
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Nov 18 13:53:04 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1109_1F1B_timelyapf_th3e-3.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.003 --freezing.max_freeze_ratio=0.7 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1118 13:53:06.180000 2261869 site-packages/torch/distributed/run.py:811] 
W1118 13:53:06.180000 2261869 site-packages/torch/distributed/run.py:811] *****************************************
W1118 13:53:06.180000 2261869 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1118 13:53:06.180000 2261869 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-11-18 13:53:13,093 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank0]:2025-11-18 13:53:13,372 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:2025-11-18 13:53:13,363 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1116: everything same, but with seed=11
[rank0]:"
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:1116: everything same, but with seed=11
[rank1]:"
[rank2]:2025-11-18 13:53:13,458 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:1116: everything same, but with seed=11
[rank2]:"
[rank3]:2025-11-18 13:53:13,590 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-18 13:53:13,592 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-18 13:53:14,092 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-18 13:53:14,095 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-18 13:53:14,101 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-18 13:53:14,104 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-18 13:53:14,109 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-18 13:53:14,110 - INFO - Loading tokenizer from tokenizer.json
[rank2]:2025-11-18 13:53:14,117 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-18 13:53:14,120 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-18 13:53:14,401 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-18 13:53:16,283 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-18 13:53:16,348 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-18 13:53:16,422 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-18 13:53:16,422 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-18 13:53:16,405 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-18 13:53:16,479 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-18 13:53:16,479 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-18 13:53:16,542 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-18 13:53:16,591 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank1]:2025-11-18 13:53:16,641 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-18 13:53:16,641 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-11-18 13:53:16,615 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-18 13:53:16,615 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-18 13:53:16,695 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-18 13:53:16,696 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-11-18 13:53:16,850 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-18 13:53:16,850 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: setting up run byp19gtd
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_1F1B_timelyapf_th3e-3_h200/20251118-1353/wandb/run-20251118_135316-byp19gtd
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1109_1F1B_timelyapf_th3e-3_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/byp19gtd
[rank3]:2025-11-18 13:53:18,079 - INFO - WandB logging enabled
[rank3]:2025-11-18 13:53:18,080 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-18 13:53:18,152 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-18 13:53:18,153 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-18 13:53:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-18 13:53:18,383 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-18 13:53:18,383 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_1F1B_timelyapf_th3e-3_h200
[rank0]:2025-11-18 13:53:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-18 13:53:18,384 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-18 13:53:18,384 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank3]:2025-11-18 13:53:18,370 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-18 13:53:18,371 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-18 13:53:18,383 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-18 13:53:30,736 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-18 13:53:30,736 - INFO - Finished loading the checkpoint in 12.35 seconds.
[rank0]:2025-11-18 13:53:30,737 - INFO - Training starts at step 1
[rank2]:2025-11-18 13:53:34,969 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 885  tflops: 41.27  mfu: 4.17%
[rank2]:2025-11-18 13:53:34,969 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-18 13:53:34,999 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 971  tflops: 45.29  mfu: 4.58%
[rank3]:2025-11-18 13:53:35,000 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-18 13:53:34,958 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 883  tflops: 41.17  mfu: 4.16%
[rank1]:2025-11-18 13:53:34,958 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-18 13:53:34,978 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 891  tflops: 41.56  mfu: 4.20%
[rank0]:2025-11-18 13:53:34,978 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-18 13:55:41,840 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 13:55:44,281 - INFO - Avg. fwd time: 14.7051 / Avg. bwd time: 42.2124 / Avg. batch time: 472.3387 (ms) / GPU bubble ratio: 3.60%
[rank2]:2025-11-18 13:55:44,311 - INFO - Avg. fwd time: 13.2704 / Avg. bwd time: 36.2774 / Avg. batch time: 525.2204 (ms) / GPU bubble ratio: 24.53%
[rank1]:2025-11-18 13:55:44,356 - INFO - Avg. fwd time: 15.1885 / Avg. bwd time: 41.0391 / Avg. batch time: 584.8313 (ms) / GPU bubble ratio: 23.09%
[rank0]:2025-11-18 13:55:44,388 - INFO - Avg. fwd time: 13.4443 / Avg. bwd time: 37.7387 / Avg. batch time: 640.3770 (ms) / GPU bubble ratio: 36.06%
[rank1]:2025-11-18 13:55:44,510 - INFO -  step: 50  loss: -4.0000  grad_norm: 5196.6494  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank3]:2025-11-18 13:55:44,512 - INFO -  step: 50  loss:  9.4360  grad_norm: 5196.6494  memory: 46.61GiB(33.34%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank2]:2025-11-18 13:55:44,508 - INFO -  step: 50  loss: -4.0000  grad_norm: 5196.6494  memory: 38.72GiB(27.69%)  tps: 6,198  tflops: 289.05  mfu: 29.23%
[rank0]:2025-11-18 13:55:44,514 - INFO -  step: 50  loss: -4.0000  grad_norm: 5196.6494  memory: 54.93GiB(39.29%)  tps: 6,198  tflops: 289.06  mfu: 29.23%
[rank0]:2025-11-18 13:57:54,052 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 13:57:56,483 - INFO - Avg. fwd time: 14.7429 / Avg. bwd time: 42.3430 / Avg. batch time: 472.8934 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-11-18 13:57:56,513 - INFO - Avg. fwd time: 13.2872 / Avg. bwd time: 36.3902 / Avg. batch time: 525.5620 (ms) / GPU bubble ratio: 24.38%
[rank0]:2025-11-18 13:57:56,591 - INFO - Avg. fwd time: 13.2800 / Avg. bwd time: 37.8319 / Avg. batch time: 639.6585 (ms) / GPU bubble ratio: 36.08%
[rank1]:2025-11-18 13:57:56,559 - INFO - Avg. fwd time: 15.0680 / Avg. bwd time: 41.0806 / Avg. batch time: 584.7103 (ms) / GPU bubble ratio: 23.18%
[rank0]:2025-11-18 13:57:56,717 - INFO -  step: 100  loss: -4.0000  grad_norm: 2703.8010  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank0]:2025-11-18 13:57:56,717 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-18 13:57:56,713 - INFO -  step: 100  loss: -4.0000  grad_norm: 2703.8010  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank1]:2025-11-18 13:57:56,713 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-18 13:57:56,715 - INFO -  step: 100  loss:  4.6344  grad_norm: 2703.8010  memory: 46.61GiB(33.34%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank3]:2025-11-18 13:57:56,715 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-18 13:57:56,710 - INFO -  step: 100  loss: -4.0000  grad_norm: 2703.8010  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank2]:2025-11-18 13:57:56,711 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-18 14:00:06,152 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:00:08,672 - INFO - Avg. fwd time: 14.7318 / Avg. bwd time: 42.3558 / Avg. batch time: 472.6655 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-11-18 14:00:08,715 - INFO - Avg. fwd time: 13.2837 / Avg. bwd time: 36.4485 / Avg. batch time: 525.2712 (ms) / GPU bubble ratio: 24.26%
[rank0]:2025-11-18 14:00:08,804 - INFO - Avg. fwd time: 13.2283 / Avg. bwd time: 37.8761 / Avg. batch time: 639.0683 (ms) / GPU bubble ratio: 36.03%
[rank1]:2025-11-18 14:00:08,761 - INFO - Avg. fwd time: 15.0223 / Avg. bwd time: 41.1124 / Avg. batch time: 584.2865 (ms) / GPU bubble ratio: 23.14%
[rank2]:2025-11-18 14:00:08,833 - INFO -  step: 150  loss: -4.0000  grad_norm: 60.5278  memory: 38.72GiB(27.69%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank0]:2025-11-18 14:00:08,839 - INFO -  step: 150  loss: -4.0000  grad_norm: 60.5278  memory: 54.93GiB(39.29%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank1]:2025-11-18 14:00:08,835 - INFO -  step: 150  loss: -4.0000  grad_norm: 60.5278  memory: 47.26GiB(33.80%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank3]:2025-11-18 14:00:08,836 - INFO -  step: 150  loss:  2.1691  grad_norm: 60.5278  memory: 46.61GiB(33.34%)  tps: 6,200  tflops: 289.19  mfu: 29.24%
[rank3]:2025-11-18 14:00:35,029 - INFO - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-18 14:01:01,402 - INFO - [Step 170] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-18 14:01:01,622 - INFO - [Step 170] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-18 14:01:01,724 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,751 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,719 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,751 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,699 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,731 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,694 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,718 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,774 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,863 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,820 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,856 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,813 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,860 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,887 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,942 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,918 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,962 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,897 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:01,952 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,914 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:01,968 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,997 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,997 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,998 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-18 14:01:01,998 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:01,999 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:02,030 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-18 14:01:02,060 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:02,006 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-18 14:01:02,038 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:02,022 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-18 14:01:17,726 - INFO - [Step 180] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-18 14:01:17,937 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1401_max_batch_time.svg
[rank3]:> Batch Time: 622.93 ms, GPU Bubble Ratio: 34.15%, 27.54%, 35.75%, 26.33%
[rank3]:2025-11-18 14:01:18,083 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1401_min_batch_time.svg
[rank3]:> Batch Time: 350.21 ms, GPU Bubble Ratio: 69.98%, 23.67%, 32.19%, 23.56%
[rank3]:2025-11-18 14:01:18,237 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1401_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 407.02 ms, GPU Bubble Ratio: 32.48%, 20.80%, 29.67%, 20.27%
[rank3]:2025-11-18 14:01:18,237 - INFO - 	> Batch Time: 407.02 ms (Average Freeze Ratio: 0.64, Time Reduction Rate: 0.35)
[rank0]:2025-11-18 14:01:59,201 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:02:01,388 - INFO - Avg. fwd time: 14.9619 / Avg. bwd time: 40.0858 / Avg. batch time: 456.8657 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-11-18 14:02:01,411 - INFO - Avg. fwd time: 13.4966 / Avg. bwd time: 34.4415 / Avg. batch time: 507.8151 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-11-18 14:02:01,447 - INFO - Avg. fwd time: 15.2617 / Avg. bwd time: 38.7823 / Avg. batch time: 564.2366 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-11-18 14:02:01,479 - INFO - Avg. fwd time: 13.4114 / Avg. bwd time: 34.5444 / Avg. batch time: 616.0444 (ms) / GPU bubble ratio: 37.72%
[rank2]:2025-11-18 14:02:01,618 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.25/0.75, [MB1] 0.27/0.81, [MB2] 0.11/0.34, [MB3] 0.27/0.81, [MB4] 0.27/0.80, [MB5] 0.27/0.81, [MB6] 0.09/0.27, [MB7] 0.33/1.00
[rank2]:2025-11-18 14:02:01,618 - INFO -  step: 200  loss: -4.0000  grad_norm:  4.4916  memory: 45.36GiB(32.44%)  tps: 7,263  tflops: 338.76  mfu: 34.25%
[rank1]:2025-11-18 14:02:01,630 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.01/0.03, [MB1] 0.19/0.57, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-18 14:02:01,630 - INFO -  step: 200  loss: -4.0000  grad_norm:  4.4916  memory: 55.11GiB(39.42%)  tps: 7,263  tflops: 338.73  mfu: 34.25%
[rank1]:2025-11-18 14:02:01,696 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1402_stage1_step200.svg
[rank0]:2025-11-18 14:02:01,635 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.21, [MB1] 0.15/0.46, [MB2] 0.15/0.45, [MB3] 0.15/0.45, [MB4] 0.00/0.00, [MB5] 0.15/0.45, [MB6] 0.17/0.52, [MB7] 0.33/1.00
[rank0]:2025-11-18 14:02:01,635 - INFO -  step: 200  loss: -4.0000  grad_norm:  4.4916  memory: 65.15GiB(46.60%)  tps: 7,263  tflops: 338.73  mfu: 34.25%
[rank0]:2025-11-18 14:02:01,693 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1402_stage0_step200.svg
[rank3]:2025-11-18 14:02:01,629 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.01/0.03, [MB2] 0.33/1.00, [MB3] 0.20/0.60, [MB4] 0.33/0.99, [MB5] 0.33/0.99, [MB6] 0.33/0.99, [MB7] 0.33/1.00
[rank3]:2025-11-18 14:02:01,631 - INFO -  step: 200  loss:  0.5805  grad_norm:  4.4916  memory: 56.12GiB(40.14%)  tps: 7,263  tflops: 338.74  mfu: 34.25%
[rank2]:2025-11-18 14:02:01,696 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1402_stage2_step200.svg
[rank3]:2025-11-18 14:02:01,770 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1402_real_step200_rank3.svg
[rank3]:> Batch Time: 471.47 ms, GPU Bubble Ratio: 51.76%, 34.54%, 40.85%, 29.20%
[rank3]:2025-11-18 14:02:01,814 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1402_stage3_step200.svg
[rank0]:2025-11-18 14:03:50,439 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:03:52,362 - INFO - Avg. fwd time: 15.1338 / Avg. bwd time: 38.4129 / Avg. batch time: 445.2590 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-11-18 14:03:52,388 - INFO - Avg. fwd time: 13.6753 / Avg. bwd time: 32.7618 / Avg. batch time: 494.3441 (ms) / GPU bubble ratio: 24.85%
[rank1]:2025-11-18 14:03:52,400 - INFO - Avg. fwd time: 15.4531 / Avg. bwd time: 36.8292 / Avg. batch time: 548.3692 (ms) / GPU bubble ratio: 23.73%
[rank0]:2025-11-18 14:03:52,431 - INFO - Avg. fwd time: 13.5389 / Avg. bwd time: 33.3193 / Avg. batch time: 599.0509 (ms) / GPU bubble ratio: 37.42%
[rank0]:2025-11-18 14:03:52,582 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.14/0.21, [MB1] 0.31/0.46, [MB2] 0.30/0.45, [MB3] 0.30/0.45, [MB4] 0.00/0.00, [MB5] 0.30/0.45, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank0]:2025-11-18 14:03:52,583 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1771  memory: 65.64GiB(46.95%)  tps: 7,384  tflops: 344.38  mfu: 34.82%
[rank3]:2025-11-18 14:03:52,582 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.02/0.03, [MB2] 0.67/1.00, [MB3] 0.40/0.60, [MB4] 0.66/0.99, [MB5] 0.66/0.99, [MB6] 0.66/0.99, [MB7] 0.67/1.00
[rank3]:2025-11-18 14:03:52,587 - INFO -  step: 250  loss:  0.2503  grad_norm:  0.1771  memory: 58.38GiB(41.76%)  tps: 7,383  tflops: 344.36  mfu: 34.82%
[rank2]:2025-11-18 14:03:52,557 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.50/0.75, [MB1] 0.54/0.81, [MB2] 0.23/0.34, [MB3] 0.54/0.81, [MB4] 0.54/0.80, [MB5] 0.54/0.81, [MB6] 0.18/0.27, [MB7] 0.67/1.00
[rank2]:2025-11-18 14:03:52,557 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1771  memory: 45.59GiB(32.61%)  tps: 7,384  tflops: 344.40  mfu: 34.82%
[rank1]:2025-11-18 14:03:52,555 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.02/0.03, [MB1] 0.38/0.57, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-18 14:03:52,555 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.1771  memory: 56.52GiB(40.42%)  tps: 7,385  tflops: 344.45  mfu: 34.83%
[rank0]:2025-11-18 14:05:31,084 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:05:33,000 - INFO - Avg. fwd time: 13.8999 / Avg. bwd time: 30.7199 / Avg. batch time: 477.8825 (ms) / GPU bubble ratio: 25.30%
[rank3]:2025-11-18 14:05:32,975 - INFO - Avg. fwd time: 15.3748 / Avg. bwd time: 36.1424 / Avg. batch time: 431.0742 (ms) / GPU bubble ratio: 4.39%
[rank2]:2025-11-18 14:05:33,086 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.75/0.75, [MB1] 0.81/0.81, [MB2] 0.34/0.34, [MB3] 0.81/0.81, [MB4] 0.80/0.80, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-18 14:05:33,087 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1413  memory: 45.59GiB(32.61%)  tps: 8,149  tflops: 380.06  mfu: 38.43%
[rank0]:2025-11-18 14:05:33,055 - INFO - Avg. fwd time: 13.7484 / Avg. bwd time: 31.4528 / Avg. batch time: 578.2150 (ms) / GPU bubble ratio: 37.46%
[rank1]:2025-11-18 14:05:33,025 - INFO - Avg. fwd time: 15.7086 / Avg. bwd time: 34.5278 / Avg. batch time: 529.1787 (ms) / GPU bubble ratio: 24.05%
[rank1]:2025-11-18 14:05:33,077 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.03/0.03, [MB1] 0.57/0.57, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-18 14:05:33,077 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1413  memory: 56.52GiB(40.42%)  tps: 8,149  tflops: 380.09  mfu: 38.43%
[rank2]:2025-11-18 14:05:33,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1405_stage2_step300.svg
[rank3]:2025-11-18 14:05:33,121 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.03/0.03, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 0.99/0.99, [MB5] 0.99/0.99, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank3]:2025-11-18 14:05:33,124 - INFO -  step: 300  loss:  0.2882  grad_norm:  0.1413  memory: 58.72GiB(42.00%)  tps: 8,148  tflops: 380.04  mfu: 38.43%
[rank0]:2025-11-18 14:05:33,122 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.21, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-18 14:05:33,122 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1413  memory: 65.70GiB(46.99%)  tps: 8,148  tflops: 380.03  mfu: 38.43%
[rank0]:2025-11-18 14:05:33,170 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1405_stage0_step300.svg
[rank1]:2025-11-18 14:05:33,174 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1405_stage1_step300.svg
[rank3]:2025-11-18 14:05:33,260 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1405_real_step300_rank3.svg
[rank3]:> Batch Time: 469.31 ms, GPU Bubble Ratio: 38.07%, 32.84%, 40.16%, 29.37%
[rank3]:2025-11-18 14:05:33,301 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1405_stage3_step300.svg
[rank0]:2025-11-18 14:07:09,063 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:07:10,864 - INFO - Avg. fwd time: 15.5423 / Avg. bwd time: 34.6061 / Avg. batch time: 421.5174 (ms) / GPU bubble ratio: 4.82%
[rank2]:2025-11-18 14:07:10,877 - INFO - Avg. fwd time: 14.0580 / Avg. bwd time: 29.2507 / Avg. batch time: 466.7820 (ms) / GPU bubble ratio: 25.77%
[rank1]:2025-11-18 14:07:10,895 - INFO - Avg. fwd time: 15.9080 / Avg. bwd time: 32.8269 / Avg. batch time: 516.0653 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-11-18 14:07:10,922 - INFO - Avg. fwd time: 13.9039 / Avg. bwd time: 28.9974 / Avg. batch time: 563.7682 (ms) / GPU bubble ratio: 39.12%
[rank1]:2025-11-18 14:07:10,980 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.03/0.03, [MB1] 0.57/0.57, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-18 14:07:11,065 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.03/0.03, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 0.99/0.99, [MB5] 0.99/0.99, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank3]:2025-11-18 14:07:11,067 - INFO -  step: 350  loss:  0.3340  grad_norm:  0.1651  memory: 58.72GiB(42.00%)  tps: 8,364  tflops: 390.10  mfu: 39.44%
[rank0]:2025-11-18 14:07:11,060 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.21, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-18 14:07:11,061 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1651  memory: 65.70GiB(46.99%)  tps: 8,364  tflops: 390.12  mfu: 39.45%
[rank2]:2025-11-18 14:07:11,026 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.75/0.75, [MB1] 0.81/0.81, [MB2] 0.34/0.34, [MB3] 0.81/0.81, [MB4] 0.80/0.80, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-18 14:07:11,026 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.1651  memory: 45.59GiB(32.61%)  tps: 8,364  tflops: 390.12  mfu: 39.45%
[rank1]:2025-11-18 14:07:11,007 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,365  tflops: 390.15  mfu: 39.45%
[rank0]:2025-11-18 14:08:46,563 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:08:48,358 - INFO - Avg. fwd time: 15.6917 / Avg. bwd time: 33.2256 / Avg. batch time: 412.9226 (ms) / GPU bubble ratio: 5.23%
[rank0]:2025-11-18 14:08:48,416 - INFO - Avg. fwd time: 14.0362 / Avg. bwd time: 26.8409 / Avg. batch time: 550.8993 (ms) / GPU bubble ratio: 40.64%
[rank2]:2025-11-18 14:08:48,372 - INFO - Avg. fwd time: 14.1954 / Avg. bwd time: 27.9604 / Avg. batch time: 456.8234 (ms) / GPU bubble ratio: 26.18%
[rank1]:2025-11-18 14:08:48,388 - INFO - Avg. fwd time: 16.0825 / Avg. bwd time: 31.3269 / Avg. batch time: 504.3305 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-11-18 14:08:48,474 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.03/0.03, [MB1] 0.57/0.57, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-18 14:08:48,555 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.03/0.03, [MB2] 1.00/1.00, [MB3] 0.60/0.60, [MB4] 0.99/0.99, [MB5] 0.99/0.99, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank3]:2025-11-18 14:08:48,558 - INFO -  step: 400  loss:  0.2762  grad_norm:  0.1086  memory: 59.95GiB(42.88%)  tps: 8,403  tflops: 391.91  mfu: 39.63%
[rank0]:2025-11-18 14:08:48,543 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.21, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-18 14:08:48,543 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1086  memory: 65.70GiB(46.99%)  tps: 8,404  tflops: 391.95  mfu: 39.63%
[rank2]:2025-11-18 14:08:48,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.75/0.75, [MB1] 0.81/0.81, [MB2] 0.34/0.34, [MB3] 0.81/0.81, [MB4] 0.80/0.80, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-18 14:08:48,517 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1086  memory: 45.59GiB(32.61%)  tps: 8,403  tflops: 391.91  mfu: 39.63%
[rank1]:2025-11-18 14:08:48,499 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,403  tflops: 391.91  mfu: 39.63%
[rank0]:2025-11-18 14:08:48,607 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1408_stage0_step400.svg
[rank2]:2025-11-18 14:08:48,609 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1408_stage2_step400.svg
[rank1]:2025-11-18 14:08:48,610 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1408_stage1_step400.svg
[rank3]:2025-11-18 14:08:48,696 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1408_real_step400_rank3.svg
[rank3]:> Batch Time: 464.22 ms, GPU Bubble Ratio: 52.58%, 33.21%, 40.95%, 30.00%
[rank3]:2025-11-18 14:08:48,742 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1408_stage3_step400.svg
[rank0]:2025-11-18 14:10:24,348 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:10:26,226 - INFO - Avg. fwd time: 15.8077 / Avg. bwd time: 32.1513 / Avg. batch time: 406.4427 (ms) / GPU bubble ratio: 5.60%
[rank0]:2025-11-18 14:10:26,305 - INFO - Avg. fwd time: 14.1377 / Avg. bwd time: 25.1827 / Avg. batch time: 541.1193 (ms) / GPU bubble ratio: 41.87%
[rank2]:2025-11-18 14:10:26,251 - INFO - Avg. fwd time: 14.3006 / Avg. bwd time: 26.9791 / Avg. batch time: 449.2940 (ms) / GPU bubble ratio: 26.50%
[rank2]:2025-11-18 14:10:26,334 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1979  memory: 45.59GiB(32.61%)  tps: 8,375  tflops: 390.60  mfu: 39.49%
[rank1]:2025-11-18 14:10:26,276 - INFO - Avg. fwd time: 16.2130 / Avg. bwd time: 30.1796 / Avg. batch time: 495.4417 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-11-18 14:10:26,313 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,375  tflops: 390.62  mfu: 39.50%
[rank0]:2025-11-18 14:10:26,367 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1979  memory: 65.70GiB(46.99%)  tps: 8,374  tflops: 390.57  mfu: 39.49%
[rank3]:2025-11-18 14:10:26,371 - INFO -  step: 450  loss:  0.2989  grad_norm:  0.1979  memory: 59.95GiB(42.88%)  tps: 8,375  tflops: 390.62  mfu: 39.50%
[rank0]:2025-11-18 14:12:01,881 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:12:03,695 - INFO - Avg. fwd time: 14.3747 / Avg. bwd time: 26.2874 / Avg. batch time: 444.0428 (ms) / GPU bubble ratio: 26.74%
[rank1]:2025-11-18 14:12:03,710 - INFO - Avg. fwd time: 16.3032 / Avg. bwd time: 29.3862 / Avg. batch time: 489.2532 (ms) / GPU bubble ratio: 25.29%
[rank3]:2025-11-18 14:12:03,680 - INFO - Avg. fwd time: 15.8847 / Avg. bwd time: 31.4247 / Avg. batch time: 401.9011 (ms) / GPU bubble ratio: 5.83%
[rank0]:2025-11-18 14:12:03,738 - INFO - Avg. fwd time: 14.2076 / Avg. bwd time: 24.0538 / Avg. batch time: 534.2202 (ms) / GPU bubble ratio: 42.70%
[rank1]:2025-11-18 14:12:03,823 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,401  tflops: 391.83  mfu: 39.62%
[rank2]:2025-11-18 14:12:03,842 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1354  memory: 45.59GiB(32.61%)  tps: 8,401  tflops: 391.84  mfu: 39.62%
[rank0]:2025-11-18 14:12:03,882 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1354  memory: 65.70GiB(46.99%)  tps: 8,401  tflops: 391.81  mfu: 39.62%
[rank1]:2025-11-18 14:12:03,931 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1412_stage1_step500.svg
[rank3]:2025-11-18 14:12:03,883 - INFO -  step: 500  loss:  0.3121  grad_norm:  0.1354  memory: 59.95GiB(42.88%)  tps: 8,401  tflops: 391.83  mfu: 39.62%
[rank0]:2025-11-18 14:12:03,930 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1412_stage0_step500.svg
[rank2]:2025-11-18 14:12:03,932 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1412_stage2_step500.svg
[rank3]:2025-11-18 14:12:04,020 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1412_real_step500_rank3.svg
[rank3]:> Batch Time: 464.05 ms, GPU Bubble Ratio: 52.22%, 33.51%, 41.00%, 29.62%
[rank3]:2025-11-18 14:12:04,061 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1412_stage3_step500.svg
[rank0]:2025-11-18 14:13:39,483 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:13:41,294 - INFO - Avg. fwd time: 14.4416 / Avg. bwd time: 25.6369 / Avg. batch time: 439.0411 (ms) / GPU bubble ratio: 26.97%
[rank1]:2025-11-18 14:13:41,310 - INFO - Avg. fwd time: 16.3880 / Avg. bwd time: 28.6256 / Avg. batch time: 483.3484 (ms) / GPU bubble ratio: 25.50%
[rank3]:2025-11-18 14:13:41,280 - INFO - Avg. fwd time: 15.9537 / Avg. bwd time: 30.7384 / Avg. batch time: 397.5541 (ms) / GPU bubble ratio: 6.04%
[rank0]:2025-11-18 14:13:41,337 - INFO - Avg. fwd time: 14.2734 / Avg. bwd time: 22.9658 / Avg. batch time: 527.7431 (ms) / GPU bubble ratio: 43.55%
[rank1]:2025-11-18 14:13:41,423 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,393  tflops: 391.47  mfu: 39.58%
[rank2]:2025-11-18 14:13:41,439 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1334  memory: 45.59GiB(32.61%)  tps: 8,394  tflops: 391.48  mfu: 39.58%
[rank0]:2025-11-18 14:13:41,480 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1334  memory: 65.70GiB(46.99%)  tps: 8,394  tflops: 391.48  mfu: 39.58%
[rank3]:2025-11-18 14:13:41,482 - INFO -  step: 550  loss:  0.1742  grad_norm:  0.1334  memory: 60.10GiB(42.99%)  tps: 8,394  tflops: 391.48  mfu: 39.58%
[rank0]:2025-11-18 14:15:18,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:15:19,986 - INFO - Avg. fwd time: 14.5091 / Avg. bwd time: 25.1187 / Avg. batch time: 435.1689 (ms) / GPU bubble ratio: 27.15%
[rank3]:2025-11-18 14:15:19,960 - INFO - Avg. fwd time: 16.0261 / Avg. bwd time: 30.1836 / Avg. batch time: 394.2313 (ms) / GPU bubble ratio: 6.23%
[rank2]:2025-11-18 14:15:20,072 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1779  memory: 45.59GiB(32.61%)  tps: 8,306  tflops: 387.38  mfu: 39.17%
[rank0]:2025-11-18 14:15:20,041 - INFO - Avg. fwd time: 14.3394 / Avg. bwd time: 22.0720 / Avg. batch time: 522.6750 (ms) / GPU bubble ratio: 44.27%
[rank1]:2025-11-18 14:15:20,011 - INFO - Avg. fwd time: 16.4719 / Avg. bwd time: 28.0118 / Avg. batch time: 478.7520 (ms) / GPU bubble ratio: 25.67%
[rank1]:2025-11-18 14:15:20,049 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,306  tflops: 387.40  mfu: 39.17%
[rank3]:2025-11-18 14:15:20,108 - INFO -  step: 600  loss:  0.3995  grad_norm:  0.1779  memory: 60.10GiB(42.99%)  tps: 8,306  tflops: 387.40  mfu: 39.17%
[rank2]:2025-11-18 14:15:20,157 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1415_stage2_step600.svg
[rank0]:2025-11-18 14:15:20,107 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1779  memory: 65.70GiB(46.99%)  tps: 8,306  tflops: 387.40  mfu: 39.17%
[rank0]:2025-11-18 14:15:20,155 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1415_stage0_step600.svg
[rank1]:2025-11-18 14:15:20,155 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1415_stage1_step600.svg
[rank3]:2025-11-18 14:15:20,244 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1415_real_step600_rank3.svg
[rank3]:> Batch Time: 473.17 ms, GPU Bubble Ratio: 52.37%, 33.57%, 40.41%, 29.75%
[rank3]:2025-11-18 14:15:20,287 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1415_stage3_step600.svg
[rank0]:2025-11-18 14:16:57,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:16:59,454 - INFO - Avg. fwd time: 14.5657 / Avg. bwd time: 24.7416 / Avg. batch time: 432.5153 (ms) / GPU bubble ratio: 27.30%
[rank1]:2025-11-18 14:16:59,470 - INFO - Avg. fwd time: 16.5414 / Avg. bwd time: 27.5710 / Avg. batch time: 475.5833 (ms) / GPU bubble ratio: 25.80%
[rank3]:2025-11-18 14:16:59,441 - INFO - Avg. fwd time: 16.0928 / Avg. bwd time: 29.7685 / Avg. batch time: 391.9307 (ms) / GPU bubble ratio: 6.39%
[rank0]:2025-11-18 14:16:59,497 - INFO - Avg. fwd time: 14.3955 / Avg. bwd time: 21.4149 / Avg. batch time: 519.1679 (ms) / GPU bubble ratio: 44.82%
[rank1]:2025-11-18 14:16:59,581 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,230  tflops: 383.87  mfu: 38.81%
[rank2]:2025-11-18 14:16:59,604 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0901  memory: 45.59GiB(32.61%)  tps: 8,231  tflops: 383.87  mfu: 38.81%
[rank0]:2025-11-18 14:16:59,626 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0901  memory: 65.70GiB(46.99%)  tps: 8,232  tflops: 383.93  mfu: 38.82%
[rank3]:2025-11-18 14:16:59,642 - INFO -  step: 650  loss:  0.2754  grad_norm:  0.0901  memory: 60.10GiB(42.99%)  tps: 8,230  tflops: 383.87  mfu: 38.81%
[rank0]:2025-11-18 14:18:37,040 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:18:38,871 - INFO - Avg. fwd time: 16.1560 / Avg. bwd time: 29.3593 / Avg. batch time: 389.6308 (ms) / GPU bubble ratio: 6.55%
[rank2]:2025-11-18 14:18:38,884 - INFO - Avg. fwd time: 14.6220 / Avg. bwd time: 24.3647 / Avg. batch time: 429.7859 (ms) / GPU bubble ratio: 27.43%
[rank0]:2025-11-18 14:18:38,924 - INFO - Avg. fwd time: 14.4497 / Avg. bwd time: 20.7538 / Avg. batch time: 515.6084 (ms) / GPU bubble ratio: 45.38%
[rank1]:2025-11-18 14:18:38,898 - INFO - Avg. fwd time: 16.6096 / Avg. bwd time: 27.1239 / Avg. batch time: 472.3366 (ms) / GPU bubble ratio: 25.93%
[rank2]:2025-11-18 14:18:39,030 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1699  memory: 45.59GiB(32.61%)  tps: 8,239  tflops: 384.28  mfu: 38.86%
[rank0]:2025-11-18 14:18:39,055 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1699  memory: 65.70GiB(46.99%)  tps: 8,239  tflops: 384.27  mfu: 38.85%
[rank1]:2025-11-18 14:18:39,016 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,239  tflops: 384.25  mfu: 38.85%
[rank3]:2025-11-18 14:18:39,069 - INFO -  step: 700  loss:  0.3587  grad_norm:  0.1699  memory: 60.22GiB(43.07%)  tps: 8,239  tflops: 384.29  mfu: 38.86%
[rank2]:2025-11-18 14:18:39,120 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1418_stage2_step700.svg
[rank0]:2025-11-18 14:18:39,119 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1418_stage0_step700.svg
[rank1]:2025-11-18 14:18:39,120 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1418_stage1_step700.svg
[rank3]:2025-11-18 14:18:39,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1418_real_step700_rank3.svg
[rank3]:> Batch Time: 469.97 ms, GPU Bubble Ratio: 53.08%, 33.56%, 39.94%, 29.71%
[rank3]:2025-11-18 14:18:39,250 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1418_stage3_step700.svg
[rank0]:2025-11-18 14:20:16,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:20:18,135 - INFO - Avg. fwd time: 14.6682 / Avg. bwd time: 24.0357 / Avg. batch time: 427.4362 (ms) / GPU bubble ratio: 27.56%
[rank1]:2025-11-18 14:20:18,160 - INFO - Avg. fwd time: 16.6643 / Avg. bwd time: 26.7380 / Avg. batch time: 469.5384 (ms) / GPU bubble ratio: 26.05%
[rank3]:2025-11-18 14:20:18,106 - INFO - Avg. fwd time: 16.2086 / Avg. bwd time: 29.0018 / Avg. batch time: 387.6030 (ms) / GPU bubble ratio: 6.69%
[rank2]:2025-11-18 14:20:18,219 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1071  memory: 45.59GiB(32.61%)  tps: 8,259  tflops: 385.20  mfu: 38.95%
[rank0]:2025-11-18 14:20:18,190 - INFO - Avg. fwd time: 14.4921 / Avg. bwd time: 20.1958 / Avg. batch time: 512.5163 (ms) / GPU bubble ratio: 45.85%
[rank0]:2025-11-18 14:20:18,238 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1071  memory: 65.70GiB(46.99%)  tps: 8,260  tflops: 385.22  mfu: 38.95%
[rank1]:2025-11-18 14:20:18,195 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,260  tflops: 385.24  mfu: 38.95%
[rank3]:2025-11-18 14:20:18,255 - INFO -  step: 750  loss:  0.1447  grad_norm:  0.1071  memory: 60.22GiB(43.07%)  tps: 8,259  tflops: 385.22  mfu: 38.95%
[rank0]:2025-11-18 14:21:53,777 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-18 14:21:55,647 - INFO - Avg. fwd time: 16.6982 / Avg. bwd time: 26.4354 / Avg. batch time: 467.1774 (ms) / GPU bubble ratio: 26.14%
[rank3]:2025-11-18 14:21:55,618 - INFO - Avg. fwd time: 16.2375 / Avg. bwd time: 28.7217 / Avg. batch time: 385.8633 (ms) / GPU bubble ratio: 6.79%
[rank2]:2025-11-18 14:21:55,632 - INFO - Avg. fwd time: 14.6953 / Avg. bwd time: 23.7881 / Avg. batch time: 425.4253 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-18 14:21:55,676 - INFO - Avg. fwd time: 14.5193 / Avg. bwd time: 19.7661 / Avg. batch time: 509.9041 (ms) / GPU bubble ratio: 46.21%
[rank1]:2025-11-18 14:21:55,761 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,396  tflops: 391.61  mfu: 39.60%
[rank2]:2025-11-18 14:21:55,789 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1769  memory: 45.59GiB(32.61%)  tps: 8,396  tflops: 391.59  mfu: 39.59%
[rank0]:2025-11-18 14:21:55,818 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1769  memory: 65.70GiB(46.99%)  tps: 8,395  tflops: 391.55  mfu: 39.59%
[rank3]:2025-11-18 14:21:55,821 - INFO -  step: 800  loss:  0.2668  grad_norm:  0.1769  memory: 60.36GiB(43.17%)  tps: 8,397  tflops: 391.61  mfu: 39.60%
[rank2]:2025-11-18 14:21:55,873 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1421_stage2_step800.svg
[rank0]:2025-11-18 14:21:55,871 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1421_stage0_step800.svg
[rank1]:2025-11-18 14:21:55,874 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1421_stage1_step800.svg
[rank3]:2025-11-18 14:21:55,955 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1421_real_step800_rank3.svg
[rank3]:> Batch Time: 465.84 ms, GPU Bubble Ratio: 52.94%, 34.04%, 39.83%, 29.88%
[rank3]:2025-11-18 14:21:56,001 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1421_stage3_step800.svg
[rank0]:2025-11-18 14:23:32,221 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:23:34,020 - INFO - Avg. fwd time: 16.2730 / Avg. bwd time: 28.4439 / Avg. batch time: 384.1805 (ms) / GPU bubble ratio: 6.88%
[rank1]:2025-11-18 14:23:34,051 - INFO - Avg. fwd time: 16.7379 / Avg. bwd time: 26.1333 / Avg. batch time: 464.8916 (ms) / GPU bubble ratio: 26.23%
[rank2]:2025-11-18 14:23:34,034 - INFO - Avg. fwd time: 14.7281 / Avg. bwd time: 23.5298 / Avg. batch time: 423.4939 (ms) / GPU bubble ratio: 27.73%
[rank0]:2025-11-18 14:23:34,080 - INFO - Avg. fwd time: 14.5505 / Avg. bwd time: 19.3297 / Avg. batch time: 507.4070 (ms) / GPU bubble ratio: 46.58%
[rank2]:2025-11-18 14:23:34,183 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1015  memory: 45.59GiB(32.61%)  tps: 8,326  tflops: 388.31  mfu: 39.26%
[rank0]:2025-11-18 14:23:34,220 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1015  memory: 65.70GiB(46.99%)  tps: 8,325  tflops: 388.28  mfu: 39.26%
[rank3]:2025-11-18 14:23:34,224 - INFO -  step: 850  loss:  0.1273  grad_norm:  0.1015  memory: 60.36GiB(43.17%)  tps: 8,325  tflops: 388.28  mfu: 39.26%
[rank1]:2025-11-18 14:23:34,164 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,325  tflops: 388.28  mfu: 39.26%
[rank0]:2025-11-18 14:25:08,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:25:10,808 - INFO - Avg. fwd time: 16.2937 / Avg. bwd time: 28.1744 / Avg. batch time: 382.4657 (ms) / GPU bubble ratio: 6.99%
[rank2]:2025-11-18 14:25:10,839 - INFO - Avg. fwd time: 14.7492 / Avg. bwd time: 23.2958 / Avg. batch time: 421.5462 (ms) / GPU bubble ratio: 27.80%
[rank0]:2025-11-18 14:25:10,896 - INFO - Avg. fwd time: 14.5698 / Avg. bwd time: 18.9427 / Avg. batch time: 504.9081 (ms) / GPU bubble ratio: 46.90%
[rank1]:2025-11-18 14:25:10,865 - INFO - Avg. fwd time: 16.7643 / Avg. bwd time: 25.8564 / Avg. batch time: 462.6199 (ms) / GPU bubble ratio: 26.30%
[rank1]:2025-11-18 14:25:10,902 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,468  tflops: 394.96  mfu: 39.94%
[rank2]:2025-11-18 14:25:10,925 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0814  memory: 45.59GiB(32.61%)  tps: 8,468  tflops: 394.94  mfu: 39.93%
[rank0]:2025-11-18 14:25:10,948 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0814  memory: 65.70GiB(46.99%)  tps: 8,469  tflops: 395.00  mfu: 39.94%
[rank0]:2025-11-18 14:25:11,005 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1425_stage0_step900.svg
[rank3]:2025-11-18 14:25:10,959 - INFO -  step: 900  loss:  0.1900  grad_norm:  0.0814  memory: 60.36GiB(43.17%)  tps: 8,469  tflops: 394.98  mfu: 39.94%
[rank1]:2025-11-18 14:25:11,005 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1425_stage1_step900.svg
[rank2]:2025-11-18 14:25:11,006 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1425_stage2_step900.svg
[rank3]:2025-11-18 14:25:11,095 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1425_real_step900_rank3.svg
[rank3]:> Batch Time: 467.20 ms, GPU Bubble Ratio: 52.77%, 33.63%, 39.48%, 30.25%
[rank3]:2025-11-18 14:25:11,135 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1425_stage3_step900.svg
[rank0]:2025-11-18 14:26:46,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:26:48,769 - INFO - Avg. fwd time: 16.3132 / Avg. bwd time: 28.0059 / Avg. batch time: 381.2926 (ms) / GPU bubble ratio: 7.01%
[rank1]:2025-11-18 14:26:48,796 - INFO - Avg. fwd time: 16.7899 / Avg. bwd time: 25.6449 / Avg. batch time: 461.0341 (ms) / GPU bubble ratio: 26.37%
[rank2]:2025-11-18 14:26:48,783 - INFO - Avg. fwd time: 14.7696 / Avg. bwd time: 23.1194 / Avg. batch time: 420.2057 (ms) / GPU bubble ratio: 27.87%
[rank0]:2025-11-18 14:26:48,824 - INFO - Avg. fwd time: 14.5882 / Avg. bwd time: 18.6483 / Avg. batch time: 503.1856 (ms) / GPU bubble ratio: 47.16%
[rank1]:2025-11-18 14:26:48,911 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,358  tflops: 389.84  mfu: 39.42%
[rank2]:2025-11-18 14:26:48,934 - INFO -  step: 950  loss: -4.0000  grad_norm:  2.6364  memory: 45.59GiB(32.61%)  tps: 8,358  tflops: 389.84  mfu: 39.42%
[rank0]:2025-11-18 14:26:48,967 - INFO -  step: 950  loss: -4.0000  grad_norm:  2.6364  memory: 65.70GiB(46.99%)  tps: 8,358  tflops: 389.80  mfu: 39.41%
[rank3]:2025-11-18 14:26:48,973 - INFO -  step: 950  loss:  0.2444  grad_norm:  2.6364  memory: 60.36GiB(43.17%)  tps: 8,358  tflops: 389.83  mfu: 39.42%
[rank0]:2025-11-18 14:28:25,354 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:28:27,160 - INFO - Avg. fwd time: 16.3398 / Avg. bwd time: 27.8107 / Avg. batch time: 380.1740 (ms) / GPU bubble ratio: 7.09%
[rank1]:2025-11-18 14:28:27,192 - INFO - Avg. fwd time: 16.8197 / Avg. bwd time: 25.4330 / Avg. batch time: 459.4711 (ms) / GPU bubble ratio: 26.43%
[rank2]:2025-11-18 14:28:27,174 - INFO - Avg. fwd time: 14.7941 / Avg. bwd time: 22.9355 / Avg. batch time: 418.8944 (ms) / GPU bubble ratio: 27.94%
[rank0]:2025-11-18 14:28:27,219 - INFO - Avg. fwd time: 14.6105 / Avg. bwd time: 18.3359 / Avg. batch time: 501.4551 (ms) / GPU bubble ratio: 47.44%
[rank1]:2025-11-18 14:28:27,302 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,326  tflops: 388.32  mfu: 39.26%
[rank1]:2025-11-18 14:28:27,302 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-18 14:28:27,324 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0590  memory: 45.59GiB(32.61%)  tps: 8,326  tflops: 388.33  mfu: 39.26%
[rank2]:2025-11-18 14:28:27,324 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-18 14:28:27,348 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0590  memory: 65.70GiB(46.99%)  tps: 8,327  tflops: 388.37  mfu: 39.27%
[rank0]:2025-11-18 14:28:27,348 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-18 14:28:27,348 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-18 14:28:27,364 - INFO -  step: 1000  loss:  0.1702  grad_norm:  0.0590  memory: 60.36GiB(43.17%)  tps: 8,326  tflops: 388.33  mfu: 39.26%
[rank3]:2025-11-18 14:28:27,365 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-18 14:28:38,789 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.47 seconds.
[rank1]:2025-11-18 14:28:39,419 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.12 seconds.
[rank3]:2025-11-18 14:28:40,511 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.15 seconds.
[rank0]:2025-11-18 14:28:42,476 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-18 14:28:42,481 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.13 seconds.
[rank1]:2025-11-18 14:28:42,540 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1428_stage1_step1000.svg
[rank2]:2025-11-18 14:28:42,538 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1428_stage2_step1000.svg
[rank0]:2025-11-18 14:28:42,538 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1428_stage0_step1000.svg
[rank3]:2025-11-18 14:28:42,707 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1428_real_step1000_rank3.svg
[rank3]:> Batch Time: 471.59 ms, GPU Bubble Ratio: 53.13%, 33.65%, 41.18%, 30.44%
[rank3]:2025-11-18 14:28:42,784 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1428_stage3_step1000.svg
[rank0]:2025-11-18 14:30:20,455 - INFO - [GC] Peforming periodical GC collection 1.80 seconds
[rank3]:2025-11-18 14:30:22,386 - INFO - Avg. fwd time: 16.3592 / Avg. bwd time: 27.6364 / Avg. batch time: 379.1940 (ms) / GPU bubble ratio: 7.18%
[rank2]:2025-11-18 14:30:22,416 - INFO - Avg. fwd time: 14.8114 / Avg. bwd time: 22.7592 / Avg. batch time: 417.7488 (ms) / GPU bubble ratio: 28.05%
[rank1]:2025-11-18 14:30:22,444 - INFO - Avg. fwd time: 16.8414 / Avg. bwd time: 25.2366 / Avg. batch time: 458.0929 (ms) / GPU bubble ratio: 26.52%
[rank1]:2025-11-18 14:30:22,482 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 7,112  tflops: 331.72  mfu: 33.54%
[rank2]:2025-11-18 14:30:22,500 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2137  memory: 45.59GiB(32.61%)  tps: 7,113  tflops: 331.73  mfu: 33.54%
[rank0]:2025-11-18 14:30:22,475 - INFO - Avg. fwd time: 14.6311 / Avg. bwd time: 18.0464 / Avg. batch time: 499.9241 (ms) / GPU bubble ratio: 47.71%
[rank0]:2025-11-18 14:30:22,535 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.2137  memory: 65.70GiB(46.99%)  tps: 7,112  tflops: 331.70  mfu: 33.54%
[rank3]:2025-11-18 14:30:22,540 - INFO -  step: 1050  loss:  0.2722  grad_norm:  0.2137  memory: 60.36GiB(43.17%)  tps: 7,113  tflops: 331.74  mfu: 33.54%
[rank0]:2025-11-18 14:32:00,198 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:32:01,995 - INFO - Avg. fwd time: 16.3905 / Avg. bwd time: 27.5022 / Avg. batch time: 378.5143 (ms) / GPU bubble ratio: 7.23%
[rank2]:2025-11-18 14:32:02,009 - INFO - Avg. fwd time: 14.8369 / Avg. bwd time: 22.6365 / Avg. batch time: 416.9308 (ms) / GPU bubble ratio: 28.10%
[rank0]:2025-11-18 14:32:02,052 - INFO - Avg. fwd time: 14.6554 / Avg. bwd time: 17.8222 / Avg. batch time: 498.8340 (ms) / GPU bubble ratio: 47.91%
[rank1]:2025-11-18 14:32:02,034 - INFO - Avg. fwd time: 16.8710 / Avg. bwd time: 25.0895 / Avg. batch time: 457.1113 (ms) / GPU bubble ratio: 26.56%
[rank2]:2025-11-18 14:32:02,157 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1153  memory: 45.59GiB(32.61%)  tps: 8,220  tflops: 383.39  mfu: 38.77%
[rank1]:2025-11-18 14:32:02,133 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,221  tflops: 383.42  mfu: 38.77%
[rank3]:2025-11-18 14:32:02,181 - INFO -  step: 1100  loss:  0.2272  grad_norm:  0.1153  memory: 60.36GiB(43.17%)  tps: 8,222  tflops: 383.46  mfu: 38.77%
[rank2]:2025-11-18 14:32:02,238 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1432_stage2_step1100.svg
[rank0]:2025-11-18 14:32:02,190 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1153  memory: 65.70GiB(46.99%)  tps: 8,220  tflops: 383.40  mfu: 38.77%
[rank0]:2025-11-18 14:32:02,238 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1432_stage0_step1100.svg
[rank1]:2025-11-18 14:32:02,240 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1432_stage1_step1100.svg
[rank3]:2025-11-18 14:32:02,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1432_real_step1100_rank3.svg
[rank3]:> Batch Time: 474.09 ms, GPU Bubble Ratio: 53.29%, 33.68%, 40.46%, 29.76%
[rank3]:2025-11-18 14:32:02,368 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1432_stage3_step1100.svg
[rank0]:2025-11-18 14:33:38,717 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:33:40,531 - INFO - Avg. fwd time: 16.4110 / Avg. bwd time: 27.3506 / Avg. batch time: 377.5976 (ms) / GPU bubble ratio: 7.28%
[rank1]:2025-11-18 14:33:40,560 - INFO - Avg. fwd time: 16.8937 / Avg. bwd time: 24.9242 / Avg. batch time: 455.8834 (ms) / GPU bubble ratio: 26.62%
[rank2]:2025-11-18 14:33:40,545 - INFO - Avg. fwd time: 14.8550 / Avg. bwd time: 22.4998 / Avg. batch time: 415.8921 (ms) / GPU bubble ratio: 28.15%
[rank0]:2025-11-18 14:33:40,588 - INFO - Avg. fwd time: 14.6730 / Avg. bwd time: 17.5860 / Avg. batch time: 497.4848 (ms) / GPU bubble ratio: 48.12%
[rank1]:2025-11-18 14:33:40,671 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,313  tflops: 387.74  mfu: 39.21%
[rank2]:2025-11-18 14:33:40,693 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1217  memory: 45.59GiB(32.61%)  tps: 8,314  tflops: 387.75  mfu: 39.21%
[rank0]:2025-11-18 14:33:40,728 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1217  memory: 65.70GiB(46.99%)  tps: 8,314  tflops: 387.75  mfu: 39.21%
[rank3]:2025-11-18 14:33:40,730 - INFO -  step: 1150  loss:  0.2133  grad_norm:  0.1217  memory: 60.40GiB(43.20%)  tps: 8,313  tflops: 387.71  mfu: 39.20%
[rank0]:2025-11-18 14:35:17,028 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:35:18,930 - INFO - Avg. fwd time: 16.4281 / Avg. bwd time: 27.2144 / Avg. batch time: 376.7901 (ms) / GPU bubble ratio: 7.34%
[rank2]:2025-11-18 14:35:18,958 - INFO - Avg. fwd time: 14.8716 / Avg. bwd time: 22.3717 / Avg. batch time: 414.9350 (ms) / GPU bubble ratio: 28.19%
[rank1]:2025-11-18 14:35:18,986 - INFO - Avg. fwd time: 16.9138 / Avg. bwd time: 24.7748 / Avg. batch time: 454.7557 (ms) / GPU bubble ratio: 26.66%
[rank1]:2025-11-18 14:35:19,024 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,329  tflops: 388.48  mfu: 39.28%
[rank2]:2025-11-18 14:35:19,044 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.8026  memory: 45.59GiB(32.61%)  tps: 8,329  tflops: 388.48  mfu: 39.28%
[rank0]:2025-11-18 14:35:19,017 - INFO - Avg. fwd time: 14.6890 / Avg. bwd time: 17.3645 / Avg. batch time: 496.2466 (ms) / GPU bubble ratio: 48.33%
[rank0]:2025-11-18 14:35:19,083 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.8026  memory: 65.70GiB(46.99%)  tps: 8,329  tflops: 388.47  mfu: 39.28%
[rank3]:2025-11-18 14:35:19,083 - INFO -  step: 1200  loss:  0.2760  grad_norm:  0.8026  memory: 60.40GiB(43.20%)  tps: 8,329  tflops: 388.48  mfu: 39.28%
[rank1]:2025-11-18 14:35:19,134 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1435_stage1_step1200.svg
[rank0]:2025-11-18 14:35:19,132 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1435_stage0_step1200.svg
[rank2]:2025-11-18 14:35:19,133 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1435_stage2_step1200.svg
[rank3]:2025-11-18 14:35:19,220 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1435_real_step1200_rank3.svg
[rank3]:> Batch Time: 466.77 ms, GPU Bubble Ratio: 52.24%, 33.58%, 40.39%, 29.53%
[rank3]:2025-11-18 14:35:19,264 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1435_stage3_step1200.svg
[rank0]:2025-11-18 14:36:54,818 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:36:56,630 - INFO - Avg. fwd time: 16.4395 / Avg. bwd time: 27.1068 / Avg. batch time: 376.0978 (ms) / GPU bubble ratio: 7.37%
[rank0]:2025-11-18 14:36:56,686 - INFO - Avg. fwd time: 14.6996 / Avg. bwd time: 17.1933 / Avg. batch time: 495.2061 (ms) / GPU bubble ratio: 48.48%
[rank2]:2025-11-18 14:36:56,645 - INFO - Avg. fwd time: 14.8832 / Avg. bwd time: 22.2685 / Avg. batch time: 414.1305 (ms) / GPU bubble ratio: 28.23%
[rank1]:2025-11-18 14:36:56,659 - INFO - Avg. fwd time: 16.9289 / Avg. bwd time: 24.6557 / Avg. batch time: 453.8121 (ms) / GPU bubble ratio: 26.69%
[rank2]:2025-11-18 14:36:56,791 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0915  memory: 45.59GiB(32.61%)  tps: 8,381  tflops: 390.89  mfu: 39.52%
[rank1]:2025-11-18 14:36:56,770 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,381  tflops: 390.89  mfu: 39.52%
[rank3]:2025-11-18 14:36:56,830 - INFO -  step: 1250  loss:  0.2521  grad_norm:  0.0915  memory: 60.40GiB(43.20%)  tps: 8,381  tflops: 390.89  mfu: 39.52%
[rank0]:2025-11-18 14:36:56,826 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0915  memory: 65.70GiB(46.99%)  tps: 8,381  tflops: 390.90  mfu: 39.52%
[rank0]:2025-11-18 14:38:32,585 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:38:34,396 - INFO - Avg. fwd time: 16.4540 / Avg. bwd time: 26.9870 / Avg. batch time: 375.3775 (ms) / GPU bubble ratio: 7.42%
[rank1]:2025-11-18 14:38:34,425 - INFO - Avg. fwd time: 16.9445 / Avg. bwd time: 24.5287 / Avg. batch time: 452.8221 (ms) / GPU bubble ratio: 26.73%
[rank0]:2025-11-18 14:38:34,454 - INFO - Avg. fwd time: 14.7131 / Avg. bwd time: 16.9986 / Avg. batch time: 494.1050 (ms) / GPU bubble ratio: 48.66%
[rank2]:2025-11-18 14:38:34,410 - INFO - Avg. fwd time: 14.8963 / Avg. bwd time: 22.1600 / Avg. batch time: 413.2909 (ms) / GPU bubble ratio: 28.27%
[rank1]:2025-11-18 14:38:34,537 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,379  tflops: 390.80  mfu: 39.52%
[rank2]:2025-11-18 14:38:34,560 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1199  memory: 45.59GiB(32.61%)  tps: 8,379  tflops: 390.79  mfu: 39.51%
[rank3]:2025-11-18 14:38:34,598 - INFO -  step: 1300  loss:  0.1960  grad_norm:  0.1199  memory: 60.40GiB(43.20%)  tps: 8,379  tflops: 390.80  mfu: 39.52%
[rank0]:2025-11-18 14:38:34,592 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1199  memory: 65.70GiB(46.99%)  tps: 8,379  tflops: 390.81  mfu: 39.52%
[rank0]:2025-11-18 14:38:34,646 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1438_stage0_step1300.svg
[rank2]:2025-11-18 14:38:34,649 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1438_stage2_step1300.svg
[rank3]:2025-11-18 14:38:34,731 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1438_real_step1300_rank3.svg
[rank3]:> Batch Time: 465.73 ms, GPU Bubble Ratio: 52.53%, 33.85%, 41.00%, 30.00%
[rank1]:2025-11-18 14:38:34,647 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1438_stage1_step1300.svg
[rank3]:2025-11-18 14:38:34,774 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1438_stage3_step1300.svg
[rank0]:2025-11-18 14:40:11,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:40:13,746 - INFO - Avg. fwd time: 16.4723 / Avg. bwd time: 26.8892 / Avg. batch time: 374.8057 (ms) / GPU bubble ratio: 7.45%
[rank1]:2025-11-18 14:40:13,803 - INFO - Avg. fwd time: 16.9634 / Avg. bwd time: 24.4135 / Avg. batch time: 452.0464 (ms) / GPU bubble ratio: 26.77%
[rank2]:2025-11-18 14:40:13,776 - INFO - Avg. fwd time: 14.9119 / Avg. bwd time: 22.0654 / Avg. batch time: 412.6449 (ms) / GPU bubble ratio: 28.31%
[rank0]:2025-11-18 14:40:13,836 - INFO - Avg. fwd time: 14.7278 / Avg. bwd time: 16.8340 / Avg. batch time: 493.2539 (ms) / GPU bubble ratio: 48.81%
[rank3]:2025-11-18 14:40:13,904 - INFO -  step: 1350  loss:  0.1365  grad_norm:  0.0940  memory: 60.40GiB(43.20%)  tps: 8,249  tflops: 384.75  mfu: 38.90%
[rank1]:2025-11-18 14:40:13,844 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,249  tflops: 384.74  mfu: 38.90%
[rank2]:2025-11-18 14:40:13,866 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0940  memory: 45.59GiB(32.61%)  tps: 8,249  tflops: 384.75  mfu: 38.90%
[rank0]:2025-11-18 14:40:13,899 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0940  memory: 65.70GiB(46.99%)  tps: 8,249  tflops: 384.74  mfu: 38.90%
[rank0]:2025-11-18 14:41:49,709 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-18 14:41:51,577 - INFO - Avg. fwd time: 16.9731 / Avg. bwd time: 24.3212 / Avg. batch time: 451.3179 (ms) / GPU bubble ratio: 26.80%
[rank3]:2025-11-18 14:41:51,549 - INFO - Avg. fwd time: 16.4804 / Avg. bwd time: 26.8082 / Avg. batch time: 374.2933 (ms) / GPU bubble ratio: 7.48%
[rank2]:2025-11-18 14:41:51,562 - INFO - Avg. fwd time: 14.9200 / Avg. bwd time: 21.9852 / Avg. batch time: 412.0282 (ms) / GPU bubble ratio: 28.34%
[rank0]:2025-11-18 14:41:51,605 - INFO - Avg. fwd time: 14.7360 / Avg. bwd time: 16.6925 / Avg. batch time: 492.4307 (ms) / GPU bubble ratio: 48.94%
[rank1]:2025-11-18 14:41:51,690 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,372  tflops: 390.49  mfu: 39.48%
[rank2]:2025-11-18 14:41:51,711 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1068  memory: 45.59GiB(32.61%)  tps: 8,372  tflops: 390.49  mfu: 39.48%
[rank1]:2025-11-18 14:41:51,799 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1441_stage1_step1400.svg
[rank3]:2025-11-18 14:41:51,750 - INFO -  step: 1400  loss:  0.3734  grad_norm:  0.1068  memory: 60.44GiB(43.23%)  tps: 8,372  tflops: 390.49  mfu: 39.48%
[rank0]:2025-11-18 14:41:51,743 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1068  memory: 65.70GiB(46.99%)  tps: 8,373  tflops: 390.50  mfu: 39.48%
[rank0]:2025-11-18 14:41:51,800 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1441_stage0_step1400.svg
[rank2]:2025-11-18 14:41:51,799 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1441_stage2_step1400.svg
[rank3]:2025-11-18 14:41:51,889 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1441_real_step1400_rank3.svg
[rank3]:> Batch Time: 465.77 ms, GPU Bubble Ratio: 52.94%, 33.34%, 40.55%, 28.38%
[rank3]:2025-11-18 14:41:51,935 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1441_stage3_step1400.svg
[rank0]:2025-11-18 14:43:29,385 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:43:31,190 - INFO - Avg. fwd time: 16.5010 / Avg. bwd time: 26.7288 / Avg. batch time: 373.8849 (ms) / GPU bubble ratio: 7.50%
[rank2]:2025-11-18 14:43:31,206 - INFO - Avg. fwd time: 14.9377 / Avg. bwd time: 21.9015 / Avg. batch time: 411.5407 (ms) / GPU bubble ratio: 28.39%
[rank1]:2025-11-18 14:43:31,218 - INFO - Avg. fwd time: 16.9935 / Avg. bwd time: 24.2264 / Avg. batch time: 450.7216 (ms) / GPU bubble ratio: 26.84%
[rank0]:2025-11-18 14:43:31,248 - INFO - Avg. fwd time: 14.7516 / Avg. bwd time: 16.5414 / Avg. batch time: 491.7436 (ms) / GPU bubble ratio: 49.09%
[rank1]:2025-11-18 14:43:31,328 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,222  tflops: 383.46  mfu: 38.77%
[rank3]:2025-11-18 14:43:31,387 - INFO -  step: 1450  loss:  0.1861  grad_norm:  0.1442  memory: 60.44GiB(43.23%)  tps: 8,222  tflops: 383.47  mfu: 38.77%
[rank2]:2025-11-18 14:43:31,352 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1442  memory: 45.59GiB(32.61%)  tps: 8,222  tflops: 383.46  mfu: 38.77%
[rank0]:2025-11-18 14:43:31,375 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1442  memory: 65.70GiB(46.99%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank0]:2025-11-18 14:45:09,333 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:45:11,285 - INFO - Avg. fwd time: 16.5219 / Avg. bwd time: 26.6583 / Avg. batch time: 373.5230 (ms) / GPU bubble ratio: 7.52%
[rank1]:2025-11-18 14:45:11,345 - INFO - Avg. fwd time: 17.0136 / Avg. bwd time: 24.1372 / Avg. batch time: 450.1904 (ms) / GPU bubble ratio: 26.87%
[rank2]:2025-11-18 14:45:11,316 - INFO - Avg. fwd time: 14.9547 / Avg. bwd time: 21.8274 / Avg. batch time: 411.1070 (ms) / GPU bubble ratio: 28.42%
[rank0]:2025-11-18 14:45:11,378 - INFO - Avg. fwd time: 14.7676 / Avg. bwd time: 16.3999 / Avg. batch time: 491.1622 (ms) / GPU bubble ratio: 49.23%
[rank3]:2025-11-18 14:45:11,443 - INFO -  step: 1500  loss:  0.2864  grad_norm:  0.1459  memory: 60.44GiB(43.23%)  tps: 8,188  tflops: 381.87  mfu: 38.61%
[rank1]:2025-11-18 14:45:11,384 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,187  tflops: 381.86  mfu: 38.61%
[rank2]:2025-11-18 14:45:11,404 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1459  memory: 45.59GiB(32.61%)  tps: 8,188  tflops: 381.88  mfu: 38.61%
[rank2]:2025-11-18 14:45:11,496 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1445_stage2_step1500.svg
[rank0]:2025-11-18 14:45:11,430 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1459  memory: 65.70GiB(46.99%)  tps: 8,187  tflops: 381.86  mfu: 38.61%
[rank0]:2025-11-18 14:45:11,493 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1445_stage0_step1500.svg
[rank1]:2025-11-18 14:45:11,494 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1445_stage1_step1500.svg
[rank3]:2025-11-18 14:45:11,578 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1445_real_step1500_rank3.svg
[rank3]:> Batch Time: 475.25 ms, GPU Bubble Ratio: 52.86%, 33.71%, 40.36%, 28.73%
[rank3]:2025-11-18 14:45:11,623 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1445_stage3_step1500.svg
[rank0]:2025-11-18 14:46:49,575 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:46:51,432 - INFO - Avg. fwd time: 16.5397 / Avg. bwd time: 26.5958 / Avg. batch time: 373.2247 (ms) / GPU bubble ratio: 7.54%
[rank2]:2025-11-18 14:46:51,447 - INFO - Avg. fwd time: 14.9691 / Avg. bwd time: 21.7662 / Avg. batch time: 410.7492 (ms) / GPU bubble ratio: 28.45%
[rank1]:2025-11-18 14:46:51,463 - INFO - Avg. fwd time: 17.0301 / Avg. bwd time: 24.0642 / Avg. batch time: 449.7539 (ms) / GPU bubble ratio: 26.90%
[rank0]:2025-11-18 14:46:51,491 - INFO - Avg. fwd time: 14.7803 / Avg. bwd time: 16.2960 / Avg. batch time: 490.6862 (ms) / GPU bubble ratio: 49.33%
[rank1]:2025-11-18 14:46:51,575 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,176  tflops: 381.35  mfu: 38.56%
[rank3]:2025-11-18 14:46:51,636 - INFO -  step: 1550  loss:  0.2724  grad_norm:  0.1491  memory: 60.44GiB(43.23%)  tps: 8,176  tflops: 381.35  mfu: 38.56%
[rank0]:2025-11-18 14:46:51,636 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1491  memory: 65.70GiB(46.99%)  tps: 8,175  tflops: 381.29  mfu: 38.55%
[rank2]:2025-11-18 14:46:51,597 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1491  memory: 45.59GiB(32.61%)  tps: 8,176  tflops: 381.34  mfu: 38.56%
[rank0]:2025-11-18 14:48:28,864 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-18 14:48:30,738 - INFO - Avg. fwd time: 17.0440 / Avg. bwd time: 23.9835 / Avg. batch time: 449.1931 (ms) / GPU bubble ratio: 26.93%
[rank3]:2025-11-18 14:48:30,710 - INFO - Avg. fwd time: 16.5537 / Avg. bwd time: 26.5206 / Avg. batch time: 372.8191 (ms) / GPU bubble ratio: 7.57%
[rank2]:2025-11-18 14:48:30,723 - INFO - Avg. fwd time: 14.9804 / Avg. bwd time: 21.6982 / Avg. batch time: 410.2820 (ms) / GPU bubble ratio: 28.48%
[rank0]:2025-11-18 14:48:30,768 - INFO - Avg. fwd time: 14.7911 / Avg. bwd time: 16.1719 / Avg. batch time: 490.0650 (ms) / GPU bubble ratio: 49.45%
[rank1]:2025-11-18 14:48:30,848 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,252  tflops: 384.87  mfu: 38.92%
[rank3]:2025-11-18 14:48:30,908 - INFO -  step: 1600  loss:  0.3891  grad_norm:  0.1616  memory: 60.44GiB(43.23%)  tps: 8,252  tflops: 384.88  mfu: 38.92%
[rank2]:2025-11-18 14:48:30,870 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1616  memory: 45.59GiB(32.61%)  tps: 8,252  tflops: 384.88  mfu: 38.92%
[rank2]:2025-11-18 14:48:30,960 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1448_stage2_step1600.svg
[rank0]:2025-11-18 14:48:30,905 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1616  memory: 65.70GiB(46.99%)  tps: 8,252  tflops: 384.89  mfu: 38.92%
[rank0]:2025-11-18 14:48:30,959 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1448_stage0_step1600.svg
[rank3]:2025-11-18 14:48:31,042 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1448_real_step1600_rank3.svg
[rank3]:> Batch Time: 472.81 ms, GPU Bubble Ratio: 53.25%, 33.87%, 40.67%, 29.74%
[rank1]:2025-11-18 14:48:30,960 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1448_stage1_step1600.svg
[rank3]:2025-11-18 14:48:31,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1448_stage3_step1600.svg
[rank0]:2025-11-18 14:50:08,354 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:50:10,279 - INFO - Avg. fwd time: 16.5691 / Avg. bwd time: 26.4548 / Avg. batch time: 372.4815 (ms) / GPU bubble ratio: 7.60%
[rank2]:2025-11-18 14:50:10,310 - INFO - Avg. fwd time: 14.9935 / Avg. bwd time: 21.6353 / Avg. batch time: 409.8774 (ms) / GPU bubble ratio: 28.51%
[rank1]:2025-11-18 14:50:10,340 - INFO - Avg. fwd time: 17.0586 / Avg. bwd time: 23.9076 / Avg. batch time: 448.7050 (ms) / GPU bubble ratio: 26.96%
[rank1]:2025-11-18 14:50:10,380 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,231  tflops: 383.87  mfu: 38.81%
[rank0]:2025-11-18 14:50:10,374 - INFO - Avg. fwd time: 14.8029 / Avg. bwd time: 16.0557 / Avg. batch time: 489.5221 (ms) / GPU bubble ratio: 49.57%
[rank0]:2025-11-18 14:50:10,425 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.2145  memory: 65.70GiB(46.99%)  tps: 8,232  tflops: 383.92  mfu: 38.82%
[rank2]:2025-11-18 14:50:10,400 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.2145  memory: 45.59GiB(32.61%)  tps: 8,231  tflops: 383.88  mfu: 38.81%
[rank3]:2025-11-18 14:50:10,438 - INFO -  step: 1650  loss:  0.4059  grad_norm:  0.2145  memory: 60.44GiB(43.23%)  tps: 8,231  tflops: 383.88  mfu: 38.82%
[rank0]:2025-11-18 14:51:48,101 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-18 14:51:49,974 - INFO - Avg. fwd time: 17.0706 / Avg. bwd time: 23.8459 / Avg. batch time: 448.3132 (ms) / GPU bubble ratio: 26.99%
[rank3]:2025-11-18 14:51:49,945 - INFO - Avg. fwd time: 16.5814 / Avg. bwd time: 26.4044 / Avg. batch time: 372.2138 (ms) / GPU bubble ratio: 7.61%
[rank0]:2025-11-18 14:51:50,000 - INFO - Avg. fwd time: 14.8119 / Avg. bwd time: 15.9703 / Avg. batch time: 489.0792 (ms) / GPU bubble ratio: 49.65%
[rank2]:2025-11-18 14:51:49,961 - INFO - Avg. fwd time: 15.0036 / Avg. bwd time: 21.5863 / Avg. batch time: 409.5542 (ms) / GPU bubble ratio: 28.53%
[rank1]:2025-11-18 14:51:50,081 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,217  tflops: 383.22  mfu: 38.75%
[rank2]:2025-11-18 14:51:50,106 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2146  memory: 45.59GiB(32.61%)  tps: 8,216  tflops: 383.21  mfu: 38.75%
[rank3]:2025-11-18 14:51:50,140 - INFO -  step: 1700  loss:  0.4060  grad_norm:  0.2146  memory: 60.44GiB(43.23%)  tps: 8,217  tflops: 383.22  mfu: 38.75%
[rank1]:2025-11-18 14:51:50,191 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1451_stage1_step1700.svg
[rank0]:2025-11-18 14:51:50,140 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2146  memory: 65.70GiB(46.99%)  tps: 8,215  tflops: 383.17  mfu: 38.74%
[rank0]:2025-11-18 14:51:50,191 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1451_stage0_step1700.svg
[rank2]:2025-11-18 14:51:50,192 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1451_stage2_step1700.svg
[rank3]:2025-11-18 14:51:50,276 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1451_real_step1700_rank3.svg
[rank3]:> Batch Time: 472.03 ms, GPU Bubble Ratio: 52.61%, 33.75%, 40.35%, 29.16%
[rank3]:2025-11-18 14:51:50,322 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1451_stage3_step1700.svg
[rank0]:2025-11-18 14:53:27,563 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-18 14:53:29,439 - INFO - Avg. fwd time: 17.0832 / Avg. bwd time: 23.7792 / Avg. batch time: 447.8380 (ms) / GPU bubble ratio: 27.00%
[rank0]:2025-11-18 14:53:29,466 - INFO - Avg. fwd time: 14.8212 / Avg. bwd time: 15.8778 / Avg. batch time: 488.5511 (ms) / GPU bubble ratio: 49.73%
[rank3]:2025-11-18 14:53:29,410 - INFO - Avg. fwd time: 16.5948 / Avg. bwd time: 26.3421 / Avg. batch time: 371.8802 (ms) / GPU bubble ratio: 7.63%
[rank2]:2025-11-18 14:53:29,422 - INFO - Avg. fwd time: 15.0147 / Avg. bwd time: 21.5253 / Avg. batch time: 409.1546 (ms) / GPU bubble ratio: 28.56%
[rank1]:2025-11-18 14:53:29,546 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank0]:2025-11-18 14:53:29,600 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.7924  memory: 65.70GiB(46.99%)  tps: 8,237  tflops: 384.15  mfu: 38.84%
[rank2]:2025-11-18 14:53:29,563 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.7924  memory: 45.59GiB(32.61%)  tps: 8,237  tflops: 384.16  mfu: 38.84%
[rank3]:2025-11-18 14:53:29,608 - INFO -  step: 1750  loss:  0.4180  grad_norm:  0.7924  memory: 60.44GiB(43.23%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank0]:2025-11-18 14:55:05,247 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:55:07,090 - INFO - Avg. fwd time: 16.5972 / Avg. bwd time: 26.2782 / Avg. batch time: 371.4739 (ms) / GPU bubble ratio: 7.66%
[rank1]:2025-11-18 14:55:07,151 - INFO - Avg. fwd time: 17.0871 / Avg. bwd time: 23.7121 / Avg. batch time: 447.2688 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-11-18 14:55:07,196 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,389  tflops: 391.28  mfu: 39.56%
[rank2]:2025-11-18 14:55:07,121 - INFO - Avg. fwd time: 15.0180 / Avg. bwd time: 21.4688 / Avg. batch time: 408.6664 (ms) / GPU bubble ratio: 28.57%
[rank0]:2025-11-18 14:55:07,187 - INFO - Avg. fwd time: 14.8244 / Avg. bwd time: 15.7806 / Avg. batch time: 487.9229 (ms) / GPU bubble ratio: 49.82%
[rank0]:2025-11-18 14:55:07,259 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0741  memory: 65.70GiB(46.99%)  tps: 8,388  tflops: 391.24  mfu: 39.56%
[rank3]:2025-11-18 14:55:07,256 - INFO -  step: 1800  loss:  0.0777  grad_norm:  0.0741  memory: 60.44GiB(43.23%)  tps: 8,389  tflops: 391.29  mfu: 39.56%
[rank2]:2025-11-18 14:55:07,218 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0741  memory: 45.59GiB(32.61%)  tps: 8,389  tflops: 391.26  mfu: 39.56%
[rank0]:2025-11-18 14:55:07,309 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1455_stage0_step1800.svg
[rank1]:2025-11-18 14:55:07,311 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1455_stage1_step1800.svg
[rank2]:2025-11-18 14:55:07,308 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1455_stage2_step1800.svg
[rank3]:2025-11-18 14:55:07,395 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1455_real_step1800_rank3.svg
[rank3]:> Batch Time: 458.47 ms, GPU Bubble Ratio: 52.16%, 33.63%, 40.71%, 30.22%
[rank3]:2025-11-18 14:55:07,441 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1455_stage3_step1800.svg
[rank0]:2025-11-18 14:56:42,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-18 14:56:44,678 - INFO - Avg. fwd time: 15.0199 / Avg. bwd time: 21.4182 / Avg. batch time: 408.2555 (ms) / GPU bubble ratio: 28.60%
[rank3]:2025-11-18 14:56:44,666 - INFO - Avg. fwd time: 16.5977 / Avg. bwd time: 26.2287 / Avg. batch time: 371.1044 (ms) / GPU bubble ratio: 7.68%
[rank0]:2025-11-18 14:56:44,721 - INFO - Avg. fwd time: 14.8264 / Avg. bwd time: 15.7062 / Avg. batch time: 487.4089 (ms) / GPU bubble ratio: 49.89%
[rank1]:2025-11-18 14:56:44,694 - INFO - Avg. fwd time: 17.0898 / Avg. bwd time: 23.6569 / Avg. batch time: 446.7897 (ms) / GPU bubble ratio: 27.04%
[rank1]:2025-11-18 14:56:44,803 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,393  tflops: 391.44  mfu: 39.58%
[rank2]:2025-11-18 14:56:44,821 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2594  memory: 45.59GiB(32.61%)  tps: 8,393  tflops: 391.46  mfu: 39.58%
[rank3]:2025-11-18 14:56:44,863 - INFO -  step: 1850  loss:  0.3582  grad_norm:  0.2594  memory: 60.44GiB(43.23%)  tps: 8,393  tflops: 391.45  mfu: 39.58%
[rank0]:2025-11-18 14:56:44,866 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2594  memory: 65.70GiB(46.99%)  tps: 8,393  tflops: 391.44  mfu: 39.58%
[rank0]:2025-11-18 14:58:19,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:58:21,390 - INFO - Avg. fwd time: 16.5957 / Avg. bwd time: 26.1683 / Avg. batch time: 370.6501 (ms) / GPU bubble ratio: 7.70%
[rank1]:2025-11-18 14:58:21,419 - INFO - Avg. fwd time: 17.0905 / Avg. bwd time: 23.5904 / Avg. batch time: 446.1965 (ms) / GPU bubble ratio: 27.06%
[rank2]:2025-11-18 14:58:21,405 - INFO - Avg. fwd time: 15.0193 / Avg. bwd time: 21.3666 / Avg. batch time: 407.7417 (ms) / GPU bubble ratio: 28.61%
[rank0]:2025-11-18 14:58:21,448 - INFO - Avg. fwd time: 14.8263 / Avg. bwd time: 15.6215 / Avg. batch time: 486.7695 (ms) / GPU bubble ratio: 49.96%
[rank1]:2025-11-18 14:58:21,526 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,470  tflops: 395.02  mfu: 39.94%
[rank2]:2025-11-18 14:58:21,546 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1792  memory: 45.59GiB(32.61%)  tps: 8,469  tflops: 395.01  mfu: 39.94%
[rank3]:2025-11-18 14:58:21,586 - INFO -  step: 1900  loss:  0.2037  grad_norm:  0.1792  memory: 60.44GiB(43.23%)  tps: 8,470  tflops: 395.03  mfu: 39.94%
[rank0]:2025-11-18 14:58:21,583 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1792  memory: 65.70GiB(46.99%)  tps: 8,470  tflops: 395.05  mfu: 39.94%
[rank0]:2025-11-18 14:58:21,636 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1458_stage0_step1900.svg
[rank1]:2025-11-18 14:58:21,636 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1458_stage1_step1900.svg
[rank2]:2025-11-18 14:58:21,638 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1458_stage2_step1900.svg
[rank3]:2025-11-18 14:58:21,721 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1458_real_step1900_rank3.svg
[rank3]:> Batch Time: 462.94 ms, GPU Bubble Ratio: 52.00%, 33.95%, 40.86%, 30.38%
[rank3]:2025-11-18 14:58:21,767 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1458_stage3_step1900.svg
[rank0]:2025-11-18 14:59:55,680 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-18 14:59:57,536 - INFO - Avg. fwd time: 16.5923 / Avg. bwd time: 26.1079 / Avg. batch time: 370.1928 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-11-18 14:59:57,569 - INFO - Avg. fwd time: 15.0176 / Avg. bwd time: 21.3168 / Avg. batch time: 407.2369 (ms) / GPU bubble ratio: 28.62%
[rank1]:2025-11-18 14:59:57,602 - INFO - Avg. fwd time: 17.0902 / Avg. bwd time: 23.5271 / Avg. batch time: 445.6162 (ms) / GPU bubble ratio: 27.08%
[rank1]:2025-11-18 14:59:57,642 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,523  tflops: 397.52  mfu: 40.19%
[rank0]:2025-11-18 14:59:57,636 - INFO - Avg. fwd time: 14.8255 / Avg. bwd time: 15.5388 / Avg. batch time: 486.1423 (ms) / GPU bubble ratio: 50.03%
[rank0]:2025-11-18 14:59:57,688 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0838  memory: 65.70GiB(46.99%)  tps: 8,524  tflops: 397.56  mfu: 40.20%
[rank3]:2025-11-18 14:59:57,703 - INFO -  step: 1950  loss:  0.1733  grad_norm:  0.0838  memory: 60.44GiB(43.23%)  tps: 8,523  tflops: 397.52  mfu: 40.19%
[rank2]:2025-11-18 14:59:57,663 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0838  memory: 45.59GiB(32.61%)  tps: 8,523  tflops: 397.51  mfu: 40.19%
[rank0]:2025-11-18 15:01:31,755 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-18 15:01:33,589 - INFO - Avg. fwd time: 14.8246 / Avg. bwd time: 15.4718 / Avg. batch time: 485.5985 (ms) / GPU bubble ratio: 50.09%
[rank3]:2025-11-18 15:01:33,533 - INFO - Avg. fwd time: 16.5902 / Avg. bwd time: 26.0542 / Avg. batch time: 369.8172 (ms) / GPU bubble ratio: 7.75%
[rank2]:2025-11-18 15:01:33,548 - INFO - Avg. fwd time: 15.0167 / Avg. bwd time: 21.2743 / Avg. batch time: 406.8044 (ms) / GPU bubble ratio: 28.63%
[rank1]:2025-11-18 15:01:33,560 - INFO - Avg. fwd time: 17.0896 / Avg. bwd time: 23.4781 / Avg. batch time: 445.1210 (ms) / GPU bubble ratio: 27.09%
[rank2]:2025-11-18 15:01:33,684 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1064  memory: 45.59GiB(32.61%)  tps: 8,531  tflops: 397.91  mfu: 40.23%
[rank2]:2025-11-18 15:01:33,684 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.1064  tps: 8,198  tflops: 382.34  mfu: 37.30%
[rank2]:2025-11-18 15:01:33,684 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-18 15:01:33,689 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-18 15:01:33,666 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 56.52GiB(40.42%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank1]:2025-11-18 15:01:33,666 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 8,197  tflops: 382.33  mfu: 37.30%
[rank1]:2025-11-18 15:01:33,666 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-18 15:01:33,669 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-18 15:01:33,723 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1064  memory: 65.70GiB(46.99%)  tps: 8,530  tflops: 397.85  mfu: 40.23%
[rank0]:2025-11-18 15:01:33,723 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.1064  tps: 8,198  tflops: 382.34  mfu: 37.30%
[rank0]:2025-11-18 15:01:33,723 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-18 15:01:33,731 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-18 15:01:33,728 - INFO -  step: 2000  loss:  0.2087  grad_norm:  0.1064  memory: 60.55GiB(43.31%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank3]:2025-11-18 15:01:33,728 - INFO -  final step: 2000  loss:  0.2087  grad_norm:  0.1064  tps: 8,201  tflops: 382.49  mfu: 37.31%
[rank3]:2025-11-18 15:01:33,728 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-18 15:01:33,733 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-18 15:01:43,722 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-18 15:01:43,795 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank0/251118_1501_stage0_final2000.svg
[rank2]:2025-11-18 15:01:43,797 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank2/251118_1501_stage2_final2000.svg
[rank1]:2025-11-18 15:01:43,796 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank1/251118_1501_stage1_final2000.svg
[rank3]:2025-11-18 15:01:43,882 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1501_real_final2000_rank3.svg
[rank3]:> Batch Time: 470.12 ms, GPU Bubble Ratio: 52.69%, 33.87%, 40.62%, 29.91%
[rank0]:2025-11-18 15:01:43,975 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/frozen_params_histogram/251118_1501_rank0_stage0.svg
[rank0]:	> Counts Sum: 2411640, Total Sum: 4274880 (56.41%), Ratio(%) per element: [47.74, 47.26, 49.04, 47.95, 47.6, 46.17, 49.24, 45.56, 86.06, 86.47, 45.69, 47.4, 45.96, 47.4, 47.33, 47.26, 48.29, 86.47, 86.81, 48.9, 48.29, 49.72, 48.01, 49.93, 45.96, 48.22, 86.88, 86.95, 46.58, 49.04, 48.63, 48.83, 46.72, 49.04, 47.4, 87.02, 86.95, 48.97, 47.81, 48.15, 49.38, 49.18, 47.67, 47.54, 86.4, 86.61, 45.69, 48.56, 48.9, 49.59, 47.4, 48.22, 47.81, 87.02, 87.29, 48.7, 48.29, 48.29, 48.83, 48.36, 47.88, 47.88, 87.15, 86.54, 47.54, 46.92, 47.47, 46.51, 48.29, 46.31, 48.42, 86.95, 86.61]
[rank0]:2025-11-18 15:01:43,976 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-11-18 15:01:43,978 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/frozen_params_histogram/251118_1501_rank2_stage2.svg
[rank2]:	> Counts Sum: 1323560, Total Sum: 4216320 (31.39%), Ratio(%) per element: [27.93, 28.07, 26.77, 28.96, 27.39, 27.18, 28.07, 44.26, 43.37, 27.73, 27.8, 28.07, 28.75, 26.77, 27.39, 28.48, 44.46, 44.39, 27.04, 28.0, 28.21, 27.45, 27.86, 27.66, 27.93, 42.89, 43.1, 27.45, 26.84, 26.5, 26.5, 26.98, 28.68, 27.86, 42.96, 43.92, 27.93, 29.37, 27.04, 27.25, 27.25, 27.25, 28.14, 42.75, 44.46, 27.32, 28.0, 27.66, 27.39, 28.21, 27.39, 28.21, 44.33, 45.28, 28.21, 28.27, 27.52, 28.27, 27.04, 28.55, 28.75, 44.87, 44.6, 28.27, 29.09, 28.62, 28.62, 27.86, 27.66, 28.27, 42.89, 43.57]
[rank2]:2025-11-18 15:01:43,978 - INFO - Destroying the purge thread.
[rank1]:2025-11-18 15:01:43,987 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/frozen_params_histogram/251118_1501_rank1_stage1.svg
[rank1]:	> Counts Sum: 1499080, Total Sum: 4743360 (31.60%), Ratio(%) per element: [30.87, 30.53, 31.35, 31.01, 30.05, 30.6, 31.55, 33.19, 33.53, 32.3, 31.07, 31.69, 31.21, 30.73, 31.42, 31.76, 33.26, 32.51, 31.83, 30.66, 30.94, 30.87, 31.62, 30.32, 32.03, 32.17, 32.44, 31.48, 31.28, 31.62, 31.76, 31.07, 30.73, 31.28, 34.35, 33.74, 31.62, 31.89, 31.83, 31.62, 31.96, 32.44, 30.8, 33.6, 32.58, 30.53, 30.6, 31.01, 30.94, 30.66, 31.28, 30.94, 33.06, 33.87, 31.35, 31.35, 31.21, 30.73, 31.28, 31.83, 31.35, 32.71, 32.65, 30.87, 30.94, 31.55, 30.05, 31.48, 31.69, 30.87, 33.19, 32.71, 31.55, 29.98, 31.21, 31.14, 31.21, 30.53, 30.87, 33.06, 32.1]
[rank1]:2025-11-18 15:01:43,987 - INFO - Destroying the purge thread.
[rank3]:2025-11-18 15:01:44,021 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/pipeline_schedule/251118_1501_thry_final2000_rank3.svg
[rank3]:> Batch Time: 529.72 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-18 15:01:44,068 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/freeze_ratio_history/rank3/251118_1501_stage3_final2000.svg
[rank3]:2025-11-18 15:01:44,237 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200/frozen_params_histogram/251118_1501_rank3_stage3.svg
[rank3]:	> Counts Sum: 1193200, Total Sum: 3806400 (31.35%), Ratio(%) per element: [27.93, 28.07, 29.16, 28.21, 28.96, 28.0, 28.55, 41.25, 41.32, 27.86, 27.45, 27.86, 28.62, 28.21, 27.73, 28.55, 41.39, 41.53, 28.41, 28.27, 28.68, 28.82, 28.27, 28.82, 28.75, 41.32, 40.77, 28.68, 29.16, 27.32, 28.0, 29.16, 28.55, 28.55, 40.98, 41.53, 28.75, 28.41, 28.27, 28.48, 29.43, 28.14, 27.66, 41.32, 41.05, 28.89, 27.8, 28.0, 28.48, 28.41, 27.93, 28.75, 41.18, 40.91, 28.75, 28.48, 27.25, 29.23, 28.14, 28.48, 28.0, 41.25, 40.84, 41.25, 29.03]
[rank3]:2025-11-18 15:01:44,238 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–…â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.99783
[rank3]:wandb:               final/avg_loss 0.20866
[rank3]:wandb:             final/avg_mfu(%) 37.31241
[rank3]:wandb:             final/avg_tflops 382.49213
[rank3]:wandb:    final/avg_throughput(tps) 8200.91791
[rank3]:wandb:              final/grad_norm 0.10639
[rank3]:wandb:               final/max_loss 0.20866
[rank3]:wandb:                    grad_norm 0.10639
[rank3]:wandb: loss_metrics/global_avg_loss 0.20866
[rank3]:wandb: loss_metrics/global_max_loss 0.20866
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1109_1F1B_timelyapf_th3e-3_h200 at: https://wandb.ai/orangingq/torchtitan/runs/byp19gtd
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1109_1F1B_timelyapf_th3e-3_h200/20251118-1353/wandb/run-20251118_135316-byp19gtd/logs
[rank0]:2025-11-18 15:01:45,976 - INFO - Training completed
[rank0]:2025-11-18 15:01:45,976 - INFO - Destroying the purge thread.
[rank1]:2025-11-18 15:01:46,242 - INFO - Process group destroyed
[rank3]:2025-11-18 15:01:46,234 - INFO - Process group destroyed
[rank2]:2025-11-18 15:01:46,269 - INFO - Process group destroyed
[rank0]:2025-11-18 15:01:46,318 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.20', 'layers.24', 'layers.23', 'layers.17', 'layers.18', 'layers.22', 'layers.19', 'layers.21'}
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.9', 'layers.13', 'layers.8', 'layers.12', 'layers.14', 'layers.11', 'layers.15', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'tok_embeddings', 'layers.3', 'layers.7', 'layers.1', 'layers.4', 'layers.5', 'layers.2', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.27', 'layers.26', 'layers.28', 'layers.31', 'layers.29', 'layers.25', 'norm', 'layers.30'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1109.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1109_1F1B_timelyapf_th3e-3_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1109_1F1B_timelyapf_th3e-3_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.003
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
