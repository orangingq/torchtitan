
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov 16 02:48:26 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1116_Interleaved1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11

âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1116.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1116 02:48:27.629000 3324038 site-packages/torch/distributed/run.py:811] 
W1116 02:48:27.629000 3324038 site-packages/torch/distributed/run.py:811] *****************************************
W1116 02:48:27.629000 3324038 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1116 02:48:27.629000 3324038 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-11-16 02:48:34,706 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank0]:2025-11-16 02:48:34,768 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:1116: everything same, but with seed=11
[rank0]:"
[rank1]:2025-11-16 02:48:34,801 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:1116: everything same, but with seed=11
[rank1]:"
[rank2]:2025-11-16 02:48:35,003 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:1116: everything same, but with seed=11
[rank2]:"
[rank3]:2025-11-16 02:48:35,472 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-16 02:48:35,474 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 02:48:35,560 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-16 02:48:35,562 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 02:48:35,566 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-16 02:48:35,568 - INFO - Loading tokenizer from tokenizer.json
[rank1]:2025-11-16 02:48:35,610 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-16 02:48:35,612 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-16 02:48:35,674 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-16 02:48:35,677 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-16 02:48:35,860 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-16 02:48:37,965 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-16 02:48:37,959 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-16 02:48:37,976 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-16 02:48:38,045 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-16 02:48:38,066 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank1]:2025-11-16 02:48:38,067 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-11-16 02:48:38,062 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-16 02:48:38,090 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28']
[rank2]:2025-11-16 02:48:38,092 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-16 02:48:38,214 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-16 02:48:38,268 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-16 02:48:38,291 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-11-16 02:48:38,315 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20']
[rank0]:2025-11-16 02:48:38,317 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-16 02:48:38,345 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-16 02:48:38,345 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-16 02:48:38,353 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-16 02:48:38,353 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-16 02:48:38,553 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-16 02:48:38,554 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run uvfvnshg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1116_Interleaved1F1B_nofreeze_h200/20251116-0248/wandb/run-20251116_024838-uvfvnshg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1116_Interleaved1F1B_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/uvfvnshg
[rank3]:2025-11-16 02:48:39,950 - INFO - WandB logging enabled
[rank3]:2025-11-16 02:48:39,951 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-16 02:48:40,024 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank3]:2025-11-16 02:48:40,045 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-16 02:48:40,047 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-16 02:48:40,295 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1116_Interleaved1F1B_nofreeze_h200
[rank0]:2025-11-16 02:48:40,296 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-16 02:48:40,296 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-16 02:48:40,296 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank2]:2025-11-16 02:48:40,296 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-16 02:48:40,296 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-16 02:48:40,281 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-16 02:48:40,282 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-16 02:48:40,295 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-16 02:48:50,743 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-16 02:48:50,744 - INFO - Finished loading the checkpoint in 10.45 seconds.
[rank0]:2025-11-16 02:48:50,744 - INFO - Training starts at step 1
[rank2]:2025-11-16 02:48:54,944 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 30.42GiB(21.76%)  tps: 969  tflops: 45.20  mfu: 4.57%
[rank2]:2025-11-16 02:48:54,944 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-16 02:48:54,946 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 38.71GiB(27.69%)  tps: 968  tflops: 45.15  mfu: 4.57%
[rank1]:2025-11-16 02:48:54,946 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-16 02:48:54,948 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 36.75GiB(26.28%)  tps: 1,096  tflops: 51.12  mfu: 5.17%
[rank3]:2025-11-16 02:48:54,949 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-16 02:48:54,965 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 42.48GiB(30.38%)  tps: 981  tflops: 45.76  mfu: 4.63%
[rank0]:2025-11-16 02:48:54,965 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-16 02:51:05,575 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 02:51:08,154 - INFO - Avg. fwd time: 7.9114 / Avg. bwd time: 18.0752 / Avg. batch time: 588.2042 (ms) / GPU bubble ratio: 29.31%
[rank3]:2025-11-16 02:51:08,133 - INFO - Avg. fwd time: 7.6176 / Avg. bwd time: 22.2912 / Avg. batch time: 554.6235 (ms) / GPU bubble ratio: 13.72%
[rank0]:2025-11-16 02:51:08,195 - INFO - Avg. fwd time: 8.2744 / Avg. bwd time: 19.7561 / Avg. batch time: 658.7389 (ms) / GPU bubble ratio: 31.92%
[rank1]:2025-11-16 02:51:08,200 - INFO - Avg. fwd time: 8.1315 / Avg. bwd time: 20.4237 / Avg. batch time: 630.0987 (ms) / GPU bubble ratio: 27.49%
[rank0]:2025-11-16 02:51:08,321 - INFO -  step: 50  loss: -4.0000  grad_norm: 5113.7065  memory: 59.45GiB(42.52%)  tps: 6,020  tflops: 280.78  mfu: 28.39%
[rank1]:2025-11-16 02:51:08,317 - INFO -  step: 50  loss: -4.0000  grad_norm: 5113.7065  memory: 53.38GiB(38.18%)  tps: 6,019  tflops: 280.75  mfu: 28.39%
[rank2]:2025-11-16 02:51:08,314 - INFO -  step: 50  loss: -4.0000  grad_norm: 5113.7065  memory: 43.49GiB(31.10%)  tps: 6,019  tflops: 280.75  mfu: 28.39%
[rank3]:2025-11-16 02:51:08,318 - INFO -  step: 50  loss:  9.4325  grad_norm: 5113.7065  memory: 51.83GiB(37.07%)  tps: 6,020  tflops: 280.75  mfu: 28.39%
[rank0]:2025-11-16 02:53:22,251 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 02:53:24,841 - INFO - Avg. fwd time: 7.9081 / Avg. bwd time: 18.1193 / Avg. batch time: 589.4053 (ms) / GPU bubble ratio: 29.35%
[rank3]:2025-11-16 02:53:24,820 - INFO - Avg. fwd time: 7.6315 / Avg. bwd time: 22.4129 / Avg. batch time: 556.2008 (ms) / GPU bubble ratio: 13.57%
[rank1]:2025-11-16 02:53:24,887 - INFO - Avg. fwd time: 8.1154 / Avg. bwd time: 20.4562 / Avg. batch time: 631.2692 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-16 02:53:24,882 - INFO - Avg. fwd time: 8.2235 / Avg. bwd time: 19.8482 / Avg. batch time: 659.9648 (ms) / GPU bubble ratio: 31.94%
[rank1]:2025-11-16 02:53:25,004 - INFO -  step: 100  loss: -4.0000  grad_norm: 97.0393  memory: 53.38GiB(38.18%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank0]:2025-11-16 02:53:25,008 - INFO -  step: 100  loss: -4.0000  grad_norm: 97.0393  memory: 59.45GiB(42.52%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank2]:2025-11-16 02:53:25,001 - INFO -  step: 100  loss: -4.0000  grad_norm: 97.0393  memory: 43.49GiB(31.10%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank3]:2025-11-16 02:53:25,005 - INFO -  step: 100  loss:  4.2929  grad_norm: 97.0393  memory: 51.83GiB(37.07%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank3]:2025-11-16 02:53:25,267 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0253_real_step100_rank3.svg
[rank3]:> Batch Time: 663.09 ms, GPU Bubble Ratio: 31.80%, 30.76%, 36.78%, 26.78%
[rank0]:2025-11-16 02:55:39,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 02:55:41,971 - INFO - Avg. fwd time: 7.8963 / Avg. bwd time: 18.1420 / Avg. batch time: 590.2970 (ms) / GPU bubble ratio: 29.42%
[rank3]:2025-11-16 02:55:41,943 - INFO - Avg. fwd time: 7.6298 / Avg. bwd time: 22.4722 / Avg. batch time: 556.8852 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-16 02:55:42,003 - INFO - Avg. fwd time: 8.1035 / Avg. bwd time: 20.4743 / Avg. batch time: 632.1533 (ms) / GPU bubble ratio: 27.67%
[rank1]:2025-11-16 02:55:42,064 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3012  memory: 53.38GiB(38.18%)  tps: 5,977  tflops: 278.77  mfu: 28.19%
[rank0]:2025-11-16 02:55:42,032 - INFO - Avg. fwd time: 8.2021 / Avg. bwd time: 19.8952 / Avg. batch time: 660.8897 (ms) / GPU bubble ratio: 31.98%
[rank0]:2025-11-16 02:55:42,067 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3012  memory: 59.45GiB(42.52%)  tps: 5,977  tflops: 278.77  mfu: 28.19%
[rank2]:2025-11-16 02:55:42,061 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3012  memory: 43.49GiB(31.10%)  tps: 5,977  tflops: 278.77  mfu: 28.19%
[rank3]:2025-11-16 02:55:42,065 - INFO -  step: 150  loss:  1.9078  grad_norm: 22.3012  memory: 51.83GiB(37.07%)  tps: 5,977  tflops: 278.77  mfu: 28.19%
[rank0]:2025-11-16 02:57:55,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 02:57:58,535 - INFO - Avg. fwd time: 7.6248 / Avg. bwd time: 22.4962 / Avg. batch time: 557.0710 (ms) / GPU bubble ratio: 13.49%
[rank2]:2025-11-16 02:57:58,557 - INFO - Avg. fwd time: 7.8891 / Avg. bwd time: 18.1525 / Avg. batch time: 590.3223 (ms) / GPU bubble ratio: 29.42%
[rank1]:2025-11-16 02:57:58,603 - INFO - Avg. fwd time: 8.0967 / Avg. bwd time: 20.4817 / Avg. batch time: 632.1689 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-16 02:57:58,598 - INFO - Avg. fwd time: 8.1909 / Avg. bwd time: 19.9152 / Avg. batch time: 660.9140 (ms) / GPU bubble ratio: 31.96%
[rank2]:2025-11-16 02:57:58,716 - INFO -  step: 200  loss: -4.0000  grad_norm: 13.6797  memory: 43.49GiB(31.10%)  tps: 5,995  tflops: 279.59  mfu: 28.27%
[rank3]:2025-11-16 02:57:58,720 - INFO -  step: 200  loss:  0.4781  grad_norm: 13.6797  memory: 51.83GiB(37.07%)  tps: 5,995  tflops: 279.59  mfu: 28.27%
[rank1]:2025-11-16 02:57:58,719 - INFO -  step: 200  loss: -4.0000  grad_norm: 13.6797  memory: 53.38GiB(38.18%)  tps: 5,995  tflops: 279.59  mfu: 28.27%
[rank0]:2025-11-16 02:57:58,723 - INFO -  step: 200  loss: -4.0000  grad_norm: 13.6797  memory: 59.45GiB(42.52%)  tps: 5,995  tflops: 279.59  mfu: 28.27%
[rank3]:2025-11-16 02:57:58,961 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0257_real_step200_rank3.svg
[rank3]:> Batch Time: 661.06 ms, GPU Bubble Ratio: 31.68%, 30.69%, 36.77%, 26.81%
[rank0]:2025-11-16 03:00:12,849 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:00:15,422 - INFO - Avg. fwd time: 7.8838 / Avg. bwd time: 18.1559 / Avg. batch time: 590.4971 (ms) / GPU bubble ratio: 29.44%
[rank3]:2025-11-16 03:00:15,401 - INFO - Avg. fwd time: 7.6204 / Avg. bwd time: 22.5088 / Avg. batch time: 557.1421 (ms) / GPU bubble ratio: 13.48%
[rank0]:2025-11-16 03:00:15,463 - INFO - Avg. fwd time: 8.1855 / Avg. bwd time: 19.9307 / Avg. batch time: 661.1087 (ms) / GPU bubble ratio: 31.95%
[rank1]:2025-11-16 03:00:15,468 - INFO - Avg. fwd time: 8.0928 / Avg. bwd time: 20.4869 / Avg. batch time: 632.3502 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-16 03:00:15,588 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6596  memory: 59.45GiB(42.52%)  tps: 5,985  tflops: 279.16  mfu: 28.23%
[rank1]:2025-11-16 03:00:15,584 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6596  memory: 53.38GiB(38.18%)  tps: 5,985  tflops: 279.16  mfu: 28.23%
[rank2]:2025-11-16 03:00:15,581 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.6596  memory: 43.49GiB(31.10%)  tps: 5,985  tflops: 279.16  mfu: 28.23%
[rank3]:2025-11-16 03:00:15,585 - INFO -  step: 250  loss:  0.2515  grad_norm:  0.6596  memory: 51.83GiB(37.07%)  tps: 5,986  tflops: 279.17  mfu: 28.23%
[rank0]:2025-11-16 03:02:29,123 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:02:31,765 - INFO - Avg. fwd time: 7.6122 / Avg. bwd time: 22.5006 / Avg. batch time: 556.8304 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 03:02:31,794 - INFO - Avg. fwd time: 7.8766 / Avg. bwd time: 18.1485 / Avg. batch time: 590.0981 (ms) / GPU bubble ratio: 29.44%
[rank3]:2025-11-16 03:02:31,889 - INFO -  step: 300  loss:  0.2807  grad_norm:  0.9357  memory: 51.83GiB(37.07%)  tps: 6,010  tflops: 280.31  mfu: 28.34%
[rank1]:2025-11-16 03:02:31,826 - INFO - Avg. fwd time: 8.0879 / Avg. bwd time: 20.4881 / Avg. batch time: 631.9724 (ms) / GPU bubble ratio: 27.65%
[rank1]:2025-11-16 03:02:31,888 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9357  memory: 53.38GiB(38.18%)  tps: 6,010  tflops: 280.31  mfu: 28.34%
[rank0]:2025-11-16 03:02:31,856 - INFO - Avg. fwd time: 8.1826 / Avg. bwd time: 19.9317 / Avg. batch time: 660.7329 (ms) / GPU bubble ratio: 31.92%
[rank0]:2025-11-16 03:02:31,891 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9357  memory: 59.45GiB(42.52%)  tps: 6,010  tflops: 280.31  mfu: 28.34%
[rank2]:2025-11-16 03:02:31,885 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9357  memory: 43.49GiB(31.10%)  tps: 6,010  tflops: 280.31  mfu: 28.34%
[rank3]:2025-11-16 03:02:32,121 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0302_real_step300_rank3.svg
[rank3]:> Batch Time: 658.56 ms, GPU Bubble Ratio: 31.52%, 30.48%, 36.77%, 26.95%
[rank0]:2025-11-16 03:04:45,647 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:04:48,211 - INFO - Avg. fwd time: 7.6072 / Avg. bwd time: 22.4904 / Avg. batch time: 556.5707 (ms) / GPU bubble ratio: 13.48%
[rank2]:2025-11-16 03:04:48,232 - INFO - Avg. fwd time: 7.8769 / Avg. bwd time: 18.1524 / Avg. batch time: 589.9798 (ms) / GPU bubble ratio: 29.41%
[rank1]:2025-11-16 03:04:48,280 - INFO - Avg. fwd time: 8.0874 / Avg. bwd time: 20.4931 / Avg. batch time: 631.8650 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-16 03:04:48,274 - INFO - Avg. fwd time: 8.1828 / Avg. bwd time: 19.9283 / Avg. batch time: 660.6198 (ms) / GPU bubble ratio: 31.92%
[rank3]:2025-11-16 03:04:48,395 - INFO -  step: 350  loss:  0.3250  grad_norm:  0.5359  memory: 51.83GiB(37.07%)  tps: 6,001  tflops: 279.90  mfu: 28.30%
[rank1]:2025-11-16 03:04:48,394 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.5359  memory: 53.38GiB(38.18%)  tps: 6,001  tflops: 279.90  mfu: 28.30%
[rank0]:2025-11-16 03:04:48,398 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.5359  memory: 59.45GiB(42.52%)  tps: 6,001  tflops: 279.90  mfu: 28.30%
[rank2]:2025-11-16 03:04:48,391 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.5359  memory: 43.49GiB(31.10%)  tps: 6,001  tflops: 279.90  mfu: 28.30%
[rank0]:2025-11-16 03:07:01,781 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:07:04,353 - INFO - Avg. fwd time: 7.6024 / Avg. bwd time: 22.4743 / Avg. batch time: 556.2253 (ms) / GPU bubble ratio: 13.48%
[rank1]:2025-11-16 03:07:04,420 - INFO - Avg. fwd time: 8.0871 / Avg. bwd time: 20.4996 / Avg. batch time: 631.5566 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-16 03:07:04,415 - INFO - Avg. fwd time: 8.1833 / Avg. bwd time: 19.9218 / Avg. batch time: 660.3054 (ms) / GPU bubble ratio: 31.90%
[rank2]:2025-11-16 03:07:04,374 - INFO - Avg. fwd time: 7.8796 / Avg. bwd time: 18.1610 / Avg. batch time: 589.6601 (ms) / GPU bubble ratio: 29.34%
[rank3]:2025-11-16 03:07:04,536 - INFO -  step: 400  loss:  0.2605  grad_norm:  0.3750  memory: 51.83GiB(37.07%)  tps: 6,017  tflops: 280.65  mfu: 28.38%
[rank1]:2025-11-16 03:07:04,535 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3750  memory: 53.38GiB(38.18%)  tps: 6,017  tflops: 280.65  mfu: 28.38%
[rank0]:2025-11-16 03:07:04,538 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3750  memory: 59.45GiB(42.52%)  tps: 6,017  tflops: 280.65  mfu: 28.38%
[rank2]:2025-11-16 03:07:04,532 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3750  memory: 43.49GiB(31.10%)  tps: 6,017  tflops: 280.65  mfu: 28.38%
[rank3]:2025-11-16 03:07:04,771 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0307_real_step400_rank3.svg
[rank3]:> Batch Time: 659.02 ms, GPU Bubble Ratio: 31.62%, 30.34%, 36.39%, 27.17%
[rank0]:2025-11-16 03:09:18,441 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-16 03:09:21,158 - INFO - Avg. fwd time: 8.0885 / Avg. bwd time: 20.5050 / Avg. batch time: 631.6165 (ms) / GPU bubble ratio: 27.57%
[rank3]:2025-11-16 03:09:21,095 - INFO - Avg. fwd time: 7.6017 / Avg. bwd time: 22.4714 / Avg. batch time: 556.1749 (ms) / GPU bubble ratio: 13.49%
[rank2]:2025-11-16 03:09:21,124 - INFO - Avg. fwd time: 7.8828 / Avg. bwd time: 18.1676 / Avg. batch time: 589.7100 (ms) / GPU bubble ratio: 29.32%
[rank1]:2025-11-16 03:09:21,219 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3344  memory: 53.38GiB(38.18%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank3]:2025-11-16 03:09:21,221 - INFO -  step: 450  loss:  0.2789  grad_norm:  0.3344  memory: 51.83GiB(37.07%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank0]:2025-11-16 03:09:21,188 - INFO - Avg. fwd time: 8.1835 / Avg. bwd time: 19.9224 / Avg. batch time: 660.3666 (ms) / GPU bubble ratio: 31.90%
[rank0]:2025-11-16 03:09:21,223 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3344  memory: 59.45GiB(42.52%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank2]:2025-11-16 03:09:21,217 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3344  memory: 43.49GiB(31.10%)  tps: 5,993  tflops: 279.53  mfu: 28.26%
[rank0]:2025-11-16 03:11:35,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:11:37,938 - INFO - Avg. fwd time: 7.8849 / Avg. bwd time: 18.1724 / Avg. batch time: 589.8263 (ms) / GPU bubble ratio: 29.32%
[rank0]:2025-11-16 03:11:37,980 - INFO - Avg. fwd time: 8.1832 / Avg. bwd time: 19.9295 / Avg. batch time: 660.4905 (ms) / GPU bubble ratio: 31.90%
[rank3]:2025-11-16 03:11:37,916 - INFO - Avg. fwd time: 7.6041 / Avg. bwd time: 22.4803 / Avg. batch time: 556.3531 (ms) / GPU bubble ratio: 13.48%
[rank1]:2025-11-16 03:11:37,983 - INFO - Avg. fwd time: 8.0896 / Avg. bwd time: 20.5083 / Avg. batch time: 631.7329 (ms) / GPU bubble ratio: 27.57%
[rank1]:2025-11-16 03:11:38,098 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3789  memory: 53.38GiB(38.18%)  tps: 5,985  tflops: 279.14  mfu: 28.22%
[rank2]:2025-11-16 03:11:38,095 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3789  memory: 43.49GiB(31.10%)  tps: 5,985  tflops: 279.14  mfu: 28.22%
[rank0]:2025-11-16 03:11:38,101 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.3789  memory: 59.45GiB(42.52%)  tps: 5,985  tflops: 279.14  mfu: 28.22%
[rank3]:2025-11-16 03:11:38,099 - INFO -  step: 500  loss:  0.2776  grad_norm:  0.3789  memory: 51.83GiB(37.07%)  tps: 5,985  tflops: 279.14  mfu: 28.22%
[rank3]:2025-11-16 03:11:38,331 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0311_real_step500_rank3.svg
[rank3]:> Batch Time: 661.62 ms, GPU Bubble Ratio: 31.67%, 30.62%, 36.72%, 26.86%
[rank0]:2025-11-16 03:13:52,191 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:13:54,768 - INFO - Avg. fwd time: 7.8865 / Avg. bwd time: 18.1758 / Avg. batch time: 590.0404 (ms) / GPU bubble ratio: 29.33%
[rank3]:2025-11-16 03:13:54,747 - INFO - Avg. fwd time: 7.6064 / Avg. bwd time: 22.4893 / Avg. batch time: 556.5366 (ms) / GPU bubble ratio: 13.48%
[rank1]:2025-11-16 03:13:54,815 - INFO - Avg. fwd time: 8.0906 / Avg. bwd time: 20.5102 / Avg. batch time: 631.9499 (ms) / GPU bubble ratio: 27.59%
[rank0]:2025-11-16 03:13:54,810 - INFO - Avg. fwd time: 8.1831 / Avg. bwd time: 19.9382 / Avg. batch time: 660.7164 (ms) / GPU bubble ratio: 31.90%
[rank1]:2025-11-16 03:13:54,929 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2984  memory: 53.38GiB(38.18%)  tps: 5,987  tflops: 279.23  mfu: 28.23%
[rank2]:2025-11-16 03:13:54,927 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2984  memory: 43.49GiB(31.10%)  tps: 5,987  tflops: 279.23  mfu: 28.23%
[rank0]:2025-11-16 03:13:54,933 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2984  memory: 59.45GiB(42.52%)  tps: 5,987  tflops: 279.23  mfu: 28.23%
[rank3]:2025-11-16 03:13:54,931 - INFO -  step: 550  loss:  0.1623  grad_norm:  0.2984  memory: 51.83GiB(37.07%)  tps: 5,987  tflops: 279.23  mfu: 28.23%
[rank0]:2025-11-16 03:16:09,982 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:16:12,689 - INFO - Avg. fwd time: 7.6150 / Avg. bwd time: 22.5064 / Avg. batch time: 556.9916 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-16 03:16:12,754 - INFO - Avg. fwd time: 8.0975 / Avg. bwd time: 20.5171 / Avg. batch time: 632.3541 (ms) / GPU bubble ratio: 27.60%
[rank2]:2025-11-16 03:16:12,719 - INFO - Avg. fwd time: 7.8931 / Avg. bwd time: 18.1828 / Avg. batch time: 590.4324 (ms) / GPU bubble ratio: 29.34%
[rank2]:2025-11-16 03:16:12,814 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7566  memory: 43.49GiB(31.10%)  tps: 5,941  tflops: 277.09  mfu: 28.02%
[rank0]:2025-11-16 03:16:12,785 - INFO - Avg. fwd time: 8.1879 / Avg. bwd time: 19.9487 / Avg. batch time: 661.1365 (ms) / GPU bubble ratio: 31.91%
[rank0]:2025-11-16 03:16:12,821 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7566  memory: 59.45GiB(42.52%)  tps: 5,941  tflops: 277.09  mfu: 28.02%
[rank3]:2025-11-16 03:16:12,818 - INFO -  step: 600  loss:  0.4065  grad_norm:  0.7566  memory: 51.83GiB(37.07%)  tps: 5,941  tflops: 277.10  mfu: 28.02%
[rank1]:2025-11-16 03:16:12,817 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.7566  memory: 53.38GiB(38.18%)  tps: 5,941  tflops: 277.09  mfu: 28.02%
[rank3]:2025-11-16 03:16:13,053 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0316_real_step600_rank3.svg
[rank3]:> Batch Time: 669.17 ms, GPU Bubble Ratio: 31.90%, 30.75%, 36.85%, 26.71%
[rank0]:2025-11-16 03:18:29,226 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:18:31,821 - INFO - Avg. fwd time: 7.6273 / Avg. bwd time: 22.5270 / Avg. batch time: 557.5920 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-16 03:18:31,888 - INFO - Avg. fwd time: 8.1082 / Avg. bwd time: 20.5256 / Avg. batch time: 632.9977 (ms) / GPU bubble ratio: 27.62%
[rank2]:2025-11-16 03:18:31,842 - INFO - Avg. fwd time: 7.9031 / Avg. bwd time: 18.1914 / Avg. batch time: 591.0590 (ms) / GPU bubble ratio: 29.36%
[rank0]:2025-11-16 03:18:31,886 - INFO - Avg. fwd time: 8.1960 / Avg. bwd time: 19.9594 / Avg. batch time: 661.8019 (ms) / GPU bubble ratio: 31.93%
[rank1]:2025-11-16 03:18:32,002 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5178  memory: 53.38GiB(38.18%)  tps: 5,886  tflops: 274.51  mfu: 27.76%
[rank2]:2025-11-16 03:18:31,999 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5178  memory: 43.49GiB(31.10%)  tps: 5,886  tflops: 274.51  mfu: 27.76%
[rank0]:2025-11-16 03:18:32,006 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.5178  memory: 59.45GiB(42.52%)  tps: 5,886  tflops: 274.51  mfu: 27.76%
[rank3]:2025-11-16 03:18:32,004 - INFO -  step: 650  loss:  0.2675  grad_norm:  0.5178  memory: 51.83GiB(37.07%)  tps: 5,886  tflops: 274.51  mfu: 27.76%
[rank0]:2025-11-16 03:20:48,311 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:20:50,935 - INFO - Avg. fwd time: 7.6392 / Avg. bwd time: 22.5467 / Avg. batch time: 558.1637 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-16 03:20:51,005 - INFO - Avg. fwd time: 8.1182 / Avg. bwd time: 20.5339 / Avg. batch time: 633.5291 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-16 03:20:50,999 - INFO - Avg. fwd time: 8.2032 / Avg. bwd time: 19.9692 / Avg. batch time: 662.3542 (ms) / GPU bubble ratio: 31.95%
[rank2]:2025-11-16 03:20:50,957 - INFO - Avg. fwd time: 7.9126 / Avg. bwd time: 18.2003 / Avg. batch time: 591.5749 (ms) / GPU bubble ratio: 29.37%
[rank1]:2025-11-16 03:20:51,117 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.2320  memory: 53.38GiB(38.18%)  tps: 5,889  tflops: 274.65  mfu: 27.77%
[rank0]:2025-11-16 03:20:51,120 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.2320  memory: 59.45GiB(42.52%)  tps: 5,889  tflops: 274.65  mfu: 27.77%
[rank2]:2025-11-16 03:20:51,114 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.2320  memory: 43.49GiB(31.10%)  tps: 5,889  tflops: 274.65  mfu: 27.77%
[rank3]:2025-11-16 03:20:51,118 - INFO -  step: 700  loss:  0.3469  grad_norm:  1.2320  memory: 51.83GiB(37.07%)  tps: 5,889  tflops: 274.65  mfu: 27.77%
[rank3]:2025-11-16 03:20:51,356 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0320_real_step700_rank3.svg
[rank3]:> Batch Time: 670.67 ms, GPU Bubble Ratio: 31.94%, 30.83%, 36.89%, 26.72%
[rank0]:2025-11-16 03:23:06,958 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:23:09,659 - INFO - Avg. fwd time: 7.9193 / Avg. bwd time: 18.2066 / Avg. batch time: 591.9754 (ms) / GPU bubble ratio: 29.39%
[rank3]:2025-11-16 03:23:09,629 - INFO - Avg. fwd time: 7.6469 / Avg. bwd time: 22.5600 / Avg. batch time: 558.5419 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-16 03:23:09,695 - INFO - Avg. fwd time: 8.1249 / Avg. bwd time: 20.5398 / Avg. batch time: 633.9412 (ms) / GPU bubble ratio: 27.65%
[rank2]:2025-11-16 03:23:09,756 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.6008  memory: 43.49GiB(31.10%)  tps: 5,909  tflops: 275.58  mfu: 27.86%
[rank0]:2025-11-16 03:23:09,727 - INFO - Avg. fwd time: 8.2077 / Avg. bwd time: 19.9756 / Avg. batch time: 662.7801 (ms) / GPU bubble ratio: 31.96%
[rank0]:2025-11-16 03:23:09,763 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.6008  memory: 59.45GiB(42.52%)  tps: 5,909  tflops: 275.58  mfu: 27.86%
[rank3]:2025-11-16 03:23:09,760 - INFO -  step: 750  loss:  0.1466  grad_norm:  0.6008  memory: 51.83GiB(37.07%)  tps: 5,909  tflops: 275.59  mfu: 27.87%
[rank1]:2025-11-16 03:23:09,759 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.6008  memory: 53.38GiB(38.18%)  tps: 5,909  tflops: 275.58  mfu: 27.87%
[rank0]:2025-11-16 03:25:24,175 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:25:26,797 - INFO - Avg. fwd time: 7.6479 / Avg. bwd time: 22.5634 / Avg. batch time: 558.6115 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 03:25:26,819 - INFO - Avg. fwd time: 7.9204 / Avg. bwd time: 18.2084 / Avg. batch time: 592.0109 (ms) / GPU bubble ratio: 29.38%
[rank0]:2025-11-16 03:25:26,861 - INFO - Avg. fwd time: 8.2072 / Avg. bwd time: 19.9783 / Avg. batch time: 662.8196 (ms) / GPU bubble ratio: 31.96%
[rank1]:2025-11-16 03:25:26,865 - INFO - Avg. fwd time: 8.1252 / Avg. bwd time: 20.5409 / Avg. batch time: 633.9790 (ms) / GPU bubble ratio: 27.65%
[rank3]:2025-11-16 03:25:26,979 - INFO -  step: 800  loss:  0.2655  grad_norm:  0.5856  memory: 51.83GiB(37.07%)  tps: 5,970  tflops: 278.45  mfu: 28.15%
[rank1]:2025-11-16 03:25:26,978 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5856  memory: 53.38GiB(38.18%)  tps: 5,970  tflops: 278.44  mfu: 28.15%
[rank2]:2025-11-16 03:25:26,975 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5856  memory: 43.49GiB(31.10%)  tps: 5,970  tflops: 278.44  mfu: 28.15%
[rank0]:2025-11-16 03:25:26,981 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.5856  memory: 59.45GiB(42.52%)  tps: 5,970  tflops: 278.44  mfu: 28.15%
[rank3]:2025-11-16 03:25:27,214 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0325_real_step800_rank3.svg
[rank3]:> Batch Time: 663.12 ms, GPU Bubble Ratio: 31.75%, 30.78%, 36.77%, 26.93%
[rank0]:2025-11-16 03:27:42,110 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-16 03:27:44,749 - INFO - Avg. fwd time: 8.1286 / Avg. bwd time: 20.5437 / Avg. batch time: 634.2083 (ms) / GPU bubble ratio: 27.66%
[rank3]:2025-11-16 03:27:44,682 - INFO - Avg. fwd time: 7.6519 / Avg. bwd time: 22.5709 / Avg. batch time: 558.8148 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-16 03:27:44,745 - INFO - Avg. fwd time: 8.2094 / Avg. bwd time: 19.9825 / Avg. batch time: 663.0569 (ms) / GPU bubble ratio: 31.97%
[rank2]:2025-11-16 03:27:44,703 - INFO - Avg. fwd time: 7.9239 / Avg. bwd time: 18.2114 / Avg. batch time: 592.2340 (ms) / GPU bubble ratio: 29.39%
[rank1]:2025-11-16 03:27:44,862 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3750  memory: 53.38GiB(38.18%)  tps: 5,941  tflops: 277.10  mfu: 28.02%
[rank3]:2025-11-16 03:27:44,864 - INFO -  step: 850  loss:  0.1229  grad_norm:  0.3750  memory: 51.83GiB(37.07%)  tps: 5,941  tflops: 277.10  mfu: 28.02%
[rank0]:2025-11-16 03:27:44,866 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3750  memory: 59.45GiB(42.52%)  tps: 5,941  tflops: 277.10  mfu: 28.02%
[rank2]:2025-11-16 03:27:44,859 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.3750  memory: 43.49GiB(31.10%)  tps: 5,941  tflops: 277.10  mfu: 28.02%
[rank0]:2025-11-16 03:29:58,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:30:00,971 - INFO - Avg. fwd time: 7.9222 / Avg. bwd time: 18.2106 / Avg. batch time: 592.1311 (ms) / GPU bubble ratio: 29.39%
[rank3]:2025-11-16 03:30:00,940 - INFO - Avg. fwd time: 7.6495 / Avg. bwd time: 22.5699 / Avg. batch time: 558.7451 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:30:01,008 - INFO - Avg. fwd time: 8.1265 / Avg. bwd time: 20.5423 / Avg. batch time: 634.1039 (ms) / GPU bubble ratio: 27.66%
[rank1]:2025-11-16 03:30:01,072 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4209  memory: 53.38GiB(38.18%)  tps: 6,014  tflops: 280.51  mfu: 28.36%
[rank0]:2025-11-16 03:30:01,041 - INFO - Avg. fwd time: 8.2071 / Avg. bwd time: 19.9840 / Avg. batch time: 662.9537 (ms) / GPU bubble ratio: 31.96%
[rank0]:2025-11-16 03:30:01,076 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4209  memory: 59.45GiB(42.52%)  tps: 6,014  tflops: 280.51  mfu: 28.36%
[rank2]:2025-11-16 03:30:01,070 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.4209  memory: 43.49GiB(31.10%)  tps: 6,014  tflops: 280.51  mfu: 28.36%
[rank3]:2025-11-16 03:30:01,074 - INFO -  step: 900  loss:  0.1844  grad_norm:  0.4209  memory: 51.83GiB(37.07%)  tps: 6,014  tflops: 280.51  mfu: 28.36%
[rank3]:2025-11-16 03:30:01,303 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0330_real_step900_rank3.svg
[rank3]:> Batch Time: 662.14 ms, GPU Bubble Ratio: 31.59%, 30.56%, 36.64%, 26.73%
[rank0]:2025-11-16 03:32:15,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:32:18,357 - INFO - Avg. fwd time: 7.9232 / Avg. bwd time: 18.2118 / Avg. batch time: 592.2292 (ms) / GPU bubble ratio: 29.39%
[rank3]:2025-11-16 03:32:18,336 - INFO - Avg. fwd time: 7.6507 / Avg. bwd time: 22.5731 / Avg. batch time: 558.8182 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:32:18,404 - INFO - Avg. fwd time: 8.1274 / Avg. bwd time: 20.5435 / Avg. batch time: 634.2035 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-16 03:32:18,399 - INFO - Avg. fwd time: 8.2074 / Avg. bwd time: 19.9866 / Avg. batch time: 663.0549 (ms) / GPU bubble ratio: 31.97%
[rank3]:2025-11-16 03:32:18,518 - INFO -  step: 950  loss:  0.2477  grad_norm:  0.7496  memory: 51.83GiB(37.07%)  tps: 5,960  tflops: 277.99  mfu: 28.11%
[rank1]:2025-11-16 03:32:18,516 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7496  memory: 53.38GiB(38.18%)  tps: 5,960  tflops: 277.99  mfu: 28.11%
[rank0]:2025-11-16 03:32:18,520 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7496  memory: 59.45GiB(42.52%)  tps: 5,960  tflops: 277.99  mfu: 28.11%
[rank2]:2025-11-16 03:32:18,513 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7496  memory: 43.49GiB(31.10%)  tps: 5,960  tflops: 277.99  mfu: 28.11%
[rank0]:2025-11-16 03:34:33,475 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:34:36,076 - INFO - Avg. fwd time: 7.9262 / Avg. bwd time: 18.2149 / Avg. batch time: 592.3747 (ms) / GPU bubble ratio: 29.39%
[rank3]:2025-11-16 03:34:36,055 - INFO - Avg. fwd time: 7.6543 / Avg. bwd time: 22.5795 / Avg. batch time: 558.9965 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:34:36,122 - INFO - Avg. fwd time: 8.1301 / Avg. bwd time: 20.5463 / Avg. batch time: 634.3534 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-16 03:34:36,118 - INFO - Avg. fwd time: 8.2092 / Avg. bwd time: 19.9906 / Avg. batch time: 663.2098 (ms) / GPU bubble ratio: 31.97%
[rank3]:2025-11-16 03:34:36,236 - INFO -  step: 1000  loss:  0.1514  grad_norm:  0.2939  memory: 51.83GiB(37.07%)  tps: 5,948  tflops: 277.44  mfu: 28.05%
[rank3]:2025-11-16 03:34:36,236 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-16 03:34:36,234 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2939  memory: 53.38GiB(38.18%)  tps: 5,948  tflops: 277.43  mfu: 28.05%
[rank1]:2025-11-16 03:34:36,234 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 03:34:36,238 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2939  memory: 59.45GiB(42.52%)  tps: 5,948  tflops: 277.43  mfu: 28.05%
[rank0]:2025-11-16 03:34:36,238 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 03:34:36,238 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-16 03:34:36,231 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2939  memory: 43.49GiB(31.10%)  tps: 5,948  tflops: 277.43  mfu: 28.05%
[rank2]:2025-11-16 03:34:36,231 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-16 03:34:51,063 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.83 seconds.
[rank1]:2025-11-16 03:34:53,305 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.07 seconds.
[rank3]:2025-11-16 03:34:53,319 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.08 seconds.
[rank0]:2025-11-16 03:34:55,901 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-16 03:34:55,908 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.67 seconds.
[rank3]:2025-11-16 03:34:56,243 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0334_real_step1000_rank3.svg
[rank3]:> Batch Time: 665.17 ms, GPU Bubble Ratio: 31.75%, 30.74%, 36.72%, 26.84%
[rank0]:2025-11-16 03:37:13,888 - INFO - [GC] Peforming periodical GC collection 3.01 seconds
[rank2]:2025-11-16 03:37:16,634 - INFO - Avg. fwd time: 7.9258 / Avg. bwd time: 18.2145 / Avg. batch time: 592.5385 (ms) / GPU bubble ratio: 29.41%
[rank3]:2025-11-16 03:37:16,600 - INFO - Avg. fwd time: 7.6543 / Avg. bwd time: 22.5881 / Avg. batch time: 559.1274 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:37:16,674 - INFO - Avg. fwd time: 8.1297 / Avg. bwd time: 20.5464 / Avg. batch time: 634.5187 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-16 03:37:16,709 - INFO - Avg. fwd time: 8.2089 / Avg. bwd time: 19.9921 / Avg. batch time: 663.3792 (ms) / GPU bubble ratio: 31.98%
[rank2]:2025-11-16 03:37:16,738 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8488  memory: 43.49GiB(31.10%)  tps: 5,104  tflops: 238.04  mfu: 24.07%
[rank3]:2025-11-16 03:37:16,743 - INFO -  step: 1050  loss:  0.2503  grad_norm:  0.8488  memory: 51.85GiB(37.08%)  tps: 5,104  tflops: 238.05  mfu: 24.07%
[rank1]:2025-11-16 03:37:16,741 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8488  memory: 53.51GiB(38.27%)  tps: 5,104  tflops: 238.04  mfu: 24.07%
[rank0]:2025-11-16 03:37:16,745 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.8488  memory: 59.45GiB(42.52%)  tps: 5,104  tflops: 238.04  mfu: 24.07%
[rank0]:2025-11-16 03:39:33,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:39:36,161 - INFO - Avg. fwd time: 7.9321 / Avg. bwd time: 18.2194 / Avg. batch time: 592.8647 (ms) / GPU bubble ratio: 29.42%
[rank3]:2025-11-16 03:39:36,141 - INFO - Avg. fwd time: 7.6621 / Avg. bwd time: 22.5996 / Avg. batch time: 559.4842 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:39:36,207 - INFO - Avg. fwd time: 8.1366 / Avg. bwd time: 20.5520 / Avg. batch time: 634.8551 (ms) / GPU bubble ratio: 27.70%
[rank0]:2025-11-16 03:39:36,203 - INFO - Avg. fwd time: 8.2144 / Avg. bwd time: 19.9974 / Avg. batch time: 663.7387 (ms) / GPU bubble ratio: 31.99%
[rank1]:2025-11-16 03:39:36,318 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3684  memory: 53.51GiB(38.27%)  tps: 5,869  tflops: 273.74  mfu: 27.68%
[rank0]:2025-11-16 03:39:36,321 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3684  memory: 59.45GiB(42.52%)  tps: 5,869  tflops: 273.74  mfu: 27.68%
[rank2]:2025-11-16 03:39:36,315 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3684  memory: 43.49GiB(31.10%)  tps: 5,869  tflops: 273.74  mfu: 27.68%
[rank3]:2025-11-16 03:39:36,319 - INFO -  step: 1100  loss:  0.2209  grad_norm:  0.3684  memory: 51.85GiB(37.08%)  tps: 5,869  tflops: 273.74  mfu: 27.68%
[rank3]:2025-11-16 03:39:36,560 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0339_real_step1100_rank3.svg
[rank3]:> Batch Time: 673.70 ms, GPU Bubble Ratio: 32.10%, 30.92%, 37.03%, 26.76%
[rank0]:2025-11-16 03:41:51,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:41:54,166 - INFO - Avg. fwd time: 7.9340 / Avg. bwd time: 18.2214 / Avg. batch time: 593.0080 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-16 03:41:54,146 - INFO - Avg. fwd time: 7.6647 / Avg. bwd time: 22.6043 / Avg. batch time: 559.6116 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:41:54,213 - INFO - Avg. fwd time: 8.1387 / Avg. bwd time: 20.5539 / Avg. batch time: 634.9989 (ms) / GPU bubble ratio: 27.70%
[rank0]:2025-11-16 03:41:54,210 - INFO - Avg. fwd time: 8.2155 / Avg. bwd time: 19.9995 / Avg. batch time: 663.8851 (ms) / GPU bubble ratio: 32.00%
[rank3]:2025-11-16 03:41:54,324 - INFO -  step: 1150  loss:  0.2108  grad_norm:  0.5734  memory: 51.85GiB(37.08%)  tps: 5,936  tflops: 276.86  mfu: 27.99%
[rank1]:2025-11-16 03:41:54,322 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5734  memory: 53.51GiB(38.27%)  tps: 5,936  tflops: 276.86  mfu: 27.99%
[rank0]:2025-11-16 03:41:54,326 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5734  memory: 59.45GiB(42.52%)  tps: 5,936  tflops: 276.86  mfu: 27.99%
[rank2]:2025-11-16 03:41:54,320 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5734  memory: 43.49GiB(31.10%)  tps: 5,936  tflops: 276.86  mfu: 27.99%
[rank0]:2025-11-16 03:44:09,180 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:44:11,871 - INFO - Avg. fwd time: 7.6664 / Avg. bwd time: 22.6076 / Avg. batch time: 559.6998 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:44:11,947 - INFO - Avg. fwd time: 8.1400 / Avg. bwd time: 20.5547 / Avg. batch time: 635.0630 (ms) / GPU bubble ratio: 27.71%
[rank2]:2025-11-16 03:44:11,907 - INFO - Avg. fwd time: 7.9354 / Avg. bwd time: 18.2228 / Avg. batch time: 593.0702 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-16 03:44:12,016 - INFO -  step: 1200  loss:  0.2634  grad_norm:  0.4514  memory: 51.85GiB(37.08%)  tps: 5,950  tflops: 277.49  mfu: 28.06%
[rank1]:2025-11-16 03:44:12,015 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4514  memory: 53.51GiB(38.27%)  tps: 5,949  tflops: 277.49  mfu: 28.06%
[rank0]:2025-11-16 03:44:11,983 - INFO - Avg. fwd time: 8.2166 / Avg. bwd time: 20.0021 / Avg. batch time: 663.9535 (ms) / GPU bubble ratio: 32.00%
[rank0]:2025-11-16 03:44:12,019 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4514  memory: 59.45GiB(42.52%)  tps: 5,949  tflops: 277.49  mfu: 28.06%
[rank2]:2025-11-16 03:44:12,012 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4514  memory: 43.49GiB(31.10%)  tps: 5,949  tflops: 277.49  mfu: 28.06%
[rank3]:2025-11-16 03:44:12,252 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0344_real_step1200_rank3.svg
[rank3]:> Batch Time: 665.62 ms, GPU Bubble Ratio: 31.76%, 30.77%, 36.84%, 26.79%
[rank0]:2025-11-16 03:46:26,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:46:29,417 - INFO - Avg. fwd time: 7.6672 / Avg. bwd time: 22.6090 / Avg. batch time: 559.7376 (ms) / GPU bubble ratio: 13.46%
[rank2]:2025-11-16 03:46:29,439 - INFO - Avg. fwd time: 7.9361 / Avg. bwd time: 18.2237 / Avg. batch time: 593.1299 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-16 03:46:29,485 - INFO - Avg. fwd time: 8.1403 / Avg. bwd time: 20.5551 / Avg. batch time: 635.1227 (ms) / GPU bubble ratio: 27.71%
[rank0]:2025-11-16 03:46:29,480 - INFO - Avg. fwd time: 8.2167 / Avg. bwd time: 20.0034 / Avg. batch time: 664.0131 (ms) / GPU bubble ratio: 32.00%
[rank1]:2025-11-16 03:46:29,595 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5361  memory: 53.51GiB(38.27%)  tps: 5,954  tflops: 277.71  mfu: 28.08%
[rank0]:2025-11-16 03:46:29,599 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5361  memory: 59.45GiB(42.52%)  tps: 5,954  tflops: 277.71  mfu: 28.08%
[rank3]:2025-11-16 03:46:29,596 - INFO -  step: 1250  loss:  0.2516  grad_norm:  0.5361  memory: 51.85GiB(37.08%)  tps: 5,954  tflops: 277.71  mfu: 28.08%
[rank2]:2025-11-16 03:46:29,592 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5361  memory: 43.49GiB(31.10%)  tps: 5,954  tflops: 277.71  mfu: 28.08%
[rank0]:2025-11-16 03:48:44,097 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:48:46,663 - INFO - Avg. fwd time: 7.6681 / Avg. bwd time: 22.6095 / Avg. batch time: 559.7637 (ms) / GPU bubble ratio: 13.46%
[rank2]:2025-11-16 03:48:46,684 - INFO - Avg. fwd time: 7.9374 / Avg. bwd time: 18.2251 / Avg. batch time: 593.1376 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-16 03:48:46,731 - INFO - Avg. fwd time: 8.1413 / Avg. bwd time: 20.5560 / Avg. batch time: 635.1311 (ms) / GPU bubble ratio: 27.71%
[rank0]:2025-11-16 03:48:46,726 - INFO - Avg. fwd time: 8.2174 / Avg. bwd time: 20.0038 / Avg. batch time: 664.0215 (ms) / GPU bubble ratio: 32.00%
[rank1]:2025-11-16 03:48:46,840 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3673  memory: 53.51GiB(38.27%)  tps: 5,969  tflops: 278.39  mfu: 28.15%
[rank0]:2025-11-16 03:48:46,843 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3673  memory: 59.45GiB(42.52%)  tps: 5,969  tflops: 278.39  mfu: 28.15%
[rank3]:2025-11-16 03:48:46,841 - INFO -  step: 1300  loss:  0.1793  grad_norm:  0.3673  memory: 51.85GiB(37.08%)  tps: 5,969  tflops: 278.39  mfu: 28.15%
[rank2]:2025-11-16 03:48:46,837 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3673  memory: 43.49GiB(31.10%)  tps: 5,969  tflops: 278.39  mfu: 28.15%
[rank3]:2025-11-16 03:48:47,075 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0348_real_step1300_rank3.svg
[rank3]:> Batch Time: 658.55 ms, GPU Bubble Ratio: 31.51%, 30.42%, 36.40%, 27.04%
[rank0]:2025-11-16 03:51:02,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:51:04,805 - INFO - Avg. fwd time: 7.6691 / Avg. bwd time: 22.6070 / Avg. batch time: 559.7587 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:51:04,880 - INFO - Avg. fwd time: 8.1435 / Avg. bwd time: 20.5593 / Avg. batch time: 635.1795 (ms) / GPU bubble ratio: 27.70%
[rank2]:2025-11-16 03:51:04,840 - INFO - Avg. fwd time: 7.9400 / Avg. bwd time: 18.2283 / Avg. batch time: 593.1798 (ms) / GPU bubble ratio: 29.42%
[rank1]:2025-11-16 03:51:04,951 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4682  memory: 53.51GiB(38.27%)  tps: 5,931  tflops: 276.64  mfu: 27.97%
[rank0]:2025-11-16 03:51:04,919 - INFO - Avg. fwd time: 8.2198 / Avg. bwd time: 20.0019 / Avg. batch time: 664.0727 (ms) / GPU bubble ratio: 32.00%
[rank0]:2025-11-16 03:51:04,955 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4682  memory: 59.45GiB(42.52%)  tps: 5,931  tflops: 276.64  mfu: 27.97%
[rank2]:2025-11-16 03:51:04,948 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4682  memory: 43.49GiB(31.10%)  tps: 5,931  tflops: 276.64  mfu: 27.97%
[rank3]:2025-11-16 03:51:04,953 - INFO -  step: 1350  loss:  0.1234  grad_norm:  0.4682  memory: 51.85GiB(37.08%)  tps: 5,931  tflops: 276.65  mfu: 27.97%
[rank0]:2025-11-16 03:53:18,640 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 03:53:21,269 - INFO - Avg. fwd time: 7.9396 / Avg. bwd time: 18.2288 / Avg. batch time: 593.0374 (ms) / GPU bubble ratio: 29.40%
[rank3]:2025-11-16 03:53:21,251 - INFO - Avg. fwd time: 7.6668 / Avg. bwd time: 22.6002 / Avg. batch time: 559.6082 (ms) / GPU bubble ratio: 13.46%
[rank1]:2025-11-16 03:53:21,316 - INFO - Avg. fwd time: 8.1423 / Avg. bwd time: 20.5591 / Avg. batch time: 635.0345 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-16 03:53:21,312 - INFO - Avg. fwd time: 8.2192 / Avg. bwd time: 19.9979 / Avg. batch time: 663.9208 (ms) / GPU bubble ratio: 32.00%
[rank1]:2025-11-16 03:53:21,425 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4820  memory: 53.51GiB(38.27%)  tps: 6,003  tflops: 279.96  mfu: 28.31%
[rank0]:2025-11-16 03:53:21,429 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4820  memory: 59.45GiB(42.52%)  tps: 6,003  tflops: 279.96  mfu: 28.31%
[rank2]:2025-11-16 03:53:21,423 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4820  memory: 43.49GiB(31.10%)  tps: 6,003  tflops: 279.96  mfu: 28.31%
[rank3]:2025-11-16 03:53:21,427 - INFO -  step: 1400  loss:  0.3590  grad_norm:  0.4820  memory: 51.85GiB(37.08%)  tps: 6,003  tflops: 279.96  mfu: 28.31%
[rank3]:2025-11-16 03:53:21,665 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0353_real_step1400_rank3.svg
[rank3]:> Batch Time: 660.52 ms, GPU Bubble Ratio: 31.63%, 30.29%, 36.34%, 26.96%
[rank0]:2025-11-16 03:55:37,155 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:55:39,726 - INFO - Avg. fwd time: 7.6693 / Avg. bwd time: 22.5992 / Avg. batch time: 559.6579 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 03:55:39,745 - INFO - Avg. fwd time: 7.9430 / Avg. bwd time: 18.2320 / Avg. batch time: 593.1271 (ms) / GPU bubble ratio: 29.39%
[rank0]:2025-11-16 03:55:39,789 - INFO - Avg. fwd time: 8.2220 / Avg. bwd time: 19.9956 / Avg. batch time: 664.0171 (ms) / GPU bubble ratio: 32.01%
[rank1]:2025-11-16 03:55:39,791 - INFO - Avg. fwd time: 8.1458 / Avg. bwd time: 20.5626 / Avg. batch time: 635.1308 (ms) / GPU bubble ratio: 27.68%
[rank2]:2025-11-16 03:55:39,896 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3940  memory: 43.49GiB(31.10%)  tps: 5,916  tflops: 275.92  mfu: 27.90%
[rank0]:2025-11-16 03:55:39,903 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3940  memory: 59.45GiB(42.52%)  tps: 5,916  tflops: 275.92  mfu: 27.90%
[rank1]:2025-11-16 03:55:39,899 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3940  memory: 53.51GiB(38.27%)  tps: 5,916  tflops: 275.92  mfu: 27.90%
[rank3]:2025-11-16 03:55:39,901 - INFO -  step: 1450  loss:  0.1865  grad_norm:  0.3940  memory: 51.85GiB(37.08%)  tps: 5,916  tflops: 275.92  mfu: 27.90%
[rank0]:2025-11-16 03:57:55,788 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 03:57:58,503 - INFO - Avg. fwd time: 7.6725 / Avg. bwd time: 22.5994 / Avg. batch time: 559.7412 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 03:57:58,539 - INFO - Avg. fwd time: 7.9469 / Avg. bwd time: 18.2354 / Avg. batch time: 593.2140 (ms) / GPU bubble ratio: 29.38%
[rank0]:2025-11-16 03:57:58,617 - INFO - Avg. fwd time: 8.2253 / Avg. bwd time: 19.9939 / Avg. batch time: 664.1154 (ms) / GPU bubble ratio: 32.01%
[rank1]:2025-11-16 03:57:58,579 - INFO - Avg. fwd time: 8.1498 / Avg. bwd time: 20.5668 / Avg. batch time: 635.2263 (ms) / GPU bubble ratio: 27.67%
[rank3]:2025-11-16 03:57:58,650 - INFO -  step: 1500  loss:  0.2554  grad_norm:  0.5440  memory: 51.85GiB(37.08%)  tps: 5,904  tflops: 275.37  mfu: 27.84%
[rank2]:2025-11-16 03:57:58,646 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5440  memory: 43.49GiB(31.10%)  tps: 5,904  tflops: 275.37  mfu: 27.84%
[rank0]:2025-11-16 03:57:58,652 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5440  memory: 59.45GiB(42.52%)  tps: 5,904  tflops: 275.37  mfu: 27.84%
[rank1]:2025-11-16 03:57:58,648 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.5440  memory: 53.51GiB(38.27%)  tps: 5,904  tflops: 275.37  mfu: 27.84%
[rank3]:2025-11-16 03:57:58,887 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0357_real_step1500_rank3.svg
[rank3]:> Batch Time: 667.55 ms, GPU Bubble Ratio: 31.94%, 30.37%, 36.49%, 26.93%
[rank0]:2025-11-16 04:00:15,315 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:00:17,948 - INFO - Avg. fwd time: 7.6767 / Avg. bwd time: 22.6041 / Avg. batch time: 559.9129 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:00:17,969 - INFO - Avg. fwd time: 7.9509 / Avg. bwd time: 18.2386 / Avg. batch time: 593.4045 (ms) / GPU bubble ratio: 29.39%
[rank1]:2025-11-16 04:00:18,015 - INFO - Avg. fwd time: 8.1540 / Avg. bwd time: 20.5703 / Avg. batch time: 635.4239 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-16 04:00:18,015 - INFO - Avg. fwd time: 8.2287 / Avg. bwd time: 19.9957 / Avg. batch time: 664.3194 (ms) / GPU bubble ratio: 32.02%
[rank2]:2025-11-16 04:00:18,121 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5048  memory: 43.49GiB(31.10%)  tps: 5,873  tflops: 273.94  mfu: 27.70%
[rank1]:2025-11-16 04:00:18,124 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5048  memory: 53.51GiB(38.27%)  tps: 5,873  tflops: 273.94  mfu: 27.70%
[rank0]:2025-11-16 04:00:18,127 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.5048  memory: 59.45GiB(42.52%)  tps: 5,873  tflops: 273.94  mfu: 27.70%
[rank3]:2025-11-16 04:00:18,125 - INFO -  step: 1550  loss:  0.2664  grad_norm:  0.5048  memory: 51.85GiB(37.08%)  tps: 5,874  tflops: 273.94  mfu: 27.70%
[rank0]:2025-11-16 04:02:34,132 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:02:36,775 - INFO - Avg. fwd time: 7.6798 / Avg. bwd time: 22.6094 / Avg. batch time: 560.0623 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:02:36,795 - INFO - Avg. fwd time: 7.9531 / Avg. bwd time: 18.2401 / Avg. batch time: 593.5259 (ms) / GPU bubble ratio: 29.39%
[rank1]:2025-11-16 04:02:36,842 - INFO - Avg. fwd time: 8.1564 / Avg. bwd time: 20.5720 / Avg. batch time: 635.5481 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-16 04:02:36,841 - INFO - Avg. fwd time: 8.2306 / Avg. bwd time: 19.9987 / Avg. batch time: 664.4496 (ms) / GPU bubble ratio: 32.02%
[rank2]:2025-11-16 04:02:36,947 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8033  memory: 43.49GiB(31.10%)  tps: 5,901  tflops: 275.22  mfu: 27.83%
[rank1]:2025-11-16 04:02:36,950 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8033  memory: 53.51GiB(38.27%)  tps: 5,901  tflops: 275.22  mfu: 27.83%
[rank0]:2025-11-16 04:02:36,953 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8033  memory: 59.45GiB(42.52%)  tps: 5,901  tflops: 275.22  mfu: 27.83%
[rank3]:2025-11-16 04:02:36,951 - INFO -  step: 1600  loss:  0.4015  grad_norm:  0.8033  memory: 51.85GiB(37.08%)  tps: 5,901  tflops: 275.22  mfu: 27.83%
[rank3]:2025-11-16 04:02:37,188 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0402_real_step1600_rank3.svg
[rank3]:> Batch Time: 673.27 ms, GPU Bubble Ratio: 32.08%, 31.02%, 37.06%, 26.83%
[rank0]:2025-11-16 04:04:53,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:04:56,352 - INFO - Avg. fwd time: 7.6837 / Avg. bwd time: 22.6157 / Avg. batch time: 560.2514 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:04:56,389 - INFO - Avg. fwd time: 7.9559 / Avg. bwd time: 18.2414 / Avg. batch time: 593.7184 (ms) / GPU bubble ratio: 29.40%
[rank1]:2025-11-16 04:04:56,430 - INFO - Avg. fwd time: 8.1599 / Avg. bwd time: 20.5741 / Avg. batch time: 635.7480 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-16 04:04:56,473 - INFO - Avg. fwd time: 8.2332 / Avg. bwd time: 20.0018 / Avg. batch time: 664.6585 (ms) / GPU bubble ratio: 32.03%
[rank3]:2025-11-16 04:04:56,506 - INFO -  step: 1650  loss:  0.4319  grad_norm:  0.8553  memory: 51.85GiB(37.08%)  tps: 5,870  tflops: 273.79  mfu: 27.68%
[rank2]:2025-11-16 04:04:56,502 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8553  memory: 43.49GiB(31.10%)  tps: 5,870  tflops: 273.78  mfu: 27.68%
[rank1]:2025-11-16 04:04:56,504 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8553  memory: 53.51GiB(38.27%)  tps: 5,870  tflops: 273.78  mfu: 27.68%
[rank0]:2025-11-16 04:04:56,508 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.8553  memory: 59.45GiB(42.52%)  tps: 5,870  tflops: 273.78  mfu: 27.68%
[rank0]:2025-11-16 04:07:13,113 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 04:07:15,756 - INFO - Avg. fwd time: 7.9584 / Avg. bwd time: 18.2427 / Avg. batch time: 593.8540 (ms) / GPU bubble ratio: 29.41%
[rank0]:2025-11-16 04:07:15,799 - INFO - Avg. fwd time: 8.2354 / Avg. bwd time: 20.0042 / Avg. batch time: 664.8047 (ms) / GPU bubble ratio: 32.04%
[rank3]:2025-11-16 04:07:15,735 - INFO - Avg. fwd time: 7.6871 / Avg. bwd time: 22.6211 / Avg. batch time: 560.4110 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-16 04:07:15,802 - INFO - Avg. fwd time: 8.1628 / Avg. bwd time: 20.5760 / Avg. batch time: 635.8884 (ms) / GPU bubble ratio: 27.69%
[rank3]:2025-11-16 04:07:15,911 - INFO -  step: 1700  loss:  0.4020  grad_norm:  0.6577  memory: 51.85GiB(37.08%)  tps: 5,876  tflops: 274.08  mfu: 27.71%
[rank2]:2025-11-16 04:07:15,907 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6577  memory: 43.49GiB(31.10%)  tps: 5,876  tflops: 274.08  mfu: 27.71%
[rank1]:2025-11-16 04:07:15,910 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6577  memory: 53.51GiB(38.27%)  tps: 5,876  tflops: 274.08  mfu: 27.71%
[rank0]:2025-11-16 04:07:15,914 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.6577  memory: 59.45GiB(42.52%)  tps: 5,876  tflops: 274.08  mfu: 27.71%
[rank3]:2025-11-16 04:07:16,145 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0407_real_step1700_rank3.svg
[rank3]:> Batch Time: 669.17 ms, GPU Bubble Ratio: 31.83%, 30.69%, 36.88%, 26.66%
[rank0]:2025-11-16 04:09:32,041 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:09:34,675 - INFO - Avg. fwd time: 7.6890 / Avg. bwd time: 22.6231 / Avg. batch time: 560.4912 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:09:34,696 - INFO - Avg. fwd time: 7.9597 / Avg. bwd time: 18.2417 / Avg. batch time: 593.9412 (ms) / GPU bubble ratio: 29.42%
[rank1]:2025-11-16 04:09:34,743 - INFO - Avg. fwd time: 8.1653 / Avg. bwd time: 20.5778 / Avg. batch time: 635.9846 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-16 04:09:34,738 - INFO - Avg. fwd time: 8.2375 / Avg. bwd time: 20.0047 / Avg. batch time: 664.9044 (ms) / GPU bubble ratio: 32.04%
[rank2]:2025-11-16 04:09:34,847 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6410  memory: 43.49GiB(31.10%)  tps: 5,896  tflops: 274.99  mfu: 27.81%
[rank1]:2025-11-16 04:09:34,850 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6410  memory: 53.51GiB(38.27%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank0]:2025-11-16 04:09:34,853 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6410  memory: 59.45GiB(42.52%)  tps: 5,896  tflops: 274.99  mfu: 27.81%
[rank3]:2025-11-16 04:09:34,851 - INFO -  step: 1750  loss:  0.4076  grad_norm:  0.6410  memory: 51.85GiB(37.08%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank0]:2025-11-16 04:11:48,335 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:11:50,932 - INFO - Avg. fwd time: 7.6861 / Avg. bwd time: 22.6175 / Avg. batch time: 560.3399 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:11:50,969 - INFO - Avg. fwd time: 7.9577 / Avg. bwd time: 18.2395 / Avg. batch time: 593.7843 (ms) / GPU bubble ratio: 29.41%
[rank0]:2025-11-16 04:11:51,050 - INFO - Avg. fwd time: 8.2365 / Avg. bwd time: 20.0019 / Avg. batch time: 664.7448 (ms) / GPU bubble ratio: 32.03%
[rank2]:2025-11-16 04:11:51,079 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3061  memory: 43.49GiB(31.10%)  tps: 6,013  tflops: 280.46  mfu: 28.36%
[rank1]:2025-11-16 04:11:51,011 - INFO - Avg. fwd time: 8.1631 / Avg. bwd time: 20.5762 / Avg. batch time: 635.8271 (ms) / GPU bubble ratio: 27.68%
[rank1]:2025-11-16 04:11:51,081 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3061  memory: 53.51GiB(38.27%)  tps: 6,013  tflops: 280.46  mfu: 28.36%
[rank0]:2025-11-16 04:11:51,085 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.3061  memory: 59.45GiB(42.52%)  tps: 6,013  tflops: 280.46  mfu: 28.36%
[rank3]:2025-11-16 04:11:51,083 - INFO -  step: 1800  loss:  0.0768  grad_norm:  0.3061  memory: 51.85GiB(37.08%)  tps: 6,013  tflops: 280.46  mfu: 28.36%
[rank3]:2025-11-16 04:11:51,320 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0411_real_step1800_rank3.svg
[rank3]:> Batch Time: 649.94 ms, GPU Bubble Ratio: 31.18%, 30.20%, 36.24%, 27.14%
[rank0]:2025-11-16 04:14:04,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:14:06,772 - INFO - Avg. fwd time: 7.6828 / Avg. bwd time: 22.6108 / Avg. batch time: 560.1657 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:14:06,792 - INFO - Avg. fwd time: 7.9560 / Avg. bwd time: 18.2383 / Avg. batch time: 593.6414 (ms) / GPU bubble ratio: 29.40%
[rank0]:2025-11-16 04:14:06,834 - INFO - Avg. fwd time: 8.2351 / Avg. bwd time: 19.9984 / Avg. batch time: 664.5919 (ms) / GPU bubble ratio: 32.03%
[rank1]:2025-11-16 04:14:06,839 - INFO - Avg. fwd time: 8.1608 / Avg. bwd time: 20.5747 / Avg. batch time: 635.6800 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-11-16 04:14:06,948 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5406  memory: 59.45GiB(42.52%)  tps: 6,030  tflops: 281.22  mfu: 28.43%
[rank3]:2025-11-16 04:14:06,946 - INFO -  step: 1850  loss:  0.3564  grad_norm:  0.5406  memory: 51.85GiB(37.08%)  tps: 6,030  tflops: 281.22  mfu: 28.44%
[rank2]:2025-11-16 04:14:06,942 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5406  memory: 43.49GiB(31.10%)  tps: 6,030  tflops: 281.22  mfu: 28.44%
[rank1]:2025-11-16 04:14:06,944 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5406  memory: 53.51GiB(38.27%)  tps: 6,030  tflops: 281.22  mfu: 28.43%
[rank0]:2025-11-16 04:16:19,409 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 04:16:21,986 - INFO - Avg. fwd time: 7.9529 / Avg. bwd time: 18.2364 / Avg. batch time: 593.4115 (ms) / GPU bubble ratio: 29.39%
[rank3]:2025-11-16 04:16:21,966 - INFO - Avg. fwd time: 7.6782 / Avg. bwd time: 22.6026 / Avg. batch time: 559.9345 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-16 04:16:22,028 - INFO - Avg. fwd time: 8.2327 / Avg. bwd time: 19.9947 / Avg. batch time: 664.3488 (ms) / GPU bubble ratio: 32.02%
[rank1]:2025-11-16 04:16:22,033 - INFO - Avg. fwd time: 8.1571 / Avg. bwd time: 20.5721 / Avg. batch time: 635.4439 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-16 04:16:22,142 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3011  memory: 59.45GiB(42.52%)  tps: 6,059  tflops: 282.61  mfu: 28.58%
[rank2]:2025-11-16 04:16:22,136 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3011  memory: 43.49GiB(31.10%)  tps: 6,059  tflops: 282.61  mfu: 28.58%
[rank3]:2025-11-16 04:16:22,140 - INFO -  step: 1900  loss:  0.2041  grad_norm:  0.3011  memory: 51.85GiB(37.08%)  tps: 6,059  tflops: 282.62  mfu: 28.58%
[rank1]:2025-11-16 04:16:22,139 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.3011  memory: 53.51GiB(38.27%)  tps: 6,059  tflops: 282.61  mfu: 28.58%
[rank3]:2025-11-16 04:16:22,392 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0416_real_step1900_rank3.svg
[rank3]:> Batch Time: 655.03 ms, GPU Bubble Ratio: 31.29%, 30.32%, 36.40%, 26.94%
[rank0]:2025-11-16 04:18:35,049 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-16 04:18:37,695 - INFO - Avg. fwd time: 7.6748 / Avg. bwd time: 22.5986 / Avg. batch time: 559.7905 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-16 04:18:37,733 - INFO - Avg. fwd time: 7.9499 / Avg. bwd time: 18.2343 / Avg. batch time: 593.2839 (ms) / GPU bubble ratio: 29.39%
[rank1]:2025-11-16 04:18:37,776 - INFO - Avg. fwd time: 8.1537 / Avg. bwd time: 20.5693 / Avg. batch time: 635.3113 (ms) / GPU bubble ratio: 27.66%
[rank0]:2025-11-16 04:18:37,816 - INFO - Avg. fwd time: 8.2300 / Avg. bwd time: 19.9933 / Avg. batch time: 664.2134 (ms) / GPU bubble ratio: 32.01%
[rank0]:2025-11-16 04:18:37,852 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2698  memory: 59.45GiB(42.52%)  tps: 6,036  tflops: 281.54  mfu: 28.47%
[rank2]:2025-11-16 04:18:37,845 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2698  memory: 43.49GiB(31.10%)  tps: 6,036  tflops: 281.54  mfu: 28.47%
[rank1]:2025-11-16 04:18:37,848 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.2698  memory: 53.51GiB(38.27%)  tps: 6,036  tflops: 281.54  mfu: 28.47%
[rank3]:2025-11-16 04:18:37,849 - INFO -  step: 1950  loss:  0.1739  grad_norm:  0.2698  memory: 51.85GiB(37.08%)  tps: 6,036  tflops: 281.54  mfu: 28.47%
[rank0]:2025-11-16 04:20:50,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-16 04:20:53,215 - INFO - Avg. fwd time: 7.9474 / Avg. bwd time: 18.2326 / Avg. batch time: 593.1608 (ms) / GPU bubble ratio: 29.38%
[rank3]:2025-11-16 04:20:53,194 - INFO - Avg. fwd time: 7.6721 / Avg. bwd time: 22.5958 / Avg. batch time: 559.6817 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-16 04:20:53,257 - INFO - Avg. fwd time: 8.2276 / Avg. bwd time: 19.9925 / Avg. batch time: 664.0811 (ms) / GPU bubble ratio: 32.01%
[rank1]:2025-11-16 04:20:53,261 - INFO - Avg. fwd time: 8.1509 / Avg. bwd time: 20.5670 / Avg. batch time: 635.1826 (ms) / GPU bubble ratio: 27.66%
[rank3]:2025-11-16 04:20:53,368 - INFO -  step: 2000  loss:  0.2088  grad_norm:  0.2574  memory: 51.85GiB(37.08%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank3]:2025-11-16 04:20:53,368 - INFO -  final step: 2000  loss:  0.2088  grad_norm:  0.2574  tps: 6,070  tflops: 283.11  mfu: 27.45%
[rank3]:2025-11-16 04:20:53,368 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 04:20:53,370 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2574  memory: 59.45GiB(42.52%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank0]:2025-11-16 04:20:53,370 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2574  tps: 6,068  tflops: 283.01  mfu: 27.44%
[rank0]:2025-11-16 04:20:53,370 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-16 04:20:53,378 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-11-16 04:20:53,364 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2574  memory: 43.49GiB(31.10%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank2]:2025-11-16 04:20:53,364 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2574  tps: 6,068  tflops: 283.00  mfu: 27.44%
[rank2]:2025-11-16 04:20:53,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-16 04:20:53,369 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-16 04:20:53,366 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2574  memory: 53.51GiB(38.27%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank1]:2025-11-16 04:20:53,366 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2574  tps: 6,068  tflops: 283.00  mfu: 27.44%
[rank1]:2025-11-16 04:20:53,367 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-16 04:20:53,370 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-16 04:20:53,374 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-16 04:21:03,889 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-16 04:21:03,922 - INFO - Destroying the purge thread.
[rank1]:2025-11-16 04:21:03,922 - INFO - Destroying the purge thread.
[rank0]:2025-11-16 04:21:03,921 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-16 04:21:04,153 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0421_real_final2000_rank3.svg
[rank3]:> Batch Time: 663.61 ms, GPU Bubble Ratio: 31.73%, 30.61%, 36.71%, 26.87%
[rank3]:2025-11-16 04:21:04,379 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251116_0421_thry_final2000_rank3.svg
[rank3]:> Batch Time: 455.90 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-16 04:21:04,380 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.69918
[rank3]:wandb:               final/avg_loss 0.20877
[rank3]:wandb:             final/avg_mfu(%) 27.45067
[rank3]:wandb:             final/avg_tflops 283.10524
[rank3]:wandb:    final/avg_throughput(tps) 6069.9885
[rank3]:wandb:              final/grad_norm 0.25736
[rank3]:wandb:               final/max_loss 0.20877
[rank3]:wandb:                    grad_norm 0.25736
[rank3]:wandb: loss_metrics/global_avg_loss 0.20877
[rank3]:wandb: loss_metrics/global_max_loss 0.20877
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1116_Interleaved1F1B_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/uvfvnshg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1116_Interleaved1F1B_nofreeze_h200/20251116-0248/wandb/run-20251116_024838-uvfvnshg/logs
[rank0]:2025-11-16 04:21:05,922 - INFO - Training completed
[rank0]:2025-11-16 04:21:05,922 - INFO - Destroying the purge thread.
[rank3]:2025-11-16 04:21:06,168 - INFO - Process group destroyed
[rank2]:2025-11-16 04:21:06,189 - INFO - Process group destroyed
[rank1]:2025-11-16 04:21:06,171 - INFO - Process group destroyed
[rank0]:2025-11-16 04:21:06,287 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.8', 'layers.6', 'layers.7', 'layers.4'}
[rank1]:Stage 5: Modules to keep: {'layers.24', 'layers.21', 'layers.22', 'layers.23'}
[rank2]:Stage 2: Modules to keep: {'layers.10', 'layers.9', 'layers.12', 'layers.11'}
[rank2]:Stage 6: Modules to keep: {'layers.26', 'layers.27', 'layers.28', 'layers.25'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'tok_embeddings', 'layers.1', 'layers.2'}
[rank0]:Stage 4: Modules to keep: {'layers.17', 'layers.19', 'layers.18', 'layers.20'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.16', 'layers.14', 'layers.15'}
[rank3]:Stage 7: Modules to keep: {'layers.29', 'output', 'layers.30', 'layers.31', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1116.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1116_Interleaved1F1B_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1116_Interleaved1F1B_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 11
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1116_Interleaved1F1B_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.01
[rank3]:		- percentile: 80
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
