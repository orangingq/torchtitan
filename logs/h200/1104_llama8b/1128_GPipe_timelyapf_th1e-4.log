
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Nov 28 14:50:11 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1128_GPipe_timelyapf_th1e-4.log
âœ”ï¸Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11
1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1128.toml --job.description="Llama 3.1 8B Experiment
1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
1116: everything same, but with seed=11
1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=1e-4 --freezing.max_freeze_ratio=0.7 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1128 14:50:13.033000 837411 site-packages/torch/distributed/run.py:811] 
W1128 14:50:13.033000 837411 site-packages/torch/distributed/run.py:811] *****************************************
W1128 14:50:13.033000 837411 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1128 14:50:13.033000 837411 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-11-28 14:50:19,940 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank0]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank0]:1116: everything same, but with seed=11
[rank0]:1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
[rank0]:"
[rank3]:2025-11-28 14:50:20,164 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
[rank3]:"
[rank2]:2025-11-28 14:50:20,231 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank2]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank2]:1116: everything same, but with seed=11
[rank2]:1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
[rank2]:"
[rank1]:2025-11-28 14:50:20,331 - INFO - Starting job: "Llama 3.1 8B Experiment
[rank1]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank1]:1116: everything same, but with seed=11
[rank1]:1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
[rank1]:"
[rank0]:2025-11-28 14:50:20,417 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-28 14:50:20,419 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 14:50:20,424 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-11-28 14:50:20,426 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-28 14:50:20,715 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank3]:2025-11-28 14:50:20,998 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-28 14:50:21,000 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-28 14:50:21,049 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-28 14:50:21,051 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-28 14:50:21,089 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-28 14:50:21,092 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-28 14:50:22,533 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-28 14:50:22,790 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-28 14:50:22,839 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-28 14:50:22,863 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-28 14:50:22,863 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-28 14:50:23,032 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-28 14:50:23,032 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-11-28 14:50:23,366 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-28 14:50:23,368 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-28 14:50:23,458 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-28 14:50:23,458 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-28 14:50:23,458 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-28 14:50:23,458 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-28 14:50:23,645 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-28 14:50:23,645 - INFO - CUDA memory usage for model: 7.31GiB(5.23%)
[rank2]:2025-11-28 14:50:23,644 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-28 14:50:23,644 - INFO - CUDA memory usage for model: 6.50GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 99xd5ziu
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1128_GPipe_timelyapf_th1e-4_h200/20251128-1450/wandb/run-20251128_145024-99xd5ziu
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1128_GPipe_timelyapf_th1e-4_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/99xd5ziu
[rank3]:2025-11-28 14:50:25,182 - INFO - WandB logging enabled
[rank3]:2025-11-28 14:50:25,183 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-28 14:50:25,255 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-28 14:50:25,255 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-28 14:50:25,436 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 14:50:25,436 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1128_GPipe_timelyapf_th1e-4_h200
[rank0]:2025-11-28 14:50:25,436 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 14:50:25,436 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2025-11-28 14:50:25,437 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank3]:2025-11-28 14:50:25,424 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-28 14:50:25,425 - INFO - CUDA memory usage for model: 7.65GiB(5.47%)
[rank3]:2025-11-28 14:50:25,436 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-28 14:50:25,437 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-28 14:50:36,053 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-28 14:50:36,053 - INFO - Finished loading the checkpoint in 10.62 seconds.
[rank0]:2025-11-28 14:50:36,053 - INFO - Training starts at step 1
[rank3]:2025-11-28 14:50:39,700 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 63.02GiB(45.07%)  tps: 1,132  tflops: 52.82  mfu: 5.34%
[rank3]:2025-11-28 14:50:39,700 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-28 14:50:39,715 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 65.15GiB(46.60%)  tps: 1,006  tflops: 46.94  mfu: 4.75%
[rank1]:2025-11-28 14:50:39,716 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 14:50:39,726 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 62.20GiB(44.49%)  tps: 970  tflops: 45.25  mfu: 4.58%
[rank0]:2025-11-28 14:50:39,726 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-28 14:50:39,711 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 57.99GiB(41.48%)  tps: 1,007  tflops: 46.95  mfu: 4.75%
[rank2]:2025-11-28 14:50:39,711 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-28 14:52:47,234 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 14:52:49,691 - INFO - Avg. fwd time: 14.4735 / Avg. bwd time: 42.6732 / Avg. batch time: 472.7256 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-28 14:52:49,788 - INFO - Avg. fwd time: 14.9740 / Avg. bwd time: 40.9663 / Avg. batch time: 585.7935 (ms) / GPU bubble ratio: 23.60%
[rank2]:2025-11-28 14:52:49,742 - INFO - Avg. fwd time: 13.1323 / Avg. bwd time: 36.1512 / Avg. batch time: 525.7682 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-11-28 14:52:49,820 - INFO - Avg. fwd time: 13.5848 / Avg. bwd time: 38.0494 / Avg. batch time: 641.4268 (ms) / GPU bubble ratio: 35.60%
[rank3]:2025-11-28 14:52:49,927 - INFO -  step: 50  loss:  9.4316  grad_norm: 5160.8081  memory: 78.25GiB(55.97%)  tps: 6,165  tflops: 287.53  mfu: 29.07%
[rank0]:2025-11-28 14:52:49,929 - INFO -  step: 50  loss: -4.0000  grad_norm: 5160.8081  memory: 72.03GiB(51.52%)  tps: 6,166  tflops: 287.58  mfu: 29.08%
[rank1]:2025-11-28 14:52:49,925 - INFO -  step: 50  loss: -4.0000  grad_norm: 5160.8081  memory: 69.31GiB(49.57%)  tps: 6,166  tflops: 287.56  mfu: 29.08%
[rank2]:2025-11-28 14:52:49,923 - INFO -  step: 50  loss: -4.0000  grad_norm: 5160.8081  memory: 61.71GiB(44.14%)  tps: 6,166  tflops: 287.56  mfu: 29.08%
[rank0]:2025-11-28 14:55:00,601 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 14:55:03,049 - INFO - Avg. fwd time: 14.5500 / Avg. bwd time: 42.9141 / Avg. batch time: 475.1499 (ms) / GPU bubble ratio: 3.25%
[rank2]:2025-11-28 14:55:03,100 - INFO - Avg. fwd time: 13.1267 / Avg. bwd time: 36.2271 / Avg. batch time: 527.8276 (ms) / GPU bubble ratio: 25.20%
[rank0]:2025-11-28 14:55:03,179 - INFO - Avg. fwd time: 13.5630 / Avg. bwd time: 38.1648 / Avg. batch time: 643.0078 (ms) / GPU bubble ratio: 35.64%
[rank1]:2025-11-28 14:55:03,147 - INFO - Avg. fwd time: 15.0075 / Avg. bwd time: 41.1315 / Avg. batch time: 587.6297 (ms) / GPU bubble ratio: 23.57%
[rank3]:2025-11-28 14:55:03,287 - INFO -  step: 100  loss:  4.4910  grad_norm: 90.5554  memory: 78.25GiB(55.97%)  tps: 6,143  tflops: 286.50  mfu: 28.97%
[rank3]:2025-11-28 14:55:03,287 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-28 14:55:03,285 - INFO -  step: 100  loss: -4.0000  grad_norm: 90.5554  memory: 69.31GiB(49.57%)  tps: 6,143  tflops: 286.50  mfu: 28.97%
[rank1]:2025-11-28 14:55:03,285 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-28 14:55:03,289 - INFO -  step: 100  loss: -4.0000  grad_norm: 90.5554  memory: 72.03GiB(51.52%)  tps: 6,143  tflops: 286.50  mfu: 28.97%
[rank0]:2025-11-28 14:55:03,289 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-28 14:55:03,282 - INFO -  step: 100  loss: -4.0000  grad_norm: 90.5554  memory: 61.71GiB(44.14%)  tps: 6,143  tflops: 286.50  mfu: 28.97%
[rank2]:2025-11-28 14:55:03,282 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-28 14:57:13,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 14:57:16,383 - INFO - Avg. fwd time: 14.5279 / Avg. bwd time: 43.0090 / Avg. batch time: 475.6873 (ms) / GPU bubble ratio: 3.24%
[rank2]:2025-11-28 14:57:16,425 - INFO - Avg. fwd time: 13.0792 / Avg. bwd time: 36.2831 / Avg. batch time: 528.2630 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-11-28 14:57:16,515 - INFO - Avg. fwd time: 13.5473 / Avg. bwd time: 38.2112 / Avg. batch time: 643.3113 (ms) / GPU bubble ratio: 35.63%
[rank1]:2025-11-28 14:57:16,472 - INFO - Avg. fwd time: 14.9958 / Avg. bwd time: 41.2072 / Avg. batch time: 588.0139 (ms) / GPU bubble ratio: 23.54%
[rank2]:2025-11-28 14:57:16,544 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.1020  memory: 61.71GiB(44.14%)  tps: 6,147  tflops: 286.71  mfu: 28.99%
[rank0]:2025-11-28 14:57:16,550 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.1020  memory: 72.03GiB(51.52%)  tps: 6,147  tflops: 286.71  mfu: 28.99%
[rank1]:2025-11-28 14:57:16,547 - INFO -  step: 150  loss: -4.0000  grad_norm: 30.1020  memory: 69.31GiB(49.57%)  tps: 6,147  tflops: 286.71  mfu: 28.99%
[rank3]:2025-11-28 14:57:16,549 - INFO -  step: 150  loss:  2.0076  grad_norm: 30.1020  memory: 78.25GiB(55.97%)  tps: 6,147  tflops: 286.72  mfu: 28.99%
[rank3]:2025-11-28 14:57:42,973 - INFO - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-28 14:58:09,618 - INFO - [Step 170] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-28 14:58:09,841 - INFO - [Step 170] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-28 14:58:26,253 - INFO - [Step 180] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-28 14:58:26,457 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1458_max_batch_time.svg
[rank3]:			> Batch Time: 628.45 ms, GPU Bubble Ratio: 33.72%, 28.05%, 36.98%, 26.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-12-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S0,MB4,F]  54-13-67ms     | [S0,MB5,F]  67-13-81ms     | [S0,MB6,F]  81-13-94ms     | [S0,MB7,F]  94-13-108ms    | [S0,MB0,B]  284-38-322ms   | [S0,MB1,B]  328-38-366ms   | [S0,MB2,B]  372-38-410ms   | [S0,MB3,B]  415-38-454ms   | [S0,MB4,B]  459-38-497ms   | [S0,MB5,B]  502-38-541ms   | [S0,MB6,B]  546-38-584ms   | [S0,MB7,B]  589-38-628ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-14-47ms     | [S1,MB2,F]  47-14-61ms     | [S1,MB3,F]  61-14-76ms     | [S1,MB4,F]  76-14-90ms     | [S1,MB5,F]  90-14-105ms    | [S1,MB6,F]  105-15-120ms   | [S1,MB7,F]  120-15-136ms   | [S1,MB0,B]  243-40-284ms   | [S1,MB1,B]  287-41-328ms   | [S1,MB2,B]  330-41-372ms   | [S1,MB3,B]  374-41-415ms   | [S1,MB4,B]  417-41-459ms   | [S1,MB5,B]  461-41-502ms   | [S1,MB6,B]  504-41-546ms   | [S1,MB7,B]  547-41-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  61-12-74ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  90-12-103ms    | [S2,MB5,F]  105-12-118ms   | [S2,MB6,F]  120-12-133ms   | [S2,MB7,F]  136-12-148ms   | [S2,MB0,B]  207-36-243ms   | [S2,MB1,B]  250-36-287ms   | [S2,MB2,B]  294-36-330ms   | [S2,MB3,B]  337-36-374ms   | [S2,MB4,B]  380-36-417ms   | [S2,MB5,B]  424-36-461ms   | [S2,MB6,B]  467-36-504ms   | [S2,MB7,B]  511-36-547ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  65-13-78ms     | [S3,MB2,F]  78-13-92ms     | [S3,MB3,F]  92-14-106ms    | [S3,MB4,F]  106-14-120ms   | [S3,MB5,F]  120-14-135ms   | [S3,MB6,F]  135-14-149ms   | [S3,MB7,F]  149-14-164ms   | [S3,MB0,B]  164-43-207ms   AFR(10):0.9846 | [S3,MB1,B]  207-43-250ms   AFR(10):0.9846 | [S3,MB2,B]  250-43-294ms   AFR(10):0.9846 | [S3,MB3,B]  294-43-337ms   AFR(10):0.9846 | [S3,MB4,B]  337-43-380ms   AFR(10):0.9846 | [S3,MB5,B]  380-43-424ms   AFR(10):0.9846 | [S3,MB6,B]  424-43-467ms   AFR(10):0.9846 | [S3,MB7,B]  467-43-511ms   AFR(10):0.9846
[rank3]:2025-11-28 14:58:26,580 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1458_min_batch_time.svg
[rank3]:			> Batch Time: 354.54 ms, GPU Bubble Ratio: 69.39%, 24.52%, 34.24%, 23.52%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-12-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S0,MB4,F]  54-13-67ms     | [S0,MB5,F]  67-13-81ms     | [S0,MB6,F]  81-13-94ms     | [S0,MB7,F]  94-13-108ms    | [S0,MB0,B]  217-0-217ms    | [S0,MB1,B]  236-0-236ms    | [S0,MB2,B]  256-0-256ms    | [S0,MB3,B]  276-0-276ms    | [S0,MB4,B]  295-0-295ms    | [S0,MB5,B]  315-0-315ms    | [S0,MB6,B]  335-0-335ms    | [S0,MB7,B]  354-0-354ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-14-47ms     | [S1,MB2,F]  47-14-61ms     | [S1,MB3,F]  61-14-76ms     | [S1,MB4,F]  76-14-90ms     | [S1,MB5,F]  90-14-105ms    | [S1,MB6,F]  105-15-120ms   | [S1,MB7,F]  120-15-136ms   | [S1,MB0,B]  199-18-217ms   | [S1,MB1,B]  218-18-236ms   | [S1,MB2,B]  238-18-256ms   | [S1,MB3,B]  257-18-276ms   | [S1,MB4,B]  277-18-295ms   | [S1,MB5,B]  296-18-315ms   | [S1,MB6,B]  316-18-335ms   | [S1,MB7,B]  335-18-354ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  61-12-74ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  90-12-103ms    | [S2,MB5,F]  105-12-118ms   | [S2,MB6,F]  120-12-133ms   | [S2,MB7,F]  136-12-148ms   | [S2,MB0,B]  183-16-199ms   | [S2,MB1,B]  202-16-218ms   | [S2,MB2,B]  222-16-238ms   | [S2,MB3,B]  241-16-257ms   | [S2,MB4,B]  261-16-277ms   | [S2,MB5,B]  280-16-296ms   | [S2,MB6,B]  300-16-316ms   | [S2,MB7,B]  319-16-335ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  65-13-78ms     | [S3,MB2,F]  78-13-92ms     | [S3,MB3,F]  92-14-106ms    | [S3,MB4,F]  106-14-120ms   | [S3,MB5,F]  120-14-135ms   | [S3,MB6,F]  135-14-149ms   | [S3,MB7,F]  149-14-164ms   | [S3,MB0,B]  164-19-183ms   AFR(10):0.9846 | [S3,MB1,B]  183-19-202ms   AFR(10):0.9846 | [S3,MB2,B]  202-19-222ms   AFR(10):0.9846 | [S3,MB3,B]  222-19-241ms   AFR(10):0.9846 | [S3,MB4,B]  241-19-261ms   AFR(10):0.9846 | [S3,MB5,B]  261-19-280ms   AFR(10):0.9846 | [S3,MB6,B]  280-19-300ms   AFR(10):0.9846 | [S3,MB7,B]  300-19-319ms   AFR(10):0.9846
[rank3]:2025-11-28 14:58:32,254 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1458_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 411.95 ms, GPU Bubble Ratio: 33.64%, 20.60%, 24.50%, 20.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-12-28ms     | [S0,MB2,F]  28-12-41ms     | [S0,MB3,F]  41-13-54ms     | [S0,MB4,F]  54-13-67ms     | [S0,MB5,F]  67-13-81ms     | [S0,MB6,F]  81-13-94ms     | [S0,MB7,F]  94-13-108ms    | [S0,MB0,B]  238-26-264ms   | [S0,MB1,B]  270-26-296ms   | [S0,MB2,B]  299-25-324ms   | [S0,MB3,B]  324-25-349ms   | [S0,MB4,B]  349-24-374ms   | [S0,MB5,B]  374-18-393ms   | [S0,MB6,B]  393-18-411ms   | [S0,MB7,B]  411-0-411ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-14-47ms     | [S1,MB2,F]  47-14-61ms     | [S1,MB3,F]  61-14-76ms     | [S1,MB4,F]  76-14-90ms     | [S1,MB5,F]  90-14-105ms    | [S1,MB6,F]  105-15-120ms   | [S1,MB7,F]  120-15-136ms   | [S1,MB0,B]  205-32-238ms   | [S1,MB1,B]  238-32-270ms   | [S1,MB2,B]  270-29-299ms   | [S1,MB3,B]  299-25-324ms   | [S1,MB4,B]  324-25-349ms   | [S1,MB5,B]  349-25-374ms   | [S1,MB6,B]  374-18-393ms   | [S1,MB7,B]  393-18-411ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  48-12-60ms     | [S2,MB2,F]  61-12-74ms     | [S2,MB3,F]  76-12-88ms     | [S2,MB4,F]  90-12-103ms    | [S2,MB5,F]  105-12-118ms   | [S2,MB6,F]  120-12-133ms   | [S2,MB7,F]  136-12-148ms   | [S2,MB0,B]  183-21-205ms   | [S2,MB1,B]  205-32-237ms   | [S2,MB2,B]  237-32-270ms   | [S2,MB3,B]  270-29-299ms   | [S2,MB4,B]  299-25-324ms   | [S2,MB5,B]  324-24-349ms   | [S2,MB6,B]  349-25-374ms   | [S2,MB7,B]  376-16-393ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  65-13-78ms     | [S3,MB2,F]  78-13-92ms     | [S3,MB3,F]  92-14-106ms    | [S3,MB4,F]  106-14-120ms   | [S3,MB5,F]  120-14-135ms   | [S3,MB6,F]  135-14-149ms   | [S3,MB7,F]  149-14-164ms   | [S3,MB0,B]  164-19-183ms   AFR(10):0.9846 | [S3,MB1,B]  183-19-202ms   AFR(10):0.9846 | [S3,MB2,B]  202-23-226ms   AFR(10):0.9846 | [S3,MB3,B]  226-43-270ms   AFR(10):0.9846 | [S3,MB4,B]  270-29-299ms   AFR(10):0.9846 | [S3,MB5,B]  299-19-318ms   AFR(10):0.9846 | [S3,MB6,B]  318-19-338ms   AFR(10):0.9846 | [S3,MB7,B]  338-38-376ms   AFR(10):0.9846
[rank3]:2025-11-28 14:58:32,254 - INFO - 	> Batch Time: 411.95 ms (Average Freeze Ratio: 0.59, Time Reduction Rate: 0.34)
[rank0]:2025-11-28 14:59:15,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 14:59:18,254 - INFO - Avg. fwd time: 13.2828 / Avg. bwd time: 34.1145 / Avg. batch time: 514.9006 (ms) / GPU bubble ratio: 26.36%
[rank3]:2025-11-28 14:59:18,220 - INFO - Avg. fwd time: 14.6476 / Avg. bwd time: 41.4408 / Avg. batch time: 464.5012 (ms) / GPU bubble ratio: 3.40%
[rank1]:2025-11-28 14:59:18,302 - INFO - Avg. fwd time: 15.2559 / Avg. bwd time: 38.7394 / Avg. batch time: 572.4812 (ms) / GPU bubble ratio: 24.55%
[rank0]:2025-11-28 14:59:18,322 - INFO - Avg. fwd time: 13.7671 / Avg. bwd time: 34.1278 / Avg. batch time: 623.6381 (ms) / GPU bubble ratio: 38.56%
[rank2]:2025-11-28 14:59:18,455 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.24/0.73, [MB1] 0.06/0.18, [MB2] 0.07/0.21, [MB3] 0.12/0.36, [MB4] 0.19/0.57, [MB5] 0.19/0.57, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank2]:2025-11-28 14:59:18,455 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.3864  memory: 78.00GiB(55.79%)  tps: 6,720  tflops: 313.41  mfu: 31.69%
[rank0]:2025-11-28 14:59:18,463 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.11/0.32, [MB1] 0.11/0.32, [MB2] 0.12/0.35, [MB3] 0.12/0.35, [MB4] 0.12/0.35, [MB5] 0.17/0.52, [MB6] 0.17/0.51, [MB7] 0.33/1.00
[rank0]:2025-11-28 14:59:18,464 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.3864  memory: 84.33GiB(60.32%)  tps: 6,720  tflops: 313.40  mfu: 31.69%
[rank3]:2025-11-28 14:59:18,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.27/0.81, [MB3] 0.00/0.00, [MB4] 0.20/0.59, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.07/0.20
[rank3]:2025-11-28 14:59:18,471 - INFO -  step: 200  loss:  0.5958  grad_norm:  8.3864  memory: 92.90GiB(66.45%)  tps: 6,719  tflops: 313.38  mfu: 31.69%
[rank1]:2025-11-28 14:59:18,461 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.11/0.34, [MB1] 0.13/0.39, [MB2] 0.17/0.52, [MB3] 0.24/0.71, [MB4] 0.24/0.72, [MB5] 0.24/0.72, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-28 14:59:18,462 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.3864  memory: 87.69GiB(62.72%)  tps: 6,719  tflops: 313.40  mfu: 31.69%
[rank2]:2025-11-28 14:59:18,530 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1459_stage2_step200.svg
[rank0]:2025-11-28 14:59:18,529 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1459_stage0_step200.svg
[rank3]:2025-11-28 14:59:18,598 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1459_real_step200_rank3.svg
[rank3]:			> Batch Time: 524.50 ms, GPU Bubble Ratio: 76.54%, 46.17%, 52.46%, 20.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB4,F]  60-15-76ms     | [S0,MB5,F]  76-15-91ms     | [S0,MB6,F]  91-15-107ms    | [S0,MB7,F]  107-15-122ms   | [S0,MB0,B]  260-0-260ms    | [S0,MB1,B]  295-0-295ms    | [S0,MB2,B]  332-0-332ms    | [S0,MB3,B]  372-0-372ms    | [S0,MB4,B]  411-0-411ms    | [S0,MB5,B]  447-0-447ms    | [S0,MB6,B]  483-0-483ms    | [S0,MB7,B]  524-0-524ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  49-16-66ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-102ms    | [S1,MB5,F]  102-17-119ms   | [S1,MB6,F]  120-17-137ms   | [S1,MB7,F]  137-17-155ms   | [S1,MB0,B]  241-18-260ms   | [S1,MB1,B]  277-18-295ms   | [S1,MB2,B]  313-18-331ms   | [S1,MB3,B]  354-18-372ms   | [S1,MB4,B]  393-18-411ms   | [S1,MB5,B]  428-18-446ms   | [S1,MB6,B]  464-18-482ms   | [S1,MB7,B]  506-18-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-14-64ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  84-14-99ms     | [S2,MB4,F]  102-15-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  137-14-152ms   | [S2,MB7,F]  155-14-170ms   | [S2,MB0,B]  221-16-238ms   | [S2,MB1,B]  258-16-274ms   | [S2,MB2,B]  296-16-313ms   | [S2,MB3,B]  337-16-354ms   | [S2,MB4,B]  376-16-392ms   | [S2,MB5,B]  412-16-428ms   | [S2,MB6,B]  448-16-464ms   | [S2,MB7,B]  489-16-505ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-13-79ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-113ms    | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  134-14-149ms   | [S3,MB6,F]  152-14-167ms   | [S3,MB7,F]  170-14-184ms   | [S3,MB0,B]  186-35-221ms   | [S3,MB1,B]  221-36-257ms   | [S3,MB2,B]  258-36-295ms   | [S3,MB3,B]  296-41-337ms   | [S3,MB4,B]  336-39-375ms   | [S3,MB5,B]  375-36-412ms   | [S3,MB6,B]  411-36-448ms   | [S3,MB7,B]  447-41-488ms  
[rank1]:2025-11-28 14:59:18,531 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1459_stage1_step200.svg
[rank3]:2025-11-28 14:59:18,643 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1459_stage3_step200.svg
[rank0]:2025-11-28 15:01:15,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 15:01:18,157 - INFO - Avg. fwd time: 13.4611 / Avg. bwd time: 32.2495 / Avg. batch time: 509.3759 (ms) / GPU bubble ratio: 28.21%
[rank3]:2025-11-28 15:01:18,137 - INFO - Avg. fwd time: 14.6533 / Avg. bwd time: 40.9891 / Avg. batch time: 460.8530 (ms) / GPU bubble ratio: 3.41%
[rank1]:2025-11-28 15:01:18,189 - INFO - Avg. fwd time: 15.4510 / Avg. bwd time: 36.6505 / Avg. batch time: 564.7162 (ms) / GPU bubble ratio: 26.19%
[rank0]:2025-11-28 15:01:18,208 - INFO - Avg. fwd time: 13.9312 / Avg. bwd time: 32.8495 / Avg. batch time: 614.5355 (ms) / GPU bubble ratio: 39.10%
[rank2]:2025-11-28 15:01:18,323 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.73, [MB1] 0.12/0.18, [MB2] 0.14/0.21, [MB3] 0.24/0.36, [MB4] 0.38/0.57, [MB5] 0.38/0.57, [MB6] 0.38/0.56, [MB7] 0.67/1.00
[rank2]:2025-11-28 15:01:18,324 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.8814  memory: 78.00GiB(55.79%)  tps: 6,834  tflops: 318.75  mfu: 32.23%
[rank3]:2025-11-28 15:01:18,355 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.54/0.81, [MB3] 0.00/0.00, [MB4] 0.39/0.59, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.13/0.20
[rank3]:2025-11-28 15:01:18,358 - INFO -  step: 250  loss:  0.2525  grad_norm:  0.8814  memory: 92.90GiB(66.45%)  tps: 6,833  tflops: 318.70  mfu: 32.22%
[rank1]:2025-11-28 15:01:18,329 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.23/0.34, [MB1] 0.26/0.39, [MB2] 0.35/0.52, [MB3] 0.48/0.71, [MB4] 0.48/0.72, [MB5] 0.48/0.72, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-28 15:01:18,330 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.8814  memory: 87.90GiB(62.87%)  tps: 6,834  tflops: 318.75  mfu: 32.23%
[rank0]:2025-11-28 15:01:18,336 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.32, [MB1] 0.21/0.32, [MB2] 0.23/0.35, [MB3] 0.23/0.35, [MB4] 0.24/0.35, [MB5] 0.34/0.52, [MB6] 0.34/0.51, [MB7] 0.67/1.00
[rank0]:2025-11-28 15:01:18,336 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.8814  memory: 86.29GiB(61.72%)  tps: 6,834  tflops: 318.74  mfu: 32.23%
[rank0]:2025-11-28 15:03:07,677 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:03:09,779 - INFO - Avg. fwd time: 14.6875 / Avg. bwd time: 40.1763 / Avg. batch time: 454.9988 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-11-28 15:03:09,803 - INFO - Avg. fwd time: 13.6627 / Avg. bwd time: 30.2100 / Avg. batch time: 501.4323 (ms) / GPU bubble ratio: 30.00%
[rank2]:2025-11-28 15:03:09,856 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.18/0.18, [MB2] 0.21/0.21, [MB3] 0.36/0.36, [MB4] 0.57/0.57, [MB5] 0.57/0.57, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank2]:2025-11-28 15:03:09,857 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1695  memory: 78.00GiB(55.79%)  tps: 7,345  tflops: 342.57  mfu: 34.64%
[rank1]:2025-11-28 15:03:09,827 - INFO - Avg. fwd time: 15.7110 / Avg. bwd time: 34.0389 / Avg. batch time: 554.0221 (ms) / GPU bubble ratio: 28.16%
[rank1]:2025-11-28 15:03:09,854 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.39/0.39, [MB2] 0.52/0.52, [MB3] 0.71/0.71, [MB4] 0.72/0.72, [MB5] 0.72/0.72, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-28 15:03:09,854 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1695  memory: 87.90GiB(62.87%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank3]:2025-11-28 15:03:09,896 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.81/0.81, [MB3] 0.00/0.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-28 15:03:09,899 - INFO -  step: 300  loss:  0.2799  grad_norm:  0.1695  memory: 92.90GiB(66.45%)  tps: 7,344  tflops: 342.55  mfu: 34.64%
[rank0]:2025-11-28 15:03:09,848 - INFO - Avg. fwd time: 14.1715 / Avg. bwd time: 30.4634 / Avg. batch time: 601.4119 (ms) / GPU bubble ratio: 40.63%
[rank0]:2025-11-28 15:03:09,854 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.32, [MB1] 0.32/0.32, [MB2] 0.35/0.35, [MB3] 0.35/0.35, [MB4] 0.35/0.35, [MB5] 0.52/0.52, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-28 15:03:09,855 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1695  memory: 90.20GiB(64.51%)  tps: 7,346  tflops: 342.61  mfu: 34.64%
[rank2]:2025-11-28 15:03:09,945 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1503_stage2_step300.svg
[rank1]:2025-11-28 15:03:09,946 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1503_stage1_step300.svg
[rank0]:2025-11-28 15:03:09,958 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1503_stage0_step300.svg
[rank3]:2025-11-28 15:03:10,031 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1503_real_step300_rank3.svg
[rank3]:			> Batch Time: 522.66 ms, GPU Bubble Ratio: 54.29%, 44.99%, 49.87%, 23.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  76-15-92ms     | [S0,MB6,F]  92-15-108ms    | [S0,MB7,F]  108-15-123ms   | [S0,MB0,B]  258-14-272ms   | [S0,MB1,B]  291-14-306ms   | [S0,MB2,B]  327-14-341ms   | [S0,MB3,B]  364-14-378ms   | [S0,MB4,B]  400-14-414ms   | [S0,MB5,B]  435-14-450ms   | [S0,MB6,B]  469-14-483ms   | [S0,MB7,B]  508-14-522ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  50-16-67ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-102ms    | [S1,MB5,F]  102-17-119ms   | [S1,MB6,F]  120-17-137ms   | [S1,MB7,F]  138-17-155ms   | [S1,MB0,B]  239-18-257ms   | [S1,MB1,B]  272-18-291ms   | [S1,MB2,B]  307-18-326ms   | [S1,MB3,B]  345-18-364ms   | [S1,MB4,B]  381-18-400ms   | [S1,MB5,B]  416-18-435ms   | [S1,MB6,B]  450-18-468ms   | [S1,MB7,B]  488-18-507ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-14-64ms     | [S2,MB2,F]  66-14-81ms     | [S2,MB3,F]  84-14-99ms     | [S2,MB4,F]  102-14-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  137-14-152ms   | [S2,MB7,F]  155-14-170ms   | [S2,MB0,B]  220-17-238ms   | [S2,MB1,B]  254-17-272ms   | [S2,MB2,B]  289-17-307ms   | [S2,MB3,B]  327-17-344ms   | [S2,MB4,B]  362-17-380ms   | [S2,MB5,B]  398-17-415ms   | [S2,MB6,B]  431-17-449ms   | [S2,MB7,B]  470-18-488ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-114ms    | [S3,MB4,F]  116-14-131ms   | [S3,MB5,F]  134-14-149ms   | [S3,MB6,F]  152-14-167ms   | [S3,MB7,F]  170-14-185ms   | [S3,MB0,B]  186-33-220ms   | [S3,MB1,B]  220-33-253ms   | [S3,MB2,B]  253-35-288ms   | [S3,MB3,B]  288-38-326ms   | [S3,MB4,B]  326-35-362ms   | [S3,MB5,B]  362-34-397ms   | [S3,MB6,B]  397-33-431ms   | [S3,MB7,B]  431-38-469ms  
[rank3]:2025-11-28 15:03:10,072 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1503_stage3_step300.svg
[rank0]:2025-11-28 15:04:51,904 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:04:53,525 - INFO - Avg. fwd time: 14.3497 / Avg. bwd time: 26.5007 / Avg. batch time: 588.8167 (ms) / GPU bubble ratio: 44.50%
[rank2]:2025-11-28 15:04:53,818 - INFO - Avg. fwd time: 13.8583 / Avg. bwd time: 28.3624 / Avg. batch time: 495.1377 (ms) / GPU bubble ratio: 31.78%
[rank3]:2025-11-28 15:04:53,826 - INFO - Avg. fwd time: 14.7204 / Avg. bwd time: 39.5091 / Avg. batch time: 450.5816 (ms) / GPU bubble ratio: 3.72%
[rank1]:2025-11-28 15:04:53,857 - INFO - Avg. fwd time: 15.9278 / Avg. bwd time: 31.9403 / Avg. batch time: 545.4930 (ms) / GPU bubble ratio: 29.80%
[rank2]:2025-11-28 15:04:53,923 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.18/0.18, [MB2] 0.21/0.21, [MB3] 0.36/0.36, [MB4] 0.57/0.57, [MB5] 0.57/0.57, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank2]:2025-11-28 15:04:53,940 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,871  tflops: 367.09  mfu: 37.12%
[rank3]:2025-11-28 15:04:53,982 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.81/0.81, [MB3] 0.00/0.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-28 15:04:53,985 - INFO -  step: 350  loss:  0.3273  grad_norm:  0.1070  memory: 92.90GiB(66.45%)  tps: 7,871  tflops: 367.08  mfu: 37.12%
[rank1]:2025-11-28 15:04:53,941 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.39/0.39, [MB2] 0.52/0.52, [MB3] 0.71/0.71, [MB4] 0.72/0.72, [MB5] 0.72/0.72, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-28 15:04:53,942 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,870  tflops: 367.07  mfu: 37.12%
[rank0]:2025-11-28 15:04:53,942 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.32, [MB1] 0.32/0.32, [MB2] 0.35/0.35, [MB3] 0.35/0.35, [MB4] 0.35/0.35, [MB5] 0.52/0.52, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-28 15:04:53,942 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,870  tflops: 367.07  mfu: 37.12%
[rank0]:2025-11-28 15:06:35,574 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:06:37,239 - INFO - Avg. fwd time: 14.5030 / Avg. bwd time: 23.0011 / Avg. batch time: 577.1153 (ms) / GPU bubble ratio: 48.01%
[rank2]:2025-11-28 15:06:37,532 - INFO - Avg. fwd time: 14.0284 / Avg. bwd time: 26.7335 / Avg. batch time: 488.9862 (ms) / GPU bubble ratio: 33.31%
[rank3]:2025-11-28 15:06:37,540 - INFO - Avg. fwd time: 14.7587 / Avg. bwd time: 38.8552 / Avg. batch time: 446.1337 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-11-28 15:06:37,572 - INFO - Avg. fwd time: 16.1137 / Avg. bwd time: 30.0905 / Avg. batch time: 537.3714 (ms) / GPU bubble ratio: 31.21%
[rank2]:2025-11-28 15:06:37,640 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.18/0.18, [MB2] 0.21/0.21, [MB3] 0.36/0.36, [MB4] 0.57/0.57, [MB5] 0.57/0.57, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank1]:2025-11-28 15:06:37,658 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.39/0.39, [MB2] 0.52/0.52, [MB3] 0.71/0.71, [MB4] 0.72/0.72, [MB5] 0.72/0.72, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-28 15:06:37,659 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,898  tflops: 368.38  mfu: 37.25%
[rank0]:2025-11-28 15:06:37,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.32, [MB1] 0.32/0.32, [MB2] 0.35/0.35, [MB3] 0.35/0.35, [MB4] 0.35/0.35, [MB5] 0.52/0.52, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-28 15:06:37,660 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,898  tflops: 368.38  mfu: 37.25%
[rank2]:2025-11-28 15:06:37,657 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,898  tflops: 368.38  mfu: 37.25%
[rank3]:2025-11-28 15:06:37,703 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.81/0.81, [MB3] 0.00/0.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-28 15:06:37,706 - INFO -  step: 400  loss:  0.2751  grad_norm:  0.0720  memory: 92.90GiB(66.45%)  tps: 7,898  tflops: 368.38  mfu: 37.25%
[rank1]:2025-11-28 15:06:37,757 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1506_stage1_step400.svg
[rank0]:2025-11-28 15:06:37,759 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1506_stage0_step400.svg
[rank2]:2025-11-28 15:06:37,756 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1506_stage2_step400.svg
[rank3]:2025-11-28 15:06:37,832 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1506_real_step400_rank3.svg
[rank3]:			> Batch Time: 501.75 ms, GPU Bubble Ratio: 75.34%, 43.82%, 50.33%, 20.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-46ms     | [S0,MB3,F]  45-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  76-15-92ms     | [S0,MB6,F]  92-15-108ms    | [S0,MB7,F]  108-15-123ms   | [S0,MB0,B]  255-0-255ms    | [S0,MB1,B]  289-0-289ms    | [S0,MB2,B]  323-0-323ms    | [S0,MB3,B]  361-0-361ms    | [S0,MB4,B]  396-0-396ms    | [S0,MB5,B]  430-0-430ms    | [S0,MB6,B]  463-0-463ms    | [S0,MB7,B]  501-0-501ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-102ms    | [S1,MB5,F]  102-17-119ms   | [S1,MB6,F]  120-17-137ms   | [S1,MB7,F]  138-17-155ms   | [S1,MB0,B]  237-17-255ms   | [S1,MB1,B]  271-17-289ms   | [S1,MB2,B]  305-17-323ms   | [S1,MB3,B]  342-17-360ms   | [S1,MB4,B]  378-17-396ms   | [S1,MB5,B]  411-17-429ms   | [S1,MB6,B]  445-17-463ms   | [S1,MB7,B]  483-17-501ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-64ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  84-15-99ms     | [S2,MB4,F]  102-15-117ms   | [S2,MB5,F]  120-15-135ms   | [S2,MB6,F]  138-15-153ms   | [S2,MB7,F]  155-15-171ms   | [S2,MB0,B]  221-16-237ms   | [S2,MB1,B]  254-16-270ms   | [S2,MB2,B]  288-16-304ms   | [S2,MB3,B]  326-16-342ms   | [S2,MB4,B]  362-16-378ms   | [S2,MB5,B]  395-16-411ms   | [S2,MB6,B]  428-16-444ms   | [S2,MB7,B]  467-16-483ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-114ms    | [S3,MB4,F]  117-14-132ms   | [S3,MB5,F]  135-14-149ms   | [S3,MB6,F]  153-14-168ms   | [S3,MB7,F]  171-14-185ms   | [S3,MB0,B]  187-32-220ms   | [S3,MB1,B]  220-33-254ms   | [S3,MB2,B]  254-34-288ms   | [S3,MB3,B]  288-37-326ms   | [S3,MB4,B]  325-35-361ms   | [S3,MB5,B]  361-33-394ms   | [S3,MB6,B]  394-33-428ms   | [S3,MB7,B]  428-38-466ms  
[rank3]:2025-11-28 15:06:37,878 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1506_stage3_step400.svg
[rank0]:2025-11-28 15:08:18,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:08:20,652 - INFO - Avg. fwd time: 14.7889 / Avg. bwd time: 38.3289 / Avg. batch time: 442.5026 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-11-28 15:08:20,674 - INFO - Avg. fwd time: 14.1600 / Avg. bwd time: 25.4846 / Avg. batch time: 484.0860 (ms) / GPU bubble ratio: 34.48%
[rank2]:2025-11-28 15:08:20,706 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,950  tflops: 370.77  mfu: 37.49%
[rank1]:2025-11-28 15:08:20,698 - INFO - Avg. fwd time: 16.2535 / Avg. bwd time: 28.6703 / Avg. batch time: 530.9578 (ms) / GPU bubble ratio: 32.31%
[rank3]:2025-11-28 15:08:20,753 - INFO -  step: 450  loss:  0.2996  grad_norm:  0.1069  memory: 92.90GiB(66.45%)  tps: 7,950  tflops: 370.78  mfu: 37.49%
[rank1]:2025-11-28 15:08:20,706 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,950  tflops: 370.78  mfu: 37.49%
[rank0]:2025-11-28 15:08:20,705 - INFO - Avg. fwd time: 14.6210 / Avg. bwd time: 20.3180 / Avg. batch time: 567.9519 (ms) / GPU bubble ratio: 50.79%
[rank0]:2025-11-28 15:08:20,709 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,950  tflops: 370.78  mfu: 37.49%
[rank0]:2025-11-28 15:10:02,471 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:10:04,118 - INFO - Avg. fwd time: 14.6990 / Avg. bwd time: 18.4713 / Avg. batch time: 562.0663 (ms) / GPU bubble ratio: 52.79%
[rank2]:2025-11-28 15:10:04,411 - INFO - Avg. fwd time: 14.2498 / Avg. bwd time: 24.6254 / Avg. batch time: 481.1443 (ms) / GPU bubble ratio: 35.36%
[rank3]:2025-11-28 15:10:04,419 - INFO - Avg. fwd time: 14.8043 / Avg. bwd time: 38.0267 / Avg. batch time: 440.4638 (ms) / GPU bubble ratio: 4.04%
[rank1]:2025-11-28 15:10:04,451 - INFO - Avg. fwd time: 16.3479 / Avg. bwd time: 27.6925 / Avg. batch time: 526.9712 (ms) / GPU bubble ratio: 33.14%
[rank1]:2025-11-28 15:10:04,538 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,890  tflops: 367.98  mfu: 37.21%
[rank0]:2025-11-28 15:10:04,539 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,890  tflops: 367.98  mfu: 37.21%
[rank2]:2025-11-28 15:10:04,536 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,890  tflops: 367.98  mfu: 37.21%
[rank1]:2025-11-28 15:10:04,630 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1510_stage1_step500.svg
[rank3]:2025-11-28 15:10:04,583 - INFO -  step: 500  loss:  0.2997  grad_norm:  0.0992  memory: 92.90GiB(66.45%)  tps: 7,890  tflops: 367.99  mfu: 37.21%
[rank0]:2025-11-28 15:10:04,634 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1510_stage0_step500.svg
[rank2]:2025-11-28 15:10:04,628 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1510_stage2_step500.svg
[rank3]:2025-11-28 15:10:04,709 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1510_real_step500_rank3.svg
[rank3]:			> Batch Time: 501.00 ms, GPU Bubble Ratio: 75.35%, 43.85%, 50.31%, 20.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  76-15-92ms     | [S0,MB6,F]  92-15-107ms    | [S0,MB7,F]  107-15-123ms   | [S0,MB0,B]  255-0-255ms    | [S0,MB1,B]  288-0-288ms    | [S0,MB2,B]  323-0-323ms    | [S0,MB3,B]  360-0-360ms    | [S0,MB4,B]  396-0-396ms    | [S0,MB5,B]  429-0-429ms    | [S0,MB6,B]  462-0-462ms    | [S0,MB7,B]  501-0-501ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  49-16-66ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-102ms    | [S1,MB5,F]  102-17-120ms   | [S1,MB6,F]  120-17-137ms   | [S1,MB7,F]  138-17-155ms   | [S1,MB0,B]  236-17-254ms   | [S1,MB1,B]  270-17-288ms   | [S1,MB2,B]  304-17-322ms   | [S1,MB3,B]  342-17-360ms   | [S1,MB4,B]  377-17-395ms   | [S1,MB5,B]  410-17-428ms   | [S1,MB6,B]  444-17-462ms   | [S1,MB7,B]  482-17-500ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-64ms     | [S2,MB2,F]  66-15-81ms     | [S2,MB3,F]  84-15-99ms     | [S2,MB4,F]  102-15-117ms   | [S2,MB5,F]  119-15-135ms   | [S2,MB6,F]  137-15-152ms   | [S2,MB7,F]  155-15-170ms   | [S2,MB0,B]  220-15-236ms   | [S2,MB1,B]  253-16-269ms   | [S2,MB2,B]  288-16-304ms   | [S2,MB3,B]  325-16-341ms   | [S2,MB4,B]  361-16-377ms   | [S2,MB5,B]  394-16-410ms   | [S2,MB6,B]  428-15-444ms   | [S2,MB7,B]  466-16-482ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  65-14-80ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-114ms    | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  134-14-149ms   | [S3,MB6,F]  152-14-167ms   | [S3,MB7,F]  170-14-185ms   | [S3,MB0,B]  187-32-219ms   | [S3,MB1,B]  220-33-253ms   | [S3,MB2,B]  253-34-287ms   | [S3,MB3,B]  287-37-325ms   | [S3,MB4,B]  325-35-360ms   | [S3,MB5,B]  360-33-393ms   | [S3,MB6,B]  393-33-427ms   | [S3,MB7,B]  427-38-465ms  
[rank3]:2025-11-28 15:10:04,750 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1510_stage3_step500.svg
[rank0]:2025-11-28 15:11:46,769 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 15:11:48,421 - INFO - Avg. fwd time: 14.7744 / Avg. bwd time: 16.7004 / Avg. batch time: 556.7216 (ms) / GPU bubble ratio: 54.77%
[rank2]:2025-11-28 15:11:48,719 - INFO - Avg. fwd time: 14.3338 / Avg. bwd time: 23.7995 / Avg. batch time: 478.6261 (ms) / GPU bubble ratio: 36.26%
[rank1]:2025-11-28 15:11:48,758 - INFO - Avg. fwd time: 16.4382 / Avg. bwd time: 26.7538 / Avg. batch time: 523.4499 (ms) / GPU bubble ratio: 33.99%
[rank3]:2025-11-28 15:11:48,727 - INFO - Avg. fwd time: 14.8089 / Avg. bwd time: 37.7739 / Avg. batch time: 438.7855 (ms) / GPU bubble ratio: 4.13%
[rank0]:2025-11-28 15:11:48,846 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,854  tflops: 366.30  mfu: 37.04%
[rank2]:2025-11-28 15:11:48,844 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,854  tflops: 366.30  mfu: 37.04%
[rank1]:2025-11-28 15:11:48,846 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,854  tflops: 366.30  mfu: 37.04%
[rank3]:2025-11-28 15:11:48,894 - INFO -  step: 550  loss:  0.1730  grad_norm:  0.0860  memory: 92.90GiB(66.45%)  tps: 7,854  tflops: 366.29  mfu: 37.04%
[rank0]:2025-11-28 15:13:32,153 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-28 15:13:34,275 - INFO - Avg. fwd time: 14.4148 / Avg. bwd time: 23.1242 / Avg. batch time: 476.7529 (ms) / GPU bubble ratio: 37.01%
[rank1]:2025-11-28 15:13:34,300 - INFO - Avg. fwd time: 16.5274 / Avg. bwd time: 25.9850 / Avg. batch time: 520.7671 (ms) / GPU bubble ratio: 34.69%
[rank3]:2025-11-28 15:13:34,251 - INFO - Avg. fwd time: 14.8304 / Avg. bwd time: 37.5752 / Avg. batch time: 437.6143 (ms) / GPU bubble ratio: 4.20%
[rank0]:2025-11-28 15:13:34,309 - INFO - Avg. fwd time: 14.8483 / Avg. bwd time: 15.2394 / Avg. batch time: 552.5532 (ms) / GPU bubble ratio: 56.44%
[rank0]:2025-11-28 15:13:34,313 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,767  tflops: 362.27  mfu: 36.63%
[rank2]:2025-11-28 15:13:34,311 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,767  tflops: 362.27  mfu: 36.63%
[rank1]:2025-11-28 15:13:34,310 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,768  tflops: 362.28  mfu: 36.63%
[rank1]:2025-11-28 15:13:34,407 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1513_stage1_step600.svg
[rank3]:2025-11-28 15:13:34,359 - INFO -  step: 600  loss:  0.4086  grad_norm:  0.1155  memory: 92.90GiB(66.45%)  tps: 7,768  tflops: 362.28  mfu: 36.63%
[rank0]:2025-11-28 15:13:34,409 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1513_stage0_step600.svg
[rank2]:2025-11-28 15:13:34,407 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1513_stage2_step600.svg
[rank3]:2025-11-28 15:13:34,486 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1513_real_step600_rank3.svg
[rank3]:			> Batch Time: 512.00 ms, GPU Bubble Ratio: 75.34%, 44.30%, 50.68%, 20.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-46ms     | [S0,MB3,F]  46-15-62ms     | [S0,MB4,F]  62-15-78ms     | [S0,MB5,F]  78-15-94ms     | [S0,MB6,F]  94-16-110ms    | [S0,MB7,F]  110-16-126ms   | [S0,MB0,B]  261-0-261ms    | [S0,MB1,B]  295-0-295ms    | [S0,MB2,B]  330-0-330ms    | [S0,MB3,B]  368-0-368ms    | [S0,MB4,B]  404-0-404ms    | [S0,MB5,B]  438-0-438ms    | [S0,MB6,B]  473-0-473ms    | [S0,MB7,B]  512-0-512ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-68ms     | [S1,MB3,F]  68-17-86ms     | [S1,MB4,F]  86-17-104ms    | [S1,MB5,F]  104-17-122ms   | [S1,MB6,F]  122-17-140ms   | [S1,MB7,F]  141-17-158ms   | [S1,MB0,B]  242-18-260ms   | [S1,MB1,B]  276-18-294ms   | [S1,MB2,B]  311-18-329ms   | [S1,MB3,B]  349-18-367ms   | [S1,MB4,B]  385-18-403ms   | [S1,MB5,B]  420-18-438ms   | [S1,MB6,B]  454-18-472ms   | [S1,MB7,B]  493-18-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  68-15-83ms     | [S2,MB3,F]  86-15-101ms    | [S2,MB4,F]  104-15-119ms   | [S2,MB5,F]  122-15-137ms   | [S2,MB6,F]  140-15-156ms   | [S2,MB7,F]  158-15-174ms   | [S2,MB0,B]  225-16-242ms   | [S2,MB1,B]  260-16-276ms   | [S2,MB2,B]  295-16-311ms   | [S2,MB3,B]  333-16-349ms   | [S2,MB4,B]  369-16-385ms   | [S2,MB5,B]  403-16-419ms   | [S2,MB6,B]  438-16-454ms   | [S2,MB7,B]  477-16-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  67-14-81ms     | [S3,MB2,F]  83-14-98ms     | [S3,MB3,F]  101-15-116ms   | [S3,MB4,F]  119-15-134ms   | [S3,MB5,F]  137-15-152ms   | [S3,MB6,F]  155-15-171ms   | [S3,MB7,F]  174-15-189ms   | [S3,MB0,B]  191-33-225ms   | [S3,MB1,B]  225-34-259ms   | [S3,MB2,B]  259-34-294ms   | [S3,MB3,B]  294-38-333ms   | [S3,MB4,B]  333-36-369ms   | [S3,MB5,B]  369-34-403ms   | [S3,MB6,B]  403-34-437ms   | [S3,MB7,B]  437-39-476ms  
[rank3]:2025-11-28 15:13:34,529 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1513_stage3_step600.svg
[rank0]:2025-11-28 15:15:18,552 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 15:15:20,242 - INFO - Avg. fwd time: 14.9139 / Avg. bwd time: 14.1764 / Avg. batch time: 549.5927 (ms) / GPU bubble ratio: 57.66%
[rank2]:2025-11-28 15:15:20,545 - INFO - Avg. fwd time: 14.4843 / Avg. bwd time: 22.6369 / Avg. batch time: 475.4416 (ms) / GPU bubble ratio: 37.54%
[rank3]:2025-11-28 15:15:20,553 - INFO - Avg. fwd time: 14.8614 / Avg. bwd time: 37.4200 / Avg. batch time: 436.7738 (ms) / GPU bubble ratio: 4.24%
[rank1]:2025-11-28 15:15:20,586 - INFO - Avg. fwd time: 16.6031 / Avg. bwd time: 25.4294 / Avg. batch time: 518.8791 (ms) / GPU bubble ratio: 35.20%
[rank2]:2025-11-28 15:15:20,671 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,702  tflops: 359.23  mfu: 36.32%
[rank1]:2025-11-28 15:15:20,673 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank0]:2025-11-28 15:15:20,673 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,702  tflops: 359.23  mfu: 36.32%
[rank3]:2025-11-28 15:15:20,721 - INFO -  step: 650  loss:  0.2884  grad_norm:  0.1141  memory: 92.90GiB(66.45%)  tps: 7,702  tflops: 359.23  mfu: 36.32%
[rank0]:2025-11-28 15:17:04,519 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:17:06,231 - INFO - Avg. fwd time: 14.9761 / Avg. bwd time: 13.1096 / Avg. batch time: 546.5282 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-11-28 15:17:06,538 - INFO - Avg. fwd time: 14.5526 / Avg. bwd time: 22.1481 / Avg. batch time: 474.0416 (ms) / GPU bubble ratio: 38.06%
[rank1]:2025-11-28 15:17:06,577 - INFO - Avg. fwd time: 16.6760 / Avg. bwd time: 24.8711 / Avg. batch time: 516.8977 (ms) / GPU bubble ratio: 35.70%
[rank3]:2025-11-28 15:17:06,545 - INFO - Avg. fwd time: 14.8916 / Avg. bwd time: 37.2604 / Avg. batch time: 435.8764 (ms) / GPU bubble ratio: 4.28%
[rank2]:2025-11-28 15:17:06,664 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,729  tflops: 360.47  mfu: 36.45%
[rank1]:2025-11-28 15:17:06,666 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,729  tflops: 360.47  mfu: 36.45%
[rank0]:2025-11-28 15:17:06,667 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,729  tflops: 360.47  mfu: 36.45%
[rank2]:2025-11-28 15:17:06,765 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1517_stage2_step700.svg
[rank1]:2025-11-28 15:17:06,763 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1517_stage1_step700.svg
[rank3]:2025-11-28 15:17:06,713 - INFO -  step: 700  loss:  0.3752  grad_norm:  0.1035  memory: 92.90GiB(66.45%)  tps: 7,729  tflops: 360.48  mfu: 36.45%
[rank0]:2025-11-28 15:17:06,766 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1517_stage0_step700.svg
[rank3]:2025-11-28 15:17:06,838 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1517_real_step700_rank3.svg
[rank3]:			> Batch Time: 509.50 ms, GPU Bubble Ratio: 75.19%, 44.03%, 50.36%, 20.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-46ms     | [S0,MB3,F]  46-15-62ms     | [S0,MB4,F]  62-15-78ms     | [S0,MB5,F]  78-15-94ms     | [S0,MB6,F]  94-16-110ms    | [S0,MB7,F]  110-16-126ms   | [S0,MB0,B]  261-0-261ms    | [S0,MB1,B]  294-0-294ms    | [S0,MB2,B]  328-0-328ms    | [S0,MB3,B]  366-0-366ms    | [S0,MB4,B]  402-0-402ms    | [S0,MB5,B]  436-0-436ms    | [S0,MB6,B]  470-0-470ms    | [S0,MB7,B]  509-0-509ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-68ms     | [S1,MB3,F]  68-17-86ms     | [S1,MB4,F]  86-17-104ms    | [S1,MB5,F]  104-17-122ms   | [S1,MB6,F]  122-17-140ms   | [S1,MB7,F]  140-17-158ms   | [S1,MB0,B]  242-18-260ms   | [S1,MB1,B]  276-18-294ms   | [S1,MB2,B]  310-18-328ms   | [S1,MB3,B]  348-18-366ms   | [S1,MB4,B]  384-18-402ms   | [S1,MB5,B]  417-18-435ms   | [S1,MB6,B]  452-18-470ms   | [S1,MB7,B]  490-18-508ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  68-15-83ms     | [S2,MB3,F]  85-15-101ms    | [S2,MB4,F]  103-15-119ms   | [S2,MB5,F]  122-15-137ms   | [S2,MB6,F]  140-15-155ms   | [S2,MB7,F]  158-15-173ms   | [S2,MB0,B]  225-16-241ms   | [S2,MB1,B]  259-16-275ms   | [S2,MB2,B]  293-16-309ms   | [S2,MB3,B]  331-16-347ms   | [S2,MB4,B]  367-16-383ms   | [S2,MB5,B]  401-16-417ms   | [S2,MB6,B]  435-16-451ms   | [S2,MB7,B]  474-16-490ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  67-14-81ms     | [S3,MB2,F]  83-14-98ms     | [S3,MB3,F]  101-15-116ms   | [S3,MB4,F]  119-15-134ms   | [S3,MB5,F]  137-15-152ms   | [S3,MB6,F]  155-15-171ms   | [S3,MB7,F]  173-15-189ms   | [S3,MB0,B]  191-33-225ms   | [S3,MB1,B]  225-33-258ms   | [S3,MB2,B]  258-34-293ms   | [S3,MB3,B]  293-38-331ms   | [S3,MB4,B]  331-35-367ms   | [S3,MB5,B]  367-33-401ms   | [S3,MB6,B]  400-34-434ms   | [S3,MB7,B]  434-38-473ms  
[rank3]:2025-11-28 15:17:06,882 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1517_stage3_step700.svg
[rank0]:2025-11-28 15:18:50,279 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-28 15:18:52,436 - INFO - Avg. fwd time: 15.0273 / Avg. bwd time: 12.1922 / Avg. batch time: 543.8881 (ms) / GPU bubble ratio: 59.96%
[rank2]:2025-11-28 15:18:52,401 - INFO - Avg. fwd time: 14.6073 / Avg. bwd time: 21.7256 / Avg. batch time: 472.8352 (ms) / GPU bubble ratio: 38.53%
[rank2]:2025-11-28 15:18:52,438 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,745  tflops: 361.22  mfu: 36.52%
[rank1]:2025-11-28 15:18:52,426 - INFO - Avg. fwd time: 16.7357 / Avg. bwd time: 24.3900 / Avg. batch time: 515.1883 (ms) / GPU bubble ratio: 36.14%
[rank1]:2025-11-28 15:18:52,438 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,745  tflops: 361.23  mfu: 36.52%
[rank3]:2025-11-28 15:18:52,377 - INFO - Avg. fwd time: 14.9117 / Avg. bwd time: 37.1242 / Avg. batch time: 435.0854 (ms) / GPU bubble ratio: 4.32%
[rank0]:2025-11-28 15:18:52,441 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,745  tflops: 361.22  mfu: 36.52%
[rank3]:2025-11-28 15:18:52,487 - INFO -  step: 750  loss:  0.1429  grad_norm:  0.1019  memory: 92.90GiB(66.45%)  tps: 7,745  tflops: 361.22  mfu: 36.52%
[rank0]:2025-11-28 15:20:33,783 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:20:35,473 - INFO - Avg. fwd time: 15.0546 / Avg. bwd time: 11.5023 / Avg. batch time: 541.5211 (ms) / GPU bubble ratio: 60.77%
[rank2]:2025-11-28 15:20:35,774 - INFO - Avg. fwd time: 14.6400 / Avg. bwd time: 21.4045 / Avg. batch time: 471.5733 (ms) / GPU bubble ratio: 38.85%
[rank1]:2025-11-28 15:20:35,815 - INFO - Avg. fwd time: 16.7699 / Avg. bwd time: 24.0252 / Avg. batch time: 513.5362 (ms) / GPU bubble ratio: 36.45%
[rank3]:2025-11-28 15:20:35,782 - INFO - Avg. fwd time: 14.9187 / Avg. bwd time: 36.9925 / Avg. batch time: 434.1648 (ms) / GPU bubble ratio: 4.35%
[rank0]:2025-11-28 15:20:35,901 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,918  tflops: 369.30  mfu: 37.34%
[rank2]:2025-11-28 15:20:35,898 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,918  tflops: 369.30  mfu: 37.34%
[rank1]:2025-11-28 15:20:35,900 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,918  tflops: 369.29  mfu: 37.34%
[rank3]:2025-11-28 15:20:35,947 - INFO -  step: 800  loss:  0.2749  grad_norm:  0.0954  memory: 92.90GiB(66.45%)  tps: 7,918  tflops: 369.31  mfu: 37.34%
[rank0]:2025-11-28 15:20:36,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1520_stage0_step800.svg
[rank2]:2025-11-28 15:20:36,000 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1520_stage2_step800.svg
[rank1]:2025-11-28 15:20:35,998 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1520_stage1_step800.svg
[rank3]:2025-11-28 15:20:36,073 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1520_real_step800_rank3.svg
[rank3]:			> Batch Time: 497.00 ms, GPU Bubble Ratio: 75.14%, 43.32%, 49.83%, 20.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  76-15-92ms     | [S0,MB6,F]  92-15-107ms    | [S0,MB7,F]  107-15-123ms   | [S0,MB0,B]  255-0-255ms    | [S0,MB1,B]  288-0-288ms    | [S0,MB2,B]  321-0-321ms    | [S0,MB3,B]  358-0-358ms    | [S0,MB4,B]  393-0-393ms    | [S0,MB5,B]  425-0-425ms    | [S0,MB6,B]  459-0-459ms    | [S0,MB7,B]  497-0-497ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-102ms    | [S1,MB5,F]  102-17-119ms   | [S1,MB6,F]  120-17-137ms   | [S1,MB7,F]  138-17-155ms   | [S1,MB0,B]  237-17-255ms   | [S1,MB1,B]  270-17-288ms   | [S1,MB2,B]  303-17-321ms   | [S1,MB3,B]  340-17-357ms   | [S1,MB4,B]  374-17-392ms   | [S1,MB5,B]  407-17-425ms   | [S1,MB6,B]  440-17-458ms   | [S1,MB7,B]  478-17-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-64ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  84-15-99ms     | [S2,MB4,F]  102-15-117ms   | [S2,MB5,F]  119-15-135ms   | [S2,MB6,F]  137-15-152ms   | [S2,MB7,F]  155-15-170ms   | [S2,MB0,B]  220-16-237ms   | [S2,MB1,B]  253-16-269ms   | [S2,MB2,B]  286-16-302ms   | [S2,MB3,B]  323-16-339ms   | [S2,MB4,B]  358-16-374ms   | [S2,MB5,B]  391-16-407ms   | [S2,MB6,B]  424-16-440ms   | [S2,MB7,B]  462-16-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-114ms    | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  134-14-149ms   | [S3,MB6,F]  152-14-167ms   | [S3,MB7,F]  170-15-185ms   | [S3,MB0,B]  187-32-220ms   | [S3,MB1,B]  220-32-253ms   | [S3,MB2,B]  253-33-286ms   | [S3,MB3,B]  286-36-323ms   | [S3,MB4,B]  322-34-357ms   | [S3,MB5,B]  357-32-390ms   | [S3,MB6,B]  390-32-423ms   | [S3,MB7,B]  423-37-461ms  
[rank3]:2025-11-28 15:20:36,119 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1520_stage3_step800.svg
[rank0]:2025-11-28 15:22:18,129 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:22:19,744 - INFO - Avg. fwd time: 15.0899 / Avg. bwd time: 10.7900 / Avg. batch time: 539.2331 (ms) / GPU bubble ratio: 61.60%
[rank1]:2025-11-28 15:22:20,080 - INFO - Avg. fwd time: 16.8121 / Avg. bwd time: 23.6492 / Avg. batch time: 511.9750 (ms) / GPU bubble ratio: 36.78%
[rank3]:2025-11-28 15:22:20,048 - INFO - Avg. fwd time: 14.9298 / Avg. bwd time: 36.8639 / Avg. batch time: 433.3293 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-11-28 15:22:20,041 - INFO - Avg. fwd time: 14.6784 / Avg. bwd time: 21.0736 / Avg. batch time: 470.4095 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-11-28 15:22:20,166 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,857  tflops: 366.45  mfu: 37.05%
[rank1]:2025-11-28 15:22:20,164 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,857  tflops: 366.45  mfu: 37.05%
[rank3]:2025-11-28 15:22:20,210 - INFO -  step: 850  loss:  0.1344  grad_norm:  0.0969  memory: 92.90GiB(66.45%)  tps: 7,857  tflops: 366.46  mfu: 37.05%
[rank2]:2025-11-28 15:22:20,163 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,857  tflops: 366.45  mfu: 37.05%
[rank0]:2025-11-28 15:24:01,495 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-28 15:24:03,602 - INFO - Avg. fwd time: 16.8367 / Avg. bwd time: 23.3129 / Avg. batch time: 510.6059 (ms) / GPU bubble ratio: 37.09%
[rank3]:2025-11-28 15:24:03,552 - INFO - Avg. fwd time: 14.9207 / Avg. bwd time: 36.7716 / Avg. batch time: 432.6434 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-11-28 15:24:03,576 - INFO - Avg. fwd time: 14.7018 / Avg. bwd time: 20.7773 / Avg. batch time: 469.4027 (ms) / GPU bubble ratio: 39.53%
[rank2]:2025-11-28 15:24:03,614 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,919  tflops: 369.33  mfu: 37.34%
[rank0]:2025-11-28 15:24:03,613 - INFO - Avg. fwd time: 15.1093 / Avg. bwd time: 10.1608 / Avg. batch time: 537.2123 (ms) / GPU bubble ratio: 62.37%
[rank0]:2025-11-28 15:24:03,616 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,919  tflops: 369.33  mfu: 37.34%
[rank1]:2025-11-28 15:24:03,614 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,919  tflops: 369.34  mfu: 37.34%
[rank1]:2025-11-28 15:24:03,707 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1524_stage1_step900.svg
[rank3]:2025-11-28 15:24:03,663 - INFO -  step: 900  loss:  0.2022  grad_norm:  0.0905  memory: 92.90GiB(66.45%)  tps: 7,919  tflops: 369.33  mfu: 37.34%
[rank2]:2025-11-28 15:24:03,710 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1524_stage2_step900.svg
[rank0]:2025-11-28 15:24:03,723 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1524_stage0_step900.svg
[rank3]:2025-11-28 15:24:03,790 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1524_real_step900_rank3.svg
[rank3]:			> Batch Time: 506.25 ms, GPU Bubble Ratio: 75.48%, 44.32%, 50.70%, 20.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-46ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  77-15-92ms     | [S0,MB6,F]  92-15-108ms    | [S0,MB7,F]  108-15-124ms   | [S0,MB0,B]  256-0-256ms    | [S0,MB1,B]  290-0-290ms    | [S0,MB2,B]  325-0-325ms    | [S0,MB3,B]  362-0-362ms    | [S0,MB4,B]  397-0-397ms    | [S0,MB5,B]  431-0-431ms    | [S0,MB6,B]  466-0-466ms    | [S0,MB7,B]  506-0-506ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-17-49ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  85-17-102ms    | [S1,MB5,F]  102-17-120ms   | [S1,MB6,F]  120-17-138ms   | [S1,MB7,F]  138-17-156ms   | [S1,MB0,B]  238-17-256ms   | [S1,MB1,B]  272-17-290ms   | [S1,MB2,B]  306-17-324ms   | [S1,MB3,B]  344-17-361ms   | [S1,MB4,B]  379-17-397ms   | [S1,MB5,B]  413-17-431ms   | [S1,MB6,B]  448-17-465ms   | [S1,MB7,B]  488-17-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-64ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  84-15-100ms    | [S2,MB4,F]  102-15-117ms   | [S2,MB5,F]  120-15-135ms   | [S2,MB6,F]  138-15-153ms   | [S2,MB7,F]  156-15-171ms   | [S2,MB0,B]  222-16-238ms   | [S2,MB1,B]  255-16-271ms   | [S2,MB2,B]  290-16-306ms   | [S2,MB3,B]  327-16-343ms   | [S2,MB4,B]  363-16-379ms   | [S2,MB5,B]  397-16-413ms   | [S2,MB6,B]  431-16-447ms   | [S2,MB7,B]  471-16-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-96ms     | [S3,MB3,F]  99-14-114ms    | [S3,MB4,F]  117-14-132ms   | [S3,MB5,F]  135-14-150ms   | [S3,MB6,F]  153-14-167ms   | [S3,MB7,F]  171-14-186ms   | [S3,MB0,B]  188-33-221ms   | [S3,MB1,B]  221-33-255ms   | [S3,MB2,B]  255-34-290ms   | [S3,MB3,B]  289-38-328ms   | [S3,MB4,B]  327-35-362ms   | [S3,MB5,B]  362-34-396ms   | [S3,MB6,B]  396-34-430ms   | [S3,MB7,B]  431-39-470ms  
[rank3]:2025-11-28 15:24:03,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1524_stage3_step900.svg
[rank0]:2025-11-28 15:25:45,213 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:25:46,876 - INFO - Avg. fwd time: 15.1296 / Avg. bwd time: 9.6771 / Avg. batch time: 535.6210 (ms) / GPU bubble ratio: 62.95%
[rank3]:2025-11-28 15:25:47,188 - INFO - Avg. fwd time: 14.9269 / Avg. bwd time: 36.6843 / Avg. batch time: 432.0528 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-11-28 15:25:47,181 - INFO - Avg. fwd time: 14.7257 / Avg. bwd time: 20.5521 / Avg. batch time: 468.5872 (ms) / GPU bubble ratio: 39.77%
[rank1]:2025-11-28 15:25:47,220 - INFO - Avg. fwd time: 16.8624 / Avg. bwd time: 23.0570 / Avg. batch time: 509.5176 (ms) / GPU bubble ratio: 37.32%
[rank2]:2025-11-28 15:25:47,306 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,900  tflops: 368.47  mfu: 37.26%
[rank0]:2025-11-28 15:25:47,308 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,900  tflops: 368.48  mfu: 37.26%
[rank1]:2025-11-28 15:25:47,308 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,900  tflops: 368.47  mfu: 37.26%
[rank3]:2025-11-28 15:25:47,354 - INFO -  step: 950  loss:  0.2569  grad_norm:  0.1268  memory: 92.90GiB(66.45%)  tps: 7,900  tflops: 368.48  mfu: 37.26%
[rank0]:2025-11-28 15:27:29,438 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:27:31,060 - INFO - Avg. fwd time: 15.1556 / Avg. bwd time: 9.1679 / Avg. batch time: 534.1118 (ms) / GPU bubble ratio: 63.57%
[rank3]:2025-11-28 15:27:31,363 - INFO - Avg. fwd time: 14.9354 / Avg. bwd time: 36.6091 / Avg. batch time: 431.6007 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-11-28 15:27:31,356 - INFO - Avg. fwd time: 14.7546 / Avg. bwd time: 20.3170 / Avg. batch time: 467.8871 (ms) / GPU bubble ratio: 40.03%
[rank1]:2025-11-28 15:27:31,394 - INFO - Avg. fwd time: 16.8940 / Avg. bwd time: 22.7895 / Avg. batch time: 508.5352 (ms) / GPU bubble ratio: 37.57%
[rank1]:2025-11-28 15:27:31,477 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,864  tflops: 366.79  mfu: 37.09%
[rank1]:2025-11-28 15:27:31,477 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 15:27:31,474 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,864  tflops: 366.79  mfu: 37.09%
[rank2]:2025-11-28 15:27:31,475 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 15:27:31,477 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,864  tflops: 366.79  mfu: 37.09%
[rank0]:2025-11-28 15:27:31,477 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 15:27:31,477 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-28 15:27:31,521 - INFO -  step: 1000  loss:  0.1887  grad_norm:  0.1083  memory: 92.90GiB(66.45%)  tps: 7,864  tflops: 366.80  mfu: 37.09%
[rank3]:2025-11-28 15:27:31,522 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 15:27:43,414 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.94 seconds.
[rank1]:2025-11-28 15:27:44,921 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.44 seconds.
[rank3]:2025-11-28 15:27:45,717 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.20 seconds.
[rank0]:2025-11-28 15:27:46,695 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-28 15:27:46,700 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.22 seconds.
[rank0]:2025-11-28 15:27:46,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1527_stage0_step1000.svg
[rank1]:2025-11-28 15:27:46,753 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1527_stage1_step1000.svg
[rank2]:2025-11-28 15:27:46,753 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1527_stage2_step1000.svg
[rank3]:2025-11-28 15:27:46,852 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1527_real_step1000_rank3.svg
[rank3]:			> Batch Time: 503.75 ms, GPU Bubble Ratio: 75.26%, 43.83%, 50.32%, 20.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-46ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-77ms     | [S0,MB5,F]  77-15-93ms     | [S0,MB6,F]  93-15-108ms    | [S0,MB7,F]  108-15-124ms   | [S0,MB0,B]  257-0-257ms    | [S0,MB1,B]  290-0-290ms    | [S0,MB2,B]  325-0-325ms    | [S0,MB3,B]  362-0-362ms    | [S0,MB4,B]  398-0-398ms    | [S0,MB5,B]  431-0-431ms    | [S0,MB6,B]  465-0-465ms    | [S0,MB7,B]  503-0-503ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  67-17-85ms     | [S1,MB4,F]  85-17-102ms    | [S1,MB5,F]  103-17-120ms   | [S1,MB6,F]  121-17-138ms   | [S1,MB7,F]  139-17-156ms   | [S1,MB0,B]  238-17-256ms   | [S1,MB1,B]  272-17-290ms   | [S1,MB2,B]  306-17-324ms   | [S1,MB3,B]  344-17-362ms   | [S1,MB4,B]  379-17-397ms   | [S1,MB5,B]  413-17-431ms   | [S1,MB6,B]  446-17-464ms   | [S1,MB7,B]  485-17-503ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-65ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  85-15-100ms    | [S2,MB4,F]  102-15-118ms   | [S2,MB5,F]  120-15-135ms   | [S2,MB6,F]  138-15-154ms   | [S2,MB7,F]  156-15-172ms   | [S2,MB0,B]  222-16-238ms   | [S2,MB1,B]  255-16-271ms   | [S2,MB2,B]  290-16-306ms   | [S2,MB3,B]  327-16-343ms   | [S2,MB4,B]  363-16-379ms   | [S2,MB5,B]  396-16-412ms   | [S2,MB6,B]  430-16-446ms   | [S2,MB7,B]  468-16-484ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-97ms     | [S3,MB3,F]  100-14-115ms   | [S3,MB4,F]  118-14-132ms   | [S3,MB5,F]  135-15-150ms   | [S3,MB6,F]  153-14-168ms   | [S3,MB7,F]  172-15-187ms   | [S3,MB0,B]  188-32-221ms   | [S3,MB1,B]  221-33-255ms   | [S3,MB2,B]  255-34-289ms   | [S3,MB3,B]  289-37-327ms   | [S3,MB4,B]  327-35-362ms   | [S3,MB5,B]  362-33-396ms   | [S3,MB6,B]  396-33-429ms   | [S3,MB7,B]  429-38-468ms  
[rank3]:2025-11-28 15:27:46,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1527_stage3_step1000.svg
[rank0]:2025-11-28 15:29:31,448 - INFO - [GC] Peforming periodical GC collection 2.09 seconds
[rank3]:2025-11-28 15:29:33,617 - INFO - Avg. fwd time: 14.9334 / Avg. bwd time: 36.5429 / Avg. batch time: 431.2723 (ms) / GPU bubble ratio: 4.51%
[rank2]:2025-11-28 15:29:33,643 - INFO - Avg. fwd time: 14.7767 / Avg. bwd time: 20.1037 / Avg. batch time: 467.3405 (ms) / GPU bubble ratio: 40.29%
[rank2]:2025-11-28 15:29:33,682 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 6,703  tflops: 312.65  mfu: 31.61%
[rank0]:2025-11-28 15:29:33,681 - INFO - Avg. fwd time: 15.1764 / Avg. bwd time: 8.7097 / Avg. batch time: 532.8476 (ms) / GPU bubble ratio: 64.14%
[rank0]:2025-11-28 15:29:33,685 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 6,703  tflops: 312.65  mfu: 31.61%
[rank1]:2025-11-28 15:29:33,670 - INFO - Avg. fwd time: 16.9157 / Avg. bwd time: 22.5463 / Avg. batch time: 507.7294 (ms) / GPU bubble ratio: 37.82%
[rank1]:2025-11-28 15:29:33,682 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 6,703  tflops: 312.65  mfu: 31.61%
[rank3]:2025-11-28 15:29:33,730 - INFO -  step: 1050  loss:  0.2901  grad_norm:  0.1105  memory: 92.90GiB(66.45%)  tps: 6,703  tflops: 312.65  mfu: 31.61%
[rank0]:2025-11-28 15:31:18,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:31:20,561 - INFO - Avg. fwd time: 15.2046 / Avg. bwd time: 8.3519 / Avg. batch time: 532.1876 (ms) / GPU bubble ratio: 64.59%
[rank3]:2025-11-28 15:31:20,865 - INFO - Avg. fwd time: 14.9511 / Avg. bwd time: 36.5234 / Avg. batch time: 431.3201 (ms) / GPU bubble ratio: 4.53%
[rank2]:2025-11-28 15:31:20,857 - INFO - Avg. fwd time: 14.8076 / Avg. bwd time: 19.9423 / Avg. batch time: 467.2271 (ms) / GPU bubble ratio: 40.50%
[rank1]:2025-11-28 15:31:20,896 - INFO - Avg. fwd time: 16.9494 / Avg. bwd time: 22.3620 / Avg. batch time: 507.4301 (ms) / GPU bubble ratio: 38.02%
[rank2]:2025-11-28 15:31:20,978 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,635  tflops: 356.10  mfu: 36.01%
[rank1]:2025-11-28 15:31:20,981 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,635  tflops: 356.09  mfu: 36.00%
[rank0]:2025-11-28 15:31:20,980 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,635  tflops: 356.10  mfu: 36.01%
[rank3]:2025-11-28 15:31:21,026 - INFO -  step: 1100  loss:  0.2356  grad_norm:  0.0895  memory: 92.90GiB(66.45%)  tps: 7,635  tflops: 356.10  mfu: 36.01%
[rank2]:2025-11-28 15:31:21,076 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1531_stage2_step1100.svg
[rank1]:2025-11-28 15:31:21,078 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1531_stage1_step1100.svg
[rank0]:2025-11-28 15:31:21,077 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1531_stage0_step1100.svg
[rank3]:2025-11-28 15:31:21,155 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1531_real_step1100_rank3.svg
[rank3]:			> Batch Time: 525.00 ms, GPU Bubble Ratio: 75.74%, 45.37%, 51.60%, 19.94%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-47ms     | [S0,MB3,F]  47-15-62ms     | [S0,MB4,F]  62-15-78ms     | [S0,MB5,F]  78-16-94ms     | [S0,MB6,F]  95-16-111ms    | [S0,MB7,F]  111-16-127ms   | [S0,MB0,B]  264-0-264ms    | [S0,MB1,B]  299-0-299ms    | [S0,MB2,B]  335-0-335ms    | [S0,MB3,B]  374-0-374ms    | [S0,MB4,B]  412-0-412ms    | [S0,MB5,B]  447-0-447ms    | [S0,MB6,B]  483-0-483ms    | [S0,MB7,B]  525-0-525ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  51-17-68ms     | [S1,MB3,F]  69-17-86ms     | [S1,MB4,F]  87-17-105ms    | [S1,MB5,F]  105-18-123ms   | [S1,MB6,F]  123-18-141ms   | [S1,MB7,F]  142-18-160ms   | [S1,MB0,B]  245-18-263ms   | [S1,MB1,B]  280-18-299ms   | [S1,MB2,B]  316-18-335ms   | [S1,MB3,B]  356-18-374ms   | [S1,MB4,B]  393-18-411ms   | [S1,MB5,B]  428-18-446ms   | [S1,MB6,B]  465-18-483ms   | [S1,MB7,B]  507-18-525ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  50-15-66ms     | [S2,MB2,F]  68-15-84ms     | [S2,MB3,F]  86-15-102ms    | [S2,MB4,F]  104-15-120ms   | [S2,MB5,F]  123-15-138ms   | [S2,MB6,F]  141-15-157ms   | [S2,MB7,F]  160-15-175ms   | [S2,MB0,B]  229-16-245ms   | [S2,MB1,B]  264-16-280ms   | [S2,MB2,B]  300-16-316ms   | [S2,MB3,B]  339-16-355ms   | [S2,MB4,B]  377-16-393ms   | [S2,MB5,B]  412-16-428ms   | [S2,MB6,B]  449-16-465ms   | [S2,MB7,B]  491-16-507ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-17-65ms     | [S3,MB1,F]  67-14-82ms     | [S3,MB2,F]  84-14-99ms     | [S3,MB3,F]  102-14-117ms   | [S3,MB4,F]  120-15-135ms   | [S3,MB5,F]  138-15-153ms   | [S3,MB6,F]  157-15-172ms   | [S3,MB7,F]  175-15-191ms   | [S3,MB0,B]  193-35-228ms   | [S3,MB1,B]  228-35-264ms   | [S3,MB2,B]  263-36-300ms   | [S3,MB3,B]  299-39-338ms   | [S3,MB4,B]  339-37-376ms   | [S3,MB5,B]  376-35-412ms   | [S3,MB6,B]  412-36-448ms   | [S3,MB7,B]  449-41-490ms  
[rank3]:2025-11-28 15:31:21,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1531_stage3_step1100.svg
[rank0]:2025-11-28 15:33:03,624 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:33:05,286 - INFO - Avg. fwd time: 15.2234 / Avg. bwd time: 7.9700 / Avg. batch time: 531.0587 (ms) / GPU bubble ratio: 65.06%
[rank1]:2025-11-28 15:33:05,629 - INFO - Avg. fwd time: 16.9730 / Avg. bwd time: 22.1614 / Avg. batch time: 506.6965 (ms) / GPU bubble ratio: 38.21%
[rank3]:2025-11-28 15:33:05,598 - INFO - Avg. fwd time: 14.9575 / Avg. bwd time: 36.4664 / Avg. batch time: 430.9704 (ms) / GPU bubble ratio: 4.54%
[rank2]:2025-11-28 15:33:05,589 - INFO - Avg. fwd time: 14.8293 / Avg. bwd time: 19.7662 / Avg. batch time: 466.7061 (ms) / GPU bubble ratio: 40.70%
[rank0]:2025-11-28 15:33:05,713 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,822  tflops: 364.81  mfu: 36.89%
[rank1]:2025-11-28 15:33:05,713 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,822  tflops: 364.81  mfu: 36.89%
[rank3]:2025-11-28 15:33:05,760 - INFO -  step: 1150  loss:  0.2209  grad_norm:  0.0795  memory: 92.90GiB(66.45%)  tps: 7,822  tflops: 364.81  mfu: 36.89%
[rank2]:2025-11-28 15:33:05,711 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,822  tflops: 364.81  mfu: 36.89%
[rank0]:2025-11-28 15:34:47,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:34:49,947 - INFO - Avg. fwd time: 14.9618 / Avg. bwd time: 36.4096 / Avg. batch time: 430.6013 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-11-28 15:34:50,001 - INFO - Avg. fwd time: 16.9934 / Avg. bwd time: 21.9775 / Avg. batch time: 505.9648 (ms) / GPU bubble ratio: 38.38%
[rank1]:2025-11-28 15:34:50,012 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,854  tflops: 366.33  mfu: 37.04%
[rank2]:2025-11-28 15:34:49,973 - INFO - Avg. fwd time: 14.8481 / Avg. bwd time: 19.6042 / Avg. batch time: 466.1672 (ms) / GPU bubble ratio: 40.88%
[rank2]:2025-11-28 15:34:50,012 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,854  tflops: 366.32  mfu: 37.04%
[rank0]:2025-11-28 15:34:50,011 - INFO - Avg. fwd time: 15.2400 / Avg. bwd time: 7.6214 / Avg. batch time: 529.9684 (ms) / GPU bubble ratio: 65.49%
[rank0]:2025-11-28 15:34:50,014 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,854  tflops: 366.32  mfu: 37.04%
[rank1]:2025-11-28 15:34:50,112 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1534_stage1_step1200.svg
[rank3]:2025-11-28 15:34:50,062 - INFO -  step: 1200  loss:  0.2904  grad_norm:  0.0895  memory: 92.90GiB(66.45%)  tps: 7,854  tflops: 366.33  mfu: 37.04%
[rank2]:2025-11-28 15:34:50,113 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1534_stage2_step1200.svg
[rank0]:2025-11-28 15:34:50,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1534_stage0_step1200.svg
[rank3]:2025-11-28 15:34:50,190 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1534_real_step1200_rank3.svg
[rank3]:			> Batch Time: 512.00 ms, GPU Bubble Ratio: 75.61%, 44.60%, 51.00%, 20.44%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  30-15-46ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-77ms     | [S0,MB5,F]  77-15-93ms     | [S0,MB6,F]  93-15-108ms    | [S0,MB7,F]  108-15-124ms   | [S0,MB0,B]  259-0-259ms    | [S0,MB1,B]  293-0-293ms    | [S0,MB2,B]  328-0-328ms    | [S0,MB3,B]  367-0-367ms    | [S0,MB4,B]  403-0-403ms    | [S0,MB5,B]  437-0-437ms    | [S0,MB6,B]  472-0-472ms    | [S0,MB7,B]  512-0-512ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  68-17-85ms     | [S1,MB4,F]  85-17-103ms    | [S1,MB5,F]  103-17-121ms   | [S1,MB6,F]  121-17-139ms   | [S1,MB7,F]  139-17-157ms   | [S1,MB0,B]  240-18-258ms   | [S1,MB1,B]  274-17-292ms   | [S1,MB2,B]  310-17-328ms   | [S1,MB3,B]  349-17-367ms   | [S1,MB4,B]  385-17-403ms   | [S1,MB5,B]  419-18-437ms   | [S1,MB6,B]  454-18-472ms   | [S1,MB7,B]  493-17-511ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-48ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  85-15-100ms    | [S2,MB4,F]  103-15-118ms   | [S2,MB5,F]  121-15-136ms   | [S2,MB6,F]  139-15-154ms   | [S2,MB7,F]  157-15-172ms   | [S2,MB0,B]  223-16-240ms   | [S2,MB1,B]  258-16-274ms   | [S2,MB2,B]  293-16-309ms   | [S2,MB3,B]  332-16-348ms   | [S2,MB4,B]  368-16-384ms   | [S2,MB5,B]  403-16-419ms   | [S2,MB6,B]  437-16-454ms   | [S2,MB7,B]  477-16-493ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-64ms     | [S3,MB1,F]  66-14-81ms     | [S3,MB2,F]  83-14-97ms     | [S3,MB3,F]  100-14-115ms   | [S3,MB4,F]  118-14-133ms   | [S3,MB5,F]  136-14-151ms   | [S3,MB6,F]  154-14-169ms   | [S3,MB7,F]  172-14-187ms   | [S3,MB0,B]  189-33-223ms   | [S3,MB1,B]  223-34-257ms   | [S3,MB2,B]  257-36-293ms   | [S3,MB3,B]  293-38-332ms   | [S3,MB4,B]  332-36-368ms   | [S3,MB5,B]  368-34-402ms   | [S3,MB6,B]  402-34-437ms   | [S3,MB7,B]  437-39-476ms  
[rank3]:2025-11-28 15:34:50,235 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1534_stage3_step1200.svg
[rank0]:2025-11-28 15:36:31,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:36:33,421 - INFO - Avg. fwd time: 15.2515 / Avg. bwd time: 7.3461 / Avg. batch time: 529.0667 (ms) / GPU bubble ratio: 65.83%
[rank3]:2025-11-28 15:36:33,726 - INFO - Avg. fwd time: 14.9634 / Avg. bwd time: 36.3616 / Avg. batch time: 430.2652 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-11-28 15:36:33,717 - INFO - Avg. fwd time: 14.8614 / Avg. bwd time: 19.4762 / Avg. batch time: 465.7076 (ms) / GPU bubble ratio: 41.01%
[rank1]:2025-11-28 15:36:33,757 - INFO - Avg. fwd time: 17.0072 / Avg. bwd time: 21.8318 / Avg. batch time: 505.3493 (ms) / GPU bubble ratio: 38.52%
[rank2]:2025-11-28 15:36:33,838 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,890  tflops: 368.00  mfu: 37.21%
[rank0]:2025-11-28 15:36:33,840 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,890  tflops: 368.00  mfu: 37.21%
[rank1]:2025-11-28 15:36:33,840 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,890  tflops: 367.99  mfu: 37.21%
[rank3]:2025-11-28 15:36:33,885 - INFO -  step: 1250  loss:  0.2739  grad_norm:  0.1078  memory: 92.90GiB(66.45%)  tps: 7,890  tflops: 368.01  mfu: 37.21%
[rank0]:2025-11-28 15:38:16,789 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:38:18,455 - INFO - Avg. fwd time: 15.2654 / Avg. bwd time: 7.0490 / Avg. batch time: 528.2843 (ms) / GPU bubble ratio: 66.21%
[rank3]:2025-11-28 15:38:18,765 - INFO - Avg. fwd time: 14.9648 / Avg. bwd time: 36.3330 / Avg. batch time: 430.1066 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-11-28 15:38:18,756 - INFO - Avg. fwd time: 14.8771 / Avg. bwd time: 19.3382 / Avg. batch time: 465.4000 (ms) / GPU bubble ratio: 41.19%
[rank1]:2025-11-28 15:38:18,796 - INFO - Avg. fwd time: 17.0242 / Avg. bwd time: 21.6749 / Avg. batch time: 504.8747 (ms) / GPU bubble ratio: 38.68%
[rank2]:2025-11-28 15:38:18,878 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,799  tflops: 363.75  mfu: 36.78%
[rank0]:2025-11-28 15:38:18,880 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,799  tflops: 363.75  mfu: 36.78%
[rank1]:2025-11-28 15:38:18,880 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,799  tflops: 363.75  mfu: 36.78%
[rank1]:2025-11-28 15:38:18,976 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1538_stage1_step1300.svg
[rank3]:2025-11-28 15:38:18,928 - INFO -  step: 1300  loss:  0.2123  grad_norm:  0.1058  memory: 92.90GiB(66.45%)  tps: 7,799  tflops: 363.74  mfu: 36.78%
[rank2]:2025-11-28 15:38:18,976 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1538_stage2_step1300.svg
[rank0]:2025-11-28 15:38:18,980 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1538_stage0_step1300.svg
[rank3]:2025-11-28 15:38:19,055 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1538_real_step1300_rank3.svg
[rank3]:			> Batch Time: 507.00 ms, GPU Bubble Ratio: 75.67%, 44.62%, 51.01%, 20.32%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-61ms     | [S0,MB4,F]  61-15-76ms     | [S0,MB5,F]  76-15-92ms     | [S0,MB6,F]  92-15-107ms    | [S0,MB7,F]  107-15-123ms   | [S0,MB0,B]  255-0-255ms    | [S0,MB1,B]  289-0-289ms    | [S0,MB2,B]  324-0-324ms    | [S0,MB3,B]  363-0-363ms    | [S0,MB4,B]  399-0-399ms    | [S0,MB5,B]  433-0-433ms    | [S0,MB6,B]  468-0-468ms    | [S0,MB7,B]  507-0-507ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  49-16-66ms     | [S1,MB3,F]  67-17-84ms     | [S1,MB4,F]  84-17-101ms    | [S1,MB5,F]  102-17-119ms   | [S1,MB6,F]  119-17-137ms   | [S1,MB7,F]  137-17-155ms   | [S1,MB0,B]  236-17-254ms   | [S1,MB1,B]  270-17-288ms   | [S1,MB2,B]  306-17-324ms   | [S1,MB3,B]  345-17-363ms   | [S1,MB4,B]  381-17-399ms   | [S1,MB5,B]  415-17-433ms   | [S1,MB6,B]  449-17-467ms   | [S1,MB7,B]  488-17-506ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  49-15-64ms     | [S2,MB2,F]  66-15-81ms     | [S2,MB3,F]  84-15-99ms     | [S2,MB4,F]  101-15-116ms   | [S2,MB5,F]  119-15-134ms   | [S2,MB6,F]  137-15-152ms   | [S2,MB7,F]  155-15-170ms   | [S2,MB0,B]  220-15-236ms   | [S2,MB1,B]  254-16-270ms   | [S2,MB2,B]  290-15-306ms   | [S2,MB3,B]  328-15-344ms   | [S2,MB4,B]  365-15-381ms   | [S2,MB5,B]  399-15-415ms   | [S2,MB6,B]  433-15-449ms   | [S2,MB7,B]  472-15-488ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-63ms     | [S3,MB1,F]  65-14-79ms     | [S3,MB2,F]  81-14-96ms     | [S3,MB3,F]  99-14-113ms    | [S3,MB4,F]  116-14-131ms   | [S3,MB5,F]  134-14-149ms   | [S3,MB6,F]  152-14-166ms   | [S3,MB7,F]  169-14-184ms   | [S3,MB0,B]  186-33-219ms   | [S3,MB1,B]  219-34-253ms   | [S3,MB2,B]  253-35-289ms   | [S3,MB3,B]  289-38-328ms   | [S3,MB4,B]  328-36-364ms   | [S3,MB5,B]  364-34-398ms   | [S3,MB6,B]  398-34-432ms   | [S3,MB7,B]  432-39-472ms  
[rank3]:2025-11-28 15:38:19,098 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1538_stage3_step1300.svg
[rank0]:2025-11-28 15:40:01,626 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:40:03,656 - INFO - Avg. fwd time: 14.9767 / Avg. bwd time: 36.2814 / Avg. batch time: 429.8079 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-11-28 15:40:03,682 - INFO - Avg. fwd time: 14.8963 / Avg. bwd time: 19.2135 / Avg. batch time: 464.9866 (ms) / GPU bubble ratio: 41.31%
[rank0]:2025-11-28 15:40:03,719 - INFO - Avg. fwd time: 15.2831 / Avg. bwd time: 6.7750 / Avg. batch time: 527.4467 (ms) / GPU bubble ratio: 66.54%
[rank0]:2025-11-28 15:40:03,723 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,814  tflops: 364.43  mfu: 36.85%
[rank1]:2025-11-28 15:40:03,709 - INFO - Avg. fwd time: 17.0450 / Avg. bwd time: 21.5326 / Avg. batch time: 504.3156 (ms) / GPU bubble ratio: 38.80%
[rank1]:2025-11-28 15:40:03,720 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,814  tflops: 364.44  mfu: 36.85%
[rank3]:2025-11-28 15:40:03,767 - INFO -  step: 1350  loss:  0.1534  grad_norm:  0.0898  memory: 92.90GiB(66.45%)  tps: 7,814  tflops: 364.45  mfu: 36.85%
[rank2]:2025-11-28 15:40:03,720 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,814  tflops: 364.43  mfu: 36.85%
[rank0]:2025-11-28 15:41:46,608 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:41:48,318 - INFO - Avg. fwd time: 15.2913 / Avg. bwd time: 6.5566 / Avg. batch time: 526.8762 (ms) / GPU bubble ratio: 66.83%
[rank3]:2025-11-28 15:41:48,633 - INFO - Avg. fwd time: 14.9742 / Avg. bwd time: 36.2638 / Avg. batch time: 429.7012 (ms) / GPU bubble ratio: 4.61%
[rank2]:2025-11-28 15:41:48,623 - INFO - Avg. fwd time: 14.9059 / Avg. bwd time: 19.1113 / Avg. batch time: 464.7678 (ms) / GPU bubble ratio: 41.45%
[rank1]:2025-11-28 15:41:48,665 - INFO - Avg. fwd time: 17.0560 / Avg. bwd time: 21.4168 / Avg. batch time: 503.9724 (ms) / GPU bubble ratio: 38.93%
[rank2]:2025-11-28 15:41:48,751 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,800  tflops: 363.78  mfu: 36.78%
[rank0]:2025-11-28 15:41:48,753 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,800  tflops: 363.78  mfu: 36.78%
[rank1]:2025-11-28 15:41:48,753 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,800  tflops: 363.77  mfu: 36.78%
[rank3]:2025-11-28 15:41:48,801 - INFO -  step: 1400  loss:  0.3888  grad_norm:  0.1056  memory: 92.90GiB(66.45%)  tps: 7,800  tflops: 363.77  mfu: 36.78%
[rank2]:2025-11-28 15:41:48,850 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1541_stage2_step1400.svg
[rank0]:2025-11-28 15:41:48,854 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1541_stage0_step1400.svg
[rank1]:2025-11-28 15:41:48,850 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1541_stage1_step1400.svg
[rank3]:2025-11-28 15:41:48,926 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1541_real_step1400_rank3.svg
[rank3]:			> Batch Time: 510.75 ms, GPU Bubble Ratio: 75.52%, 44.46%, 50.92%, 20.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-46ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-77ms     | [S0,MB5,F]  77-15-93ms     | [S0,MB6,F]  93-15-109ms    | [S0,MB7,F]  109-15-124ms   | [S0,MB0,B]  258-0-258ms    | [S0,MB1,B]  292-0-292ms    | [S0,MB2,B]  328-0-328ms    | [S0,MB3,B]  365-0-365ms    | [S0,MB4,B]  401-0-401ms    | [S0,MB5,B]  435-0-435ms    | [S0,MB6,B]  470-0-470ms    | [S0,MB7,B]  510-0-510ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  68-17-85ms     | [S1,MB4,F]  85-17-103ms    | [S1,MB5,F]  103-17-121ms   | [S1,MB6,F]  121-17-139ms   | [S1,MB7,F]  139-17-157ms   | [S1,MB0,B]  239-17-257ms   | [S1,MB1,B]  273-17-291ms   | [S1,MB2,B]  309-17-327ms   | [S1,MB3,B]  347-17-365ms   | [S1,MB4,B]  383-17-401ms   | [S1,MB5,B]  416-17-434ms   | [S1,MB6,B]  451-17-469ms   | [S1,MB7,B]  492-17-510ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-48ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  85-15-100ms    | [S2,MB4,F]  103-15-118ms   | [S2,MB5,F]  121-15-136ms   | [S2,MB6,F]  139-15-154ms   | [S2,MB7,F]  157-15-172ms   | [S2,MB0,B]  223-16-239ms   | [S2,MB1,B]  257-16-273ms   | [S2,MB2,B]  293-16-309ms   | [S2,MB3,B]  331-16-347ms   | [S2,MB4,B]  367-16-383ms   | [S2,MB5,B]  400-16-416ms   | [S2,MB6,B]  435-16-451ms   | [S2,MB7,B]  475-16-491ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-64ms     | [S3,MB1,F]  66-14-81ms     | [S3,MB2,F]  83-14-97ms     | [S3,MB3,F]  100-14-115ms   | [S3,MB4,F]  118-14-133ms   | [S3,MB5,F]  136-14-151ms   | [S3,MB6,F]  154-14-169ms   | [S3,MB7,F]  172-14-187ms   | [S3,MB0,B]  189-33-223ms   | [S3,MB1,B]  223-34-257ms   | [S3,MB2,B]  257-35-292ms   | [S3,MB3,B]  293-38-331ms   | [S3,MB4,B]  330-36-366ms   | [S3,MB5,B]  366-34-400ms   | [S3,MB6,B]  400-34-434ms   | [S3,MB7,B]  435-39-474ms  
[rank3]:2025-11-28 15:41:48,972 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1541_stage3_step1400.svg
[rank0]:2025-11-28 15:43:33,139 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:43:34,783 - INFO - Avg. fwd time: 15.3105 / Avg. bwd time: 6.3189 / Avg. batch time: 526.4096 (ms) / GPU bubble ratio: 67.13%
[rank2]:2025-11-28 15:43:35,080 - INFO - Avg. fwd time: 14.9266 / Avg. bwd time: 19.0043 / Avg. batch time: 464.6665 (ms) / GPU bubble ratio: 41.58%
[rank1]:2025-11-28 15:43:35,119 - INFO - Avg. fwd time: 17.0783 / Avg. bwd time: 21.2946 / Avg. batch time: 503.7473 (ms) / GPU bubble ratio: 39.06%
[rank3]:2025-11-28 15:43:35,089 - INFO - Avg. fwd time: 14.9872 / Avg. bwd time: 36.2463 / Avg. batch time: 429.6964 (ms) / GPU bubble ratio: 4.61%
[rank0]:2025-11-28 15:43:35,202 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,696  tflops: 358.93  mfu: 36.29%
[rank1]:2025-11-28 15:43:35,202 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,696  tflops: 358.93  mfu: 36.29%
[rank3]:2025-11-28 15:43:35,247 - INFO -  step: 1450  loss:  0.1943  grad_norm:  0.0831  memory: 92.90GiB(66.45%)  tps: 7,696  tflops: 358.94  mfu: 36.29%
[rank2]:2025-11-28 15:43:35,200 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,696  tflops: 358.93  mfu: 36.29%
[rank0]:2025-11-28 15:45:18,883 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:45:20,969 - INFO - Avg. fwd time: 15.0050 / Avg. bwd time: 36.2060 / Avg. batch time: 429.5257 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-11-28 15:45:20,995 - INFO - Avg. fwd time: 14.9483 / Avg. bwd time: 18.9059 / Avg. batch time: 464.3988 (ms) / GPU bubble ratio: 41.68%
[rank2]:2025-11-28 15:45:21,036 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,740  tflops: 361.01  mfu: 36.50%
[rank0]:2025-11-28 15:45:21,035 - INFO - Avg. fwd time: 15.3302 / Avg. bwd time: 6.0978 / Avg. batch time: 525.8090 (ms) / GPU bubble ratio: 67.40%
[rank0]:2025-11-28 15:45:21,038 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,740  tflops: 361.01  mfu: 36.50%
[rank1]:2025-11-28 15:45:21,023 - INFO - Avg. fwd time: 17.1013 / Avg. bwd time: 21.1817 / Avg. batch time: 503.3685 (ms) / GPU bubble ratio: 39.16%
[rank1]:2025-11-28 15:45:21,036 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,740  tflops: 361.02  mfu: 36.50%
[rank3]:2025-11-28 15:45:21,082 - INFO -  step: 1500  loss:  0.3103  grad_norm:  0.0987  memory: 92.90GiB(66.45%)  tps: 7,741  tflops: 361.02  mfu: 36.50%
[rank2]:2025-11-28 15:45:21,131 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1545_stage2_step1500.svg
[rank0]:2025-11-28 15:45:21,135 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1545_stage0_step1500.svg
[rank1]:2025-11-28 15:45:21,130 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1545_stage1_step1500.svg
[rank3]:2025-11-28 15:45:21,208 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1545_real_step1500_rank3.svg
[rank3]:			> Batch Time: 505.50 ms, GPU Bubble Ratio: 74.82%, 43.21%, 49.68%, 20.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-47ms     | [S0,MB3,F]  47-15-62ms     | [S0,MB4,F]  62-16-78ms     | [S0,MB5,F]  78-16-95ms     | [S0,MB6,F]  94-16-111ms    | [S0,MB7,F]  111-16-127ms   | [S0,MB0,B]  262-0-262ms    | [S0,MB1,B]  295-0-295ms    | [S0,MB2,B]  330-0-330ms    | [S0,MB3,B]  366-0-366ms    | [S0,MB4,B]  401-0-401ms    | [S0,MB5,B]  435-0-435ms    | [S0,MB6,B]  468-0-468ms    | [S0,MB7,B]  505-0-505ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  51-17-68ms     | [S1,MB3,F]  68-17-86ms     | [S1,MB4,F]  86-17-104ms    | [S1,MB5,F]  105-18-123ms   | [S1,MB6,F]  123-18-141ms   | [S1,MB7,F]  141-18-160ms   | [S1,MB0,B]  243-18-262ms   | [S1,MB1,B]  276-18-294ms   | [S1,MB2,B]  311-18-329ms   | [S1,MB3,B]  348-18-366ms   | [S1,MB4,B]  383-18-401ms   | [S1,MB5,B]  416-18-434ms   | [S1,MB6,B]  449-18-467ms   | [S1,MB7,B]  487-18-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  50-15-66ms     | [S2,MB2,F]  68-15-84ms     | [S2,MB3,F]  86-15-102ms    | [S2,MB4,F]  104-15-120ms   | [S2,MB5,F]  123-15-138ms   | [S2,MB6,F]  141-15-157ms   | [S2,MB7,F]  160-15-175ms   | [S2,MB0,B]  227-16-243ms   | [S2,MB1,B]  260-16-276ms   | [S2,MB2,B]  294-16-311ms   | [S2,MB3,B]  331-16-347ms   | [S2,MB4,B]  366-16-382ms   | [S2,MB5,B]  399-16-416ms   | [S2,MB6,B]  433-16-449ms   | [S2,MB7,B]  470-16-487ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-17-65ms     | [S3,MB1,F]  67-14-82ms     | [S3,MB2,F]  84-15-99ms     | [S3,MB3,F]  102-15-117ms   | [S3,MB4,F]  120-15-135ms   | [S3,MB5,F]  138-15-154ms   | [S3,MB6,F]  157-15-172ms   | [S3,MB7,F]  175-15-191ms   | [S3,MB0,B]  193-32-226ms   | [S3,MB1,B]  226-33-259ms   | [S3,MB2,B]  259-34-294ms   | [S3,MB3,B]  294-37-331ms   | [S3,MB4,B]  330-35-366ms   | [S3,MB5,B]  366-33-399ms   | [S3,MB6,B]  399-33-432ms   | [S3,MB7,B]  432-37-469ms  
[rank3]:2025-11-28 15:45:21,254 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1545_stage3_step1500.svg
[rank0]:2025-11-28 15:47:05,419 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:47:07,096 - INFO - Avg. fwd time: 15.3463 / Avg. bwd time: 5.9203 / Avg. batch time: 525.4622 (ms) / GPU bubble ratio: 67.62%
[rank3]:2025-11-28 15:47:07,409 - INFO - Avg. fwd time: 15.0185 / Avg. bwd time: 36.1891 / Avg. batch time: 429.5172 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-11-28 15:47:07,401 - INFO - Avg. fwd time: 14.9656 / Avg. bwd time: 18.8266 / Avg. batch time: 464.3218 (ms) / GPU bubble ratio: 41.78%
[rank1]:2025-11-28 15:47:07,440 - INFO - Avg. fwd time: 17.1205 / Avg. bwd time: 21.0911 / Avg. batch time: 503.2011 (ms) / GPU bubble ratio: 39.25%
[rank0]:2025-11-28 15:47:07,522 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,693  tflops: 358.81  mfu: 36.28%
[rank2]:2025-11-28 15:47:07,520 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,693  tflops: 358.81  mfu: 36.28%
[rank1]:2025-11-28 15:47:07,522 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,693  tflops: 358.80  mfu: 36.28%
[rank3]:2025-11-28 15:47:07,567 - INFO -  step: 1550  loss:  0.2890  grad_norm:  0.1091  memory: 92.90GiB(66.45%)  tps: 7,693  tflops: 358.81  mfu: 36.28%
[rank0]:2025-11-28 15:48:51,649 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:48:53,356 - INFO - Avg. fwd time: 15.3586 / Avg. bwd time: 5.7259 / Avg. batch time: 525.0247 (ms) / GPU bubble ratio: 67.87%
[rank3]:2025-11-28 15:48:53,670 - INFO - Avg. fwd time: 15.0237 / Avg. bwd time: 36.1737 / Avg. batch time: 429.4785 (ms) / GPU bubble ratio: 4.63%
[rank2]:2025-11-28 15:48:53,662 - INFO - Avg. fwd time: 14.9789 / Avg. bwd time: 18.7377 / Avg. batch time: 464.1890 (ms) / GPU bubble ratio: 41.89%
[rank1]:2025-11-28 15:48:53,703 - INFO - Avg. fwd time: 17.1360 / Avg. bwd time: 20.9901 / Avg. batch time: 502.9638 (ms) / GPU bubble ratio: 39.36%
[rank3]:2025-11-28 15:48:53,834 - INFO -  step: 1600  loss:  0.3945  grad_norm:  0.1299  memory: 92.90GiB(66.45%)  tps: 7,709  tflops: 359.55  mfu: 36.35%
[rank0]:2025-11-28 15:48:53,787 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,709  tflops: 359.55  mfu: 36.35%
[rank2]:2025-11-28 15:48:53,784 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,709  tflops: 359.55  mfu: 36.36%
[rank1]:2025-11-28 15:48:53,786 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,709  tflops: 359.55  mfu: 36.36%
[rank0]:2025-11-28 15:48:53,888 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1548_stage0_step1600.svg
[rank2]:2025-11-28 15:48:53,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1548_stage2_step1600.svg
[rank1]:2025-11-28 15:48:53,884 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1548_stage1_step1600.svg
[rank3]:2025-11-28 15:48:53,960 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1548_real_step1600_rank3.svg
[rank3]:			> Batch Time: 510.25 ms, GPU Bubble Ratio: 75.16%, 43.92%, 50.40%, 20.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-46ms     | [S0,MB3,F]  46-15-62ms     | [S0,MB4,F]  62-15-78ms     | [S0,MB5,F]  78-16-94ms     | [S0,MB6,F]  94-16-110ms    | [S0,MB7,F]  110-16-126ms   | [S0,MB0,B]  261-0-261ms    | [S0,MB1,B]  295-0-295ms    | [S0,MB2,B]  329-0-329ms    | [S0,MB3,B]  367-0-367ms    | [S0,MB4,B]  403-0-403ms    | [S0,MB5,B]  437-0-437ms    | [S0,MB6,B]  471-0-471ms    | [S0,MB7,B]  510-0-510ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-33ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-68ms     | [S1,MB3,F]  68-17-86ms     | [S1,MB4,F]  86-17-104ms    | [S1,MB5,F]  104-17-122ms   | [S1,MB6,F]  123-18-141ms   | [S1,MB7,F]  141-18-159ms   | [S1,MB0,B]  243-18-261ms   | [S1,MB1,B]  277-18-295ms   | [S1,MB2,B]  311-18-329ms   | [S1,MB3,B]  349-18-367ms   | [S1,MB4,B]  385-18-403ms   | [S1,MB5,B]  419-18-437ms   | [S1,MB6,B]  453-18-471ms   | [S1,MB7,B]  492-18-510ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  33-15-48ms     | [S2,MB1,F]  50-15-66ms     | [S2,MB2,F]  68-15-83ms     | [S2,MB3,F]  86-15-101ms    | [S2,MB4,F]  104-15-119ms   | [S2,MB5,F]  122-15-138ms   | [S2,MB6,F]  141-15-156ms   | [S2,MB7,F]  159-15-175ms   | [S2,MB0,B]  226-16-242ms   | [S2,MB1,B]  260-16-276ms   | [S2,MB2,B]  294-16-310ms   | [S2,MB3,B]  332-16-349ms   | [S2,MB4,B]  368-16-384ms   | [S2,MB5,B]  402-16-419ms   | [S2,MB6,B]  436-16-453ms   | [S2,MB7,B]  475-16-491ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  67-14-81ms     | [S3,MB2,F]  83-14-98ms     | [S3,MB3,F]  101-15-116ms   | [S3,MB4,F]  119-15-134ms   | [S3,MB5,F]  138-15-153ms   | [S3,MB6,F]  156-15-171ms   | [S3,MB7,F]  174-15-190ms   | [S3,MB0,B]  192-33-225ms   | [S3,MB1,B]  225-33-259ms   | [S3,MB2,B]  259-34-294ms   | [S3,MB3,B]  294-38-332ms   | [S3,MB4,B]  332-36-368ms   | [S3,MB5,B]  368-33-402ms   | [S3,MB6,B]  402-34-436ms   | [S3,MB7,B]  436-39-475ms  
[rank3]:2025-11-28 15:48:54,007 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1548_stage3_step1600.svg
[rank0]:2025-11-28 15:50:38,313 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:50:40,386 - INFO - Avg. fwd time: 15.0326 / Avg. bwd time: 36.1592 / Avg. batch time: 429.4570 (ms) / GPU bubble ratio: 4.64%
[rank1]:2025-11-28 15:50:40,444 - INFO - Avg. fwd time: 17.1522 / Avg. bwd time: 20.8960 / Avg. batch time: 502.7738 (ms) / GPU bubble ratio: 39.46%
[rank2]:2025-11-28 15:50:40,414 - INFO - Avg. fwd time: 14.9934 / Avg. bwd time: 18.6553 / Avg. batch time: 464.0937 (ms) / GPU bubble ratio: 42.00%
[rank0]:2025-11-28 15:50:40,457 - INFO - Avg. fwd time: 15.3724 / Avg. bwd time: 5.5438 / Avg. batch time: 524.6506 (ms) / GPU bubble ratio: 68.11%
[rank0]:2025-11-28 15:50:40,460 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,680  tflops: 358.18  mfu: 36.22%
[rank3]:2025-11-28 15:50:40,504 - INFO -  step: 1650  loss:  0.4223  grad_norm:  0.1269  memory: 92.90GiB(66.45%)  tps: 7,680  tflops: 358.19  mfu: 36.22%
[rank1]:2025-11-28 15:50:40,458 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,680  tflops: 358.18  mfu: 36.22%
[rank2]:2025-11-28 15:50:40,458 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,680  tflops: 358.18  mfu: 36.22%
[rank0]:2025-11-28 15:52:25,050 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:52:26,721 - INFO - Avg. fwd time: 15.3838 / Avg. bwd time: 5.3967 / Avg. batch time: 524.3739 (ms) / GPU bubble ratio: 68.30%
[rank2]:2025-11-28 15:52:27,022 - INFO - Avg. fwd time: 15.0053 / Avg. bwd time: 18.5890 / Avg. batch time: 464.0440 (ms) / GPU bubble ratio: 42.08%
[rank3]:2025-11-28 15:52:27,028 - INFO - Avg. fwd time: 15.0387 / Avg. bwd time: 36.1521 / Avg. batch time: 429.4762 (ms) / GPU bubble ratio: 4.65%
[rank1]:2025-11-28 15:52:27,059 - INFO - Avg. fwd time: 17.1654 / Avg. bwd time: 20.8201 / Avg. batch time: 502.6470 (ms) / GPU bubble ratio: 39.54%
[rank2]:2025-11-28 15:52:27,138 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,679  tflops: 358.15  mfu: 36.21%
[rank0]:2025-11-28 15:52:27,140 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,679  tflops: 358.15  mfu: 36.21%
[rank3]:2025-11-28 15:52:27,184 - INFO -  step: 1700  loss:  0.4183  grad_norm:  0.1233  memory: 92.90GiB(66.45%)  tps: 7,679  tflops: 358.16  mfu: 36.21%
[rank1]:2025-11-28 15:52:27,140 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,679  tflops: 358.14  mfu: 36.21%
[rank2]:2025-11-28 15:52:27,235 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1552_stage2_step1700.svg
[rank0]:2025-11-28 15:52:27,237 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1552_stage0_step1700.svg
[rank3]:2025-11-28 15:52:27,308 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1552_real_step1700_rank3.svg
[rank3]:			> Batch Time: 524.00 ms, GPU Bubble Ratio: 75.88%, 45.55%, 51.76%, 20.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-46ms     | [S0,MB3,F]  46-15-62ms     | [S0,MB4,F]  62-15-78ms     | [S0,MB5,F]  78-15-94ms     | [S0,MB6,F]  94-16-110ms    | [S0,MB7,F]  110-16-126ms   | [S0,MB0,B]  261-0-261ms    | [S0,MB1,B]  297-0-297ms    | [S0,MB2,B]  333-0-333ms    | [S0,MB3,B]  371-0-371ms    | [S0,MB4,B]  409-0-409ms    | [S0,MB5,B]  446-0-446ms    | [S0,MB6,B]  483-0-483ms    | [S0,MB7,B]  524-0-524ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-68ms     | [S1,MB3,F]  68-17-86ms     | [S1,MB4,F]  86-17-103ms    | [S1,MB5,F]  104-17-122ms   | [S1,MB6,F]  122-17-140ms   | [S1,MB7,F]  140-17-158ms   | [S1,MB0,B]  243-18-261ms   | [S1,MB1,B]  279-18-297ms   | [S1,MB2,B]  315-18-333ms   | [S1,MB3,B]  353-18-371ms   | [S1,MB4,B]  391-18-409ms   | [S1,MB5,B]  427-18-445ms   | [S1,MB6,B]  464-18-482ms   | [S1,MB7,B]  505-18-524ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-48ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  68-15-83ms     | [S2,MB3,F]  85-15-101ms    | [S2,MB4,F]  103-15-119ms   | [S2,MB5,F]  121-15-137ms   | [S2,MB6,F]  140-15-155ms   | [S2,MB7,F]  158-15-174ms   | [S2,MB0,B]  226-16-242ms   | [S2,MB1,B]  262-16-278ms   | [S2,MB2,B]  298-16-314ms   | [S2,MB3,B]  336-16-353ms   | [S2,MB4,B]  374-16-391ms   | [S2,MB5,B]  411-16-427ms   | [S2,MB6,B]  448-16-464ms   | [S2,MB7,B]  489-16-505ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  48-16-65ms     | [S3,MB1,F]  67-14-81ms     | [S3,MB2,F]  83-14-98ms     | [S3,MB3,F]  101-14-116ms   | [S3,MB4,F]  119-15-134ms   | [S3,MB5,F]  137-15-152ms   | [S3,MB6,F]  155-15-170ms   | [S3,MB7,F]  173-15-189ms   | [S3,MB0,B]  191-35-226ms   | [S3,MB1,B]  225-35-261ms   | [S3,MB2,B]  261-36-297ms   | [S3,MB3,B]  298-37-335ms   | [S3,MB4,B]  336-37-373ms   | [S3,MB5,B]  374-35-409ms   | [S3,MB6,B]  410-36-446ms   | [S3,MB7,B]  447-40-488ms  
[rank1]:2025-11-28 15:52:27,234 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1552_stage1_step1700.svg
[rank3]:2025-11-28 15:52:27,353 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1552_stage3_step1700.svg
[rank0]:2025-11-28 15:54:11,378 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:54:13,098 - INFO - Avg. fwd time: 15.3957 / Avg. bwd time: 5.2347 / Avg. batch time: 523.9805 (ms) / GPU bubble ratio: 68.50%
[rank2]:2025-11-28 15:54:13,409 - INFO - Avg. fwd time: 15.0180 / Avg. bwd time: 18.5155 / Avg. batch time: 463.9012 (ms) / GPU bubble ratio: 42.17%
[rank3]:2025-11-28 15:54:13,417 - INFO - Avg. fwd time: 15.0460 / Avg. bwd time: 36.1326 / Avg. batch time: 429.4003 (ms) / GPU bubble ratio: 4.65%
[rank1]:2025-11-28 15:54:13,451 - INFO - Avg. fwd time: 17.1794 / Avg. bwd time: 20.7363 / Avg. batch time: 502.4188 (ms) / GPU bubble ratio: 39.63%
[rank0]:2025-11-28 15:54:13,534 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,700  tflops: 359.12  mfu: 36.31%
[rank3]:2025-11-28 15:54:13,583 - INFO -  step: 1750  loss:  0.4408  grad_norm:  0.1276  memory: 92.90GiB(66.45%)  tps: 7,699  tflops: 359.10  mfu: 36.31%
[rank1]:2025-11-28 15:54:13,534 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,700  tflops: 359.12  mfu: 36.31%
[rank2]:2025-11-28 15:54:13,532 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,700  tflops: 359.12  mfu: 36.31%
[rank0]:2025-11-28 15:55:54,938 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 15:55:56,879 - INFO - Avg. fwd time: 15.0415 / Avg. bwd time: 36.1037 / Avg. batch time: 429.1547 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-11-28 15:55:56,907 - INFO - Avg. fwd time: 15.0216 / Avg. bwd time: 18.4421 / Avg. batch time: 463.5729 (ms) / GPU bubble ratio: 42.25%
[rank0]:2025-11-28 15:55:56,951 - INFO - Avg. fwd time: 15.3979 / Avg. bwd time: 5.0821 / Avg. batch time: 523.4018 (ms) / GPU bubble ratio: 68.70%
[rank0]:2025-11-28 15:55:56,954 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,921  tflops: 369.44  mfu: 37.36%
[rank1]:2025-11-28 15:55:56,938 - INFO - Avg. fwd time: 17.1826 / Avg. bwd time: 20.6540 / Avg. batch time: 502.0010 (ms) / GPU bubble ratio: 39.70%
[rank1]:2025-11-28 15:55:56,952 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,921  tflops: 369.45  mfu: 37.36%
[rank2]:2025-11-28 15:55:56,952 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,921  tflops: 369.44  mfu: 37.36%
[rank0]:2025-11-28 15:55:57,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1555_stage0_step1800.svg
[rank3]:2025-11-28 15:55:56,999 - INFO -  step: 1800  loss:  0.0732  grad_norm:  0.0482  memory: 92.90GiB(66.45%)  tps: 7,922  tflops: 369.46  mfu: 37.36%
[rank1]:2025-11-28 15:55:57,049 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1555_stage1_step1800.svg
[rank2]:2025-11-28 15:55:57,049 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1555_stage2_step1800.svg
[rank3]:2025-11-28 15:55:57,124 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1555_real_step1800_rank3.svg
[rank3]:			> Batch Time: 486.00 ms, GPU Bubble Ratio: 75.26%, 43.07%, 49.63%, 20.75%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-14-30ms     | [S0,MB2,F]  30-14-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-15-89ms     | [S0,MB6,F]  89-15-105ms    | [S0,MB7,F]  105-15-120ms   | [S0,MB0,B]  248-0-248ms    | [S0,MB1,B]  281-0-281ms    | [S0,MB2,B]  313-0-313ms    | [S0,MB3,B]  350-0-350ms    | [S0,MB4,B]  384-0-384ms    | [S0,MB5,B]  416-0-416ms    | [S0,MB6,B]  449-0-449ms    | [S0,MB7,B]  486-0-486ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-31ms     | [S1,MB1,F]  32-16-48ms     | [S1,MB2,F]  49-16-65ms     | [S1,MB3,F]  66-16-82ms     | [S1,MB4,F]  83-16-99ms     | [S1,MB5,F]  100-16-116ms   | [S1,MB6,F]  117-16-134ms   | [S1,MB7,F]  134-17-151ms   | [S1,MB0,B]  230-17-248ms   | [S1,MB1,B]  262-17-280ms   | [S1,MB2,B]  295-17-313ms   | [S1,MB3,B]  332-17-349ms   | [S1,MB4,B]  366-17-384ms   | [S1,MB5,B]  398-17-416ms   | [S1,MB6,B]  430-17-448ms   | [S1,MB7,B]  467-17-485ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  31-14-46ms     | [S2,MB1,F]  48-14-63ms     | [S2,MB2,F]  65-14-80ms     | [S2,MB3,F]  82-14-97ms     | [S2,MB4,F]  99-14-114ms    | [S2,MB5,F]  116-14-131ms   | [S2,MB6,F]  134-14-148ms   | [S2,MB7,F]  151-14-166ms   | [S2,MB0,B]  214-15-229ms   | [S2,MB1,B]  246-15-262ms   | [S2,MB2,B]  279-15-295ms   | [S2,MB3,B]  315-15-331ms   | [S2,MB4,B]  350-15-365ms   | [S2,MB5,B]  382-15-398ms   | [S2,MB6,B]  414-15-430ms   | [S2,MB7,B]  451-15-467ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  46-16-62ms     | [S3,MB1,F]  64-13-78ms     | [S3,MB2,F]  80-13-94ms     | [S3,MB3,F]  97-14-111ms    | [S3,MB4,F]  114-14-128ms   | [S3,MB5,F]  131-14-145ms   | [S3,MB6,F]  148-14-163ms   | [S3,MB7,F]  166-14-180ms   | [S3,MB0,B]  182-31-213ms   | [S3,MB1,B]  213-32-245ms   | [S3,MB2,B]  245-32-278ms   | [S3,MB3,B]  278-36-315ms   | [S3,MB4,B]  315-34-349ms   | [S3,MB5,B]  349-32-381ms   | [S3,MB6,B]  381-32-414ms   | [S3,MB7,B]  414-36-451ms  
[rank3]:2025-11-28 15:55:57,170 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1555_stage3_step1800.svg
[rank0]:2025-11-28 15:57:38,430 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:57:40,071 - INFO - Avg. fwd time: 15.3986 / Avg. bwd time: 4.9582 / Avg. batch time: 522.9583 (ms) / GPU bubble ratio: 68.86%
[rank2]:2025-11-28 15:57:40,368 - INFO - Avg. fwd time: 15.0234 / Avg. bwd time: 18.3819 / Avg. batch time: 463.3369 (ms) / GPU bubble ratio: 42.32%
[rank1]:2025-11-28 15:57:40,407 - INFO - Avg. fwd time: 17.1839 / Avg. bwd time: 20.5864 / Avg. batch time: 501.6896 (ms) / GPU bubble ratio: 39.77%
[rank3]:2025-11-28 15:57:40,376 - INFO - Avg. fwd time: 15.0358 / Avg. bwd time: 36.0847 / Avg. batch time: 428.9785 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-11-28 15:57:40,488 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,912  tflops: 369.03  mfu: 37.31%
[rank0]:2025-11-28 15:57:40,490 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,912  tflops: 369.03  mfu: 37.31%
[rank1]:2025-11-28 15:57:40,490 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,912  tflops: 369.02  mfu: 37.31%
[rank3]:2025-11-28 15:57:40,537 - INFO -  step: 1850  loss:  0.3620  grad_norm:  0.0881  memory: 92.90GiB(66.45%)  tps: 7,912  tflops: 369.03  mfu: 37.31%
[rank0]:2025-11-28 15:59:21,364 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 15:59:22,987 - INFO - Avg. fwd time: 15.3968 / Avg. bwd time: 4.8212 / Avg. batch time: 522.4258 (ms) / GPU bubble ratio: 69.04%
[rank2]:2025-11-28 15:59:23,280 - INFO - Avg. fwd time: 15.0229 / Avg. bwd time: 18.3147 / Avg. batch time: 463.0400 (ms) / GPU bubble ratio: 42.40%
[rank1]:2025-11-28 15:59:23,319 - INFO - Avg. fwd time: 17.1827 / Avg. bwd time: 20.5111 / Avg. batch time: 501.3061 (ms) / GPU bubble ratio: 39.85%
[rank3]:2025-11-28 15:59:23,288 - INFO - Avg. fwd time: 15.0261 / Avg. bwd time: 36.0640 / Avg. batch time: 428.7621 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-11-28 15:59:23,398 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,960  tflops: 371.27  mfu: 37.54%
[rank0]:2025-11-28 15:59:23,400 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,960  tflops: 371.27  mfu: 37.54%
[rank3]:2025-11-28 15:59:23,447 - INFO -  step: 1900  loss:  0.2030  grad_norm:  0.0735  memory: 92.90GiB(66.45%)  tps: 7,960  tflops: 371.28  mfu: 37.54%
[rank1]:2025-11-28 15:59:23,400 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,960  tflops: 371.27  mfu: 37.54%
[rank2]:2025-11-28 15:59:23,497 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1559_stage2_step1900.svg
[rank0]:2025-11-28 15:59:23,499 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1559_stage0_step1900.svg
[rank1]:2025-11-28 15:59:23,497 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1559_stage1_step1900.svg
[rank3]:2025-11-28 15:59:23,572 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1559_real_step1900_rank3.svg
[rank3]:			> Batch Time: 498.50 ms, GPU Bubble Ratio: 75.51%, 44.04%, 50.50%, 20.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB4,F]  60-15-75ms     | [S0,MB5,F]  75-15-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-122ms   | [S0,MB0,B]  252-0-252ms    | [S0,MB1,B]  286-0-286ms    | [S0,MB2,B]  320-0-320ms    | [S0,MB3,B]  357-0-357ms    | [S0,MB4,B]  392-0-392ms    | [S0,MB5,B]  426-0-426ms    | [S0,MB6,B]  459-0-459ms    | [S0,MB7,B]  498-0-498ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-16-32ms     | [S1,MB1,F]  32-16-49ms     | [S1,MB2,F]  49-16-66ms     | [S1,MB3,F]  66-17-83ms     | [S1,MB4,F]  83-17-101ms    | [S1,MB5,F]  101-17-118ms   | [S1,MB6,F]  118-17-135ms   | [S1,MB7,F]  136-17-153ms   | [S1,MB0,B]  234-17-252ms   | [S1,MB1,B]  267-17-285ms   | [S1,MB2,B]  301-17-319ms   | [S1,MB3,B]  339-17-357ms   | [S1,MB4,B]  374-17-392ms   | [S1,MB5,B]  408-17-425ms   | [S1,MB6,B]  441-17-459ms   | [S1,MB7,B]  480-17-497ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-14-47ms     | [S2,MB1,F]  49-14-64ms     | [S2,MB2,F]  66-14-81ms     | [S2,MB3,F]  83-14-98ms     | [S2,MB4,F]  100-14-115ms   | [S2,MB5,F]  118-14-133ms   | [S2,MB6,F]  135-14-150ms   | [S2,MB7,F]  153-14-168ms   | [S2,MB0,B]  217-15-233ms   | [S2,MB1,B]  251-15-267ms   | [S2,MB2,B]  285-15-301ms   | [S2,MB3,B]  322-15-338ms   | [S2,MB4,B]  358-15-374ms   | [S2,MB5,B]  391-15-407ms   | [S2,MB6,B]  425-15-441ms   | [S2,MB7,B]  463-15-479ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-63ms     | [S3,MB1,F]  65-14-79ms     | [S3,MB2,F]  81-14-95ms     | [S3,MB3,F]  98-14-113ms    | [S3,MB4,F]  115-14-130ms   | [S3,MB5,F]  133-14-147ms   | [S3,MB6,F]  150-14-165ms   | [S3,MB7,F]  167-14-182ms   | [S3,MB0,B]  184-32-217ms   | [S3,MB1,B]  217-33-251ms   | [S3,MB2,B]  250-34-284ms   | [S3,MB3,B]  284-37-322ms   | [S3,MB4,B]  322-35-358ms   | [S3,MB5,B]  357-33-391ms   | [S3,MB6,B]  391-33-425ms   | [S3,MB7,B]  424-39-463ms  
[rank3]:2025-11-28 15:59:23,618 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1559_stage3_step1900.svg
[rank0]:2025-11-28 16:01:03,794 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-28 16:01:05,833 - INFO - Avg. fwd time: 15.0155 / Avg. bwd time: 36.0397 / Avg. batch time: 428.5112 (ms) / GPU bubble ratio: 4.68%
[rank2]:2025-11-28 16:01:05,861 - INFO - Avg. fwd time: 15.0213 / Avg. bwd time: 18.2502 / Avg. batch time: 462.7211 (ms) / GPU bubble ratio: 42.48%
[rank2]:2025-11-28 16:01:05,907 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank0]:2025-11-28 16:01:05,905 - INFO - Avg. fwd time: 15.3940 / Avg. bwd time: 4.6914 / Avg. batch time: 521.8841 (ms) / GPU bubble ratio: 69.21%
[rank0]:2025-11-28 16:01:05,909 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank1]:2025-11-28 16:01:05,892 - INFO - Avg. fwd time: 17.1804 / Avg. bwd time: 20.4391 / Avg. batch time: 500.9050 (ms) / GPU bubble ratio: 39.92%
[rank1]:2025-11-28 16:01:05,907 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank3]:2025-11-28 16:01:05,957 - INFO -  step: 1950  loss:  0.1737  grad_norm:  0.0791  memory: 92.90GiB(66.45%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank0]:2025-11-28 16:02:45,579 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-28 16:02:47,246 - INFO - Avg. fwd time: 15.3913 / Avg. bwd time: 4.5857 / Avg. batch time: 521.3410 (ms) / GPU bubble ratio: 69.35%
[rank2]:2025-11-28 16:02:47,551 - INFO - Avg. fwd time: 15.0196 / Avg. bwd time: 18.1977 / Avg. batch time: 462.3621 (ms) / GPU bubble ratio: 42.53%
[rank1]:2025-11-28 16:02:47,593 - INFO - Avg. fwd time: 17.1782 / Avg. bwd time: 20.3806 / Avg. batch time: 500.4777 (ms) / GPU bubble ratio: 39.96%
[rank3]:2025-11-28 16:02:47,560 - INFO - Avg. fwd time: 15.0077 / Avg. bwd time: 36.0090 / Avg. batch time: 428.2164 (ms) / GPU bubble ratio: 4.69%
[rank2]:2025-11-28 16:02:47,674 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 78.00GiB(55.79%)  tps: 8,050  tflops: 375.44  mfu: 37.96%
[rank2]:2025-11-28 16:02:47,674 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,731  tflops: 360.60  mfu: 35.11%
[rank2]:2025-11-28 16:02:47,674 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-28 16:02:47,679 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-28 16:02:47,676 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 90.20GiB(64.51%)  tps: 8,050  tflops: 375.44  mfu: 37.96%
[rank0]:2025-11-28 16:02:47,676 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,730  tflops: 360.55  mfu: 35.11%
[rank0]:2025-11-28 16:02:47,677 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-28 16:02:47,682 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-11-28 16:02:47,676 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 87.90GiB(62.87%)  tps: 8,050  tflops: 375.43  mfu: 37.96%
[rank1]:2025-11-28 16:02:47,676 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 7,731  tflops: 360.60  mfu: 35.11%
[rank1]:2025-11-28 16:02:47,676 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-28 16:02:47,681 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-11-28 16:02:47,727 - INFO -  step: 2000  loss:  0.2082  grad_norm:  0.0762  memory: 92.90GiB(66.45%)  tps: 8,050  tflops: 375.44  mfu: 37.96%
[rank3]:2025-11-28 16:02:47,727 - INFO -  final step: 2000  loss:  0.2082  grad_norm:  0.0762  tps: 7,735  tflops: 360.75  mfu: 35.13%
[rank3]:2025-11-28 16:02:47,727 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-28 16:02:47,732 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-11-28 16:02:58,178 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-28 16:02:58,259 - INFO - Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank2/251128_1602_stage2_final2000.svg
[rank0]:2025-11-28 16:02:58,300 - INFO - Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank0/251128_1602_stage0_final2000.svg
[rank1]:2025-11-28 16:02:58,257 - INFO - Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank1/251128_1602_stage1_final2000.svg
[rank3]:2025-11-28 16:02:58,332 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1602_real_final2000_rank3.svg
[rank3]:			> Batch Time: 508.25 ms, GPU Bubble Ratio: 75.50%, 44.29%, 50.69%, 20.55%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-46ms     | [S0,MB3,F]  46-15-61ms     | [S0,MB4,F]  61-15-77ms     | [S0,MB5,F]  77-15-92ms     | [S0,MB6,F]  92-15-108ms    | [S0,MB7,F]  108-15-124ms   | [S0,MB0,B]  259-0-259ms    | [S0,MB1,B]  292-0-292ms    | [S0,MB2,B]  327-0-327ms    | [S0,MB3,B]  365-0-365ms    | [S0,MB4,B]  401-0-401ms    | [S0,MB5,B]  435-0-435ms    | [S0,MB6,B]  469-0-469ms    | [S0,MB7,B]  508-0-508ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-17-32ms     | [S1,MB1,F]  33-17-50ms     | [S1,MB2,F]  50-17-67ms     | [S1,MB3,F]  67-17-85ms     | [S1,MB4,F]  85-17-102ms    | [S1,MB5,F]  103-17-120ms   | [S1,MB6,F]  121-17-138ms   | [S1,MB7,F]  139-17-156ms   | [S1,MB0,B]  240-18-258ms   | [S1,MB1,B]  274-18-292ms   | [S1,MB2,B]  309-18-327ms   | [S1,MB3,B]  346-18-364ms   | [S1,MB4,B]  382-17-400ms   | [S1,MB5,B]  416-18-434ms   | [S1,MB6,B]  450-18-468ms   | [S1,MB7,B]  489-18-507ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  32-15-47ms     | [S2,MB1,F]  50-15-65ms     | [S2,MB2,F]  67-15-82ms     | [S2,MB3,F]  85-15-100ms    | [S2,MB4,F]  102-15-118ms   | [S2,MB5,F]  120-15-136ms   | [S2,MB6,F]  138-15-154ms   | [S2,MB7,F]  156-15-172ms   | [S2,MB0,B]  223-16-239ms   | [S2,MB1,B]  257-16-273ms   | [S2,MB2,B]  292-16-308ms   | [S2,MB3,B]  330-16-346ms   | [S2,MB4,B]  366-16-382ms   | [S2,MB5,B]  400-16-416ms   | [S2,MB6,B]  434-16-450ms   | [S2,MB7,B]  473-16-489ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-16-64ms     | [S3,MB1,F]  66-14-80ms     | [S3,MB2,F]  82-14-97ms     | [S3,MB3,F]  100-14-115ms   | [S3,MB4,F]  118-14-132ms   | [S3,MB5,F]  135-14-150ms   | [S3,MB6,F]  153-14-168ms   | [S3,MB7,F]  171-15-186ms   | [S3,MB0,B]  188-33-222ms   | [S3,MB1,B]  222-33-256ms   | [S3,MB2,B]  256-34-291ms   | [S3,MB3,B]  291-38-330ms   | [S3,MB4,B]  329-35-365ms   | [S3,MB5,B]  365-33-399ms   | [S3,MB6,B]  399-34-433ms   | [S3,MB7,B]  433-39-472ms  
[rank2]:2025-11-28 16:02:58,440 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_params_histogram/251128_1602_rank2_stage2.svg
[rank2]:	> Counts Sum: 2161120, Total Sum: 4216320 (51.26%), Ratio(%) per element: [50.2, 50.75, 50.61, 50.34, 52.25, 53.14, 51.43, 50.68, 52.66, 52.25, 51.02, 50.75, 50.88, 51.7, 53.0, 50.0, 51.16, 50.06, 50.68, 50.61, 50.54, 50.4, 51.5, 52.18, 51.63, 51.77, 50.2, 52.66, 50.13, 52.11, 51.7, 51.77, 51.77, 52.59, 50.68, 49.65, 49.18, 50.61, 56.07, 50.75, 53.62, 52.86, 51.29, 50.95, 51.29, 51.36, 52.11, 51.02, 50.75, 53.82, 50.81, 51.29, 51.22, 50.75, 53.68, 49.04, 51.36, 49.93, 52.18, 51.22, 50.0, 49.38, 50.47, 52.86, 50.06, 50.34, 48.56, 53.82, 51.5, 50.34, 50.2, 49.93]
[rank2]:2025-11-28 16:02:58,440 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 16:02:58,446 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_params_histogram/251128_1602_rank1_stage1.svg
[rank1]:	> Counts Sum: 3144440, Total Sum: 4743360 (66.29%), Ratio(%) per element: [65.57, 66.18, 65.71, 67.62, 68.51, 68.3, 66.66, 67.82, 64.95, 67.28, 66.73, 67.48, 65.57, 66.93, 66.59, 68.51, 66.53, 64.95, 65.71, 66.59, 65.71, 65.09, 65.77, 66.8, 65.84, 66.59, 65.57, 66.12, 65.3, 64.82, 68.57, 66.53, 65.64, 64.61, 65.5, 66.39, 65.16, 63.93, 65.16, 64.75, 65.16, 64.95, 66.66, 64.89, 65.36, 64.54, 66.25, 67.21, 66.18, 66.39, 68.03, 66.8, 66.32, 65.3, 66.8, 65.09, 66.59, 66.05, 68.71, 66.46, 67.28, 65.71, 67.41, 67.34, 66.8, 65.3, 65.64, 65.64, 67.0, 66.87, 67.21, 65.64, 67.07, 63.66, 67.96, 67.14, 66.39, 65.57, 67.14, 67.34, 67.34]
[rank1]:2025-11-28 16:02:58,446 - INFO - Destroying the purge thread.
[rank3]:2025-11-28 16:02:58,460 - INFO - 
[rank3]:Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/pipeline_schedule/251128_1602_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 521.23 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-31ms     | [S0,MB2,F]  31-15-47ms     | [S0,MB3,F]  47-15-63ms     | [S0,MB4,F]  63-15-78ms     | [S0,MB5,F]  78-15-94ms     | [S0,MB6,F]  94-15-110ms    | [S0,MB7,F]  110-15-126ms   | [S0,MB0,B]  268-31-300ms   | [S0,MB1,B]  300-31-331ms   | [S0,MB2,B]  331-31-363ms   | [S0,MB3,B]  363-31-394ms   | [S0,MB4,B]  394-31-426ms   | [S0,MB5,B]  426-31-458ms   | [S0,MB6,B]  458-31-489ms   | [S0,MB7,B]  489-31-521ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-31ms     | [S1,MB1,F]  31-15-47ms     | [S1,MB2,F]  47-15-63ms     | [S1,MB3,F]  63-15-78ms     | [S1,MB4,F]  78-15-94ms     | [S1,MB5,F]  94-15-110ms    | [S1,MB6,F]  110-15-126ms   | [S1,MB7,F]  126-15-142ms   | [S1,MB0,B]  236-31-268ms   | [S1,MB1,B]  268-31-300ms   | [S1,MB2,B]  300-31-331ms   | [S1,MB3,B]  331-31-363ms   | [S1,MB4,B]  363-31-394ms   | [S1,MB5,B]  394-31-426ms   | [S1,MB6,B]  426-31-458ms   | [S1,MB7,B]  458-31-489ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  31-15-47ms     | [S2,MB1,F]  47-15-63ms     | [S2,MB2,F]  63-15-78ms     | [S2,MB3,F]  78-15-94ms     | [S2,MB4,F]  94-15-110ms    | [S2,MB5,F]  110-15-126ms   | [S2,MB6,F]  126-15-142ms   | [S2,MB7,F]  142-15-157ms   | [S2,MB0,B]  205-31-236ms   | [S2,MB1,B]  236-31-268ms   | [S2,MB2,B]  268-31-300ms   | [S2,MB3,B]  300-31-331ms   | [S2,MB4,B]  331-31-363ms   | [S2,MB5,B]  363-31-394ms   | [S2,MB6,B]  394-31-426ms   | [S2,MB7,B]  426-31-458ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  47-15-63ms     | [S3,MB1,F]  63-15-78ms     | [S3,MB2,F]  78-15-94ms     | [S3,MB3,F]  94-15-110ms    | [S3,MB4,F]  110-15-126ms   | [S3,MB5,F]  126-15-142ms   | [S3,MB6,F]  142-15-157ms   | [S3,MB7,F]  157-15-173ms   | [S3,MB0,B]  173-31-205ms   | [S3,MB1,B]  205-31-236ms   | [S3,MB2,B]  236-31-268ms   | [S3,MB3,B]  268-31-300ms   | [S3,MB4,B]  300-31-331ms   | [S3,MB5,B]  331-31-363ms   | [S3,MB6,B]  363-31-394ms   | [S3,MB7,B]  394-31-426ms  
[rank3]:2025-11-28 16:02:58,508 - INFO - Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_ratio_history/rank3/251128_1602_stage3_final2000.svg
[rank0]:2025-11-28 16:02:58,629 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_params_histogram/251128_1602_rank0_stage0.svg
[rank0]:	> Counts Sum: 1948680, Total Sum: 4274880 (45.58%), Ratio(%) per element: [45.76, 46.92, 43.78, 44.05, 47.26, 46.03, 43.37, 47.54, 43.37, 43.23, 46.72, 46.24, 48.9, 46.17, 46.99, 46.44, 43.85, 45.96, 46.17, 43.44, 45.08, 43.23, 45.35, 46.72, 48.29, 44.94, 45.21, 45.42, 46.17, 45.62, 45.96, 46.17, 46.03, 46.92, 45.83, 44.8, 45.28, 45.21, 45.35, 46.72, 44.8, 45.28, 45.21, 45.42, 47.13, 45.42, 47.95, 44.53, 44.39, 44.8, 45.76, 45.62, 46.99, 47.74, 44.74, 44.94, 45.08, 44.19, 46.1, 46.51, 44.74, 44.05, 43.64, 45.35, 43.51, 45.28, 45.35, 46.44, 45.69, 45.9, 46.44, 45.96, 45.83]
[rank0]:2025-11-28 16:02:58,629 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-28 16:02:58,675 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200/frozen_params_histogram/251128_1602_rank3_stage3.svg
[rank3]:	> Counts Sum: 2606280, Total Sum: 3806400 (68.47%), Ratio(%) per element: [74.86, 71.44, 67.89, 71.03, 74.86, 75.68, 75.54, 54.57, 54.37, 77.18, 64.89, 73.08, 75.47, 75.54, 74.24, 74.65, 54.09, 54.37, 74.04, 71.92, 60.24, 68.85, 76.16, 75.2, 75.06, 54.5, 54.64, 75.75, 73.9, 58.33, 73.77, 76.91, 76.84, 76.22, 54.84, 53.75, 76.02, 67.69, 73.42, 67.28, 72.33, 76.7, 76.43, 53.96, 55.87, 75.95, 73.36, 70.08, 73.49, 75.75, 75.06, 76.77, 54.57, 54.5, 76.22, 57.44, 74.59, 72.54, 74.79, 75.88, 74.45, 55.6, 55.66, 54.3, 54.91]
[rank3]:2025-11-28 16:02:58,676 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 40-40, summary, console lines 441-458
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.11826
[rank3]:wandb:               final/avg_loss 0.2082
[rank3]:wandb:             final/avg_mfu(%) 35.1275
[rank3]:wandb:             final/avg_tflops 360.74541
[rank3]:wandb:    final/avg_throughput(tps) 7734.65197
[rank3]:wandb:              final/grad_norm 0.07617
[rank3]:wandb:               final/max_loss 0.2082
[rank3]:wandb:                    grad_norm 0.07617
[rank3]:wandb: loss_metrics/global_avg_loss 0.2082
[rank3]:wandb: loss_metrics/global_max_loss 0.2082
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1128_GPipe_timelyapf_th1e-4_h200 at: https://wandb.ai/orangingq/torchtitan/runs/99xd5ziu
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1128_GPipe_timelyapf_th1e-4_h200/20251128-1450/wandb/run-20251128_145024-99xd5ziu/logs
[rank0]:2025-11-28 16:03:00,630 - INFO - Training completed
[rank0]:2025-11-28 16:03:00,630 - INFO - Destroying the purge thread.
[rank1]:2025-11-28 16:03:00,822 - INFO - Process group destroyed
[rank3]:2025-11-28 16:03:00,819 - INFO - Process group destroyed
[rank2]:2025-11-28 16:03:00,838 - INFO - Process group destroyed
[rank0]:2025-11-28 16:03:01,078 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.4', 'tok_embeddings', 'layers.6', 'layers.7', 'layers.2', 'layers.3', 'layers.1', 'layers.5', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.24', 'layers.21', 'layers.23', 'layers.22', 'layers.17', 'layers.20', 'layers.19'}
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.12', 'layers.11', 'layers.8', 'layers.10', 'layers.14', 'layers.16', 'layers.15', 'layers.13'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.31', 'layers.28', 'layers.26', 'layers.25', 'layers.27', 'layers.29', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1128.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:1109: 1) resolved timelyapf issue, 2) seed fixed to 42 for all runs, 3) 3000 steps -> 2000 steps (better benchmark scores!)
[rank3]:1116: everything same, but with seed=11
[rank3]:1128: everything same as 1109, but with th=1e-3, and solve DAG with QP. 
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1128_GPipe_timelyapf_th1e-4_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1128_GPipe_timelyapf_th1e-4_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.0001
[rank3]:		- percentile: 80
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
