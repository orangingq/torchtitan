
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Nov  5 23:18:11 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 2,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/1104_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Experiment
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1104.toml --job.description="Llama 3.1 8B Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1105 23:18:12.879000 453824 site-packages/torch/distributed/run.py:811] 
W1105 23:18:12.879000 453824 site-packages/torch/distributed/run.py:811] *****************************************
W1105 23:18:12.879000 453824 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1105 23:18:12.879000 453824 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-11-05 23:18:19,699 - INFO - Starting job: "Llama 3.1 8B Experiment"
[rank0]:2025-11-05 23:18:19,694 - INFO - Starting job: "Llama 3.1 8B Experiment"
[rank3]:2025-11-05 23:18:19,796 - INFO - Starting job: "Llama 3.1 8B Experiment"
[rank2]:2025-11-05 23:18:19,815 - INFO - Starting job: "Llama 3.1 8B Experiment"
[rank1]:2025-11-05 23:18:20,709 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-05 23:18:20,712 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-05 23:18:20,739 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-05 23:18:20,742 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:18:20,727 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-05 23:18:20,730 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:18:20,735 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-05 23:18:20,742 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-05 23:18:20,745 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-05 23:18:22,478 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-05 23:18:22,760 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank1]:2025-11-05 23:18:24,972 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-05 23:18:25,045 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-05 23:18:25,045 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-05 23:18:25,018 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-05 23:18:24,966 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-05 23:18:25,091 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-05 23:18:25,091 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-05 23:18:25,222 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-05 23:18:25,304 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-05 23:18:25,304 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-05 23:18:25,328 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-05 23:18:25,328 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-05 23:18:25,309 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-05 23:18:25,331 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-05 23:18:25,332 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-05 23:18:25,549 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-05 23:18:25,549 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run w9b29whl
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1104_GPipe_timelyapf_h200/20251105-2318/wandb/run-20251105_231825-w9b29whl
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1104_GPipe_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/w9b29whl
[rank3]:2025-11-05 23:18:27,027 - INFO - WandB logging enabled
[rank3]:2025-11-05 23:18:27,029 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-05 23:18:27,100 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-05 23:18:27,100 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-05 23:18:27,327 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-05 23:18:27,311 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-05 23:18:27,311 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-05 23:18:27,324 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-05 23:18:27,324 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 23:18:27,324 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1104_GPipe_timelyapf_h200
[rank0]:2025-11-05 23:18:27,324 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-05 23:18:27,324 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 200)
[rank0]:2025-11-05 23:18:27,324 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank0]:2025-11-05 23:18:36,338 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-05 23:18:36,338 - INFO - Finished loading the checkpoint in 9.01 seconds.
[rank0]:2025-11-05 23:18:36,338 - INFO - Training starts at step 1
[rank3]:2025-11-05 23:18:40,624 - INFO -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 1,210  tflops: 56.41  mfu: 5.70%
[rank3]:2025-11-05 23:18:40,624 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-05 23:18:40,621 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 1,050  tflops: 48.98  mfu: 4.95%
[rank1]:2025-11-05 23:18:40,621 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 23:18:40,641 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 1,069  tflops: 49.84  mfu: 5.04%
[rank0]:2025-11-05 23:18:40,641 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-05 23:18:40,618 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 1,053  tflops: 49.13  mfu: 4.97%
[rank2]:2025-11-05 23:18:40,618 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-05 23:20:47,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:20:49,922 - INFO - Avg. fwd time: 14.4610 / Avg. bwd time: 42.4444 / Avg. batch time: 473.1470 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-11-05 23:20:49,972 - INFO - Avg. fwd time: 13.0450 / Avg. bwd time: 36.0429 / Avg. batch time: 526.3201 (ms) / GPU bubble ratio: 25.39%
[rank1]:2025-11-05 23:20:50,018 - INFO - Avg. fwd time: 15.0882 / Avg. bwd time: 41.2880 / Avg. batch time: 587.2455 (ms) / GPU bubble ratio: 23.20%
[rank0]:2025-11-05 23:20:50,050 - INFO - Avg. fwd time: 13.9338 / Avg. bwd time: 38.2455 / Avg. batch time: 643.2440 (ms) / GPU bubble ratio: 35.10%
[rank1]:2025-11-05 23:20:50,155 - INFO -  step: 50  loss: -4.0000  grad_norm: 5667.9141  memory: 64.32GiB(46.00%)  tps: 6,198  tflops: 289.06  mfu: 29.23%
[rank3]:2025-11-05 23:20:50,157 - INFO -  step: 50  loss:  9.4309  grad_norm: 5667.9141  memory: 73.38GiB(52.48%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank0]:2025-11-05 23:20:50,160 - INFO -  step: 50  loss: -4.0000  grad_norm: 5667.9141  memory: 66.72GiB(47.72%)  tps: 6,198  tflops: 289.10  mfu: 29.23%
[rank2]:2025-11-05 23:20:50,153 - INFO -  step: 50  loss: -4.0000  grad_norm: 5667.9141  memory: 57.29GiB(40.97%)  tps: 6,198  tflops: 289.06  mfu: 29.23%
[rank0]:2025-11-05 23:22:59,693 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:23:02,119 - INFO - Avg. fwd time: 14.4588 / Avg. bwd time: 42.5274 / Avg. batch time: 472.3810 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-11-05 23:23:02,168 - INFO - Avg. fwd time: 13.0577 / Avg. bwd time: 36.1714 / Avg. batch time: 525.1263 (ms) / GPU bubble ratio: 25.00%
[rank1]:2025-11-05 23:23:02,215 - INFO - Avg. fwd time: 15.0823 / Avg. bwd time: 41.3534 / Avg. batch time: 585.4205 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-11-05 23:23:02,248 - INFO - Avg. fwd time: 13.7185 / Avg. bwd time: 38.3418 / Avg. batch time: 640.9933 (ms) / GPU bubble ratio: 35.03%
[rank1]:2025-11-05 23:23:02,352 - INFO -  step: 100  loss: -4.0000  grad_norm: 75.7409  memory: 64.32GiB(46.00%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank1]:2025-11-05 23:23:02,352 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-05 23:23:02,354 - INFO -  step: 100  loss:  4.4183  grad_norm: 75.7409  memory: 73.38GiB(52.48%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank3]:2025-11-05 23:23:02,355 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-05 23:23:02,350 - INFO -  step: 100  loss: -4.0000  grad_norm: 75.7409  memory: 57.29GiB(40.97%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank2]:2025-11-05 23:23:02,350 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-05 23:23:02,357 - INFO -  step: 100  loss: -4.0000  grad_norm: 75.7409  memory: 66.72GiB(47.72%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank0]:2025-11-05 23:23:02,357 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-05 23:25:11,823 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:25:14,342 - INFO - Avg. fwd time: 14.4120 / Avg. bwd time: 42.5660 / Avg. batch time: 471.8807 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-11-05 23:25:14,384 - INFO - Avg. fwd time: 13.0218 / Avg. bwd time: 36.2427 / Avg. batch time: 524.5116 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-11-05 23:25:14,431 - INFO - Avg. fwd time: 15.0597 / Avg. bwd time: 41.3876 / Avg. batch time: 584.6235 (ms) / GPU bubble ratio: 22.76%
[rank0]:2025-11-05 23:25:14,475 - INFO - Avg. fwd time: 13.6445 / Avg. bwd time: 38.3904 / Avg. batch time: 640.0966 (ms) / GPU bubble ratio: 34.97%
[rank1]:2025-11-05 23:25:14,506 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3530  memory: 64.32GiB(46.00%)  tps: 6,199  tflops: 289.12  mfu: 29.23%
[rank3]:2025-11-05 23:25:14,508 - INFO -  step: 150  loss:  1.9768  grad_norm: 22.3530  memory: 73.38GiB(52.48%)  tps: 6,199  tflops: 289.12  mfu: 29.23%
[rank0]:2025-11-05 23:25:14,510 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3530  memory: 66.72GiB(47.72%)  tps: 6,199  tflops: 289.12  mfu: 29.23%
[rank2]:2025-11-05 23:25:14,504 - INFO -  step: 150  loss: -4.0000  grad_norm: 22.3530  memory: 57.29GiB(40.97%)  tps: 6,199  tflops: 289.12  mfu: 29.23%
[rank3]:2025-11-05 23:25:40,715 - INFO - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-05 23:26:11,936 - INFO - [Step 170] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-05 23:26:12,161 - INFO - [Step 170] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-05 23:26:33,523 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,502 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,533 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,508 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,539 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,506 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,523 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,539 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,556 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,589 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,630 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,570 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,669 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,665 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,703 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,740 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,677 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,714 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,751 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,704 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,742 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,736 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:33,778 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,790 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,827 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,779 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-05 23:26:33,817 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,772 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,811 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,849 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-05 23:26:33,865 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-05 23:26:33,886 - WARNING - Batch index 681 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-05 23:26:49,699 - INFO - [Step 180] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-05 23:26:49,905 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2326_max_batch_time.svg
[rank3]:> Batch Time: 623.98 ms, GPU Bubble Ratio: 32.99%, 27.20%, 36.56%, 26.67%
[rank3]:2025-11-05 23:26:50,047 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2326_min_batch_time.svg
[rank3]:> Batch Time: 350.93 ms, GPU Bubble Ratio: 69.00%, 23.38%, 33.75%, 23.90%
[rank3]:2025-11-05 23:26:50,201 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2326_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 407.84 ms, GPU Bubble Ratio: 27.38%, 19.78%, 24.65%, 20.57%
[rank3]:2025-11-05 23:26:50,201 - INFO - 	> Batch Time: 407.84 ms (Average Freeze Ratio: 0.58, Time Reduction Rate: 0.35)
[rank0]:2025-11-05 23:27:54,977 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:27:57,288 - INFO - Avg. fwd time: 14.4924 / Avg. bwd time: 41.1183 / Avg. batch time: 461.5396 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-11-05 23:27:57,318 - INFO - Avg. fwd time: 13.2327 / Avg. bwd time: 34.0456 / Avg. batch time: 538.6735 (ms) / GPU bubble ratio: 29.79%
[rank1]:2025-11-05 23:27:57,369 - INFO - Avg. fwd time: 15.3332 / Avg. bwd time: 38.8532 / Avg. batch time: 596.1400 (ms) / GPU bubble ratio: 27.28%
[rank0]:2025-11-05 23:27:57,387 - INFO - Avg. fwd time: 13.8256 / Avg. bwd time: 34.3481 / Avg. batch time: 647.4410 (ms) / GPU bubble ratio: 40.47%
[rank2]:2025-11-05 23:28:10,298 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.29/0.86, [MB1] 0.28/0.85, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.23/0.70, [MB5] 0.31/0.93, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-05 23:28:10,299 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.7436  memory: 64.67GiB(46.25%)  tps: 4,660  tflops: 217.34  mfu: 21.98%
[rank1]:2025-11-05 23:28:13,236 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.96, [MB1] 0.04/0.12, [MB2] 0.04/0.13, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.09/0.28, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-05 23:28:13,237 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.7436  memory: 72.68GiB(51.98%)  tps: 4,583  tflops: 213.77  mfu: 21.62%
[rank0]:2025-11-05 23:28:17,512 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.05/0.14, [MB4] 0.00/0.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-11-05 23:28:17,513 - INFO -  step: 200  loss: -4.0000  grad_norm:  8.7436  memory: 68.54GiB(49.02%)  tps: 4,476  tflops: 208.78  mfu: 21.11%
[rank3]:2025-11-05 23:28:18,295 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.20/0.60, [MB5] 0.33/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-05 23:28:18,301 - INFO -  step: 200  loss:  0.5924  grad_norm:  8.7436  memory: 83.85GiB(59.97%)  tps: 4,457  tflops: 207.89  mfu: 21.02%
[rank3]:2025-11-05 23:28:18,441 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2328_real_step200_rank3.svg
[rank3]:> Batch Time: 537.50 ms, GPU Bubble Ratio: 77.17%, 47.33%, 53.78%, 20.79%
[rank1]:2025-11-05 23:28:18,366 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251105_2328_stage1_step200.svg
[rank2]:2025-11-05 23:28:18,367 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251105_2328_stage2_step200.svg
[rank0]:2025-11-05 23:28:18,368 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251105_2328_stage0_step200.svg
[rank3]:2025-11-05 23:28:18,488 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251105_2328_stage3_step200.svg
[rank0]:2025-11-05 23:31:38,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:31:40,700 - INFO - Avg. fwd time: 14.4317 / Avg. bwd time: 40.9669 / Avg. batch time: 459.8942 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-11-05 23:31:40,712 - INFO - Avg. fwd time: 13.3859 / Avg. bwd time: 32.3232 / Avg. batch time: 565.3732 (ms) / GPU bubble ratio: 35.32%
[rank1]:2025-11-05 23:31:40,744 - INFO - Avg. fwd time: 15.5216 / Avg. bwd time: 36.7365 / Avg. batch time: 620.6055 (ms) / GPU bubble ratio: 32.64%
[rank0]:2025-11-05 23:31:40,760 - INFO - Avg. fwd time: 13.9973 / Avg. bwd time: 32.6789 / Avg. batch time: 675.8772 (ms) / GPU bubble ratio: 44.75%
[rank0]:2025-11-05 23:31:44,545 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.09/0.14, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-05 23:31:44,546 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5456  memory: 74.38GiB(53.20%)  tps: 3,957  tflops: 184.55  mfu: 18.66%
[rank2]:2025-11-05 23:31:47,516 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.57/0.86, [MB1] 0.57/0.85, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.46/0.70, [MB5] 0.62/0.93, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-05 23:31:47,517 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5456  memory: 65.94GiB(47.16%)  tps: 3,771  tflops: 175.90  mfu: 17.79%
[rank1]:2025-11-05 23:31:47,718 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.64/0.96, [MB1] 0.08/0.12, [MB2] 0.09/0.13, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.19/0.28, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-05 23:31:47,719 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5456  memory: 73.07GiB(52.26%)  tps: 3,819  tflops: 178.14  mfu: 18.01%
[rank3]:2025-11-05 23:31:59,803 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.40/0.60, [MB5] 0.67/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-05 23:31:59,813 - INFO -  step: 250  loss:  0.2547  grad_norm:  0.5456  memory: 83.85GiB(59.97%)  tps: 3,698  tflops: 172.49  mfu: 17.44%
[rank0]:2025-11-05 23:35:08,517 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-05 23:35:10,745 - INFO - Avg. fwd time: 13.6054 / Avg. bwd time: 30.1119 / Avg. batch time: 607.4717 (ms) / GPU bubble ratio: 42.43%
[rank1]:2025-11-05 23:35:10,770 - INFO - Avg. fwd time: 15.7737 / Avg. bwd time: 34.1519 / Avg. batch time: 660.0335 (ms) / GPU bubble ratio: 39.49%
[rank3]:2025-11-05 23:35:10,722 - INFO - Avg. fwd time: 14.3753 / Avg. bwd time: 40.6103 / Avg. batch time: 457.6323 (ms) / GPU bubble ratio: 3.88%
[rank0]:2025-11-05 23:35:10,791 - INFO - Avg. fwd time: 14.2029 / Avg. bwd time: 30.2662 / Avg. batch time: 714.4343 (ms) / GPU bubble ratio: 50.21%
[rank2]:2025-11-05 23:35:11,416 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.85/0.85, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.70/0.70, [MB5] 0.93/0.93, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 23:35:11,416 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1204  memory: 66.52GiB(47.58%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank1]:2025-11-05 23:35:11,604 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.12/0.12, [MB2] 0.13/0.13, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.28/0.28, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 23:35:11,604 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1204  memory: 73.36GiB(52.47%)  tps: 4,018  tflops: 187.40  mfu: 18.95%
[rank0]:2025-11-05 23:35:12,099 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.14/0.14, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-05 23:35:12,100 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1204  memory: 75.62GiB(54.09%)  tps: 3,947  tflops: 184.09  mfu: 18.61%
[rank2]:2025-11-05 23:35:29,995 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251105_2335_stage2_step300.svg
[rank0]:2025-11-05 23:35:29,993 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251105_2335_stage0_step300.svg
[rank1]:2025-11-05 23:35:29,993 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251105_2335_stage1_step300.svg
[rank3]:2025-11-05 23:35:29,936 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.60/0.60, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-05 23:35:29,941 - INFO -  step: 300  loss:  0.2825  grad_norm:  0.1204  memory: 83.85GiB(59.97%)  tps: 3,899  tflops: 181.83  mfu: 18.39%
[rank3]:2025-11-05 23:35:30,086 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2335_real_step300_rank3.svg
[rank3]:> Batch Time: 548.61 ms, GPU Bubble Ratio: 55.00%, 47.10%, 53.82%, 22.87%
[rank3]:2025-11-05 23:35:30,128 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251105_2335_stage3_step300.svg
[rank0]:2025-11-05 23:38:32,329 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 23:38:34,051 - INFO - Avg. fwd time: 14.3784 / Avg. bwd time: 26.3300 / Avg. batch time: 745.0747 (ms) / GPU bubble ratio: 56.29%
[rank2]:2025-11-05 23:38:34,364 - INFO - Avg. fwd time: 13.8000 / Avg. bwd time: 28.2731 / Avg. batch time: 645.3100 (ms) / GPU bubble ratio: 47.84%
[rank1]:2025-11-05 23:38:34,407 - INFO - Avg. fwd time: 15.9907 / Avg. bwd time: 32.0497 / Avg. batch time: 695.6604 (ms) / GPU bubble ratio: 44.75%
[rank3]:2025-11-05 23:38:34,386 - INFO - Avg. fwd time: 14.3352 / Avg. bwd time: 40.3390 / Avg. batch time: 456.3577 (ms) / GPU bubble ratio: 4.16%
[rank2]:2025-11-05 23:38:34,488 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.85/0.85, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.70/0.70, [MB5] 0.93/0.93, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 23:38:34,505 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,034  tflops: 188.13  mfu: 19.02%
[rank1]:2025-11-05 23:38:34,506 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.12/0.12, [MB2] 0.13/0.13, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.28/0.28, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 23:38:34,507 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,037  tflops: 188.31  mfu: 19.04%
[rank0]:2025-11-05 23:38:34,506 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.14/0.14, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-05 23:38:34,507 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,047  tflops: 188.77  mfu: 19.09%
[rank3]:2025-11-05 23:38:53,654 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.60/0.60, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-05 23:38:53,664 - INFO -  step: 350  loss:  0.3313  grad_norm:  0.0852  memory: 83.85GiB(59.97%)  tps: 4,021  tflops: 187.55  mfu: 18.96%
[rank0]:2025-11-05 23:41:56,116 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 23:41:57,853 - INFO - Avg. fwd time: 14.5303 / Avg. bwd time: 22.8530 / Avg. batch time: 776.2650 (ms) / GPU bubble ratio: 61.47%
[rank2]:2025-11-05 23:41:58,160 - INFO - Avg. fwd time: 13.9705 / Avg. bwd time: 26.6511 / Avg. batch time: 682.8490 (ms) / GPU bubble ratio: 52.41%
[rank1]:2025-11-05 23:41:58,202 - INFO - Avg. fwd time: 16.1821 / Avg. bwd time: 30.1986 / Avg. batch time: 731.2531 (ms) / GPU bubble ratio: 49.26%
[rank3]:2025-11-05 23:41:58,182 - INFO - Avg. fwd time: 14.2975 / Avg. bwd time: 40.1115 / Avg. batch time: 455.3360 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-11-05 23:41:58,285 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.85/0.85, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.70/0.70, [MB5] 0.93/0.93, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-05 23:41:58,301 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,020  tflops: 187.48  mfu: 18.96%
[rank0]:2025-11-05 23:41:58,303 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.14/0.14, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-05 23:41:58,303 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,020  tflops: 187.48  mfu: 18.96%
[rank1]:2025-11-05 23:41:58,303 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.12/0.12, [MB2] 0.13/0.13, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.28/0.28, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-05 23:41:58,303 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,020  tflops: 187.48  mfu: 18.96%
[rank3]:2025-11-05 23:42:17,167 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.60/0.60, [MB5] 1.00/1.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank3]:2025-11-05 23:42:17,172 - INFO -  step: 400  loss:  0.2771  grad_norm:  0.0794  memory: 83.85GiB(59.97%)  tps: 4,025  tflops: 187.75  mfu: 18.98%
[rank2]:2025-11-05 23:42:17,229 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251105_2341_stage2_step400.svg
[rank1]:2025-11-05 23:42:17,224 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251105_2341_stage1_step400.svg
[rank0]:2025-11-05 23:42:17,229 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251105_2341_stage0_step400.svg
[rank3]:2025-11-05 23:42:17,309 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2342_real_step400_rank3.svg
[rank3]:> Batch Time: 532.50 ms, GPU Bubble Ratio: 76.79%, 46.72%, 53.34%, 20.76%
[rank3]:2025-11-05 23:42:17,354 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251105_2342_stage3_step400.svg
[rank0]:2025-11-05 23:45:19,458 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:45:21,617 - INFO - Avg. fwd time: 14.2692 / Avg. bwd time: 39.9305 / Avg. batch time: 454.5015 (ms) / GPU bubble ratio: 4.60%
[rank2]:2025-11-05 23:45:21,640 - INFO - Avg. fwd time: 14.1014 / Avg. bwd time: 25.4068 / Avg. batch time: 700.9059 (ms) / GPU bubble ratio: 54.91%
[rank2]:2025-11-05 23:45:21,672 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,028  tflops: 187.87  mfu: 19.00%
[rank0]:2025-11-05 23:45:21,671 - INFO - Avg. fwd time: 14.6471 / Avg. bwd time: 20.1872 / Avg. batch time: 789.4569 (ms) / GPU bubble ratio: 64.70%
[rank0]:2025-11-05 23:45:21,673 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,028  tflops: 187.87  mfu: 19.00%
[rank1]:2025-11-05 23:45:21,664 - INFO - Avg. fwd time: 16.3290 / Avg. bwd time: 28.7789 / Avg. batch time: 747.8174 (ms) / GPU bubble ratio: 51.74%
[rank1]:2025-11-05 23:45:21,671 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,028  tflops: 187.87  mfu: 19.00%
[rank3]:2025-11-05 23:45:40,159 - INFO -  step: 450  loss:  0.2933  grad_norm:  0.0848  memory: 83.85GiB(59.97%)  tps: 4,036  tflops: 188.23  mfu: 19.03%
[rank0]:2025-11-05 23:48:42,571 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 23:48:44,292 - INFO - Avg. fwd time: 14.7294 / Avg. bwd time: 18.3523 / Avg. batch time: 813.2168 (ms) / GPU bubble ratio: 67.46%
[rank3]:2025-11-05 23:48:44,621 - INFO - Avg. fwd time: 14.2496 / Avg. bwd time: 39.8034 / Avg. batch time: 453.8929 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-11-05 23:48:44,598 - INFO - Avg. fwd time: 14.1911 / Avg. bwd time: 24.5509 / Avg. batch time: 728.0010 (ms) / GPU bubble ratio: 57.43%
[rank1]:2025-11-05 23:48:44,642 - INFO - Avg. fwd time: 16.4283 / Avg. bwd time: 27.8013 / Avg. batch time: 773.8830 (ms) / GPU bubble ratio: 54.28%
[rank2]:2025-11-05 23:48:44,741 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,034  tflops: 188.15  mfu: 19.02%
[rank1]:2025-11-05 23:48:44,743 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,034  tflops: 188.15  mfu: 19.02%
[rank0]:2025-11-05 23:48:44,743 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,034  tflops: 188.15  mfu: 19.02%
[rank3]:2025-11-05 23:49:03,992 - INFO -  step: 500  loss:  0.3115  grad_norm:  0.1128  memory: 83.85GiB(59.97%)  tps: 4,019  tflops: 187.45  mfu: 18.95%
[rank2]:2025-11-05 23:49:04,047 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251105_2348_stage2_step500.svg
[rank1]:2025-11-05 23:49:04,043 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251105_2348_stage1_step500.svg
[rank0]:2025-11-05 23:49:04,046 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251105_2348_stage0_step500.svg
[rank3]:2025-11-05 23:49:04,132 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2349_real_step500_rank3.svg
[rank3]:> Batch Time: 531.50 ms, GPU Bubble Ratio: 76.73%, 46.70%, 53.32%, 20.73%
[rank3]:2025-11-05 23:49:04,173 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251105_2349_stage3_step500.svg
[rank0]:2025-11-05 23:52:06,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 23:52:08,182 - INFO - Avg. fwd time: 14.8047 / Avg. bwd time: 16.5928 / Avg. batch time: 820.7624 (ms) / GPU bubble ratio: 69.40%
[rank2]:2025-11-05 23:52:08,492 - INFO - Avg. fwd time: 14.2751 / Avg. bwd time: 23.7289 / Avg. batch time: 738.7657 (ms) / GPU bubble ratio: 58.85%
[rank1]:2025-11-05 23:52:08,534 - INFO - Avg. fwd time: 16.5226 / Avg. bwd time: 26.8627 / Avg. batch time: 783.6598 (ms) / GPU bubble ratio: 55.71%
[rank3]:2025-11-05 23:52:08,514 - INFO - Avg. fwd time: 14.2261 / Avg. bwd time: 39.6741 / Avg. batch time: 453.2342 (ms) / GPU bubble ratio: 4.86%
[rank1]:2025-11-05 23:52:08,634 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank0]:2025-11-05 23:52:08,633 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank2]:2025-11-05 23:52:08,631 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank3]:2025-11-05 23:52:27,041 - INFO -  step: 550  loss:  0.1745  grad_norm:  0.0882  memory: 83.85GiB(59.97%)  tps: 4,035  tflops: 188.17  mfu: 19.03%
[rank0]:2025-11-05 23:55:30,070 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-05 23:55:32,276 - INFO - Avg. fwd time: 14.2236 / Avg. bwd time: 39.5920 / Avg. batch time: 453.0086 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-11-05 23:55:32,325 - INFO - Avg. fwd time: 16.6131 / Avg. bwd time: 26.0942 / Avg. batch time: 799.4042 (ms) / GPU bubble ratio: 57.26%
[rank0]:2025-11-05 23:55:32,332 - INFO - Avg. fwd time: 14.8785 / Avg. bwd time: 15.1413 / Avg. batch time: 834.6763 (ms) / GPU bubble ratio: 71.23%
[rank1]:2025-11-05 23:55:32,333 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,022  tflops: 187.57  mfu: 18.97%
[rank0]:2025-11-05 23:55:32,334 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,022  tflops: 187.57  mfu: 18.97%
[rank2]:2025-11-05 23:55:32,300 - INFO - Avg. fwd time: 14.3552 / Avg. bwd time: 23.0568 / Avg. batch time: 755.3091 (ms) / GPU bubble ratio: 60.37%
[rank2]:2025-11-05 23:55:32,333 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,022  tflops: 187.57  mfu: 18.97%
[rank3]:2025-11-05 23:55:51,521 - INFO -  step: 600  loss:  0.4098  grad_norm:  0.1367  memory: 83.85GiB(59.97%)  tps: 4,006  tflops: 186.86  mfu: 18.89%
[rank2]:2025-11-05 23:55:51,576 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251105_2355_stage2_step600.svg
[rank1]:2025-11-05 23:55:51,574 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251105_2355_stage1_step600.svg
[rank0]:2025-11-05 23:55:51,575 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251105_2355_stage0_step600.svg
[rank3]:2025-11-05 23:55:51,658 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251105_2355_real_step600_rank3.svg
[rank3]:> Batch Time: 538.50 ms, GPU Bubble Ratio: 76.54%, 46.64%, 53.24%, 20.61%
[rank3]:2025-11-05 23:55:51,700 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251105_2355_stage3_step600.svg
[rank0]:2025-11-05 23:58:56,442 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-05 23:58:58,183 - INFO - Avg. fwd time: 14.9445 / Avg. bwd time: 14.0851 / Avg. batch time: 843.3589 (ms) / GPU bubble ratio: 72.46%
[rank3]:2025-11-05 23:58:58,522 - INFO - Avg. fwd time: 14.2364 / Avg. bwd time: 39.5435 / Avg. batch time: 453.0429 (ms) / GPU bubble ratio: 5.03%
[rank2]:2025-11-05 23:58:58,496 - INFO - Avg. fwd time: 14.4236 / Avg. bwd time: 22.5716 / Avg. batch time: 765.8835 (ms) / GPU bubble ratio: 61.36%
[rank1]:2025-11-05 23:58:58,539 - INFO - Avg. fwd time: 16.6913 / Avg. bwd time: 25.5389 / Avg. batch time: 809.4100 (ms) / GPU bubble ratio: 58.26%
[rank2]:2025-11-05 23:58:58,637 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,971  tflops: 185.20  mfu: 18.73%
[rank0]:2025-11-05 23:58:58,639 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,971  tflops: 185.20  mfu: 18.73%
[rank1]:2025-11-05 23:58:58,639 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,971  tflops: 185.20  mfu: 18.73%
[rank3]:2025-11-05 23:59:18,405 - INFO -  step: 650  loss:  0.2871  grad_norm:  0.0781  memory: 83.85GiB(59.97%)  tps: 3,960  tflops: 184.68  mfu: 18.67%
[rank0]:2025-11-06 00:02:23,688 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:02:25,472 - INFO - Avg. fwd time: 15.0070 / Avg. bwd time: 13.0252 / Avg. batch time: 854.6769 (ms) / GPU bubble ratio: 73.76%
[rank2]:2025-11-06 00:02:25,786 - INFO - Avg. fwd time: 14.4902 / Avg. bwd time: 22.0840 / Avg. batch time: 779.1007 (ms) / GPU bubble ratio: 62.44%
[rank3]:2025-11-06 00:02:25,809 - INFO - Avg. fwd time: 14.2458 / Avg. bwd time: 39.4943 / Avg. batch time: 453.0496 (ms) / GPU bubble ratio: 5.11%
[rank1]:2025-11-06 00:02:25,830 - INFO - Avg. fwd time: 16.7671 / Avg. bwd time: 24.9815 / Avg. batch time: 822.0554 (ms) / GPU bubble ratio: 59.37%
[rank2]:2025-11-06 00:02:25,928 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,952  tflops: 184.32  mfu: 18.64%
[rank0]:2025-11-06 00:02:25,930 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,952  tflops: 184.32  mfu: 18.64%
[rank1]:2025-11-06 00:02:25,930 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,952  tflops: 184.32  mfu: 18.64%
[rank3]:2025-11-06 00:02:44,414 - INFO -  step: 700  loss:  0.3787  grad_norm:  0.1247  memory: 83.85GiB(59.97%)  tps: 3,977  tflops: 185.47  mfu: 18.75%
[rank0]:2025-11-06 00:02:44,468 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0002_stage0_step700.svg
[rank1]:2025-11-06 00:02:44,469 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0002_stage1_step700.svg
[rank2]:2025-11-06 00:02:44,471 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0002_stage2_step700.svg
[rank3]:2025-11-06 00:02:44,553 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0002_real_step700_rank3.svg
[rank3]:> Batch Time: 539.00 ms, GPU Bubble Ratio: 76.56%, 46.69%, 53.25%, 20.64%
[rank3]:2025-11-06 00:02:44,598 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0002_stage3_step700.svg
[rank0]:2025-11-06 00:05:48,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 00:05:50,670 - INFO - Avg. fwd time: 14.5443 / Avg. bwd time: 21.6630 / Avg. batch time: 783.6184 (ms) / GPU bubble ratio: 63.04%
[rank3]:2025-11-06 00:05:50,646 - INFO - Avg. fwd time: 14.2513 / Avg. bwd time: 39.4476 / Avg. batch time: 452.9843 (ms) / GPU bubble ratio: 5.16%
[rank1]:2025-11-06 00:05:50,695 - INFO - Avg. fwd time: 16.8280 / Avg. bwd time: 24.5004 / Avg. batch time: 826.0768 (ms) / GPU bubble ratio: 59.98%
[rank1]:2025-11-06 00:05:50,704 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,001  tflops: 186.58  mfu: 18.87%
[rank0]:2025-11-06 00:05:50,703 - INFO - Avg. fwd time: 15.0561 / Avg. bwd time: 12.1137 / Avg. batch time: 857.5532 (ms) / GPU bubble ratio: 74.65%
[rank0]:2025-11-06 00:05:50,706 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,000  tflops: 186.58  mfu: 18.87%
[rank2]:2025-11-06 00:05:50,704 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,000  tflops: 186.58  mfu: 18.87%
[rank3]:2025-11-06 00:06:08,905 - INFO -  step: 750  loss:  0.1454  grad_norm:  0.0793  memory: 83.85GiB(59.97%)  tps: 4,006  tflops: 186.84  mfu: 18.89%
[rank0]:2025-11-06 00:09:09,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:09:11,672 - INFO - Avg. fwd time: 15.0837 / Avg. bwd time: 11.4282 / Avg. batch time: 868.0691 (ms) / GPU bubble ratio: 75.57%
[rank1]:2025-11-06 00:09:12,030 - INFO - Avg. fwd time: 16.8633 / Avg. bwd time: 24.1350 / Avg. batch time: 837.4622 (ms) / GPU bubble ratio: 60.84%
[rank2]:2025-11-06 00:09:11,987 - INFO - Avg. fwd time: 14.5768 / Avg. bwd time: 21.3434 / Avg. batch time: 795.3891 (ms) / GPU bubble ratio: 63.87%
[rank3]:2025-11-06 00:09:12,010 - INFO - Avg. fwd time: 14.2427 / Avg. bwd time: 39.3950 / Avg. batch time: 452.6992 (ms) / GPU bubble ratio: 5.21%
[rank1]:2025-11-06 00:09:12,131 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,067  tflops: 189.69  mfu: 19.18%
[rank0]:2025-11-06 00:09:12,130 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,067  tflops: 189.69  mfu: 19.18%
[rank2]:2025-11-06 00:09:12,128 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,067  tflops: 189.69  mfu: 19.18%
[rank3]:2025-11-06 00:09:30,595 - INFO -  step: 800  loss:  0.2780  grad_norm:  0.0811  memory: 83.85GiB(59.97%)  tps: 4,062  tflops: 189.44  mfu: 19.15%
[rank1]:2025-11-06 00:09:30,653 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0009_stage1_step800.svg
[rank0]:2025-11-06 00:09:30,654 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0009_stage0_step800.svg
[rank2]:2025-11-06 00:09:30,654 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0009_stage2_step800.svg
[rank3]:2025-11-06 00:09:30,734 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0009_real_step800_rank3.svg
[rank3]:> Batch Time: 531.00 ms, GPU Bubble Ratio: 76.73%, 46.66%, 53.20%, 20.71%
[rank3]:2025-11-06 00:09:30,779 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0009_stage3_step800.svg
[rank0]:2025-11-06 00:12:34,415 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:12:36,126 - INFO - Avg. fwd time: 15.1179 / Avg. bwd time: 10.7205 / Avg. batch time: 869.8341 (ms) / GPU bubble ratio: 76.24%
[rank3]:2025-11-06 00:12:36,463 - INFO - Avg. fwd time: 14.2395 / Avg. bwd time: 39.3486 / Avg. batch time: 452.5267 (ms) / GPU bubble ratio: 5.26%
[rank1]:2025-11-06 00:12:36,484 - INFO - Avg. fwd time: 16.9063 / Avg. bwd time: 23.7592 / Avg. batch time: 840.1208 (ms) / GPU bubble ratio: 61.28%
[rank2]:2025-11-06 00:12:36,441 - INFO - Avg. fwd time: 14.6156 / Avg. bwd time: 21.0142 / Avg. batch time: 798.4397 (ms) / GPU bubble ratio: 64.30%
[rank0]:2025-11-06 00:12:36,583 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,007  tflops: 186.88  mfu: 18.90%
[rank1]:2025-11-06 00:12:36,583 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,007  tflops: 186.88  mfu: 18.90%
[rank2]:2025-11-06 00:12:36,581 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,007  tflops: 186.88  mfu: 18.90%
[rank3]:2025-11-06 00:12:55,417 - INFO -  step: 850  loss:  0.1364  grad_norm:  0.0851  memory: 83.85GiB(59.97%)  tps: 4,000  tflops: 186.54  mfu: 18.86%
[rank0]:2025-11-06 00:15:58,032 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:16:00,190 - INFO - Avg. fwd time: 14.2223 / Avg. bwd time: 39.2919 / Avg. batch time: 452.1417 (ms) / GPU bubble ratio: 5.31%
[rank0]:2025-11-06 00:16:00,249 - INFO - Avg. fwd time: 15.1381 / Avg. bwd time: 10.0954 / Avg. batch time: 876.5404 (ms) / GPU bubble ratio: 76.97%
[rank0]:2025-11-06 00:16:00,252 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,022  tflops: 187.60  mfu: 18.97%
[rank1]:2025-11-06 00:16:00,240 - INFO - Avg. fwd time: 16.9327 / Avg. bwd time: 23.4227 / Avg. batch time: 847.6234 (ms) / GPU bubble ratio: 61.91%
[rank1]:2025-11-06 00:16:00,250 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,022  tflops: 187.60  mfu: 18.97%
[rank2]:2025-11-06 00:16:00,214 - INFO - Avg. fwd time: 14.6398 / Avg. bwd time: 20.7185 / Avg. batch time: 806.3005 (ms) / GPU bubble ratio: 64.92%
[rank2]:2025-11-06 00:16:00,250 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,022  tflops: 187.60  mfu: 18.97%
[rank3]:2025-11-06 00:16:19,472 - INFO -  step: 900  loss:  0.2033  grad_norm:  0.0812  memory: 83.85GiB(59.97%)  tps: 4,015  tflops: 187.24  mfu: 18.93%
[rank0]:2025-11-06 00:16:19,524 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0016_stage0_step900.svg
[rank1]:2025-11-06 00:16:19,523 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0016_stage1_step900.svg
[rank2]:2025-11-06 00:16:19,524 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0016_stage2_step900.svg
[rank3]:2025-11-06 00:16:19,611 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0016_real_step900_rank3.svg
[rank3]:> Batch Time: 531.00 ms, GPU Bubble Ratio: 76.57%, 46.57%, 53.21%, 20.74%
[rank3]:2025-11-06 00:16:19,651 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0016_stage3_step900.svg
[rank0]:2025-11-06 00:19:24,468 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:19:26,210 - INFO - Avg. fwd time: 15.1593 / Avg. bwd time: 9.6148 / Avg. batch time: 880.7578 (ms) / GPU bubble ratio: 77.50%
[rank2]:2025-11-06 00:19:26,527 - INFO - Avg. fwd time: 14.6631 / Avg. bwd time: 20.4945 / Avg. batch time: 811.3976 (ms) / GPU bubble ratio: 65.34%
[rank1]:2025-11-06 00:19:26,571 - INFO - Avg. fwd time: 16.9583 / Avg. bwd time: 23.1664 / Avg. batch time: 852.4503 (ms) / GPU bubble ratio: 62.34%
[rank3]:2025-11-06 00:19:26,551 - INFO - Avg. fwd time: 14.2180 / Avg. bwd time: 39.2563 / Avg. batch time: 451.9603 (ms) / GPU bubble ratio: 5.35%
[rank2]:2025-11-06 00:19:26,669 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,969  tflops: 185.10  mfu: 18.72%
[rank1]:2025-11-06 00:19:26,671 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,969  tflops: 185.10  mfu: 18.72%
[rank0]:2025-11-06 00:19:26,671 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,969  tflops: 185.10  mfu: 18.72%
[rank3]:2025-11-06 00:19:46,218 - INFO -  step: 950  loss:  0.2644  grad_norm:  0.1237  memory: 83.85GiB(59.97%)  tps: 3,962  tflops: 184.81  mfu: 18.69%
[rank0]:2025-11-06 00:22:50,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:22:52,469 - INFO - Avg. fwd time: 15.1860 / Avg. bwd time: 9.1089 / Avg. batch time: 886.6881 (ms) / GPU bubble ratio: 78.08%
[rank2]:2025-11-06 00:22:52,779 - INFO - Avg. fwd time: 14.6916 / Avg. bwd time: 20.2603 / Avg. batch time: 818.2437 (ms) / GPU bubble ratio: 65.83%
[rank3]:2025-11-06 00:22:52,801 - INFO - Avg. fwd time: 14.2180 / Avg. bwd time: 39.2277 / Avg. batch time: 451.8871 (ms) / GPU bubble ratio: 5.38%
[rank1]:2025-11-06 00:22:52,822 - INFO - Avg. fwd time: 16.9905 / Avg. bwd time: 22.8986 / Avg. batch time: 859.0182 (ms) / GPU bubble ratio: 62.85%
[rank2]:2025-11-06 00:22:52,918 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,972  tflops: 185.25  mfu: 18.73%
[rank2]:2025-11-06 00:22:52,919 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 00:22:52,921 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,972  tflops: 185.25  mfu: 18.73%
[rank1]:2025-11-06 00:22:52,921 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 00:22:52,920 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,972  tflops: 185.25  mfu: 18.73%
[rank0]:2025-11-06 00:22:52,920 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 00:22:52,921 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-06 00:23:03,201 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.28 seconds.
[rank1]:2025-11-06 00:23:05,270 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.35 seconds.
[rank0]:2025-11-06 00:23:06,344 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 00:23:06,350 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.43 seconds.
[rank3]:2025-11-06 00:23:12,147 - INFO -  step: 1000  loss:  0.1840  grad_norm:  0.0637  memory: 83.85GiB(59.97%)  tps: 3,978  tflops: 185.54  mfu: 18.76%
[rank3]:2025-11-06 00:23:12,147 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 00:23:24,095 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.95 seconds.
[rank2]:2025-11-06 00:23:24,245 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0023_stage2_step1000.svg
[rank0]:2025-11-06 00:23:24,238 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0023_stage0_step1000.svg
[rank1]:2025-11-06 00:23:24,259 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0023_stage1_step1000.svg
[rank3]:2025-11-06 00:23:24,386 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0023_real_step1000_rank3.svg
[rank3]:> Batch Time: 533.50 ms, GPU Bubble Ratio: 76.59%, 46.63%, 53.26%, 20.81%
[rank3]:2025-11-06 00:23:24,435 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0023_stage3_step1000.svg
[rank0]:2025-11-06 00:26:31,442 - INFO - [GC] Peforming periodical GC collection 1.80 seconds
[rank2]:2025-11-06 00:26:33,717 - INFO - Avg. fwd time: 14.7128 / Avg. bwd time: 20.0471 / Avg. batch time: 819.9425 (ms) / GPU bubble ratio: 66.09%
[rank0]:2025-11-06 00:26:33,756 - INFO - Avg. fwd time: 15.2067 / Avg. bwd time: 8.6537 / Avg. batch time: 887.5765 (ms) / GPU bubble ratio: 78.49%
[rank3]:2025-11-06 00:26:33,692 - INFO - Avg. fwd time: 14.2118 / Avg. bwd time: 39.1975 / Avg. batch time: 451.8792 (ms) / GPU bubble ratio: 5.44%
[rank1]:2025-11-06 00:26:33,745 - INFO - Avg. fwd time: 17.0141 / Avg. bwd time: 22.6556 / Avg. batch time: 860.4671 (ms) / GPU bubble ratio: 63.12%
[rank1]:2025-11-06 00:26:33,757 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,710  tflops: 173.01  mfu: 17.49%
[rank2]:2025-11-06 00:26:33,757 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,710  tflops: 173.01  mfu: 17.49%
[rank0]:2025-11-06 00:26:33,759 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,710  tflops: 173.01  mfu: 17.49%
[rank3]:2025-11-06 00:26:52,470 - INFO -  step: 1050  loss:  0.2901  grad_norm:  0.1085  memory: 83.85GiB(59.97%)  tps: 3,718  tflops: 173.42  mfu: 17.53%
[rank0]:2025-11-06 00:29:58,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:29:59,778 - INFO - Avg. fwd time: 15.2365 / Avg. bwd time: 8.2982 / Avg. batch time: 894.8916 (ms) / GPU bubble ratio: 78.96%
[rank2]:2025-11-06 00:30:00,089 - INFO - Avg. fwd time: 14.7421 / Avg. bwd time: 19.8866 / Avg. batch time: 827.8795 (ms) / GPU bubble ratio: 66.54%
[rank3]:2025-11-06 00:30:00,111 - INFO - Avg. fwd time: 14.2257 / Avg. bwd time: 39.1883 / Avg. batch time: 452.0090 (ms) / GPU bubble ratio: 5.46%
[rank1]:2025-11-06 00:30:00,133 - INFO - Avg. fwd time: 17.0478 / Avg. bwd time: 22.4716 / Avg. batch time: 868.2223 (ms) / GPU bubble ratio: 63.59%
[rank0]:2025-11-06 00:30:00,230 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,968  tflops: 185.05  mfu: 18.71%
[rank2]:2025-11-06 00:30:00,228 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,968  tflops: 185.05  mfu: 18.71%
[rank1]:2025-11-06 00:30:00,230 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,968  tflops: 185.05  mfu: 18.71%
[rank0]:2025-11-06 00:30:19,348 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0030_stage0_step1100.svg
[rank3]:2025-11-06 00:30:19,294 - INFO -  step: 1100  loss:  0.2376  grad_norm:  0.0730  memory: 83.85GiB(59.97%)  tps: 3,961  tflops: 184.74  mfu: 18.68%
[rank2]:2025-11-06 00:30:19,347 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0030_stage2_step1100.svg
[rank1]:2025-11-06 00:30:19,348 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0030_stage1_step1100.svg
[rank3]:2025-11-06 00:30:19,431 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0030_real_step1100_rank3.svg
[rank3]:> Batch Time: 540.50 ms, GPU Bubble Ratio: 76.41%, 46.61%, 53.16%, 20.54%
[rank3]:2025-11-06 00:30:19,473 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0030_stage3_step1100.svg
[rank0]:2025-11-06 00:33:22,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:33:24,712 - INFO - Avg. fwd time: 15.2559 / Avg. bwd time: 7.9187 / Avg. batch time: 894.9359 (ms) / GPU bubble ratio: 79.28%
[rank2]:2025-11-06 00:33:25,025 - INFO - Avg. fwd time: 14.7631 / Avg. bwd time: 19.7112 / Avg. batch time: 828.6142 (ms) / GPU bubble ratio: 66.72%
[rank1]:2025-11-06 00:33:25,068 - INFO - Avg. fwd time: 17.0715 / Avg. bwd time: 22.2709 / Avg. batch time: 868.7472 (ms) / GPU bubble ratio: 63.77%
[rank3]:2025-11-06 00:33:25,047 - INFO - Avg. fwd time: 14.2260 / Avg. bwd time: 39.1670 / Avg. batch time: 451.9461 (ms) / GPU bubble ratio: 5.49%
[rank1]:2025-11-06 00:33:25,165 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,997  tflops: 186.44  mfu: 18.85%
[rank0]:2025-11-06 00:33:25,165 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,997  tflops: 186.44  mfu: 18.85%
[rank2]:2025-11-06 00:33:25,163 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,997  tflops: 186.44  mfu: 18.85%
[rank3]:2025-11-06 00:33:44,848 - INFO -  step: 1150  loss:  0.2203  grad_norm:  0.0666  memory: 83.85GiB(59.97%)  tps: 3,985  tflops: 185.88  mfu: 18.79%
[rank0]:2025-11-06 00:36:48,667 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:36:50,850 - INFO - Avg. fwd time: 14.2247 / Avg. bwd time: 39.1440 / Avg. batch time: 451.8514 (ms) / GPU bubble ratio: 5.51%
[rank2]:2025-11-06 00:36:50,876 - INFO - Avg. fwd time: 14.7815 / Avg. bwd time: 19.5500 / Avg. batch time: 833.4250 (ms) / GPU bubble ratio: 67.05%
[rank2]:2025-11-06 00:36:50,916 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,981  tflops: 185.70  mfu: 18.78%
[rank1]:2025-11-06 00:36:50,904 - INFO - Avg. fwd time: 17.0927 / Avg. bwd time: 22.0871 / Avg. batch time: 873.3683 (ms) / GPU bubble ratio: 64.11%
[rank1]:2025-11-06 00:36:50,916 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,982  tflops: 185.70  mfu: 18.78%
[rank0]:2025-11-06 00:36:50,915 - INFO - Avg. fwd time: 15.2727 / Avg. bwd time: 7.5724 / Avg. batch time: 899.1211 (ms) / GPU bubble ratio: 79.67%
[rank0]:2025-11-06 00:36:50,917 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,981  tflops: 185.70  mfu: 18.78%
[rank3]:2025-11-06 00:37:10,187 - INFO -  step: 1200  loss:  0.2920  grad_norm:  0.0794  memory: 83.85GiB(59.97%)  tps: 3,990  tflops: 186.07  mfu: 18.81%
[rank2]:2025-11-06 00:37:10,241 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0036_stage2_step1200.svg
[rank1]:2025-11-06 00:37:10,240 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0036_stage1_step1200.svg
[rank0]:2025-11-06 00:37:10,243 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0036_stage0_step1200.svg
[rank3]:2025-11-06 00:37:10,328 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0037_real_step1200_rank3.svg
[rank3]:> Batch Time: 535.00 ms, GPU Bubble Ratio: 76.60%, 46.63%, 53.26%, 20.59%
[rank3]:2025-11-06 00:37:10,372 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0037_stage3_step1200.svg
[rank0]:2025-11-06 00:40:11,543 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:40:13,295 - INFO - Avg. fwd time: 15.2844 / Avg. bwd time: 7.2988 / Avg. batch time: 900.7590 (ms) / GPU bubble ratio: 79.94%
[rank3]:2025-11-06 00:40:13,632 - INFO - Avg. fwd time: 14.2211 / Avg. bwd time: 39.1241 / Avg. batch time: 451.7443 (ms) / GPU bubble ratio: 5.53%
[rank2]:2025-11-06 00:40:13,610 - INFO - Avg. fwd time: 14.7945 / Avg. bwd time: 19.4225 / Avg. batch time: 835.5646 (ms) / GPU bubble ratio: 67.24%
[rank1]:2025-11-06 00:40:13,654 - INFO - Avg. fwd time: 17.1072 / Avg. bwd time: 21.9414 / Avg. batch time: 875.3538 (ms) / GPU bubble ratio: 64.31%
[rank1]:2025-11-06 00:40:13,750 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,039  tflops: 188.37  mfu: 19.05%
[rank0]:2025-11-06 00:40:13,749 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,039  tflops: 188.37  mfu: 19.05%
[rank2]:2025-11-06 00:40:13,748 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,039  tflops: 188.37  mfu: 19.05%
[rank3]:2025-11-06 00:40:32,398 - INFO -  step: 1250  loss:  0.2728  grad_norm:  0.0947  memory: 83.85GiB(59.97%)  tps: 4,051  tflops: 188.95  mfu: 19.11%
[rank0]:2025-11-06 00:43:35,469 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:43:37,196 - INFO - Avg. fwd time: 15.2979 / Avg. bwd time: 7.0036 / Avg. batch time: 904.0748 (ms) / GPU bubble ratio: 80.27%
[rank3]:2025-11-06 00:43:37,525 - INFO - Avg. fwd time: 14.2193 / Avg. bwd time: 39.1039 / Avg. batch time: 451.6597 (ms) / GPU bubble ratio: 5.55%
[rank2]:2025-11-06 00:43:37,504 - INFO - Avg. fwd time: 14.8097 / Avg. bwd time: 19.2845 / Avg. batch time: 839.4196 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-11-06 00:43:37,547 - INFO - Avg. fwd time: 17.1249 / Avg. bwd time: 21.7843 / Avg. batch time: 879.0441 (ms) / GPU bubble ratio: 64.59%
[rank0]:2025-11-06 00:43:37,643 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank2]:2025-11-06 00:43:37,641 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank1]:2025-11-06 00:43:37,644 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,018  tflops: 187.39  mfu: 18.95%
[rank3]:2025-11-06 00:43:56,158 - INFO -  step: 1300  loss:  0.2101  grad_norm:  0.0723  memory: 83.85GiB(59.97%)  tps: 4,020  tflops: 187.52  mfu: 18.96%
[rank1]:2025-11-06 00:43:56,212 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0043_stage1_step1300.svg
[rank0]:2025-11-06 00:43:56,214 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0043_stage0_step1300.svg
[rank2]:2025-11-06 00:43:56,214 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0043_stage2_step1300.svg
[rank3]:2025-11-06 00:43:56,294 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0043_real_step1300_rank3.svg
[rank3]:> Batch Time: 528.50 ms, GPU Bubble Ratio: 76.67%, 46.52%, 53.17%, 20.75%
[rank3]:2025-11-06 00:43:56,337 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0043_stage3_step1300.svg
[rank0]:2025-11-06 00:47:01,273 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 00:47:03,437 - INFO - Avg. fwd time: 14.2245 / Avg. bwd time: 39.0944 / Avg. batch time: 451.6980 (ms) / GPU bubble ratio: 5.57%
[rank1]:2025-11-06 00:47:03,492 - INFO - Avg. fwd time: 17.1462 / Avg. bwd time: 21.6420 / Avg. batch time: 879.2668 (ms) / GPU bubble ratio: 64.71%
[rank2]:2025-11-06 00:47:03,463 - INFO - Avg. fwd time: 14.8277 / Avg. bwd time: 19.1600 / Avg. batch time: 839.7856 (ms) / GPU bubble ratio: 67.62%
[rank2]:2025-11-06 00:47:03,504 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,979  tflops: 185.60  mfu: 18.77%
[rank0]:2025-11-06 00:47:03,503 - INFO - Avg. fwd time: 15.3159 / Avg. bwd time: 6.7314 / Avg. batch time: 903.9582 (ms) / GPU bubble ratio: 80.49%
[rank0]:2025-11-06 00:47:03,506 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,979  tflops: 185.60  mfu: 18.77%
[rank1]:2025-11-06 00:47:03,504 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,979  tflops: 185.60  mfu: 18.77%
[rank3]:2025-11-06 00:47:22,342 - INFO -  step: 1350  loss:  0.1462  grad_norm:  0.0900  memory: 83.85GiB(59.97%)  tps: 3,973  tflops: 185.31  mfu: 18.74%
[rank0]:2025-11-06 00:50:24,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:50:26,298 - INFO - Avg. fwd time: 15.3246 / Avg. bwd time: 6.5144 / Avg. batch time: 908.7733 (ms) / GPU bubble ratio: 80.77%
[rank1]:2025-11-06 00:50:26,659 - INFO - Avg. fwd time: 17.1569 / Avg. bwd time: 21.5262 / Avg. batch time: 884.3583 (ms) / GPU bubble ratio: 65.01%
[rank2]:2025-11-06 00:50:26,615 - INFO - Avg. fwd time: 14.8376 / Avg. bwd time: 19.0585 / Avg. batch time: 845.0001 (ms) / GPU bubble ratio: 67.91%
[rank3]:2025-11-06 00:50:26,638 - INFO - Avg. fwd time: 14.2218 / Avg. bwd time: 39.0780 / Avg. batch time: 451.6015 (ms) / GPU bubble ratio: 5.58%
[rank1]:2025-11-06 00:50:26,756 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,030  tflops: 187.98  mfu: 19.01%
[rank2]:2025-11-06 00:50:26,754 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,031  tflops: 187.98  mfu: 19.01%
[rank0]:2025-11-06 00:50:26,756 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,031  tflops: 187.98  mfu: 19.01%
[rank0]:2025-11-06 00:50:45,617 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0050_stage0_step1400.svg
[rank3]:2025-11-06 00:50:45,559 - INFO -  step: 1400  loss:  0.3862  grad_norm:  0.0986  memory: 83.85GiB(59.97%)  tps: 4,031  tflops: 188.02  mfu: 19.01%
[rank1]:2025-11-06 00:50:45,618 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0050_stage1_step1400.svg
[rank2]:2025-11-06 00:50:45,617 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0050_stage2_step1400.svg
[rank3]:2025-11-06 00:50:45,699 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0050_real_step1400_rank3.svg
[rank3]:> Batch Time: 534.50 ms, GPU Bubble Ratio: 76.55%, 46.62%, 53.22%, 20.58%
[rank3]:2025-11-06 00:50:45,744 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0050_stage3_step1400.svg
[rank0]:2025-11-06 00:53:50,034 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 00:53:51,767 - INFO - Avg. fwd time: 15.3449 / Avg. bwd time: 6.2782 / Avg. batch time: 908.3385 (ms) / GPU bubble ratio: 80.96%
[rank3]:2025-11-06 00:53:52,104 - INFO - Avg. fwd time: 14.2319 / Avg. bwd time: 39.0732 / Avg. batch time: 451.7086 (ms) / GPU bubble ratio: 5.59%
[rank1]:2025-11-06 00:53:52,126 - INFO - Avg. fwd time: 17.1803 / Avg. bwd time: 21.4045 / Avg. batch time: 884.2157 (ms) / GPU bubble ratio: 65.09%
[rank2]:2025-11-06 00:53:52,080 - INFO - Avg. fwd time: 14.8573 / Avg. bwd time: 18.9522 / Avg. batch time: 844.9783 (ms) / GPU bubble ratio: 67.99%
[rank1]:2025-11-06 00:53:52,222 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,987  tflops: 185.96  mfu: 18.80%
[rank2]:2025-11-06 00:53:52,220 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,987  tflops: 185.96  mfu: 18.80%
[rank0]:2025-11-06 00:53:52,222 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,987  tflops: 185.96  mfu: 18.80%
[rank3]:2025-11-06 00:54:11,874 - INFO -  step: 1450  loss:  0.1999  grad_norm:  0.0606  memory: 83.85GiB(59.97%)  tps: 3,971  tflops: 185.19  mfu: 18.73%
[rank0]:2025-11-06 00:57:15,129 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-06 00:57:17,507 - INFO - Avg. fwd time: 17.2028 / Avg. bwd time: 21.2917 / Avg. batch time: 887.1419 (ms) / GPU bubble ratio: 65.29%
[rank1]:2025-11-06 00:57:17,522 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,990  tflops: 186.11  mfu: 18.82%
[rank2]:2025-11-06 00:57:17,477 - INFO - Avg. fwd time: 14.8772 / Avg. bwd time: 18.8540 / Avg. batch time: 848.0136 (ms) / GPU bubble ratio: 68.18%
[rank2]:2025-11-06 00:57:17,522 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,990  tflops: 186.11  mfu: 18.82%
[rank3]:2025-11-06 00:57:17,360 - INFO - Avg. fwd time: 14.2439 / Avg. bwd time: 39.0732 / Avg. batch time: 451.8525 (ms) / GPU bubble ratio: 5.60%
[rank0]:2025-11-06 00:57:17,521 - INFO - Avg. fwd time: 15.3647 / Avg. bwd time: 6.0586 / Avg. batch time: 910.9958 (ms) / GPU bubble ratio: 81.19%
[rank0]:2025-11-06 00:57:17,523 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,990  tflops: 186.11  mfu: 18.82%
[rank2]:2025-11-06 00:57:36,943 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0057_stage2_step1500.svg
[rank3]:2025-11-06 00:57:36,887 - INFO -  step: 1500  loss:  0.2975  grad_norm:  0.0880  memory: 83.85GiB(59.97%)  tps: 3,996  tflops: 186.37  mfu: 18.84%
[rank0]:2025-11-06 00:57:36,943 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0057_stage0_step1500.svg
[rank1]:2025-11-06 00:57:36,944 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0057_stage1_step1500.svg
[rank3]:2025-11-06 00:57:37,022 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0057_real_step1500_rank3.svg
[rank3]:> Batch Time: 541.50 ms, GPU Bubble Ratio: 76.48%, 46.71%, 53.25%, 20.43%
[rank3]:2025-11-06 00:57:37,067 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0057_stage3_step1500.svg
[rank0]:2025-11-06 01:00:39,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:00:41,076 - INFO - Avg. fwd time: 15.3819 / Avg. bwd time: 5.8822 / Avg. batch time: 911.9732 (ms) / GPU bubble ratio: 81.35%
[rank2]:2025-11-06 01:00:41,390 - INFO - Avg. fwd time: 14.8935 / Avg. bwd time: 18.7750 / Avg. batch time: 849.2968 (ms) / GPU bubble ratio: 68.29%
[rank3]:2025-11-06 01:00:41,413 - INFO - Avg. fwd time: 14.2533 / Avg. bwd time: 39.0721 / Avg. batch time: 451.9620 (ms) / GPU bubble ratio: 5.61%
[rank1]:2025-11-06 01:00:41,436 - INFO - Avg. fwd time: 17.2214 / Avg. bwd time: 21.2010 / Avg. batch time: 888.3361 (ms) / GPU bubble ratio: 65.40%
[rank0]:2025-11-06 01:00:41,530 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,016  tflops: 187.29  mfu: 18.94%
[rank1]:2025-11-06 01:00:41,531 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,016  tflops: 187.28  mfu: 18.94%
[rank2]:2025-11-06 01:00:41,529 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,016  tflops: 187.29  mfu: 18.94%
[rank3]:2025-11-06 01:00:59,922 - INFO -  step: 1550  loss:  0.2869  grad_norm:  0.0868  memory: 83.85GiB(59.97%)  tps: 4,035  tflops: 188.18  mfu: 19.03%
[rank0]:2025-11-06 01:04:01,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:04:03,652 - INFO - Avg. fwd time: 15.3950 / Avg. bwd time: 5.6891 / Avg. batch time: 913.9448 (ms) / GPU bubble ratio: 81.54%
[rank2]:2025-11-06 01:04:03,969 - INFO - Avg. fwd time: 14.9064 / Avg. bwd time: 18.6867 / Avg. batch time: 851.6134 (ms) / GPU bubble ratio: 68.44%
[rank3]:2025-11-06 01:04:03,992 - INFO - Avg. fwd time: 14.2572 / Avg. bwd time: 39.0639 / Avg. batch time: 451.9758 (ms) / GPU bubble ratio: 5.62%
[rank1]:2025-11-06 01:04:04,014 - INFO - Avg. fwd time: 17.2360 / Avg. bwd time: 21.0998 / Avg. batch time: 890.5493 (ms) / GPU bubble ratio: 65.56%
[rank0]:2025-11-06 01:04:04,110 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,044  tflops: 188.61  mfu: 19.07%
[rank1]:2025-11-06 01:04:04,110 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,044  tflops: 188.61  mfu: 19.07%
[rank2]:2025-11-06 01:04:04,108 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,044  tflops: 188.61  mfu: 19.07%
[rank3]:2025-11-06 01:04:23,710 - INFO -  step: 1600  loss:  0.3949  grad_norm:  0.1232  memory: 83.85GiB(59.97%)  tps: 4,020  tflops: 187.49  mfu: 18.96%
[rank2]:2025-11-06 01:04:23,772 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0104_stage2_step1600.svg
[rank0]:2025-11-06 01:04:23,769 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0104_stage0_step1600.svg
[rank1]:2025-11-06 01:04:23,766 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0104_stage1_step1600.svg
[rank3]:2025-11-06 01:04:23,846 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0104_real_step1600_rank3.svg
[rank3]:> Batch Time: 539.50 ms, GPU Bubble Ratio: 76.44%, 46.69%, 53.32%, 20.59%
[rank3]:2025-11-06 01:04:23,892 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0104_stage3_step1600.svg
[rank0]:2025-11-06 01:07:29,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:07:31,635 - INFO - Avg. fwd time: 14.2632 / Avg. bwd time: 39.0613 / Avg. batch time: 452.0479 (ms) / GPU bubble ratio: 5.63%
[rank1]:2025-11-06 01:07:31,694 - INFO - Avg. fwd time: 17.2518 / Avg. bwd time: 21.0056 / Avg. batch time: 890.3849 (ms) / GPU bubble ratio: 65.63%
[rank1]:2025-11-06 01:07:31,710 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,946  tflops: 184.04  mfu: 18.61%
[rank2]:2025-11-06 01:07:31,663 - INFO - Avg. fwd time: 14.9203 / Avg. bwd time: 18.6048 / Avg. batch time: 851.5423 (ms) / GPU bubble ratio: 68.50%
[rank2]:2025-11-06 01:07:31,710 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,946  tflops: 184.04  mfu: 18.61%
[rank0]:2025-11-06 01:07:31,708 - INFO - Avg. fwd time: 15.4092 / Avg. bwd time: 5.5081 / Avg. batch time: 913.5567 (ms) / GPU bubble ratio: 81.68%
[rank0]:2025-11-06 01:07:31,712 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,946  tflops: 184.04  mfu: 18.61%
[rank3]:2025-11-06 01:07:51,166 - INFO -  step: 1650  loss:  0.4199  grad_norm:  0.1367  memory: 83.85GiB(59.97%)  tps: 3,949  tflops: 184.17  mfu: 18.62%
[rank0]:2025-11-06 01:10:57,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:10:59,540 - INFO - Avg. fwd time: 15.4209 / Avg. bwd time: 5.3620 / Avg. batch time: 917.8220 (ms) / GPU bubble ratio: 81.89%
[rank2]:2025-11-06 01:10:59,855 - INFO - Avg. fwd time: 14.9316 / Avg. bwd time: 18.5386 / Avg. batch time: 856.0654 (ms) / GPU bubble ratio: 68.72%
[rank3]:2025-11-06 01:10:59,879 - INFO - Avg. fwd time: 14.2684 / Avg. bwd time: 39.0600 / Avg. batch time: 452.1140 (ms) / GPU bubble ratio: 5.64%
[rank1]:2025-11-06 01:10:59,900 - INFO - Avg. fwd time: 17.2648 / Avg. bwd time: 20.9298 / Avg. batch time: 894.8319 (ms) / GPU bubble ratio: 65.85%
[rank2]:2025-11-06 01:10:59,994 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,933  tflops: 183.44  mfu: 18.55%
[rank0]:2025-11-06 01:10:59,996 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,933  tflops: 183.44  mfu: 18.55%
[rank1]:2025-11-06 01:10:59,996 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,933  tflops: 183.44  mfu: 18.55%
[rank3]:2025-11-06 01:11:18,853 - INFO -  step: 1700  loss:  0.4162  grad_norm:  0.1230  memory: 83.85GiB(59.97%)  tps: 3,944  tflops: 183.97  mfu: 18.60%
[rank2]:2025-11-06 01:11:18,911 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0110_stage2_step1700.svg
[rank0]:2025-11-06 01:11:18,908 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0110_stage0_step1700.svg
[rank1]:2025-11-06 01:11:18,911 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0110_stage1_step1700.svg
[rank3]:2025-11-06 01:11:18,996 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0111_real_step1700_rank3.svg
[rank3]:> Batch Time: 539.50 ms, GPU Bubble Ratio: 76.55%, 46.72%, 53.33%, 20.49%
[rank3]:2025-11-06 01:11:19,041 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0111_stage3_step1700.svg
[rank0]:2025-11-06 01:14:23,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:14:25,339 - INFO - Avg. fwd time: 15.4331 / Avg. bwd time: 5.2010 / Avg. batch time: 917.1950 (ms) / GPU bubble ratio: 82.00%
[rank2]:2025-11-06 01:14:25,656 - INFO - Avg. fwd time: 14.9435 / Avg. bwd time: 18.4657 / Avg. batch time: 855.7232 (ms) / GPU bubble ratio: 68.77%
[rank3]:2025-11-06 01:14:25,680 - INFO - Avg. fwd time: 14.2733 / Avg. bwd time: 39.0554 / Avg. batch time: 452.1571 (ms) / GPU bubble ratio: 5.65%
[rank1]:2025-11-06 01:14:25,701 - INFO - Avg. fwd time: 17.2787 / Avg. bwd time: 20.8458 / Avg. batch time: 894.4054 (ms) / GPU bubble ratio: 65.90%
[rank0]:2025-11-06 01:14:25,797 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,981  tflops: 185.65  mfu: 18.77%
[rank1]:2025-11-06 01:14:25,797 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,981  tflops: 185.65  mfu: 18.77%
[rank2]:2025-11-06 01:14:25,795 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,981  tflops: 185.65  mfu: 18.77%
[rank3]:2025-11-06 01:14:44,221 - INFO -  step: 1750  loss:  0.4328  grad_norm:  0.1272  memory: 83.85GiB(59.97%)  tps: 3,989  tflops: 186.05  mfu: 18.81%
[rank0]:2025-11-06 01:17:46,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:17:48,680 - INFO - Avg. fwd time: 14.2667 / Avg. bwd time: 39.0410 / Avg. batch time: 452.0273 (ms) / GPU bubble ratio: 5.66%
[rank2]:2025-11-06 01:17:48,709 - INFO - Avg. fwd time: 14.9480 / Avg. bwd time: 18.3936 / Avg. batch time: 857.8015 (ms) / GPU bubble ratio: 68.91%
[rank2]:2025-11-06 01:17:48,756 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,036  tflops: 188.25  mfu: 19.03%
[rank0]:2025-11-06 01:17:48,755 - INFO - Avg. fwd time: 15.4358 / Avg. bwd time: 5.0494 / Avg. batch time: 918.9900 (ms) / GPU bubble ratio: 82.17%
[rank0]:2025-11-06 01:17:48,757 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,036  tflops: 188.25  mfu: 19.03%
[rank1]:2025-11-06 01:17:48,741 - INFO - Avg. fwd time: 17.2816 / Avg. bwd time: 20.7637 / Avg. batch time: 896.3946 (ms) / GPU bubble ratio: 66.05%
[rank1]:2025-11-06 01:17:48,756 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,036  tflops: 188.25  mfu: 19.03%
[rank3]:2025-11-06 01:18:08,124 - INFO -  step: 1800  loss:  0.0704  grad_norm:  0.0406  memory: 83.85GiB(59.97%)  tps: 4,018  tflops: 187.38  mfu: 18.95%
[rank0]:2025-11-06 01:18:08,182 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0117_stage0_step1800.svg
[rank1]:2025-11-06 01:18:08,182 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0117_stage1_step1800.svg
[rank2]:2025-11-06 01:18:08,183 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0117_stage2_step1800.svg
[rank3]:2025-11-06 01:18:08,262 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0118_real_step1800_rank3.svg
[rank3]:> Batch Time: 522.50 ms, GPU Bubble Ratio: 76.98%, 46.70%, 53.11%, 20.79%
[rank3]:2025-11-06 01:18:08,308 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0118_stage3_step1800.svg
[rank0]:2025-11-06 01:21:09,018 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:21:10,736 - INFO - Avg. fwd time: 15.4369 / Avg. bwd time: 4.9264 / Avg. batch time: 919.5972 (ms) / GPU bubble ratio: 82.29%
[rank2]:2025-11-06 01:21:11,043 - INFO - Avg. fwd time: 14.9505 / Avg. bwd time: 18.3338 / Avg. batch time: 858.6429 (ms) / GPU bubble ratio: 68.99%
[rank3]:2025-11-06 01:21:11,066 - INFO - Avg. fwd time: 14.2600 / Avg. bwd time: 39.0263 / Avg. batch time: 451.8887 (ms) / GPU bubble ratio: 5.66%
[rank1]:2025-11-06 01:21:11,087 - INFO - Avg. fwd time: 17.2833 / Avg. bwd time: 20.6960 / Avg. batch time: 897.1613 (ms) / GPU bubble ratio: 66.13%
[rank2]:2025-11-06 01:21:11,178 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,047  tflops: 188.75  mfu: 19.09%
[rank0]:2025-11-06 01:21:11,180 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,047  tflops: 188.75  mfu: 19.09%
[rank1]:2025-11-06 01:21:11,180 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,047  tflops: 188.75  mfu: 19.08%
[rank3]:2025-11-06 01:21:29,538 - INFO -  step: 1850  loss:  0.3579  grad_norm:  0.1345  memory: 83.85GiB(59.97%)  tps: 4,067  tflops: 189.70  mfu: 19.18%
[rank0]:2025-11-06 01:24:30,398 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:24:32,106 - INFO - Avg. fwd time: 15.4350 / Avg. bwd time: 4.7901 / Avg. batch time: 921.0808 (ms) / GPU bubble ratio: 82.43%
[rank2]:2025-11-06 01:24:32,412 - INFO - Avg. fwd time: 14.9509 / Avg. bwd time: 18.2669 / Avg. batch time: 860.3910 (ms) / GPU bubble ratio: 69.11%
[rank3]:2025-11-06 01:24:32,437 - INFO - Avg. fwd time: 14.2494 / Avg. bwd time: 39.0085 / Avg. batch time: 451.7042 (ms) / GPU bubble ratio: 5.68%
[rank1]:2025-11-06 01:24:32,457 - INFO - Avg. fwd time: 17.2829 / Avg. bwd time: 20.6206 / Avg. batch time: 898.8235 (ms) / GPU bubble ratio: 66.26%
[rank1]:2025-11-06 01:24:32,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,068  tflops: 189.74  mfu: 19.18%
[rank2]:2025-11-06 01:24:32,547 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,068  tflops: 189.74  mfu: 19.18%
[rank0]:2025-11-06 01:24:32,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,068  tflops: 189.74  mfu: 19.18%
[rank3]:2025-11-06 01:24:50,892 - INFO -  step: 1900  loss:  0.1963  grad_norm:  0.0651  memory: 83.85GiB(59.97%)  tps: 4,069  tflops: 189.76  mfu: 19.19%
[rank1]:2025-11-06 01:24:50,951 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0124_stage1_step1900.svg
[rank2]:2025-11-06 01:24:50,951 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0124_stage2_step1900.svg
[rank0]:2025-11-06 01:24:50,951 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0124_stage0_step1900.svg
[rank3]:2025-11-06 01:24:51,030 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0124_real_step1900_rank3.svg
[rank3]:> Batch Time: 526.00 ms, GPU Bubble Ratio: 76.85%, 46.61%, 53.16%, 20.64%
[rank3]:2025-11-06 01:24:51,076 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0124_stage3_step1900.svg
[rank0]:2025-11-06 01:27:51,593 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 01:27:53,742 - INFO - Avg. fwd time: 14.9504 / Avg. bwd time: 18.2029 / Avg. batch time: 859.7063 (ms) / GPU bubble ratio: 69.15%
[rank0]:2025-11-06 01:27:53,789 - INFO - Avg. fwd time: 15.4319 / Avg. bwd time: 4.6613 / Avg. batch time: 920.1456 (ms) / GPU bubble ratio: 82.53%
[rank3]:2025-11-06 01:27:53,713 - INFO - Avg. fwd time: 14.2372 / Avg. bwd time: 38.9905 / Avg. batch time: 451.5085 (ms) / GPU bubble ratio: 5.69%
[rank1]:2025-11-06 01:27:53,774 - INFO - Avg. fwd time: 17.2812 / Avg. bwd time: 20.5486 / Avg. batch time: 898.0576 (ms) / GPU bubble ratio: 66.30%
[rank1]:2025-11-06 01:27:53,790 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,071  tflops: 189.86  mfu: 19.20%
[rank2]:2025-11-06 01:27:53,791 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,071  tflops: 189.86  mfu: 19.20%
[rank0]:2025-11-06 01:27:53,792 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,071  tflops: 189.86  mfu: 19.20%
[rank3]:2025-11-06 01:28:11,740 - INFO -  step: 1950  loss:  0.1633  grad_norm:  0.0680  memory: 83.85GiB(59.97%)  tps: 4,079  tflops: 190.23  mfu: 19.24%
[rank0]:2025-11-06 01:31:09,678 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:31:11,394 - INFO - Avg. fwd time: 15.4292 / Avg. bwd time: 4.5562 / Avg. batch time: 922.6341 (ms) / GPU bubble ratio: 82.67%
[rank2]:2025-11-06 01:31:11,700 - INFO - Avg. fwd time: 14.9498 / Avg. bwd time: 18.1509 / Avg. batch time: 862.4016 (ms) / GPU bubble ratio: 69.29%
[rank3]:2025-11-06 01:31:11,723 - INFO - Avg. fwd time: 14.2270 / Avg. bwd time: 38.9745 / Avg. batch time: 451.3329 (ms) / GPU bubble ratio: 5.70%
[rank1]:2025-11-06 01:31:11,744 - INFO - Avg. fwd time: 17.2794 / Avg. bwd time: 20.4900 / Avg. batch time: 900.6850 (ms) / GPU bubble ratio: 66.45%
[rank0]:2025-11-06 01:31:11,837 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,136  tflops: 192.92  mfu: 19.51%
[rank0]:2025-11-06 01:31:11,837 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 01:31:11,840 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-06 01:31:11,837 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,136  tflops: 192.92  mfu: 19.51%
[rank1]:2025-11-06 01:31:11,837 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 01:31:11,835 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,136  tflops: 192.93  mfu: 19.51%
[rank2]:2025-11-06 01:31:11,835 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 01:31:23,112 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.28 seconds.
[rank1]:2025-11-06 01:31:23,825 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.99 seconds.
[rank0]:2025-11-06 01:31:26,223 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-06 01:31:26,231 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.39 seconds.
[rank3]:2025-11-06 01:31:30,691 - INFO -  step: 2000  loss:  0.1947  grad_norm:  0.0552  memory: 83.85GiB(59.97%)  tps: 4,118  tflops: 192.05  mfu: 19.42%
[rank3]:2025-11-06 01:31:30,691 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 01:31:42,927 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.24 seconds.
[rank2]:2025-11-06 01:31:43,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0131_stage2_step2000.svg
[rank0]:2025-11-06 01:31:43,115 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0131_stage0_step2000.svg
[rank1]:2025-11-06 01:31:43,129 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0131_stage1_step2000.svg
[rank3]:2025-11-06 01:31:43,192 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0131_real_step2000_rank3.svg
[rank3]:> Batch Time: 526.00 ms, GPU Bubble Ratio: 76.85%, 46.56%, 53.15%, 20.72%
[rank3]:2025-11-06 01:31:43,281 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0131_stage3_step2000.svg
[rank0]:2025-11-06 01:34:57,208 - INFO - [GC] Peforming periodical GC collection 2.30 seconds
[rank0]:2025-11-06 01:34:58,984 - INFO - Avg. fwd time: 15.4281 / Avg. bwd time: 4.4395 / Avg. batch time: 923.0006 (ms) / GPU bubble ratio: 82.78%
[rank2]:2025-11-06 01:34:59,284 - INFO - Avg. fwd time: 14.9494 / Avg. bwd time: 18.0928 / Avg. batch time: 862.9850 (ms) / GPU bubble ratio: 69.37%
[rank3]:2025-11-06 01:34:59,307 - INFO - Avg. fwd time: 14.2163 / Avg. bwd time: 38.9562 / Avg. batch time: 451.1376 (ms) / GPU bubble ratio: 5.71%
[rank1]:2025-11-06 01:34:59,329 - INFO - Avg. fwd time: 17.2777 / Avg. bwd time: 20.4246 / Avg. batch time: 901.1936 (ms) / GPU bubble ratio: 66.53%
[rank0]:2025-11-06 01:34:59,423 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,600  tflops: 167.88  mfu: 16.97%
[rank1]:2025-11-06 01:34:59,422 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,600  tflops: 167.88  mfu: 16.98%
[rank2]:2025-11-06 01:34:59,420 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,600  tflops: 167.88  mfu: 16.98%
[rank3]:2025-11-06 01:35:22,091 - INFO -  step: 2050  loss:  0.2177  grad_norm:  0.0589  memory: 83.85GiB(59.97%)  tps: 3,540  tflops: 165.12  mfu: 16.70%
[rank0]:2025-11-06 01:38:24,338 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 01:38:26,494 - INFO - Avg. fwd time: 14.9489 / Avg. bwd time: 18.0378 / Avg. batch time: 865.1612 (ms) / GPU bubble ratio: 69.50%
[rank1]:2025-11-06 01:38:26,527 - INFO - Avg. fwd time: 17.2759 / Avg. bwd time: 20.3628 / Avg. batch time: 903.3005 (ms) / GPU bubble ratio: 66.67%
[rank1]:2025-11-06 01:38:26,544 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,955  tflops: 184.47  mfu: 18.65%
[rank3]:2025-11-06 01:38:26,462 - INFO - Avg. fwd time: 14.2058 / Avg. bwd time: 38.9384 / Avg. batch time: 450.9476 (ms) / GPU bubble ratio: 5.72%
[rank2]:2025-11-06 01:38:26,544 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,955  tflops: 184.47  mfu: 18.65%
[rank0]:2025-11-06 01:38:26,543 - INFO - Avg. fwd time: 15.4259 / Avg. bwd time: 4.3286 / Avg. batch time: 924.9639 (ms) / GPU bubble ratio: 82.91%
[rank0]:2025-11-06 01:38:26,546 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,955  tflops: 184.47  mfu: 18.65%
[rank0]:2025-11-06 01:38:45,837 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0138_stage0_step2100.svg
[rank3]:2025-11-06 01:38:45,772 - INFO -  step: 2100  loss:  0.2208  grad_norm:  0.0419  memory: 83.85GiB(59.97%)  tps: 4,022  tflops: 187.59  mfu: 18.97%
[rank1]:2025-11-06 01:38:45,823 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0138_stage1_step2100.svg
[rank2]:2025-11-06 01:38:45,828 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0138_stage2_step2100.svg
[rank3]:2025-11-06 01:38:45,911 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0138_real_step2100_rank3.svg
[rank3]:> Batch Time: 528.00 ms, GPU Bubble Ratio: 76.75%, 46.67%, 53.28%, 20.86%
[rank3]:2025-11-06 01:38:45,953 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0138_stage3_step2100.svg
[rank0]:2025-11-06 01:41:45,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:41:47,459 - INFO - Avg. fwd time: 15.4240 / Avg. bwd time: 4.2378 / Avg. batch time: 925.3110 (ms) / GPU bubble ratio: 83.00%
[rank2]:2025-11-06 01:41:47,766 - INFO - Avg. fwd time: 14.9483 / Avg. bwd time: 17.9925 / Avg. batch time: 865.6851 (ms) / GPU bubble ratio: 69.56%
[rank3]:2025-11-06 01:41:47,790 - INFO - Avg. fwd time: 14.1969 / Avg. bwd time: 38.9245 / Avg. batch time: 450.7944 (ms) / GPU bubble ratio: 5.73%
[rank1]:2025-11-06 01:41:47,809 - INFO - Avg. fwd time: 17.2743 / Avg. bwd time: 20.3119 / Avg. batch time: 903.7659 (ms) / GPU bubble ratio: 66.73%
[rank1]:2025-11-06 01:41:47,902 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,068  tflops: 189.75  mfu: 19.19%
[rank2]:2025-11-06 01:41:47,900 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,068  tflops: 189.75  mfu: 19.19%
[rank0]:2025-11-06 01:41:47,901 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,068  tflops: 189.75  mfu: 19.19%
[rank3]:2025-11-06 01:42:06,630 - INFO -  step: 2150  loss:  0.1851  grad_norm:  0.0659  memory: 83.85GiB(59.97%)  tps: 4,079  tflops: 190.23  mfu: 19.23%
[rank0]:2025-11-06 01:45:06,884 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:45:08,579 - INFO - Avg. fwd time: 15.4214 / Avg. bwd time: 4.1367 / Avg. batch time: 926.4594 (ms) / GPU bubble ratio: 83.11%
[rank2]:2025-11-06 01:45:08,882 - INFO - Avg. fwd time: 14.9476 / Avg. bwd time: 17.9424 / Avg. batch time: 867.0322 (ms) / GPU bubble ratio: 69.65%
[rank3]:2025-11-06 01:45:08,906 - INFO - Avg. fwd time: 14.1870 / Avg. bwd time: 38.9092 / Avg. batch time: 450.6254 (ms) / GPU bubble ratio: 5.74%
[rank1]:2025-11-06 01:45:08,925 - INFO - Avg. fwd time: 17.2723 / Avg. bwd time: 20.2554 / Avg. batch time: 905.0482 (ms) / GPU bubble ratio: 66.83%
[rank0]:2025-11-06 01:45:09,016 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,073  tflops: 189.98  mfu: 19.21%
[rank2]:2025-11-06 01:45:09,014 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,073  tflops: 189.98  mfu: 19.21%
[rank1]:2025-11-06 01:45:09,017 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,073  tflops: 189.98  mfu: 19.21%
[rank3]:2025-11-06 01:45:28,323 - INFO -  step: 2200  loss:  0.1782  grad_norm:  0.0572  memory: 83.85GiB(59.97%)  tps: 4,062  tflops: 189.44  mfu: 19.15%
[rank1]:2025-11-06 01:45:28,379 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0145_stage1_step2200.svg
[rank0]:2025-11-06 01:45:28,379 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0145_stage0_step2200.svg
[rank2]:2025-11-06 01:45:28,378 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0145_stage2_step2200.svg
[rank3]:2025-11-06 01:45:28,464 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0145_real_step2200_rank3.svg
[rank3]:> Batch Time: 528.00 ms, GPU Bubble Ratio: 76.75%, 46.59%, 53.25%, 20.89%
[rank3]:2025-11-06 01:45:28,507 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0145_stage3_step2200.svg
[rank0]:2025-11-06 01:48:30,411 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 01:48:32,538 - INFO - Avg. fwd time: 14.1776 / Avg. bwd time: 38.8952 / Avg. batch time: 450.4694 (ms) / GPU bubble ratio: 5.75%
[rank2]:2025-11-06 01:48:32,570 - INFO - Avg. fwd time: 14.9469 / Avg. bwd time: 17.8944 / Avg. batch time: 866.4373 (ms) / GPU bubble ratio: 69.68%
[rank2]:2025-11-06 01:48:32,619 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,023  tflops: 187.66  mfu: 18.97%
[rank1]:2025-11-06 01:48:32,603 - INFO - Avg. fwd time: 17.2703 / Avg. bwd time: 20.2014 / Avg. batch time: 904.3923 (ms) / GPU bubble ratio: 66.85%
[rank1]:2025-11-06 01:48:32,619 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,024  tflops: 187.66  mfu: 18.97%
[rank0]:2025-11-06 01:48:32,618 - INFO - Avg. fwd time: 15.4188 / Avg. bwd time: 4.0402 / Avg. batch time: 925.6765 (ms) / GPU bubble ratio: 83.18%
[rank0]:2025-11-06 01:48:32,621 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,023  tflops: 187.66  mfu: 18.97%
[rank3]:2025-11-06 01:48:52,021 - INFO -  step: 2250  loss:  0.2188  grad_norm:  0.0507  memory: 83.85GiB(59.97%)  tps: 4,022  tflops: 187.57  mfu: 18.97%
[rank0]:2025-11-06 01:51:50,541 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:51:52,252 - INFO - Avg. fwd time: 15.4171 / Avg. bwd time: 3.9611 / Avg. batch time: 927.9604 (ms) / GPU bubble ratio: 83.29%
[rank3]:2025-11-06 01:51:52,586 - INFO - Avg. fwd time: 14.1698 / Avg. bwd time: 38.8816 / Avg. batch time: 450.3233 (ms) / GPU bubble ratio: 5.75%
[rank2]:2025-11-06 01:51:52,563 - INFO - Avg. fwd time: 14.9464 / Avg. bwd time: 17.8549 / Avg. batch time: 868.8766 (ms) / GPU bubble ratio: 69.80%
[rank1]:2025-11-06 01:51:52,604 - INFO - Avg. fwd time: 17.2687 / Avg. bwd time: 20.1571 / Avg. batch time: 906.7809 (ms) / GPU bubble ratio: 66.98%
[rank2]:2025-11-06 01:51:52,693 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,095  tflops: 190.97  mfu: 19.31%
[rank1]:2025-11-06 01:51:52,695 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,094  tflops: 190.97  mfu: 19.31%
[rank0]:2025-11-06 01:51:52,694 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,095  tflops: 190.97  mfu: 19.31%
[rank3]:2025-11-06 01:52:12,432 - INFO -  step: 2300  loss:  0.1955  grad_norm:  0.0458  memory: 83.85GiB(59.97%)  tps: 4,088  tflops: 190.65  mfu: 19.28%
[rank2]:2025-11-06 01:52:12,486 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0151_stage2_step2300.svg
[rank1]:2025-11-06 01:52:12,487 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0151_stage1_step2300.svg
[rank0]:2025-11-06 01:52:12,487 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0151_stage0_step2300.svg
[rank3]:2025-11-06 01:52:12,571 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0152_real_step2300_rank3.svg
[rank3]:> Batch Time: 526.00 ms, GPU Bubble Ratio: 76.67%, 46.47%, 53.14%, 20.75%
[rank3]:2025-11-06 01:52:12,613 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0152_stage3_step2300.svg
[rank0]:2025-11-06 01:55:13,429 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 01:55:15,139 - INFO - Avg. fwd time: 15.4148 / Avg. bwd time: 3.8726 / Avg. batch time: 927.0510 (ms) / GPU bubble ratio: 83.36%
[rank2]:2025-11-06 01:55:15,450 - INFO - Avg. fwd time: 14.9457 / Avg. bwd time: 17.8108 / Avg. batch time: 868.1415 (ms) / GPU bubble ratio: 69.81%
[rank1]:2025-11-06 01:55:15,493 - INFO - Avg. fwd time: 17.2669 / Avg. bwd time: 20.1077 / Avg. batch time: 905.9890 (ms) / GPU bubble ratio: 67.00%
[rank3]:2025-11-06 01:55:15,473 - INFO - Avg. fwd time: 14.1612 / Avg. bwd time: 38.8673 / Avg. batch time: 450.1677 (ms) / GPU bubble ratio: 5.76%
[rank2]:2025-11-06 01:55:15,582 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,038  tflops: 188.32  mfu: 19.04%
[rank1]:2025-11-06 01:55:15,584 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,038  tflops: 188.32  mfu: 19.04%
[rank0]:2025-11-06 01:55:15,584 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,038  tflops: 188.32  mfu: 19.04%
[rank3]:2025-11-06 01:55:34,048 - INFO -  step: 2350  loss:  0.1832  grad_norm:  0.0377  memory: 83.85GiB(59.97%)  tps: 4,063  tflops: 189.51  mfu: 19.16%
[rank0]:2025-11-06 01:58:36,275 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 01:58:38,448 - INFO - Avg. fwd time: 14.9452 / Avg. bwd time: 17.7683 / Avg. batch time: 869.5048 (ms) / GPU bubble ratio: 69.90%
[rank1]:2025-11-06 01:58:38,482 - INFO - Avg. fwd time: 17.2653 / Avg. bwd time: 20.0602 / Avg. batch time: 907.2990 (ms) / GPU bubble ratio: 67.09%
[rank1]:2025-11-06 01:58:38,500 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,037  tflops: 188.29  mfu: 19.04%
[rank3]:2025-11-06 01:58:38,416 - INFO - Avg. fwd time: 14.1532 / Avg. bwd time: 38.8534 / Avg. batch time: 450.0190 (ms) / GPU bubble ratio: 5.77%
[rank0]:2025-11-06 01:58:38,499 - INFO - Avg. fwd time: 15.4129 / Avg. bwd time: 3.7879 / Avg. batch time: 928.2508 (ms) / GPU bubble ratio: 83.45%
[rank0]:2025-11-06 01:58:38,502 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,037  tflops: 188.29  mfu: 19.04%
[rank2]:2025-11-06 01:58:38,500 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,037  tflops: 188.29  mfu: 19.04%
[rank2]:2025-11-06 01:58:57,478 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0158_stage2_step2400.svg
[rank1]:2025-11-06 01:58:57,478 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0158_stage1_step2400.svg
[rank3]:2025-11-06 01:58:57,423 - INFO -  step: 2400  loss:  0.1889  grad_norm:  0.0459  memory: 83.85GiB(59.97%)  tps: 4,028  tflops: 187.87  mfu: 19.00%
[rank0]:2025-11-06 01:58:57,481 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0158_stage0_step2400.svg
[rank3]:2025-11-06 01:58:57,560 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0158_real_step2400_rank3.svg
[rank3]:> Batch Time: 526.00 ms, GPU Bubble Ratio: 76.77%, 46.60%, 53.22%, 20.76%
[rank3]:2025-11-06 01:58:57,603 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0158_stage3_step2400.svg
[rank0]:2025-11-06 02:01:56,665 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:01:58,378 - INFO - Avg. fwd time: 15.4116 / Avg. bwd time: 3.7183 / Avg. batch time: 928.3979 (ms) / GPU bubble ratio: 83.52%
[rank1]:2025-11-06 02:01:58,733 - INFO - Avg. fwd time: 17.2639 / Avg. bwd time: 20.0213 / Avg. batch time: 907.5345 (ms) / GPU bubble ratio: 67.13%
[rank3]:2025-11-06 02:01:58,712 - INFO - Avg. fwd time: 14.1462 / Avg. bwd time: 38.8414 / Avg. batch time: 449.8897 (ms) / GPU bubble ratio: 5.78%
[rank2]:2025-11-06 02:01:58,689 - INFO - Avg. fwd time: 14.9446 / Avg. bwd time: 17.7339 / Avg. batch time: 869.7855 (ms) / GPU bubble ratio: 69.94%
[rank1]:2025-11-06 02:01:58,824 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,089  tflops: 190.73  mfu: 19.29%
[rank0]:2025-11-06 02:01:58,824 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,089  tflops: 190.73  mfu: 19.29%
[rank2]:2025-11-06 02:01:58,822 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,089  tflops: 190.73  mfu: 19.29%
[rank3]:2025-11-06 02:02:17,979 - INFO -  step: 2450  loss:  0.2313  grad_norm:  0.0709  memory: 83.85GiB(59.97%)  tps: 4,085  tflops: 190.51  mfu: 19.26%
[rank0]:2025-11-06 02:05:17,678 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:05:19,389 - INFO - Avg. fwd time: 15.4106 / Avg. bwd time: 3.6402 / Avg. batch time: 929.3077 (ms) / GPU bubble ratio: 83.60%
[rank1]:2025-11-06 02:05:19,738 - INFO - Avg. fwd time: 17.2626 / Avg. bwd time: 19.9776 / Avg. batch time: 908.5429 (ms) / GPU bubble ratio: 67.21%
[rank3]:2025-11-06 02:05:19,719 - INFO - Avg. fwd time: 14.1387 / Avg. bwd time: 38.8282 / Avg. batch time: 449.7507 (ms) / GPU bubble ratio: 5.78%
[rank2]:2025-11-06 02:05:19,695 - INFO - Avg. fwd time: 14.9444 / Avg. bwd time: 17.6950 / Avg. batch time: 870.8439 (ms) / GPU bubble ratio: 70.02%
[rank0]:2025-11-06 02:05:19,829 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,076  tflops: 190.08  mfu: 19.22%
[rank1]:2025-11-06 02:05:19,829 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,076  tflops: 190.08  mfu: 19.22%
[rank2]:2025-11-06 02:05:19,827 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,076  tflops: 190.08  mfu: 19.22%
[rank1]:2025-11-06 02:05:38,455 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0205_stage1_step2500.svg
[rank3]:2025-11-06 02:05:38,398 - INFO -  step: 2500  loss:  0.2137  grad_norm:  0.0550  memory: 83.85GiB(59.97%)  tps: 4,088  tflops: 190.64  mfu: 19.28%
[rank2]:2025-11-06 02:05:38,455 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0205_stage2_step2500.svg
[rank0]:2025-11-06 02:05:38,453 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0205_stage0_step2500.svg
[rank3]:2025-11-06 02:05:38,539 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0205_real_step2500_rank3.svg
[rank3]:> Batch Time: 527.00 ms, GPU Bubble Ratio: 76.68%, 46.58%, 53.24%, 20.83%
[rank3]:2025-11-06 02:05:38,583 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0205_stage3_step2500.svg
[rank0]:2025-11-06 02:08:40,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:08:42,952 - INFO - Avg. fwd time: 14.1373 / Avg. bwd time: 38.8224 / Avg. batch time: 449.7133 (ms) / GPU bubble ratio: 5.79%
[rank1]:2025-11-06 02:08:43,020 - INFO - Avg. fwd time: 17.2660 / Avg. bwd time: 19.9376 / Avg. batch time: 907.8287 (ms) / GPU bubble ratio: 67.22%
[rank2]:2025-11-06 02:08:42,985 - INFO - Avg. fwd time: 14.9476 / Avg. bwd time: 17.6598 / Avg. batch time: 870.1709 (ms) / GPU bubble ratio: 70.02%
[rank2]:2025-11-06 02:08:43,038 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,031  tflops: 188.02  mfu: 19.01%
[rank0]:2025-11-06 02:08:43,037 - INFO - Avg. fwd time: 15.4132 / Avg. bwd time: 3.5653 / Avg. batch time: 928.4987 (ms) / GPU bubble ratio: 83.65%
[rank0]:2025-11-06 02:08:43,040 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,031  tflops: 188.02  mfu: 19.01%
[rank1]:2025-11-06 02:08:43,038 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,031  tflops: 188.02  mfu: 19.01%
[rank3]:2025-11-06 02:09:02,012 - INFO -  step: 2550  loss:  0.4413  grad_norm:  0.1255  memory: 83.85GiB(59.97%)  tps: 4,023  tflops: 187.65  mfu: 18.97%
[rank0]:2025-11-06 02:12:05,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:12:06,886 - INFO - Avg. fwd time: 15.4170 / Avg. bwd time: 3.5036 / Avg. batch time: 930.7506 (ms) / GPU bubble ratio: 83.74%
[rank2]:2025-11-06 02:12:07,200 - INFO - Avg. fwd time: 14.9512 / Avg. bwd time: 17.6310 / Avg. batch time: 872.5351 (ms) / GPU bubble ratio: 70.13%
[rank3]:2025-11-06 02:12:07,223 - INFO - Avg. fwd time: 14.1378 / Avg. bwd time: 38.8190 / Avg. batch time: 449.7083 (ms) / GPU bubble ratio: 5.79%
[rank1]:2025-11-06 02:12:07,243 - INFO - Avg. fwd time: 17.2703 / Avg. bwd time: 19.9049 / Avg. batch time: 910.1591 (ms) / GPU bubble ratio: 67.32%
[rank2]:2025-11-06 02:12:07,332 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,010  tflops: 187.02  mfu: 18.91%
[rank0]:2025-11-06 02:12:07,334 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,010  tflops: 187.02  mfu: 18.91%
[rank1]:2025-11-06 02:12:07,335 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,010  tflops: 187.02  mfu: 18.91%
[rank3]:2025-11-06 02:12:26,250 - INFO -  step: 2600  loss:  0.3901  grad_norm:  0.1054  memory: 83.85GiB(59.97%)  tps: 4,011  tflops: 187.08  mfu: 18.92%
[rank1]:2025-11-06 02:12:26,307 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0212_stage1_step2600.svg
[rank2]:2025-11-06 02:12:26,303 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0212_stage2_step2600.svg
[rank0]:2025-11-06 02:12:26,307 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0212_stage0_step2600.svg
[rank3]:2025-11-06 02:12:26,391 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0212_real_step2600_rank3.svg
[rank3]:> Batch Time: 535.00 ms, GPU Bubble Ratio: 76.63%, 46.74%, 53.39%, 20.64%
[rank3]:2025-11-06 02:12:26,437 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0212_stage3_step2600.svg
[rank0]:2025-11-06 02:15:33,494 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:15:35,238 - INFO - Avg. fwd time: 15.4210 / Avg. bwd time: 3.4342 / Avg. batch time: 930.3904 (ms) / GPU bubble ratio: 83.79%
[rank1]:2025-11-06 02:15:35,594 - INFO - Avg. fwd time: 17.2751 / Avg. bwd time: 19.8682 / Avg. batch time: 909.8876 (ms) / GPU bubble ratio: 67.34%
[rank2]:2025-11-06 02:15:35,551 - INFO - Avg. fwd time: 14.9551 / Avg. bwd time: 17.5989 / Avg. batch time: 872.3022 (ms) / GPU bubble ratio: 70.14%
[rank3]:2025-11-06 02:15:35,574 - INFO - Avg. fwd time: 14.1383 / Avg. bwd time: 38.8154 / Avg. batch time: 449.7027 (ms) / GPU bubble ratio: 5.80%
[rank1]:2025-11-06 02:15:35,684 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,932  tflops: 183.38  mfu: 18.54%
[rank2]:2025-11-06 02:15:35,682 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,932  tflops: 183.38  mfu: 18.54%
[rank0]:2025-11-06 02:15:35,683 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,932  tflops: 183.38  mfu: 18.54%
[rank3]:2025-11-06 02:15:54,467 - INFO -  step: 2650  loss:  0.3178  grad_norm:  0.0971  memory: 83.85GiB(59.97%)  tps: 3,934  tflops: 183.50  mfu: 18.55%
[rank0]:2025-11-06 02:18:58,672 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-06 02:19:00,886 - INFO - Avg. fwd time: 14.9589 / Avg. bwd time: 17.5679 / Avg. batch time: 873.5377 (ms) / GPU bubble ratio: 70.21%
[rank3]:2025-11-06 02:19:00,852 - INFO - Avg. fwd time: 14.1392 / Avg. bwd time: 38.8120 / Avg. batch time: 449.6977 (ms) / GPU bubble ratio: 5.80%
[rank1]:2025-11-06 02:19:00,922 - INFO - Avg. fwd time: 17.2797 / Avg. bwd time: 19.8328 / Avg. batch time: 911.0882 (ms) / GPU bubble ratio: 67.41%
[rank1]:2025-11-06 02:19:00,942 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,991  tflops: 186.14  mfu: 18.82%
[rank2]:2025-11-06 02:19:00,942 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,991  tflops: 186.14  mfu: 18.82%
[rank0]:2025-11-06 02:19:00,941 - INFO - Avg. fwd time: 15.4247 / Avg. bwd time: 3.3675 / Avg. batch time: 931.5076 (ms) / GPU bubble ratio: 83.86%
[rank0]:2025-11-06 02:19:00,944 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,991  tflops: 186.14  mfu: 18.82%
[rank2]:2025-11-06 02:19:19,606 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0219_stage2_step2700.svg
[rank0]:2025-11-06 02:19:19,605 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0219_stage0_step2700.svg
[rank3]:2025-11-06 02:19:19,550 - INFO -  step: 2700  loss:  0.3452  grad_norm:  0.0801  memory: 83.85GiB(59.97%)  tps: 3,995  tflops: 186.31  mfu: 18.84%
[rank1]:2025-11-06 02:19:19,604 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0219_stage1_step2700.svg
[rank3]:2025-11-06 02:19:19,685 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0219_real_step2700_rank3.svg
[rank3]:> Batch Time: 533.50 ms, GPU Bubble Ratio: 76.58%, 46.64%, 53.26%, 20.62%
[rank3]:2025-11-06 02:19:19,728 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0219_stage3_step2700.svg
[rank0]:2025-11-06 02:22:21,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:22:23,560 - INFO - Avg. fwd time: 15.4278 / Avg. bwd time: 3.3123 / Avg. batch time: 931.7862 (ms) / GPU bubble ratio: 83.91%
[rank2]:2025-11-06 02:22:23,874 - INFO - Avg. fwd time: 14.9620 / Avg. bwd time: 17.5425 / Avg. batch time: 873.9170 (ms) / GPU bubble ratio: 70.24%
[rank1]:2025-11-06 02:22:23,915 - INFO - Avg. fwd time: 17.2835 / Avg. bwd time: 19.8036 / Avg. batch time: 911.4370 (ms) / GPU bubble ratio: 67.45%
[rank3]:2025-11-06 02:22:23,898 - INFO - Avg. fwd time: 14.1395 / Avg. bwd time: 38.8086 / Avg. batch time: 449.6885 (ms) / GPU bubble ratio: 5.80%
[rank1]:2025-11-06 02:22:24,005 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,034  tflops: 188.16  mfu: 19.02%
[rank0]:2025-11-06 02:22:24,005 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,034  tflops: 188.16  mfu: 19.03%
[rank2]:2025-11-06 02:22:24,003 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,034  tflops: 188.16  mfu: 19.03%
[rank3]:2025-11-06 02:22:42,549 - INFO -  step: 2750  loss:  0.2897  grad_norm:  0.0703  memory: 83.85GiB(59.97%)  tps: 4,036  tflops: 188.22  mfu: 19.03%
[rank0]:2025-11-06 02:25:45,525 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:25:47,269 - INFO - Avg. fwd time: 15.4312 / Avg. bwd time: 3.2502 / Avg. batch time: 932.7043 (ms) / GPU bubble ratio: 83.98%
[rank3]:2025-11-06 02:25:47,604 - INFO - Avg. fwd time: 14.1403 / Avg. bwd time: 38.8057 / Avg. batch time: 449.6889 (ms) / GPU bubble ratio: 5.81%
[rank1]:2025-11-06 02:25:47,624 - INFO - Avg. fwd time: 17.2879 / Avg. bwd time: 19.7707 / Avg. batch time: 912.4343 (ms) / GPU bubble ratio: 67.51%
[rank2]:2025-11-06 02:25:47,584 - INFO - Avg. fwd time: 14.9655 / Avg. bwd time: 17.5138 / Avg. batch time: 874.9487 (ms) / GPU bubble ratio: 70.30%
[rank0]:2025-11-06 02:25:47,715 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,021  tflops: 187.56  mfu: 18.96%
[rank1]:2025-11-06 02:25:47,716 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,021  tflops: 187.56  mfu: 18.96%
[rank2]:2025-11-06 02:25:47,714 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,021  tflops: 187.56  mfu: 18.96%
[rank3]:2025-11-06 02:26:06,806 - INFO -  step: 2800  loss:  0.2886  grad_norm:  0.0681  memory: 83.85GiB(59.97%)  tps: 4,011  tflops: 187.06  mfu: 18.91%
[rank1]:2025-11-06 02:26:06,863 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0225_stage1_step2800.svg
[rank2]:2025-11-06 02:26:06,864 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0225_stage2_step2800.svg
[rank0]:2025-11-06 02:26:06,864 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0225_stage0_step2800.svg
[rank3]:2025-11-06 02:26:06,946 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0226_real_step2800_rank3.svg
[rank3]:> Batch Time: 533.50 ms, GPU Bubble Ratio: 76.74%, 46.72%, 53.32%, 20.80%
[rank3]:2025-11-06 02:26:06,990 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0226_stage3_step2800.svg
[rank0]:2025-11-06 02:29:10,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:29:12,594 - INFO - Avg. fwd time: 14.1412 / Avg. bwd time: 38.8036 / Avg. batch time: 449.6960 (ms) / GPU bubble ratio: 5.81%
[rank2]:2025-11-06 02:29:12,630 - INFO - Avg. fwd time: 14.9692 / Avg. bwd time: 17.4862 / Avg. batch time: 874.3698 (ms) / GPU bubble ratio: 70.31%
[rank0]:2025-11-06 02:29:12,682 - INFO - Avg. fwd time: 15.4349 / Avg. bwd time: 3.1904 / Avg. batch time: 932.0192 (ms) / GPU bubble ratio: 84.01%
[rank0]:2025-11-06 02:29:12,685 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,997  tflops: 186.41  mfu: 18.85%
[rank2]:2025-11-06 02:29:12,684 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,997  tflops: 186.41  mfu: 18.85%
[rank1]:2025-11-06 02:29:12,664 - INFO - Avg. fwd time: 17.2925 / Avg. bwd time: 19.7391 / Avg. batch time: 911.8239 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-11-06 02:29:12,684 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,997  tflops: 186.41  mfu: 18.85%
[rank3]:2025-11-06 02:29:32,792 - INFO -  step: 2850  loss:  0.3967  grad_norm:  0.0859  memory: 83.85GiB(59.97%)  tps: 3,977  tflops: 185.49  mfu: 18.76%
[rank0]:2025-11-06 02:32:35,967 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:32:37,720 - INFO - Avg. fwd time: 15.4377 / Avg. bwd time: 3.1409 / Avg. batch time: 934.0854 (ms) / GPU bubble ratio: 84.09%
[rank3]:2025-11-06 02:32:38,055 - INFO - Avg. fwd time: 14.1415 / Avg. bwd time: 38.8010 / Avg. batch time: 449.6900 (ms) / GPU bubble ratio: 5.82%
[rank2]:2025-11-06 02:32:38,034 - INFO - Avg. fwd time: 14.9719 / Avg. bwd time: 17.4631 / Avg. batch time: 876.5263 (ms) / GPU bubble ratio: 70.40%
[rank1]:2025-11-06 02:32:38,074 - INFO - Avg. fwd time: 17.2958 / Avg. bwd time: 19.7128 / Avg. batch time: 913.9531 (ms) / GPU bubble ratio: 67.61%
[rank0]:2025-11-06 02:32:38,166 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,987  tflops: 185.94  mfu: 18.80%
[rank2]:2025-11-06 02:32:38,164 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,987  tflops: 185.94  mfu: 18.80%
[rank1]:2025-11-06 02:32:38,166 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,987  tflops: 185.94  mfu: 18.80%
[rank0]:2025-11-06 02:32:57,484 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0232_stage0_step2900.svg
[rank3]:2025-11-06 02:32:57,425 - INFO -  step: 2900  loss:  0.3816  grad_norm:  0.0984  memory: 83.85GiB(59.97%)  tps: 4,003  tflops: 186.71  mfu: 18.88%
[rank2]:2025-11-06 02:32:57,484 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0232_stage2_step2900.svg
[rank1]:2025-11-06 02:32:57,483 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0232_stage1_step2900.svg
[rank3]:2025-11-06 02:32:57,562 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0232_real_step2900_rank3.svg
[rank3]:> Batch Time: 532.50 ms, GPU Bubble Ratio: 76.61%, 46.57%, 53.22%, 20.61%
[rank3]:2025-11-06 02:32:57,606 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0232_stage3_step2900.svg
[rank0]:2025-11-06 02:36:00,116 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-06 02:36:01,868 - INFO - Avg. fwd time: 15.4413 / Avg. bwd time: 3.0850 / Avg. batch time: 933.3120 (ms) / GPU bubble ratio: 84.12%
[rank2]:2025-11-06 02:36:02,188 - INFO - Avg. fwd time: 14.9754 / Avg. bwd time: 17.4374 / Avg. batch time: 875.8559 (ms) / GPU bubble ratio: 70.39%
[rank3]:2025-11-06 02:36:02,209 - INFO - Avg. fwd time: 14.1425 / Avg. bwd time: 38.7981 / Avg. batch time: 449.6893 (ms) / GPU bubble ratio: 5.82%
[rank1]:2025-11-06 02:36:02,228 - INFO - Avg. fwd time: 17.2999 / Avg. bwd time: 19.6833 / Avg. batch time: 913.2513 (ms) / GPU bubble ratio: 67.60%
[rank0]:2025-11-06 02:36:02,321 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 4,013  tflops: 187.15  mfu: 18.92%
[rank2]:2025-11-06 02:36:02,319 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 4,013  tflops: 187.15  mfu: 18.92%
[rank1]:2025-11-06 02:36:02,321 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 4,013  tflops: 187.15  mfu: 18.92%
[rank3]:2025-11-06 02:36:21,657 - INFO -  step: 2950  loss:  0.4276  grad_norm:  0.0880  memory: 83.85GiB(59.97%)  tps: 4,011  tflops: 187.08  mfu: 18.92%
[rank0]:2025-11-06 02:39:26,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-06 02:39:28,383 - INFO - Avg. fwd time: 14.1431 / Avg. bwd time: 38.7953 / Avg. batch time: 449.6858 (ms) / GPU bubble ratio: 5.82%
[rank2]:2025-11-06 02:39:28,420 - INFO - Avg. fwd time: 14.9786 / Avg. bwd time: 17.4126 / Avg. batch time: 876.9796 (ms) / GPU bubble ratio: 70.45%
[rank2]:2025-11-06 02:39:28,475 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 66.52GiB(47.58%)  tps: 3,974  tflops: 185.33  mfu: 18.74%
[rank2]:2025-11-06 02:39:28,475 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 4,142  tflops: 193.20  mfu: 19.19%
[rank2]:2025-11-06 02:39:28,475 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-06 02:39:28,478 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-06 02:39:28,455 - INFO - Avg. fwd time: 17.3037 / Avg. bwd time: 19.6549 / Avg. batch time: 914.3472 (ms) / GPU bubble ratio: 67.66%
[rank1]:2025-11-06 02:39:28,475 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 73.36GiB(52.47%)  tps: 3,974  tflops: 185.34  mfu: 18.74%
[rank1]:2025-11-06 02:39:28,475 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 4,142  tflops: 193.20  mfu: 19.19%
[rank1]:2025-11-06 02:39:28,475 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-06 02:39:28,478 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-06 02:39:28,474 - INFO - Avg. fwd time: 15.4443 / Avg. bwd time: 3.0311 / Avg. batch time: 934.3406 (ms) / GPU bubble ratio: 84.18%
[rank0]:2025-11-06 02:39:28,477 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 75.62GiB(54.09%)  tps: 3,974  tflops: 185.33  mfu: 18.74%
[rank0]:2025-11-06 02:39:28,477 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 4,142  tflops: 193.21  mfu: 19.19%
[rank0]:2025-11-06 02:39:28,477 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-06 02:39:28,485 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-06 02:39:47,812 - INFO -  step: 3000  loss:  0.3494  grad_norm:  0.0856  memory: 83.85GiB(59.97%)  tps: 3,974  tflops: 185.34  mfu: 18.74%
[rank3]:2025-11-06 02:39:47,813 - INFO -  final step: 3000  loss:  0.3494  grad_norm:  0.0856  tps: 4,136  tflops: 192.93  mfu: 19.17%
[rank3]:2025-11-06 02:39:47,813 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-06 02:39:47,816 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-06 02:39:58,100 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-06 02:39:58,204 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251106_0239_stage2_final3000.svg
[rank1]:2025-11-06 02:39:58,217 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251106_0239_stage1_final3000.svg
[rank0]:2025-11-06 02:39:58,216 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251106_0239_stage0_final3000.svg
[rank2]:2025-11-06 02:39:58,391 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/frozen_params_histogram/251106_0239_rank2_stage2.svg
[rank2]:	> Counts Sum: 3032760, Total Sum: 6520320 (46.51%), Ratio(%) per element: [46.33, 46.55, 46.59, 46.59, 46.81, 46.64, 47.21, 47.04, 47.61, 46.46, 45.71, 47.26, 46.81, 46.55, 46.15, 46.28, 47.26, 46.33, 45.98, 46.68, 45.75, 45.36, 46.2, 46.02, 46.11, 47.79, 46.15, 45.62, 46.51, 46.15, 46.33, 47.61, 46.33, 46.06, 46.59, 47.48, 46.02, 46.42, 46.59, 46.73, 46.42, 46.42, 46.02, 46.15, 45.98, 46.02, 47.96, 46.02, 46.77, 46.15, 47.04, 45.93, 46.86, 46.9, 46.77, 46.51, 46.46, 45.89, 46.86, 45.67, 46.55, 47.74, 46.9, 46.11, 46.42, 46.99, 45.71, 45.98, 47.12, 46.81, 46.37, 46.37]
[rank2]:2025-11-06 02:39:58,391 - INFO - Destroying the purge thread.
[rank1]:2025-11-06 02:39:58,418 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/frozen_params_histogram/251106_0239_rank1_stage1.svg
[rank1]:	> Counts Sum: 2368200, Total Sum: 7335360 (32.28%), Ratio(%) per element: [32.99, 31.71, 32.46, 31.58, 30.83, 32.46, 32.5, 32.68, 32.33, 32.68, 32.33, 31.44, 32.68, 31.4, 32.46, 32.59, 32.55, 32.9, 32.24, 32.99, 31.75, 32.19, 31.93, 32.64, 32.02, 32.99, 32.46, 32.77, 32.37, 31.53, 31.97, 32.9, 32.11, 32.9, 32.72, 32.37, 31.93, 32.02, 30.91, 32.28, 32.42, 31.89, 32.68, 32.33, 33.25, 31.36, 32.77, 33.03, 32.59, 31.31, 32.64, 31.8, 32.42, 32.77, 32.19, 31.93, 32.5, 32.37, 32.11, 32.02, 32.06, 32.28, 33.43, 32.72, 32.55, 31.84, 31.58, 31.71, 32.15, 31.4, 33.61, 31.49, 31.53, 32.72, 32.68, 31.75, 32.28, 32.99, 31.4, 32.77, 32.77]
[rank1]:2025-11-06 02:39:58,418 - INFO - Destroying the purge thread.
[rank3]:2025-11-06 02:39:58,384 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0239_real_final3000_rank3.svg
[rank3]:> Batch Time: 533.50 ms, GPU Bubble Ratio: 76.72%, 46.76%, 53.35%, 20.78%
[rank0]:2025-11-06 02:39:58,524 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/frozen_params_histogram/251106_0239_rank0_stage0.svg
[rank0]:	> Counts Sum: 4044680, Total Sum: 6610880 (61.18%), Ratio(%) per element: [60.77, 61.43, 60.9, 61.7, 61.3, 61.35, 60.82, 60.99, 61.21, 61.83, 61.3, 60.95, 60.9, 60.99, 60.68, 61.39, 61.08, 61.7, 61.21, 61.08, 61.08, 61.08, 61.35, 60.29, 61.21, 61.04, 60.73, 61.79, 61.52, 61.13, 60.95, 61.21, 61.35, 60.9, 61.39, 62.05, 61.61, 61.04, 60.9, 61.39, 61.04, 60.33, 61.17, 60.86, 61.21, 61.39, 61.39, 61.3, 61.13, 60.9, 61.39, 61.13, 61.04, 61.13, 61.52, 61.13, 60.95, 60.46, 60.99, 61.17, 61.35, 60.99, 61.3, 61.61, 61.35, 61.26, 61.17, 61.21, 61.52, 61.13, 60.68, 61.92, 61.17]
[rank0]:2025-11-06 02:39:58,525 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-06 02:39:58,622 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/pipeline_schedule/251106_0239_thry_final3000_rank3.svg
[rank3]:> Batch Time: 512.90 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-06 02:39:58,701 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251106_0239_stage3_final3000.svg
[rank3]:2025-11-06 02:39:58,994 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200/frozen_params_histogram/251106_0239_rank3_stage3.svg
[rank3]:	> Counts Sum: 1824080, Total Sum: 5886400 (30.99%), Ratio(%) per element: [28.44, 28.22, 28.22, 28.57, 28.57, 29.32, 29.06, 39.31, 39.48, 28.09, 29.15, 28.66, 28.48, 28.48, 28.31, 28.79, 39.13, 39.17, 28.18, 28.53, 28.31, 28.84, 28.4, 28.0, 28.53, 39.22, 39.35, 28.35, 28.44, 28.71, 28.48, 28.22, 29.15, 28.4, 39.26, 39.26, 28.44, 28.09, 28.57, 28.13, 28.22, 28.48, 28.75, 39.26, 39.48, 28.79, 28.26, 28.66, 28.13, 28.62, 28.62, 28.18, 39.31, 39.31, 28.93, 29.15, 28.66, 28.53, 28.04, 28.57, 28.13, 39.17, 39.09, 39.17, 28.09]
[rank3]:2025-11-06 02:39:58,995 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 3.96084
[rank3]:wandb:               final/avg_loss 0.34938
[rank3]:wandb:             final/avg_mfu(%) 19.17223
[rank3]:wandb:             final/avg_tflops 192.92678
[rank3]:wandb:    final/avg_throughput(tps) 4136.49467
[rank3]:wandb:              final/grad_norm 0.08562
[rank3]:wandb:               final/max_loss 0.34938
[rank3]:wandb:                    grad_norm 0.08562
[rank3]:wandb: loss_metrics/global_avg_loss 0.34938
[rank3]:wandb: loss_metrics/global_max_loss 0.34938
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1104_GPipe_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/w9b29whl
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1104_GPipe_timelyapf_h200/20251105-2318/wandb/run-20251105_231825-w9b29whl/logs
[rank0]:2025-11-06 02:40:00,525 - INFO - Training completed
[rank0]:2025-11-06 02:40:00,526 - INFO - Destroying the purge thread.
[rank2]:2025-11-06 02:40:00,776 - INFO - Process group destroyed
[rank1]:2025-11-06 02:40:00,760 - INFO - Process group destroyed
[rank3]:2025-11-06 02:40:00,748 - INFO - Process group destroyed
[rank0]:2025-11-06 02:40:01,000 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.16', 'layers.8', 'layers.11', 'layers.12', 'layers.13', 'layers.15', 'layers.10', 'layers.14'}
[rank2]:Stage 2: Modules to keep: {'layers.17', 'layers.19', 'layers.20', 'layers.22', 'layers.23', 'layers.24', 'layers.21', 'layers.18'}
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.3', 'layers.6', 'tok_embeddings', 'layers.1', 'layers.5', 'layers.7', 'layers.4', 'layers.0'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.25', 'layers.28', 'layers.31', 'layers.27', 'output', 'layers.26', 'norm', 'layers.30'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1104_llama8b/config_1104.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1104_GPipe_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1104_GPipe_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1104_GPipe_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1104_GPipe_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1104_GPipe_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1104_GPipe_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1104_GPipe_timelyapf_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1104_GPipe_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
