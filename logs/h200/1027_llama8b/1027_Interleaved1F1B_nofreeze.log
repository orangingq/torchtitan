
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Mon Oct 27 03:56:07 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/run3.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/1027_Interleaved1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1027 03:56:09.140000 2950525 site-packages/torch/distributed/run.py:811] 
W1027 03:56:09.140000 2950525 site-packages/torch/distributed/run.py:811] *****************************************
W1027 03:56:09.140000 2950525 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1027 03:56:09.140000 2950525 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-27 03:56:19,389 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 03:56:19,523 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 03:56:19,468 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 03:56:19,635 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 03:56:20,314 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 03:56:20,316 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-27 03:56:20,438 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 03:56:20,441 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 03:56:20,467 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 03:56:20,470 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 03:56:20,475 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-27 03:56:20,482 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 03:56:20,484 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 03:56:22,282 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 03:56:22,568 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 03:56:24,464 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-27 03:56:24,722 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-27 03:56:24,663 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-27 03:56:24,736 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank0]:2025-10-27 03:56:24,771 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-27 03:56:24,795 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2025-10-27 03:56:24,816 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20']
[rank0]:2025-10-27 03:56:24,818 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-27 03:56:24,756 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28']
[rank2]:2025-10-27 03:56:24,757 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-10-27 03:56:24,910 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-27 03:56:25,041 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-27 03:56:25,041 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-27 03:56:25,008 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-10-27 03:56:25,030 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank1]:2025-10-27 03:56:25,031 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank2]:2025-10-27 03:56:24,976 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-27 03:56:24,977 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-27 03:56:25,248 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-27 03:56:25,248 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ec6ak88x
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_Interleaved1F1B_nofreeze_dm1/20251027-0356/wandb/run-20251027_035626-ec6ak88x
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_Interleaved1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ec6ak88x
[rank3]:2025-10-27 03:56:27,077 - INFO - WandB logging enabled
[rank3]:2025-10-27 03:56:27,078 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-27 03:56:27,153 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank3]:2025-10-27 03:56:27,174 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-27 03:56:27,176 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-10-27 03:56:27,433 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_Interleaved1F1B_nofreeze_dm1
[rank0]:2025-10-27 03:56:27,436 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 03:56:27,436 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 03:56:27,436 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-27 03:56:27,412 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-27 03:56:27,413 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-27 03:56:30,410 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 03:56:30,410 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-27 03:56:41,452 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 03:56:41,452 - INFO - Finished loading the checkpoint in 11.04 seconds.
[rank0]:2025-10-27 03:56:41,452 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:2025-10-27 03:57:06,833 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 50.58GiB(36.18%)  tps: 390  tflops: 18.17  mfu: 1.84%
[rank0]:2025-10-27 03:57:06,833 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 03:57:06,813 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 46.70GiB(33.40%)  tps: 392  tflops: 18.27  mfu: 1.85%
[rank1]:2025-10-27 03:57:06,813 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 03:57:06,811 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 34.15GiB(24.43%)  tps: 389  tflops: 18.15  mfu: 1.84%
[rank2]:2025-10-27 03:57:06,811 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 03:57:06,816 - INFO -  step:  1  loss:  4.0063  grad_norm: 613.1230  memory: 46.00GiB(32.90%)  tps: 413  tflops: 19.25  mfu: 1.95%
[rank3]:2025-10-27 03:57:06,817 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 03:57:46,870 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,871 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,871 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,871 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,872 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,872 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,872 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,872 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,872 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 03:57:46,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 03:57:47,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,348 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,349 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 03:57:47,350 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,502 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,502 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,503 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,504 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 03:57:47,505 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 04:04:28,612 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 04:04:28,606 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:04:28,610 - INFO -  step: 20  loss:  0.1266  grad_norm:  0.3757  memory: 61.40GiB(43.91%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 04:04:28,608 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:04:33,783 - INFO - Avg. fwd time: 86.6414 / Avg. bwd time: 177.0728 / Avg. batch time: 4926.3574 (ms) / GPU bubble ratio: 14.35%
[rank2]:2025-10-27 04:04:34,001 - INFO - Avg. fwd time: 83.0591 / Avg. bwd time: 146.2184 / Avg. batch time: 5218.5673 (ms) / GPU bubble ratio: 29.70%
[rank1]:2025-10-27 04:04:34,261 - INFO - Avg. fwd time: 86.3184 / Avg. bwd time: 164.4880 / Avg. batch time: 5569.7157 (ms) / GPU bubble ratio: 27.95%
[rank0]:2025-10-27 04:04:34,415 - INFO - Avg. fwd time: 86.3905 / Avg. bwd time: 154.3988 / Avg. batch time: 5794.3510 (ms) / GPU bubble ratio: 33.51%
[rank0]:2025-10-27 04:12:13,600 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2745  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 04:12:13,596 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2745  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 04:12:13,597 - INFO -  step: 40  loss:  0.1271  grad_norm:  0.2745  memory: 61.40GiB(43.91%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 04:12:13,593 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2745  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 04:12:18,771 - INFO - Avg. fwd time: 87.1790 / Avg. bwd time: 178.1653 / Avg. batch time: 4926.2078 (ms) / GPU bubble ratio: 13.82%
[rank2]:2025-10-27 04:12:18,991 - INFO - Avg. fwd time: 83.5819 / Avg. bwd time: 147.1277 / Avg. batch time: 5218.4224 (ms) / GPU bubble ratio: 29.26%
[rank1]:2025-10-27 04:12:19,249 - INFO - Avg. fwd time: 86.8554 / Avg. bwd time: 165.5058 / Avg. batch time: 5569.5506 (ms) / GPU bubble ratio: 27.50%
[rank0]:2025-10-27 04:12:19,403 - INFO - Avg. fwd time: 86.9267 / Avg. bwd time: 155.3597 / Avg. batch time: 5794.1700 (ms) / GPU bubble ratio: 33.10%
[rank0]:2025-10-27 04:15:42,861 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 04:19:58,638 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1322  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:19:58,640 - INFO -  step: 60  loss:  0.1360  grad_norm:  0.1322  memory: 61.40GiB(43.91%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 04:19:58,636 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1322  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 04:19:58,642 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1322  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:20:03,815 - INFO - Avg. fwd time: 87.3607 / Avg. bwd time: 178.5330 / Avg. batch time: 4926.1922 (ms) / GPU bubble ratio: 13.64%
[rank2]:2025-10-27 04:20:04,033 - INFO - Avg. fwd time: 83.7554 / Avg. bwd time: 147.4332 / Avg. batch time: 5218.4070 (ms) / GPU bubble ratio: 29.12%
[rank1]:2025-10-27 04:20:04,292 - INFO - Avg. fwd time: 87.0365 / Avg. bwd time: 165.8515 / Avg. batch time: 5569.5401 (ms) / GPU bubble ratio: 27.35%
[rank0]:2025-10-27 04:20:04,446 - INFO - Avg. fwd time: 87.1086 / Avg. bwd time: 155.6811 / Avg. batch time: 5794.1533 (ms) / GPU bubble ratio: 32.96%
[rank1]:2025-10-27 04:27:43,669 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2039  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 04:27:43,667 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2039  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 04:27:43,673 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2039  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:27:43,671 - INFO -  step: 80  loss:  0.1202  grad_norm:  0.2039  memory: 61.40GiB(43.91%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:27:48,845 - INFO - Avg. fwd time: 87.4508 / Avg. bwd time: 178.7185 / Avg. batch time: 4926.1841 (ms) / GPU bubble ratio: 13.55%
[rank2]:2025-10-27 04:27:49,064 - INFO - Avg. fwd time: 83.8422 / Avg. bwd time: 147.5864 / Avg. batch time: 5218.3971 (ms) / GPU bubble ratio: 29.04%
[rank1]:2025-10-27 04:27:49,323 - INFO - Avg. fwd time: 87.1271 / Avg. bwd time: 166.0246 / Avg. batch time: 5569.5315 (ms) / GPU bubble ratio: 27.28%
[rank0]:2025-10-27 04:27:49,477 - INFO - Avg. fwd time: 87.2011 / Avg. bwd time: 155.8437 / Avg. batch time: 5794.1467 (ms) / GPU bubble ratio: 32.89%
[rank0]:2025-10-27 04:35:05,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 04:35:28,668 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1220  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 04:35:28,668 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 04:35:28,672 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1220  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 04:35:28,672 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 04:35:28,665 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1220  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 04:35:28,666 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 04:35:28,670 - INFO -  step: 100  loss:  0.1147  grad_norm:  0.1220  memory: 61.40GiB(43.91%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 04:35:28,670 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 04:39:03,948 - INFO - validate step: 100  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,903
[rank1]:2025-10-27 04:39:04,023 - INFO - validate step: 100  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,902
[rank2]:2025-10-27 04:39:04,115 - INFO - validate step: 100  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,901
[rank3]:2025-10-27 04:39:04,281 - INFO - validate step: 100  loss:  0.2368  memory: 61.40GiB(43.91%)  tps: 1,900
[rank3]:2025-10-27 04:39:04,602 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0439_real_step100_rank3.svg
[rank3]:> Batch Time: 5121.56 ms, GPU Bubble Ratio: 23.81%, 20.66%, 27.44%, 16.57%
[rank3]:2025-10-27 04:39:09,534 - INFO - Avg. fwd time: 87.5056 / Avg. bwd time: 178.8262 / Avg. batch time: 4926.1137 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-10-27 04:39:09,753 - INFO - Avg. fwd time: 83.8930 / Avg. bwd time: 147.6786 / Avg. batch time: 5218.5173 (ms) / GPU bubble ratio: 29.00%
[rank1]:2025-10-27 04:39:10,012 - INFO - Avg. fwd time: 87.1806 / Avg. bwd time: 166.1241 / Avg. batch time: 5569.6486 (ms) / GPU bubble ratio: 27.23%
[rank0]:2025-10-27 04:39:10,166 - INFO - Avg. fwd time: 87.2550 / Avg. bwd time: 155.9401 / Avg. batch time: 5794.2634 (ms) / GPU bubble ratio: 32.85%
[rank1]:2025-10-27 04:46:49,405 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1295  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank0]:2025-10-27 04:46:49,409 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1295  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.83  mfu: 3.32%
[rank2]:2025-10-27 04:46:49,403 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1295  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 04:46:49,407 - INFO -  step: 120  loss:  0.1207  grad_norm:  0.1295  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 04:46:54,578 - INFO - Avg. fwd time: 87.5412 / Avg. bwd time: 178.8997 / Avg. batch time: 4926.0983 (ms) / GPU bubble ratio: 13.46%
[rank2]:2025-10-27 04:46:54,797 - INFO - Avg. fwd time: 83.9287 / Avg. bwd time: 147.7401 / Avg. batch time: 5218.4704 (ms) / GPU bubble ratio: 28.97%
[rank1]:2025-10-27 04:46:55,057 - INFO - Avg. fwd time: 87.2169 / Avg. bwd time: 166.1891 / Avg. batch time: 5569.6042 (ms) / GPU bubble ratio: 27.20%
[rank0]:2025-10-27 04:46:55,211 - INFO - Avg. fwd time: 87.2910 / Avg. bwd time: 156.0059 / Avg. batch time: 5794.2321 (ms) / GPU bubble ratio: 32.82%
[rank2]:2025-10-27 04:54:34,407 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1004  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 04:54:34,414 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1004  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 04:54:34,410 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1004  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 04:54:34,412 - INFO -  step: 140  loss:  0.1241  grad_norm:  0.1004  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 04:54:39,585 - INFO - Avg. fwd time: 87.5671 / Avg. bwd time: 178.9517 / Avg. batch time: 4926.0868 (ms) / GPU bubble ratio: 13.43%
[rank2]:2025-10-27 04:54:39,803 - INFO - Avg. fwd time: 83.9550 / Avg. bwd time: 147.7842 / Avg. batch time: 5218.4408 (ms) / GPU bubble ratio: 28.95%
[rank1]:2025-10-27 04:54:40,063 - INFO - Avg. fwd time: 87.2424 / Avg. bwd time: 166.2375 / Avg. batch time: 5569.5772 (ms) / GPU bubble ratio: 27.18%
[rank0]:2025-10-27 04:54:40,217 - INFO - Avg. fwd time: 87.3168 / Avg. bwd time: 156.0510 / Avg. batch time: 5794.2022 (ms) / GPU bubble ratio: 32.80%
[rank0]:2025-10-27 04:58:03,655 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 05:02:19,416 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1218  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 05:02:19,420 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1218  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:02:19,413 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1218  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:02:19,418 - INFO -  step: 160  loss:  0.1065  grad_norm:  0.1218  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:02:24,592 - INFO - Avg. fwd time: 87.5875 / Avg. bwd time: 178.9921 / Avg. batch time: 4926.1071 (ms) / GPU bubble ratio: 13.41%
[rank2]:2025-10-27 05:02:24,812 - INFO - Avg. fwd time: 83.9743 / Avg. bwd time: 147.8176 / Avg. batch time: 5218.4454 (ms) / GPU bubble ratio: 28.93%
[rank1]:2025-10-27 05:02:25,071 - INFO - Avg. fwd time: 87.2620 / Avg. bwd time: 166.2768 / Avg. batch time: 5569.5804 (ms) / GPU bubble ratio: 27.16%
[rank0]:2025-10-27 05:02:25,225 - INFO - Avg. fwd time: 87.3360 / Avg. bwd time: 156.0838 / Avg. batch time: 5794.1982 (ms) / GPU bubble ratio: 32.78%
[rank0]:2025-10-27 05:10:04,438 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1891  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:10:04,431 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1891  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:10:04,436 - INFO -  step: 180  loss:  0.1289  grad_norm:  0.1891  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 05:10:04,434 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1891  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:10:09,611 - INFO - Avg. fwd time: 87.6025 / Avg. bwd time: 179.0227 / Avg. batch time: 4926.0972 (ms) / GPU bubble ratio: 13.40%
[rank2]:2025-10-27 05:10:09,830 - INFO - Avg. fwd time: 83.9885 / Avg. bwd time: 147.8430 / Avg. batch time: 5218.4179 (ms) / GPU bubble ratio: 28.92%
[rank1]:2025-10-27 05:10:10,089 - INFO - Avg. fwd time: 87.2772 / Avg. bwd time: 166.3053 / Avg. batch time: 5569.5596 (ms) / GPU bubble ratio: 27.15%
[rank0]:2025-10-27 05:10:10,244 - INFO - Avg. fwd time: 87.3511 / Avg. bwd time: 156.1115 / Avg. batch time: 5794.1761 (ms) / GPU bubble ratio: 32.77%
[rank0]:2025-10-27 05:17:26,189 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 05:17:49,459 - INFO -  step: 200  loss:  0.1296  grad_norm:  0.1141  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:17:49,459 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 05:17:49,461 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1141  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 05:17:49,461 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-27 05:17:49,454 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1141  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:17:49,455 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 05:17:49,457 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1141  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 05:17:49,457 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 05:21:23,079 - INFO - validate step: 200  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,917
[rank1]:2025-10-27 05:21:23,157 - INFO - validate step: 200  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 05:21:23,250 - INFO - validate step: 200  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 05:21:23,413 - INFO - validate step: 200  loss:  0.2496  memory: 61.42GiB(43.93%)  tps: 1,914
[rank3]:2025-10-27 05:21:23,721 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0521_real_step200_rank3.svg
[rank3]:> Batch Time: 5121.56 ms, GPU Bubble Ratio: 23.81%, 20.66%, 27.44%, 16.57%
[rank3]:2025-10-27 05:21:28,653 - INFO - Avg. fwd time: 87.6146 / Avg. bwd time: 179.0477 / Avg. batch time: 4926.0967 (ms) / GPU bubble ratio: 13.39%
[rank2]:2025-10-27 05:21:28,872 - INFO - Avg. fwd time: 83.9995 / Avg. bwd time: 147.8633 / Avg. batch time: 5218.4815 (ms) / GPU bubble ratio: 28.91%
[rank1]:2025-10-27 05:21:29,133 - INFO - Avg. fwd time: 87.2894 / Avg. bwd time: 166.3274 / Avg. batch time: 5569.6287 (ms) / GPU bubble ratio: 27.14%
[rank0]:2025-10-27 05:21:29,288 - INFO - Avg. fwd time: 87.3634 / Avg. bwd time: 156.1338 / Avg. batch time: 5794.2495 (ms) / GPU bubble ratio: 32.76%
[rank1]:2025-10-27 05:29:08,481 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1557  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 05:29:08,488 - INFO -  step: 220  loss:  0.1466  grad_norm:  0.1557  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 05:29:08,479 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1557  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank0]:2025-10-27 05:29:08,485 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.1557  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 05:29:13,657 - INFO - Avg. fwd time: 87.6245 / Avg. bwd time: 179.0672 / Avg. batch time: 4926.0889 (ms) / GPU bubble ratio: 13.38%
[rank2]:2025-10-27 05:29:13,875 - INFO - Avg. fwd time: 84.0094 / Avg. bwd time: 147.8800 / Avg. batch time: 5218.4563 (ms) / GPU bubble ratio: 28.90%
[rank1]:2025-10-27 05:29:14,134 - INFO - Avg. fwd time: 87.2990 / Avg. bwd time: 166.3452 / Avg. batch time: 5569.6070 (ms) / GPU bubble ratio: 27.13%
[rank0]:2025-10-27 05:29:14,289 - INFO - Avg. fwd time: 87.3736 / Avg. bwd time: 156.1518 / Avg. batch time: 5794.2275 (ms) / GPU bubble ratio: 32.75%
[rank3]:2025-10-27 05:36:53,494 - INFO -  step: 240  loss:  0.1566  grad_norm:  0.1342  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 05:36:53,496 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1342  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:36:53,489 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1342  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 05:36:53,492 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1342  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:36:58,669 - INFO - Avg. fwd time: 87.6326 / Avg. bwd time: 179.0840 / Avg. batch time: 4926.0860 (ms) / GPU bubble ratio: 13.37%
[rank2]:2025-10-27 05:36:58,887 - INFO - Avg. fwd time: 84.0177 / Avg. bwd time: 147.8943 / Avg. batch time: 5218.4428 (ms) / GPU bubble ratio: 28.89%
[rank1]:2025-10-27 05:36:59,146 - INFO - Avg. fwd time: 87.3073 / Avg. bwd time: 166.3602 / Avg. batch time: 5569.5926 (ms) / GPU bubble ratio: 27.13%
[rank0]:2025-10-27 05:36:59,301 - INFO - Avg. fwd time: 87.3818 / Avg. bwd time: 156.1668 / Avg. batch time: 5794.2116 (ms) / GPU bubble ratio: 32.75%
[rank0]:2025-10-27 05:40:22,730 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 05:44:38,487 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1211  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:44:38,481 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1211  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:44:38,485 - INFO -  step: 260  loss:  0.1279  grad_norm:  0.1211  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 05:44:38,483 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1211  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:44:43,658 - INFO - Avg. fwd time: 87.6395 / Avg. bwd time: 179.0981 / Avg. batch time: 4926.0786 (ms) / GPU bubble ratio: 13.36%
[rank2]:2025-10-27 05:44:43,877 - INFO - Avg. fwd time: 84.0240 / Avg. bwd time: 147.9059 / Avg. batch time: 5218.4241 (ms) / GPU bubble ratio: 28.89%
[rank1]:2025-10-27 05:44:44,136 - INFO - Avg. fwd time: 87.3141 / Avg. bwd time: 166.3728 / Avg. batch time: 5569.5781 (ms) / GPU bubble ratio: 27.12%
[rank0]:2025-10-27 05:44:44,291 - INFO - Avg. fwd time: 87.3890 / Avg. bwd time: 156.1798 / Avg. batch time: 5794.1948 (ms) / GPU bubble ratio: 32.74%
[rank0]:2025-10-27 05:52:23,484 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1317  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 05:52:23,478 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1317  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:52:23,483 - INFO -  step: 280  loss:  0.1582  grad_norm:  0.1317  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 05:52:23,480 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1317  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 05:52:28,656 - INFO - Avg. fwd time: 87.6456 / Avg. bwd time: 179.1102 / Avg. batch time: 4926.0784 (ms) / GPU bubble ratio: 13.36%
[rank2]:2025-10-27 05:52:28,876 - INFO - Avg. fwd time: 84.0296 / Avg. bwd time: 147.9158 / Avg. batch time: 5218.4125 (ms) / GPU bubble ratio: 28.88%
[rank1]:2025-10-27 05:52:29,134 - INFO - Avg. fwd time: 87.3199 / Avg. bwd time: 166.3835 / Avg. batch time: 5569.5680 (ms) / GPU bubble ratio: 27.12%
[rank0]:2025-10-27 05:52:29,289 - INFO - Avg. fwd time: 87.3948 / Avg. bwd time: 156.1907 / Avg. batch time: 5794.1827 (ms) / GPU bubble ratio: 32.74%
[rank0]:2025-10-27 05:59:45,229 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 06:00:08,499 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0920  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 06:00:08,499 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-27 06:00:08,493 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0920  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 06:00:08,493 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 06:00:08,495 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0920  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 06:00:08,495 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 06:00:08,497 - INFO -  step: 300  loss:  0.1135  grad_norm:  0.0920  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 06:00:08,497 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 06:03:42,138 - INFO - validate step: 300  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,917
[rank1]:2025-10-27 06:03:42,215 - INFO - validate step: 300  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 06:03:42,308 - INFO - validate step: 300  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 06:03:42,471 - INFO - validate step: 300  loss:  0.2554  memory: 61.42GiB(43.93%)  tps: 1,914
[rank3]:2025-10-27 06:03:42,784 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0603_real_step300_rank3.svg
[rank3]:> Batch Time: 5121.56 ms, GPU Bubble Ratio: 23.81%, 20.66%, 27.44%, 16.57%
[rank3]:2025-10-27 06:03:47,717 - INFO - Avg. fwd time: 87.6506 / Avg. bwd time: 179.1206 / Avg. batch time: 4926.0720 (ms) / GPU bubble ratio: 13.35%
[rank2]:2025-10-27 06:03:47,937 - INFO - Avg. fwd time: 84.0343 / Avg. bwd time: 147.9245 / Avg. batch time: 5218.4526 (ms) / GPU bubble ratio: 28.88%
[rank1]:2025-10-27 06:03:48,195 - INFO - Avg. fwd time: 87.3248 / Avg. bwd time: 166.3929 / Avg. batch time: 5569.6107 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-27 06:03:48,351 - INFO - Avg. fwd time: 87.3996 / Avg. bwd time: 156.2001 / Avg. batch time: 5794.2240 (ms) / GPU bubble ratio: 32.73%
[rank3]:2025-10-27 06:11:27,557 - INFO -  step: 320  loss:  0.1492  grad_norm:  0.1303  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 06:11:27,558 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank2]:2025-10-27 06:11:27,552 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank1]:2025-10-27 06:11:27,555 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 06:11:32,731 - INFO - Avg. fwd time: 87.6550 / Avg. bwd time: 179.1299 / Avg. batch time: 4926.0701 (ms) / GPU bubble ratio: 13.35%
[rank2]:2025-10-27 06:11:32,950 - INFO - Avg. fwd time: 84.0385 / Avg. bwd time: 147.9318 / Avg. batch time: 5218.4385 (ms) / GPU bubble ratio: 28.88%
[rank1]:2025-10-27 06:11:33,209 - INFO - Avg. fwd time: 87.3293 / Avg. bwd time: 166.4011 / Avg. batch time: 5569.6005 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-27 06:11:33,365 - INFO - Avg. fwd time: 87.4040 / Avg. bwd time: 156.2083 / Avg. batch time: 5794.2128 (ms) / GPU bubble ratio: 32.73%
[rank2]:2025-10-27 06:19:12,608 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.2033  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 06:19:12,612 - INFO -  step: 340  loss:  0.1514  grad_norm:  0.2033  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 06:19:12,614 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.2033  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 06:19:12,610 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.2033  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 06:19:17,787 - INFO - Avg. fwd time: 87.6595 / Avg. bwd time: 179.1378 / Avg. batch time: 4926.0713 (ms) / GPU bubble ratio: 13.34%
[rank2]:2025-10-27 06:19:18,006 - INFO - Avg. fwd time: 84.0401 / Avg. bwd time: 147.9388 / Avg. batch time: 5218.4304 (ms) / GPU bubble ratio: 28.87%
[rank1]:2025-10-27 06:19:18,265 - INFO - Avg. fwd time: 87.3336 / Avg. bwd time: 166.4086 / Avg. batch time: 5569.5953 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-27 06:19:18,421 - INFO - Avg. fwd time: 87.4084 / Avg. bwd time: 156.2144 / Avg. batch time: 5794.2124 (ms) / GPU bubble ratio: 32.73%
[rank0]:2025-10-27 06:22:41,872 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 06:26:57,646 - INFO -  step: 360  loss:  0.1117  grad_norm:  0.1093  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 06:26:57,648 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1093  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 06:26:57,644 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1093  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 06:26:57,641 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1093  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 06:27:02,823 - INFO - Avg. fwd time: 87.6635 / Avg. bwd time: 179.1449 / Avg. batch time: 4926.0786 (ms) / GPU bubble ratio: 13.34%
[rank2]:2025-10-27 06:27:03,038 - INFO - Avg. fwd time: 84.0426 / Avg. bwd time: 147.9448 / Avg. batch time: 5218.4287 (ms) / GPU bubble ratio: 28.87%
[rank1]:2025-10-27 06:27:03,297 - INFO - Avg. fwd time: 87.3377 / Avg. bwd time: 166.4154 / Avg. batch time: 5569.5963 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-27 06:27:03,453 - INFO - Avg. fwd time: 87.4121 / Avg. bwd time: 156.2201 / Avg. batch time: 5794.2122 (ms) / GPU bubble ratio: 32.72%
[rank0]:2025-10-27 06:34:42,665 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0999  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 06:34:42,661 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0999  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 06:34:42,664 - INFO -  step: 380  loss:  0.1144  grad_norm:  0.0999  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 06:34:42,659 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0999  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 06:34:47,839 - INFO - Avg. fwd time: 87.6672 / Avg. bwd time: 179.1510 / Avg. batch time: 4926.0796 (ms) / GPU bubble ratio: 13.34%
[rank2]:2025-10-27 06:34:48,057 - INFO - Avg. fwd time: 84.0451 / Avg. bwd time: 147.9503 / Avg. batch time: 5218.4216 (ms) / GPU bubble ratio: 28.87%
[rank1]:2025-10-27 06:34:48,317 - INFO - Avg. fwd time: 87.3414 / Avg. bwd time: 166.4212 / Avg. batch time: 5569.5924 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-27 06:34:48,472 - INFO - Avg. fwd time: 87.4154 / Avg. bwd time: 156.2252 / Avg. batch time: 5794.2089 (ms) / GPU bubble ratio: 32.72%
[rank0]:2025-10-27 06:42:04,425 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 06:42:27,691 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1221  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 06:42:27,691 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 06:42:27,697 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1221  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 06:42:27,697 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-27 06:42:27,694 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1221  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 06:42:27,694 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 06:42:27,696 - INFO -  step: 400  loss:  0.1063  grad_norm:  0.1221  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 06:42:27,696 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 06:46:01,303 - INFO - validate step: 400  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,918
[rank1]:2025-10-27 06:46:01,380 - INFO - validate step: 400  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 06:46:01,472 - INFO - validate step: 400  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 06:46:01,636 - INFO - validate step: 400  loss:  0.2572  memory: 61.42GiB(43.93%)  tps: 1,915
[rank3]:2025-10-27 06:46:01,960 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0646_real_step400_rank3.svg
[rank3]:> Batch Time: 5121.69 ms, GPU Bubble Ratio: 23.81%, 20.66%, 27.45%, 16.57%
[rank3]:2025-10-27 06:46:06,897 - INFO - Avg. fwd time: 87.6704 / Avg. bwd time: 179.1566 / Avg. batch time: 4926.0823 (ms) / GPU bubble ratio: 13.33%
[rank2]:2025-10-27 06:46:07,115 - INFO - Avg. fwd time: 84.0471 / Avg. bwd time: 147.9553 / Avg. batch time: 5218.4650 (ms) / GPU bubble ratio: 28.87%
[rank1]:2025-10-27 06:46:07,375 - INFO - Avg. fwd time: 87.3445 / Avg. bwd time: 166.4269 / Avg. batch time: 5569.6367 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-27 06:46:07,531 - INFO - Avg. fwd time: 87.4186 / Avg. bwd time: 156.2296 / Avg. batch time: 5794.2556 (ms) / GPU bubble ratio: 32.72%
[rank2]:2025-10-27 06:53:46,810 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1377  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank0]:2025-10-27 06:53:46,817 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1377  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.83  mfu: 3.32%
[rank1]:2025-10-27 06:53:46,813 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1377  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 06:53:46,815 - INFO -  step: 420  loss:  0.1305  grad_norm:  0.1377  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 06:53:51,989 - INFO - Avg. fwd time: 87.6732 / Avg. bwd time: 179.1619 / Avg. batch time: 4926.0842 (ms) / GPU bubble ratio: 13.33%
[rank2]:2025-10-27 06:53:52,208 - INFO - Avg. fwd time: 84.0492 / Avg. bwd time: 147.9598 / Avg. batch time: 5218.4584 (ms) / GPU bubble ratio: 28.87%
[rank1]:2025-10-27 06:53:52,467 - INFO - Avg. fwd time: 87.3474 / Avg. bwd time: 166.4321 / Avg. batch time: 5569.6307 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-27 06:53:52,624 - INFO - Avg. fwd time: 87.4215 / Avg. bwd time: 156.2338 / Avg. batch time: 5794.2517 (ms) / GPU bubble ratio: 32.72%
[rank3]:2025-10-27 07:01:31,895 - INFO -  step: 440  loss:  0.1281  grad_norm:  0.1225  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 07:01:31,893 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1225  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 07:01:31,897 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1225  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 07:01:31,890 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1225  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:01:37,072 - INFO - Avg. fwd time: 87.6755 / Avg. bwd time: 179.1667 / Avg. batch time: 4926.0835 (ms) / GPU bubble ratio: 13.33%
[rank2]:2025-10-27 07:01:37,291 - INFO - Avg. fwd time: 84.0515 / Avg. bwd time: 147.9636 / Avg. batch time: 5218.4503 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:01:37,550 - INFO - Avg. fwd time: 87.3496 / Avg. bwd time: 166.4361 / Avg. batch time: 5569.6230 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:01:37,708 - INFO - Avg. fwd time: 87.4238 / Avg. bwd time: 156.2382 / Avg. batch time: 5794.2466 (ms) / GPU bubble ratio: 32.72%
[rank0]:2025-10-27 07:05:01,189 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 07:09:16,971 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0875  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 07:09:16,975 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0875  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 07:09:16,968 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0875  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:09:16,973 - INFO -  step: 460  loss:  0.1031  grad_norm:  0.0875  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:09:22,149 - INFO - Avg. fwd time: 87.6777 / Avg. bwd time: 179.1712 / Avg. batch time: 4926.0835 (ms) / GPU bubble ratio: 13.33%
[rank2]:2025-10-27 07:09:22,368 - INFO - Avg. fwd time: 84.0537 / Avg. bwd time: 147.9669 / Avg. batch time: 5218.4428 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:09:22,627 - INFO - Avg. fwd time: 87.3516 / Avg. bwd time: 166.4401 / Avg. batch time: 5569.6182 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:09:22,783 - INFO - Avg. fwd time: 87.4260 / Avg. bwd time: 156.2423 / Avg. batch time: 5794.2442 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 07:17:02,027 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1105  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 07:17:02,020 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1105  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:17:02,025 - INFO -  step: 480  loss:  0.1158  grad_norm:  0.1105  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 07:17:02,023 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1105  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:17:07,200 - INFO - Avg. fwd time: 87.6795 / Avg. bwd time: 179.1752 / Avg. batch time: 4926.0792 (ms) / GPU bubble ratio: 13.33%
[rank2]:2025-10-27 07:17:07,420 - INFO - Avg. fwd time: 84.0555 / Avg. bwd time: 147.9700 / Avg. batch time: 5218.4306 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:17:07,679 - INFO - Avg. fwd time: 87.3534 / Avg. bwd time: 166.4438 / Avg. batch time: 5569.6098 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:17:07,837 - INFO - Avg. fwd time: 87.4281 / Avg. bwd time: 156.2459 / Avg. batch time: 5794.2395 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 07:24:23,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 07:24:47,037 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0852  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 07:24:47,038 - INFO - ðŸ”Ž  Running validation at step 500
[rank3]:2025-10-27 07:24:47,042 - INFO -  step: 500  loss:  0.0951  grad_norm:  0.0852  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 07:24:47,042 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 07:24:47,040 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0852  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 07:24:47,040 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 07:24:47,044 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0852  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 07:24:47,044 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 07:28:20,661 - INFO - validate step: 500  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,917
[rank0]:2025-10-27 07:28:20,661 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 07:28:20,665 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 07:28:20,737 - INFO - validate step: 500  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank1]:2025-10-27 07:28:20,738 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 07:28:20,828 - INFO - validate step: 500  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank2]:2025-10-27 07:28:20,828 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 07:28:20,992 - INFO - validate step: 500  loss:  0.2582  memory: 61.42GiB(43.93%)  tps: 1,914
[rank3]:2025-10-27 07:28:20,993 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 07:28:31,499 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.67 seconds.
[rank1]:2025-10-27 07:28:32,795 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.06 seconds.
[rank3]:2025-10-27 07:28:33,313 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.32 seconds.
[rank0]:2025-10-27 07:28:34,587 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 07:28:34,593 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.93 seconds.
[rank3]:2025-10-27 07:28:35,052 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0728_real_step500_rank3.svg
[rank3]:> Batch Time: 5121.75 ms, GPU Bubble Ratio: 23.81%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 07:28:39,990 - INFO - Avg. fwd time: 87.6813 / Avg. bwd time: 179.1788 / Avg. batch time: 4926.0770 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 07:28:40,207 - INFO - Avg. fwd time: 84.0569 / Avg. bwd time: 147.9728 / Avg. batch time: 5218.4914 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:28:40,466 - INFO - Avg. fwd time: 87.3550 / Avg. bwd time: 166.4471 / Avg. batch time: 5569.6734 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:28:40,625 - INFO - Avg. fwd time: 87.4309 / Avg. bwd time: 156.2492 / Avg. batch time: 5794.3083 (ms) / GPU bubble ratio: 32.71%
[rank2]:2025-10-27 07:36:19,935 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0926  memory: 47.12GiB(33.70%)  tps: 684  tflops: 31.90  mfu: 3.23%
[rank0]:2025-10-27 07:36:19,941 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0926  memory: 67.54GiB(48.30%)  tps: 684  tflops: 31.89  mfu: 3.22%
[rank1]:2025-10-27 07:36:19,938 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0926  memory: 61.38GiB(43.90%)  tps: 684  tflops: 31.89  mfu: 3.22%
[rank3]:2025-10-27 07:36:19,940 - INFO -  step: 520  loss:  0.1329  grad_norm:  0.0926  memory: 61.42GiB(43.93%)  tps: 684  tflops: 31.91  mfu: 3.23%
[rank3]:2025-10-27 07:36:25,116 - INFO - Avg. fwd time: 87.6828 / Avg. bwd time: 179.1823 / Avg. batch time: 4926.0737 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 07:36:25,336 - INFO - Avg. fwd time: 84.0582 / Avg. bwd time: 147.9754 / Avg. batch time: 5218.4782 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:36:25,594 - INFO - Avg. fwd time: 87.3563 / Avg. bwd time: 166.4499 / Avg. batch time: 5569.6619 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:36:25,754 - INFO - Avg. fwd time: 87.4322 / Avg. bwd time: 156.2524 / Avg. batch time: 5794.2995 (ms) / GPU bubble ratio: 32.71%
[rank3]:2025-10-27 07:44:05,106 - INFO -  step: 540  loss:  0.1308  grad_norm:  0.1585  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 07:44:05,108 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1585  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 07:44:05,101 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1585  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 07:44:05,104 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1585  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 07:44:10,288 - INFO - Avg. fwd time: 87.6845 / Avg. bwd time: 179.1856 / Avg. batch time: 4926.0779 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 07:44:10,507 - INFO - Avg. fwd time: 84.0598 / Avg. bwd time: 147.9779 / Avg. batch time: 5218.4735 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:44:10,766 - INFO - Avg. fwd time: 87.3578 / Avg. bwd time: 166.4529 / Avg. batch time: 5569.6590 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:44:10,927 - INFO - Avg. fwd time: 87.4336 / Avg. bwd time: 156.2552 / Avg. batch time: 5794.3011 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 07:47:36,621 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank1]:2025-10-27 07:51:52,540 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1049  memory: 61.38GiB(43.90%)  tps: 701  tflops: 32.70  mfu: 3.31%
[rank0]:2025-10-27 07:51:52,544 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1049  memory: 67.54GiB(48.30%)  tps: 701  tflops: 32.70  mfu: 3.31%
[rank2]:2025-10-27 07:51:52,537 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1049  memory: 47.12GiB(33.70%)  tps: 701  tflops: 32.70  mfu: 3.31%
[rank3]:2025-10-27 07:51:52,542 - INFO -  step: 560  loss:  0.1337  grad_norm:  0.1049  memory: 61.42GiB(43.93%)  tps: 701  tflops: 32.70  mfu: 3.31%
[rank3]:2025-10-27 07:51:57,722 - INFO - Avg. fwd time: 87.6865 / Avg. bwd time: 179.1922 / Avg. batch time: 4926.1484 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 07:51:57,941 - INFO - Avg. fwd time: 84.0613 / Avg. bwd time: 147.9803 / Avg. batch time: 5218.5375 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:51:58,200 - INFO - Avg. fwd time: 87.3597 / Avg. bwd time: 166.4621 / Avg. batch time: 5569.7192 (ms) / GPU bubble ratio: 27.09%
[rank0]:2025-10-27 07:51:58,358 - INFO - Avg. fwd time: 87.4350 / Avg. bwd time: 156.2572 / Avg. batch time: 5794.3626 (ms) / GPU bubble ratio: 32.71%
[rank2]:2025-10-27 07:59:37,752 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1290  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank0]:2025-10-27 07:59:37,758 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1290  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank1]:2025-10-27 07:59:37,754 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1290  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 07:59:37,757 - INFO -  step: 580  loss:  0.1126  grad_norm:  0.1290  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 07:59:42,931 - INFO - Avg. fwd time: 87.6886 / Avg. bwd time: 179.1992 / Avg. batch time: 4926.2272 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 07:59:43,150 - INFO - Avg. fwd time: 84.0616 / Avg. bwd time: 147.9827 / Avg. batch time: 5218.6099 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 07:59:43,408 - INFO - Avg. fwd time: 87.3616 / Avg. bwd time: 166.4714 / Avg. batch time: 5569.7883 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 07:59:43,566 - INFO - Avg. fwd time: 87.4365 / Avg. bwd time: 156.2593 / Avg. batch time: 5794.4311 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 08:06:59,543 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 08:07:22,820 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 08:07:22,820 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-27 08:07:22,813 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 08:07:22,813 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 08:07:22,818 - INFO -  step: 600  loss:  0.1187  grad_norm:  0.0974  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 08:07:22,818 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-27 08:07:22,816 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0974  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 08:07:22,816 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 08:10:56,426 - INFO - validate step: 600  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,918
[rank1]:2025-10-27 08:10:56,504 - INFO - validate step: 600  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 08:10:56,597 - INFO - validate step: 600  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 08:10:56,760 - INFO - validate step: 600  loss:  0.2602  memory: 61.42GiB(43.93%)  tps: 1,915
[rank3]:2025-10-27 08:10:57,080 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0810_real_step600_rank3.svg
[rank3]:> Batch Time: 5121.75 ms, GPU Bubble Ratio: 23.81%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 08:11:02,016 - INFO - Avg. fwd time: 87.6898 / Avg. bwd time: 179.2015 / Avg. batch time: 4926.2227 (ms) / GPU bubble ratio: 13.32%
[rank2]:2025-10-27 08:11:02,235 - INFO - Avg. fwd time: 84.0624 / Avg. bwd time: 147.9850 / Avg. batch time: 5218.6299 (ms) / GPU bubble ratio: 28.86%
[rank1]:2025-10-27 08:11:02,494 - INFO - Avg. fwd time: 87.3630 / Avg. bwd time: 166.4741 / Avg. batch time: 5569.8080 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:11:02,652 - INFO - Avg. fwd time: 87.4378 / Avg. bwd time: 156.2612 / Avg. batch time: 5794.4524 (ms) / GPU bubble ratio: 32.71%
[rank1]:2025-10-27 08:18:41,843 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1037  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 08:18:41,846 - INFO -  step: 620  loss:  0.1460  grad_norm:  0.1037  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 08:18:41,841 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1037  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank0]:2025-10-27 08:18:41,847 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1037  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 08:18:47,023 - INFO - Avg. fwd time: 87.6908 / Avg. bwd time: 179.2033 / Avg. batch time: 4926.2103 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 08:18:47,242 - INFO - Avg. fwd time: 84.0632 / Avg. bwd time: 147.9869 / Avg. batch time: 5218.6108 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 08:18:47,501 - INFO - Avg. fwd time: 87.3641 / Avg. bwd time: 166.4758 / Avg. batch time: 5569.7902 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:18:47,659 - INFO - Avg. fwd time: 87.4390 / Avg. bwd time: 156.2629 / Avg. batch time: 5794.4339 (ms) / GPU bubble ratio: 32.71%
[rank1]:2025-10-27 08:26:26,838 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0961  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 08:26:26,842 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0961  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:26:26,840 - INFO -  step: 640  loss:  0.1072  grad_norm:  0.0961  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 08:26:26,835 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0961  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:26:32,016 - INFO - Avg. fwd time: 87.6918 / Avg. bwd time: 179.2050 / Avg. batch time: 4926.2003 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 08:26:32,235 - INFO - Avg. fwd time: 84.0639 / Avg. bwd time: 147.9888 / Avg. batch time: 5218.5947 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 08:26:32,493 - INFO - Avg. fwd time: 87.3652 / Avg. bwd time: 166.4776 / Avg. batch time: 5569.7746 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:26:32,651 - INFO - Avg. fwd time: 87.4400 / Avg. bwd time: 156.2645 / Avg. batch time: 5794.4170 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 08:29:56,077 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 08:34:11,837 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1186  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:34:11,839 - INFO -  step: 660  loss:  0.1126  grad_norm:  0.1186  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 08:34:11,835 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1186  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 08:34:11,841 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1186  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:34:17,015 - INFO - Avg. fwd time: 87.6927 / Avg. bwd time: 179.2069 / Avg. batch time: 4926.1949 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 08:34:17,235 - INFO - Avg. fwd time: 84.0648 / Avg. bwd time: 147.9905 / Avg. batch time: 5218.5829 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 08:34:17,493 - INFO - Avg. fwd time: 87.3662 / Avg. bwd time: 166.4795 / Avg. batch time: 5569.7638 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:34:17,651 - INFO - Avg. fwd time: 87.4409 / Avg. bwd time: 156.2660 / Avg. batch time: 5794.4046 (ms) / GPU bubble ratio: 32.71%
[rank0]:2025-10-27 08:41:56,866 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0824  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 08:41:56,862 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0824  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:41:56,864 - INFO -  step: 680  loss:  0.1202  grad_norm:  0.0824  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 08:41:56,859 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0824  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:42:02,039 - INFO - Avg. fwd time: 87.6938 / Avg. bwd time: 179.2086 / Avg. batch time: 4926.1931 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 08:42:02,259 - INFO - Avg. fwd time: 84.0649 / Avg. bwd time: 147.9922 / Avg. batch time: 5218.5753 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 08:42:02,517 - INFO - Avg. fwd time: 87.3675 / Avg. bwd time: 166.4814 / Avg. batch time: 5569.7572 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:42:02,675 - INFO - Avg. fwd time: 87.4419 / Avg. bwd time: 156.2674 / Avg. batch time: 5794.3964 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 08:49:18,616 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 08:49:41,882 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0859  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 08:49:41,883 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-27 08:49:41,884 - INFO -  step: 700  loss:  0.1101  grad_norm:  0.0859  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 08:49:41,885 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 08:49:41,880 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0859  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 08:49:41,880 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 08:49:41,886 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0859  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 08:49:41,886 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 08:53:15,468 - INFO - validate step: 700  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,918
[rank1]:2025-10-27 08:53:15,545 - INFO - validate step: 700  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 08:53:15,637 - INFO - validate step: 700  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 08:53:15,802 - INFO - validate step: 700  loss:  0.2531  memory: 61.42GiB(43.93%)  tps: 1,915
[rank3]:2025-10-27 08:53:16,116 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0853_real_step700_rank3.svg
[rank3]:> Batch Time: 5121.75 ms, GPU Bubble Ratio: 23.81%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 08:53:21,052 - INFO - Avg. fwd time: 87.6947 / Avg. bwd time: 179.2100 / Avg. batch time: 4926.1865 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 08:53:21,271 - INFO - Avg. fwd time: 84.0656 / Avg. bwd time: 147.9937 / Avg. batch time: 5218.5862 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 08:53:21,530 - INFO - Avg. fwd time: 87.3684 / Avg. bwd time: 166.4831 / Avg. batch time: 5569.7684 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 08:53:21,688 - INFO - Avg. fwd time: 87.4428 / Avg. bwd time: 156.2687 / Avg. batch time: 5794.4073 (ms) / GPU bubble ratio: 32.70%
[rank3]:2025-10-27 09:01:00,873 - INFO -  step: 720  loss:  0.1842  grad_norm:  0.1497  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 09:01:00,868 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1497  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank1]:2025-10-27 09:01:00,871 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1497  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank0]:2025-10-27 09:01:00,875 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1497  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 09:01:06,049 - INFO - Avg. fwd time: 87.6955 / Avg. bwd time: 179.2113 / Avg. batch time: 4926.1787 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:01:06,269 - INFO - Avg. fwd time: 84.0665 / Avg. bwd time: 147.9951 / Avg. batch time: 5218.5733 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:01:06,527 - INFO - Avg. fwd time: 87.3692 / Avg. bwd time: 166.4846 / Avg. batch time: 5569.7558 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 09:01:06,685 - INFO - Avg. fwd time: 87.4437 / Avg. bwd time: 156.2700 / Avg. batch time: 5794.3940 (ms) / GPU bubble ratio: 32.70%
[rank3]:2025-10-27 09:08:45,862 - INFO -  step: 740  loss:  0.1291  grad_norm:  0.1162  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 09:08:45,858 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1162  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 09:08:45,860 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1162  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 09:08:45,864 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1162  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 09:08:51,038 - INFO - Avg. fwd time: 87.6963 / Avg. bwd time: 179.2125 / Avg. batch time: 4926.1707 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:08:51,257 - INFO - Avg. fwd time: 84.0669 / Avg. bwd time: 147.9964 / Avg. batch time: 5218.5600 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:08:51,517 - INFO - Avg. fwd time: 87.3700 / Avg. bwd time: 166.4858 / Avg. batch time: 5569.7432 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 09:08:51,676 - INFO - Avg. fwd time: 87.4444 / Avg. bwd time: 156.2713 / Avg. batch time: 5794.3814 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 09:12:15,121 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 09:16:30,880 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0983  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 09:16:30,873 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0983  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 09:16:30,878 - INFO -  step: 760  loss:  0.1177  grad_norm:  0.0983  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 09:16:30,876 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0983  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 09:16:36,055 - INFO - Avg. fwd time: 87.6970 / Avg. bwd time: 179.2136 / Avg. batch time: 4926.1619 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:16:36,274 - INFO - Avg. fwd time: 84.0675 / Avg. bwd time: 147.9977 / Avg. batch time: 5218.5462 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:16:36,532 - INFO - Avg. fwd time: 87.3708 / Avg. bwd time: 166.4869 / Avg. batch time: 5569.7295 (ms) / GPU bubble ratio: 27.08%
[rank0]:2025-10-27 09:16:36,691 - INFO - Avg. fwd time: 87.4452 / Avg. bwd time: 156.2725 / Avg. batch time: 5794.3676 (ms) / GPU bubble ratio: 32.70%
[rank1]:2025-10-27 09:24:16,130 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1152  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank0]:2025-10-27 09:24:16,134 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1152  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank2]:2025-10-27 09:24:16,128 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1152  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 09:24:16,132 - INFO -  step: 780  loss:  0.1278  grad_norm:  0.1152  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 09:24:21,315 - INFO - Avg. fwd time: 87.6987 / Avg. bwd time: 179.2191 / Avg. batch time: 4926.2426 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:24:21,534 - INFO - Avg. fwd time: 84.0677 / Avg. bwd time: 147.9990 / Avg. batch time: 5218.6229 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:24:21,793 - INFO - Avg. fwd time: 87.3721 / Avg. bwd time: 166.4954 / Avg. batch time: 5569.8033 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 09:24:21,952 - INFO - Avg. fwd time: 87.4461 / Avg. bwd time: 156.2738 / Avg. batch time: 5794.4422 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 09:31:38,154 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 09:32:01,442 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0949  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank1]:2025-10-27 09:32:01,443 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-27 09:32:01,440 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0949  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank2]:2025-10-27 09:32:01,440 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 09:32:01,446 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0949  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank0]:2025-10-27 09:32:01,446 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 09:32:01,444 - INFO -  step: 800  loss:  0.1034  grad_norm:  0.0949  memory: 61.42GiB(43.93%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 09:32:01,445 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 09:35:35,075 - INFO - validate step: 800  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,917
[rank1]:2025-10-27 09:35:35,151 - INFO - validate step: 800  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 09:35:35,244 - INFO - validate step: 800  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 09:35:35,407 - INFO - validate step: 800  loss:  0.2538  memory: 61.42GiB(43.93%)  tps: 1,914
[rank3]:2025-10-27 09:35:35,720 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_0935_real_step800_rank3.svg
[rank3]:> Batch Time: 5121.75 ms, GPU Bubble Ratio: 23.81%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 09:35:40,662 - INFO - Avg. fwd time: 87.7002 / Avg. bwd time: 179.2249 / Avg. batch time: 4926.3260 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:35:40,880 - INFO - Avg. fwd time: 84.0680 / Avg. bwd time: 148.0001 / Avg. batch time: 5218.7213 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:35:41,139 - INFO - Avg. fwd time: 87.3735 / Avg. bwd time: 166.5048 / Avg. batch time: 5569.8993 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 09:35:41,297 - INFO - Avg. fwd time: 87.4471 / Avg. bwd time: 156.2753 / Avg. batch time: 5794.5389 (ms) / GPU bubble ratio: 32.70%
[rank3]:2025-10-27 09:40:01,371 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 09:40:02,566 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 09:40:02,824 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 09:40:02,975 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 09:43:21,390 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0983  memory: 47.12GiB(33.70%)  tps: 703  tflops: 32.79  mfu: 3.32%
[rank0]:2025-10-27 09:43:21,397 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0983  memory: 67.54GiB(48.30%)  tps: 703  tflops: 32.77  mfu: 3.31%
[rank3]:2025-10-27 09:43:21,395 - INFO -  step: 820  loss:  0.1275  grad_norm:  0.0983  memory: 61.42GiB(43.93%)  tps: 703  tflops: 32.80  mfu: 3.32%
[rank1]:2025-10-27 09:43:21,393 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0983  memory: 61.38GiB(43.90%)  tps: 703  tflops: 32.78  mfu: 3.31%
[rank3]:2025-10-27 09:43:26,570 - INFO - Avg. fwd time: 87.7016 / Avg. bwd time: 179.2299 / Avg. batch time: 4926.3952 (ms) / GPU bubble ratio: 13.31%
[rank2]:2025-10-27 09:43:26,789 - INFO - Avg. fwd time: 84.0684 / Avg. bwd time: 148.0012 / Avg. batch time: 5218.7859 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:43:27,049 - INFO - Avg. fwd time: 87.3745 / Avg. bwd time: 166.5129 / Avg. batch time: 5569.9622 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 09:43:27,208 - INFO - Avg. fwd time: 87.4480 / Avg. bwd time: 156.2767 / Avg. batch time: 5794.6027 (ms) / GPU bubble ratio: 32.70%
[rank3]:2025-10-27 09:51:06,517 - INFO -  step: 840  loss:  0.1210  grad_norm:  0.1114  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 09:51:06,513 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1114  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 09:51:06,515 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1114  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 09:51:06,519 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1114  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 09:51:11,694 - INFO - Avg. fwd time: 87.7024 / Avg. bwd time: 179.2330 / Avg. batch time: 4926.4268 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 09:51:11,914 - INFO - Avg. fwd time: 84.0689 / Avg. bwd time: 148.0022 / Avg. batch time: 5218.8137 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:51:12,173 - INFO - Avg. fwd time: 87.3753 / Avg. bwd time: 166.5174 / Avg. batch time: 5569.9894 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 09:51:12,333 - INFO - Avg. fwd time: 87.4487 / Avg. bwd time: 156.2778 / Avg. batch time: 5794.6299 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 09:54:35,787 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 09:58:51,516 - INFO -  step: 860  loss:  0.1102  grad_norm:  0.1045  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 09:58:51,515 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1045  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 09:58:51,512 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1045  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 09:58:51,518 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1045  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 09:58:56,692 - INFO - Avg. fwd time: 87.7029 / Avg. bwd time: 179.2340 / Avg. batch time: 4926.4226 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 09:58:56,912 - INFO - Avg. fwd time: 84.0696 / Avg. bwd time: 148.0031 / Avg. batch time: 5218.8052 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 09:58:57,171 - INFO - Avg. fwd time: 87.3758 / Avg. bwd time: 166.5190 / Avg. batch time: 5569.9807 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 09:58:57,330 - INFO - Avg. fwd time: 87.4493 / Avg. bwd time: 156.2787 / Avg. batch time: 5794.6211 (ms) / GPU bubble ratio: 32.70%
[rank3]:2025-10-27 10:06:36,508 - INFO -  step: 880  loss:  0.0845  grad_norm:  0.0797  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 10:06:36,504 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0797  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 10:06:36,506 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0797  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 10:06:36,510 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0797  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 10:06:41,688 - INFO - Avg. fwd time: 87.7032 / Avg. bwd time: 179.2350 / Avg. batch time: 4926.4149 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:06:41,908 - INFO - Avg. fwd time: 84.0702 / Avg. bwd time: 148.0040 / Avg. batch time: 5218.7936 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:06:42,166 - INFO - Avg. fwd time: 87.3763 / Avg. bwd time: 166.5199 / Avg. batch time: 5569.9697 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 10:06:42,325 - INFO - Avg. fwd time: 87.4498 / Avg. bwd time: 156.2796 / Avg. batch time: 5794.6095 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 10:13:58,236 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 10:14:21,500 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1152  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank1]:2025-10-27 10:14:21,501 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 10:14:21,503 - INFO -  step: 900  loss:  0.1087  grad_norm:  0.1152  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank3]:2025-10-27 10:14:21,503 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 10:14:21,504 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1152  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank0]:2025-10-27 10:14:21,504 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-27 10:14:21,498 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1152  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 10:14:21,498 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 10:17:55,101 - INFO - validate step: 900  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,918
[rank1]:2025-10-27 10:17:55,184 - INFO - validate step: 900  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank2]:2025-10-27 10:17:55,269 - INFO - validate step: 900  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank3]:2025-10-27 10:17:55,434 - INFO - validate step: 900  loss:  0.2529  memory: 61.42GiB(43.93%)  tps: 1,915
[rank3]:2025-10-27 10:17:55,754 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_1017_real_step900_rank3.svg
[rank3]:> Batch Time: 5121.88 ms, GPU Bubble Ratio: 23.82%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 10:18:00,690 - INFO - Avg. fwd time: 87.7034 / Avg. bwd time: 179.2361 / Avg. batch time: 4926.4091 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:18:00,907 - INFO - Avg. fwd time: 84.0707 / Avg. bwd time: 148.0049 / Avg. batch time: 5218.8024 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:18:01,168 - INFO - Avg. fwd time: 87.3767 / Avg. bwd time: 166.5211 / Avg. batch time: 5569.9787 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 10:18:01,328 - INFO - Avg. fwd time: 87.4504 / Avg. bwd time: 156.2804 / Avg. batch time: 5794.6183 (ms) / GPU bubble ratio: 32.70%
[rank2]:2025-10-27 10:25:40,544 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0996  memory: 47.12GiB(33.70%)  tps: 704  tflops: 32.85  mfu: 3.32%
[rank3]:2025-10-27 10:25:40,548 - INFO -  step: 920  loss:  0.1126  grad_norm:  0.0996  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 10:25:40,546 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0996  memory: 61.38GiB(43.90%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank0]:2025-10-27 10:25:40,550 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0996  memory: 67.54GiB(48.30%)  tps: 704  tflops: 32.84  mfu: 3.32%
[rank3]:2025-10-27 10:25:45,726 - INFO - Avg. fwd time: 87.7039 / Avg. bwd time: 179.2366 / Avg. batch time: 4926.3999 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:25:45,945 - INFO - Avg. fwd time: 84.0710 / Avg. bwd time: 148.0057 / Avg. batch time: 5218.7887 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:25:46,204 - INFO - Avg. fwd time: 87.3771 / Avg. bwd time: 166.5217 / Avg. batch time: 5569.9657 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 10:25:46,364 - INFO - Avg. fwd time: 87.4509 / Avg. bwd time: 156.2811 / Avg. batch time: 5794.6060 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 10:33:25,576 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1153  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:33:25,574 - INFO -  step: 940  loss:  0.0960  grad_norm:  0.1153  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.87  mfu: 3.32%
[rank2]:2025-10-27 10:33:25,570 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1153  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 10:33:25,572 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1153  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:33:30,752 - INFO - Avg. fwd time: 87.7042 / Avg. bwd time: 179.2375 / Avg. batch time: 4926.3944 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:33:30,971 - INFO - Avg. fwd time: 84.0713 / Avg. bwd time: 148.0063 / Avg. batch time: 5218.7789 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:33:31,229 - INFO - Avg. fwd time: 87.3775 / Avg. bwd time: 166.5228 / Avg. batch time: 5569.9558 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 10:33:31,389 - INFO - Avg. fwd time: 87.4514 / Avg. bwd time: 156.2818 / Avg. batch time: 5794.5959 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 10:36:54,849 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 10:41:10,618 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0982  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:41:10,620 - INFO -  step: 960  loss:  0.0807  grad_norm:  0.0982  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 10:41:10,622 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0982  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 10:41:10,615 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0982  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:41:15,800 - INFO - Avg. fwd time: 87.7045 / Avg. bwd time: 179.2388 / Avg. batch time: 4926.3956 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:41:16,020 - INFO - Avg. fwd time: 84.0718 / Avg. bwd time: 148.0071 / Avg. batch time: 5218.7762 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:41:16,278 - INFO - Avg. fwd time: 87.3780 / Avg. bwd time: 166.5243 / Avg. batch time: 5569.9531 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-27 10:41:16,439 - INFO - Avg. fwd time: 87.4519 / Avg. bwd time: 156.2825 / Avg. batch time: 5794.5934 (ms) / GPU bubble ratio: 32.70%
[rank2]:2025-10-27 10:48:55,682 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0809  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:48:55,686 - INFO -  step: 980  loss:  0.0887  grad_norm:  0.0809  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 10:48:55,688 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0809  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 10:48:55,684 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0809  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:49:00,865 - INFO - Avg. fwd time: 87.7047 / Avg. bwd time: 179.2401 / Avg. batch time: 4926.3987 (ms) / GPU bubble ratio: 13.30%
[rank2]:2025-10-27 10:49:01,085 - INFO - Avg. fwd time: 84.0723 / Avg. bwd time: 148.0078 / Avg. batch time: 5218.7760 (ms) / GPU bubble ratio: 28.85%
[rank1]:2025-10-27 10:49:01,343 - INFO - Avg. fwd time: 87.3783 / Avg. bwd time: 166.5258 / Avg. batch time: 5569.9522 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-27 10:49:01,503 - INFO - Avg. fwd time: 87.4523 / Avg. bwd time: 156.2832 / Avg. batch time: 5794.5929 (ms) / GPU bubble ratio: 32.70%
[rank0]:2025-10-27 10:56:17,449 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 10:56:40,711 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0857  memory: 47.12GiB(33.70%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank2]:2025-10-27 10:56:40,711 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0857  tps: 718  tflops: 33.47  mfu: 3.29%
[rank2]:2025-10-27 10:56:40,711 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 10:56:40,717 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0857  memory: 67.54GiB(48.30%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank0]:2025-10-27 10:56:40,717 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0857  tps: 717  tflops: 33.46  mfu: 3.29%
[rank0]:2025-10-27 10:56:40,717 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 10:56:40,715 - INFO -  step: 1000  loss:  0.0965  grad_norm:  0.0857  memory: 61.42GiB(43.93%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank3]:2025-10-27 10:56:40,715 - INFO -  final step: 1000  loss:  0.0965  grad_norm:  0.0857  tps: 718  tflops: 33.47  mfu: 3.29%
[rank3]:2025-10-27 10:56:40,716 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 10:56:40,713 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0857  memory: 61.38GiB(43.90%)  tps: 705  tflops: 32.86  mfu: 3.32%
[rank1]:2025-10-27 10:56:40,713 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0857  tps: 718  tflops: 33.47  mfu: 3.29%
[rank1]:2025-10-27 10:56:40,714 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 11:00:14,304 - INFO - validate step: 1000  loss: -1.0000  memory: 67.54GiB(48.30%)  tps: 1,918
[rank0]:2025-10-27 11:00:14,305 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 11:00:14,309 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 11:00:14,381 - INFO - validate step: 1000  loss: -1.0000  memory: 61.38GiB(43.90%)  tps: 1,917
[rank1]:2025-10-27 11:00:14,382 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 11:00:14,386 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 11:00:14,473 - INFO - validate step: 1000  loss: -1.0000  memory: 47.12GiB(33.70%)  tps: 1,916
[rank2]:2025-10-27 11:00:14,474 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 11:00:14,477 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 11:00:14,637 - INFO - validate step: 1000  loss:  0.2529  memory: 61.42GiB(43.93%)  tps: 1,915
[rank3]:2025-10-27 11:00:14,638 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 11:00:14,641 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 11:00:24,472 - INFO - Destroying the purge thread.
[rank2]:2025-10-27 11:00:24,472 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 11:00:24,448 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-27 11:00:24,472 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-27 11:00:24,777 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_1100_real_final1000_rank3.svg
[rank3]:> Batch Time: 5121.94 ms, GPU Bubble Ratio: 23.82%, 20.67%, 27.45%, 16.57%
[rank3]:2025-10-27 11:00:25,074 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1/pipeline_schedule/251027_1100_thry_final1000_rank3.svg
[rank3]:> Batch Time: 4939.63 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-10-27 11:00:25,075 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 22.82973
[rank3]:wandb:               final/avg_loss 0.09651
[rank3]:wandb:             final/avg_mfu(%) 3.29352
[rank3]:wandb:             final/avg_tflops 33.47181
[rank3]:wandb:    final/avg_throughput(tps) 717.66072
[rank3]:wandb:              final/grad_norm 0.08575
[rank3]:wandb:               final/max_loss 0.09651
[rank3]:wandb:                    grad_norm 0.08575
[rank3]:wandb: loss_metrics/global_avg_loss 0.09651
[rank3]:wandb: loss_metrics/global_max_loss 0.09651
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1027_Interleaved1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/ec6ak88x
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1027_Interleaved1F1B_nofreeze_dm1/20251027-0356/wandb/run-20251027_035626-ec6ak88x/logs
[rank0]:2025-10-27 11:00:26,472 - INFO - Training completed
[rank0]:2025-10-27 11:00:26,472 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 11:00:26,768 - INFO - Process group destroyed
[rank1]:2025-10-27 11:00:26,767 - INFO - Process group destroyed
[rank2]:2025-10-27 11:00:26,901 - INFO - Process group destroyed
[rank0]:2025-10-27 11:00:26,891 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.10', 'layers.11'}
[rank2]:Stage 6: Modules to keep: {'layers.27', 'layers.28', 'layers.26', 'layers.25'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.0', 'layers.2', 'layers.3', 'layers.1'}
[rank0]:Stage 4: Modules to keep: {'layers.18', 'layers.20', 'layers.17', 'layers.19'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.4', 'layers.6', 'layers.7', 'layers.5'}
[rank1]:Stage 5: Modules to keep: {'layers.22', 'layers.21', 'layers.23', 'layers.24'}
[rank3]:Stage 3: Modules to keep: {'layers.16', 'layers.15', 'layers.14', 'layers.13'}
[rank3]:Stage 7: Modules to keep: {'layers.29', 'layers.31', 'norm', 'layers.30', 'output'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1027_Interleaved1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1027_Interleaved1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
