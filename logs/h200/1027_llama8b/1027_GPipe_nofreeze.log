
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Oct 26 17:35:00 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/1027_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1026 17:35:02.082000 2429266 site-packages/torch/distributed/run.py:811] 
W1026 17:35:02.082000 2429266 site-packages/torch/distributed/run.py:811] *****************************************
W1026 17:35:02.082000 2429266 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1026 17:35:02.082000 2429266 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-26 17:35:07,703 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-26 17:35:07,868 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-26 17:35:08,092 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-26 17:35:08,136 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-26 17:35:08,138 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-26 17:35:08,142 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-26 17:35:08,416 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-26 17:35:08,418 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 17:35:08,423 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-26 17:35:08,712 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-26 17:35:08,714 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-26 17:35:08,698 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-26 17:35:08,702 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 17:35:10,234 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-26 17:35:10,525 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-26 17:35:12,376 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-26 17:35:12,572 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-26 17:35:12,628 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-26 17:35:12,645 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-26 17:35:12,645 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-26 17:35:12,685 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-26 17:35:12,680 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-26 17:35:12,703 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-26 17:35:12,703 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-26 17:35:12,759 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-26 17:35:12,761 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-26 17:35:12,864 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-26 17:35:12,865 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-10-26 17:35:13,013 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-26 17:35:13,014 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-26 17:35:12,936 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-26 17:35:12,936 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run pw63cggg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_GPipe_nofreeze_dm1/20251026-1735/wandb/run-20251026_173513-pw63cggg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/pw63cggg
[rank3]:2025-10-26 17:35:14,439 - INFO - WandB logging enabled
[rank3]:2025-10-26 17:35:14,440 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-26 17:35:14,514 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-26 17:35:14,515 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-26 17:35:14,720 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-26 17:35:14,721 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-26 17:35:14,747 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_GPipe_nofreeze_dm1
[rank0]:2025-10-26 17:35:14,747 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-26 17:35:14,747 - INFO - Mixed precision training is disabled
[rank0]:2025-10-26 17:35:14,747 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-26 17:35:18,377 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-26 17:35:18,378 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-26 17:35:27,958 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-26 17:35:27,958 - INFO - Finished loading the checkpoint in 9.58 seconds.
[rank0]:2025-10-26 17:35:27,958 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-26 17:35:51,900 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 65.20GiB(46.63%)  tps: 417  tflops: 19.45  mfu: 1.97%
[rank1]:2025-10-26 17:35:51,901 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-26 17:35:51,899 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 58.03GiB(41.50%)  tps: 418  tflops: 19.51  mfu: 1.97%
[rank2]:2025-10-26 17:35:51,900 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-26 17:35:51,903 - INFO -  step:  1  loss:  4.0063  grad_norm: 613.1230  memory: 77.01GiB(55.08%)  tps: 438  tflops: 20.43  mfu: 2.07%
[rank3]:2025-10-26 17:35:51,903 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-26 17:35:51,919 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 61.95GiB(44.31%)  tps: 418  tflops: 19.47  mfu: 1.97%
[rank0]:2025-10-26 17:35:51,920 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-26 17:36:29,589 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,589 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,589 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,590 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,591 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 17:36:29,592 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 17:36:29,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,226 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,227 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,228 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,228 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,228 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 17:36:30,228 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,527 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:36:30,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 17:42:51,355 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 17:42:51,351 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 17:42:51,354 - INFO -  step: 20  loss:  0.1266  grad_norm:  0.3757  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 17:42:51,349 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 17:42:55,930 - INFO - Avg. fwd time: 167.4268 / Avg. bwd time: 339.2300 / Avg. batch time: 4113.0972 (ms) / GPU bubble ratio: 1.45%
[rank2]:2025-10-26 17:42:56,229 - INFO - Avg. fwd time: 144.6080 / Avg. bwd time: 292.4453 / Avg. batch time: 4556.5379 (ms) / GPU bubble ratio: 23.27%
[rank1]:2025-10-26 17:42:56,565 - INFO - Avg. fwd time: 163.4270 / Avg. bwd time: 329.1596 / Avg. batch time: 5055.3857 (ms) / GPU bubble ratio: 22.05%
[rank0]:2025-10-26 17:42:56,865 - INFO - Avg. fwd time: 145.9746 / Avg. bwd time: 294.4717 / Avg. batch time: 5501.3127 (ms) / GPU bubble ratio: 35.95%
[rank0]:2025-10-26 17:50:12,858 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2732  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 17:50:12,856 - INFO -  step: 40  loss:  0.1271  grad_norm:  0.2732  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 17:50:12,851 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2732  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 17:50:12,854 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2732  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 17:50:17,432 - INFO - Avg. fwd time: 168.4655 / Avg. bwd time: 341.3373 / Avg. batch time: 4113.0887 (ms) / GPU bubble ratio: 0.84%
[rank2]:2025-10-26 17:50:17,731 - INFO - Avg. fwd time: 145.5085 / Avg. bwd time: 294.2745 / Avg. batch time: 4556.5214 (ms) / GPU bubble ratio: 22.79%
[rank1]:2025-10-26 17:50:18,066 - INFO - Avg. fwd time: 164.5023 / Avg. bwd time: 331.1558 / Avg. batch time: 5055.2718 (ms) / GPU bubble ratio: 21.56%
[rank0]:2025-10-26 17:50:18,367 - INFO - Avg. fwd time: 147.1162 / Avg. bwd time: 296.2979 / Avg. batch time: 5501.1871 (ms) / GPU bubble ratio: 35.52%
[rank0]:2025-10-26 17:53:31,552 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-26 17:57:34,354 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1318  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 17:57:34,361 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1318  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 17:57:34,357 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1318  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 17:57:34,360 - INFO -  step: 60  loss:  0.1356  grad_norm:  0.1318  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 17:57:38,937 - INFO - Avg. fwd time: 168.8111 / Avg. bwd time: 342.0475 / Avg. batch time: 4113.0732 (ms) / GPU bubble ratio: 0.64%
[rank2]:2025-10-26 17:57:39,236 - INFO - Avg. fwd time: 145.8121 / Avg. bwd time: 294.9008 / Avg. batch time: 4556.5167 (ms) / GPU bubble ratio: 22.62%
[rank1]:2025-10-26 17:57:39,572 - INFO - Avg. fwd time: 164.9297 / Avg. bwd time: 331.8525 / Avg. batch time: 5055.2580 (ms) / GPU bubble ratio: 21.38%
[rank0]:2025-10-26 17:57:39,872 - INFO - Avg. fwd time: 147.5754 / Avg. bwd time: 296.9136 / Avg. batch time: 5501.1760 (ms) / GPU bubble ratio: 35.36%
[rank3]:2025-10-26 18:04:55,898 - INFO -  step: 80  loss:  0.1226  grad_norm:  0.1940  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 18:04:55,896 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.1940  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 18:04:55,893 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.1940  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 18:04:55,900 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.1940  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 18:05:00,479 - INFO - Avg. fwd time: 168.9990 / Avg. bwd time: 342.4076 / Avg. batch time: 4113.2145 (ms) / GPU bubble ratio: 0.53%
[rank2]:2025-10-26 18:05:00,778 - INFO - Avg. fwd time: 145.9651 / Avg. bwd time: 295.2065 / Avg. batch time: 4556.6524 (ms) / GPU bubble ratio: 22.54%
[rank1]:2025-10-26 18:05:01,113 - INFO - Avg. fwd time: 165.1896 / Avg. bwd time: 332.1937 / Avg. batch time: 5055.3841 (ms) / GPU bubble ratio: 21.29%
[rank0]:2025-10-26 18:05:01,414 - INFO - Avg. fwd time: 147.8458 / Avg. bwd time: 297.2233 / Avg. batch time: 5501.3026 (ms) / GPU bubble ratio: 35.28%
[rank0]:2025-10-26 18:11:55,297 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-26 18:12:17,390 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1789  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 18:12:17,390 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-26 18:12:17,389 - INFO -  step: 100  loss:  0.1210  grad_norm:  0.1789  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 18:12:17,389 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-26 18:12:17,384 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1789  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 18:12:17,384 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-26 18:12:17,386 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1789  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 18:12:17,386 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-26 18:14:36,177 - INFO - validate step: 100  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,951
[rank1]:2025-10-26 18:14:36,517 - INFO - validate step: 100  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,944
[rank2]:2025-10-26 18:14:36,858 - INFO - validate step: 100  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,937
[rank3]:2025-10-26 18:14:37,187 - INFO - validate step: 100  loss:  0.2457  memory: 92.28GiB(66.01%)  tps: 2,930
[rank3]:2025-10-26 18:14:37,394 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_1814_real_step100_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.93%, 27.27%, 35.50%, 25.24%
[rank3]:2025-10-26 18:14:41,768 - INFO - Avg. fwd time: 169.0941 / Avg. bwd time: 342.6182 / Avg. batch time: 4113.1087 (ms) / GPU bubble ratio: 0.47%
[rank2]:2025-10-26 18:14:42,068 - INFO - Avg. fwd time: 146.0554 / Avg. bwd time: 295.3964 / Avg. batch time: 4556.5516 (ms) / GPU bubble ratio: 22.49%
[rank1]:2025-10-26 18:14:42,403 - INFO - Avg. fwd time: 165.2782 / Avg. bwd time: 332.3994 / Avg. batch time: 5055.2927 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-26 18:14:42,704 - INFO - Avg. fwd time: 147.9627 / Avg. bwd time: 297.4086 / Avg. batch time: 5501.2155 (ms) / GPU bubble ratio: 35.23%
[rank2]:2025-10-26 18:21:58,698 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1312  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.59  mfu: 3.50%
[rank0]:2025-10-26 18:21:58,704 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1312  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.54  mfu: 3.49%
[rank1]:2025-10-26 18:21:58,700 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1312  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank3]:2025-10-26 18:21:58,703 - INFO -  step: 120  loss:  0.1187  grad_norm:  0.1312  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 18:22:03,279 - INFO - Avg. fwd time: 169.1573 / Avg. bwd time: 342.7611 / Avg. batch time: 4113.0557 (ms) / GPU bubble ratio: 0.43%
[rank2]:2025-10-26 18:22:03,578 - INFO - Avg. fwd time: 146.1160 / Avg. bwd time: 295.5194 / Avg. batch time: 4556.4950 (ms) / GPU bubble ratio: 22.46%
[rank1]:2025-10-26 18:22:03,914 - INFO - Avg. fwd time: 165.3504 / Avg. bwd time: 332.5245 / Avg. batch time: 5055.2334 (ms) / GPU bubble ratio: 21.21%
[rank0]:2025-10-26 18:22:04,215 - INFO - Avg. fwd time: 148.0471 / Avg. bwd time: 297.5331 / Avg. batch time: 5501.1646 (ms) / GPU bubble ratio: 35.20%
[rank1]:2025-10-26 18:29:20,209 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1120  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 18:29:20,212 - INFO -  step: 140  loss:  0.1246  grad_norm:  0.1120  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 18:29:20,207 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1120  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 18:29:20,213 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.1120  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 18:29:24,790 - INFO - Avg. fwd time: 169.2027 / Avg. bwd time: 342.8609 / Avg. batch time: 4113.0009 (ms) / GPU bubble ratio: 0.40%
[rank2]:2025-10-26 18:29:25,089 - INFO - Avg. fwd time: 146.1597 / Avg. bwd time: 295.6127 / Avg. batch time: 4556.4460 (ms) / GPU bubble ratio: 22.44%
[rank1]:2025-10-26 18:29:25,425 - INFO - Avg. fwd time: 165.4242 / Avg. bwd time: 332.6151 / Avg. batch time: 5055.1778 (ms) / GPU bubble ratio: 21.18%
[rank0]:2025-10-26 18:29:25,726 - INFO - Avg. fwd time: 148.1267 / Avg. bwd time: 297.6225 / Avg. batch time: 5501.1155 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-26 18:32:38,923 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-26 18:36:41,819 - INFO -  step: 160  loss:  0.1096  grad_norm:  0.1358  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 18:36:41,814 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1358  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 18:36:41,816 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1358  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 18:36:41,820 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.1358  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 18:36:46,403 - INFO - Avg. fwd time: 169.2455 / Avg. bwd time: 342.9396 / Avg. batch time: 4113.0601 (ms) / GPU bubble ratio: 0.38%
[rank2]:2025-10-26 18:36:46,702 - INFO - Avg. fwd time: 146.1928 / Avg. bwd time: 295.6850 / Avg. batch time: 4556.5108 (ms) / GPU bubble ratio: 22.42%
[rank1]:2025-10-26 18:36:47,038 - INFO - Avg. fwd time: 165.4915 / Avg. bwd time: 332.6969 / Avg. batch time: 5055.2523 (ms) / GPU bubble ratio: 21.16%
[rank0]:2025-10-26 18:36:47,339 - INFO - Avg. fwd time: 148.2014 / Avg. bwd time: 297.6889 / Avg. batch time: 5501.1981 (ms) / GPU bubble ratio: 35.16%
[rank2]:2025-10-26 18:44:03,404 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1191  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 18:44:03,406 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1191  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 18:44:03,410 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.1191  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 18:44:03,409 - INFO -  step: 180  loss:  0.1279  grad_norm:  0.1191  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 18:44:07,989 - INFO - Avg. fwd time: 169.2774 / Avg. bwd time: 342.9988 / Avg. batch time: 4113.0779 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-26 18:44:08,288 - INFO - Avg. fwd time: 146.2188 / Avg. bwd time: 295.7410 / Avg. batch time: 4556.5352 (ms) / GPU bubble ratio: 22.40%
[rank1]:2025-10-26 18:44:08,624 - INFO - Avg. fwd time: 165.5182 / Avg. bwd time: 332.7577 / Avg. batch time: 5055.2785 (ms) / GPU bubble ratio: 21.15%
[rank0]:2025-10-26 18:44:08,925 - INFO - Avg. fwd time: 148.2318 / Avg. bwd time: 297.7410 / Avg. batch time: 5501.2285 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-26 18:51:02,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-26 18:51:24,981 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1236  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 18:51:24,981 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-26 18:51:24,979 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1236  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 18:51:24,979 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-26 18:51:24,985 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1236  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 18:51:24,985 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-26 18:51:24,984 - INFO -  step: 200  loss:  0.1318  grad_norm:  0.1236  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 18:51:24,984 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-26 18:53:42,493 - INFO - validate step: 200  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,979
[rank1]:2025-10-26 18:53:42,835 - INFO - validate step: 200  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,971
[rank2]:2025-10-26 18:53:43,177 - INFO - validate step: 200  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,964
[rank3]:2025-10-26 18:53:43,506 - INFO - validate step: 200  loss:  0.2582  memory: 92.28GiB(66.01%)  tps: 2,957
[rank3]:2025-10-26 18:53:43,705 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_1853_real_step200_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.91%, 27.27%, 35.50%, 25.24%
[rank3]:2025-10-26 18:53:48,089 - INFO - Avg. fwd time: 169.2997 / Avg. bwd time: 343.0469 / Avg. batch time: 4113.0733 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-26 18:53:48,388 - INFO - Avg. fwd time: 146.2396 / Avg. bwd time: 295.7874 / Avg. batch time: 4556.5349 (ms) / GPU bubble ratio: 22.39%
[rank1]:2025-10-26 18:53:48,725 - INFO - Avg. fwd time: 165.5368 / Avg. bwd time: 332.8039 / Avg. batch time: 5055.2809 (ms) / GPU bubble ratio: 21.14%
[rank0]:2025-10-26 18:53:49,026 - INFO - Avg. fwd time: 148.2488 / Avg. bwd time: 297.7827 / Avg. batch time: 5501.2372 (ms) / GPU bubble ratio: 35.14%

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Oct 26 18:56:08 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 2,3,4,5
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/1027_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1026 18:56:09.584000 2480047 site-packages/torch/distributed/run.py:811] 
W1026 18:56:09.584000 2480047 site-packages/torch/distributed/run.py:811] *****************************************
W1026 18:56:09.584000 2480047 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1026 18:56:09.584000 2480047 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-26 18:56:15,253 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-26 18:56:15,409 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-26 18:56:15,433 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-26 18:56:15,482 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-26 18:56:16,221 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-26 18:56:16,224 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 18:56:16,229 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-26 18:56:16,511 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-26 18:56:16,515 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-26 18:56:16,582 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-26 18:56:16,584 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:Traceback (most recent call last):
[rank1]:  File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:  File "<frozen runpy>", line 88, in _run_code
[rank1]:  File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 713, in <module>
[rank1]:    trainer = TrainerWithFreezer(config)
[rank1]:  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:    return f(*args, **kwargs)
[rank1]:  File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 94, in __init__
[rank1]:    device_module.set_device(self.device)
[rank1]:    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
[rank1]:  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/cuda/__init__.py", line 571, in set_device
[rank1]:    torch._C._cuda_setDevice(device)
[rank1]:    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
[rank1]:torch.AcceleratorError: CUDA error: out of memory
[rank1]:Search for `cudaErrorMemoryAllocation' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
[rank1]:CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[rank1]:For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[rank1]:Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[rank1]:
W1026 18:56:18.936000 2480047 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2480135 closing signal SIGTERM
W1026 18:56:18.937000 2480047 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2480137 closing signal SIGTERM
W1026 18:56:18.937000 2480047 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 2480138 closing signal SIGTERM
E1026 18:56:20.927000 2480047 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 1 (pid: 2480136) of binary: /opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/bin/python3.13
E1026 18:56:20.945000 2480047 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_8ugg7j8t/eb9c415f-8778-4afa-86ce-a1bd411f40fd_xwv4z3kc/attempt_0/1/error.json)
Traceback (most recent call last):
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ~~~~^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
    ~~~^^^^^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
    ~~~~~~~~~~~~~~~
        config=config,
        ~~~~~~~~~~~~~~
        entrypoint=cmd,
        ~~~~~~~~~~~~~~~
    )(*cmd_args)
    ~^^^^^^^^^^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
    ...<2 lines>...
    )
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-26_18:56:20
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 2480135)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 2480135
[2]:
  time      : 2025-10-26_18:56:20
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 2 (local_rank: 2)
  exitcode  : -15 (pid: 2480137)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 2480137
[3]:
  time      : 2025-10-26_18:56:20
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 3 (local_rank: 3)
  exitcode  : -15 (pid: 2480138)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 2480138
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-26_18:56:16
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2480136)
  error_file: /tmp/torchelastic_8ugg7j8t/eb9c415f-8778-4afa-86ce-a1bd411f40fd_xwv4z3kc/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 94, in __init__
      device_module.set_device(self.device)
      ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/cuda/__init__.py", line 571, in set_device
      torch._C._cuda_setDevice(device)
      ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  torch.AcceleratorError: CUDA error: out of memory
  Search for `cudaErrorMemoryAllocation' in https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html for more information.
  CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
  For debugging consider passing CUDA_LAUNCH_BLOCKING=1
  Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
  
  
============================================================
[rank2]:2025-10-26 19:03:47,749 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.2930  memory: 71.04GiB(50.81%)  tps: 542  tflops: 25.28  mfu: 2.56%
[rank1]:2025-10-26 19:03:47,754 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.2930  memory: 79.85GiB(57.11%)  tps: 542  tflops: 25.26  mfu: 2.55%
[rank0]:2025-10-26 19:03:47,764 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.2930  memory: 78.87GiB(56.41%)  tps: 541  tflops: 25.25  mfu: 2.55%
[rank3]:2025-10-26 19:03:47,765 - INFO -  step: 220  loss:  0.1523  grad_norm:  0.2930  memory: 92.28GiB(66.01%)  tps: 542  tflops: 25.29  mfu: 2.56%
[rank3]:2025-10-26 19:03:58,068 - INFO - Avg. fwd time: 174.2563 / Avg. bwd time: 353.4907 / Avg. batch time: 4248.4800 (ms) / GPU bubble ratio: 0.62%
[rank2]:2025-10-26 19:03:58,733 - INFO - Avg. fwd time: 151.3694 / Avg. bwd time: 305.2662 / Avg. batch time: 4715.2814 (ms) / GPU bubble ratio: 22.53%
[rank1]:2025-10-26 19:03:59,489 - INFO - Avg. fwd time: 168.7104 / Avg. bwd time: 338.8464 / Avg. batch time: 5233.5307 (ms) / GPU bubble ratio: 22.41%
[rank0]:2025-10-26 19:04:00,163 - INFO - Avg. fwd time: 151.3159 / Avg. bwd time: 304.9768 / Avg. batch time: 5693.5945 (ms) / GPU bubble ratio: 35.89%
[rank1]:2025-10-26 19:13:21,706 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1390  memory: 79.85GiB(57.11%)  tps: 571  tflops: 26.63  mfu: 2.69%
[rank3]:2025-10-26 19:13:21,708 - INFO -  step: 240  loss:  0.1556  grad_norm:  0.1390  memory: 92.28GiB(66.01%)  tps: 571  tflops: 26.63  mfu: 2.69%
[rank0]:2025-10-26 19:13:21,710 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1390  memory: 78.87GiB(56.41%)  tps: 571  tflops: 26.63  mfu: 2.69%
[rank2]:2025-10-26 19:13:21,704 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.1390  memory: 71.04GiB(50.81%)  tps: 571  tflops: 26.63  mfu: 2.69%
[rank3]:2025-10-26 19:13:26,291 - INFO - Avg. fwd time: 175.0785 / Avg. bwd time: 355.4356 / Avg. batch time: 4292.9304 (ms) / GPU bubble ratio: 1.14%
[rank2]:2025-10-26 19:13:26,590 - INFO - Avg. fwd time: 152.1982 / Avg. bwd time: 306.9754 / Avg. batch time: 4784.8934 (ms) / GPU bubble ratio: 23.23%
[rank1]:2025-10-26 19:13:26,927 - INFO - Avg. fwd time: 172.3768 / Avg. bwd time: 346.4151 / Avg. batch time: 5334.7246 (ms) / GPU bubble ratio: 22.20%
[rank0]:2025-10-26 19:13:27,228 - INFO - Avg. fwd time: 155.1453 / Avg. bwd time: 312.3145 / Avg. batch time: 5807.9580 (ms) / GPU bubble ratio: 35.61%
[rank0]:2025-10-26 19:16:40,409 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-26 19:20:43,298 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1374  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 19:20:43,301 - INFO -  step: 260  loss:  0.1274  grad_norm:  0.1374  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 19:20:43,302 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1374  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 19:20:43,295 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1374  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 19:20:47,880 - INFO - Avg. fwd time: 174.6469 / Avg. bwd time: 354.5154 / Avg. batch time: 4279.0553 (ms) / GPU bubble ratio: 1.07%
[rank2]:2025-10-26 19:20:48,180 - INFO - Avg. fwd time: 151.7551 / Avg. bwd time: 306.1496 / Avg. batch time: 4767.2922 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-10-26 19:20:48,516 - INFO - Avg. fwd time: 171.8443 / Avg. bwd time: 345.4085 / Avg. batch time: 5313.2019 (ms) / GPU bubble ratio: 22.12%
[rank0]:2025-10-26 19:20:48,818 - INFO - Avg. fwd time: 154.6135 / Avg. bwd time: 311.2264 / Avg. batch time: 5784.3463 (ms) / GPU bubble ratio: 35.57%
[rank1]:2025-10-26 19:28:04,878 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1253  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 19:28:04,875 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1253  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 19:28:04,880 - INFO -  step: 280  loss:  0.1575  grad_norm:  0.1253  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 19:28:04,882 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1253  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 19:28:09,460 - INFO - Avg. fwd time: 174.2764 / Avg. bwd time: 353.7264 / Avg. batch time: 4267.1591 (ms) / GPU bubble ratio: 1.01%
[rank2]:2025-10-26 19:28:09,759 - INFO - Avg. fwd time: 151.3749 / Avg. bwd time: 305.4419 / Avg. batch time: 4752.2027 (ms) / GPU bubble ratio: 23.10%
[rank1]:2025-10-26 19:28:10,096 - INFO - Avg. fwd time: 171.3838 / Avg. bwd time: 344.5439 / Avg. batch time: 5294.7455 (ms) / GPU bubble ratio: 22.05%
[rank0]:2025-10-26 19:28:10,398 - INFO - Avg. fwd time: 154.1518 / Avg. bwd time: 310.2937 / Avg. batch time: 5764.0981 (ms) / GPU bubble ratio: 35.54%
[rank0]:2025-10-26 19:35:04,372 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-26 19:35:26,465 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0842  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 19:35:26,465 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-26 19:35:26,469 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0842  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 19:35:26,468 - INFO -  step: 300  loss:  0.1115  grad_norm:  0.0842  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 19:35:26,469 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-26 19:35:26,468 - INFO - ðŸ”Ž  Running validation at step 300
[rank2]:2025-10-26 19:35:26,462 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0842  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 19:35:26,463 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-26 19:37:43,955 - INFO - validate step: 300  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,979
[rank1]:2025-10-26 19:37:44,296 - INFO - validate step: 300  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,972
[rank2]:2025-10-26 19:37:44,637 - INFO - validate step: 300  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,964
[rank3]:2025-10-26 19:37:44,966 - INFO - validate step: 300  loss:  0.2564  memory: 92.28GiB(66.01%)  tps: 2,957
[rank3]:2025-10-26 19:37:45,172 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_1937_real_step300_rank3.svg
[rank3]:> Batch Time: 5490.00 ms, GPU Bubble Ratio: 34.91%, 27.27%, 35.50%, 25.25%
[rank3]:2025-10-26 19:37:49,549 - INFO - Avg. fwd time: 173.9562 / Avg. bwd time: 353.0431 / Avg. batch time: 4256.8602 (ms) / GPU bubble ratio: 0.96%
[rank2]:2025-10-26 19:37:49,849 - INFO - Avg. fwd time: 151.0464 / Avg. bwd time: 304.8288 / Avg. batch time: 4739.1348 (ms) / GPU bubble ratio: 23.04%
[rank1]:2025-10-26 19:37:50,185 - INFO - Avg. fwd time: 170.9973 / Avg. bwd time: 343.7900 / Avg. batch time: 5278.7533 (ms) / GPU bubble ratio: 21.98%
[rank0]:2025-10-26 19:37:50,486 - INFO - Avg. fwd time: 153.7653 / Avg. bwd time: 309.4849 / Avg. batch time: 5746.5542 (ms) / GPU bubble ratio: 35.51%
[rank3]:2025-10-26 19:45:06,486 - INFO -  step: 320  loss:  0.1536  grad_norm:  0.1303  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 19:45:06,487 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.54  mfu: 3.49%
[rank2]:2025-10-26 19:45:06,481 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.59  mfu: 3.50%
[rank1]:2025-10-26 19:45:06,483 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1303  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank3]:2025-10-26 19:45:11,066 - INFO - Avg. fwd time: 173.6764 / Avg. bwd time: 352.4446 / Avg. batch time: 4247.8478 (ms) / GPU bubble ratio: 0.92%
[rank2]:2025-10-26 19:45:11,366 - INFO - Avg. fwd time: 150.7581 / Avg. bwd time: 304.2906 / Avg. batch time: 4727.6986 (ms) / GPU bubble ratio: 23.00%
[rank1]:2025-10-26 19:45:11,702 - INFO - Avg. fwd time: 170.6717 / Avg. bwd time: 343.1347 / Avg. batch time: 5264.7670 (ms) / GPU bubble ratio: 21.93%
[rank0]:2025-10-26 19:45:12,004 - INFO - Avg. fwd time: 153.4336 / Avg. bwd time: 308.7774 / Avg. batch time: 5731.2019 (ms) / GPU bubble ratio: 35.48%
[rank0]:2025-10-26 19:52:27,979 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1733  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 19:52:27,973 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1733  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 19:52:27,975 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1733  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 19:52:27,978 - INFO -  step: 340  loss:  0.1493  grad_norm:  0.1733  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 19:52:32,556 - INFO - Avg. fwd time: 173.4283 / Avg. bwd time: 351.9168 / Avg. batch time: 4239.8886 (ms) / GPU bubble ratio: 0.88%
[rank2]:2025-10-26 19:52:32,856 - INFO - Avg. fwd time: 150.5035 / Avg. bwd time: 303.8159 / Avg. batch time: 4717.6020 (ms) / GPU bubble ratio: 22.96%
[rank1]:2025-10-26 19:52:33,193 - INFO - Avg. fwd time: 170.3716 / Avg. bwd time: 342.5565 / Avg. batch time: 5252.4192 (ms) / GPU bubble ratio: 21.88%
[rank0]:2025-10-26 19:52:33,494 - INFO - Avg. fwd time: 153.1268 / Avg. bwd time: 308.1529 / Avg. batch time: 5717.6482 (ms) / GPU bubble ratio: 35.46%
[rank0]:2025-10-26 19:55:46,629 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-26 19:59:49,463 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1078  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 19:59:49,457 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1078  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 19:59:49,462 - INFO -  step: 360  loss:  0.1109  grad_norm:  0.1078  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 19:59:49,459 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1078  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 19:59:54,040 - INFO - Avg. fwd time: 173.2071 / Avg. bwd time: 351.4476 / Avg. batch time: 4232.8090 (ms) / GPU bubble ratio: 0.84%
[rank2]:2025-10-26 19:59:54,340 - INFO - Avg. fwd time: 150.2769 / Avg. bwd time: 303.3923 / Avg. batch time: 4708.6220 (ms) / GPU bubble ratio: 22.92%
[rank1]:2025-10-26 19:59:54,676 - INFO - Avg. fwd time: 170.1016 / Avg. bwd time: 342.0409 / Avg. batch time: 5241.4342 (ms) / GPU bubble ratio: 21.83%
[rank0]:2025-10-26 19:59:54,978 - INFO - Avg. fwd time: 152.8518 / Avg. bwd time: 307.5975 / Avg. batch time: 5705.5909 (ms) / GPU bubble ratio: 35.44%
[rank1]:2025-10-26 20:07:10,922 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0993  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 20:07:10,920 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0993  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 20:07:10,925 - INFO -  step: 380  loss:  0.1138  grad_norm:  0.0993  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 20:07:10,926 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0993  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 20:07:15,504 - INFO - Avg. fwd time: 173.0095 / Avg. bwd time: 351.0275 / Avg. batch time: 4226.4747 (ms) / GPU bubble ratio: 0.81%
[rank2]:2025-10-26 20:07:15,804 - INFO - Avg. fwd time: 150.0742 / Avg. bwd time: 303.0104 / Avg. batch time: 4700.5829 (ms) / GPU bubble ratio: 22.89%
[rank1]:2025-10-26 20:07:16,140 - INFO - Avg. fwd time: 169.8664 / Avg. bwd time: 341.5766 / Avg. batch time: 5231.5981 (ms) / GPU bubble ratio: 21.79%
[rank0]:2025-10-26 20:07:16,442 - INFO - Avg. fwd time: 152.6126 / Avg. bwd time: 307.1006 / Avg. batch time: 5694.7957 (ms) / GPU bubble ratio: 35.42%
[rank0]:2025-10-26 20:14:10,328 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-26 20:14:32,429 - INFO -  step: 400  loss:  0.1074  grad_norm:  0.1162  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 20:14:32,429 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-26 20:14:32,430 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1162  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 20:14:32,430 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-26 20:14:32,426 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1162  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 20:14:32,427 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-26 20:14:32,424 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1162  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 20:14:32,424 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-26 20:16:50,018 - INFO - validate step: 400  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,977
[rank1]:2025-10-26 20:16:50,360 - INFO - validate step: 400  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,970
[rank2]:2025-10-26 20:16:50,699 - INFO - validate step: 400  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,962
[rank3]:2025-10-26 20:16:51,026 - INFO - validate step: 400  loss:  0.2590  memory: 92.28GiB(66.01%)  tps: 2,955
[rank3]:2025-10-26 20:16:51,228 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2016_real_step400_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.91%, 27.27%, 35.50%, 25.24%
[rank3]:2025-10-26 20:16:55,614 - INFO - Avg. fwd time: 172.8334 / Avg. bwd time: 350.6505 / Avg. batch time: 4220.7967 (ms) / GPU bubble ratio: 0.78%
[rank2]:2025-10-26 20:16:55,914 - INFO - Avg. fwd time: 149.8917 / Avg. bwd time: 302.6638 / Avg. batch time: 4693.3681 (ms) / GPU bubble ratio: 22.86%
[rank1]:2025-10-26 20:16:56,251 - INFO - Avg. fwd time: 169.6612 / Avg. bwd time: 341.1581 / Avg. batch time: 5222.7634 (ms) / GPU bubble ratio: 21.75%
[rank0]:2025-10-26 20:16:56,553 - INFO - Avg. fwd time: 152.4011 / Avg. bwd time: 306.6533 / Avg. batch time: 5685.0980 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-26 20:24:12,568 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1311  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.53  mfu: 3.49%
[rank1]:2025-10-26 20:24:12,564 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1311  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank2]:2025-10-26 20:24:12,561 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1311  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.59  mfu: 3.50%
[rank3]:2025-10-26 20:24:12,567 - INFO -  step: 420  loss:  0.1304  grad_norm:  0.1311  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:24:17,145 - INFO - Avg. fwd time: 172.6737 / Avg. bwd time: 350.3080 / Avg. batch time: 4215.6458 (ms) / GPU bubble ratio: 0.75%
[rank2]:2025-10-26 20:24:17,445 - INFO - Avg. fwd time: 149.7267 / Avg. bwd time: 302.3528 / Avg. batch time: 4686.8308 (ms) / GPU bubble ratio: 22.83%
[rank1]:2025-10-26 20:24:17,783 - INFO - Avg. fwd time: 169.4674 / Avg. bwd time: 340.7803 / Avg. batch time: 5214.7624 (ms) / GPU bubble ratio: 21.72%
[rank0]:2025-10-26 20:24:18,085 - INFO - Avg. fwd time: 152.1993 / Avg. bwd time: 306.2487 / Avg. batch time: 5676.3199 (ms) / GPU bubble ratio: 35.39%
[rank1]:2025-10-26 20:31:34,097 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1361  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 20:31:34,094 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1361  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 20:31:34,101 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1361  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:31:34,099 - INFO -  step: 440  loss:  0.1304  grad_norm:  0.1361  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:31:38,679 - INFO - Avg. fwd time: 172.5285 / Avg. bwd time: 349.9971 / Avg. batch time: 4210.9678 (ms) / GPU bubble ratio: 0.73%
[rank2]:2025-10-26 20:31:38,979 - INFO - Avg. fwd time: 149.5767 / Avg. bwd time: 302.0703 / Avg. batch time: 4680.8921 (ms) / GPU bubble ratio: 22.81%
[rank1]:2025-10-26 20:31:39,317 - INFO - Avg. fwd time: 169.2889 / Avg. bwd time: 340.4370 / Avg. batch time: 5207.4935 (ms) / GPU bubble ratio: 21.69%
[rank0]:2025-10-26 20:31:39,619 - INFO - Avg. fwd time: 152.0158 / Avg. bwd time: 305.8807 / Avg. batch time: 5668.3448 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-10-26 20:34:52,799 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-26 20:38:55,626 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0786  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:38:55,624 - INFO -  step: 460  loss:  0.1019  grad_norm:  0.0786  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 20:38:55,622 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0786  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 20:38:55,619 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0786  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:39:00,204 - INFO - Avg. fwd time: 172.3952 / Avg. bwd time: 349.7134 / Avg. batch time: 4206.6910 (ms) / GPU bubble ratio: 0.71%
[rank2]:2025-10-26 20:39:00,505 - INFO - Avg. fwd time: 149.4399 / Avg. bwd time: 301.8137 / Avg. batch time: 4675.4655 (ms) / GPU bubble ratio: 22.79%
[rank1]:2025-10-26 20:39:00,842 - INFO - Avg. fwd time: 169.1281 / Avg. bwd time: 340.1248 / Avg. batch time: 5200.8547 (ms) / GPU bubble ratio: 21.67%
[rank0]:2025-10-26 20:39:01,144 - INFO - Avg. fwd time: 151.8502 / Avg. bwd time: 305.5449 / Avg. batch time: 5661.0592 (ms) / GPU bubble ratio: 35.36%
[rank2]:2025-10-26 20:46:17,158 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1119  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 20:46:17,161 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1119  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 20:46:17,165 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1119  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:46:17,164 - INFO -  step: 480  loss:  0.1130  grad_norm:  0.1119  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:46:21,746 - INFO - Avg. fwd time: 172.2748 / Avg. bwd time: 349.4534 / Avg. batch time: 4202.7863 (ms) / GPU bubble ratio: 0.69%
[rank2]:2025-10-26 20:46:22,047 - INFO - Avg. fwd time: 149.3146 / Avg. bwd time: 301.5794 / Avg. batch time: 4670.5084 (ms) / GPU bubble ratio: 22.77%
[rank1]:2025-10-26 20:46:22,384 - INFO - Avg. fwd time: 168.9872 / Avg. bwd time: 339.8402 / Avg. batch time: 5194.7882 (ms) / GPU bubble ratio: 21.64%
[rank0]:2025-10-26 20:46:22,686 - INFO - Avg. fwd time: 151.7038 / Avg. bwd time: 305.2371 / Avg. batch time: 5654.3985 (ms) / GPU bubble ratio: 35.35%
[rank0]:2025-10-26 20:53:16,594 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-26 20:53:38,687 - INFO -  step: 500  loss:  0.0950  grad_norm:  0.0788  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 20:53:38,687 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-26 20:53:38,684 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0788  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 20:53:38,684 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-26 20:53:38,681 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0788  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 20:53:38,682 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-26 20:53:38,688 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0788  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 20:53:38,688 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-26 20:55:56,159 - INFO - validate step: 500  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,980
[rank0]:2025-10-26 20:55:56,160 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-26 20:55:56,164 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-26 20:55:56,499 - INFO - validate step: 500  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,972
[rank1]:2025-10-26 20:55:56,500 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-26 20:55:56,842 - INFO - validate step: 500  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,965
[rank2]:2025-10-26 20:55:56,843 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-26 20:55:57,170 - INFO - validate step: 500  loss:  0.2577  memory: 92.28GiB(66.01%)  tps: 2,958
[rank3]:2025-10-26 20:55:57,171 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-26 20:56:08,164 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.32 seconds.
[rank1]:2025-10-26 20:56:09,249 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.75 seconds.
[rank3]:2025-10-26 20:56:09,327 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.16 seconds.
[rank0]:2025-10-26 20:56:10,942 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-26 20:56:10,947 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.79 seconds.
[rank3]:2025-10-26 20:56:11,256 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2056_real_step500_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.93%, 27.28%, 35.50%, 25.24%
[rank3]:2025-10-26 20:56:15,579 - INFO - Avg. fwd time: 172.1628 / Avg. bwd time: 349.2144 / Avg. batch time: 4199.1853 (ms) / GPU bubble ratio: 0.67%
[rank2]:2025-10-26 20:56:15,880 - INFO - Avg. fwd time: 149.1994 / Avg. bwd time: 301.3653 / Avg. batch time: 4665.9410 (ms) / GPU bubble ratio: 22.75%
[rank1]:2025-10-26 20:56:16,219 - INFO - Avg. fwd time: 168.8490 / Avg. bwd time: 339.5792 / Avg. batch time: 5189.2016 (ms) / GPU bubble ratio: 21.62%
[rank0]:2025-10-26 20:56:16,523 - INFO - Avg. fwd time: 151.5606 / Avg. bwd time: 304.9540 / Avg. batch time: 5648.2658 (ms) / GPU bubble ratio: 35.34%
[rank0]:2025-10-26 21:03:32,677 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0872  memory: 78.87GiB(56.41%)  tps: 718  tflops: 33.48  mfu: 3.38%
[rank2]:2025-10-26 21:03:32,670 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0872  memory: 71.04GiB(50.81%)  tps: 719  tflops: 33.53  mfu: 3.39%
[rank1]:2025-10-26 21:03:32,672 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0872  memory: 79.85GiB(57.11%)  tps: 718  tflops: 33.50  mfu: 3.39%
[rank3]:2025-10-26 21:03:32,676 - INFO -  step: 520  loss:  0.1324  grad_norm:  0.0872  memory: 92.28GiB(66.01%)  tps: 719  tflops: 33.55  mfu: 3.39%
[rank3]:2025-10-26 21:03:37,257 - INFO - Avg. fwd time: 172.0587 / Avg. bwd time: 348.9933 / Avg. batch time: 4195.8519 (ms) / GPU bubble ratio: 0.65%
[rank2]:2025-10-26 21:03:37,558 - INFO - Avg. fwd time: 149.0929 / Avg. bwd time: 301.1652 / Avg. batch time: 4661.7128 (ms) / GPU bubble ratio: 22.73%
[rank1]:2025-10-26 21:03:37,896 - INFO - Avg. fwd time: 168.7162 / Avg. bwd time: 339.3382 / Avg. batch time: 5184.0331 (ms) / GPU bubble ratio: 21.60%
[rank0]:2025-10-26 21:03:38,200 - INFO - Avg. fwd time: 151.4209 / Avg. bwd time: 304.6931 / Avg. batch time: 5642.5996 (ms) / GPU bubble ratio: 35.33%
[rank0]:2025-10-26 21:10:54,343 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1429  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-26 21:10:54,343 - INFO -  step: 540  loss:  0.1320  grad_norm:  0.1429  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-26 21:10:54,339 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1429  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-26 21:10:54,337 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1429  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-26 21:10:58,923 - INFO - Avg. fwd time: 171.9627 / Avg. bwd time: 348.7886 / Avg. batch time: 4192.7687 (ms) / GPU bubble ratio: 0.64%
[rank2]:2025-10-26 21:10:59,226 - INFO - Avg. fwd time: 148.9946 / Avg. bwd time: 300.9819 / Avg. batch time: 4657.8054 (ms) / GPU bubble ratio: 22.71%
[rank1]:2025-10-26 21:10:59,564 - INFO - Avg. fwd time: 168.5978 / Avg. bwd time: 339.1165 / Avg. batch time: 5179.2576 (ms) / GPU bubble ratio: 21.58%
[rank0]:2025-10-26 21:10:59,867 - INFO - Avg. fwd time: 151.3016 / Avg. bwd time: 304.4515 / Avg. batch time: 5637.3627 (ms) / GPU bubble ratio: 35.32%
[rank0]:2025-10-26 21:14:15,233 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank0]:2025-10-26 21:18:18,153 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1039  memory: 78.87GiB(56.41%)  tps: 738  tflops: 34.44  mfu: 3.48%
[rank3]:2025-10-26 21:18:18,152 - INFO -  step: 560  loss:  0.1331  grad_norm:  0.1039  memory: 92.28GiB(66.01%)  tps: 738  tflops: 34.44  mfu: 3.48%
[rank2]:2025-10-26 21:18:18,146 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1039  memory: 71.04GiB(50.81%)  tps: 738  tflops: 34.44  mfu: 3.48%
[rank1]:2025-10-26 21:18:18,149 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1039  memory: 79.85GiB(57.11%)  tps: 738  tflops: 34.44  mfu: 3.48%
[rank3]:2025-10-26 21:18:22,735 - INFO - Avg. fwd time: 171.8742 / Avg. bwd time: 348.5984 / Avg. batch time: 4189.9107 (ms) / GPU bubble ratio: 0.62%
[rank2]:2025-10-26 21:18:23,036 - INFO - Avg. fwd time: 148.9031 / Avg. bwd time: 300.8107 / Avg. batch time: 4654.1796 (ms) / GPU bubble ratio: 22.70%
[rank1]:2025-10-26 21:18:23,374 - INFO - Avg. fwd time: 168.4937 / Avg. bwd time: 338.9094 / Avg. batch time: 5174.8233 (ms) / GPU bubble ratio: 21.56%
[rank0]:2025-10-26 21:18:23,677 - INFO - Avg. fwd time: 151.1933 / Avg. bwd time: 304.2271 / Avg. batch time: 5632.4984 (ms) / GPU bubble ratio: 35.32%
[rank0]:2025-10-26 21:25:39,735 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1639  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 21:25:39,729 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1639  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 21:25:39,731 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.1639  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:25:39,733 - INFO -  step: 580  loss:  0.1132  grad_norm:  0.1639  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:25:44,313 - INFO - Avg. fwd time: 171.7914 / Avg. bwd time: 348.4215 / Avg. batch time: 4187.2479 (ms) / GPU bubble ratio: 0.61%
[rank2]:2025-10-26 21:25:44,614 - INFO - Avg. fwd time: 148.8178 / Avg. bwd time: 300.6497 / Avg. batch time: 4650.7993 (ms) / GPU bubble ratio: 22.69%
[rank1]:2025-10-26 21:25:44,951 - INFO - Avg. fwd time: 168.3891 / Avg. bwd time: 338.7175 / Avg. batch time: 5170.6907 (ms) / GPU bubble ratio: 21.54%
[rank0]:2025-10-26 21:25:45,254 - INFO - Avg. fwd time: 151.0864 / Avg. bwd time: 304.0180 / Avg. batch time: 5627.9647 (ms) / GPU bubble ratio: 35.31%
[rank0]:2025-10-26 21:32:39,204 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-26 21:33:01,295 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0921  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 21:33:01,295 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-26 21:33:01,297 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0921  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 21:33:01,297 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-26 21:33:01,301 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0921  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 21:33:01,301 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-26 21:33:01,300 - INFO -  step: 600  loss:  0.1184  grad_norm:  0.0921  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:33:01,300 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-26 21:35:18,859 - INFO - validate step: 600  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,978
[rank1]:2025-10-26 21:35:19,198 - INFO - validate step: 600  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,970
[rank2]:2025-10-26 21:35:19,537 - INFO - validate step: 600  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,963
[rank3]:2025-10-26 21:35:19,865 - INFO - validate step: 600  loss:  0.2574  memory: 92.28GiB(66.01%)  tps: 2,956
[rank3]:2025-10-26 21:35:20,066 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2135_real_step600_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.92%, 27.28%, 35.50%, 25.24%
[rank3]:2025-10-26 21:35:24,451 - INFO - Avg. fwd time: 171.7136 / Avg. bwd time: 348.2568 / Avg. batch time: 4184.7615 (ms) / GPU bubble ratio: 0.60%
[rank2]:2025-10-26 21:35:24,752 - INFO - Avg. fwd time: 148.7383 / Avg. bwd time: 300.5004 / Avg. batch time: 4647.6441 (ms) / GPU bubble ratio: 22.67%
[rank1]:2025-10-26 21:35:25,089 - INFO - Avg. fwd time: 168.2873 / Avg. bwd time: 338.5385 / Avg. batch time: 5166.8340 (ms) / GPU bubble ratio: 21.53%
[rank0]:2025-10-26 21:35:25,392 - INFO - Avg. fwd time: 150.9833 / Avg. bwd time: 303.8228 / Avg. batch time: 5623.7325 (ms) / GPU bubble ratio: 35.30%
[rank0]:2025-10-26 21:42:41,448 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1043  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.53  mfu: 3.49%
[rank1]:2025-10-26 21:42:41,444 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1043  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank2]:2025-10-26 21:42:41,442 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1043  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.58  mfu: 3.50%
[rank3]:2025-10-26 21:42:41,447 - INFO -  step: 620  loss:  0.1461  grad_norm:  0.1043  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:42:46,027 - INFO - Avg. fwd time: 171.6411 / Avg. bwd time: 348.1020 / Avg. batch time: 4182.4318 (ms) / GPU bubble ratio: 0.59%
[rank2]:2025-10-26 21:42:46,328 - INFO - Avg. fwd time: 148.6638 / Avg. bwd time: 300.3609 / Avg. batch time: 4644.6888 (ms) / GPU bubble ratio: 22.66%
[rank1]:2025-10-26 21:42:46,666 - INFO - Avg. fwd time: 168.2006 / Avg. bwd time: 338.3696 / Avg. batch time: 5163.2213 (ms) / GPU bubble ratio: 21.51%
[rank0]:2025-10-26 21:42:46,970 - INFO - Avg. fwd time: 150.8918 / Avg. bwd time: 303.6402 / Avg. batch time: 5619.7722 (ms) / GPU bubble ratio: 35.30%
[rank3]:2025-10-26 21:50:03,035 - INFO -  step: 640  loss:  0.1069  grad_norm:  0.0921  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 21:50:03,036 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0921  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 21:50:03,032 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0921  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 21:50:03,030 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0921  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:50:07,618 - INFO - Avg. fwd time: 171.5738 / Avg. bwd time: 347.9572 / Avg. batch time: 4180.2558 (ms) / GPU bubble ratio: 0.57%
[rank2]:2025-10-26 21:50:07,919 - INFO - Avg. fwd time: 148.5941 / Avg. bwd time: 300.2292 / Avg. batch time: 4641.9256 (ms) / GPU bubble ratio: 22.65%
[rank1]:2025-10-26 21:50:08,257 - INFO - Avg. fwd time: 168.1254 / Avg. bwd time: 338.2115 / Avg. batch time: 5159.8418 (ms) / GPU bubble ratio: 21.50%
[rank0]:2025-10-26 21:50:08,560 - INFO - Avg. fwd time: 150.8121 / Avg. bwd time: 303.4689 / Avg. batch time: 5616.0658 (ms) / GPU bubble ratio: 35.29%
[rank0]:2025-10-26 21:53:21,731 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-26 21:57:24,614 - INFO -  step: 660  loss:  0.1126  grad_norm:  0.1180  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 21:57:24,609 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1180  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 21:57:24,612 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1180  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 21:57:24,616 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1180  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 21:57:29,194 - INFO - Avg. fwd time: 171.5105 / Avg. bwd time: 347.8216 / Avg. batch time: 4178.2139 (ms) / GPU bubble ratio: 0.56%
[rank2]:2025-10-26 21:57:29,495 - INFO - Avg. fwd time: 148.5285 / Avg. bwd time: 300.1044 / Avg. batch time: 4639.3311 (ms) / GPU bubble ratio: 22.64%
[rank1]:2025-10-26 21:57:29,833 - INFO - Avg. fwd time: 168.0491 / Avg. bwd time: 338.0617 / Avg. batch time: 5156.6666 (ms) / GPU bubble ratio: 21.48%
[rank0]:2025-10-26 21:57:30,136 - INFO - Avg. fwd time: 150.7306 / Avg. bwd time: 303.3080 / Avg. batch time: 5612.5820 (ms) / GPU bubble ratio: 35.28%
[rank1]:2025-10-26 22:04:46,210 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0821  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 22:04:46,207 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0821  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 22:04:46,214 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0821  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:04:46,212 - INFO -  step: 680  loss:  0.1202  grad_norm:  0.0821  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:04:50,794 - INFO - Avg. fwd time: 171.4503 / Avg. bwd time: 347.6938 / Avg. batch time: 4176.2868 (ms) / GPU bubble ratio: 0.55%
[rank2]:2025-10-26 22:04:51,095 - INFO - Avg. fwd time: 148.4668 / Avg. bwd time: 299.9877 / Avg. batch time: 4636.8847 (ms) / GPU bubble ratio: 22.63%
[rank1]:2025-10-26 22:04:51,433 - INFO - Avg. fwd time: 167.9736 / Avg. bwd time: 337.9214 / Avg. batch time: 5153.6759 (ms) / GPU bubble ratio: 21.47%
[rank0]:2025-10-26 22:04:51,737 - INFO - Avg. fwd time: 150.6527 / Avg. bwd time: 303.1568 / Avg. batch time: 5609.3019 (ms) / GPU bubble ratio: 35.28%
[rank0]:2025-10-26 22:11:45,723 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-26 22:12:07,814 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0879  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 22:12:07,814 - INFO - ðŸ”Ž  Running validation at step 700
[rank1]:2025-10-26 22:12:07,816 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0879  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:12:07,816 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-26 22:12:07,819 - INFO -  step: 700  loss:  0.1106  grad_norm:  0.0879  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:12:07,819 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-26 22:12:07,820 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0879  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 22:12:07,820 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-26 22:14:25,353 - INFO - validate step: 700  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,978
[rank1]:2025-10-26 22:14:25,692 - INFO - validate step: 700  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,971
[rank2]:2025-10-26 22:14:26,036 - INFO - validate step: 700  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,963
[rank3]:2025-10-26 22:14:26,366 - INFO - validate step: 700  loss:  0.2535  memory: 92.28GiB(66.01%)  tps: 2,956
[rank3]:2025-10-26 22:14:26,572 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2214_real_step700_rank3.svg
[rank3]:> Batch Time: 5490.00 ms, GPU Bubble Ratio: 34.92%, 27.28%, 35.50%, 25.25%
[rank3]:2025-10-26 22:14:30,955 - INFO - Avg. fwd time: 171.3938 / Avg. bwd time: 347.5732 / Avg. batch time: 4174.4710 (ms) / GPU bubble ratio: 0.54%
[rank2]:2025-10-26 22:14:31,256 - INFO - Avg. fwd time: 148.4085 / Avg. bwd time: 299.8771 / Avg. batch time: 4634.5786 (ms) / GPU bubble ratio: 22.62%
[rank1]:2025-10-26 22:14:31,594 - INFO - Avg. fwd time: 167.9048 / Avg. bwd time: 337.7892 / Avg. batch time: 5150.8550 (ms) / GPU bubble ratio: 21.46%
[rank0]:2025-10-26 22:14:31,897 - INFO - Avg. fwd time: 150.5819 / Avg. bwd time: 303.0141 / Avg. batch time: 5606.2079 (ms) / GPU bubble ratio: 35.27%
[rank3]:2025-10-26 22:21:47,950 - INFO -  step: 720  loss:  0.1846  grad_norm:  0.1479  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:21:47,947 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1479  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank2]:2025-10-26 22:21:47,945 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1479  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.58  mfu: 3.50%
[rank0]:2025-10-26 22:21:47,951 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1479  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.53  mfu: 3.49%
[rank3]:2025-10-26 22:21:52,534 - INFO - Avg. fwd time: 171.3406 / Avg. bwd time: 347.4594 / Avg. batch time: 4172.7585 (ms) / GPU bubble ratio: 0.54%
[rank2]:2025-10-26 22:21:52,836 - INFO - Avg. fwd time: 148.3537 / Avg. bwd time: 299.7724 / Avg. batch time: 4632.4032 (ms) / GPU bubble ratio: 22.61%
[rank1]:2025-10-26 22:21:53,174 - INFO - Avg. fwd time: 167.8413 / Avg. bwd time: 337.6643 / Avg. batch time: 5148.1952 (ms) / GPU bubble ratio: 21.45%
[rank0]:2025-10-26 22:21:53,478 - INFO - Avg. fwd time: 150.5155 / Avg. bwd time: 302.8793 / Avg. batch time: 5603.2894 (ms) / GPU bubble ratio: 35.27%
[rank0]:2025-10-26 22:29:09,470 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1000  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:29:09,468 - INFO -  step: 740  loss:  0.1290  grad_norm:  0.1000  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:29:09,466 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1000  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 22:29:09,463 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.1000  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:29:14,047 - INFO - Avg. fwd time: 171.2896 / Avg. bwd time: 347.3517 / Avg. batch time: 4171.1315 (ms) / GPU bubble ratio: 0.53%
[rank2]:2025-10-26 22:29:14,350 - INFO - Avg. fwd time: 148.3018 / Avg. bwd time: 299.6734 / Avg. batch time: 4630.3372 (ms) / GPU bubble ratio: 22.60%
[rank1]:2025-10-26 22:29:14,688 - INFO - Avg. fwd time: 167.7770 / Avg. bwd time: 337.5469 / Avg. batch time: 5145.6711 (ms) / GPU bubble ratio: 21.44%
[rank0]:2025-10-26 22:29:14,991 - INFO - Avg. fwd time: 150.4475 / Avg. bwd time: 302.7519 / Avg. batch time: 5600.5197 (ms) / GPU bubble ratio: 35.26%
[rank0]:2025-10-26 22:32:28,137 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-26 22:36:31,006 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0921  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:36:31,009 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0921  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 22:36:31,013 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0921  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:36:31,011 - INFO -  step: 760  loss:  0.1174  grad_norm:  0.0921  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:36:35,591 - INFO - Avg. fwd time: 171.2419 / Avg. bwd time: 347.2491 / Avg. batch time: 4169.5917 (ms) / GPU bubble ratio: 0.52%
[rank2]:2025-10-26 22:36:35,894 - INFO - Avg. fwd time: 148.2523 / Avg. bwd time: 299.5810 / Avg. batch time: 4628.3835 (ms) / GPU bubble ratio: 22.59%
[rank1]:2025-10-26 22:36:36,232 - INFO - Avg. fwd time: 167.7207 / Avg. bwd time: 337.4332 / Avg. batch time: 5143.2818 (ms) / GPU bubble ratio: 21.43%
[rank0]:2025-10-26 22:36:36,535 - INFO - Avg. fwd time: 150.3935 / Avg. bwd time: 302.6309 / Avg. batch time: 5597.8991 (ms) / GPU bubble ratio: 35.26%
[rank3]:2025-10-26 22:43:52,554 - INFO -  step: 780  loss:  0.1276  grad_norm:  0.1199  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:43:52,551 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1199  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 22:43:52,548 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1199  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 22:43:52,555 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1199  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:43:57,136 - INFO - Avg. fwd time: 171.1966 / Avg. bwd time: 347.1521 / Avg. batch time: 4168.1327 (ms) / GPU bubble ratio: 0.51%
[rank2]:2025-10-26 22:43:57,438 - INFO - Avg. fwd time: 148.2055 / Avg. bwd time: 299.4939 / Avg. batch time: 4626.5335 (ms) / GPU bubble ratio: 22.59%
[rank1]:2025-10-26 22:43:57,777 - INFO - Avg. fwd time: 167.6714 / Avg. bwd time: 337.3259 / Avg. batch time: 5141.0194 (ms) / GPU bubble ratio: 21.42%
[rank0]:2025-10-26 22:43:58,080 - INFO - Avg. fwd time: 150.3472 / Avg. bwd time: 302.5161 / Avg. batch time: 5595.4164 (ms) / GPU bubble ratio: 35.25%
[rank0]:2025-10-26 22:50:52,033 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-26 22:51:14,139 - INFO -  step: 800  loss:  0.1038  grad_norm:  0.0984  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 22:51:14,139 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-26 22:51:14,136 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0984  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 22:51:14,136 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-26 22:51:14,134 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0984  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 22:51:14,134 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-26 22:51:14,140 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0984  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 22:51:14,140 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-26 22:53:31,582 - INFO - validate step: 800  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,980
[rank1]:2025-10-26 22:53:31,922 - INFO - validate step: 800  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,973
[rank2]:2025-10-26 22:53:32,264 - INFO - validate step: 800  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,965
[rank3]:2025-10-26 22:53:32,590 - INFO - validate step: 800  loss:  0.2546  memory: 92.28GiB(66.01%)  tps: 2,958
[rank3]:2025-10-26 22:53:32,798 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2253_real_step800_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.92%, 27.28%, 35.50%, 25.25%
[rank3]:2025-10-26 22:53:37,184 - INFO - Avg. fwd time: 171.1545 / Avg. bwd time: 347.0601 / Avg. batch time: 4166.7552 (ms) / GPU bubble ratio: 0.50%
[rank2]:2025-10-26 22:53:37,486 - INFO - Avg. fwd time: 148.1611 / Avg. bwd time: 299.4113 / Avg. batch time: 4624.7847 (ms) / GPU bubble ratio: 22.58%
[rank1]:2025-10-26 22:53:37,824 - INFO - Avg. fwd time: 167.6276 / Avg. bwd time: 337.2243 / Avg. batch time: 5138.8779 (ms) / GPU bubble ratio: 21.41%
[rank0]:2025-10-26 22:53:38,127 - INFO - Avg. fwd time: 150.3067 / Avg. bwd time: 302.4070 / Avg. batch time: 5593.0647 (ms) / GPU bubble ratio: 35.25%
[rank3]:2025-10-26 22:57:44,641 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 22:57:45,848 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 22:57:46,184 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 22:57:46,484 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 23:00:54,758 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1006  memory: 79.85GiB(57.11%)  tps: 740  tflops: 34.51  mfu: 3.49%
[rank2]:2025-10-26 23:00:54,755 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1006  memory: 71.04GiB(50.81%)  tps: 741  tflops: 34.54  mfu: 3.49%
[rank0]:2025-10-26 23:00:54,762 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1006  memory: 78.87GiB(56.41%)  tps: 739  tflops: 34.49  mfu: 3.49%
[rank3]:2025-10-26 23:00:54,760 - INFO -  step: 820  loss:  0.1273  grad_norm:  0.1006  memory: 92.28GiB(66.01%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank3]:2025-10-26 23:00:59,341 - INFO - Avg. fwd time: 171.1138 / Avg. bwd time: 346.9728 / Avg. batch time: 4165.4418 (ms) / GPU bubble ratio: 0.50%
[rank2]:2025-10-26 23:00:59,643 - INFO - Avg. fwd time: 148.1187 / Avg. bwd time: 299.3325 / Avg. batch time: 4623.1177 (ms) / GPU bubble ratio: 22.57%
[rank1]:2025-10-26 23:00:59,981 - INFO - Avg. fwd time: 167.5774 / Avg. bwd time: 337.1274 / Avg. batch time: 5136.8369 (ms) / GPU bubble ratio: 21.40%
[rank0]:2025-10-26 23:01:00,285 - INFO - Avg. fwd time: 150.2579 / Avg. bwd time: 302.3032 / Avg. batch time: 5590.8231 (ms) / GPU bubble ratio: 35.24%
[rank1]:2025-10-26 23:08:16,273 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1118  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 23:08:16,271 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1118  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-26 23:08:16,277 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1118  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:08:16,276 - INFO -  step: 840  loss:  0.1203  grad_norm:  0.1118  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:08:20,857 - INFO - Avg. fwd time: 171.0746 / Avg. bwd time: 346.8895 / Avg. batch time: 4164.1858 (ms) / GPU bubble ratio: 0.49%
[rank2]:2025-10-26 23:08:21,160 - INFO - Avg. fwd time: 148.0784 / Avg. bwd time: 299.2568 / Avg. batch time: 4621.5240 (ms) / GPU bubble ratio: 22.56%
[rank1]:2025-10-26 23:08:21,498 - INFO - Avg. fwd time: 167.5263 / Avg. bwd time: 337.0367 / Avg. batch time: 5134.8892 (ms) / GPU bubble ratio: 21.39%
[rank0]:2025-10-26 23:08:21,801 - INFO - Avg. fwd time: 150.2095 / Avg. bwd time: 302.2044 / Avg. batch time: 5588.6845 (ms) / GPU bubble ratio: 35.24%
[rank0]:2025-10-26 23:11:34,989 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-26 23:15:37,834 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1037  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 23:15:37,832 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1037  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 23:15:37,838 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1037  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 23:15:37,837 - INFO -  step: 860  loss:  0.1098  grad_norm:  0.1037  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 23:15:42,418 - INFO - Avg. fwd time: 171.0370 / Avg. bwd time: 346.8101 / Avg. batch time: 4162.9867 (ms) / GPU bubble ratio: 0.49%
[rank2]:2025-10-26 23:15:42,720 - INFO - Avg. fwd time: 148.0399 / Avg. bwd time: 299.1854 / Avg. batch time: 4620.0033 (ms) / GPU bubble ratio: 22.56%
[rank1]:2025-10-26 23:15:43,058 - INFO - Avg. fwd time: 167.4803 / Avg. bwd time: 336.9494 / Avg. batch time: 5133.0291 (ms) / GPU bubble ratio: 21.38%
[rank0]:2025-10-26 23:15:43,362 - INFO - Avg. fwd time: 150.1662 / Avg. bwd time: 302.1101 / Avg. batch time: 5586.6444 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-26 23:22:59,423 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0798  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 23:22:59,419 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0798  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 23:22:59,416 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0798  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 23:22:59,421 - INFO -  step: 880  loss:  0.0839  grad_norm:  0.0798  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-26 23:23:04,006 - INFO - Avg. fwd time: 171.0015 / Avg. bwd time: 346.7344 / Avg. batch time: 4161.8458 (ms) / GPU bubble ratio: 0.48%
[rank2]:2025-10-26 23:23:04,309 - INFO - Avg. fwd time: 148.0033 / Avg. bwd time: 299.1168 / Avg. batch time: 4618.5550 (ms) / GPU bubble ratio: 22.55%
[rank1]:2025-10-26 23:23:04,647 - INFO - Avg. fwd time: 167.4383 / Avg. bwd time: 336.8666 / Avg. batch time: 5131.2583 (ms) / GPU bubble ratio: 21.38%
[rank0]:2025-10-26 23:23:04,952 - INFO - Avg. fwd time: 150.1271 / Avg. bwd time: 302.0202 / Avg. batch time: 5584.7017 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-26 23:29:58,847 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-26 23:30:20,935 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1149  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-26 23:30:20,935 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-26 23:30:20,933 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1149  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-26 23:30:20,933 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-26 23:30:20,937 - INFO -  step: 900  loss:  0.1087  grad_norm:  0.1149  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:30:20,938 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-26 23:30:20,939 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1149  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-26 23:30:20,939 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-26 23:32:38,413 - INFO - validate step: 900  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,979
[rank1]:2025-10-26 23:32:38,753 - INFO - validate step: 900  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,972
[rank2]:2025-10-26 23:32:39,098 - INFO - validate step: 900  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,965
[rank3]:2025-10-26 23:32:39,423 - INFO - validate step: 900  loss:  0.2534  memory: 92.28GiB(66.01%)  tps: 2,958
[rank3]:2025-10-26 23:32:39,624 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251026_2332_real_step900_rank3.svg
[rank3]:> Batch Time: 5489.88 ms, GPU Bubble Ratio: 34.92%, 27.28%, 35.50%, 25.25%
[rank3]:2025-10-26 23:32:44,014 - INFO - Avg. fwd time: 170.9670 / Avg. bwd time: 346.6618 / Avg. batch time: 4160.7493 (ms) / GPU bubble ratio: 0.47%
[rank2]:2025-10-26 23:32:44,317 - INFO - Avg. fwd time: 147.9683 / Avg. bwd time: 299.0517 / Avg. batch time: 4617.1648 (ms) / GPU bubble ratio: 22.55%
[rank1]:2025-10-26 23:32:44,655 - INFO - Avg. fwd time: 167.3917 / Avg. bwd time: 336.7875 / Avg. batch time: 5129.5593 (ms) / GPU bubble ratio: 21.37%
[rank0]:2025-10-26 23:32:44,958 - INFO - Avg. fwd time: 150.0818 / Avg. bwd time: 301.9341 / Avg. batch time: 5582.8360 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-26 23:40:00,929 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1016  memory: 78.87GiB(56.41%)  tps: 740  tflops: 34.54  mfu: 3.49%
[rank1]:2025-10-26 23:40:00,925 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1016  memory: 79.85GiB(57.11%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank2]:2025-10-26 23:40:00,923 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1016  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.59  mfu: 3.50%
[rank3]:2025-10-26 23:40:00,928 - INFO -  step: 920  loss:  0.1128  grad_norm:  0.1016  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:40:05,508 - INFO - Avg. fwd time: 170.9336 / Avg. bwd time: 346.5923 / Avg. batch time: 4159.6971 (ms) / GPU bubble ratio: 0.47%
[rank2]:2025-10-26 23:40:05,811 - INFO - Avg. fwd time: 147.9350 / Avg. bwd time: 298.9884 / Avg. batch time: 4615.8308 (ms) / GPU bubble ratio: 22.54%
[rank1]:2025-10-26 23:40:06,150 - INFO - Avg. fwd time: 167.3449 / Avg. bwd time: 336.7123 / Avg. batch time: 5127.9307 (ms) / GPU bubble ratio: 21.36%
[rank0]:2025-10-26 23:40:06,453 - INFO - Avg. fwd time: 150.0370 / Avg. bwd time: 301.8520 / Avg. batch time: 5581.0487 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-26 23:47:22,416 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1143  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 23:47:22,410 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1143  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 23:47:22,412 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1143  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:47:22,415 - INFO -  step: 940  loss:  0.0954  grad_norm:  0.1143  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:47:26,995 - INFO - Avg. fwd time: 170.9015 / Avg. bwd time: 346.5256 / Avg. batch time: 4158.6869 (ms) / GPU bubble ratio: 0.46%
[rank2]:2025-10-26 23:47:27,297 - INFO - Avg. fwd time: 147.9030 / Avg. bwd time: 298.9269 / Avg. batch time: 4614.5498 (ms) / GPU bubble ratio: 22.54%
[rank1]:2025-10-26 23:47:27,636 - INFO - Avg. fwd time: 167.3012 / Avg. bwd time: 336.6400 / Avg. batch time: 5126.3673 (ms) / GPU bubble ratio: 21.36%
[rank0]:2025-10-26 23:47:27,939 - INFO - Avg. fwd time: 149.9951 / Avg. bwd time: 301.7734 / Avg. batch time: 5579.3338 (ms) / GPU bubble ratio: 35.22%
[rank0]:2025-10-26 23:50:41,086 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-26 23:54:43,916 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0992  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:54:43,917 - INFO -  step: 960  loss:  0.0820  grad_norm:  0.0992  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-26 23:54:43,910 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0992  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-26 23:54:43,912 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0992  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-26 23:54:48,496 - INFO - Avg. fwd time: 170.8708 / Avg. bwd time: 346.4618 / Avg. batch time: 4157.7210 (ms) / GPU bubble ratio: 0.46%
[rank2]:2025-10-26 23:54:48,799 - INFO - Avg. fwd time: 147.8724 / Avg. bwd time: 298.8682 / Avg. batch time: 4613.3249 (ms) / GPU bubble ratio: 22.53%
[rank1]:2025-10-26 23:54:49,138 - INFO - Avg. fwd time: 167.2621 / Avg. bwd time: 336.5711 / Avg. batch time: 5124.8723 (ms) / GPU bubble ratio: 21.35%
[rank0]:2025-10-26 23:54:49,442 - INFO - Avg. fwd time: 149.9563 / Avg. bwd time: 301.6983 / Avg. batch time: 5577.6940 (ms) / GPU bubble ratio: 35.22%
[rank1]:2025-10-27 00:02:05,411 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0798  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-27 00:02:05,414 - INFO -  step: 980  loss:  0.0880  grad_norm:  0.0798  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-27 00:02:05,409 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0798  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-27 00:02:05,415 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0798  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-27 00:02:09,996 - INFO - Avg. fwd time: 170.8413 / Avg. bwd time: 346.4007 / Avg. batch time: 4156.7938 (ms) / GPU bubble ratio: 0.45%
[rank2]:2025-10-27 00:02:10,298 - INFO - Avg. fwd time: 147.8429 / Avg. bwd time: 298.8114 / Avg. batch time: 4612.1486 (ms) / GPU bubble ratio: 22.53%
[rank1]:2025-10-27 00:02:10,637 - INFO - Avg. fwd time: 167.2211 / Avg. bwd time: 336.5049 / Avg. batch time: 5123.4372 (ms) / GPU bubble ratio: 21.35%
[rank0]:2025-10-27 00:02:10,941 - INFO - Avg. fwd time: 149.9159 / Avg. bwd time: 301.6261 / Avg. batch time: 5576.1193 (ms) / GPU bubble ratio: 35.22%
[rank0]:2025-10-27 00:09:04,815 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 00:09:26,903 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0873  memory: 79.85GiB(57.11%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank1]:2025-10-27 00:09:26,903 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0873  tps: 746  tflops: 34.78  mfu: 3.43%
[rank1]:2025-10-27 00:09:26,903 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 00:09:26,906 - INFO -  step: 1000  loss:  0.0972  grad_norm:  0.0873  memory: 92.28GiB(66.01%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank3]:2025-10-27 00:09:26,907 - INFO -  final step: 1000  loss:  0.0972  grad_norm:  0.0873  tps: 746  tflops: 34.79  mfu: 3.43%
[rank3]:2025-10-27 00:09:26,908 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 00:09:26,907 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0873  memory: 78.87GiB(56.41%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank0]:2025-10-27 00:09:26,908 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0873  tps: 746  tflops: 34.77  mfu: 3.43%
[rank0]:2025-10-27 00:09:26,908 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 00:09:26,901 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0873  memory: 71.04GiB(50.81%)  tps: 742  tflops: 34.62  mfu: 3.50%
[rank2]:2025-10-27 00:09:26,901 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0873  tps: 746  tflops: 34.78  mfu: 3.43%
[rank2]:2025-10-27 00:09:26,901 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 00:11:44,251 - INFO - validate step: 1000  loss: -1.0000  memory: 78.87GiB(56.41%)  tps: 2,982
[rank0]:2025-10-27 00:11:44,252 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 00:11:44,256 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 00:11:44,592 - INFO - validate step: 1000  loss: -1.0000  memory: 79.85GiB(57.11%)  tps: 2,975
[rank1]:2025-10-27 00:11:44,593 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 00:11:44,596 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 00:11:44,931 - INFO - validate step: 1000  loss: -1.0000  memory: 71.04GiB(50.81%)  tps: 2,967
[rank2]:2025-10-27 00:11:44,932 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 00:11:44,935 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 00:11:45,257 - INFO - validate step: 1000  loss:  0.2532  memory: 92.28GiB(66.01%)  tps: 2,961
[rank3]:2025-10-27 00:11:45,258 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 00:11:45,261 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 00:11:56,854 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-27 00:11:56,866 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-27 00:11:56,866 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 00:11:56,866 - INFO - Destroying the purge thread.
[rank3]:2025-10-27 00:11:57,059 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251027_0011_real_final1000_rank3.svg
[rank3]:> Batch Time: 5489.75 ms, GPU Bubble Ratio: 34.93%, 27.29%, 35.50%, 25.24%
[rank3]:2025-10-27 00:11:57,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1/pipeline_schedule/251027_0011_thry_final1000_rank3.svg
[rank3]:> Batch Time: 5192.99 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 00:11:57,248 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–„â–„â–…â–„â–„â–ƒâ–„â–„â–†â–†â–†â–†â–†â–ƒâ–ƒâ–„â–„â–‚â–ƒâ–‚â–„â–„â–ƒâ–ƒâ–…â–ƒâ–„â–ƒâ–ˆâ–„â–„â–‚â–„â–„â–ƒâ–ƒâ–ƒâ–‚â–â–‚
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 21.96506
[rank3]:wandb:               final/avg_loss 0.09717
[rank3]:wandb:             final/avg_mfu(%) 3.43481
[rank3]:wandb:             final/avg_tflops 34.78945
[rank3]:wandb:    final/avg_throughput(tps) 745.91198
[rank3]:wandb:              final/grad_norm 0.08733
[rank3]:wandb:               final/max_loss 0.09717
[rank3]:wandb:                    grad_norm 0.08733
[rank3]:wandb: loss_metrics/global_avg_loss 0.09717
[rank3]:wandb: loss_metrics/global_max_loss 0.09717
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1027_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/pw63cggg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1027_GPipe_nofreeze_dm1/20251026-1735/wandb/run-20251026_173513-pw63cggg/logs
[rank0]:2025-10-27 00:11:58,866 - INFO - Training completed
[rank0]:2025-10-27 00:11:58,867 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 00:11:59,109 - INFO - Process group destroyed
[rank3]:2025-10-27 00:11:59,113 - INFO - Process group destroyed
[rank2]:2025-10-27 00:11:59,129 - INFO - Process group destroyed
[rank0]:2025-10-27 00:11:59,418 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.2', 'layers.4', 'layers.7', 'layers.0', 'layers.6', 'layers.5', 'layers.3', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.15', 'layers.14', 'layers.13', 'layers.11', 'layers.8', 'layers.16', 'layers.12', 'layers.9', 'layers.10'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.20', 'layers.22', 'layers.18', 'layers.23', 'layers.24', 'layers.17', 'layers.19'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'output', 'layers.26', 'layers.28', 'norm', 'layers.27', 'layers.30', 'layers.25', 'layers.31'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1027_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1027_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1027_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1027_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_GPipe_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1027_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
