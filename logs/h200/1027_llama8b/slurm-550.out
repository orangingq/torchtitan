âœ”ï¸ SLURM JOB GPUS: 0,1,2,7
âœ”ï¸ Using Slurm-assigned GPU(s): 0,1,2,7

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Mon Oct 27 07:46:55 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/1027_1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1027 07:46:56.205000 3098786 site-packages/torch/distributed/run.py:811] 
W1027 07:46:56.205000 3098786 site-packages/torch/distributed/run.py:811] *****************************************
W1027 07:46:56.205000 3098786 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1027 07:46:56.205000 3098786 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-27 07:47:02,154 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 07:47:02,111 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 07:47:02,197 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 07:47:02,400 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 07:47:03,071 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 07:47:03,074 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 07:47:03,080 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-27 07:47:03,221 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 07:47:03,224 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-27 07:47:03,202 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 07:47:03,205 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-27 07:47:03,430 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 07:47:03,432 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 07:47:04,829 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 07:47:05,113 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 07:47:06,742 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-27 07:47:07,018 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-27 07:47:06,994 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-27 07:47:07,001 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-27 07:47:07,122 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-27 07:47:07,123 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-27 07:47:07,100 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-27 07:47:07,100 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-27 07:47:07,088 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-27 07:47:07,111 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-27 07:47:07,111 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 07:47:07,428 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-27 07:47:07,428 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-27 07:47:07,475 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-27 07:47:07,475 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-27 07:47:07,478 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-27 07:47:07,479 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run k6druhak
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_1F1B_nofreeze_dm1/20251027-0747/wandb/run-20251027_074707-k6druhak
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_1F1B_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k6druhak
[rank3]:2025-10-27 07:47:08,810 - INFO - WandB logging enabled
[rank3]:2025-10-27 07:47:08,811 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-27 07:47:08,885 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-27 07:47:08,885 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-27 07:47:09,141 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_1F1B_nofreeze_dm1
[rank0]:2025-10-27 07:47:09,141 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 07:47:09,141 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 07:47:09,141 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-27 07:47:09,093 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-27 07:47:09,093 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-27 07:47:12,686 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 07:47:12,687 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-27 07:47:22,282 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-27 07:47:22,282 - INFO - Finished loading the checkpoint in 9.60 seconds.
[rank0]:2025-10-27 07:47:22,282 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank2]:2025-10-27 07:47:46,320 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 26.61GiB(19.03%)  tps: 417  tflops: 19.47  mfu: 1.97%
[rank2]:2025-10-27 07:47:46,320 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-27 07:47:46,304 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 34.42GiB(24.62%)  tps: 418  tflops: 19.49  mfu: 1.97%
[rank1]:2025-10-27 07:47:46,304 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 07:47:46,323 - INFO -  step:  1  loss: -4.0000  grad_norm: 613.1230  memory: 39.86GiB(28.51%)  tps: 418  tflops: 19.48  mfu: 1.97%
[rank0]:2025-10-27 07:47:46,323 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 07:47:46,330 - INFO -  step:  1  loss:  4.0063  grad_norm: 613.1230  memory: 38.77GiB(27.73%)  tps: 437  tflops: 20.39  mfu: 2.06%
[rank3]:2025-10-27 07:47:46,331 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 07:48:24,030 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,031 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,031 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,031 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,031 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,032 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,032 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,032 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,032 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,032 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 07:48:24,033 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,331 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 07:48:24,332 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,667 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:48:24,668 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,967 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,968 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 07:48:24,969 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 07:54:45,882 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 07:54:45,886 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 07:54:45,880 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.3757  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-27 07:54:45,885 - INFO -  step: 20  loss:  0.1266  grad_norm:  0.3757  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-27 07:54:50,464 - INFO - Avg. fwd time: 167.3698 / Avg. bwd time: 339.2870 / Avg. batch time: 4114.4549 (ms) / GPU bubble ratio: 1.49%
[rank2]:2025-10-27 07:54:50,763 - INFO - Avg. fwd time: 144.6886 / Avg. bwd time: 292.4157 / Avg. batch time: 4557.9067 (ms) / GPU bubble ratio: 23.28%
[rank1]:2025-10-27 07:54:51,098 - INFO - Avg. fwd time: 162.7717 / Avg. bwd time: 329.0709 / Avg. batch time: 5056.6623 (ms) / GPU bubble ratio: 22.19%
[rank0]:2025-10-27 07:54:51,399 - INFO - Avg. fwd time: 144.7810 / Avg. bwd time: 294.3758 / Avg. batch time: 5502.5262 (ms) / GPU bubble ratio: 36.15%
[rank3]:2025-10-27 08:02:07,534 - INFO -  step: 40  loss:  0.1271  grad_norm:  0.2752  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 08:02:07,531 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2752  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:02:07,529 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2752  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 08:02:07,535 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.2752  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:02:12,113 - INFO - Avg. fwd time: 168.4132 / Avg. bwd time: 341.3998 / Avg. batch time: 4114.5309 (ms) / GPU bubble ratio: 0.88%
[rank2]:2025-10-27 08:02:12,412 - INFO - Avg. fwd time: 145.5824 / Avg. bwd time: 294.2286 / Avg. batch time: 4557.9965 (ms) / GPU bubble ratio: 22.81%
[rank1]:2025-10-27 08:02:12,747 - INFO - Avg. fwd time: 163.7941 / Avg. bwd time: 331.1239 / Avg. batch time: 5056.7713 (ms) / GPU bubble ratio: 21.70%
[rank0]:2025-10-27 08:02:13,048 - INFO - Avg. fwd time: 145.6798 / Avg. bwd time: 296.2146 / Avg. batch time: 5502.6330 (ms) / GPU bubble ratio: 35.76%
[rank0]:2025-10-27 08:05:26,257 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 08:09:29,166 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1330  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-27 08:09:29,170 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1330  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-27 08:09:29,164 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.1330  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-27 08:09:29,168 - INFO -  step: 60  loss:  0.1360  grad_norm:  0.1330  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-27 08:09:33,748 - INFO - Avg. fwd time: 168.7652 / Avg. bwd time: 342.1107 / Avg. batch time: 4114.5723 (ms) / GPU bubble ratio: 0.67%
[rank2]:2025-10-27 08:09:34,047 - INFO - Avg. fwd time: 145.8781 / Avg. bwd time: 294.8249 / Avg. batch time: 4558.0330 (ms) / GPU bubble ratio: 22.65%
[rank1]:2025-10-27 08:09:34,382 - INFO - Avg. fwd time: 164.1333 / Avg. bwd time: 331.8109 / Avg. batch time: 5056.8092 (ms) / GPU bubble ratio: 21.54%
[rank0]:2025-10-27 08:09:34,683 - INFO - Avg. fwd time: 145.9729 / Avg. bwd time: 296.8296 / Avg. batch time: 5502.6477 (ms) / GPU bubble ratio: 35.62%
[rank0]:2025-10-27 08:16:50,823 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2076  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:16:50,821 - INFO -  step: 80  loss:  0.1212  grad_norm:  0.2076  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:16:50,817 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2076  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 08:16:50,819 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.2076  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:16:55,402 - INFO - Avg. fwd time: 168.9415 / Avg. bwd time: 342.4696 / Avg. batch time: 4114.6102 (ms) / GPU bubble ratio: 0.57%
[rank2]:2025-10-27 08:16:55,701 - INFO - Avg. fwd time: 146.0238 / Avg. bwd time: 295.1199 / Avg. batch time: 4558.0629 (ms) / GPU bubble ratio: 22.57%
[rank1]:2025-10-27 08:16:56,036 - INFO - Avg. fwd time: 164.3029 / Avg. bwd time: 332.1542 / Avg. batch time: 5056.8456 (ms) / GPU bubble ratio: 21.46%
[rank0]:2025-10-27 08:16:56,337 - INFO - Avg. fwd time: 146.1222 / Avg. bwd time: 297.1392 / Avg. batch time: 5502.6780 (ms) / GPU bubble ratio: 35.56%
[rank0]:2025-10-27 08:23:50,384 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 08:24:12,486 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1476  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 08:24:12,487 - INFO - ðŸ”Ž  Running validation at step 100
[rank3]:2025-10-27 08:24:12,484 - INFO -  step: 100  loss:  0.1226  grad_norm:  0.1476  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:24:12,485 - INFO - ðŸ”Ž  Running validation at step 100
[rank1]:2025-10-27 08:24:12,482 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1476  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 08:24:12,483 - INFO - ðŸ”Ž  Running validation at step 100
[rank2]:2025-10-27 08:24:12,480 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.1476  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:24:12,481 - INFO - ðŸ”Ž  Running validation at step 100
[rank0]:2025-10-27 08:26:31,040 - INFO - validate step: 100  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,956
[rank1]:2025-10-27 08:26:31,380 - INFO - validate step: 100  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,949
[rank2]:2025-10-27 08:26:31,719 - INFO - validate step: 100  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,942
[rank3]:2025-10-27 08:26:32,048 - INFO - validate step: 100  loss:  0.2379  memory: 52.47GiB(37.53%)  tps: 2,935
[rank3]:2025-10-27 08:26:32,266 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_0826_real_step100_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 08:26:36,633 - INFO - Avg. fwd time: 169.0475 / Avg. bwd time: 342.6820 / Avg. batch time: 4114.6069 (ms) / GPU bubble ratio: 0.50%
[rank2]:2025-10-27 08:26:36,933 - INFO - Avg. fwd time: 146.1131 / Avg. bwd time: 295.2975 / Avg. batch time: 4558.0561 (ms) / GPU bubble ratio: 22.53%
[rank1]:2025-10-27 08:26:37,270 - INFO - Avg. fwd time: 164.4059 / Avg. bwd time: 332.3599 / Avg. batch time: 5056.8436 (ms) / GPU bubble ratio: 21.41%
[rank0]:2025-10-27 08:26:37,571 - INFO - Avg. fwd time: 146.2118 / Avg. bwd time: 297.3260 / Avg. batch time: 5502.6813 (ms) / GPU bubble ratio: 35.52%
[rank0]:2025-10-27 08:33:53,734 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1259  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank3]:2025-10-27 08:33:53,732 - INFO -  step: 120  loss:  0.1189  grad_norm:  0.1259  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 08:33:53,730 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1259  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank2]:2025-10-27 08:33:53,727 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1259  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.58  mfu: 3.50%
[rank3]:2025-10-27 08:33:58,311 - INFO - Avg. fwd time: 169.1168 / Avg. bwd time: 342.8232 / Avg. batch time: 4114.5886 (ms) / GPU bubble ratio: 0.46%
[rank2]:2025-10-27 08:33:58,610 - INFO - Avg. fwd time: 146.1713 / Avg. bwd time: 295.4166 / Avg. batch time: 4558.0365 (ms) / GPU bubble ratio: 22.50%
[rank1]:2025-10-27 08:33:58,946 - INFO - Avg. fwd time: 164.4723 / Avg. bwd time: 332.4948 / Avg. batch time: 5056.8261 (ms) / GPU bubble ratio: 21.38%
[rank0]:2025-10-27 08:33:59,247 - INFO - Avg. fwd time: 146.2716 / Avg. bwd time: 297.4497 / Avg. batch time: 5502.6647 (ms) / GPU bubble ratio: 35.49%
[rank0]:2025-10-27 08:41:15,402 - INFO -  step: 140  loss: -4.0000  grad_norm: 160.0450  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:41:15,400 - INFO -  step: 140  loss:  3.7628  grad_norm: 160.0450  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:41:15,396 - INFO -  step: 140  loss: -4.0000  grad_norm: 160.0450  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 08:41:15,398 - INFO -  step: 140  loss: -4.0000  grad_norm: 160.0450  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:41:19,981 - INFO - Avg. fwd time: 169.1672 / Avg. bwd time: 342.9246 / Avg. batch time: 4114.5862 (ms) / GPU bubble ratio: 0.43%
[rank2]:2025-10-27 08:41:20,280 - INFO - Avg. fwd time: 146.2111 / Avg. bwd time: 295.4988 / Avg. batch time: 4558.0279 (ms) / GPU bubble ratio: 22.47%
[rank1]:2025-10-27 08:41:20,616 - INFO - Avg. fwd time: 164.5200 / Avg. bwd time: 332.5909 / Avg. batch time: 5056.8175 (ms) / GPU bubble ratio: 21.36%
[rank0]:2025-10-27 08:41:20,917 - INFO - Avg. fwd time: 146.3146 / Avg. bwd time: 297.5393 / Avg. batch time: 5502.6573 (ms) / GPU bubble ratio: 35.47%
[rank0]:2025-10-27 08:44:34,135 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 08:48:37,065 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2686  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:48:37,063 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2686  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 08:48:37,069 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.2686  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:48:37,067 - INFO -  step: 160  loss:  0.1114  grad_norm:  0.2686  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:48:41,648 - INFO - Avg. fwd time: 169.2049 / Avg. bwd time: 343.0002 / Avg. batch time: 4114.5799 (ms) / GPU bubble ratio: 0.41%
[rank2]:2025-10-27 08:48:41,948 - INFO - Avg. fwd time: 146.2427 / Avg. bwd time: 295.5614 / Avg. batch time: 4558.0190 (ms) / GPU bubble ratio: 22.46%
[rank1]:2025-10-27 08:48:42,284 - INFO - Avg. fwd time: 164.5551 / Avg. bwd time: 332.6616 / Avg. batch time: 5056.8080 (ms) / GPU bubble ratio: 21.34%
[rank0]:2025-10-27 08:48:42,585 - INFO - Avg. fwd time: 146.3474 / Avg. bwd time: 297.6061 / Avg. batch time: 5502.6498 (ms) / GPU bubble ratio: 35.46%
[rank1]:2025-10-27 08:55:58,722 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.5600  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 08:55:58,719 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.5600  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 08:55:58,726 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.5600  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:55:58,724 - INFO -  step: 180  loss:  0.1351  grad_norm:  0.5600  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 08:56:03,306 - INFO - Avg. fwd time: 169.2340 / Avg. bwd time: 343.0586 / Avg. batch time: 4114.5688 (ms) / GPU bubble ratio: 0.39%
[rank2]:2025-10-27 08:56:03,606 - INFO - Avg. fwd time: 146.2664 / Avg. bwd time: 295.6093 / Avg. batch time: 4558.0126 (ms) / GPU bubble ratio: 22.44%
[rank1]:2025-10-27 08:56:03,942 - INFO - Avg. fwd time: 164.5823 / Avg. bwd time: 332.7171 / Avg. batch time: 5056.7990 (ms) / GPU bubble ratio: 21.33%
[rank0]:2025-10-27 08:56:04,243 - INFO - Avg. fwd time: 146.3726 / Avg. bwd time: 297.6579 / Avg. batch time: 5502.6381 (ms) / GPU bubble ratio: 35.44%
[rank0]:2025-10-27 09:02:58,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 09:03:20,365 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7827  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 09:03:20,365 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 09:03:20,371 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7827  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 09:03:20,371 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-27 09:03:20,367 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7827  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 09:03:20,367 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-27 09:03:20,370 - INFO -  step: 200  loss:  0.1358  grad_norm:  0.7827  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:03:20,371 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-27 09:05:37,717 - INFO - validate step: 200  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,982
[rank1]:2025-10-27 09:05:38,059 - INFO - validate step: 200  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,975
[rank2]:2025-10-27 09:05:38,397 - INFO - validate step: 200  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,967
[rank3]:2025-10-27 09:05:38,725 - INFO - validate step: 200  loss:  0.2635  memory: 52.47GiB(37.53%)  tps: 2,961
[rank3]:2025-10-27 09:05:38,924 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_0905_real_step200_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 09:05:43,311 - INFO - Avg. fwd time: 169.2567 / Avg. bwd time: 343.1048 / Avg. batch time: 4114.5516 (ms) / GPU bubble ratio: 0.38%
[rank2]:2025-10-27 09:05:43,611 - INFO - Avg. fwd time: 146.2845 / Avg. bwd time: 295.6474 / Avg. batch time: 4557.9960 (ms) / GPU bubble ratio: 22.43%
[rank1]:2025-10-27 09:05:43,947 - INFO - Avg. fwd time: 164.6040 / Avg. bwd time: 332.7614 / Avg. batch time: 5056.7791 (ms) / GPU bubble ratio: 21.32%
[rank0]:2025-10-27 09:05:44,248 - INFO - Avg. fwd time: 146.3927 / Avg. bwd time: 297.6993 / Avg. batch time: 5502.6175 (ms) / GPU bubble ratio: 35.44%
[rank0]:2025-10-27 09:13:00,376 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3728  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.53  mfu: 3.49%
[rank3]:2025-10-27 09:13:00,375 - INFO -  step: 220  loss:  0.1466  grad_norm:  0.3728  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 09:13:00,370 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3728  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.58  mfu: 3.50%
[rank1]:2025-10-27 09:13:00,372 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3728  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank3]:2025-10-27 09:13:04,955 - INFO - Avg. fwd time: 169.2751 / Avg. bwd time: 343.1430 / Avg. batch time: 4114.5396 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-27 09:13:05,254 - INFO - Avg. fwd time: 146.2975 / Avg. bwd time: 295.6764 / Avg. batch time: 4557.9788 (ms) / GPU bubble ratio: 22.43%
[rank1]:2025-10-27 09:13:05,590 - INFO - Avg. fwd time: 164.6206 / Avg. bwd time: 332.7965 / Avg. batch time: 5056.7622 (ms) / GPU bubble ratio: 21.31%
[rank0]:2025-10-27 09:13:05,892 - INFO - Avg. fwd time: 146.4105 / Avg. bwd time: 297.7337 / Avg. batch time: 5502.5999 (ms) / GPU bubble ratio: 35.43%
[rank3]:2025-10-27 09:20:22,010 - INFO -  step: 240  loss:  0.1568  grad_norm:  0.2622  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank0]:2025-10-27 09:20:22,011 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.2622  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank2]:2025-10-27 09:20:22,005 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.2622  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank1]:2025-10-27 09:20:22,007 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.2622  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.61  mfu: 3.50%
[rank3]:2025-10-27 09:20:26,591 - INFO - Avg. fwd time: 169.2905 / Avg. bwd time: 343.1745 / Avg. batch time: 4114.5264 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-27 09:20:26,890 - INFO - Avg. fwd time: 146.3109 / Avg. bwd time: 295.7062 / Avg. batch time: 4557.9642 (ms) / GPU bubble ratio: 22.42%
[rank1]:2025-10-27 09:20:27,226 - INFO - Avg. fwd time: 164.6362 / Avg. bwd time: 332.8277 / Avg. batch time: 5056.7474 (ms) / GPU bubble ratio: 21.30%
[rank0]:2025-10-27 09:20:27,528 - INFO - Avg. fwd time: 146.4260 / Avg. bwd time: 297.7613 / Avg. batch time: 5502.5880 (ms) / GPU bubble ratio: 35.42%
[rank0]:2025-10-27 09:23:40,749 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 09:27:43,694 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3309  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 09:27:43,696 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3309  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:27:43,699 - INFO -  step: 260  loss:  0.1325  grad_norm:  0.3309  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 09:27:43,700 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.3309  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:27:48,280 - INFO - Avg. fwd time: 169.3033 / Avg. bwd time: 343.2012 / Avg. batch time: 4114.5139 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-27 09:27:48,580 - INFO - Avg. fwd time: 146.3263 / Avg. bwd time: 295.7367 / Avg. batch time: 4557.9542 (ms) / GPU bubble ratio: 22.41%
[rank1]:2025-10-27 09:27:48,916 - INFO - Avg. fwd time: 164.6512 / Avg. bwd time: 332.8570 / Avg. batch time: 5056.7408 (ms) / GPU bubble ratio: 21.29%
[rank0]:2025-10-27 09:27:49,218 - INFO - Avg. fwd time: 146.4400 / Avg. bwd time: 297.7841 / Avg. batch time: 5502.5858 (ms) / GPU bubble ratio: 35.42%
[rank1]:2025-10-27 09:35:05,370 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2278  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 09:35:05,367 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2278  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:35:05,373 - INFO -  step: 280  loss:  0.1609  grad_norm:  0.2278  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 09:35:05,374 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.2278  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:35:09,953 - INFO - Avg. fwd time: 169.3145 / Avg. bwd time: 343.2245 / Avg. batch time: 4114.5089 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-27 09:35:10,253 - INFO - Avg. fwd time: 146.3391 / Avg. bwd time: 295.7631 / Avg. batch time: 4557.9545 (ms) / GPU bubble ratio: 22.40%
[rank1]:2025-10-27 09:35:10,589 - INFO - Avg. fwd time: 164.6642 / Avg. bwd time: 332.8822 / Avg. batch time: 5056.7444 (ms) / GPU bubble ratio: 21.29%
[rank0]:2025-10-27 09:35:10,890 - INFO - Avg. fwd time: 146.4513 / Avg. bwd time: 297.8036 / Avg. batch time: 5502.5923 (ms) / GPU bubble ratio: 35.41%
[rank0]:2025-10-27 09:42:04,934 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-27 09:42:27,030 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.4240  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 09:42:27,030 - INFO - ðŸ”Ž  Running validation at step 300
[rank1]:2025-10-27 09:42:27,032 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.4240  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 09:42:27,033 - INFO - ðŸ”Ž  Running validation at step 300
[rank3]:2025-10-27 09:42:27,035 - INFO -  step: 300  loss:  0.1213  grad_norm:  2.4240  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:42:27,035 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 09:42:27,036 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.4240  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 09:42:27,037 - INFO - ðŸ”Ž  Running validation at step 300
[rank0]:2025-10-27 09:44:44,291 - INFO - validate step: 300  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,984
[rank1]:2025-10-27 09:44:44,632 - INFO - validate step: 300  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,977
[rank2]:2025-10-27 09:44:44,972 - INFO - validate step: 300  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,969
[rank3]:2025-10-27 09:44:45,298 - INFO - validate step: 300  loss:  0.2772  memory: 52.47GiB(37.53%)  tps: 2,962
[rank3]:2025-10-27 09:44:45,494 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_0944_real_step300_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 09:44:49,883 - INFO - Avg. fwd time: 169.3239 / Avg. bwd time: 343.2440 / Avg. batch time: 4114.4963 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-27 09:44:50,182 - INFO - Avg. fwd time: 146.3511 / Avg. bwd time: 295.7861 / Avg. batch time: 4557.9428 (ms) / GPU bubble ratio: 22.40%
[rank1]:2025-10-27 09:44:50,519 - INFO - Avg. fwd time: 164.6760 / Avg. bwd time: 332.9044 / Avg. batch time: 5056.7334 (ms) / GPU bubble ratio: 21.28%
[rank0]:2025-10-27 09:44:50,821 - INFO - Avg. fwd time: 146.4625 / Avg. bwd time: 297.8206 / Avg. batch time: 5502.5851 (ms) / GPU bubble ratio: 35.41%
[rank3]:2025-10-27 09:52:06,967 - INFO -  step: 320  loss:  0.1542  grad_norm:  0.2422  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 09:52:06,969 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2422  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank1]:2025-10-27 09:52:06,965 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2422  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank2]:2025-10-27 09:52:06,963 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.2422  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.58  mfu: 3.50%
[rank3]:2025-10-27 09:52:11,548 - INFO - Avg. fwd time: 169.3323 / Avg. bwd time: 343.2611 / Avg. batch time: 4114.4870 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-27 09:52:11,848 - INFO - Avg. fwd time: 146.3608 / Avg. bwd time: 295.8031 / Avg. batch time: 4557.9326 (ms) / GPU bubble ratio: 22.39%
[rank1]:2025-10-27 09:52:12,185 - INFO - Avg. fwd time: 164.6855 / Avg. bwd time: 332.9225 / Avg. batch time: 5056.7247 (ms) / GPU bubble ratio: 21.28%
[rank0]:2025-10-27 09:52:12,486 - INFO - Avg. fwd time: 146.4720 / Avg. bwd time: 297.8358 / Avg. batch time: 5502.5796 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-27 09:59:28,649 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1846  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 09:59:28,645 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1846  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 09:59:28,643 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.1846  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:59:28,647 - INFO -  step: 340  loss:  0.1533  grad_norm:  0.1846  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 09:59:33,227 - INFO - Avg. fwd time: 169.3399 / Avg. bwd time: 343.2768 / Avg. batch time: 4114.4849 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-27 09:59:33,527 - INFO - Avg. fwd time: 146.3662 / Avg. bwd time: 295.8144 / Avg. batch time: 4557.9288 (ms) / GPU bubble ratio: 22.39%
[rank1]:2025-10-27 09:59:33,864 - INFO - Avg. fwd time: 164.6926 / Avg. bwd time: 332.9363 / Avg. batch time: 5056.7186 (ms) / GPU bubble ratio: 21.27%
[rank0]:2025-10-27 09:59:34,165 - INFO - Avg. fwd time: 146.4781 / Avg. bwd time: 297.8497 / Avg. batch time: 5502.5722 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-27 10:02:47,380 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 10:06:50,302 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1462  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:06:50,298 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1462  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 10:06:50,296 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.1462  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:06:50,300 - INFO -  step: 360  loss:  0.1133  grad_norm:  0.1462  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:06:54,881 - INFO - Avg. fwd time: 169.3464 / Avg. bwd time: 343.2901 / Avg. batch time: 4114.4755 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-27 10:06:55,181 - INFO - Avg. fwd time: 146.3699 / Avg. bwd time: 295.8232 / Avg. batch time: 4557.9162 (ms) / GPU bubble ratio: 22.39%
[rank1]:2025-10-27 10:06:55,518 - INFO - Avg. fwd time: 164.6984 / Avg. bwd time: 332.9485 / Avg. batch time: 5056.7052 (ms) / GPU bubble ratio: 21.27%
[rank0]:2025-10-27 10:06:55,820 - INFO - Avg. fwd time: 146.4834 / Avg. bwd time: 297.8621 / Avg. batch time: 5502.5570 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-27 10:14:11,963 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1830  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 10:14:11,957 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1830  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:14:11,959 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.1830  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:14:11,962 - INFO -  step: 380  loss:  0.1178  grad_norm:  0.1830  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:14:16,544 - INFO - Avg. fwd time: 169.3523 / Avg. bwd time: 343.3023 / Avg. batch time: 4114.4707 (ms) / GPU bubble ratio: 0.32%
[rank2]:2025-10-27 10:14:16,844 - INFO - Avg. fwd time: 146.3751 / Avg. bwd time: 295.8323 / Avg. batch time: 4557.9119 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 10:14:17,180 - INFO - Avg. fwd time: 164.7038 / Avg. bwd time: 332.9597 / Avg. batch time: 5056.7006 (ms) / GPU bubble ratio: 21.27%
[rank0]:2025-10-27 10:14:17,482 - INFO - Avg. fwd time: 146.4881 / Avg. bwd time: 297.8730 / Avg. batch time: 5502.5519 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-27 10:21:11,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 10:21:33,636 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1840  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 10:21:33,636 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-27 10:21:33,632 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1840  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:21:33,632 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-27 10:21:33,630 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1840  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 10:21:33,630 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-27 10:21:33,634 - INFO -  step: 400  loss:  0.1049  grad_norm:  0.1840  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:21:33,635 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-27 10:23:50,994 - INFO - validate step: 400  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,982
[rank1]:2025-10-27 10:23:51,333 - INFO - validate step: 400  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,975
[rank2]:2025-10-27 10:23:51,673 - INFO - validate step: 400  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,967
[rank3]:2025-10-27 10:23:52,001 - INFO - validate step: 400  loss:  0.2679  memory: 52.47GiB(37.53%)  tps: 2,960
[rank3]:2025-10-27 10:23:52,201 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1023_real_step400_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 10:23:56,588 - INFO - Avg. fwd time: 169.3581 / Avg. bwd time: 343.3136 / Avg. batch time: 4114.4720 (ms) / GPU bubble ratio: 0.32%
[rank2]:2025-10-27 10:23:56,888 - INFO - Avg. fwd time: 146.3798 / Avg. bwd time: 295.8409 / Avg. batch time: 4557.9141 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 10:23:57,226 - INFO - Avg. fwd time: 164.7090 / Avg. bwd time: 332.9703 / Avg. batch time: 5056.7031 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 10:23:57,527 - INFO - Avg. fwd time: 146.4925 / Avg. bwd time: 297.8828 / Avg. batch time: 5502.5547 (ms) / GPU bubble ratio: 35.39%
[rank3]:2025-10-27 10:31:13,716 - INFO -  step: 420  loss:  0.1342  grad_norm:  0.1746  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 10:31:13,718 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1746  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank2]:2025-10-27 10:31:13,712 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1746  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.57  mfu: 3.50%
[rank1]:2025-10-27 10:31:13,714 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.1746  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank3]:2025-10-27 10:31:18,297 - INFO - Avg. fwd time: 169.3630 / Avg. bwd time: 343.3233 / Avg. batch time: 4114.4678 (ms) / GPU bubble ratio: 0.32%
[rank2]:2025-10-27 10:31:18,598 - INFO - Avg. fwd time: 146.3847 / Avg. bwd time: 295.8492 / Avg. batch time: 4557.9108 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 10:31:18,935 - INFO - Avg. fwd time: 164.7139 / Avg. bwd time: 332.9800 / Avg. batch time: 5056.7015 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 10:31:19,237 - INFO - Avg. fwd time: 146.4965 / Avg. bwd time: 297.8915 / Avg. batch time: 5502.5540 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 10:38:35,415 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1985  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:38:35,411 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1985  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 10:38:35,409 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.1985  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:38:35,414 - INFO -  step: 440  loss:  0.1320  grad_norm:  0.1985  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:38:39,996 - INFO - Avg. fwd time: 169.3678 / Avg. bwd time: 343.3327 / Avg. batch time: 4114.4696 (ms) / GPU bubble ratio: 0.31%
[rank2]:2025-10-27 10:38:40,297 - INFO - Avg. fwd time: 146.3890 / Avg. bwd time: 295.8571 / Avg. batch time: 4557.9141 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 10:38:40,634 - INFO - Avg. fwd time: 164.7180 / Avg. bwd time: 332.9884 / Avg. batch time: 5056.7043 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 10:38:40,937 - INFO - Avg. fwd time: 146.4998 / Avg. bwd time: 297.8992 / Avg. batch time: 5502.5572 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 10:41:54,174 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 10:45:57,105 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1478  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:45:57,107 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1478  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:45:57,110 - INFO -  step: 460  loss:  0.1033  grad_norm:  0.1478  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 10:45:57,111 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.1478  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:46:01,693 - INFO - Avg. fwd time: 169.3721 / Avg. bwd time: 343.3418 / Avg. batch time: 4114.4757 (ms) / GPU bubble ratio: 0.31%
[rank2]:2025-10-27 10:46:01,993 - INFO - Avg. fwd time: 146.3927 / Avg. bwd time: 295.8636 / Avg. batch time: 4557.9214 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 10:46:02,331 - INFO - Avg. fwd time: 164.7218 / Avg. bwd time: 332.9963 / Avg. batch time: 5056.7112 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 10:46:02,633 - INFO - Avg. fwd time: 146.5028 / Avg. bwd time: 297.9065 / Avg. batch time: 5502.5643 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 10:53:18,817 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1633  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:53:18,815 - INFO -  step: 480  loss:  0.1164  grad_norm:  0.1633  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 10:53:18,813 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1633  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 10:53:18,811 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.1633  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 10:53:23,398 - INFO - Avg. fwd time: 169.3761 / Avg. bwd time: 343.3499 / Avg. batch time: 4114.4799 (ms) / GPU bubble ratio: 0.31%
[rank2]:2025-10-27 10:53:23,698 - INFO - Avg. fwd time: 146.3963 / Avg. bwd time: 295.8701 / Avg. batch time: 4557.9265 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 10:53:24,036 - INFO - Avg. fwd time: 164.7253 / Avg. bwd time: 333.0035 / Avg. batch time: 5056.7179 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 10:53:24,338 - INFO - Avg. fwd time: 146.5057 / Avg. bwd time: 297.9133 / Avg. batch time: 5502.5725 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 11:00:18,401 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-27 11:00:40,502 - INFO -  step: 500  loss:  0.0961  grad_norm:  0.1831  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:00:40,503 - INFO - ðŸ”Ž  Running validation at step 500
[rank1]:2025-10-27 11:00:40,500 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1831  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 11:00:40,500 - INFO - ðŸ”Ž  Running validation at step 500
[rank2]:2025-10-27 11:00:40,497 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1831  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 11:00:40,498 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 11:00:40,504 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1831  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 11:00:40,504 - INFO - ðŸ”Ž  Running validation at step 500
[rank0]:2025-10-27 11:02:57,726 - INFO - validate step: 500  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,985
[rank0]:2025-10-27 11:02:57,727 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 11:02:57,731 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-27 11:02:58,067 - INFO - validate step: 500  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,977
[rank1]:2025-10-27 11:02:58,068 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 11:02:58,407 - INFO - validate step: 500  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,970
[rank2]:2025-10-27 11:02:58,408 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 11:02:58,734 - INFO - validate step: 500  loss:  0.2735  memory: 52.47GiB(37.53%)  tps: 2,963
[rank3]:2025-10-27 11:02:58,735 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 11:03:11,473 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-27 11:03:11,478 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.75 seconds.
[rank2]:2025-10-27 11:03:12,023 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.62 seconds.
[rank3]:2025-10-27 11:03:13,622 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.89 seconds.
[rank1]:2025-10-27 11:03:13,746 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.68 seconds.
[rank3]:2025-10-27 11:03:14,052 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1103_real_step500_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 11:03:18,956 - INFO - Avg. fwd time: 169.3799 / Avg. bwd time: 343.3926 / Avg. batch time: 4114.7666 (ms) / GPU bubble ratio: 0.31%
[rank2]:2025-10-27 11:03:19,257 - INFO - Avg. fwd time: 146.4000 / Avg. bwd time: 295.8765 / Avg. batch time: 4558.2122 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 11:03:19,595 - INFO - Avg. fwd time: 164.7286 / Avg. bwd time: 333.0101 / Avg. batch time: 5057.0045 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 11:03:19,898 - INFO - Avg. fwd time: 146.5084 / Avg. bwd time: 297.9194 / Avg. batch time: 5502.8620 (ms) / GPU bubble ratio: 35.39%
[rank3]:2025-10-27 11:10:36,083 - INFO -  step: 520  loss:  0.1345  grad_norm:  0.1321  memory: 52.47GiB(37.53%)  tps: 716  tflops: 33.42  mfu: 3.38%
[rank0]:2025-10-27 11:10:36,084 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1321  memory: 56.85GiB(40.66%)  tps: 715  tflops: 33.34  mfu: 3.37%
[rank2]:2025-10-27 11:10:36,078 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1321  memory: 38.19GiB(27.32%)  tps: 716  tflops: 33.39  mfu: 3.38%
[rank1]:2025-10-27 11:10:36,080 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.1321  memory: 48.97GiB(35.03%)  tps: 715  tflops: 33.37  mfu: 3.37%
[rank3]:2025-10-27 11:10:40,664 - INFO - Avg. fwd time: 169.3833 / Avg. bwd time: 343.3980 / Avg. batch time: 4114.7582 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:10:40,965 - INFO - Avg. fwd time: 146.4022 / Avg. bwd time: 295.8810 / Avg. batch time: 4558.2035 (ms) / GPU bubble ratio: 22.38%
[rank1]:2025-10-27 11:10:41,304 - INFO - Avg. fwd time: 164.7314 / Avg. bwd time: 333.0164 / Avg. batch time: 5056.9973 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 11:10:41,608 - INFO - Avg. fwd time: 146.5107 / Avg. bwd time: 297.9252 / Avg. batch time: 5502.8566 (ms) / GPU bubble ratio: 35.39%
[rank1]:2025-10-27 11:17:57,819 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1597  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 11:17:57,817 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1597  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:17:57,822 - INFO -  step: 540  loss:  0.1317  grad_norm:  0.1597  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 11:17:57,823 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.1597  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:18:02,405 - INFO - Avg. fwd time: 169.3865 / Avg. bwd time: 343.4030 / Avg. batch time: 4114.7510 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:18:02,706 - INFO - Avg. fwd time: 146.4054 / Avg. bwd time: 295.8866 / Avg. batch time: 4558.1999 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:18:03,044 - INFO - Avg. fwd time: 164.7342 / Avg. bwd time: 333.0229 / Avg. batch time: 5056.9949 (ms) / GPU bubble ratio: 21.26%
[rank0]:2025-10-27 11:18:03,347 - INFO - Avg. fwd time: 146.5132 / Avg. bwd time: 297.9307 / Avg. batch time: 5502.8575 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 11:21:18,255 - INFO - [GC] Peforming periodical GC collection 1.65 seconds
[rank2]:2025-10-27 11:25:21,169 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1549  memory: 38.19GiB(27.32%)  tps: 739  tflops: 34.47  mfu: 3.49%
[rank1]:2025-10-27 11:25:21,171 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1549  memory: 48.97GiB(35.03%)  tps: 739  tflops: 34.47  mfu: 3.49%
[rank3]:2025-10-27 11:25:21,173 - INFO -  step: 560  loss:  0.1341  grad_norm:  0.1549  memory: 52.47GiB(37.53%)  tps: 739  tflops: 34.47  mfu: 3.49%
[rank0]:2025-10-27 11:25:21,175 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.1549  memory: 56.85GiB(40.66%)  tps: 739  tflops: 34.47  mfu: 3.49%
[rank3]:2025-10-27 11:25:25,756 - INFO - Avg. fwd time: 169.3894 / Avg. bwd time: 343.4078 / Avg. batch time: 4114.7441 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:25:26,057 - INFO - Avg. fwd time: 146.4085 / Avg. bwd time: 295.8920 / Avg. batch time: 4558.1945 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:25:26,394 - INFO - Avg. fwd time: 164.7370 / Avg. bwd time: 333.0291 / Avg. batch time: 5056.9912 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 11:25:26,698 - INFO - Avg. fwd time: 146.5152 / Avg. bwd time: 297.9356 / Avg. batch time: 5502.8558 (ms) / GPU bubble ratio: 35.39%
[rank1]:2025-10-27 11:32:42,838 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.2249  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 11:32:42,836 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.2249  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 11:32:42,842 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.2249  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:32:42,841 - INFO -  step: 580  loss:  0.1146  grad_norm:  0.2249  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:32:47,422 - INFO - Avg. fwd time: 169.3920 / Avg. bwd time: 343.4120 / Avg. batch time: 4114.7357 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:32:47,723 - INFO - Avg. fwd time: 146.4114 / Avg. bwd time: 295.8970 / Avg. batch time: 4558.1871 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:32:48,061 - INFO - Avg. fwd time: 164.7398 / Avg. bwd time: 333.0347 / Avg. batch time: 5056.9843 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 11:32:48,363 - INFO - Avg. fwd time: 146.5173 / Avg. bwd time: 297.9400 / Avg. batch time: 5502.8494 (ms) / GPU bubble ratio: 35.39%
[rank0]:2025-10-27 11:39:42,419 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 11:40:04,517 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1183  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 11:40:04,517 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-27 11:40:04,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1183  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 11:40:04,515 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 11:40:04,521 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1183  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 11:40:04,521 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-27 11:40:04,520 - INFO -  step: 600  loss:  0.1195  grad_norm:  0.1183  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:40:04,521 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-27 11:42:21,792 - INFO - validate step: 600  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,984
[rank1]:2025-10-27 11:42:22,132 - INFO - validate step: 600  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,976
[rank2]:2025-10-27 11:42:22,473 - INFO - validate step: 600  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,969
[rank3]:2025-10-27 11:42:22,801 - INFO - validate step: 600  loss:  0.2758  memory: 52.47GiB(37.53%)  tps: 2,962
[rank3]:2025-10-27 11:42:23,004 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1142_real_step600_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 11:42:27,388 - INFO - Avg. fwd time: 169.3946 / Avg. bwd time: 343.4164 / Avg. batch time: 4114.7333 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:42:27,689 - INFO - Avg. fwd time: 146.4141 / Avg. bwd time: 295.9016 / Avg. batch time: 4558.1849 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:42:28,028 - INFO - Avg. fwd time: 164.7423 / Avg. bwd time: 333.0401 / Avg. batch time: 5056.9828 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 11:42:28,331 - INFO - Avg. fwd time: 146.5192 / Avg. bwd time: 297.9442 / Avg. batch time: 5502.8491 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 11:49:44,484 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1410  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank1]:2025-10-27 11:49:44,480 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1410  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank2]:2025-10-27 11:49:44,477 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.1410  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.58  mfu: 3.50%
[rank3]:2025-10-27 11:49:44,482 - INFO -  step: 620  loss:  0.1466  grad_norm:  0.1410  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:49:49,065 - INFO - Avg. fwd time: 169.3969 / Avg. bwd time: 343.4204 / Avg. batch time: 4114.7283 (ms) / GPU bubble ratio: 0.30%
[rank2]:2025-10-27 11:49:49,365 - INFO - Avg. fwd time: 146.4169 / Avg. bwd time: 295.9067 / Avg. batch time: 4558.1801 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:49:49,703 - INFO - Avg. fwd time: 164.7445 / Avg. bwd time: 333.0445 / Avg. batch time: 5056.9780 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 11:49:50,006 - INFO - Avg. fwd time: 146.5209 / Avg. bwd time: 297.9480 / Avg. batch time: 5502.8449 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-10-27 11:57:06,149 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1456  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 11:57:06,147 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1456  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 11:57:06,153 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.1456  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:57:06,151 - INFO -  step: 640  loss:  0.1073  grad_norm:  0.1456  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 11:57:10,734 - INFO - Avg. fwd time: 169.3992 / Avg. bwd time: 343.4237 / Avg. batch time: 4114.7217 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 11:57:11,035 - INFO - Avg. fwd time: 146.4194 / Avg. bwd time: 295.9114 / Avg. batch time: 4558.1752 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 11:57:11,373 - INFO - Avg. fwd time: 164.7464 / Avg. bwd time: 333.0486 / Avg. batch time: 5056.9728 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 11:57:11,677 - INFO - Avg. fwd time: 146.5226 / Avg. bwd time: 297.9514 / Avg. batch time: 5502.8398 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:00:24,899 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-27 12:04:27,829 - INFO -  step: 660  loss:  0.1141  grad_norm:  0.1935  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 12:04:27,825 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1935  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:04:27,827 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1935  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:04:27,831 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.1935  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:04:32,411 - INFO - Avg. fwd time: 169.4012 / Avg. bwd time: 343.4268 / Avg. batch time: 4114.7138 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:04:32,712 - INFO - Avg. fwd time: 146.4217 / Avg. bwd time: 295.9157 / Avg. batch time: 4558.1679 (ms) / GPU bubble ratio: 22.37%
[rank1]:2025-10-27 12:04:33,050 - INFO - Avg. fwd time: 164.7483 / Avg. bwd time: 333.0523 / Avg. batch time: 5056.9649 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 12:04:33,353 - INFO - Avg. fwd time: 146.5240 / Avg. bwd time: 297.9548 / Avg. batch time: 5502.8329 (ms) / GPU bubble ratio: 35.38%
[rank3]:2025-10-27 12:11:49,507 - INFO -  step: 680  loss:  0.1218  grad_norm:  0.0902  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:11:49,505 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0902  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 12:11:49,503 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0902  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:11:49,509 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0902  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:11:54,089 - INFO - Avg. fwd time: 169.4031 / Avg. bwd time: 343.4299 / Avg. batch time: 4114.7076 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:11:54,391 - INFO - Avg. fwd time: 146.4241 / Avg. bwd time: 295.9197 / Avg. batch time: 4558.1628 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:11:54,729 - INFO - Avg. fwd time: 164.7501 / Avg. bwd time: 333.0561 / Avg. batch time: 5056.9608 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 12:11:55,032 - INFO - Avg. fwd time: 146.5255 / Avg. bwd time: 297.9580 / Avg. batch time: 5502.8290 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:18:49,090 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 12:19:11,190 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1142  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:19:11,190 - INFO - ðŸ”Ž  Running validation at step 700
[rank2]:2025-10-27 12:19:11,187 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1142  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 12:19:11,188 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 12:19:11,194 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1142  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:19:11,194 - INFO - ðŸ”Ž  Running validation at step 700
[rank3]:2025-10-27 12:19:11,192 - INFO -  step: 700  loss:  0.1106  grad_norm:  0.1142  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:19:11,193 - INFO - ðŸ”Ž  Running validation at step 700
[rank0]:2025-10-27 12:21:28,439 - INFO - validate step: 700  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,984
[rank1]:2025-10-27 12:21:28,779 - INFO - validate step: 700  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,977
[rank2]:2025-10-27 12:21:29,119 - INFO - validate step: 700  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,970
[rank3]:2025-10-27 12:21:29,447 - INFO - validate step: 700  loss:  0.2613  memory: 52.47GiB(37.53%)  tps: 2,963
[rank3]:2025-10-27 12:21:29,645 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1221_real_step700_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 12:21:34,038 - INFO - Avg. fwd time: 169.4049 / Avg. bwd time: 343.4328 / Avg. batch time: 4114.7018 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:21:34,339 - INFO - Avg. fwd time: 146.4262 / Avg. bwd time: 295.9237 / Avg. batch time: 4558.1582 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:21:34,678 - INFO - Avg. fwd time: 164.7520 / Avg. bwd time: 333.0599 / Avg. batch time: 5056.9572 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 12:21:34,981 - INFO - Avg. fwd time: 146.5271 / Avg. bwd time: 297.9611 / Avg. batch time: 5502.8267 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:28:51,167 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1847  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank3]:2025-10-27 12:28:51,166 - INFO -  step: 720  loss:  0.1854  grad_norm:  0.1847  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:28:51,162 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1847  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank2]:2025-10-27 12:28:51,160 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.1847  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.57  mfu: 3.50%
[rank3]:2025-10-27 12:28:55,747 - INFO - Avg. fwd time: 169.4068 / Avg. bwd time: 343.4356 / Avg. batch time: 4114.6990 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:28:56,049 - INFO - Avg. fwd time: 146.4280 / Avg. bwd time: 295.9268 / Avg. batch time: 4558.1568 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:28:56,388 - INFO - Avg. fwd time: 164.7535 / Avg. bwd time: 333.0631 / Avg. batch time: 5056.9568 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 12:28:56,691 - INFO - Avg. fwd time: 146.5287 / Avg. bwd time: 297.9640 / Avg. batch time: 5502.8278 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:36:12,841 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.2059  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:36:12,841 - INFO -  step: 740  loss:  0.1306  grad_norm:  0.2059  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 12:36:12,835 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.2059  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:36:12,837 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.2059  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:36:17,422 - INFO - Avg. fwd time: 169.4083 / Avg. bwd time: 343.4384 / Avg. batch time: 4114.6942 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:36:17,724 - INFO - Avg. fwd time: 146.4296 / Avg. bwd time: 295.9298 / Avg. batch time: 4558.1539 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:36:18,063 - INFO - Avg. fwd time: 164.7551 / Avg. bwd time: 333.0663 / Avg. batch time: 5056.9554 (ms) / GPU bubble ratio: 21.25%
[rank0]:2025-10-27 12:36:18,366 - INFO - Avg. fwd time: 146.5300 / Avg. bwd time: 297.9666 / Avg. batch time: 5502.8271 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:39:31,611 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-27 12:43:34,540 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1027  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:43:34,546 - INFO -  step: 760  loss:  0.1179  grad_norm:  0.1027  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:43:34,542 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1027  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:43:34,546 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.1027  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:43:39,128 - INFO - Avg. fwd time: 169.4099 / Avg. bwd time: 343.4409 / Avg. batch time: 4114.6913 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:43:39,430 - INFO - Avg. fwd time: 146.4312 / Avg. bwd time: 295.9328 / Avg. batch time: 4558.1529 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:43:39,768 - INFO - Avg. fwd time: 164.7566 / Avg. bwd time: 333.0693 / Avg. batch time: 5056.9544 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 12:43:40,072 - INFO - Avg. fwd time: 146.5312 / Avg. bwd time: 297.9690 / Avg. batch time: 5502.8270 (ms) / GPU bubble ratio: 35.38%
[rank2]:2025-10-27 12:50:56,218 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1474  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:50:56,223 - INFO -  step: 780  loss:  0.1285  grad_norm:  0.1474  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:50:56,225 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1474  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:50:56,221 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.1474  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:51:00,806 - INFO - Avg. fwd time: 169.4113 / Avg. bwd time: 343.4431 / Avg. batch time: 4114.6853 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 12:51:01,108 - INFO - Avg. fwd time: 146.4327 / Avg. bwd time: 295.9357 / Avg. batch time: 4558.1479 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 12:51:01,447 - INFO - Avg. fwd time: 164.7580 / Avg. bwd time: 333.0721 / Avg. batch time: 5056.9496 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 12:51:01,750 - INFO - Avg. fwd time: 146.5324 / Avg. bwd time: 297.9713 / Avg. batch time: 5502.8238 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 12:57:55,799 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 12:58:17,897 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1566  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 12:58:17,898 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-27 12:58:17,895 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1566  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 12:58:17,895 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-27 12:58:17,900 - INFO -  step: 800  loss:  0.1033  grad_norm:  0.1566  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 12:58:17,900 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 12:58:17,901 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1566  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 12:58:17,902 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-27 13:00:35,105 - INFO - validate step: 800  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,985
[rank1]:2025-10-27 13:00:35,448 - INFO - validate step: 800  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,978
[rank2]:2025-10-27 13:00:35,786 - INFO - validate step: 800  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,970
[rank3]:2025-10-27 13:00:36,113 - INFO - validate step: 800  loss:  0.2614  memory: 52.47GiB(37.53%)  tps: 2,964
[rank3]:2025-10-27 13:00:36,313 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1300_real_step800_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 13:00:40,703 - INFO - Avg. fwd time: 169.4128 / Avg. bwd time: 343.4454 / Avg. batch time: 4114.6833 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 13:00:41,005 - INFO - Avg. fwd time: 146.4344 / Avg. bwd time: 295.9384 / Avg. batch time: 4558.1471 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:00:41,345 - INFO - Avg. fwd time: 164.7594 / Avg. bwd time: 333.0749 / Avg. batch time: 5056.9497 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:00:41,648 - INFO - Avg. fwd time: 146.5335 / Avg. bwd time: 297.9736 / Avg. batch time: 5502.8247 (ms) / GPU bubble ratio: 35.38%
[rank3]:2025-10-27 13:04:48,115 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 13:04:49,448 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-27 13:04:49,782 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-27 13:04:50,083 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-27 13:07:58,374 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1295  memory: 38.19GiB(27.32%)  tps: 740  tflops: 34.53  mfu: 3.49%
[rank3]:2025-10-27 13:07:58,380 - INFO -  step: 820  loss:  0.1289  grad_norm:  0.1295  memory: 52.47GiB(37.53%)  tps: 741  tflops: 34.56  mfu: 3.49%
[rank0]:2025-10-27 13:07:58,381 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1295  memory: 56.85GiB(40.66%)  tps: 739  tflops: 34.48  mfu: 3.49%
[rank1]:2025-10-27 13:07:58,377 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.1295  memory: 48.97GiB(35.03%)  tps: 740  tflops: 34.50  mfu: 3.49%
[rank3]:2025-10-27 13:08:02,963 - INFO - Avg. fwd time: 169.4141 / Avg. bwd time: 343.4478 / Avg. batch time: 4114.6812 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 13:08:03,265 - INFO - Avg. fwd time: 146.4358 / Avg. bwd time: 295.9413 / Avg. batch time: 4558.1456 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:08:03,604 - INFO - Avg. fwd time: 164.7608 / Avg. bwd time: 333.0776 / Avg. batch time: 5056.9499 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:08:03,908 - INFO - Avg. fwd time: 146.5345 / Avg. bwd time: 297.9755 / Avg. batch time: 5502.8251 (ms) / GPU bubble ratio: 35.38%
[rank2]:2025-10-27 13:15:20,030 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1222  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:15:20,035 - INFO -  step: 840  loss:  0.1211  grad_norm:  0.1222  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 13:15:20,036 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1222  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 13:15:20,032 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.1222  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:15:24,618 - INFO - Avg. fwd time: 169.4154 / Avg. bwd time: 343.4497 / Avg. batch time: 4114.6767 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 13:15:24,919 - INFO - Avg. fwd time: 146.4372 / Avg. bwd time: 295.9437 / Avg. batch time: 4558.1411 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:15:25,258 - INFO - Avg. fwd time: 164.7621 / Avg. bwd time: 333.0800 / Avg. batch time: 5056.9457 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:15:25,562 - INFO - Avg. fwd time: 146.5354 / Avg. bwd time: 297.9775 / Avg. batch time: 5502.8209 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 13:18:38,784 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-27 13:22:41,692 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1306  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:22:41,694 - INFO -  step: 860  loss:  0.1106  grad_norm:  0.1306  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 13:22:41,689 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1306  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 13:22:41,696 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.1306  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:22:46,278 - INFO - Avg. fwd time: 169.4165 / Avg. bwd time: 343.4515 / Avg. batch time: 4114.6722 (ms) / GPU bubble ratio: 0.29%
[rank2]:2025-10-27 13:22:46,580 - INFO - Avg. fwd time: 146.4386 / Avg. bwd time: 295.9462 / Avg. batch time: 4558.1371 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:22:46,919 - INFO - Avg. fwd time: 164.7632 / Avg. bwd time: 333.0822 / Avg. batch time: 5056.9424 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:22:47,225 - INFO - Avg. fwd time: 146.5365 / Avg. bwd time: 297.9793 / Avg. batch time: 5502.8180 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-10-27 13:30:03,388 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1431  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 13:30:03,386 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1431  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:30:03,390 - INFO -  step: 880  loss:  0.0847  grad_norm:  0.1431  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 13:30:03,392 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.1431  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:30:07,974 - INFO - Avg. fwd time: 169.4177 / Avg. bwd time: 343.4534 / Avg. batch time: 4114.6702 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 13:30:08,276 - INFO - Avg. fwd time: 146.4399 / Avg. bwd time: 295.9482 / Avg. batch time: 4558.1348 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:30:08,615 - INFO - Avg. fwd time: 164.7644 / Avg. bwd time: 333.0845 / Avg. batch time: 5056.9404 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:30:08,919 - INFO - Avg. fwd time: 146.5375 / Avg. bwd time: 297.9812 / Avg. batch time: 5502.8166 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 13:37:02,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-27 13:37:25,062 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1506  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 13:37:25,063 - INFO - ðŸ”Ž  Running validation at step 900
[rank3]:2025-10-27 13:37:25,065 - INFO -  step: 900  loss:  0.1103  grad_norm:  0.1506  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:37:25,065 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 13:37:25,066 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1506  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 13:37:25,066 - INFO - ðŸ”Ž  Running validation at step 900
[rank2]:2025-10-27 13:37:25,060 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1506  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 13:37:25,060 - INFO - ðŸ”Ž  Running validation at step 900
[rank0]:2025-10-27 13:39:42,359 - INFO - validate step: 900  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,983
[rank1]:2025-10-27 13:39:42,699 - INFO - validate step: 900  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,976
[rank2]:2025-10-27 13:39:43,041 - INFO - validate step: 900  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,969
[rank3]:2025-10-27 13:39:43,368 - INFO - validate step: 900  loss:  0.2586  memory: 52.47GiB(37.53%)  tps: 2,962
[rank3]:2025-10-27 13:39:43,573 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1339_real_step900_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 13:39:47,959 - INFO - Avg. fwd time: 169.4189 / Avg. bwd time: 343.4555 / Avg. batch time: 4114.6707 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 13:39:48,261 - INFO - Avg. fwd time: 146.4409 / Avg. bwd time: 295.9502 / Avg. batch time: 4558.1362 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:39:48,600 - INFO - Avg. fwd time: 164.7654 / Avg. bwd time: 333.0864 / Avg. batch time: 5056.9419 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:39:48,903 - INFO - Avg. fwd time: 146.5384 / Avg. bwd time: 297.9831 / Avg. batch time: 5502.8183 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-10-27 13:47:05,046 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1095  memory: 48.97GiB(35.03%)  tps: 741  tflops: 34.55  mfu: 3.49%
[rank3]:2025-10-27 13:47:05,048 - INFO -  step: 920  loss:  0.1133  grad_norm:  0.1095  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 13:47:05,050 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1095  memory: 56.85GiB(40.66%)  tps: 740  tflops: 34.52  mfu: 3.49%
[rank2]:2025-10-27 13:47:05,044 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.1095  memory: 38.19GiB(27.32%)  tps: 741  tflops: 34.58  mfu: 3.50%
[rank3]:2025-10-27 13:47:09,630 - INFO - Avg. fwd time: 169.4200 / Avg. bwd time: 343.4572 / Avg. batch time: 4114.6683 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 13:47:09,933 - INFO - Avg. fwd time: 146.4420 / Avg. bwd time: 295.9518 / Avg. batch time: 4558.1339 (ms) / GPU bubble ratio: 22.36%
[rank1]:2025-10-27 13:47:10,272 - INFO - Avg. fwd time: 164.7662 / Avg. bwd time: 333.0882 / Avg. batch time: 5056.9402 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:47:10,577 - INFO - Avg. fwd time: 146.5393 / Avg. bwd time: 297.9848 / Avg. batch time: 5502.8168 (ms) / GPU bubble ratio: 35.38%
[rank0]:2025-10-27 13:54:26,736 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1283  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 13:54:26,732 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1283  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 13:54:26,730 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.1283  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:54:26,734 - INFO -  step: 940  loss:  0.0963  grad_norm:  0.1283  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 13:54:31,317 - INFO - Avg. fwd time: 169.4211 / Avg. bwd time: 343.4590 / Avg. batch time: 4114.6682 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 13:54:31,619 - INFO - Avg. fwd time: 146.4430 / Avg. bwd time: 295.9534 / Avg. batch time: 4558.1339 (ms) / GPU bubble ratio: 22.35%
[rank1]:2025-10-27 13:54:31,958 - INFO - Avg. fwd time: 164.7671 / Avg. bwd time: 333.0899 / Avg. batch time: 5056.9403 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 13:54:32,262 - INFO - Avg. fwd time: 146.5398 / Avg. bwd time: 297.9864 / Avg. batch time: 5502.8165 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-10-27 13:57:45,488 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-27 14:01:48,415 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1529  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 14:01:48,409 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1529  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 14:01:48,411 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.1529  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 14:01:48,414 - INFO -  step: 960  loss:  0.0833  grad_norm:  0.1529  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 14:01:52,998 - INFO - Avg. fwd time: 169.4223 / Avg. bwd time: 343.4609 / Avg. batch time: 4114.6695 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 14:01:53,302 - INFO - Avg. fwd time: 146.4438 / Avg. bwd time: 295.9549 / Avg. batch time: 4558.1357 (ms) / GPU bubble ratio: 22.35%
[rank1]:2025-10-27 14:01:53,642 - INFO - Avg. fwd time: 164.7679 / Avg. bwd time: 333.0915 / Avg. batch time: 5056.9430 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 14:01:53,946 - INFO - Avg. fwd time: 146.5406 / Avg. bwd time: 297.9880 / Avg. batch time: 5502.8195 (ms) / GPU bubble ratio: 35.37%
[rank2]:2025-10-27 14:09:10,107 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1242  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 14:09:10,112 - INFO -  step: 980  loss:  0.0898  grad_norm:  0.1242  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 14:09:10,109 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1242  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 14:09:10,113 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.1242  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 14:09:14,697 - INFO - Avg. fwd time: 169.4233 / Avg. bwd time: 343.4626 / Avg. batch time: 4114.6691 (ms) / GPU bubble ratio: 0.28%
[rank2]:2025-10-27 14:09:15,000 - INFO - Avg. fwd time: 146.4447 / Avg. bwd time: 295.9563 / Avg. batch time: 4558.1353 (ms) / GPU bubble ratio: 22.35%
[rank1]:2025-10-27 14:09:15,340 - INFO - Avg. fwd time: 164.7687 / Avg. bwd time: 333.0930 / Avg. batch time: 5056.9435 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-27 14:09:15,644 - INFO - Avg. fwd time: 146.5413 / Avg. bwd time: 297.9895 / Avg. batch time: 5502.8204 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-10-27 14:16:09,698 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-27 14:16:31,800 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0951  memory: 56.85GiB(40.66%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank0]:2025-10-27 14:16:31,800 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0951  tps: 755  tflops: 35.22  mfu: 3.46%
[rank0]:2025-10-27 14:16:31,800 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-27 14:16:31,794 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0951  memory: 38.19GiB(27.32%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank2]:2025-10-27 14:16:31,794 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0951  tps: 755  tflops: 35.23  mfu: 3.47%
[rank2]:2025-10-27 14:16:31,794 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-27 14:16:31,796 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0951  memory: 48.97GiB(35.03%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank1]:2025-10-27 14:16:31,796 - INFO -  final step: 1000  loss: -4.0000  grad_norm:  0.0951  tps: 755  tflops: 35.23  mfu: 3.47%
[rank1]:2025-10-27 14:16:31,796 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-27 14:16:31,798 - INFO -  step: 1000  loss:  0.0968  grad_norm:  0.0951  memory: 52.47GiB(37.53%)  tps: 742  tflops: 34.60  mfu: 3.50%
[rank3]:2025-10-27 14:16:31,799 - INFO -  final step: 1000  loss:  0.0968  grad_norm:  0.0951  tps: 756  tflops: 35.24  mfu: 3.47%
[rank3]:2025-10-27 14:16:31,804 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-27 14:18:49,011 - INFO - validate step: 1000  loss: -1.0000  memory: 56.85GiB(40.66%)  tps: 2,985
[rank0]:2025-10-27 14:18:49,012 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-27 14:18:49,017 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank1]:2025-10-27 14:18:49,352 - INFO - validate step: 1000  loss: -1.0000  memory: 48.97GiB(35.03%)  tps: 2,978
[rank1]:2025-10-27 14:18:49,353 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-27 14:18:49,358 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank2]:2025-10-27 14:18:49,691 - INFO - validate step: 1000  loss: -1.0000  memory: 38.19GiB(27.32%)  tps: 2,970
[rank2]:2025-10-27 14:18:49,692 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-27 14:18:49,698 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank3]:2025-10-27 14:18:50,018 - INFO - validate step: 1000  loss:  0.2589  memory: 52.47GiB(37.53%)  tps: 2,964
[rank3]:2025-10-27 14:18:50,020 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-27 14:18:50,025 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 1000.
[rank0]:2025-10-27 14:19:00,058 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-27 14:19:00,078 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 14:19:00,077 - INFO - Destroying the purge thread.
[rank0]:2025-10-27 14:19:00,076 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-27 14:19:00,334 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1419_real_final1000_rank3.svg
[rank3]:> Batch Time: 5491.12 ms, GPU Bubble Ratio: 35.19%, 27.42%, 35.51%, 25.23%
[rank3]:2025-10-27 14:19:00,584 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1/pipeline_schedule/251027_1419_thry_final1000_rank3.svg
[rank3]:> Batch Time: 5175.59 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-27 14:19:00,585 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 21.68334
[rank3]:wandb:               final/avg_loss 0.09679
[rank3]:wandb:             final/avg_mfu(%) 3.46787
[rank3]:wandb:             final/avg_tflops 35.24145
[rank3]:wandb:    final/avg_throughput(tps) 755.60319
[rank3]:wandb:              final/grad_norm 0.09506
[rank3]:wandb:               final/max_loss 0.09679
[rank3]:wandb:                    grad_norm 0.09506
[rank3]:wandb: loss_metrics/global_avg_loss 0.09679
[rank3]:wandb: loss_metrics/global_max_loss 0.09679
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1027_1F1B_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/k6druhak
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1027_1F1B_nofreeze_dm1/20251027-0747/wandb/run-20251027_074707-k6druhak/logs
[rank0]:2025-10-27 14:19:02,077 - INFO - Training completed
[rank0]:2025-10-27 14:19:02,077 - INFO - Destroying the purge thread.
[rank1]:2025-10-27 14:19:02,280 - INFO - Process group destroyed
[rank3]:2025-10-27 14:19:02,294 - INFO - Process group destroyed
[rank2]:2025-10-27 14:19:02,305 - INFO - Process group destroyed
[rank0]:2025-10-27 14:19:02,597 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.14', 'layers.10', 'layers.8', 'layers.9', 'layers.13', 'layers.12', 'layers.15', 'layers.11', 'layers.16'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.4', 'layers.7', 'layers.5', 'layers.2', 'tok_embeddings', 'layers.0', 'layers.6', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.23', 'layers.21', 'layers.18', 'layers.22', 'layers.24', 'layers.17', 'layers.20'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'layers.31', 'layers.25', 'layers.26', 'layers.28', 'norm', 'output', 'layers.29', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1027_1F1B_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1027_1F1B_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1027_1F1B_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_1F1B_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1027_1F1B_nofreeze_dm1
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1027_1F1B_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 1000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_1F1B_nofreeze_dm1
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1027_1F1B_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 100
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Mon Oct 27 14:19:10 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/1027_1F1B_apf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation
âœ”ï¸Running with apf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1027_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1027 14:19:11.798000 3445538 site-packages/torch/distributed/run.py:811] 
W1027 14:19:11.798000 3445538 site-packages/torch/distributed/run.py:811] *****************************************
W1027 14:19:11.798000 3445538 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1027 14:19:11.798000 3445538 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-27 14:19:17,614 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank0]:2025-10-27 14:19:17,735 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank1]:2025-10-27 14:19:17,936 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank3]:2025-10-27 14:19:17,913 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation"
[rank2]:2025-10-27 14:19:18,181 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-27 14:19:18,184 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 14:19:18,592 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-27 14:19:18,595 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 14:19:18,600 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-27 14:19:18,717 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-27 14:19:18,720 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-27 14:19:18,707 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-27 14:19:18,709 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-27 14:19:20,433 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-27 14:19:20,742 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-27 14:19:22,402 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-27 14:19:22,661 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-27 14:19:22,691 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-27 14:19:22,615 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-27 14:19:22,694 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-27 14:19:22,695 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-27 14:19:22,715 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-27 14:19:22,738 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-27 14:19:22,738 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-27 14:19:22,768 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-27 14:19:22,768 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-27 14:19:22,941 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-27 14:19:22,941 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-27 14:19:23,050 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-27 14:19:23,051 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-27 14:19:23,052 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-27 14:19:23,053 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run zctrxecu
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1027_1F1B_apf_dm1/20251027-1419/wandb/run-20251027_141923-zctrxecu
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1027_1F1B_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/zctrxecu
[rank3]:2025-10-27 14:19:24,512 - INFO - WandB logging enabled
[rank3]:2025-10-27 14:19:24,515 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-27 14:19:24,587 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-27 14:19:24,588 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-10-27 14:19:24,800 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-27 14:19:24,801 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-27 14:19:24,993 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1027_1F1B_apf_dm1
[rank0]:2025-10-27 14:19:24,993 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-27 14:19:24,993 - INFO - Mixed precision training is disabled
[rank0]:2025-10-27 14:19:24,994 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-27 14:19:28,063 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 1000 (warmup 100)
[rank0]:2025-10-27 14:19:28,064 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-27 14:19:37,452 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-27 14:19:37,452 - INFO - Finished loading the checkpoint in 9.39 seconds.
[rank0]:2025-10-27 14:19:37,452 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-27 14:20:01,435 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 34.42GiB(24.62%)  tps: 423  tflops: 19.75  mfu: 2.00%
[rank1]:2025-10-27 14:20:01,435 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 14:20:01,475 - INFO -  step:  1  loss: 15.8956  grad_norm:     inf  memory: 38.77GiB(27.73%)  tps: 444  tflops: 20.70  mfu: 2.09%
[rank3]:2025-10-27 14:20:01,476 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-27 14:20:01,454 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 39.86GiB(28.51%)  tps: 423  tflops: 19.73  mfu: 1.99%
[rank0]:2025-10-27 14:20:01,454 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-27 14:20:01,461 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 26.61GiB(19.03%)  tps: 422  tflops: 19.70  mfu: 1.99%
[rank2]:2025-10-27 14:20:01,462 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-27 14:20:39,170 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,170 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-27 14:20:39,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,471 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,472 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,473 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-27 14:20:39,473 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,807 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,807 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,807 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,808 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-27 14:20:39,809 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,108 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-27 14:20:40,109 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
slurmstepd-localhost: error: *** JOB 550 ON localhost CANCELLED AT 2025-10-27T14:23:27 ***
