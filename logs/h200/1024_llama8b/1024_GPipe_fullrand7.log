
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Oct 25 11:14:43 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/1024_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1025 11:14:45.088000 1544237 site-packages/torch/distributed/run.py:811] 
W1025 11:14:45.088000 1544237 site-packages/torch/distributed/run.py:811] *****************************************
W1025 11:14:45.088000 1544237 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1025 11:14:45.088000 1544237 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-25 11:14:50,996 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank1]:2025-10-25 11:14:51,124 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank3]:2025-10-25 11:14:51,140 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank2]:2025-10-25 11:14:51,244 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank0]:2025-10-25 11:14:51,703 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 11:14:51,706 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 11:14:51,711 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-25 11:14:51,987 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 11:14:51,989 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-25 11:14:51,986 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 11:14:51,988 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-25 11:14:51,979 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 11:14:51,981 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 11:14:53,585 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-25 11:14:53,868 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-25 11:14:55,507 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-25 11:14:55,782 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-25 11:14:55,836 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-25 11:14:55,859 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-25 11:14:55,859 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-25 11:14:56,197 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-25 11:14:56,293 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-25 11:14:56,293 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-25 11:14:56,263 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-25 11:14:56,336 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-25 11:14:56,336 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-25 11:14:56,264 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-25 11:14:56,265 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-25 11:14:56,869 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-25 11:14:56,869 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-10-25 11:14:56,862 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-25 11:14:56,863 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: setting up run k4xx2d73
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1024_GPipe_fullrand7_h200/20251025-1114/wandb/run-20251025_111456-k4xx2d73
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1024_GPipe_fullrand7_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k4xx2d73
[rank3]:2025-10-25 11:14:57,759 - INFO - WandB logging enabled
[rank3]:2025-10-25 11:14:57,761 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-25 11:14:57,833 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-25 11:14:57,834 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-25 11:14:58,063 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-25 11:14:58,064 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-25 11:14:58,103 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200.
[rank1]:2025-10-25 11:14:58,076 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200.
[rank2]:2025-10-25 11:14:58,103 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200.
[rank0]:2025-10-25 11:14:58,102 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200
[rank0]:2025-10-25 11:14:58,102 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-25 11:14:58,102 - INFO - Mixed precision training is disabled
[rank0]:2025-10-25 11:14:58,102 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-25 11:14:58,102 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200.
[rank0]:2025-10-25 11:14:58,103 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200/step-500.
[rank0]:2025-10-25 11:15:05,178 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-25 11:15:05,178 - INFO - Finished loading the checkpoint in 7.08 seconds.
[rank0]:2025-10-25 11:15:05,178 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-25 11:15:29,632 - INFO -  step:  1  loss:  0.5498  grad_norm:  0.6216  memory: 77.01GiB(55.08%)  tps: 515  tflops: 24.01  mfu: 2.43%
[rank3]:2025-10-25 11:15:29,632 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-25 11:15:29,628 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.6216  memory: 58.03GiB(41.50%)  tps: 492  tflops: 22.94  mfu: 2.32%
[rank2]:2025-10-25 11:15:29,628 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-25 11:15:29,630 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.6216  memory: 65.20GiB(46.63%)  tps: 491  tflops: 22.91  mfu: 2.32%
[rank1]:2025-10-25 11:15:29,631 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-25 11:15:29,648 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.6216  memory: 61.95GiB(44.31%)  tps: 485  tflops: 22.60  mfu: 2.29%
[rank0]:2025-10-25 11:15:29,648 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 11:16:07,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 11:16:07,674 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:16:07,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,307 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 11:16:08,308 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,608 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 11:16:08,609 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 11:22:34,116 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.5624  memory: 71.04GiB(50.81%)  tps: 733  tflops: 34.20  mfu: 3.46%
[rank1]:2025-10-25 11:22:34,118 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.5624  memory: 79.85GiB(57.11%)  tps: 733  tflops: 34.20  mfu: 3.46%
[rank0]:2025-10-25 11:22:34,122 - INFO -  step: 20  loss: -4.0000  grad_norm:  0.5624  memory: 78.87GiB(56.41%)  tps: 733  tflops: 34.20  mfu: 3.46%
[rank3]:2025-10-25 11:22:34,121 - INFO -  step: 20  loss:  0.5815  grad_norm:  0.5624  memory: 92.28GiB(66.01%)  tps: 733  tflops: 34.20  mfu: 3.46%
[rank3]:2025-10-25 11:22:38,774 - INFO - Avg. fwd time: 170.1223 / Avg. bwd time: 340.1357 / Avg. batch time: 4142.2784 (ms) / GPU bubble ratio: 1.45%
[rank2]:2025-10-25 11:22:39,073 - INFO - Avg. fwd time: 144.6453 / Avg. bwd time: 292.3692 / Avg. batch time: 4585.7329 (ms) / GPU bubble ratio: 23.76%
[rank1]:2025-10-25 11:22:39,409 - INFO - Avg. fwd time: 164.6580 / Avg. bwd time: 329.1471 / Avg. batch time: 5084.6111 (ms) / GPU bubble ratio: 22.31%
[rank0]:2025-10-25 11:22:39,709 - INFO - Avg. fwd time: 146.0232 / Avg. bwd time: 294.4908 / Avg. batch time: 5530.7201 (ms) / GPU bubble ratio: 36.28%
[rank1]:2025-10-25 11:30:01,607 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5136  memory: 79.85GiB(57.11%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank2]:2025-10-25 11:30:01,605 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5136  memory: 71.04GiB(50.81%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank3]:2025-10-25 11:30:01,609 - INFO -  step: 40  loss:  0.5710  grad_norm:  0.5136  memory: 92.28GiB(66.01%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank0]:2025-10-25 11:30:01,611 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5136  memory: 78.87GiB(56.41%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank3]:2025-10-25 11:30:06,269 - INFO - Avg. fwd time: 171.5085 / Avg. bwd time: 342.5473 / Avg. batch time: 4147.3401 (ms) / GPU bubble ratio: 0.84%
[rank2]:2025-10-25 11:30:06,568 - INFO - Avg. fwd time: 145.5661 / Avg. bwd time: 294.2172 / Avg. batch time: 4590.7938 (ms) / GPU bubble ratio: 23.36%
[rank1]:2025-10-25 11:30:06,903 - INFO - Avg. fwd time: 165.9549 / Avg. bwd time: 331.2193 / Avg. batch time: 5089.7126 (ms) / GPU bubble ratio: 21.85%
[rank0]:2025-10-25 11:30:07,204 - INFO - Avg. fwd time: 147.0021 / Avg. bwd time: 296.3102 / Avg. batch time: 5535.8228 (ms) / GPU bubble ratio: 35.94%
[rank0]:2025-10-25 11:33:23,035 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-25 11:37:29,169 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5835  memory: 71.04GiB(50.81%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank0]:2025-10-25 11:37:29,175 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5835  memory: 78.87GiB(56.41%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank1]:2025-10-25 11:37:29,171 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.5835  memory: 79.85GiB(57.11%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank3]:2025-10-25 11:37:29,174 - INFO -  step: 60  loss:  0.5453  grad_norm:  0.5835  memory: 92.28GiB(66.01%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank3]:2025-10-25 11:37:33,832 - INFO - Avg. fwd time: 171.9944 / Avg. bwd time: 343.3802 / Avg. batch time: 4149.3684 (ms) / GPU bubble ratio: 0.64%
[rank2]:2025-10-25 11:37:34,130 - INFO - Avg. fwd time: 145.8878 / Avg. bwd time: 294.8516 / Avg. batch time: 4592.8288 (ms) / GPU bubble ratio: 23.23%
[rank1]:2025-10-25 11:37:34,466 - INFO - Avg. fwd time: 166.4187 / Avg. bwd time: 331.9171 / Avg. batch time: 5091.7558 (ms) / GPU bubble ratio: 21.70%
[rank0]:2025-10-25 11:37:34,766 - INFO - Avg. fwd time: 147.3472 / Avg. bwd time: 296.9194 / Avg. batch time: 5537.8643 (ms) / GPU bubble ratio: 35.82%
[rank1]:2025-10-25 11:44:56,765 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.6230  memory: 79.85GiB(57.11%)  tps: 732  tflops: 34.14  mfu: 3.45%
[rank0]:2025-10-25 11:44:56,769 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.6230  memory: 78.87GiB(56.41%)  tps: 732  tflops: 34.14  mfu: 3.45%
[rank2]:2025-10-25 11:44:56,762 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.6230  memory: 71.04GiB(50.81%)  tps: 732  tflops: 34.14  mfu: 3.45%
[rank3]:2025-10-25 11:44:56,767 - INFO -  step: 80  loss:  0.5414  grad_norm:  0.6230  memory: 92.28GiB(66.01%)  tps: 732  tflops: 34.15  mfu: 3.45%
[rank3]:2025-10-25 11:45:01,425 - INFO - Avg. fwd time: 172.2394 / Avg. bwd time: 343.7976 / Avg. batch time: 4150.3888 (ms) / GPU bubble ratio: 0.53%
[rank2]:2025-10-25 11:45:01,724 - INFO - Avg. fwd time: 146.0502 / Avg. bwd time: 295.1676 / Avg. batch time: 4593.8548 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-10-25 11:45:02,060 - INFO - Avg. fwd time: 166.6654 / Avg. bwd time: 332.2640 / Avg. batch time: 5092.7853 (ms) / GPU bubble ratio: 21.63%
[rank0]:2025-10-25 11:45:02,361 - INFO - Avg. fwd time: 147.5264 / Avg. bwd time: 297.2247 / Avg. batch time: 5538.8997 (ms) / GPU bubble ratio: 35.76%
[rank3]:2025-10-25 11:45:45,292 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 11:45:46,507 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 11:45:46,841 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 11:45:47,138 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 11:50:31,505 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-25 11:52:02,570 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 11:52:23,425 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-25 11:52:24,975 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-25 11:52:24,978 - INFO -  step: 100  loss:  0.5805  grad_norm:  0.5819  memory: 92.28GiB(66.01%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank1]:2025-10-25 11:52:24,977 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5819  memory: 79.85GiB(57.11%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank2]:2025-10-25 11:52:24,976 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5819  memory: 71.04GiB(50.81%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank0]:2025-10-25 11:52:24,977 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5819  memory: 78.87GiB(56.41%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank1]:2025-10-25 11:52:25,049 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1152_stage1_step100.svg
[rank2]:2025-10-25 11:52:25,048 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1152_stage2_step100.svg
[rank0]:2025-10-25 11:52:25,048 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1152_stage0_step100.svg
[rank0]:2025-10-25 11:52:25,246 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:25,345 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1152_real_step100_rank3.svg
[rank3]:> Batch Time: 5529.50 ms, GPU Bubble Ratio: 35.42%, 27.55%, 35.94%, 25.07%
[rank3]:2025-10-25 11:52:25,398 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1152_stage3_step100.svg
[rank3]:2025-10-25 11:52:25,595 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:25,538 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:25,575 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:25,542 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:25,871 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:25,908 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:25,849 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:25,937 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:26,220 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:26,154 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:26,284 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:26,254 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:26,569 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:26,605 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:26,659 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:27,098 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:27,436 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:27,467 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:27,775 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:27,805 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:27,904 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:28,114 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:28,087 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:28,145 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:28,242 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:28,425 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 11:52:28,483 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:28,582 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:28,765 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 11:52:28,920 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 11:52:29,103 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 11:52:29,664 - INFO - Avg. fwd time: 172.3872 / Avg. bwd time: 344.0373 / Avg. batch time: 4150.9173 (ms) / GPU bubble ratio: 0.47%
[rank2]:2025-10-25 11:52:29,957 - INFO - Avg. fwd time: 146.1465 / Avg. bwd time: 295.3503 / Avg. batch time: 4594.3794 (ms) / GPU bubble ratio: 23.12%
[rank1]:2025-10-25 11:52:30,287 - INFO - Avg. fwd time: 166.8142 / Avg. bwd time: 332.4608 / Avg. batch time: 5093.2974 (ms) / GPU bubble ratio: 21.58%
[rank0]:2025-10-25 11:52:30,581 - INFO - Avg. fwd time: 147.6326 / Avg. bwd time: 297.3971 / Avg. batch time: 5539.4052 (ms) / GPU bubble ratio: 35.73%
[rank3]:2025-10-25 11:53:39,898 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-25 11:53:41,452 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1153_max_batch_time.svg
[rank3]:> Batch Time: 5532.00 ms, GPU Bubble Ratio: 35.44%, 27.56%, 35.95%, 25.06%
[rank3]:2025-10-25 11:53:41,733 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1153_min_batch_time.svg
[rank3]:> Batch Time: 3646.88 ms, GPU Bubble Ratio: 67.52%, 25.10%, 33.93%, 21.57%
[rank3]:2025-10-25 11:53:42,063 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1153_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3646.88 ms, GPU Bubble Ratio: 33.17%, 23.88%, 28.98%, 21.57%
[rank3]:2025-10-25 11:53:42,063 - INFO - 	> Batch Time: 3646.88 ms (Average Freeze Ratio: 0.82, Time Reduction Rate: 0.34)
[rank3]:2025-10-25 11:57:47,095 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 11:57:48,149 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.80/0.80, [MB1] 0.79/0.79, [MB2] 0.77/0.77, [MB3] 0.79/0.79, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-10-25 11:57:48,379 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.92/0.92, [MB2] 0.93/0.93, [MB3] 0.94/0.94, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 11:57:48,524 - INFO -  step: 120  loss:  0.5323  grad_norm:  0.1142  memory: 92.28GiB(66.01%)  tps: 1,013  tflops: 47.24  mfu: 4.78%
[rank1]:2025-10-25 11:57:48,523 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1142  memory: 79.85GiB(57.11%)  tps: 1,013  tflops: 47.24  mfu: 4.78%
[rank0]:2025-10-25 11:57:48,520 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.37/0.37, [MB1] 0.00/0.00, [MB2] 0.43/0.43, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 11:57:48,523 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1142  memory: 78.87GiB(56.41%)  tps: 1,013  tflops: 47.24  mfu: 4.78%
[rank2]:2025-10-25 11:57:48,523 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1142  memory: 71.04GiB(50.81%)  tps: 1,013  tflops: 47.24  mfu: 4.78%
[rank3]:2025-10-25 11:57:52,049 - INFO - Avg. fwd time: 172.5318 / Avg. bwd time: 321.3142 / Avg. batch time: 3968.1928 (ms) / GPU bubble ratio: 0.44%
[rank2]:2025-10-25 11:57:52,234 - INFO - Avg. fwd time: 146.2174 / Avg. bwd time: 274.9515 / Avg. batch time: 4392.1765 (ms) / GPU bubble ratio: 23.29%
[rank1]:2025-10-25 11:57:52,458 - INFO - Avg. fwd time: 166.8560 / Avg. bwd time: 309.3007 / Avg. batch time: 4868.6823 (ms) / GPU bubble ratio: 21.76%
[rank0]:2025-10-25 11:57:52,601 - INFO - Avg. fwd time: 147.6357 / Avg. bwd time: 261.3720 / Avg. batch time: 5278.5241 (ms) / GPU bubble ratio: 38.01%
[rank3]:2025-10-25 12:02:43,097 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1202_rank3_trend_line.svg
[rank0]:2025-10-25 12:02:43,120 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1202_rank0_trend_line.svg
[rank0]:2025-10-25 12:02:43,126 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 12:02:43,127 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 12:02:43,127 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank2]:2025-10-25 12:02:43,097 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1202_rank2_trend_line.svg
[rank2]:2025-10-25 12:02:43,125 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.66/0.66, [MB2] 0.66/0.66, [MB3] 0.72/0.72, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-25 12:02:43,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.66/0.66, [MB2] 0.66/0.66, [MB3] 0.72/0.72, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-25 12:02:43,127 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank1]:2025-10-25 12:02:43,116 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1202_rank1_trend_line.svg
[rank1]:2025-10-25 12:02:43,125 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.99/0.99, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:02:43,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.99/0.99, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:02:43,127 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank3]:2025-10-25 12:02:43,419 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1202_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3617.90 ms, GPU Bubble Ratio: 54.50%, 24.73%, 31.10%, 22.25%
[rank3]:2025-10-25 12:02:43,419 - INFO - 	> Batch Time: 3617.90 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-25 12:02:43,420 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:02:43,421 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:02:43,424 - INFO -  step: 140  loss:  0.5179  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,111  tflops: 51.82  mfu: 5.24%
[rank3]:2025-10-25 12:02:46,476 - INFO - Avg. fwd time: 172.6585 / Avg. bwd time: 301.1789 / Avg. batch time: 3806.6649 (ms) / GPU bubble ratio: 0.42%
[rank2]:2025-10-25 12:02:46,634 - INFO - Avg. fwd time: 146.2698 / Avg. bwd time: 257.7967 / Avg. batch time: 4213.1933 (ms) / GPU bubble ratio: 23.28%
[rank0]:2025-10-25 12:02:46,813 - INFO - Avg. fwd time: 147.5670 / Avg. bwd time: 224.1002 / Avg. batch time: 5042.4918 (ms) / GPU bubble ratio: 41.03%
[rank1]:2025-10-25 12:02:46,810 - INFO - Avg. fwd time: 166.8610 / Avg. bwd time: 290.0015 / Avg. batch time: 4670.1176 (ms) / GPU bubble ratio: 21.74%
[rank0]:2025-10-25 12:04:55,589 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 12:07:37,450 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1207_rank3_trend_line.svg
[rank0]:2025-10-25 12:07:37,472 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1207_rank0_trend_line.svg
[rank0]:2025-10-25 12:07:37,477 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 12:07:37,478 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank1]:2025-10-25 12:07:37,471 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1207_rank1_trend_line.svg
[rank1]:2025-10-25 12:07:37,477 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.96/0.96, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:07:37,478 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank2]:2025-10-25 12:07:37,450 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1207_rank2_trend_line.svg
[rank2]:2025-10-25 12:07:37,477 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.54/0.54, [MB1] 0.54/0.54, [MB2] 0.54/0.54, [MB3] 0.57/0.57, [MB4] 0.68/0.68, [MB5] 0.79/0.79, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank2]:2025-10-25 12:07:37,478 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 12:07:37,777 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1207_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3623.33 ms, GPU Bubble Ratio: 60.72%, 24.60%, 30.52%, 22.21%
[rank3]:2025-10-25 12:07:37,777 - INFO - 	> Batch Time: 3623.33 ms (Average Freeze Ratio: 0.67)
[rank3]:2025-10-25 12:07:37,778 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:07:37,781 - INFO -  step: 160  loss:  0.4954  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 12:07:40,826 - INFO - Avg. fwd time: 172.7635 / Avg. bwd time: 286.0741 / Avg. batch time: 3685.6347 (ms) / GPU bubble ratio: 0.41%
[rank2]:2025-10-25 12:07:40,983 - INFO - Avg. fwd time: 146.3093 / Avg. bwd time: 244.9236 / Avg. batch time: 4079.0714 (ms) / GPU bubble ratio: 23.27%
[rank0]:2025-10-25 12:07:41,162 - INFO - Avg. fwd time: 147.5100 / Avg. bwd time: 196.1318 / Avg. batch time: 4865.5843 (ms) / GPU bubble ratio: 43.50%
[rank1]:2025-10-25 12:07:41,160 - INFO - Avg. fwd time: 166.8454 / Avg. bwd time: 275.5184 / Avg. batch time: 4521.3085 (ms) / GPU bubble ratio: 21.73%
[rank3]:2025-10-25 12:09:00,463 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:09:01,625 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:09:02,227 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:09:02,824 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 12:14:00,860 - INFO -  step: 180  loss:  0.5105  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 855  tflops: 39.90  mfu: 4.03%
[rank0]:2025-10-25 12:14:00,885 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4754  memory: 78.87GiB(56.41%)  tps: 855  tflops: 39.86  mfu: 4.03%
[rank1]:2025-10-25 12:14:00,858 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 855  tflops: 39.86  mfu: 4.03%
[rank2]:2025-10-25 12:14:00,858 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 855  tflops: 39.86  mfu: 4.03%
[rank3]:2025-10-25 12:14:04,212 - INFO - Avg. fwd time: 172.7161 / Avg. bwd time: 274.2066 / Avg. batch time: 3589.5452 (ms) / GPU bubble ratio: 0.39%
[rank2]:2025-10-25 12:14:04,369 - INFO - Avg. fwd time: 146.3279 / Avg. bwd time: 234.8932 / Avg. batch time: 3972.7913 (ms) / GPU bubble ratio: 23.23%
[rank1]:2025-10-25 12:14:04,952 - INFO - Avg. fwd time: 166.8441 / Avg. bwd time: 264.2502 / Avg. batch time: 4449.4402 (ms) / GPU bubble ratio: 22.49%
[rank0]:2025-10-25 12:14:05,674 - INFO - Avg. fwd time: 147.6194 / Avg. bwd time: 207.4686 / Avg. batch time: 4852.0070 (ms) / GPU bubble ratio: 41.45%
[rank0]:2025-10-25 12:20:05,410 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 12:20:24,697 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1220_rank3_trend_line.svg
[rank1]:2025-10-25 12:20:24,699 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1220_rank1_trend_line.svg
[rank1]:2025-10-25 12:20:24,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.94/0.94, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:20:24,728 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 854  tflops: 39.81  mfu: 4.03%
[rank2]:2025-10-25 12:20:24,697 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1220_rank2_trend_line.svg
[rank2]:2025-10-25 12:20:24,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.32/0.32, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank2]:2025-10-25 12:20:24,728 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 854  tflops: 39.81  mfu: 4.03%
[rank0]:2025-10-25 12:20:24,722 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1220_rank0_trend_line.svg
[rank0]:2025-10-25 12:20:24,727 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 12:20:24,728 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4465  memory: 78.87GiB(56.41%)  tps: 854  tflops: 39.82  mfu: 4.03%
[rank3]:2025-10-25 12:20:25,013 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1220_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3607.39 ms, GPU Bubble Ratio: 33.99%, 23.97%, 29.84%, 21.89%
[rank3]:2025-10-25 12:20:25,013 - INFO - 	> Batch Time: 3607.39 ms (Average Freeze Ratio: 0.59)
[rank3]:2025-10-25 12:20:25,013 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:20:25,018 - INFO -  step: 200  loss:  0.5318  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 853  tflops: 39.78  mfu: 4.02%
[rank0]:2025-10-25 12:20:25,084 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1220_stage0_step200.svg
[rank1]:2025-10-25 12:20:25,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1220_stage1_step200.svg
[rank2]:2025-10-25 12:20:25,084 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1220_stage2_step200.svg
[rank3]:2025-10-25 12:20:25,366 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1220_real_step200_rank3.svg
[rank3]:> Batch Time: 5511.75 ms, GPU Bubble Ratio: 35.24%, 27.49%, 35.86%, 25.14%
[rank3]:2025-10-25 12:20:25,428 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1220_stage3_step200.svg
[rank3]:2025-10-25 12:20:28,412 - INFO - Avg. fwd time: 172.6549 / Avg. bwd time: 264.6849 / Avg. batch time: 3512.2879 (ms) / GPU bubble ratio: 0.39%
[rank2]:2025-10-25 12:20:28,569 - INFO - Avg. fwd time: 146.3434 / Avg. bwd time: 226.8642 / Avg. batch time: 3887.3789 (ms) / GPU bubble ratio: 23.20%
[rank1]:2025-10-25 12:20:29,151 - INFO - Avg. fwd time: 166.8576 / Avg. bwd time: 255.2329 / Avg. batch time: 4391.7862 (ms) / GPU bubble ratio: 23.11%
[rank0]:2025-10-25 12:20:29,866 - INFO - Avg. fwd time: 147.7181 / Avg. bwd time: 216.5432 / Avg. batch time: 4840.9814 (ms) / GPU bubble ratio: 39.80%
[rank2]:2025-10-25 12:25:20,003 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,110  tflops: 51.76  mfu: 5.23%
[rank1]:2025-10-25 12:25:20,004 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,110  tflops: 51.76  mfu: 5.23%
[rank0]:2025-10-25 12:25:20,004 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,110  tflops: 51.76  mfu: 5.23%
[rank3]:2025-10-25 12:25:20,004 - INFO -  step: 220  loss:  0.5063  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,111  tflops: 51.81  mfu: 5.24%
[rank3]:2025-10-25 12:25:23,340 - INFO - Avg. fwd time: 172.7105 / Avg. bwd time: 256.9854 / Avg. batch time: 3450.6705 (ms) / GPU bubble ratio: 0.38%
[rank2]:2025-10-25 12:25:23,497 - INFO - Avg. fwd time: 146.3636 / Avg. bwd time: 220.3052 / Avg. batch time: 3819.1000 (ms) / GPU bubble ratio: 23.19%
[rank1]:2025-10-25 12:25:23,674 - INFO - Avg. fwd time: 166.8613 / Avg. bwd time: 247.8532 / Avg. batch time: 4308.5102 (ms) / GPU bubble ratio: 23.00%
[rank0]:2025-10-25 12:25:23,677 - INFO - Avg. fwd time: 147.6828 / Avg. bwd time: 196.8802 / Avg. batch time: 4730.2838 (ms) / GPU bubble ratio: 41.73%
[rank3]:2025-10-25 12:30:13,999 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1230_rank3_trend_line.svg
[rank2]:2025-10-25 12:30:14,000 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1230_rank2_trend_line.svg
[rank2]:2025-10-25 12:30:14,033 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-25 12:30:14,034 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank1]:2025-10-25 12:30:14,028 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1230_rank1_trend_line.svg
[rank1]:2025-10-25 12:30:14,033 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.93/0.93, [MB4] 0.93/0.93, [MB5] 0.93/0.93, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:30:14,034 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank0]:2025-10-25 12:30:14,027 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1230_rank0_trend_line.svg
[rank0]:2025-10-25 12:30:14,032 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 12:30:14,034 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank3]:2025-10-25 12:30:14,320 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1230_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3618.17 ms, GPU Bubble Ratio: 43.56%, 23.54%, 32.84%, 22.07%
[rank3]:2025-10-25 12:30:14,320 - INFO - 	> Batch Time: 3618.17 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-10-25 12:30:14,320 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:30:14,325 - INFO -  step: 240  loss:  0.4672  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank3]:2025-10-25 12:30:17,381 - INFO - Avg. fwd time: 172.7610 / Avg. bwd time: 250.5776 / Avg. batch time: 3399.4354 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-25 12:30:17,538 - INFO - Avg. fwd time: 146.3813 / Avg. bwd time: 214.8389 / Avg. batch time: 3762.3124 (ms) / GPU bubble ratio: 23.19%
[rank1]:2025-10-25 12:30:17,715 - INFO - Avg. fwd time: 166.8416 / Avg. bwd time: 241.7014 / Avg. batch time: 4239.2221 (ms) / GPU bubble ratio: 22.90%
[rank0]:2025-10-25 12:30:17,718 - INFO - Avg. fwd time: 147.6351 / Avg. bwd time: 180.4909 / Avg. batch time: 4638.1453 (ms) / GPU bubble ratio: 43.40%
[rank3]:2025-10-25 12:32:16,031 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:32:18,048 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:32:18,220 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:32:18,217 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:33:00,505 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 12:36:24,463 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 885  tflops: 41.26  mfu: 4.17%
[rank1]:2025-10-25 12:36:24,462 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 885  tflops: 41.26  mfu: 4.17%
[rank3]:2025-10-25 12:36:24,463 - INFO -  step: 260  loss:  0.4721  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 885  tflops: 41.29  mfu: 4.17%
[rank2]:2025-10-25 12:36:24,482 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1906  memory: 71.04GiB(50.81%)  tps: 885  tflops: 41.26  mfu: 4.17%
[rank3]:2025-10-25 12:36:28,014 - INFO - Avg. fwd time: 172.8307 / Avg. bwd time: 247.0899 / Avg. batch time: 3371.7950 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-25 12:36:28,921 - INFO - Avg. fwd time: 146.3879 / Avg. bwd time: 221.0818 / Avg. batch time: 3788.0530 (ms) / GPU bubble ratio: 22.39%
[rank0]:2025-10-25 12:36:29,102 - INFO - Avg. fwd time: 147.5983 / Avg. bwd time: 166.6206 / Avg. batch time: 4633.9748 (ms) / GPU bubble ratio: 45.75%
[rank1]:2025-10-25 12:36:29,099 - INFO - Avg. fwd time: 166.8065 / Avg. bwd time: 236.4921 / Avg. batch time: 4254.3814 (ms) / GPU bubble ratio: 24.16%
[rank1]:2025-10-25 12:42:35,387 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank3]:2025-10-25 12:42:35,388 - INFO -  step: 280  loss:  0.5107  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank0]:2025-10-25 12:42:35,388 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank2]:2025-10-25 12:42:35,406 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1661  memory: 71.04GiB(50.81%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank3]:2025-10-25 12:42:38,942 - INFO - Avg. fwd time: 172.9063 / Avg. bwd time: 244.1024 / Avg. batch time: 3348.2502 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 12:42:39,849 - INFO - Avg. fwd time: 146.3905 / Avg. bwd time: 226.4313 / Avg. batch time: 3810.2252 (ms) / GPU bubble ratio: 21.72%
[rank0]:2025-10-25 12:42:40,030 - INFO - Avg. fwd time: 147.5665 / Avg. bwd time: 154.7300 / Avg. batch time: 4630.5064 (ms) / GPU bubble ratio: 47.77%
[rank1]:2025-10-25 12:42:40,026 - INFO - Avg. fwd time: 166.7717 / Avg. bwd time: 232.0264 / Avg. batch time: 4267.4832 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-25 12:48:27,750 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 12:48:46,291 - INFO -  step: 300  loss:  0.5048  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 883  tflops: 41.21  mfu: 4.17%
[rank1]:2025-10-25 12:48:46,291 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank2]:2025-10-25 12:48:46,310 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1703  memory: 71.04GiB(50.81%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank0]:2025-10-25 12:48:46,291 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank1]:2025-10-25 12:48:46,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1248_stage1_step300.svg
[rank2]:2025-10-25 12:48:46,374 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1248_stage2_step300.svg
[rank0]:2025-10-25 12:48:46,377 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1248_stage0_step300.svg
[rank3]:2025-10-25 12:48:46,631 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1248_real_step300_rank3.svg
[rank3]:> Batch Time: 4700.12 ms, GPU Bubble Ratio: 50.89%, 41.98%, 24.78%, 35.61%
[rank3]:2025-10-25 12:48:46,690 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1248_stage3_step300.svg
[rank3]:2025-10-25 12:48:49,926 - INFO - Avg. fwd time: 172.9674 / Avg. bwd time: 241.5152 / Avg. batch time: 3327.8268 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 12:48:50,833 - INFO - Avg. fwd time: 146.3931 / Avg. bwd time: 231.0688 / Avg. batch time: 3829.4106 (ms) / GPU bubble ratio: 21.14%
[rank1]:2025-10-25 12:48:51,010 - INFO - Avg. fwd time: 166.7425 / Avg. bwd time: 228.1557 / Avg. batch time: 4278.8081 (ms) / GPU bubble ratio: 26.17%
[rank0]:2025-10-25 12:48:51,014 - INFO - Avg. fwd time: 147.5383 / Avg. bwd time: 144.4235 / Avg. batch time: 4627.4702 (ms) / GPU bubble ratio: 49.53%
[rank2]:2025-10-25 12:54:57,428 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1254_rank2_trend_line.svg
[rank0]:2025-10-25 12:54:57,452 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1254_rank0_trend_line.svg
[rank0]:2025-10-25 12:54:57,457 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:54:57,408 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1254_rank3_trend_line.svg
[rank1]:2025-10-25 12:54:57,446 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1254_rank1_trend_line.svg
[rank1]:2025-10-25 12:54:57,457 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.31/0.31, [MB1] 0.84/0.84, [MB2] 0.84/0.84, [MB3] 0.86/0.86, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 12:54:57,458 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 883  tflops: 41.18  mfu: 4.16%
[rank2]:2025-10-25 12:54:57,456 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.53/0.53, [MB4] 0.55/0.55, [MB5] 0.70/0.70, [MB6] 0.85/0.85, [MB7] 1.00/1.00
[rank2]:2025-10-25 12:54:57,457 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1976  memory: 71.04GiB(50.81%)  tps: 883  tflops: 41.18  mfu: 4.16%
[rank0]:2025-10-25 12:54:57,458 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 883  tflops: 41.18  mfu: 4.16%
[rank3]:2025-10-25 12:54:57,749 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1254_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3667.84 ms, GPU Bubble Ratio: 53.42%, 22.73%, 31.84%, 20.98%
[rank3]:2025-10-25 12:54:57,749 - INFO - 	> Batch Time: 3667.84 ms (Average Freeze Ratio: 0.67)
[rank3]:2025-10-25 12:54:57,749 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 12:54:57,753 - INFO -  step: 320  loss:  0.4829  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 882  tflops: 41.14  mfu: 4.16%
[rank3]:2025-10-25 12:55:00,997 - INFO - Avg. fwd time: 173.0260 / Avg. bwd time: 239.2505 / Avg. batch time: 3309.9926 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 12:55:01,885 - INFO - Avg. fwd time: 146.3953 / Avg. bwd time: 235.1237 / Avg. batch time: 3846.2128 (ms) / GPU bubble ratio: 20.65%
[rank1]:2025-10-25 12:55:02,062 - INFO - Avg. fwd time: 166.7186 / Avg. bwd time: 224.7685 / Avg. batch time: 4288.7326 (ms) / GPU bubble ratio: 26.97%
[rank0]:2025-10-25 12:55:02,066 - INFO - Avg. fwd time: 147.5172 / Avg. bwd time: 135.4043 / Avg. batch time: 4624.8292 (ms) / GPU bubble ratio: 51.06%
[rank3]:2025-10-25 12:57:13,082 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 12:57:14,139 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:57:14,314 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 12:57:14,313 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 12:59:52,860 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,109  tflops: 51.74  mfu: 5.23%
[rank2]:2025-10-25 12:59:52,859 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,109  tflops: 51.74  mfu: 5.23%
[rank0]:2025-10-25 12:59:52,861 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,109  tflops: 51.74  mfu: 5.23%
[rank3]:2025-10-25 12:59:52,864 - INFO -  step: 340  loss:  0.4405  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,110  tflops: 51.79  mfu: 5.24%
[rank3]:2025-10-25 12:59:56,201 - INFO - Avg. fwd time: 173.0348 / Avg. bwd time: 235.7596 / Avg. batch time: 3281.9648 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 12:59:56,360 - INFO - Avg. fwd time: 146.4059 / Avg. bwd time: 230.3927 / Avg. batch time: 3804.3964 (ms) / GPU bubble ratio: 20.77%
[rank1]:2025-10-25 12:59:56,537 - INFO - Avg. fwd time: 166.7026 / Avg. bwd time: 221.7810 / Avg. batch time: 4240.8485 (ms) / GPU bubble ratio: 26.72%
[rank0]:2025-10-25 12:59:56,540 - INFO - Avg. fwd time: 147.4939 / Avg. bwd time: 127.4454 / Avg. batch time: 4565.8586 (ms) / GPU bubble ratio: 51.83%
[rank0]:2025-10-25 13:02:05,078 - INFO - [GC] Peforming periodical GC collection 0.03 seconds

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Oct 25 13:02:29 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/1024_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1025 13:02:30.352000 1613905 site-packages/torch/distributed/run.py:811] 
W1025 13:02:30.352000 1613905 site-packages/torch/distributed/run.py:811] *****************************************
W1025 13:02:30.352000 1613905 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1025 13:02:30.352000 1613905 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-10-25 13:02:36,091 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank1]:2025-10-25 13:02:36,219 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank0]:2025-10-25 13:02:36,172 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank2]:2025-10-25 13:02:36,286 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank3]:2025-10-25 13:02:36,841 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 13:02:36,844 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 13:02:37,038 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 13:02:37,040 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 13:02:37,045 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-25 13:02:37,058 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 13:02:37,061 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-25 13:02:37,069 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 13:02:37,071 - INFO - Building 1-D device mesh with ['pp'], [4]

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Oct 25 13:04:08 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/1024_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1025 13:04:09.478000 1615797 site-packages/torch/distributed/run.py:811] 
W1025 13:04:09.478000 1615797 site-packages/torch/distributed/run.py:811] *****************************************
W1025 13:04:09.478000 1615797 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1025 13:04:09.478000 1615797 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-25 13:04:15,287 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank3]:2025-10-25 13:04:15,360 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank2]:2025-10-25 13:04:15,416 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank0]:2025-10-25 13:04:15,418 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank1]:2025-10-25 13:04:16,084 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-25 13:04:16,086 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-25 13:04:16,240 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-25 13:04:16,243 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 13:04:16,301 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-25 13:04:16,305 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 13:04:16,311 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-25 13:04:16,296 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-25 13:04:16,298 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-25 13:04:17,979 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-25 13:04:18,289 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-25 13:04:19,919 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-25 13:04:20,196 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-25 13:04:20,206 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-25 13:04:20,184 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-25 13:04:20,260 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-10-25 13:04:20,307 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-25 13:04:20,308 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-25 13:04:20,284 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-25 13:04:20,284 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-25 13:04:20,301 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-25 13:04:20,301 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-25 13:04:20,632 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-25 13:04:20,633 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-25 13:04:20,605 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-25 13:04:20,606 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-25 13:04:20,629 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-25 13:04:20,630 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run a1dnczh1
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1024_GPipe_fullrand7_h200/20251025-1304/wandb/run-20251025_130421-a1dnczh1
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1024_GPipe_fullrand7_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/a1dnczh1
[rank3]:2025-10-25 13:04:22,463 - INFO - WandB logging enabled
[rank3]:2025-10-25 13:04:22,464 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-25 13:04:22,539 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-25 13:04:22,539 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-25 13:04:22,755 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-25 13:04:22,756 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-25 13:04:22,952 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200
[rank0]:2025-10-25 13:04:22,952 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-25 13:04:22,952 - INFO - Mixed precision training is disabled
[rank0]:2025-10-25 13:04:22,952 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-25 13:04:22,952 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-25 13:04:33,351 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-25 13:04:33,351 - INFO - Finished loading the checkpoint in 10.40 seconds.
[rank0]:2025-10-25 13:04:33,351 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]:2025-10-25 13:04:57,504 - INFO -  step:  1  loss:  1.5658  grad_norm:  3.0754  memory: 77.01GiB(55.08%)  tps: 468  tflops: 21.84  mfu: 2.21%
[rank3]:2025-10-25 13:04:57,504 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-25 13:04:57,502 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 58.03GiB(41.50%)  tps: 440  tflops: 20.53  mfu: 2.08%
[rank2]:2025-10-25 13:04:57,502 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-25 13:04:57,502 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 65.20GiB(46.63%)  tps: 440  tflops: 20.53  mfu: 2.08%
[rank1]:2025-10-25 13:04:57,503 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-25 13:04:57,526 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 61.95GiB(44.31%)  tps: 440  tflops: 20.51  mfu: 2.07%
[rank0]:2025-10-25 13:04:57,526 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-25 13:05:35,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,576 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,576 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,576 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,577 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,577 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,577 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,577 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,577 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,578 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,578 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,578 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,578 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-25 13:05:35,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,877 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:05:35,878 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-25 13:05:36,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,514 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,515 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-25 13:05:36,516 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-25 13:12:02,498 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 71.04GiB(50.81%)  tps: 732  tflops: 34.16  mfu: 3.45%
[rank3]:2025-10-25 13:12:02,502 - INFO -  step: 20  loss:  1.1858  grad_norm:  1.1848  memory: 92.28GiB(66.01%)  tps: 732  tflops: 34.16  mfu: 3.45%
[rank1]:2025-10-25 13:12:02,500 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 79.85GiB(57.11%)  tps: 732  tflops: 34.16  mfu: 3.45%
[rank0]:2025-10-25 13:12:02,504 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 78.87GiB(56.41%)  tps: 732  tflops: 34.16  mfu: 3.45%
[rank3]:2025-10-25 13:12:07,164 - INFO - Avg. fwd time: 170.3494 / Avg. bwd time: 340.6235 / Avg. batch time: 4148.0710 (ms) / GPU bubble ratio: 1.45%
[rank2]:2025-10-25 13:12:07,463 - INFO - Avg. fwd time: 144.7404 / Avg. bwd time: 292.4793 / Avg. batch time: 4591.5439 (ms) / GPU bubble ratio: 23.82%
[rank1]:2025-10-25 13:12:07,799 - INFO - Avg. fwd time: 165.2306 / Avg. bwd time: 329.1157 / Avg. batch time: 5090.3864 (ms) / GPU bubble ratio: 22.31%
[rank0]:2025-10-25 13:12:08,099 - INFO - Avg. fwd time: 146.2134 / Avg. bwd time: 294.5226 / Avg. batch time: 5536.5676 (ms) / GPU bubble ratio: 36.32%
[rank0]:2025-10-25 13:19:30,486 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5195  memory: 78.87GiB(56.41%)  tps: 731  tflops: 34.12  mfu: 3.45%
[rank1]:2025-10-25 13:19:30,482 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5195  memory: 79.85GiB(57.11%)  tps: 731  tflops: 34.12  mfu: 3.45%
[rank3]:2025-10-25 13:19:30,485 - INFO -  step: 40  loss:  1.0795  grad_norm:  0.5195  memory: 92.28GiB(66.01%)  tps: 731  tflops: 34.12  mfu: 3.45%
[rank2]:2025-10-25 13:19:30,480 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5195  memory: 71.04GiB(50.81%)  tps: 731  tflops: 34.12  mfu: 3.45%
[rank3]:2025-10-25 13:19:35,149 - INFO - Avg. fwd time: 171.7021 / Avg. bwd time: 343.0429 / Avg. batch time: 4152.8887 (ms) / GPU bubble ratio: 0.84%
[rank2]:2025-10-25 13:19:35,447 - INFO - Avg. fwd time: 145.6567 / Avg. bwd time: 294.3161 / Avg. batch time: 4596.3445 (ms) / GPU bubble ratio: 23.42%
[rank1]:2025-10-25 13:19:35,783 - INFO - Avg. fwd time: 166.5690 / Avg. bwd time: 331.1763 / Avg. batch time: 5095.2219 (ms) / GPU bubble ratio: 21.85%
[rank0]:2025-10-25 13:19:36,084 - INFO - Avg. fwd time: 147.2279 / Avg. bwd time: 296.3758 / Avg. batch time: 5541.4529 (ms) / GPU bubble ratio: 35.96%
[rank0]:2025-10-25 13:22:52,089 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-25 13:26:58,506 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4491  memory: 79.85GiB(57.11%)  tps: 731  tflops: 34.11  mfu: 3.45%
[rank3]:2025-10-25 13:26:58,508 - INFO -  step: 60  loss:  1.0642  grad_norm:  0.4491  memory: 92.28GiB(66.01%)  tps: 731  tflops: 34.11  mfu: 3.45%
[rank2]:2025-10-25 13:26:58,503 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4491  memory: 71.04GiB(50.81%)  tps: 731  tflops: 34.11  mfu: 3.45%
[rank0]:2025-10-25 13:26:58,510 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4491  memory: 78.87GiB(56.41%)  tps: 731  tflops: 34.11  mfu: 3.45%
[rank3]:2025-10-25 13:27:03,177 - INFO - Avg. fwd time: 172.1725 / Avg. bwd time: 343.8566 / Avg. batch time: 4154.6270 (ms) / GPU bubble ratio: 0.64%
[rank2]:2025-10-25 13:27:03,475 - INFO - Avg. fwd time: 145.9655 / Avg. bwd time: 294.9345 / Avg. batch time: 4598.0884 (ms) / GPU bubble ratio: 23.29%
[rank1]:2025-10-25 13:27:03,811 - INFO - Avg. fwd time: 167.0546 / Avg. bwd time: 331.8717 / Avg. batch time: 5096.9860 (ms) / GPU bubble ratio: 21.69%
[rank0]:2025-10-25 13:27:04,112 - INFO - Avg. fwd time: 147.5868 / Avg. bwd time: 296.9919 / Avg. batch time: 5543.2191 (ms) / GPU bubble ratio: 35.84%
[rank1]:2025-10-25 13:34:26,696 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4325  memory: 79.85GiB(57.11%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank0]:2025-10-25 13:34:26,700 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4325  memory: 78.87GiB(56.41%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank2]:2025-10-25 13:34:26,693 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4325  memory: 71.04GiB(50.81%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank3]:2025-10-25 13:34:26,698 - INFO -  step: 80  loss:  1.0453  grad_norm:  0.4325  memory: 92.28GiB(66.01%)  tps: 731  tflops: 34.10  mfu: 3.45%
[rank3]:2025-10-25 13:34:31,361 - INFO - Avg. fwd time: 172.4075 / Avg. bwd time: 344.2599 / Avg. batch time: 4155.4498 (ms) / GPU bubble ratio: 0.53%
[rank2]:2025-10-25 13:34:31,660 - INFO - Avg. fwd time: 146.1195 / Avg. bwd time: 295.2459 / Avg. batch time: 4598.9071 (ms) / GPU bubble ratio: 23.22%
[rank1]:2025-10-25 13:34:31,996 - INFO - Avg. fwd time: 167.2697 / Avg. bwd time: 332.2187 / Avg. batch time: 5097.7954 (ms) / GPU bubble ratio: 21.61%
[rank0]:2025-10-25 13:34:32,297 - INFO - Avg. fwd time: 147.7579 / Avg. bwd time: 297.3110 / Avg. batch time: 5544.0475 (ms) / GPU bubble ratio: 35.78%
[rank3]:2025-10-25 13:35:15,273 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:35:16,492 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:35:16,826 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 13:35:17,123 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 13:40:01,797 - INFO - [Step 95] ã€°ï¸ Monitoring Upperbound
[rank0]:2025-10-25 13:41:32,902 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 13:41:53,788 - INFO - [Step 100] âœ”ï¸  Setting Upperbound
[rank2]:2025-10-25 13:41:55,342 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 71.04GiB(50.81%)  tps: 730  tflops: 34.06  mfu: 3.44%
[rank3]:2025-10-25 13:41:55,341 - INFO - [Step 100] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-25 13:41:55,345 - INFO -  step: 100  loss:  1.0455  grad_norm:  0.4329  memory: 92.28GiB(66.01%)  tps: 730  tflops: 34.06  mfu: 3.44%
[rank0]:2025-10-25 13:41:55,343 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 78.87GiB(56.41%)  tps: 730  tflops: 34.07  mfu: 3.44%
[rank1]:2025-10-25 13:41:55,343 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 79.85GiB(57.11%)  tps: 730  tflops: 34.06  mfu: 3.44%
[rank2]:2025-10-25 13:41:55,415 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1341_stage2_step100.svg
[rank0]:2025-10-25 13:41:55,421 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1341_stage0_step100.svg
[rank1]:2025-10-25 13:41:55,413 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1341_stage1_step100.svg
[rank0]:2025-10-25 13:41:55,621 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:55,730 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1341_real_step100_rank3.svg
[rank3]:> Batch Time: 5535.00 ms, GPU Bubble Ratio: 35.44%, 27.55%, 36.00%, 25.05%
[rank3]:2025-10-25 13:41:55,786 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1341_stage3_step100.svg
[rank2]:2025-10-25 13:41:55,949 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:55,916 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:55,912 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:55,969 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:56,223 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:56,245 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:56,282 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:56,311 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:56,530 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:56,595 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:56,660 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:56,631 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:56,947 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:57,035 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:56,983 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:57,473 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:57,842 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:57,811 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:58,152 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:58,182 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:58,279 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:58,462 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:41:58,492 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:58,522 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:58,619 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:58,802 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-25 13:41:58,862 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:58,959 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:59,142 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-25 13:41:59,300 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-25 13:41:59,483 - WARNING - Batch index 401 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-25 13:42:00,047 - INFO - Avg. fwd time: 172.5326 / Avg. bwd time: 344.4676 / Avg. batch time: 4155.5357 (ms) / GPU bubble ratio: 0.47%
[rank2]:2025-10-25 13:42:00,341 - INFO - Avg. fwd time: 146.2102 / Avg. bwd time: 295.4202 / Avg. batch time: 4598.9740 (ms) / GPU bubble ratio: 23.18%
[rank1]:2025-10-25 13:42:00,671 - INFO - Avg. fwd time: 167.3637 / Avg. bwd time: 332.4136 / Avg. batch time: 5097.8426 (ms) / GPU bubble ratio: 21.57%
[rank0]:2025-10-25 13:42:00,965 - INFO - Avg. fwd time: 147.8572 / Avg. bwd time: 297.4793 / Avg. batch time: 5544.0659 (ms) / GPU bubble ratio: 35.74%
[rank3]:2025-10-25 13:43:09,756 - INFO - [Step 105] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-25 13:43:11,308 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1343_max_batch_time.svg
[rank3]:> Batch Time: 5538.12 ms, GPU Bubble Ratio: 35.48%, 27.57%, 36.03%, 25.03%
[rank3]:2025-10-25 13:43:11,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1343_min_batch_time.svg
[rank3]:> Batch Time: 3623.38 ms, GPU Bubble Ratio: 67.28%, 24.50%, 33.49%, 21.71%
[rank3]:2025-10-25 13:43:11,910 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1343_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3623.38 ms, GPU Bubble Ratio: 33.15%, 23.75%, 29.34%, 21.71%
[rank3]:2025-10-25 13:43:11,910 - INFO - 	> Batch Time: 3623.38 ms (Average Freeze Ratio: 0.83, Time Reduction Rate: 0.35)
[rank3]:2025-10-25 13:47:13,422 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-25 13:47:14,491 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.82/0.82, [MB1] 0.80/0.80, [MB2] 0.79/0.79, [MB3] 0.81/0.81, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank1]:2025-10-25 13:47:14,691 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.93/0.93, [MB2] 0.95/0.95, [MB3] 0.99/0.99, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 13:47:14,841 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 1.00/1.00, [MB3] 0.02/0.02, [MB4] 1.00/1.00, [MB5] 0.42/0.42, [MB6] 0.42/0.42, [MB7] 1.00/1.00
[rank0]:2025-10-25 13:47:14,842 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1058  memory: 78.87GiB(56.41%)  tps: 1,026  tflops: 47.83  mfu: 4.84%
[rank1]:2025-10-25 13:47:14,843 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1058  memory: 79.85GiB(57.11%)  tps: 1,026  tflops: 47.83  mfu: 4.84%
[rank3]:2025-10-25 13:47:14,846 - INFO -  step: 120  loss:  0.9883  grad_norm:  0.1058  memory: 92.28GiB(66.01%)  tps: 1,026  tflops: 47.83  mfu: 4.84%
[rank2]:2025-10-25 13:47:14,843 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.1058  memory: 71.04GiB(50.81%)  tps: 1,026  tflops: 47.83  mfu: 4.84%
[rank3]:2025-10-25 13:47:18,468 - INFO - Avg. fwd time: 172.6419 / Avg. bwd time: 320.6108 / Avg. batch time: 3963.4379 (ms) / GPU bubble ratio: 0.44%
[rank2]:2025-10-25 13:47:18,646 - INFO - Avg. fwd time: 146.2675 / Avg. bwd time: 274.8917 / Avg. batch time: 4387.2552 (ms) / GPU bubble ratio: 23.20%
[rank1]:2025-10-25 13:47:18,847 - INFO - Avg. fwd time: 167.3217 / Avg. bwd time: 309.2461 / Avg. batch time: 4862.8101 (ms) / GPU bubble ratio: 21.60%
[rank0]:2025-10-25 13:47:18,998 - INFO - Avg. fwd time: 147.8557 / Avg. bwd time: 262.9316 / Avg. batch time: 5274.2461 (ms) / GPU bubble ratio: 37.69%
[rank3]:2025-10-25 13:52:09,140 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1352_rank3_trend_line.svg
[rank2]:2025-10-25 13:52:09,139 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1352_rank2_trend_line.svg
[rank2]:2025-10-25 13:52:09,165 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.67/0.67, [MB2] 0.67/0.67, [MB3] 0.68/0.68, [MB4] 0.76/0.76, [MB5] 0.84/0.84, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-25 13:52:09,166 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.67/0.67, [MB2] 0.67/0.67, [MB3] 0.68/0.68, [MB4] 0.76/0.76, [MB5] 0.84/0.84, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-25 13:52:09,166 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank1]:2025-10-25 13:52:09,154 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1352_rank1_trend_line.svg
[rank1]:2025-10-25 13:52:09,165 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 13:52:09,166 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 13:52:09,166 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank0]:2025-10-25 13:52:09,160 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1352_rank0_trend_line.svg
[rank0]:2025-10-25 13:52:09,165 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 13:52:09,166 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 13:52:09,167 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank3]:2025-10-25 13:52:09,469 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1352_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3639.83 ms, GPU Bubble Ratio: 53.17%, 24.68%, 30.76%, 22.23%
[rank3]:2025-10-25 13:52:09,470 - INFO - 	> Batch Time: 3639.83 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-25 13:52:09,470 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 13:52:09,471 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 13:52:09,474 - INFO -  step: 140  loss:  1.0160  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank3]:2025-10-25 13:52:12,499 - INFO - Avg. fwd time: 172.7146 / Avg. bwd time: 300.5368 / Avg. batch time: 3801.9682 (ms) / GPU bubble ratio: 0.42%
[rank2]:2025-10-25 13:52:12,656 - INFO - Avg. fwd time: 146.3102 / Avg. bwd time: 257.7429 / Avg. batch time: 4208.3567 (ms) / GPU bubble ratio: 23.19%
[rank0]:2025-10-25 13:52:12,835 - INFO - Avg. fwd time: 147.7986 / Avg. bwd time: 225.4374 / Avg. batch time: 5038.1935 (ms) / GPU bubble ratio: 40.73%
[rank1]:2025-10-25 13:52:12,833 - INFO - Avg. fwd time: 167.2482 / Avg. bwd time: 289.9487 / Avg. batch time: 4664.4537 (ms) / GPU bubble ratio: 21.59%
[rank0]:2025-10-25 13:54:21,317 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 13:57:02,941 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1357_rank3_trend_line.svg
[rank2]:2025-10-25 13:57:02,941 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1357_rank2_trend_line.svg
[rank2]:2025-10-25 13:57:02,966 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.53/0.53, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.53/0.53, [MB4] 0.63/0.63, [MB5] 0.75/0.75, [MB6] 0.88/0.88, [MB7] 1.00/1.00
[rank2]:2025-10-25 13:57:02,968 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank0]:2025-10-25 13:57:02,962 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1357_rank0_trend_line.svg
[rank0]:2025-10-25 13:57:02,967 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-25 13:57:02,968 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank1]:2025-10-25 13:57:02,960 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1357_rank1_trend_line.svg
[rank1]:2025-10-25 13:57:02,967 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 13:57:02,968 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 13:57:03,263 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1357_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3635.91 ms, GPU Bubble Ratio: 60.08%, 24.56%, 30.31%, 22.25%
[rank3]:2025-10-25 13:57:03,263 - INFO - 	> Batch Time: 3635.91 ms (Average Freeze Ratio: 0.66)
[rank3]:2025-10-25 13:57:03,263 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 13:57:03,267 - INFO -  step: 160  loss:  0.9774  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 13:57:06,312 - INFO - Avg. fwd time: 172.7601 / Avg. bwd time: 285.4686 / Avg. batch time: 3680.7545 (ms) / GPU bubble ratio: 0.41%
[rank2]:2025-10-25 13:57:06,469 - INFO - Avg. fwd time: 146.3436 / Avg. bwd time: 244.8751 / Avg. batch time: 4074.0681 (ms) / GPU bubble ratio: 23.18%
[rank1]:2025-10-25 13:57:06,646 - INFO - Avg. fwd time: 167.1741 / Avg. bwd time: 275.4674 / Avg. batch time: 4515.5739 (ms) / GPU bubble ratio: 21.58%
[rank0]:2025-10-25 13:57:06,648 - INFO - Avg. fwd time: 147.7427 / Avg. bwd time: 197.3021 / Avg. batch time: 4861.0406 (ms) / GPU bubble ratio: 43.21%
[rank3]:2025-10-25 13:58:25,941 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 13:58:27,104 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 13:58:27,699 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 13:58:28,300 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 14:03:26,426 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 855  tflops: 39.86  mfu: 4.03%
[rank3]:2025-10-25 14:03:26,428 - INFO -  step: 180  loss:  0.9601  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 855  tflops: 39.89  mfu: 4.03%
[rank2]:2025-10-25 14:03:26,426 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 855  tflops: 39.86  mfu: 4.03%
[rank0]:2025-10-25 14:03:26,453 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.2547  memory: 78.87GiB(56.41%)  tps: 854  tflops: 39.85  mfu: 4.03%
[rank3]:2025-10-25 14:03:29,790 - INFO - Avg. fwd time: 172.7507 / Avg. bwd time: 273.7017 / Avg. batch time: 3585.7769 (ms) / GPU bubble ratio: 0.39%
[rank2]:2025-10-25 14:03:29,947 - INFO - Avg. fwd time: 146.3681 / Avg. bwd time: 234.8631 / Avg. batch time: 3968.9250 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-10-25 14:03:30,525 - INFO - Avg. fwd time: 167.1878 / Avg. bwd time: 264.2018 / Avg. batch time: 4444.6613 (ms) / GPU bubble ratio: 22.35%
[rank0]:2025-10-25 14:03:31,247 - INFO - Avg. fwd time: 147.8676 / Avg. bwd time: 208.5124 / Avg. batch time: 4848.2928 (ms) / GPU bubble ratio: 41.19%
[rank0]:2025-10-25 14:09:31,289 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-25 14:09:50,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1409_rank1_trend_line.svg
[rank3]:2025-10-25 14:09:50,592 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1409_rank3_trend_line.svg
[rank2]:2025-10-25 14:09:50,593 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1409_rank2_trend_line.svg
[rank0]:2025-10-25 14:09:50,623 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1409_rank0_trend_line.svg
[rank0]:2025-10-25 14:09:50,628 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.01/0.01, [MB5] 0.01/0.01, [MB6] 0.01/0.01, [MB7] 1.00/1.00
[rank0]:2025-10-25 14:09:50,629 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.2436  memory: 78.87GiB(56.41%)  tps: 853  tflops: 39.78  mfu: 4.02%
[rank1]:2025-10-25 14:09:50,628 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.94/0.94, [MB4] 0.94/0.94, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 14:09:50,630 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 853  tflops: 39.78  mfu: 4.02%
[rank2]:2025-10-25 14:09:50,628 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.04/0.04, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank2]:2025-10-25 14:09:50,629 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 853  tflops: 39.78  mfu: 4.02%
[rank1]:2025-10-25 14:09:50,991 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1409_stage1_step200.svg
[rank3]:2025-10-25 14:09:50,919 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1409_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3616.29 ms, GPU Bubble Ratio: 33.70%, 23.80%, 30.32%, 21.92%
[rank3]:2025-10-25 14:09:50,919 - INFO - 	> Batch Time: 3616.29 ms (Average Freeze Ratio: 0.57)
[rank3]:2025-10-25 14:09:50,919 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 14:09:50,923 - INFO -  step: 200  loss:  1.0076  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 852  tflops: 39.75  mfu: 4.02%
[rank2]:2025-10-25 14:09:50,989 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1409_stage2_step200.svg
[rank0]:2025-10-25 14:09:50,991 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1409_stage0_step200.svg
[rank3]:2025-10-25 14:09:51,272 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1409_real_step200_rank3.svg
[rank3]:> Batch Time: 5512.38 ms, GPU Bubble Ratio: 35.20%, 27.44%, 35.86%, 25.14%
[rank3]:2025-10-25 14:09:51,334 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1409_stage3_step200.svg
[rank3]:2025-10-25 14:09:54,327 - INFO - Avg. fwd time: 172.7378 / Avg. bwd time: 264.2783 / Avg. batch time: 3509.6942 (ms) / GPU bubble ratio: 0.39%
[rank2]:2025-10-25 14:09:54,484 - INFO - Avg. fwd time: 146.3870 / Avg. bwd time: 226.8513 / Avg. batch time: 3884.7088 (ms) / GPU bubble ratio: 23.14%
[rank1]:2025-10-25 14:09:55,061 - INFO - Avg. fwd time: 167.2277 / Avg. bwd time: 255.1875 / Avg. batch time: 4387.9112 (ms) / GPU bubble ratio: 22.99%
[rank0]:2025-10-25 14:09:55,776 - INFO - Avg. fwd time: 147.9934 / Avg. bwd time: 217.4841 / Avg. batch time: 4838.0618 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-25 14:14:45,817 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,110  tflops: 51.77  mfu: 5.23%
[rank1]:2025-10-25 14:14:45,816 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,110  tflops: 51.77  mfu: 5.24%
[rank2]:2025-10-25 14:14:45,815 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,110  tflops: 51.77  mfu: 5.24%
[rank3]:2025-10-25 14:14:45,817 - INFO -  step: 220  loss:  0.9821  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank3]:2025-10-25 14:14:49,161 - INFO - Avg. fwd time: 172.7683 / Avg. bwd time: 256.6066 / Avg. batch time: 3448.0982 (ms) / GPU bubble ratio: 0.38%
[rank2]:2025-10-25 14:14:49,319 - INFO - Avg. fwd time: 146.4044 / Avg. bwd time: 220.2937 / Avg. batch time: 3816.4558 (ms) / GPU bubble ratio: 23.13%
[rank0]:2025-10-25 14:14:49,498 - INFO - Avg. fwd time: 147.9553 / Avg. bwd time: 197.7355 / Avg. batch time: 4727.4072 (ms) / GPU bubble ratio: 41.50%
[rank1]:2025-10-25 14:14:49,495 - INFO - Avg. fwd time: 167.2053 / Avg. bwd time: 247.8087 / Avg. batch time: 4304.7654 (ms) / GPU bubble ratio: 22.87%
[rank3]:2025-10-25 14:19:39,861 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1419_rank3_trend_line.svg
[rank2]:2025-10-25 14:19:39,857 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1419_rank2_trend_line.svg
[rank2]:2025-10-25 14:19:39,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-25 14:19:39,898 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank0]:2025-10-25 14:19:39,893 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1419_rank0_trend_line.svg
[rank0]:2025-10-25 14:19:39,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 14:19:39,899 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank1]:2025-10-25 14:19:39,887 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1419_rank1_trend_line.svg
[rank1]:2025-10-25 14:19:39,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.93/0.93, [MB4] 0.93/0.93, [MB5] 0.93/0.93, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank1]:2025-10-25 14:19:39,899 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank3]:2025-10-25 14:19:40,192 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1419_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3623.40 ms, GPU Bubble Ratio: 43.28%, 23.46%, 33.02%, 22.08%
[rank3]:2025-10-25 14:19:40,192 - INFO - 	> Batch Time: 3623.40 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-10-25 14:19:40,192 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 14:19:40,196 - INFO -  step: 240  loss:  0.9399  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 14:19:43,238 - INFO - Avg. fwd time: 172.8088 / Avg. bwd time: 250.2246 / Avg. batch time: 3396.9899 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-25 14:19:43,396 - INFO - Avg. fwd time: 146.4194 / Avg. bwd time: 214.8284 / Avg. batch time: 3759.8004 (ms) / GPU bubble ratio: 23.13%
[rank0]:2025-10-25 14:19:43,575 - INFO - Avg. fwd time: 147.9142 / Avg. bwd time: 181.2750 / Avg. batch time: 4635.4161 (ms) / GPU bubble ratio: 43.19%
[rank1]:2025-10-25 14:19:43,572 - INFO - Avg. fwd time: 167.1711 / Avg. bwd time: 241.6580 / Avg. batch time: 4235.6978 (ms) / GPU bubble ratio: 22.78%
[rank3]:2025-10-25 14:21:41,851 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 14:21:43,866 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 14:21:44,037 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 14:21:44,039 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 14:22:26,320 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 14:25:50,225 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 885  tflops: 41.27  mfu: 4.17%
[rank1]:2025-10-25 14:25:50,224 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 885  tflops: 41.27  mfu: 4.17%
[rank3]:2025-10-25 14:25:50,225 - INFO -  step: 260  loss:  0.9142  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 886  tflops: 41.30  mfu: 4.18%
[rank2]:2025-10-25 14:25:50,244 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.1149  memory: 71.04GiB(50.81%)  tps: 885  tflops: 41.27  mfu: 4.17%
[rank3]:2025-10-25 14:25:53,776 - INFO - Avg. fwd time: 172.8671 / Avg. bwd time: 246.7585 / Avg. batch time: 3369.4307 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-25 14:25:54,684 - INFO - Avg. fwd time: 146.4223 / Avg. bwd time: 221.0697 / Avg. batch time: 3785.6536 (ms) / GPU bubble ratio: 22.34%
[rank1]:2025-10-25 14:25:54,861 - INFO - Avg. fwd time: 167.1258 / Avg. bwd time: 236.4491 / Avg. batch time: 4251.0450 (ms) / GPU bubble ratio: 24.05%
[rank0]:2025-10-25 14:25:54,864 - INFO - Avg. fwd time: 147.8803 / Avg. bwd time: 167.3445 / Avg. batch time: 4631.3678 (ms) / GPU bubble ratio: 45.55%
[rank0]:2025-10-25 14:32:01,045 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank1]:2025-10-25 14:32:01,044 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank2]:2025-10-25 14:32:01,064 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.1166  memory: 71.04GiB(50.81%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank3]:2025-10-25 14:32:01,045 - INFO -  step: 280  loss:  0.9808  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank3]:2025-10-25 14:32:04,598 - INFO - Avg. fwd time: 172.9286 / Avg. bwd time: 243.7941 / Avg. batch time: 3345.9583 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 14:32:05,505 - INFO - Avg. fwd time: 146.4241 / Avg. bwd time: 226.4200 / Avg. batch time: 3807.9048 (ms) / GPU bubble ratio: 21.67%
[rank1]:2025-10-25 14:32:05,682 - INFO - Avg. fwd time: 167.0853 / Avg. bwd time: 231.9837 / Avg. batch time: 4264.2929 (ms) / GPU bubble ratio: 25.13%
[rank0]:2025-10-25 14:32:05,686 - INFO - Avg. fwd time: 147.8518 / Avg. bwd time: 155.4022 / Avg. batch time: 4627.9906 (ms) / GPU bubble ratio: 47.58%
[rank0]:2025-10-25 14:37:53,385 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 14:38:11,930 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank2]:2025-10-25 14:38:11,949 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.1220  memory: 71.04GiB(50.81%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank3]:2025-10-25 14:38:11,930 - INFO -  step: 300  loss:  0.9713  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank1]:2025-10-25 14:38:11,930 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 884  tflops: 41.21  mfu: 4.17%
[rank1]:2025-10-25 14:38:12,012 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1438_stage1_step300.svg
[rank0]:2025-10-25 14:38:12,017 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1438_stage0_step300.svg
[rank2]:2025-10-25 14:38:12,015 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1438_stage2_step300.svg
[rank3]:2025-10-25 14:38:12,282 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1438_real_step300_rank3.svg
[rank3]:> Batch Time: 4709.38 ms, GPU Bubble Ratio: 49.57%, 42.05%, 24.90%, 35.75%
[rank3]:2025-10-25 14:38:12,341 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1438_stage3_step300.svg
[rank3]:2025-10-25 14:38:15,568 - INFO - Avg. fwd time: 172.9846 / Avg. bwd time: 241.2240 / Avg. batch time: 3325.6312 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 14:38:16,475 - INFO - Avg. fwd time: 146.4258 / Avg. bwd time: 231.0580 / Avg. batch time: 3827.2141 (ms) / GPU bubble ratio: 21.09%
[rank0]:2025-10-25 14:38:16,656 - INFO - Avg. fwd time: 147.8276 / Avg. bwd time: 145.0509 / Avg. batch time: 4625.0865 (ms) / GPU bubble ratio: 49.34%
[rank1]:2025-10-25 14:38:16,652 - INFO - Avg. fwd time: 167.0496 / Avg. bwd time: 228.1129 / Avg. batch time: 4275.7969 (ms) / GPU bubble ratio: 26.07%
[rank2]:2025-10-25 14:44:22,869 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1444_rank2_trend_line.svg
[rank2]:2025-10-25 14:44:22,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.52/0.52, [MB2] 0.52/0.52, [MB3] 0.52/0.52, [MB4] 0.52/0.52, [MB5] 0.67/0.67, [MB6] 0.84/0.84, [MB7] 1.00/1.00
[rank2]:2025-10-25 14:44:22,899 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.1511  memory: 71.04GiB(50.81%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank3]:2025-10-25 14:44:22,850 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1444_rank3_trend_line.svg
[rank0]:2025-10-25 14:44:22,892 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1444_rank0_trend_line.svg
[rank0]:2025-10-25 14:44:22,898 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 14:44:22,899 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank1]:2025-10-25 14:44:22,882 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1444_rank1_trend_line.svg
[rank1]:2025-10-25 14:44:22,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.83/0.83, [MB2] 0.83/0.83, [MB3] 0.83/0.83, [MB4] 0.99/0.99, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 14:44:22,898 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 883  tflops: 41.20  mfu: 4.17%
[rank3]:2025-10-25 14:44:23,201 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1444_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3672.70 ms, GPU Bubble Ratio: 53.27%, 22.69%, 31.57%, 21.03%
[rank3]:2025-10-25 14:44:23,201 - INFO - 	> Batch Time: 3672.70 ms (Average Freeze Ratio: 0.67)
[rank3]:2025-10-25 14:44:23,201 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 14:44:23,206 - INFO -  step: 320  loss:  0.9803  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 883  tflops: 41.16  mfu: 4.16%
[rank3]:2025-10-25 14:44:26,439 - INFO - Avg. fwd time: 173.0198 / Avg. bwd time: 238.9694 / Avg. batch time: 3307.6913 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-25 14:44:27,326 - INFO - Avg. fwd time: 146.4262 / Avg. bwd time: 235.1133 / Avg. batch time: 3843.9708 (ms) / GPU bubble ratio: 20.59%
[rank0]:2025-10-25 14:44:27,506 - INFO - Avg. fwd time: 147.7995 / Avg. bwd time: 135.9926 / Avg. batch time: 4622.4074 (ms) / GPU bubble ratio: 50.88%
[rank1]:2025-10-25 14:44:27,503 - INFO - Avg. fwd time: 167.0110 / Avg. bwd time: 224.7260 / Avg. batch time: 4285.7247 (ms) / GPU bubble ratio: 26.88%
[rank3]:2025-10-25 14:46:38,753 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 14:46:39,812 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 14:46:39,986 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 14:46:39,983 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 14:49:18,661 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,108  tflops: 51.67  mfu: 5.22%
[rank3]:2025-10-25 14:49:18,662 - INFO -  step: 340  loss:  0.8792  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,109  tflops: 51.73  mfu: 5.23%
[rank0]:2025-10-25 14:49:18,662 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,108  tflops: 51.67  mfu: 5.22%
[rank1]:2025-10-25 14:49:18,662 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,108  tflops: 51.67  mfu: 5.22%
[rank3]:2025-10-25 14:49:22,004 - INFO - Avg. fwd time: 173.0535 / Avg. bwd time: 235.5176 / Avg. batch time: 3280.1761 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 14:49:22,162 - INFO - Avg. fwd time: 146.4348 / Avg. bwd time: 230.3832 / Avg. batch time: 3802.6639 (ms) / GPU bubble ratio: 20.73%
[rank0]:2025-10-25 14:49:22,343 - INFO - Avg. fwd time: 147.7758 / Avg. bwd time: 127.9991 / Avg. batch time: 4563.9541 (ms) / GPU bubble ratio: 51.66%
[rank1]:2025-10-25 14:49:22,339 - INFO - Avg. fwd time: 167.0029 / Avg. bwd time: 221.7399 / Avg. batch time: 4238.3965 (ms) / GPU bubble ratio: 26.62%
[rank0]:2025-10-25 14:51:30,872 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 14:54:12,536 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 14:54:12,536 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 14:54:12,535 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 14:54:12,536 - INFO -  step: 360  loss:  0.9763  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 14:54:15,886 - INFO - Avg. fwd time: 173.0653 / Avg. bwd time: 232.4322 / Avg. batch time: 3255.4362 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 14:54:16,045 - INFO - Avg. fwd time: 146.4430 / Avg. bwd time: 226.1782 / Avg. batch time: 3765.6642 (ms) / GPU bubble ratio: 20.84%
[rank0]:2025-10-25 14:54:16,225 - INFO - Avg. fwd time: 147.7529 / Avg. bwd time: 120.8932 / Avg. batch time: 4511.7109 (ms) / GPU bubble ratio: 52.36%
[rank1]:2025-10-25 14:54:16,222 - INFO - Avg. fwd time: 166.9895 / Avg. bwd time: 219.0851 / Avg. batch time: 4196.0434 (ms) / GPU bubble ratio: 26.39%
[rank1]:2025-10-25 14:59:06,563 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank0]:2025-10-25 14:59:06,563 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank2]:2025-10-25 14:59:06,562 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank3]:2025-10-25 14:59:06,563 - INFO -  step: 380  loss:  0.9267  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.98  mfu: 5.26%
[rank3]:2025-10-25 14:59:09,913 - INFO - Avg. fwd time: 173.0827 / Avg. bwd time: 229.6767 / Avg. batch time: 3233.3990 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 14:59:10,071 - INFO - Avg. fwd time: 146.4505 / Avg. bwd time: 222.4159 / Avg. batch time: 3732.6576 (ms) / GPU bubble ratio: 20.94%
[rank1]:2025-10-25 14:59:10,249 - INFO - Avg. fwd time: 166.9817 / Avg. bwd time: 216.7101 / Avg. batch time: 4158.2487 (ms) / GPU bubble ratio: 26.18%
[rank0]:2025-10-25 14:59:10,252 - INFO - Avg. fwd time: 147.7354 / Avg. bwd time: 114.5347 / Avg. batch time: 4465.0671 (ms) / GPU bubble ratio: 53.01%
[rank0]:2025-10-25 15:03:45,873 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-25 15:04:00,561 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank2]:2025-10-25 15:04:00,560 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank3]:2025-10-25 15:04:00,561 - INFO -  step: 400  loss:  0.9270  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank1]:2025-10-25 15:04:00,561 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank1]:2025-10-25 15:04:00,631 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1504_stage1_step400.svg
[rank0]:2025-10-25 15:04:00,635 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1504_stage0_step400.svg
[rank2]:2025-10-25 15:04:00,632 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1504_stage2_step400.svg
[rank3]:2025-10-25 15:04:00,840 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1504_real_step400_rank3.svg
[rank3]:> Batch Time: 3616.38 ms, GPU Bubble Ratio: 67.35%, 24.58%, 33.34%, 21.75%
[rank3]:2025-10-25 15:04:00,902 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1504_stage3_step400.svg
[rank3]:2025-10-25 15:04:03,982 - INFO - Avg. fwd time: 173.0948 / Avg. bwd time: 227.1951 / Avg. batch time: 3213.5256 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:04:04,141 - INFO - Avg. fwd time: 146.4573 / Avg. bwd time: 219.0295 / Avg. batch time: 3702.9123 (ms) / GPU bubble ratio: 21.04%
[rank1]:2025-10-25 15:04:04,319 - INFO - Avg. fwd time: 166.9724 / Avg. bwd time: 214.5724 / Avg. batch time: 4124.1913 (ms) / GPU bubble ratio: 25.99%
[rank0]:2025-10-25 15:04:04,322 - INFO - Avg. fwd time: 147.7173 / Avg. bwd time: 108.8118 / Avg. batch time: 4423.0464 (ms) / GPU bubble ratio: 53.60%
[rank3]:2025-10-25 15:06:48,136 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 15:06:49,188 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 15:06:49,363 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 15:06:49,364 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 15:08:54,957 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank0]:2025-10-25 15:08:54,957 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank2]:2025-10-25 15:08:54,956 - INFO -  step: 420  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank3]:2025-10-25 15:08:54,957 - INFO -  step: 420  loss:  0.8575  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank3]:2025-10-25 15:08:58,302 - INFO - Avg. fwd time: 173.0968 / Avg. bwd time: 224.9424 / Avg. batch time: 3195.4136 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:08:58,461 - INFO - Avg. fwd time: 146.4630 / Avg. bwd time: 215.9652 / Avg. batch time: 3675.8687 (ms) / GPU bubble ratio: 21.12%
[rank1]:2025-10-25 15:08:58,639 - INFO - Avg. fwd time: 166.9604 / Avg. bwd time: 212.6378 / Avg. batch time: 4093.2472 (ms) / GPU bubble ratio: 25.81%
[rank0]:2025-10-25 15:08:58,643 - INFO - Avg. fwd time: 147.7026 / Avg. bwd time: 103.6335 / Avg. batch time: 4384.9004 (ms) / GPU bubble ratio: 54.15%
[rank0]:2025-10-25 15:13:48,770 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank2]:2025-10-25 15:13:48,769 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 15:13:48,770 - INFO -  step: 440  loss:  0.9402  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank1]:2025-10-25 15:13:48,770 - INFO -  step: 440  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 15:13:52,119 - INFO - Avg. fwd time: 173.0985 / Avg. bwd time: 222.8928 / Avg. batch time: 3178.9347 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:13:52,277 - INFO - Avg. fwd time: 146.4684 / Avg. bwd time: 213.1792 / Avg. batch time: 3651.2697 (ms) / GPU bubble ratio: 21.20%
[rank1]:2025-10-25 15:13:52,455 - INFO - Avg. fwd time: 166.9500 / Avg. bwd time: 210.8789 / Avg. batch time: 4065.1017 (ms) / GPU bubble ratio: 25.64%
[rank0]:2025-10-25 15:13:52,459 - INFO - Avg. fwd time: 147.6916 / Avg. bwd time: 98.9257 / Avg. batch time: 4350.2084 (ms) / GPU bubble ratio: 54.65%
[rank0]:2025-10-25 15:16:01,265 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 15:18:43,052 - INFO -  step: 460  loss:  1.0064  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank1]:2025-10-25 15:18:43,052 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank0]:2025-10-25 15:18:43,053 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank2]:2025-10-25 15:18:43,051 - INFO -  step: 460  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank3]:2025-10-25 15:18:46,409 - INFO - Avg. fwd time: 173.1124 / Avg. bwd time: 221.0352 / Avg. batch time: 3164.0990 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:18:46,568 - INFO - Avg. fwd time: 146.4734 / Avg. bwd time: 210.6357 / Avg. batch time: 3629.0208 (ms) / GPU bubble ratio: 21.28%
[rank1]:2025-10-25 15:18:46,746 - INFO - Avg. fwd time: 166.9460 / Avg. bwd time: 209.2734 / Avg. batch time: 4039.6164 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-10-25 15:18:46,750 - INFO - Avg. fwd time: 147.6801 / Avg. bwd time: 94.6271 / Avg. batch time: 4318.7453 (ms) / GPU bubble ratio: 55.12%
[rank3]:2025-10-25 15:23:36,918 - INFO -  step: 480  loss:  0.9805  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 15:23:36,918 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank0]:2025-10-25 15:23:36,919 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 15:23:36,917 - INFO -  step: 480  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 15:23:40,254 - INFO - Avg. fwd time: 173.1117 / Avg. bwd time: 219.3190 / Avg. batch time: 3150.2856 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 15:23:40,413 - INFO - Avg. fwd time: 146.4777 / Avg. bwd time: 208.3036 / Avg. batch time: 3608.4106 (ms) / GPU bubble ratio: 21.34%
[rank1]:2025-10-25 15:23:40,591 - INFO - Avg. fwd time: 166.9320 / Avg. bwd time: 207.8011 / Avg. batch time: 4016.0383 (ms) / GPU bubble ratio: 25.35%
[rank0]:2025-10-25 15:23:40,595 - INFO - Avg. fwd time: 147.6630 / Avg. bwd time: 90.6865 / Avg. batch time: 4289.6884 (ms) / GPU bubble ratio: 55.55%
[rank3]:2025-10-25 15:26:57,878 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 15:26:58,937 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 15:26:59,111 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 15:26:59,112 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 15:28:16,926 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 15:28:31,624 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank0]:2025-10-25 15:28:31,625 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 15:28:31,625 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-25 15:28:31,624 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank1]:2025-10-25 15:28:31,624 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 15:28:31,623 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank2]:2025-10-25 15:28:31,623 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 15:28:31,624 - INFO -  step: 500  loss:  0.8713  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank3]:2025-10-25 15:28:31,624 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 15:28:42,830 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.21 seconds.
[rank1]:2025-10-25 15:28:43,419 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.80 seconds.
[rank3]:2025-10-25 15:28:44,160 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.54 seconds.
[rank0]:2025-10-25 15:28:45,994 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 15:28:45,999 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.37 seconds.
[rank0]:2025-10-25 15:28:46,193 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1528_stage0_step500.svg
[rank1]:2025-10-25 15:28:46,186 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1528_stage1_step500.svg
[rank2]:2025-10-25 15:28:46,184 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1528_stage2_step500.svg
[rank3]:2025-10-25 15:28:46,422 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1528_real_step500_rank3.svg
[rank3]:> Batch Time: 3614.00 ms, GPU Bubble Ratio: 67.34%, 24.55%, 33.32%, 21.77%
[rank3]:2025-10-25 15:28:46,478 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1528_stage3_step500.svg
[rank3]:2025-10-25 15:28:49,933 - INFO - Avg. fwd time: 173.1197 / Avg. bwd time: 217.7480 / Avg. batch time: 3137.8993 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:28:50,094 - INFO - Avg. fwd time: 146.4817 / Avg. bwd time: 206.1584 / Avg. batch time: 3589.7716 (ms) / GPU bubble ratio: 21.41%
[rank0]:2025-10-25 15:28:50,278 - INFO - Avg. fwd time: 147.6510 / Avg. bwd time: 87.0610 / Avg. batch time: 4263.2801 (ms) / GPU bubble ratio: 55.96%
[rank1]:2025-10-25 15:28:50,272 - INFO - Avg. fwd time: 166.9238 / Avg. bwd time: 206.4466 / Avg. batch time: 3994.6699 (ms) / GPU bubble ratio: 25.23%
[rank0]:2025-10-25 15:33:40,847 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,060  tflops: 49.42  mfu: 5.00%
[rank1]:2025-10-25 15:33:40,845 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,060  tflops: 49.42  mfu: 5.00%
[rank3]:2025-10-25 15:33:40,847 - INFO -  step: 520  loss:  0.9656  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,060  tflops: 49.42  mfu: 5.00%
[rank2]:2025-10-25 15:33:40,845 - INFO -  step: 520  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,060  tflops: 49.42  mfu: 5.00%
[rank3]:2025-10-25 15:33:44,204 - INFO - Avg. fwd time: 173.1295 / Avg. bwd time: 216.2976 / Avg. batch time: 3126.3013 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:33:44,363 - INFO - Avg. fwd time: 146.4856 / Avg. bwd time: 204.1785 / Avg. batch time: 3572.4052 (ms) / GPU bubble ratio: 21.47%
[rank0]:2025-10-25 15:33:44,548 - INFO - Avg. fwd time: 147.6398 / Avg. bwd time: 83.7143 / Avg. batch time: 4238.7433 (ms) / GPU bubble ratio: 56.34%
[rank1]:2025-10-25 15:33:44,542 - INFO - Avg. fwd time: 166.9246 / Avg. bwd time: 205.1970 / Avg. batch time: 3974.7858 (ms) / GPU bubble ratio: 25.10%
[rank0]:2025-10-25 15:38:35,203 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank1]:2025-10-25 15:38:35,202 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 15:38:35,202 - INFO -  step: 540  loss:  0.9554  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank2]:2025-10-25 15:38:35,201 - INFO -  step: 540  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 15:38:38,546 - INFO - Avg. fwd time: 173.1361 / Avg. bwd time: 214.9527 / Avg. batch time: 3115.5277 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:38:38,706 - INFO - Avg. fwd time: 146.4895 / Avg. bwd time: 202.3451 / Avg. batch time: 3556.2890 (ms) / GPU bubble ratio: 21.53%
[rank0]:2025-10-25 15:38:38,890 - INFO - Avg. fwd time: 147.6292 / Avg. bwd time: 80.6153 / Avg. batch time: 4215.9888 (ms) / GPU bubble ratio: 56.69%
[rank1]:2025-10-25 15:38:38,884 - INFO - Avg. fwd time: 166.9212 / Avg. bwd time: 204.0394 / Avg. batch time: 3956.3368 (ms) / GPU bubble ratio: 24.99%
[rank0]:2025-10-25 15:40:50,070 - INFO - [GC] Peforming periodical GC collection 2.36 seconds
[rank1]:2025-10-25 15:43:31,968 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,104  tflops: 51.50  mfu: 5.21%
[rank0]:2025-10-25 15:43:31,969 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,104  tflops: 51.50  mfu: 5.21%
[rank3]:2025-10-25 15:43:31,969 - INFO -  step: 560  loss:  0.9776  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,104  tflops: 51.50  mfu: 5.21%
[rank2]:2025-10-25 15:43:31,968 - INFO -  step: 560  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,104  tflops: 51.50  mfu: 5.21%
[rank3]:2025-10-25 15:43:35,322 - INFO - Avg. fwd time: 173.1463 / Avg. bwd time: 213.7099 / Avg. batch time: 3105.6051 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:43:35,482 - INFO - Avg. fwd time: 146.4934 / Avg. bwd time: 200.6427 / Avg. batch time: 3541.4062 (ms) / GPU bubble ratio: 21.58%
[rank1]:2025-10-25 15:43:35,660 - INFO - Avg. fwd time: 166.9211 / Avg. bwd time: 202.9649 / Avg. batch time: 3939.2884 (ms) / GPU bubble ratio: 24.88%
[rank0]:2025-10-25 15:43:35,664 - INFO - Avg. fwd time: 147.6201 / Avg. bwd time: 77.7376 / Avg. batch time: 4194.9402 (ms) / GPU bubble ratio: 57.02%
[rank3]:2025-10-25 15:47:26,993 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 15:47:27,141 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 15:47:27,318 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 15:47:27,320 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 15:48:26,853 - INFO -  step: 580  loss:  0.8662  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank2]:2025-10-25 15:48:26,852 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank1]:2025-10-25 15:48:26,853 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank0]:2025-10-25 15:48:26,854 - INFO -  step: 580  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank3]:2025-10-25 15:48:30,209 - INFO - Avg. fwd time: 173.1581 / Avg. bwd time: 212.5524 / Avg. batch time: 3096.3819 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-25 15:48:30,369 - INFO - Avg. fwd time: 146.4969 / Avg. bwd time: 199.0578 / Avg. batch time: 3527.5635 (ms) / GPU bubble ratio: 21.63%
[rank1]:2025-10-25 15:48:30,547 - INFO - Avg. fwd time: 166.9245 / Avg. bwd time: 201.9647 / Avg. batch time: 3923.4309 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-25 15:48:30,552 - INFO - Avg. fwd time: 147.6116 / Avg. bwd time: 75.0583 / Avg. batch time: 4175.3557 (ms) / GPU bubble ratio: 57.34%
[rank0]:2025-10-25 15:53:06,007 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 15:53:20,700 - INFO -  step: 600  loss:  0.9687  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 15:53:20,699 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 15:53:20,769 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1553_stage2_step600.svg
[rank1]:2025-10-25 15:53:20,700 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 15:53:20,767 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1553_stage1_step600.svg
[rank0]:2025-10-25 15:53:20,700 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank0]:2025-10-25 15:53:20,772 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1553_stage0_step600.svg
[rank3]:2025-10-25 15:53:20,986 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1553_real_step600_rank3.svg
[rank3]:> Batch Time: 3613.50 ms, GPU Bubble Ratio: 67.35%, 24.54%, 33.31%, 21.77%
[rank3]:2025-10-25 15:53:21,045 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1553_stage3_step600.svg
[rank3]:2025-10-25 15:53:24,124 - INFO - Avg. fwd time: 173.1621 / Avg. bwd time: 211.4668 / Avg. batch time: 3087.6761 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 15:53:24,283 - INFO - Avg. fwd time: 146.4997 / Avg. bwd time: 197.5781 / Avg. batch time: 3514.5462 (ms) / GPU bubble ratio: 21.68%
[rank1]:2025-10-25 15:53:24,462 - INFO - Avg. fwd time: 166.9231 / Avg. bwd time: 201.0307 / Avg. batch time: 3908.5309 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-10-25 15:53:24,466 - INFO - Avg. fwd time: 147.6027 / Avg. bwd time: 72.5575 / Avg. batch time: 4156.9766 (ms) / GPU bubble ratio: 57.63%
[rank1]:2025-10-25 15:58:14,381 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank0]:2025-10-25 15:58:14,381 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank2]:2025-10-25 15:58:14,380 - INFO -  step: 620  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank3]:2025-10-25 15:58:14,381 - INFO -  step: 620  loss:  0.9698  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank3]:2025-10-25 15:58:17,731 - INFO - Avg. fwd time: 173.1592 / Avg. bwd time: 210.4464 / Avg. batch time: 3079.4402 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 15:58:17,891 - INFO - Avg. fwd time: 146.5021 / Avg. bwd time: 196.1935 / Avg. batch time: 3502.2777 (ms) / GPU bubble ratio: 21.72%
[rank1]:2025-10-25 15:58:18,069 - INFO - Avg. fwd time: 166.9138 / Avg. bwd time: 200.1566 / Avg. batch time: 3894.5005 (ms) / GPU bubble ratio: 24.60%
[rank0]:2025-10-25 15:58:18,074 - INFO - Avg. fwd time: 147.5924 / Avg. bwd time: 70.2180 / Avg. batch time: 4139.6916 (ms) / GPU bubble ratio: 57.91%
[rank2]:2025-10-25 16:03:08,522 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1603_rank2_trend_line.svg
[rank3]:2025-10-25 16:03:08,523 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1603_rank3_trend_line.svg
[rank1]:2025-10-25 16:03:08,593 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1603_rank1_trend_line.svg
[rank1]:2025-10-25 16:03:08,601 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-25 16:03:08,603 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.94  mfu: 5.25%
[rank0]:2025-10-25 16:03:08,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1603_rank0_trend_line.svg
[rank0]:2025-10-25 16:03:08,602 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 16:03:08,603 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.94  mfu: 5.25%
[rank2]:2025-10-25 16:03:08,602 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.71/0.71, [MB2] 0.75/0.75, [MB3] 0.80/0.80, [MB4] 0.85/0.85, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-25 16:03:08,604 - INFO -  step: 640  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.94  mfu: 5.25%
[rank3]:2025-10-25 16:03:08,893 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1603_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3625.40 ms, GPU Bubble Ratio: 61.55%, 23.65%, 34.92%, 21.25%
[rank3]:2025-10-25 16:03:08,893 - INFO - 	> Batch Time: 3625.40 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-10-25 16:03:08,894 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 16:03:08,900 - INFO -  step: 640  loss:  0.9473  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.89  mfu: 5.25%
[rank3]:2025-10-25 16:03:11,953 - INFO - Avg. fwd time: 173.1620 / Avg. bwd time: 209.4947 / Avg. batch time: 3071.8021 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:03:12,112 - INFO - Avg. fwd time: 146.5045 / Avg. bwd time: 194.8958 / Avg. batch time: 3490.8590 (ms) / GPU bubble ratio: 21.76%
[rank1]:2025-10-25 16:03:12,290 - INFO - Avg. fwd time: 166.9086 / Avg. bwd time: 199.3371 / Avg. batch time: 3881.4311 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-10-25 16:03:12,295 - INFO - Avg. fwd time: 147.5842 / Avg. bwd time: 68.0246 / Avg. batch time: 4123.5712 (ms) / GPU bubble ratio: 58.17%
[rank0]:2025-10-25 16:05:21,023 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 16:07:39,587 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 16:07:40,640 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 16:07:40,814 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 16:07:40,814 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 16:08:03,473 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank0]:2025-10-25 16:08:03,473 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank3]:2025-10-25 16:08:03,474 - INFO -  step: 660  loss:  0.8761  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank2]:2025-10-25 16:08:03,472 - INFO -  step: 660  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,111  tflops: 51.83  mfu: 5.24%
[rank3]:2025-10-25 16:08:06,824 - INFO - Avg. fwd time: 173.1723 / Avg. bwd time: 208.6077 / Avg. batch time: 3064.7461 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:08:06,984 - INFO - Avg. fwd time: 146.5071 / Avg. bwd time: 193.6770 / Avg. batch time: 3480.2527 (ms) / GPU bubble ratio: 21.80%
[rank1]:2025-10-25 16:08:07,165 - INFO - Avg. fwd time: 166.9072 / Avg. bwd time: 198.5677 / Avg. batch time: 3869.2744 (ms) / GPU bubble ratio: 24.44%
[rank0]:2025-10-25 16:08:07,171 - INFO - Avg. fwd time: 147.5789 / Avg. bwd time: 65.9642 / Avg. batch time: 4108.5496 (ms) / GPU bubble ratio: 58.42%
[rank0]:2025-10-25 16:12:57,326 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 16:12:57,325 - INFO -  step: 680  loss:  0.9573  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 16:12:57,325 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 16:12:57,324 - INFO -  step: 680  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 16:13:00,674 - INFO - Avg. fwd time: 173.1753 / Avg. bwd time: 207.7654 / Avg. batch time: 3057.9909 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:13:00,834 - INFO - Avg. fwd time: 146.5096 / Avg. bwd time: 192.5293 / Avg. batch time: 3470.1543 (ms) / GPU bubble ratio: 21.84%
[rank0]:2025-10-25 16:13:01,018 - INFO - Avg. fwd time: 147.5725 / Avg. bwd time: 64.0249 / Avg. batch time: 4094.2937 (ms) / GPU bubble ratio: 58.66%
[rank1]:2025-10-25 16:13:01,013 - INFO - Avg. fwd time: 166.9013 / Avg. bwd time: 197.8432 / Avg. batch time: 3857.7153 (ms) / GPU bubble ratio: 24.36%
[rank0]:2025-10-25 16:17:36,718 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 16:17:51,391 - INFO -  step: 700  loss:  0.9615  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank0]:2025-10-25 16:17:51,391 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank1]:2025-10-25 16:17:51,391 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank2]:2025-10-25 16:17:51,390 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank0]:2025-10-25 16:17:51,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1617_stage0_step700.svg
[rank1]:2025-10-25 16:17:51,461 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1617_stage1_step700.svg
[rank2]:2025-10-25 16:17:51,461 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1617_stage2_step700.svg
[rank3]:2025-10-25 16:17:51,675 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1617_real_step700_rank3.svg
[rank3]:> Batch Time: 3613.38 ms, GPU Bubble Ratio: 67.35%, 24.54%, 33.31%, 21.77%
[rank3]:2025-10-25 16:17:51,736 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1617_stage3_step700.svg
[rank3]:2025-10-25 16:17:54,805 - INFO - Avg. fwd time: 173.1816 / Avg. bwd time: 206.9737 / Avg. batch time: 3051.6691 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:17:54,964 - INFO - Avg. fwd time: 146.5115 / Avg. bwd time: 191.4477 / Avg. batch time: 3460.6799 (ms) / GPU bubble ratio: 21.87%
[rank0]:2025-10-25 16:17:55,147 - INFO - Avg. fwd time: 147.5683 / Avg. bwd time: 62.1964 / Avg. batch time: 4080.9002 (ms) / GPU bubble ratio: 58.88%
[rank1]:2025-10-25 16:17:55,143 - INFO - Avg. fwd time: 166.8994 / Avg. bwd time: 197.1599 / Avg. batch time: 3846.8650 (ms) / GPU bubble ratio: 24.29%
[rank1]:2025-10-25 16:22:45,475 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank2]:2025-10-25 16:22:45,474 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank3]:2025-10-25 16:22:45,475 - INFO -  step: 720  loss:  0.9561  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank0]:2025-10-25 16:22:45,475 - INFO -  step: 720  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank3]:2025-10-25 16:22:48,825 - INFO - Avg. fwd time: 173.1875 / Avg. bwd time: 206.2275 / Avg. batch time: 3045.7111 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:22:48,985 - INFO - Avg. fwd time: 146.5138 / Avg. bwd time: 190.4260 / Avg. batch time: 3451.7448 (ms) / GPU bubble ratio: 21.91%
[rank1]:2025-10-25 16:22:49,165 - INFO - Avg. fwd time: 166.8964 / Avg. bwd time: 196.5149 / Avg. batch time: 3836.6307 (ms) / GPU bubble ratio: 24.22%
[rank0]:2025-10-25 16:22:49,171 - INFO - Avg. fwd time: 147.5629 / Avg. bwd time: 60.4694 / Avg. batch time: 4068.2644 (ms) / GPU bubble ratio: 59.09%
[rank1]:2025-10-25 16:27:39,247 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank2]:2025-10-25 16:27:39,246 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 16:27:39,247 - INFO -  step: 740  loss:  0.9122  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank0]:2025-10-25 16:27:39,248 - INFO -  step: 740  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 16:27:42,591 - INFO - Avg. fwd time: 173.1870 / Avg. bwd time: 205.5154 / Avg. batch time: 3039.9760 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:27:42,752 - INFO - Avg. fwd time: 146.5158 / Avg. bwd time: 189.4593 / Avg. batch time: 3443.1934 (ms) / GPU bubble ratio: 21.94%
[rank1]:2025-10-25 16:27:42,931 - INFO - Avg. fwd time: 166.8894 / Avg. bwd time: 195.9043 / Avg. batch time: 3826.8494 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-10-25 16:27:42,936 - INFO - Avg. fwd time: 147.5575 / Avg. bwd time: 58.8357 / Avg. batch time: 4056.2108 (ms) / GPU bubble ratio: 59.29%
[rank3]:2025-10-25 16:27:49,074 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 16:27:50,130 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 16:27:50,302 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 16:27:50,304 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 16:29:52,473 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 16:32:34,375 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,110  tflops: 51.78  mfu: 5.24%
[rank2]:2025-10-25 16:32:34,374 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,110  tflops: 51.78  mfu: 5.24%
[rank3]:2025-10-25 16:32:34,375 - INFO -  step: 760  loss:  0.9742  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,110  tflops: 51.78  mfu: 5.24%
[rank0]:2025-10-25 16:32:34,376 - INFO -  step: 760  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,110  tflops: 51.78  mfu: 5.24%
[rank3]:2025-10-25 16:32:37,730 - INFO - Avg. fwd time: 173.1962 / Avg. bwd time: 204.8504 / Avg. batch time: 3034.6987 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:32:37,890 - INFO - Avg. fwd time: 146.5176 / Avg. bwd time: 188.5437 / Avg. batch time: 3435.2483 (ms) / GPU bubble ratio: 21.97%
[rank0]:2025-10-25 16:32:38,076 - INFO - Avg. fwd time: 147.5539 / Avg. bwd time: 57.2880 / Avg. batch time: 4044.9505 (ms) / GPU bubble ratio: 59.49%
[rank1]:2025-10-25 16:32:38,070 - INFO - Avg. fwd time: 166.8898 / Avg. bwd time: 195.3264 / Avg. batch time: 3817.7404 (ms) / GPU bubble ratio: 24.10%
[rank1]:2025-10-25 16:37:28,354 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank2]:2025-10-25 16:37:28,354 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 16:37:28,355 - INFO -  step: 780  loss:  0.9613  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank0]:2025-10-25 16:37:28,355 - INFO -  step: 780  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 16:37:31,710 - INFO - Avg. fwd time: 173.1973 / Avg. bwd time: 204.2125 / Avg. batch time: 3029.5734 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:37:31,871 - INFO - Avg. fwd time: 146.5193 / Avg. bwd time: 187.6749 / Avg. batch time: 3427.5922 (ms) / GPU bubble ratio: 22.00%
[rank1]:2025-10-25 16:37:32,051 - INFO - Avg. fwd time: 166.8861 / Avg. bwd time: 194.7778 / Avg. batch time: 3808.9798 (ms) / GPU bubble ratio: 24.04%
[rank0]:2025-10-25 16:37:32,057 - INFO - Avg. fwd time: 147.5496 / Avg. bwd time: 55.8197 / Avg. batch time: 4034.1504 (ms) / GPU bubble ratio: 59.67%
[rank0]:2025-10-25 16:42:07,637 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 16:42:22,354 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank0]:2025-10-25 16:42:22,355 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank1]:2025-10-25 16:42:22,354 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank3]:2025-10-25 16:42:22,355 - INFO -  step: 800  loss:  0.9299  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 51.98  mfu: 5.26%
[rank2]:2025-10-25 16:42:22,431 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1642_stage2_step800.svg
[rank0]:2025-10-25 16:42:22,432 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1642_stage0_step800.svg
[rank1]:2025-10-25 16:42:22,431 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1642_stage1_step800.svg
[rank3]:2025-10-25 16:42:22,631 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1642_real_step800_rank3.svg
[rank3]:> Batch Time: 3613.25 ms, GPU Bubble Ratio: 67.36%, 24.54%, 33.31%, 21.77%
[rank3]:2025-10-25 16:42:22,695 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1642_stage3_step800.svg
[rank3]:2025-10-25 16:42:25,776 - INFO - Avg. fwd time: 173.1977 / Avg. bwd time: 203.6059 / Avg. batch time: 3024.6952 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:42:25,937 - INFO - Avg. fwd time: 146.5208 / Avg. bwd time: 186.8495 / Avg. batch time: 3420.3094 (ms) / GPU bubble ratio: 22.03%
[rank1]:2025-10-25 16:42:26,116 - INFO - Avg. fwd time: 166.8818 / Avg. bwd time: 194.2565 / Avg. batch time: 3800.6469 (ms) / GPU bubble ratio: 23.98%
[rank0]:2025-10-25 16:42:26,121 - INFO - Avg. fwd time: 147.5459 / Avg. bwd time: 54.4247 / Avg. batch time: 4023.8794 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-25 16:47:16,485 - INFO -  step: 820  loss:  0.9294  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank0]:2025-10-25 16:47:16,486 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank2]:2025-10-25 16:47:16,484 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank1]:2025-10-25 16:47:16,485 - INFO -  step: 820  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank3]:2025-10-25 16:47:19,832 - INFO - Avg. fwd time: 173.1995 / Avg. bwd time: 203.0303 / Avg. batch time: 3020.0785 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:47:19,992 - INFO - Avg. fwd time: 146.5224 / Avg. bwd time: 186.0642 / Avg. batch time: 3413.4054 (ms) / GPU bubble ratio: 22.05%
[rank1]:2025-10-25 16:47:20,172 - INFO - Avg. fwd time: 166.8784 / Avg. bwd time: 193.7608 / Avg. batch time: 3792.7445 (ms) / GPU bubble ratio: 23.93%
[rank0]:2025-10-25 16:47:20,179 - INFO - Avg. fwd time: 147.5427 / Avg. bwd time: 53.0978 / Avg. batch time: 4014.1342 (ms) / GPU bubble ratio: 60.01%
[rank3]:2025-10-25 16:48:00,334 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 16:48:00,483 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 16:48:00,663 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 16:48:00,660 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 16:52:10,771 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank1]:2025-10-25 16:52:10,772 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank3]:2025-10-25 16:52:10,772 - INFO -  step: 840  loss:  0.8850  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank0]:2025-10-25 16:52:10,772 - INFO -  step: 840  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.93  mfu: 5.25%
[rank3]:2025-10-25 16:52:14,123 - INFO - Avg. fwd time: 173.1969 / Avg. bwd time: 202.4775 / Avg. batch time: 3015.6086 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:52:14,283 - INFO - Avg. fwd time: 146.5238 / Avg. bwd time: 185.3163 / Avg. batch time: 3406.7571 (ms) / GPU bubble ratio: 22.07%
[rank1]:2025-10-25 16:52:14,463 - INFO - Avg. fwd time: 166.8729 / Avg. bwd time: 193.2887 / Avg. batch time: 3785.1451 (ms) / GPU bubble ratio: 23.88%
[rank0]:2025-10-25 16:52:14,469 - INFO - Avg. fwd time: 147.5386 / Avg. bwd time: 51.8340 / Avg. batch time: 4004.7794 (ms) / GPU bubble ratio: 60.17%
[rank0]:2025-10-25 16:54:22,950 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 16:57:04,604 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 16:57:04,603 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 16:57:04,602 - INFO -  step: 860  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 16:57:04,603 - INFO -  step: 860  loss:  0.9581  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 16:57:07,962 - INFO - Avg. fwd time: 173.1967 / Avg. bwd time: 201.9530 / Avg. batch time: 3011.3872 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 16:57:08,123 - INFO - Avg. fwd time: 146.5250 / Avg. bwd time: 184.6032 / Avg. batch time: 3400.4593 (ms) / GPU bubble ratio: 22.10%
[rank0]:2025-10-25 16:57:08,309 - INFO - Avg. fwd time: 147.5356 / Avg. bwd time: 50.6290 / Avg. batch time: 3995.9002 (ms) / GPU bubble ratio: 60.33%
[rank1]:2025-10-25 16:57:08,303 - INFO - Avg. fwd time: 166.8688 / Avg. bwd time: 192.8385 / Avg. batch time: 3777.9410 (ms) / GPU bubble ratio: 23.83%
[rank2]:2025-10-25 17:01:58,393 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 17:01:58,394 - INFO -  step: 880  loss:  0.9830  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank0]:2025-10-25 17:01:58,395 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank1]:2025-10-25 17:01:58,394 - INFO -  step: 880  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 17:02:01,744 - INFO - Avg. fwd time: 173.1961 / Avg. bwd time: 201.4516 / Avg. batch time: 3007.3472 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:02:01,905 - INFO - Avg. fwd time: 146.5262 / Avg. bwd time: 183.9225 / Avg. batch time: 3394.4371 (ms) / GPU bubble ratio: 22.12%
[rank0]:2025-10-25 17:02:02,091 - INFO - Avg. fwd time: 147.5323 / Avg. bwd time: 49.4787 / Avg. batch time: 3987.4130 (ms) / GPU bubble ratio: 60.47%
[rank1]:2025-10-25 17:02:02,085 - INFO - Avg. fwd time: 166.8648 / Avg. bwd time: 192.4089 / Avg. batch time: 3771.0532 (ms) / GPU bubble ratio: 23.78%
[rank0]:2025-10-25 17:06:37,815 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 17:06:52,530 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank2]:2025-10-25 17:06:52,529 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank3]:2025-10-25 17:06:52,530 - INFO -  step: 900  loss:  0.9073  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank0]:2025-10-25 17:06:52,530 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank0]:2025-10-25 17:06:52,598 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1706_stage0_step900.svg
[rank1]:2025-10-25 17:06:52,595 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1706_stage1_step900.svg
[rank2]:2025-10-25 17:06:52,596 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1706_stage2_step900.svg
[rank3]:2025-10-25 17:06:52,808 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1706_real_step900_rank3.svg
[rank3]:> Batch Time: 3613.13 ms, GPU Bubble Ratio: 67.35%, 24.54%, 33.31%, 21.77%
[rank3]:2025-10-25 17:06:52,863 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1706_stage3_step900.svg
[rank3]:2025-10-25 17:06:55,949 - INFO - Avg. fwd time: 173.2012 / Avg. bwd time: 200.9774 / Avg. batch time: 3003.5718 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:06:56,110 - INFO - Avg. fwd time: 146.5275 / Avg. bwd time: 183.2722 / Avg. batch time: 3388.7675 (ms) / GPU bubble ratio: 22.14%
[rank0]:2025-10-25 17:06:56,296 - INFO - Avg. fwd time: 147.5293 / Avg. bwd time: 48.3796 / Avg. batch time: 3979.3891 (ms) / GPU bubble ratio: 60.62%
[rank1]:2025-10-25 17:06:56,290 - INFO - Avg. fwd time: 166.8637 / Avg. bwd time: 191.9984 / Avg. batch time: 3764.5578 (ms) / GPU bubble ratio: 23.74%
[rank3]:2025-10-25 17:08:09,469 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:08:09,626 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:08:09,804 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:08:09,803 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:11:46,962 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank2]:2025-10-25 17:11:46,961 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank1]:2025-10-25 17:11:46,962 - INFO -  step: 920  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank3]:2025-10-25 17:11:46,962 - INFO -  step: 920  loss:  0.8605  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.91  mfu: 5.25%
[rank3]:2025-10-25 17:11:50,310 - INFO - Avg. fwd time: 173.2010 / Avg. bwd time: 200.5185 / Avg. batch time: 2999.8778 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:11:50,471 - INFO - Avg. fwd time: 146.5286 / Avg. bwd time: 182.6503 / Avg. batch time: 3383.2614 (ms) / GPU bubble ratio: 22.16%
[rank0]:2025-10-25 17:11:50,657 - INFO - Avg. fwd time: 147.5254 / Avg. bwd time: 47.3282 / Avg. batch time: 3971.6305 (ms) / GPU bubble ratio: 60.75%
[rank1]:2025-10-25 17:11:50,651 - INFO - Avg. fwd time: 166.8593 / Avg. bwd time: 191.6054 / Avg. batch time: 3758.2606 (ms) / GPU bubble ratio: 23.70%
[rank3]:2025-10-25 17:16:40,836 - INFO -  step: 940  loss:  0.9553  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 17:16:40,836 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank0]:2025-10-25 17:16:40,836 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank2]:2025-10-25 17:16:40,835 - INFO -  step: 940  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 17:16:44,186 - INFO - Avg. fwd time: 173.2022 / Avg. bwd time: 200.0815 / Avg. batch time: 2996.3712 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:16:44,347 - INFO - Avg. fwd time: 146.5298 / Avg. bwd time: 182.0547 / Avg. batch time: 3378.0201 (ms) / GPU bubble ratio: 22.18%
[rank1]:2025-10-25 17:16:44,527 - INFO - Avg. fwd time: 166.8565 / Avg. bwd time: 191.2294 / Avg. batch time: 3752.2622 (ms) / GPU bubble ratio: 23.65%
[rank0]:2025-10-25 17:16:44,533 - INFO - Avg. fwd time: 147.5221 / Avg. bwd time: 46.3216 / Avg. batch time: 3964.2321 (ms) / GPU bubble ratio: 60.88%
[rank0]:2025-10-25 17:18:53,223 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 17:21:34,963 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank3]:2025-10-25 17:21:34,964 - INFO -  step: 960  loss:  0.9606  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank1]:2025-10-25 17:21:34,964 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank0]:2025-10-25 17:21:34,964 - INFO -  step: 960  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.96  mfu: 5.25%
[rank3]:2025-10-25 17:21:38,318 - INFO - Avg. fwd time: 173.2068 / Avg. bwd time: 199.6656 / Avg. batch time: 2993.0612 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:21:38,479 - INFO - Avg. fwd time: 146.5310 / Avg. bwd time: 181.4840 / Avg. batch time: 3373.0477 (ms) / GPU bubble ratio: 22.20%
[rank1]:2025-10-25 17:21:38,659 - INFO - Avg. fwd time: 166.8564 / Avg. bwd time: 190.8691 / Avg. batch time: 3746.5645 (ms) / GPU bubble ratio: 23.62%
[rank0]:2025-10-25 17:21:38,665 - INFO - Avg. fwd time: 147.5201 / Avg. bwd time: 45.3569 / Avg. batch time: 3957.1926 (ms) / GPU bubble ratio: 61.01%
[rank3]:2025-10-25 17:26:28,728 - INFO -  step: 980  loss:  0.9698  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.03  mfu: 5.26%
[rank0]:2025-10-25 17:26:28,729 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank2]:2025-10-25 17:26:28,727 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank1]:2025-10-25 17:26:28,728 - INFO -  step: 980  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank3]:2025-10-25 17:26:32,078 - INFO - Avg. fwd time: 173.2059 / Avg. bwd time: 199.2612 / Avg. batch time: 2989.8008 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:26:32,240 - INFO - Avg. fwd time: 146.5322 / Avg. bwd time: 180.9364 / Avg. batch time: 3368.1926 (ms) / GPU bubble ratio: 22.22%
[rank1]:2025-10-25 17:26:32,420 - INFO - Avg. fwd time: 166.8529 / Avg. bwd time: 190.5233 / Avg. batch time: 3741.0133 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-25 17:26:32,426 - INFO - Avg. fwd time: 147.5171 / Avg. bwd time: 44.4315 / Avg. batch time: 3950.3547 (ms) / GPU bubble ratio: 61.13%
[rank3]:2025-10-25 17:28:22,333 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:28:22,490 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:28:22,668 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:28:22,666 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:31:08,419 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-25 17:31:23,097 - INFO -  step: 1000  loss:  0.9036  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank3]:2025-10-25 17:31:23,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 17:31:23,097 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank0]:2025-10-25 17:31:23,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 17:31:23,100 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 17:31:23,096 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank2]:2025-10-25 17:31:23,096 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 17:31:23,096 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,113  tflops: 51.92  mfu: 5.25%
[rank1]:2025-10-25 17:31:23,096 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 17:31:34,044 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.95 seconds.
[rank1]:2025-10-25 17:31:35,066 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.97 seconds.
[rank3]:2025-10-25 17:31:35,592 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.49 seconds.
[rank0]:2025-10-25 17:31:36,884 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 17:31:36,888 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.79 seconds.
[rank0]:2025-10-25 17:31:37,081 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1731_stage0_step1000.svg
[rank2]:2025-10-25 17:31:37,106 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1731_stage2_step1000.svg
[rank1]:2025-10-25 17:31:37,116 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1731_stage1_step1000.svg
[rank3]:2025-10-25 17:31:37,331 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1731_real_step1000_rank3.svg
[rank3]:> Batch Time: 3612.88 ms, GPU Bubble Ratio: 67.36%, 24.54%, 33.30%, 21.77%
[rank3]:2025-10-25 17:31:37,390 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1731_stage3_step1000.svg
[rank3]:2025-10-25 17:31:40,441 - INFO - Avg. fwd time: 173.2051 / Avg. bwd time: 198.8737 / Avg. batch time: 2986.6758 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:31:40,602 - INFO - Avg. fwd time: 146.5332 / Avg. bwd time: 180.4107 / Avg. batch time: 3363.5370 (ms) / GPU bubble ratio: 22.24%
[rank1]:2025-10-25 17:31:40,783 - INFO - Avg. fwd time: 166.8510 / Avg. bwd time: 190.1915 / Avg. batch time: 3735.6890 (ms) / GPU bubble ratio: 23.54%
[rank0]:2025-10-25 17:31:40,793 - INFO - Avg. fwd time: 147.5151 / Avg. bwd time: 43.5432 / Avg. batch time: 3943.7962 (ms) / GPU bubble ratio: 61.24%
[rank3]:2025-10-25 17:36:31,534 - INFO -  step: 1020  loss:  0.9111  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,062  tflops: 49.55  mfu: 5.01%
[rank1]:2025-10-25 17:36:31,533 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,062  tflops: 49.55  mfu: 5.01%
[rank0]:2025-10-25 17:36:31,535 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,062  tflops: 49.55  mfu: 5.01%
[rank2]:2025-10-25 17:36:31,533 - INFO -  step: 1020  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,062  tflops: 49.55  mfu: 5.01%
[rank3]:2025-10-25 17:36:34,899 - INFO - Avg. fwd time: 173.2097 / Avg. bwd time: 198.5050 / Avg. batch time: 2983.7466 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:36:35,061 - INFO - Avg. fwd time: 146.5343 / Avg. bwd time: 179.9057 / Avg. batch time: 3359.1375 (ms) / GPU bubble ratio: 22.26%
[rank1]:2025-10-25 17:36:35,242 - INFO - Avg. fwd time: 166.8550 / Avg. bwd time: 189.8730 / Avg. batch time: 3730.6487 (ms) / GPU bubble ratio: 23.50%
[rank0]:2025-10-25 17:36:35,251 - INFO - Avg. fwd time: 147.5147 / Avg. bwd time: 42.6897 / Avg. batch time: 3937.5721 (ms) / GPU bubble ratio: 61.36%
[rank3]:2025-10-25 17:41:26,112 - INFO -  step: 1040  loss:  0.9446  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank1]:2025-10-25 17:41:26,112 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank0]:2025-10-25 17:41:26,114 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank2]:2025-10-25 17:41:26,111 - INFO -  step: 1040  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.88  mfu: 5.25%
[rank3]:2025-10-25 17:41:29,470 - INFO - Avg. fwd time: 173.2142 / Avg. bwd time: 198.1511 / Avg. batch time: 2980.9343 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:41:29,633 - INFO - Avg. fwd time: 146.5354 / Avg. bwd time: 179.4202 / Avg. batch time: 3354.9118 (ms) / GPU bubble ratio: 22.27%
[rank1]:2025-10-25 17:41:29,814 - INFO - Avg. fwd time: 166.8565 / Avg. bwd time: 189.5665 / Avg. batch time: 3725.8066 (ms) / GPU bubble ratio: 23.47%
[rank0]:2025-10-25 17:41:29,823 - INFO - Avg. fwd time: 147.5146 / Avg. bwd time: 41.8690 / Avg. batch time: 3931.5917 (ms) / GPU bubble ratio: 61.46%
[rank0]:2025-10-25 17:43:40,785 - INFO - [GC] Peforming periodical GC collection 2.21 seconds
[rank0]:2025-10-25 17:46:22,700 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,105  tflops: 51.53  mfu: 5.21%
[rank2]:2025-10-25 17:46:22,699 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,105  tflops: 51.53  mfu: 5.21%
[rank1]:2025-10-25 17:46:22,700 - INFO -  step: 1060  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,105  tflops: 51.53  mfu: 5.21%
[rank3]:2025-10-25 17:46:22,708 - INFO -  step: 1060  loss:  0.9406  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,105  tflops: 51.53  mfu: 5.21%
[rank3]:2025-10-25 17:46:26,058 - INFO - Avg. fwd time: 173.2185 / Avg. bwd time: 197.8104 / Avg. batch time: 2978.2269 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:46:26,220 - INFO - Avg. fwd time: 146.5362 / Avg. bwd time: 178.9530 / Avg. batch time: 3350.8444 (ms) / GPU bubble ratio: 22.29%
[rank1]:2025-10-25 17:46:26,401 - INFO - Avg. fwd time: 166.8580 / Avg. bwd time: 189.2717 / Avg. batch time: 3721.1462 (ms) / GPU bubble ratio: 23.44%
[rank0]:2025-10-25 17:46:26,408 - INFO - Avg. fwd time: 147.5146 / Avg. bwd time: 41.0793 / Avg. batch time: 3925.8346 (ms) / GPU bubble ratio: 61.57%
[rank3]:2025-10-25 17:48:49,443 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 17:48:49,592 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 17:48:49,771 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:48:49,769 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 17:51:17,359 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank2]:2025-10-25 17:51:17,358 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank0]:2025-10-25 17:51:17,359 - INFO -  step: 1080  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank3]:2025-10-25 17:51:17,359 - INFO -  step: 1080  loss:  0.8759  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank3]:2025-10-25 17:51:20,710 - INFO - Avg. fwd time: 173.2217 / Avg. bwd time: 197.4820 / Avg. batch time: 2975.6106 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:51:20,871 - INFO - Avg. fwd time: 146.5371 / Avg. bwd time: 178.5031 / Avg. batch time: 3346.9186 (ms) / GPU bubble ratio: 22.31%
[rank1]:2025-10-25 17:51:21,052 - INFO - Avg. fwd time: 166.8589 / Avg. bwd time: 188.9878 / Avg. batch time: 3716.6488 (ms) / GPU bubble ratio: 23.40%
[rank0]:2025-10-25 17:51:21,060 - INFO - Avg. fwd time: 147.5143 / Avg. bwd time: 40.3188 / Avg. batch time: 3920.2802 (ms) / GPU bubble ratio: 61.67%
[rank0]:2025-10-25 17:55:56,424 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 17:56:11,051 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank0]:2025-10-25 17:56:11,052 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank3]:2025-10-25 17:56:11,052 - INFO -  step: 1100  loss:  0.9473  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank1]:2025-10-25 17:56:11,052 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,116  tflops: 52.04  mfu: 5.26%
[rank1]:2025-10-25 17:56:11,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1756_stage1_step1100.svg
[rank2]:2025-10-25 17:56:11,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1756_stage2_step1100.svg
[rank0]:2025-10-25 17:56:11,125 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1756_stage0_step1100.svg
[rank3]:2025-10-25 17:56:11,338 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1756_real_step1100_rank3.svg
[rank3]:> Batch Time: 3613.38 ms, GPU Bubble Ratio: 67.36%, 24.55%, 33.31%, 21.77%
[rank3]:2025-10-25 17:56:11,396 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1756_stage3_step1100.svg
[rank3]:2025-10-25 17:56:14,467 - INFO - Avg. fwd time: 173.2196 / Avg. bwd time: 197.1611 / Avg. batch time: 2973.0127 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 17:56:14,628 - INFO - Avg. fwd time: 146.5378 / Avg. bwd time: 178.0694 / Avg. batch time: 3343.0581 (ms) / GPU bubble ratio: 22.32%
[rank1]:2025-10-25 17:56:14,808 - INFO - Avg. fwd time: 166.8557 / Avg. bwd time: 188.7141 / Avg. batch time: 3712.2369 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-25 17:56:14,815 - INFO - Avg. fwd time: 147.5122 / Avg. bwd time: 39.5860 / Avg. batch time: 3914.8495 (ms) / GPU bubble ratio: 61.77%
[rank2]:2025-10-25 18:01:05,005 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank0]:2025-10-25 18:01:05,007 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank1]:2025-10-25 18:01:05,006 - INFO -  step: 1120  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 18:01:05,006 - INFO -  step: 1120  loss:  0.9444  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 18:01:08,359 - INFO - Avg. fwd time: 173.2196 / Avg. bwd time: 196.8538 / Avg. batch time: 2970.5390 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-25 18:01:08,521 - INFO - Avg. fwd time: 146.5387 / Avg. bwd time: 177.6513 / Avg. batch time: 3339.3669 (ms) / GPU bubble ratio: 22.33%
[rank1]:2025-10-25 18:01:08,701 - INFO - Avg. fwd time: 166.8545 / Avg. bwd time: 188.4501 / Avg. batch time: 3708.0148 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-25 18:01:08,709 - INFO - Avg. fwd time: 147.5108 / Avg. bwd time: 38.8793 / Avg. batch time: 3909.6460 (ms) / GPU bubble ratio: 61.86%
[rank2]:2025-10-25 18:05:58,958 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank1]:2025-10-25 18:05:58,959 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank0]:2025-10-25 18:05:58,959 - INFO -  step: 1140  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 18:05:58,959 - INFO -  step: 1140  loss:  0.9475  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 51.99  mfu: 5.26%
[rank3]:2025-10-25 18:06:02,310 - INFO - Avg. fwd time: 173.2203 / Avg. bwd time: 196.5573 / Avg. batch time: 2968.1599 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:06:02,471 - INFO - Avg. fwd time: 146.5393 / Avg. bwd time: 177.2479 / Avg. batch time: 3335.8131 (ms) / GPU bubble ratio: 22.35%
[rank1]:2025-10-25 18:06:02,652 - INFO - Avg. fwd time: 166.8535 / Avg. bwd time: 188.1953 / Avg. batch time: 3703.9481 (ms) / GPU bubble ratio: 23.31%
[rank0]:2025-10-25 18:06:02,661 - INFO - Avg. fwd time: 147.5097 / Avg. bwd time: 38.1974 / Avg. batch time: 3904.6322 (ms) / GPU bubble ratio: 61.95%
[rank0]:2025-10-25 18:08:11,356 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 18:08:57,950 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:08:59,006 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:08:59,182 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:08:59,181 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:10:53,678 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank3]:2025-10-25 18:10:53,680 - INFO -  step: 1160  loss:  0.8613  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank0]:2025-10-25 18:10:53,680 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank1]:2025-10-25 18:10:53,679 - INFO -  step: 1160  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.86  mfu: 5.24%
[rank3]:2025-10-25 18:10:57,027 - INFO - Avg. fwd time: 173.2226 / Avg. bwd time: 196.2734 / Avg. batch time: 2965.8938 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:10:57,189 - INFO - Avg. fwd time: 146.5400 / Avg. bwd time: 176.8583 / Avg. batch time: 3332.4127 (ms) / GPU bubble ratio: 22.36%
[rank0]:2025-10-25 18:10:57,378 - INFO - Avg. fwd time: 147.5093 / Avg. bwd time: 37.5390 / Avg. batch time: 3899.8225 (ms) / GPU bubble ratio: 62.04%
[rank1]:2025-10-25 18:10:57,370 - INFO - Avg. fwd time: 166.8542 / Avg. bwd time: 187.9494 / Avg. batch time: 3700.0531 (ms) / GPU bubble ratio: 23.29%
[rank2]:2025-10-25 18:15:47,528 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank0]:2025-10-25 18:15:47,529 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 18:15:47,529 - INFO -  step: 1180  loss:  0.9419  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank1]:2025-10-25 18:15:47,529 - INFO -  step: 1180  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.01  mfu: 5.26%
[rank3]:2025-10-25 18:15:50,880 - INFO - Avg. fwd time: 173.2230 / Avg. bwd time: 195.9970 / Avg. batch time: 2963.6728 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:15:51,042 - INFO - Avg. fwd time: 146.5406 / Avg. bwd time: 176.4820 / Avg. batch time: 3329.0963 (ms) / GPU bubble ratio: 22.38%
[rank0]:2025-10-25 18:15:51,232 - INFO - Avg. fwd time: 147.5085 / Avg. bwd time: 36.9030 / Avg. batch time: 3895.1439 (ms) / GPU bubble ratio: 62.12%
[rank1]:2025-10-25 18:15:51,223 - INFO - Avg. fwd time: 166.8534 / Avg. bwd time: 187.7118 / Avg. batch time: 3696.2582 (ms) / GPU bubble ratio: 23.26%
[rank0]:2025-10-25 18:20:26,626 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 18:20:41,339 - INFO -  step: 1200  loss:  0.9658  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank1]:2025-10-25 18:20:41,339 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank2]:2025-10-25 18:20:41,338 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank0]:2025-10-25 18:20:41,340 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.02  mfu: 5.26%
[rank0]:2025-10-25 18:20:41,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1820_stage0_step1200.svg
[rank1]:2025-10-25 18:20:41,413 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1820_stage1_step1200.svg
[rank2]:2025-10-25 18:20:41,412 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1820_stage2_step1200.svg
[rank3]:2025-10-25 18:20:41,624 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1820_real_step1200_rank3.svg
[rank3]:> Batch Time: 3613.13 ms, GPU Bubble Ratio: 67.35%, 24.54%, 33.31%, 21.77%
[rank3]:2025-10-25 18:20:41,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1820_stage3_step1200.svg
[rank3]:2025-10-25 18:20:44,766 - INFO - Avg. fwd time: 173.2225 / Avg. bwd time: 195.7286 / Avg. batch time: 2961.5099 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:20:44,928 - INFO - Avg. fwd time: 146.5413 / Avg. bwd time: 176.1181 / Avg. batch time: 3325.8740 (ms) / GPU bubble ratio: 22.39%
[rank0]:2025-10-25 18:20:45,116 - INFO - Avg. fwd time: 147.5069 / Avg. bwd time: 36.2881 / Avg. batch time: 3890.6048 (ms) / GPU bubble ratio: 62.21%
[rank1]:2025-10-25 18:20:45,109 - INFO - Avg. fwd time: 166.8521 / Avg. bwd time: 187.4821 / Avg. batch time: 3692.5738 (ms) / GPU bubble ratio: 23.23%
[rank2]:2025-10-25 18:25:35,405 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank3]:2025-10-25 18:25:35,407 - INFO -  step: 1220  loss:  0.9397  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank1]:2025-10-25 18:25:35,406 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank0]:2025-10-25 18:25:35,407 - INFO -  step: 1220  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,114  tflops: 51.97  mfu: 5.25%
[rank3]:2025-10-25 18:25:38,747 - INFO - Avg. fwd time: 173.2248 / Avg. bwd time: 195.4717 / Avg. batch time: 2959.4608 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:25:38,910 - INFO - Avg. fwd time: 146.5419 / Avg. bwd time: 175.7663 / Avg. batch time: 3322.8004 (ms) / GPU bubble ratio: 22.40%
[rank1]:2025-10-25 18:25:39,091 - INFO - Avg. fwd time: 166.8519 / Avg. bwd time: 187.2600 / Avg. batch time: 3689.0535 (ms) / GPU bubble ratio: 23.21%
[rank0]:2025-10-25 18:25:39,099 - INFO - Avg. fwd time: 147.5059 / Avg. bwd time: 35.6934 / Avg. batch time: 3886.2576 (ms) / GPU bubble ratio: 62.29%
[rank3]:2025-10-25 18:29:10,982 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:29:12,035 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:29:12,212 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:29:12,210 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:30:30,050 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank3]:2025-10-25 18:30:30,051 - INFO -  step: 1240  loss:  0.8883  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank1]:2025-10-25 18:30:30,050 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank0]:2025-10-25 18:30:30,051 - INFO -  step: 1240  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.87  mfu: 5.24%
[rank3]:2025-10-25 18:30:33,405 - INFO - Avg. fwd time: 173.2274 / Avg. bwd time: 195.2235 / Avg. batch time: 2957.4851 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:30:33,567 - INFO - Avg. fwd time: 146.5426 / Avg. bwd time: 175.4257 / Avg. batch time: 3319.8331 (ms) / GPU bubble ratio: 22.41%
[rank1]:2025-10-25 18:30:33,748 - INFO - Avg. fwd time: 166.8521 / Avg. bwd time: 187.0450 / Avg. batch time: 3685.6538 (ms) / GPU bubble ratio: 23.18%
[rank0]:2025-10-25 18:30:33,757 - INFO - Avg. fwd time: 147.5054 / Avg. bwd time: 35.1179 / Avg. batch time: 3882.0584 (ms) / GPU bubble ratio: 62.37%
[rank0]:2025-10-25 18:32:42,395 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 18:35:23,969 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,115  tflops: 52.00  mfu: 5.26%
[rank3]:2025-10-25 18:35:23,970 - INFO -  step: 1260  loss:  0.9896  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,115  tflops: 52.00  mfu: 5.26%
[rank1]:2025-10-25 18:35:23,969 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,115  tflops: 52.00  mfu: 5.26%
[rank0]:2025-10-25 18:35:23,970 - INFO -  step: 1260  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,115  tflops: 52.00  mfu: 5.26%
[rank3]:2025-10-25 18:35:27,315 - INFO - Avg. fwd time: 173.2276 / Avg. bwd time: 194.9816 / Avg. batch time: 2955.5398 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:35:27,477 - INFO - Avg. fwd time: 146.5431 / Avg. bwd time: 175.0960 / Avg. batch time: 3316.9278 (ms) / GPU bubble ratio: 22.42%
[rank1]:2025-10-25 18:35:27,658 - INFO - Avg. fwd time: 166.8504 / Avg. bwd time: 186.8368 / Avg. batch time: 3682.3293 (ms) / GPU bubble ratio: 23.16%
[rank0]:2025-10-25 18:35:27,666 - INFO - Avg. fwd time: 147.5038 / Avg. bwd time: 34.5606 / Avg. batch time: 3877.9593 (ms) / GPU bubble ratio: 62.44%
[rank3]:2025-10-25 18:40:18,358 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1840_rank3_trend_line.svg
[rank2]:2025-10-25 18:40:18,353 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1840_rank2_trend_line.svg
[rank1]:2025-10-25 18:40:18,501 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1840_rank1_trend_line.svg
[rank1]:2025-10-25 18:40:18,512 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-10-25 18:40:18,514 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 79.85GiB(57.11%)  tps: 1,112  tflops: 51.89  mfu: 5.25%
[rank2]:2025-10-25 18:40:18,512 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.52/0.52, [MB1] 0.52/0.52, [MB2] 0.58/0.58, [MB3] 0.66/0.66, [MB4] 0.75/0.75, [MB5] 0.83/0.83, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-25 18:40:18,515 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 1,112  tflops: 51.89  mfu: 5.25%
[rank0]:2025-10-25 18:40:18,506 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule_adjustment/251025_1840_rank0_trend_line.svg
[rank0]:2025-10-25 18:40:18,512 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-25 18:40:18,515 - INFO -  step: 1280  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 1,112  tflops: 51.89  mfu: 5.25%
[rank3]:2025-10-25 18:40:18,804 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1840_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 3612.34 ms, GPU Bubble Ratio: 64.57%, 24.26%, 31.39%, 21.43%
[rank3]:2025-10-25 18:40:18,804 - INFO - 	> Batch Time: 3612.34 ms (Average Freeze Ratio: 0.46)
[rank3]:2025-10-25 18:40:18,805 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-25 18:40:18,812 - INFO -  step: 1280  loss:  0.9846  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 1,111  tflops: 51.84  mfu: 5.24%
[rank3]:2025-10-25 18:40:21,870 - INFO - Avg. fwd time: 173.2288 / Avg. bwd time: 194.7465 / Avg. batch time: 2953.6585 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:40:22,032 - INFO - Avg. fwd time: 146.5437 / Avg. bwd time: 174.7764 / Avg. batch time: 3314.1165 (ms) / GPU bubble ratio: 22.44%
[rank1]:2025-10-25 18:40:22,213 - INFO - Avg. fwd time: 166.8498 / Avg. bwd time: 186.6351 / Avg. batch time: 3679.1119 (ms) / GPU bubble ratio: 23.14%
[rank0]:2025-10-25 18:40:22,220 - INFO - Avg. fwd time: 147.5029 / Avg. bwd time: 34.0208 / Avg. batch time: 3873.9914 (ms) / GPU bubble ratio: 62.51%
[rank0]:2025-10-25 18:46:30,136 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 18:46:49,787 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1794  memory: 79.85GiB(57.11%)  tps: 837  tflops: 39.06  mfu: 3.95%
[rank0]:2025-10-25 18:46:49,765 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 838  tflops: 39.06  mfu: 3.95%
[rank3]:2025-10-25 18:46:49,766 - INFO -  step: 1300  loss:  0.9161  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 838  tflops: 39.09  mfu: 3.95%
[rank2]:2025-10-25 18:46:49,765 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 838  tflops: 39.06  mfu: 3.95%
[rank2]:2025-10-25 18:46:49,859 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1846_stage2_step1300.svg
[rank1]:2025-10-25 18:46:49,859 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1846_stage1_step1300.svg
[rank0]:2025-10-25 18:46:49,863 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1846_stage0_step1300.svg
[rank3]:2025-10-25 18:46:50,069 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1846_real_step1300_rank3.svg
[rank3]:> Batch Time: 3612.88 ms, GPU Bubble Ratio: 67.35%, 24.53%, 33.30%, 21.77%
[rank3]:2025-10-25 18:46:50,129 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1846_stage3_step1300.svg
[rank3]:2025-10-25 18:46:53,226 - INFO - Avg. fwd time: 173.2218 / Avg. bwd time: 194.5597 / Avg. batch time: 2952.0971 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:46:53,922 - INFO - Avg. fwd time: 146.5443 / Avg. bwd time: 174.4657 / Avg. batch time: 3319.9846 (ms) / GPU bubble ratio: 22.65%
[rank1]:2025-10-25 18:46:54,768 - INFO - Avg. fwd time: 166.8607 / Avg. bwd time: 188.8902 / Avg. batch time: 3694.9245 (ms) / GPU bubble ratio: 22.98%
[rank0]:2025-10-25 18:46:54,776 - INFO - Avg. fwd time: 147.5023 / Avg. bwd time: 33.4975 / Avg. batch time: 3889.0771 (ms) / GPU bubble ratio: 62.77%
[rank3]:2025-10-25 18:52:22,023 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 18:52:22,684 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:52:23,357 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 18:52:23,351 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 18:53:22,821 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.1668  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank0]:2025-10-25 18:53:22,799 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank2]:2025-10-25 18:53:22,799 - INFO -  step: 1320  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank3]:2025-10-25 18:53:22,800 - INFO -  step: 1320  loss:  0.8588  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank3]:2025-10-25 18:53:26,164 - INFO - Avg. fwd time: 173.2134 / Avg. bwd time: 194.3774 / Avg. batch time: 2950.5615 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:53:26,855 - INFO - Avg. fwd time: 146.5448 / Avg. bwd time: 174.1644 / Avg. batch time: 3325.6625 (ms) / GPU bubble ratio: 22.85%
[rank1]:2025-10-25 18:53:27,702 - INFO - Avg. fwd time: 166.8713 / Avg. bwd time: 191.0771 / Avg. batch time: 3710.2456 (ms) / GPU bubble ratio: 22.82%
[rank0]:2025-10-25 18:53:27,710 - INFO - Avg. fwd time: 147.5011 / Avg. bwd time: 32.9901 / Avg. batch time: 3903.6935 (ms) / GPU bubble ratio: 63.01%
[rank3]:2025-10-25 18:59:55,106 - INFO -  step: 1340  loss:  0.9214  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank0]:2025-10-25 18:59:55,105 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank1]:2025-10-25 18:59:55,127 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.1678  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank2]:2025-10-25 18:59:55,105 - INFO -  step: 1340  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 18:59:58,472 - INFO - Avg. fwd time: 173.2061 / Avg. bwd time: 194.2006 / Avg. batch time: 2949.0787 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 18:59:59,164 - INFO - Avg. fwd time: 146.5454 / Avg. bwd time: 173.8722 / Avg. batch time: 3331.1786 (ms) / GPU bubble ratio: 23.05%
[rank0]:2025-10-25 19:00:00,020 - INFO - Avg. fwd time: 147.5007 / Avg. bwd time: 32.4979 / Avg. batch time: 3917.8808 (ms) / GPU bubble ratio: 63.25%
[rank1]:2025-10-25 19:00:00,011 - INFO - Avg. fwd time: 166.8823 / Avg. bwd time: 193.1987 / Avg. batch time: 3725.1169 (ms) / GPU bubble ratio: 22.67%
[rank0]:2025-10-25 19:02:51,719 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 19:06:27,579 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank2]:2025-10-25 19:06:27,579 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank1]:2025-10-25 19:06:27,602 - INFO -  step: 1360  loss: -4.0000  grad_norm:  0.1742  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 19:06:27,581 - INFO -  step: 1360  loss:  0.9486  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 19:06:30,947 - INFO - Avg. fwd time: 173.2002 / Avg. bwd time: 194.0300 / Avg. batch time: 2947.6569 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:06:31,640 - INFO - Avg. fwd time: 146.5460 / Avg. bwd time: 173.5884 / Avg. batch time: 3336.5417 (ms) / GPU bubble ratio: 23.24%
[rank0]:2025-10-25 19:06:32,495 - INFO - Avg. fwd time: 147.5009 / Avg. bwd time: 32.0201 / Avg. batch time: 3931.6609 (ms) / GPU bubble ratio: 63.47%
[rank1]:2025-10-25 19:06:32,486 - INFO - Avg. fwd time: 166.8946 / Avg. bwd time: 195.2581 / Avg. batch time: 3739.5607 (ms) / GPU bubble ratio: 22.53%
[rank2]:2025-10-25 19:13:00,014 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank0]:2025-10-25 19:13:00,014 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 19:13:00,016 - INFO -  step: 1380  loss:  0.9411  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank1]:2025-10-25 19:13:00,036 - INFO -  step: 1380  loss: -4.0000  grad_norm:  0.1748  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 19:13:03,379 - INFO - Avg. fwd time: 173.1941 / Avg. bwd time: 193.8638 / Avg. batch time: 2946.2698 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:13:04,073 - INFO - Avg. fwd time: 146.5466 / Avg. bwd time: 173.3129 / Avg. batch time: 3341.7476 (ms) / GPU bubble ratio: 23.43%
[rank1]:2025-10-25 19:13:04,919 - INFO - Avg. fwd time: 166.9060 / Avg. bwd time: 197.2577 / Avg. batch time: 3753.5835 (ms) / GPU bubble ratio: 22.39%
[rank0]:2025-10-25 19:13:04,928 - INFO - Avg. fwd time: 147.5009 / Avg. bwd time: 31.5562 / Avg. batch time: 3945.0390 (ms) / GPU bubble ratio: 63.69%
[rank0]:2025-10-25 19:19:12,858 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 19:19:15,327 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:19:17,119 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:19:17,793 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:19:17,789 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 19:19:33,113 - INFO -  step: 1400  loss:  0.8703  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank2]:2025-10-25 19:19:33,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank1]:2025-10-25 19:19:33,135 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1655  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank0]:2025-10-25 19:19:33,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.88  mfu: 3.93%
[rank2]:2025-10-25 19:19:33,213 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1919_stage2_step1400.svg
[rank1]:2025-10-25 19:19:33,211 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1919_stage1_step1400.svg
[rank0]:2025-10-25 19:19:33,213 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1919_stage0_step1400.svg
[rank3]:2025-10-25 19:19:33,420 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1919_real_step1400_rank3.svg
[rank3]:> Batch Time: 3612.25 ms, GPU Bubble Ratio: 67.35%, 24.51%, 33.29%, 21.78%
[rank3]:2025-10-25 19:19:33,483 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1919_stage3_step1400.svg
[rank3]:2025-10-25 19:19:36,579 - INFO - Avg. fwd time: 173.1880 / Avg. bwd time: 193.7025 / Avg. batch time: 2944.9209 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:19:37,273 - INFO - Avg. fwd time: 146.5472 / Avg. bwd time: 173.0453 / Avg. batch time: 3346.8017 (ms) / GPU bubble ratio: 23.61%
[rank1]:2025-10-25 19:19:38,121 - INFO - Avg. fwd time: 166.9168 / Avg. bwd time: 199.2001 / Avg. batch time: 3767.2023 (ms) / GPU bubble ratio: 22.25%
[rank0]:2025-10-25 19:19:38,129 - INFO - Avg. fwd time: 147.5001 / Avg. bwd time: 31.1055 / Avg. batch time: 3958.0322 (ms) / GPU bubble ratio: 63.90%
[rank3]:2025-10-25 19:26:05,530 - INFO -  step: 1420  loss:  0.9230  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank2]:2025-10-25 19:26:05,528 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank0]:2025-10-25 19:26:05,528 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank1]:2025-10-25 19:26:05,551 - INFO -  step: 1420  loss: -4.0000  grad_norm:  0.2237  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:26:08,898 - INFO - Avg. fwd time: 173.1816 / Avg. bwd time: 193.5459 / Avg. batch time: 2943.6083 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:26:09,591 - INFO - Avg. fwd time: 146.5477 / Avg. bwd time: 172.7852 / Avg. batch time: 3351.7105 (ms) / GPU bubble ratio: 23.78%
[rank0]:2025-10-25 19:26:10,446 - INFO - Avg. fwd time: 147.4995 / Avg. bwd time: 30.6676 / Avg. batch time: 3970.6568 (ms) / GPU bubble ratio: 64.10%
[rank1]:2025-10-25 19:26:10,437 - INFO - Avg. fwd time: 166.9265 / Avg. bwd time: 201.0879 / Avg. batch time: 3780.4349 (ms) / GPU bubble ratio: 22.12%
[rank2]:2025-10-25 19:32:37,885 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank0]:2025-10-25 19:32:37,885 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:32:37,887 - INFO -  step: 1440  loss:  0.9516  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank1]:2025-10-25 19:32:37,908 - INFO -  step: 1440  loss: -4.0000  grad_norm:  0.1863  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:32:41,251 - INFO - Avg. fwd time: 173.1752 / Avg. bwd time: 193.3931 / Avg. batch time: 2942.3259 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:32:41,943 - INFO - Avg. fwd time: 146.5482 / Avg. bwd time: 172.5323 / Avg. batch time: 3356.4818 (ms) / GPU bubble ratio: 23.95%
[rank1]:2025-10-25 19:32:42,789 - INFO - Avg. fwd time: 166.9360 / Avg. bwd time: 202.9233 / Avg. batch time: 3793.2985 (ms) / GPU bubble ratio: 22.00%
[rank0]:2025-10-25 19:32:42,799 - INFO - Avg. fwd time: 147.4991 / Avg. bwd time: 30.2417 / Avg. batch time: 3982.9290 (ms) / GPU bubble ratio: 64.30%
[rank0]:2025-10-25 19:35:34,467 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 19:39:10,280 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:39:10,281 - INFO -  step: 1460  loss:  0.9144  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank2]:2025-10-25 19:39:10,280 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank1]:2025-10-25 19:39:10,302 - INFO -  step: 1460  loss: -4.0000  grad_norm:  0.1680  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:39:13,649 - INFO - Avg. fwd time: 173.1693 / Avg. bwd time: 193.2446 / Avg. batch time: 2941.0828 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:39:14,342 - INFO - Avg. fwd time: 146.5487 / Avg. bwd time: 172.2864 / Avg. batch time: 3361.1250 (ms) / GPU bubble ratio: 24.11%
[rank1]:2025-10-25 19:39:15,188 - INFO - Avg. fwd time: 166.9454 / Avg. bwd time: 204.7084 / Avg. batch time: 3805.8124 (ms) / GPU bubble ratio: 21.88%
[rank0]:2025-10-25 19:39:15,197 - INFO - Avg. fwd time: 147.4987 / Avg. bwd time: 29.8276 / Avg. batch time: 3994.8674 (ms) / GPU bubble ratio: 64.49%
[rank0]:2025-10-25 19:45:42,674 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:45:42,676 - INFO -  step: 1480  loss:  0.8741  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank2]:2025-10-25 19:45:42,674 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank1]:2025-10-25 19:45:42,697 - INFO -  step: 1480  loss: -4.0000  grad_norm:  0.1597  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.95  mfu: 3.94%
[rank3]:2025-10-25 19:45:46,041 - INFO - Avg. fwd time: 173.1639 / Avg. bwd time: 193.1007 / Avg. batch time: 2939.8800 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:45:46,734 - INFO - Avg. fwd time: 146.5492 / Avg. bwd time: 172.0471 / Avg. batch time: 3365.6452 (ms) / GPU bubble ratio: 24.27%
[rank1]:2025-10-25 19:45:47,581 - INFO - Avg. fwd time: 166.9551 / Avg. bwd time: 206.4452 / Avg. batch time: 3817.9905 (ms) / GPU bubble ratio: 21.76%
[rank0]:2025-10-25 19:45:47,590 - INFO - Avg. fwd time: 147.4985 / Avg. bwd time: 29.4246 / Avg. batch time: 4006.4859 (ms) / GPU bubble ratio: 64.67%
[rank3]:2025-10-25 19:46:09,691 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 19:46:11,491 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 19:46:12,162 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:46:12,161 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 19:51:56,011 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 19:52:15,625 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank0]:2025-10-25 19:52:15,625 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 19:52:15,628 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-25 19:52:15,648 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1768  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank1]:2025-10-25 19:52:15,648 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 19:52:15,625 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank2]:2025-10-25 19:52:15,625 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 19:52:15,626 - INFO -  step: 1500  loss:  0.8823  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank3]:2025-10-25 19:52:15,627 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 19:52:28,350 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.72 seconds.
[rank2]:2025-10-25 19:52:29,166 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.54 seconds.
[rank1]:2025-10-25 19:52:31,673 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.02 seconds.
[rank0]:2025-10-25 19:52:33,314 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-25 19:52:33,318 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.69 seconds.
[rank0]:2025-10-25 19:52:33,318 - INFO - Checkpointer is deleting /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200/step-500.
[rank0]:2025-10-25 19:52:33,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_1952_stage0_step1500.svg
[rank1]:2025-10-25 19:52:33,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_1952_stage1_step1500.svg
[rank2]:2025-10-25 19:52:33,551 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_1952_stage2_step1500.svg
[rank3]:2025-10-25 19:52:33,765 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_1952_real_step1500_rank3.svg
[rank3]:> Batch Time: 3611.38 ms, GPU Bubble Ratio: 67.34%, 24.49%, 33.27%, 21.78%
[rank3]:2025-10-25 19:52:33,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_1952_stage3_step1500.svg
[rank3]:2025-10-25 19:52:36,919 - INFO - Avg. fwd time: 173.1578 / Avg. bwd time: 192.9601 / Avg. batch time: 2938.6986 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:52:37,618 - INFO - Avg. fwd time: 146.5497 / Avg. bwd time: 171.8142 / Avg. batch time: 3370.0384 (ms) / GPU bubble ratio: 24.42%
[rank1]:2025-10-25 19:52:38,465 - INFO - Avg. fwd time: 166.9637 / Avg. bwd time: 208.1358 / Avg. batch time: 3829.8380 (ms) / GPU bubble ratio: 21.65%
[rank0]:2025-10-25 19:52:38,480 - INFO - Avg. fwd time: 147.4982 / Avg. bwd time: 29.0324 / Avg. batch time: 4017.7895 (ms) / GPU bubble ratio: 64.85%
[rank0]:2025-10-25 19:52:50,866 - INFO - Checkpointer deleted /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200/step-500 in 17.55 seconds.
[rank0]:2025-10-25 19:59:06,133 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank2]:2025-10-25 19:59:06,134 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank3]:2025-10-25 19:59:06,136 - INFO -  step: 1520  loss:  0.9360  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank1]:2025-10-25 19:59:06,156 - INFO -  step: 1520  loss: -4.0000  grad_norm:  0.1808  memory: 79.85GiB(57.11%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank3]:2025-10-25 19:59:09,498 - INFO - Avg. fwd time: 173.1476 / Avg. bwd time: 192.8212 / Avg. batch time: 2937.4983 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 19:59:10,195 - INFO - Avg. fwd time: 146.5497 / Avg. bwd time: 171.5875 / Avg. batch time: 3374.2821 (ms) / GPU bubble ratio: 24.57%
[rank0]:2025-10-25 19:59:11,050 - INFO - Avg. fwd time: 147.4971 / Avg. bwd time: 28.6505 / Avg. batch time: 4028.7623 (ms) / GPU bubble ratio: 65.02%
[rank1]:2025-10-25 19:59:11,040 - INFO - Avg. fwd time: 166.9711 / Avg. bwd time: 209.7819 / Avg. batch time: 3841.3397 (ms) / GPU bubble ratio: 21.54%
[rank1]:2025-10-25 20:05:38,894 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.1760  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank0]:2025-10-25 20:05:38,871 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank2]:2025-10-25 20:05:38,871 - INFO -  step: 1540  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank3]:2025-10-25 20:05:38,873 - INFO -  step: 1540  loss:  0.8909  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank3]:2025-10-25 20:05:42,247 - INFO - Avg. fwd time: 173.1384 / Avg. bwd time: 192.6867 / Avg. batch time: 2936.3420 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:05:42,943 - INFO - Avg. fwd time: 146.5498 / Avg. bwd time: 171.3665 / Avg. batch time: 3378.4211 (ms) / GPU bubble ratio: 24.72%
[rank1]:2025-10-25 20:05:43,789 - INFO - Avg. fwd time: 166.9790 / Avg. bwd time: 211.3851 / Avg. batch time: 3852.5480 (ms) / GPU bubble ratio: 21.43%
[rank0]:2025-10-25 20:05:43,800 - INFO - Avg. fwd time: 147.4962 / Avg. bwd time: 28.2786 / Avg. batch time: 4039.4568 (ms) / GPU bubble ratio: 65.19%
[rank0]:2025-10-25 20:08:37,521 - INFO - [GC] Peforming periodical GC collection 1.83 seconds
[rank0]:2025-10-25 20:12:13,715 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank2]:2025-10-25 20:12:13,715 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank1]:2025-10-25 20:12:13,738 - INFO -  step: 1560  loss: -4.0000  grad_norm:  0.1775  memory: 79.85GiB(57.11%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank3]:2025-10-25 20:12:13,716 - INFO -  step: 1560  loss:  0.8887  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank3]:2025-10-25 20:12:17,078 - INFO - Avg. fwd time: 173.1283 / Avg. bwd time: 192.5548 / Avg. batch time: 2935.1984 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:12:17,772 - INFO - Avg. fwd time: 146.5497 / Avg. bwd time: 171.1515 / Avg. batch time: 3382.4447 (ms) / GPU bubble ratio: 24.86%
[rank0]:2025-10-25 20:12:18,627 - INFO - Avg. fwd time: 147.4994 / Avg. bwd time: 27.9161 / Avg. batch time: 4049.9411 (ms) / GPU bubble ratio: 65.35%
[rank1]:2025-10-25 20:12:18,618 - INFO - Avg. fwd time: 166.9855 / Avg. bwd time: 212.9473 / Avg. batch time: 3863.4595 (ms) / GPU bubble ratio: 21.33%
[rank3]:2025-10-25 20:13:30,840 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:13:31,506 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:13:32,171 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:13:32,178 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-25 20:18:46,404 - INFO -  step: 1580  loss:  0.8450  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.92  mfu: 3.94%
[rank0]:2025-10-25 20:18:46,403 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.92  mfu: 3.94%
[rank2]:2025-10-25 20:18:46,403 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.92  mfu: 3.94%
[rank1]:2025-10-25 20:18:46,425 - INFO -  step: 1580  loss: -4.0000  grad_norm:  0.1793  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.92  mfu: 3.94%
[rank3]:2025-10-25 20:18:49,764 - INFO - Avg. fwd time: 173.1184 / Avg. bwd time: 192.4273 / Avg. batch time: 2934.0919 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:18:50,458 - INFO - Avg. fwd time: 146.5492 / Avg. bwd time: 170.9416 / Avg. batch time: 3386.3661 (ms) / GPU bubble ratio: 25.00%
[rank1]:2025-10-25 20:18:51,304 - INFO - Avg. fwd time: 166.9915 / Avg. bwd time: 214.4701 / Avg. batch time: 3874.0961 (ms) / GPU bubble ratio: 21.23%
[rank0]:2025-10-25 20:18:51,314 - INFO - Avg. fwd time: 147.4981 / Avg. bwd time: 27.5628 / Avg. batch time: 4060.0863 (ms) / GPU bubble ratio: 65.51%
[rank0]:2025-10-25 20:24:58,917 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 20:25:18,552 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1815  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank2]:2025-10-25 20:25:18,529 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank0]:2025-10-25 20:25:18,529 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 20:25:18,531 - INFO -  step: 1600  loss:  0.9243  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank1]:2025-10-25 20:25:18,634 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_2025_stage1_step1600.svg
[rank2]:2025-10-25 20:25:18,636 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_2025_stage2_step1600.svg
[rank0]:2025-10-25 20:25:18,634 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_2025_stage0_step1600.svg
[rank3]:2025-10-25 20:25:18,839 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2025_real_step1600_rank3.svg
[rank3]:> Batch Time: 3610.75 ms, GPU Bubble Ratio: 67.33%, 24.46%, 33.26%, 21.79%
[rank3]:2025-10-25 20:25:18,904 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_2025_stage3_step1600.svg
[rank3]:2025-10-25 20:25:21,995 - INFO - Avg. fwd time: 173.1087 / Avg. bwd time: 192.3018 / Avg. batch time: 2933.0037 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:25:22,694 - INFO - Avg. fwd time: 146.5492 / Avg. bwd time: 170.7371 / Avg. batch time: 3390.1894 (ms) / GPU bubble ratio: 25.13%
[rank1]:2025-10-25 20:25:23,539 - INFO - Avg. fwd time: 166.9979 / Avg. bwd time: 215.9547 / Avg. batch time: 3884.4653 (ms) / GPU bubble ratio: 21.13%
[rank0]:2025-10-25 20:25:23,547 - INFO - Avg. fwd time: 147.4956 / Avg. bwd time: 27.2184 / Avg. batch time: 4069.9762 (ms) / GPU bubble ratio: 65.66%
[rank2]:2025-10-25 20:31:50,791 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank0]:2025-10-25 20:31:50,791 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank1]:2025-10-25 20:31:50,814 - INFO -  step: 1620  loss: -4.0000  grad_norm:  0.1868  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 20:31:50,792 - INFO -  step: 1620  loss:  0.8927  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 20:31:54,159 - INFO - Avg. fwd time: 173.0993 / Avg. bwd time: 192.1793 / Avg. batch time: 2931.9412 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:31:54,852 - INFO - Avg. fwd time: 146.5493 / Avg. bwd time: 170.5377 / Avg. batch time: 3393.9186 (ms) / GPU bubble ratio: 25.26%
[rank0]:2025-10-25 20:31:55,707 - INFO - Avg. fwd time: 147.4929 / Avg. bwd time: 26.8825 / Avg. batch time: 4079.6224 (ms) / GPU bubble ratio: 65.81%
[rank1]:2025-10-25 20:31:55,697 - INFO - Avg. fwd time: 167.0036 / Avg. bwd time: 217.4027 / Avg. batch time: 3894.5789 (ms) / GPU bubble ratio: 21.04%
[rank2]:2025-10-25 20:38:22,927 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank0]:2025-10-25 20:38:22,927 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 20:38:22,929 - INFO -  step: 1640  loss:  0.9177  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank1]:2025-10-25 20:38:22,950 - INFO -  step: 1640  loss: -4.0000  grad_norm:  0.1853  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 20:38:26,293 - INFO - Avg. fwd time: 173.0895 / Avg. bwd time: 192.0598 / Avg. batch time: 2930.9003 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:38:26,987 - INFO - Avg. fwd time: 146.5493 / Avg. bwd time: 170.3431 / Avg. batch time: 3397.5520 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-25 20:38:27,844 - INFO - Avg. fwd time: 147.4898 / Avg. bwd time: 26.5547 / Avg. batch time: 4089.0285 (ms) / GPU bubble ratio: 65.95%
[rank1]:2025-10-25 20:38:27,832 - INFO - Avg. fwd time: 167.0092 / Avg. bwd time: 218.8153 / Avg. batch time: 3904.4406 (ms) / GPU bubble ratio: 20.95%
[rank3]:2025-10-25 20:40:23,040 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 20:40:24,835 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 20:40:25,505 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:40:25,505 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 20:41:20,093 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 20:44:55,699 - INFO -  step: 1660  loss:  0.8174  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank2]:2025-10-25 20:44:55,697 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank1]:2025-10-25 20:44:55,720 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.1819  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank0]:2025-10-25 20:44:55,697 - INFO -  step: 1660  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.91  mfu: 3.93%
[rank3]:2025-10-25 20:44:59,065 - INFO - Avg. fwd time: 173.0800 / Avg. bwd time: 191.9432 / Avg. batch time: 2929.8853 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:44:59,759 - INFO - Avg. fwd time: 146.5490 / Avg. bwd time: 170.1531 / Avg. batch time: 3401.0974 (ms) / GPU bubble ratio: 25.51%
[rank1]:2025-10-25 20:45:00,604 - INFO - Avg. fwd time: 167.0145 / Avg. bwd time: 220.1938 / Avg. batch time: 3914.0641 (ms) / GPU bubble ratio: 20.86%
[rank0]:2025-10-25 20:45:00,615 - INFO - Avg. fwd time: 147.4874 / Avg. bwd time: 26.2349 / Avg. batch time: 4098.2075 (ms) / GPU bubble ratio: 66.09%
[rank0]:2025-10-25 20:51:27,815 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 20:51:27,816 - INFO -  step: 1680  loss:  0.8801  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 20:51:27,815 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 20:51:27,837 - INFO -  step: 1680  loss: -4.0000  grad_norm:  0.1950  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 20:51:31,177 - INFO - Avg. fwd time: 173.0706 / Avg. bwd time: 191.8284 / Avg. batch time: 2928.8852 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:51:31,874 - INFO - Avg. fwd time: 146.5490 / Avg. bwd time: 169.9679 / Avg. batch time: 3404.5577 (ms) / GPU bubble ratio: 25.63%
[rank1]:2025-10-25 20:51:32,718 - INFO - Avg. fwd time: 167.0191 / Avg. bwd time: 221.5396 / Avg. batch time: 3923.4584 (ms) / GPU bubble ratio: 20.77%
[rank0]:2025-10-25 20:51:32,729 - INFO - Avg. fwd time: 147.4842 / Avg. bwd time: 25.9227 / Avg. batch time: 4107.1674 (ms) / GPU bubble ratio: 66.22%
[rank0]:2025-10-25 20:57:40,315 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 20:57:59,927 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 20:57:59,928 - INFO -  step: 1700  loss:  0.8825  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 20:57:59,949 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1940  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 20:57:59,927 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 20:58:00,031 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_2057_stage0_step1700.svg
[rank1]:2025-10-25 20:58:00,029 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_2057_stage1_step1700.svg
[rank2]:2025-10-25 20:58:00,031 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_2057_stage2_step1700.svg
[rank3]:2025-10-25 20:58:00,239 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2057_real_step1700_rank3.svg
[rank3]:> Batch Time: 3609.88 ms, GPU Bubble Ratio: 67.33%, 24.44%, 33.25%, 21.79%
[rank3]:2025-10-25 20:58:00,303 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_2057_stage3_step1700.svg
[rank3]:2025-10-25 20:58:03,394 - INFO - Avg. fwd time: 173.0616 / Avg. bwd time: 191.7171 / Avg. batch time: 2927.9168 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 20:58:04,090 - INFO - Avg. fwd time: 146.5487 / Avg. bwd time: 169.7869 / Avg. batch time: 3407.9388 (ms) / GPU bubble ratio: 25.74%
[rank0]:2025-10-25 20:58:04,945 - INFO - Avg. fwd time: 147.4814 / Avg. bwd time: 25.6178 / Avg. batch time: 4115.9189 (ms) / GPU bubble ratio: 66.36%
[rank1]:2025-10-25 20:58:04,935 - INFO - Avg. fwd time: 167.0239 / Avg. bwd time: 222.8538 / Avg. batch time: 3932.6341 (ms) / GPU bubble ratio: 20.69%
[rank3]:2025-10-25 21:04:32,022 - INFO -  step: 1720  loss:  0.8983  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 21:04:32,021 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 21:04:32,021 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 21:04:32,043 - INFO -  step: 1720  loss: -4.0000  grad_norm:  0.1855  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:04:35,380 - INFO - Avg. fwd time: 173.0516 / Avg. bwd time: 191.6075 / Avg. batch time: 2926.9544 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:04:36,079 - INFO - Avg. fwd time: 146.5489 / Avg. bwd time: 169.6100 / Avg. batch time: 3411.2326 (ms) / GPU bubble ratio: 25.85%
[rank1]:2025-10-25 21:04:36,923 - INFO - Avg. fwd time: 167.0284 / Avg. bwd time: 224.1375 / Avg. batch time: 3941.5863 (ms) / GPU bubble ratio: 20.61%
[rank0]:2025-10-25 21:04:36,934 - INFO - Avg. fwd time: 147.4786 / Avg. bwd time: 25.3200 / Avg. batch time: 4124.4568 (ms) / GPU bubble ratio: 66.48%
[rank3]:2025-10-25 21:07:16,203 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:07:18,004 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:07:18,675 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:07:18,671 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:11:04,663 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.1883  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.93  mfu: 3.94%
[rank3]:2025-10-25 21:11:04,641 - INFO -  step: 1740  loss:  0.8422  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.93  mfu: 3.94%
[rank0]:2025-10-25 21:11:04,640 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.93  mfu: 3.94%
[rank2]:2025-10-25 21:11:04,640 - INFO -  step: 1740  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.93  mfu: 3.94%
[rank3]:2025-10-25 21:11:08,002 - INFO - Avg. fwd time: 173.0426 / Avg. bwd time: 191.5008 / Avg. batch time: 2926.0231 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:11:08,695 - INFO - Avg. fwd time: 146.5490 / Avg. bwd time: 169.4374 / Avg. batch time: 3414.4561 (ms) / GPU bubble ratio: 25.97%
[rank1]:2025-10-25 21:11:09,541 - INFO - Avg. fwd time: 167.0326 / Avg. bwd time: 225.3915 / Avg. batch time: 3950.3383 (ms) / GPU bubble ratio: 20.53%
[rank0]:2025-10-25 21:11:09,552 - INFO - Avg. fwd time: 147.4753 / Avg. bwd time: 25.0290 / Avg. batch time: 4132.8038 (ms) / GPU bubble ratio: 66.61%
[rank0]:2025-10-25 21:14:01,078 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank1]:2025-10-25 21:17:36,714 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.1911  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 21:17:36,691 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:17:36,693 - INFO -  step: 1760  loss:  0.8968  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 21:17:36,691 - INFO -  step: 1760  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:17:40,051 - INFO - Avg. fwd time: 173.0334 / Avg. bwd time: 191.3966 / Avg. batch time: 2925.1090 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:17:40,748 - INFO - Avg. fwd time: 146.5487 / Avg. bwd time: 169.2686 / Avg. batch time: 3417.6023 (ms) / GPU bubble ratio: 26.07%
[rank1]:2025-10-25 21:17:41,593 - INFO - Avg. fwd time: 167.0365 / Avg. bwd time: 226.6170 / Avg. batch time: 3958.8881 (ms) / GPU bubble ratio: 20.45%
[rank0]:2025-10-25 21:17:41,604 - INFO - Avg. fwd time: 147.4726 / Avg. bwd time: 24.7447 / Avg. batch time: 4140.9588 (ms) / GPU bubble ratio: 66.73%
[rank2]:2025-10-25 21:24:08,734 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:24:08,735 - INFO -  step: 1780  loss:  0.8878  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 21:24:08,757 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.1908  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 21:24:08,734 - INFO -  step: 1780  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:24:12,098 - INFO - Avg. fwd time: 173.0241 / Avg. bwd time: 191.2941 / Avg. batch time: 2924.2095 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:24:12,793 - INFO - Avg. fwd time: 146.5490 / Avg. bwd time: 169.1036 / Avg. batch time: 3420.6776 (ms) / GPU bubble ratio: 26.18%
[rank1]:2025-10-25 21:24:13,638 - INFO - Avg. fwd time: 167.0404 / Avg. bwd time: 227.8152 / Avg. batch time: 3967.2441 (ms) / GPU bubble ratio: 20.38%
[rank0]:2025-10-25 21:24:13,649 - INFO - Avg. fwd time: 147.4693 / Avg. bwd time: 24.4667 / Avg. batch time: 4148.9278 (ms) / GPU bubble ratio: 66.85%
[rank0]:2025-10-25 21:30:21,239 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 21:30:40,846 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 21:30:40,848 - INFO -  step: 1800  loss:  0.8748  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 21:30:40,846 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 21:30:40,869 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1839  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 21:30:40,951 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_2130_stage2_step1800.svg
[rank0]:2025-10-25 21:30:40,951 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_2130_stage0_step1800.svg
[rank1]:2025-10-25 21:30:40,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_2130_stage1_step1800.svg
[rank3]:2025-10-25 21:30:41,160 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2130_real_step1800_rank3.svg
[rank3]:> Batch Time: 3609.38 ms, GPU Bubble Ratio: 67.32%, 24.42%, 33.24%, 21.79%
[rank3]:2025-10-25 21:30:41,224 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_2130_stage3_step1800.svg
[rank3]:2025-10-25 21:30:44,313 - INFO - Avg. fwd time: 173.0162 / Avg. bwd time: 191.1948 / Avg. batch time: 2923.3466 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:30:45,011 - INFO - Avg. fwd time: 146.5482 / Avg. bwd time: 168.9423 / Avg. batch time: 3423.6925 (ms) / GPU bubble ratio: 26.28%
[rank0]:2025-10-25 21:30:45,866 - INFO - Avg. fwd time: 147.4675 / Avg. bwd time: 24.1950 / Avg. batch time: 4156.7286 (ms) / GPU bubble ratio: 66.96%
[rank1]:2025-10-25 21:30:45,856 - INFO - Avg. fwd time: 167.0433 / Avg. bwd time: 228.9865 / Avg. batch time: 3975.4227 (ms) / GPU bubble ratio: 20.30%
[rank3]:2025-10-25 21:34:09,303 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 21:34:11,103 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 21:34:11,767 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:34:11,774 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 21:37:13,707 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.1953  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank3]:2025-10-25 21:37:13,685 - INFO -  step: 1820  loss:  0.8143  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank0]:2025-10-25 21:37:13,684 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank2]:2025-10-25 21:37:13,684 - INFO -  step: 1820  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank3]:2025-10-25 21:37:17,053 - INFO - Avg. fwd time: 173.0094 / Avg. bwd time: 191.0984 / Avg. batch time: 2922.5154 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:37:17,748 - INFO - Avg. fwd time: 146.5480 / Avg. bwd time: 168.7845 / Avg. batch time: 3426.6486 (ms) / GPU bubble ratio: 26.38%
[rank1]:2025-10-25 21:37:18,593 - INFO - Avg. fwd time: 167.0466 / Avg. bwd time: 230.1320 / Avg. batch time: 3983.4297 (ms) / GPU bubble ratio: 20.23%
[rank0]:2025-10-25 21:37:18,605 - INFO - Avg. fwd time: 147.4658 / Avg. bwd time: 23.9292 / Avg. batch time: 4164.3659 (ms) / GPU bubble ratio: 67.07%
[rank0]:2025-10-25 21:43:45,851 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank1]:2025-10-25 21:43:45,873 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.2122  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 21:43:45,852 - INFO -  step: 1840  loss:  0.8954  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank2]:2025-10-25 21:43:45,851 - INFO -  step: 1840  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 21:43:49,216 - INFO - Avg. fwd time: 173.0033 / Avg. bwd time: 191.0039 / Avg. batch time: 2921.7063 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:43:49,911 - INFO - Avg. fwd time: 146.5480 / Avg. bwd time: 168.6302 / Avg. batch time: 3429.5439 (ms) / GPU bubble ratio: 26.48%
[rank0]:2025-10-25 21:43:50,768 - INFO - Avg. fwd time: 147.4646 / Avg. bwd time: 23.6691 / Avg. batch time: 4171.8411 (ms) / GPU bubble ratio: 67.18%
[rank1]:2025-10-25 21:43:50,756 - INFO - Avg. fwd time: 167.0502 / Avg. bwd time: 231.2527 / Avg. batch time: 3991.2662 (ms) / GPU bubble ratio: 20.17%
[rank0]:2025-10-25 21:46:42,403 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 21:50:18,127 - INFO -  step: 1860  loss:  0.9244  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank1]:2025-10-25 21:50:18,147 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.1889  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank0]:2025-10-25 21:50:18,125 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank2]:2025-10-25 21:50:18,125 - INFO -  step: 1860  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 21:50:21,495 - INFO - Avg. fwd time: 172.9982 / Avg. bwd time: 190.9122 / Avg. batch time: 2920.9265 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:50:22,188 - INFO - Avg. fwd time: 146.5482 / Avg. bwd time: 168.4791 / Avg. batch time: 3432.3826 (ms) / GPU bubble ratio: 26.58%
[rank1]:2025-10-25 21:50:23,033 - INFO - Avg. fwd time: 167.0540 / Avg. bwd time: 232.3492 / Avg. batch time: 3998.9400 (ms) / GPU bubble ratio: 20.10%
[rank0]:2025-10-25 21:50:23,046 - INFO - Avg. fwd time: 147.4637 / Avg. bwd time: 23.4147 / Avg. batch time: 4179.1612 (ms) / GPU bubble ratio: 67.29%
[rank0]:2025-10-25 21:56:50,415 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank2]:2025-10-25 21:56:50,415 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 21:56:50,416 - INFO -  step: 1880  loss:  0.9109  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank1]:2025-10-25 21:56:50,438 - INFO -  step: 1880  loss: -4.0000  grad_norm:  0.1861  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 21:56:53,784 - INFO - Avg. fwd time: 172.9928 / Avg. bwd time: 190.8224 / Avg. batch time: 2920.1603 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 21:56:54,479 - INFO - Avg. fwd time: 146.5483 / Avg. bwd time: 168.3311 / Avg. batch time: 3435.1591 (ms) / GPU bubble ratio: 26.67%
[rank1]:2025-10-25 21:56:55,324 - INFO - Avg. fwd time: 167.0577 / Avg. bwd time: 233.4225 / Avg. batch time: 4006.4490 (ms) / GPU bubble ratio: 20.03%
[rank0]:2025-10-25 21:56:55,336 - INFO - Avg. fwd time: 147.4629 / Avg. bwd time: 23.1657 / Avg. batch time: 4186.3240 (ms) / GPU bubble ratio: 67.39%
[rank3]:2025-10-25 22:01:07,786 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:01:09,582 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:01:10,255 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:01:10,251 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:03:03,656 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank3]:2025-10-25 22:03:23,272 - INFO -  step: 1900  loss:  0.8031  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank0]:2025-10-25 22:03:23,271 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank1]:2025-10-25 22:03:23,294 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1843  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank2]:2025-10-25 22:03:23,271 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.90  mfu: 3.93%
[rank0]:2025-10-25 22:03:23,379 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_2203_stage0_step1900.svg
[rank1]:2025-10-25 22:03:23,376 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_2203_stage1_step1900.svg
[rank2]:2025-10-25 22:03:23,377 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_2203_stage2_step1900.svg
[rank3]:2025-10-25 22:03:23,586 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2203_real_step1900_rank3.svg
[rank3]:> Batch Time: 3608.63 ms, GPU Bubble Ratio: 67.32%, 24.40%, 33.23%, 21.80%
[rank3]:2025-10-25 22:03:23,650 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_2203_stage3_step1900.svg
[rank3]:2025-10-25 22:03:26,747 - INFO - Avg. fwd time: 172.9872 / Avg. bwd time: 190.7341 / Avg. batch time: 2919.4037 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 22:03:27,440 - INFO - Avg. fwd time: 146.5484 / Avg. bwd time: 168.1862 / Avg. batch time: 3437.8741 (ms) / GPU bubble ratio: 26.76%
[rank0]:2025-10-25 22:03:28,299 - INFO - Avg. fwd time: 147.4619 / Avg. bwd time: 22.9219 / Avg. batch time: 4193.3396 (ms) / GPU bubble ratio: 67.49%
[rank1]:2025-10-25 22:03:28,288 - INFO - Avg. fwd time: 167.0607 / Avg. bwd time: 234.4732 / Avg. batch time: 4013.7966 (ms) / GPU bubble ratio: 19.97%
[rank0]:2025-10-25 22:09:55,481 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.97  mfu: 3.94%
[rank2]:2025-10-25 22:09:55,481 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 22:09:55,483 - INFO -  step: 1920  loss:  0.8959  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.97  mfu: 3.94%
[rank1]:2025-10-25 22:09:55,504 - INFO -  step: 1920  loss: -4.0000  grad_norm:  0.3039  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.97  mfu: 3.94%
[rank3]:2025-10-25 22:09:58,845 - INFO - Avg. fwd time: 172.9813 / Avg. bwd time: 190.6476 / Avg. batch time: 2918.6603 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 22:09:59,541 - INFO - Avg. fwd time: 146.5482 / Avg. bwd time: 168.0444 / Avg. batch time: 3440.5293 (ms) / GPU bubble ratio: 26.85%
[rank1]:2025-10-25 22:10:00,388 - INFO - Avg. fwd time: 167.0632 / Avg. bwd time: 235.5019 / Avg. batch time: 4020.9884 (ms) / GPU bubble ratio: 19.91%
[rank0]:2025-10-25 22:10:00,400 - INFO - Avg. fwd time: 147.4605 / Avg. bwd time: 22.6832 / Avg. batch time: 4200.1996 (ms) / GPU bubble ratio: 67.59%
[rank3]:2025-10-25 22:16:27,565 - INFO -  step: 1940  loss:  0.8734  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank0]:2025-10-25 22:16:27,563 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank2]:2025-10-25 22:16:27,564 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank1]:2025-10-25 22:16:27,586 - INFO -  step: 1940  loss: -4.0000  grad_norm:  0.2786  memory: 79.85GiB(57.11%)  tps: 836  tflops: 38.98  mfu: 3.94%
[rank3]:2025-10-25 22:16:30,936 - INFO - Avg. fwd time: 172.9743 / Avg. bwd time: 190.5619 / Avg. batch time: 2917.9137 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 22:16:31,629 - INFO - Avg. fwd time: 146.5479 / Avg. bwd time: 167.9057 / Avg. batch time: 3443.1196 (ms) / GPU bubble ratio: 26.94%
[rank0]:2025-10-25 22:16:32,488 - INFO - Avg. fwd time: 147.4579 / Avg. bwd time: 22.4494 / Avg. batch time: 4206.9085 (ms) / GPU bubble ratio: 67.69%
[rank1]:2025-10-25 22:16:32,475 - INFO - Avg. fwd time: 167.0648 / Avg. bwd time: 236.5095 / Avg. batch time: 4028.0215 (ms) / GPU bubble ratio: 19.85%
[rank0]:2025-10-25 22:19:24,207 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank2]:2025-10-25 22:23:00,018 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank0]:2025-10-25 22:23:00,018 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank1]:2025-10-25 22:23:00,041 - INFO -  step: 1960  loss: -4.0000  grad_norm:  0.2560  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 22:23:00,020 - INFO -  step: 1960  loss:  0.9048  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.94  mfu: 3.94%
[rank3]:2025-10-25 22:23:03,390 - INFO - Avg. fwd time: 172.9721 / Avg. bwd time: 190.4800 / Avg. batch time: 2917.2362 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 22:23:04,084 - INFO - Avg. fwd time: 146.5480 / Avg. bwd time: 167.7696 / Avg. batch time: 3445.6948 (ms) / GPU bubble ratio: 27.02%
[rank0]:2025-10-25 22:23:04,945 - INFO - Avg. fwd time: 147.4557 / Avg. bwd time: 22.2204 / Avg. batch time: 4213.5175 (ms) / GPU bubble ratio: 67.78%
[rank1]:2025-10-25 22:23:04,931 - INFO - Avg. fwd time: 167.0694 / Avg. bwd time: 237.4965 / Avg. batch time: 4034.9487 (ms) / GPU bubble ratio: 19.79%
[rank3]:2025-10-25 22:28:01,657 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:28:03,455 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-25 22:28:04,127 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-25 22:28:04,125 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-25 22:29:33,034 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank0]:2025-10-25 22:29:33,034 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank1]:2025-10-25 22:29:33,057 - INFO -  step: 1980  loss: -4.0000  grad_norm:  0.2307  memory: 79.85GiB(57.11%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank3]:2025-10-25 22:29:33,036 - INFO -  step: 1980  loss:  0.8084  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank3]:2025-10-25 22:29:36,405 - INFO - Avg. fwd time: 172.9689 / Avg. bwd time: 190.3998 / Avg. batch time: 2916.5645 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-25 22:29:37,097 - INFO - Avg. fwd time: 146.5477 / Avg. bwd time: 167.6363 / Avg. batch time: 3448.2101 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-25 22:29:37,958 - INFO - Avg. fwd time: 147.4527 / Avg. bwd time: 21.9960 / Avg. batch time: 4219.9856 (ms) / GPU bubble ratio: 67.88%
[rank1]:2025-10-25 22:29:37,946 - INFO - Avg. fwd time: 167.0726 / Avg. bwd time: 238.4636 / Avg. batch time: 4041.7280 (ms) / GPU bubble ratio: 19.73%
[rank0]:2025-10-25 22:35:45,699 - INFO - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2025-10-25 22:36:05,310 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 78.87GiB(56.41%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank0]:2025-10-25 22:36:05,310 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 965  tflops: 45.00  mfu: 4.58%
[rank0]:2025-10-25 22:36:05,311 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-25 22:36:05,314 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2025-10-25 22:36:05,333 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.2506  memory: 79.85GiB(57.11%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank1]:2025-10-25 22:36:05,333 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.2506  tps: 965  tflops: 45.00  mfu: 4.58%
[rank1]:2025-10-25 22:36:05,333 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-25 22:36:05,336 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2025-10-25 22:36:05,312 - INFO -  step: 2000  loss:  0.8984  grad_norm:  0.0000  memory: 92.28GiB(66.01%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank3]:2025-10-25 22:36:05,313 - INFO -  final step: 2000  loss:  0.8984  grad_norm:  0.0000  tps: 965  tflops: 45.00  mfu: 4.59%
[rank3]:2025-10-25 22:36:05,313 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-25 22:36:05,317 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2025-10-25 22:36:05,310 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 71.04GiB(50.81%)  tps: 835  tflops: 38.96  mfu: 3.94%
[rank2]:2025-10-25 22:36:05,311 - INFO -  final step: 2000  loss: -4.0000  grad_norm:  0.0000  tps: 965  tflops: 45.00  mfu: 4.58%
[rank2]:2025-10-25 22:36:05,311 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-25 22:36:05,313 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2025-10-25 22:36:15,252 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-25 22:36:15,356 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank2/251025_2236_stage2_final2000.svg
[rank0]:2025-10-25 22:36:15,357 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank0/251025_2236_stage0_final2000.svg
[rank1]:2025-10-25 22:36:15,366 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank1/251025_2236_stage1_final2000.svg
[rank3]:2025-10-25 22:36:15,554 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2236_real_final2000_rank3.svg
[rank3]:> Batch Time: 3607.88 ms, GPU Bubble Ratio: 67.31%, 24.37%, 33.21%, 21.80%
[rank1]:2025-10-25 22:36:15,634 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/frozen_params_histogram/251025_2236_rank1_stage1.svg
[rank1]:	> Counts Sum: 3470000, Total Sum: 4924800 (70.46%), Ratio(%) per element: [70.19, 70.88, 70.52, 70.09, 70.55, 69.93, 70.55, 70.55, 70.42, 70.46, 70.49, 70.52, 70.72, 70.06, 70.46, 70.39, 70.23, 70.19, 70.62, 70.62, 70.13, 70.49, 70.23, 70.62, 71.11, 70.32, 70.85, 69.93, 70.29, 70.49, 70.46, 70.26, 70.39, 70.39, 70.49, 70.52, 70.46, 70.52, 70.23, 70.92, 70.49, 70.59, 70.62, 70.49, 70.39, 70.95, 70.69, 70.32, 70.13, 71.11, 70.16, 70.29, 70.16, 70.59, 70.62, 70.16, 70.23, 70.32, 70.29, 70.46, 70.42, 70.52, 69.86, 70.55, 70.26, 70.88, 70.59, 70.29, 70.78, 70.49, 70.13, 70.42, 70.98, 70.72, 70.13, 70.55, 70.65, 70.36, 70.69, 70.26, 70.72]
[rank1]:2025-10-25 22:36:15,635 - INFO - Destroying the purge thread.
[rank2]:2025-10-25 22:36:15,672 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/frozen_params_histogram/251025_2236_rank2_stage2.svg
[rank2]:	> Counts Sum: 1257100, Total Sum: 4377600 (28.72%), Ratio(%) per element: [29.67, 28.71, 28.81, 28.48, 28.65, 28.84, 28.75, 30.03, 29.63, 29.04, 29.07, 28.32, 29.4, 27.96, 28.19, 28.81, 28.42, 28.65, 28.25, 28.48, 30.19, 30.0, 28.78, 28.71, 29.07, 28.15, 27.79, 28.19, 27.56, 27.66, 28.78, 29.5, 28.61, 28.91, 28.91, 27.73, 27.76, 28.35, 29.34, 27.46, 27.69, 29.3, 29.24, 29.3, 26.57, 29.83, 30.09, 28.32, 29.96, 28.98, 28.88, 29.27, 28.35, 28.75, 28.55, 28.84, 28.35, 28.88, 28.98, 27.89, 28.75, 27.99, 29.53, 28.38, 28.55, 29.37, 29.37, 28.25, 27.89, 28.91, 27.73, 28.91]
[rank2]:2025-10-25 22:36:15,672 - INFO - Destroying the purge thread.
[rank0]:2025-10-25 22:36:15,627 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/frozen_params_histogram/251025_2236_rank0_stage0.svg
[rank0]:	> Counts Sum: 3858740, Total Sum: 4438400 (86.94%), Ratio(%) per element: [86.97, 86.87, 86.87, 86.84, 86.74, 86.71, 86.87, 86.77, 86.74, 86.9, 86.77, 86.87, 86.87, 86.9, 86.77, 86.77, 86.87, 86.67, 86.8, 86.8, 86.87, 86.8, 86.9, 86.8, 86.94, 86.87, 86.87, 86.97, 86.77, 86.84, 86.84, 86.8, 86.97, 86.94, 86.8, 86.87, 86.84, 86.87, 86.84, 86.94, 86.8, 86.94, 86.97, 87.03, 86.84, 86.9, 87.07, 87.17, 87.03, 87.03, 86.94, 87.17, 87.0, 86.9, 87.17, 87.03, 86.87, 87.0, 87.03, 87.0, 87.07, 87.1, 87.07, 87.1, 87.07, 87.2, 87.2, 87.1, 87.2, 87.13, 87.1, 87.13, 87.17]
[rank0]:2025-10-25 22:36:15,627 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-25 22:36:15,892 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/pipeline_schedule/251025_2236_thry_final2000_rank3.svg
[rank3]:> Batch Time: 5229.98 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-25 22:36:15,958 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/freeze_ratio_history/rank3/251025_2236_stage3_final2000.svg
[rank3]:2025-10-25 22:36:16,176 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200/frozen_params_histogram/251025_2236_rank3_stage3.svg
[rank3]:	> Counts Sum: 5440, Total Sum: 3952000 (0.14%), Ratio(%) per element: [0.13, 0.13, 0.13, 0.19, 0.16, 0.13, 0.09, 0.06, 0.19, 0.09, 0.13, 0.06, 0.19, 0.16, 0.13, 0.13, 0.13, 0.16, 0.06, 0.06, 0.16, 0.09, 0.16, 0.13, 0.09, 0.19, 0.19, 0.19, 0.09, 0.09, 0.13, 0.19, 0.06, 0.13, 0.09, 0.13, 0.13, 0.09, 0.13, 0.16, 0.06, 0.06, 0.23, 0.16, 0.13, 0.03, 0.09, 0.19, 0.23, 0.19, 0.16, 0.23, 0.13, 0.23, 0.13, 0.03, 0.09, 0.06, 0.09, 0.26, 0.16, 0.16, 0.09, 0.23, 0.09]
[rank3]:2025-10-25 22:36:16,176 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 100-100, summary, console lines 533-540
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–â–‚â–â–‚â–â–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–‚â–â–‚â–â–‚â–‚
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–†â–…â–…â–„â–…â–„â–„â–„â–ƒâ–…â–‚â–„â–„â–„â–„â–ƒâ–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–„â–ƒâ–‚â–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–â–ƒâ–ƒâ–â–‚
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 16.98149
[rank3]:wandb:               final/avg_loss 0.89843
[rank3]:wandb:             final/avg_mfu(%) 4.58545
[rank3]:wandb:             final/avg_tflops 44.99914
[rank3]:wandb:    final/avg_throughput(tps) 964.81531
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.89843
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.89843
[rank3]:wandb: loss_metrics/global_max_loss 0.89843
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1024_GPipe_fullrand7_h200 at: https://wandb.ai/orangingq/torchtitan/runs/a1dnczh1
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1024_GPipe_fullrand7_h200/20251025-1304/wandb/run-20251025_130421-a1dnczh1/logs
[rank0]:2025-10-25 22:36:17,627 - INFO - Training completed
[rank0]:2025-10-25 22:36:17,627 - INFO - Destroying the purge thread.
[rank1]:2025-10-25 22:36:17,848 - INFO - Process group destroyed
[rank3]:2025-10-25 22:36:17,847 - INFO - Process group destroyed
[rank2]:2025-10-25 22:36:17,876 - INFO - Process group destroyed
[rank0]:2025-10-25 22:36:18,043 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.2', 'layers.1', 'layers.0', 'layers.5', 'layers.6', 'layers.4', 'tok_embeddings', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.22', 'layers.23', 'layers.18', 'layers.24', 'layers.19', 'layers.17', 'layers.20'}
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.9', 'layers.16', 'layers.15', 'layers.13', 'layers.12', 'layers.14', 'layers.11', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'norm', 'layers.26', 'layers.25', 'layers.27', 'layers.28', 'layers.30', 'layers.31', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1024_GPipe_fullrand7_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1024_GPipe_fullrand7_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1024_GPipe_fullrand7_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 20
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1024_GPipe_fullrand7_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_GPipe_fullrand7_h200
[rank3]:		- pplog_freq: 80
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1024_GPipe_fullrand7_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_GPipe_fullrand7_h200
[rank3]:		- interval: 500
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1024_GPipe_fullrand7_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 10
[rank3]:		- stability_check_freq: 5
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
