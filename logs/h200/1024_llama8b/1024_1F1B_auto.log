
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Oct 26 11:03:27 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/1024_1F1B_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment
âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1024_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1026 11:03:28.409000 2207605 site-packages/torch/distributed/run.py:811] 
W1026 11:03:28.409000 2207605 site-packages/torch/distributed/run.py:811] *****************************************
W1026 11:03:28.409000 2207605 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1026 11:03:28.409000 2207605 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-26 11:03:34,104 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank0]:2025-10-26 11:03:34,369 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank2]:2025-10-26 11:03:34,400 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank1]:2025-10-26 11:03:34,479 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-26 11:03:34,481 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-26 11:03:34,537 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment"
[rank2]:2025-10-26 11:03:35,014 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-26 11:03:35,016 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 11:03:34,998 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-26 11:03:35,002 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 11:03:35,008 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-26 11:03:35,142 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-26 11:03:35,145 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-26 11:03:36,817 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-26 11:03:37,097 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-26 11:03:39,009 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-26 11:03:39,025 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-26 11:03:39,084 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-26 11:03:39,084 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-26 11:03:39,237 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-26 11:03:39,320 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-26 11:03:39,320 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-26 11:03:39,288 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-26 11:03:39,346 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-26 11:03:39,371 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-26 11:03:39,371 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-26 11:03:39,325 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-26 11:03:39,326 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-26 11:03:39,557 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-26 11:03:39,558 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-26 11:03:39,611 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-26 11:03:39,611 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run f75s53i9
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1024_1F1B_auto_h200/20251026-1103/wandb/run-20251026_110339-f75s53i9
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1024_1F1B_auto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/f75s53i9
[rank3]:2025-10-26 11:03:40,880 - INFO - WandB logging enabled
[rank3]:2025-10-26 11:03:40,882 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-26 11:03:40,954 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-26 11:03:40,955 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-10-26 11:03:41,174 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-26 11:03:41,175 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-26 11:03:41,206 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1024_1F1B_auto_h200
[rank0]:2025-10-26 11:03:41,206 - WARNING - Mixed precision training with TP or PP is only supported when FSDP/HSDP/CP is enabled.
[rank0]:2025-10-26 11:03:41,206 - INFO - Mixed precision training is disabled
[rank0]:2025-10-26 11:03:41,206 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 100)
[rank0]:2025-10-26 11:03:41,206 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-26 11:03:50,731 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-26 11:03:50,731 - INFO - Finished loading the checkpoint in 9.53 seconds.
[rank0]:2025-10-26 11:03:50,731 - INFO - Training starts at step 1
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/autograd/graph.py:849: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[rank0]:  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank1]:2025-10-26 11:04:15,032 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 34.42GiB(24.62%)  tps: 459  tflops: 21.39  mfu: 2.16%
[rank1]:2025-10-26 11:04:15,032 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-26 11:04:15,049 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 39.86GiB(28.51%)  tps: 459  tflops: 21.40  mfu: 2.16%
[rank0]:2025-10-26 11:04:15,050 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-26 11:04:15,049 - INFO -  step:  1  loss: -4.0000  grad_norm:  3.0754  memory: 26.61GiB(19.03%)  tps: 455  tflops: 21.23  mfu: 2.15%
[rank2]:2025-10-26 11:04:15,049 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-26 11:04:15,059 - INFO -  step:  1  loss:  1.5658  grad_norm:  3.0754  memory: 38.77GiB(27.73%)  tps: 480  tflops: 22.39  mfu: 2.26%
[rank3]:2025-10-26 11:04:15,060 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-26 11:04:53,036 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,036 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,037 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,038 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:04:53,039 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,337 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-26 11:04:53,338 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,673 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,674 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,674 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,674 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-26 11:04:53,674 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,975 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-26 11:04:53,975 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-26 11:11:17,391 - INFO -  step: 20  loss:  1.1858  grad_norm:  1.1848  memory: 52.47GiB(37.53%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank0]:2025-10-26 11:11:17,393 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 56.85GiB(40.66%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank1]:2025-10-26 11:11:17,389 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 48.97GiB(35.03%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank2]:2025-10-26 11:11:17,386 - INFO -  step: 20  loss: -4.0000  grad_norm:  1.1848  memory: 38.19GiB(27.32%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank3]:2025-10-26 11:11:22,011 - INFO - Avg. fwd time: 167.3877 / Avg. bwd time: 339.2615 / Avg. batch time: 4114.3528 (ms) / GPU bubble ratio: 1.49%
[rank2]:2025-10-26 11:11:22,310 - INFO - Avg. fwd time: 144.7235 / Avg. bwd time: 292.4688 / Avg. batch time: 4557.9522 (ms) / GPU bubble ratio: 23.27%
[rank1]:2025-10-26 11:11:22,645 - INFO - Avg. fwd time: 162.8248 / Avg. bwd time: 329.0592 / Avg. batch time: 5056.6216 (ms) / GPU bubble ratio: 22.18%
[rank0]:2025-10-26 11:11:22,946 - INFO - Avg. fwd time: 144.9804 / Avg. bwd time: 294.3707 / Avg. batch time: 5502.5129 (ms) / GPU bubble ratio: 36.12%
[rank1]:2025-10-26 11:18:41,836 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5196  memory: 48.97GiB(35.03%)  tps: 737  tflops: 34.39  mfu: 3.48%
[rank2]:2025-10-26 11:18:41,833 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5196  memory: 38.19GiB(27.32%)  tps: 737  tflops: 34.39  mfu: 3.48%
[rank0]:2025-10-26 11:18:41,840 - INFO -  step: 40  loss: -4.0000  grad_norm:  0.5196  memory: 56.85GiB(40.66%)  tps: 737  tflops: 34.39  mfu: 3.48%
[rank3]:2025-10-26 11:18:41,838 - INFO -  step: 40  loss:  1.0795  grad_norm:  0.5196  memory: 52.47GiB(37.53%)  tps: 737  tflops: 34.39  mfu: 3.48%
[rank3]:2025-10-26 11:18:46,460 - INFO - Avg. fwd time: 168.4280 / Avg. bwd time: 341.3659 / Avg. batch time: 4114.3358 (ms) / GPU bubble ratio: 0.87%
[rank2]:2025-10-26 11:18:46,759 - INFO - Avg. fwd time: 145.6193 / Avg. bwd time: 294.2784 / Avg. batch time: 4557.9233 (ms) / GPU bubble ratio: 22.79%
[rank1]:2025-10-26 11:18:47,094 - INFO - Avg. fwd time: 163.8487 / Avg. bwd time: 331.1345 / Avg. batch time: 5056.5924 (ms) / GPU bubble ratio: 21.69%
[rank0]:2025-10-26 11:18:47,395 - INFO - Avg. fwd time: 145.9323 / Avg. bwd time: 296.1980 / Avg. batch time: 5502.4555 (ms) / GPU bubble ratio: 35.72%
[rank0]:2025-10-26 11:22:01,844 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank1]:2025-10-26 11:26:06,309 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4484  memory: 48.97GiB(35.03%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank3]:2025-10-26 11:26:06,312 - INFO -  step: 60  loss:  1.0643  grad_norm:  0.4484  memory: 52.47GiB(37.53%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank0]:2025-10-26 11:26:06,313 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4484  memory: 56.85GiB(40.66%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank2]:2025-10-26 11:26:06,307 - INFO -  step: 60  loss: -4.0000  grad_norm:  0.4484  memory: 38.19GiB(27.32%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank3]:2025-10-26 11:26:10,935 - INFO - Avg. fwd time: 168.7797 / Avg. bwd time: 342.0775 / Avg. batch time: 4114.3819 (ms) / GPU bubble ratio: 0.67%
[rank2]:2025-10-26 11:26:11,233 - INFO - Avg. fwd time: 145.9223 / Avg. bwd time: 294.8880 / Avg. batch time: 4557.9615 (ms) / GPU bubble ratio: 22.63%
[rank1]:2025-10-26 11:26:11,569 - INFO - Avg. fwd time: 164.1916 / Avg. bwd time: 331.8356 / Avg. batch time: 5056.6388 (ms) / GPU bubble ratio: 21.52%
[rank0]:2025-10-26 11:26:11,870 - INFO - Avg. fwd time: 146.2585 / Avg. bwd time: 296.8133 / Avg. batch time: 5502.5031 (ms) / GPU bubble ratio: 35.58%
[rank2]:2025-10-26 11:33:30,832 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4301  memory: 38.19GiB(27.32%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank3]:2025-10-26 11:33:30,837 - INFO -  step: 80  loss:  1.0454  grad_norm:  0.4301  memory: 52.47GiB(37.53%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank1]:2025-10-26 11:33:30,834 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4301  memory: 48.97GiB(35.03%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank0]:2025-10-26 11:33:30,838 - INFO -  step: 80  loss: -4.0000  grad_norm:  0.4301  memory: 56.85GiB(40.66%)  tps: 737  tflops: 34.38  mfu: 3.48%
[rank3]:2025-10-26 11:33:35,455 - INFO - Avg. fwd time: 168.9566 / Avg. bwd time: 342.4358 / Avg. batch time: 4114.4194 (ms) / GPU bubble ratio: 0.57%
[rank2]:2025-10-26 11:33:35,754 - INFO - Avg. fwd time: 146.0744 / Avg. bwd time: 295.1937 / Avg. batch time: 4558.0081 (ms) / GPU bubble ratio: 22.55%
[rank1]:2025-10-26 11:33:36,090 - INFO - Avg. fwd time: 164.3633 / Avg. bwd time: 332.1865 / Avg. batch time: 5056.6858 (ms) / GPU bubble ratio: 21.44%
[rank0]:2025-10-26 11:33:36,391 - INFO - Avg. fwd time: 146.4302 / Avg. bwd time: 297.1222 / Avg. batch time: 5502.5527 (ms) / GPU bubble ratio: 35.51%
[rank3]:2025-10-26 11:34:18,878 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 11:34:20,211 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 11:34:20,545 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 11:34:20,843 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 11:39:04,719 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-26 11:39:04,722 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-26 11:39:04,723 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-26 11:39:04,726 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-26 11:40:33,624 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-26 11:40:55,867 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2736e-01
[rank2]:2025-10-26 11:40:55,867 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 38.19GiB(27.32%)  tps: 736  tflops: 34.34  mfu: 3.47%
[rank3]:2025-10-26 11:40:55,870 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 7.4316e-01
[rank3]:2025-10-26 11:40:55,875 - INFO -  step: 100  loss:  1.0454  grad_norm:  0.4329  memory: 52.47GiB(37.53%)  tps: 736  tflops: 34.34  mfu: 3.47%
[rank0]:2025-10-26 11:40:55,874 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8183e-01
[rank0]:2025-10-26 11:40:55,874 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 56.85GiB(40.66%)  tps: 736  tflops: 34.34  mfu: 3.47%
[rank1]:2025-10-26 11:40:55,870 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2124e-01
[rank1]:2025-10-26 11:40:55,870 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4329  memory: 48.97GiB(35.03%)  tps: 736  tflops: 34.34  mfu: 3.47%
[rank1]:2025-10-26 11:40:55,944 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank1/251026_1140_stage1_step100.svg
[rank2]:2025-10-26 11:40:55,946 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank2/251026_1140_stage2_step100.svg
[rank0]:2025-10-26 11:40:55,948 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank0/251026_1140_stage0_step100.svg
[rank3]:2025-10-26 11:40:56,087 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/pipeline_schedule/251026_1140_real_step100_rank3.svg
[rank3]:> Batch Time: 5491.38 ms, GPU Bubble Ratio: 35.16%, 27.42%, 35.50%, 25.23%
[rank3]:2025-10-26 11:40:56,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank3/251026_1140_stage3_step100.svg
[rank3]:2025-10-26 11:41:00,429 - INFO - Avg. fwd time: 169.0620 / Avg. bwd time: 342.6050 / Avg. batch time: 4114.0647 (ms) / GPU bubble ratio: 0.50%
[rank2]:2025-10-26 11:41:00,657 - INFO - Avg. fwd time: 146.1718 / Avg. bwd time: 295.2051 / Avg. batch time: 4557.4757 (ms) / GPU bubble ratio: 22.52%
[rank1]:2025-10-26 11:41:00,993 - INFO - Avg. fwd time: 164.4708 / Avg. bwd time: 332.4059 / Avg. batch time: 5056.1596 (ms) / GPU bubble ratio: 21.38%
[rank0]:2025-10-26 11:41:01,294 - INFO - Avg. fwd time: 146.5414 / Avg. bwd time: 297.3074 / Avg. batch time: 5502.0292 (ms) / GPU bubble ratio: 35.46%
[rank1]:2025-10-26 11:42:42,846 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.0185e-01
[rank2]:2025-10-26 11:42:42,830 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6270e+00
[rank0]:2025-10-26 11:42:42,850 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.6870e-01
[rank3]:2025-10-26 11:42:42,844 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3661e+00
[rank3]:2025-10-26 11:44:34,016 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 4.9571e-01
[rank1]:2025-10-26 11:44:34,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0327e-01
[rank2]:2025-10-26 11:44:34,012 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9619e-02
[rank0]:2025-10-26 11:44:34,019 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.4412e-01
[rank2]:2025-10-26 11:46:20,532 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0743e+00
[rank0]:2025-10-26 11:46:20,548 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.0837e+00
[rank3]:2025-10-26 11:46:20,546 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.7637e-01
[rank1]:2025-10-26 11:46:20,547 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.6519e-01
[rank1]:2025-10-26 11:48:11,693 - INFO - Freezing Ratio: [Stage1] 0.11, Threshold: 5.6224e-01
[rank1]:2025-10-26 11:48:11,694 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4408  memory: 48.97GiB(35.03%)  tps: 752  tflops: 35.07  mfu: 3.55%
[rank3]:2025-10-26 11:48:11,694 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 7.9312e-01
[rank3]:2025-10-26 11:48:11,699 - INFO -  step: 120  loss:  0.9909  grad_norm:  0.4408  memory: 52.47GiB(37.53%)  tps: 752  tflops: 35.07  mfu: 3.55%
[rank0]:2025-10-26 11:48:11,697 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.2043e-01
[rank0]:2025-10-26 11:48:11,698 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4408  memory: 56.85GiB(40.66%)  tps: 752  tflops: 35.07  mfu: 3.55%
[rank2]:2025-10-26 11:48:11,691 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7045e-01
[rank2]:2025-10-26 11:48:11,691 - INFO -  step: 120  loss: -4.0000  grad_norm:  0.4408  memory: 38.19GiB(27.32%)  tps: 752  tflops: 35.07  mfu: 3.55%
[rank3]:2025-10-26 11:48:16,176 - INFO - Avg. fwd time: 169.1337 / Avg. bwd time: 341.2820 / Avg. batch time: 4102.3286 (ms) / GPU bubble ratio: 0.46%
[rank2]:2025-10-26 11:48:16,404 - INFO - Avg. fwd time: 146.2338 / Avg. bwd time: 289.4758 / Avg. batch time: 4539.8654 (ms) / GPU bubble ratio: 23.22%
[rank1]:2025-10-26 11:48:16,722 - INFO - Avg. fwd time: 164.5521 / Avg. bwd time: 332.5690 / Avg. batch time: 5038.5121 (ms) / GPU bubble ratio: 21.07%
[rank0]:2025-10-26 11:48:17,005 - INFO - Avg. fwd time: 146.6252 / Avg. bwd time: 296.6604 / Avg. batch time: 5483.6107 (ms) / GPU bubble ratio: 35.33%
[rank1]:2025-10-26 11:49:57,876 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0678e-01
[rank3]:2025-10-26 11:49:57,876 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0015e+00
[rank2]:2025-10-26 11:49:57,863 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.0216e-01
[rank0]:2025-10-26 11:49:57,880 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.3068e-01
[rank1]:2025-10-26 11:51:49,059 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 6.8204e-01
[rank3]:2025-10-26 11:51:49,059 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 8.9946e-01
[rank0]:2025-10-26 11:51:49,063 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.0607e+00
[rank2]:2025-10-26 11:51:49,056 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4824e-01
[rank3]:2025-10-26 11:53:34,903 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7538e-01
[rank0]:2025-10-26 11:53:34,906 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.7173e-01
[rank2]:2025-10-26 11:53:34,890 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1182e-01
[rank1]:2025-10-26 11:53:34,899 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.3571e-01
[rank1]:2025-10-26 11:55:26,047 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 1.3625e-01
[rank1]:2025-10-26 11:55:26,047 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4137  memory: 48.97GiB(35.03%)  tps: 754  tflops: 35.19  mfu: 3.56%
[rank3]:2025-10-26 11:55:26,047 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 6.6040e-01
[rank3]:2025-10-26 11:55:26,052 - INFO -  step: 140  loss:  1.0172  grad_norm:  0.4137  memory: 52.47GiB(37.53%)  tps: 754  tflops: 35.19  mfu: 3.56%
[rank2]:2025-10-26 11:55:26,044 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5434e-01
[rank2]:2025-10-26 11:55:26,044 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4137  memory: 38.19GiB(27.32%)  tps: 754  tflops: 35.19  mfu: 3.56%
[rank0]:2025-10-26 11:55:26,050 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.3925e-01
[rank0]:2025-10-26 11:55:26,051 - INFO -  step: 140  loss: -4.0000  grad_norm:  0.4137  memory: 56.85GiB(40.66%)  tps: 754  tflops: 35.19  mfu: 3.56%
[rank3]:2025-10-26 11:55:30,532 - INFO - Avg. fwd time: 169.1857 / Avg. bwd time: 340.3393 / Avg. batch time: 4093.9741 (ms) / GPU bubble ratio: 0.43%
[rank2]:2025-10-26 11:55:30,760 - INFO - Avg. fwd time: 146.2804 / Avg. bwd time: 285.3818 / Avg. batch time: 4527.3156 (ms) / GPU bubble ratio: 23.72%
[rank1]:2025-10-26 11:55:31,060 - INFO - Avg. fwd time: 164.6035 / Avg. bwd time: 330.7433 / Avg. batch time: 5024.0351 (ms) / GPU bubble ratio: 21.12%
[rank0]:2025-10-26 11:55:31,343 - INFO - Avg. fwd time: 146.6774 / Avg. bwd time: 295.5967 / Avg. batch time: 5467.9828 (ms) / GPU bubble ratio: 35.29%
[rank3]:2025-10-26 11:57:11,902 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.2796e-01
[rank2]:2025-10-26 11:57:11,888 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.1789e-01
[rank0]:2025-10-26 11:57:11,905 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.3874e-01
[rank1]:2025-10-26 11:57:11,898 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2806e-01
[rank0]:2025-10-26 11:58:40,825 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-26 11:59:03,075 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1064e-01
[rank3]:2025-10-26 11:59:03,079 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 4.7426e-01
[rank0]:2025-10-26 11:59:03,081 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 2.5947e-01
[rank1]:2025-10-26 11:59:03,078 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 1.5352e-01
[rank2]:2025-10-26 12:00:48,576 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.3408e-01
[rank0]:2025-10-26 12:00:48,590 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.6273e-01
[rank3]:2025-10-26 12:00:48,590 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9405e-01
[rank1]:2025-10-26 12:00:48,586 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6150e-01
[rank0]:2025-10-26 12:02:39,784 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.0563e+00
[rank0]:2025-10-26 12:02:39,784 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.3952  memory: 56.85GiB(40.66%)  tps: 755  tflops: 35.24  mfu: 3.56%
[rank3]:2025-10-26 12:02:39,781 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 4.7558e-01
[rank3]:2025-10-26 12:02:39,786 - INFO -  step: 160  loss:  0.9760  grad_norm:  0.3952  memory: 52.47GiB(37.53%)  tps: 755  tflops: 35.24  mfu: 3.56%
[rank1]:2025-10-26 12:02:39,780 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 7.2856e-01
[rank1]:2025-10-26 12:02:39,780 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.3952  memory: 48.97GiB(35.03%)  tps: 755  tflops: 35.24  mfu: 3.56%
[rank2]:2025-10-26 12:02:39,777 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3084e-01
[rank2]:2025-10-26 12:02:39,777 - INFO -  step: 160  loss: -4.0000  grad_norm:  0.3952  memory: 38.19GiB(27.32%)  tps: 755  tflops: 35.24  mfu: 3.56%
[rank3]:2025-10-26 12:02:44,268 - INFO - Avg. fwd time: 169.2241 / Avg. bwd time: 339.6393 / Avg. batch time: 4087.7641 (ms) / GPU bubble ratio: 0.41%
[rank2]:2025-10-26 12:02:44,496 - INFO - Avg. fwd time: 146.3141 / Avg. bwd time: 282.3085 / Avg. batch time: 4517.9602 (ms) / GPU bubble ratio: 24.10%
[rank1]:2025-10-26 12:02:44,797 - INFO - Avg. fwd time: 164.6422 / Avg. bwd time: 328.8484 / Avg. batch time: 5012.7109 (ms) / GPU bubble ratio: 21.24%
[rank0]:2025-10-26 12:02:45,062 - INFO - Avg. fwd time: 146.7199 / Avg. bwd time: 294.2195 / Avg. batch time: 5455.2194 (ms) / GPU bubble ratio: 35.34%
[rank3]:2025-10-26 12:04:12,942 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 12:04:14,187 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 12:04:14,488 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 12:04:14,750 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 12:04:25,906 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2731e-01
[rank0]:2025-10-26 12:04:25,920 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.3996e-01
[rank3]:2025-10-26 12:04:25,920 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.0951e-01
[rank1]:2025-10-26 12:04:25,916 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.5494e-01
[rank1]:2025-10-26 12:06:17,067 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 2.4609e-01
[rank3]:2025-10-26 12:06:17,068 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 2.1595e-01
[rank0]:2025-10-26 12:06:17,071 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.9643e-01
[rank2]:2025-10-26 12:06:17,064 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4074e-01
[rank3]:2025-10-26 12:08:02,184 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.9720e-01
[rank0]:2025-10-26 12:08:02,181 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.3588e-01
[rank2]:2025-10-26 12:08:02,170 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0654e-01
[rank1]:2025-10-26 12:08:02,180 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2930e-01
[rank1]:2025-10-26 12:09:53,361 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.3857e-01
[rank1]:2025-10-26 12:09:53,362 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4040  memory: 48.97GiB(35.03%)  tps: 756  tflops: 35.25  mfu: 3.56%
[rank3]:2025-10-26 12:09:53,362 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 3.8298e-01
[rank3]:2025-10-26 12:09:53,367 - INFO -  step: 180  loss:  0.9491  grad_norm:  0.4040  memory: 52.47GiB(37.53%)  tps: 756  tflops: 35.25  mfu: 3.56%
[rank2]:2025-10-26 12:09:53,358 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8292e-02
[rank2]:2025-10-26 12:09:53,358 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4040  memory: 38.19GiB(27.32%)  tps: 756  tflops: 35.25  mfu: 3.56%
[rank0]:2025-10-26 12:09:53,365 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.9537e-01
[rank0]:2025-10-26 12:09:53,365 - INFO -  step: 180  loss: -4.0000  grad_norm:  0.4040  memory: 56.85GiB(40.66%)  tps: 756  tflops: 35.25  mfu: 3.56%
[rank3]:2025-10-26 12:09:57,846 - INFO - Avg. fwd time: 169.2543 / Avg. bwd time: 339.1111 / Avg. batch time: 4083.0678 (ms) / GPU bubble ratio: 0.40%
[rank2]:2025-10-26 12:09:58,074 - INFO - Avg. fwd time: 146.3414 / Avg. bwd time: 279.9167 / Avg. batch time: 4510.8140 (ms) / GPU bubble ratio: 24.40%
[rank1]:2025-10-26 12:09:58,357 - INFO - Avg. fwd time: 164.6744 / Avg. bwd time: 327.3511 / Avg. batch time: 5004.0078 (ms) / GPU bubble ratio: 21.34%
[rank0]:2025-10-26 12:09:58,605 - INFO - Avg. fwd time: 146.7517 / Avg. bwd time: 292.1677 / Avg. batch time: 5444.4111 (ms) / GPU bubble ratio: 35.51%
[rank1]:2025-10-26 12:11:38,145 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1626e-01
[rank3]:2025-10-26 12:11:38,152 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.1064e-01
[rank2]:2025-10-26 12:11:38,139 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.7329e-01
[rank0]:2025-10-26 12:11:38,149 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.6666e-01
[rank2]:2025-10-26 12:13:29,344 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4705e-01
[rank0]:2025-10-26 12:13:29,351 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1405e-01
[rank3]:2025-10-26 12:13:29,348 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 5.6742e-01
[rank1]:2025-10-26 12:13:29,347 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.0285e-01
[rank2]:2025-10-26 12:15:14,166 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.8964e-01
[rank3]:2025-10-26 12:15:14,179 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.5294e-01
[rank1]:2025-10-26 12:15:14,173 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7677e-01
[rank0]:2025-10-26 12:15:14,176 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.6018e-01
[rank0]:2025-10-26 12:16:43,184 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-26 12:17:05,453 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6891e-01
[rank0]:2025-10-26 12:17:05,454 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4095  memory: 56.85GiB(40.66%)  tps: 758  tflops: 35.37  mfu: 3.58%
[rank2]:2025-10-26 12:17:05,446 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0430e-01
[rank2]:2025-10-26 12:17:05,447 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4095  memory: 38.19GiB(27.32%)  tps: 758  tflops: 35.37  mfu: 3.58%
[rank3]:2025-10-26 12:17:05,450 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 7.8072e-01
[rank3]:2025-10-26 12:17:05,455 - INFO -  step: 200  loss:  0.9381  grad_norm:  0.4095  memory: 52.47GiB(37.53%)  tps: 758  tflops: 35.37  mfu: 3.58%
[rank1]:2025-10-26 12:17:05,450 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6367e-01
[rank1]:2025-10-26 12:17:05,450 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4095  memory: 48.97GiB(35.03%)  tps: 758  tflops: 35.37  mfu: 3.58%
[rank0]:2025-10-26 12:17:05,528 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank0/251026_1217_stage0_step200.svg
[rank2]:2025-10-26 12:17:05,527 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank2/251026_1217_stage2_step200.svg
[rank1]:2025-10-26 12:17:05,525 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank1/251026_1217_stage1_step200.svg
[rank3]:2025-10-26 12:17:05,651 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/pipeline_schedule/251026_1217_real_step200_rank3.svg
[rank3]:> Batch Time: 5490.38 ms, GPU Bubble Ratio: 35.14%, 27.41%, 35.49%, 25.24%
[rank3]:2025-10-26 12:17:05,719 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank3/251026_1217_stage3_step200.svg
[rank3]:2025-10-26 12:17:10,012 - INFO - Avg. fwd time: 169.2788 / Avg. bwd time: 338.7066 / Avg. batch time: 4079.4597 (ms) / GPU bubble ratio: 0.38%
[rank2]:2025-10-26 12:17:10,241 - INFO - Avg. fwd time: 146.3627 / Avg. bwd time: 278.0012 / Avg. batch time: 4505.2453 (ms) / GPU bubble ratio: 24.65%
[rank1]:2025-10-26 12:17:10,506 - INFO - Avg. fwd time: 164.6997 / Avg. bwd time: 325.2724 / Avg. batch time: 4996.3077 (ms) / GPU bubble ratio: 21.55%
[rank0]:2025-10-26 12:17:10,737 - INFO - Avg. fwd time: 146.7828 / Avg. bwd time: 290.0846 / Avg. batch time: 5434.5834 (ms) / GPU bubble ratio: 35.69%
[rank2]:2025-10-26 12:18:49,647 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5526e-01
[rank3]:2025-10-26 12:18:49,660 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6166e-01
[rank1]:2025-10-26 12:18:49,650 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.9241e-01
[rank0]:2025-10-26 12:18:49,654 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.2467e-01
[rank3]:2025-10-26 12:20:40,863 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.2455e-01
[rank1]:2025-10-26 12:20:40,862 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5801e-01
[rank0]:2025-10-26 12:20:40,866 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3792e-01
[rank2]:2025-10-26 12:20:40,859 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2383e-01
[rank1]:2025-10-26 12:22:22,128 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.7197e-01
[rank3]:2025-10-26 12:22:22,135 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2601e-01
[rank2]:2025-10-26 12:22:22,124 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3970e-01
[rank0]:2025-10-26 12:22:22,131 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.3231e-01
[rank3]:2025-10-26 12:24:13,358 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.5374e-01
[rank3]:2025-10-26 12:24:13,363 - INFO -  step: 220  loss:  0.9050  grad_norm:  0.3991  memory: 52.47GiB(37.53%)  tps: 766  tflops: 35.72  mfu: 3.61%
[rank0]:2025-10-26 12:24:13,361 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.2962e-02
[rank0]:2025-10-26 12:24:13,361 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3991  memory: 56.85GiB(40.66%)  tps: 766  tflops: 35.72  mfu: 3.61%
[rank2]:2025-10-26 12:24:13,354 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4475e-01
[rank2]:2025-10-26 12:24:13,354 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3991  memory: 38.19GiB(27.32%)  tps: 766  tflops: 35.72  mfu: 3.61%
[rank1]:2025-10-26 12:24:13,357 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.2963e-01
[rank1]:2025-10-26 12:24:13,358 - INFO -  step: 220  loss: -4.0000  grad_norm:  0.3991  memory: 48.97GiB(35.03%)  tps: 766  tflops: 35.72  mfu: 3.61%
[rank3]:2025-10-26 12:24:17,705 - INFO - Avg. fwd time: 169.2992 / Avg. bwd time: 337.9616 / Avg. batch time: 4073.1939 (ms) / GPU bubble ratio: 0.37%
[rank2]:2025-10-26 12:24:17,934 - INFO - Avg. fwd time: 146.3785 / Avg. bwd time: 276.4328 / Avg. batch time: 4497.3748 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-26 12:24:18,199 - INFO - Avg. fwd time: 164.7200 / Avg. bwd time: 322.7891 / Avg. batch time: 4985.9055 (ms) / GPU bubble ratio: 21.78%
[rank0]:2025-10-26 12:24:18,430 - INFO - Avg. fwd time: 146.8074 / Avg. bwd time: 287.5957 / Avg. batch time: 5421.6575 (ms) / GPU bubble ratio: 35.90%
[rank1]:2025-10-26 12:25:54,630 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1831e-01
[rank3]:2025-10-26 12:25:54,637 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.3839e-01
[rank2]:2025-10-26 12:25:54,627 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.9854e-01
[rank0]:2025-10-26 12:25:54,634 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0945e-01
[rank0]:2025-10-26 12:27:45,872 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.3491e-01
[rank2]:2025-10-26 12:27:45,865 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2627e-01
[rank1]:2025-10-26 12:27:45,868 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0888e-01
[rank3]:2025-10-26 12:27:45,869 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.1398e-01
[rank3]:2025-10-26 12:29:27,152 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.8583e-01
[rank2]:2025-10-26 12:29:27,142 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.2904e-01
[rank0]:2025-10-26 12:29:27,149 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7437e-01
[rank1]:2025-10-26 12:29:27,145 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7677e-01
[rank1]:2025-10-26 12:31:18,391 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.3299e-02
[rank1]:2025-10-26 12:31:18,391 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4103  memory: 48.97GiB(35.03%)  tps: 771  tflops: 35.96  mfu: 3.64%
[rank0]:2025-10-26 12:31:18,395 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1198e-01
[rank0]:2025-10-26 12:31:18,395 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4103  memory: 56.85GiB(40.66%)  tps: 771  tflops: 35.96  mfu: 3.64%
[rank3]:2025-10-26 12:31:18,392 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.8269e-01
[rank3]:2025-10-26 12:31:18,397 - INFO -  step: 240  loss:  0.8666  grad_norm:  0.4103  memory: 52.47GiB(37.53%)  tps: 771  tflops: 35.96  mfu: 3.64%
[rank2]:2025-10-26 12:31:18,388 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.2925e-02
[rank2]:2025-10-26 12:31:18,388 - INFO -  step: 240  loss: -4.0000  grad_norm:  0.4103  memory: 38.19GiB(27.32%)  tps: 771  tflops: 35.96  mfu: 3.64%
[rank3]:2025-10-26 12:31:22,738 - INFO - Avg. fwd time: 169.3163 / Avg. bwd time: 336.9959 / Avg. batch time: 4065.2126 (ms) / GPU bubble ratio: 0.36%
[rank2]:2025-10-26 12:31:22,967 - INFO - Avg. fwd time: 146.3910 / Avg. bwd time: 275.1248 / Avg. batch time: 4488.0544 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-10-26 12:31:23,233 - INFO - Avg. fwd time: 164.7377 / Avg. bwd time: 320.7220 / Avg. batch time: 4974.4760 (ms) / GPU bubble ratio: 21.93%
[rank0]:2025-10-26 12:31:23,463 - INFO - Avg. fwd time: 146.8307 / Avg. bwd time: 285.5210 / Avg. batch time: 5408.1243 (ms) / GPU bubble ratio: 36.04%
[rank1]:2025-10-26 12:32:59,684 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1275e-01
[rank0]:2025-10-26 12:32:59,688 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0775e-01
[rank3]:2025-10-26 12:32:59,691 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5991e-01
[rank2]:2025-10-26 12:32:59,681 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3734e-01
[rank3]:2025-10-26 12:33:36,697 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 12:33:38,028 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 12:33:38,365 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 12:33:38,661 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 12:34:29,267 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-26 12:34:51,544 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0406e-01
[rank3]:2025-10-26 12:34:51,549 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.6544e-01
[rank1]:2025-10-26 12:34:51,548 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7859e-01
[rank0]:2025-10-26 12:34:51,551 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2307e-01
[rank1]:2025-10-26 12:36:32,844 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1520e-01
[rank0]:2025-10-26 12:36:32,848 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6561e-01
[rank2]:2025-10-26 12:36:32,841 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6916e-01
[rank3]:2025-10-26 12:36:32,851 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2900e-01
[rank2]:2025-10-26 12:38:24,091 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9593e-02
[rank2]:2025-10-26 12:38:24,092 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4210  memory: 38.19GiB(27.32%)  tps: 770  tflops: 35.90  mfu: 3.63%
[rank3]:2025-10-26 12:38:24,095 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.7601e-01
[rank3]:2025-10-26 12:38:24,100 - INFO -  step: 260  loss:  0.8553  grad_norm:  0.4210  memory: 52.47GiB(37.53%)  tps: 770  tflops: 35.90  mfu: 3.63%
[rank1]:2025-10-26 12:38:24,095 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.9364e-01
[rank1]:2025-10-26 12:38:24,095 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4210  memory: 48.97GiB(35.03%)  tps: 770  tflops: 35.90  mfu: 3.63%
[rank0]:2025-10-26 12:38:24,098 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6724e-01
[rank0]:2025-10-26 12:38:24,099 - INFO -  step: 260  loss: -4.0000  grad_norm:  0.4210  memory: 56.85GiB(40.66%)  tps: 770  tflops: 35.90  mfu: 3.63%
[rank3]:2025-10-26 12:38:28,445 - INFO - Avg. fwd time: 169.3316 / Avg. bwd time: 336.1835 / Avg. batch time: 4058.5055 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-26 12:38:28,674 - INFO - Avg. fwd time: 146.4017 / Avg. bwd time: 274.0179 / Avg. batch time: 4480.2165 (ms) / GPU bubble ratio: 24.93%
[rank1]:2025-10-26 12:38:28,939 - INFO - Avg. fwd time: 164.7543 / Avg. bwd time: 318.9764 / Avg. batch time: 4964.8570 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-26 12:38:29,170 - INFO - Avg. fwd time: 146.8513 / Avg. bwd time: 283.7649 / Avg. batch time: 5396.7263 (ms) / GPU bubble ratio: 36.17%
[rank2]:2025-10-26 12:40:05,400 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2692e-01
[rank3]:2025-10-26 12:40:05,410 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6702e-01
[rank0]:2025-10-26 12:40:05,407 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.4614e-01
[rank1]:2025-10-26 12:40:05,403 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8312e-01
[rank2]:2025-10-26 12:41:56,675 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3959e-01
[rank3]:2025-10-26 12:41:56,679 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.7931e-01
[rank0]:2025-10-26 12:41:56,682 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2053e-01
[rank1]:2025-10-26 12:41:56,678 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.5068e-02
[rank0]:2025-10-26 12:43:38,019 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.1203e-01
[rank1]:2025-10-26 12:43:38,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.3409e-01
[rank2]:2025-10-26 12:43:38,012 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.1824e-01
[rank3]:2025-10-26 12:43:38,023 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.7611e-01
[rank3]:2025-10-26 12:45:29,307 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.5172e-01
[rank3]:2025-10-26 12:45:29,313 - INFO -  step: 280  loss:  0.8664  grad_norm:  0.4070  memory: 52.47GiB(37.53%)  tps: 771  tflops: 35.94  mfu: 3.63%
[rank0]:2025-10-26 12:45:29,310 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9567e-01
[rank0]:2025-10-26 12:45:29,311 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4070  memory: 56.85GiB(40.66%)  tps: 771  tflops: 35.94  mfu: 3.63%
[rank1]:2025-10-26 12:45:29,306 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.2186e-01
[rank1]:2025-10-26 12:45:29,307 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4070  memory: 48.97GiB(35.03%)  tps: 771  tflops: 35.94  mfu: 3.63%
[rank2]:2025-10-26 12:45:29,303 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6623e-01
[rank2]:2025-10-26 12:45:29,304 - INFO -  step: 280  loss: -4.0000  grad_norm:  0.4070  memory: 38.19GiB(27.32%)  tps: 771  tflops: 35.94  mfu: 3.63%
[rank3]:2025-10-26 12:45:33,661 - INFO - Avg. fwd time: 169.3451 / Avg. bwd time: 335.4958 / Avg. batch time: 4052.8296 (ms) / GPU bubble ratio: 0.35%
[rank2]:2025-10-26 12:45:33,890 - INFO - Avg. fwd time: 146.4121 / Avg. bwd time: 273.0693 / Avg. batch time: 4473.5732 (ms) / GPU bubble ratio: 24.98%
[rank1]:2025-10-26 12:45:34,155 - INFO - Avg. fwd time: 164.7695 / Avg. bwd time: 317.4801 / Avg. batch time: 4956.6841 (ms) / GPU bubble ratio: 22.17%
[rank0]:2025-10-26 12:45:34,386 - INFO - Avg. fwd time: 146.8714 / Avg. bwd time: 282.2598 / Avg. batch time: 5387.0279 (ms) / GPU bubble ratio: 36.27%
[rank0]:2025-10-26 12:47:10,703 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0446e-01
[rank1]:2025-10-26 12:47:10,699 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.5783e-01
[rank2]:2025-10-26 12:47:10,696 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6651e-01
[rank3]:2025-10-26 12:47:10,707 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3455e-01
[rank3]:2025-10-26 12:49:02,004 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.3145e-01
[rank0]:2025-10-26 12:49:02,007 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.5226e-02
[rank1]:2025-10-26 12:49:02,003 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.0696e-02
[rank2]:2025-10-26 12:49:02,000 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0358e-01
[rank3]:2025-10-26 12:50:40,552 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.7338e-01
[rank0]:2025-10-26 12:50:40,552 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.0909e-01
[rank2]:2025-10-26 12:50:40,545 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.0093e-01
[rank1]:2025-10-26 12:50:40,548 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4796e-01
[rank0]:2025-10-26 12:52:09,604 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2025-10-26 12:52:31,889 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9870e-01
[rank2]:2025-10-26 12:52:31,889 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4440  memory: 38.19GiB(27.32%)  tps: 775  tflops: 36.17  mfu: 3.66%
[rank1]:2025-10-26 12:52:31,892 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.9587e-01
[rank1]:2025-10-26 12:52:31,893 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4440  memory: 48.97GiB(35.03%)  tps: 775  tflops: 36.17  mfu: 3.66%
[rank0]:2025-10-26 12:52:31,896 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9897e-01
[rank0]:2025-10-26 12:52:31,897 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4440  memory: 56.85GiB(40.66%)  tps: 775  tflops: 36.17  mfu: 3.66%
[rank0]:2025-10-26 12:52:31,965 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank0/251026_1252_stage0_step300.svg
[rank3]:2025-10-26 12:52:31,893 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.2526e-01
[rank3]:2025-10-26 12:52:31,898 - INFO -  step: 300  loss:  0.8315  grad_norm:  0.4440  memory: 52.47GiB(37.53%)  tps: 775  tflops: 36.17  mfu: 3.66%
[rank2]:2025-10-26 12:52:31,964 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank2/251026_1252_stage2_step300.svg
[rank1]:2025-10-26 12:52:31,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank1/251026_1252_stage1_step300.svg
[rank3]:2025-10-26 12:52:32,096 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/pipeline_schedule/251026_1252_real_step300_rank3.svg
[rank3]:> Batch Time: 5484.88 ms, GPU Bubble Ratio: 35.06%, 27.35%, 35.51%, 25.27%
[rank3]:2025-10-26 12:52:32,154 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank3/251026_1252_stage3_step300.svg
[rank3]:2025-10-26 12:52:36,170 - INFO - Avg. fwd time: 169.3595 / Avg. bwd time: 334.5959 / Avg. batch time: 4045.4995 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-26 12:52:36,400 - INFO - Avg. fwd time: 146.4212 / Avg. bwd time: 272.2471 / Avg. batch time: 4465.4070 (ms) / GPU bubble ratio: 24.99%
[rank1]:2025-10-26 12:52:36,665 - INFO - Avg. fwd time: 164.7839 / Avg. bwd time: 316.1870 / Avg. batch time: 4947.1918 (ms) / GPU bubble ratio: 22.22%
[rank0]:2025-10-26 12:52:36,896 - INFO - Avg. fwd time: 146.8894 / Avg. bwd time: 280.9553 / Avg. batch time: 5376.2161 (ms) / GPU bubble ratio: 36.34%
[rank1]:2025-10-26 12:54:10,521 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6745e-01
[rank0]:2025-10-26 12:54:10,525 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.9175e-01
[rank3]:2025-10-26 12:54:10,525 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.1421e-01
[rank2]:2025-10-26 12:54:10,517 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.7836e-01
[rank3]:2025-10-26 12:56:01,868 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.4663e-01
[rank2]:2025-10-26 12:56:01,863 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1265e-01
[rank1]:2025-10-26 12:56:01,866 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0417e-01
[rank0]:2025-10-26 12:56:01,870 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6608e-01
[rank0]:2025-10-26 12:57:40,441 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8295e-01
[rank3]:2025-10-26 12:57:40,441 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2680e-01
[rank2]:2025-10-26 12:57:40,434 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.1760e-01
[rank1]:2025-10-26 12:57:40,437 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9691e-01
[rank1]:2025-10-26 12:59:31,765 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.3357e-01
[rank1]:2025-10-26 12:59:31,765 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4881  memory: 48.97GiB(35.03%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank0]:2025-10-26 12:59:31,769 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5528e-01
[rank0]:2025-10-26 12:59:31,769 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4881  memory: 56.85GiB(40.66%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 12:59:31,765 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.6016e-01
[rank3]:2025-10-26 12:59:31,771 - INFO -  step: 320  loss:  0.8377  grad_norm:  0.4881  memory: 52.47GiB(37.53%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank2]:2025-10-26 12:59:31,762 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0777e-01
[rank2]:2025-10-26 12:59:31,762 - INFO -  step: 320  loss: -4.0000  grad_norm:  0.4881  memory: 38.19GiB(27.32%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 12:59:35,977 - INFO - Avg. fwd time: 169.3734 / Avg. bwd time: 333.5498 / Avg. batch time: 4037.0255 (ms) / GPU bubble ratio: 0.34%
[rank2]:2025-10-26 12:59:36,206 - INFO - Avg. fwd time: 146.4305 / Avg. bwd time: 271.5283 / Avg. batch time: 4456.1984 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-10-26 12:59:36,472 - INFO - Avg. fwd time: 164.7972 / Avg. bwd time: 315.0602 / Avg. batch time: 4936.8249 (ms) / GPU bubble ratio: 22.24%
[rank0]:2025-10-26 12:59:36,702 - INFO - Avg. fwd time: 146.9090 / Avg. bwd time: 279.8140 / Avg. batch time: 5364.6929 (ms) / GPU bubble ratio: 36.37%
[rank1]:2025-10-26 13:01:10,345 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2789e+00
[rank0]:2025-10-26 13:01:10,348 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4726e+00
[rank2]:2025-10-26 13:01:10,341 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5335e+00
[rank3]:2025-10-26 13:01:10,349 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4325e+00
[rank3]:2025-10-26 13:02:42,980 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-26 13:02:44,317 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-26 13:02:44,654 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 13:02:44,950 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-26 13:03:02,268 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4313e-01
[rank1]:2025-10-26 13:03:02,264 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6230e-01
[rank2]:2025-10-26 13:03:02,261 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.7496e-02
[rank3]:2025-10-26 13:03:02,266 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.9876e-01
[rank3]:2025-10-26 13:04:40,823 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.7082e-01
[rank0]:2025-10-26 13:04:40,822 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3129e+00
[rank1]:2025-10-26 13:04:40,818 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.9649e-01
[rank2]:2025-10-26 13:04:40,815 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.9305e-01
[rank3]:2025-10-26 13:06:32,111 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.8508e-01
[rank3]:2025-10-26 13:06:32,118 - INFO -  step: 340  loss:  0.7866  grad_norm:  0.4488  memory: 52.47GiB(37.53%)  tps: 780  tflops: 36.36  mfu: 3.68%
[rank0]:2025-10-26 13:06:32,113 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4104e-01
[rank0]:2025-10-26 13:06:32,114 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4488  memory: 56.85GiB(40.66%)  tps: 780  tflops: 36.36  mfu: 3.68%
[rank1]:2025-10-26 13:06:32,109 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5259e-01
[rank1]:2025-10-26 13:06:32,110 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4488  memory: 48.97GiB(35.03%)  tps: 780  tflops: 36.36  mfu: 3.68%
[rank2]:2025-10-26 13:06:32,107 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2189e-01
[rank2]:2025-10-26 13:06:32,107 - INFO -  step: 340  loss: -4.0000  grad_norm:  0.4488  memory: 38.19GiB(27.32%)  tps: 780  tflops: 36.36  mfu: 3.68%
[rank3]:2025-10-26 13:06:36,317 - INFO - Avg. fwd time: 169.3875 / Avg. bwd time: 332.6273 / Avg. batch time: 4029.5679 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-26 13:06:36,547 - INFO - Avg. fwd time: 146.4387 / Avg. bwd time: 270.8938 / Avg. batch time: 4448.0941 (ms) / GPU bubble ratio: 24.94%
[rank1]:2025-10-26 13:06:36,812 - INFO - Avg. fwd time: 164.8093 / Avg. bwd time: 314.0652 / Avg. batch time: 4927.7012 (ms) / GPU bubble ratio: 22.26%
[rank0]:2025-10-26 13:06:37,043 - INFO - Avg. fwd time: 146.9264 / Avg. bwd time: 278.8057 / Avg. batch time: 5354.5486 (ms) / GPU bubble ratio: 36.39%
[rank2]:2025-10-26 13:08:10,668 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4364e-01
[rank1]:2025-10-26 13:08:10,671 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8832e-01
[rank3]:2025-10-26 13:08:10,675 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0381e-01
[rank0]:2025-10-26 13:08:10,675 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.5834e-01
[rank0]:2025-10-26 13:09:39,728 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-26 13:10:02,011 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.4234e-01
[rank2]:2025-10-26 13:10:02,007 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8966e-01
[rank0]:2025-10-26 13:10:02,014 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.6615e-01
[rank1]:2025-10-26 13:10:02,010 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6638e-01
[rank3]:2025-10-26 13:11:40,591 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.5914e-01
[rank2]:2025-10-26 13:11:40,584 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6515e-01
[rank0]:2025-10-26 13:11:40,590 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.0166e-01
[rank1]:2025-10-26 13:11:40,586 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6885e-01
[rank0]:2025-10-26 13:13:31,933 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9727e-01
[rank0]:2025-10-26 13:13:31,933 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4632  memory: 56.85GiB(40.66%)  tps: 781  tflops: 36.40  mfu: 3.68%
[rank2]:2025-10-26 13:13:31,926 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9621e-01
[rank2]:2025-10-26 13:13:31,927 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4632  memory: 38.19GiB(27.32%)  tps: 781  tflops: 36.40  mfu: 3.68%
[rank1]:2025-10-26 13:13:31,929 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.4370e-01
[rank1]:2025-10-26 13:13:31,929 - INFO -  step: 360  loss: -4.0000  grad_norm:  0.4632  memory: 48.97GiB(35.03%)  tps: 781  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 13:13:31,930 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.0200e-01
[rank3]:2025-10-26 13:13:31,937 - INFO -  step: 360  loss:  0.8190  grad_norm:  0.4632  memory: 52.47GiB(37.53%)  tps: 781  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 13:13:36,137 - INFO - Avg. fwd time: 169.4001 / Avg. bwd time: 331.8129 / Avg. batch time: 4022.9848 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-26 13:13:36,367 - INFO - Avg. fwd time: 146.4445 / Avg. bwd time: 270.3297 / Avg. batch time: 4440.9357 (ms) / GPU bubble ratio: 24.92%
[rank1]:2025-10-26 13:13:36,632 - INFO - Avg. fwd time: 164.8217 / Avg. bwd time: 313.1849 / Avg. batch time: 4919.6347 (ms) / GPU bubble ratio: 22.27%
[rank0]:2025-10-26 13:13:36,863 - INFO - Avg. fwd time: 146.9442 / Avg. bwd time: 277.9101 / Avg. batch time: 5345.5747 (ms) / GPU bubble ratio: 36.42%
[rank0]:2025-10-26 13:15:10,540 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.2432e-01
[rank2]:2025-10-26 13:15:10,533 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7405e-01
[rank1]:2025-10-26 13:15:10,536 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1151e-01
[rank3]:2025-10-26 13:15:10,540 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5617e-01
[rank3]:2025-10-26 13:17:01,891 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.5708e-01
[rank2]:2025-10-26 13:17:01,887 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7523e-01
[rank0]:2025-10-26 13:17:01,894 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.4011e-01
[rank1]:2025-10-26 13:17:01,890 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5635e-01
[rank3]:2025-10-26 13:18:40,475 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9200e-01
[rank1]:2025-10-26 13:18:40,472 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2744e-01
[rank2]:2025-10-26 13:18:40,468 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.3150e-01
[rank0]:2025-10-26 13:18:40,475 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3037e+00
[rank2]:2025-10-26 13:20:31,816 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5788e-01
[rank2]:2025-10-26 13:20:31,817 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4522  memory: 38.19GiB(27.32%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 13:20:31,820 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.8190e-01
[rank3]:2025-10-26 13:20:31,826 - INFO -  step: 380  loss:  0.7616  grad_norm:  0.4522  memory: 52.47GiB(37.53%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank1]:2025-10-26 13:20:31,819 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.2751e-01
[rank1]:2025-10-26 13:20:31,820 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4522  memory: 48.97GiB(35.03%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank0]:2025-10-26 13:20:31,823 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.9713e-01
[rank0]:2025-10-26 13:20:31,824 - INFO -  step: 380  loss: -4.0000  grad_norm:  0.4522  memory: 56.85GiB(40.66%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank3]:2025-10-26 13:20:36,031 - INFO - Avg. fwd time: 169.4120 / Avg. bwd time: 331.0865 / Avg. batch time: 4017.1186 (ms) / GPU bubble ratio: 0.33%
[rank2]:2025-10-26 13:20:36,260 - INFO - Avg. fwd time: 146.4504 / Avg. bwd time: 269.8247 / Avg. batch time: 4434.5543 (ms) / GPU bubble ratio: 24.90%
[rank1]:2025-10-26 13:20:36,526 - INFO - Avg. fwd time: 164.8312 / Avg. bwd time: 312.3971 / Avg. batch time: 4912.4419 (ms) / GPU bubble ratio: 22.28%
[rank0]:2025-10-26 13:20:36,757 - INFO - Avg. fwd time: 146.9583 / Avg. bwd time: 277.1090 / Avg. batch time: 5337.5703 (ms) / GPU bubble ratio: 36.44%
[rank3]:2025-10-26 13:22:10,425 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0215e-01
[rank1]:2025-10-26 13:22:10,421 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.3505e-01
[rank0]:2025-10-26 13:22:10,425 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.0998e-01
[rank2]:2025-10-26 13:22:10,418 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.6682e-01
[rank1]:2025-10-26 13:24:01,791 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0038e-01
[rank0]:2025-10-26 13:24:01,795 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5415e-01
[rank2]:2025-10-26 13:24:01,788 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5170e-02
[rank3]:2025-10-26 13:24:01,791 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.6830e-01
[rank2]:2025-10-26 13:25:40,398 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.3982e-01
[rank3]:2025-10-26 13:25:40,404 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2024e-01
[rank1]:2025-10-26 13:25:40,401 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2166e+00
[rank0]:2025-10-26 13:25:40,404 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7483e+00
[rank0]:2025-10-26 13:27:09,446 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2025-10-26 13:27:31,722 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5871e-01
[rank3]:2025-10-26 13:27:31,726 - INFO -  step: 400  loss:  0.7371  grad_norm:  0.4371  memory: 52.47GiB(37.53%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank1]:2025-10-26 13:27:31,721 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6713e-01
[rank1]:2025-10-26 13:27:31,722 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4371  memory: 48.97GiB(35.03%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank0]:2025-10-26 13:27:31,725 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6446e-01
[rank0]:2025-10-26 13:27:31,725 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4371  memory: 56.85GiB(40.66%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank0]:2025-10-26 13:27:31,799 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank0/251026_1327_stage0_step400.svg
[rank2]:2025-10-26 13:27:31,718 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9608e-02
[rank2]:2025-10-26 13:27:31,719 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.4371  memory: 38.19GiB(27.32%)  tps: 780  tflops: 36.40  mfu: 3.68%
[rank2]:2025-10-26 13:27:31,800 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank2/251026_1327_stage2_step400.svg
[rank1]:2025-10-26 13:27:31,797 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank1/251026_1327_stage1_step400.svg
[rank3]:2025-10-26 13:27:31,921 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/pipeline_schedule/251026_1327_real_step400_rank3.svg
[rank3]:> Batch Time: 5484.62 ms, GPU Bubble Ratio: 35.18%, 27.45%, 35.51%, 25.27%
[rank3]:2025-10-26 13:27:31,982 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1024_1F1B_auto_h200/freeze_ratio_history/rank3/251026_1327_stage3_step400.svg
[rank3]:2025-10-26 13:27:36,003 - INFO - Avg. fwd time: 169.4221 / Avg. bwd time: 330.4313 / Avg. batch time: 4011.8223 (ms) / GPU bubble ratio: 0.32%
[rank2]:2025-10-26 13:27:36,232 - INFO - Avg. fwd time: 146.4554 / Avg. bwd time: 269.3703 / Avg. batch time: 4428.7926 (ms) / GPU bubble ratio: 24.89%
[rank1]:2025-10-26 13:27:36,498 - INFO - Avg. fwd time: 164.8404 / Avg. bwd time: 311.6883 / Avg. batch time: 4905.9518 (ms) / GPU bubble ratio: 22.29%
[rank0]:2025-10-26 13:27:36,729 - INFO - Avg. fwd time: 146.9705 / Avg. bwd time: 276.3874 / Avg. batch time: 5330.3508 (ms) / GPU bubble ratio: 36.46%
[rank3]:2025-10-26 13:29:10,322 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.7575e+00
[rank1]:2025-10-26 13:29:10,318 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.7782e+00
[rank2]:2025-10-26 13:29:10,315 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.8452e+00
[rank0]:2025-10-26 13:29:10,322 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 6.7459e+00
