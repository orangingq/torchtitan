
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 06:21:27 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] 
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] *****************************************
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-29 06:21:35,212 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 06:21:35,220 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 06:21:35,322 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 06:21:35,447 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 06:21:36,082 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 06:21:36,085 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 06:21:36,082 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 06:21:36,093 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 06:21:36,205 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 06:21:36,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:21:36,296 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 06:21:36,298 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:21:36,304 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 06:21:38,067 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 06:21:38,341 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 06:21:40,044 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 06:21:41,355 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 06:21:41,517 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:21:41,662 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 06:21:41,603 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 06:21:41,652 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 06:21:41,674 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 06:21:41,674 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:21:41,598 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 06:21:41,598 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:21:41,737 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 06:21:41,737 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:21:41,809 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 06:21:41,810 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 06:21:41,964 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 06:21:41,964 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 06:21:41,883 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 06:21:41,883 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run l90qbnni
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1/20251029-0621/wandb/run-20251029_062142-l90qbnni
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/l90qbnni
[rank3]:2025-10-29 06:21:43,235 - INFO - WandB logging enabled
[rank3]:2025-10-29 06:21:43,237 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 06:21:43,310 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 06:21:43,311 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 06:21:43,549 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 06:21:43,549 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:43,577 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-29 06:21:43,577 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:43,578 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:47,302 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 06:21:47,302 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 06:21:55,669 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 06:21:55,669 - INFO - Finished loading the checkpoint in 8.37 seconds.
[rank0]:2025-10-29 06:21:55,669 - INFO - Training starts at step 1
[rank1]:2025-10-29 06:22:00,224 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 49.69GiB(35.54%)  tps: 885  tflops: 41.28  mfu: 4.17%
[rank1]:2025-10-29 06:22:00,224 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:22:00,226 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.2461  memory: 58.03GiB(41.50%)  tps: 967  tflops: 45.11  mfu: 4.56%
[rank3]:2025-10-29 06:22:00,227 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 06:22:00,242 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 49.75GiB(35.58%)  tps: 881  tflops: 41.10  mfu: 4.16%
[rank0]:2025-10-29 06:22:00,243 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 06:22:00,222 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 44.28GiB(31.67%)  tps: 878  tflops: 40.96  mfu: 4.14%
[rank2]:2025-10-29 06:22:00,222 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:22:18,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,621 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,621 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:24:09,938 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:24:12,666 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 66.72GiB(47.72%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank3]:2025-10-29 06:24:12,664 - INFO -  step: 50  loss:  3.2102  grad_norm: 16.3765  memory: 73.38GiB(52.48%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank1]:2025-10-29 06:24:12,662 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank2]:2025-10-29 06:24:12,660 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 57.29GiB(40.97%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank3]:2025-10-29 06:24:13,130 - INFO - Avg. fwd time: 14.8205 / Avg. bwd time: 43.0823 / Avg. batch time: 483.0107 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-29 06:24:13,180 - INFO - Avg. fwd time: 13.3687 / Avg. bwd time: 36.3470 / Avg. batch time: 535.8820 (ms) / GPU bubble ratio: 25.78%
[rank0]:2025-10-29 06:24:13,260 - INFO - Avg. fwd time: 13.9947 / Avg. bwd time: 38.1530 / Avg. batch time: 650.9255 (ms) / GPU bubble ratio: 35.91%
[rank1]:2025-10-29 06:24:13,227 - INFO - Avg. fwd time: 15.2075 / Avg. bwd time: 41.0101 / Avg. batch time: 595.6529 (ms) / GPU bubble ratio: 24.50%
[rank3]:2025-10-29 06:24:39,463 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 06:25:06,550 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 06:25:06,765 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 06:25:06,869 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:06,885 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:06,900 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:06,885 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:06,905 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,895 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,929 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,878 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,911 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,944 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,963 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,006 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,046 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,113 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,054 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,092 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,131 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,043 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,081 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,121 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,083 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,121 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,161 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,151 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,191 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,171 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,209 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,159 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,199 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,268 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,246 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:40,137 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 06:25:40,441 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_max_batch_time.svg
[rank3]:> Batch Time: 633.92 ms, GPU Bubble Ratio: 33.81%, 28.09%, 36.76%, 26.21%
[rank3]:2025-10-29 06:25:40,627 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_min_batch_time.svg
[rank3]:> Batch Time: 358.61 ms, GPU Bubble Ratio: 69.05%, 24.37%, 33.78%, 23.42%
[rank3]:2025-10-29 06:25:40,843 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.61 ms, GPU Bubble Ratio: 32.20%, 23.40%, 29.14%, 23.42%
[rank3]:2025-10-29 06:25:40,843 - INFO - 	> Batch Time: 358.61 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 06:25:55,738 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:25:57,357 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:25:57,371 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.27/0.80, [MB3] 0.30/0.90, [MB4] 0.30/0.90, [MB5] 0.31/0.94, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:25:57,388 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,822  tflops: 364.83  mfu: 36.89%
[rank1]:2025-10-29 06:25:57,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.91, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 06:25:57,391 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,822  tflops: 364.83  mfu: 36.89%
[rank1]:2025-10-29 06:25:57,467 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0625_stage1_step100.svg
[rank3]:2025-10-29 06:25:57,389 - INFO -  step: 100  loss:  2.4224  grad_norm:  0.0000  memory: 86.23GiB(61.67%)  tps: 7,823  tflops: 364.84  mfu: 36.89%
[rank0]:2025-10-29 06:25:57,390 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.19/0.56, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 06:25:57,391 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,822  tflops: 364.84  mfu: 36.89%
[rank0]:2025-10-29 06:25:57,466 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0625_stage0_step100.svg
[rank2]:2025-10-29 06:25:57,468 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0625_stage2_step100.svg
[rank0]:2025-10-29 06:25:57,562 - INFO - Avg. fwd time: 14.4843 / Avg. bwd time: 27.4627 / Avg. batch time: 580.2664 (ms) / GPU bubble ratio: 42.17%
[rank3]:2025-10-29 06:25:57,576 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_real_step100_rank3.svg
[rank3]:> Batch Time: 631.54 ms, GPU Bubble Ratio: 33.67%, 28.13%, 36.59%, 26.22%
[rank3]:2025-10-29 06:25:57,637 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0625_stage3_step100.svg
[rank1]:2025-10-29 06:25:57,948 - INFO - Avg. fwd time: 16.0657 / Avg. bwd time: 34.7691 / Avg. batch time: 536.0298 (ms) / GPU bubble ratio: 24.13%
[rank3]:2025-10-29 06:25:57,900 - INFO - Avg. fwd time: 15.5750 / Avg. bwd time: 36.4882 / Avg. batch time: 434.2398 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-29 06:25:57,922 - INFO - Avg. fwd time: 13.9970 / Avg. bwd time: 30.7438 / Avg. batch time: 482.6923 (ms) / GPU bubble ratio: 25.85%
[rank0]:2025-10-29 06:27:45,532 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:27:47,524 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 06:27:47,527 - INFO -  step: 150  loss:  0.9625  grad_norm:  0.1740  memory: 86.40GiB(61.80%)  tps: 7,438  tflops: 346.91  mfu: 35.08%
[rank1]:2025-10-29 06:27:47,528 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.60/0.91, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 06:27:47,529 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 72.68GiB(51.98%)  tps: 7,438  tflops: 346.91  mfu: 35.08%
[rank0]:2025-10-29 06:27:47,529 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.37/0.56, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 06:27:47,530 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 73.11GiB(52.29%)  tps: 7,438  tflops: 346.90  mfu: 35.08%
[rank2]:2025-10-29 06:27:47,530 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.53/0.80, [MB3] 0.60/0.90, [MB4] 0.60/0.90, [MB5] 0.63/0.94, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank2]:2025-10-29 06:27:47,531 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 64.67GiB(46.25%)  tps: 7,438  tflops: 346.89  mfu: 35.08%
[rank3]:2025-10-29 06:27:47,935 - INFO - Avg. fwd time: 15.7845 / Avg. bwd time: 34.1165 / Avg. batch time: 416.1264 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-10-29 06:27:47,972 - INFO - Avg. fwd time: 14.1680 / Avg. bwd time: 28.9046 / Avg. batch time: 463.5968 (ms) / GPU bubble ratio: 25.67%
[rank1]:2025-10-29 06:27:48,002 - INFO - Avg. fwd time: 16.2536 / Avg. bwd time: 32.7068 / Avg. batch time: 516.1791 (ms) / GPU bubble ratio: 24.12%
[rank0]:2025-10-29 06:27:48,028 - INFO - Avg. fwd time: 14.6257 / Avg. bwd time: 26.9409 / Avg. batch time: 560.0947 (ms) / GPU bubble ratio: 40.63%
[rank0]:2025-10-29 06:29:19,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:29:21,524 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:29:21,524 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 73.75GiB(52.75%)  tps: 8,715  tflops: 406.49  mfu: 41.10%
[rank1]:2025-10-29 06:29:21,524 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 06:29:21,522 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:29:21,525 - INFO -  step: 200  loss:  0.9618  grad_norm:  0.0614  memory: 86.40GiB(61.80%)  tps: 8,715  tflops: 406.48  mfu: 41.10%
[rank3]:2025-10-29 06:29:21,525 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 06:29:21,523 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.56/0.56, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:29:21,523 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 75.31GiB(53.87%)  tps: 8,715  tflops: 406.49  mfu: 41.10%
[rank0]:2025-10-29 06:29:21,523 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:29:21,523 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.80/0.80, [MB3] 0.90/0.90, [MB4] 0.90/0.90, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:29:21,523 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 65.98GiB(47.19%)  tps: 8,716  tflops: 406.50  mfu: 41.10%
[rank2]:2025-10-29 06:29:21,523 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 06:29:40,753 - INFO - validate step: 200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 21,301
[rank0]:2025-10-29 06:29:40,717 - INFO - validate step: 200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 21,341
[rank2]:2025-10-29 06:29:40,784 - INFO - validate step: 200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 21,266
[rank3]:2025-10-29 06:29:40,808 - INFO - validate step: 200  loss:  0.2552  memory: 86.40GiB(61.80%)  tps: 21,243
[rank2]:2025-10-29 06:29:40,881 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0629_stage2_step200.svg
[rank1]:2025-10-29 06:29:40,881 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0629_stage1_step200.svg
[rank0]:2025-10-29 06:29:40,880 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0629_stage0_step200.svg
[rank3]:2025-10-29 06:29:40,987 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0629_real_step200_rank3.svg
[rank3]:> Batch Time: 502.60 ms, GPU Bubble Ratio: 32.14%, 26.99%, 37.05%, 26.93%
[rank3]:2025-10-29 06:29:41,052 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0629_stage3_step200.svg
[rank3]:2025-10-29 06:29:41,323 - INFO - Avg. fwd time: 16.0497 / Avg. bwd time: 31.5070 / Avg. batch time: 396.9837 (ms) / GPU bubble ratio: 4.16%
[rank0]:2025-10-29 06:29:41,330 - INFO - Avg. fwd time: 14.8247 / Avg. bwd time: 24.8421 / Avg. batch time: 535.4069 (ms) / GPU bubble ratio: 40.73%
[rank2]:2025-10-29 06:29:41,346 - INFO - Avg. fwd time: 14.3800 / Avg. bwd time: 26.8829 / Avg. batch time: 441.9945 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-10-29 06:29:41,374 - INFO - Avg. fwd time: 16.5013 / Avg. bwd time: 30.4699 / Avg. batch time: 493.6064 (ms) / GPU bubble ratio: 23.87%
[rank0]:2025-10-29 06:31:02,130 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:31:03,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.80/0.80, [MB3] 0.90/0.90, [MB4] 0.90/0.90, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:31:03,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,870  tflops: 460.36  mfu: 46.55%
[rank3]:2025-10-29 06:31:03,748 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:31:03,781 - INFO -  step: 250  loss:  0.9555  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,873  tflops: 460.49  mfu: 46.56%
[rank1]:2025-10-29 06:31:03,782 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:31:03,783 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank0]:2025-10-29 06:31:03,782 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.56/0.56, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:31:03,783 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,862  tflops: 459.97  mfu: 46.51%
[rank0]:2025-10-29 06:31:03,877 - INFO - Avg. fwd time: 15.0394 / Avg. bwd time: 19.7803 / Avg. batch time: 506.3545 (ms) / GPU bubble ratio: 44.99%
[rank3]:2025-10-29 06:31:04,095 - INFO - Avg. fwd time: 16.3369 / Avg. bwd time: 28.9682 / Avg. batch time: 378.7055 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-10-29 06:31:04,117 - INFO - Avg. fwd time: 14.6224 / Avg. bwd time: 24.6746 / Avg. batch time: 421.1978 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-10-29 06:31:04,143 - INFO - Avg. fwd time: 16.8020 / Avg. bwd time: 27.9797 / Avg. batch time: 469.7729 (ms) / GPU bubble ratio: 23.74%
[rank0]:2025-10-29 06:32:24,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:32:26,679 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank3_trend_line.svg
[rank2]:2025-10-29 06:32:26,693 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank2_trend_line.svg
[rank2]:2025-10-29 06:32:26,716 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:32:26,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,877  tflops: 460.67  mfu: 46.58%
[rank1]:2025-10-29 06:32:26,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank1_trend_line.svg
[rank1]:2025-10-29 06:32:26,716 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:32:26,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,877  tflops: 460.69  mfu: 46.58%
[rank0]:2025-10-29 06:32:26,709 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank0_trend_line.svg
[rank0]:2025-10-29 06:32:26,717 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:32:26,718 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,878  tflops: 460.69  mfu: 46.58%
[rank3]:2025-10-29 06:32:26,911 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0632_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 359.77 ms, GPU Bubble Ratio: 38.09%, 24.83%, 31.12%, 24.41%
[rank3]:2025-10-29 06:32:26,912 - INFO - 	> Batch Time: 359.77 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 06:32:26,912 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:32:26,915 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:32:26,918 - INFO -  step: 300  loss:  0.8838  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,854  tflops: 459.58  mfu: 46.47%
[rank1]:2025-10-29 06:32:26,984 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0632_stage1_step300.svg
[rank0]:2025-10-29 06:32:26,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0632_stage0_step300.svg
[rank2]:2025-10-29 06:32:26,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0632_stage2_step300.svg
[rank3]:2025-10-29 06:32:27,094 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0632_real_step300_rank3.svg
[rank3]:> Batch Time: 429.54 ms, GPU Bubble Ratio: 41.54%, 25.21%, 34.90%, 26.25%
[rank3]:2025-10-29 06:32:27,157 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0632_stage3_step300.svg
[rank2]:2025-10-29 06:32:27,512 - INFO - Avg. fwd time: 14.7809 / Avg. bwd time: 23.2167 / Avg. batch time: 407.5339 (ms) / GPU bubble ratio: 25.41%
[rank3]:2025-10-29 06:32:27,490 - INFO - Avg. fwd time: 16.5222 / Avg. bwd time: 27.3029 / Avg. batch time: 366.6969 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 06:32:27,535 - INFO - Avg. fwd time: 16.9905 / Avg. bwd time: 26.3234 / Avg. batch time: 454.0536 (ms) / GPU bubble ratio: 23.68%
[rank0]:2025-10-29 06:32:27,540 - INFO - Avg. fwd time: 15.1757 / Avg. bwd time: 16.3222 / Avg. batch time: 487.0697 (ms) / GPU bubble ratio: 48.27%
[rank0]:2025-10-29 06:33:48,144 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:33:49,799 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,860  tflops: 459.89  mfu: 46.50%
[rank3]:2025-10-29 06:33:49,799 - INFO -  step: 350  loss:  0.9138  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,884  tflops: 461.00  mfu: 46.61%
[rank1]:2025-10-29 06:33:49,801 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,860  tflops: 459.88  mfu: 46.50%
[rank0]:2025-10-29 06:33:49,800 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,860  tflops: 459.88  mfu: 46.50%
[rank0]:2025-10-29 06:33:49,899 - INFO - Avg. fwd time: 15.2588 / Avg. bwd time: 14.1952 / Avg. batch time: 475.1393 (ms) / GPU bubble ratio: 50.41%
[rank3]:2025-10-29 06:33:50,119 - INFO - Avg. fwd time: 16.6375 / Avg. bwd time: 26.2793 / Avg. batch time: 359.3289 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-29 06:33:50,141 - INFO - Avg. fwd time: 14.8789 / Avg. bwd time: 22.3197 / Avg. batch time: 399.0651 (ms) / GPU bubble ratio: 25.43%
[rank1]:2025-10-29 06:33:50,167 - INFO - Avg. fwd time: 17.1088 / Avg. bwd time: 25.3039 / Avg. batch time: 444.3172 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-29 06:35:09,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:35:11,577 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank2_trend_line.svg
[rank1]:2025-10-29 06:35:11,601 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank1_trend_line.svg
[rank1]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.97/0.97, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:35:11,609 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,014  tflops: 467.05  mfu: 47.22%
[rank1]:2025-10-29 06:35:11,609 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 06:35:11,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank0_trend_line.svg
[rank0]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:35:11,608 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,014  tflops: 467.04  mfu: 47.22%
[rank0]:2025-10-29 06:35:11,608 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:35:11,567 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank3_trend_line.svg
[rank2]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.73/0.73, [MB2] 0.73/0.73, [MB3] 0.76/0.76, [MB4] 0.82/0.82, [MB5] 0.88/0.88, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:35:11,608 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,014  tflops: 467.03  mfu: 47.22%
[rank2]:2025-10-29 06:35:11,608 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:35:11,800 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0635_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 360.72 ms, GPU Bubble Ratio: 52.56%, 24.88%, 31.27%, 24.32%
[rank3]:2025-10-29 06:35:11,800 - INFO - 	> Batch Time: 360.72 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 06:35:11,800 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:35:11,807 - INFO -  step: 400  loss:  0.3258  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,990  tflops: 465.92  mfu: 47.11%
[rank3]:2025-10-29 06:35:11,807 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 06:35:28,301 - INFO - validate step: 400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,539
[rank0]:2025-10-29 06:35:28,264 - INFO - validate step: 400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,593
[rank2]:2025-10-29 06:35:28,332 - INFO - validate step: 400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,492
[rank0]:2025-10-29 06:35:28,433 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0635_stage0_step400.svg
[rank3]:2025-10-29 06:35:28,356 - INFO - validate step: 400  loss:  0.2526  memory: 86.40GiB(61.80%)  tps: 24,751
[rank2]:2025-10-29 06:35:28,436 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0635_stage2_step400.svg
[rank1]:2025-10-29 06:35:28,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0635_stage1_step400.svg
[rank0]:2025-10-29 06:35:28,517 - INFO - Avg. fwd time: 15.3154 / Avg. bwd time: 12.3220 / Avg. batch time: 464.2769 (ms) / GPU bubble ratio: 52.38%
[rank3]:2025-10-29 06:35:28,533 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0635_real_step400_rank3.svg
[rank3]:> Batch Time: 382.70 ms, GPU Bubble Ratio: 67.23%, 24.02%, 33.35%, 23.09%
[rank3]:2025-10-29 06:35:28,601 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0635_stage3_step400.svg
[rank2]:2025-10-29 06:35:28,869 - INFO - Avg. fwd time: 14.9517 / Avg. bwd time: 21.5254 / Avg. batch time: 391.2739 (ms) / GPU bubble ratio: 25.42%
[rank1]:2025-10-29 06:35:28,894 - INFO - Avg. fwd time: 17.1914 / Avg. bwd time: 24.3966 / Avg. batch time: 435.3980 (ms) / GPU bubble ratio: 23.59%
[rank3]:2025-10-29 06:35:28,847 - INFO - Avg. fwd time: 16.7172 / Avg. bwd time: 25.3603 / Avg. batch time: 352.5218 (ms) / GPU bubble ratio: 4.51%
[rank0]:2025-10-29 06:36:44,683 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:36:46,231 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank1]:2025-10-29 06:36:46,233 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,512  tflops: 490.27  mfu: 49.57%
[rank0]:2025-10-29 06:36:46,233 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,507  tflops: 490.04  mfu: 49.55%
[rank3]:2025-10-29 06:36:46,232 - INFO -  step: 450  loss:  0.3390  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,520  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:36:46,588 - INFO - Avg. fwd time: 16.7017 / Avg. bwd time: 24.5996 / Avg. batch time: 346.2260 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 06:36:46,610 - INFO - Avg. fwd time: 14.9526 / Avg. bwd time: 20.8909 / Avg. batch time: 384.2178 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 06:36:46,633 - INFO - Avg. fwd time: 17.1916 / Avg. bwd time: 23.6805 / Avg. batch time: 427.4556 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-10-29 06:36:46,639 - INFO - Avg. fwd time: 15.3015 / Avg. bwd time: 10.8857 / Avg. batch time: 454.8064 (ms) / GPU bubble ratio: 53.94%
[rank0]:2025-10-29 06:38:02,379 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:38:03,916 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank1]:2025-10-29 06:38:03,919 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank0]:2025-10-29 06:38:03,918 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank3]:2025-10-29 06:38:03,917 - INFO -  step: 500  loss:  0.3436  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,545  tflops: 491.84  mfu: 49.73%
[rank2]:2025-10-29 06:38:03,990 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0638_stage2_step500.svg
[rank1]:2025-10-29 06:38:03,988 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0638_stage1_step500.svg
[rank0]:2025-10-29 06:38:03,988 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0638_stage0_step500.svg
[rank0]:2025-10-29 06:38:04,073 - INFO - Avg. fwd time: 15.2894 / Avg. bwd time: 9.8969 / Avg. batch time: 448.2070 (ms) / GPU bubble ratio: 55.05%
[rank3]:2025-10-29 06:38:04,098 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0638_real_step500_rank3.svg
[rank3]:> Batch Time: 379.64 ms, GPU Bubble Ratio: 67.31%, 23.99%, 33.42%, 23.14%
[rank3]:2025-10-29 06:38:04,162 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0638_stage3_step500.svg
[rank2]:2025-10-29 06:38:04,425 - INFO - Avg. fwd time: 14.9520 / Avg. bwd time: 20.4537 / Avg. batch time: 379.2954 (ms) / GPU bubble ratio: 25.32%
[rank3]:2025-10-29 06:38:04,404 - INFO - Avg. fwd time: 16.6901 / Avg. bwd time: 24.0756 / Avg. batch time: 341.8821 (ms) / GPU bubble ratio: 4.61%
[rank1]:2025-10-29 06:38:04,451 - INFO - Avg. fwd time: 17.1902 / Avg. bwd time: 23.1853 / Avg. batch time: 421.9118 (ms) / GPU bubble ratio: 23.44%
[rank0]:2025-10-29 06:39:20,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:39:21,758 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank1]:2025-10-29 06:39:21,760 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 06:39:21,760 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank3]:2025-10-29 06:39:21,759 - INFO -  step: 550  loss:  0.3601  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,524  tflops: 490.85  mfu: 49.63%
[rank0]:2025-10-29 06:39:21,845 - INFO - Avg. fwd time: 15.2784 / Avg. bwd time: 8.9486 / Avg. batch time: 441.9459 (ms) / GPU bubble ratio: 56.14%
[rank2]:2025-10-29 06:39:22,070 - INFO - Avg. fwd time: 14.9520 / Avg. bwd time: 20.0350 / Avg. batch time: 374.6335 (ms) / GPU bubble ratio: 25.29%
[rank1]:2025-10-29 06:39:22,095 - INFO - Avg. fwd time: 17.1874 / Avg. bwd time: 22.7126 / Avg. batch time: 416.6619 (ms) / GPU bubble ratio: 23.39%
[rank3]:2025-10-29 06:39:22,049 - INFO - Avg. fwd time: 16.6788 / Avg. bwd time: 23.5731 / Avg. batch time: 337.7154 (ms) / GPU bubble ratio: 4.65%
[rank0]:2025-10-29 06:40:37,787 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:40:39,620 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank2_trend_line.svg
[rank2]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.70/0.70, [MB2] 0.70/0.70, [MB3] 0.75/0.75, [MB4] 0.81/0.81, [MB5] 0.88/0.88, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:40:39,649 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,517  tflops: 490.53  mfu: 49.60%
[rank2]:2025-10-29 06:40:39,649 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 06:40:39,640 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank1_trend_line.svg
[rank1]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.99/0.99, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:40:39,649 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,518  tflops: 490.55  mfu: 49.60%
[rank1]:2025-10-29 06:40:39,649 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 06:40:39,637 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank0_trend_line.svg
[rank0]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 06:40:39,648 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,518  tflops: 490.55  mfu: 49.60%
[rank0]:2025-10-29 06:40:39,648 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 06:40:39,607 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank3_trend_line.svg
[rank3]:2025-10-29 06:40:39,837 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0640_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.65 ms, GPU Bubble Ratio: 59.93%, 24.40%, 31.13%, 23.86%
[rank3]:2025-10-29 06:40:39,837 - INFO - 	> Batch Time: 356.65 ms (Average Freeze Ratio: 0.70)
[rank3]:2025-10-29 06:40:39,838 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:40:39,844 - INFO -  step: 600  loss:  0.3232  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,491  tflops: 489.32  mfu: 49.48%
[rank3]:2025-10-29 06:40:39,844 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 06:40:56,269 - INFO - validate step: 600  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,645
[rank0]:2025-10-29 06:40:56,197 - INFO - validate step: 600  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,751
[rank1]:2025-10-29 06:40:56,234 - INFO - validate step: 600  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,696
[rank3]:2025-10-29 06:40:56,291 - INFO - validate step: 600  loss:  0.2542  memory: 86.40GiB(61.80%)  tps: 24,905
[rank2]:2025-10-29 06:40:56,366 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0640_stage2_step600.svg
[rank0]:2025-10-29 06:40:56,362 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0640_stage0_step600.svg
[rank1]:2025-10-29 06:40:56,364 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0640_stage1_step600.svg
[rank3]:2025-10-29 06:40:56,469 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0640_real_step600_rank3.svg
[rank3]:> Batch Time: 377.35 ms, GPU Bubble Ratio: 67.37%, 23.94%, 33.36%, 23.15%
[rank3]:2025-10-29 06:40:56,533 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0640_stage3_step600.svg
[rank2]:2025-10-29 06:40:56,866 - INFO - Avg. fwd time: 14.9514 / Avg. bwd time: 19.6891 / Avg. batch time: 370.7399 (ms) / GPU bubble ratio: 25.25%
[rank3]:2025-10-29 06:40:56,843 - INFO - Avg. fwd time: 16.6667 / Avg. bwd time: 23.1555 / Avg. batch time: 334.2323 (ms) / GPU bubble ratio: 4.68%
[rank0]:2025-10-29 06:40:56,897 - INFO - Avg. fwd time: 15.2680 / Avg. bwd time: 8.1662 / Avg. batch time: 436.7299 (ms) / GPU bubble ratio: 57.07%
[rank1]:2025-10-29 06:40:56,890 - INFO - Avg. fwd time: 17.1836 / Avg. bwd time: 22.3193 / Avg. batch time: 412.2796 (ms) / GPU bubble ratio: 23.35%
[rank0]:2025-10-29 06:42:48,811 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:42:51,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,134  tflops: 332.74  mfu: 33.64%
[rank1]:2025-10-29 06:42:51,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,132  tflops: 332.64  mfu: 33.63%
[rank0]:2025-10-29 06:42:51,130 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1068  memory: 75.31GiB(53.87%)  tps: 7,128  tflops: 332.43  mfu: 33.61%
[rank3]:2025-10-29 06:42:51,097 - INFO -  step: 650  loss:  0.2001  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,136  tflops: 332.81  mfu: 33.65%
[rank2]:2025-10-29 06:42:51,441 - INFO - Avg. fwd time: 14.9513 / Avg. bwd time: 19.4341 / Avg. batch time: 368.9703 (ms) / GPU bubble ratio: 25.45%
[rank3]:2025-10-29 06:42:51,420 - INFO - Avg. fwd time: 16.6540 / Avg. bwd time: 22.8444 / Avg. batch time: 331.6059 (ms) / GPU bubble ratio: 4.71%
[rank1]:2025-10-29 06:42:51,500 - INFO - Avg. fwd time: 17.1713 / Avg. bwd time: 22.0156 / Avg. batch time: 414.3573 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-10-29 06:42:51,621 - INFO - Avg. fwd time: 15.1572 / Avg. bwd time: 10.2788 / Avg. batch time: 445.1221 (ms) / GPU bubble ratio: 54.28%
[rank0]:2025-10-29 06:44:43,648 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:44:45,950 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 06:44:45,949 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank3]:2025-10-29 06:44:45,951 - INFO -  step: 700  loss:  0.2141  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 06:44:46,058 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0644_stage1_step700.svg
[rank0]:2025-10-29 06:44:45,983 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0904  memory: 75.31GiB(53.87%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank0]:2025-10-29 06:44:46,061 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0644_stage0_step700.svg
[rank2]:2025-10-29 06:44:46,060 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0644_stage2_step700.svg
[rank3]:2025-10-29 06:44:46,162 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0644_real_step700_rank3.svg
[rank3]:> Batch Time: 375.38 ms, GPU Bubble Ratio: 67.44%, 23.91%, 33.25%, 23.19%
[rank3]:2025-10-29 06:44:46,228 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0644_stage3_step700.svg
[rank3]:2025-10-29 06:44:46,473 - INFO - Avg. fwd time: 16.6373 / Avg. bwd time: 22.5296 / Avg. batch time: 328.9172 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 06:44:46,494 - INFO - Avg. fwd time: 14.9493 / Avg. bwd time: 19.1817 / Avg. batch time: 367.1727 (ms) / GPU bubble ratio: 25.63%
[rank1]:2025-10-29 06:44:46,552 - INFO - Avg. fwd time: 17.1566 / Avg. bwd time: 21.7136 / Avg. batch time: 416.4250 (ms) / GPU bubble ratio: 25.33%
[rank0]:2025-10-29 06:44:46,671 - INFO - Avg. fwd time: 15.0443 / Avg. bwd time: 12.4020 / Avg. batch time: 453.5324 (ms) / GPU bubble ratio: 51.59%
[rank0]:2025-10-29 06:46:38,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:46:40,971 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank0]:2025-10-29 06:46:41,004 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1127  memory: 75.31GiB(53.87%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank1]:2025-10-29 06:46:40,971 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank3]:2025-10-29 06:46:40,972 - INFO -  step: 750  loss:  0.2455  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank3]:2025-10-29 06:46:41,363 - INFO - Avg. fwd time: 16.6226 / Avg. bwd time: 22.2578 / Avg. batch time: 326.5929 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 06:46:41,392 - INFO - Avg. fwd time: 14.9485 / Avg. bwd time: 18.9684 / Avg. batch time: 365.6811 (ms) / GPU bubble ratio: 25.80%
[rank1]:2025-10-29 06:46:41,471 - INFO - Avg. fwd time: 17.1450 / Avg. bwd time: 21.4557 / Avg. batch time: 418.2561 (ms) / GPU bubble ratio: 26.17%
[rank0]:2025-10-29 06:46:41,570 - INFO - Avg. fwd time: 14.9485 / Avg. bwd time: 14.2302 / Avg. batch time: 460.8250 (ms) / GPU bubble ratio: 49.35%
[rank0]:2025-10-29 06:48:33,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:48:36,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank2_trend_line.svg
[rank1]:2025-10-29 06:48:36,106 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank1_trend_line.svg
[rank3]:2025-10-29 06:48:36,094 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank3_trend_line.svg
[rank2]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.66/0.66, [MB2] 0.66/0.66, [MB3] 0.71/0.71, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:48:36,191 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,110  tflops: 331.60  mfu: 33.53%
[rank2]:2025-10-29 06:48:36,191 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:48:36,182 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank0_trend_line.svg
[rank0]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:48:36,196 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1025  memory: 75.31GiB(53.87%)  tps: 7,112  tflops: 331.69  mfu: 33.54%
[rank0]:2025-10-29 06:48:36,196 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:48:36,191 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,110  tflops: 331.60  mfu: 33.53%
[rank1]:2025-10-29 06:48:36,191 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 06:48:36,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0648_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.61 ms, GPU Bubble Ratio: 35.88%, 24.37%, 30.88%, 23.92%
[rank3]:2025-10-29 06:48:36,379 - INFO - 	> Batch Time: 355.61 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 06:48:36,379 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:48:36,387 - INFO -  step: 800  loss:  0.2264  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,098  tflops: 331.05  mfu: 33.47%
[rank3]:2025-10-29 06:48:36,387 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:48:52,863 - INFO - validate step: 800  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,576
[rank2]:2025-10-29 06:48:52,911 - INFO - validate step: 800  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,499
[rank3]:2025-10-29 06:48:52,926 - INFO - validate step: 800  loss:  0.2512  memory: 86.40GiB(61.80%)  tps: 24,767
[rank1]:2025-10-29 06:48:52,896 - INFO - validate step: 800  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,521
[rank2]:2025-10-29 06:48:53,008 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0648_stage2_step800.svg
[rank0]:2025-10-29 06:48:53,002 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0648_stage0_step800.svg
[rank1]:2025-10-29 06:48:53,005 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0648_stage1_step800.svg
[rank3]:2025-10-29 06:48:53,103 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0648_real_step800_rank3.svg
[rank3]:> Batch Time: 373.25 ms, GPU Bubble Ratio: 67.46%, 23.71%, 33.07%, 23.33%
[rank3]:2025-10-29 06:48:53,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0648_stage3_step800.svg
[rank2]:2025-10-29 06:48:53,443 - INFO - Avg. fwd time: 14.9467 / Avg. bwd time: 18.8052 / Avg. batch time: 364.4976 (ms) / GPU bubble ratio: 25.92%
[rank3]:2025-10-29 06:48:53,421 - INFO - Avg. fwd time: 16.6097 / Avg. bwd time: 22.0515 / Avg. batch time: 324.8159 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 06:48:53,501 - INFO - Avg. fwd time: 17.1356 / Avg. bwd time: 21.2624 / Avg. batch time: 419.5739 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-10-29 06:48:53,617 - INFO - Avg. fwd time: 14.8757 / Avg. bwd time: 15.6047 / Avg. batch time: 466.2541 (ms) / GPU bubble ratio: 47.70%
[rank0]:2025-10-29 06:50:09,484 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:50:11,041 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,485  tflops: 489.03  mfu: 49.45%
[rank1]:2025-10-29 06:50:11,043 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,483  tflops: 488.92  mfu: 49.44%
[rank3]:2025-10-29 06:50:11,042 - INFO -  step: 850  loss:  0.2505  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,487  tflops: 489.12  mfu: 49.46%
[rank0]:2025-10-29 06:50:11,043 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,479  tflops: 488.72  mfu: 49.42%
[rank0]:2025-10-29 06:50:11,129 - INFO - Avg. fwd time: 14.8883 / Avg. bwd time: 14.8662 / Avg. batch time: 462.1396 (ms) / GPU bubble ratio: 48.49%
[rank3]:2025-10-29 06:50:11,332 - INFO - Avg. fwd time: 16.6063 / Avg. bwd time: 21.8501 / Avg. batch time: 323.1556 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 06:50:11,352 - INFO - Avg. fwd time: 14.9467 / Avg. bwd time: 18.6372 / Avg. batch time: 362.4753 (ms) / GPU bubble ratio: 25.88%
[rank1]:2025-10-29 06:50:11,378 - INFO - Avg. fwd time: 17.1428 / Avg. bwd time: 21.0793 / Avg. batch time: 416.7871 (ms) / GPU bubble ratio: 26.63%
[rank0]:2025-10-29 06:51:27,159 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:51:28,697 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank2]:2025-10-29 06:51:28,695 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank2]:2025-10-29 06:51:28,767 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0651_stage2_step900.svg
[rank1]:2025-10-29 06:51:28,698 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank1]:2025-10-29 06:51:28,767 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0651_stage1_step900.svg
[rank3]:2025-10-29 06:51:28,696 - INFO -  step: 900  loss:  0.2393  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,550  tflops: 492.03  mfu: 49.75%
[rank0]:2025-10-29 06:51:28,768 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0651_stage0_step900.svg
[rank3]:2025-10-29 06:51:28,877 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0651_real_step900_rank3.svg
[rank3]:> Batch Time: 372.25 ms, GPU Bubble Ratio: 67.36%, 23.55%, 32.98%, 23.41%
[rank3]:2025-10-29 06:51:28,938 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0651_stage3_step900.svg
[rank2]:2025-10-29 06:51:29,270 - INFO - Avg. fwd time: 14.9468 / Avg. bwd time: 18.4888 / Avg. batch time: 360.6095 (ms) / GPU bubble ratio: 25.82%
[rank1]:2025-10-29 06:51:29,295 - INFO - Avg. fwd time: 17.1464 / Avg. bwd time: 20.9172 / Avg. batch time: 413.8986 (ms) / GPU bubble ratio: 26.43%
[rank3]:2025-10-29 06:51:29,247 - INFO - Avg. fwd time: 16.6038 / Avg. bwd time: 21.6729 / Avg. batch time: 321.6992 (ms) / GPU bubble ratio: 4.81%
[rank0]:2025-10-29 06:51:29,301 - INFO - Avg. fwd time: 14.9041 / Avg. bwd time: 13.9994 / Avg. batch time: 457.5252 (ms) / GPU bubble ratio: 49.46%
[rank0]:2025-10-29 06:52:45,008 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:52:46,549 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank3]:2025-10-29 06:52:46,548 - INFO -  step: 950  loss:  0.2626  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,523  tflops: 490.79  mfu: 49.62%
[rank0]:2025-10-29 06:52:46,548 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank2]:2025-10-29 06:52:46,547 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank0]:2025-10-29 06:52:46,635 - INFO - Avg. fwd time: 14.9164 / Avg. bwd time: 13.3331 / Avg. batch time: 453.9530 (ms) / GPU bubble ratio: 50.22%
[rank3]:2025-10-29 06:52:46,838 - INFO - Avg. fwd time: 16.6027 / Avg. bwd time: 21.5374 / Avg. batch time: 320.5916 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 06:52:46,859 - INFO - Avg. fwd time: 14.9475 / Avg. bwd time: 18.3751 / Avg. batch time: 359.1573 (ms) / GPU bubble ratio: 25.78%
[rank1]:2025-10-29 06:52:46,884 - INFO - Avg. fwd time: 17.1487 / Avg. bwd time: 20.7921 / Avg. batch time: 411.6548 (ms) / GPU bubble ratio: 26.27%
[rank0]:2025-10-29 06:54:02,596 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:54:04,143 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank0]:2025-10-29 06:54:04,143 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:54:04,141 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank2]:2025-10-29 06:54:04,141 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 06:54:04,144 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank1]:2025-10-29 06:54:04,144 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 06:54:04,142 - INFO -  step: 1000  loss:  0.2373  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,558  tflops: 492.41  mfu: 49.79%
[rank3]:2025-10-29 06:54:04,142 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 06:54:20,639 - INFO - validate step: 1000  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,832
[rank0]:2025-10-29 06:54:20,603 - INFO - validate step: 1000  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,886
[rank2]:2025-10-29 06:54:20,672 - INFO - validate step: 1000  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,779
[rank3]:2025-10-29 06:54:20,695 - INFO - validate step: 1000  loss:  0.2504  memory: 86.40GiB(61.80%)  tps: 24,747
[rank2]:2025-10-29 06:54:20,772 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0654_stage2_step1000.svg
[rank1]:2025-10-29 06:54:20,770 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0654_stage1_step1000.svg
[rank0]:2025-10-29 06:54:20,770 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0654_stage0_step1000.svg
[rank0]:2025-10-29 06:54:20,857 - INFO - Avg. fwd time: 14.9276 / Avg. bwd time: 12.6317 / Avg. batch time: 450.1565 (ms) / GPU bubble ratio: 51.02%
[rank3]:2025-10-29 06:54:20,881 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0654_real_step1000_rank3.svg
[rank3]:> Batch Time: 371.79 ms, GPU Bubble Ratio: 67.33%, 23.50%, 32.96%, 23.42%
[rank3]:2025-10-29 06:54:20,945 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0654_stage3_step1000.svg
[rank2]:2025-10-29 06:54:21,211 - INFO - Avg. fwd time: 14.9471 / Avg. bwd time: 18.2554 / Avg. batch time: 357.5938 (ms) / GPU bubble ratio: 25.72%
[rank1]:2025-10-29 06:54:21,237 - INFO - Avg. fwd time: 17.1484 / Avg. bwd time: 20.6590 / Avg. batch time: 409.2568 (ms) / GPU bubble ratio: 26.10%
[rank3]:2025-10-29 06:54:21,191 - INFO - Avg. fwd time: 16.5994 / Avg. bwd time: 21.3927 / Avg. batch time: 319.3920 (ms) / GPU bubble ratio: 4.84%
[rank0]:2025-10-29 06:55:37,075 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:55:38,632 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,508  tflops: 490.09  mfu: 49.55%
[rank1]:2025-10-29 06:55:38,635 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank3]:2025-10-29 06:55:38,633 - INFO -  step: 1050  loss:  0.2424  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,511  tflops: 490.24  mfu: 49.57%
[rank0]:2025-10-29 06:55:38,634 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,498  tflops: 489.65  mfu: 49.51%
[rank3]:2025-10-29 06:55:38,995 - INFO - Avg. fwd time: 16.5971 / Avg. bwd time: 21.2640 / Avg. batch time: 318.3317 (ms) / GPU bubble ratio: 4.85%
[rank2]:2025-10-29 06:55:39,019 - INFO - Avg. fwd time: 14.9471 / Avg. bwd time: 18.1482 / Avg. batch time: 356.2402 (ms) / GPU bubble ratio: 25.68%
[rank1]:2025-10-29 06:55:39,045 - INFO - Avg. fwd time: 17.1505 / Avg. bwd time: 20.5409 / Avg. batch time: 407.1590 (ms) / GPU bubble ratio: 25.94%
[rank0]:2025-10-29 06:55:39,053 - INFO - Avg. fwd time: 14.9393 / Avg. bwd time: 12.0005 / Avg. batch time: 446.8016 (ms) / GPU bubble ratio: 51.76%
[rank0]:2025-10-29 06:56:54,785 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:56:56,346 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank3]:2025-10-29 06:56:56,345 - INFO -  step: 1100  loss:  0.2130  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,542  tflops: 491.67  mfu: 49.71%
[rank0]:2025-10-29 06:56:56,345 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank2]:2025-10-29 06:56:56,343 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank2]:2025-10-29 06:56:56,421 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0656_stage2_step1100.svg
[rank1]:2025-10-29 06:56:56,420 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0656_stage1_step1100.svg
[rank0]:2025-10-29 06:56:56,419 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0656_stage0_step1100.svg
[rank3]:2025-10-29 06:56:56,528 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0656_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.55 ms, GPU Bubble Ratio: 67.33%, 23.48%, 32.95%, 23.43%
[rank3]:2025-10-29 06:56:56,591 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0656_stage3_step1100.svg
[rank0]:2025-10-29 06:56:56,503 - INFO - Avg. fwd time: 14.9480 / Avg. bwd time: 11.5075 / Avg. batch time: 444.1539 (ms) / GPU bubble ratio: 52.35%
[rank3]:2025-10-29 06:56:56,836 - INFO - Avg. fwd time: 16.5961 / Avg. bwd time: 21.1638 / Avg. batch time: 317.5109 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 06:56:56,856 - INFO - Avg. fwd time: 14.9475 / Avg. bwd time: 18.0641 / Avg. batch time: 355.1632 (ms) / GPU bubble ratio: 25.64%
[rank1]:2025-10-29 06:56:56,882 - INFO - Avg. fwd time: 17.1517 / Avg. bwd time: 20.4476 / Avg. batch time: 405.4940 (ms) / GPU bubble ratio: 25.82%
[rank0]:2025-10-29 06:58:12,656 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:58:14,221 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:58:14,219 - INFO -  step: 1150  loss:  0.2297  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,520  tflops: 490.64  mfu: 49.61%
[rank0]:2025-10-29 06:58:14,220 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:58:14,218 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 06:58:14,306 - INFO - Avg. fwd time: 14.9572 / Avg. bwd time: 10.9813 / Avg. batch time: 441.3514 (ms) / GPU bubble ratio: 52.98%
[rank3]:2025-10-29 06:58:14,516 - INFO - Avg. fwd time: 16.5947 / Avg. bwd time: 21.0568 / Avg. batch time: 316.6322 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 06:58:14,537 - INFO - Avg. fwd time: 14.9474 / Avg. bwd time: 17.9745 / Avg. batch time: 354.0378 (ms) / GPU bubble ratio: 25.61%
[rank1]:2025-10-29 06:58:14,562 - INFO - Avg. fwd time: 17.1521 / Avg. bwd time: 20.3477 / Avg. batch time: 403.7415 (ms) / GPU bubble ratio: 25.70%
[rank0]:2025-10-29 06:59:30,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:59:31,881 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,549  tflops: 491.98  mfu: 49.75%
[rank1]:2025-10-29 06:59:31,881 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 06:59:31,880 - INFO -  step: 1200  loss:  0.2156  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,549  tflops: 491.99  mfu: 49.75%
[rank3]:2025-10-29 06:59:31,880 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:59:31,880 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,549  tflops: 491.99  mfu: 49.75%
[rank0]:2025-10-29 06:59:31,881 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 06:59:31,879 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,549  tflops: 491.98  mfu: 49.75%
[rank2]:2025-10-29 06:59:31,879 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:59:48,413 - INFO - validate step: 1200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,777
[rank0]:2025-10-29 06:59:48,414 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:59:48,418 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 06:59:48,469 - INFO - validate step: 1200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,689
[rank2]:2025-10-29 06:59:48,470 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:59:48,450 - INFO - validate step: 1200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,722
[rank1]:2025-10-29 06:59:48,451 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:59:48,494 - INFO - validate step: 1200  loss:  0.2519  memory: 86.40GiB(61.80%)  tps: 24,655
[rank3]:2025-10-29 06:59:48,495 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:59:59,418 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.95 seconds.
[rank1]:2025-10-29 07:00:00,563 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.11 seconds.
[rank3]:2025-10-29 07:00:06,095 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.60 seconds.
[rank0]:2025-10-29 07:00:07,381 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 07:00:07,386 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.97 seconds.
[rank1]:2025-10-29 07:00:07,590 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0700_stage1_step1200.svg
[rank1]:2025-10-29 07:00:07,602 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 07:00:07,591 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0700_stage0_step1200.svg
[rank0]:2025-10-29 07:00:07,602 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 07:00:07,617 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0659_stage2_step1200.svg
[rank2]:2025-10-29 07:00:07,627 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 07:00:07,718 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0700_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.24 ms, GPU Bubble Ratio: 67.32%, 23.45%, 32.91%, 23.41%
[rank3]:2025-10-29 07:00:07,785 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0700_stage3_step1200.svg
[rank3]:2025-10-29 07:00:07,794 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 07:00:08,894 - INFO - Avg. fwd time: 14.9482 / Avg. bwd time: 17.8929 / Avg. batch time: 353.1757 (ms) / GPU bubble ratio: 25.61%
[rank1]:2025-10-29 07:00:08,923 - INFO - Avg. fwd time: 17.1538 / Avg. bwd time: 20.2567 / Avg. batch time: 402.3088 (ms) / GPU bubble ratio: 25.61%
[rank3]:2025-10-29 07:00:08,869 - INFO - Avg. fwd time: 16.5939 / Avg. bwd time: 20.9592 / Avg. batch time: 315.9938 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:00:08,933 - INFO - Avg. fwd time: 14.9672 / Avg. bwd time: 10.5011 / Avg. batch time: 438.9675 (ms) / GPU bubble ratio: 53.59%
[rank0]:2025-10-29 07:01:31,893 - INFO - [GC] Peforming periodical GC collection 2.18 seconds
[rank0]:2025-10-29 07:01:33,550 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 7,792  tflops: 363.41  mfu: 36.75%
[rank2]:2025-10-29 07:01:33,547 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,796  tflops: 363.61  mfu: 36.77%
[rank1]:2025-10-29 07:01:33,550 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,795  tflops: 363.54  mfu: 36.76%
[rank3]:2025-10-29 07:01:33,548 - INFO -  step: 1250  loss:  0.9803  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank0]:2025-10-29 07:01:33,647 - INFO - Avg. fwd time: 14.9995 / Avg. bwd time: 10.1218 / Avg. batch time: 437.3876 (ms) / GPU bubble ratio: 54.05%
[rank3]:2025-10-29 07:01:33,867 - INFO - Avg. fwd time: 16.6219 / Avg. bwd time: 20.9030 / Avg. batch time: 315.7663 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:01:33,888 - INFO - Avg. fwd time: 14.9694 / Avg. bwd time: 17.8371 / Avg. batch time: 352.7767 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:01:33,914 - INFO - Avg. fwd time: 17.1790 / Avg. bwd time: 20.1926 / Avg. batch time: 401.4627 (ms) / GPU bubble ratio: 25.53%
[rank0]:2025-10-29 07:02:54,588 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:02:56,235 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,907  tflops: 462.09  mfu: 46.72%
[rank2]:2025-10-29 07:02:56,234 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,907  tflops: 462.08  mfu: 46.72%
[rank1]:2025-10-29 07:02:56,236 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,907  tflops: 462.08  mfu: 46.72%
[rank3]:2025-10-29 07:02:56,235 - INFO -  step: 1300  loss:  0.9598  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,908  tflops: 462.09  mfu: 46.72%
[rank0]:2025-10-29 07:02:56,314 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0702_stage0_step1300.svg
[rank2]:2025-10-29 07:02:56,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0702_stage2_step1300.svg
[rank1]:2025-10-29 07:02:56,316 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0702_stage1_step1300.svg
[rank0]:2025-10-29 07:02:56,412 - INFO - Avg. fwd time: 15.0325 / Avg. bwd time: 9.7124 / Avg. batch time: 435.6877 (ms) / GPU bubble ratio: 54.56%
[rank3]:2025-10-29 07:02:56,422 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0702_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.13 ms, GPU Bubble Ratio: 67.29%, 23.50%, 32.98%, 23.42%
[rank3]:2025-10-29 07:02:56,488 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0702_stage3_step1300.svg
[rank3]:2025-10-29 07:02:56,759 - INFO - Avg. fwd time: 16.6525 / Avg. bwd time: 20.8436 / Avg. batch time: 315.5275 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:02:56,780 - INFO - Avg. fwd time: 14.9925 / Avg. bwd time: 17.7773 / Avg. batch time: 352.3536 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:02:56,806 - INFO - Avg. fwd time: 17.2086 / Avg. bwd time: 20.1249 / Avg. batch time: 400.5606 (ms) / GPU bubble ratio: 25.44%
[rank0]:2025-10-29 07:04:17,426 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:04:19,082 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank0]:2025-10-29 07:04:19,084 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank1]:2025-10-29 07:04:19,085 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank3]:2025-10-29 07:04:19,083 - INFO -  step: 1350  loss:  0.9639  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank2]:2025-10-29 07:04:19,493 - INFO - Avg. fwd time: 15.0137 / Avg. bwd time: 17.7223 / Avg. batch time: 351.9984 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:04:19,521 - INFO - Avg. fwd time: 17.2358 / Avg. bwd time: 20.0625 / Avg. batch time: 399.7654 (ms) / GPU bubble ratio: 25.36%
[rank3]:2025-10-29 07:04:19,468 - INFO - Avg. fwd time: 16.6811 / Avg. bwd time: 20.7898 / Avg. batch time: 315.3176 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:04:19,530 - INFO - Avg. fwd time: 15.0633 / Avg. bwd time: 9.3349 / Avg. batch time: 434.1572 (ms) / GPU bubble ratio: 55.04%
[rank0]:2025-10-29 07:05:40,210 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:05:41,864 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank2]:2025-10-29 07:05:41,864 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:05:41,866 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank0]:2025-10-29 07:05:41,866 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 07:05:41,866 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank1]:2025-10-29 07:05:41,866 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 07:05:41,865 - INFO -  step: 1400  loss:  0.9899  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,896  tflops: 461.56  mfu: 46.67%
[rank3]:2025-10-29 07:05:41,865 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 07:05:58,480 - INFO - validate step: 1400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,651
[rank0]:2025-10-29 07:05:58,413 - INFO - validate step: 1400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,754
[rank1]:2025-10-29 07:05:58,451 - INFO - validate step: 1400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,698
[rank3]:2025-10-29 07:05:58,504 - INFO - validate step: 1400  loss:  0.2497  memory: 86.40GiB(61.80%)  tps: 24,618
[rank0]:2025-10-29 07:05:58,586 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0705_stage0_step1400.svg
[rank1]:2025-10-29 07:05:58,589 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0705_stage1_step1400.svg
[rank2]:2025-10-29 07:05:58,591 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0705_stage2_step1400.svg
[rank0]:2025-10-29 07:05:58,686 - INFO - Avg. fwd time: 15.0873 / Avg. bwd time: 9.0340 / Avg. batch time: 432.9163 (ms) / GPU bubble ratio: 55.43%
[rank3]:2025-10-29 07:05:58,691 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0705_real_step1400_rank3.svg
[rank3]:> Batch Time: 373.02 ms, GPU Bubble Ratio: 67.27%, 23.55%, 33.03%, 23.40%
[rank3]:2025-10-29 07:05:58,759 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0705_stage3_step1400.svg
[rank2]:2025-10-29 07:05:59,054 - INFO - Avg. fwd time: 15.0308 / Avg. bwd time: 17.6788 / Avg. batch time: 351.6969 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:05:59,080 - INFO - Avg. fwd time: 17.2569 / Avg. bwd time: 20.0126 / Avg. batch time: 399.1117 (ms) / GPU bubble ratio: 25.29%
[rank3]:2025-10-29 07:05:59,033 - INFO - Avg. fwd time: 16.7041 / Avg. bwd time: 20.7469 / Avg. batch time: 315.1520 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:07:19,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:07:21,480 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank3]:2025-10-29 07:07:21,478 - INFO -  step: 1450  loss:  1.0070  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,873  tflops: 460.49  mfu: 46.56%
[rank0]:2025-10-29 07:07:21,479 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,862  tflops: 459.97  mfu: 46.51%
[rank2]:2025-10-29 07:07:21,477 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,870  tflops: 460.35  mfu: 46.55%
[rank0]:2025-10-29 07:07:21,578 - INFO - Avg. fwd time: 15.1145 / Avg. bwd time: 8.7065 / Avg. batch time: 431.5959 (ms) / GPU bubble ratio: 55.85%
[rank2]:2025-10-29 07:07:21,815 - INFO - Avg. fwd time: 15.0492 / Avg. bwd time: 17.6310 / Avg. batch time: 351.3940 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:07:21,841 - INFO - Avg. fwd time: 17.2811 / Avg. bwd time: 19.9599 / Avg. batch time: 398.4290 (ms) / GPU bubble ratio: 25.22%
[rank3]:2025-10-29 07:07:21,795 - INFO - Avg. fwd time: 16.7291 / Avg. bwd time: 20.7007 / Avg. batch time: 314.9757 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:08:42,532 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:08:44,172 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank3]:2025-10-29 07:08:44,173 - INFO -  step: 1500  loss:  0.8917  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,906  tflops: 462.04  mfu: 46.72%
[rank1]:2025-10-29 07:08:44,175 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank1]:2025-10-29 07:08:44,253 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0708_stage1_step1500.svg
[rank0]:2025-10-29 07:08:44,174 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank0]:2025-10-29 07:08:44,255 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0708_stage0_step1500.svg
[rank2]:2025-10-29 07:08:44,253 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0708_stage2_step1500.svg
[rank3]:2025-10-29 07:08:44,359 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0708_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.12 ms, GPU Bubble Ratio: 67.27%, 23.64%, 33.12%, 23.37%
[rank3]:2025-10-29 07:08:44,427 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0708_stage3_step1500.svg
[rank2]:2025-10-29 07:08:44,790 - INFO - Avg. fwd time: 15.0660 / Avg. bwd time: 17.5867 / Avg. batch time: 351.1058 (ms) / GPU bubble ratio: 25.60%
[rank3]:2025-10-29 07:08:44,765 - INFO - Avg. fwd time: 16.7524 / Avg. bwd time: 20.6568 / Avg. batch time: 314.8044 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 07:08:44,818 - INFO - Avg. fwd time: 17.3027 / Avg. bwd time: 19.9098 / Avg. batch time: 397.7864 (ms) / GPU bubble ratio: 25.16%
[rank0]:2025-10-29 07:08:44,826 - INFO - Avg. fwd time: 15.1389 / Avg. bwd time: 8.4020 / Avg. batch time: 430.3603 (ms) / GPU bubble ratio: 56.24%
[rank0]:2025-10-29 07:10:05,416 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:10:07,069 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank1]:2025-10-29 07:10:07,072 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank3]:2025-10-29 07:10:07,071 - INFO -  step: 1550  loss:  0.9566  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,882  tflops: 460.91  mfu: 46.60%
[rank0]:2025-10-29 07:10:07,071 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank0]:2025-10-29 07:10:07,172 - INFO - Avg. fwd time: 15.1585 / Avg. bwd time: 8.1574 / Avg. batch time: 429.3521 (ms) / GPU bubble ratio: 56.56%
[rank3]:2025-10-29 07:10:07,390 - INFO - Avg. fwd time: 16.7711 / Avg. bwd time: 20.6220 / Avg. batch time: 314.6707 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:10:07,411 - INFO - Avg. fwd time: 15.0799 / Avg. bwd time: 17.5511 / Avg. batch time: 350.8604 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:10:07,438 - INFO - Avg. fwd time: 17.3202 / Avg. bwd time: 19.8697 / Avg. batch time: 397.2555 (ms) / GPU bubble ratio: 25.11%
[rank0]:2025-10-29 07:11:27,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:11:29,405 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank2_trend_line.svg
[rank2]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.45/0.45, [MB1] 0.45/0.45, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.59/0.59, [MB5] 0.73/0.73, [MB6] 0.86/0.86, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,946  tflops: 463.86  mfu: 46.90%
[rank2]:2025-10-29 07:11:29,439 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 07:11:29,427 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank1_trend_line.svg
[rank1]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,946  tflops: 463.88  mfu: 46.90%
[rank1]:2025-10-29 07:11:29,438 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:11:29,406 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank3_trend_line.svg
[rank0]:2025-10-29 07:11:29,428 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank0_trend_line.svg
[rank0]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,946  tflops: 463.87  mfu: 46.90%
[rank0]:2025-10-29 07:11:29,438 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:11:29,626 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0711_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.27 ms, GPU Bubble Ratio: 53.76%, 24.08%, 29.86%, 23.80%
[rank3]:2025-10-29 07:11:29,627 - INFO - 	> Batch Time: 356.27 ms (Average Freeze Ratio: 0.68)
[rank3]:2025-10-29 07:11:29,628 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:11:29,636 - INFO -  step: 1600  loss:  0.2251  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,922  tflops: 462.77  mfu: 46.79%
[rank3]:2025-10-29 07:11:29,636 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 07:11:45,993 - INFO - validate step: 1600  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,743
[rank0]:2025-10-29 07:11:45,955 - INFO - validate step: 1600  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,799
[rank2]:2025-10-29 07:11:46,021 - INFO - validate step: 1600  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,701
[rank3]:2025-10-29 07:11:46,044 - INFO - validate step: 1600  loss:  0.2525  memory: 86.40GiB(61.80%)  tps: 24,965
[rank0]:2025-10-29 07:11:46,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0711_stage0_step1600.svg
[rank2]:2025-10-29 07:11:46,131 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0711_stage2_step1600.svg
[rank1]:2025-10-29 07:11:46,128 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0711_stage1_step1600.svg
[rank0]:2025-10-29 07:11:46,210 - INFO - Avg. fwd time: 15.1759 / Avg. bwd time: 7.8894 / Avg. batch time: 428.1607 (ms) / GPU bubble ratio: 56.90%
[rank3]:2025-10-29 07:11:46,227 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0711_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.00 ms, GPU Bubble Ratio: 67.26%, 23.69%, 33.18%, 23.33%
[rank3]:2025-10-29 07:11:46,297 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0711_stage3_step1600.svg
[rank2]:2025-10-29 07:11:46,568 - INFO - Avg. fwd time: 15.0913 / Avg. bwd time: 17.5106 / Avg. batch time: 350.5083 (ms) / GPU bubble ratio: 25.59%
[rank1]:2025-10-29 07:11:46,594 - INFO - Avg. fwd time: 17.3353 / Avg. bwd time: 19.8238 / Avg. batch time: 396.5891 (ms) / GPU bubble ratio: 25.04%
[rank3]:2025-10-29 07:11:46,547 - INFO - Avg. fwd time: 16.7860 / Avg. bwd time: 20.5799 / Avg. batch time: 314.4458 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:13:02,226 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:13:03,771 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,527  tflops: 491.00  mfu: 49.65%
[rank2]:2025-10-29 07:13:03,769 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,537  tflops: 491.43  mfu: 49.69%
[rank1]:2025-10-29 07:13:03,772 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,532  tflops: 491.23  mfu: 49.67%
[rank3]:2025-10-29 07:13:03,770 - INFO -  step: 1650  loss:  0.2240  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank3]:2025-10-29 07:13:04,129 - INFO - Avg. fwd time: 16.7781 / Avg. bwd time: 20.5225 / Avg. batch time: 313.9127 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:13:04,195 - INFO - Avg. fwd time: 15.1760 / Avg. bwd time: 7.6386 / Avg. batch time: 426.7134 (ms) / GPU bubble ratio: 57.23%
[rank2]:2025-10-29 07:13:04,156 - INFO - Avg. fwd time: 15.0872 / Avg. bwd time: 17.4659 / Avg. batch time: 349.8564 (ms) / GPU bubble ratio: 25.56%
[rank1]:2025-10-29 07:13:04,184 - INFO - Avg. fwd time: 17.3310 / Avg. bwd time: 19.7750 / Avg. batch time: 395.6444 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-10-29 07:14:19,751 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:14:21,282 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank1]:2025-10-29 07:14:21,285 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank3]:2025-10-29 07:14:21,283 - INFO -  step: 1700  loss:  0.2341  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,569  tflops: 492.93  mfu: 49.84%
[rank0]:2025-10-29 07:14:21,284 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank2]:2025-10-29 07:14:21,364 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0714_stage2_step1700.svg
[rank1]:2025-10-29 07:14:21,363 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0714_stage1_step1700.svg
[rank0]:2025-10-29 07:14:21,366 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0714_stage0_step1700.svg
[rank0]:2025-10-29 07:14:21,453 - INFO - Avg. fwd time: 15.1749 / Avg. bwd time: 7.4359 / Avg. batch time: 425.5130 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-29 07:14:21,466 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0714_real_step1700_rank3.svg
[rank3]:> Batch Time: 374.32 ms, GPU Bubble Ratio: 67.25%, 23.62%, 33.13%, 23.39%
[rank3]:2025-10-29 07:14:21,534 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0714_stage3_step1700.svg
[rank2]:2025-10-29 07:14:21,798 - INFO - Avg. fwd time: 15.0835 / Avg. bwd time: 17.4295 / Avg. batch time: 349.3039 (ms) / GPU bubble ratio: 25.54%
[rank1]:2025-10-29 07:14:21,823 - INFO - Avg. fwd time: 17.3267 / Avg. bwd time: 19.7354 / Avg. batch time: 394.8516 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 07:14:21,778 - INFO - Avg. fwd time: 16.7711 / Avg. bwd time: 20.4758 / Avg. batch time: 313.4741 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:15:37,376 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:15:38,912 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank2]:2025-10-29 07:15:38,911 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank1]:2025-10-29 07:15:38,913 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank3]:2025-10-29 07:15:38,911 - INFO -  step: 1750  loss:  0.2353  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,553  tflops: 492.20  mfu: 49.77%
[rank0]:2025-10-29 07:15:39,002 - INFO - Avg. fwd time: 15.1742 / Avg. bwd time: 7.2126 / Avg. batch time: 424.2070 (ms) / GPU bubble ratio: 57.78%
[rank2]:2025-10-29 07:15:39,228 - INFO - Avg. fwd time: 15.0795 / Avg. bwd time: 17.3896 / Avg. batch time: 348.7090 (ms) / GPU bubble ratio: 25.51%
[rank1]:2025-10-29 07:15:39,252 - INFO - Avg. fwd time: 17.3221 / Avg. bwd time: 19.6918 / Avg. batch time: 393.9944 (ms) / GPU bubble ratio: 24.84%
[rank3]:2025-10-29 07:15:39,205 - INFO - Avg. fwd time: 16.7634 / Avg. bwd time: 20.4238 / Avg. batch time: 312.9870 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 07:16:54,806 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:16:56,349 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,579  tflops: 493.41  mfu: 49.89%
[rank1]:2025-10-29 07:16:56,349 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 07:16:56,347 - INFO -  step: 1800  loss:  0.2129  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,579  tflops: 493.42  mfu: 49.89%
[rank3]:2025-10-29 07:16:56,347 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:16:56,348 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,579  tflops: 493.42  mfu: 49.89%
[rank0]:2025-10-29 07:16:56,348 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:16:56,346 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,579  tflops: 493.41  mfu: 49.89%
[rank2]:2025-10-29 07:16:56,346 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:17:12,888 - INFO - validate step: 1800  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,765
[rank2]:2025-10-29 07:17:12,953 - INFO - validate step: 1800  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,665
[rank1]:2025-10-29 07:17:12,923 - INFO - validate step: 1800  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,713
[rank1]:2025-10-29 07:17:13,062 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0717_stage1_step1800.svg
[rank3]:2025-10-29 07:17:12,976 - INFO - validate step: 1800  loss:  0.2505  memory: 86.40GiB(61.80%)  tps: 24,633
[rank0]:2025-10-29 07:17:13,071 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0717_stage0_step1800.svg
[rank2]:2025-10-29 07:17:13,065 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0717_stage2_step1800.svg
[rank3]:2025-10-29 07:17:13,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0717_real_step1800_rank3.svg
[rank3]:> Batch Time: 373.64 ms, GPU Bubble Ratio: 67.23%, 23.55%, 33.06%, 23.40%
[rank3]:2025-10-29 07:17:13,233 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0717_stage3_step1800.svg
[rank3]:2025-10-29 07:17:13,545 - INFO - Avg. fwd time: 16.7556 / Avg. bwd time: 20.3742 / Avg. batch time: 312.5181 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 07:17:13,616 - INFO - Avg. fwd time: 15.1731 / Avg. bwd time: 7.0024 / Avg. batch time: 422.9684 (ms) / GPU bubble ratio: 58.06%
[rank2]:2025-10-29 07:17:13,571 - INFO - Avg. fwd time: 15.0753 / Avg. bwd time: 17.3518 / Avg. batch time: 348.1382 (ms) / GPU bubble ratio: 25.48%
[rank1]:2025-10-29 07:17:13,600 - INFO - Avg. fwd time: 17.3171 / Avg. bwd time: 19.6507 / Avg. batch time: 393.1778 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 07:18:29,426 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:18:30,973 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,491  tflops: 489.31  mfu: 49.48%
[rank2]:2025-10-29 07:18:30,971 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,500  tflops: 489.73  mfu: 49.52%
[rank1]:2025-10-29 07:18:30,974 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,496  tflops: 489.53  mfu: 49.50%
[rank3]:2025-10-29 07:18:30,972 - INFO -  step: 1850  loss:  0.1981  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,503  tflops: 489.88  mfu: 49.53%
[rank0]:2025-10-29 07:18:31,064 - INFO - Avg. fwd time: 15.1734 / Avg. bwd time: 6.8317 / Avg. batch time: 421.9686 (ms) / GPU bubble ratio: 58.28%
[rank2]:2025-10-29 07:18:31,288 - INFO - Avg. fwd time: 15.0726 / Avg. bwd time: 17.3217 / Avg. batch time: 347.6779 (ms) / GPU bubble ratio: 25.46%
[rank1]:2025-10-29 07:18:31,314 - INFO - Avg. fwd time: 17.3147 / Avg. bwd time: 19.6182 / Avg. batch time: 392.5189 (ms) / GPU bubble ratio: 24.73%
[rank3]:2025-10-29 07:18:31,268 - INFO - Avg. fwd time: 16.7502 / Avg. bwd time: 20.3349 / Avg. batch time: 312.1529 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:19:46,971 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:19:48,528 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank2]:2025-10-29 07:19:48,526 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank1]:2025-10-29 07:19:48,528 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank3]:2025-10-29 07:19:48,527 - INFO -  step: 1900  loss:  0.2126  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank0]:2025-10-29 07:19:48,613 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0719_stage0_step1900.svg
[rank2]:2025-10-29 07:19:48,613 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0719_stage2_step1900.svg
[rank1]:2025-10-29 07:19:48,609 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0719_stage1_step1900.svg
[rank0]:2025-10-29 07:19:48,701 - INFO - Avg. fwd time: 15.1727 / Avg. bwd time: 6.6428 / Avg. batch time: 420.8446 (ms) / GPU bubble ratio: 58.53%
[rank3]:2025-10-29 07:19:48,713 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0719_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.16 ms, GPU Bubble Ratio: 67.23%, 23.51%, 33.02%, 23.43%
[rank3]:2025-10-29 07:19:48,782 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0719_stage3_step1900.svg
[rank2]:2025-10-29 07:19:49,054 - INFO - Avg. fwd time: 15.0692 / Avg. bwd time: 17.2882 / Avg. batch time: 347.1585 (ms) / GPU bubble ratio: 25.44%
[rank1]:2025-10-29 07:19:49,079 - INFO - Avg. fwd time: 17.3104 / Avg. bwd time: 19.5809 / Avg. batch time: 391.7746 (ms) / GPU bubble ratio: 24.67%
[rank3]:2025-10-29 07:19:49,034 - INFO - Avg. fwd time: 16.7435 / Avg. bwd time: 20.2909 / Avg. batch time: 311.7400 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:21:04,715 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:21:06,281 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,536  tflops: 491.39  mfu: 49.69%
[rank1]:2025-10-29 07:21:06,282 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank2]:2025-10-29 07:21:06,279 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 07:21:06,280 - INFO -  step: 1950  loss:  0.2384  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 07:21:06,650 - INFO - Avg. fwd time: 16.7383 / Avg. bwd time: 20.2506 / Avg. batch time: 311.3684 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:21:06,719 - INFO - Avg. fwd time: 15.1723 / Avg. bwd time: 6.4641 / Avg. batch time: 419.8177 (ms) / GPU bubble ratio: 58.77%
[rank1]:2025-10-29 07:21:06,708 - INFO - Avg. fwd time: 17.3067 / Avg. bwd time: 19.5457 / Avg. batch time: 391.1060 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-10-29 07:21:06,678 - INFO - Avg. fwd time: 15.0662 / Avg. bwd time: 17.2563 / Avg. batch time: 346.7030 (ms) / GPU bubble ratio: 25.42%
[rank0]:2025-10-29 07:22:22,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:22:23,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank0]:2025-10-29 07:22:23,932 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 07:22:23,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank1]:2025-10-29 07:22:23,933 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 07:22:23,930 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank2]:2025-10-29 07:22:23,930 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 07:22:23,931 - INFO -  step: 2000  loss:  0.2230  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank3]:2025-10-29 07:22:23,931 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 07:22:40,488 - INFO - validate step: 2000  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,741
[rank1]:2025-10-29 07:22:40,526 - INFO - validate step: 2000  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,685
[rank2]:2025-10-29 07:22:40,551 - INFO - validate step: 2000  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,644
[rank3]:2025-10-29 07:22:40,575 - INFO - validate step: 2000  loss:  0.2515  memory: 86.40GiB(61.80%)  tps: 24,611
[rank0]:2025-10-29 07:22:40,664 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0722_stage0_step2000.svg
[rank1]:2025-10-29 07:22:40,666 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0722_stage1_step2000.svg
[rank2]:2025-10-29 07:22:40,667 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0722_stage2_step2000.svg
[rank0]:2025-10-29 07:22:40,753 - INFO - Avg. fwd time: 15.1715 / Avg. bwd time: 6.3184 / Avg. batch time: 418.9599 (ms) / GPU bubble ratio: 58.97%
[rank3]:2025-10-29 07:22:40,769 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0722_real_step2000_rank3.svg
[rank3]:> Batch Time: 372.80 ms, GPU Bubble Ratio: 67.23%, 23.48%, 32.99%, 23.43%
[rank3]:2025-10-29 07:22:40,842 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0722_stage3_step2000.svg
[rank2]:2025-10-29 07:22:41,116 - INFO - Avg. fwd time: 15.0634 / Avg. bwd time: 17.2301 / Avg. batch time: 346.3123 (ms) / GPU bubble ratio: 25.40%
[rank3]:2025-10-29 07:22:41,096 - INFO - Avg. fwd time: 16.7339 / Avg. bwd time: 20.2174 / Avg. batch time: 311.0612 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:22:41,143 - INFO - Avg. fwd time: 17.3032 / Avg. bwd time: 19.5168 / Avg. batch time: 390.5414 (ms) / GPU bubble ratio: 24.58%
[rank0]:2025-10-29 07:23:56,932 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:23:58,486 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,511  tflops: 490.25  mfu: 49.57%
[rank3]:2025-10-29 07:23:58,487 - INFO -  step: 2050  loss:  0.2648  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,515  tflops: 490.41  mfu: 49.59%
[rank0]:2025-10-29 07:23:58,488 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank0]:2025-10-29 07:23:58,578 - INFO - Avg. fwd time: 15.1716 / Avg. bwd time: 6.1565 / Avg. batch time: 418.0470 (ms) / GPU bubble ratio: 59.19%
[rank1]:2025-10-29 07:23:58,489 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,508  tflops: 490.08  mfu: 49.55%
[rank3]:2025-10-29 07:23:58,780 - INFO - Avg. fwd time: 16.7300 / Avg. bwd time: 20.1820 / Avg. batch time: 310.7404 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:23:58,827 - INFO - Avg. fwd time: 17.3007 / Avg. bwd time: 19.4854 / Avg. batch time: 389.9534 (ms) / GPU bubble ratio: 24.53%
[rank2]:2025-10-29 07:23:58,802 - INFO - Avg. fwd time: 15.0610 / Avg. bwd time: 17.2015 / Avg. batch time: 345.9169 (ms) / GPU bubble ratio: 25.39%
[rank0]:2025-10-29 07:25:14,552 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:25:16,089 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank0]:2025-10-29 07:25:16,088 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank2]:2025-10-29 07:25:16,086 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank3]:2025-10-29 07:25:16,088 - INFO -  step: 2100  loss:  0.2491  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,557  tflops: 492.37  mfu: 49.79%
[rank1]:2025-10-29 07:25:16,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0725_stage1_step2100.svg
[rank0]:2025-10-29 07:25:16,169 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0725_stage0_step2100.svg
[rank2]:2025-10-29 07:25:16,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0725_stage2_step2100.svg
[rank3]:2025-10-29 07:25:16,277 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0725_real_step2100_rank3.svg
[rank3]:> Batch Time: 372.53 ms, GPU Bubble Ratio: 67.23%, 23.46%, 32.98%, 23.43%
[rank3]:2025-10-29 07:25:16,341 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0725_stage3_step2100.svg
[rank3]:2025-10-29 07:25:16,651 - INFO - Avg. fwd time: 16.7257 / Avg. bwd time: 20.1479 / Avg. batch time: 310.4266 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:25:16,708 - INFO - Avg. fwd time: 17.2978 / Avg. bwd time: 19.4552 / Avg. batch time: 389.3845 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-29 07:25:16,719 - INFO - Avg. fwd time: 15.1712 / Avg. bwd time: 6.0027 / Avg. batch time: 417.1701 (ms) / GPU bubble ratio: 59.40%
[rank2]:2025-10-29 07:25:16,678 - INFO - Avg. fwd time: 15.0583 / Avg. bwd time: 17.1742 / Avg. batch time: 345.5319 (ms) / GPU bubble ratio: 25.37%
[rank0]:2025-10-29 07:26:32,366 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:26:33,910 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank0]:2025-10-29 07:26:33,912 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank3]:2025-10-29 07:26:33,912 - INFO -  step: 2150  loss:  0.2846  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,527  tflops: 490.96  mfu: 49.64%
[rank1]:2025-10-29 07:26:33,913 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank0]:2025-10-29 07:26:34,003 - INFO - Avg. fwd time: 15.1708 / Avg. bwd time: 5.8768 / Avg. batch time: 416.4421 (ms) / GPU bubble ratio: 59.57%
[rank3]:2025-10-29 07:26:34,205 - INFO - Avg. fwd time: 16.7227 / Avg. bwd time: 20.1202 / Avg. batch time: 310.1753 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:26:34,254 - INFO - Avg. fwd time: 17.2952 / Avg. bwd time: 19.4303 / Avg. batch time: 388.9094 (ms) / GPU bubble ratio: 24.45%
[rank2]:2025-10-29 07:26:34,226 - INFO - Avg. fwd time: 15.0562 / Avg. bwd time: 17.1519 / Avg. batch time: 345.2094 (ms) / GPU bubble ratio: 25.36%
[rank0]:2025-10-29 07:27:49,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:27:51,538 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank1]:2025-10-29 07:27:51,538 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 07:27:51,535 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank2]:2025-10-29 07:27:51,535 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 07:27:51,536 - INFO -  step: 2200  loss:  0.2276  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank3]:2025-10-29 07:27:51,536 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 07:27:51,537 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank0]:2025-10-29 07:27:51,537 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 07:28:08,077 - INFO - validate step: 2200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,764
[rank1]:2025-10-29 07:28:08,117 - INFO - validate step: 2200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,707
[rank2]:2025-10-29 07:28:08,135 - INFO - validate step: 2200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,675
[rank3]:2025-10-29 07:28:08,159 - INFO - validate step: 2200  loss:  0.2514  memory: 86.40GiB(61.80%)  tps: 24,642
[rank1]:2025-10-29 07:28:08,242 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0728_stage1_step2200.svg
[rank2]:2025-10-29 07:28:08,244 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0728_stage2_step2200.svg
[rank0]:2025-10-29 07:28:08,241 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0728_stage0_step2200.svg
[rank3]:2025-10-29 07:28:08,349 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0728_real_step2200_rank3.svg
[rank3]:> Batch Time: 372.35 ms, GPU Bubble Ratio: 67.23%, 23.45%, 32.97%, 23.43%
[rank0]:2025-10-29 07:28:08,332 - INFO - Avg. fwd time: 15.1698 / Avg. bwd time: 5.7365 / Avg. batch time: 415.6211 (ms) / GPU bubble ratio: 59.76%
[rank3]:2025-10-29 07:28:08,412 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0728_stage3_step2200.svg
[rank2]:2025-10-29 07:28:08,682 - INFO - Avg. fwd time: 15.0535 / Avg. bwd time: 17.1268 / Avg. batch time: 344.8404 (ms) / GPU bubble ratio: 25.34%
[rank3]:2025-10-29 07:28:08,662 - INFO - Avg. fwd time: 16.7186 / Avg. bwd time: 20.0890 / Avg. batch time: 309.8865 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:28:08,708 - INFO - Avg. fwd time: 17.2915 / Avg. bwd time: 19.4022 / Avg. batch time: 388.3707 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-10-29 07:29:24,544 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:29:26,105 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,504  tflops: 489.92  mfu: 49.54%
[rank2]:2025-10-29 07:29:26,102 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank3]:2025-10-29 07:29:26,103 - INFO -  step: 2250  loss:  0.2498  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,510  tflops: 490.21  mfu: 49.57%
[rank0]:2025-10-29 07:29:26,103 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,499  tflops: 489.68  mfu: 49.51%
[rank1]:2025-10-29 07:29:26,526 - INFO - Avg. fwd time: 17.2890 / Avg. bwd time: 19.3766 / Avg. batch time: 387.8813 (ms) / GPU bubble ratio: 24.38%
[rank2]:2025-10-29 07:29:26,495 - INFO - Avg. fwd time: 15.0511 / Avg. bwd time: 17.1028 / Avg. batch time: 344.5080 (ms) / GPU bubble ratio: 25.33%
[rank3]:2025-10-29 07:29:26,466 - INFO - Avg. fwd time: 16.7150 / Avg. bwd time: 20.0594 / Avg. batch time: 309.6160 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 07:29:26,539 - INFO - Avg. fwd time: 15.1697 / Avg. bwd time: 5.6028 / Avg. batch time: 414.8645 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-10-29 07:30:42,254 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:30:43,811 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,542  tflops: 491.68  mfu: 49.71%
[rank3]:2025-10-29 07:30:43,812 - INFO -  step: 2300  loss:  0.2170  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,542  tflops: 491.69  mfu: 49.72%
[rank0]:2025-10-29 07:30:43,813 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,542  tflops: 491.68  mfu: 49.71%
[rank1]:2025-10-29 07:30:43,813 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,542  tflops: 491.68  mfu: 49.72%
[rank1]:2025-10-29 07:30:43,893 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0730_stage1_step2300.svg
[rank2]:2025-10-29 07:30:43,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0730_stage2_step2300.svg
[rank0]:2025-10-29 07:30:43,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0730_stage0_step2300.svg
[rank3]:2025-10-29 07:30:44,001 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0730_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.21 ms, GPU Bubble Ratio: 67.24%, 23.43%, 32.97%, 23.44%
[rank0]:2025-10-29 07:30:43,983 - INFO - Avg. fwd time: 15.1694 / Avg. bwd time: 5.4930 / Avg. batch time: 414.2283 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-10-29 07:30:44,064 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0730_stage3_step2300.svg
[rank3]:2025-10-29 07:30:44,316 - INFO - Avg. fwd time: 16.7123 / Avg. bwd time: 20.0350 / Avg. batch time: 309.3946 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:30:44,364 - INFO - Avg. fwd time: 17.2867 / Avg. bwd time: 19.3552 / Avg. batch time: 387.4658 (ms) / GPU bubble ratio: 24.35%
[rank2]:2025-10-29 07:30:44,337 - INFO - Avg. fwd time: 15.0493 / Avg. bwd time: 17.0832 / Avg. batch time: 344.2233 (ms) / GPU bubble ratio: 25.32%
[rank0]:2025-10-29 07:32:00,081 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:32:01,649 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank2]:2025-10-29 07:32:01,646 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank3]:2025-10-29 07:32:01,647 - INFO -  step: 2350  loss:  0.2373  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,525  tflops: 490.89  mfu: 49.63%
[rank0]:2025-10-29 07:32:01,648 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank0]:2025-10-29 07:32:01,739 - INFO - Avg. fwd time: 15.1691 / Avg. bwd time: 5.3702 / Avg. batch time: 413.5230 (ms) / GPU bubble ratio: 60.26%
[rank2]:2025-10-29 07:32:01,972 - INFO - Avg. fwd time: 15.0471 / Avg. bwd time: 17.0613 / Avg. batch time: 343.9125 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-10-29 07:32:01,951 - INFO - Avg. fwd time: 16.7088 / Avg. bwd time: 20.0074 / Avg. batch time: 309.1411 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:32:01,998 - INFO - Avg. fwd time: 17.2839 / Avg. bwd time: 19.3310 / Avg. batch time: 387.0072 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 07:33:17,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:33:19,319 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,547  tflops: 491.93  mfu: 49.74%
[rank1]:2025-10-29 07:33:19,319 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,761  tflops: 455.25  mfu: 45.34%
[rank1]:2025-10-29 07:33:19,319 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 07:33:19,317 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,547  tflops: 491.92  mfu: 49.74%
[rank2]:2025-10-29 07:33:19,317 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,761  tflops: 455.27  mfu: 45.34%
[rank2]:2025-10-29 07:33:19,317 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 07:33:19,317 - INFO -  step: 2400  loss:  0.2224  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,547  tflops: 491.93  mfu: 49.74%
[rank3]:2025-10-29 07:33:19,318 - INFO -  final step: 2400  loss:  0.2224  grad_norm:  0.0000  tps: 9,764  tflops: 455.40  mfu: 45.35%
[rank3]:2025-10-29 07:33:19,318 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 07:33:19,318 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,547  tflops: 491.92  mfu: 49.74%
[rank0]:2025-10-29 07:33:19,318 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,760  tflops: 455.20  mfu: 45.33%
[rank0]:2025-10-29 07:33:19,319 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 07:33:35,791 - INFO - validate step: 2400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,866
[rank0]:2025-10-29 07:33:35,792 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 07:33:35,828 - INFO - validate step: 2400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,812
[rank1]:2025-10-29 07:33:35,829 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 07:33:35,832 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 07:33:35,862 - INFO - validate step: 2400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,757
[rank2]:2025-10-29 07:33:35,863 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 07:33:35,866 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 07:33:35,797 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 07:33:35,885 - INFO - validate step: 2400  loss:  0.2502  memory: 86.40GiB(61.80%)  tps: 24,725
[rank3]:2025-10-29 07:33:35,886 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 07:33:35,891 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 07:33:45,994 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 07:33:46,083 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0733_stage0_final2400.svg
[rank1]:2025-10-29 07:33:46,085 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0733_stage1_final2400.svg
[rank2]:2025-10-29 07:33:46,086 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0733_stage2_final2400.svg
[rank3]:2025-10-29 07:33:46,195 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0733_real_final2400_rank3.svg
[rank3]:> Batch Time: 372.00 ms, GPU Bubble Ratio: 67.24%, 23.42%, 32.94%, 23.43%
[rank1]:2025-10-29 07:33:46,329 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank1_stage1.svg
[rank1]:	> Counts Sum: 190240, Total Sum: 6039360 (3.15%), Ratio(%) per element: [2.14, 2.25, 2.41, 2.36, 2.03, 2.03, 2.52, 2.52, 2.46, 3.11, 2.78, 3.54, 1.98, 2.95, 2.41, 3.0, 3.59, 2.89, 3.43, 3.96, 2.68, 3.54, 3.0, 3.16, 3.11, 3.59, 2.84, 3.64, 3.59, 2.89, 3.0, 3.8, 3.16, 3.64, 2.19, 2.95, 3.75, 3.27, 3.59, 3.48, 3.8, 3.11, 3.05, 3.32, 3.05, 3.7, 4.02, 3.48, 2.89, 3.05, 3.37, 3.8, 3.43, 3.43, 3.54, 3.05, 3.05, 3.11, 3.05, 3.11, 2.84, 3.21, 3.75, 3.32, 3.48, 3.0, 3.48, 3.37, 3.16, 3.48, 3.8, 2.89, 2.78, 3.8, 3.8, 3.27, 3.48, 3.16, 3.27, 2.52, 3.21]
[rank1]:2025-10-29 07:33:46,330 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 07:33:46,370 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0733_thry_final2400_rank3.svg
[rank3]:> Batch Time: 529.31 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 07:33:46,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank2_stage2.svg
[rank2]:	> Counts Sum: 1416920, Total Sum: 5368320 (26.39%), Ratio(%) per element: [24.35, 24.83, 26.01, 22.31, 26.5, 24.03, 25.1, 24.89, 27.57, 27.14, 26.5, 25.91, 26.5, 26.93, 26.23, 25.53, 26.28, 26.12, 25.64, 26.71, 27.09, 24.83, 27.89, 26.55, 25.26, 25.85, 25.37, 26.44, 25.16, 26.12, 25.75, 28.11, 26.34, 26.23, 27.03, 27.14, 26.18, 26.07, 27.03, 26.18, 27.19, 27.46, 26.6, 28.21, 26.66, 27.25, 24.57, 27.62, 26.39, 27.57, 26.39, 26.55, 27.78, 26.98, 26.93, 27.41, 26.39, 24.94, 26.82, 27.03, 27.25, 28.0, 28.21, 27.25, 27.57, 26.07, 27.62, 24.89, 25.53, 26.5, 26.77, 25.91]
[rank2]:2025-10-29 07:33:46,331 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 07:33:46,321 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank0_stage0.svg
[rank0]:	> Counts Sum: 4610560, Total Sum: 5442880 (84.71%), Ratio(%) per element: [84.71, 84.38, 84.65, 84.49, 84.71, 84.6, 84.44, 84.92, 84.54, 84.6, 84.44, 84.81, 84.6, 84.6, 84.22, 84.6, 84.33, 84.33, 84.54, 84.54, 84.71, 84.33, 84.65, 84.6, 84.44, 84.38, 84.38, 84.33, 84.81, 84.76, 84.97, 84.76, 84.71, 84.71, 84.81, 84.65, 85.03, 85.03, 84.44, 84.54, 84.65, 85.08, 84.87, 84.76, 84.81, 84.44, 84.6, 84.87, 84.76, 84.97, 84.65, 84.81, 84.87, 84.76, 84.87, 84.71, 85.13, 84.71, 84.81, 84.87, 84.97, 84.97, 85.03, 84.6, 84.92, 84.71, 85.19, 84.81, 84.76, 84.76, 84.92, 84.76, 84.87]
[rank0]:2025-10-29 07:33:46,322 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 07:33:46,436 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0733_stage3_final2400.svg
[rank3]:2025-10-29 07:33:46,661 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.34, 1.77, 1.44, 1.5, 1.34, 1.18, 1.39, 1.39, 1.93, 1.07, 1.66, 1.6, 1.39, 1.39, 1.39, 1.55, 0.91, 1.39, 1.55, 1.55, 1.55, 1.77, 1.23, 1.77, 1.44, 1.34, 1.23, 1.87, 1.98, 1.71, 1.6, 1.77, 1.77, 1.39, 2.09, 2.14, 1.39, 1.82, 1.5, 1.93, 1.71, 1.77, 1.71, 1.34, 1.87, 1.5, 1.87, 1.77, 1.34, 1.87, 1.6, 1.44, 1.23, 1.82, 1.5, 1.77, 1.5, 1.55, 1.6, 1.71, 1.98, 1.55, 1.55, 1.5, 1.66]
[rank3]:2025-10-29 07:33:46,662 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.67797
[rank3]:wandb:               final/avg_loss 0.22237
[rank3]:wandb:             final/avg_mfu(%) 45.3454
[rank3]:wandb:             final/avg_tflops 455.40338
[rank3]:wandb:    final/avg_throughput(tps) 9764.18967
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.22237
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.22237
[rank3]:wandb: loss_metrics/global_max_loss 0.22237
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/l90qbnni
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyauto_dm1/20251029-0621/wandb/run-20251029_062142-l90qbnni/logs
[rank0]:2025-10-29 07:33:48,322 - INFO - Training completed
[rank0]:2025-10-29 07:33:48,322 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 07:33:48,734 - INFO - Process group destroyed
[rank3]:2025-10-29 07:33:48,735 - INFO - Process group destroyed
[rank2]:2025-10-29 07:33:48,771 - INFO - Process group destroyed
[rank0]:2025-10-29 07:33:48,826 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.23', 'layers.19', 'layers.17', 'layers.21', 'layers.20', 'layers.24', 'layers.22'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'layers.6', 'layers.5', 'layers.7', 'tok_embeddings', 'layers.4', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.14', 'layers.16', 'layers.11', 'layers.10', 'layers.12', 'layers.15', 'layers.13', 'layers.8', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'layers.27', 'layers.26', 'output', 'layers.30', 'layers.31', 'norm', 'layers.28', 'layers.29'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 08:17:02 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] 
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] *****************************************
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-10-29 08:17:09,457 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 08:17:09,483 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 08:17:09,470 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 08:17:09,466 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 08:17:10,483 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 08:17:10,485 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 08:17:10,466 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 08:17:10,468 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 08:17:10,475 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 08:17:10,477 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 08:17:10,476 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 08:17:10,479 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 08:17:10,483 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 08:17:12,359 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 08:17:12,631 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 08:17:14,213 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-29 08:17:15,798 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:15,765 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-29 08:17:15,871 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 08:17:15,871 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 08:17:16,015 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:16,024 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:16,090 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 08:17:16,113 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 08:17:16,113 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 08:17:16,102 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 08:17:16,102 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 08:17:16,211 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 08:17:16,212 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 08:17:16,359 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 08:17:16,359 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 08:17:16,342 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 08:17:16,343 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run am0tnl8r
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1/20251029-0817/wandb/run-20251029_081716-am0tnl8r
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/am0tnl8r
[rank3]:2025-10-29 08:17:17,944 - INFO - WandB logging enabled
[rank3]:2025-10-29 08:17:17,945 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 08:17:18,020 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 08:17:18,021 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 08:17:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 08:17:18,372 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 08:17:18,372 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 08:17:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 08:17:18,387 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-29 08:17:18,387 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 08:17:18,388 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 08:17:18,387 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 08:17:21,739 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank3]:2025-10-29 08:17:22,141 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank2]:2025-10-29 08:17:22,172 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank0]:2025-10-29 08:17:22,296 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 08:17:22,296 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank0]:2025-10-29 08:17:22,296 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400.
[rank0]:2025-10-29 08:17:31,010 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 08:17:31,010 - INFO - Finished loading the checkpoint in 8.71 seconds.
[rank0]:2025-10-29 08:17:31,011 - INFO - Training starts at step 1
[rank1]:2025-10-29 08:17:35,820 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 49.69GiB(35.54%)  tps: 820  tflops: 38.26  mfu: 3.87%
[rank1]:2025-10-29 08:17:35,820 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 08:17:35,822 - INFO -  step:  1  loss:  0.9694  grad_norm:  2.3281  memory: 58.03GiB(41.50%)  tps: 919  tflops: 42.87  mfu: 4.33%
[rank3]:2025-10-29 08:17:35,822 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 08:17:35,817 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 44.28GiB(31.67%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank2]:2025-10-29 08:17:35,817 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 08:17:35,838 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 49.75GiB(35.58%)  tps: 830  tflops: 38.69  mfu: 3.91%
[rank0]:2025-10-29 08:17:35,838 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 08:17:54,081 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,081 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,082 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,082 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,216 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,216 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,170 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:19:45,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:19:48,219 - INFO -  step: 50  loss:  0.8921  grad_norm:  0.5945  memory: 73.38GiB(52.48%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank1]:2025-10-29 08:19:48,217 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 64.32GiB(46.00%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank0]:2025-10-29 08:19:48,221 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 66.72GiB(47.72%)  tps: 6,064  tflops: 282.84  mfu: 28.60%
[rank2]:2025-10-29 08:19:48,214 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 57.29GiB(40.97%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank3]:2025-10-29 08:19:48,681 - INFO - Avg. fwd time: 14.7311 / Avg. bwd time: 42.9603 / Avg. batch time: 481.0782 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 08:19:48,732 - INFO - Avg. fwd time: 13.2849 / Avg. bwd time: 36.4670 / Avg. batch time: 534.0333 (ms) / GPU bubble ratio: 25.47%
[rank0]:2025-10-29 08:19:48,812 - INFO - Avg. fwd time: 14.2030 / Avg. bwd time: 38.5726 / Avg. batch time: 650.6763 (ms) / GPU bubble ratio: 35.11%
[rank1]:2025-10-29 08:19:48,779 - INFO - Avg. fwd time: 15.4079 / Avg. bwd time: 41.6510 / Avg. batch time: 594.6645 (ms) / GPU bubble ratio: 23.24%
[rank3]:2025-10-29 08:20:15,062 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 08:20:42,146 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 08:20:42,363 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-10-29 08:20:42,479 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,484 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,506 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,494 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,469 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,485 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,503 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,512 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,545 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,528 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,561 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,603 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,643 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,679 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,651 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,689 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,639 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,717 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,755 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,792 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,727 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,765 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,802 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,711 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,748 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,787 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,715 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,840 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,825 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,863 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:21:15,729 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 08:21:16,037 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_max_batch_time.svg
[rank3]:> Batch Time: 635.25 ms, GPU Bubble Ratio: 33.04%, 27.14%, 36.75%, 26.69%
[rank3]:2025-10-29 08:21:16,224 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_min_batch_time.svg
[rank3]:> Batch Time: 360.16 ms, GPU Bubble Ratio: 68.64%, 23.38%, 33.95%, 23.98%
[rank3]:2025-10-29 08:21:16,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 360.16 ms, GPU Bubble Ratio: 31.84%, 23.09%, 30.76%, 23.98%
[rank3]:2025-10-29 08:21:16,430 - INFO - 	> Batch Time: 360.16 ms (Average Freeze Ratio: 0.87, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 08:21:31,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:21:33,007 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.19/0.58, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 08:21:33,008 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,818  tflops: 364.63  mfu: 36.87%
[rank2]:2025-10-29 08:21:32,987 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.30/0.90, [MB3] 0.31/0.94, [MB4] 0.32/0.96, [MB5] 0.33/0.98, [MB6] 0.33/0.99, [MB7] 0.33/1.00
[rank2]:2025-10-29 08:21:33,005 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,817  tflops: 364.61  mfu: 36.87%
[rank3]:2025-10-29 08:21:32,972 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 08:21:33,006 - INFO -  step: 100  loss:  0.8837  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,818  tflops: 364.63  mfu: 36.87%
[rank1]:2025-10-29 08:21:33,008 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.95, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 08:21:33,008 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,817  tflops: 364.61  mfu: 36.87%
[rank0]:2025-10-29 08:21:33,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0821_stage0_step100.svg
[rank2]:2025-10-29 08:21:33,085 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0821_stage2_step100.svg
[rank1]:2025-10-29 08:21:33,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0821_stage1_step100.svg
[rank0]:2025-10-29 08:21:33,187 - INFO - Avg. fwd time: 14.6950 / Avg. bwd time: 27.7886 / Avg. batch time: 580.0868 (ms) / GPU bubble ratio: 41.41%
[rank3]:2025-10-29 08:21:33,191 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_real_step100_rank3.svg
[rank3]:> Batch Time: 632.80 ms, GPU Bubble Ratio: 32.97%, 27.20%, 36.63%, 26.62%
[rank3]:2025-10-29 08:21:33,251 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0821_stage3_step100.svg
[rank2]:2025-10-29 08:21:33,536 - INFO - Avg. fwd time: 13.9554 / Avg. bwd time: 30.8540 / Avg. batch time: 480.9322 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-10-29 08:21:33,514 - INFO - Avg. fwd time: 15.5040 / Avg. bwd time: 36.3734 / Avg. batch time: 432.3901 (ms) / GPU bubble ratio: 4.02%
[rank1]:2025-10-29 08:21:33,562 - INFO - Avg. fwd time: 16.2639 / Avg. bwd time: 35.3395 / Avg. batch time: 535.2476 (ms) / GPU bubble ratio: 22.87%
[rank0]:2025-10-29 08:23:20,788 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:23:22,879 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.60/0.90, [MB3] 0.62/0.94, [MB4] 0.64/0.96, [MB5] 0.65/0.98, [MB6] 0.66/0.99, [MB7] 0.67/1.00
[rank2]:2025-10-29 08:23:22,879 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 64.67GiB(46.25%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank0]:2025-10-29 08:23:22,889 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.39/0.58, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 08:23:22,890 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 74.22GiB(53.08%)  tps: 7,455  tflops: 347.71  mfu: 35.16%
[rank3]:2025-10-29 08:23:22,880 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 08:23:22,883 - INFO -  step: 150  loss:  0.8737  grad_norm:  0.3395  memory: 84.49GiB(60.43%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank1]:2025-10-29 08:23:22,881 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.64/0.95, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 08:23:22,882 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 72.68GiB(51.98%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank2]:2025-10-29 08:23:23,345 - INFO - Avg. fwd time: 14.1601 / Avg. bwd time: 28.7960 / Avg. batch time: 461.3653 (ms) / GPU bubble ratio: 25.51%
[rank3]:2025-10-29 08:23:23,318 - INFO - Avg. fwd time: 15.7215 / Avg. bwd time: 34.0674 / Avg. batch time: 414.9423 (ms) / GPU bubble ratio: 4.01%
[rank0]:2025-10-29 08:23:23,407 - INFO - Avg. fwd time: 14.8232 / Avg. bwd time: 27.5460 / Avg. batch time: 559.4825 (ms) / GPU bubble ratio: 39.42%
[rank1]:2025-10-29 08:23:23,376 - INFO - Avg. fwd time: 16.4974 / Avg. bwd time: 33.1080 / Avg. batch time: 514.6032 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-10-29 08:24:57,088 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:24:58,999 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.90/0.90, [MB3] 0.94/0.94, [MB4] 0.96/0.96, [MB5] 0.98/0.98, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:24:59,000 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 64.67GiB(46.25%)  tps: 8,523  tflops: 397.50  mfu: 40.19%
[rank1]:2025-10-29 08:24:58,998 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:24:59,000 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 08:24:58,999 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 72.99GiB(52.21%)  tps: 8,523  tflops: 397.51  mfu: 40.19%
[rank1]:2025-10-29 08:24:58,999 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 08:24:59,005 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:24:59,007 - INFO -  step: 200  loss:  2.1141  grad_norm: 87.6197  memory: 84.59GiB(60.50%)  tps: 8,522  tflops: 397.49  mfu: 40.19%
[rank0]:2025-10-29 08:24:59,005 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:24:59,007 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 08:24:59,005 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 75.21GiB(53.80%)  tps: 8,523  tflops: 397.52  mfu: 40.19%
[rank0]:2025-10-29 08:24:59,005 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 08:25:17,849 - INFO - validate step: 200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 21,737
[rank2]:2025-10-29 08:25:17,901 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 21,671
[rank3]:2025-10-29 08:25:17,905 - INFO - validate step: 200  loss:  1.5024  memory: 84.59GiB(60.50%)  tps: 21,676
[rank1]:2025-10-29 08:25:17,886 - INFO - validate step: 200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 21,687
[rank2]:2025-10-29 08:25:17,979 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0825_stage2_step200.svg
[rank0]:2025-10-29 08:25:17,974 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0825_stage0_step200.svg
[rank1]:2025-10-29 08:25:17,978 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0825_stage1_step200.svg
[rank3]:2025-10-29 08:25:18,083 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0825_real_step200_rank3.svg
[rank3]:> Batch Time: 511.41 ms, GPU Bubble Ratio: 32.34%, 27.92%, 38.69%, 27.14%
[rank3]:2025-10-29 08:25:18,148 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0825_stage3_step200.svg
[rank2]:2025-10-29 08:25:18,456 - INFO - Avg. fwd time: 14.3609 / Avg. bwd time: 26.8939 / Avg. batch time: 442.2483 (ms) / GPU bubble ratio: 25.37%
[rank3]:2025-10-29 08:25:18,430 - INFO - Avg. fwd time: 15.9583 / Avg. bwd time: 31.7422 / Avg. batch time: 397.9136 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 08:25:18,492 - INFO - Avg. fwd time: 15.0309 / Avg. bwd time: 25.0929 / Avg. batch time: 536.5669 (ms) / GPU bubble ratio: 40.18%
[rank1]:2025-10-29 08:25:18,487 - INFO - Avg. fwd time: 16.7582 / Avg. bwd time: 30.7420 / Avg. batch time: 494.2305 (ms) / GPU bubble ratio: 23.11%
[rank0]:2025-10-29 08:26:39,295 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:26:40,911 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:26:40,926 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.90/0.90, [MB3] 0.94/0.94, [MB4] 0.96/0.96, [MB5] 0.98/0.98, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:26:40,945 - INFO -  step: 250  loss:  4.5668  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank0]:2025-10-29 08:26:40,946 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:26:40,947 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,858  tflops: 459.79  mfu: 46.49%
[rank2]:2025-10-29 08:26:40,944 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,865  tflops: 460.10  mfu: 46.52%
[rank1]:2025-10-29 08:26:40,946 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:26:40,947 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.00  mfu: 46.51%
[rank0]:2025-10-29 08:26:41,041 - INFO - Avg. fwd time: 15.2365 / Avg. bwd time: 20.1484 / Avg. batch time: 508.0392 (ms) / GPU bubble ratio: 44.28%
[rank3]:2025-10-29 08:26:41,258 - INFO - Avg. fwd time: 16.2394 / Avg. bwd time: 29.2188 / Avg. batch time: 379.7537 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-29 08:26:41,279 - INFO - Avg. fwd time: 14.6104 / Avg. bwd time: 24.6965 / Avg. batch time: 421.7390 (ms) / GPU bubble ratio: 25.44%
[rank1]:2025-10-29 08:26:41,305 - INFO - Avg. fwd time: 17.0556 / Avg. bwd time: 28.2397 / Avg. batch time: 470.8211 (ms) / GPU bubble ratio: 23.04%
[rank0]:2025-10-29 08:28:02,159 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:28:03,972 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank2_trend_line.svg
[rank2]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.89/0.89, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:28:04,003 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.89/0.89, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 08:28:03,995 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank0_trend_line.svg
[rank1]:2025-10-29 08:28:03,987 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank1_trend_line.svg
[rank1]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:28:04,003 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:03,956 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank3_trend_line.svg
[rank0]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:28:04,002 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank1]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank3]:2025-10-29 08:28:04,196 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0828_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.62 ms, GPU Bubble Ratio: 37.91%, 24.53%, 31.10%, 24.88%
[rank3]:2025-10-29 08:28:04,196 - INFO - 	> Batch Time: 366.62 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 08:28:04,196 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:04,199 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:04,202 - INFO -  step: 300  loss:  5.6260  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,840  tflops: 458.92  mfu: 46.40%
[rank2]:2025-10-29 08:28:04,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0828_stage2_step300.svg
[rank0]:2025-10-29 08:28:04,271 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0828_stage0_step300.svg
[rank1]:2025-10-29 08:28:04,268 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0828_stage1_step300.svg
[rank3]:2025-10-29 08:28:04,376 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0828_real_step300_rank3.svg
[rank3]:> Batch Time: 448.12 ms, GPU Bubble Ratio: 39.12%, 29.34%, 35.81%, 26.54%
[rank3]:2025-10-29 08:28:04,439 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0828_stage3_step300.svg
[rank2]:2025-10-29 08:28:04,789 - INFO - Avg. fwd time: 14.7765 / Avg. bwd time: 23.2381 / Avg. batch time: 407.6518 (ms) / GPU bubble ratio: 25.40%
[rank3]:2025-10-29 08:28:04,768 - INFO - Avg. fwd time: 16.4300 / Avg. bwd time: 27.4802 / Avg. batch time: 367.2273 (ms) / GPU bubble ratio: 4.34%
[rank0]:2025-10-29 08:28:04,818 - INFO - Avg. fwd time: 15.3590 / Avg. bwd time: 16.6260 / Avg. batch time: 488.4073 (ms) / GPU bubble ratio: 47.61%
[rank1]:2025-10-29 08:28:04,812 - INFO - Avg. fwd time: 17.2476 / Avg. bwd time: 26.6005 / Avg. batch time: 454.8396 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-10-29 08:29:25,588 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 08:29:27,238 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,842  tflops: 459.04  mfu: 46.41%
[rank1]:2025-10-29 08:29:27,240 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,842  tflops: 459.02  mfu: 46.41%
[rank0]:2025-10-29 08:29:27,240 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,842  tflops: 459.03  mfu: 46.41%
[rank3]:2025-10-29 08:29:27,239 - INFO -  step: 350  loss:  4.1776  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,866  tflops: 460.14  mfu: 46.53%
[rank0]:2025-10-29 08:29:27,337 - INFO - Avg. fwd time: 15.4358 / Avg. bwd time: 14.4594 / Avg. batch time: 476.3046 (ms) / GPU bubble ratio: 49.79%
[rank2]:2025-10-29 08:29:27,577 - INFO - Avg. fwd time: 14.8795 / Avg. bwd time: 22.3408 / Avg. batch time: 398.9537 (ms) / GPU bubble ratio: 25.36%
[rank3]:2025-10-29 08:29:27,555 - INFO - Avg. fwd time: 16.5502 / Avg. bwd time: 26.4133 / Avg. batch time: 359.5691 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-10-29 08:29:27,603 - INFO - Avg. fwd time: 17.3679 / Avg. bwd time: 25.5941 / Avg. batch time: 444.9812 (ms) / GPU bubble ratio: 22.76%
[rank0]:2025-10-29 08:30:47,182 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:30:48,949 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank2_trend_line.svg
[rank3]:2025-10-29 08:30:48,940 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank3_trend_line.svg
[rank1]:2025-10-29 08:30:48,967 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank1_trend_line.svg
[rank1]:2025-10-29 08:30:48,972 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:30:48,973 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.77/0.77, [MB3] 0.81/0.81, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:30:48,967 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank0_trend_line.svg
[rank0]:2025-10-29 08:30:48,972 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,023  tflops: 467.46  mfu: 47.27%
[rank2]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,022  tflops: 467.45  mfu: 47.26%
[rank0]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,023  tflops: 467.46  mfu: 47.27%
[rank1]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 08:30:49,165 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0830_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.78 ms, GPU Bubble Ratio: 52.15%, 24.59%, 32.09%, 24.89%
[rank3]:2025-10-29 08:30:49,166 - INFO - 	> Batch Time: 364.78 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 08:30:49,166 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:30:49,172 - INFO -  step: 400  loss:  0.7527  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank3]:2025-10-29 08:30:49,172 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 08:31:05,758 - INFO - validate step: 400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,406
[rank3]:2025-10-29 08:31:05,822 - INFO - validate step: 400  loss:  1.2537  memory: 84.59GiB(60.50%)  tps: 24,602
[rank1]:2025-10-29 08:31:05,796 - INFO - validate step: 400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,351
[rank2]:2025-10-29 08:31:05,811 - INFO - validate step: 400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,329
[rank1]:2025-10-29 08:31:05,899 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0831_stage1_step400.svg
[rank0]:2025-10-29 08:31:05,895 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0831_stage0_step400.svg
[rank2]:2025-10-29 08:31:05,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0831_stage2_step400.svg
[rank3]:2025-10-29 08:31:06,007 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0831_real_step400_rank3.svg
[rank3]:> Batch Time: 384.51 ms, GPU Bubble Ratio: 67.11%, 23.02%, 33.51%, 23.82%
[rank0]:2025-10-29 08:31:05,978 - INFO - Avg. fwd time: 15.4846 / Avg. bwd time: 12.5513 / Avg. batch time: 465.2262 (ms) / GPU bubble ratio: 51.79%
[rank3]:2025-10-29 08:31:06,078 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0831_stage3_step400.svg
[rank3]:2025-10-29 08:31:06,322 - INFO - Avg. fwd time: 16.6331 / Avg. bwd time: 25.4505 / Avg. batch time: 352.4513 (ms) / GPU bubble ratio: 4.48%
[rank1]:2025-10-29 08:31:06,369 - INFO - Avg. fwd time: 17.4543 / Avg. bwd time: 24.6932 / Avg. batch time: 435.8979 (ms) / GPU bubble ratio: 22.65%
[rank2]:2025-10-29 08:31:06,344 - INFO - Avg. fwd time: 14.9536 / Avg. bwd time: 21.5380 / Avg. batch time: 390.8980 (ms) / GPU bubble ratio: 25.32%
[rank0]:2025-10-29 08:32:21,636 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 08:32:23,182 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,586  tflops: 493.73  mfu: 49.92%
[rank2]:2025-10-29 08:32:23,180 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,588  tflops: 493.84  mfu: 49.93%
[rank0]:2025-10-29 08:32:23,181 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,581  tflops: 493.49  mfu: 49.90%
[rank3]:2025-10-29 08:32:23,181 - INFO -  step: 450  loss:  8.8215  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,590  tflops: 493.91  mfu: 49.94%
[rank3]:2025-10-29 08:32:23,531 - INFO - Avg. fwd time: 16.6178 / Avg. bwd time: 24.6339 / Avg. batch time: 345.7209 (ms) / GPU bubble ratio: 4.54%
[rank1]:2025-10-29 08:32:23,576 - INFO - Avg. fwd time: 17.4468 / Avg. bwd time: 23.9528 / Avg. batch time: 427.6213 (ms) / GPU bubble ratio: 22.55%
[rank2]:2025-10-29 08:32:23,552 - INFO - Avg. fwd time: 14.9566 / Avg. bwd time: 20.8766 / Avg. batch time: 383.4259 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-29 08:32:23,581 - INFO - Avg. fwd time: 15.4601 / Avg. bwd time: 11.0882 / Avg. batch time: 455.3762 (ms) / GPU bubble ratio: 53.36%
[rank0]:2025-10-29 08:33:38,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:33:40,340 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank0]:2025-10-29 08:33:40,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0833_stage0_step500.svg
[rank1]:2025-10-29 08:33:40,341 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank1]:2025-10-29 08:33:40,411 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0833_stage1_step500.svg
[rank2]:2025-10-29 08:33:40,339 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank2]:2025-10-29 08:33:40,412 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0833_stage2_step500.svg
[rank3]:2025-10-29 08:33:40,340 - INFO -  step: 500  loss: 13.0543  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,617  tflops: 495.19  mfu: 50.07%
[rank0]:2025-10-29 08:33:40,496 - INFO - Avg. fwd time: 15.4411 / Avg. bwd time: 10.0810 / Avg. batch time: 448.5026 (ms) / GPU bubble ratio: 54.48%
[rank3]:2025-10-29 08:33:40,519 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0833_real_step500_rank3.svg
[rank3]:> Batch Time: 380.98 ms, GPU Bubble Ratio: 67.14%, 22.97%, 33.64%, 23.98%
[rank3]:2025-10-29 08:33:40,581 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0833_stage3_step500.svg
[rank3]:2025-10-29 08:33:40,821 - INFO - Avg. fwd time: 16.6058 / Avg. bwd time: 24.0700 / Avg. batch time: 341.0616 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-29 08:33:40,867 - INFO - Avg. fwd time: 17.4410 / Avg. bwd time: 23.4426 / Avg. batch time: 421.8340 (ms) / GPU bubble ratio: 22.46%
[rank2]:2025-10-29 08:33:40,841 - INFO - Avg. fwd time: 14.9567 / Avg. bwd time: 20.4197 / Avg. batch time: 378.1932 (ms) / GPU bubble ratio: 25.17%
[rank0]:2025-10-29 08:34:56,100 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:34:57,631 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,599  tflops: 494.34  mfu: 49.98%
[rank2]:2025-10-29 08:34:57,628 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,599  tflops: 494.35  mfu: 49.98%
[rank0]:2025-10-29 08:34:57,630 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,599  tflops: 494.34  mfu: 49.98%
[rank3]:2025-10-29 08:34:57,630 - INFO -  step: 550  loss: 11.2601  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,599  tflops: 494.35  mfu: 49.98%
[rank0]:2025-10-29 08:34:57,714 - INFO - Avg. fwd time: 15.4244 / Avg. bwd time: 9.1151 / Avg. batch time: 441.9685 (ms) / GPU bubble ratio: 55.58%
[rank1]:2025-10-29 08:34:57,964 - INFO - Avg. fwd time: 17.4350 / Avg. bwd time: 22.9521 / Avg. batch time: 416.3401 (ms) / GPU bubble ratio: 22.40%
[rank2]:2025-10-29 08:34:57,938 - INFO - Avg. fwd time: 14.9577 / Avg. bwd time: 19.9833 / Avg. batch time: 373.2393 (ms) / GPU bubble ratio: 25.11%
[rank3]:2025-10-29 08:34:57,918 - INFO - Avg. fwd time: 16.5941 / Avg. bwd time: 23.5299 / Avg. batch time: 336.5977 (ms) / GPU bubble ratio: 4.64%
[rank0]:2025-10-29 08:36:13,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:36:15,047 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank2_trend_line.svg
[rank3]:2025-10-29 08:36:15,037 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank3_trend_line.svg
[rank1]:2025-10-29 08:36:15,071 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank1_trend_line.svg
[rank1]:2025-10-29 08:36:15,078 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,577  tflops: 493.32  mfu: 49.88%
[rank1]:2025-10-29 08:36:15,082 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 08:36:15,073 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank0_trend_line.svg
[rank0]:2025-10-29 08:36:15,078 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,577  tflops: 493.32  mfu: 49.88%
[rank0]:2025-10-29 08:36:15,081 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 08:36:15,079 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.79/0.79, [MB2] 0.83/0.83, [MB3] 0.86/0.86, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,577  tflops: 493.30  mfu: 49.88%
[rank2]:2025-10-29 08:36:15,081 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 08:36:15,270 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0836_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.16 ms, GPU Bubble Ratio: 59.36%, 23.91%, 33.32%, 24.50%
[rank3]:2025-10-29 08:36:15,270 - INFO - 	> Batch Time: 358.16 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 08:36:15,271 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:36:15,278 - INFO -  step: 600  loss:  9.0968  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,550  tflops: 492.08  mfu: 49.75%
[rank3]:2025-10-29 08:36:15,278 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 08:36:31,813 - INFO - validate step: 600  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,480
[rank1]:2025-10-29 08:36:31,851 - INFO - validate step: 600  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,425
[rank2]:2025-10-29 08:36:31,867 - INFO - validate step: 600  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,402
[rank3]:2025-10-29 08:36:31,879 - INFO - validate step: 600  loss:  1.5320  memory: 84.59GiB(60.50%)  tps: 24,676
[rank0]:2025-10-29 08:36:31,952 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0836_stage0_step600.svg
[rank1]:2025-10-29 08:36:31,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0836_stage1_step600.svg
[rank2]:2025-10-29 08:36:31,956 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0836_stage2_step600.svg
[rank3]:2025-10-29 08:36:32,061 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0836_real_step600_rank3.svg
[rank3]:> Batch Time: 378.43 ms, GPU Bubble Ratio: 67.20%, 22.93%, 33.62%, 23.97%
[rank3]:2025-10-29 08:36:32,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0836_stage3_step600.svg
[rank2]:2025-10-29 08:36:32,457 - INFO - Avg. fwd time: 14.9575 / Avg. bwd time: 19.6224 / Avg. batch time: 369.1340 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 08:36:32,434 - INFO - Avg. fwd time: 16.5832 / Avg. bwd time: 23.0833 / Avg. batch time: 332.8977 (ms) / GPU bubble ratio: 4.68%
[rank1]:2025-10-29 08:36:32,481 - INFO - Avg. fwd time: 17.4292 / Avg. bwd time: 22.5483 / Avg. batch time: 411.7946 (ms) / GPU bubble ratio: 22.34%
[rank0]:2025-10-29 08:36:32,488 - INFO - Avg. fwd time: 15.4095 / Avg. bwd time: 8.3182 / Avg. batch time: 436.5642 (ms) / GPU bubble ratio: 56.52%
[rank0]:2025-10-29 08:38:25,089 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:38:27,388 - INFO -  step: 650  loss:  0.0867  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,092  tflops: 330.78  mfu: 33.45%
[rank0]:2025-10-29 08:38:27,420 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0831  memory: 75.21GiB(53.80%)  tps: 7,086  tflops: 330.50  mfu: 33.42%
[rank1]:2025-10-29 08:38:27,386 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,091  tflops: 330.70  mfu: 33.44%
[rank2]:2025-10-29 08:38:27,387 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,091  tflops: 330.75  mfu: 33.44%
[rank3]:2025-10-29 08:38:27,709 - INFO - Avg. fwd time: 16.5782 / Avg. bwd time: 22.7657 / Avg. batch time: 330.2876 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 08:38:27,730 - INFO - Avg. fwd time: 14.9604 / Avg. bwd time: 19.3707 / Avg. batch time: 367.5391 (ms) / GPU bubble ratio: 25.27%
[rank1]:2025-10-29 08:38:27,790 - INFO - Avg. fwd time: 17.4113 / Avg. bwd time: 22.2368 / Avg. batch time: 414.0419 (ms) / GPU bubble ratio: 23.39%
[rank0]:2025-10-29 08:38:27,911 - INFO - Avg. fwd time: 15.2988 / Avg. bwd time: 10.4468 / Avg. batch time: 445.2106 (ms) / GPU bubble ratio: 53.74%
[rank0]:2025-10-29 08:40:20,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:40:23,062 - INFO -  step: 700  loss:  0.1000  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,082  tflops: 330.31  mfu: 33.40%
[rank2]:2025-10-29 08:40:23,061 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank1]:2025-10-29 08:40:23,061 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank0]:2025-10-29 08:40:23,094 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1030  memory: 75.21GiB(53.80%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank0]:2025-10-29 08:40:23,166 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0840_stage0_step700.svg
[rank2]:2025-10-29 08:40:23,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0840_stage2_step700.svg
[rank1]:2025-10-29 08:40:23,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0840_stage1_step700.svg
[rank3]:2025-10-29 08:40:23,277 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0840_real_step700_rank3.svg
[rank3]:> Batch Time: 376.06 ms, GPU Bubble Ratio: 67.26%, 22.94%, 33.45%, 23.91%
[rank3]:2025-10-29 08:40:23,345 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0840_stage3_step700.svg
[rank3]:2025-10-29 08:40:23,591 - INFO - Avg. fwd time: 16.5719 / Avg. bwd time: 22.4496 / Avg. batch time: 327.6784 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 08:40:23,671 - INFO - Avg. fwd time: 17.3858 / Avg. bwd time: 21.9245 / Avg. batch time: 416.3300 (ms) / GPU bubble ratio: 24.46%
[rank2]:2025-10-29 08:40:23,612 - INFO - Avg. fwd time: 14.9633 / Avg. bwd time: 19.1224 / Avg. batch time: 365.9645 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-10-29 08:40:23,792 - INFO - Avg. fwd time: 15.1864 / Avg. bwd time: 12.5901 / Avg. batch time: 453.9376 (ms) / GPU bubble ratio: 51.05%
[rank0]:2025-10-29 08:42:16,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:42:19,020 - INFO -  step: 750  loss:  0.1327  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank0]:2025-10-29 08:42:19,052 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1419  memory: 75.21GiB(53.80%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank2]:2025-10-29 08:42:19,019 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank1]:2025-10-29 08:42:19,019 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank3]:2025-10-29 08:42:19,413 - INFO - Avg. fwd time: 16.5679 / Avg. bwd time: 22.1806 / Avg. batch time: 325.4678 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 08:42:19,442 - INFO - Avg. fwd time: 14.9669 / Avg. bwd time: 18.9098 / Avg. batch time: 364.6683 (ms) / GPU bubble ratio: 25.68%
[rank1]:2025-10-29 08:42:19,522 - INFO - Avg. fwd time: 17.3648 / Avg. bwd time: 21.6555 / Avg. batch time: 418.3510 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 08:42:19,622 - INFO - Avg. fwd time: 15.0927 / Avg. bwd time: 14.4317 / Avg. batch time: 461.4987 (ms) / GPU bubble ratio: 48.82%
[rank0]:2025-10-29 08:44:12,458 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:44:15,105 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank3_trend_line.svg
[rank1]:2025-10-29 08:44:15,104 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank1_trend_line.svg
[rank2]:2025-10-29 08:44:15,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank2_trend_line.svg
[rank0]:2025-10-29 08:44:15,206 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank0_trend_line.svg
[rank0]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:44:15,221 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2231  memory: 75.21GiB(53.80%)  tps: 7,052  tflops: 328.90  mfu: 33.26%
[rank0]:2025-10-29 08:44:15,221 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:44:15,215 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,050  tflops: 328.82  mfu: 33.25%
[rank1]:2025-10-29 08:44:15,215 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.75/0.75, [MB1] 0.78/0.78, [MB2] 0.82/0.82, [MB3] 0.85/0.85, [MB4] 0.89/0.89, [MB5] 0.93/0.93, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:44:15,215 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,050  tflops: 328.82  mfu: 33.25%
[rank2]:2025-10-29 08:44:15,215 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 08:44:15,407 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0844_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.13 ms, GPU Bubble Ratio: 35.14%, 23.95%, 33.01%, 24.57%
[rank3]:2025-10-29 08:44:15,407 - INFO - 	> Batch Time: 357.13 ms (Average Freeze Ratio: 0.75)
[rank3]:2025-10-29 08:44:15,407 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:44:15,414 - INFO -  step: 800  loss:  0.1177  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,038  tflops: 328.27  mfu: 33.19%
[rank3]:2025-10-29 08:44:15,414 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 08:44:31,894 - INFO - validate step: 800  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,568
[rank3]:2025-10-29 08:44:31,949 - INFO - validate step: 800  loss:  0.2351  memory: 84.59GiB(60.50%)  tps: 24,772
[rank2]:2025-10-29 08:44:31,940 - INFO - validate step: 800  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,492
[rank1]:2025-10-29 08:44:31,924 - INFO - validate step: 800  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,514
[rank0]:2025-10-29 08:44:32,028 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0844_stage0_step800.svg
[rank2]:2025-10-29 08:44:32,029 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0844_stage2_step800.svg
[rank1]:2025-10-29 08:44:32,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0844_stage1_step800.svg
[rank3]:2025-10-29 08:44:32,135 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0844_real_step800_rank3.svg
[rank3]:> Batch Time: 373.82 ms, GPU Bubble Ratio: 67.27%, 22.95%, 33.20%, 23.90%
[rank3]:2025-10-29 08:44:32,207 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0844_stage3_step800.svg
[rank3]:2025-10-29 08:44:32,456 - INFO - Avg. fwd time: 16.5640 / Avg. bwd time: 21.9797 / Avg. batch time: 323.8109 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 08:44:32,477 - INFO - Avg. fwd time: 14.9691 / Avg. bwd time: 18.7508 / Avg. batch time: 363.6510 (ms) / GPU bubble ratio: 25.82%
[rank1]:2025-10-29 08:44:32,537 - INFO - Avg. fwd time: 17.3476 / Avg. bwd time: 21.4539 / Avg. batch time: 419.8287 (ms) / GPU bubble ratio: 26.06%
[rank0]:2025-10-29 08:44:32,655 - INFO - Avg. fwd time: 15.0208 / Avg. bwd time: 15.8175 / Avg. batch time: 467.1470 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-29 08:45:48,699 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:45:50,259 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,454  tflops: 487.56  mfu: 49.30%
[rank2]:2025-10-29 08:45:50,257 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,460  tflops: 487.86  mfu: 49.33%
[rank1]:2025-10-29 08:45:50,260 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,458  tflops: 487.74  mfu: 49.32%
[rank3]:2025-10-29 08:45:50,259 - INFO -  step: 850  loss:  0.1432  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,461  tflops: 487.92  mfu: 49.33%
[rank0]:2025-10-29 08:45:50,344 - INFO - Avg. fwd time: 15.0311 / Avg. bwd time: 15.0672 / Avg. batch time: 463.0305 (ms) / GPU bubble ratio: 48.00%
[rank2]:2025-10-29 08:45:50,567 - INFO - Avg. fwd time: 14.9729 / Avg. bwd time: 18.5867 / Avg. batch time: 361.6454 (ms) / GPU bubble ratio: 25.76%
[rank3]:2025-10-29 08:45:50,546 - INFO - Avg. fwd time: 16.5645 / Avg. bwd time: 21.7751 / Avg. batch time: 322.1602 (ms) / GPU bubble ratio: 4.79%
[rank1]:2025-10-29 08:45:50,592 - INFO - Avg. fwd time: 17.3480 / Avg. bwd time: 21.2714 / Avg. batch time: 417.0663 (ms) / GPU bubble ratio: 25.92%
[rank0]:2025-10-29 08:47:06,560 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:47:08,102 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank1]:2025-10-29 08:47:08,103 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank2]:2025-10-29 08:47:08,100 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank3]:2025-10-29 08:47:08,101 - INFO -  step: 900  loss:  0.1284  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 08:47:08,174 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0847_stage0_step900.svg
[rank2]:2025-10-29 08:47:08,173 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0847_stage2_step900.svg
[rank1]:2025-10-29 08:47:08,174 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0847_stage1_step900.svg
[rank3]:2025-10-29 08:47:08,280 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0847_real_step900_rank3.svg
[rank3]:> Batch Time: 372.90 ms, GPU Bubble Ratio: 67.18%, 22.83%, 33.11%, 23.95%
[rank3]:2025-10-29 08:47:08,340 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0847_stage3_step900.svg
[rank3]:2025-10-29 08:47:08,647 - INFO - Avg. fwd time: 16.5641 / Avg. bwd time: 21.5946 / Avg. batch time: 320.6961 (ms) / GPU bubble ratio: 4.81%
[rank0]:2025-10-29 08:47:08,702 - INFO - Avg. fwd time: 15.0452 / Avg. bwd time: 14.1887 / Avg. batch time: 458.4033 (ms) / GPU bubble ratio: 48.98%
[rank1]:2025-10-29 08:47:08,696 - INFO - Avg. fwd time: 17.3508 / Avg. bwd time: 21.1140 / Avg. batch time: 414.1940 (ms) / GPU bubble ratio: 25.71%
[rank2]:2025-10-29 08:47:08,671 - INFO - Avg. fwd time: 14.9758 / Avg. bwd time: 18.4421 / Avg. batch time: 359.7671 (ms) / GPU bubble ratio: 25.69%
[rank0]:2025-10-29 08:48:24,586 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:48:26,136 - INFO -  step: 950  loss:  0.1557  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank1]:2025-10-29 08:48:26,137 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,498  tflops: 489.62  mfu: 49.51%
[rank0]:2025-10-29 08:48:26,137 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank2]:2025-10-29 08:48:26,135 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank0]:2025-10-29 08:48:26,224 - INFO - Avg. fwd time: 15.0557 / Avg. bwd time: 13.5134 / Avg. batch time: 454.8272 (ms) / GPU bubble ratio: 49.75%
[rank3]:2025-10-29 08:48:26,426 - INFO - Avg. fwd time: 16.5648 / Avg. bwd time: 21.4561 / Avg. batch time: 319.5822 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 08:48:26,473 - INFO - Avg. fwd time: 17.3537 / Avg. bwd time: 20.9934 / Avg. batch time: 411.9694 (ms) / GPU bubble ratio: 25.53%
[rank2]:2025-10-29 08:48:26,448 - INFO - Avg. fwd time: 14.9784 / Avg. bwd time: 18.3309 / Avg. batch time: 358.3066 (ms) / GPU bubble ratio: 25.63%
[rank0]:2025-10-29 08:49:42,376 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:49:43,926 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank2]:2025-10-29 08:49:43,924 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank1]:2025-10-29 08:49:43,927 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank0]:2025-10-29 08:49:43,926 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 08:49:43,924 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 08:49:43,927 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 08:49:43,925 - INFO -  step: 1000  loss:  0.1286  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,531  tflops: 491.18  mfu: 49.66%
[rank3]:2025-10-29 08:49:43,926 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 08:50:00,927 - INFO - validate step: 1000  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,093
[rank1]:2025-10-29 08:50:00,966 - INFO - validate step: 1000  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,039
[rank2]:2025-10-29 08:50:00,981 - INFO - validate step: 1000  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,014
[rank3]:2025-10-29 08:50:00,991 - INFO - validate step: 1000  loss:  0.2341  memory: 84.59GiB(60.50%)  tps: 24,003
[rank0]:2025-10-29 08:50:01,066 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0850_stage0_step1000.svg
[rank2]:2025-10-29 08:50:01,067 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0850_stage2_step1000.svg
[rank1]:2025-10-29 08:50:01,064 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0850_stage1_step1000.svg
[rank0]:2025-10-29 08:50:01,155 - INFO - Avg. fwd time: 15.0645 / Avg. bwd time: 12.8025 / Avg. batch time: 451.0396 (ms) / GPU bubble ratio: 50.57%
[rank3]:2025-10-29 08:50:01,172 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0850_real_step1000_rank3.svg
[rank3]:> Batch Time: 372.57 ms, GPU Bubble Ratio: 67.16%, 22.78%, 33.09%, 23.98%
[rank3]:2025-10-29 08:50:01,234 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0850_stage3_step1000.svg
[rank2]:2025-10-29 08:50:01,499 - INFO - Avg. fwd time: 14.9798 / Avg. bwd time: 18.2142 / Avg. batch time: 356.7456 (ms) / GPU bubble ratio: 25.56%
[rank3]:2025-10-29 08:50:01,478 - INFO - Avg. fwd time: 16.5634 / Avg. bwd time: 21.3096 / Avg. batch time: 318.3864 (ms) / GPU bubble ratio: 4.84%
[rank1]:2025-10-29 08:50:01,525 - INFO - Avg. fwd time: 17.3554 / Avg. bwd time: 20.8664 / Avg. batch time: 409.6052 (ms) / GPU bubble ratio: 25.35%
[rank0]:2025-10-29 08:51:17,431 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:51:18,986 - INFO -  step: 1050  loss:  0.1343  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.89  mfu: 49.53%
[rank1]:2025-10-29 08:51:18,987 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.71  mfu: 49.52%
[rank2]:2025-10-29 08:51:18,985 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,502  tflops: 489.82  mfu: 49.53%
[rank0]:2025-10-29 08:51:18,987 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,495  tflops: 489.47  mfu: 49.49%
[rank2]:2025-10-29 08:51:19,369 - INFO - Avg. fwd time: 14.9812 / Avg. bwd time: 18.1091 / Avg. batch time: 355.3743 (ms) / GPU bubble ratio: 25.51%
[rank3]:2025-10-29 08:51:19,345 - INFO - Avg. fwd time: 16.5630 / Avg. bwd time: 21.1775 / Avg. batch time: 317.3145 (ms) / GPU bubble ratio: 4.85%
[rank1]:2025-10-29 08:51:19,395 - INFO - Avg. fwd time: 17.3572 / Avg. bwd time: 20.7516 / Avg. batch time: 407.5103 (ms) / GPU bubble ratio: 25.19%
[rank0]:2025-10-29 08:51:19,403 - INFO - Avg. fwd time: 15.0739 / Avg. bwd time: 12.1627 / Avg. batch time: 447.6654 (ms) / GPU bubble ratio: 51.33%
[rank0]:2025-10-29 08:52:35,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:52:36,815 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,526  tflops: 490.91  mfu: 49.64%
[rank0]:2025-10-29 08:52:36,816 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,526  tflops: 490.92  mfu: 49.64%
[rank1]:2025-10-29 08:52:36,817 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,526  tflops: 490.91  mfu: 49.64%
[rank3]:2025-10-29 08:52:36,816 - INFO -  step: 1100  loss:  0.1026  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,526  tflops: 490.92  mfu: 49.64%
[rank2]:2025-10-29 08:52:36,892 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0852_stage2_step1100.svg
[rank0]:2025-10-29 08:52:36,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0852_stage0_step1100.svg
[rank1]:2025-10-29 08:52:36,889 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0852_stage1_step1100.svg
[rank0]:2025-10-29 08:52:36,977 - INFO - Avg. fwd time: 15.0810 / Avg. bwd time: 11.6632 / Avg. batch time: 445.0133 (ms) / GPU bubble ratio: 51.92%
[rank3]:2025-10-29 08:52:37,006 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0852_real_step1100_rank3.svg
[rank3]:> Batch Time: 372.23 ms, GPU Bubble Ratio: 67.16%, 22.71%, 33.05%, 23.99%
[rank3]:2025-10-29 08:52:37,071 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0852_stage3_step1100.svg
[rank2]:2025-10-29 08:52:37,338 - INFO - Avg. fwd time: 14.9828 / Avg. bwd time: 18.0273 / Avg. batch time: 354.2851 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-10-29 08:52:37,317 - INFO - Avg. fwd time: 16.5631 / Avg. bwd time: 21.0744 / Avg. batch time: 316.4821 (ms) / GPU bubble ratio: 4.86%
[rank1]:2025-10-29 08:52:37,363 - INFO - Avg. fwd time: 17.3590 / Avg. bwd time: 20.6622 / Avg. batch time: 405.8581 (ms) / GPU bubble ratio: 25.06%
[rank0]:2025-10-29 08:53:53,237 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:53:54,807 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,504  tflops: 489.90  mfu: 49.53%
[rank1]:2025-10-29 08:53:54,808 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,504  tflops: 489.90  mfu: 49.54%
[rank2]:2025-10-29 08:53:54,805 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,504  tflops: 489.90  mfu: 49.54%
[rank3]:2025-10-29 08:53:54,806 - INFO -  step: 1150  loss:  0.1231  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.91  mfu: 49.54%
[rank0]:2025-10-29 08:53:54,895 - INFO - Avg. fwd time: 15.0883 / Avg. bwd time: 11.1298 / Avg. batch time: 442.1998 (ms) / GPU bubble ratio: 52.57%
[rank3]:2025-10-29 08:53:55,102 - INFO - Avg. fwd time: 16.5627 / Avg. bwd time: 20.9641 / Avg. batch time: 315.5867 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 08:53:55,123 - INFO - Avg. fwd time: 14.9842 / Avg. bwd time: 17.9391 / Avg. batch time: 353.1429 (ms) / GPU bubble ratio: 25.42%
[rank1]:2025-10-29 08:53:55,149 - INFO - Avg. fwd time: 17.3605 / Avg. bwd time: 20.5663 / Avg. batch time: 404.1126 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-10-29 08:55:11,080 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:55:12,655 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank1]:2025-10-29 08:55:12,655 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 08:55:12,655 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank0]:2025-10-29 08:55:12,655 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 08:55:12,653 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank2]:2025-10-29 08:55:12,653 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 08:55:12,654 - INFO -  step: 1200  loss:  0.1066  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,523  tflops: 490.81  mfu: 49.63%
[rank3]:2025-10-29 08:55:12,654 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 08:55:29,371 - INFO - validate step: 1200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,504
[rank0]:2025-10-29 08:55:29,371 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 08:55:29,375 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 08:55:29,435 - INFO - validate step: 1200  loss:  0.2358  memory: 84.59GiB(60.50%)  tps: 24,410
[rank3]:2025-10-29 08:55:29,436 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 08:55:29,408 - INFO - validate step: 1200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,450
[rank1]:2025-10-29 08:55:29,409 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:55:29,424 - INFO - validate step: 1200  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,424
[rank2]:2025-10-29 08:55:29,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:55:41,875 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.45 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 08:55:43,788 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.35 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 08:55:44,878 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.47 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 08:55:47,187 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 08:55:47,192 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.82 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank0]:2025-10-29 08:55:47,321 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0855_stage0_step1200.svg
[rank0]:2025-10-29 08:55:47,331 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 08:55:47,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0855_stage1_step1200.svg
[rank1]:2025-10-29 08:55:47,334 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 08:55:47,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0855_stage2_step1200.svg
[rank2]:2025-10-29 08:55:47,334 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 08:55:47,433 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0855_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.99 ms, GPU Bubble Ratio: 67.17%, 22.67%, 33.04%, 23.98%
[rank3]:2025-10-29 08:55:47,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0855_stage3_step1200.svg
[rank3]:2025-10-29 08:55:47,512 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 08:55:47,834 - INFO - Avg. fwd time: 16.5636 / Avg. bwd time: 20.8646 / Avg. batch time: 314.7891 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 08:55:47,886 - INFO - Avg. fwd time: 17.3634 / Avg. bwd time: 20.4789 / Avg. batch time: 402.5404 (ms) / GPU bubble ratio: 24.79%
[rank2]:2025-10-29 08:55:47,859 - INFO - Avg. fwd time: 14.9864 / Avg. bwd time: 17.8590 / Avg. batch time: 352.1228 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 08:55:47,895 - INFO - Avg. fwd time: 15.0963 / Avg. bwd time: 10.6432 / Avg. batch time: 439.6551 (ms) / GPU bubble ratio: 53.16%
[rank0]:2025-10-29 08:57:12,198 - INFO - [GC] Peforming periodical GC collection 2.50 seconds
[rank3]:2025-10-29 08:57:13,862 - INFO -  step: 1250  loss:  0.8541  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,845  tflops: 365.89  mfu: 37.00%
[rank1]:2025-10-29 08:57:13,863 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,843  tflops: 365.78  mfu: 36.99%
[rank0]:2025-10-29 08:57:13,863 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank2]:2025-10-29 08:57:13,860 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,844  tflops: 365.85  mfu: 36.99%
[rank0]:2025-10-29 08:57:13,962 - INFO - Avg. fwd time: 15.1277 / Avg. bwd time: 10.2587 / Avg. batch time: 438.2348 (ms) / GPU bubble ratio: 53.66%
[rank3]:2025-10-29 08:57:14,182 - INFO - Avg. fwd time: 16.5938 / Avg. bwd time: 20.8113 / Avg. batch time: 314.6504 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 08:57:14,229 - INFO - Avg. fwd time: 17.3907 / Avg. bwd time: 20.4190 / Avg. batch time: 401.8624 (ms) / GPU bubble ratio: 24.73%
[rank2]:2025-10-29 08:57:14,203 - INFO - Avg. fwd time: 15.0080 / Avg. bwd time: 17.8060 / Avg. batch time: 351.8957 (ms) / GPU bubble ratio: 25.40%
[rank0]:2025-10-29 08:58:35,195 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:58:36,851 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank0]:2025-10-29 08:58:36,853 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank1]:2025-10-29 08:58:36,853 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank3]:2025-10-29 08:58:36,852 - INFO -  step: 1300  loss:  0.8901  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank2]:2025-10-29 08:58:36,931 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0858_stage2_step1300.svg
[rank0]:2025-10-29 08:58:36,930 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0858_stage0_step1300.svg
[rank1]:2025-10-29 08:58:36,928 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0858_stage1_step1300.svg
[rank3]:2025-10-29 08:58:37,046 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0858_real_step1300_rank3.svg
[rank3]:> Batch Time: 373.00 ms, GPU Bubble Ratio: 67.14%, 22.72%, 33.09%, 23.99%
[rank0]:2025-10-29 08:58:37,029 - INFO - Avg. fwd time: 15.1616 / Avg. bwd time: 9.8438 / Avg. batch time: 436.5543 (ms) / GPU bubble ratio: 54.18%
[rank3]:2025-10-29 08:58:37,115 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0858_stage3_step1300.svg
[rank3]:2025-10-29 08:58:37,385 - INFO - Avg. fwd time: 16.6266 / Avg. bwd time: 20.7536 / Avg. batch time: 314.4480 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 08:58:37,407 - INFO - Avg. fwd time: 15.0320 / Avg. bwd time: 17.7493 / Avg. batch time: 351.5043 (ms) / GPU bubble ratio: 25.39%
[rank1]:2025-10-29 08:58:37,433 - INFO - Avg. fwd time: 17.4230 / Avg. bwd time: 20.3572 / Avg. batch time: 400.9916 (ms) / GPU bubble ratio: 24.63%
[rank0]:2025-10-29 08:59:58,213 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:59:59,881 - INFO -  step: 1350  loss:  0.8666  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank0]:2025-10-29 08:59:59,882 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank2]:2025-10-29 08:59:59,880 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank1]:2025-10-29 08:59:59,882 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank3]:2025-10-29 09:00:00,268 - INFO - Avg. fwd time: 16.6564 / Avg. bwd time: 20.6999 / Avg. batch time: 314.2545 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 09:00:00,330 - INFO - Avg. fwd time: 15.1921 / Avg. bwd time: 9.4612 / Avg. batch time: 435.0252 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-10-29 09:00:00,321 - INFO - Avg. fwd time: 17.4527 / Avg. bwd time: 20.3003 / Avg. batch time: 400.2097 (ms) / GPU bubble ratio: 24.53%
[rank2]:2025-10-29 09:00:00,293 - INFO - Avg. fwd time: 15.0535 / Avg. bwd time: 17.6973 / Avg. batch time: 351.1636 (ms) / GPU bubble ratio: 25.39%
[rank0]:2025-10-29 09:01:21,205 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:01:22,869 - INFO -  step: 1400  loss:  0.9290  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,871  tflops: 460.41  mfu: 46.55%
[rank3]:2025-10-29 09:01:22,869 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 09:01:22,868 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank2]:2025-10-29 09:01:22,868 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 09:01:22,870 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank0]:2025-10-29 09:01:22,870 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank1]:2025-10-29 09:01:22,870 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 09:01:22,870 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 09:01:39,627 - INFO - validate step: 1400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,441
[rank1]:2025-10-29 09:01:39,611 - INFO - validate step: 1400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,468
[rank0]:2025-10-29 09:01:39,571 - INFO - validate step: 1400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,525
[rank3]:2025-10-29 09:01:39,638 - INFO - validate step: 1400  loss:  0.2334  memory: 84.59GiB(60.50%)  tps: 24,427
[rank2]:2025-10-29 09:01:39,722 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0901_stage2_step1400.svg
[rank1]:2025-10-29 09:01:39,719 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0901_stage1_step1400.svg
[rank0]:2025-10-29 09:01:39,719 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0901_stage0_step1400.svg
[rank0]:2025-10-29 09:01:39,819 - INFO - Avg. fwd time: 15.2162 / Avg. bwd time: 9.1562 / Avg. batch time: 433.7855 (ms) / GPU bubble ratio: 55.05%
[rank3]:2025-10-29 09:01:39,831 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0901_real_step1400_rank3.svg
[rank3]:> Batch Time: 374.03 ms, GPU Bubble Ratio: 67.12%, 22.75%, 33.15%, 23.99%
[rank3]:2025-10-29 09:01:39,902 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0901_stage3_step1400.svg
[rank3]:2025-10-29 09:01:40,173 - INFO - Avg. fwd time: 16.6802 / Avg. bwd time: 20.6571 / Avg. batch time: 314.1007 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 09:01:40,194 - INFO - Avg. fwd time: 15.0708 / Avg. bwd time: 17.6556 / Avg. batch time: 350.8697 (ms) / GPU bubble ratio: 25.38%
[rank1]:2025-10-29 09:01:40,221 - INFO - Avg. fwd time: 17.4761 / Avg. bwd time: 20.2549 / Avg. batch time: 399.5633 (ms) / GPU bubble ratio: 24.46%
[rank0]:2025-10-29 09:03:01,010 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:03:02,667 - INFO -  step: 1450  loss:  0.9559  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank1]:2025-10-29 09:03:02,668 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank2]:2025-10-29 09:03:02,666 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank0]:2025-10-29 09:03:02,668 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,858  tflops: 459.80  mfu: 46.49%
[rank0]:2025-10-29 09:03:02,771 - INFO - Avg. fwd time: 15.2425 / Avg. bwd time: 8.8242 / Avg. batch time: 432.4548 (ms) / GPU bubble ratio: 55.48%
[rank3]:2025-10-29 09:03:02,984 - INFO - Avg. fwd time: 16.7063 / Avg. bwd time: 20.6101 / Avg. batch time: 313.9308 (ms) / GPU bubble ratio: 4.91%
[rank1]:2025-10-29 09:03:03,034 - INFO - Avg. fwd time: 17.5011 / Avg. bwd time: 20.2053 / Avg. batch time: 398.8816 (ms) / GPU bubble ratio: 24.38%
[rank2]:2025-10-29 09:03:03,007 - INFO - Avg. fwd time: 15.0896 / Avg. bwd time: 17.6105 / Avg. batch time: 350.5712 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 09:04:23,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:04:25,532 - INFO -  step: 1500  loss:  0.8341  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,886  tflops: 461.09  mfu: 46.62%
[rank1]:2025-10-29 09:04:25,533 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,886  tflops: 461.08  mfu: 46.62%
[rank2]:2025-10-29 09:04:25,531 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,886  tflops: 461.08  mfu: 46.62%
[rank0]:2025-10-29 09:04:25,533 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,886  tflops: 461.09  mfu: 46.62%
[rank1]:2025-10-29 09:04:25,612 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0904_stage1_step1500.svg
[rank2]:2025-10-29 09:04:25,614 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0904_stage2_step1500.svg
[rank0]:2025-10-29 09:04:25,613 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0904_stage0_step1500.svg
[rank3]:2025-10-29 09:04:25,722 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0904_real_step1500_rank3.svg
[rank3]:> Batch Time: 375.12 ms, GPU Bubble Ratio: 67.12%, 22.79%, 33.22%, 23.97%
[rank3]:2025-10-29 09:04:25,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0904_stage3_step1500.svg
[rank3]:2025-10-29 09:04:26,130 - INFO - Avg. fwd time: 16.7302 / Avg. bwd time: 20.5667 / Avg. batch time: 313.7723 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:04:26,156 - INFO - Avg. fwd time: 15.1067 / Avg. bwd time: 17.5689 / Avg. batch time: 350.2937 (ms) / GPU bubble ratio: 25.38%
[rank1]:2025-10-29 09:04:26,184 - INFO - Avg. fwd time: 17.5245 / Avg. bwd time: 20.1597 / Avg. batch time: 398.2493 (ms) / GPU bubble ratio: 24.30%
[rank0]:2025-10-29 09:04:26,193 - INFO - Avg. fwd time: 15.2665 / Avg. bwd time: 8.5156 / Avg. batch time: 431.2194 (ms) / GPU bubble ratio: 55.88%
[rank0]:2025-10-29 09:05:46,937 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:05:48,591 - INFO -  step: 1550  loss:  0.9017  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 09:05:48,592 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank1]:2025-10-29 09:05:48,593 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank2]:2025-10-29 09:05:48,590 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 09:05:48,692 - INFO - Avg. fwd time: 15.2861 / Avg. bwd time: 8.2677 / Avg. batch time: 430.2120 (ms) / GPU bubble ratio: 56.20%
[rank3]:2025-10-29 09:05:48,907 - INFO - Avg. fwd time: 16.7498 / Avg. bwd time: 20.5321 / Avg. batch time: 313.6516 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:05:48,929 - INFO - Avg. fwd time: 15.1209 / Avg. bwd time: 17.5353 / Avg. batch time: 350.0583 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 09:05:48,956 - INFO - Avg. fwd time: 17.5440 / Avg. bwd time: 20.1226 / Avg. batch time: 397.7268 (ms) / GPU bubble ratio: 24.24%
[rank0]:2025-10-29 09:07:08,751 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:07:11,063 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank2_trend_line.svg
[rank0]:2025-10-29 09:07:11,081 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank0_trend_line.svg
[rank1]:2025-10-29 09:07:11,085 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank1_trend_line.svg
[rank3]:2025-10-29 09:07:11,123 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank3_trend_line.svg
[rank2]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.77/0.77, [MB2] 0.81/0.81, [MB3] 0.85/0.85, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 09:07:11,134 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,924  tflops: 462.88  mfu: 46.80%
[rank2]:2025-10-29 09:07:11,134 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 09:07:11,134 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,925  tflops: 462.89  mfu: 46.80%
[rank0]:2025-10-29 09:07:11,134 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 09:07:11,135 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,925  tflops: 462.89  mfu: 46.80%
[rank1]:2025-10-29 09:07:11,135 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 09:07:11,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0907_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.39 ms, GPU Bubble Ratio: 53.15%, 23.50%, 33.06%, 24.40%
[rank3]:2025-10-29 09:07:11,327 - INFO - 	> Batch Time: 357.39 ms (Average Freeze Ratio: 0.75)
[rank3]:2025-10-29 09:07:11,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 09:07:11,336 - INFO -  step: 1600  loss:  0.1197  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,900  tflops: 461.76  mfu: 46.69%
[rank3]:2025-10-29 09:07:11,336 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 09:07:28,036 - INFO - validate step: 1600  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,236
[rank0]:2025-10-29 09:07:27,997 - INFO - validate step: 1600  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,290
[rank3]:2025-10-29 09:07:28,062 - INFO - validate step: 1600  loss:  0.2361  memory: 84.59GiB(60.50%)  tps: 24,490
[rank2]:2025-10-29 09:07:28,050 - INFO - validate step: 1600  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,214
[rank0]:2025-10-29 09:07:28,142 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0907_stage0_step1600.svg
[rank2]:2025-10-29 09:07:28,149 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0907_stage2_step1600.svg
[rank1]:2025-10-29 09:07:28,146 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0907_stage1_step1600.svg
[rank0]:2025-10-29 09:07:28,229 - INFO - Avg. fwd time: 15.3031 / Avg. bwd time: 7.9961 / Avg. batch time: 429.0191 (ms) / GPU bubble ratio: 56.55%
[rank3]:2025-10-29 09:07:28,251 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0907_real_step1600_rank3.svg
[rank3]:> Batch Time: 376.14 ms, GPU Bubble Ratio: 67.12%, 22.84%, 33.28%, 23.94%
[rank3]:2025-10-29 09:07:28,323 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0907_stage3_step1600.svg
[rank3]:2025-10-29 09:07:28,574 - INFO - Avg. fwd time: 16.7656 / Avg. bwd time: 20.4896 / Avg. batch time: 313.4351 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:07:28,595 - INFO - Avg. fwd time: 15.1326 / Avg. bwd time: 17.4970 / Avg. batch time: 349.7115 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-10-29 09:07:28,624 - INFO - Avg. fwd time: 17.5606 / Avg. bwd time: 20.0805 / Avg. batch time: 397.0680 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-10-29 09:08:44,481 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:08:46,030 - INFO -  step: 1650  loss:  0.1139  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank2]:2025-10-29 09:08:46,029 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank1]:2025-10-29 09:08:46,032 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank0]:2025-10-29 09:08:46,031 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank3]:2025-10-29 09:08:46,388 - INFO - Avg. fwd time: 16.7594 / Avg. bwd time: 20.4318 / Avg. batch time: 312.9162 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 09:08:46,414 - INFO - Avg. fwd time: 15.1296 / Avg. bwd time: 17.4527 / Avg. batch time: 349.0716 (ms) / GPU bubble ratio: 25.33%
[rank1]:2025-10-29 09:08:46,442 - INFO - Avg. fwd time: 17.5553 / Avg. bwd time: 20.0319 / Avg. batch time: 396.1409 (ms) / GPU bubble ratio: 24.09%
[rank0]:2025-10-29 09:08:46,453 - INFO - Avg. fwd time: 15.3018 / Avg. bwd time: 7.7419 / Avg. batch time: 427.5796 (ms) / GPU bubble ratio: 56.89%
[rank0]:2025-10-29 09:10:02,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:10:03,808 - INFO -  step: 1700  loss:  0.1215  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:10:03,810 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank0]:2025-10-29 09:10:03,809 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank2]:2025-10-29 09:10:03,807 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank1]:2025-10-29 09:10:03,888 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0910_stage1_step1700.svg
[rank0]:2025-10-29 09:10:03,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0910_stage0_step1700.svg
[rank0]:2025-10-29 09:10:03,979 - INFO - Avg. fwd time: 15.2999 / Avg. bwd time: 7.5365 / Avg. batch time: 426.3883 (ms) / GPU bubble ratio: 57.15%
[rank2]:2025-10-29 09:10:03,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0910_stage2_step1700.svg
[rank3]:2025-10-29 09:10:04,002 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0910_real_step1700_rank3.svg
[rank3]:> Batch Time: 375.43 ms, GPU Bubble Ratio: 67.11%, 22.78%, 33.22%, 23.97%
[rank3]:2025-10-29 09:10:04,073 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0910_stage3_step1700.svg
[rank3]:2025-10-29 09:10:04,317 - INFO - Avg. fwd time: 16.7539 / Avg. bwd time: 20.3848 / Avg. batch time: 312.4913 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 09:10:04,364 - INFO - Avg. fwd time: 17.5504 / Avg. bwd time: 19.9920 / Avg. batch time: 395.3647 (ms) / GPU bubble ratio: 24.03%
[rank2]:2025-10-29 09:10:04,338 - INFO - Avg. fwd time: 15.1266 / Avg. bwd time: 17.4172 / Avg. batch time: 348.5310 (ms) / GPU bubble ratio: 25.30%
[rank0]:2025-10-29 09:11:20,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:11:21,775 - INFO -  step: 1750  loss:  0.1251  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,507  tflops: 490.06  mfu: 49.55%
[rank1]:2025-10-29 09:11:21,776 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank0]:2025-10-29 09:11:21,776 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank2]:2025-10-29 09:11:21,774 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank0]:2025-10-29 09:11:21,866 - INFO - Avg. fwd time: 15.2983 / Avg. bwd time: 7.3102 / Avg. batch time: 425.1046 (ms) / GPU bubble ratio: 57.45%
[rank3]:2025-10-29 09:11:22,069 - INFO - Avg. fwd time: 16.7482 / Avg. bwd time: 20.3332 / Avg. batch time: 312.0257 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 09:11:22,116 - INFO - Avg. fwd time: 17.5456 / Avg. bwd time: 19.9492 / Avg. batch time: 394.5380 (ms) / GPU bubble ratio: 23.97%
[rank2]:2025-10-29 09:11:22,090 - INFO - Avg. fwd time: 15.1235 / Avg. bwd time: 17.3781 / Avg. batch time: 347.9577 (ms) / GPU bubble ratio: 25.27%
[rank0]:2025-10-29 09:12:37,969 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 09:12:39,516 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank1]:2025-10-29 09:12:39,516 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 09:12:39,515 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank0]:2025-10-29 09:12:39,515 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 09:12:39,513 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank2]:2025-10-29 09:12:39,513 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 09:12:39,514 - INFO -  step: 1800  loss:  0.1005  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,538  tflops: 491.50  mfu: 49.70%
[rank3]:2025-10-29 09:12:39,514 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 09:12:56,233 - INFO - validate step: 1800  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,501
[rank1]:2025-10-29 09:12:56,271 - INFO - validate step: 1800  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,446
[rank2]:2025-10-29 09:12:56,287 - INFO - validate step: 1800  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,420
[rank3]:2025-10-29 09:12:56,301 - INFO - validate step: 1800  loss:  0.2343  memory: 84.59GiB(60.50%)  tps: 24,402
[rank1]:2025-10-29 09:12:56,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0912_stage1_step1800.svg
[rank0]:2025-10-29 09:12:56,385 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0912_stage0_step1800.svg
[rank2]:2025-10-29 09:12:56,388 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0912_stage2_step1800.svg
[rank3]:2025-10-29 09:12:56,485 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0912_real_step1800_rank3.svg
[rank3]:> Batch Time: 374.95 ms, GPU Bubble Ratio: 67.12%, 22.75%, 33.19%, 23.99%
[rank3]:2025-10-29 09:12:56,553 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0912_stage3_step1800.svg
[rank3]:2025-10-29 09:12:56,867 - INFO - Avg. fwd time: 16.7421 / Avg. bwd time: 20.2845 / Avg. batch time: 311.5821 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 09:12:56,934 - INFO - Avg. fwd time: 15.2964 / Avg. bwd time: 7.0971 / Avg. batch time: 423.8862 (ms) / GPU bubble ratio: 57.74%
[rank1]:2025-10-29 09:12:56,923 - INFO - Avg. fwd time: 17.5405 / Avg. bwd time: 19.9085 / Avg. batch time: 393.7494 (ms) / GPU bubble ratio: 23.91%
[rank2]:2025-10-29 09:12:56,894 - INFO - Avg. fwd time: 15.1201 / Avg. bwd time: 17.3413 / Avg. batch time: 347.4109 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 09:14:12,761 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:14:14,313 - INFO -  step: 1850  loss:  0.0802  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,501  tflops: 489.77  mfu: 49.52%
[rank0]:2025-10-29 09:14:14,314 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,492  tflops: 489.34  mfu: 49.48%
[rank0]:2025-10-29 09:14:14,404 - INFO - Avg. fwd time: 15.2954 / Avg. bwd time: 6.9241 / Avg. batch time: 422.8903 (ms) / GPU bubble ratio: 57.97%
[rank1]:2025-10-29 09:14:14,314 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,497  tflops: 489.57  mfu: 49.50%
[rank2]:2025-10-29 09:14:14,312 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,499  tflops: 489.69  mfu: 49.51%
[rank3]:2025-10-29 09:14:14,610 - INFO - Avg. fwd time: 16.7379 / Avg. bwd time: 20.2456 / Avg. batch time: 311.2322 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 09:14:14,655 - INFO - Avg. fwd time: 17.5370 / Avg. bwd time: 19.8753 / Avg. batch time: 393.1028 (ms) / GPU bubble ratio: 23.86%
[rank2]:2025-10-29 09:14:14,631 - INFO - Avg. fwd time: 15.1178 / Avg. bwd time: 17.3112 / Avg. batch time: 346.9621 (ms) / GPU bubble ratio: 25.23%
[rank0]:2025-10-29 09:15:30,528 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:15:32,086 - INFO -  step: 1900  loss:  0.0954  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.28  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,087 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,172 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0915_stage0_step1900.svg
[rank1]:2025-10-29 09:15:32,088 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank1]:2025-10-29 09:15:32,170 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0915_stage1_step1900.svg
[rank2]:2025-10-29 09:15:32,085 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,261 - INFO - Avg. fwd time: 15.2936 / Avg. bwd time: 6.7326 / Avg. batch time: 421.7799 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-10-29 09:15:32,173 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0915_stage2_step1900.svg
[rank3]:2025-10-29 09:15:32,279 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0915_real_step1900_rank3.svg
[rank3]:> Batch Time: 374.43 ms, GPU Bubble Ratio: 67.12%, 22.71%, 33.15%, 23.99%
[rank3]:2025-10-29 09:15:32,349 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0915_stage3_step1900.svg
[rank3]:2025-10-29 09:15:32,599 - INFO - Avg. fwd time: 16.7327 / Avg. bwd time: 20.2019 / Avg. batch time: 310.8355 (ms) / GPU bubble ratio: 4.94%
[rank2]:2025-10-29 09:15:32,620 - INFO - Avg. fwd time: 15.1147 / Avg. bwd time: 17.2780 / Avg. batch time: 346.4559 (ms) / GPU bubble ratio: 25.20%
[rank1]:2025-10-29 09:15:32,646 - INFO - Avg. fwd time: 17.5329 / Avg. bwd time: 19.8389 / Avg. batch time: 392.3795 (ms) / GPU bubble ratio: 23.80%
[rank0]:2025-10-29 09:16:48,506 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:16:50,070 - INFO -  step: 1950  loss:  0.1223  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,505  tflops: 489.95  mfu: 49.54%
[rank0]:2025-10-29 09:16:50,071 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,505  tflops: 489.94  mfu: 49.54%
[rank2]:2025-10-29 09:16:50,069 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,505  tflops: 489.95  mfu: 49.54%
[rank1]:2025-10-29 09:16:50,072 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,505  tflops: 489.94  mfu: 49.54%
[rank3]:2025-10-29 09:16:50,436 - INFO - Avg. fwd time: 16.7281 / Avg. bwd time: 20.1606 / Avg. batch time: 310.4644 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 09:16:50,507 - INFO - Avg. fwd time: 15.2925 / Avg. bwd time: 6.5515 / Avg. batch time: 420.7556 (ms) / GPU bubble ratio: 58.47%
[rank2]:2025-10-29 09:16:50,464 - INFO - Avg. fwd time: 15.1122 / Avg. bwd time: 17.2462 / Avg. batch time: 345.9983 (ms) / GPU bubble ratio: 25.18%
[rank1]:2025-10-29 09:16:50,495 - INFO - Avg. fwd time: 17.5298 / Avg. bwd time: 19.8048 / Avg. batch time: 391.7201 (ms) / GPU bubble ratio: 23.75%
[rank0]:2025-10-29 09:18:06,278 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:18:07,846 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank0]:2025-10-29 09:18:07,847 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:18:07,848 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:18:07,848 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 09:18:07,848 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 09:18:07,846 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 09:18:07,846 - INFO -  step: 2000  loss:  0.1122  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank3]:2025-10-29 09:18:07,847 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 09:18:24,521 - INFO - validate step: 2000  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,566
[rank2]:2025-10-29 09:18:24,574 - INFO - validate step: 2000  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,486
[rank1]:2025-10-29 09:18:24,559 - INFO - validate step: 2000  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,512
[rank3]:2025-10-29 09:18:24,586 - INFO - validate step: 2000  loss:  0.2351  memory: 84.59GiB(60.50%)  tps: 24,471
[rank2]:2025-10-29 09:18:24,672 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0918_stage2_step2000.svg
[rank0]:2025-10-29 09:18:24,672 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0918_stage0_step2000.svg
[rank1]:2025-10-29 09:18:24,669 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0918_stage1_step2000.svg
[rank0]:2025-10-29 09:18:24,762 - INFO - Avg. fwd time: 15.2909 / Avg. bwd time: 6.4038 / Avg. batch time: 419.8914 (ms) / GPU bubble ratio: 58.67%
[rank3]:2025-10-29 09:18:24,771 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0918_real_step2000_rank3.svg
[rank3]:> Batch Time: 374.06 ms, GPU Bubble Ratio: 67.13%, 22.68%, 33.12%, 23.99%
[rank3]:2025-10-29 09:18:24,841 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0918_stage3_step2000.svg
[rank2]:2025-10-29 09:18:25,118 - INFO - Avg. fwd time: 15.1097 / Avg. bwd time: 17.2203 / Avg. batch time: 345.5981 (ms) / GPU bubble ratio: 25.16%
[rank3]:2025-10-29 09:18:25,097 - INFO - Avg. fwd time: 16.7236 / Avg. bwd time: 20.1264 / Avg. batch time: 310.1499 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 09:18:25,144 - INFO - Avg. fwd time: 17.5261 / Avg. bwd time: 19.7766 / Avg. batch time: 391.1546 (ms) / GPU bubble ratio: 23.71%
[rank0]:2025-10-29 09:19:41,009 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 09:19:42,566 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,504  tflops: 489.89  mfu: 49.53%
[rank1]:2025-10-29 09:19:42,569 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,501  tflops: 489.78  mfu: 49.52%
[rank0]:2025-10-29 09:19:42,568 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,496  tflops: 489.55  mfu: 49.50%
[rank3]:2025-10-29 09:19:42,567 - INFO -  step: 2050  loss:  0.1585  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank0]:2025-10-29 09:19:42,659 - INFO - Avg. fwd time: 15.2902 / Avg. bwd time: 6.2397 / Avg. batch time: 418.9623 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-10-29 09:19:42,881 - INFO - Avg. fwd time: 15.1077 / Avg. bwd time: 17.1917 / Avg. batch time: 345.1876 (ms) / GPU bubble ratio: 25.14%
[rank3]:2025-10-29 09:19:42,860 - INFO - Avg. fwd time: 16.7200 / Avg. bwd time: 20.0892 / Avg. batch time: 309.8187 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 09:19:42,907 - INFO - Avg. fwd time: 17.5231 / Avg. bwd time: 19.7451 / Avg. batch time: 390.5566 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-29 09:20:58,749 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:21:00,294 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank1]:2025-10-29 09:21:00,296 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank0]:2025-10-29 09:21:00,295 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank3]:2025-10-29 09:21:00,295 - INFO -  step: 2100  loss:  0.1390  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank2]:2025-10-29 09:21:00,375 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0921_stage2_step2100.svg
[rank1]:2025-10-29 09:21:00,374 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0921_stage1_step2100.svg
[rank0]:2025-10-29 09:21:00,376 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0921_stage0_step2100.svg
[rank3]:2025-10-29 09:21:00,482 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0921_real_step2100_rank3.svg
[rank3]:> Batch Time: 373.81 ms, GPU Bubble Ratio: 67.14%, 22.67%, 33.11%, 23.99%
[rank3]:2025-10-29 09:21:00,545 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0921_stage3_step2100.svg
[rank3]:2025-10-29 09:21:00,856 - INFO - Avg. fwd time: 16.7158 / Avg. bwd time: 20.0536 / Avg. batch time: 309.4964 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 09:21:00,914 - INFO - Avg. fwd time: 17.5197 / Avg. bwd time: 19.7156 / Avg. batch time: 389.9855 (ms) / GPU bubble ratio: 23.62%
[rank2]:2025-10-29 09:21:00,883 - INFO - Avg. fwd time: 15.1053 / Avg. bwd time: 17.1647 / Avg. batch time: 344.7905 (ms) / GPU bubble ratio: 25.13%
[rank0]:2025-10-29 09:21:00,924 - INFO - Avg. fwd time: 15.2890 / Avg. bwd time: 6.0838 / Avg. batch time: 418.0773 (ms) / GPU bubble ratio: 59.10%
[rank0]:2025-10-29 09:22:16,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 09:22:18,293 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank1]:2025-10-29 09:22:18,293 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank2]:2025-10-29 09:22:18,291 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank3]:2025-10-29 09:22:18,292 - INFO -  step: 2150  loss:  0.1793  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank0]:2025-10-29 09:22:18,385 - INFO - Avg. fwd time: 15.2882 / Avg. bwd time: 5.9563 / Avg. batch time: 417.3456 (ms) / GPU bubble ratio: 59.28%
[rank2]:2025-10-29 09:22:18,611 - INFO - Avg. fwd time: 15.1037 / Avg. bwd time: 17.1428 / Avg. batch time: 344.4580 (ms) / GPU bubble ratio: 25.11%
[rank3]:2025-10-29 09:22:18,590 - INFO - Avg. fwd time: 16.7129 / Avg. bwd time: 20.0245 / Avg. batch time: 309.2371 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 09:22:18,636 - INFO - Avg. fwd time: 17.5179 / Avg. bwd time: 19.6916 / Avg. batch time: 389.5113 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 09:23:34,473 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:23:36,018 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,540  tflops: 491.56  mfu: 49.70%
[rank2]:2025-10-29 09:23:36,018 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 09:23:36,020 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,540  tflops: 491.56  mfu: 49.70%
[rank1]:2025-10-29 09:23:36,020 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 09:23:36,020 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank0]:2025-10-29 09:23:36,020 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 09:23:36,019 - INFO -  step: 2200  loss:  0.1173  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank3]:2025-10-29 09:23:36,019 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 09:23:52,751 - INFO - validate step: 2200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,481
[rank1]:2025-10-29 09:23:52,788 - INFO - validate step: 2200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,429
[rank3]:2025-10-29 09:23:52,817 - INFO - validate step: 2200  loss:  0.2352  memory: 84.59GiB(60.50%)  tps: 24,386
[rank2]:2025-10-29 09:23:52,803 - INFO - validate step: 2200  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,403
[rank2]:2025-10-29 09:23:52,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0923_stage2_step2200.svg
[rank0]:2025-10-29 09:23:52,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0923_stage0_step2200.svg
[rank0]:2025-10-29 09:23:52,990 - INFO - Avg. fwd time: 15.2867 / Avg. bwd time: 5.8141 / Avg. batch time: 416.5144 (ms) / GPU bubble ratio: 59.47%
[rank1]:2025-10-29 09:23:52,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0923_stage1_step2200.svg
[rank3]:2025-10-29 09:23:53,014 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0923_real_step2200_rank3.svg
[rank3]:> Batch Time: 373.53 ms, GPU Bubble Ratio: 67.13%, 22.65%, 33.08%, 23.99%
[rank3]:2025-10-29 09:23:53,080 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0923_stage3_step2200.svg
[rank2]:2025-10-29 09:23:53,351 - INFO - Avg. fwd time: 15.1014 / Avg. bwd time: 17.1183 / Avg. batch time: 344.0747 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 09:23:53,377 - INFO - Avg. fwd time: 17.5146 / Avg. bwd time: 19.6645 / Avg. batch time: 388.9678 (ms) / GPU bubble ratio: 23.53%
[rank3]:2025-10-29 09:23:53,332 - INFO - Avg. fwd time: 16.7085 / Avg. bwd time: 19.9917 / Avg. batch time: 308.9363 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 09:25:09,254 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 09:25:10,809 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,495  tflops: 489.49  mfu: 49.49%
[rank2]:2025-10-29 09:25:10,807 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,502  tflops: 489.82  mfu: 49.53%
[rank1]:2025-10-29 09:25:10,809 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.71  mfu: 49.52%
[rank3]:2025-10-29 09:25:10,808 - INFO -  step: 2250  loss:  0.1420  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.91  mfu: 49.54%
[rank3]:2025-10-29 09:25:11,172 - INFO - Avg. fwd time: 16.7047 / Avg. bwd time: 19.9606 / Avg. batch time: 308.6531 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 09:25:11,247 - INFO - Avg. fwd time: 15.2857 / Avg. bwd time: 5.6785 / Avg. batch time: 415.7446 (ms) / GPU bubble ratio: 59.66%
[rank2]:2025-10-29 09:25:11,202 - INFO - Avg. fwd time: 15.0992 / Avg. bwd time: 17.0948 / Avg. batch time: 343.7293 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 09:25:11,232 - INFO - Avg. fwd time: 17.5115 / Avg. bwd time: 19.6389 / Avg. batch time: 388.4706 (ms) / GPU bubble ratio: 23.49%
[rank0]:2025-10-29 09:26:27,127 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 09:26:28,686 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank2]:2025-10-29 09:26:28,684 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank1]:2025-10-29 09:26:28,686 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank3]:2025-10-29 09:26:28,685 - INFO -  step: 2300  loss:  0.1069  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 09:26:28,765 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0926_stage0_step2300.svg
[rank2]:2025-10-29 09:26:28,766 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0926_stage2_step2300.svg
[rank1]:2025-10-29 09:26:28,762 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0926_stage1_step2300.svg
[rank0]:2025-10-29 09:26:28,855 - INFO - Avg. fwd time: 15.2849 / Avg. bwd time: 5.5673 / Avg. batch time: 415.1059 (ms) / GPU bubble ratio: 59.81%
[rank3]:2025-10-29 09:26:28,876 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0926_real_step2300_rank3.svg
[rank3]:> Batch Time: 373.39 ms, GPU Bubble Ratio: 67.14%, 22.64%, 33.09%, 23.99%
[rank3]:2025-10-29 09:26:28,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0926_stage3_step2300.svg
[rank2]:2025-10-29 09:26:29,211 - INFO - Avg. fwd time: 15.0978 / Avg. bwd time: 17.0757 / Avg. batch time: 343.4407 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 09:26:29,190 - INFO - Avg. fwd time: 16.7022 / Avg. bwd time: 19.9356 / Avg. batch time: 308.4293 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 09:26:29,237 - INFO - Avg. fwd time: 17.5095 / Avg. bwd time: 19.6177 / Avg. batch time: 388.0565 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-10-29 09:27:45,132 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:27:46,705 - INFO -  step: 2350  loss:  0.1314  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,501  tflops: 489.75  mfu: 49.52%
[rank0]:2025-10-29 09:27:46,702 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank2]:2025-10-29 09:27:46,700 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank1]:2025-10-29 09:27:46,702 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank0]:2025-10-29 09:27:46,795 - INFO - Avg. fwd time: 15.2842 / Avg. bwd time: 5.4428 / Avg. batch time: 414.4011 (ms) / GPU bubble ratio: 59.99%
[rank3]:2025-10-29 09:27:47,001 - INFO - Avg. fwd time: 16.6990 / Avg. bwd time: 19.9071 / Avg. batch time: 308.1734 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 09:27:47,023 - INFO - Avg. fwd time: 15.0960 / Avg. bwd time: 17.0541 / Avg. batch time: 343.1261 (ms) / GPU bubble ratio: 25.04%
[rank1]:2025-10-29 09:27:47,049 - INFO - Avg. fwd time: 17.5070 / Avg. bwd time: 19.5943 / Avg. batch time: 387.6031 (ms) / GPU bubble ratio: 23.42%
[rank0]:2025-10-29 09:29:03,027 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:29:04,599 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank2]:2025-10-29 09:29:04,599 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,739  tflops: 454.25  mfu: 45.26%
[rank2]:2025-10-29 09:29:04,599 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 09:29:04,601 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank0]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,738  tflops: 454.18  mfu: 45.25%
[rank0]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 09:29:04,601 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank1]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,738  tflops: 454.20  mfu: 45.26%
[rank1]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 09:29:04,600 - INFO -  step: 2400  loss:  0.1148  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,517  tflops: 490.51  mfu: 49.60%
[rank3]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss:  0.1148  grad_norm:  0.0000  tps: 9,743  tflops: 454.39  mfu: 45.26%
[rank3]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 09:29:21,246 - INFO - validate step: 2400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,609
[rank0]:2025-10-29 09:29:21,247 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 09:29:21,254 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 09:29:21,296 - INFO - validate step: 2400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,532
[rank2]:2025-10-29 09:29:21,297 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 09:29:21,302 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-10-29 09:29:21,285 - INFO - validate step: 2400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,551
[rank1]:2025-10-29 09:29:21,286 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 09:29:21,289 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 09:29:21,310 - INFO - validate step: 2400  loss:  0.2338  memory: 84.59GiB(60.50%)  tps: 24,516
[rank3]:2025-10-29 09:29:21,310 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 09:29:21,315 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 09:29:32,183 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 09:29:32,286 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0929_stage2_final2400.svg
[rank0]:2025-10-29 09:29:32,290 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0929_stage0_final2400.svg
[rank1]:2025-10-29 09:29:32,277 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0929_stage1_final2400.svg
[rank3]:2025-10-29 09:29:32,429 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0929_real_final2400_rank3.svg
[rank3]:> Batch Time: 373.21 ms, GPU Bubble Ratio: 67.14%, 22.64%, 33.08%, 24.00%
[rank2]:2025-10-29 09:29:32,550 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank2_stage2.svg
[rank2]:	> Counts Sum: 749760, Total Sum: 5368320 (13.97%), Ratio(%) per element: [12.76, 14.0, 13.14, 12.6, 12.12, 13.78, 13.62, 12.71, 12.92, 13.03, 13.94, 13.51, 12.55, 14.32, 12.12, 13.35, 12.07, 12.71, 13.78, 15.28, 14.43, 14.1, 14.05, 15.02, 14.8, 15.23, 13.46, 14.59, 14.59, 12.44, 14.16, 13.25, 13.3, 13.3, 14.69, 15.12, 13.14, 13.62, 14.43, 13.51, 15.02, 15.02, 13.73, 14.37, 14.21, 15.23, 15.71, 12.23, 14.86, 14.21, 12.87, 13.94, 13.89, 14.21, 14.37, 13.51, 14.53, 13.62, 14.96, 14.59, 13.41, 15.39, 12.6, 15.5, 14.43, 16.25, 14.64, 14.1, 14.69, 14.21, 14.64, 14.69]
[rank2]:2025-10-29 09:29:32,551 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 09:29:32,543 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank0_stage0.svg
[rank0]:	> Counts Sum: 4609240, Total Sum: 5442880 (84.68%), Ratio(%) per element: [85.24, 84.06, 84.28, 84.12, 84.54, 84.38, 84.12, 84.49, 84.33, 84.17, 83.95, 84.12, 83.95, 84.22, 84.28, 84.44, 84.22, 83.95, 84.17, 84.33, 84.38, 84.06, 84.33, 84.65, 84.22, 84.6, 84.44, 84.22, 84.38, 84.38, 84.38, 84.6, 84.6, 84.6, 84.44, 84.54, 84.54, 84.81, 85.08, 84.81, 85.08, 85.35, 84.97, 84.81, 85.19, 84.97, 84.97, 85.24, 85.08, 84.97, 84.71, 85.3, 85.08, 85.03, 85.03, 85.13, 85.03, 85.24, 84.97, 84.92, 85.35, 85.03, 84.97, 84.97, 84.92, 85.13, 85.03, 84.81, 84.76, 84.97, 85.13, 84.92, 85.03]
[rank0]:2025-10-29 09:29:32,543 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 09:29:32,547 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank1_stage1.svg
[rank1]:	> Counts Sum: 104960, Total Sum: 6039360 (1.74%), Ratio(%) per element: [0.91, 0.91, 0.8, 1.07, 1.18, 0.8, 1.18, 0.75, 0.69, 1.34, 1.39, 1.66, 1.44, 1.18, 1.39, 2.03, 1.12, 1.66, 1.12, 1.44, 1.77, 1.77, 1.44, 1.77, 1.6, 2.03, 1.39, 1.5, 1.23, 1.6, 1.6, 1.55, 1.5, 1.55, 1.71, 1.87, 1.66, 1.82, 1.55, 1.39, 1.44, 1.39, 1.82, 1.39, 1.23, 2.3, 1.6, 2.09, 2.09, 2.03, 1.98, 2.25, 2.3, 2.03, 2.46, 2.03, 2.3, 2.19, 1.98, 2.19, 2.19, 1.93, 1.98, 1.87, 2.25, 2.41, 2.09, 2.3, 2.25, 1.98, 2.52, 2.36, 2.36, 2.03, 1.93, 2.03, 2.03, 1.98, 2.14, 1.87, 2.41]
[rank1]:2025-10-29 09:29:32,548 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 09:29:32,650 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0929_thry_final2400_rank3.svg
[rank3]:> Batch Time: 532.55 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 09:29:32,733 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0929_stage3_final2400.svg
[rank3]:2025-10-29 09:29:32,992 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.07, 1.01, 0.85, 1.18, 0.96, 1.01, 0.85, 1.07, 1.12, 2.03, 1.55, 1.5, 1.39, 1.23, 1.28, 1.82, 1.23, 1.5, 1.39, 1.39, 1.87, 1.98, 1.44, 1.77, 2.19, 1.44, 1.87, 1.39, 1.39, 1.87, 2.19, 1.28, 1.82, 1.39, 1.5, 1.87, 1.71, 1.39, 1.66, 1.39, 1.82, 1.44, 1.71, 1.77, 1.87, 2.09, 1.77, 1.77, 1.34, 1.82, 1.87, 1.77, 2.03, 1.87, 1.55, 2.03, 1.71, 1.34, 1.6, 1.6, 1.77, 1.87, 1.71, 1.82, 1.87]
[rank3]:2025-10-29 09:29:32,993 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 437-444
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–â–â–â–â–‚â–ƒâ–â–†â–ˆâ–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–â–â–â–â–‚â–„â–ƒâ–â–†â–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.6817
[rank3]:wandb:               final/avg_loss 0.11478
[rank3]:wandb:             final/avg_mfu(%) 45.26392
[rank3]:wandb:             final/avg_tflops 454.39233
[rank3]:wandb:    final/avg_throughput(tps) 9742.51203
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11478
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11478
[rank3]:wandb: loss_metrics/global_max_loss 0.11478
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/am0tnl8r
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyauto_dm1/20251029-0817/wandb/run-20251029_081716-am0tnl8r/logs
[rank0]:2025-10-29 09:29:34,544 - INFO - Training completed
[rank0]:2025-10-29 09:29:34,544 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 09:29:34,795 - INFO - Process group destroyed
[rank2]:2025-10-29 09:29:34,853 - INFO - Process group destroyed
[rank0]:2025-10-29 09:29:34,856 - INFO - Process group destroyed
[rank1]:2025-10-29 09:29:34,788 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.16', 'layers.8', 'layers.13', 'layers.14', 'layers.9', 'layers.11', 'layers.12', 'layers.15'}
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.0', 'tok_embeddings', 'layers.4', 'layers.2', 'layers.6', 'layers.7', 'layers.1', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.18', 'layers.20', 'layers.21', 'layers.23', 'layers.17', 'layers.19', 'layers.24'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.28', 'layers.29', 'layers.25', 'layers.31', 'layers.26', 'layers.30', 'layers.27', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
