
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 00:39:14 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_apf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] 
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] *****************************************
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 00:39:20,959 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 00:39:21,089 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 00:39:21,185 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 00:39:21,377 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 00:39:21,418 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 00:39:21,421 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:39:21,427 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 00:39:21,897 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 00:39:21,899 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 00:39:21,922 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 00:39:21,924 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 00:39:22,075 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 00:39:22,078 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:39:23,811 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 00:39:24,089 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 00:39:25,752 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 00:39:27,102 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 00:39:27,368 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 00:39:27,356 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 00:39:27,374 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 00:39:27,455 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 00:39:27,479 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 00:39:27,479 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 00:39:27,456 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 00:39:27,456 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 00:39:27,482 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 00:39:27,483 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 00:39:27,796 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 00:39:27,796 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-29 00:39:27,736 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 00:39:27,736 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-10-29 00:39:27,787 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 00:39:27,787 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run em62i16u
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1/20251029-0039/wandb/run-20251029_003928-em62i16u
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/em62i16u
[rank3]:2025-10-29 00:39:29,031 - INFO - WandB logging enabled
[rank3]:2025-10-29 00:39:29,051 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 00:39:29,123 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 00:39:29,123 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 00:39:29,445 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:39:29,445 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-29 00:39:29,433 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 00:39:29,434 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 00:39:32,875 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank1]:2025-10-29 00:39:32,827 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank2]:2025-10-29 00:39:32,944 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 00:39:33,256 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 00:39:33,256 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 00:39:33,256 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1600.
[rank0]:2025-10-29 00:39:43,419 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 00:39:43,419 - INFO - Finished loading the checkpoint in 10.16 seconds.
[rank0]:2025-10-29 00:39:43,419 - INFO - Training starts at step 1
[rank0]:2025-10-29 00:39:48,004 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 49.75GiB(35.58%)  tps: 797  tflops: 37.19  mfu: 3.76%
[rank0]:2025-10-29 00:39:48,004 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:39:47,987 - INFO -  step:  1  loss:  1.2019  grad_norm:  1.4112  memory: 58.03GiB(41.50%)  tps: 867  tflops: 40.46  mfu: 4.09%
[rank3]:2025-10-29 00:39:47,988 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 00:39:47,983 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 44.28GiB(31.67%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank2]:2025-10-29 00:39:47,983 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 00:39:47,985 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 49.69GiB(35.54%)  tps: 797  tflops: 37.18  mfu: 3.76%
[rank1]:2025-10-29 00:39:47,986 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:40:06,231 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,231 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,232 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,232 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,236 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,324 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,278 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:41:57,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:42:00,544 - INFO -  step: 50  loss:  0.9452  grad_norm:  0.5079  memory: 73.38GiB(52.48%)  tps: 6,057  tflops: 282.48  mfu: 28.56%
[rank0]:2025-10-29 00:42:00,545 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 66.72GiB(47.72%)  tps: 6,057  tflops: 282.51  mfu: 28.56%
[rank2]:2025-10-29 00:42:00,538 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 57.29GiB(40.97%)  tps: 6,056  tflops: 282.47  mfu: 28.56%
[rank1]:2025-10-29 00:42:00,541 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 64.32GiB(46.00%)  tps: 6,056  tflops: 282.47  mfu: 28.56%
[rank3]:2025-10-29 00:42:01,005 - INFO - Avg. fwd time: 14.7542 / Avg. bwd time: 43.1361 / Avg. batch time: 483.4858 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-29 00:42:01,056 - INFO - Avg. fwd time: 13.3732 / Avg. bwd time: 36.4739 / Avg. batch time: 536.4654 (ms) / GPU bubble ratio: 25.67%
[rank0]:2025-10-29 00:42:01,135 - INFO - Avg. fwd time: 14.1955 / Avg. bwd time: 38.2318 / Avg. batch time: 651.7722 (ms) / GPU bubble ratio: 35.65%
[rank1]:2025-10-29 00:42:01,102 - INFO - Avg. fwd time: 15.2345 / Avg. bwd time: 41.0440 / Avg. batch time: 596.2550 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-29 00:42:27,640 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:42:27,636 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:42:27,633 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:42:28,641 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:42:49,996 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:16,999 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:16,992 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:16,994 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:43:21,604 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:38,203 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:38,202 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:38,202 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:43:42,820 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:57,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:59,432 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 66.72GiB(47.72%)  tps: 6,891  tflops: 321.38  mfu: 32.50%
[rank1]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:59,431 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 72.68GiB(51.98%)  tps: 6,890  tflops: 321.37  mfu: 32.49%
[rank2]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:59,431 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 64.67GiB(46.25%)  tps: 6,890  tflops: 321.36  mfu: 32.49%
[rank3]:2025-10-29 00:44:04,058 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:04,062 - INFO -  step: 100  loss:  0.8794  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,632  tflops: 309.33  mfu: 31.28%
[rank0]:2025-10-29 00:44:04,142 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0043_stage0_step100.svg
[rank1]:2025-10-29 00:44:04,139 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0043_stage1_step100.svg
[rank2]:2025-10-29 00:44:04,137 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0043_stage2_step100.svg
[rank3]:2025-10-29 00:44:04,258 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0044_real_step100_rank3.svg
[rank3]:> Batch Time: 632.08 ms, GPU Bubble Ratio: 33.52%, 28.12%, 36.44%, 26.26%
[rank3]:2025-10-29 00:44:04,318 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0044_stage3_step100.svg
[rank3]:2025-10-29 00:44:04,729 - INFO - Avg. fwd time: 15.5687 / Avg. bwd time: 36.4839 / Avg. batch time: 434.0366 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-29 00:44:04,825 - INFO - Avg. fwd time: 16.0590 / Avg. bwd time: 34.7553 / Avg. batch time: 572.3828 (ms) / GPU bubble ratio: 28.98%
[rank2]:2025-10-29 00:44:04,779 - INFO - Avg. fwd time: 14.0705 / Avg. bwd time: 30.8264 / Avg. batch time: 519.0536 (ms) / GPU bubble ratio: 30.80%
[rank0]:2025-10-29 00:44:04,858 - INFO - Avg. fwd time: 14.6540 / Avg. bwd time: 27.6478 / Avg. batch time: 616.9579 (ms) / GPU bubble ratio: 45.15%
[rank1]:2025-10-29 00:44:31,296 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:44:31,293 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:44:31,300 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:35,989 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:44:52,559 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:44:52,558 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:44:52,558 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:57,186 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:45:13,737 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:45:13,736 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:45:13,736 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:45:18,357 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:45:34,922 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:45:34,921 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:45:34,921 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:45:39,565 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:03,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:46:06,547 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:06,548 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 66.72GiB(47.72%)  tps: 6,445  tflops: 300.57  mfu: 30.39%
[rank1]:2025-10-29 00:46:06,543 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:06,543 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 72.68GiB(51.98%)  tps: 6,445  tflops: 300.58  mfu: 30.39%
[rank2]:2025-10-29 00:46:06,541 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:06,541 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 64.67GiB(46.25%)  tps: 6,445  tflops: 300.59  mfu: 30.39%
[rank3]:2025-10-29 00:46:11,139 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:11,143 - INFO -  step: 150  loss:  0.9237  grad_norm:  0.4892  memory: 83.85GiB(59.97%)  tps: 6,446  tflops: 300.66  mfu: 30.40%
[rank0]:2025-10-29 00:46:11,524 - INFO - Avg. fwd time: 14.8429 / Avg. bwd time: 23.3480 / Avg. batch time: 611.9667 (ms) / GPU bubble ratio: 50.07%
[rank3]:2025-10-29 00:46:11,475 - INFO - Avg. fwd time: 15.8748 / Avg. bwd time: 33.7008 / Avg. batch time: 413.3985 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-29 00:46:11,519 - INFO - Avg. fwd time: 16.3640 / Avg. bwd time: 32.0982 / Avg. batch time: 571.8168 (ms) / GPU bubble ratio: 32.20%
[rank2]:2025-10-29 00:46:11,496 - INFO - Avg. fwd time: 14.3236 / Avg. bwd time: 28.4734 / Avg. batch time: 521.2272 (ms) / GPU bubble ratio: 34.31%
[rank0]:2025-10-29 00:46:27,672 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:27,671 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:27,671 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:32,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:53,435 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:47:09,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:47:09,970 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:47:09,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:47:14,637 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:47:31,172 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:47:31,171 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:47:31,171 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:47:35,787 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:00,070 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:48:02,796 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:02,797 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 66.72GiB(47.72%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank0]:2025-10-29 00:48:02,797 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 00:48:02,790 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:48:02,790 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 64.67GiB(46.25%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank2]:2025-10-29 00:48:02,790 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 00:48:02,792 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:48:02,793 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 72.68GiB(51.98%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank1]:2025-10-29 00:48:02,793 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 00:48:07,448 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:48:07,452 - INFO -  step: 200  loss:  0.9406  grad_norm:  0.5840  memory: 83.85GiB(59.97%)  tps: 7,043  tflops: 328.50  mfu: 33.22%
[rank3]:2025-10-29 00:48:07,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 00:48:25,501 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,041
[rank1]:2025-10-29 00:48:25,536 - INFO - validate step: 200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,010
[rank2]:2025-10-29 00:48:25,565 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 17,985
[rank3]:2025-10-29 00:48:25,591 - INFO - validate step: 200  loss:  0.2413  memory: 83.85GiB(59.97%)  tps: 22,583
[rank0]:2025-10-29 00:48:25,666 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0048_stage0_step200.svg
[rank1]:2025-10-29 00:48:25,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0048_stage1_step200.svg
[rank2]:2025-10-29 00:48:25,662 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0048_stage2_step200.svg
[rank3]:2025-10-29 00:48:25,774 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0048_real_step200_rank3.svg
[rank3]:> Batch Time: 382.68 ms, GPU Bubble Ratio: 65.02%, 24.36%, 33.16%, 23.21%
[rank0]:2025-10-29 00:48:25,768 - INFO - Avg. fwd time: 15.0348 / Avg. bwd time: 19.2314 / Avg. batch time: 592.4201 (ms) / GPU bubble ratio: 53.73%
[rank3]:2025-10-29 00:48:25,838 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0048_stage3_step200.svg
[rank3]:2025-10-29 00:48:26,107 - INFO - Avg. fwd time: 16.1555 / Avg. bwd time: 31.0441 / Avg. batch time: 394.0320 (ms) / GPU bubble ratio: 4.17%
[rank1]:2025-10-29 00:48:26,154 - INFO - Avg. fwd time: 16.6352 / Avg. bwd time: 29.5622 / Avg. batch time: 556.4888 (ms) / GPU bubble ratio: 33.59%
[rank2]:2025-10-29 00:48:26,129 - INFO - Avg. fwd time: 14.5598 / Avg. bwd time: 26.2294 / Avg. batch time: 508.4828 (ms) / GPU bubble ratio: 35.83%
[rank2]:2025-10-29 00:48:42,391 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:48:42,391 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:42,392 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:48:47,023 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:08,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:29,394 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:50,560 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:05,538 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:50:07,193 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:07,193 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 8,061  tflops: 375.96  mfu: 38.01%
[rank1]:2025-10-29 00:50:07,193 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:50:07,193 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 8,058  tflops: 375.85  mfu: 38.00%
[rank0]:2025-10-29 00:50:07,194 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:07,194 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 8,056  tflops: 375.72  mfu: 37.99%
[rank3]:2025-10-29 00:50:11,807 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:50:11,815 - INFO -  step: 250  loss:  0.9329  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,712  tflops: 359.69  mfu: 36.37%
[rank3]:2025-10-29 00:50:12,227 - INFO - Avg. fwd time: 16.3734 / Avg. bwd time: 29.0352 / Avg. batch time: 379.4604 (ms) / GPU bubble ratio: 4.27%
[rank2]:2025-10-29 00:50:12,276 - INFO - Avg. fwd time: 14.7425 / Avg. bwd time: 24.5344 / Avg. batch time: 495.5911 (ms) / GPU bubble ratio: 36.60%
[rank0]:2025-10-29 00:50:12,355 - INFO - Avg. fwd time: 15.1865 / Avg. bwd time: 16.1141 / Avg. batch time: 574.3840 (ms) / GPU bubble ratio: 56.40%
[rank1]:2025-10-29 00:50:12,322 - INFO - Avg. fwd time: 16.8464 / Avg. bwd time: 27.6441 / Avg. batch time: 541.6468 (ms) / GPU bubble ratio: 34.29%
[rank1]:2025-10-29 00:50:38,798 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:38,796 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:38,802 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:50:43,433 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:04,634 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:51:21,270 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:51:21,269 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:51:21,270 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:25,885 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:51:42,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:51:42,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:51:42,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:47,010 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:01,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:52:03,567 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:03,567 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank1]:2025-10-29 00:52:03,566 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:03,566 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank2]:2025-10-29 00:52:03,566 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:03,566 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank0]:2025-10-29 00:52:08,264 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0052_stage0_step300.svg
[rank3]:2025-10-29 00:52:08,188 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:08,192 - INFO -  step: 300  loss:  0.8592  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,039  tflops: 328.31  mfu: 33.20%
[rank1]:2025-10-29 00:52:08,263 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0052_stage1_step300.svg
[rank2]:2025-10-29 00:52:08,264 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0052_stage2_step300.svg
[rank3]:2025-10-29 00:52:08,380 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0052_real_step300_rank3.svg
[rank3]:> Batch Time: 383.49 ms, GPU Bubble Ratio: 64.72%, 24.34%, 33.18%, 23.30%
[rank3]:2025-10-29 00:52:08,443 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0052_stage3_step300.svg
[rank3]:2025-10-29 00:52:08,773 - INFO - Avg. fwd time: 16.4672 / Avg. bwd time: 28.1483 / Avg. batch time: 372.9632 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-29 00:52:08,795 - INFO - Avg. fwd time: 14.8240 / Avg. bwd time: 23.7861 / Avg. batch time: 494.3263 (ms) / GPU bubble ratio: 37.51%
[rank0]:2025-10-29 00:52:08,824 - INFO - Avg. fwd time: 15.2467 / Avg. bwd time: 14.7370 / Avg. batch time: 570.8283 (ms) / GPU bubble ratio: 57.98%
[rank1]:2025-10-29 00:52:08,818 - INFO - Avg. fwd time: 16.9312 / Avg. bwd time: 26.7891 / Avg. batch time: 539.5002 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:29,630 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:50,768 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:53:17,755 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:53:17,753 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:17,760 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:53:22,441 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:39,009 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:53:39,008 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:53:39,008 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:53:43,586 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:58,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:54:00,121 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:54:00,121 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 66.72GiB(47.72%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank2]:2025-10-29 00:54:00,120 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:00,120 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 64.67GiB(46.25%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank1]:2025-10-29 00:54:00,120 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:00,120 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 72.68GiB(51.98%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank0]:2025-10-29 00:54:00,223 - INFO - Avg. fwd time: 15.2755 / Avg. bwd time: 14.0433 / Avg. batch time: 568.6623 (ms) / GPU bubble ratio: 58.75%
[rank3]:2025-10-29 00:54:04,741 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:04,745 - INFO -  step: 350  loss:  0.8905  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,029  tflops: 327.82  mfu: 33.15%
[rank3]:2025-10-29 00:54:05,016 - INFO - Avg. fwd time: 16.5132 / Avg. bwd time: 27.7027 / Avg. batch time: 369.6738 (ms) / GPU bubble ratio: 4.31%
[rank1]:2025-10-29 00:54:05,064 - INFO - Avg. fwd time: 16.9747 / Avg. bwd time: 26.3568 / Avg. batch time: 538.0459 (ms) / GPU bubble ratio: 35.57%
[rank2]:2025-10-29 00:54:05,038 - INFO - Avg. fwd time: 14.8659 / Avg. bwd time: 23.4094 / Avg. batch time: 493.3168 (ms) / GPU bubble ratio: 37.93%
[rank0]:2025-10-29 00:54:21,336 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:21,335 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:21,335 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:25,923 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:54:42,479 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:42,478 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:42,478 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:47,105 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:08,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:24,647 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:24,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:24,648 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:29,254 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:43,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:55:44,777 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank2]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 00:55:44,777 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank1]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:55:44,778 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank0]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 00:55:49,398 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:49,402 - INFO -  step: 400  loss:  0.1265  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,828  tflops: 365.08  mfu: 36.91%
[rank3]:2025-10-29 00:55:49,402 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:56:03,846 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 21,482
[rank2]:2025-10-29 00:56:03,902 - INFO - validate step: 400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 21,418
[rank1]:2025-10-29 00:56:03,878 - INFO - validate step: 400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 21,445
[rank3]:2025-10-29 00:56:03,921 - INFO - validate step: 400  loss:  0.2379  memory: 83.85GiB(59.97%)  tps: 28,213
[rank2]:2025-10-29 00:56:03,997 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0056_stage2_step400.svg
[rank1]:2025-10-29 00:56:04,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0056_stage1_step400.svg
[rank0]:2025-10-29 00:56:04,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0056_stage0_step400.svg
[rank3]:2025-10-29 00:56:04,116 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0056_real_step400_rank3.svg
[rank3]:> Batch Time: 383.19 ms, GPU Bubble Ratio: 64.65%, 24.35%, 33.18%, 23.28%
[rank3]:2025-10-29 00:56:04,187 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0056_stage3_step400.svg
[rank3]:2025-10-29 00:56:04,578 - INFO - Avg. fwd time: 16.6081 / Avg. bwd time: 26.5879 / Avg. batch time: 361.4261 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 00:56:04,675 - INFO - Avg. fwd time: 17.0701 / Avg. bwd time: 25.3041 / Avg. batch time: 531.0332 (ms) / GPU bubble ratio: 36.16%
[rank2]:2025-10-29 00:56:04,628 - INFO - Avg. fwd time: 14.9489 / Avg. bwd time: 22.4748 / Avg. batch time: 487.3731 (ms) / GPU bubble ratio: 38.57%
[rank0]:2025-10-29 00:56:04,707 - INFO - Avg. fwd time: 15.3419 / Avg. bwd time: 12.3405 / Avg. batch time: 559.8957 (ms) / GPU bubble ratio: 60.45%
[rank2]:2025-10-29 00:56:30,112 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:30,114 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:30,119 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:35,293 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:55,430 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:10,885 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:10,884 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:10,884 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:15,686 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:31,128 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:31,127 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:31,127 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:35,710 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:49,696 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:51,249 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,627  tflops: 355.74  mfu: 35.97%
[rank1]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:51,248 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,630  tflops: 355.85  mfu: 35.98%
[rank2]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:51,248 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,631  tflops: 355.93  mfu: 35.99%
[rank3]:2025-10-29 00:57:55,839 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:55,843 - INFO -  step: 450  loss:  0.1056  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,320  tflops: 341.38  mfu: 34.52%
[rank3]:2025-10-29 00:57:56,150 - INFO - Avg. fwd time: 16.5429 / Avg. bwd time: 26.1951 / Avg. batch time: 357.6817 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-29 00:57:56,172 - INFO - Avg. fwd time: 14.9097 / Avg. bwd time: 22.1806 / Avg. batch time: 486.2533 (ms) / GPU bubble ratio: 38.98%
[rank1]:2025-10-29 00:57:56,196 - INFO - Avg. fwd time: 17.0288 / Avg. bwd time: 24.9813 / Avg. batch time: 529.5857 (ms) / GPU bubble ratio: 36.54%
[rank0]:2025-10-29 00:57:56,203 - INFO - Avg. fwd time: 15.2919 / Avg. bwd time: 11.8549 / Avg. batch time: 557.9056 (ms) / GPU bubble ratio: 61.07%
[rank2]:2025-10-29 00:58:11,301 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:11,301 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:11,302 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:15,905 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:31,400 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:31,400 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:31,401 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:36,144 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:51,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:51,647 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:51,648 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:56,217 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:11,702 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:11,701 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:11,701 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:16,285 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:39,638 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:59:42,245 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:42,245 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 66.72GiB(47.72%)  tps: 7,380  tflops: 344.23  mfu: 34.81%
[rank1]:2025-10-29 00:59:42,240 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:42,241 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 72.68GiB(51.98%)  tps: 7,381  tflops: 344.24  mfu: 34.81%
[rank2]:2025-10-29 00:59:42,238 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:42,238 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 64.67GiB(46.25%)  tps: 7,381  tflops: 344.24  mfu: 34.81%
[rank3]:2025-10-29 00:59:46,847 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:46,851 - INFO -  step: 500  loss:  0.1172  grad_norm:  0.1229  memory: 83.85GiB(59.97%)  tps: 7,380  tflops: 344.19  mfu: 34.80%
[rank2]:2025-10-29 00:59:46,921 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0059_stage2_step500.svg
[rank0]:2025-10-29 00:59:46,924 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0059_stage0_step500.svg
[rank1]:2025-10-29 00:59:46,924 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0059_stage1_step500.svg
[rank0]:2025-10-29 00:59:47,013 - INFO - Avg. fwd time: 15.2671 / Avg. bwd time: 11.2730 / Avg. batch time: 553.8146 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-10-29 00:59:47,039 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0059_real_step500_rank3.svg
[rank3]:> Batch Time: 381.39 ms, GPU Bubble Ratio: 64.74%, 24.33%, 33.23%, 23.37%
[rank3]:2025-10-29 00:59:47,101 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0059_stage3_step500.svg
[rank3]:2025-10-29 00:59:47,342 - INFO - Avg. fwd time: 16.5136 / Avg. bwd time: 25.7636 / Avg. batch time: 353.9377 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-10-29 00:59:47,388 - INFO - Avg. fwd time: 17.0135 / Avg. bwd time: 24.6056 / Avg. batch time: 526.1277 (ms) / GPU bubble ratio: 36.72%
[rank2]:2025-10-29 00:59:47,364 - INFO - Avg. fwd time: 14.8975 / Avg. bwd time: 21.8436 / Avg. batch time: 483.1792 (ms) / GPU bubble ratio: 39.17%
[rank2]:2025-10-29 01:00:02,604 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:02,604 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:02,605 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:07,215 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:22,742 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:22,741 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:22,742 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:27,355 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:47,558 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:03,044 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:03,044 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:03,045 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:07,648 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:21,657 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:01:23,206 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:23,207 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,114  tflops: 378.42  mfu: 38.26%
[rank2]:2025-10-29 01:01:23,206 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:23,206 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,113  tflops: 378.41  mfu: 38.26%
[rank0]:2025-10-29 01:01:23,207 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:23,207 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,114  tflops: 378.44  mfu: 38.26%
[rank0]:2025-10-29 01:01:23,294 - INFO - Avg. fwd time: 15.2508 / Avg. bwd time: 10.6229 / Avg. batch time: 548.0308 (ms) / GPU bubble ratio: 62.23%
[rank3]:2025-10-29 01:01:27,822 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:27,826 - INFO -  step: 550  loss:  0.1045  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,113  tflops: 378.39  mfu: 38.26%
[rank2]:2025-10-29 01:01:28,091 - INFO - Avg. fwd time: 14.8943 / Avg. bwd time: 21.4727 / Avg. batch time: 478.5168 (ms) / GPU bubble ratio: 39.20%
[rank3]:2025-10-29 01:01:28,069 - INFO - Avg. fwd time: 16.4981 / Avg. bwd time: 25.2967 / Avg. batch time: 350.0255 (ms) / GPU bubble ratio: 4.48%
[rank1]:2025-10-29 01:01:28,116 - INFO - Avg. fwd time: 17.0113 / Avg. bwd time: 24.1923 / Avg. batch time: 521.0427 (ms) / GPU bubble ratio: 36.74%
[rank1]:2025-10-29 01:01:43,377 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:43,377 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:43,378 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:48,010 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:08,171 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:23,756 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:23,756 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:23,757 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:28,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:43,909 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:43,908 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:43,908 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:49,061 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:12,359 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:03:14,972 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:14,973 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 72.68GiB(51.98%)  tps: 7,330  tflops: 341.85  mfu: 34.57%
[rank1]:2025-10-29 01:03:14,973 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 01:03:14,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:14,970 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 64.67GiB(46.25%)  tps: 7,330  tflops: 341.86  mfu: 34.57%
[rank2]:2025-10-29 01:03:14,970 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 01:03:14,977 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:14,977 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 66.72GiB(47.72%)  tps: 7,329  tflops: 341.84  mfu: 34.56%
[rank0]:2025-10-29 01:03:14,977 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 01:03:19,684 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:19,689 - INFO -  step: 600  loss:  0.0962  grad_norm:  0.1011  memory: 83.85GiB(59.97%)  tps: 7,323  tflops: 341.57  mfu: 34.54%
[rank3]:2025-10-29 01:03:19,689 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 01:03:36,505 - INFO - validate step: 600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,023
[rank0]:2025-10-29 01:03:36,468 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,059
[rank2]:2025-10-29 01:03:36,540 - INFO - validate step: 600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,989
[rank3]:2025-10-29 01:03:36,564 - INFO - validate step: 600  loss:  0.2376  memory: 83.85GiB(59.97%)  tps: 24,274
[rank0]:2025-10-29 01:03:36,640 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0103_stage0_step600.svg
[rank1]:2025-10-29 01:03:36,640 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0103_stage1_step600.svg
[rank2]:2025-10-29 01:03:36,639 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0103_stage2_step600.svg
[rank3]:2025-10-29 01:03:36,755 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0103_real_step600_rank3.svg
[rank3]:> Batch Time: 379.38 ms, GPU Bubble Ratio: 64.84%, 24.26%, 33.23%, 23.60%
[rank3]:2025-10-29 01:03:36,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0103_stage3_step600.svg
[rank3]:2025-10-29 01:03:37,132 - INFO - Avg. fwd time: 16.4618 / Avg. bwd time: 25.1188 / Avg. batch time: 348.2693 (ms) / GPU bubble ratio: 4.49%
[rank1]:2025-10-29 01:03:37,179 - INFO - Avg. fwd time: 16.9848 / Avg. bwd time: 24.0488 / Avg. batch time: 520.8479 (ms) / GPU bubble ratio: 36.97%
[rank2]:2025-10-29 01:03:37,155 - INFO - Avg. fwd time: 14.8720 / Avg. bwd time: 21.3437 / Avg. batch time: 478.4777 (ms) / GPU bubble ratio: 39.45%
[rank0]:2025-10-29 01:03:37,186 - INFO - Avg. fwd time: 15.2181 / Avg. bwd time: 10.4091 / Avg. batch time: 547.5887 (ms) / GPU bubble ratio: 62.56%
[rank1]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:57,814 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:13,328 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:13,328 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:13,329 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:17,892 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:33,471 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:33,471 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:33,472 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:38,678 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:54,301 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:54,300 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:54,300 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:58,881 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:12,848 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:05:14,401 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:14,402 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,368  tflops: 390.28  mfu: 39.46%
[rank2]:2025-10-29 01:05:14,401 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:14,402 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,371  tflops: 390.43  mfu: 39.48%
[rank0]:2025-10-29 01:05:14,402 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:14,403 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,365  tflops: 390.14  mfu: 39.45%
[rank0]:2025-10-29 01:05:14,491 - INFO - Avg. fwd time: 15.2232 / Avg. bwd time: 9.7621 / Avg. batch time: 543.7522 (ms) / GPU bubble ratio: 63.24%
[rank3]:2025-10-29 01:05:19,243 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:19,248 - INFO -  step: 650  loss:  0.0871  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,978  tflops: 372.10  mfu: 37.62%
[rank2]:2025-10-29 01:05:19,512 - INFO - Avg. fwd time: 14.8872 / Avg. bwd time: 20.9818 / Avg. batch time: 475.7197 (ms) / GPU bubble ratio: 39.68%
[rank3]:2025-10-29 01:05:19,491 - INFO - Avg. fwd time: 16.4742 / Avg. bwd time: 24.6783 / Avg. batch time: 344.8130 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-29 01:05:19,538 - INFO - Avg. fwd time: 17.0066 / Avg. bwd time: 23.6475 / Avg. batch time: 517.6924 (ms) / GPU bubble ratio: 37.18%
[rank1]:2025-10-29 01:05:34,855 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:34,855 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:34,856 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:39,459 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:54,999 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:54,999 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:55,000 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:59,604 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:19,756 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:35,360 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:35,360 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:35,361 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:40,215 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:54,156 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:55,718 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank1]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:55,717 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank2]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:55,717 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank3]:2025-10-29 01:07:00,349 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:00,354 - INFO -  step: 700  loss:  0.0734  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,103  tflops: 377.90  mfu: 38.21%
[rank1]:2025-10-29 01:07:00,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0106_stage1_step700.svg
[rank2]:2025-10-29 01:07:00,430 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0106_stage2_step700.svg
[rank0]:2025-10-29 01:07:00,435 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0106_stage0_step700.svg
[rank3]:2025-10-29 01:07:00,551 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0107_real_step700_rank3.svg
[rank3]:> Batch Time: 377.88 ms, GPU Bubble Ratio: 64.92%, 24.17%, 33.20%, 23.64%
[rank3]:2025-10-29 01:07:00,620 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0107_stage3_step700.svg
[rank3]:2025-10-29 01:07:01,009 - INFO - Avg. fwd time: 16.4838 / Avg. bwd time: 24.2332 / Avg. batch time: 341.2969 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-10-29 01:07:01,104 - INFO - Avg. fwd time: 17.0233 / Avg. bwd time: 23.2410 / Avg. batch time: 514.6657 (ms) / GPU bubble ratio: 37.41%
[rank2]:2025-10-29 01:07:01,058 - INFO - Avg. fwd time: 14.9011 / Avg. bwd time: 20.6187 / Avg. batch time: 473.1019 (ms) / GPU bubble ratio: 39.94%
[rank0]:2025-10-29 01:07:01,136 - INFO - Avg. fwd time: 15.2257 / Avg. bwd time: 9.1126 / Avg. batch time: 540.0403 (ms) / GPU bubble ratio: 63.95%
[rank1]:2025-10-29 01:07:26,582 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:26,580 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:26,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:31,224 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:46,799 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:46,799 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:46,800 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:51,484 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:07,015 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:07,015 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:07,016 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:11,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:27,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:27,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:27,381 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:32,023 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:46,015 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:08:47,586 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:47,586 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank2]:2025-10-29 01:08:47,585 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:47,586 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank0]:2025-10-29 01:08:47,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:47,587 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank3]:2025-10-29 01:08:52,534 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:52,539 - INFO -  step: 750  loss:  0.1053  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,302  tflops: 340.58  mfu: 34.44%
[rank1]:2025-10-29 01:08:52,901 - INFO - Avg. fwd time: 17.0069 / Avg. bwd time: 23.1936 / Avg. batch time: 515.0142 (ms) / GPU bubble ratio: 37.55%
[rank2]:2025-10-29 01:08:52,876 - INFO - Avg. fwd time: 14.8850 / Avg. bwd time: 20.5731 / Avg. batch time: 473.5075 (ms) / GPU bubble ratio: 40.09%
[rank0]:2025-10-29 01:08:52,908 - INFO - Avg. fwd time: 15.2029 / Avg. bwd time: 9.0476 / Avg. batch time: 540.3081 (ms) / GPU bubble ratio: 64.09%
[rank3]:2025-10-29 01:08:52,854 - INFO - Avg. fwd time: 16.4596 / Avg. bwd time: 24.1684 / Avg. batch time: 340.5598 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-10-29 01:09:08,072 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:08,072 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:08,073 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:12,766 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:28,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:28,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:28,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:32,963 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:48,454 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:48,454 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:48,455 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:53,083 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:13,291 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:27,297 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:10:28,870 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank1]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 01:10:28,870 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank2]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:10:28,871 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank0]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 01:10:33,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:33,523 - INFO -  step: 800  loss:  0.1210  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank3]:2025-10-29 01:10:33,524 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:10:50,002 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,384
[rank2]:2025-10-29 01:10:50,071 - INFO - validate step: 800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,321
[rank1]:2025-10-29 01:10:50,038 - INFO - validate step: 800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,351
[rank3]:2025-10-29 01:10:50,092 - INFO - validate step: 800  loss:  0.2397  memory: 83.85GiB(59.97%)  tps: 24,722
[rank2]:2025-10-29 01:10:50,172 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0110_stage2_step800.svg
[rank1]:2025-10-29 01:10:50,174 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0110_stage1_step800.svg
[rank0]:2025-10-29 01:10:50,172 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0110_stage0_step800.svg
[rank3]:2025-10-29 01:10:50,285 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0110_real_step800_rank3.svg
[rank3]:> Batch Time: 376.60 ms, GPU Bubble Ratio: 64.94%, 24.06%, 33.13%, 23.67%
[rank0]:2025-10-29 01:10:50,262 - INFO - Avg. fwd time: 15.2054 / Avg. bwd time: 8.5996 / Avg. batch time: 537.2036 (ms) / GPU bubble ratio: 64.55%
[rank3]:2025-10-29 01:10:50,356 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0110_stage3_step800.svg
[rank3]:2025-10-29 01:10:50,606 - INFO - Avg. fwd time: 16.4672 / Avg. bwd time: 23.8640 / Avg. batch time: 338.1650 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-10-29 01:10:50,627 - INFO - Avg. fwd time: 14.8952 / Avg. bwd time: 20.3224 / Avg. batch time: 471.1630 (ms) / GPU bubble ratio: 40.20%
[rank1]:2025-10-29 01:10:50,652 - INFO - Avg. fwd time: 17.0194 / Avg. bwd time: 22.9120 / Avg. batch time: 512.3819 (ms) / GPU bubble ratio: 37.65%
[rank2]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:10,636 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:26,296 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:26,295 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:26,295 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:30,926 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:56,907 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:56,903 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:56,900 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:01,525 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:21,733 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:35,814 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:37,375 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,630  tflops: 355.84  mfu: 35.98%
[rank1]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:37,374 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,632  tflops: 355.96  mfu: 35.99%
[rank2]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:37,374 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,634  tflops: 356.07  mfu: 36.00%
[rank0]:2025-10-29 01:12:37,464 - INFO - Avg. fwd time: 15.1876 / Avg. bwd time: 8.5738 / Avg. batch time: 536.1698 (ms) / GPU bubble ratio: 64.55%
[rank3]:2025-10-29 01:12:42,153 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:42,157 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,310  tflops: 340.95  mfu: 34.47%
[rank3]:2025-10-29 01:12:42,396 - INFO - Avg. fwd time: 16.4487 / Avg. bwd time: 23.8294 / Avg. batch time: 337.7207 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-29 01:12:42,442 - INFO - Avg. fwd time: 17.0077 / Avg. bwd time: 22.8917 / Avg. batch time: 511.3848 (ms) / GPU bubble ratio: 37.58%
[rank2]:2025-10-29 01:12:42,418 - INFO - Avg. fwd time: 14.8824 / Avg. bwd time: 20.2993 / Avg. batch time: 470.1854 (ms) / GPU bubble ratio: 40.14%
[rank0]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:02,216 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:22,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:42,742 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:02,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:16,882 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:14:18,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:18,420 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,107  tflops: 378.12  mfu: 38.23%
[rank1]:2025-10-29 01:14:18,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:18,419 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank2]:2025-10-29 01:14:18,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:18,419 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank3]:2025-10-29 01:14:23,067 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:23,071 - INFO -  step: 900  loss:  0.1320  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,118  tflops: 378.62  mfu: 38.28%
[rank0]:2025-10-29 01:14:23,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0114_stage0_step900.svg
[rank2]:2025-10-29 01:14:23,144 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0114_stage2_step900.svg
[rank1]:2025-10-29 01:14:23,145 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0114_stage1_step900.svg
[rank3]:2025-10-29 01:14:23,263 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0114_real_step900_rank3.svg
[rank3]:> Batch Time: 375.38 ms, GPU Bubble Ratio: 64.90%, 23.90%, 33.02%, 23.72%
[rank3]:2025-10-29 01:14:23,324 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0114_stage3_step900.svg
[rank0]:2025-10-29 01:14:23,686 - INFO - Avg. fwd time: 15.1924 / Avg. bwd time: 8.1397 / Avg. batch time: 533.7192 (ms) / GPU bubble ratio: 65.03%
[rank2]:2025-10-29 01:14:23,654 - INFO - Avg. fwd time: 14.8939 / Avg. bwd time: 20.0511 / Avg. batch time: 468.4451 (ms) / GPU bubble ratio: 40.32%
[rank1]:2025-10-29 01:14:23,679 - INFO - Avg. fwd time: 17.0220 / Avg. bwd time: 22.6202 / Avg. batch time: 509.3893 (ms) / GPU bubble ratio: 37.74%
[rank3]:2025-10-29 01:14:23,631 - INFO - Avg. fwd time: 16.4589 / Avg. bwd time: 23.5266 / Avg. batch time: 335.3610 (ms) / GPU bubble ratio: 4.62%
[rank0]:2025-10-29 01:14:38,826 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:38,825 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:38,825 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:43,462 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:58,935 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:58,934 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:58,934 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:03,578 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:19,153 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:19,152 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:19,152 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:23,798 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:39,220 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:39,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:39,219 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:43,866 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:57,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:15:59,403 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank1]:2025-10-29 01:15:59,402 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank2]:2025-10-29 01:15:59,402 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank3]:2025-10-29 01:16:04,118 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:04,122 - INFO -  step: 950  loss:  0.1562  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,107  tflops: 378.11  mfu: 38.23%
[rank2]:2025-10-29 01:16:04,555 - INFO - Avg. fwd time: 14.9043 / Avg. bwd time: 19.8611 / Avg. batch time: 466.6749 (ms) / GPU bubble ratio: 40.40%
[rank3]:2025-10-29 01:16:04,507 - INFO - Avg. fwd time: 16.4668 / Avg. bwd time: 23.2938 / Avg. batch time: 333.5481 (ms) / GPU bubble ratio: 4.64%
[rank0]:2025-10-29 01:16:04,634 - INFO - Avg. fwd time: 15.1962 / Avg. bwd time: 7.8060 / Avg. batch time: 531.3966 (ms) / GPU bubble ratio: 65.37%
[rank1]:2025-10-29 01:16:04,601 - INFO - Avg. fwd time: 17.0332 / Avg. bwd time: 22.4109 / Avg. batch time: 507.4187 (ms) / GPU bubble ratio: 37.81%
[rank0]:2025-10-29 01:16:30,133 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:30,129 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:30,127 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:34,763 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:50,274 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:50,273 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:50,273 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:54,894 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:15,175 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:35,357 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:49,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:17:50,928 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:50,929 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank0]:2025-10-29 01:17:50,929 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 01:17:50,927 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:50,928 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank1]:2025-10-29 01:17:50,928 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 01:17:50,927 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:50,928 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank2]:2025-10-29 01:17:50,928 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 01:17:55,580 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:55,584 - INFO -  step: 1000  loss:  0.1058  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,350  tflops: 342.79  mfu: 34.66%
[rank3]:2025-10-29 01:17:55,584 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:18:12,029 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,412
[rank1]:2025-10-29 01:18:12,066 - INFO - validate step: 1000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,377
[rank2]:2025-10-29 01:18:12,105 - INFO - validate step: 1000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,342
[rank3]:2025-10-29 01:18:12,125 - INFO - validate step: 1000  loss:  0.2373  memory: 83.85GiB(59.97%)  tps: 24,763
[rank0]:2025-10-29 01:18:12,202 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0118_stage0_step1000.svg
[rank0]:2025-10-29 01:18:12,292 - INFO - Avg. fwd time: 15.1790 / Avg. bwd time: 7.8258 / Avg. batch time: 531.8945 (ms) / GPU bubble ratio: 65.40%
[rank2]:2025-10-29 01:18:12,202 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0118_stage2_step1000.svg
[rank1]:2025-10-29 01:18:12,203 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0118_stage1_step1000.svg
[rank3]:2025-10-29 01:18:12,314 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0118_real_step1000_rank3.svg
[rank3]:> Batch Time: 374.34 ms, GPU Bubble Ratio: 64.86%, 23.78%, 32.92%, 23.75%
[rank3]:2025-10-29 01:18:12,378 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0118_stage3_step1000.svg
[rank2]:2025-10-29 01:18:12,646 - INFO - Avg. fwd time: 14.8910 / Avg. bwd time: 19.8662 / Avg. batch time: 467.1547 (ms) / GPU bubble ratio: 40.48%
[rank1]:2025-10-29 01:18:12,670 - INFO - Avg. fwd time: 17.0186 / Avg. bwd time: 22.4190 / Avg. batch time: 507.9062 (ms) / GPU bubble ratio: 37.88%
[rank3]:2025-10-29 01:18:12,625 - INFO - Avg. fwd time: 16.4490 / Avg. bwd time: 23.2922 / Avg. batch time: 333.3787 (ms) / GPU bubble ratio: 4.63%
[rank0]:2025-10-29 01:18:28,029 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:28,028 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:28,028 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:32,810 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:48,305 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:48,304 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:48,304 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:52,953 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:13,419 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:29,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:29,020 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:29,020 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:33,670 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:47,630 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:19:49,192 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:49,193 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,431  tflops: 393.23  mfu: 39.76%
[rank2]:2025-10-29 01:19:49,191 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:49,192 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,438  tflops: 393.54  mfu: 39.79%
[rank1]:2025-10-29 01:19:49,192 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:49,192 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank3]:2025-10-29 01:19:53,849 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:53,853 - INFO -  step: 1050  loss:  0.1308  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,053  tflops: 375.59  mfu: 37.98%
[rank3]:2025-10-29 01:19:54,166 - INFO - Avg. fwd time: 16.4590 / Avg. bwd time: 23.0680 / Avg. batch time: 331.6519 (ms) / GPU bubble ratio: 4.65%
[rank2]:2025-10-29 01:19:54,191 - INFO - Avg. fwd time: 14.9008 / Avg. bwd time: 19.6807 / Avg. batch time: 465.9338 (ms) / GPU bubble ratio: 40.62%
[rank0]:2025-10-29 01:19:54,226 - INFO - Avg. fwd time: 15.1835 / Avg. bwd time: 7.4912 / Avg. batch time: 530.1146 (ms) / GPU bubble ratio: 65.78%
[rank1]:2025-10-29 01:19:54,217 - INFO - Avg. fwd time: 17.0319 / Avg. bwd time: 22.2113 / Avg. batch time: 506.4776 (ms) / GPU bubble ratio: 38.01%
[rank2]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:14,148 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:34,310 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:54,472 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:14,934 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:38,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:21:40,815 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:40,815 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 66.72GiB(47.72%)  tps: 7,339  tflops: 342.29  mfu: 34.61%
[rank1]:2025-10-29 01:21:40,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:40,811 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 72.68GiB(51.98%)  tps: 7,339  tflops: 342.30  mfu: 34.61%
[rank2]:2025-10-29 01:21:40,808 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:40,809 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 64.67GiB(46.25%)  tps: 7,339  tflops: 342.31  mfu: 34.61%
[rank3]:2025-10-29 01:21:45,453 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:45,461 - INFO -  step: 1100  loss:  0.0996  grad_norm:  0.1015  memory: 83.85GiB(59.97%)  tps: 7,340  tflops: 342.34  mfu: 34.62%
[rank0]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0121_stage0_step1100.svg
[rank1]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0121_stage1_step1100.svg
[rank2]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0121_stage2_step1100.svg
[rank3]:2025-10-29 01:21:45,654 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0121_real_step1100_rank3.svg
[rank3]:> Batch Time: 373.80 ms, GPU Bubble Ratio: 64.84%, 23.72%, 32.87%, 23.76%
[rank0]:2025-10-29 01:21:45,630 - INFO - Avg. fwd time: 15.1770 / Avg. bwd time: 7.4068 / Avg. batch time: 529.5396 (ms) / GPU bubble ratio: 65.88%
[rank3]:2025-10-29 01:21:45,717 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0121_stage3_step1100.svg
[rank3]:2025-10-29 01:21:45,964 - INFO - Avg. fwd time: 16.4546 / Avg. bwd time: 23.0057 / Avg. batch time: 331.1087 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 01:21:45,986 - INFO - Avg. fwd time: 14.8977 / Avg. bwd time: 19.6315 / Avg. batch time: 465.5117 (ms) / GPU bubble ratio: 40.66%
[rank1]:2025-10-29 01:21:46,010 - INFO - Avg. fwd time: 17.0293 / Avg. bwd time: 22.1567 / Avg. batch time: 505.9971 (ms) / GPU bubble ratio: 38.05%
[rank0]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:06,139 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:21,737 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:21,737 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:21,736 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:26,425 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:41,907 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:41,906 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:41,906 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:46,578 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:02,183 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:02,182 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:02,182 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:06,866 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:20,831 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:22,404 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,064  tflops: 376.10  mfu: 38.03%
[rank1]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:22,403 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,064  tflops: 376.09  mfu: 38.03%
[rank2]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:22,403 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,063  tflops: 376.08  mfu: 38.03%
[rank0]:2025-10-29 01:23:22,494 - INFO - Avg. fwd time: 15.1731 / Avg. bwd time: 7.2732 / Avg. batch time: 528.0146 (ms) / GPU bubble ratio: 65.99%
[rank3]:2025-10-29 01:23:27,183 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:27,187 - INFO -  step: 1150  loss:  0.1189  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,053  tflops: 375.60  mfu: 37.98%
[rank3]:2025-10-29 01:23:27,433 - INFO - Avg. fwd time: 16.4526 / Avg. bwd time: 22.9089 / Avg. batch time: 330.3073 (ms) / GPU bubble ratio: 4.67%
[rank1]:2025-10-29 01:23:27,480 - INFO - Avg. fwd time: 17.0297 / Avg. bwd time: 22.0731 / Avg. batch time: 504.6169 (ms) / GPU bubble ratio: 38.01%
[rank2]:2025-10-29 01:23:27,455 - INFO - Avg. fwd time: 14.8979 / Avg. bwd time: 19.5542 / Avg. batch time: 464.2114 (ms) / GPU bubble ratio: 40.63%
[rank0]:2025-10-29 01:23:42,709 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:42,708 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:42,708 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:47,329 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:03,102 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:03,102 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:03,103 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:08,909 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:24,434 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:24,434 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:24,435 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:29,504 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:45,054 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:45,054 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:45,055 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:50,370 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:04,399 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:25:05,977 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:05,977 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank0]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 01:25:05,976 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:25:05,977 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank1]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 01:25:05,976 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:25:05,976 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,909  tflops: 368.90  mfu: 37.30%
[rank2]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 01:25:11,055 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:25:11,065 - INFO -  step: 1200  loss:  0.1033  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,886  tflops: 367.82  mfu: 37.19%
[rank3]:2025-10-29 01:25:11,065 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:25:27,526 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,008
[rank0]:2025-10-29 01:25:27,528 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:25:27,533 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 01:25:27,562 - INFO - validate step: 1200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,976
[rank1]:2025-10-29 01:25:27,563 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:25:27,586 - INFO - validate step: 1200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,955
[rank2]:2025-10-29 01:25:27,587 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 01:25:27,610 - INFO - validate step: 1200  loss:  0.2378  memory: 83.85GiB(59.97%)  tps: 24,759
[rank3]:2025-10-29 01:25:27,611 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 01:25:40,730 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.12 seconds.
[rank0]:2025-10-29 01:25:42,266 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 01:25:42,272 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.74 seconds.
[rank0]:2025-10-29 01:25:42,273 - INFO - Checkpointer is deleting /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-800.
[rank2]:2025-10-29 01:25:42,492 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.90 seconds.
[rank1]:2025-10-29 01:25:44,969 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.41 seconds.
[rank2]:2025-10-29 01:25:45,078 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0125_stage2_step1200.svg
[rank2]:2025-10-29 01:25:45,091 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 01:25:45,074 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0125_stage1_step1200.svg
[rank1]:2025-10-29 01:25:45,087 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 01:25:45,185 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0125_stage0_step1200.svg
[rank0]:2025-10-29 01:25:45,197 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:25:45,283 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0125_real_step1200_rank3.svg
[rank3]:> Batch Time: 373.38 ms, GPU Bubble Ratio: 64.82%, 23.67%, 32.84%, 23.77%
[rank3]:2025-10-29 01:25:45,352 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0125_stage3_step1200.svg
[rank3]:2025-10-29 01:25:45,365 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:25:46,231 - INFO - Avg. fwd time: 16.4615 / Avg. bwd time: 22.7255 / Avg. batch time: 329.0161 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 01:25:46,256 - INFO - Avg. fwd time: 14.9096 / Avg. bwd time: 19.4061 / Avg. batch time: 463.7707 (ms) / GPU bubble ratio: 40.81%
[rank1]:2025-10-29 01:25:46,283 - INFO - Avg. fwd time: 17.0413 / Avg. bwd time: 21.9062 / Avg. batch time: 504.0169 (ms) / GPU bubble ratio: 38.18%
[rank0]:2025-10-29 01:25:46,294 - INFO - Avg. fwd time: 15.1800 / Avg. bwd time: 7.0046 / Avg. batch time: 527.1413 (ms) / GPU bubble ratio: 66.33%
[rank0]:2025-10-29 01:25:50,619 - INFO - Checkpointer deleted /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-800 in 8.34 seconds.
[rank0]:2025-10-29 01:26:02,555 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:02,554 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:02,554 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:08,264 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:24,879 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:24,878 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:24,878 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:29,807 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:46,368 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:46,368 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:46,367 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:51,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:08,498 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:08,498 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:08,497 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:13,374 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:39,671 - INFO - [GC] Peforming periodical GC collection 2.04 seconds
[rank2]:2025-10-29 01:27:42,392 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:42,393 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 64.67GiB(46.25%)  tps: 6,077  tflops: 283.43  mfu: 28.66%
[rank1]:2025-10-29 01:27:42,395 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:42,396 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 72.68GiB(51.98%)  tps: 6,076  tflops: 283.37  mfu: 28.65%
[rank0]:2025-10-29 01:27:42,399 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:42,399 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 66.72GiB(47.72%)  tps: 6,074  tflops: 283.29  mfu: 28.64%
[rank0]:2025-10-29 01:27:42,504 - INFO - Avg. fwd time: 15.1982 / Avg. bwd time: 6.9496 / Avg. batch time: 527.6700 (ms) / GPU bubble ratio: 66.42%
[rank3]:2025-10-29 01:27:48,116 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:48,121 - INFO -  step: 1250  loss:  0.8856  grad_norm:  0.5491  memory: 83.85GiB(59.97%)  tps: 5,830  tflops: 271.92  mfu: 27.49%
[rank3]:2025-10-29 01:27:48,391 - INFO - Avg. fwd time: 16.4854 / Avg. bwd time: 22.7054 / Avg. batch time: 329.0402 (ms) / GPU bubble ratio: 4.71%
[rank1]:2025-10-29 01:27:48,440 - INFO - Avg. fwd time: 17.0604 / Avg. bwd time: 21.8767 / Avg. batch time: 504.5875 (ms) / GPU bubble ratio: 38.27%
[rank2]:2025-10-29 01:27:48,412 - INFO - Avg. fwd time: 14.9273 / Avg. bwd time: 19.3825 / Avg. batch time: 464.3717 (ms) / GPU bubble ratio: 40.89%
[rank1]:2025-10-29 01:28:04,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:04,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:04,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:09,855 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:26,498 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:26,497 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:26,497 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:31,600 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:53,242 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:09,855 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:09,855 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:09,856 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:14,969 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:29,923 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:29:31,585 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:31,585 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 64.67GiB(46.25%)  tps: 7,502  tflops: 349.91  mfu: 35.38%
[rank1]:2025-10-29 01:29:31,585 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:31,586 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 72.68GiB(51.98%)  tps: 7,503  tflops: 349.92  mfu: 35.38%
[rank0]:2025-10-29 01:29:31,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:31,586 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 66.72GiB(47.72%)  tps: 7,503  tflops: 349.93  mfu: 35.38%
[rank3]:2025-10-29 01:29:36,972 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:36,977 - INFO -  step: 1300  loss:  0.8851  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,526  tflops: 351.00  mfu: 35.49%
[rank0]:2025-10-29 01:29:37,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0129_stage0_step1300.svg
[rank2]:2025-10-29 01:29:37,057 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0129_stage2_step1300.svg
[rank1]:2025-10-29 01:29:37,064 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0129_stage1_step1300.svg
[rank0]:2025-10-29 01:29:37,170 - INFO - Avg. fwd time: 15.2210 / Avg. bwd time: 6.8515 / Avg. batch time: 528.3174 (ms) / GPU bubble ratio: 66.58%
[rank3]:2025-10-29 01:29:37,171 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0129_real_step1300_rank3.svg
[rank3]:> Batch Time: 374.46 ms, GPU Bubble Ratio: 64.83%, 23.75%, 32.90%, 23.76%
[rank3]:2025-10-29 01:29:37,237 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0129_stage3_step1300.svg
[rank3]:2025-10-29 01:29:37,509 - INFO - Avg. fwd time: 16.5151 / Avg. bwd time: 22.6596 / Avg. batch time: 328.9046 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-29 01:29:37,531 - INFO - Avg. fwd time: 14.9502 / Avg. bwd time: 19.3355 / Avg. batch time: 465.1606 (ms) / GPU bubble ratio: 41.03%
[rank1]:2025-10-29 01:29:37,557 - INFO - Avg. fwd time: 17.0864 / Avg. bwd time: 21.8222 / Avg. batch time: 505.3237 (ms) / GPU bubble ratio: 38.40%
[rank0]:2025-10-29 01:29:53,745 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:53,744 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:53,744 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:59,287 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:15,878 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:15,877 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:15,877 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:20,836 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:42,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:58,869 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:58,869 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:58,870 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:03,842 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:18,731 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:20,396 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 66.72GiB(47.72%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank1]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:31:20,395 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 72.68GiB(51.98%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank2]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:20,395 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 64.67GiB(46.25%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank3]:2025-10-29 01:31:25,349 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:25,354 - INFO -  step: 1350  loss:  1.2334  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,559  tflops: 352.55  mfu: 35.65%
[rank0]:2025-10-29 01:31:25,756 - INFO - Avg. fwd time: 15.2483 / Avg. bwd time: 6.6297 / Avg. batch time: 527.8916 (ms) / GPU bubble ratio: 66.84%
[rank3]:2025-10-29 01:31:25,693 - INFO - Avg. fwd time: 16.5511 / Avg. bwd time: 22.5326 / Avg. batch time: 328.1703 (ms) / GPU bubble ratio: 4.72%
[rank1]:2025-10-29 01:31:25,745 - INFO - Avg. fwd time: 17.1185 / Avg. bwd time: 21.6907 / Avg. batch time: 505.1134 (ms) / GPU bubble ratio: 38.53%
[rank2]:2025-10-29 01:31:25,718 - INFO - Avg. fwd time: 14.9785 / Avg. bwd time: 19.2207 / Avg. batch time: 465.0805 (ms) / GPU bubble ratio: 41.17%
[rank1]:2025-10-29 01:31:41,897 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:41,897 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:41,898 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:46,853 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:03,478 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:03,477 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:03,477 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:08,415 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:24,978 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:24,977 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:24,977 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:29,947 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:46,496 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:46,495 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:46,495 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:51,441 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:06,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:08,060 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 72.68GiB(51.98%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank2]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:33:08,060 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 64.67GiB(46.25%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank2]:2025-10-29 01:33:08,060 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:08,060 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:08,061 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 66.72GiB(47.72%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank0]:2025-10-29 01:33:08,061 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 01:33:13,018 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:33:13,022 - INFO -  step: 1400  loss:  2.7328  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,609  tflops: 354.87  mfu: 35.88%
[rank3]:2025-10-29 01:33:13,023 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:27,591 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,974
[rank1]:2025-10-29 01:33:27,623 - INFO - validate step: 1400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,938
[rank2]:2025-10-29 01:33:27,649 - INFO - validate step: 1400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,910
[rank3]:2025-10-29 01:33:27,668 - INFO - validate step: 1400  loss:  1.3556  memory: 83.85GiB(59.97%)  tps: 27,969
[rank0]:2025-10-29 01:33:27,751 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0133_stage0_step1400.svg
[rank1]:2025-10-29 01:33:27,762 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0133_stage1_step1400.svg
[rank2]:2025-10-29 01:33:27,751 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0133_stage2_step1400.svg
[rank3]:2025-10-29 01:33:27,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0133_real_step1400_rank3.svg
[rank3]:> Batch Time: 375.73 ms, GPU Bubble Ratio: 64.83%, 23.82%, 33.00%, 23.76%
[rank3]:2025-10-29 01:33:27,928 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0133_stage3_step1400.svg
[rank3]:2025-10-29 01:33:28,345 - INFO - Avg. fwd time: 16.5800 / Avg. bwd time: 22.4317 / Avg. batch time: 327.5897 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 01:33:28,396 - INFO - Avg. fwd time: 15.0013 / Avg. bwd time: 19.1288 / Avg. batch time: 464.6536 (ms) / GPU bubble ratio: 41.24%
[rank1]:2025-10-29 01:33:28,442 - INFO - Avg. fwd time: 17.1442 / Avg. bwd time: 21.5864 / Avg. batch time: 504.5824 (ms) / GPU bubble ratio: 38.59%
[rank0]:2025-10-29 01:33:28,474 - INFO - Avg. fwd time: 15.2697 / Avg. bwd time: 6.4529 / Avg. batch time: 527.1877 (ms) / GPU bubble ratio: 67.04%
[rank2]:2025-10-29 01:33:54,917 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:54,924 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:54,919 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:00,047 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:16,629 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:16,629 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:16,630 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:21,615 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:43,207 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:59,759 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:59,759 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:59,760 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:04,729 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:19,733 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:35:21,391 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 66.72GiB(47.72%)  tps: 7,199  tflops: 335.74  mfu: 33.95%
[rank2]:2025-10-29 01:35:21,390 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 64.67GiB(46.25%)  tps: 7,202  tflops: 335.92  mfu: 33.97%
[rank1]:2025-10-29 01:35:21,390 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 72.68GiB(51.98%)  tps: 7,201  tflops: 335.84  mfu: 33.96%
[rank0]:2025-10-29 01:35:21,493 - INFO - Avg. fwd time: 15.2802 / Avg. bwd time: 6.5179 / Avg. batch time: 527.6817 (ms) / GPU bubble ratio: 66.95%
[rank3]:2025-10-29 01:35:26,364 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:26,369 - INFO -  step: 1450  loss:  0.9433  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,902  tflops: 321.89  mfu: 32.55%
[rank3]:2025-10-29 01:35:26,639 - INFO - Avg. fwd time: 16.5941 / Avg. bwd time: 22.4885 / Avg. batch time: 328.1528 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 01:35:26,661 - INFO - Avg. fwd time: 15.0115 / Avg. bwd time: 19.1704 / Avg. batch time: 465.0232 (ms) / GPU bubble ratio: 41.20%
[rank1]:2025-10-29 01:35:26,686 - INFO - Avg. fwd time: 17.1560 / Avg. bwd time: 21.6322 / Avg. batch time: 505.0010 (ms) / GPU bubble ratio: 38.55%
[rank0]:2025-10-29 01:35:42,950 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:42,949 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:42,949 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:47,944 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:09,497 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:26,124 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:26,124 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:26,125 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:31,141 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:47,683 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:47,682 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:47,682 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:52,806 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:07,724 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:37:09,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank1]:2025-10-29 01:37:09,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank0]:2025-10-29 01:37:09,375 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank3]:2025-10-29 01:37:14,485 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:14,490 - INFO -  step: 1500  loss:  0.8235  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,577  tflops: 353.38  mfu: 35.73%
[rank1]:2025-10-29 01:37:14,579 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0137_stage1_step1500.svg
[rank2]:2025-10-29 01:37:14,575 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0137_stage2_step1500.svg
[rank0]:2025-10-29 01:37:14,574 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0137_stage0_step1500.svg
[rank3]:2025-10-29 01:37:14,679 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0137_real_step1500_rank3.svg
[rank3]:> Batch Time: 376.99 ms, GPU Bubble Ratio: 64.84%, 23.94%, 33.10%, 23.73%
[rank3]:2025-10-29 01:37:14,746 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0137_stage3_step1500.svg
[rank3]:2025-10-29 01:37:15,087 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 22.3809 / Avg. batch time: 327.5221 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 01:37:15,139 - INFO - Avg. fwd time: 17.1822 / Avg. bwd time: 21.5220 / Avg. batch time: 504.7824 (ms) / GPU bubble ratio: 38.66%
[rank2]:2025-10-29 01:37:15,112 - INFO - Avg. fwd time: 15.0347 / Avg. bwd time: 19.0742 / Avg. batch time: 464.9143 (ms) / GPU bubble ratio: 41.31%
[rank0]:2025-10-29 01:37:15,148 - INFO - Avg. fwd time: 15.3021 / Avg. bwd time: 6.3301 / Avg. batch time: 527.2797 (ms) / GPU bubble ratio: 67.18%
[rank2]:2025-10-29 01:37:31,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:31,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:31,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:36,473 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:57,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:14,564 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:14,563 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:14,564 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:19,541 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:36,098 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:36,097 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:36,097 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:41,085 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:55,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:57,627 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 64.67GiB(46.25%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank1]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:57,627 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 72.68GiB(51.98%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank0]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:57,628 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 66.72GiB(47.72%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank0]:2025-10-29 01:38:57,732 - INFO - Avg. fwd time: 15.3203 / Avg. bwd time: 6.1792 / Avg. batch time: 526.7076 (ms) / GPU bubble ratio: 67.35%
[rank3]:2025-10-29 01:39:02,643 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:02,648 - INFO -  step: 1550  loss:  0.8942  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,574  tflops: 353.26  mfu: 35.72%
[rank3]:2025-10-29 01:39:02,922 - INFO - Avg. fwd time: 16.6474 / Avg. bwd time: 22.2949 / Avg. batch time: 327.0213 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 01:39:02,942 - INFO - Avg. fwd time: 15.0538 / Avg. bwd time: 18.9965 / Avg. batch time: 464.5788 (ms) / GPU bubble ratio: 41.37%
[rank1]:2025-10-29 01:39:02,969 - INFO - Avg. fwd time: 17.2037 / Avg. bwd time: 21.4335 / Avg. batch time: 504.3582 (ms) / GPU bubble ratio: 38.71%
[rank1]:2025-10-29 01:39:19,281 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:19,281 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:19,282 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:24,275 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:40,836 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:40,835 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:39:40,835 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:45,799 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:12,795 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:12,792 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:12,799 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:17,756 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:39,173 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:53,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:40:54,774 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank0]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 01:40:54,773 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank2]:2025-10-29 01:40:54,773 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank1]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 01:40:59,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:59,741 - INFO -  step: 1600  loss:  0.1246  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,996  tflops: 326.31  mfu: 32.99%
[rank3]:2025-10-29 01:40:59,741 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:41:16,154 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,159
[rank1]:2025-10-29 01:41:16,192 - INFO - validate step: 1600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,124
[rank2]:2025-10-29 01:41:16,217 - INFO - validate step: 1600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,102
[rank3]:2025-10-29 01:41:16,240 - INFO - validate step: 1600  loss:  0.2372  memory: 83.85GiB(59.97%)  tps: 24,826
[rank0]:2025-10-29 01:41:16,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0141_stage0_step1600.svg
[rank1]:2025-10-29 01:41:16,326 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0141_stage1_step1600.svg
[rank2]:2025-10-29 01:41:16,325 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0141_stage2_step1600.svg
[rank0]:2025-10-29 01:41:16,418 - INFO - Avg. fwd time: 15.3232 / Avg. bwd time: 6.2470 / Avg. batch time: 527.8131 (ms) / GPU bubble ratio: 67.31%
[rank3]:2025-10-29 01:41:16,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0141_real_step1600_rank3.svg
[rank3]:> Batch Time: 377.91 ms, GPU Bubble Ratio: 64.84%, 24.02%, 33.16%, 23.70%
[rank3]:2025-10-29 01:41:16,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0141_stage3_step1600.svg
[rank2]:2025-10-29 01:41:16,772 - INFO - Avg. fwd time: 15.0568 / Avg. bwd time: 19.0364 / Avg. batch time: 465.5662 (ms) / GPU bubble ratio: 41.42%
[rank3]:2025-10-29 01:41:16,750 - INFO - Avg. fwd time: 16.6528 / Avg. bwd time: 22.3468 / Avg. batch time: 327.4754 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 01:41:16,797 - INFO - Avg. fwd time: 17.2068 / Avg. bwd time: 21.4781 / Avg. batch time: 505.3909 (ms) / GPU bubble ratio: 38.76%
[rank0]:2025-10-29 01:41:32,002 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:41:32,001 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:41:32,001 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:41:37,142 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:41:52,761 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:41:52,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:41:52,762 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:41:57,752 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:18,312 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:38,790 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:52,863 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:42:54,413 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:54,414 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,340  tflops: 388.99  mfu: 39.33%
[rank2]:2025-10-29 01:42:54,413 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:54,414 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,342  tflops: 389.09  mfu: 39.34%
[rank0]:2025-10-29 01:42:54,414 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:54,415 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,337  tflops: 388.84  mfu: 39.32%
[rank3]:2025-10-29 01:42:59,363 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:59,367 - INFO -  step: 1650  loss:  0.1110  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,944  tflops: 370.50  mfu: 37.46%
[rank3]:2025-10-29 01:42:59,678 - INFO - Avg. fwd time: 16.6525 / Avg. bwd time: 22.2330 / Avg. batch time: 326.5527 (ms) / GPU bubble ratio: 4.74%
[rank1]:2025-10-29 01:42:59,734 - INFO - Avg. fwd time: 17.2112 / Avg. bwd time: 21.3770 / Avg. batch time: 504.7793 (ms) / GPU bubble ratio: 38.84%
[rank2]:2025-10-29 01:42:59,705 - INFO - Avg. fwd time: 15.0590 / Avg. bwd time: 18.9451 / Avg. batch time: 465.0491 (ms) / GPU bubble ratio: 41.50%
[rank0]:2025-10-29 01:42:59,746 - INFO - Avg. fwd time: 15.3229 / Avg. bwd time: 6.0843 / Avg. batch time: 527.0294 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-10-29 01:43:14,868 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:14,868 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:14,869 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:43:19,824 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:43:35,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:35,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:35,375 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:43:40,355 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:55,935 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:55,934 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:43:55,934 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:00,919 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:21,500 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:35,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:37,098 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank1]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:44:37,098 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank0]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:37,099 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank3]:2025-10-29 01:44:42,119 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:42,127 - INFO -  step: 1700  loss:  0.1070  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank2]:2025-10-29 01:44:42,212 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0144_stage2_step1700.svg
[rank1]:2025-10-29 01:44:42,212 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0144_stage1_step1700.svg
[rank0]:2025-10-29 01:44:42,213 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0144_stage0_step1700.svg
[rank3]:2025-10-29 01:44:42,319 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0144_real_step1700_rank3.svg
[rank3]:> Batch Time: 377.10 ms, GPU Bubble Ratio: 64.81%, 23.91%, 33.09%, 23.74%
[rank3]:2025-10-29 01:44:42,387 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0144_stage3_step1700.svg
[rank0]:2025-10-29 01:44:42,305 - INFO - Avg. fwd time: 15.3215 / Avg. bwd time: 5.9528 / Avg. batch time: 526.1448 (ms) / GPU bubble ratio: 67.65%
[rank2]:2025-10-29 01:44:42,653 - INFO - Avg. fwd time: 15.0598 / Avg. bwd time: 18.8710 / Avg. batch time: 464.3872 (ms) / GPU bubble ratio: 41.55%
[rank3]:2025-10-29 01:44:42,631 - INFO - Avg. fwd time: 16.6515 / Avg. bwd time: 22.1403 / Avg. batch time: 325.7958 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 01:44:42,677 - INFO - Avg. fwd time: 17.2130 / Avg. bwd time: 21.2947 / Avg. batch time: 504.0355 (ms) / GPU bubble ratio: 38.88%
[rank1]:2025-10-29 01:44:57,910 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:57,910 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:57,911 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:02,868 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:18,409 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:18,408 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:18,408 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:23,396 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:44,017 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:59,496 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:59,496 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:59,497 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:04,581 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:18,593 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:46:20,140 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank1]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:46:20,140 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank0]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:20,141 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank3]:2025-10-29 01:46:25,217 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:25,222 - INFO -  step: 1750  loss:  0.1009  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,946  tflops: 370.61  mfu: 37.47%
[rank3]:2025-10-29 01:46:25,614 - INFO - Avg. fwd time: 16.6510 / Avg. bwd time: 22.0385 / Avg. batch time: 324.9694 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:46:25,663 - INFO - Avg. fwd time: 15.0614 / Avg. bwd time: 18.7897 / Avg. batch time: 463.2151 (ms) / GPU bubble ratio: 41.54%
[rank1]:2025-10-29 01:46:25,709 - INFO - Avg. fwd time: 17.2157 / Avg. bwd time: 21.2039 / Avg. batch time: 502.7728 (ms) / GPU bubble ratio: 38.87%
[rank0]:2025-10-29 01:46:25,741 - INFO - Avg. fwd time: 15.3203 / Avg. bwd time: 5.8080 / Avg. batch time: 524.7274 (ms) / GPU bubble ratio: 67.79%
[rank2]:2025-10-29 01:46:51,259 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:46:51,262 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:51,266 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:56,345 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:11,845 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:11,845 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:11,846 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:17,091 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:37,786 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:53,329 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:53,329 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:53,330 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:58,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:12,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:48:13,912 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank2]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 01:48:13,912 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank1]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:48:13,913 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank0]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 01:48:18,937 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:48:18,942 - INFO -  step: 1800  loss:  0.0894  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,204  tflops: 335.99  mfu: 33.97%
[rank3]:2025-10-29 01:48:18,943 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:48:35,449 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,020
[rank2]:2025-10-29 01:48:35,510 - INFO - validate step: 1800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,966
[rank1]:2025-10-29 01:48:35,487 - INFO - validate step: 1800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,986
[rank3]:2025-10-29 01:48:35,533 - INFO - validate step: 1800  loss:  0.2347  memory: 83.85GiB(59.97%)  tps: 24,690
[rank2]:2025-10-29 01:48:35,620 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0148_stage2_step1800.svg
[rank1]:2025-10-29 01:48:35,621 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0148_stage1_step1800.svg
[rank0]:2025-10-29 01:48:35,617 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0148_stage0_step1800.svg
[rank3]:2025-10-29 01:48:35,726 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0148_real_step1800_rank3.svg
[rank3]:> Batch Time: 376.45 ms, GPU Bubble Ratio: 64.80%, 23.83%, 33.03%, 23.77%
[rank3]:2025-10-29 01:48:35,794 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0148_stage3_step1800.svg
[rank2]:2025-10-29 01:48:36,134 - INFO - Avg. fwd time: 15.0503 / Avg. bwd time: 18.8259 / Avg. batch time: 463.9305 (ms) / GPU bubble ratio: 41.58%
[rank1]:2025-10-29 01:48:36,162 - INFO - Avg. fwd time: 17.2035 / Avg. bwd time: 21.2448 / Avg. batch time: 503.5285 (ms) / GPU bubble ratio: 38.91%
[rank3]:2025-10-29 01:48:36,108 - INFO - Avg. fwd time: 16.6359 / Avg. bwd time: 22.0752 / Avg. batch time: 325.1348 (ms) / GPU bubble ratio: 4.75%
[rank0]:2025-10-29 01:48:36,171 - INFO - Avg. fwd time: 15.3080 / Avg. bwd time: 5.8776 / Avg. batch time: 525.5484 (ms) / GPU bubble ratio: 67.75%
[rank1]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:48:56,542 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:12,052 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:12,052 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:12,053 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:17,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:32,626 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:32,625 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:32,626 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:37,624 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:58,247 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:12,196 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:13,756 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,333  tflops: 388.66  mfu: 39.30%
[rank2]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:13,755 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,338  tflops: 388.90  mfu: 39.32%
[rank1]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:13,755 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,336  tflops: 388.81  mfu: 39.31%
[rank0]:2025-10-29 01:50:13,848 - INFO - Avg. fwd time: 15.3080 / Avg. bwd time: 5.7619 / Avg. batch time: 524.8044 (ms) / GPU bubble ratio: 67.88%
[rank3]:2025-10-29 01:50:18,781 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:18,786 - INFO -  step: 1850  loss:  0.0879  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,934  tflops: 370.05  mfu: 37.42%
[rank3]:2025-10-29 01:50:19,037 - INFO - Avg. fwd time: 16.6368 / Avg. bwd time: 21.9954 / Avg. batch time: 324.4975 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:50:19,057 - INFO - Avg. fwd time: 15.0522 / Avg. bwd time: 18.7617 / Avg. batch time: 463.3783 (ms) / GPU bubble ratio: 41.62%
[rank1]:2025-10-29 01:50:19,083 - INFO - Avg. fwd time: 17.2072 / Avg. bwd time: 21.1734 / Avg. batch time: 502.9077 (ms) / GPU bubble ratio: 38.95%
[rank0]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:39,392 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:54,953 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:54,953 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:54,954 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:59,936 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:15,478 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:15,478 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:15,479 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:51:20,451 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:36,077 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:36,077 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:36,078 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:51:41,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:54,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:51:56,549 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank2]:2025-10-29 01:51:56,548 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank1]:2025-10-29 01:51:56,548 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank3]:2025-10-29 01:52:01,562 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:01,567 - INFO -  step: 1900  loss:  0.0774  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,971  tflops: 371.75  mfu: 37.59%
[rank0]:2025-10-29 01:52:01,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0151_stage0_step1900.svg
[rank2]:2025-10-29 01:52:01,653 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0151_stage2_step1900.svg
[rank1]:2025-10-29 01:52:01,656 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0151_stage1_step1900.svg
[rank0]:2025-10-29 01:52:01,744 - INFO - Avg. fwd time: 15.3071 / Avg. bwd time: 5.6338 / Avg. batch time: 524.1678 (ms) / GPU bubble ratio: 68.04%
[rank3]:2025-10-29 01:52:01,761 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0152_real_step1900_rank3.svg
[rank3]:> Batch Time: 375.89 ms, GPU Bubble Ratio: 64.79%, 23.76%, 32.98%, 23.81%
[rank3]:2025-10-29 01:52:01,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0152_stage3_step1900.svg
[rank2]:2025-10-29 01:52:02,103 - INFO - Avg. fwd time: 15.0538 / Avg. bwd time: 18.6906 / Avg. batch time: 462.9579 (ms) / GPU bubble ratio: 41.69%
[rank1]:2025-10-29 01:52:02,128 - INFO - Avg. fwd time: 17.2096 / Avg. bwd time: 21.0935 / Avg. batch time: 502.4080 (ms) / GPU bubble ratio: 39.01%
[rank3]:2025-10-29 01:52:02,082 - INFO - Avg. fwd time: 16.6365 / Avg. bwd time: 21.9063 / Avg. batch time: 323.7754 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:22,333 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:42,877 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:52:58,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:58,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:58,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:03,370 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:23,990 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:47,302 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:53:49,946 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:53:49,947 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 64.67GiB(46.25%)  tps: 7,224  tflops: 336.93  mfu: 34.07%
[rank1]:2025-10-29 01:53:49,949 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:53:49,949 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 72.68GiB(51.98%)  tps: 7,224  tflops: 336.93  mfu: 34.07%
[rank0]:2025-10-29 01:53:49,953 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:49,954 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 66.72GiB(47.72%)  tps: 7,224  tflops: 336.92  mfu: 34.07%
[rank3]:2025-10-29 01:53:55,005 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:55,010 - INFO -  step: 1950  loss:  0.1055  grad_norm:  0.1606  memory: 83.85GiB(59.97%)  tps: 7,221  tflops: 336.81  mfu: 34.06%
[rank3]:2025-10-29 01:53:55,330 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 21.9439 / Avg. batch time: 323.9656 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:53:55,357 - INFO - Avg. fwd time: 15.0445 / Avg. bwd time: 18.7262 / Avg. batch time: 463.5589 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 01:53:55,387 - INFO - Avg. fwd time: 17.1992 / Avg. bwd time: 21.1340 / Avg. batch time: 503.0478 (ms) / GPU bubble ratio: 39.04%
[rank0]:2025-10-29 01:53:55,400 - INFO - Avg. fwd time: 15.2969 / Avg. bwd time: 5.7024 / Avg. batch time: 524.8734 (ms) / GPU bubble ratio: 67.99%
[rank2]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:15,644 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:54:31,303 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:31,303 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:31,304 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:36,524 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:57,082 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:55:12,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:55:12,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:12,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:55:17,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:31,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:55:33,339 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:33,339 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,924  tflops: 369.57  mfu: 37.37%
[rank0]:2025-10-29 01:55:33,339 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 01:55:33,338 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:55:33,338 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,923  tflops: 369.54  mfu: 37.37%
[rank2]:2025-10-29 01:55:33,338 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 01:55:33,338 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:55:33,338 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,923  tflops: 369.55  mfu: 37.37%
[rank1]:2025-10-29 01:55:33,338 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 01:55:38,439 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:55:38,449 - INFO -  step: 2000  loss:  0.1163  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,920  tflops: 369.38  mfu: 37.35%
[rank3]:2025-10-29 01:55:38,449 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 01:55:54,910 - INFO - validate step: 2000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,988
[rank0]:2025-10-29 01:55:54,873 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,021
[rank2]:2025-10-29 01:55:54,940 - INFO - validate step: 2000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,962
[rank3]:2025-10-29 01:55:54,963 - INFO - validate step: 2000  loss:  0.2348  memory: 83.85GiB(59.97%)  tps: 24,803
[rank0]:2025-10-29 01:55:55,051 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0155_stage0_step2000.svg
[rank2]:2025-10-29 01:55:55,052 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0155_stage2_step2000.svg
[rank1]:2025-10-29 01:55:55,054 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0155_stage1_step2000.svg
[rank3]:2025-10-29 01:55:55,157 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0155_real_step2000_rank3.svg
[rank3]:> Batch Time: 375.46 ms, GPU Bubble Ratio: 64.78%, 23.71%, 32.94%, 23.82%
[rank0]:2025-10-29 01:55:55,143 - INFO - Avg. fwd time: 15.2962 / Avg. bwd time: 5.5993 / Avg. batch time: 524.2330 (ms) / GPU bubble ratio: 68.11%
[rank3]:2025-10-29 01:55:55,228 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0155_stage3_step2000.svg
[rank2]:2025-10-29 01:55:55,501 - INFO - Avg. fwd time: 15.0459 / Avg. bwd time: 18.6690 / Avg. batch time: 463.0918 (ms) / GPU bubble ratio: 41.76%
[rank1]:2025-10-29 01:55:55,526 - INFO - Avg. fwd time: 17.2014 / Avg. bwd time: 21.0700 / Avg. batch time: 502.5178 (ms) / GPU bubble ratio: 39.07%
[rank3]:2025-10-29 01:55:55,480 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 21.8723 / Avg. batch time: 323.3885 (ms) / GPU bubble ratio: 4.77%
[rank0]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:16,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:37,132 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:57,843 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:13,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:57:13,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:13,381 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:18,521 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:32,627 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 01:57:34,189 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,254  tflops: 384.96  mfu: 38.92%
[rank1]:2025-10-29 01:57:34,190 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,251  tflops: 384.85  mfu: 38.91%
[rank0]:2025-10-29 01:57:34,190 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,248  tflops: 384.70  mfu: 38.90%
[rank0]:2025-10-29 01:57:34,283 - INFO - Avg. fwd time: 15.2967 / Avg. bwd time: 5.4848 / Avg. batch time: 523.2208 (ms) / GPU bubble ratio: 68.23%
[rank3]:2025-10-29 01:57:39,313 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:39,317 - INFO -  step: 2050  loss:  0.1540  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,850  tflops: 366.14  mfu: 37.02%
[rank2]:2025-10-29 01:57:39,584 - INFO - Avg. fwd time: 15.0485 / Avg. bwd time: 18.6053 / Avg. batch time: 462.2713 (ms) / GPU bubble ratio: 41.76%
[rank1]:2025-10-29 01:57:39,609 - INFO - Avg. fwd time: 17.2058 / Avg. bwd time: 20.9992 / Avg. batch time: 501.6275 (ms) / GPU bubble ratio: 39.07%
[rank3]:2025-10-29 01:57:39,563 - INFO - Avg. fwd time: 16.6250 / Avg. bwd time: 21.7942 / Avg. batch time: 322.7695 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 01:57:54,805 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:54,805 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:54,806 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:59,929 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:15,523 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:15,523 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:15,524 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:58:20,653 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:36,282 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:36,281 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:36,282 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:58:41,440 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:02,092 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:16,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:17,710 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank2]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:59:17,709 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank1]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:17,709 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank3]:2025-10-29 01:59:22,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:22,845 - INFO -  step: 2100  loss:  0.1347  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,913  tflops: 369.06  mfu: 37.32%
[rank0]:2025-10-29 01:59:22,926 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0159_stage0_step2100.svg
[rank2]:2025-10-29 01:59:22,928 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0159_stage2_step2100.svg
[rank1]:2025-10-29 01:59:22,929 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0159_stage1_step2100.svg
[rank3]:2025-10-29 01:59:23,040 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0159_real_step2100_rank3.svg
[rank3]:> Batch Time: 375.18 ms, GPU Bubble Ratio: 64.78%, 23.68%, 32.91%, 23.82%
[rank3]:2025-10-29 01:59:23,104 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0159_stage3_step2100.svg
[rank3]:2025-10-29 01:59:23,416 - INFO - Avg. fwd time: 16.6257 / Avg. bwd time: 21.7194 / Avg. batch time: 322.1710 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 01:59:23,472 - INFO - Avg. fwd time: 17.2086 / Avg. bwd time: 20.9313 / Avg. batch time: 501.3240 (ms) / GPU bubble ratio: 39.14%
[rank2]:2025-10-29 01:59:23,443 - INFO - Avg. fwd time: 15.0504 / Avg. bwd time: 18.5450 / Avg. batch time: 462.0348 (ms) / GPU bubble ratio: 41.83%
[rank0]:2025-10-29 01:59:23,484 - INFO - Avg. fwd time: 15.2965 / Avg. bwd time: 5.3760 / Avg. batch time: 522.8021 (ms) / GPU bubble ratio: 68.37%
[rank2]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:43,844 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:59,376 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:59:59,375 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:59,375 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:04,554 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:00:20,187 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:00:20,186 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:00:20,186 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:25,372 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:46,033 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:09,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:01:12,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:12,021 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 66.72GiB(47.72%)  tps: 7,166  tflops: 334.24  mfu: 33.80%
[rank2]:2025-10-29 02:01:12,014 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:01:12,015 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 64.67GiB(46.25%)  tps: 7,167  tflops: 334.26  mfu: 33.80%
[rank1]:2025-10-29 02:01:12,017 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:12,017 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 72.68GiB(51.98%)  tps: 7,167  tflops: 334.25  mfu: 33.80%
[rank0]:2025-10-29 02:01:12,117 - INFO - Avg. fwd time: 15.2919 / Avg. bwd time: 5.3777 / Avg. batch time: 522.8968 (ms) / GPU bubble ratio: 68.38%
[rank3]:2025-10-29 02:01:17,170 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:17,175 - INFO -  step: 2150  loss:  0.1752  grad_norm:  0.1753  memory: 83.85GiB(59.97%)  tps: 7,165  tflops: 334.19  mfu: 33.79%
[rank3]:2025-10-29 02:01:17,426 - INFO - Avg. fwd time: 16.6200 / Avg. bwd time: 21.7160 / Avg. batch time: 322.0939 (ms) / GPU bubble ratio: 4.78%
[rank2]:2025-10-29 02:01:17,448 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.5449 / Avg. batch time: 462.1323 (ms) / GPU bubble ratio: 41.85%
[rank1]:2025-10-29 02:01:17,473 - INFO - Avg. fwd time: 17.2046 / Avg. bwd time: 20.9311 / Avg. batch time: 501.4204 (ms) / GPU bubble ratio: 39.16%
[rank2]:2025-10-29 02:01:32,798 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:32,798 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:32,799 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:37,937 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:58,595 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:14,216 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:14,216 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:14,217 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:02:19,366 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:34,912 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:34,911 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:34,911 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:02:40,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:54,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:02:55,593 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:55,593 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,910  tflops: 368.90  mfu: 37.30%
[rank0]:2025-10-29 02:02:55,593 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:02:55,592 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:55,592 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,909  tflops: 368.88  mfu: 37.30%
[rank2]:2025-10-29 02:02:55,593 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 02:02:55,592 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:55,592 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank1]:2025-10-29 02:02:55,592 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 02:03:00,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:00,741 - INFO -  step: 2200  loss:  0.1032  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,910  tflops: 368.93  mfu: 37.30%
[rank3]:2025-10-29 02:03:00,741 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 02:03:17,285 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,883
[rank2]:2025-10-29 02:03:17,341 - INFO - validate step: 2200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,833
[rank1]:2025-10-29 02:03:17,322 - INFO - validate step: 2200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,850
[rank3]:2025-10-29 02:03:17,365 - INFO - validate step: 2200  loss:  0.2347  memory: 83.85GiB(59.97%)  tps: 24,640
[rank0]:2025-10-29 02:03:17,451 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0203_stage0_step2200.svg
[rank2]:2025-10-29 02:03:17,447 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0203_stage2_step2200.svg
[rank1]:2025-10-29 02:03:17,447 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0203_stage1_step2200.svg
[rank0]:2025-10-29 02:03:17,547 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.3563 / Avg. batch time: 523.0181 (ms) / GPU bubble ratio: 68.42%
[rank3]:2025-10-29 02:03:17,568 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0203_real_step2200_rank3.svg
[rank3]:> Batch Time: 374.88 ms, GPU Bubble Ratio: 64.78%, 23.66%, 32.89%, 23.82%
[rank3]:2025-10-29 02:03:17,632 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0203_stage3_step2200.svg
[rank2]:2025-10-29 02:03:17,904 - INFO - Avg. fwd time: 15.0434 / Avg. bwd time: 18.5324 / Avg. batch time: 462.2936 (ms) / GPU bubble ratio: 41.90%
[rank3]:2025-10-29 02:03:17,884 - INFO - Avg. fwd time: 16.6145 / Avg. bwd time: 21.6970 / Avg. batch time: 321.8930 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 02:03:17,930 - INFO - Avg. fwd time: 17.2012 / Avg. bwd time: 20.9172 / Avg. batch time: 501.5683 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 02:03:33,333 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:03:33,332 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:03:33,332 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:39,009 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:03:54,540 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:03:54,539 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:03:54,539 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:59,597 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:15,199 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:15,198 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:15,198 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:04:20,237 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:35,884 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:35,883 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:35,883 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:04:40,953 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:54,929 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:56,494 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,262  tflops: 385.34  mfu: 38.96%
[rank0]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:56,495 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,257  tflops: 385.12  mfu: 38.94%
[rank1]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:56,494 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,260  tflops: 385.27  mfu: 38.96%
[rank3]:2025-10-29 02:05:01,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:01,542 - INFO -  step: 2250  loss:  0.1395  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,864  tflops: 366.77  mfu: 37.08%
[rank2]:2025-10-29 02:05:01,889 - INFO - Avg. fwd time: 15.0453 / Avg. bwd time: 18.4779 / Avg. batch time: 462.0968 (ms) / GPU bubble ratio: 41.96%
[rank3]:2025-10-29 02:05:01,860 - INFO - Avg. fwd time: 16.6157 / Avg. bwd time: 21.6296 / Avg. batch time: 321.3583 (ms) / GPU bubble ratio: 4.79%
[rank0]:2025-10-29 02:05:01,935 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.2577 / Avg. batch time: 522.6588 (ms) / GPU bubble ratio: 68.55%
[rank1]:2025-10-29 02:05:01,921 - INFO - Avg. fwd time: 17.2039 / Avg. bwd time: 20.8565 / Avg. batch time: 501.3118 (ms) / GPU bubble ratio: 39.26%
[rank0]:2025-10-29 02:05:17,221 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:17,220 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:17,220 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:22,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:43,003 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:58,536 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:58,536 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:05:58,537 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:03,614 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:06:19,263 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:19,264 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:06:19,263 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:24,495 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:38,418 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:06:39,984 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank0]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:39,985 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank1]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:06:39,984 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank3]:2025-10-29 02:06:45,122 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:45,127 - INFO -  step: 2300  loss:  0.0946  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,909  tflops: 368.86  mfu: 37.30%
[rank0]:2025-10-29 02:06:45,212 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0206_stage0_step2300.svg
[rank1]:2025-10-29 02:06:45,210 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0206_stage1_step2300.svg
[rank2]:2025-10-29 02:06:45,211 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0206_stage2_step2300.svg
[rank3]:2025-10-29 02:06:45,324 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0206_real_step2300_rank3.svg
[rank3]:> Batch Time: 374.71 ms, GPU Bubble Ratio: 64.78%, 23.64%, 32.88%, 23.84%
[rank0]:2025-10-29 02:06:45,304 - INFO - Avg. fwd time: 15.2869 / Avg. bwd time: 5.1768 / Avg. batch time: 522.1612 (ms) / GPU bubble ratio: 68.65%
[rank3]:2025-10-29 02:06:45,386 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0206_stage3_step2300.svg
[rank2]:2025-10-29 02:06:45,657 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.4327 / Avg. batch time: 461.7354 (ms) / GPU bubble ratio: 41.99%
[rank3]:2025-10-29 02:06:45,635 - INFO - Avg. fwd time: 16.6164 / Avg. bwd time: 21.5737 / Avg. batch time: 320.9134 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 02:06:45,683 - INFO - Avg. fwd time: 17.2061 / Avg. bwd time: 20.8058 / Avg. batch time: 500.8995 (ms) / GPU bubble ratio: 39.29%
[rank1]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:06,120 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:26,860 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:42,354 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:07:42,353 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:42,353 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:47,518 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:03,134 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:08:03,134 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:03,135 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:08:08,259 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:22,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:08:23,833 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:23,833 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,888  tflops: 367.91  mfu: 37.20%
[rank2]:2025-10-29 02:08:23,833 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:08:23,833 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,888  tflops: 367.91  mfu: 37.20%
[rank0]:2025-10-29 02:08:23,834 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:23,834 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,888  tflops: 367.92  mfu: 37.20%
[rank3]:2025-10-29 02:08:28,935 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:08:28,941 - INFO -  step: 2350  loss:  0.1287  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,891  tflops: 368.05  mfu: 37.21%
[rank2]:2025-10-29 02:08:29,389 - INFO - Avg. fwd time: 15.0485 / Avg. bwd time: 18.3823 / Avg. batch time: 460.9888 (ms) / GPU bubble ratio: 41.98%
[rank3]:2025-10-29 02:08:29,343 - INFO - Avg. fwd time: 16.6171 / Avg. bwd time: 21.5113 / Avg. batch time: 320.4153 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 02:08:29,437 - INFO - Avg. fwd time: 17.2085 / Avg. bwd time: 20.7494 / Avg. batch time: 500.0973 (ms) / GPU bubble ratio: 39.28%
[rank0]:2025-10-29 02:08:29,468 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.0863 / Avg. batch time: 521.2630 (ms) / GPU bubble ratio: 68.73%
[rank2]:2025-10-29 02:08:54,886 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:54,893 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:54,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:00,000 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:15,666 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:15,665 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:15,665 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:20,795 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:36,292 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:36,292 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:36,293 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:41,420 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:10:02,111 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:10:16,140 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:10:17,720 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank1]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,694  tflops: 358.85  mfu: 35.22%
[rank1]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:10:17,720 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank2]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,695  tflops: 358.87  mfu: 35.22%
[rank2]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:10:17,721 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank0]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,693  tflops: 358.82  mfu: 35.22%
[rank0]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 02:10:22,859 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:10:22,869 - INFO -  step: 2400  loss:  0.1134  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,191  tflops: 335.37  mfu: 33.91%
[rank3]:2025-10-29 02:10:22,870 - INFO -  final step: 2400  loss:  0.1134  grad_norm:  0.0000  tps: 7,612  tflops: 355.01  mfu: 34.83%
[rank3]:2025-10-29 02:10:22,870 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:10:39,420 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,877
[rank0]:2025-10-29 02:10:39,420 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:10:39,424 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 02:10:39,458 - INFO - validate step: 2400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,843
[rank1]:2025-10-29 02:10:39,460 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:10:39,467 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 02:10:39,474 - INFO - validate step: 2400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,829
[rank2]:2025-10-29 02:10:39,475 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:10:39,478 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 02:10:39,498 - INFO - validate step: 2400  loss:  0.2336  memory: 83.85GiB(59.97%)  tps: 24,634
[rank3]:2025-10-29 02:10:39,499 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 02:10:39,502 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 02:10:49,767 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 02:10:49,859 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0210_stage1_final2400.svg
[rank2]:2025-10-29 02:10:49,857 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0210_stage2_final2400.svg
[rank0]:2025-10-29 02:10:49,885 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0210_stage0_final2400.svg
[rank3]:2025-10-29 02:10:49,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0210_real_final2400_rank3.svg
[rank3]:> Batch Time: 374.49 ms, GPU Bubble Ratio: 64.79%, 23.62%, 32.87%, 23.83%
[rank2]:2025-10-29 02:10:50,094 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank2_stage2.svg
[rank2]:	> Counts Sum: 15266, Total Sum: 16920 (90.22%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank2]:2025-10-29 02:10:50,094 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 02:10:50,112 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank1_stage1.svg
[rank1]:	> Counts Sum: 17201, Total Sum: 19035 (90.37%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank1]:2025-10-29 02:10:50,112 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 02:10:50,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0210_thry_final2400_rank3.svg
[rank3]:> Batch Time: 533.61 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 02:10:50,235 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0210_stage3_final2400.svg
[rank0]:2025-10-29 02:10:50,285 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank0_stage0.svg
[rank0]:	> Counts Sum: 15481, Total Sum: 17155 (90.24%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank0]:2025-10-29 02:10:50,285 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 02:10:50,467 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank3_stage3.svg
[rank3]:	> Counts Sum: 13975, Total Sum: 15275 (91.49%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48]
[rank3]:2025-10-29 02:10:50,468 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–ƒâ–„â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–‚â–â–„â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–„â–ˆâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–„â–ˆâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.15249
[rank3]:wandb:               final/avg_loss 0.11336
[rank3]:wandb:             final/avg_mfu(%) 34.82821
[rank3]:wandb:             final/avg_tflops 355.00774
[rank3]:wandb:    final/avg_throughput(tps) 7611.63209
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11336
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11336
[rank3]:wandb: loss_metrics/global_max_loss 0.11336
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/em62i16u
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_apf_dm1/20251029-0039/wandb/run-20251029_003928-em62i16u/logs
[rank0]:2025-10-29 02:10:52,285 - INFO - Training completed
[rank0]:2025-10-29 02:10:52,286 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 02:10:52,534 - INFO - Process group destroyed
[rank1]:2025-10-29 02:10:52,496 - INFO - Process group destroyed
[rank2]:2025-10-29 02:10:52,542 - INFO - Process group destroyed
[rank3]:2025-10-29 02:10:52,602 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.5', 'layers.3', 'tok_embeddings', 'layers.2', 'layers.4', 'layers.6', 'layers.7', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.23', 'layers.22', 'layers.24', 'layers.17', 'layers.19', 'layers.18', 'layers.20'}
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.12', 'layers.13', 'layers.16', 'layers.14', 'layers.9', 'layers.8', 'layers.15', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'output', 'norm', 'layers.26', 'layers.28', 'layers.27', 'layers.31', 'layers.30', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 02:18:50 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_apf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] 
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] *****************************************
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 02:18:57,222 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 02:18:57,388 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 02:18:57,507 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 02:18:57,551 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 02:18:58,234 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 02:18:58,236 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:18:58,241 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 02:18:58,294 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 02:18:58,297 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 02:18:58,446 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 02:18:58,448 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 02:18:58,438 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 02:18:58,440 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:19:00,100 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 02:19:00,376 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 02:19:01,996 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-29 02:19:03,528 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 02:19:03,602 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 02:19:03,603 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 02:19:03,628 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 02:19:03,725 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 02:19:03,796 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 02:19:03,796 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 02:19:03,826 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 02:19:03,826 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 02:19:03,923 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:19:03,973 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 02:19:03,996 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 02:19:03,996 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 02:19:04,251 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 02:19:04,251 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 02:19:04,221 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 02:19:04,221 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 2pi1be3k
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1/20251029-0219/wandb/run-20251029_021904-2pi1be3k
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2pi1be3k
[rank3]:2025-10-29 02:19:05,655 - INFO - WandB logging enabled
[rank3]:2025-10-29 02:19:05,659 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 02:19:05,731 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 02:19:05,731 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 02:19:05,957 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-29 02:19:05,958 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:19:05,958 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 02:19:05,956 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 02:19:05,944 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 02:19:05,931 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 02:19:05,932 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 02:19:05,944 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:19:09,177 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 02:19:09,177 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 02:19:09,177 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400.
[rank3]:2025-10-29 02:19:09,270 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank2]:2025-10-29 02:19:09,397 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank1]:2025-10-29 02:19:09,516 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 02:19:18,385 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 02:19:18,385 - INFO - Finished loading the checkpoint in 9.21 seconds.
[rank0]:2025-10-29 02:19:18,385 - INFO - Training starts at step 1
[rank2]:2025-10-29 02:19:22,883 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 44.28GiB(31.67%)  tps: 857  tflops: 39.98  mfu: 4.04%
[rank2]:2025-10-29 02:19:22,884 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 02:19:22,905 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 49.75GiB(35.58%)  tps: 865  tflops: 40.36  mfu: 4.08%
[rank0]:2025-10-29 02:19:22,905 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 02:19:22,886 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 49.69GiB(35.54%)  tps: 849  tflops: 39.58  mfu: 4.00%
[rank1]:2025-10-29 02:19:22,886 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 02:19:22,889 - INFO -  step:  1  loss:  0.8886  grad_norm:  0.5047  memory: 58.03GiB(41.50%)  tps: 954  tflops: 44.48  mfu: 4.50%
[rank3]:2025-10-29 02:19:22,889 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 02:19:41,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,560 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,687 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:21:33,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:21:36,115 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 57.29GiB(40.97%)  tps: 6,026  tflops: 281.04  mfu: 28.42%
[rank0]:2025-10-29 02:21:36,122 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 66.72GiB(47.72%)  tps: 6,026  tflops: 281.07  mfu: 28.42%
[rank1]:2025-10-29 02:21:36,117 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 64.32GiB(46.00%)  tps: 6,026  tflops: 281.04  mfu: 28.42%
[rank3]:2025-10-29 02:21:36,120 - INFO -  step: 50  loss:  0.7675  grad_norm:  0.5268  memory: 73.38GiB(52.48%)  tps: 6,026  tflops: 281.05  mfu: 28.42%
[rank2]:2025-10-29 02:21:36,635 - INFO - Avg. fwd time: 13.3965 / Avg. bwd time: 36.5105 / Avg. batch time: 537.8620 (ms) / GPU bubble ratio: 25.77%
[rank3]:2025-10-29 02:21:36,584 - INFO - Avg. fwd time: 14.8153 / Avg. bwd time: 43.1820 / Avg. batch time: 484.3336 (ms) / GPU bubble ratio: 4.20%
[rank0]:2025-10-29 02:21:36,715 - INFO - Avg. fwd time: 14.3545 / Avg. bwd time: 38.6574 / Avg. batch time: 655.2174 (ms) / GPU bubble ratio: 35.27%
[rank1]:2025-10-29 02:21:36,682 - INFO - Avg. fwd time: 15.6435 / Avg. bwd time: 42.0094 / Avg. batch time: 599.0835 (ms) / GPU bubble ratio: 23.01%
[rank2]:2025-10-29 02:22:03,259 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:03,266 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:03,261 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:04,417 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:22:21,224 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:21,225 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:21,225 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:26,758 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:53,790 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:22:53,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:53,786 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:59,364 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:23:21,409 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:36,367 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:38,027 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,720  tflops: 313.42  mfu: 31.69%
[rank2]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:23:38,027 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0030  memory: 64.67GiB(46.25%)  tps: 6,720  tflops: 313.40  mfu: 31.69%
[rank1]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:23:38,028 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0030  memory: 72.68GiB(51.98%)  tps: 6,720  tflops: 313.41  mfu: 31.69%
[rank3]:2025-10-29 02:23:43,545 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:23:43,550 - INFO -  step: 100  loss:  0.8954  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,429  tflops: 299.84  mfu: 30.32%
[rank2]:2025-10-29 02:23:43,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0223_stage2_step100.svg
[rank0]:2025-10-29 02:23:43,627 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0223_stage0_step100.svg
[rank1]:2025-10-29 02:23:43,625 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0223_stage1_step100.svg
[rank3]:2025-10-29 02:23:43,748 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0223_real_step100_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.11%, 27.02%, 36.69%, 26.72%
[rank3]:2025-10-29 02:23:43,807 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0223_stage3_step100.svg
[rank3]:2025-10-29 02:23:44,221 - INFO - Avg. fwd time: 15.6045 / Avg. bwd time: 36.4549 / Avg. batch time: 434.4065 (ms) / GPU bubble ratio: 4.13%
[rank2]:2025-10-29 02:23:44,272 - INFO - Avg. fwd time: 14.0946 / Avg. bwd time: 30.8596 / Avg. batch time: 526.7763 (ms) / GPU bubble ratio: 31.73%
[rank1]:2025-10-29 02:23:44,319 - INFO - Avg. fwd time: 16.4497 / Avg. bwd time: 35.5277 / Avg. batch time: 581.5286 (ms) / GPU bubble ratio: 28.50%
[rank0]:2025-10-29 02:23:44,353 - INFO - Avg. fwd time: 14.8084 / Avg. bwd time: 27.7423 / Avg. batch time: 626.3358 (ms) / GPU bubble ratio: 45.65%
[rank2]:2025-10-29 02:24:10,799 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:10,806 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:10,802 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:24:16,328 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:24:32,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:32,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:32,971 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:24:38,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:24:55,036 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:55,037 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:55,036 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:00,519 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:25:17,169 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:17,170 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:25:17,169 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:22,572 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:46,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:25:49,634 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:25:49,634 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 64.67GiB(46.25%)  tps: 6,225  tflops: 290.32  mfu: 29.35%
[rank0]:2025-10-29 02:25:49,641 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:49,641 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 66.72GiB(47.72%)  tps: 6,224  tflops: 290.30  mfu: 29.35%
[rank1]:2025-10-29 02:25:49,637 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:25:49,637 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 72.68GiB(51.98%)  tps: 6,224  tflops: 290.31  mfu: 29.35%
[rank3]:2025-10-29 02:25:55,135 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:55,139 - INFO -  step: 150  loss:  0.8346  grad_norm:  0.5343  memory: 83.85GiB(59.97%)  tps: 6,226  tflops: 290.36  mfu: 29.36%
[rank2]:2025-10-29 02:25:55,498 - INFO - Avg. fwd time: 14.3489 / Avg. bwd time: 28.5081 / Avg. batch time: 533.2337 (ms) / GPU bubble ratio: 35.70%
[rank0]:2025-10-29 02:25:55,527 - INFO - Avg. fwd time: 14.9903 / Avg. bwd time: 23.3595 / Avg. batch time: 625.5779 (ms) / GPU bubble ratio: 50.96%
[rank1]:2025-10-29 02:25:55,522 - INFO - Avg. fwd time: 16.7421 / Avg. bwd time: 32.8208 / Avg. batch time: 585.2950 (ms) / GPU bubble ratio: 32.26%
[rank3]:2025-10-29 02:25:55,477 - INFO - Avg. fwd time: 15.9195 / Avg. bwd time: 33.6594 / Avg. batch time: 413.6318 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:26:17,233 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:33,922 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:33,923 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:26:33,922 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:26:39,362 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:56,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:56,033 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:26:56,032 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:01,479 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:23,530 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:47,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:27:50,650 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:27:50,650 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 72.68GiB(51.98%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank1]:2025-10-29 02:27:50,650 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 02:27:50,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:27:50,647 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 64.67GiB(46.25%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank2]:2025-10-29 02:27:50,648 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:27:50,654 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:50,654 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 66.72GiB(47.72%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank0]:2025-10-29 02:27:50,654 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 02:27:56,136 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:56,140 - INFO -  step: 200  loss:  0.8445  grad_norm:  0.7066  memory: 83.85GiB(59.97%)  tps: 6,770  tflops: 315.77  mfu: 31.93%
[rank3]:2025-10-29 02:27:56,140 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:28:14,728 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 17,015
[rank1]:2025-10-29 02:28:14,765 - INFO - validate step: 200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 16,986
[rank2]:2025-10-29 02:28:14,779 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 16,974
[rank2]:2025-10-29 02:28:14,861 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0228_stage2_step200.svg
[rank1]:2025-10-29 02:28:14,867 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0228_stage1_step200.svg
[rank3]:2025-10-29 02:28:14,791 - INFO - validate step: 200  loss:  0.2454  memory: 83.85GiB(59.97%)  tps: 21,962
[rank0]:2025-10-29 02:28:14,866 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0228_stage0_step200.svg
[rank3]:2025-10-29 02:28:14,977 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0228_real_step200_rank3.svg
[rank3]:> Batch Time: 385.74 ms, GPU Bubble Ratio: 65.03%, 23.32%, 33.44%, 23.73%
[rank0]:2025-10-29 02:28:14,967 - INFO - Avg. fwd time: 15.1781 / Avg. bwd time: 19.2522 / Avg. batch time: 607.6521 (ms) / GPU bubble ratio: 54.67%
[rank3]:2025-10-29 02:28:15,041 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0228_stage3_step200.svg
[rank2]:2025-10-29 02:28:15,330 - INFO - Avg. fwd time: 14.5924 / Avg. bwd time: 26.2714 / Avg. batch time: 522.0555 (ms) / GPU bubble ratio: 37.38%
[rank1]:2025-10-29 02:28:15,356 - INFO - Avg. fwd time: 17.0236 / Avg. bwd time: 30.2450 / Avg. batch time: 571.5864 (ms) / GPU bubble ratio: 33.84%
[rank3]:2025-10-29 02:28:15,308 - INFO - Avg. fwd time: 16.2082 / Avg. bwd time: 31.0038 / Avg. batch time: 394.2941 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-29 02:28:31,676 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:28:31,676 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:28:31,677 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:28:37,126 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:28:59,332 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:16,033 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:29:16,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:29:16,032 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:29:21,523 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:38,155 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:29:38,154 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:29:38,154 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:29:43,545 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:58,609 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:30:00,276 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 66.72GiB(47.72%)  tps: 7,761  tflops: 361.99  mfu: 36.60%
[rank2]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:00,275 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 64.67GiB(46.25%)  tps: 7,765  tflops: 362.17  mfu: 36.62%
[rank1]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:00,275 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 72.68GiB(51.98%)  tps: 7,764  tflops: 362.12  mfu: 36.61%
[rank3]:2025-10-29 02:30:05,659 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:30:05,663 - INFO -  step: 250  loss:  0.9926  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,389  tflops: 344.62  mfu: 34.85%
[rank3]:2025-10-29 02:30:06,072 - INFO - Avg. fwd time: 16.4376 / Avg. bwd time: 29.0020 / Avg. batch time: 379.8405 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-29 02:30:06,124 - INFO - Avg. fwd time: 14.7794 / Avg. bwd time: 24.5756 / Avg. batch time: 509.8560 (ms) / GPU bubble ratio: 38.25%
[rank0]:2025-10-29 02:30:06,202 - INFO - Avg. fwd time: 15.3317 / Avg. bwd time: 16.1396 / Avg. batch time: 590.3369 (ms) / GPU bubble ratio: 57.35%
[rank1]:2025-10-29 02:30:06,169 - INFO - Avg. fwd time: 17.2416 / Avg. bwd time: 28.2990 / Avg. batch time: 557.4667 (ms) / GPU bubble ratio: 34.65%
[rank0]:2025-10-29 02:30:32,701 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:32,694 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:32,696 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:30:38,116 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:00,182 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:16,863 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:31:16,862 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:31:16,862 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:22,274 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:38,890 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:31:38,889 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:31:38,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:44,313 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:59,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:32:00,935 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 72.68GiB(51.98%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank2]:2025-10-29 02:32:00,936 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 64.67GiB(46.25%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank0]:2025-10-29 02:32:00,936 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 66.72GiB(47.72%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank3]:2025-10-29 02:32:06,401 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:06,406 - INFO -  step: 300  loss:  0.9126  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,785  tflops: 316.44  mfu: 32.00%
[rank0]:2025-10-29 02:32:06,476 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0232_stage0_step300.svg
[rank1]:2025-10-29 02:32:06,477 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0232_stage1_step300.svg
[rank2]:2025-10-29 02:32:06,480 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0232_stage2_step300.svg
[rank3]:2025-10-29 02:32:06,601 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0232_real_step300_rank3.svg
[rank3]:> Batch Time: 387.21 ms, GPU Bubble Ratio: 64.80%, 23.28%, 33.66%, 23.89%
[rank3]:2025-10-29 02:32:06,666 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0232_stage3_step300.svg
[rank1]:2025-10-29 02:32:07,047 - INFO - Avg. fwd time: 17.3297 / Avg. bwd time: 27.4308 / Avg. batch time: 556.1645 (ms) / GPU bubble ratio: 35.62%
[rank2]:2025-10-29 02:32:07,024 - INFO - Avg. fwd time: 14.8573 / Avg. bwd time: 23.8247 / Avg. batch time: 509.4368 (ms) / GPU bubble ratio: 39.26%
[rank3]:2025-10-29 02:32:07,001 - INFO - Avg. fwd time: 16.5296 / Avg. bwd time: 28.1142 / Avg. batch time: 373.3002 (ms) / GPU bubble ratio: 4.33%
[rank0]:2025-10-29 02:32:07,053 - INFO - Avg. fwd time: 15.3894 / Avg. bwd time: 14.7703 / Avg. batch time: 587.6251 (ms) / GPU bubble ratio: 58.94%
[rank1]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:28,745 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:50,749 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:33:17,807 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:33:17,804 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:33:17,811 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:33:23,225 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:33:39,854 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:33:39,853 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:33:39,853 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:33:45,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:00,198 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:34:01,865 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 64.67GiB(46.25%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank0]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:01,866 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 66.72GiB(47.72%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank1]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:01,865 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 72.68GiB(51.98%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank0]:2025-10-29 02:34:01,971 - INFO - Avg. fwd time: 15.4174 / Avg. bwd time: 14.0837 / Avg. batch time: 585.7604 (ms) / GPU bubble ratio: 59.71%
[rank3]:2025-10-29 02:34:07,271 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:07,275 - INFO -  step: 350  loss:  0.9350  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,778  tflops: 316.11  mfu: 31.96%
[rank3]:2025-10-29 02:34:07,547 - INFO - Avg. fwd time: 16.5756 / Avg. bwd time: 27.6634 / Avg. batch time: 369.9547 (ms) / GPU bubble ratio: 4.34%
[rank2]:2025-10-29 02:34:07,570 - INFO - Avg. fwd time: 14.8977 / Avg. bwd time: 23.4485 / Avg. batch time: 508.7184 (ms) / GPU bubble ratio: 39.70%
[rank1]:2025-10-29 02:34:07,596 - INFO - Avg. fwd time: 17.3712 / Avg. bwd time: 26.9921 / Avg. batch time: 555.0023 (ms) / GPU bubble ratio: 36.05%
[rank2]:2025-10-29 02:34:23,953 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:23,952 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:23,953 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:29,326 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:51,335 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:07,965 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:07,964 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:07,964 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:13,326 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:29,798 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:29,797 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:29,797 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:35,202 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:49,316 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:35:50,899 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank0]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 02:35:50,898 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank2]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 02:35:50,898 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank1]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:35:56,295 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:56,300 - INFO -  step: 400  loss:  0.1160  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,514  tflops: 350.45  mfu: 35.44%
[rank3]:2025-10-29 02:35:56,300 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 02:36:11,006 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,372
[rank2]:2025-10-29 02:36:11,053 - INFO - validate step: 400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,323
[rank1]:2025-10-29 02:36:11,038 - INFO - validate step: 400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,338
[rank3]:2025-10-29 02:36:11,061 - INFO - validate step: 400  loss:  0.2399  memory: 83.85GiB(59.97%)  tps: 27,751
[rank0]:2025-10-29 02:36:11,139 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0236_stage0_step400.svg
[rank2]:2025-10-29 02:36:11,147 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0236_stage2_step400.svg
[rank1]:2025-10-29 02:36:11,138 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0236_stage1_step400.svg
[rank3]:2025-10-29 02:36:11,251 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0236_real_step400_rank3.svg
[rank3]:> Batch Time: 386.92 ms, GPU Bubble Ratio: 64.72%, 23.28%, 33.66%, 23.91%
[rank3]:2025-10-29 02:36:11,320 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0236_stage3_step400.svg
[rank3]:2025-10-29 02:36:11,711 - INFO - Avg. fwd time: 16.6668 / Avg. bwd time: 26.5514 / Avg. batch time: 361.6866 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-29 02:36:11,760 - INFO - Avg. fwd time: 14.9815 / Avg. bwd time: 22.5179 / Avg. batch time: 503.2190 (ms) / GPU bubble ratio: 40.38%
[rank0]:2025-10-29 02:36:11,840 - INFO - Avg. fwd time: 15.4815 / Avg. bwd time: 12.3770 / Avg. batch time: 577.4496 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-29 02:36:11,807 - INFO - Avg. fwd time: 17.4627 / Avg. bwd time: 25.9188 / Avg. batch time: 548.4461 (ms) / GPU bubble ratio: 36.72%
[rank2]:2025-10-29 02:36:37,297 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:36:37,300 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:36:37,304 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:36:42,752 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:36:58,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:36:58,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:36:58,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:03,827 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:24,858 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:37:40,426 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:37:40,426 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:40,427 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:45,819 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:59,918 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:38:01,479 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 72.68GiB(51.98%)  tps: 7,418  tflops: 345.96  mfu: 34.98%
[rank0]:2025-10-29 02:38:01,480 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 66.72GiB(47.72%)  tps: 7,415  tflops: 345.85  mfu: 34.97%
[rank2]:2025-10-29 02:38:01,479 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 64.67GiB(46.25%)  tps: 7,419  tflops: 346.00  mfu: 34.99%
[rank3]:2025-10-29 02:38:06,865 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:06,869 - INFO -  step: 450  loss:  0.1115  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,074  tflops: 329.93  mfu: 33.36%
[rank3]:2025-10-29 02:38:07,177 - INFO - Avg. fwd time: 16.6018 / Avg. bwd time: 26.1631 / Avg. batch time: 357.9702 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-10-29 02:38:07,231 - INFO - Avg. fwd time: 15.4318 / Avg. bwd time: 11.8969 / Avg. batch time: 575.5848 (ms) / GPU bubble ratio: 62.02%
[rank2]:2025-10-29 02:38:07,199 - INFO - Avg. fwd time: 14.9436 / Avg. bwd time: 22.2235 / Avg. batch time: 502.1686 (ms) / GPU bubble ratio: 40.79%
[rank1]:2025-10-29 02:38:07,224 - INFO - Avg. fwd time: 17.4141 / Avg. bwd time: 25.5858 / Avg. batch time: 547.1176 (ms) / GPU bubble ratio: 37.13%
[rank2]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:27,824 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:43,428 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:38:43,427 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:43,427 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:49,031 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:04,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:04,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:04,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:39:10,275 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:25,850 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:25,851 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:25,850 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:39:31,303 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:54,725 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:39:57,334 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:57,334 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 64.67GiB(46.25%)  tps: 7,071  tflops: 329.79  mfu: 33.35%
[rank1]:2025-10-29 02:39:57,336 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:57,337 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 72.68GiB(51.98%)  tps: 7,071  tflops: 329.78  mfu: 33.35%
[rank0]:2025-10-29 02:39:57,340 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:57,341 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 66.72GiB(47.72%)  tps: 7,071  tflops: 329.77  mfu: 33.34%
[rank3]:2025-10-29 02:40:02,759 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:02,764 - INFO -  step: 500  loss:  0.1032  grad_norm:  0.1305  memory: 83.85GiB(59.97%)  tps: 7,069  tflops: 329.68  mfu: 33.33%
[rank2]:2025-10-29 02:40:02,837 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0239_stage2_step500.svg
[rank1]:2025-10-29 02:40:02,839 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0239_stage1_step500.svg
[rank0]:2025-10-29 02:40:02,836 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0239_stage0_step500.svg
[rank0]:2025-10-29 02:40:02,928 - INFO - Avg. fwd time: 15.4060 / Avg. bwd time: 11.3146 / Avg. batch time: 571.9348 (ms) / GPU bubble ratio: 62.62%
[rank3]:2025-10-29 02:40:02,953 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0240_real_step500_rank3.svg
[rank3]:> Batch Time: 384.93 ms, GPU Bubble Ratio: 64.77%, 23.27%, 33.68%, 23.94%
[rank3]:2025-10-29 02:40:03,015 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0240_stage3_step500.svg
[rank2]:2025-10-29 02:40:03,281 - INFO - Avg. fwd time: 14.9315 / Avg. bwd time: 21.8866 / Avg. batch time: 499.4996 (ms) / GPU bubble ratio: 41.03%
[rank3]:2025-10-29 02:40:03,259 - INFO - Avg. fwd time: 16.5723 / Avg. bwd time: 25.7362 / Avg. batch time: 354.2556 (ms) / GPU bubble ratio: 4.46%
[rank1]:2025-10-29 02:40:03,306 - INFO - Avg. fwd time: 17.3939 / Avg. bwd time: 25.1988 / Avg. batch time: 544.0994 (ms) / GPU bubble ratio: 37.38%
[rank0]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:23,996 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:40:39,621 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:40:39,620 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:40:39,620 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:44,998 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:00,662 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:00,661 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:00,661 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:06,123 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:21,709 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:21,709 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:21,710 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:27,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:41,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:41:42,690 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:42,691 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 7,776  tflops: 362.68  mfu: 36.67%
[rank2]:2025-10-29 02:41:42,689 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:42,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 7,776  tflops: 362.65  mfu: 36.67%
[rank1]:2025-10-29 02:41:42,689 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:42,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 7,776  tflops: 362.66  mfu: 36.67%
[rank0]:2025-10-29 02:41:42,782 - INFO - Avg. fwd time: 15.3879 / Avg. bwd time: 10.6630 / Avg. batch time: 566.0072 (ms) / GPU bubble ratio: 63.18%
[rank3]:2025-10-29 02:41:48,107 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:48,116 - INFO -  step: 550  loss:  0.1058  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,776  tflops: 362.67  mfu: 36.67%
[rank3]:2025-10-29 02:41:48,362 - INFO - Avg. fwd time: 16.5508 / Avg. bwd time: 25.2702 / Avg. batch time: 350.2957 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-10-29 02:41:48,383 - INFO - Avg. fwd time: 14.9253 / Avg. bwd time: 21.5146 / Avg. batch time: 494.6653 (ms) / GPU bubble ratio: 41.07%
[rank1]:2025-10-29 02:41:48,408 - INFO - Avg. fwd time: 17.3811 / Avg. bwd time: 24.7720 / Avg. batch time: 538.8702 (ms) / GPU bubble ratio: 37.42%
[rank2]:2025-10-29 02:42:03,769 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:03,769 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:03,770 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:09,102 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:24,694 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:24,695 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:42:24,694 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:30,041 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:42:45,688 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:45,688 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:45,689 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:51,045 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:43:06,634 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:06,635 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:43:06,634 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:43:12,015 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:35,347 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:43:37,967 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:43:37,967 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 72.68GiB(51.98%)  tps: 7,106  tflops: 331.44  mfu: 33.51%
[rank1]:2025-10-29 02:43:37,967 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:43:37,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:37,972 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 66.72GiB(47.72%)  tps: 7,106  tflops: 331.43  mfu: 33.51%
[rank0]:2025-10-29 02:43:37,972 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 02:43:37,964 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:43:37,965 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 64.67GiB(46.25%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank2]:2025-10-29 02:43:37,965 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 02:43:43,317 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:43:43,321 - INFO -  step: 600  loss:  0.0889  grad_norm:  0.0855  memory: 83.85GiB(59.97%)  tps: 7,111  tflops: 331.65  mfu: 33.53%
[rank3]:2025-10-29 02:43:43,322 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 02:44:00,387 - INFO - validate step: 600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,270
[rank3]:2025-10-29 02:44:00,414 - INFO - validate step: 600  loss:  0.2489  memory: 83.85GiB(59.97%)  tps: 23,965
[rank0]:2025-10-29 02:44:00,350 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,304
[rank2]:2025-10-29 02:44:00,403 - INFO - validate step: 600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,255
[rank0]:2025-10-29 02:44:00,487 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0244_stage0_step600.svg
[rank2]:2025-10-29 02:44:00,491 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0244_stage2_step600.svg
[rank1]:2025-10-29 02:44:00,490 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0244_stage1_step600.svg
[rank3]:2025-10-29 02:44:00,600 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0244_real_step600_rank3.svg
[rank3]:> Batch Time: 382.24 ms, GPU Bubble Ratio: 64.81%, 23.16%, 33.65%, 24.24%
[rank3]:2025-10-29 02:44:00,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0244_stage3_step600.svg
[rank3]:2025-10-29 02:44:00,975 - INFO - Avg. fwd time: 16.5090 / Avg. bwd time: 25.0912 / Avg. batch time: 348.4806 (ms) / GPU bubble ratio: 4.50%
[rank2]:2025-10-29 02:44:00,998 - INFO - Avg. fwd time: 14.8993 / Avg. bwd time: 21.3843 / Avg. batch time: 494.4921 (ms) / GPU bubble ratio: 41.30%
[rank1]:2025-10-29 02:44:01,023 - INFO - Avg. fwd time: 17.3445 / Avg. bwd time: 24.6190 / Avg. batch time: 538.5510 (ms) / GPU bubble ratio: 37.66%
[rank0]:2025-10-29 02:44:01,030 - INFO - Avg. fwd time: 15.3532 / Avg. bwd time: 10.4503 / Avg. batch time: 565.4450 (ms) / GPU bubble ratio: 63.49%
[rank1]:2025-10-29 02:44:16,377 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:16,378 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:16,377 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:44:21,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:37,567 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:44:37,567 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:37,568 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:44:43,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:58,652 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:58,651 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:44:58,651 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:04,122 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:19,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:45:19,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:45:19,784 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:25,245 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:39,261 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:45:40,824 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 8,158  tflops: 380.47  mfu: 38.47%
[rank1]:2025-10-29 02:45:40,824 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 8,156  tflops: 380.41  mfu: 38.46%
[rank0]:2025-10-29 02:45:40,825 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 8,153  tflops: 380.27  mfu: 38.45%
[rank0]:2025-10-29 02:45:40,916 - INFO - Avg. fwd time: 15.3571 / Avg. bwd time: 9.8009 / Avg. batch time: 561.3437 (ms) / GPU bubble ratio: 64.15%
[rank3]:2025-10-29 02:45:46,333 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:46,337 - INFO -  step: 650  loss:  0.0924  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,734  tflops: 360.71  mfu: 36.47%
[rank3]:2025-10-29 02:45:46,584 - INFO - Avg. fwd time: 16.5156 / Avg. bwd time: 24.6446 / Avg. batch time: 344.9238 (ms) / GPU bubble ratio: 4.54%
[rank2]:2025-10-29 02:45:46,605 - INFO - Avg. fwd time: 14.9119 / Avg. bwd time: 21.0200 / Avg. batch time: 491.4400 (ms) / GPU bubble ratio: 41.51%
[rank1]:2025-10-29 02:45:46,630 - INFO - Avg. fwd time: 17.3574 / Avg. bwd time: 24.2039 / Avg. batch time: 535.1345 (ms) / GPU bubble ratio: 37.87%
[rank1]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:07,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:23,024 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:23,023 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:46:23,023 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:28,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:44,020 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:44,019 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:46:44,019 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:49,401 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:05,064 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:05,063 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:05,063 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:47:10,466 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:24,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:47:26,062 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank2]:2025-10-29 02:47:26,061 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank1]:2025-10-29 02:47:26,061 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank3]:2025-10-29 02:47:31,444 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:47:31,448 - INFO -  step: 700  loss:  0.0719  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,794  tflops: 363.50  mfu: 36.75%
[rank1]:2025-10-29 02:47:31,525 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0247_stage1_step700.svg
[rank0]:2025-10-29 02:47:31,524 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0247_stage0_step700.svg
[rank2]:2025-10-29 02:47:31,527 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0247_stage2_step700.svg
[rank3]:2025-10-29 02:47:31,640 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0247_real_step700_rank3.svg
[rank3]:> Batch Time: 380.68 ms, GPU Bubble Ratio: 64.87%, 23.09%, 33.61%, 24.26%
[rank3]:2025-10-29 02:47:31,706 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0247_stage3_step700.svg
[rank3]:2025-10-29 02:47:32,093 - INFO - Avg. fwd time: 16.5205 / Avg. bwd time: 24.1969 / Avg. batch time: 341.3453 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 02:47:32,142 - INFO - Avg. fwd time: 14.9233 / Avg. bwd time: 20.6540 / Avg. batch time: 488.8636 (ms) / GPU bubble ratio: 41.78%
[rank1]:2025-10-29 02:47:32,189 - INFO - Avg. fwd time: 17.3677 / Avg. bwd time: 23.7870 / Avg. batch time: 532.1857 (ms) / GPU bubble ratio: 38.13%
[rank0]:2025-10-29 02:47:32,221 - INFO - Avg. fwd time: 15.3587 / Avg. bwd time: 9.1492 / Avg. batch time: 557.7072 (ms) / GPU bubble ratio: 64.84%
[rank0]:2025-10-29 02:47:57,670 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:57,663 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:57,665 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:03,046 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:48:18,686 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:48:18,685 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:48:18,685 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:24,095 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:48:39,705 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:48:39,704 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:48:39,704 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:45,174 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:00,838 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:49:00,837 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:00,838 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:06,189 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:20,240 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:49:21,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank0]:2025-10-29 02:49:21,812 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank2]:2025-10-29 02:49:21,811 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank3]:2025-10-29 02:49:27,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:27,196 - INFO -  step: 750  loss:  0.1113  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,078  tflops: 330.10  mfu: 33.38%
[rank3]:2025-10-29 02:49:27,508 - INFO - Avg. fwd time: 16.4920 / Avg. bwd time: 24.1298 / Avg. batch time: 340.5512 (ms) / GPU bubble ratio: 4.57%
[rank0]:2025-10-29 02:49:27,564 - INFO - Avg. fwd time: 15.3360 / Avg. bwd time: 9.0860 / Avg. batch time: 557.9307 (ms) / GPU bubble ratio: 64.98%
[rank2]:2025-10-29 02:49:27,531 - INFO - Avg. fwd time: 14.9057 / Avg. bwd time: 20.6099 / Avg. batch time: 489.2213 (ms) / GPU bubble ratio: 41.92%
[rank1]:2025-10-29 02:49:27,556 - INFO - Avg. fwd time: 17.3434 / Avg. bwd time: 23.7335 / Avg. batch time: 532.4885 (ms) / GPU bubble ratio: 38.29%
[rank2]:2025-10-29 02:49:42,801 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:42,802 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:42,802 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:48,156 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:03,837 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:03,838 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:03,837 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:09,241 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:24,814 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:24,813 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:24,813 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:30,252 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:51,238 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:51:05,323 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:51:06,897 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:51:06,897 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 72.68GiB(51.98%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank1]:2025-10-29 02:51:06,897 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:51:06,898 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:51:06,898 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 66.72GiB(47.72%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank0]:2025-10-29 02:51:06,898 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 02:51:06,897 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:51:06,897 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 64.67GiB(46.25%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank2]:2025-10-29 02:51:06,897 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 02:51:12,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:51:12,266 - INFO -  step: 800  loss:  0.1375  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,797  tflops: 363.64  mfu: 36.77%
[rank3]:2025-10-29 02:51:12,266 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:51:28,867 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,645
[rank1]:2025-10-29 02:51:28,903 - INFO - validate step: 800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,613
[rank2]:2025-10-29 02:51:28,920 - INFO - validate step: 800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,599
[rank3]:2025-10-29 02:51:28,931 - INFO - validate step: 800  loss:  0.2563  memory: 83.85GiB(59.97%)  tps: 24,579
[rank1]:2025-10-29 02:51:29,010 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0251_stage1_step800.svg
[rank0]:2025-10-29 02:51:29,011 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0251_stage0_step800.svg
[rank2]:2025-10-29 02:51:29,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0251_stage2_step800.svg
[rank3]:2025-10-29 02:51:29,120 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0251_real_step800_rank3.svg
[rank3]:> Batch Time: 379.35 ms, GPU Bubble Ratio: 64.89%, 23.01%, 33.50%, 24.31%
[rank0]:2025-10-29 02:51:29,101 - INFO - Avg. fwd time: 15.3364 / Avg. bwd time: 8.6363 / Avg. batch time: 554.8642 (ms) / GPU bubble ratio: 65.44%
[rank3]:2025-10-29 02:51:29,188 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0251_stage3_step800.svg
[rank2]:2025-10-29 02:51:29,461 - INFO - Avg. fwd time: 14.9149 / Avg. bwd time: 20.3591 / Avg. batch time: 486.9142 (ms) / GPU bubble ratio: 42.04%
[rank3]:2025-10-29 02:51:29,438 - INFO - Avg. fwd time: 16.4966 / Avg. bwd time: 23.8258 / Avg. batch time: 338.1324 (ms) / GPU bubble ratio: 4.60%
[rank1]:2025-10-29 02:51:29,485 - INFO - Avg. fwd time: 17.3490 / Avg. bwd time: 23.4445 / Avg. batch time: 529.8954 (ms) / GPU bubble ratio: 38.41%
[rank0]:2025-10-29 02:51:44,787 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:51:44,786 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:51:44,786 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:51:50,188 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:52:11,250 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:37,263 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:37,267 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:37,261 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:52:42,889 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:58,499 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:58,498 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:58,498 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:03,996 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:53:18,114 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:53:19,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 7,396  tflops: 344.96  mfu: 34.88%
[rank1]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:53:19,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 7,395  tflops: 344.91  mfu: 34.87%
[rank0]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:53:19,681 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 7,393  tflops: 344.79  mfu: 34.86%
[rank0]:2025-10-29 02:53:19,770 - INFO - Avg. fwd time: 15.3183 / Avg. bwd time: 8.6121 / Avg. batch time: 553.7727 (ms) / GPU bubble ratio: 65.43%
[rank3]:2025-10-29 02:53:25,055 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:25,059 - INFO -  step: 850  loss:  0.1484  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,054  tflops: 329.02  mfu: 33.27%
[rank3]:2025-10-29 02:53:25,300 - INFO - Avg. fwd time: 16.4742 / Avg. bwd time: 23.7917 / Avg. batch time: 337.6580 (ms) / GPU bubble ratio: 4.60%
[rank2]:2025-10-29 02:53:25,322 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 20.3364 / Avg. batch time: 485.8901 (ms) / GPU bubble ratio: 41.98%
[rank1]:2025-10-29 02:53:25,347 - INFO - Avg. fwd time: 17.3316 / Avg. bwd time: 23.4197 / Avg. batch time: 528.8443 (ms) / GPU bubble ratio: 38.35%
[rank0]:2025-10-29 02:53:40,627 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:53:40,626 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:53:40,626 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:45,993 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:01,612 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:01,612 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:01,613 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:07,119 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:22,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:22,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:22,784 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:28,231 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:49,202 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:03,295 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:55:04,850 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank1]:2025-10-29 02:55:04,850 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank0]:2025-10-29 02:55:04,851 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank3]:2025-10-29 02:55:10,297 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:10,305 - INFO -  step: 900  loss:  0.1336  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,784  tflops: 363.04  mfu: 36.71%
[rank1]:2025-10-29 02:55:10,377 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0255_stage1_step900.svg
[rank0]:2025-10-29 02:55:10,378 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0255_stage0_step900.svg
[rank2]:2025-10-29 02:55:10,381 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0255_stage2_step900.svg
[rank3]:2025-10-29 02:55:10,502 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0255_real_step900_rank3.svg
[rank3]:> Batch Time: 378.22 ms, GPU Bubble Ratio: 64.86%, 22.90%, 33.42%, 24.37%
[rank3]:2025-10-29 02:55:10,564 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0255_stage3_step900.svg
[rank3]:2025-10-29 02:55:10,875 - INFO - Avg. fwd time: 16.4808 / Avg. bwd time: 23.4980 / Avg. batch time: 335.3400 (ms) / GPU bubble ratio: 4.63%
[rank0]:2025-10-29 02:55:10,931 - INFO - Avg. fwd time: 15.3223 / Avg. bwd time: 8.1763 / Avg. batch time: 551.4515 (ms) / GPU bubble ratio: 65.91%
[rank2]:2025-10-29 02:55:10,898 - INFO - Avg. fwd time: 14.9101 / Avg. bwd time: 20.0931 / Avg. batch time: 484.2935 (ms) / GPU bubble ratio: 42.18%
[rank1]:2025-10-29 02:55:10,924 - INFO - Avg. fwd time: 17.3416 / Avg. bwd time: 23.1420 / Avg. batch time: 526.9825 (ms) / GPU bubble ratio: 38.54%
[rank2]:2025-10-29 02:55:26,179 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:26,179 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:26,180 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:31,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:47,165 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:55:47,164 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:47,164 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:52,653 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:08,338 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:08,337 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:08,337 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:14,940 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:30,535 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:30,536 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:30,535 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:37,146 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:51,202 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:56:52,760 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:52,761 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank0]:2025-10-29 02:56:52,761 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:52,762 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank2]:2025-10-29 02:56:52,760 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:52,761 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank3]:2025-10-29 02:56:59,579 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:59,584 - INFO -  step: 950  loss:  0.1614  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,497  tflops: 349.64  mfu: 35.35%
[rank3]:2025-10-29 02:56:59,973 - INFO - Avg. fwd time: 16.4868 / Avg. bwd time: 23.2718 / Avg. batch time: 333.5623 (ms) / GPU bubble ratio: 4.64%
[rank2]:2025-10-29 02:57:00,024 - INFO - Avg. fwd time: 14.9185 / Avg. bwd time: 19.9056 / Avg. batch time: 483.2710 (ms) / GPU bubble ratio: 42.35%
[rank1]:2025-10-29 02:57:00,069 - INFO - Avg. fwd time: 17.3501 / Avg. bwd time: 22.9273 / Avg. batch time: 525.7539 (ms) / GPU bubble ratio: 38.71%
[rank0]:2025-10-29 02:57:00,103 - INFO - Avg. fwd time: 15.3254 / Avg. bwd time: 7.8413 / Avg. batch time: 549.8697 (ms) / GPU bubble ratio: 66.30%
[rank0]:2025-10-29 02:57:25,620 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:57:25,613 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:57:25,616 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:57:32,623 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:57:48,283 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:57:48,283 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:57:48,284 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:57:55,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:10,969 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:10,968 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:10,968 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:16,547 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:32,262 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:32,261 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:32,261 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:38,070 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:52,188 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:53,767 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank0]:2025-10-29 02:58:53,767 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:53,766 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank2]:2025-10-29 02:58:53,766 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:53,766 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank1]:2025-10-29 02:58:53,766 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 02:58:59,499 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:59,507 - INFO -  step: 1000  loss:  0.1154  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,831  tflops: 318.61  mfu: 32.21%
[rank3]:2025-10-29 02:58:59,508 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:59:16,289 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,187
[rank2]:2025-10-29 02:59:16,342 - INFO - validate step: 1000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,144
[rank1]:2025-10-29 02:59:16,326 - INFO - validate step: 1000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,156
[rank3]:2025-10-29 02:59:16,356 - INFO - validate step: 1000  loss:  0.2549  memory: 83.85GiB(59.97%)  tps: 24,312
[rank0]:2025-10-29 02:59:16,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0259_stage0_step1000.svg
[rank2]:2025-10-29 02:59:16,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0259_stage2_step1000.svg
[rank1]:2025-10-29 02:59:16,431 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0259_stage1_step1000.svg
[rank0]:2025-10-29 02:59:16,523 - INFO - Avg. fwd time: 15.3065 / Avg. bwd time: 7.8621 / Avg. batch time: 551.7823 (ms) / GPU bubble ratio: 66.41%
[rank3]:2025-10-29 02:59:16,553 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0259_real_step1000_rank3.svg
[rank3]:> Batch Time: 377.45 ms, GPU Bubble Ratio: 64.85%, 22.81%, 33.36%, 24.41%
[rank3]:2025-10-29 02:59:16,618 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0259_stage3_step1000.svg
[rank3]:2025-10-29 02:59:16,868 - INFO - Avg. fwd time: 16.4744 / Avg. bwd time: 23.2703 / Avg. batch time: 333.4362 (ms) / GPU bubble ratio: 4.64%
[rank2]:2025-10-29 02:59:16,889 - INFO - Avg. fwd time: 14.9102 / Avg. bwd time: 19.9078 / Avg. batch time: 485.1595 (ms) / GPU bubble ratio: 42.59%
[rank1]:2025-10-29 02:59:16,915 - INFO - Avg. fwd time: 17.3392 / Avg. bwd time: 22.9327 / Avg. batch time: 527.6575 (ms) / GPU bubble ratio: 38.94%
[rank2]:2025-10-29 02:59:32,364 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:59:32,365 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:59:32,365 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:59:37,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:59:53,674 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:59:53,673 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:59:53,673 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:59:59,210 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:14,915 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:14,916 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:14,915 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:00:20,414 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:36,165 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:36,164 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:36,164 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:00:41,845 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:55,957 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:00:57,537 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 8,091  tflops: 377.37  mfu: 38.16%
[rank2]:2025-10-29 03:00:57,536 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 8,095  tflops: 377.57  mfu: 38.18%
[rank1]:2025-10-29 03:00:57,536 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 8,094  tflops: 377.51  mfu: 38.17%
[rank3]:2025-10-29 03:01:03,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:03,260 - INFO -  step: 1050  loss:  0.1488  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,663  tflops: 357.41  mfu: 36.14%
[rank3]:2025-10-29 03:01:03,576 - INFO - Avg. fwd time: 16.4925 / Avg. bwd time: 23.0447 / Avg. batch time: 331.7632 (ms) / GPU bubble ratio: 4.66%
[rank0]:2025-10-29 03:01:03,636 - INFO - Avg. fwd time: 15.3105 / Avg. bwd time: 7.5261 / Avg. batch time: 550.2476 (ms) / GPU bubble ratio: 66.80%
[rank2]:2025-10-29 03:01:03,601 - INFO - Avg. fwd time: 14.9278 / Avg. bwd time: 19.7187 / Avg. batch time: 484.1611 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-10-29 03:01:03,627 - INFO - Avg. fwd time: 17.3600 / Avg. bwd time: 22.7206 / Avg. batch time: 526.4768 (ms) / GPU bubble ratio: 39.10%
[rank0]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:24,576 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:01:40,304 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:01:40,305 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:01:40,304 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:45,773 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:01,457 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:01,458 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:01,457 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:06,862 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:28,048 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:51,369 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:02:54,011 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:54,012 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 66.72GiB(47.72%)  tps: 7,033  tflops: 328.03  mfu: 33.17%
[rank2]:2025-10-29 03:02:54,005 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:54,005 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 64.67GiB(46.25%)  tps: 7,034  tflops: 328.05  mfu: 33.17%
[rank1]:2025-10-29 03:02:54,007 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:54,008 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 72.68GiB(51.98%)  tps: 7,034  tflops: 328.04  mfu: 33.17%
[rank3]:2025-10-29 03:02:59,451 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:59,456 - INFO -  step: 1100  loss:  0.0991  grad_norm:  0.1059  memory: 83.85GiB(59.97%)  tps: 7,050  tflops: 328.83  mfu: 33.25%
[rank0]:2025-10-29 03:02:59,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0302_stage0_step1100.svg
[rank2]:2025-10-29 03:02:59,530 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0302_stage2_step1100.svg
[rank1]:2025-10-29 03:02:59,531 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0302_stage1_step1100.svg
[rank0]:2025-10-29 03:02:59,621 - INFO - Avg. fwd time: 15.3034 / Avg. bwd time: 7.4420 / Avg. batch time: 549.6965 (ms) / GPU bubble ratio: 66.90%
[rank3]:2025-10-29 03:02:59,647 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0302_real_step1100_rank3.svg
[rank3]:> Batch Time: 377.36 ms, GPU Bubble Ratio: 64.87%, 22.78%, 33.34%, 24.41%
[rank3]:2025-10-29 03:02:59,710 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0302_stage3_step1100.svg
[rank3]:2025-10-29 03:02:59,960 - INFO - Avg. fwd time: 16.4930 / Avg. bwd time: 22.9814 / Avg. batch time: 331.2506 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-10-29 03:02:59,981 - INFO - Avg. fwd time: 14.9294 / Avg. bwd time: 19.6669 / Avg. batch time: 483.7482 (ms) / GPU bubble ratio: 42.79%
[rank1]:2025-10-29 03:03:00,006 - INFO - Avg. fwd time: 17.3618 / Avg. bwd time: 22.6641 / Avg. batch time: 526.0202 (ms) / GPU bubble ratio: 39.13%
[rank0]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:03:20,746 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:03:41,822 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:03:57,361 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:57,360 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:57,360 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:02,826 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:18,468 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:04:18,467 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:04:18,467 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:23,898 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:37,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:39,558 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,762  tflops: 362.00  mfu: 36.60%
[rank2]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:04:39,557 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,761  tflops: 361.98  mfu: 36.60%
[rank1]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:04:39,557 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,761  tflops: 361.99  mfu: 36.60%
[rank0]:2025-10-29 03:04:39,649 - INFO - Avg. fwd time: 15.2987 / Avg. bwd time: 7.3086 / Avg. batch time: 547.9377 (ms) / GPU bubble ratio: 66.99%
[rank3]:2025-10-29 03:04:45,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:45,037 - INFO -  step: 1150  loss:  0.1295  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,759  tflops: 361.88  mfu: 36.59%
[rank3]:2025-10-29 03:04:45,287 - INFO - Avg. fwd time: 16.4883 / Avg. bwd time: 22.8863 / Avg. batch time: 330.4403 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-10-29 03:04:45,307 - INFO - Avg. fwd time: 14.9280 / Avg. bwd time: 19.5899 / Avg. batch time: 482.2214 (ms) / GPU bubble ratio: 42.74%
[rank1]:2025-10-29 03:04:45,332 - INFO - Avg. fwd time: 17.3578 / Avg. bwd time: 22.5764 / Avg. batch time: 524.4069 (ms) / GPU bubble ratio: 39.08%
[rank0]:2025-10-29 03:05:00,630 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:00,629 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:00,629 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:06,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:21,748 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:21,748 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:05:21,749 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:27,173 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:05:42,763 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:42,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:42,762 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:48,225 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:06:09,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:23,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:06:24,931 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank2]:2025-10-29 03:06:24,931 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:24,932 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank0]:2025-10-29 03:06:24,932 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:06:24,931 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank1]:2025-10-29 03:06:24,931 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 03:06:30,359 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:06:30,368 - INFO -  step: 1200  loss:  0.1143  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,778  tflops: 362.75  mfu: 36.68%
[rank3]:2025-10-29 03:06:30,368 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:06:47,018 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,546
[rank0]:2025-10-29 03:06:47,019 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:06:47,022 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 03:06:47,082 - INFO - validate step: 1200  loss:  0.2502  memory: 83.85GiB(59.97%)  tps: 24,508
[rank3]:2025-10-29 03:06:47,083 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:06:47,072 - INFO - validate step: 1200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,500
[rank2]:2025-10-29 03:06:47,073 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:06:47,056 - INFO - validate step: 1200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,513
[rank1]:2025-10-29 03:06:47,057 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:06:59,293 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.24 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 03:07:01,456 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.38 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 03:07:04,990 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.91 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 03:07:05,917 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 03:07:05,922 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.90 seconds.
[rank0]:2025-10-29 03:07:05,922 - INFO - Checkpointer is deleting /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 03:07:06,010 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0307_stage2_step1200.svg
[rank2]:2025-10-29 03:07:06,022 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 03:07:06,009 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0306_stage1_step1200.svg
[rank1]:2025-10-29 03:07:06,021 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 03:07:06,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0307_stage0_step1200.svg
[rank0]:2025-10-29 03:07:06,059 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 03:07:06,139 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0307_real_step1200_rank3.svg
[rank3]:> Batch Time: 377.00 ms, GPU Bubble Ratio: 64.87%, 22.77%, 33.32%, 24.41%
[rank3]:2025-10-29 03:07:06,208 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0307_stage3_step1200.svg
[rank3]:2025-10-29 03:07:06,219 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 03:07:07,017 - INFO - Avg. fwd time: 16.4955 / Avg. bwd time: 22.7061 / Avg. batch time: 329.1442 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 03:07:07,043 - INFO - Avg. fwd time: 14.9363 / Avg. bwd time: 19.4402 / Avg. batch time: 481.3299 (ms) / GPU bubble ratio: 42.86%
[rank1]:2025-10-29 03:07:07,071 - INFO - Avg. fwd time: 17.3670 / Avg. bwd time: 22.4047 / Avg. batch time: 523.3510 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 03:07:07,080 - INFO - Avg. fwd time: 15.3033 / Avg. bwd time: 7.0388 / Avg. batch time: 546.5988 (ms) / GPU bubble ratio: 67.30%
[rank0]:2025-10-29 03:07:11,811 - INFO - Checkpointer deleted /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200 in 5.88 seconds.
[rank2]:2025-10-29 03:07:24,541 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:07:24,542 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:07:24,542 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:07:30,607 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:07:47,219 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:07:47,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:07:47,220 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:07:52,879 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:08:09,603 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:08:09,603 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:08:09,604 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:08:15,335 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:08:32,102 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:08:32,102 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:08:32,103 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:08:38,026 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:04,397 - INFO - [GC] Peforming periodical GC collection 2.04 seconds
[rank1]:2025-10-29 03:09:07,124 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:09:07,125 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 72.68GiB(51.98%)  tps: 5,849  tflops: 272.78  mfu: 27.58%
[rank2]:2025-10-29 03:09:07,122 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:07,122 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 64.67GiB(46.25%)  tps: 5,849  tflops: 272.81  mfu: 27.58%
[rank0]:2025-10-29 03:09:07,129 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:07,129 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 66.72GiB(47.72%)  tps: 5,847  tflops: 272.70  mfu: 27.57%
[rank0]:2025-10-29 03:09:07,232 - INFO - Avg. fwd time: 15.3217 / Avg. bwd time: 6.9838 / Avg. batch time: 547.1777 (ms) / GPU bubble ratio: 67.39%
[rank3]:2025-10-29 03:09:12,682 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:12,690 - INFO -  step: 1250  loss:  0.7846  grad_norm:  0.9824  memory: 83.85GiB(59.97%)  tps: 5,626  tflops: 262.41  mfu: 26.53%
[rank3]:2025-10-29 03:09:12,968 - INFO - Avg. fwd time: 16.5194 / Avg. bwd time: 22.6862 / Avg. batch time: 329.2671 (ms) / GPU bubble ratio: 4.74%
[rank1]:2025-10-29 03:09:13,015 - INFO - Avg. fwd time: 17.3844 / Avg. bwd time: 22.3738 / Avg. batch time: 523.9669 (ms) / GPU bubble ratio: 39.30%
[rank2]:2025-10-29 03:09:12,990 - INFO - Avg. fwd time: 14.9515 / Avg. bwd time: 19.4324 / Avg. batch time: 481.9938 (ms) / GPU bubble ratio: 42.93%
[rank1]:2025-10-29 03:09:29,389 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:29,389 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:29,390 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:35,044 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:09:51,766 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:51,766 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:51,767 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:57,103 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:13,785 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:13,785 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:13,786 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:10:19,776 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:10:42,092 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:57,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:58,759 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 64.67GiB(46.25%)  tps: 7,338  tflops: 342.25  mfu: 34.61%
[rank1]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:58,759 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 72.68GiB(51.98%)  tps: 7,338  tflops: 342.26  mfu: 34.61%
[rank0]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:58,760 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 66.72GiB(47.72%)  tps: 7,338  tflops: 342.27  mfu: 34.61%
[rank3]:2025-10-29 03:11:03,738 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:03,748 - INFO -  step: 1300  loss:  0.9636  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,376  tflops: 344.04  mfu: 34.79%
[rank2]:2025-10-29 03:11:03,832 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0310_stage2_step1300.svg
[rank1]:2025-10-29 03:11:03,829 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0310_stage1_step1300.svg
[rank0]:2025-10-29 03:11:03,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0310_stage0_step1300.svg
[rank3]:2025-10-29 03:11:03,956 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0311_real_step1300_rank3.svg
[rank3]:> Batch Time: 377.74 ms, GPU Bubble Ratio: 64.84%, 22.80%, 33.36%, 24.39%
[rank0]:2025-10-29 03:11:03,935 - INFO - Avg. fwd time: 15.3432 / Avg. bwd time: 6.8855 / Avg. batch time: 547.4723 (ms) / GPU bubble ratio: 67.52%
[rank3]:2025-10-29 03:11:04,026 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0311_stage3_step1300.svg
[rank3]:2025-10-29 03:11:04,303 - INFO - Avg. fwd time: 16.5480 / Avg. bwd time: 22.6389 / Avg. batch time: 329.1069 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 03:11:04,325 - INFO - Avg. fwd time: 14.9705 / Avg. bwd time: 19.3845 / Avg. batch time: 482.4491 (ms) / GPU bubble ratio: 43.03%
[rank1]:2025-10-29 03:11:04,351 - INFO - Avg. fwd time: 17.4071 / Avg. bwd time: 22.3176 / Avg. batch time: 524.3501 (ms) / GPU bubble ratio: 39.39%
[rank2]:2025-10-29 03:11:20,620 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:11:20,619 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:11:20,620 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:25,900 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:47,559 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:09,250 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:25,863 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:25,863 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:25,864 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:30,880 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:45,875 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:12:47,545 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:47,545 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 72.68GiB(51.98%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank2]:2025-10-29 03:12:47,545 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:47,545 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 64.67GiB(46.25%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank0]:2025-10-29 03:12:47,546 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:47,546 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 66.72GiB(47.72%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank3]:2025-10-29 03:12:52,564 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:52,568 - INFO -  step: 1350  loss:  0.8039  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,528  tflops: 351.11  mfu: 35.50%
[rank3]:2025-10-29 03:12:52,906 - INFO - Avg. fwd time: 16.5829 / Avg. bwd time: 22.5117 / Avg. batch time: 328.3581 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:12:52,960 - INFO - Avg. fwd time: 17.4367 / Avg. bwd time: 22.1854 / Avg. batch time: 523.4518 (ms) / GPU bubble ratio: 39.44%
[rank2]:2025-10-29 03:12:52,932 - INFO - Avg. fwd time: 14.9963 / Avg. bwd time: 19.2706 / Avg. batch time: 481.6944 (ms) / GPU bubble ratio: 43.09%
[rank0]:2025-10-29 03:12:52,970 - INFO - Avg. fwd time: 15.3696 / Avg. bwd time: 6.6627 / Avg. batch time: 546.3572 (ms) / GPU bubble ratio: 67.74%
[rank1]:2025-10-29 03:13:09,210 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:09,210 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:09,211 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:14,221 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:13:30,939 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:30,939 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:30,940 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:35,972 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:57,664 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:14:14,293 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:14,293 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:14,294 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:14:19,415 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:34,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:36,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 72.68GiB(51.98%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank2]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:36,112 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 03:14:36,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 64.67GiB(46.25%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank2]:2025-10-29 03:14:36,112 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:36,113 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 66.72GiB(47.72%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank0]:2025-10-29 03:14:36,113 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:14:41,352 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:14:41,356 - INFO -  step: 1400  loss:  0.7860  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank3]:2025-10-29 03:14:41,356 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:14:56,077 - INFO - validate step: 1400  loss:  0.2452  memory: 83.85GiB(59.97%)  tps: 27,826
[rank1]:2025-10-29 03:14:56,052 - INFO - validate step: 1400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,542
[rank2]:2025-10-29 03:14:56,065 - INFO - validate step: 1400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,529
[rank0]:2025-10-29 03:14:56,020 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,576
[rank1]:2025-10-29 03:14:56,160 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0314_stage1_step1400.svg
[rank2]:2025-10-29 03:14:56,158 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0314_stage2_step1400.svg
[rank0]:2025-10-29 03:14:56,160 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0314_stage0_step1400.svg
[rank3]:2025-10-29 03:14:56,269 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0314_real_step1400_rank3.svg
[rank3]:> Batch Time: 378.61 ms, GPU Bubble Ratio: 64.80%, 22.86%, 33.41%, 24.36%
[rank3]:2025-10-29 03:14:56,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0314_stage3_step1400.svg
[rank3]:2025-10-29 03:14:56,754 - INFO - Avg. fwd time: 16.6104 / Avg. bwd time: 22.4097 / Avg. batch time: 327.7533 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 03:14:56,804 - INFO - Avg. fwd time: 15.0163 / Avg. bwd time: 19.1790 / Avg. batch time: 480.7902 (ms) / GPU bubble ratio: 43.10%
[rank1]:2025-10-29 03:14:56,851 - INFO - Avg. fwd time: 17.4612 / Avg. bwd time: 22.0798 / Avg. batch time: 522.4333 (ms) / GPU bubble ratio: 39.45%
[rank0]:2025-10-29 03:14:56,884 - INFO - Avg. fwd time: 15.3905 / Avg. bwd time: 6.4851 / Avg. batch time: 545.1644 (ms) / GPU bubble ratio: 67.90%
[rank1]:2025-10-29 03:15:23,400 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:15:23,398 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:15:23,405 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:15:28,625 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:15:45,344 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:15:45,344 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:15:45,345 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:15:50,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:07,252 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:07,253 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:07,253 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:12,360 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:29,014 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:29,013 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:29,014 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:34,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:49,328 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:50,997 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 72.68GiB(51.98%)  tps: 7,127  tflops: 332.40  mfu: 33.61%
[rank2]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:50,997 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 64.67GiB(46.25%)  tps: 7,128  tflops: 332.44  mfu: 33.61%
[rank0]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:50,998 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 66.72GiB(47.72%)  tps: 7,125  tflops: 332.31  mfu: 33.60%
[rank0]:2025-10-29 03:16:51,103 - INFO - Avg. fwd time: 15.4009 / Avg. bwd time: 6.5514 / Avg. batch time: 545.1708 (ms) / GPU bubble ratio: 67.79%
[rank3]:2025-10-29 03:16:56,097 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:56,101 - INFO -  step: 1450  loss:  0.9693  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,825  tflops: 318.34  mfu: 32.19%
[rank3]:2025-10-29 03:16:56,374 - INFO - Avg. fwd time: 16.6237 / Avg. bwd time: 22.4649 / Avg. batch time: 328.2939 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-29 03:16:56,396 - INFO - Avg. fwd time: 15.0234 / Avg. bwd time: 19.2191 / Avg. batch time: 480.6817 (ms) / GPU bubble ratio: 43.01%
[rank1]:2025-10-29 03:16:56,421 - INFO - Avg. fwd time: 17.4702 / Avg. bwd time: 22.1264 / Avg. batch time: 522.3611 (ms) / GPU bubble ratio: 39.36%
[rank1]:2025-10-29 03:17:12,754 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:12,753 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:12,754 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:17:17,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:17:34,621 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:34,621 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:34,622 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:17:39,814 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:17:56,502 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:56,502 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:56,503 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:01,644 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:18:18,237 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:18:18,237 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:18,238 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:23,369 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:38,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:18:40,015 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:18:40,015 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 72.68GiB(51.98%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank2]:2025-10-29 03:18:40,014 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:18:40,015 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 64.67GiB(46.25%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank0]:2025-10-29 03:18:40,015 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:40,016 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 66.72GiB(47.72%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank3]:2025-10-29 03:18:45,109 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:45,113 - INFO -  step: 1500  loss:  0.8418  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,515  tflops: 350.50  mfu: 35.44%
[rank0]:2025-10-29 03:18:45,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0318_stage0_step1500.svg
[rank1]:2025-10-29 03:18:45,193 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0318_stage1_step1500.svg
[rank2]:2025-10-29 03:18:45,196 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0318_stage2_step1500.svg
[rank3]:2025-10-29 03:18:45,306 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0318_real_step1500_rank3.svg
[rank3]:> Batch Time: 379.54 ms, GPU Bubble Ratio: 64.79%, 22.94%, 33.49%, 24.32%
[rank3]:2025-10-29 03:18:45,374 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0318_stage3_step1500.svg
[rank1]:2025-10-29 03:18:45,765 - INFO - Avg. fwd time: 17.4939 / Avg. bwd time: 22.0137 / Avg. batch time: 521.6731 (ms) / GPU bubble ratio: 39.41%
[rank2]:2025-10-29 03:18:45,738 - INFO - Avg. fwd time: 15.0437 / Avg. bwd time: 19.1215 / Avg. batch time: 480.1149 (ms) / GPU bubble ratio: 43.07%
[rank3]:2025-10-29 03:18:45,712 - INFO - Avg. fwd time: 16.6518 / Avg. bwd time: 22.3557 / Avg. batch time: 327.6363 (ms) / GPU bubble ratio: 4.75%
[rank0]:2025-10-29 03:18:45,775 - INFO - Avg. fwd time: 15.4221 / Avg. bwd time: 6.3626 / Avg. batch time: 544.2998 (ms) / GPU bubble ratio: 67.98%
[rank1]:2025-10-29 03:19:02,064 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:02,064 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:02,065 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:07,214 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:23,811 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:19:23,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:23,812 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:28,922 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:19:45,582 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:45,582 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:45,583 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:50,738 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:07,388 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:20:07,388 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:07,389 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:12,511 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:27,444 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:20:29,113 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 64.67GiB(46.25%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank1]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:29,113 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 72.68GiB(51.98%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank0]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:29,114 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 66.72GiB(47.72%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank0]:2025-10-29 03:20:29,222 - INFO - Avg. fwd time: 15.4396 / Avg. bwd time: 6.2109 / Avg. batch time: 543.3343 (ms) / GPU bubble ratio: 68.12%
[rank3]:2025-10-29 03:20:34,329 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:34,333 - INFO -  step: 1550  loss:  0.9173  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,501  tflops: 349.83  mfu: 35.37%
[rank2]:2025-10-29 03:20:34,627 - INFO - Avg. fwd time: 15.0605 / Avg. bwd time: 19.0428 / Avg. batch time: 479.3926 (ms) / GPU bubble ratio: 43.09%
[rank1]:2025-10-29 03:20:34,652 - INFO - Avg. fwd time: 17.5144 / Avg. bwd time: 21.9236 / Avg. batch time: 520.8550 (ms) / GPU bubble ratio: 39.43%
[rank3]:2025-10-29 03:20:34,605 - INFO - Avg. fwd time: 16.6747 / Avg. bwd time: 22.2680 / Avg. batch time: 327.1112 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 03:20:51,047 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:51,047 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:51,048 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:56,150 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:21:12,796 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:21:12,796 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:21:12,797 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:21:17,920 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:21:44,983 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:21:44,981 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:21:44,988 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:21:50,155 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:06,670 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:22:06,669 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:22:06,669 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:22:11,810 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:25,905 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:27,491 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank0]:2025-10-29 03:22:27,491 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:22:27,490 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank2]:2025-10-29 03:22:27,490 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:22:27,490 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank1]:2025-10-29 03:22:27,490 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:22:32,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:22:32,588 - INFO -  step: 1600  loss:  0.1334  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,928  tflops: 323.10  mfu: 32.67%
[rank3]:2025-10-29 03:22:32,588 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 03:22:49,202 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,866
[rank1]:2025-10-29 03:22:49,240 - INFO - validate step: 1600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,833
[rank2]:2025-10-29 03:22:49,257 - INFO - validate step: 1600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,818
[rank3]:2025-10-29 03:22:49,266 - INFO - validate step: 1600  loss:  0.2432  memory: 83.85GiB(59.97%)  tps: 24,560
[rank1]:2025-10-29 03:22:49,352 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0322_stage1_step1600.svg
[rank2]:2025-10-29 03:22:49,351 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0322_stage2_step1600.svg
[rank0]:2025-10-29 03:22:49,351 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0322_stage0_step1600.svg
[rank3]:2025-10-29 03:22:49,458 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0322_real_step1600_rank3.svg
[rank3]:> Batch Time: 380.27 ms, GPU Bubble Ratio: 64.77%, 22.99%, 33.55%, 24.29%
[rank0]:2025-10-29 03:22:49,444 - INFO - Avg. fwd time: 15.4431 / Avg. bwd time: 6.2796 / Avg. batch time: 544.0655 (ms) / GPU bubble ratio: 68.06%
[rank3]:2025-10-29 03:22:49,528 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0322_stage3_step1600.svg
[rank3]:2025-10-29 03:22:49,779 - INFO - Avg. fwd time: 16.6796 / Avg. bwd time: 22.3179 / Avg. batch time: 327.5414 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:22:49,825 - INFO - Avg. fwd time: 17.5163 / Avg. bwd time: 21.9685 / Avg. batch time: 521.5109 (ms) / GPU bubble ratio: 39.43%
[rank2]:2025-10-29 03:22:49,800 - INFO - Avg. fwd time: 15.0620 / Avg. bwd time: 19.0811 / Avg. batch time: 480.0063 (ms) / GPU bubble ratio: 43.10%
[rank1]:2025-10-29 03:23:05,095 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:05,095 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:05,096 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:10,300 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:31,043 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:46,661 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:23:46,660 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:46,660 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:51,729 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:24:07,312 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:07,312 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:07,313 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:12,393 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:26,532 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:24:28,094 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:28,094 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,284  tflops: 386.36  mfu: 39.07%
[rank1]:2025-10-29 03:24:28,093 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:24:28,093 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,287  tflops: 386.51  mfu: 39.08%
[rank2]:2025-10-29 03:24:28,093 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:28,093 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,288  tflops: 386.58  mfu: 39.09%
[rank3]:2025-10-29 03:24:33,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:33,270 - INFO -  step: 1650  loss:  0.1183  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,877  tflops: 367.37  mfu: 37.15%
[rank3]:2025-10-29 03:24:33,579 - INFO - Avg. fwd time: 16.6783 / Avg. bwd time: 22.2018 / Avg. batch time: 326.5910 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-10-29 03:24:33,635 - INFO - Avg. fwd time: 17.5165 / Avg. bwd time: 21.8633 / Avg. batch time: 520.5047 (ms) / GPU bubble ratio: 39.47%
[rank2]:2025-10-29 03:24:33,606 - INFO - Avg. fwd time: 15.0634 / Avg. bwd time: 18.9873 / Avg. batch time: 479.0821 (ms) / GPU bubble ratio: 43.14%
[rank0]:2025-10-29 03:24:33,648 - INFO - Avg. fwd time: 15.4424 / Avg. bwd time: 6.1160 / Avg. batch time: 542.8866 (ms) / GPU bubble ratio: 68.23%
[rank1]:2025-10-29 03:24:48,840 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:48,840 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:48,841 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:53,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:14,700 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:30,346 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:30,345 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:30,345 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:35,462 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:51,019 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:51,019 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:51,020 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:56,189 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:10,326 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:26:11,870 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank1]:2025-10-29 03:26:11,869 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank2]:2025-10-29 03:26:11,869 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank3]:2025-10-29 03:26:16,966 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:16,972 - INFO -  step: 1700  loss:  0.1048  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,900  tflops: 368.44  mfu: 37.25%
[rank0]:2025-10-29 03:26:17,059 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0326_stage0_step1700.svg
[rank1]:2025-10-29 03:26:17,055 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0326_stage1_step1700.svg
[rank2]:2025-10-29 03:26:17,056 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0326_stage2_step1700.svg
[rank3]:2025-10-29 03:26:17,167 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0326_real_step1700_rank3.svg
[rank3]:> Batch Time: 379.52 ms, GPU Bubble Ratio: 64.76%, 22.92%, 33.48%, 24.32%
[rank0]:2025-10-29 03:26:17,153 - INFO - Avg. fwd time: 15.4407 / Avg. bwd time: 5.9839 / Avg. batch time: 541.6995 (ms) / GPU bubble ratio: 68.36%
[rank3]:2025-10-29 03:26:17,236 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0326_stage3_step1700.svg
[rank3]:2025-10-29 03:26:17,480 - INFO - Avg. fwd time: 16.6769 / Avg. bwd time: 22.1084 / Avg. batch time: 325.8227 (ms) / GPU bubble ratio: 4.77%
[rank1]:2025-10-29 03:26:17,526 - INFO - Avg. fwd time: 17.5158 / Avg. bwd time: 21.7777 / Avg. batch time: 519.4599 (ms) / GPU bubble ratio: 39.49%
[rank2]:2025-10-29 03:26:17,500 - INFO - Avg. fwd time: 15.0639 / Avg. bwd time: 18.9112 / Avg. batch time: 478.1112 (ms) / GPU bubble ratio: 43.15%
[rank0]:2025-10-29 03:26:32,830 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:32,830 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:32,829 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:37,920 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:53,515 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:53,514 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:53,514 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:58,624 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:27:19,403 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:27:40,229 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:54,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:27:55,853 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:55,853 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank1]:2025-10-29 03:27:55,852 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:55,853 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank2]:2025-10-29 03:27:55,852 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:55,852 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank3]:2025-10-29 03:28:00,975 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:00,979 - INFO -  step: 1750  loss:  0.1059  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,877  tflops: 367.36  mfu: 37.14%
[rank3]:2025-10-29 03:28:01,370 - INFO - Avg. fwd time: 16.6753 / Avg. bwd time: 22.0051 / Avg. batch time: 324.9721 (ms) / GPU bubble ratio: 4.78%
[rank2]:2025-10-29 03:28:01,419 - INFO - Avg. fwd time: 15.0646 / Avg. bwd time: 18.8272 / Avg. batch time: 476.5808 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 03:28:01,498 - INFO - Avg. fwd time: 15.4388 / Avg. bwd time: 5.8383 / Avg. batch time: 539.9349 (ms) / GPU bubble ratio: 68.47%
[rank1]:2025-10-29 03:28:01,464 - INFO - Avg. fwd time: 17.5152 / Avg. bwd time: 21.6836 / Avg. batch time: 517.8522 (ms) / GPU bubble ratio: 39.44%
[rank1]:2025-10-29 03:28:27,035 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:28:27,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:28:27,039 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:32,134 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:28:47,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:28:47,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:28:47,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:52,799 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:13,571 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:29,177 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:29,177 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:29,178 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:34,288 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:48,319 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:29:49,877 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank0]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 03:29:49,876 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank2]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 03:29:49,876 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank1]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 03:29:54,971 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:54,975 - INFO -  step: 1800  loss:  0.0849  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,186  tflops: 335.17  mfu: 33.89%
[rank3]:2025-10-29 03:29:54,976 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 03:30:11,667 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,798
[rank1]:2025-10-29 03:30:11,701 - INFO - validate step: 1800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,768
[rank2]:2025-10-29 03:30:11,717 - INFO - validate step: 1800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,754
[rank3]:2025-10-29 03:30:11,728 - INFO - validate step: 1800  loss:  0.2401  memory: 83.85GiB(59.97%)  tps: 24,451
[rank1]:2025-10-29 03:30:11,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0330_stage1_step1800.svg
[rank2]:2025-10-29 03:30:11,812 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0330_stage2_step1800.svg
[rank0]:2025-10-29 03:30:11,814 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0330_stage0_step1800.svg
[rank3]:2025-10-29 03:30:11,921 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0330_real_step1800_rank3.svg
[rank3]:> Batch Time: 379.00 ms, GPU Bubble Ratio: 64.76%, 22.88%, 33.45%, 24.35%
[rank3]:2025-10-29 03:30:11,990 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0330_stage3_step1800.svg
[rank3]:2025-10-29 03:30:12,303 - INFO - Avg. fwd time: 16.6594 / Avg. bwd time: 22.0404 / Avg. batch time: 325.1178 (ms) / GPU bubble ratio: 4.77%
[rank0]:2025-10-29 03:30:12,369 - INFO - Avg. fwd time: 15.4264 / Avg. bwd time: 5.9086 / Avg. batch time: 540.3441 (ms) / GPU bubble ratio: 68.41%
[rank1]:2025-10-29 03:30:12,358 - INFO - Avg. fwd time: 17.5011 / Avg. bwd time: 21.7236 / Avg. batch time: 518.1962 (ms) / GPU bubble ratio: 39.44%
[rank2]:2025-10-29 03:30:12,329 - INFO - Avg. fwd time: 15.0531 / Avg. bwd time: 18.8619 / Avg. batch time: 476.8770 (ms) / GPU bubble ratio: 43.10%
[rank0]:2025-10-29 03:30:27,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:30:27,785 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:30:27,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:30:32,887 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:30:48,456 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:30:48,456 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:30:48,457 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:30:53,526 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:09,186 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:09,185 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:09,185 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:14,250 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:29,959 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:29,958 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:29,958 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:35,004 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:49,008 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:31:50,570 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:50,570 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 8,283  tflops: 386.32  mfu: 39.06%
[rank1]:2025-10-29 03:31:50,569 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:50,569 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 8,286  tflops: 386.45  mfu: 39.08%
[rank2]:2025-10-29 03:31:50,569 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:50,569 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 8,287  tflops: 386.51  mfu: 39.08%
[rank0]:2025-10-29 03:31:50,665 - INFO - Avg. fwd time: 15.4260 / Avg. bwd time: 5.7923 / Avg. batch time: 539.3074 (ms) / GPU bubble ratio: 68.53%
[rank3]:2025-10-29 03:31:55,656 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:55,660 - INFO -  step: 1850  loss:  0.0917  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,882  tflops: 367.63  mfu: 37.17%
[rank3]:2025-10-29 03:31:55,911 - INFO - Avg. fwd time: 16.6592 / Avg. bwd time: 21.9601 / Avg. batch time: 324.4659 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 03:31:55,957 - INFO - Avg. fwd time: 17.5031 / Avg. bwd time: 21.6498 / Avg. batch time: 517.2839 (ms) / GPU bubble ratio: 39.45%
[rank2]:2025-10-29 03:31:55,932 - INFO - Avg. fwd time: 15.0551 / Avg. bwd time: 18.7964 / Avg. batch time: 476.0271 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:16,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:32:32,042 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:32,041 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:32,041 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:37,113 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:52,741 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:52,741 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:32:52,742 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:57,868 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:33:18,693 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:32,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:33:34,293 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:34,293 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank1]:2025-10-29 03:33:34,292 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:34,292 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank2]:2025-10-29 03:33:34,292 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:34,292 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank3]:2025-10-29 03:33:39,327 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:33:39,332 - INFO -  step: 1900  loss:  0.0776  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,902  tflops: 368.55  mfu: 37.26%
[rank0]:2025-10-29 03:33:39,417 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0333_stage0_step1900.svg
[rank1]:2025-10-29 03:33:39,415 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0333_stage1_step1900.svg
[rank2]:2025-10-29 03:33:39,417 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0333_stage2_step1900.svg
[rank0]:2025-10-29 03:33:39,512 - INFO - Avg. fwd time: 15.4248 / Avg. bwd time: 5.6636 / Avg. batch time: 538.3879 (ms) / GPU bubble ratio: 68.66%
[rank3]:2025-10-29 03:33:39,527 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0333_real_step1900_rank3.svg
[rank3]:> Batch Time: 378.54 ms, GPU Bubble Ratio: 64.76%, 22.83%, 33.41%, 24.38%
[rank3]:2025-10-29 03:33:39,597 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0333_stage3_step1900.svg
[rank3]:2025-10-29 03:33:39,850 - INFO - Avg. fwd time: 16.6587 / Avg. bwd time: 21.8711 / Avg. batch time: 323.7403 (ms) / GPU bubble ratio: 4.79%
[rank2]:2025-10-29 03:33:39,870 - INFO - Avg. fwd time: 15.0566 / Avg. bwd time: 18.7239 / Avg. batch time: 475.3178 (ms) / GPU bubble ratio: 43.14%
[rank1]:2025-10-29 03:33:39,895 - INFO - Avg. fwd time: 17.5043 / Avg. bwd time: 21.5678 / Avg. batch time: 516.5026 (ms) / GPU bubble ratio: 39.48%
[rank0]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:00,319 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:21,061 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:41,733 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:57,433 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:57,433 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:57,434 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:02,602 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:35:25,981 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:35:28,635 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:35:28,635 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 66.72GiB(47.72%)  tps: 7,164  tflops: 334.15  mfu: 33.79%
[rank2]:2025-10-29 03:35:28,628 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:35:28,628 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 64.67GiB(46.25%)  tps: 7,165  tflops: 334.17  mfu: 33.79%
[rank1]:2025-10-29 03:35:28,630 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:35:28,631 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 72.68GiB(51.98%)  tps: 7,165  tflops: 334.16  mfu: 33.79%
[rank3]:2025-10-29 03:35:33,761 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:33,765 - INFO -  step: 1950  loss:  0.1049  grad_norm:  0.1659  memory: 83.85GiB(59.97%)  tps: 7,159  tflops: 333.89  mfu: 33.76%
[rank3]:2025-10-29 03:35:34,085 - INFO - Avg. fwd time: 16.6456 / Avg. bwd time: 21.9082 / Avg. batch time: 323.9251 (ms) / GPU bubble ratio: 4.78%
[rank0]:2025-10-29 03:35:34,155 - INFO - Avg. fwd time: 15.4141 / Avg. bwd time: 5.7330 / Avg. batch time: 538.8301 (ms) / GPU bubble ratio: 68.60%
[rank1]:2025-10-29 03:35:34,142 - INFO - Avg. fwd time: 17.4932 / Avg. bwd time: 21.6081 / Avg. batch time: 516.8783 (ms) / GPU bubble ratio: 39.48%
[rank2]:2025-10-29 03:35:34,113 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.7581 / Avg. batch time: 475.6462 (ms) / GPU bubble ratio: 43.14%
[rank0]:2025-10-29 03:35:49,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:35:49,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:35:49,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:54,495 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:10,225 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:10,224 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:10,224 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:15,276 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:30,847 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:30,846 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:30,846 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:35,966 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:56,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:37:10,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:37:12,416 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:37:12,417 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,894  tflops: 368.16  mfu: 37.23%
[rank0]:2025-10-29 03:37:12,417 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 03:37:12,416 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:37:12,416 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,893  tflops: 368.14  mfu: 37.22%
[rank1]:2025-10-29 03:37:12,416 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 03:37:12,415 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:37:12,416 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,893  tflops: 368.13  mfu: 37.22%
[rank2]:2025-10-29 03:37:12,416 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 03:37:17,915 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:37:17,918 - INFO -  step: 2000  loss:  0.1202  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,865  tflops: 366.85  mfu: 37.09%
[rank3]:2025-10-29 03:37:17,919 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 03:37:34,609 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,457
[rank1]:2025-10-29 03:37:34,646 - INFO - validate step: 2000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,426
[rank2]:2025-10-29 03:37:34,661 - INFO - validate step: 2000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,413
[rank3]:2025-10-29 03:37:34,674 - INFO - validate step: 2000  loss:  0.2392  memory: 83.85GiB(59.97%)  tps: 24,447
[rank1]:2025-10-29 03:37:34,763 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0337_stage1_step2000.svg
[rank2]:2025-10-29 03:37:34,761 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0337_stage2_step2000.svg
[rank0]:2025-10-29 03:37:34,761 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0337_stage0_step2000.svg
[rank3]:2025-10-29 03:37:34,863 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0337_real_step2000_rank3.svg
[rank3]:> Batch Time: 378.19 ms, GPU Bubble Ratio: 64.76%, 22.82%, 33.39%, 24.38%
[rank0]:2025-10-29 03:37:34,857 - INFO - Avg. fwd time: 15.4131 / Avg. bwd time: 5.6294 / Avg. batch time: 537.9011 (ms) / GPU bubble ratio: 68.70%
[rank3]:2025-10-29 03:37:34,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0337_stage3_step2000.svg
[rank1]:2025-10-29 03:37:35,237 - INFO - Avg. fwd time: 17.4940 / Avg. bwd time: 21.5420 / Avg. batch time: 516.0601 (ms) / GPU bubble ratio: 39.49%
[rank2]:2025-10-29 03:37:35,210 - INFO - Avg. fwd time: 15.0481 / Avg. bwd time: 18.6998 / Avg. batch time: 474.8865 (ms) / GPU bubble ratio: 43.15%
[rank3]:2025-10-29 03:37:35,191 - INFO - Avg. fwd time: 16.6451 / Avg. bwd time: 21.8366 / Avg. batch time: 323.3405 (ms) / GPU bubble ratio: 4.79%
[rank0]:2025-10-29 03:37:50,530 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:37:50,529 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:37:50,529 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:37:55,627 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:11,331 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:11,330 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:11,330 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:16,805 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:32,447 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:32,446 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:32,446 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:37,839 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:58,838 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:13,009 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:39:14,581 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:14,581 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 8,194  tflops: 382.18  mfu: 38.64%
[rank2]:2025-10-29 03:39:14,580 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:39:14,580 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 8,199  tflops: 382.39  mfu: 38.66%
[rank1]:2025-10-29 03:39:14,580 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:14,581 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 8,197  tflops: 382.33  mfu: 38.66%
[rank0]:2025-10-29 03:39:14,676 - INFO - Avg. fwd time: 15.4125 / Avg. bwd time: 5.5143 / Avg. batch time: 536.6162 (ms) / GPU bubble ratio: 68.80%
[rank3]:2025-10-29 03:39:19,893 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:39:19,897 - INFO -  step: 2050  loss:  0.1601  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,785  tflops: 363.12  mfu: 36.72%
[rank3]:2025-10-29 03:39:20,146 - INFO - Avg. fwd time: 16.6459 / Avg. bwd time: 21.7573 / Avg. batch time: 322.7052 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 03:39:20,166 - INFO - Avg. fwd time: 15.0508 / Avg. bwd time: 18.6352 / Avg. batch time: 473.7872 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 03:39:20,191 - INFO - Avg. fwd time: 17.4968 / Avg. bwd time: 21.4690 / Avg. batch time: 514.8986 (ms) / GPU bubble ratio: 39.46%
[rank2]:2025-10-29 03:39:35,460 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:35,460 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:35,461 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:39:40,760 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:01,642 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:22,600 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:38,149 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:38,148 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:38,148 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:43,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:57,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:40:59,010 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank1]:2025-10-29 03:40:59,009 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank2]:2025-10-29 03:40:59,009 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank3]:2025-10-29 03:41:04,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:04,260 - INFO -  step: 2100  loss:  0.1397  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,850  tflops: 366.11  mfu: 37.02%
[rank2]:2025-10-29 03:41:04,337 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0340_stage2_step2100.svg
[rank0]:2025-10-29 03:41:04,341 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0340_stage0_step2100.svg
[rank1]:2025-10-29 03:41:04,338 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0340_stage1_step2100.svg
[rank3]:2025-10-29 03:41:04,458 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0341_real_step2100_rank3.svg
[rank3]:> Batch Time: 377.97 ms, GPU Bubble Ratio: 64.77%, 22.80%, 33.37%, 24.39%
[rank3]:2025-10-29 03:41:04,523 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0341_stage3_step2100.svg
[rank3]:2025-10-29 03:41:04,834 - INFO - Avg. fwd time: 16.6457 / Avg. bwd time: 21.6816 / Avg. batch time: 322.0904 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 03:41:04,902 - INFO - Avg. fwd time: 15.4116 / Avg. bwd time: 5.4049 / Avg. batch time: 535.9645 (ms) / GPU bubble ratio: 68.93%
[rank1]:2025-10-29 03:41:04,890 - INFO - Avg. fwd time: 17.4983 / Avg. bwd time: 21.3992 / Avg. batch time: 514.3634 (ms) / GPU bubble ratio: 39.50%
[rank2]:2025-10-29 03:41:04,861 - INFO - Avg. fwd time: 15.0525 / Avg. bwd time: 18.5737 / Avg. batch time: 473.3114 (ms) / GPU bubble ratio: 43.16%
[rank0]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:25,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:41:41,011 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:41:41,010 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:41:41,010 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:46,283 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:07,323 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:22,896 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:22,896 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:22,897 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:28,216 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:51,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:42:54,287 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:54,288 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 66.72GiB(47.72%)  tps: 7,106  tflops: 331.44  mfu: 33.51%
[rank2]:2025-10-29 03:42:54,281 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:54,281 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 64.67GiB(46.25%)  tps: 7,107  tflops: 331.46  mfu: 33.51%
[rank1]:2025-10-29 03:42:54,283 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:54,284 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 72.68GiB(51.98%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank0]:2025-10-29 03:42:54,385 - INFO - Avg. fwd time: 15.4062 / Avg. bwd time: 5.4067 / Avg. batch time: 535.8734 (ms) / GPU bubble ratio: 68.93%
[rank3]:2025-10-29 03:42:59,529 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:59,534 - INFO -  step: 2150  loss:  0.1815  grad_norm:  0.2284  memory: 83.85GiB(59.97%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank2]:2025-10-29 03:42:59,809 - INFO - Avg. fwd time: 15.0486 / Avg. bwd time: 18.5722 / Avg. batch time: 473.2180 (ms) / GPU bubble ratio: 43.16%
[rank1]:2025-10-29 03:42:59,834 - INFO - Avg. fwd time: 17.4936 / Avg. bwd time: 21.3984 / Avg. batch time: 514.2743 (ms) / GPU bubble ratio: 39.50%
[rank3]:2025-10-29 03:42:59,787 - INFO - Avg. fwd time: 16.6398 / Avg. bwd time: 21.6778 / Avg. batch time: 322.0071 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 03:43:15,221 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:15,220 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:15,220 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:43:20,601 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:43:41,497 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:57,176 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:57,176 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:43:57,177 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:02,531 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:18,143 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:44:18,142 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:44:18,142 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:23,450 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:37,514 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:44:39,075 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:39,075 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,818  tflops: 364.62  mfu: 36.87%
[rank0]:2025-10-29 03:44:39,075 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 03:44:39,074 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:44:39,074 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,817  tflops: 364.60  mfu: 36.87%
[rank2]:2025-10-29 03:44:39,075 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 03:44:39,074 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:44:39,074 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,818  tflops: 364.61  mfu: 36.87%
[rank1]:2025-10-29 03:44:39,074 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:44:44,399 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:44,403 - INFO -  step: 2200  loss:  0.1049  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,812  tflops: 364.34  mfu: 36.84%
[rank3]:2025-10-29 03:44:44,403 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:45:01,191 - INFO - validate step: 2200  loss:  0.2388  memory: 83.85GiB(59.97%)  tps: 24,401
[rank0]:2025-10-29 03:45:01,128 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,574
[rank2]:2025-10-29 03:45:01,180 - INFO - validate step: 2200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,530
[rank1]:2025-10-29 03:45:01,165 - INFO - validate step: 2200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,543
[rank0]:2025-10-29 03:45:01,273 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0345_stage0_step2200.svg
[rank2]:2025-10-29 03:45:01,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0345_stage2_step2200.svg
[rank1]:2025-10-29 03:45:01,273 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0345_stage1_step2200.svg
[rank3]:2025-10-29 03:45:01,388 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0345_real_step2200_rank3.svg
[rank3]:> Batch Time: 377.73 ms, GPU Bubble Ratio: 64.78%, 22.78%, 33.37%, 24.40%
[rank0]:2025-10-29 03:45:01,371 - INFO - Avg. fwd time: 15.4010 / Avg. bwd time: 5.3854 / Avg. batch time: 535.8252 (ms) / GPU bubble ratio: 68.97%
[rank3]:2025-10-29 03:45:01,452 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0345_stage3_step2200.svg
[rank2]:2025-10-29 03:45:01,723 - INFO - Avg. fwd time: 15.0451 / Avg. bwd time: 18.5586 / Avg. batch time: 473.2054 (ms) / GPU bubble ratio: 43.19%
[rank3]:2025-10-29 03:45:01,702 - INFO - Avg. fwd time: 16.6335 / Avg. bwd time: 21.6582 / Avg. batch time: 321.7932 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 03:45:01,749 - INFO - Avg. fwd time: 17.4888 / Avg. bwd time: 21.3832 / Avg. batch time: 514.2533 (ms) / GPU bubble ratio: 39.53%
[rank0]:2025-10-29 03:45:17,209 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:17,208 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:17,208 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:45:22,483 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:45:38,075 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:38,074 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:38,075 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:45:43,395 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:45:59,052 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:59,052 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:59,051 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:04,312 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:20,004 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:46:20,003 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:46:20,003 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:25,336 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:39,365 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:46:40,933 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,208  tflops: 382.82  mfu: 38.71%
[rank1]:2025-10-29 03:46:40,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,211  tflops: 382.97  mfu: 38.72%
[rank2]:2025-10-29 03:46:40,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,212  tflops: 383.02  mfu: 38.73%
[rank3]:2025-10-29 03:46:46,232 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:46,239 - INFO -  step: 2250  loss:  0.1445  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,798  tflops: 363.72  mfu: 36.78%
[rank3]:2025-10-29 03:46:46,560 - INFO - Avg. fwd time: 16.6337 / Avg. bwd time: 21.5900 / Avg. batch time: 321.2431 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 03:46:46,589 - INFO - Avg. fwd time: 15.0468 / Avg. bwd time: 18.5031 / Avg. batch time: 472.8025 (ms) / GPU bubble ratio: 43.23%
[rank0]:2025-10-29 03:46:46,635 - INFO - Avg. fwd time: 15.4009 / Avg. bwd time: 5.2863 / Avg. batch time: 535.2670 (ms) / GPU bubble ratio: 69.08%
[rank1]:2025-10-29 03:46:46,621 - INFO - Avg. fwd time: 17.4909 / Avg. bwd time: 21.3207 / Avg. batch time: 513.7996 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 03:47:01,985 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:01,985 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:01,984 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:07,298 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:47:22,933 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:22,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:22,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:28,201 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:47:43,792 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:43,791 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:43,791 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:49,211 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:10,378 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:24,354 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:48:25,928 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:48:25,928 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank0]:2025-10-29 03:48:25,929 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:25,929 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank2]:2025-10-29 03:48:25,928 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:25,929 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank3]:2025-10-29 03:48:31,379 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:31,383 - INFO -  step: 2300  loss:  0.0886  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,791  tflops: 363.39  mfu: 36.74%
[rank1]:2025-10-29 03:48:31,465 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0348_stage1_step2300.svg
[rank0]:2025-10-29 03:48:31,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0348_stage0_step2300.svg
[rank2]:2025-10-29 03:48:31,466 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0348_stage2_step2300.svg
[rank0]:2025-10-29 03:48:31,559 - INFO - Avg. fwd time: 15.4008 / Avg. bwd time: 5.2050 / Avg. batch time: 534.6559 (ms) / GPU bubble ratio: 69.17%
[rank3]:2025-10-29 03:48:31,581 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0348_real_step2300_rank3.svg
[rank3]:> Batch Time: 377.53 ms, GPU Bubble Ratio: 64.78%, 22.77%, 33.35%, 24.41%
[rank3]:2025-10-29 03:48:31,644 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0348_stage3_step2300.svg
[rank3]:2025-10-29 03:48:31,896 - INFO - Avg. fwd time: 16.6340 / Avg. bwd time: 21.5339 / Avg. batch time: 320.7921 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 03:48:31,943 - INFO - Avg. fwd time: 17.4926 / Avg. bwd time: 21.2688 / Avg. batch time: 513.2757 (ms) / GPU bubble ratio: 39.59%
[rank2]:2025-10-29 03:48:31,917 - INFO - Avg. fwd time: 15.0483 / Avg. bwd time: 18.4574 / Avg. batch time: 472.3237 (ms) / GPU bubble ratio: 43.25%
[rank1]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:52,781 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:08,469 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:08,470 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:08,469 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:13,969 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:29,520 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:29,521 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:29,520 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:34,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:50,670 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:50,670 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:50,671 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:56,169 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:50:10,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:50:11,799 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank0]:2025-10-29 03:50:11,800 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank2]:2025-10-29 03:50:11,799 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank3]:2025-10-29 03:50:17,218 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:50:17,227 - INFO -  step: 2350  loss:  0.1327  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,740  tflops: 360.99  mfu: 36.50%
[rank3]:2025-10-29 03:50:17,628 - INFO - Avg. fwd time: 16.6343 / Avg. bwd time: 21.4711 / Avg. batch time: 320.2859 (ms) / GPU bubble ratio: 4.82%
[rank2]:2025-10-29 03:50:17,677 - INFO - Avg. fwd time: 15.0500 / Avg. bwd time: 18.4065 / Avg. batch time: 471.4758 (ms) / GPU bubble ratio: 43.23%
[rank1]:2025-10-29 03:50:17,723 - INFO - Avg. fwd time: 17.4943 / Avg. bwd time: 21.2106 / Avg. batch time: 512.3774 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 03:50:17,756 - INFO - Avg. fwd time: 15.4004 / Avg. bwd time: 5.1141 / Avg. batch time: 533.6602 (ms) / GPU bubble ratio: 69.25%
[rank0]:2025-10-29 03:50:43,223 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:50:43,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:50:43,216 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:50:48,742 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:04,482 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:04,481 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:04,481 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:09,813 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:30,910 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:51,936 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:52:06,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:52:07,616 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank0]:2025-10-29 03:52:07,616 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,513  tflops: 350.41  mfu: 34.40%
[rank0]:2025-10-29 03:52:07,616 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:52:07,615 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank1]:2025-10-29 03:52:07,616 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,513  tflops: 350.41  mfu: 34.40%
[rank1]:2025-10-29 03:52:07,616 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:52:07,615 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank2]:2025-10-29 03:52:07,615 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,514  tflops: 350.43  mfu: 34.40%
[rank2]:2025-10-29 03:52:07,615 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:52:13,031 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:52:13,035 - INFO -  step: 2400  loss:  0.1171  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,074  tflops: 329.93  mfu: 33.36%
[rank3]:2025-10-29 03:52:13,035 - INFO -  final step: 2400  loss:  0.1171  grad_norm:  0.0000  tps: 7,427  tflops: 346.39  mfu: 33.99%
[rank3]:2025-10-29 03:52:13,035 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 03:52:29,663 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,579
[rank0]:2025-10-29 03:52:29,664 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:52:29,668 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 03:52:29,700 - INFO - validate step: 2400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,547
[rank1]:2025-10-29 03:52:29,700 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:52:29,703 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 03:52:29,717 - INFO - validate step: 2400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,533
[rank2]:2025-10-29 03:52:29,718 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:52:29,724 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 03:52:29,725 - INFO - validate step: 2400  loss:  0.2374  memory: 83.85GiB(59.97%)  tps: 24,543
[rank3]:2025-10-29 03:52:29,726 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 03:52:29,729 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 03:52:40,798 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 03:52:40,888 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0352_stage1_final2400.svg
[rank2]:2025-10-29 03:52:40,892 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0352_stage2_final2400.svg
[rank0]:2025-10-29 03:52:40,906 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0352_stage0_final2400.svg
[rank3]:2025-10-29 03:52:41,017 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0352_real_final2400_rank3.svg
[rank3]:> Batch Time: 377.37 ms, GPU Bubble Ratio: 64.79%, 22.76%, 33.34%, 24.42%
[rank1]:2025-10-29 03:52:41,138 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank1_stage1.svg
[rank1]:	> Counts Sum: 17201, Total Sum: 19035 (90.37%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank1]:2025-10-29 03:52:41,139 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 03:52:41,186 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank0_stage0.svg
[rank0]:	> Counts Sum: 15484, Total Sum: 17155 (90.26%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 1.7]
[rank0]:2025-10-29 03:52:41,186 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 03:52:41,166 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank2_stage2.svg
[rank2]:	> Counts Sum: 15266, Total Sum: 16920 (90.22%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank2]:2025-10-29 03:52:41,167 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 03:52:41,372 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0352_thry_final2400_rank3.svg
[rank3]:> Batch Time: 537.24 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 03:52:41,501 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0352_stage3_final2400.svg
[rank3]:2025-10-29 03:52:41,912 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank3_stage3.svg
[rank3]:	> Counts Sum: 13975, Total Sum: 15275 (91.49%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48]
[rank3]:2025-10-29 03:52:41,913 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank0]:2025-10-29 03:52:43,186 - INFO - Training completed
[rank0]:2025-10-29 03:52:43,187 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 03:52:43,247 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–…â–…â–â–…â–†â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–‚â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–ƒâ–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–†â–‡â–‡â–‡â–ˆâ–ˆâ–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–â–†â–ˆâ–‡â–†â–ˆâ–‡â–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–†â–‡â–‡â–‡â–ˆâ–ˆâ–â–â–â–â–â–â–â–‚â–â–‚â–â–‚â–â–â–‡â–ˆâ–‡â–‡â–‡â–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.20605
[rank3]:wandb:               final/avg_loss 0.1171
[rank3]:wandb:             final/avg_mfu(%) 33.98818
[rank3]:wandb:             final/avg_tflops 346.38981
[rank3]:wandb:    final/avg_throughput(tps) 7426.85721
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.1171
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.1171
[rank3]:wandb: loss_metrics/global_max_loss 0.1171
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2pi1be3k
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_apf_dm1/20251029-0219/wandb/run-20251029_021904-2pi1be3k/logs
[rank0]:2025-10-29 03:52:43,763 - INFO - Process group destroyed
[rank2]:2025-10-29 03:52:43,762 - INFO - Process group destroyed
[rank3]:2025-10-29 03:52:43,901 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.11', 'layers.12', 'layers.8', 'layers.10', 'layers.15', 'layers.16', 'layers.9', 'layers.14'}
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.17', 'layers.19', 'layers.23', 'layers.18', 'layers.20', 'layers.21', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.5', 'layers.6', 'layers.3', 'tok_embeddings', 'layers.7', 'layers.4', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'layers.29', 'output', 'layers.25', 'layers.31', 'norm', 'layers.26', 'layers.27', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
