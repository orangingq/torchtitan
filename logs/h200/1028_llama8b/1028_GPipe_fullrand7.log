
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 03:37:32 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] 
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] *****************************************
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-10-29 03:37:39,334 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 03:37:39,437 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 03:37:39,462 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 03:37:39,569 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 03:37:40,142 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 03:37:40,145 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 03:37:40,431 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 03:37:40,432 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 03:37:40,411 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 03:37:40,413 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:37:40,462 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 03:37:40,465 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:37:40,470 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 03:37:42,421 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 03:37:42,717 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 03:37:44,255 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 03:37:45,807 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 03:37:45,978 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 03:37:46,050 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 03:37:46,050 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:46,125 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 03:37:46,066 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 03:37:46,118 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 03:37:46,143 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 03:37:46,143 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:46,202 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 03:37:46,203 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 03:37:46,251 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 03:37:46,252 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 03:37:46,430 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 03:37:46,430 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 03:37:46,368 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 03:37:46,368 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run i08zgsmr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1/20251029-0337/wandb/run-20251029_033746-i08zgsmr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/i08zgsmr
[rank3]:2025-10-29 03:37:47,993 - INFO - WandB logging enabled
[rank3]:2025-10-29 03:37:47,994 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 03:37:48,069 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 03:37:48,069 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:48,281 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank0]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:48,281 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:37:48,269 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 03:37:48,270 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:51,709 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 03:37:51,709 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 03:38:01,129 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 03:38:01,130 - INFO - Finished loading the checkpoint in 9.42 seconds.
[rank0]:2025-10-29 03:38:01,130 - INFO - Training starts at step 1
[rank0]:2025-10-29 03:38:05,993 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 49.75GiB(35.58%)  tps: 824  tflops: 38.45  mfu: 3.89%
[rank0]:2025-10-29 03:38:05,994 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 03:38:05,975 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 49.69GiB(35.54%)  tps: 827  tflops: 38.59  mfu: 3.90%
[rank1]:2025-10-29 03:38:05,976 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 03:38:05,977 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.3708  memory: 58.03GiB(41.50%)  tps: 914  tflops: 42.62  mfu: 4.31%
[rank3]:2025-10-29 03:38:05,978 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:38:05,974 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 44.28GiB(31.67%)  tps: 821  tflops: 38.31  mfu: 3.87%
[rank2]:2025-10-29 03:38:05,974 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,443 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,485 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:40:15,870 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:40:18,604 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 64.32GiB(46.00%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank2]:2025-10-29 03:40:18,601 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 57.29GiB(40.97%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank3]:2025-10-29 03:40:18,606 - INFO -  step: 50  loss:  3.2514  grad_norm: 16.1512  memory: 73.38GiB(52.48%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank0]:2025-10-29 03:40:18,608 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 66.72GiB(47.72%)  tps: 6,054  tflops: 282.35  mfu: 28.55%
[rank3]:2025-10-29 03:40:19,069 - INFO - Avg. fwd time: 14.8050 / Avg. bwd time: 43.1365 / Avg. batch time: 484.7553 (ms) / GPU bubble ratio: 4.38%
[rank1]:2025-10-29 03:40:19,167 - INFO - Avg. fwd time: 15.2321 / Avg. bwd time: 41.0241 / Avg. batch time: 598.1378 (ms) / GPU bubble ratio: 24.76%
[rank2]:2025-10-29 03:40:19,120 - INFO - Avg. fwd time: 13.3992 / Avg. bwd time: 36.5862 / Avg. batch time: 538.2795 (ms) / GPU bubble ratio: 25.71%
[rank0]:2025-10-29 03:40:19,200 - INFO - Avg. fwd time: 14.2054 / Avg. bwd time: 38.1712 / Avg. batch time: 653.5159 (ms) / GPU bubble ratio: 35.88%
[rank3]:2025-10-29 03:40:45,446 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 03:41:12,540 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 03:41:12,756 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-29 03:41:12,881 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,915 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,864 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,897 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:12,866 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:12,890 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,858 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,890 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,950 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,993 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,929 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,029 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,067 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,105 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,032 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,069 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,107 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,041 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,079 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,117 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,100 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,143 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,145 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,183 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,155 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,193 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,137 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,176 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,216 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,254 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:46,361 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 03:41:46,671 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_max_batch_time.svg
[rank3]:> Batch Time: 634.28 ms, GPU Bubble Ratio: 33.80%, 28.02%, 36.56%, 26.32%
[rank3]:2025-10-29 03:41:46,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_min_batch_time.svg
[rank3]:> Batch Time: 358.78 ms, GPU Bubble Ratio: 68.97%, 24.19%, 33.56%, 23.50%
[rank3]:2025-10-29 03:41:47,082 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.78 ms, GPU Bubble Ratio: 32.09%, 23.23%, 29.08%, 23.50%
[rank3]:2025-10-29 03:41:47,083 - INFO - 	> Batch Time: 358.78 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 03:42:01,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:42:03,652 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.91, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 03:42:03,633 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.28/0.84, [MB3] 0.29/0.87, [MB4] 0.30/0.91, [MB5] 0.31/0.94, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 03:42:03,651 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,798  tflops: 363.71  mfu: 36.78%
[rank1]:2025-10-29 03:42:03,653 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,798  tflops: 363.71  mfu: 36.78%
[rank3]:2025-10-29 03:42:03,618 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 03:42:03,652 - INFO -  step: 100  loss:  2.4528  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,799  tflops: 363.73  mfu: 36.78%
[rank0]:2025-10-29 03:42:03,652 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-10-29 03:42:03,652 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,799  tflops: 363.73  mfu: 36.78%
[rank2]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0342_stage2_step100.svg
[rank1]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0342_stage1_step100.svg
[rank0]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0342_stage0_step100.svg
[rank3]:2025-10-29 03:42:03,834 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0342_real_step100_rank3.svg
[rank3]:> Batch Time: 631.96 ms, GPU Bubble Ratio: 33.68%, 28.10%, 36.43%, 26.25%
[rank0]:2025-10-29 03:42:03,825 - INFO - Avg. fwd time: 14.5982 / Avg. bwd time: 27.4813 / Avg. batch time: 582.2292 (ms) / GPU bubble ratio: 42.18%
[rank3]:2025-10-29 03:42:03,896 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0342_stage3_step100.svg
[rank3]:2025-10-29 03:42:04,164 - INFO - Avg. fwd time: 15.5666 / Avg. bwd time: 36.5185 / Avg. batch time: 435.6104 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-10-29 03:42:04,186 - INFO - Avg. fwd time: 14.0379 / Avg. bwd time: 30.9046 / Avg. batch time: 484.4686 (ms) / GPU bubble ratio: 25.79%
[rank1]:2025-10-29 03:42:04,212 - INFO - Avg. fwd time: 16.1693 / Avg. bwd time: 34.7983 / Avg. batch time: 537.8812 (ms) / GPU bubble ratio: 24.19%
[rank0]:2025-10-29 03:43:50,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:43:52,848 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 03:43:52,939 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.56/0.84, [MB3] 0.58/0.87, [MB4] 0.60/0.91, [MB5] 0.63/0.94, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank1]:2025-10-29 03:43:52,969 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.61/0.91, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 03:43:52,998 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 72.81GiB(52.08%)  tps: 7,492  tflops: 349.42  mfu: 35.33%
[rank3]:2025-10-29 03:43:52,998 - INFO -  step: 150  loss:  1.1602  grad_norm:  0.2062  memory: 86.11GiB(61.59%)  tps: 7,492  tflops: 349.42  mfu: 35.33%
[rank2]:2025-10-29 03:43:53,000 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 64.67GiB(46.25%)  tps: 7,492  tflops: 349.41  mfu: 35.33%
[rank0]:2025-10-29 03:43:52,991 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-10-29 03:43:52,997 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 72.54GiB(51.88%)  tps: 7,492  tflops: 349.43  mfu: 35.33%
[rank3]:2025-10-29 03:43:53,417 - INFO - Avg. fwd time: 15.7969 / Avg. bwd time: 34.0124 / Avg. batch time: 416.1354 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-29 03:43:53,445 - INFO - Avg. fwd time: 14.1622 / Avg. bwd time: 29.3397 / Avg. batch time: 464.3881 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-10-29 03:43:53,475 - INFO - Avg. fwd time: 16.3500 / Avg. bwd time: 32.5039 / Avg. batch time: 516.6364 (ms) / GPU bubble ratio: 24.35%
[rank0]:2025-10-29 03:43:53,501 - INFO - Avg. fwd time: 14.7235 / Avg. bwd time: 26.6225 / Avg. batch time: 560.2172 (ms) / GPU bubble ratio: 40.96%
[rank0]:2025-10-29 03:45:26,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:45:27,724 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.84/0.84, [MB3] 0.87/0.87, [MB4] 0.91/0.91, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:45:27,641 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 64.90GiB(46.42%)  tps: 8,646  tflops: 403.23  mfu: 40.77%
[rank2]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss:  0.9320  grad_norm:  0.0634  memory: 86.11GiB(61.59%)  tps: 8,646  tflops: 403.23  mfu: 40.77%
[rank3]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 03:45:27,746 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 74.10GiB(53.00%)  tps: 8,645  tflops: 403.23  mfu: 40.77%
[rank1]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 03:45:27,753 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 72.54GiB(51.88%)  tps: 8,645  tflops: 403.22  mfu: 40.77%
[rank0]:2025-10-29 03:45:27,754 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 03:45:45,529 - INFO - validate step: 200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 23,043
[rank1]:2025-10-29 03:45:45,504 - INFO - validate step: 200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 23,075
[rank0]:2025-10-29 03:45:45,468 - INFO - validate step: 200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 23,123
[rank2]:2025-10-29 03:45:45,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0345_stage2_step200.svg
[rank3]:2025-10-29 03:45:45,553 - INFO - validate step: 200  loss:  0.2415  memory: 86.11GiB(61.59%)  tps: 23,013
[rank1]:2025-10-29 03:45:45,630 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0345_stage1_step200.svg
[rank0]:2025-10-29 03:45:45,626 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0345_stage0_step200.svg
[rank3]:2025-10-29 03:45:45,740 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0345_real_step200_rank3.svg
[rank3]:> Batch Time: 502.30 ms, GPU Bubble Ratio: 34.11%, 27.97%, 35.93%, 26.84%
[rank3]:2025-10-29 03:45:45,807 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0345_stage3_step200.svg
[rank0]:2025-10-29 03:45:45,762 - INFO - Avg. fwd time: 14.9083 / Avg. bwd time: 24.3428 / Avg. batch time: 536.6707 (ms) / GPU bubble ratio: 41.49%
[rank2]:2025-10-29 03:45:46,098 - INFO - Avg. fwd time: 14.3708 / Avg. bwd time: 27.2645 / Avg. batch time: 445.5535 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 03:45:46,074 - INFO - Avg. fwd time: 16.0128 / Avg. bwd time: 31.8321 / Avg. batch time: 399.8652 (ms) / GPU bubble ratio: 4.28%
[rank1]:2025-10-29 03:45:46,126 - INFO - Avg. fwd time: 16.5855 / Avg. bwd time: 30.2525 / Avg. batch time: 495.4200 (ms) / GPU bubble ratio: 24.37%
[rank0]:2025-10-29 03:47:06,999 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:47:08,637 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.84/0.84, [MB3] 0.87/0.87, [MB4] 0.91/0.91, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:47:08,656 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,855  tflops: 459.63  mfu: 46.47%
[rank3]:2025-10-29 03:47:08,623 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss:  0.9256  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,858  tflops: 459.77  mfu: 46.49%
[rank1]:2025-10-29 03:47:08,656 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,852  tflops: 459.49  mfu: 46.46%
[rank0]:2025-10-29 03:47:08,657 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,847  tflops: 459.29  mfu: 46.44%
[rank0]:2025-10-29 03:47:08,753 - INFO - Avg. fwd time: 15.1067 / Avg. bwd time: 19.3038 / Avg. batch time: 507.3678 (ms) / GPU bubble ratio: 45.74%
[rank2]:2025-10-29 03:47:08,991 - INFO - Avg. fwd time: 14.6250 / Avg. bwd time: 24.9895 / Avg. batch time: 424.0850 (ms) / GPU bubble ratio: 25.27%
[rank3]:2025-10-29 03:47:08,969 - INFO - Avg. fwd time: 16.3123 / Avg. bwd time: 29.2257 / Avg. batch time: 381.0217 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 03:47:09,017 - INFO - Avg. fwd time: 16.8788 / Avg. bwd time: 27.8092 / Avg. batch time: 471.2932 (ms) / GPU bubble ratio: 24.14%
[rank0]:2025-10-29 03:48:29,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:48:31,657 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank3_trend_line.svg
[rank2]:2025-10-29 03:48:31,660 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank2_trend_line.svg
[rank1]:2025-10-29 03:48:31,686 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank1_trend_line.svg
[rank1]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,685 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank0_trend_line.svg
[rank0]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,694 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,866  tflops: 460.13  mfu: 46.52%
[rank2]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.80/0.80, [MB5] 0.87/0.87, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.80/0.80, [MB5] 0.87/0.87, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:48:31,693 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank1]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:48:31,693 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,866  tflops: 460.13  mfu: 46.52%
[rank3]:2025-10-29 03:48:31,891 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0348_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 363.33 ms, GPU Bubble Ratio: 40.20%, 23.23%, 31.91%, 24.13%
[rank3]:2025-10-29 03:48:31,892 - INFO - 	> Batch Time: 363.33 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 03:48:31,892 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:48:31,893 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:48:31,896 - INFO -  step: 300  loss:  0.8513  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,842  tflops: 459.01  mfu: 46.41%
[rank2]:2025-10-29 03:48:31,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0348_stage2_step300.svg
[rank1]:2025-10-29 03:48:31,966 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0348_stage1_step300.svg
[rank0]:2025-10-29 03:48:31,964 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0348_stage0_step300.svg
[rank3]:2025-10-29 03:48:32,074 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0348_real_step300_rank3.svg
[rank3]:> Batch Time: 433.46 ms, GPU Bubble Ratio: 39.15%, 26.85%, 35.63%, 26.32%
[rank3]:2025-10-29 03:48:32,139 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0348_stage3_step300.svg
[rank3]:2025-10-29 03:48:32,471 - INFO - Avg. fwd time: 16.5045 / Avg. bwd time: 27.5194 / Avg. batch time: 368.6605 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-29 03:48:32,492 - INFO - Avg. fwd time: 14.7917 / Avg. bwd time: 23.4873 / Avg. batch time: 409.9877 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 03:48:32,516 - INFO - Avg. fwd time: 17.0623 / Avg. bwd time: 26.1859 / Avg. batch time: 455.3915 (ms) / GPU bubble ratio: 24.02%
[rank0]:2025-10-29 03:48:32,521 - INFO - Avg. fwd time: 15.2317 / Avg. bwd time: 15.9290 / Avg. batch time: 487.9953 (ms) / GPU bubble ratio: 48.92%
[rank0]:2025-10-29 03:49:53,205 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:49:54,862 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,850  tflops: 459.40  mfu: 46.45%
[rank3]:2025-10-29 03:49:54,864 - INFO -  step: 350  loss:  0.8848  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,874  tflops: 460.52  mfu: 46.56%
[rank0]:2025-10-29 03:49:54,863 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,850  tflops: 459.39  mfu: 46.45%
[rank1]:2025-10-29 03:49:54,863 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,850  tflops: 459.39  mfu: 46.45%
[rank0]:2025-10-29 03:49:54,964 - INFO - Avg. fwd time: 15.3092 / Avg. bwd time: 13.8533 / Avg. batch time: 475.9730 (ms) / GPU bubble ratio: 50.98%
[rank2]:2025-10-29 03:49:55,205 - INFO - Avg. fwd time: 14.8967 / Avg. bwd time: 22.5638 / Avg. batch time: 401.2230 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-10-29 03:49:55,183 - INFO - Avg. fwd time: 16.6230 / Avg. bwd time: 26.4673 / Avg. batch time: 361.0420 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-29 03:49:55,230 - INFO - Avg. fwd time: 17.1715 / Avg. bwd time: 25.1847 / Avg. batch time: 445.5054 (ms) / GPU bubble ratio: 23.94%
[rank0]:2025-10-29 03:51:15,001 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:51:16,767 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank2_trend_line.svg
[rank2]:2025-10-29 03:51:16,793 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.74/0.74, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,999  tflops: 466.33  mfu: 47.15%
[rank2]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 03:51:16,756 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank3_trend_line.svg
[rank0]:2025-10-29 03:51:16,788 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank0_trend_line.svg
[rank0]:2025-10-29 03:51:16,794 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank0]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 03:51:16,784 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank1_trend_line.svg
[rank1]:2025-10-29 03:51:16,793 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.65/0.65, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank1]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 03:51:16,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0351_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.55 ms, GPU Bubble Ratio: 53.57%, 23.27%, 31.92%, 24.16%
[rank3]:2025-10-29 03:51:16,985 - INFO - 	> Batch Time: 362.55 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 03:51:16,985 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:51:16,989 - INFO -  step: 400  loss:  0.2454  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,975  tflops: 465.24  mfu: 47.04%
[rank3]:2025-10-29 03:51:16,990 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 03:51:33,529 - INFO - validate step: 400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,478
[rank0]:2025-10-29 03:51:33,456 - INFO - validate step: 400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,585
[rank1]:2025-10-29 03:51:33,493 - INFO - validate step: 400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,530
[rank3]:2025-10-29 03:51:33,553 - INFO - validate step: 400  loss:  0.2392  memory: 86.11GiB(61.59%)  tps: 24,729
[rank2]:2025-10-29 03:51:33,632 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0351_stage2_step400.svg
[rank0]:2025-10-29 03:51:33,633 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0351_stage0_step400.svg
[rank1]:2025-10-29 03:51:33,633 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0351_stage1_step400.svg
[rank3]:2025-10-29 03:51:33,730 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0351_real_step400_rank3.svg
[rank3]:> Batch Time: 383.39 ms, GPU Bubble Ratio: 67.26%, 24.02%, 33.24%, 23.15%
[rank0]:2025-10-29 03:51:33,717 - INFO - Avg. fwd time: 15.3607 / Avg. bwd time: 12.0252 / Avg. batch time: 465.0628 (ms) / GPU bubble ratio: 52.89%
[rank3]:2025-10-29 03:51:33,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0351_stage3_step400.svg
[rank3]:2025-10-29 03:51:34,043 - INFO - Avg. fwd time: 16.7069 / Avg. bwd time: 25.5265 / Avg. batch time: 354.0501 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 03:51:34,064 - INFO - Avg. fwd time: 14.9731 / Avg. bwd time: 21.7434 / Avg. batch time: 393.2040 (ms) / GPU bubble ratio: 25.30%
[rank1]:2025-10-29 03:51:34,089 - INFO - Avg. fwd time: 17.2478 / Avg. bwd time: 24.2947 / Avg. batch time: 436.4869 (ms) / GPU bubble ratio: 23.86%
[rank0]:2025-10-29 03:52:49,994 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 03:52:51,549 - INFO -  step: 450  loss:  0.2560  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,503  tflops: 489.88  mfu: 49.53%
[rank2]:2025-10-29 03:52:51,548 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,500  tflops: 489.72  mfu: 49.52%
[rank0]:2025-10-29 03:52:51,549 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,490  tflops: 489.26  mfu: 49.47%
[rank1]:2025-10-29 03:52:51,550 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,495  tflops: 489.49  mfu: 49.49%
[rank3]:2025-10-29 03:52:51,904 - INFO - Avg. fwd time: 16.6955 / Avg. bwd time: 24.7476 / Avg. batch time: 347.6098 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-29 03:52:51,926 - INFO - Avg. fwd time: 14.9774 / Avg. bwd time: 21.0881 / Avg. batch time: 385.9690 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 03:52:51,955 - INFO - Avg. fwd time: 15.3404 / Avg. bwd time: 10.6234 / Avg. batch time: 455.5550 (ms) / GPU bubble ratio: 54.40%
[rank1]:2025-10-29 03:52:51,950 - INFO - Avg. fwd time: 17.2448 / Avg. bwd time: 23.5900 / Avg. batch time: 428.4703 (ms) / GPU bubble ratio: 23.76%
[rank0]:2025-10-29 03:54:07,493 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss:  0.2602  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,573  tflops: 493.12  mfu: 49.86%
[rank2]:2025-10-29 03:54:09,032 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank0]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank1]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank2]:2025-10-29 03:54:09,105 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0354_stage2_step500.svg
[rank0]:2025-10-29 03:54:09,104 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0354_stage0_step500.svg
[rank1]:2025-10-29 03:54:09,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0354_stage1_step500.svg
[rank3]:2025-10-29 03:54:09,210 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0354_real_step500_rank3.svg
[rank3]:> Batch Time: 380.12 ms, GPU Bubble Ratio: 67.31%, 23.98%, 33.34%, 23.29%
[rank0]:2025-10-29 03:54:09,189 - INFO - Avg. fwd time: 15.3239 / Avg. bwd time: 9.6585 / Avg. batch time: 448.8093 (ms) / GPU bubble ratio: 55.47%
[rank3]:2025-10-29 03:54:09,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0354_stage3_step500.svg
[rank3]:2025-10-29 03:54:09,513 - INFO - Avg. fwd time: 16.6798 / Avg. bwd time: 24.2015 / Avg. batch time: 343.0325 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 03:54:09,534 - INFO - Avg. fwd time: 14.9790 / Avg. bwd time: 20.6367 / Avg. batch time: 380.7897 (ms) / GPU bubble ratio: 25.18%
[rank1]:2025-10-29 03:54:09,560 - INFO - Avg. fwd time: 17.2400 / Avg. bwd time: 23.1034 / Avg. batch time: 422.7563 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-29 03:55:25,263 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss:  0.2778  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank2]:2025-10-29 03:55:26,807 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank0]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank1]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank0]:2025-10-29 03:55:26,893 - INFO - Avg. fwd time: 15.3091 / Avg. bwd time: 8.7331 / Avg. batch time: 442.4677 (ms) / GPU bubble ratio: 56.53%
[rank3]:2025-10-29 03:55:27,098 - INFO - Avg. fwd time: 16.6687 / Avg. bwd time: 23.6827 / Avg. batch time: 338.7145 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 03:55:27,120 - INFO - Avg. fwd time: 14.9814 / Avg. bwd time: 20.2044 / Avg. batch time: 375.9501 (ms) / GPU bubble ratio: 25.13%
[rank1]:2025-10-29 03:55:27,144 - INFO - Avg. fwd time: 17.2336 / Avg. bwd time: 22.6374 / Avg. batch time: 417.4030 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 03:56:42,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:56:44,780 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank0_trend_line.svg
[rank0]:2025-10-29 03:56:44,785 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,505  tflops: 489.98  mfu: 49.54%
[rank0]:2025-10-29 03:56:44,787 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:56:44,751 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank3_trend_line.svg
[rank2]:2025-10-29 03:56:44,769 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank2_trend_line.svg
[rank2]:2025-10-29 03:56:44,786 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.72/0.72, [MB2] 0.72/0.72, [MB3] 0.72/0.72, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank2]:2025-10-29 03:56:44,788 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 03:56:44,780 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank1_trend_line.svg
[rank1]:2025-10-29 03:56:44,785 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.62/0.62, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank1]:2025-10-29 03:56:44,787 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:56:44,979 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0356_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.68 ms, GPU Bubble Ratio: 60.41%, 22.89%, 31.59%, 23.84%
[rank3]:2025-10-29 03:56:44,979 - INFO - 	> Batch Time: 357.68 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 03:56:44,980 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:56:44,984 - INFO -  step: 600  loss:  0.2381  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,479  tflops: 488.74  mfu: 49.42%
[rank3]:2025-10-29 03:56:44,984 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 03:57:01,485 - INFO - validate step: 600  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,531
[rank3]:2025-10-29 03:57:01,576 - INFO - validate step: 600  loss:  0.2407  memory: 86.11GiB(61.59%)  tps: 24,688
[rank2]:2025-10-29 03:57:01,553 - INFO - validate step: 600  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,432
[rank1]:2025-10-29 03:57:01,521 - INFO - validate step: 600  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,477
[rank0]:2025-10-29 03:57:01,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0357_stage0_step600.svg
[rank2]:2025-10-29 03:57:01,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0357_stage2_step600.svg
[rank1]:2025-10-29 03:57:01,653 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0357_stage1_step600.svg
[rank3]:2025-10-29 03:57:01,756 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0357_real_step600_rank3.svg
[rank3]:> Batch Time: 377.73 ms, GPU Bubble Ratio: 67.37%, 23.95%, 33.23%, 23.27%
[rank3]:2025-10-29 03:57:01,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0357_stage3_step600.svg
[rank0]:2025-10-29 03:57:02,185 - INFO - Avg. fwd time: 15.2956 / Avg. bwd time: 7.9695 / Avg. batch time: 437.2576 (ms) / GPU bubble ratio: 57.43%
[rank3]:2025-10-29 03:57:02,132 - INFO - Avg. fwd time: 16.6609 / Avg. bwd time: 23.2573 / Avg. batch time: 335.1847 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 03:57:02,154 - INFO - Avg. fwd time: 14.9824 / Avg. bwd time: 19.8480 / Avg. batch time: 371.9899 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 03:57:02,178 - INFO - Avg. fwd time: 17.2262 / Avg. bwd time: 22.2511 / Avg. batch time: 413.0076 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-10-29 03:58:54,163 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:58:56,475 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1078  memory: 72.54GiB(51.88%)  tps: 7,124  tflops: 332.27  mfu: 33.60%
[rank2]:2025-10-29 03:58:56,447 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,130  tflops: 332.55  mfu: 33.62%
[rank3]:2025-10-29 03:58:56,448 - INFO -  step: 650  loss:  0.1212  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,132  tflops: 332.62  mfu: 33.63%
[rank1]:2025-10-29 03:58:56,447 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,128  tflops: 332.46  mfu: 33.62%
[rank2]:2025-10-29 03:58:56,786 - INFO - Avg. fwd time: 14.9839 / Avg. bwd time: 19.5842 / Avg. batch time: 370.1420 (ms) / GPU bubble ratio: 25.29%
[rank3]:2025-10-29 03:58:56,765 - INFO - Avg. fwd time: 16.6493 / Avg. bwd time: 22.9394 / Avg. batch time: 332.5003 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:58:56,845 - INFO - Avg. fwd time: 17.2115 / Avg. bwd time: 21.9502 / Avg. batch time: 415.0399 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-10-29 03:58:56,965 - INFO - Avg. fwd time: 15.1836 / Avg. bwd time: 10.0963 / Avg. batch time: 445.6289 (ms) / GPU bubble ratio: 54.62%
[rank0]:2025-10-29 04:00:48,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:00:51,299 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank0]:2025-10-29 04:00:51,326 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0887  memory: 72.54GiB(51.88%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank3]:2025-10-29 04:00:51,300 - INFO -  step: 700  loss:  0.1358  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank2]:2025-10-29 04:00:51,299 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 04:00:51,404 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0400_stage1_step700.svg
[rank0]:2025-10-29 04:00:51,403 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0400_stage0_step700.svg
[rank2]:2025-10-29 04:00:51,402 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0400_stage2_step700.svg
[rank3]:2025-10-29 04:00:51,504 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0400_real_step700_rank3.svg
[rank3]:> Batch Time: 375.74 ms, GPU Bubble Ratio: 67.45%, 23.91%, 33.10%, 23.29%
[rank3]:2025-10-29 04:00:51,571 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0400_stage3_step700.svg
[rank3]:2025-10-29 04:00:51,815 - INFO - Avg. fwd time: 16.6347 / Avg. bwd time: 22.6175 / Avg. batch time: 329.7581 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 04:00:51,836 - INFO - Avg. fwd time: 14.9833 / Avg. bwd time: 19.3204 / Avg. batch time: 368.2615 (ms) / GPU bubble ratio: 25.48%
[rank1]:2025-10-29 04:00:51,895 - INFO - Avg. fwd time: 17.1949 / Avg. bwd time: 21.6498 / Avg. batch time: 417.0583 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-10-29 04:00:52,014 - INFO - Avg. fwd time: 15.0710 / Avg. bwd time: 12.2330 / Avg. batch time: 454.0194 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-10-29 04:02:43,989 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:02:46,298 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank0]:2025-10-29 04:02:46,325 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1105  memory: 72.54GiB(51.88%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank3]:2025-10-29 04:02:46,299 - INFO -  step: 750  loss:  0.1670  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,124  tflops: 332.25  mfu: 33.59%
[rank2]:2025-10-29 04:02:46,298 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank3]:2025-10-29 04:02:46,686 - INFO - Avg. fwd time: 16.6223 / Avg. bwd time: 22.3414 / Avg. batch time: 327.4075 (ms) / GPU bubble ratio: 4.79%
[rank2]:2025-10-29 04:02:46,714 - INFO - Avg. fwd time: 14.9834 / Avg. bwd time: 19.0962 / Avg. batch time: 366.6895 (ms) / GPU bubble ratio: 25.65%
[rank1]:2025-10-29 04:02:46,794 - INFO - Avg. fwd time: 17.1800 / Avg. bwd time: 21.3916 / Avg. batch time: 418.8379 (ms) / GPU bubble ratio: 26.33%
[rank0]:2025-10-29 04:02:46,892 - INFO - Avg. fwd time: 14.9736 / Avg. bwd time: 14.0715 / Avg. batch time: 461.2846 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-29 04:04:38,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:04:41,486 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank2_trend_line.svg
[rank1]:2025-10-29 04:04:41,497 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank1_trend_line.svg
[rank3]:2025-10-29 04:04:41,493 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank3_trend_line.svg
[rank2]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.69/0.69, [MB2] 0.69/0.69, [MB3] 0.69/0.69, [MB4] 0.77/0.77, [MB5] 0.84/0.84, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:04:41,585 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,106  tflops: 331.42  mfu: 33.51%
[rank2]:2025-10-29 04:04:41,585 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.59/0.59, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:04:41,584 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,106  tflops: 331.42  mfu: 33.51%
[rank1]:2025-10-29 04:04:41,584 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:04:41,576 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank0_trend_line.svg
[rank0]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:04:41,585 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0946  memory: 72.54GiB(51.88%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank0]:2025-10-29 04:04:41,585 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 04:04:41,774 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0404_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.23 ms, GPU Bubble Ratio: 36.25%, 22.91%, 31.37%, 23.89%
[rank3]:2025-10-29 04:04:41,775 - INFO - 	> Batch Time: 356.23 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 04:04:41,775 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:04:41,780 - INFO -  step: 800  loss:  0.1462  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,094  tflops: 330.86  mfu: 33.45%
[rank3]:2025-10-29 04:04:41,781 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:04:58,250 - INFO - validate step: 800  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,578
[rank2]:2025-10-29 04:04:58,297 - INFO - validate step: 800  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,510
[rank1]:2025-10-29 04:04:58,282 - INFO - validate step: 800  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,531
[rank3]:2025-10-29 04:04:58,317 - INFO - validate step: 800  loss:  0.2367  memory: 86.11GiB(61.59%)  tps: 24,770
[rank2]:2025-10-29 04:04:58,396 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0404_stage2_step800.svg
[rank1]:2025-10-29 04:04:58,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0404_stage1_step800.svg
[rank0]:2025-10-29 04:04:58,401 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0404_stage0_step800.svg
[rank3]:2025-10-29 04:04:58,498 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0404_real_step800_rank3.svg
[rank3]:> Batch Time: 373.37 ms, GPU Bubble Ratio: 67.45%, 23.71%, 32.87%, 23.40%
[rank3]:2025-10-29 04:04:58,567 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0404_stage3_step800.svg
[rank3]:2025-10-29 04:04:58,816 - INFO - Avg. fwd time: 16.6120 / Avg. bwd time: 22.1333 / Avg. batch time: 325.6280 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 04:04:58,838 - INFO - Avg. fwd time: 14.9825 / Avg. bwd time: 18.9279 / Avg. batch time: 365.4737 (ms) / GPU bubble ratio: 25.77%
[rank1]:2025-10-29 04:04:58,894 - INFO - Avg. fwd time: 17.1675 / Avg. bwd time: 21.1984 / Avg. batch time: 420.1393 (ms) / GPU bubble ratio: 26.95%
[rank0]:2025-10-29 04:04:59,009 - INFO - Avg. fwd time: 14.8997 / Avg. bwd time: 15.4547 / Avg. batch time: 466.7124 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-29 04:06:15,121 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,449  tflops: 487.36  mfu: 49.28%
[rank0]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,445  tflops: 487.16  mfu: 49.26%
[rank2]:2025-10-29 04:06:16,679 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,451  tflops: 487.46  mfu: 49.29%
[rank3]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss:  0.1682  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,454  tflops: 487.58  mfu: 49.30%
[rank0]:2025-10-29 04:06:16,765 - INFO - Avg. fwd time: 14.9111 / Avg. bwd time: 14.7249 / Avg. batch time: 462.5954 (ms) / GPU bubble ratio: 48.75%
[rank3]:2025-10-29 04:06:16,966 - INFO - Avg. fwd time: 16.6104 / Avg. bwd time: 21.9273 / Avg. batch time: 323.9378 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 04:06:16,988 - INFO - Avg. fwd time: 14.9831 / Avg. bwd time: 18.7550 / Avg. batch time: 363.4136 (ms) / GPU bubble ratio: 25.73%
[rank1]:2025-10-29 04:06:17,013 - INFO - Avg. fwd time: 17.1700 / Avg. bwd time: 21.0207 / Avg. batch time: 417.3382 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-10-29 04:07:32,957 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank2]:2025-10-29 04:07:34,496 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank3]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss:  0.1552  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,527  tflops: 491.00  mfu: 49.65%
[rank1]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank0]:2025-10-29 04:07:34,568 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0407_stage0_step900.svg
[rank2]:2025-10-29 04:07:34,569 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0407_stage2_step900.svg
[rank1]:2025-10-29 04:07:34,568 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0407_stage1_step900.svg
[rank3]:2025-10-29 04:07:34,676 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0407_real_step900_rank3.svg
[rank3]:> Batch Time: 372.33 ms, GPU Bubble Ratio: 67.35%, 23.55%, 32.80%, 23.46%
[rank3]:2025-10-29 04:07:34,736 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0407_stage3_step900.svg
[rank0]:2025-10-29 04:07:35,098 - INFO - Avg. fwd time: 14.9263 / Avg. bwd time: 13.8664 / Avg. batch time: 457.9863 (ms) / GPU bubble ratio: 49.71%
[rank2]:2025-10-29 04:07:35,066 - INFO - Avg. fwd time: 14.9839 / Avg. bwd time: 18.6031 / Avg. batch time: 361.5267 (ms) / GPU bubble ratio: 25.68%
[rank3]:2025-10-29 04:07:35,043 - INFO - Avg. fwd time: 16.6096 / Avg. bwd time: 21.7474 / Avg. batch time: 322.4663 (ms) / GPU bubble ratio: 4.84%
[rank1]:2025-10-29 04:07:35,092 - INFO - Avg. fwd time: 17.1714 / Avg. bwd time: 20.8621 / Avg. batch time: 414.4478 (ms) / GPU bubble ratio: 26.58%
[rank0]:2025-10-29 04:08:50,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank2]:2025-10-29 04:08:52,449 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank3]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss:  0.1804  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,509  tflops: 490.15  mfu: 49.56%
[rank1]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank0]:2025-10-29 04:08:52,536 - INFO - Avg. fwd time: 14.9377 / Avg. bwd time: 13.2064 / Avg. batch time: 454.4178 (ms) / GPU bubble ratio: 50.45%
[rank2]:2025-10-29 04:08:52,761 - INFO - Avg. fwd time: 14.9849 / Avg. bwd time: 18.4862 / Avg. batch time: 360.0606 (ms) / GPU bubble ratio: 25.63%
[rank3]:2025-10-29 04:08:52,740 - INFO - Avg. fwd time: 16.6102 / Avg. bwd time: 21.6095 / Avg. batch time: 321.3476 (ms) / GPU bubble ratio: 4.85%
[rank1]:2025-10-29 04:08:52,786 - INFO - Avg. fwd time: 17.1711 / Avg. bwd time: 20.7392 / Avg. batch time: 412.2031 (ms) / GPU bubble ratio: 26.42%
[rank0]:2025-10-29 04:10:08,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss:  0.1545  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,541  tflops: 491.65  mfu: 49.71%
[rank3]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank1]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank0]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 04:10:10,164 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank2]:2025-10-29 04:10:10,164 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:10:26,787 - INFO - validate step: 1000  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,642
[rank2]:2025-10-29 04:10:26,858 - INFO - validate step: 1000  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,536
[rank3]:2025-10-29 04:10:26,879 - INFO - validate step: 1000  loss:  0.2358  memory: 86.11GiB(61.59%)  tps: 24,508
[rank1]:2025-10-29 04:10:26,825 - INFO - validate step: 1000  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,586
[rank1]:2025-10-29 04:10:26,957 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0410_stage1_step1000.svg
[rank0]:2025-10-29 04:10:26,959 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0410_stage0_step1000.svg
[rank2]:2025-10-29 04:10:26,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0410_stage2_step1000.svg
[rank3]:2025-10-29 04:10:27,063 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0410_real_step1000_rank3.svg
[rank3]:> Batch Time: 371.87 ms, GPU Bubble Ratio: 67.31%, 23.52%, 32.77%, 23.46%
[rank0]:2025-10-29 04:10:27,045 - INFO - Avg. fwd time: 14.9479 / Avg. bwd time: 12.5117 / Avg. batch time: 450.6334 (ms) / GPU bubble ratio: 51.25%
[rank3]:2025-10-29 04:10:27,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0410_stage3_step1000.svg
[rank3]:2025-10-29 04:10:27,371 - INFO - Avg. fwd time: 16.6085 / Avg. bwd time: 21.4634 / Avg. batch time: 320.1433 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 04:10:27,394 - INFO - Avg. fwd time: 14.9849 / Avg. bwd time: 18.3630 / Avg. batch time: 358.4886 (ms) / GPU bubble ratio: 25.58%
[rank1]:2025-10-29 04:10:27,417 - INFO - Avg. fwd time: 17.1683 / Avg. bwd time: 20.6087 / Avg. batch time: 409.8128 (ms) / GPU bubble ratio: 26.26%
[rank0]:2025-10-29 04:11:43,236 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank2]:2025-10-29 04:11:44,787 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,512  tflops: 490.30  mfu: 49.58%
[rank1]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,508  tflops: 490.08  mfu: 49.55%
[rank3]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss:  0.1603  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,515  tflops: 490.42  mfu: 49.59%
[rank3]:2025-10-29 04:11:45,148 - INFO - Avg. fwd time: 16.6073 / Avg. bwd time: 21.3311 / Avg. batch time: 319.0566 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 04:11:45,174 - INFO - Avg. fwd time: 14.9854 / Avg. bwd time: 18.2525 / Avg. batch time: 357.1023 (ms) / GPU bubble ratio: 25.54%
[rank1]:2025-10-29 04:11:45,200 - INFO - Avg. fwd time: 17.1670 / Avg. bwd time: 20.4915 / Avg. batch time: 407.6944 (ms) / GPU bubble ratio: 26.10%
[rank0]:2025-10-29 04:11:45,207 - INFO - Avg. fwd time: 14.9582 / Avg. bwd time: 11.8864 / Avg. batch time: 447.2617 (ms) / GPU bubble ratio: 51.98%
[rank0]:2025-10-29 04:13:01,011 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:13:02,570 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank1]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank3]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss:  0.1300  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,532  tflops: 491.22  mfu: 49.67%
[rank0]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank0]:2025-10-29 04:13:02,650 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0413_stage0_step1100.svg
[rank2]:2025-10-29 04:13:02,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0413_stage2_step1100.svg
[rank1]:2025-10-29 04:13:02,643 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0413_stage1_step1100.svg
[rank0]:2025-10-29 04:13:02,740 - INFO - Avg. fwd time: 14.9661 / Avg. bwd time: 11.3982 / Avg. batch time: 444.6003 (ms) / GPU bubble ratio: 52.56%
[rank3]:2025-10-29 04:13:02,754 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0413_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.46 ms, GPU Bubble Ratio: 67.29%, 23.49%, 32.74%, 23.43%
[rank3]:2025-10-29 04:13:02,818 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0413_stage3_step1100.svg
[rank2]:2025-10-29 04:13:03,085 - INFO - Avg. fwd time: 14.9858 / Avg. bwd time: 18.1657 / Avg. batch time: 355.9962 (ms) / GPU bubble ratio: 25.50%
[rank3]:2025-10-29 04:13:03,063 - INFO - Avg. fwd time: 16.6062 / Avg. bwd time: 21.2281 / Avg. batch time: 318.2092 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 04:13:03,109 - INFO - Avg. fwd time: 17.1652 / Avg. bwd time: 20.3995 / Avg. batch time: 406.0108 (ms) / GPU bubble ratio: 25.98%
[rank0]:2025-10-29 04:14:19,030 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank2]:2025-10-29 04:14:20,602 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank1]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank3]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss:  0.1490  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,499  tflops: 489.65  mfu: 49.51%
[rank0]:2025-10-29 04:14:20,695 - INFO - Avg. fwd time: 14.9747 / Avg. bwd time: 10.8770 / Avg. batch time: 441.7965 (ms) / GPU bubble ratio: 53.19%
[rank2]:2025-10-29 04:14:20,921 - INFO - Avg. fwd time: 14.9860 / Avg. bwd time: 18.0733 / Avg. batch time: 354.8538 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:14:20,945 - INFO - Avg. fwd time: 17.1632 / Avg. bwd time: 20.3007 / Avg. batch time: 404.2508 (ms) / GPU bubble ratio: 25.86%
[rank3]:2025-10-29 04:14:20,899 - INFO - Avg. fwd time: 16.6058 / Avg. bwd time: 21.1190 / Avg. batch time: 317.3173 (ms) / GPU bubble ratio: 4.89%
[rank0]:2025-10-29 04:15:36,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:15:38,381 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank2]:2025-10-29 04:15:38,381 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank1]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss:  0.1340  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank3]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,532  tflops: 491.24  mfu: 49.67%
[rank0]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:15:55,007 - INFO - validate step: 1200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,638
[rank0]:2025-10-29 04:15:55,008 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:15:55,013 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 04:15:55,077 - INFO - validate step: 1200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,533
[rank2]:2025-10-29 04:15:55,078 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:15:55,043 - INFO - validate step: 1200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,585
[rank1]:2025-10-29 04:15:55,044 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:15:55,101 - INFO - validate step: 1200  loss:  0.2373  memory: 86.11GiB(61.59%)  tps: 24,500
[rank3]:2025-10-29 04:15:55,102 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:16:05,624 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.55 seconds.
[rank1]:2025-10-29 04:16:07,066 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.02 seconds.
[rank3]:2025-10-29 04:16:07,252 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.15 seconds.
[rank0]:2025-10-29 04:16:11,412 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 04:16:11,419 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.41 seconds.
[rank0]:2025-10-29 04:16:11,647 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0416_stage0_step1200.svg
[rank0]:2025-10-29 04:16:11,658 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 04:16:11,641 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0416_stage2_step1200.svg
[rank2]:2025-10-29 04:16:11,650 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 04:16:11,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0416_stage1_step1200.svg
[rank1]:2025-10-29 04:16:11,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:16:11,744 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0416_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.17 ms, GPU Bubble Ratio: 67.29%, 23.48%, 32.72%, 23.42%
[rank3]:2025-10-29 04:16:11,811 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0416_stage3_step1200.svg
[rank3]:2025-10-29 04:16:11,822 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:16:12,820 - INFO - Avg. fwd time: 16.6066 / Avg. bwd time: 21.0195 / Avg. batch time: 316.6518 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:16:12,885 - INFO - Avg. fwd time: 14.9840 / Avg. bwd time: 10.4014 / Avg. batch time: 439.3878 (ms) / GPU bubble ratio: 53.78%
[rank2]:2025-10-29 04:16:12,847 - INFO - Avg. fwd time: 14.9870 / Avg. bwd time: 17.9888 / Avg. batch time: 353.9567 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:16:12,874 - INFO - Avg. fwd time: 17.1624 / Avg. bwd time: 20.2108 / Avg. batch time: 402.7901 (ms) / GPU bubble ratio: 25.77%
[rank0]:2025-10-29 04:17:35,571 - INFO - [GC] Peforming periodical GC collection 1.82 seconds
[rank3]:2025-10-29 04:17:37,229 - INFO -  step: 1250  loss:  0.9494  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 8,021  tflops: 374.12  mfu: 37.83%
[rank0]:2025-10-29 04:17:37,230 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 8,014  tflops: 373.77  mfu: 37.79%
[rank2]:2025-10-29 04:17:37,228 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 8,020  tflops: 374.03  mfu: 37.82%
[rank1]:2025-10-29 04:17:37,229 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 8,017  tflops: 373.90  mfu: 37.81%
[rank0]:2025-10-29 04:17:37,329 - INFO - Avg. fwd time: 15.0151 / Avg. bwd time: 10.0256 / Avg. batch time: 437.8187 (ms) / GPU bubble ratio: 54.24%
[rank3]:2025-10-29 04:17:37,547 - INFO - Avg. fwd time: 16.6354 / Avg. bwd time: 20.9632 / Avg. batch time: 316.4213 (ms) / GPU bubble ratio: 4.94%
[rank2]:2025-10-29 04:17:37,569 - INFO - Avg. fwd time: 15.0088 / Avg. bwd time: 17.9313 / Avg. batch time: 353.5535 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:17:37,595 - INFO - Avg. fwd time: 17.1861 / Avg. bwd time: 20.1466 / Avg. batch time: 401.9472 (ms) / GPU bubble ratio: 25.70%
[rank0]:2025-10-29 04:18:58,569 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:19:00,223 - INFO -  step: 1300  loss:  0.9214  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank0]:2025-10-29 04:19:00,224 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank2]:2025-10-29 04:19:00,222 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank1]:2025-10-29 04:19:00,223 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank0]:2025-10-29 04:19:00,306 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0419_stage0_step1300.svg
[rank2]:2025-10-29 04:19:00,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0419_stage2_step1300.svg
[rank1]:2025-10-29 04:19:00,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0419_stage1_step1300.svg
[rank3]:2025-10-29 04:19:00,401 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0419_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.10 ms, GPU Bubble Ratio: 67.26%, 23.54%, 32.78%, 23.41%
[rank0]:2025-10-29 04:19:00,410 - INFO - Avg. fwd time: 15.0476 / Avg. bwd time: 9.6202 / Avg. batch time: 436.1441 (ms) / GPU bubble ratio: 54.75%
[rank3]:2025-10-29 04:19:00,466 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0419_stage3_step1300.svg
[rank2]:2025-10-29 04:19:00,761 - INFO - Avg. fwd time: 15.0324 / Avg. bwd time: 17.8695 / Avg. batch time: 353.1448 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:19:00,787 - INFO - Avg. fwd time: 17.2127 / Avg. bwd time: 20.0782 / Avg. batch time: 401.0660 (ms) / GPU bubble ratio: 25.62%
[rank3]:2025-10-29 04:19:00,739 - INFO - Avg. fwd time: 16.6681 / Avg. bwd time: 20.9040 / Avg. batch time: 316.1986 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:20:21,673 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:20:23,332 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank1]:2025-10-29 04:20:23,333 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,857  tflops: 459.72  mfu: 46.48%
[rank3]:2025-10-29 04:20:23,334 - INFO -  step: 1350  loss:  0.9308  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank0]:2025-10-29 04:20:23,334 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank2]:2025-10-29 04:20:23,745 - INFO - Avg. fwd time: 15.0542 / Avg. bwd time: 17.8122 / Avg. batch time: 352.7816 (ms) / GPU bubble ratio: 25.47%
[rank3]:2025-10-29 04:20:23,720 - INFO - Avg. fwd time: 16.6978 / Avg. bwd time: 20.8489 / Avg. batch time: 315.9857 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:20:23,781 - INFO - Avg. fwd time: 15.0775 / Avg. bwd time: 9.2462 / Avg. batch time: 434.6131 (ms) / GPU bubble ratio: 55.23%
[rank1]:2025-10-29 04:20:23,771 - INFO - Avg. fwd time: 17.2365 / Avg. bwd time: 20.0144 / Avg. batch time: 400.2664 (ms) / GPU bubble ratio: 25.55%
[rank0]:2025-10-29 04:21:44,689 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:21:46,354 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank0]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 04:21:46,353 - INFO -  step: 1400  loss:  0.9568  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,868  tflops: 460.23  mfu: 46.54%
[rank3]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 04:21:46,353 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank1]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 04:21:46,352 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank2]:2025-10-29 04:21:46,353 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:22:02,891 - INFO - validate step: 1400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,768
[rank1]:2025-10-29 04:22:02,926 - INFO - validate step: 1400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,716
[rank3]:2025-10-29 04:22:02,990 - INFO - validate step: 1400  loss:  0.2352  memory: 86.11GiB(61.59%)  tps: 24,622
[rank2]:2025-10-29 04:22:02,965 - INFO - validate step: 1400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,656
[rank0]:2025-10-29 04:22:03,078 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0422_stage0_step1400.svg
[rank1]:2025-10-29 04:22:03,072 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0422_stage1_step1400.svg
[rank2]:2025-10-29 04:22:03,072 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0422_stage2_step1400.svg
[rank0]:2025-10-29 04:22:03,189 - INFO - Avg. fwd time: 15.1011 / Avg. bwd time: 8.9481 / Avg. batch time: 433.3778 (ms) / GPU bubble ratio: 55.61%
[rank3]:2025-10-29 04:22:03,183 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0422_real_step1400_rank3.svg
[rank3]:> Batch Time: 372.98 ms, GPU Bubble Ratio: 67.24%, 23.61%, 32.84%, 23.40%
[rank3]:2025-10-29 04:22:03,253 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0422_stage3_step1400.svg
[rank3]:2025-10-29 04:22:03,527 - INFO - Avg. fwd time: 16.7212 / Avg. bwd time: 20.8058 / Avg. batch time: 315.8196 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:22:03,574 - INFO - Avg. fwd time: 17.2566 / Avg. bwd time: 19.9644 / Avg. batch time: 399.6157 (ms) / GPU bubble ratio: 25.49%
[rank2]:2025-10-29 04:22:03,549 - INFO - Avg. fwd time: 15.0712 / Avg. bwd time: 17.7666 / Avg. batch time: 352.4777 (ms) / GPU bubble ratio: 25.47%
[rank0]:2025-10-29 04:23:24,672 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,818  tflops: 457.92  mfu: 46.30%
[rank3]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss:  0.9778  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,830  tflops: 458.47  mfu: 46.36%
[rank1]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,822  tflops: 458.11  mfu: 46.32%
[rank2]:2025-10-29 04:23:26,328 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,827  tflops: 458.33  mfu: 46.34%
[rank0]:2025-10-29 04:23:26,430 - INFO - Avg. fwd time: 15.1279 / Avg. bwd time: 8.6238 / Avg. batch time: 432.0751 (ms) / GPU bubble ratio: 56.02%
[rank3]:2025-10-29 04:23:26,644 - INFO - Avg. fwd time: 16.7480 / Avg. bwd time: 20.7594 / Avg. batch time: 315.6538 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:23:26,691 - INFO - Avg. fwd time: 17.2793 / Avg. bwd time: 19.9108 / Avg. batch time: 398.9469 (ms) / GPU bubble ratio: 25.42%
[rank2]:2025-10-29 04:23:26,666 - INFO - Avg. fwd time: 15.0900 / Avg. bwd time: 17.7174 / Avg. batch time: 352.1844 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:24:47,637 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:24:49,283 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank3]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss:  0.8592  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank0]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank1]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,875  tflops: 460.58  mfu: 46.57%
[rank1]:2025-10-29 04:24:49,364 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0424_stage1_step1500.svg
[rank2]:2025-10-29 04:24:49,366 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0424_stage2_step1500.svg
[rank0]:2025-10-29 04:24:49,367 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0424_stage0_step1500.svg
[rank3]:2025-10-29 04:24:49,472 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0424_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.01 ms, GPU Bubble Ratio: 67.24%, 23.68%, 32.92%, 23.38%
[rank3]:2025-10-29 04:24:49,543 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0424_stage3_step1500.svg
[rank3]:2025-10-29 04:24:49,883 - INFO - Avg. fwd time: 16.7719 / Avg. bwd time: 20.7154 / Avg. batch time: 315.4843 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:24:49,945 - INFO - Avg. fwd time: 15.1516 / Avg. bwd time: 8.3221 / Avg. batch time: 430.8487 (ms) / GPU bubble ratio: 56.41%
[rank1]:2025-10-29 04:24:49,936 - INFO - Avg. fwd time: 17.2990 / Avg. bwd time: 19.8607 / Avg. batch time: 398.3104 (ms) / GPU bubble ratio: 25.37%
[rank2]:2025-10-29 04:24:49,909 - INFO - Avg. fwd time: 15.1071 / Avg. bwd time: 17.6715 / Avg. batch time: 351.8976 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:26:10,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:26:12,559 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank3]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss:  0.9272  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,837  tflops: 458.82  mfu: 46.39%
[rank0]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank1]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank0]:2025-10-29 04:26:12,663 - INFO - Avg. fwd time: 15.1715 / Avg. bwd time: 8.0799 / Avg. batch time: 429.8552 (ms) / GPU bubble ratio: 56.73%
[rank3]:2025-10-29 04:26:12,882 - INFO - Avg. fwd time: 16.7917 / Avg. bwd time: 20.6807 / Avg. batch time: 315.3593 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:26:12,929 - INFO - Avg. fwd time: 17.3156 / Avg. bwd time: 19.8207 / Avg. batch time: 397.7909 (ms) / GPU bubble ratio: 25.31%
[rank2]:2025-10-29 04:26:12,903 - INFO - Avg. fwd time: 15.1214 / Avg. bwd time: 17.6349 / Avg. batch time: 351.6597 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:27:32,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:27:35,177 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank3_trend_line.svg
[rank1]:2025-10-29 04:27:35,195 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank1_trend_line.svg
[rank2]:2025-10-29 04:27:35,175 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank2_trend_line.svg
[rank2]:2025-10-29 04:27:35,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.54/0.54, [MB4] 0.65/0.65, [MB5] 0.77/0.77, [MB6] 0.88/0.88, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:27:35,215 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,911  tflops: 462.25  mfu: 46.74%
[rank2]:2025-10-29 04:27:35,215 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 04:27:35,204 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank0_trend_line.svg
[rank0]:2025-10-29 04:27:35,211 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:27:35,214 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,911  tflops: 462.26  mfu: 46.74%
[rank0]:2025-10-29 04:27:35,214 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 04:27:35,211 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.36/0.36, [MB1] 0.87/0.87, [MB2] 0.88/0.88, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:27:35,214 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,911  tflops: 462.26  mfu: 46.74%
[rank1]:2025-10-29 04:27:35,214 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 04:27:35,411 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0427_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.78 ms, GPU Bubble Ratio: 53.90%, 22.81%, 30.79%, 23.83%
[rank3]:2025-10-29 04:27:35,411 - INFO - 	> Batch Time: 356.78 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 04:27:35,412 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:27:35,418 - INFO -  step: 1600  loss:  0.1447  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank3]:2025-10-29 04:27:35,418 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 04:27:51,826 - INFO - validate step: 1600  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,657
[rank1]:2025-10-29 04:27:51,860 - INFO - validate step: 1600  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,607
[rank2]:2025-10-29 04:27:51,893 - INFO - validate step: 1600  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,561
[rank0]:2025-10-29 04:27:52,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0427_stage0_step1600.svg
[rank3]:2025-10-29 04:27:51,916 - INFO - validate step: 1600  loss:  0.2377  memory: 86.11GiB(61.59%)  tps: 24,829
[rank1]:2025-10-29 04:27:51,998 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0427_stage1_step1600.svg
[rank2]:2025-10-29 04:27:52,001 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0427_stage2_step1600.svg
[rank0]:2025-10-29 04:27:52,096 - INFO - Avg. fwd time: 15.1885 / Avg. bwd time: 7.8145 / Avg. batch time: 428.6770 (ms) / GPU bubble ratio: 57.07%
[rank3]:2025-10-29 04:27:52,105 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0427_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.10 ms, GPU Bubble Ratio: 67.24%, 23.78%, 33.00%, 23.34%
[rank3]:2025-10-29 04:27:52,177 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0427_stage3_step1600.svg
[rank2]:2025-10-29 04:27:52,449 - INFO - Avg. fwd time: 15.1332 / Avg. bwd time: 17.5927 / Avg. batch time: 351.3163 (ms) / GPU bubble ratio: 25.48%
[rank3]:2025-10-29 04:27:52,429 - INFO - Avg. fwd time: 16.8080 / Avg. bwd time: 20.6386 / Avg. batch time: 315.1450 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:27:52,474 - INFO - Avg. fwd time: 17.3287 / Avg. bwd time: 19.7746 / Avg. batch time: 397.1356 (ms) / GPU bubble ratio: 25.26%
[rank0]:2025-10-29 04:29:08,223 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,514  tflops: 490.38  mfu: 49.58%
[rank2]:2025-10-29 04:29:09,773 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,519  tflops: 490.60  mfu: 49.61%
[rank3]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss:  0.1408  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,522  tflops: 490.75  mfu: 49.62%
[rank0]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,510  tflops: 490.17  mfu: 49.56%
[rank3]:2025-10-29 04:29:10,133 - INFO - Avg. fwd time: 16.8006 / Avg. bwd time: 20.5803 / Avg. batch time: 314.6069 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 04:29:10,160 - INFO - Avg. fwd time: 15.1289 / Avg. bwd time: 17.5464 / Avg. batch time: 350.6573 (ms) / GPU bubble ratio: 25.45%
[rank0]:2025-10-29 04:29:10,200 - INFO - Avg. fwd time: 15.1880 / Avg. bwd time: 7.5660 / Avg. batch time: 427.2214 (ms) / GPU bubble ratio: 57.39%
[rank1]:2025-10-29 04:29:10,188 - INFO - Avg. fwd time: 17.3218 / Avg. bwd time: 19.7253 / Avg. batch time: 396.1805 (ms) / GPU bubble ratio: 25.19%
[rank0]:2025-10-29 04:30:26,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:30:27,576 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank3]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss:  0.1490  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,529  tflops: 491.09  mfu: 49.66%
[rank0]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank1]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank2]:2025-10-29 04:30:27,657 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0430_stage2_step1700.svg
[rank0]:2025-10-29 04:30:27,662 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0430_stage0_step1700.svg
[rank1]:2025-10-29 04:30:27,658 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0430_stage1_step1700.svg
[rank3]:2025-10-29 04:30:27,761 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0430_real_step1700_rank3.svg
[rank3]:> Batch Time: 374.22 ms, GPU Bubble Ratio: 67.22%, 23.70%, 32.93%, 23.36%
[rank3]:2025-10-29 04:30:27,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0430_stage3_step1700.svg
[rank0]:2025-10-29 04:30:27,751 - INFO - Avg. fwd time: 15.1868 / Avg. bwd time: 7.3652 / Avg. batch time: 426.0333 (ms) / GPU bubble ratio: 57.65%
[rank2]:2025-10-29 04:30:28,096 - INFO - Avg. fwd time: 15.1252 / Avg. bwd time: 17.5092 / Avg. batch time: 350.1152 (ms) / GPU bubble ratio: 25.43%
[rank3]:2025-10-29 04:30:28,076 - INFO - Avg. fwd time: 16.7946 / Avg. bwd time: 20.5340 / Avg. batch time: 314.1793 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 04:30:28,120 - INFO - Avg. fwd time: 17.3163 / Avg. bwd time: 19.6857 / Avg. batch time: 395.3977 (ms) / GPU bubble ratio: 25.13%
[rank0]:2025-10-29 04:31:43,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:31:45,489 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank3]:2025-10-29 04:31:45,488 - INFO -  step: 1750  loss:  0.1516  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,515  tflops: 490.41  mfu: 49.59%
[rank1]:2025-10-29 04:31:45,489 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank2]:2025-10-29 04:31:45,487 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank0]:2025-10-29 04:31:45,579 - INFO - Avg. fwd time: 15.1857 / Avg. bwd time: 7.1441 / Avg. batch time: 424.7485 (ms) / GPU bubble ratio: 57.94%
[rank3]:2025-10-29 04:31:45,782 - INFO - Avg. fwd time: 16.7887 / Avg. bwd time: 20.4830 / Avg. batch time: 313.7129 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 04:31:45,804 - INFO - Avg. fwd time: 15.1215 / Avg. bwd time: 17.4686 / Avg. batch time: 349.5409 (ms) / GPU bubble ratio: 25.41%
[rank1]:2025-10-29 04:31:45,829 - INFO - Avg. fwd time: 17.3104 / Avg. bwd time: 19.6421 / Avg. batch time: 394.5605 (ms) / GPU bubble ratio: 25.08%
[rank0]:2025-10-29 04:33:01,658 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:33:03,204 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank2]:2025-10-29 04:33:03,204 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank1]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss:  0.1281  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank3]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank0]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 04:33:19,786 - INFO - validate step: 1800  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,703
[rank2]:2025-10-29 04:33:19,854 - INFO - validate step: 1800  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,601
[rank1]:2025-10-29 04:33:19,823 - INFO - validate step: 1800  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,648
[rank3]:2025-10-29 04:33:19,878 - INFO - validate step: 1800  loss:  0.2360  memory: 86.11GiB(61.59%)  tps: 24,569
[rank1]:2025-10-29 04:33:19,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0433_stage1_step1800.svg
[rank0]:2025-10-29 04:33:19,964 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0433_stage0_step1800.svg
[rank2]:2025-10-29 04:33:19,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0433_stage2_step1800.svg
[rank3]:2025-10-29 04:33:20,066 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0433_real_step1800_rank3.svg
[rank3]:> Batch Time: 373.59 ms, GPU Bubble Ratio: 67.21%, 23.65%, 32.86%, 23.37%
[rank3]:2025-10-29 04:33:20,134 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0433_stage3_step1800.svg
[rank3]:2025-10-29 04:33:20,449 - INFO - Avg. fwd time: 16.7828 / Avg. bwd time: 20.4347 / Avg. batch time: 313.2685 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:33:20,475 - INFO - Avg. fwd time: 15.1176 / Avg. bwd time: 17.4300 / Avg. batch time: 348.9955 (ms) / GPU bubble ratio: 25.39%
[rank1]:2025-10-29 04:33:20,504 - INFO - Avg. fwd time: 17.3045 / Avg. bwd time: 19.6013 / Avg. batch time: 393.7669 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 04:33:20,513 - INFO - Avg. fwd time: 15.1845 / Avg. bwd time: 6.9359 / Avg. batch time: 423.5340 (ms) / GPU bubble ratio: 58.22%
[rank0]:2025-10-29 04:34:36,362 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:34:37,909 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,495  tflops: 489.50  mfu: 49.49%
[rank1]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,491  tflops: 489.30  mfu: 49.47%
[rank3]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss:  0.1133  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,498  tflops: 489.65  mfu: 49.51%
[rank0]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,486  tflops: 489.07  mfu: 49.45%
[rank0]:2025-10-29 04:34:38,000 - INFO - Avg. fwd time: 15.1841 / Avg. bwd time: 6.7668 / Avg. batch time: 422.5475 (ms) / GPU bubble ratio: 58.44%
[rank3]:2025-10-29 04:34:38,208 - INFO - Avg. fwd time: 16.7787 / Avg. bwd time: 20.3962 / Avg. batch time: 312.9200 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:34:38,227 - INFO - Avg. fwd time: 15.1149 / Avg. bwd time: 17.3988 / Avg. batch time: 348.5502 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 04:34:38,252 - INFO - Avg. fwd time: 17.3010 / Avg. bwd time: 19.5690 / Avg. batch time: 393.1222 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-10-29 04:35:54,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:35:55,679 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank1]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank0]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank3]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss:  0.1303  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,534  tflops: 491.30  mfu: 49.68%
[rank2]:2025-10-29 04:35:55,764 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0435_stage2_step1900.svg
[rank1]:2025-10-29 04:35:55,764 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0435_stage1_step1900.svg
[rank0]:2025-10-29 04:35:55,762 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0435_stage0_step1900.svg
[rank3]:2025-10-29 04:35:55,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0435_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.17 ms, GPU Bubble Ratio: 67.22%, 23.62%, 32.85%, 23.36%
[rank0]:2025-10-29 04:35:55,851 - INFO - Avg. fwd time: 15.1832 / Avg. bwd time: 6.5797 / Avg. batch time: 421.4442 (ms) / GPU bubble ratio: 58.69%
[rank3]:2025-10-29 04:35:55,937 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0435_stage3_step1900.svg
[rank3]:2025-10-29 04:35:56,190 - INFO - Avg. fwd time: 16.7736 / Avg. bwd time: 20.3530 / Avg. batch time: 312.5247 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:35:56,210 - INFO - Avg. fwd time: 15.1115 / Avg. bwd time: 17.3643 / Avg. batch time: 348.0478 (ms) / GPU bubble ratio: 25.35%
[rank1]:2025-10-29 04:35:56,235 - INFO - Avg. fwd time: 17.2962 / Avg. bwd time: 19.5328 / Avg. batch time: 392.3976 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-10-29 04:37:11,955 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:37:13,521 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank1]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank3]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss:  0.1576  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank2]:2025-10-29 04:37:13,920 - INFO - Avg. fwd time: 15.1084 / Avg. bwd time: 17.3313 / Avg. batch time: 347.5836 (ms) / GPU bubble ratio: 25.34%
[rank1]:2025-10-29 04:37:13,949 - INFO - Avg. fwd time: 17.2914 / Avg. bwd time: 19.4975 / Avg. batch time: 391.7219 (ms) / GPU bubble ratio: 24.87%
[rank3]:2025-10-29 04:37:13,893 - INFO - Avg. fwd time: 16.7685 / Avg. bwd time: 20.3118 / Avg. batch time: 312.1448 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:37:13,961 - INFO - Avg. fwd time: 15.1825 / Avg. bwd time: 6.4027 / Avg. batch time: 420.4114 (ms) / GPU bubble ratio: 58.93%
[rank0]:2025-10-29 04:38:29,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:38:31,280 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank2]:2025-10-29 04:38:31,281 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 04:38:31,282 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank1]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 04:38:31,281 - INFO -  step: 2000  loss:  0.1418  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.37  mfu: 49.68%
[rank0]:2025-10-29 04:38:31,282 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank3]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 04:38:47,843 - INFO - validate step: 2000  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,733
[rank0]:2025-10-29 04:38:47,806 - INFO - validate step: 2000  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,788
[rank2]:2025-10-29 04:38:47,874 - INFO - validate step: 2000  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,684
[rank3]:2025-10-29 04:38:47,898 - INFO - validate step: 2000  loss:  0.2368  memory: 86.11GiB(61.59%)  tps: 24,652
[rank2]:2025-10-29 04:38:47,988 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0438_stage2_step2000.svg
[rank1]:2025-10-29 04:38:47,987 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0438_stage1_step2000.svg
[rank0]:2025-10-29 04:38:47,986 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0438_stage0_step2000.svg
[rank0]:2025-10-29 04:38:48,075 - INFO - Avg. fwd time: 15.1813 / Avg. bwd time: 6.2583 / Avg. batch time: 419.5502 (ms) / GPU bubble ratio: 59.12%
[rank3]:2025-10-29 04:38:48,099 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0438_real_step2000_rank3.svg
[rank3]:> Batch Time: 372.85 ms, GPU Bubble Ratio: 67.22%, 23.59%, 32.82%, 23.36%
[rank3]:2025-10-29 04:38:48,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0438_stage3_step2000.svg
[rank3]:2025-10-29 04:38:48,430 - INFO - Avg. fwd time: 16.7640 / Avg. bwd time: 20.2778 / Avg. batch time: 311.8303 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 04:38:48,452 - INFO - Avg. fwd time: 15.1055 / Avg. bwd time: 17.3045 / Avg. batch time: 347.1852 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-10-29 04:38:48,476 - INFO - Avg. fwd time: 17.2873 / Avg. bwd time: 19.4695 / Avg. batch time: 391.1531 (ms) / GPU bubble ratio: 24.82%
[rank0]:2025-10-29 04:40:04,409 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:40:05,966 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,490  tflops: 489.27  mfu: 49.47%
[rank1]:2025-10-29 04:40:05,968 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,486  tflops: 489.06  mfu: 49.45%
[rank0]:2025-10-29 04:40:05,967 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,481  tflops: 488.83  mfu: 49.43%
[rank3]:2025-10-29 04:40:05,967 - INFO -  step: 2050  loss:  0.1833  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,493  tflops: 489.42  mfu: 49.49%
[rank0]:2025-10-29 04:40:06,059 - INFO - Avg. fwd time: 15.1813 / Avg. bwd time: 6.0980 / Avg. batch time: 418.6307 (ms) / GPU bubble ratio: 59.34%
[rank2]:2025-10-29 04:40:06,283 - INFO - Avg. fwd time: 15.1030 / Avg. bwd time: 17.2750 / Avg. batch time: 346.7790 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 04:40:06,307 - INFO - Avg. fwd time: 17.2841 / Avg. bwd time: 19.4389 / Avg. batch time: 390.5572 (ms) / GPU bubble ratio: 24.78%
[rank3]:2025-10-29 04:40:06,262 - INFO - Avg. fwd time: 16.7602 / Avg. bwd time: 20.2411 / Avg. batch time: 311.4984 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:41:22,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank2]:2025-10-29 04:41:23,729 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank0]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank3]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss:  0.1654  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank1]:2025-10-29 04:41:23,807 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0441_stage1_step2100.svg
[rank2]:2025-10-29 04:41:23,809 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0441_stage2_step2100.svg
[rank0]:2025-10-29 04:41:23,810 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0441_stage0_step2100.svg
[rank3]:2025-10-29 04:41:23,917 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0441_real_step2100_rank3.svg
[rank3]:> Batch Time: 372.55 ms, GPU Bubble Ratio: 67.22%, 23.57%, 32.80%, 23.36%
[rank3]:2025-10-29 04:41:23,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0441_stage3_step2100.svg
[rank1]:2025-10-29 04:41:24,349 - INFO - Avg. fwd time: 17.2805 / Avg. bwd time: 19.4095 / Avg. batch time: 389.9854 (ms) / GPU bubble ratio: 24.74%
[rank2]:2025-10-29 04:41:24,320 - INFO - Avg. fwd time: 15.1004 / Avg. bwd time: 17.2470 / Avg. batch time: 346.3878 (ms) / GPU bubble ratio: 25.29%
[rank0]:2025-10-29 04:41:24,360 - INFO - Avg. fwd time: 15.1808 / Avg. bwd time: 5.9456 / Avg. batch time: 417.7522 (ms) / GPU bubble ratio: 59.54%
[rank3]:2025-10-29 04:41:24,293 - INFO - Avg. fwd time: 16.7561 / Avg. bwd time: 20.2063 / Avg. batch time: 311.1798 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:42:40,183 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:42:41,731 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank0]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank3]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss:  0.2036  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank1]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank0]:2025-10-29 04:42:41,824 - INFO - Avg. fwd time: 15.1805 / Avg. bwd time: 5.8210 / Avg. batch time: 417.0190 (ms) / GPU bubble ratio: 59.71%
[rank3]:2025-10-29 04:42:42,031 - INFO - Avg. fwd time: 16.7529 / Avg. bwd time: 20.1778 / Avg. batch time: 310.9194 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:42:42,076 - INFO - Avg. fwd time: 17.2773 / Avg. bwd time: 19.3851 / Avg. batch time: 389.5036 (ms) / GPU bubble ratio: 24.70%
[rank2]:2025-10-29 04:42:42,051 - INFO - Avg. fwd time: 15.0983 / Avg. bwd time: 17.2239 / Avg. batch time: 346.0548 (ms) / GPU bubble ratio: 25.28%
[rank0]:2025-10-29 04:43:57,935 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:43:59,483 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank1]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 04:43:59,481 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank2]:2025-10-29 04:43:59,481 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 04:43:59,482 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank0]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 04:43:59,482 - INFO -  step: 2200  loss:  0.1441  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,537  tflops: 491.43  mfu: 49.69%
[rank3]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 04:44:16,094 - INFO - validate step: 2200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,659
[rank2]:2025-10-29 04:44:16,120 - INFO - validate step: 2200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,618
[rank0]:2025-10-29 04:44:16,054 - INFO - validate step: 2200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,717
[rank3]:2025-10-29 04:44:16,142 - INFO - validate step: 2200  loss:  0.2368  memory: 86.11GiB(61.59%)  tps: 24,589
[rank0]:2025-10-29 04:44:16,223 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0444_stage0_step2200.svg
[rank1]:2025-10-29 04:44:16,223 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0444_stage1_step2200.svg
[rank2]:2025-10-29 04:44:16,226 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0444_stage2_step2200.svg
[rank3]:2025-10-29 04:44:16,331 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0444_real_step2200_rank3.svg
[rank3]:> Batch Time: 372.26 ms, GPU Bubble Ratio: 67.21%, 23.56%, 32.77%, 23.34%
[rank0]:2025-10-29 04:44:16,314 - INFO - Avg. fwd time: 15.1793 / Avg. bwd time: 5.6820 / Avg. batch time: 416.1913 (ms) / GPU bubble ratio: 59.90%
[rank3]:2025-10-29 04:44:16,394 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0444_stage3_step2200.svg
[rank1]:2025-10-29 04:44:16,693 - INFO - Avg. fwd time: 17.2734 / Avg. bwd time: 19.3576 / Avg. batch time: 388.9565 (ms) / GPU bubble ratio: 24.66%
[rank2]:2025-10-29 04:44:16,667 - INFO - Avg. fwd time: 15.0955 / Avg. bwd time: 17.1981 / Avg. batch time: 345.6743 (ms) / GPU bubble ratio: 25.26%
[rank3]:2025-10-29 04:44:16,647 - INFO - Avg. fwd time: 16.7485 / Avg. bwd time: 20.1456 / Avg. batch time: 310.6203 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 04:45:32,463 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:45:34,021 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,512  tflops: 490.30  mfu: 49.58%
[rank2]:2025-10-29 04:45:34,019 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank3]:2025-10-29 04:45:34,021 - INFO -  step: 2250  loss:  0.1680  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank0]:2025-10-29 04:45:34,020 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,507  tflops: 490.06  mfu: 49.55%
[rank3]:2025-10-29 04:45:34,387 - INFO - Avg. fwd time: 16.7444 / Avg. bwd time: 20.1143 / Avg. batch time: 310.3302 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:45:34,447 - INFO - Avg. fwd time: 17.2697 / Avg. bwd time: 19.3316 / Avg. batch time: 388.4491 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-10-29 04:45:34,416 - INFO - Avg. fwd time: 15.0931 / Avg. bwd time: 17.1737 / Avg. batch time: 345.3224 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 04:45:34,462 - INFO - Avg. fwd time: 15.1788 / Avg. bwd time: 5.5495 / Avg. batch time: 415.4170 (ms) / GPU bubble ratio: 60.08%
[rank0]:2025-10-29 04:46:50,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank2]:2025-10-29 04:46:51,784 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank3]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss:  0.1342  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank0]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank1]:2025-10-29 04:46:51,865 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0446_stage1_step2300.svg
[rank2]:2025-10-29 04:46:51,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0446_stage2_step2300.svg
[rank0]:2025-10-29 04:46:51,866 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0446_stage0_step2300.svg
[rank0]:2025-10-29 04:46:51,956 - INFO - Avg. fwd time: 15.1783 / Avg. bwd time: 5.4408 / Avg. batch time: 414.7748 (ms) / GPU bubble ratio: 60.23%
[rank3]:2025-10-29 04:46:51,975 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0446_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.11 ms, GPU Bubble Ratio: 67.22%, 23.55%, 32.77%, 23.35%
[rank3]:2025-10-29 04:46:52,038 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0446_stage3_step2300.svg
[rank2]:2025-10-29 04:46:52,311 - INFO - Avg. fwd time: 15.0912 / Avg. bwd time: 17.1537 / Avg. batch time: 345.0281 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 04:46:52,290 - INFO - Avg. fwd time: 16.7414 / Avg. bwd time: 20.0889 / Avg. batch time: 310.0988 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:46:52,335 - INFO - Avg. fwd time: 17.2674 / Avg. bwd time: 19.3107 / Avg. batch time: 388.0271 (ms) / GPU bubble ratio: 24.59%
[rank0]:2025-10-29 04:48:08,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:48:09,737 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank3]:2025-10-29 04:48:09,741 - INFO -  step: 2350  loss:  0.1571  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,509  tflops: 490.15  mfu: 49.56%
[rank0]:2025-10-29 04:48:09,737 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank2]:2025-10-29 04:48:09,736 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank0]:2025-10-29 04:48:09,830 - INFO - Avg. fwd time: 15.1778 / Avg. bwd time: 5.3192 / Avg. batch time: 414.0686 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-10-29 04:48:10,086 - INFO - Avg. fwd time: 17.2644 / Avg. bwd time: 19.2871 / Avg. batch time: 387.5672 (ms) / GPU bubble ratio: 24.55%
[rank3]:2025-10-29 04:48:10,040 - INFO - Avg. fwd time: 16.7381 / Avg. bwd time: 20.0609 / Avg. batch time: 309.8420 (ms) / GPU bubble ratio: 4.99%
[rank2]:2025-10-29 04:48:10,060 - INFO - Avg. fwd time: 15.0890 / Avg. bwd time: 17.1313 / Avg. batch time: 344.7133 (ms) / GPU bubble ratio: 25.22%
[rank0]:2025-10-29 04:49:25,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:49:27,498 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank2]:2025-10-29 04:49:27,498 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,750  tflops: 454.75  mfu: 45.28%
[rank2]:2025-10-29 04:49:27,498 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank1]:2025-10-29 04:49:27,499 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,750  tflops: 454.73  mfu: 45.28%
[rank1]:2025-10-29 04:49:27,499 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss:  0.1417  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.37  mfu: 49.68%
[rank3]:2025-10-29 04:49:27,500 - INFO -  final step: 2400  loss:  0.1417  grad_norm:  0.0000  tps: 9,754  tflops: 454.92  mfu: 45.29%
[rank0]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank3]:2025-10-29 04:49:27,500 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 04:49:27,499 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,749  tflops: 454.68  mfu: 45.27%
[rank0]:2025-10-29 04:49:27,499 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 04:49:44,060 - INFO - validate step: 2400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,734
[rank1]:2025-10-29 04:49:44,061 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:49:44,064 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 04:49:44,024 - INFO - validate step: 2400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,787
[rank0]:2025-10-29 04:49:44,025 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:49:44,030 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 04:49:44,090 - INFO - validate step: 2400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,687
[rank2]:2025-10-29 04:49:44,091 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:49:44,094 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 04:49:44,115 - INFO - validate step: 2400  loss:  0.2356  memory: 86.11GiB(61.59%)  tps: 24,655
[rank3]:2025-10-29 04:49:44,116 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:49:44,118 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 04:49:54,068 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 04:49:54,165 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0449_stage1_final2400.svg
[rank0]:2025-10-29 04:49:54,165 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0449_stage0_final2400.svg
[rank2]:2025-10-29 04:49:54,193 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0449_stage2_final2400.svg
[rank3]:2025-10-29 04:49:54,315 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0449_real_final2400_rank3.svg
[rank3]:> Batch Time: 371.93 ms, GPU Bubble Ratio: 67.22%, 23.53%, 32.76%, 23.36%
[rank0]:2025-10-29 04:49:54,406 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank0_stage0.svg
[rank0]:	> Counts Sum: 4610600, Total Sum: 5442880 (84.71%), Ratio(%) per element: [84.33, 84.01, 83.79, 84.33, 83.9, 83.79, 84.17, 84.22, 84.01, 84.28, 84.01, 84.17, 84.01, 84.12, 84.33, 84.17, 84.22, 84.33, 84.22, 84.28, 83.95, 84.54, 84.38, 84.22, 84.44, 84.6, 84.33, 84.49, 84.6, 84.38, 84.17, 84.44, 84.54, 84.49, 84.71, 84.44, 84.38, 84.71, 84.38, 84.71, 84.49, 84.76, 84.49, 84.6, 84.97, 84.81, 84.97, 85.08, 85.13, 84.76, 85.08, 84.71, 84.87, 84.71, 85.3, 85.13, 85.67, 85.4, 85.08, 84.97, 85.51, 85.51, 85.4, 85.35, 85.46, 85.56, 85.56, 85.56, 85.24, 85.89, 85.89, 86.05, 85.83]
[rank0]:2025-10-29 04:49:54,406 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 04:49:54,419 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank1_stage1.svg
[rank1]:	> Counts Sum: 569000, Total Sum: 6039360 (9.42%), Ratio(%) per element: [9.97, 9.12, 9.28, 9.81, 9.06, 9.28, 9.17, 9.33, 9.6, 8.42, 9.33, 9.06, 8.79, 9.49, 8.95, 8.31, 9.01, 8.95, 9.54, 9.81, 8.69, 9.97, 10.67, 9.38, 9.49, 9.76, 8.95, 8.63, 10.51, 9.92, 9.33, 9.97, 9.76, 9.65, 8.9, 9.71, 9.12, 9.76, 9.33, 9.28, 9.28, 9.22, 9.17, 8.95, 10.51, 9.92, 9.54, 10.35, 9.6, 8.74, 10.72, 9.71, 8.85, 9.76, 9.92, 8.42, 9.33, 8.53, 9.54, 9.44, 10.62, 8.42, 8.42, 10.4, 8.31, 9.87, 8.9, 9.06, 9.33, 10.46, 10.08, 10.03, 10.08, 9.54, 9.65, 9.17, 9.71, 8.47, 9.06, 8.63, 9.97]
[rank1]:2025-10-29 04:49:54,419 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 04:49:54,513 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank2_stage2.svg
[rank2]:	> Counts Sum: 1103400, Total Sum: 5368320 (20.55%), Ratio(%) per element: [21.4, 21.29, 21.56, 21.08, 19.63, 20.65, 20.49, 19.68, 21.99, 20.43, 21.29, 21.29, 20.38, 21.72, 21.19, 21.35, 20.33, 19.79, 19.58, 20.65, 20.7, 19.84, 20.49, 21.35, 21.03, 20.38, 20.27, 20.81, 20.54, 19.52, 19.58, 19.36, 20.11, 20.54, 21.51, 21.35, 20.43, 21.4, 20.97, 20.22, 21.67, 21.03, 21.35, 19.25, 21.94, 20.27, 18.77, 20.06, 19.95, 20.01, 19.74, 19.74, 21.29, 22.58, 19.15, 21.72, 19.58, 21.72, 19.09, 20.81, 20.92, 21.62, 19.58, 20.65, 20.17, 20.06, 20.7, 19.79, 19.47, 20.17, 21.13, 19.36]
[rank2]:2025-10-29 04:49:54,514 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 04:49:54,536 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0449_thry_final2400_rank3.svg
[rank3]:> Batch Time: 529.68 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 04:49:54,631 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0449_stage3_final2400.svg
[rank3]:2025-10-29 04:49:54,949 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.39, 1.28, 1.66, 1.77, 1.82, 2.03, 1.5, 1.82, 1.12, 1.6, 1.66, 1.44, 1.23, 1.71, 1.6, 1.18, 1.77, 1.55, 1.6, 1.28, 1.6, 1.82, 1.66, 1.71, 1.07, 1.82, 1.44, 1.23, 1.77, 1.66, 1.71, 1.23, 1.5, 1.5, 1.5, 1.98, 1.66, 1.87, 1.5, 1.39, 1.28, 1.39, 1.44, 1.6, 1.87, 2.09, 1.77, 1.93, 1.71, 1.07, 1.44, 1.71, 1.77, 1.66, 1.82, 1.44, 1.18, 1.55, 1.6, 1.87, 1.5, 1.6, 1.77, 1.23, 1.77]
[rank3]:2025-10-29 04:49:54,950 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank0]:2025-10-29 04:49:56,406 - INFO - Training completed
[rank0]:2025-10-29 04:49:56,407 - INFO - Destroying the purge thread.
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.67974
[rank3]:wandb:               final/avg_loss 0.14175
[rank3]:wandb:             final/avg_mfu(%) 45.28634
[rank3]:wandb:             final/avg_tflops 454.92326
[rank3]:wandb:    final/avg_throughput(tps) 9753.89558
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.14175
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.14175
[rank3]:wandb: loss_metrics/global_max_loss 0.14175
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/i08zgsmr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_fullrand7_dm1/20251029-0337/wandb/run-20251029_033746-i08zgsmr/logs
[rank1]:2025-10-29 04:49:56,658 - INFO - Process group destroyed
[rank3]:2025-10-29 04:49:56,661 - INFO - Process group destroyed
[rank2]:2025-10-29 04:49:56,726 - INFO - Process group destroyed
[rank0]:2025-10-29 04:49:56,722 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.18', 'layers.21', 'layers.23', 'layers.22', 'layers.20', 'layers.24', 'layers.17'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'tok_embeddings', 'layers.6', 'layers.3', 'layers.5', 'layers.2', 'layers.0', 'layers.7', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.14', 'layers.16', 'layers.13', 'layers.12', 'layers.9', 'layers.11', 'layers.15', 'layers.10', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'norm', 'layers.26', 'output', 'layers.30', 'layers.31', 'layers.25', 'layers.29', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 05:32:53 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] 
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] *****************************************
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 05:33:00,286 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 05:33:00,250 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 05:33:00,321 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 05:33:00,310 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 05:33:01,487 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 05:33:01,489 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 05:33:01,458 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 05:33:01,461 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 05:33:01,518 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 05:33:01,520 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:33:01,512 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 05:33:01,515 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:33:01,520 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 05:33:03,481 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 05:33:03,790 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 05:33:05,294 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 05:33:06,615 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 05:33:06,870 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 05:33:06,951 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 05:33:06,917 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 05:33:06,941 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 05:33:06,941 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 05:33:07,024 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 05:33:07,024 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 05:33:07,152 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 05:33:07,153 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 05:33:07,459 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 05:33:07,459 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-29 05:33:08,080 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 05:33:08,155 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 05:33:08,156 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 05:33:08,363 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 05:33:08,364 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: setting up run 2224xvmg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1/20251029-0533/wandb/run-20251029_053307-2224xvmg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2224xvmg
[rank3]:2025-10-29 05:33:08,711 - INFO - WandB logging enabled
[rank3]:2025-10-29 05:33:08,713 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 05:33:08,786 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 05:33:08,786 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 05:33:09,000 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 05:33:09,001 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank2]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 05:33:09,013 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank0]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 05:33:09,013 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 05:33:09,017 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 05:33:12,308 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank2]:2025-10-29 05:33:12,481 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:12,759 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 05:33:12,759 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:12,759 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400.
[rank1]:2025-10-29 05:33:12,905 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:21,705 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 05:33:21,705 - INFO - Finished loading the checkpoint in 8.95 seconds.
[rank0]:2025-10-29 05:33:21,705 - INFO - Training starts at step 1
[rank2]:2025-10-29 05:33:26,388 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 44.28GiB(31.67%)  tps: 845  tflops: 39.41  mfu: 3.99%
[rank2]:2025-10-29 05:33:26,388 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 05:33:26,392 - INFO -  step:  1  loss:  0.9414  grad_norm:  1.0722  memory: 58.03GiB(41.50%)  tps: 929  tflops: 43.34  mfu: 4.38%
[rank3]:2025-10-29 05:33:26,392 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 05:33:26,390 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 49.69GiB(35.54%)  tps: 897  tflops: 41.85  mfu: 4.23%
[rank1]:2025-10-29 05:33:26,390 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 05:33:26,409 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 49.75GiB(35.58%)  tps: 841  tflops: 39.20  mfu: 3.96%
[rank0]:2025-10-29 05:33:26,409 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 05:33:44,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:35:35,795 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:35:38,518 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 57.29GiB(40.97%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank1]:2025-10-29 05:35:38,521 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 64.32GiB(46.00%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank0]:2025-10-29 05:35:38,526 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 66.72GiB(47.72%)  tps: 6,077  tflops: 283.41  mfu: 28.66%
[rank3]:2025-10-29 05:35:38,523 - INFO -  step: 50  loss:  0.8893  grad_norm:  0.5068  memory: 73.38GiB(52.48%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank3]:2025-10-29 05:35:38,985 - INFO - Avg. fwd time: 14.6866 / Avg. bwd time: 42.8933 / Avg. batch time: 481.3084 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-10-29 05:35:39,035 - INFO - Avg. fwd time: 13.2387 / Avg. bwd time: 36.4394 / Avg. batch time: 534.1678 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 05:35:39,082 - INFO - Avg. fwd time: 15.3921 / Avg. bwd time: 41.6531 / Avg. batch time: 594.9250 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 05:35:39,115 - INFO - Avg. fwd time: 14.2845 / Avg. bwd time: 38.4378 / Avg. batch time: 650.6706 (ms) / GPU bubble ratio: 35.18%
[rank3]:2025-10-29 05:36:05,330 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 05:36:32,361 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 05:36:32,578 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 05:36:32,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,693 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,686 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,719 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,752 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,702 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,737 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,687 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,709 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,853 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,771 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,849 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,861 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,889 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,927 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,965 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,926 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,899 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,937 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,975 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,921 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,958 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,997 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:33,003 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:33,014 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:33,052 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:33,036 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:33,073 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:37:07,194 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 05:37:07,510 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_max_batch_time.svg
[rank3]:> Batch Time: 634.38 ms, GPU Bubble Ratio: 33.22%, 26.98%, 36.74%, 26.69%
[rank3]:2025-10-29 05:37:07,699 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_min_batch_time.svg
[rank3]:> Batch Time: 394.26 ms, GPU Bubble Ratio: 71.44%, 30.80%, 40.05%, 21.69%
[rank3]:2025-10-29 05:37:07,906 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 394.26 ms, GPU Bubble Ratio: 32.34%, 23.16%, 27.03%, 21.69%
[rank3]:2025-10-29 05:37:07,906 - INFO - 	> Batch Time: 394.26 ms (Average Freeze Ratio: 0.76, Time Reduction Rate: 0.38)
[rank0]:2025-10-29 05:37:22,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:37:24,451 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.63, [MB1] 0.21/0.63, [MB2] 0.00/0.00, [MB3] 0.20/0.59, [MB4] 0.32/0.97, [MB5] 0.33/1.00, [MB6] 0.23/0.69, [MB7] 0.33/1.00
[rank2]:2025-10-29 05:37:24,470 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,732  tflops: 360.61  mfu: 36.46%
[rank3]:2025-10-29 05:37:24,437 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 05:37:24,471 - INFO -  step: 100  loss:  0.8663  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,732  tflops: 360.63  mfu: 36.46%
[rank1]:2025-10-29 05:37:24,472 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.26/0.77, [MB1] 0.04/0.13, [MB2] 0.27/0.80, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 05:37:24,472 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,732  tflops: 360.62  mfu: 36.46%
[rank0]:2025-10-29 05:37:24,471 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.01/0.02, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 05:37:24,472 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,732  tflops: 360.63  mfu: 36.46%
[rank2]:2025-10-29 05:37:24,548 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0537_stage2_step100.svg
[rank1]:2025-10-29 05:37:24,549 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0537_stage1_step100.svg
[rank0]:2025-10-29 05:37:24,547 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0537_stage0_step100.svg
[rank0]:2025-10-29 05:37:24,646 - INFO - Avg. fwd time: 14.7164 / Avg. bwd time: 27.6796 / Avg. batch time: 583.1536 (ms) / GPU bubble ratio: 41.84%
[rank3]:2025-10-29 05:37:24,649 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_real_step100_rank3.svg
[rank3]:> Batch Time: 631.94 ms, GPU Bubble Ratio: 33.11%, 27.09%, 36.66%, 26.64%
[rank3]:2025-10-29 05:37:24,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0537_stage3_step100.svg
[rank2]:2025-10-29 05:37:24,993 - INFO - Avg. fwd time: 13.9197 / Avg. bwd time: 30.7924 / Avg. batch time: 484.2851 (ms) / GPU bubble ratio: 26.14%
[rank3]:2025-10-29 05:37:24,971 - INFO - Avg. fwd time: 15.4029 / Avg. bwd time: 36.8401 / Avg. batch time: 435.8669 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 05:37:25,019 - INFO - Avg. fwd time: 16.2548 / Avg. bwd time: 35.2998 / Avg. batch time: 538.5016 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-10-29 05:39:15,156 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:39:17,088 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 05:39:17,178 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.42/0.63, [MB1] 0.42/0.63, [MB2] 0.00/0.00, [MB3] 0.39/0.59, [MB4] 0.64/0.97, [MB5] 0.67/1.00, [MB6] 0.46/0.69, [MB7] 0.67/1.00
[rank2]:2025-10-29 05:39:17,265 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 64.67GiB(46.25%)  tps: 7,263  tflops: 338.74  mfu: 34.25%
[rank3]:2025-10-29 05:39:17,264 - INFO -  step: 150  loss:  0.8765  grad_norm:  0.1878  memory: 84.29GiB(60.29%)  tps: 7,263  tflops: 338.75  mfu: 34.25%
[rank1]:2025-10-29 05:39:17,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.51/0.77, [MB1] 0.09/0.13, [MB2] 0.54/0.80, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 05:39:17,267 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 72.68GiB(51.98%)  tps: 7,263  tflops: 338.74  mfu: 34.25%
[rank0]:2025-10-29 05:39:17,257 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.01/0.02, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 05:39:17,271 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 72.70GiB(52.00%)  tps: 7,262  tflops: 338.72  mfu: 34.25%
[rank3]:2025-10-29 05:39:17,692 - INFO - Avg. fwd time: 15.5767 / Avg. bwd time: 34.9522 / Avg. batch time: 421.2274 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-29 05:39:17,720 - INFO - Avg. fwd time: 14.0930 / Avg. bwd time: 29.1136 / Avg. batch time: 467.8554 (ms) / GPU bubble ratio: 26.12%
[rank1]:2025-10-29 05:39:17,766 - INFO - Avg. fwd time: 16.4333 / Avg. bwd time: 33.5825 / Avg. batch time: 521.9209 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-29 05:39:17,794 - INFO - Avg. fwd time: 14.8408 / Avg. bwd time: 27.2951 / Avg. batch time: 566.3430 (ms) / GPU bubble ratio: 40.48%
[rank0]:2025-10-29 05:40:50,473 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:40:52,175 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.63, [MB1] 0.63/0.63, [MB2] 0.00/0.00, [MB3] 0.59/0.59, [MB4] 0.97/0.97, [MB5] 1.00/1.00, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:40:52,095 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:40:52,212 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.02/0.02, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 72.70GiB(52.00%)  tps: 8,628  tflops: 402.43  mfu: 40.69%
[rank0]:2025-10-29 05:40:52,213 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 05:40:52,212 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 65.57GiB(46.90%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank2]:2025-10-29 05:40:52,212 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss:  0.9093  grad_norm:  0.0614  memory: 84.29GiB(60.29%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank3]:2025-10-29 05:40:52,213 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 05:40:52,207 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.77/0.77, [MB1] 0.13/0.13, [MB2] 0.80/0.80, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 73.44GiB(52.53%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank1]:2025-10-29 05:40:52,214 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 05:41:09,987 - INFO - validate step: 200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 23,045
[rank2]:2025-10-29 05:41:10,039 - INFO - validate step: 200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 22,977
[rank3]:2025-10-29 05:41:10,055 - INFO - validate step: 200  loss:  0.2354  memory: 84.29GiB(60.29%)  tps: 22,958
[rank1]:2025-10-29 05:41:10,024 - INFO - validate step: 200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 22,998
[rank0]:2025-10-29 05:41:10,129 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0541_stage0_step200.svg
[rank2]:2025-10-29 05:41:10,128 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0541_stage2_step200.svg
[rank1]:2025-10-29 05:41:10,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0541_stage1_step200.svg
[rank3]:2025-10-29 05:41:10,239 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0541_real_step200_rank3.svg
[rank3]:> Batch Time: 526.34 ms, GPU Bubble Ratio: 34.81%, 28.38%, 38.11%, 26.84%
[rank3]:2025-10-29 05:41:10,305 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0541_stage3_step200.svg
[rank0]:2025-10-29 05:41:10,254 - INFO - Avg. fwd time: 15.0188 / Avg. bwd time: 24.6771 / Avg. batch time: 541.4354 (ms) / GPU bubble ratio: 41.35%
[rank2]:2025-10-29 05:41:10,598 - INFO - Avg. fwd time: 14.3098 / Avg. bwd time: 27.1018 / Avg. batch time: 448.1811 (ms) / GPU bubble ratio: 26.08%
[rank3]:2025-10-29 05:41:10,575 - INFO - Avg. fwd time: 15.8186 / Avg. bwd time: 32.5804 / Avg. batch time: 403.7805 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 05:41:10,628 - INFO - Avg. fwd time: 16.7008 / Avg. bwd time: 31.1700 / Avg. batch time: 499.7156 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-29 05:42:31,395 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:42:33,027 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.63, [MB1] 0.63/0.63, [MB2] 0.00/0.00, [MB3] 0.59/0.59, [MB4] 0.97/0.97, [MB5] 1.00/1.00, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:42:33,047 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,869  tflops: 460.29  mfu: 46.54%
[rank3]:2025-10-29 05:42:33,012 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:42:33,048 - INFO -  step: 250  loss:  0.9115  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank1]:2025-10-29 05:42:33,048 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.77/0.77, [MB1] 0.13/0.13, [MB2] 0.80/0.80, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:42:33,048 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,867  tflops: 460.20  mfu: 46.53%
[rank0]:2025-10-29 05:42:33,048 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.02/0.02, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:42:33,049 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,863  tflops: 459.99  mfu: 46.51%
[rank0]:2025-10-29 05:42:33,145 - INFO - Avg. fwd time: 15.2099 / Avg. bwd time: 19.5513 / Avg. batch time: 511.0191 (ms) / GPU bubble ratio: 45.58%
[rank3]:2025-10-29 05:42:33,361 - INFO - Avg. fwd time: 16.1406 / Avg. bwd time: 29.7769 / Avg. batch time: 383.6417 (ms) / GPU bubble ratio: 4.25%
[rank2]:2025-10-29 05:42:33,382 - INFO - Avg. fwd time: 14.5655 / Avg. bwd time: 24.8428 / Avg. batch time: 425.6678 (ms) / GPU bubble ratio: 25.94%
[rank1]:2025-10-29 05:42:33,408 - INFO - Avg. fwd time: 17.0103 / Avg. bwd time: 28.6064 / Avg. batch time: 474.5775 (ms) / GPU bubble ratio: 23.10%
[rank0]:2025-10-29 05:43:54,195 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:43:55,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank2_trend_line.svg
[rank2]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.92/0.92, [MB2] 0.83/0.83, [MB3] 0.75/0.75, [MB4] 0.66/0.66, [MB5] 0.64/0.64, [MB6] 0.50/0.50, [MB7] 0.56/0.56
[rank3]:2025-10-29 05:43:55,983 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank3_trend_line.svg
[rank2]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.92/0.92, [MB2] 0.83/0.83, [MB3] 0.75/0.75, [MB4] 0.66/0.66, [MB5] 0.64/0.64, [MB6] 0.50/0.50, [MB7] 0.56/0.56
[rank2]:2025-10-29 05:43:56,039 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank1]:2025-10-29 05:43:56,032 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank1_trend_line.svg
[rank1]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:43:56,040 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank0]:2025-10-29 05:43:56,017 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank0_trend_line.svg
[rank0]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:43:56,039 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank3]:2025-10-29 05:43:56,228 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0543_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 369.78 ms, GPU Bubble Ratio: 42.28%, 23.35%, 30.85%, 26.14%
[rank3]:2025-10-29 05:43:56,229 - INFO - 	> Batch Time: 369.78 ms (Average Freeze Ratio: 0.71)
[rank3]:2025-10-29 05:43:56,229 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.96/0.96
[rank3]:2025-10-29 05:43:56,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.96/0.96
[rank3]:2025-10-29 05:43:56,233 - INFO -  step: 300  loss:  0.8355  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,848  tflops: 459.32  mfu: 46.44%
[rank2]:2025-10-29 05:43:56,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0543_stage2_step300.svg
[rank1]:2025-10-29 05:43:56,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0543_stage1_step300.svg
[rank0]:2025-10-29 05:43:56,299 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0543_stage0_step300.svg
[rank3]:2025-10-29 05:43:56,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0543_real_step300_rank3.svg
[rank3]:> Batch Time: 444.33 ms, GPU Bubble Ratio: 40.71%, 26.96%, 36.26%, 26.50%
[rank3]:2025-10-29 05:43:56,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0543_stage3_step300.svg
[rank2]:2025-10-29 05:43:56,823 - INFO - Avg. fwd time: 14.7328 / Avg. bwd time: 23.3579 / Avg. batch time: 410.9017 (ms) / GPU bubble ratio: 25.84%
[rank3]:2025-10-29 05:43:56,801 - INFO - Avg. fwd time: 16.3475 / Avg. bwd time: 27.9426 / Avg. batch time: 370.4422 (ms) / GPU bubble ratio: 4.35%
[rank1]:2025-10-29 05:43:56,847 - INFO - Avg. fwd time: 17.2133 / Avg. bwd time: 26.9127 / Avg. batch time: 457.9767 (ms) / GPU bubble ratio: 22.92%
[rank0]:2025-10-29 05:43:56,852 - INFO - Avg. fwd time: 15.3335 / Avg. bwd time: 16.1333 / Avg. batch time: 490.9000 (ms) / GPU bubble ratio: 48.72%
[rank0]:2025-10-29 05:45:27,186 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:45:29,015 - INFO -  step: 350  loss:  0.8641  grad_norm:  0.0596  memory: 84.29GiB(60.29%)  tps: 8,829  tflops: 411.81  mfu: 41.64%
[rank1]:2025-10-29 05:45:29,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 8,811  tflops: 410.95  mfu: 41.55%
[rank0]:2025-10-29 05:45:29,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 8,811  tflops: 410.95  mfu: 41.55%
[rank2]:2025-10-29 05:45:29,022 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0596  memory: 65.57GiB(46.90%)  tps: 8,810  tflops: 410.91  mfu: 41.55%
[rank0]:2025-10-29 05:45:29,114 - INFO - Avg. fwd time: 15.4138 / Avg. bwd time: 14.0309 / Avg. batch time: 484.9678 (ms) / GPU bubble ratio: 51.43%
[rank2]:2025-10-29 05:45:29,392 - INFO - Avg. fwd time: 14.6879 / Avg. bwd time: 23.5923 / Avg. batch time: 408.5100 (ms) / GPU bubble ratio: 25.03%
[rank3]:2025-10-29 05:45:29,333 - INFO - Avg. fwd time: 16.4618 / Avg. bwd time: 26.9551 / Avg. batch time: 363.3476 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-10-29 05:45:29,408 - INFO - Avg. fwd time: 17.3321 / Avg. bwd time: 25.8054 / Avg. batch time: 454.2051 (ms) / GPU bubble ratio: 24.02%
[rank0]:2025-10-29 05:46:57,147 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:46:59,062 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank2_trend_line.svg
[rank1]:2025-10-29 05:46:59,084 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank1_trend_line.svg
[rank1]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 0.95/0.95, [MB4] 0.95/0.95, [MB5] 0.95/0.95, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:46:59,091 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,095  tflops: 424.17  mfu: 42.89%
[rank1]:2025-10-29 05:46:59,091 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:46:59,039 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank3_trend_line.svg
[rank0]:2025-10-29 05:46:59,084 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank0_trend_line.svg
[rank0]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:46:59,091 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,094  tflops: 424.17  mfu: 42.89%
[rank0]:2025-10-29 05:46:59,091 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:46:59,090 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0163  memory: 65.57GiB(46.90%)  tps: 9,095  tflops: 424.21  mfu: 42.89%
[rank2]:2025-10-29 05:46:59,090 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:46:59,286 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0546_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.23 ms, GPU Bubble Ratio: 54.02%, 24.04%, 28.74%, 25.70%
[rank3]:2025-10-29 05:46:59,286 - INFO - 	> Batch Time: 371.23 ms (Average Freeze Ratio: 0.77)
[rank3]:2025-10-29 05:46:59,287 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.98/0.98, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:46:59,292 - INFO -  step: 400  loss:  0.1114  grad_norm:  0.0163  memory: 84.29GiB(60.29%)  tps: 9,075  tflops: 423.24  mfu: 42.79%
[rank3]:2025-10-29 05:46:59,292 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:47:15,987 - INFO - validate step: 400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,243
[rank3]:2025-10-29 05:47:16,010 - INFO - validate step: 400  loss:  0.2307  memory: 84.29GiB(60.29%)  tps: 24,502
[rank0]:2025-10-29 05:47:15,950 - INFO - validate step: 400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,296
[rank2]:2025-10-29 05:47:16,003 - INFO - validate step: 400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,219
[rank2]:2025-10-29 05:47:16,087 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0547_stage2_step400.svg
[rank1]:2025-10-29 05:47:16,090 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0547_stage1_step400.svg
[rank0]:2025-10-29 05:47:16,089 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0547_stage0_step400.svg
[rank3]:2025-10-29 05:47:16,180 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0547_real_step400_rank3.svg
[rank3]:> Batch Time: 420.03 ms, GPU Bubble Ratio: 69.96%, 29.63%, 27.12%, 28.37%
[rank0]:2025-10-29 05:47:16,175 - INFO - Avg. fwd time: 15.4637 / Avg. bwd time: 12.1794 / Avg. batch time: 478.3093 (ms) / GPU bubble ratio: 53.77%
[rank3]:2025-10-29 05:47:16,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0547_stage3_step400.svg
[rank3]:2025-10-29 05:47:16,498 - INFO - Avg. fwd time: 16.5360 / Avg. bwd time: 26.0558 / Avg. batch time: 356.6458 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-29 05:47:16,550 - INFO - Avg. fwd time: 14.6529 / Avg. bwd time: 23.6541 / Avg. batch time: 405.0062 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-10-29 05:47:16,567 - INFO - Avg. fwd time: 17.4194 / Avg. bwd time: 24.8249 / Avg. batch time: 449.4699 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 05:48:32,095 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:48:33,645 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,551  tflops: 492.10  mfu: 49.76%
[rank1]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,549  tflops: 492.00  mfu: 49.75%
[rank3]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss:  0.1230  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,552  tflops: 492.15  mfu: 49.76%
[rank0]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,544  tflops: 491.76  mfu: 49.72%
[rank2]:2025-10-29 05:48:34,021 - INFO - Avg. fwd time: 14.6831 / Avg. bwd time: 22.8011 / Avg. batch time: 396.2199 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-10-29 05:48:34,045 - INFO - Avg. fwd time: 17.4138 / Avg. bwd time: 24.0794 / Avg. batch time: 439.9188 (ms) / GPU bubble ratio: 24.54%
[rank3]:2025-10-29 05:48:33,999 - INFO - Avg. fwd time: 16.5286 / Avg. bwd time: 25.1888 / Avg. batch time: 349.5580 (ms) / GPU bubble ratio: 4.53%
[rank0]:2025-10-29 05:48:34,050 - INFO - Avg. fwd time: 15.4380 / Avg. bwd time: 10.7596 / Avg. batch time: 467.2409 (ms) / GPU bubble ratio: 55.14%
[rank0]:2025-10-29 05:49:49,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank2]:2025-10-29 05:49:51,074 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank1]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank3]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss:  0.1262  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,580  tflops: 493.46  mfu: 49.89%
[rank0]:2025-10-29 05:49:51,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0549_stage0_step500.svg
[rank2]:2025-10-29 05:49:51,146 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0549_stage2_step500.svg
[rank1]:2025-10-29 05:49:51,148 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0549_stage1_step500.svg
[rank3]:2025-10-29 05:49:51,258 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0549_real_step500_rank3.svg
[rank3]:> Batch Time: 390.43 ms, GPU Bubble Ratio: 68.03%, 25.05%, 28.09%, 24.77%
[rank0]:2025-10-29 05:49:51,231 - INFO - Avg. fwd time: 15.4187 / Avg. bwd time: 9.7823 / Avg. batch time: 459.4052 (ms) / GPU bubble ratio: 56.12%
[rank3]:2025-10-29 05:49:51,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0549_stage3_step500.svg
[rank3]:2025-10-29 05:49:51,562 - INFO - Avg. fwd time: 16.5234 / Avg. bwd time: 24.5880 / Avg. batch time: 344.6487 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 05:49:51,583 - INFO - Avg. fwd time: 14.7062 / Avg. bwd time: 22.1836 / Avg. batch time: 389.9383 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-10-29 05:49:51,609 - INFO - Avg. fwd time: 17.4105 / Avg. bwd time: 23.5690 / Avg. batch time: 433.1327 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 05:51:07,177 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:51:08,725 - INFO -  step: 550  loss:  0.1387  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,550  tflops: 492.06  mfu: 49.75%
[rank0]:2025-10-29 05:51:08,726 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,550  tflops: 492.04  mfu: 49.75%
[rank2]:2025-10-29 05:51:08,724 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank1]:2025-10-29 05:51:08,725 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank0]:2025-10-29 05:51:08,814 - INFO - Avg. fwd time: 15.4001 / Avg. bwd time: 8.8450 / Avg. batch time: 451.9827 (ms) / GPU bubble ratio: 57.09%
[rank3]:2025-10-29 05:51:09,014 - INFO - Avg. fwd time: 16.5185 / Avg. bwd time: 24.0149 / Avg. batch time: 339.9647 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-29 05:51:09,036 - INFO - Avg. fwd time: 14.7286 / Avg. bwd time: 21.5920 / Avg. batch time: 383.9987 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-10-29 05:51:09,061 - INFO - Avg. fwd time: 17.4085 / Avg. bwd time: 23.0827 / Avg. batch time: 426.7150 (ms) / GPU bubble ratio: 24.09%
[rank0]:2025-10-29 05:52:24,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:52:26,462 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank3_trend_line.svg
[rank0]:2025-10-29 05:52:26,508 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank0_trend_line.svg
[rank0]:2025-10-29 05:52:26,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank0]:2025-10-29 05:52:26,515 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 05:52:26,478 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank2_trend_line.svg
[rank2]:2025-10-29 05:52:26,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.78/0.78, [MB1] 0.78/0.78, [MB2] 0.78/0.78, [MB3] 0.78/0.78, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,531  tflops: 491.16  mfu: 49.66%
[rank2]:2025-10-29 05:52:26,516 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 05:52:26,497 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank1_trend_line.svg
[rank1]:2025-10-29 05:52:26,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank1]:2025-10-29 05:52:26,515 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:52:26,701 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0552_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 361.91 ms, GPU Bubble Ratio: 59.97%, 23.86%, 29.29%, 25.07%
[rank3]:2025-10-29 05:52:26,701 - INFO - 	> Batch Time: 361.91 ms (Average Freeze Ratio: 0.71)
[rank3]:2025-10-29 05:52:26,701 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:52:26,706 - INFO -  step: 600  loss:  0.1042  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank3]:2025-10-29 05:52:26,706 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:52:43,415 - INFO - validate step: 600  loss:  0.2321  memory: 84.29GiB(60.29%)  tps: 24,514
[rank0]:2025-10-29 05:52:43,351 - INFO - validate step: 600  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,330
[rank2]:2025-10-29 05:52:43,405 - INFO - validate step: 600  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,253
[rank1]:2025-10-29 05:52:43,389 - INFO - validate step: 600  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,275
[rank0]:2025-10-29 05:52:43,490 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0552_stage0_step600.svg
[rank2]:2025-10-29 05:52:43,490 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0552_stage2_step600.svg
[rank1]:2025-10-29 05:52:43,489 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0552_stage1_step600.svg
[rank3]:2025-10-29 05:52:43,597 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0552_real_step600_rank3.svg
[rank3]:> Batch Time: 379.78 ms, GPU Bubble Ratio: 67.42%, 23.43%, 33.87%, 23.88%
[rank3]:2025-10-29 05:52:43,662 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0552_stage3_step600.svg
[rank3]:2025-10-29 05:52:43,971 - INFO - Avg. fwd time: 16.5135 / Avg. bwd time: 23.5393 / Avg. batch time: 336.0713 (ms) / GPU bubble ratio: 4.66%
[rank0]:2025-10-29 05:52:44,025 - INFO - Avg. fwd time: 15.3830 / Avg. bwd time: 8.0717 / Avg. batch time: 445.8346 (ms) / GPU bubble ratio: 57.91%
[rank2]:2025-10-29 05:52:43,994 - INFO - Avg. fwd time: 14.7459 / Avg. bwd time: 21.1035 / Avg. batch time: 379.0682 (ms) / GPU bubble ratio: 24.34%
[rank1]:2025-10-29 05:52:44,018 - INFO - Avg. fwd time: 17.4050 / Avg. bwd time: 22.6809 / Avg. batch time: 421.3948 (ms) / GPU bubble ratio: 23.90%
[rank0]:2025-10-29 05:54:36,227 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:54:38,519 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,116  tflops: 331.91  mfu: 33.56%
[rank1]:2025-10-29 05:54:38,519 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,115  tflops: 331.87  mfu: 33.56%
[rank3]:2025-10-29 05:54:38,520 - INFO -  step: 650  loss:  0.0855  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,117  tflops: 331.94  mfu: 33.56%
[rank0]:2025-10-29 05:54:38,546 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0762  memory: 72.70GiB(52.00%)  tps: 7,111  tflops: 331.68  mfu: 33.54%
[rank2]:2025-10-29 05:54:38,859 - INFO - Avg. fwd time: 14.7617 / Avg. bwd time: 20.7457 / Avg. batch time: 376.7287 (ms) / GPU bubble ratio: 24.60%
[rank3]:2025-10-29 05:54:38,838 - INFO - Avg. fwd time: 16.5114 / Avg. bwd time: 23.1890 / Avg. batch time: 333.2161 (ms) / GPU bubble ratio: 4.69%
[rank1]:2025-10-29 05:54:38,918 - INFO - Avg. fwd time: 17.3872 / Avg. bwd time: 22.3587 / Avg. batch time: 422.8919 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 05:54:39,040 - INFO - Avg. fwd time: 15.2713 / Avg. bwd time: 10.2044 / Avg. batch time: 453.7027 (ms) / GPU bubble ratio: 55.08%
[rank0]:2025-10-29 05:56:31,470 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:56:33,780 - INFO -  step: 700  loss:  0.0993  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,108  tflops: 331.50  mfu: 33.52%
[rank0]:2025-10-29 05:56:33,806 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0977  memory: 72.70GiB(52.00%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank1]:2025-10-29 05:56:33,779 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank2]:2025-10-29 05:56:33,779 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank0]:2025-10-29 05:56:33,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0556_stage0_step700.svg
[rank1]:2025-10-29 05:56:33,882 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0556_stage1_step700.svg
[rank2]:2025-10-29 05:56:33,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0556_stage2_step700.svg
[rank3]:2025-10-29 05:56:33,991 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0556_real_step700_rank3.svg
[rank3]:> Batch Time: 376.73 ms, GPU Bubble Ratio: 67.41%, 23.31%, 33.69%, 23.81%
[rank3]:2025-10-29 05:56:34,060 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0556_stage3_step700.svg
[rank3]:2025-10-29 05:56:34,305 - INFO - Avg. fwd time: 16.5085 / Avg. bwd time: 22.8401 / Avg. batch time: 330.3650 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-29 05:56:34,326 - INFO - Avg. fwd time: 14.7782 / Avg. bwd time: 20.3890 / Avg. batch time: 374.3996 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-10-29 05:56:34,384 - INFO - Avg. fwd time: 17.3658 / Avg. bwd time: 22.0355 / Avg. batch time: 424.4242 (ms) / GPU bubble ratio: 25.73%
[rank0]:2025-10-29 05:56:34,505 - INFO - Avg. fwd time: 15.1599 / Avg. bwd time: 12.3520 / Avg. batch time: 461.6534 (ms) / GPU bubble ratio: 52.32%
[rank0]:2025-10-29 05:58:26,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:58:29,244 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1491  memory: 72.70GiB(52.00%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank1]:2025-10-29 05:58:29,216 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank2]:2025-10-29 05:58:29,216 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank3]:2025-10-29 05:58:29,218 - INFO -  step: 750  loss:  0.1311  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,097  tflops: 330.99  mfu: 33.47%
[rank3]:2025-10-29 05:58:29,603 - INFO - Avg. fwd time: 16.5071 / Avg. bwd time: 22.5430 / Avg. batch time: 327.9459 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 05:58:29,632 - INFO - Avg. fwd time: 14.7933 / Avg. bwd time: 20.0831 / Avg. batch time: 372.4575 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 05:58:29,712 - INFO - Avg. fwd time: 17.3479 / Avg. bwd time: 21.7573 / Avg. batch time: 425.7989 (ms) / GPU bubble ratio: 26.53%
[rank0]:2025-10-29 05:58:29,811 - INFO - Avg. fwd time: 15.0654 / Avg. bwd time: 14.1993 / Avg. batch time: 468.5505 (ms) / GPU bubble ratio: 50.03%
[rank0]:2025-10-29 06:00:22,174 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:00:24,808 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank3_trend_line.svg
[rank1]:2025-10-29 06:00:24,820 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank1_trend_line.svg
[rank2]:2025-10-29 06:00:24,803 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank2_trend_line.svg
[rank0]:2025-10-29 06:00:24,898 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank0_trend_line.svg
[rank0]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:00:24,905 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1498  memory: 72.70GiB(52.00%)  tps: 7,083  tflops: 330.34  mfu: 33.40%
[rank0]:2025-10-29 06:00:24,905 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:00:24,906 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,081  tflops: 330.26  mfu: 33.39%
[rank1]:2025-10-29 06:00:24,906 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.72/0.72, [MB1] 0.72/0.72, [MB2] 0.72/0.72, [MB3] 0.72/0.72, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:00:24,906 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,081  tflops: 330.26  mfu: 33.39%
[rank2]:2025-10-29 06:00:24,906 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 06:00:25,100 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0600_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 359.24 ms, GPU Bubble Ratio: 36.67%, 23.88%, 29.73%, 24.90%
[rank3]:2025-10-29 06:00:25,101 - INFO - 	> Batch Time: 359.24 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 06:00:25,101 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:00:25,106 - INFO -  step: 800  loss:  0.1166  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,069  tflops: 329.70  mfu: 33.34%
[rank3]:2025-10-29 06:00:25,106 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:00:41,568 - INFO - validate step: 800  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,583
[rank3]:2025-10-29 06:00:41,626 - INFO - validate step: 800  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,797
[rank1]:2025-10-29 06:00:41,597 - INFO - validate step: 800  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,540
[rank2]:2025-10-29 06:00:41,613 - INFO - validate step: 800  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,517
[rank2]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0600_stage2_step800.svg
[rank0]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0600_stage0_step800.svg
[rank1]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0600_stage1_step800.svg
[rank3]:2025-10-29 06:00:41,808 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0600_real_step800_rank3.svg
[rank3]:> Batch Time: 374.22 ms, GPU Bubble Ratio: 67.40%, 23.19%, 33.45%, 23.84%
[rank3]:2025-10-29 06:00:41,877 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0600_stage3_step800.svg
[rank3]:2025-10-29 06:00:42,125 - INFO - Avg. fwd time: 16.5050 / Avg. bwd time: 22.3193 / Avg. batch time: 326.1169 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 06:00:42,146 - INFO - Avg. fwd time: 14.8037 / Avg. bwd time: 19.8527 / Avg. batch time: 370.9528 (ms) / GPU bubble ratio: 25.26%
[rank1]:2025-10-29 06:00:42,206 - INFO - Avg. fwd time: 17.3327 / Avg. bwd time: 21.5481 / Avg. batch time: 426.7927 (ms) / GPU bubble ratio: 27.12%
[rank0]:2025-10-29 06:00:42,323 - INFO - Avg. fwd time: 14.9928 / Avg. bwd time: 15.5899 / Avg. batch time: 473.7020 (ms) / GPU bubble ratio: 48.35%
[rank0]:2025-10-29 06:01:58,111 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:01:59,668 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,495  tflops: 489.50  mfu: 49.49%
[rank3]:2025-10-29 06:01:59,670 - INFO -  step: 850  loss:  0.1418  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,497  tflops: 489.58  mfu: 49.50%
[rank0]:2025-10-29 06:01:59,669 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,489  tflops: 489.21  mfu: 49.46%
[rank1]:2025-10-29 06:01:59,670 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,493  tflops: 489.39  mfu: 49.48%
[rank0]:2025-10-29 06:01:59,754 - INFO - Avg. fwd time: 15.0028 / Avg. bwd time: 14.8526 / Avg. batch time: 469.1115 (ms) / GPU bubble ratio: 49.09%
[rank2]:2025-10-29 06:01:59,976 - INFO - Avg. fwd time: 14.8159 / Avg. bwd time: 19.6163 / Avg. batch time: 368.4449 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 06:01:59,955 - INFO - Avg. fwd time: 16.5072 / Avg. bwd time: 22.0901 / Avg. batch time: 324.2773 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 06:02:00,002 - INFO - Avg. fwd time: 17.3351 / Avg. bwd time: 21.3559 / Avg. batch time: 423.5388 (ms) / GPU bubble ratio: 26.92%
[rank0]:2025-10-29 06:03:15,736 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank1]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank2]:2025-10-29 06:03:17,272 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank2]:2025-10-29 06:03:17,342 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0603_stage2_step900.svg
[rank3]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss:  0.1267  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,556  tflops: 492.35  mfu: 49.78%
[rank0]:2025-10-29 06:03:17,345 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0603_stage0_step900.svg
[rank1]:2025-10-29 06:03:17,341 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0603_stage1_step900.svg
[rank3]:2025-10-29 06:03:17,460 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0603_real_step900_rank3.svg
[rank3]:> Batch Time: 372.67 ms, GPU Bubble Ratio: 67.25%, 22.92%, 33.28%, 23.92%
[rank3]:2025-10-29 06:03:17,522 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0603_stage3_step900.svg
[rank3]:2025-10-29 06:03:17,829 - INFO - Avg. fwd time: 16.5078 / Avg. bwd time: 21.8876 / Avg. batch time: 322.6435 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 06:03:17,883 - INFO - Avg. fwd time: 15.0167 / Avg. bwd time: 13.9866 / Avg. batch time: 464.0771 (ms) / GPU bubble ratio: 50.00%
[rank1]:2025-10-29 06:03:17,877 - INFO - Avg. fwd time: 17.3400 / Avg. bwd time: 21.1908 / Avg. batch time: 420.2401 (ms) / GPU bubble ratio: 26.65%
[rank2]:2025-10-29 06:03:17,852 - INFO - Avg. fwd time: 14.8257 / Avg. bwd time: 19.4076 / Avg. batch time: 366.1195 (ms) / GPU bubble ratio: 25.20%
[rank0]:2025-10-29 06:04:33,522 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank1]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank2]:2025-10-29 06:04:35,069 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,530  tflops: 491.13  mfu: 49.66%
[rank3]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss:  0.1541  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,530  tflops: 491.14  mfu: 49.66%
[rank0]:2025-10-29 06:04:35,156 - INFO - Avg. fwd time: 15.0275 / Avg. bwd time: 13.3210 / Avg. batch time: 460.1735 (ms) / GPU bubble ratio: 50.72%
[rank2]:2025-10-29 06:04:35,379 - INFO - Avg. fwd time: 14.8334 / Avg. bwd time: 19.2472 / Avg. batch time: 364.3120 (ms) / GPU bubble ratio: 25.16%
[rank3]:2025-10-29 06:04:35,358 - INFO - Avg. fwd time: 16.5093 / Avg. bwd time: 21.7324 / Avg. batch time: 321.3986 (ms) / GPU bubble ratio: 4.81%
[rank1]:2025-10-29 06:04:35,404 - INFO - Avg. fwd time: 17.3438 / Avg. bwd time: 21.0627 / Avg. batch time: 417.6718 (ms) / GPU bubble ratio: 26.44%
[rank0]:2025-10-29 06:05:51,093 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank1]:2025-10-29 06:05:52,641 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss:  0.1268  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,561  tflops: 492.56  mfu: 49.80%
[rank3]:2025-10-29 06:05:52,642 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:05:52,640 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank2]:2025-10-29 06:05:52,640 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank0]:2025-10-29 06:05:52,641 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 06:06:09,382 - INFO - validate step: 1000  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,467
[rank1]:2025-10-29 06:06:09,421 - INFO - validate step: 1000  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,411
[rank3]:2025-10-29 06:06:09,446 - INFO - validate step: 1000  loss:  0.2341  memory: 84.29GiB(60.29%)  tps: 24,376
[rank2]:2025-10-29 06:06:09,437 - INFO - validate step: 1000  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,386
[rank0]:2025-10-29 06:06:09,521 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0606_stage0_step1000.svg
[rank1]:2025-10-29 06:06:09,522 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0606_stage1_step1000.svg
[rank2]:2025-10-29 06:06:09,520 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0606_stage2_step1000.svg
[rank0]:2025-10-29 06:06:09,608 - INFO - Avg. fwd time: 15.0375 / Avg. bwd time: 12.6202 / Avg. batch time: 456.0439 (ms) / GPU bubble ratio: 51.48%
[rank3]:2025-10-29 06:06:09,628 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0606_real_step1000_rank3.svg
[rank3]:> Batch Time: 372.16 ms, GPU Bubble Ratio: 67.20%, 22.82%, 33.25%, 23.96%
[rank3]:2025-10-29 06:06:09,691 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0606_stage3_step1000.svg
[rank3]:2025-10-29 06:06:09,934 - INFO - Avg. fwd time: 16.5089 / Avg. bwd time: 21.5680 / Avg. batch time: 320.0635 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 06:06:09,955 - INFO - Avg. fwd time: 14.8403 / Avg. bwd time: 19.0785 / Avg. batch time: 362.3837 (ms) / GPU bubble ratio: 25.12%
[rank1]:2025-10-29 06:06:09,983 - INFO - Avg. fwd time: 17.3456 / Avg. bwd time: 20.9283 / Avg. batch time: 414.9485 (ms) / GPU bubble ratio: 26.21%
[rank0]:2025-10-29 06:07:25,706 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss:  0.1331  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,528  tflops: 491.03  mfu: 49.65%
[rank2]:2025-10-29 06:07:27,258 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank0]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank1]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,524  tflops: 490.86  mfu: 49.63%
[rank3]:2025-10-29 06:07:27,618 - INFO - Avg. fwd time: 16.5093 / Avg. bwd time: 21.4204 / Avg. batch time: 318.8725 (ms) / GPU bubble ratio: 4.84%
[rank2]:2025-10-29 06:07:27,642 - INFO - Avg. fwd time: 14.8471 / Avg. bwd time: 18.9266 / Avg. batch time: 360.6902 (ms) / GPU bubble ratio: 25.09%
[rank0]:2025-10-29 06:07:27,676 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 11.9895 / Avg. batch time: 452.3726 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-10-29 06:07:27,668 - INFO - Avg. fwd time: 17.3473 / Avg. bwd time: 20.8073 / Avg. batch time: 412.5403 (ms) / GPU bubble ratio: 26.01%
[rank0]:2025-10-29 06:08:43,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank1]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank3]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss:  0.1016  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,554  tflops: 492.23  mfu: 49.77%
[rank2]:2025-10-29 06:08:44,881 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank0]:2025-10-29 06:08:44,954 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0608_stage0_step1100.svg
[rank1]:2025-10-29 06:08:44,957 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0608_stage1_step1100.svg
[rank2]:2025-10-29 06:08:44,954 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0608_stage2_step1100.svg
[rank0]:2025-10-29 06:08:45,040 - INFO - Avg. fwd time: 15.0545 / Avg. bwd time: 11.4971 / Avg. batch time: 449.4882 (ms) / GPU bubble ratio: 52.74%
[rank3]:2025-10-29 06:08:45,062 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0608_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.79 ms, GPU Bubble Ratio: 67.19%, 22.74%, 33.22%, 23.97%
[rank3]:2025-10-29 06:08:45,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0608_stage3_step1100.svg
[rank3]:2025-10-29 06:08:45,369 - INFO - Avg. fwd time: 16.5101 / Avg. bwd time: 21.3056 / Avg. batch time: 317.9494 (ms) / GPU bubble ratio: 4.85%
[rank2]:2025-10-29 06:08:45,389 - INFO - Avg. fwd time: 14.8527 / Avg. bwd time: 18.8079 / Avg. batch time: 359.3496 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-10-29 06:08:45,416 - INFO - Avg. fwd time: 17.3505 / Avg. bwd time: 20.7132 / Avg. batch time: 410.6431 (ms) / GPU bubble ratio: 25.85%
[rank0]:2025-10-29 06:10:01,116 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:10:02,678 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank3]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss:  0.1222  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,530  tflops: 491.13  mfu: 49.66%
[rank0]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank1]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank0]:2025-10-29 06:10:02,766 - INFO - Avg. fwd time: 15.0629 / Avg. bwd time: 10.9713 / Avg. batch time: 446.4269 (ms) / GPU bubble ratio: 53.35%
[rank2]:2025-10-29 06:10:02,993 - INFO - Avg. fwd time: 14.8584 / Avg. bwd time: 18.6810 / Avg. batch time: 357.9422 (ms) / GPU bubble ratio: 25.04%
[rank3]:2025-10-29 06:10:02,972 - INFO - Avg. fwd time: 16.5105 / Avg. bwd time: 21.1832 / Avg. batch time: 316.9609 (ms) / GPU bubble ratio: 4.86%
[rank1]:2025-10-29 06:10:03,018 - INFO - Avg. fwd time: 17.3530 / Avg. bwd time: 20.6122 / Avg. batch time: 408.6364 (ms) / GPU bubble ratio: 25.67%
[rank0]:2025-10-29 06:11:18,732 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank0]:2025-10-29 06:11:20,297 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank1]:2025-10-29 06:11:20,298 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 06:11:20,296 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank2]:2025-10-29 06:11:20,296 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss:  0.1056  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,554  tflops: 492.26  mfu: 49.77%
[rank3]:2025-10-29 06:11:20,297 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:11:36,987 - INFO - validate step: 1200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,542
[rank0]:2025-10-29 06:11:36,988 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:11:36,993 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-29 06:11:37,025 - INFO - validate step: 1200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,487
[rank1]:2025-10-29 06:11:37,025 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:11:37,041 - INFO - validate step: 1200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,462
[rank2]:2025-10-29 06:11:37,041 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:11:37,052 - INFO - validate step: 1200  loss:  0.2356  memory: 84.29GiB(60.29%)  tps: 24,448
[rank3]:2025-10-29 06:11:37,053 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:11:49,179 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.15 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 06:11:51,912 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.87 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 06:11:53,701 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.65 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 06:11:55,394 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 06:11:55,400 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.41 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 06:11:55,498 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0611_stage2_step1200.svg
[rank0]:2025-10-29 06:11:55,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0611_stage0_step1200.svg
[rank0]:2025-10-29 06:11:55,541 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 06:11:55,491 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0611_stage1_step1200.svg
[rank1]:2025-10-29 06:11:55,498 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 06:11:55,509 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 06:11:55,605 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0611_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.60 ms, GPU Bubble Ratio: 67.19%, 22.70%, 33.21%, 23.99%
[rank3]:2025-10-29 06:11:55,672 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0611_stage3_step1200.svg
[rank3]:2025-10-29 06:11:55,684 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 06:11:56,001 - INFO - Avg. fwd time: 16.5120 / Avg. bwd time: 21.0721 / Avg. batch time: 316.0737 (ms) / GPU bubble ratio: 4.87%
[rank1]:2025-10-29 06:11:56,053 - INFO - Avg. fwd time: 17.3564 / Avg. bwd time: 20.5196 / Avg. batch time: 406.8139 (ms) / GPU bubble ratio: 25.52%
[rank2]:2025-10-29 06:11:56,027 - INFO - Avg. fwd time: 14.8645 / Avg. bwd time: 18.5654 / Avg. batch time: 356.6682 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 06:11:56,063 - INFO - Avg. fwd time: 15.0715 / Avg. bwd time: 10.4916 / Avg. batch time: 443.6439 (ms) / GPU bubble ratio: 53.90%
[rank0]:2025-10-29 06:13:20,535 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank0]:2025-10-29 06:13:22,194 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 7,787  tflops: 363.17  mfu: 36.72%
[rank1]:2025-10-29 06:13:22,193 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,789  tflops: 363.30  mfu: 36.73%
[rank2]:2025-10-29 06:13:22,192 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,791  tflops: 363.36  mfu: 36.74%
[rank3]:2025-10-29 06:13:22,194 - INFO -  step: 1250  loss:  0.8492  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,792  tflops: 363.40  mfu: 36.74%
[rank0]:2025-10-29 06:13:22,297 - INFO - Avg. fwd time: 15.1035 / Avg. bwd time: 10.1126 / Avg. batch time: 442.1798 (ms) / GPU bubble ratio: 54.38%
[rank2]:2025-10-29 06:13:22,531 - INFO - Avg. fwd time: 14.8900 / Avg. bwd time: 18.4862 / Avg. batch time: 356.3756 (ms) / GPU bubble ratio: 25.08%
[rank3]:2025-10-29 06:13:22,509 - INFO - Avg. fwd time: 16.5429 / Avg. bwd time: 21.0223 / Avg. batch time: 315.9915 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:13:22,556 - INFO - Avg. fwd time: 17.3842 / Avg. bwd time: 20.4691 / Avg. batch time: 406.0836 (ms) / GPU bubble ratio: 25.43%
[rank0]:2025-10-29 06:14:43,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:14:45,042 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank3]:2025-10-29 06:14:45,044 - INFO -  step: 1300  loss:  0.8770  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank0]:2025-10-29 06:14:45,043 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank1]:2025-10-29 06:14:45,044 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank2]:2025-10-29 06:14:45,121 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0614_stage2_step1300.svg
[rank0]:2025-10-29 06:14:45,122 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0614_stage0_step1300.svg
[rank1]:2025-10-29 06:14:45,123 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0614_stage1_step1300.svg
[rank3]:2025-10-29 06:14:45,230 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0614_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.50 ms, GPU Bubble Ratio: 67.16%, 22.73%, 33.25%, 23.99%
[rank0]:2025-10-29 06:14:45,221 - INFO - Avg. fwd time: 15.1365 / Avg. bwd time: 9.7036 / Avg. batch time: 440.3093 (ms) / GPU bubble ratio: 54.87%
[rank3]:2025-10-29 06:14:45,297 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0614_stage3_step1300.svg
[rank1]:2025-10-29 06:14:45,613 - INFO - Avg. fwd time: 17.4161 / Avg. bwd time: 20.4042 / Avg. batch time: 405.0128 (ms) / GPU bubble ratio: 25.30%
[rank2]:2025-10-29 06:14:45,586 - INFO - Avg. fwd time: 14.9173 / Avg. bwd time: 18.4005 / Avg. batch time: 355.7761 (ms) / GPU bubble ratio: 25.08%
[rank3]:2025-10-29 06:14:45,564 - INFO - Avg. fwd time: 16.5761 / Avg. bwd time: 20.9547 / Avg. batch time: 315.7105 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 06:16:06,315 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank2]:2025-10-29 06:16:07,977 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank3]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss:  0.8536  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,878  tflops: 460.71  mfu: 46.58%
[rank0]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank2]:2025-10-29 06:16:08,388 - INFO - Avg. fwd time: 14.9424 / Avg. bwd time: 18.3217 / Avg. batch time: 355.2449 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-29 06:16:08,362 - INFO - Avg. fwd time: 16.6068 / Avg. bwd time: 20.8919 / Avg. batch time: 315.4488 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 06:16:08,425 - INFO - Avg. fwd time: 15.1669 / Avg. bwd time: 9.3265 / Avg. batch time: 438.6111 (ms) / GPU bubble ratio: 55.33%
[rank1]:2025-10-29 06:16:08,415 - INFO - Avg. fwd time: 17.4464 / Avg. bwd time: 20.3457 / Avg. batch time: 404.0524 (ms) / GPU bubble ratio: 25.17%
[rank0]:2025-10-29 06:17:29,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank0]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank1]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 06:17:30,834 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank2]:2025-10-29 06:17:30,834 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss:  0.9120  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank3]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 06:17:47,608 - INFO - validate step: 1400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,421
[rank1]:2025-10-29 06:17:47,646 - INFO - validate step: 1400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,365
[rank2]:2025-10-29 06:17:47,661 - INFO - validate step: 1400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,342
[rank3]:2025-10-29 06:17:47,674 - INFO - validate step: 1400  loss:  0.2334  memory: 84.29GiB(60.29%)  tps: 24,326
[rank0]:2025-10-29 06:17:47,756 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0617_stage0_step1400.svg
[rank1]:2025-10-29 06:17:47,758 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0617_stage1_step1400.svg
[rank2]:2025-10-29 06:17:47,756 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0617_stage2_step1400.svg
[rank0]:2025-10-29 06:17:47,858 - INFO - Avg. fwd time: 15.1906 / Avg. bwd time: 9.0258 / Avg. batch time: 437.2333 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-10-29 06:17:47,863 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0617_real_step1400_rank3.svg
[rank3]:> Batch Time: 373.55 ms, GPU Bubble Ratio: 67.14%, 22.78%, 33.32%, 23.99%
[rank3]:2025-10-29 06:17:47,930 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0617_stage3_step1400.svg
[rank3]:2025-10-29 06:17:48,201 - INFO - Avg. fwd time: 16.6310 / Avg. bwd time: 20.8420 / Avg. batch time: 315.2397 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:17:48,248 - INFO - Avg. fwd time: 17.4704 / Avg. bwd time: 20.2987 / Avg. batch time: 403.2631 (ms) / GPU bubble ratio: 25.07%
[rank2]:2025-10-29 06:17:48,223 - INFO - Avg. fwd time: 14.9620 / Avg. bwd time: 18.2586 / Avg. batch time: 354.8000 (ms) / GPU bubble ratio: 25.09%
[rank0]:2025-10-29 06:19:09,006 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:19:10,659 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,868  tflops: 460.27  mfu: 46.54%
[rank2]:2025-10-29 06:19:10,657 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,870  tflops: 460.36  mfu: 46.55%
[rank3]:2025-10-29 06:19:10,658 - INFO -  step: 1450  loss:  0.9425  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,872  tflops: 460.43  mfu: 46.56%
[rank0]:2025-10-29 06:19:10,658 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,864  tflops: 460.06  mfu: 46.52%
[rank0]:2025-10-29 06:19:10,759 - INFO - Avg. fwd time: 15.2169 / Avg. bwd time: 8.6986 / Avg. batch time: 435.7611 (ms) / GPU bubble ratio: 56.09%
[rank3]:2025-10-29 06:19:10,973 - INFO - Avg. fwd time: 16.6577 / Avg. bwd time: 20.7878 / Avg. batch time: 315.0156 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:19:11,020 - INFO - Avg. fwd time: 17.4970 / Avg. bwd time: 20.2478 / Avg. batch time: 402.4315 (ms) / GPU bubble ratio: 24.97%
[rank2]:2025-10-29 06:19:10,994 - INFO - Avg. fwd time: 14.9836 / Avg. bwd time: 18.1902 / Avg. batch time: 354.3420 (ms) / GPU bubble ratio: 25.10%
[rank0]:2025-10-29 06:20:31,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:20:33,387 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank2]:2025-10-29 06:20:33,386 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank1]:2025-10-29 06:20:33,388 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank3]:2025-10-29 06:20:33,388 - INFO -  step: 1500  loss:  0.8219  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,902  tflops: 461.85  mfu: 46.70%
[rank0]:2025-10-29 06:20:33,469 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0620_stage0_step1500.svg
[rank2]:2025-10-29 06:20:33,469 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0620_stage2_step1500.svg
[rank1]:2025-10-29 06:20:33,470 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0620_stage1_step1500.svg
[rank3]:2025-10-29 06:20:33,572 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0620_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.72 ms, GPU Bubble Ratio: 67.14%, 22.84%, 33.41%, 23.99%
[rank3]:2025-10-29 06:20:33,639 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0620_stage3_step1500.svg
[rank2]:2025-10-29 06:20:34,002 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 18.1266 / Avg. batch time: 353.9090 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:20:34,029 - INFO - Avg. fwd time: 17.5207 / Avg. bwd time: 20.2003 / Avg. batch time: 401.6525 (ms) / GPU bubble ratio: 24.87%
[rank3]:2025-10-29 06:20:33,976 - INFO - Avg. fwd time: 16.6819 / Avg. bwd time: 20.7372 / Avg. batch time: 314.8001 (ms) / GPU bubble ratio: 4.91%
[rank0]:2025-10-29 06:20:34,038 - INFO - Avg. fwd time: 15.2411 / Avg. bwd time: 8.3943 / Avg. batch time: 434.3871 (ms) / GPU bubble ratio: 56.47%
[rank0]:2025-10-29 06:21:54,734 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:21:56,387 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank1]:2025-10-29 06:21:56,388 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank3]:2025-10-29 06:21:56,389 - INFO -  step: 1550  loss:  0.8815  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,870  tflops: 460.34  mfu: 46.55%
[rank0]:2025-10-29 06:21:56,388 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank0]:2025-10-29 06:21:56,490 - INFO - Avg. fwd time: 15.2606 / Avg. bwd time: 8.1500 / Avg. batch time: 433.2704 (ms) / GPU bubble ratio: 56.77%
[rank3]:2025-10-29 06:21:56,704 - INFO - Avg. fwd time: 16.7019 / Avg. bwd time: 20.6967 / Avg. batch time: 314.6332 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 06:21:56,727 - INFO - Avg. fwd time: 15.0196 / Avg. bwd time: 18.0755 / Avg. batch time: 353.5501 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:21:56,751 - INFO - Avg. fwd time: 17.5410 / Avg. bwd time: 20.1622 / Avg. batch time: 401.0139 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 06:23:16,475 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:23:18,793 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank2_trend_line.svg
[rank1]:2025-10-29 06:23:18,882 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank1_trend_line.svg
[rank3]:2025-10-29 06:23:18,793 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank3_trend_line.svg
[rank0]:2025-10-29 06:23:18,844 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank0_trend_line.svg
[rank0]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:23:18,891 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,929  tflops: 463.11  mfu: 46.83%
[rank0]:2025-10-29 06:23:18,891 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.54/0.54, [MB1] 0.55/0.55, [MB2] 0.62/0.62, [MB3] 0.70/0.70, [MB4] 0.77/0.77, [MB5] 0.85/0.85, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:23:18,892 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,929  tflops: 463.10  mfu: 46.82%
[rank2]:2025-10-29 06:23:18,892 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:23:18,891 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,929  tflops: 463.11  mfu: 46.83%
[rank1]:2025-10-29 06:23:18,891 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 06:23:19,081 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0623_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.56 ms, GPU Bubble Ratio: 53.58%, 23.63%, 30.80%, 24.45%
[rank3]:2025-10-29 06:23:19,081 - INFO - 	> Batch Time: 357.56 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 06:23:19,082 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:23:19,088 - INFO -  step: 1600  loss:  0.1183  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,906  tflops: 462.01  mfu: 46.72%
[rank3]:2025-10-29 06:23:19,088 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 06:23:35,714 - INFO - validate step: 1600  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,348
[rank2]:2025-10-29 06:23:35,768 - INFO - validate step: 1600  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,272
[rank1]:2025-10-29 06:23:35,753 - INFO - validate step: 1600  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,292
[rank3]:2025-10-29 06:23:35,777 - INFO - validate step: 1600  loss:  0.2360  memory: 84.29GiB(60.29%)  tps: 24,546
[rank2]:2025-10-29 06:23:35,861 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0623_stage2_step1600.svg
[rank1]:2025-10-29 06:23:35,866 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0623_stage1_step1600.svg
[rank0]:2025-10-29 06:23:35,863 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0623_stage0_step1600.svg
[rank3]:2025-10-29 06:23:35,965 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0623_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.93 ms, GPU Bubble Ratio: 67.15%, 22.93%, 33.50%, 23.96%
[rank0]:2025-10-29 06:23:35,951 - INFO - Avg. fwd time: 15.2768 / Avg. bwd time: 7.8823 / Avg. batch time: 431.9550 (ms) / GPU bubble ratio: 57.11%
[rank3]:2025-10-29 06:23:36,036 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0623_stage3_step1600.svg
[rank3]:2025-10-29 06:23:36,287 - INFO - Avg. fwd time: 16.7181 / Avg. bwd time: 20.6480 / Avg. batch time: 314.3676 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 06:23:36,309 - INFO - Avg. fwd time: 15.0339 / Avg. bwd time: 18.0172 / Avg. batch time: 353.0687 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:23:36,333 - INFO - Avg. fwd time: 17.5574 / Avg. bwd time: 20.1177 / Avg. batch time: 400.2262 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-10-29 06:24:52,086 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:24:53,637 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,520  tflops: 490.67  mfu: 49.61%
[rank3]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss:  0.1127  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,521  tflops: 490.72  mfu: 49.62%
[rank1]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,518  tflops: 490.56  mfu: 49.60%
[rank0]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,513  tflops: 490.32  mfu: 49.58%
[rank2]:2025-10-29 06:24:54,025 - INFO - Avg. fwd time: 15.0326 / Avg. bwd time: 17.9542 / Avg. batch time: 352.2975 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-29 06:24:53,997 - INFO - Avg. fwd time: 16.7123 / Avg. bwd time: 20.5839 / Avg. batch time: 313.8001 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 06:24:54,053 - INFO - Avg. fwd time: 17.5527 / Avg. bwd time: 20.0667 / Avg. batch time: 399.1741 (ms) / GPU bubble ratio: 24.61%
[rank0]:2025-10-29 06:24:54,064 - INFO - Avg. fwd time: 15.2763 / Avg. bwd time: 7.6316 / Avg. batch time: 430.3977 (ms) / GPU bubble ratio: 57.42%
[rank0]:2025-10-29 06:26:09,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:26:11,304 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank3]:2025-10-29 06:26:11,306 - INFO -  step: 1700  loss:  0.1205  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank1]:2025-10-29 06:26:11,305 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank0]:2025-10-29 06:26:11,305 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank2]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0626_stage2_step1700.svg
[rank1]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0626_stage1_step1700.svg
[rank0]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0626_stage0_step1700.svg
[rank3]:2025-10-29 06:26:11,498 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0626_real_step1700_rank3.svg
[rank3]:> Batch Time: 375.07 ms, GPU Bubble Ratio: 67.12%, 22.82%, 33.42%, 23.99%
[rank0]:2025-10-29 06:26:11,478 - INFO - Avg. fwd time: 15.2751 / Avg. bwd time: 7.4291 / Avg. batch time: 429.1162 (ms) / GPU bubble ratio: 57.67%
[rank3]:2025-10-29 06:26:11,569 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0626_stage3_step1700.svg
[rank3]:2025-10-29 06:26:11,813 - INFO - Avg. fwd time: 16.7072 / Avg. bwd time: 20.5318 / Avg. batch time: 313.3360 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 06:26:11,834 - INFO - Avg. fwd time: 15.0311 / Avg. bwd time: 17.9033 / Avg. batch time: 351.6515 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 06:26:11,859 - INFO - Avg. fwd time: 17.5484 / Avg. bwd time: 20.0258 / Avg. batch time: 398.3021 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-10-29 06:27:27,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank2]:2025-10-29 06:27:29,126 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank3]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss:  0.1236  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,527  tflops: 490.98  mfu: 49.64%
[rank1]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank0]:2025-10-29 06:27:29,216 - INFO - Avg. fwd time: 15.2744 / Avg. bwd time: 7.2061 / Avg. batch time: 427.7242 (ms) / GPU bubble ratio: 57.95%
[rank2]:2025-10-29 06:27:29,441 - INFO - Avg. fwd time: 15.0297 / Avg. bwd time: 17.8475 / Avg. batch time: 350.9640 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 06:27:29,420 - INFO - Avg. fwd time: 16.7019 / Avg. bwd time: 20.4748 / Avg. batch time: 312.8290 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 06:27:29,467 - INFO - Avg. fwd time: 17.5443 / Avg. bwd time: 19.9801 / Avg. batch time: 397.3608 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 06:28:45,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:28:46,708 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank2]:2025-10-29 06:28:46,708 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 06:28:46,710 - INFO -  step: 1800  loss:  0.0989  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,559  tflops: 492.49  mfu: 49.80%
[rank3]:2025-10-29 06:28:46,710 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 06:28:46,709 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank1]:2025-10-29 06:28:46,709 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 06:28:46,709 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank0]:2025-10-29 06:28:46,709 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 06:29:03,496 - INFO - validate step: 1800  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,400
[rank2]:2025-10-29 06:29:03,549 - INFO - validate step: 1800  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,322
[rank3]:2025-10-29 06:29:03,559 - INFO - validate step: 1800  loss:  0.2342  memory: 84.29GiB(60.29%)  tps: 24,310
[rank1]:2025-10-29 06:29:03,533 - INFO - validate step: 1800  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,347
[rank2]:2025-10-29 06:29:03,645 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0629_stage2_step1800.svg
[rank1]:2025-10-29 06:29:03,646 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0629_stage1_step1800.svg
[rank0]:2025-10-29 06:29:03,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0629_stage0_step1800.svg
[rank3]:2025-10-29 06:29:03,750 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0629_real_step1800_rank3.svg
[rank3]:> Batch Time: 374.46 ms, GPU Bubble Ratio: 67.11%, 22.76%, 33.37%, 24.00%
[rank3]:2025-10-29 06:29:03,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0629_stage3_step1800.svg
[rank3]:2025-10-29 06:29:04,131 - INFO - Avg. fwd time: 16.6963 / Avg. bwd time: 20.4209 / Avg. batch time: 312.3459 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 06:29:04,186 - INFO - Avg. fwd time: 17.5396 / Avg. bwd time: 19.9374 / Avg. batch time: 396.4687 (ms) / GPU bubble ratio: 24.38%
[rank0]:2025-10-29 06:29:04,197 - INFO - Avg. fwd time: 15.2730 / Avg. bwd time: 6.9960 / Avg. batch time: 426.4079 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-10-29 06:29:04,157 - INFO - Avg. fwd time: 15.0280 / Avg. bwd time: 17.7946 / Avg. batch time: 350.3107 (ms) / GPU bubble ratio: 25.04%
[rank0]:2025-10-29 06:30:19,958 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:30:21,504 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,509  tflops: 490.13  mfu: 49.56%
[rank3]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss:  0.0795  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,510  tflops: 490.19  mfu: 49.56%
[rank1]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,506  tflops: 490.02  mfu: 49.55%
[rank0]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,501  tflops: 489.79  mfu: 49.52%
[rank0]:2025-10-29 06:30:21,594 - INFO - Avg. fwd time: 15.2728 / Avg. bwd time: 6.8255 / Avg. batch time: 425.3310 (ms) / GPU bubble ratio: 58.44%
[rank3]:2025-10-29 06:30:21,801 - INFO - Avg. fwd time: 16.6926 / Avg. bwd time: 20.3771 / Avg. batch time: 311.9604 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 06:30:21,847 - INFO - Avg. fwd time: 17.5365 / Avg. bwd time: 19.9023 / Avg. batch time: 395.7350 (ms) / GPU bubble ratio: 24.32%
[rank2]:2025-10-29 06:30:21,822 - INFO - Avg. fwd time: 15.0271 / Avg. bwd time: 17.7519 / Avg. batch time: 349.7720 (ms) / GPU bubble ratio: 25.03%
[rank0]:2025-10-29 06:31:37,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:31:39,257 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 06:31:39,257 - INFO -  step: 1900  loss:  0.0945  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,536  tflops: 491.41  mfu: 49.69%
[rank1]:2025-10-29 06:31:39,258 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank0]:2025-10-29 06:31:39,258 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank2]:2025-10-29 06:31:39,341 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0631_stage2_step1900.svg
[rank1]:2025-10-29 06:31:39,343 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0631_stage1_step1900.svg
[rank0]:2025-10-29 06:31:39,343 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0631_stage0_step1900.svg
[rank3]:2025-10-29 06:31:39,443 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0631_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.93 ms, GPU Bubble Ratio: 67.11%, 22.71%, 33.31%, 24.01%
[rank0]:2025-10-29 06:31:39,435 - INFO - Avg. fwd time: 15.2721 / Avg. bwd time: 6.6368 / Avg. batch time: 424.1405 (ms) / GPU bubble ratio: 58.68%
[rank3]:2025-10-29 06:31:39,512 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0631_stage3_step1900.svg
[rank3]:2025-10-29 06:31:39,761 - INFO - Avg. fwd time: 16.6882 / Avg. bwd time: 20.3285 / Avg. batch time: 311.5300 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 06:31:39,807 - INFO - Avg. fwd time: 17.5331 / Avg. bwd time: 19.8642 / Avg. batch time: 394.9249 (ms) / GPU bubble ratio: 24.24%
[rank2]:2025-10-29 06:31:39,782 - INFO - Avg. fwd time: 15.0258 / Avg. bwd time: 17.7046 / Avg. batch time: 349.1714 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-10-29 06:32:55,567 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:32:57,132 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:32:57,132 - INFO -  step: 1950  loss:  0.1212  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,520  tflops: 490.64  mfu: 49.61%
[rank1]:2025-10-29 06:32:57,133 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 06:32:57,133 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:32:57,525 - INFO - Avg. fwd time: 15.0249 / Avg. bwd time: 17.6597 / Avg. batch time: 348.6258 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-10-29 06:32:57,498 - INFO - Avg. fwd time: 16.6843 / Avg. bwd time: 20.2830 / Avg. batch time: 311.1285 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 06:32:57,554 - INFO - Avg. fwd time: 17.5302 / Avg. bwd time: 19.8277 / Avg. batch time: 394.1760 (ms) / GPU bubble ratio: 24.18%
[rank0]:2025-10-29 06:32:57,567 - INFO - Avg. fwd time: 15.2720 / Avg. bwd time: 6.4582 / Avg. batch time: 423.0331 (ms) / GPU bubble ratio: 58.91%
[rank0]:2025-10-29 06:34:13,287 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank0]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 06:34:14,850 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank2]:2025-10-29 06:34:14,851 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss:  0.1106  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank3]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank1]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 06:34:31,551 - INFO - validate step: 2000  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,529
[rank2]:2025-10-29 06:34:31,604 - INFO - validate step: 2000  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,449
[rank3]:2025-10-29 06:34:31,616 - INFO - validate step: 2000  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,434
[rank1]:2025-10-29 06:34:31,590 - INFO - validate step: 2000  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,470
[rank2]:2025-10-29 06:34:31,702 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0634_stage2_step2000.svg
[rank1]:2025-10-29 06:34:31,708 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0634_stage1_step2000.svg
[rank0]:2025-10-29 06:34:31,704 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0634_stage0_step2000.svg
[rank3]:2025-10-29 06:34:31,810 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0634_real_step2000_rank3.svg
[rank3]:> Batch Time: 373.63 ms, GPU Bubble Ratio: 67.11%, 22.68%, 33.29%, 24.03%
[rank0]:2025-10-29 06:34:31,795 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 6.3126 / Avg. batch time: 422.1076 (ms) / GPU bubble ratio: 59.09%
[rank3]:2025-10-29 06:34:31,882 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0634_stage3_step2000.svg
[rank3]:2025-10-29 06:34:32,134 - INFO - Avg. fwd time: 16.6802 / Avg. bwd time: 20.2455 / Avg. batch time: 310.7907 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 06:34:32,155 - INFO - Avg. fwd time: 15.0237 / Avg. bwd time: 17.6234 / Avg. batch time: 348.1561 (ms) / GPU bubble ratio: 24.98%
[rank1]:2025-10-29 06:34:32,181 - INFO - Avg. fwd time: 17.5276 / Avg. bwd time: 19.7985 / Avg. batch time: 393.5442 (ms) / GPU bubble ratio: 24.12%
[rank0]:2025-10-29 06:35:47,967 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,512  tflops: 490.28  mfu: 49.57%
[rank0]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,507  tflops: 490.03  mfu: 49.55%
[rank2]:2025-10-29 06:35:49,521 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,514  tflops: 490.37  mfu: 49.58%
[rank3]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss:  0.1565  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,516  tflops: 490.45  mfu: 49.59%
[rank0]:2025-10-29 06:35:49,615 - INFO - Avg. fwd time: 15.2717 / Avg. bwd time: 6.1509 / Avg. batch time: 421.1016 (ms) / GPU bubble ratio: 59.30%
[rank2]:2025-10-29 06:35:49,836 - INFO - Avg. fwd time: 15.0230 / Avg. bwd time: 17.5828 / Avg. batch time: 347.6617 (ms) / GPU bubble ratio: 24.97%
[rank3]:2025-10-29 06:35:49,816 - INFO - Avg. fwd time: 16.6767 / Avg. bwd time: 20.2041 / Avg. batch time: 310.4263 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 06:35:49,862 - INFO - Avg. fwd time: 17.5249 / Avg. bwd time: 19.7652 / Avg. batch time: 392.8637 (ms) / GPU bubble ratio: 24.07%
[rank0]:2025-10-29 06:37:05,615 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss:  0.1372  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,552  tflops: 492.15  mfu: 49.76%
[rank1]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank0]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank2]:2025-10-29 06:37:07,157 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank2]:2025-10-29 06:37:07,236 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0637_stage2_step2100.svg
[rank1]:2025-10-29 06:37:07,238 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0637_stage1_step2100.svg
[rank0]:2025-10-29 06:37:07,237 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0637_stage0_step2100.svg
[rank3]:2025-10-29 06:37:07,348 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0637_real_step2100_rank3.svg
[rank3]:> Batch Time: 373.39 ms, GPU Bubble Ratio: 67.11%, 22.67%, 33.29%, 24.04%
[rank3]:2025-10-29 06:37:07,411 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0637_stage3_step2100.svg
[rank3]:2025-10-29 06:37:07,721 - INFO - Avg. fwd time: 16.6730 / Avg. bwd time: 20.1649 / Avg. batch time: 310.0772 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 06:37:07,777 - INFO - Avg. fwd time: 17.5226 / Avg. bwd time: 19.7339 / Avg. batch time: 392.2179 (ms) / GPU bubble ratio: 24.01%
[rank0]:2025-10-29 06:37:07,788 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 5.9972 / Avg. batch time: 420.1470 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-10-29 06:37:07,748 - INFO - Avg. fwd time: 15.0220 / Avg. bwd time: 17.5441 / Avg. batch time: 347.1891 (ms) / GPU bubble ratio: 24.96%
[rank0]:2025-10-29 06:38:23,509 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:38:25,059 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank3]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss:  0.1780  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,516  tflops: 490.47  mfu: 49.59%
[rank1]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank0]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank0]:2025-10-29 06:38:25,153 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 5.8715 / Avg. batch time: 419.3530 (ms) / GPU bubble ratio: 59.67%
[rank2]:2025-10-29 06:38:25,377 - INFO - Avg. fwd time: 15.0214 / Avg. bwd time: 17.5126 / Avg. batch time: 346.7908 (ms) / GPU bubble ratio: 24.95%
[rank3]:2025-10-29 06:38:25,357 - INFO - Avg. fwd time: 16.6701 / Avg. bwd time: 20.1328 / Avg. batch time: 309.7928 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 06:38:25,403 - INFO - Avg. fwd time: 17.5208 / Avg. bwd time: 19.7082 / Avg. batch time: 391.6772 (ms) / GPU bubble ratio: 23.96%
[rank0]:2025-10-29 06:39:41,118 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:39:42,668 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank2]:2025-10-29 06:39:42,668 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss:  0.1158  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,556  tflops: 492.32  mfu: 49.78%
[rank3]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank1]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank0]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:39:59,615 - INFO - validate step: 2200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,171
[rank0]:2025-10-29 06:39:59,578 - INFO - validate step: 2200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,224
[rank2]:2025-10-29 06:39:59,630 - INFO - validate step: 2200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,148
[rank3]:2025-10-29 06:39:59,643 - INFO - validate step: 2200  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,133
[rank1]:2025-10-29 06:39:59,723 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0639_stage1_step2200.svg
[rank0]:2025-10-29 06:39:59,723 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0639_stage0_step2200.svg
[rank2]:2025-10-29 06:39:59,721 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0639_stage2_step2200.svg
[rank0]:2025-10-29 06:39:59,813 - INFO - Avg. fwd time: 15.2705 / Avg. bwd time: 5.7313 / Avg. batch time: 418.4569 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-29 06:39:59,838 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0639_real_step2200_rank3.svg
[rank3]:> Batch Time: 373.16 ms, GPU Bubble Ratio: 67.11%, 22.65%, 33.26%, 24.04%
[rank3]:2025-10-29 06:39:59,901 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0639_stage3_step2200.svg
[rank2]:2025-10-29 06:40:00,170 - INFO - Avg. fwd time: 15.0203 / Avg. bwd time: 17.4777 / Avg. batch time: 346.3375 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-10-29 06:40:00,150 - INFO - Avg. fwd time: 16.6659 / Avg. bwd time: 20.0968 / Avg. batch time: 309.4666 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:40:00,196 - INFO - Avg. fwd time: 17.5177 / Avg. bwd time: 19.6797 / Avg. batch time: 391.0643 (ms) / GPU bubble ratio: 23.91%
[rank0]:2025-10-29 06:41:15,896 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 06:41:17,453 - INFO -  step: 2250  loss:  0.1409  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,529  tflops: 491.05  mfu: 49.65%
[rank1]:2025-10-29 06:41:17,453 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,525  tflops: 490.86  mfu: 49.63%
[rank0]:2025-10-29 06:41:17,452 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:41:17,451 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank2]:2025-10-29 06:41:17,844 - INFO - Avg. fwd time: 15.0193 / Avg. bwd time: 17.4440 / Avg. batch time: 345.9242 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-10-29 06:41:17,816 - INFO - Avg. fwd time: 16.6624 / Avg. bwd time: 20.0625 / Avg. batch time: 309.1595 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:41:17,874 - INFO - Avg. fwd time: 17.5143 / Avg. bwd time: 19.6520 / Avg. batch time: 390.4981 (ms) / GPU bubble ratio: 23.86%
[rank0]:2025-10-29 06:41:17,888 - INFO - Avg. fwd time: 15.2700 / Avg. bwd time: 5.5977 / Avg. batch time: 417.6217 (ms) / GPU bubble ratio: 60.03%
[rank0]:2025-10-29 06:42:33,601 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,543  tflops: 491.72  mfu: 49.72%
[rank0]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,543  tflops: 491.71  mfu: 49.72%
[rank2]:2025-10-29 06:42:35,155 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,543  tflops: 491.71  mfu: 49.72%
[rank3]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss:  0.1056  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,543  tflops: 491.72  mfu: 49.72%
[rank1]:2025-10-29 06:42:35,236 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0642_stage1_step2300.svg
[rank0]:2025-10-29 06:42:35,236 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0642_stage0_step2300.svg
[rank2]:2025-10-29 06:42:35,235 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0642_stage2_step2300.svg
[rank0]:2025-10-29 06:42:35,326 - INFO - Avg. fwd time: 15.2697 / Avg. bwd time: 5.4880 / Avg. batch time: 416.9271 (ms) / GPU bubble ratio: 60.17%
[rank3]:2025-10-29 06:42:35,344 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0642_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.94 ms, GPU Bubble Ratio: 67.10%, 22.63%, 33.25%, 24.05%
[rank3]:2025-10-29 06:42:35,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0642_stage3_step2300.svg
[rank2]:2025-10-29 06:42:35,677 - INFO - Avg. fwd time: 15.0186 / Avg. bwd time: 17.4165 / Avg. batch time: 345.5751 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 06:42:35,657 - INFO - Avg. fwd time: 16.6598 / Avg. bwd time: 20.0345 / Avg. batch time: 308.9107 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:42:35,703 - INFO - Avg. fwd time: 17.5125 / Avg. bwd time: 19.6298 / Avg. batch time: 390.0251 (ms) / GPU bubble ratio: 23.82%
[rank0]:2025-10-29 06:43:51,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank1]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank2]:2025-10-29 06:43:53,017 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank3]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss:  0.1306  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,521  tflops: 490.72  mfu: 49.62%
[rank0]:2025-10-29 06:43:53,113 - INFO - Avg. fwd time: 15.2690 / Avg. bwd time: 5.3654 / Avg. batch time: 416.1618 (ms) / GPU bubble ratio: 60.33%
[rank2]:2025-10-29 06:43:53,340 - INFO - Avg. fwd time: 15.0176 / Avg. bwd time: 17.3857 / Avg. batch time: 345.1962 (ms) / GPU bubble ratio: 24.90%
[rank3]:2025-10-29 06:43:53,319 - INFO - Avg. fwd time: 16.6566 / Avg. bwd time: 20.0032 / Avg. batch time: 308.6307 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:43:53,364 - INFO - Avg. fwd time: 17.5100 / Avg. bwd time: 19.6049 / Avg. batch time: 389.5078 (ms) / GPU bubble ratio: 23.77%
[rank0]:2025-10-29 06:45:09,118 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:45:10,686 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank1]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,704  tflops: 452.59  mfu: 45.11%
[rank1]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 06:45:10,684 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank2]:2025-10-29 06:45:10,685 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,702  tflops: 452.49  mfu: 45.10%
[rank2]:2025-10-29 06:45:10,685 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 06:45:10,685 - INFO -  step: 2400  loss:  0.1136  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank3]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss:  0.1136  grad_norm:  0.0000  tps: 9,704  tflops: 452.61  mfu: 45.11%
[rank3]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:45:10,686 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank0]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,700  tflops: 452.41  mfu: 45.10%
[rank0]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:45:27,572 - INFO - validate step: 2400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,257
[rank0]:2025-10-29 06:45:27,573 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:45:27,577 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 06:45:27,628 - INFO - validate step: 2400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,175
[rank2]:2025-10-29 06:45:27,629 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:45:27,634 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 06:45:27,638 - INFO - validate step: 2400  loss:  0.2338  memory: 84.29GiB(60.29%)  tps: 24,164
[rank3]:2025-10-29 06:45:27,639 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:45:27,643 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 06:45:27,611 - INFO - validate step: 2400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,200
[rank1]:2025-10-29 06:45:27,612 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:45:27,615 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 06:45:39,082 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 06:45:39,167 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0645_stage0_final2400.svg
[rank1]:2025-10-29 06:45:39,170 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0645_stage1_final2400.svg
[rank2]:2025-10-29 06:45:39,167 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0645_stage2_final2400.svg
[rank3]:2025-10-29 06:45:39,278 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0645_real_final2400_rank3.svg
[rank3]:> Batch Time: 372.82 ms, GPU Bubble Ratio: 67.11%, 22.62%, 33.25%, 24.05%
[rank0]:2025-10-29 06:45:39,405 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank0_stage0.svg
[rank0]:	> Counts Sum: 4638200, Total Sum: 5442880 (85.22%), Ratio(%) per element: [84.92, 84.71, 84.65, 84.76, 84.92, 84.87, 84.71, 84.97, 84.65, 84.76, 84.6, 85.03, 85.03, 85.08, 84.81, 84.65, 84.92, 84.81, 84.76, 84.87, 85.03, 84.87, 84.87, 85.08, 84.97, 85.13, 84.92, 85.08, 84.97, 84.87, 85.13, 85.08, 85.03, 85.13, 84.97, 85.03, 84.81, 85.13, 84.97, 85.19, 84.97, 85.19, 84.81, 85.46, 85.3, 85.4, 85.19, 85.67, 85.35, 85.35, 85.3, 85.51, 85.35, 85.51, 85.35, 85.4, 85.94, 85.72, 85.56, 85.56, 85.56, 85.99, 85.46, 85.89, 85.72, 85.72, 85.72, 86.1, 85.94, 85.89, 86.05, 85.78, 85.94]
[rank0]:2025-10-29 06:45:39,405 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 06:45:39,408 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank2_stage2.svg
[rank2]:	> Counts Sum: 1179800, Total Sum: 5368320 (21.98%), Ratio(%) per element: [22.63, 21.03, 21.88, 22.63, 20.17, 20.86, 22.47, 22.53, 20.22, 22.53, 21.94, 20.22, 22.96, 22.42, 22.47, 21.4, 19.25, 22.8, 22.53, 22.1, 22.42, 22.42, 22.1, 21.4, 21.83, 22.42, 22.37, 21.78, 22.74, 21.99, 23.12, 20.86, 22.26, 21.62, 22.04, 22.69, 22.21, 21.78, 21.03, 22.69, 23.01, 19.52, 24.73, 22.8, 21.78, 22.96, 21.19, 21.67, 22.53, 21.78, 21.99, 22.53, 20.86, 23.06, 21.83, 22.47, 21.83, 22.69, 23.01, 21.94, 22.69, 22.15, 21.78, 21.62, 21.35, 21.13, 21.51, 20.92, 22.53, 21.83, 21.94, 21.62]
[rank2]:2025-10-29 06:45:39,408 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:45:39,455 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0645_thry_final2400_rank3.svg
[rank3]:> Batch Time: 531.86 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-10-29 06:45:39,424 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank1_stage1.svg
[rank1]:	> Counts Sum: 249440, Total Sum: 6039360 (4.13%), Ratio(%) per element: [4.45, 4.77, 3.96, 3.96, 4.02, 4.07, 4.23, 4.02, 4.5, 4.29, 4.13, 3.7, 3.91, 4.98, 3.64, 4.23, 4.56, 3.91, 3.96, 4.29, 3.21, 3.75, 4.13, 3.86, 3.96, 3.7, 3.75, 4.02, 3.7, 4.02, 3.86, 4.02, 4.23, 4.5, 4.13, 4.02, 4.39, 3.16, 3.96, 3.8, 4.34, 4.77, 4.07, 4.39, 4.29, 4.5, 4.39, 4.39, 4.45, 4.34, 3.91, 4.34, 4.07, 3.75, 3.75, 3.59, 4.02, 3.37, 4.5, 4.61, 4.29, 3.86, 4.82, 4.18, 4.29, 3.75, 4.23, 4.07, 3.48, 4.45, 4.23, 3.7, 3.91, 4.18, 4.45, 4.23, 4.13, 4.5, 5.09, 4.02, 4.66]
[rank1]:2025-10-29 06:45:39,424 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:45:39,523 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0645_stage3_final2400.svg
[rank3]:2025-10-29 06:45:39,750 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank3_stage3.svg
[rank3]:	> Counts Sum: 79600, Total Sum: 4846400 (1.64%), Ratio(%) per element: [1.18, 1.55, 1.6, 1.66, 1.82, 1.98, 1.66, 1.82, 1.77, 1.55, 1.28, 1.77, 1.66, 1.23, 1.66, 1.55, 1.55, 1.44, 1.6, 1.6, 1.44, 1.82, 1.77, 2.09, 1.55, 1.6, 1.77, 1.5, 1.66, 1.71, 1.55, 1.77, 1.5, 1.93, 1.71, 1.66, 1.5, 1.44, 1.6, 1.18, 1.77, 1.44, 1.77, 1.6, 1.5, 1.87, 2.14, 1.82, 1.87, 1.87, 1.93, 2.14, 1.55, 1.71, 1.34, 1.93, 1.34, 1.66, 1.87, 1.77, 1.28, 1.5, 1.12, 1.71, 1.28]
[rank3]:2025-10-29 06:45:39,751 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–‡â–‡â–‡â–ˆâ–‡â–ˆâ–â–â–â–â–â–â–â–‚â–‚â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.68832
[rank3]:wandb:               final/avg_loss 0.11356
[rank3]:wandb:             final/avg_mfu(%) 45.10672
[rank3]:wandb:             final/avg_tflops 452.61184
[rank3]:wandb:    final/avg_throughput(tps) 9704.33707
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11356
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11356
[rank3]:wandb: loss_metrics/global_max_loss 0.11356
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2224xvmg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_fullrand7_dm1/20251029-0533/wandb/run-20251029_053307-2224xvmg/logs
[rank0]:2025-10-29 06:45:41,405 - INFO - Training completed
[rank0]:2025-10-29 06:45:41,405 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 06:45:41,601 - INFO - Process group destroyed
[rank2]:2025-10-29 06:45:41,630 - INFO - Process group destroyed
[rank0]:2025-10-29 06:45:41,631 - INFO - Process group destroyed
[rank3]:2025-10-29 06:45:41,699 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.4', 'layers.1', 'layers.7', 'layers.6', 'layers.3', 'layers.0', 'layers.2', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.24', 'layers.19', 'layers.22', 'layers.18', 'layers.23', 'layers.20', 'layers.17'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.16', 'layers.9', 'layers.10', 'layers.12', 'layers.11', 'layers.15', 'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.27', 'layers.25', 'layers.26', 'layers.31', 'norm', 'output', 'layers.30', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
