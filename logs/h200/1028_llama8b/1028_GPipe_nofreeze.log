
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Oct 28 22:49:42 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] 
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] *****************************************
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-28 22:49:49,782 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-28 22:49:49,780 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-28 22:49:49,803 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-28 22:49:49,726 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-28 22:49:50,751 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 22:49:50,754 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:50,823 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 22:49:50,826 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:50,831 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 22:49:50,826 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 22:49:50,829 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 22:49:50,827 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 22:49:50,829 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:52,661 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 22:49:52,946 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank3]:
[rank3]:Generating train split:   0%|          | 0/24887 [00:00<?, ? examples/s][rank3]:
[rank3]:Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24887/24887 [00:01<00:00, 20249.92 examples/s]
[rank3]:Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24887/24887 [00:01<00:00, 20237.90 examples/s]
[rank0]:2025-10-28 22:50:02,667 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 22:50:04,307 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-28 22:50:04,565 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-28 22:50:04,579 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-28 22:50:04,585 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-28 22:50:04,661 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-28 22:50:04,662 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 22:50:04,666 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-28 22:50:04,690 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-28 22:50:04,690 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-28 22:50:04,693 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-28 22:50:04,694 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-28 22:50:04,971 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-28 22:50:04,971 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-28 22:50:05,016 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-28 22:50:05,016 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-28 22:50:05,020 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-28 22:50:05,021 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run h40tt1xa
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1/20251028-2250/wandb/run-20251028_225005-h40tt1xa
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/h40tt1xa
[rank3]:2025-10-28 22:50:06,602 - INFO - WandB logging enabled
[rank3]:2025-10-28 22:50:06,603 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-28 22:50:06,676 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-28 22:50:06,676 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-28 22:50:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-28 22:50:06,847 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-28 22:50:06,848 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-28 22:50:06,859 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-28 22:50:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-28 22:50:06,870 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank0]:2025-10-28 22:50:06,870 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-28 22:50:06,870 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-28 22:50:09,325 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-28 22:50:09,325 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-28 22:50:19,886 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-28 22:50:19,887 - INFO - Finished loading the checkpoint in 10.56 seconds.
[rank0]:2025-10-28 22:50:19,887 - INFO - Training starts at step 1
[rank1]:2025-10-28 22:50:24,330 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 49.69GiB(35.54%)  tps: 833  tflops: 38.87  mfu: 3.93%
[rank1]:2025-10-28 22:50:24,330 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:50:24,333 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.4101  memory: 58.03GiB(41.50%)  tps: 927  tflops: 43.22  mfu: 4.37%
[rank3]:2025-10-28 22:50:24,333 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 22:50:24,330 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 44.28GiB(31.67%)  tps: 832  tflops: 38.80  mfu: 3.92%
[rank2]:2025-10-28 22:50:24,330 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 22:50:24,350 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 49.75GiB(35.58%)  tps: 832  tflops: 38.82  mfu: 3.93%
[rank0]:2025-10-28 22:50:24,350 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:50:42,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,846 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,846 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,892 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:52:33,850 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 22:52:36,568 - INFO -  step: 50  loss:  3.2236  grad_norm: 16.3336  memory: 73.38GiB(52.48%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank0]:2025-10-28 22:52:36,570 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 66.72GiB(47.72%)  tps: 6,072  tflops: 283.19  mfu: 28.63%
[rank1]:2025-10-28 22:52:36,566 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 64.32GiB(46.00%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank2]:2025-10-28 22:52:36,563 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 57.29GiB(40.97%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank3]:2025-10-28 22:52:37,028 - INFO - Avg. fwd time: 14.7696 / Avg. bwd time: 42.9832 / Avg. batch time: 482.3891 (ms) / GPU bubble ratio: 4.22%
[rank1]:2025-10-28 22:52:37,125 - INFO - Avg. fwd time: 15.1546 / Avg. bwd time: 40.8205 / Avg. batch time: 595.1324 (ms) / GPU bubble ratio: 24.76%
[rank2]:2025-10-28 22:52:37,079 - INFO - Avg. fwd time: 13.3788 / Avg. bwd time: 36.4166 / Avg. batch time: 535.5559 (ms) / GPU bubble ratio: 25.62%
[rank0]:2025-10-28 22:52:37,158 - INFO - Avg. fwd time: 14.0659 / Avg. bwd time: 38.2517 / Avg. batch time: 650.5830 (ms) / GPU bubble ratio: 35.67%
[rank0]:2025-10-28 22:54:48,574 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 22:54:51,287 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 64.32GiB(46.00%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 22:54:51,289 - INFO -  step: 100  loss:  1.0432  grad_norm:  5.4804  memory: 73.38GiB(52.48%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank0]:2025-10-28 22:54:51,291 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 66.72GiB(47.72%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank2]:2025-10-28 22:54:51,284 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 57.29GiB(40.97%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 22:54:51,488 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2254_real_step100_rank3.svg
[rank3]:> Batch Time: 630.94 ms, GPU Bubble Ratio: 33.52%, 28.37%, 36.39%, 26.30%
[rank3]:2025-10-28 22:54:51,899 - INFO - Avg. fwd time: 14.7994 / Avg. bwd time: 43.1026 / Avg. batch time: 480.8920 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-28 22:54:51,949 - INFO - Avg. fwd time: 13.4005 / Avg. bwd time: 36.5233 / Avg. batch time: 533.9076 (ms) / GPU bubble ratio: 25.19%
[rank1]:2025-10-28 22:54:51,995 - INFO - Avg. fwd time: 15.1934 / Avg. bwd time: 41.0312 / Avg. batch time: 593.4770 (ms) / GPU bubble ratio: 24.21%
[rank0]:2025-10-28 22:54:52,028 - INFO - Avg. fwd time: 13.9696 / Avg. bwd time: 38.3515 / Avg. batch time: 648.8791 (ms) / GPU bubble ratio: 35.49%
[rank0]:2025-10-28 22:57:03,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 22:57:06,125 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank3]:2025-10-28 22:57:06,130 - INFO -  step: 150  loss:  0.9229  grad_norm:  0.5022  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.36  mfu: 28.65%
[rank1]:2025-10-28 22:57:06,128 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank0]:2025-10-28 22:57:06,132 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank2]:2025-10-28 22:57:06,723 - INFO - Avg. fwd time: 13.4026 / Avg. bwd time: 36.5584 / Avg. batch time: 533.5594 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-28 22:57:06,681 - INFO - Avg. fwd time: 14.7953 / Avg. bwd time: 43.1385 / Avg. batch time: 480.3348 (ms) / GPU bubble ratio: 3.51%
[rank1]:2025-10-28 22:57:06,769 - INFO - Avg. fwd time: 15.2123 / Avg. bwd time: 41.1018 / Avg. batch time: 593.1583 (ms) / GPU bubble ratio: 24.05%
[rank0]:2025-10-28 22:57:06,811 - INFO - Avg. fwd time: 13.9471 / Avg. bwd time: 38.3775 / Avg. batch time: 648.5499 (ms) / GPU bubble ratio: 35.46%
[rank0]:2025-10-28 22:59:18,071 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 22:59:20,787 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 64.32GiB(46.00%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank1]:2025-10-28 22:59:20,787 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 22:59:20,790 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 66.72GiB(47.72%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank0]:2025-10-28 22:59:20,791 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-28 22:59:20,784 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 57.29GiB(40.97%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank2]:2025-10-28 22:59:20,784 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 22:59:20,788 - INFO -  step: 200  loss:  0.9315  grad_norm:  0.5123  memory: 73.38GiB(52.48%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank3]:2025-10-28 22:59:20,789 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-28 22:59:36,648 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 25,824
[rank0]:2025-10-28 22:59:36,618 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 25,880
[rank2]:2025-10-28 22:59:36,661 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 25,799
[rank3]:2025-10-28 22:59:36,676 - INFO - validate step: 200  loss:  0.2364  memory: 73.38GiB(52.48%)  tps: 25,783
[rank3]:2025-10-28 22:59:36,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2259_real_step200_rank3.svg
[rank3]:> Batch Time: 630.86 ms, GPU Bubble Ratio: 33.46%, 28.21%, 36.34%, 26.33%
[rank3]:2025-10-28 22:59:37,276 - INFO - Avg. fwd time: 14.7872 / Avg. bwd time: 43.1262 / Avg. batch time: 479.8219 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-28 22:59:37,373 - INFO - Avg. fwd time: 15.2348 / Avg. bwd time: 41.1667 / Avg. batch time: 592.7018 (ms) / GPU bubble ratio: 23.87%
[rank2]:2025-10-28 22:59:37,326 - INFO - Avg. fwd time: 13.4239 / Avg. bwd time: 36.6094 / Avg. batch time: 533.0315 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-10-28 22:59:37,406 - INFO - Avg. fwd time: 13.9402 / Avg. bwd time: 38.3962 / Avg. batch time: 648.0985 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-28 23:01:48,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 23:01:51,236 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 57.29GiB(40.97%)  tps: 6,087  tflops: 283.91  mfu: 28.71%
[rank3]:2025-10-28 23:01:51,241 - INFO -  step: 250  loss:  0.9241  grad_norm:  0.4044  memory: 73.38GiB(52.48%)  tps: 6,088  tflops: 283.94  mfu: 28.71%
[rank1]:2025-10-28 23:01:51,239 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 64.32GiB(46.00%)  tps: 6,087  tflops: 283.88  mfu: 28.70%
[rank0]:2025-10-28 23:01:51,243 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 66.72GiB(47.72%)  tps: 6,085  tflops: 283.81  mfu: 28.70%
[rank3]:2025-10-28 23:01:51,701 - INFO - Avg. fwd time: 14.7829 / Avg. bwd time: 43.0879 / Avg. batch time: 479.2327 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-28 23:01:51,751 - INFO - Avg. fwd time: 13.4316 / Avg. bwd time: 36.6281 / Avg. batch time: 532.5514 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-10-28 23:01:51,797 - INFO - Avg. fwd time: 15.2721 / Avg. bwd time: 41.2535 / Avg. batch time: 592.3393 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-28 23:01:51,830 - INFO - Avg. fwd time: 13.9534 / Avg. bwd time: 38.4244 / Avg. batch time: 647.7661 (ms) / GPU bubble ratio: 35.31%
[rank0]:2025-10-28 23:04:03,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:04:05,956 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 64.32GiB(46.00%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 23:04:05,958 - INFO -  step: 300  loss:  0.8420  grad_norm:  0.4258  memory: 73.38GiB(52.48%)  tps: 6,081  tflops: 283.62  mfu: 28.68%
[rank2]:2025-10-28 23:04:05,954 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 57.29GiB(40.97%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank0]:2025-10-28 23:04:05,961 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 66.72GiB(47.72%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 23:04:06,140 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2304_real_step300_rank3.svg
[rank3]:> Batch Time: 630.70 ms, GPU Bubble Ratio: 33.35%, 27.98%, 36.29%, 26.39%
[rank3]:2025-10-28 23:04:06,637 - INFO - Avg. fwd time: 14.7864 / Avg. bwd time: 43.0847 / Avg. batch time: 479.0770 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-10-28 23:04:06,680 - INFO - Avg. fwd time: 13.4362 / Avg. bwd time: 36.6382 / Avg. batch time: 532.4574 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-28 23:04:06,726 - INFO - Avg. fwd time: 15.2939 / Avg. bwd time: 41.3033 / Avg. batch time: 592.3087 (ms) / GPU bubble ratio: 23.56%
[rank0]:2025-10-28 23:04:06,770 - INFO - Avg. fwd time: 13.9609 / Avg. bwd time: 38.4399 / Avg. batch time: 647.7533 (ms) / GPU bubble ratio: 35.28%
[rank0]:2025-10-28 23:06:18,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:06:21,078 - INFO -  step: 350  loss:  0.8813  grad_norm:  0.4043  memory: 73.38GiB(52.48%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank1]:2025-10-28 23:06:21,076 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 64.32GiB(46.00%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank2]:2025-10-28 23:06:21,074 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 57.29GiB(40.97%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank0]:2025-10-28 23:06:21,080 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 66.72GiB(47.72%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank3]:2025-10-28 23:06:21,545 - INFO - Avg. fwd time: 14.7949 / Avg. bwd time: 43.1103 / Avg. batch time: 479.2545 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-28 23:06:21,595 - INFO - Avg. fwd time: 13.4449 / Avg. bwd time: 36.6411 / Avg. batch time: 532.5908 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-28 23:06:21,641 - INFO - Avg. fwd time: 15.3015 / Avg. bwd time: 41.3135 / Avg. batch time: 592.4425 (ms) / GPU bubble ratio: 23.55%
[rank0]:2025-10-28 23:06:21,674 - INFO - Avg. fwd time: 13.9616 / Avg. bwd time: 38.4423 / Avg. batch time: 647.8864 (ms) / GPU bubble ratio: 35.29%
[rank0]:2025-10-28 23:08:32,225 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:08:34,848 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 64.32GiB(46.00%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank3]:2025-10-28 23:08:34,850 - INFO -  step: 400  loss:  0.1093  grad_norm:  0.1434  memory: 73.38GiB(52.48%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank1]:2025-10-28 23:08:34,848 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 23:08:34,851 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-28 23:08:34,846 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 57.29GiB(40.97%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank2]:2025-10-28 23:08:34,846 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 23:08:34,852 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 66.72GiB(47.72%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank0]:2025-10-28 23:08:34,852 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 23:08:49,842 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,326
[rank3]:2025-10-28 23:08:49,917 - INFO - validate step: 400  loss:  0.2384  memory: 73.38GiB(52.48%)  tps: 27,189
[rank1]:2025-10-28 23:08:49,871 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,265
[rank2]:2025-10-28 23:08:49,898 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,212
[rank3]:2025-10-28 23:08:50,100 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2308_real_step400_rank3.svg
[rank3]:> Batch Time: 630.98 ms, GPU Bubble Ratio: 33.40%, 28.01%, 36.32%, 26.37%
[rank3]:2025-10-28 23:08:50,489 - INFO - Avg. fwd time: 14.7800 / Avg. bwd time: 43.1086 / Avg. batch time: 479.0330 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-28 23:08:50,540 - INFO - Avg. fwd time: 13.4325 / Avg. bwd time: 36.6310 / Avg. batch time: 532.3007 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-28 23:08:50,585 - INFO - Avg. fwd time: 15.2859 / Avg. bwd time: 41.3024 / Avg. batch time: 592.1138 (ms) / GPU bubble ratio: 23.54%
[rank0]:2025-10-28 23:08:50,618 - INFO - Avg. fwd time: 13.9428 / Avg. bwd time: 38.4328 / Avg. batch time: 647.5345 (ms) / GPU bubble ratio: 35.29%
[rank0]:2025-10-28 23:10:56,912 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:10:59,511 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 64.32GiB(46.00%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank2]:2025-10-28 23:10:59,509 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 57.29GiB(40.97%)  tps: 6,320  tflops: 294.79  mfu: 29.81%
[rank3]:2025-10-28 23:10:59,514 - INFO -  step: 450  loss:  0.1187  grad_norm:  0.3102  memory: 73.38GiB(52.48%)  tps: 6,321  tflops: 294.82  mfu: 29.81%
[rank0]:2025-10-28 23:10:59,515 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.65  mfu: 29.79%
[rank3]:2025-10-28 23:11:00,035 - INFO - Avg. fwd time: 14.6850 / Avg. bwd time: 43.0182 / Avg. batch time: 477.4625 (ms) / GPU bubble ratio: 3.32%
[rank1]:2025-10-28 23:11:00,123 - INFO - Avg. fwd time: 15.2045 / Avg. bwd time: 41.2480 / Avg. batch time: 590.3499 (ms) / GPU bubble ratio: 23.50%
[rank2]:2025-10-28 23:11:00,078 - INFO - Avg. fwd time: 13.3570 / Avg. bwd time: 36.5811 / Avg. batch time: 530.6510 (ms) / GPU bubble ratio: 24.71%
[rank0]:2025-10-28 23:11:00,167 - INFO - Avg. fwd time: 13.8588 / Avg. bwd time: 38.3909 / Avg. batch time: 645.6701 (ms) / GPU bubble ratio: 35.26%
[rank0]:2025-10-28 23:13:06,420 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 23:13:09,009 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 57.29GiB(40.97%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank1]:2025-10-28 23:13:09,011 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 64.32GiB(46.00%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank3]:2025-10-28 23:13:09,013 - INFO -  step: 500  loss:  0.1215  grad_norm:  0.1729  memory: 73.38GiB(52.48%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank0]:2025-10-28 23:13:09,015 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 66.72GiB(47.72%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank3]:2025-10-28 23:13:09,196 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2313_real_step500_rank3.svg
[rank3]:> Batch Time: 629.04 ms, GPU Bubble Ratio: 33.35%, 28.00%, 36.30%, 26.40%
[rank2]:2025-10-28 23:13:09,630 - INFO - Avg. fwd time: 13.3035 / Avg. bwd time: 36.5493 / Avg. batch time: 529.4184 (ms) / GPU bubble ratio: 24.67%
[rank3]:2025-10-28 23:13:09,581 - INFO - Avg. fwd time: 14.6178 / Avg. bwd time: 42.9522 / Avg. batch time: 476.3364 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-10-28 23:13:09,676 - INFO - Avg. fwd time: 15.1473 / Avg. bwd time: 41.2100 / Avg. batch time: 589.0374 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-10-28 23:13:09,708 - INFO - Avg. fwd time: 13.8002 / Avg. bwd time: 38.3640 / Avg. batch time: 644.2942 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-28 23:15:16,088 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:15:18,696 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank2]:2025-10-28 23:15:18,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank3]:2025-10-28 23:15:18,694 - INFO -  step: 550  loss:  0.1341  grad_norm:  0.1360  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank1]:2025-10-28 23:15:18,692 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank3]:2025-10-28 23:15:19,127 - INFO - Avg. fwd time: 14.5581 / Avg. bwd time: 42.8924 / Avg. batch time: 475.3240 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-28 23:15:19,176 - INFO - Avg. fwd time: 13.2561 / Avg. bwd time: 36.5181 / Avg. batch time: 528.3635 (ms) / GPU bubble ratio: 24.64%
[rank1]:2025-10-28 23:15:19,222 - INFO - Avg. fwd time: 15.0955 / Avg. bwd time: 41.1755 / Avg. batch time: 587.9065 (ms) / GPU bubble ratio: 23.43%
[rank0]:2025-10-28 23:15:19,254 - INFO - Avg. fwd time: 13.7460 / Avg. bwd time: 38.3402 / Avg. batch time: 643.1072 (ms) / GPU bubble ratio: 35.21%
[rank0]:2025-10-28 23:17:25,648 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:17:28,255 - INFO -  step: 600  loss:  0.0983  grad_norm:  0.0999  memory: 73.38GiB(52.48%)  tps: 6,323  tflops: 294.91  mfu: 29.82%
[rank3]:2025-10-28 23:17:28,255 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-28 23:17:28,250 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 57.29GiB(40.97%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank2]:2025-10-28 23:17:28,250 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 23:17:28,252 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 64.32GiB(46.00%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank1]:2025-10-28 23:17:28,252 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 23:17:28,256 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 66.72GiB(47.72%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank0]:2025-10-28 23:17:28,257 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 23:17:43,186 - INFO - validate step: 600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,428
[rank0]:2025-10-28 23:17:43,156 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,491
[rank3]:2025-10-28 23:17:43,224 - INFO - validate step: 600  loss:  0.2432  memory: 73.38GiB(52.48%)  tps: 27,365
[rank2]:2025-10-28 23:17:43,207 - INFO - validate step: 600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,386
[rank3]:2025-10-28 23:17:43,416 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2317_real_step600_rank3.svg
[rank3]:> Batch Time: 627.01 ms, GPU Bubble Ratio: 33.30%, 27.97%, 36.25%, 26.43%
[rank3]:2025-10-28 23:17:43,893 - INFO - Avg. fwd time: 14.5078 / Avg. bwd time: 42.8429 / Avg. batch time: 474.4794 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-28 23:17:43,936 - INFO - Avg. fwd time: 13.2147 / Avg. bwd time: 36.4949 / Avg. batch time: 527.4885 (ms) / GPU bubble ratio: 24.61%
[rank1]:2025-10-28 23:17:43,983 - INFO - Avg. fwd time: 15.0470 / Avg. bwd time: 41.1447 / Avg. batch time: 586.9658 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-10-28 23:17:44,027 - INFO - Avg. fwd time: 13.6979 / Avg. bwd time: 38.3175 / Avg. batch time: 642.1153 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-28 23:19:50,466 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 23:19:53,063 - INFO -  step: 650  loss:  0.0902  grad_norm:  0.1144  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.27  mfu: 29.75%
[rank1]:2025-10-28 23:19:53,060 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank2]:2025-10-28 23:19:53,058 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.24  mfu: 29.75%
[rank0]:2025-10-28 23:19:53,065 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.11  mfu: 29.74%
[rank3]:2025-10-28 23:19:53,497 - INFO - Avg. fwd time: 14.4752 / Avg. bwd time: 42.8103 / Avg. batch time: 473.9241 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:19:53,592 - INFO - Avg. fwd time: 15.0162 / Avg. bwd time: 41.1248 / Avg. batch time: 586.2965 (ms) / GPU bubble ratio: 23.40%
[rank2]:2025-10-28 23:19:53,547 - INFO - Avg. fwd time: 13.1866 / Avg. bwd time: 36.4772 / Avg. batch time: 526.8665 (ms) / GPU bubble ratio: 24.59%
[rank0]:2025-10-28 23:19:53,624 - INFO - Avg. fwd time: 13.6629 / Avg. bwd time: 38.3006 / Avg. batch time: 641.4073 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-28 23:22:00,063 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:22:02,679 - INFO -  step: 700  loss:  0.1095  grad_norm:  0.1308  memory: 73.38GiB(52.48%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank2]:2025-10-28 23:22:02,674 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 57.29GiB(40.97%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank1]:2025-10-28 23:22:02,677 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 64.32GiB(46.00%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank0]:2025-10-28 23:22:02,681 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 66.72GiB(47.72%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank3]:2025-10-28 23:22:02,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2322_real_step700_rank3.svg
[rank3]:> Batch Time: 624.79 ms, GPU Bubble Ratio: 33.25%, 27.93%, 36.20%, 26.47%
[rank2]:2025-10-28 23:22:03,304 - INFO - Avg. fwd time: 13.1568 / Avg. bwd time: 36.4597 / Avg. batch time: 526.1862 (ms) / GPU bubble ratio: 24.56%
[rank3]:2025-10-28 23:22:03,255 - INFO - Avg. fwd time: 14.4391 / Avg. bwd time: 42.7743 / Avg. batch time: 473.3141 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:22:03,350 - INFO - Avg. fwd time: 14.9794 / Avg. bwd time: 41.1010 / Avg. batch time: 585.5654 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-28 23:22:03,382 - INFO - Avg. fwd time: 13.6245 / Avg. bwd time: 38.2815 / Avg. batch time: 640.6324 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:24:09,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:24:12,327 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 66.72GiB(47.72%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank1]:2025-10-28 23:24:12,323 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 64.32GiB(46.00%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-28 23:24:12,321 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 57.29GiB(40.97%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank3]:2025-10-28 23:24:12,325 - INFO -  step: 750  loss:  0.1419  grad_norm:  0.1559  memory: 73.38GiB(52.48%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-28 23:24:12,897 - INFO - Avg. fwd time: 13.1302 / Avg. bwd time: 36.4425 / Avg. batch time: 525.6397 (ms) / GPU bubble ratio: 24.55%
[rank3]:2025-10-28 23:24:12,852 - INFO - Avg. fwd time: 14.4068 / Avg. bwd time: 42.7437 / Avg. batch time: 472.7810 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:24:12,944 - INFO - Avg. fwd time: 14.9452 / Avg. bwd time: 41.0782 / Avg. batch time: 584.9705 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-28 23:24:12,988 - INFO - Avg. fwd time: 13.5929 / Avg. bwd time: 38.2644 / Avg. batch time: 640.0055 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:26:19,375 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:26:22,010 - INFO -  step: 800  loss:  0.1190  grad_norm:  0.1343  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank3]:2025-10-28 23:26:22,011 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-28 23:26:22,005 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank2]:2025-10-28 23:26:22,006 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 23:26:22,008 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank1]:2025-10-28 23:26:22,008 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 23:26:22,012 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank0]:2025-10-28 23:26:22,012 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 23:26:37,019 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,294
[rank2]:2025-10-28 23:26:37,074 - INFO - validate step: 800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,184
[rank3]:2025-10-28 23:26:37,091 - INFO - validate step: 800  loss:  0.2471  memory: 73.38GiB(52.48%)  tps: 27,162
[rank1]:2025-10-28 23:26:37,049 - INFO - validate step: 800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,233
[rank3]:2025-10-28 23:26:37,278 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2326_real_step800_rank3.svg
[rank3]:> Batch Time: 622.91 ms, GPU Bubble Ratio: 33.20%, 27.89%, 36.18%, 26.49%
[rank2]:2025-10-28 23:26:37,723 - INFO - Avg. fwd time: 13.1100 / Avg. bwd time: 36.4307 / Avg. batch time: 525.2040 (ms) / GPU bubble ratio: 24.54%
[rank3]:2025-10-28 23:26:37,673 - INFO - Avg. fwd time: 14.3821 / Avg. bwd time: 42.7226 / Avg. batch time: 472.3924 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:26:37,769 - INFO - Avg. fwd time: 14.9209 / Avg. bwd time: 41.0649 / Avg. batch time: 584.5009 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-28 23:26:37,801 - INFO - Avg. fwd time: 13.5684 / Avg. bwd time: 38.2547 / Avg. batch time: 639.5143 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-28 23:28:44,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:28:46,918 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.20  mfu: 29.75%
[rank2]:2025-10-28 23:28:46,915 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.26  mfu: 29.75%
[rank3]:2025-10-28 23:28:46,921 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.1056  memory: 73.38GiB(52.48%)  tps: 6,310  tflops: 294.30  mfu: 29.76%
[rank0]:2025-10-28 23:28:46,922 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank2]:2025-10-28 23:28:47,397 - INFO - Avg. fwd time: 13.0941 / Avg. bwd time: 36.4222 / Avg. batch time: 524.8303 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-28 23:28:47,348 - INFO - Avg. fwd time: 14.3602 / Avg. bwd time: 42.7009 / Avg. batch time: 472.0216 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-10-28 23:28:47,476 - INFO - Avg. fwd time: 13.5447 / Avg. bwd time: 38.2439 / Avg. batch time: 639.0870 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-28 23:28:47,444 - INFO - Avg. fwd time: 14.9001 / Avg. bwd time: 41.0535 / Avg. batch time: 584.0995 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-28 23:30:53,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:30:56,125 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 64.32GiB(46.00%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank2]:2025-10-28 23:30:56,122 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 57.29GiB(40.97%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank3]:2025-10-28 23:30:56,127 - INFO -  step: 900  loss:  0.1272  grad_norm:  0.1407  memory: 73.38GiB(52.48%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank0]:2025-10-28 23:30:56,129 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 66.72GiB(47.72%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank3]:2025-10-28 23:30:56,313 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2330_real_step900_rank3.svg
[rank3]:> Batch Time: 621.51 ms, GPU Bubble Ratio: 33.18%, 27.82%, 36.14%, 26.53%
[rank2]:2025-10-28 23:30:56,823 - INFO - Avg. fwd time: 13.0776 / Avg. bwd time: 36.4151 / Avg. batch time: 524.3267 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-10-28 23:30:56,781 - INFO - Avg. fwd time: 14.3368 / Avg. bwd time: 42.6644 / Avg. batch time: 471.5218 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:30:56,871 - INFO - Avg. fwd time: 14.8827 / Avg. bwd time: 41.0564 / Avg. batch time: 583.6051 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-28 23:30:56,915 - INFO - Avg. fwd time: 13.5241 / Avg. bwd time: 38.2374 / Avg. batch time: 638.5735 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-28 23:33:02,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:33:05,582 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 66.72GiB(47.72%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank2]:2025-10-28 23:33:05,575 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 57.29GiB(40.97%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank1]:2025-10-28 23:33:05,578 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 64.32GiB(46.00%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank3]:2025-10-28 23:33:05,581 - INFO -  step: 950  loss:  0.1548  grad_norm:  0.1471  memory: 73.38GiB(52.48%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank3]:2025-10-28 23:33:06,015 - INFO - Avg. fwd time: 14.3198 / Avg. bwd time: 42.6362 / Avg. batch time: 471.1446 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:33:06,064 - INFO - Avg. fwd time: 13.0659 / Avg. bwd time: 36.4093 / Avg. batch time: 523.9177 (ms) / GPU bubble ratio: 24.45%
[rank1]:2025-10-28 23:33:06,109 - INFO - Avg. fwd time: 14.8726 / Avg. bwd time: 41.0603 / Avg. batch time: 583.2041 (ms) / GPU bubble ratio: 23.28%
[rank0]:2025-10-28 23:33:06,143 - INFO - Avg. fwd time: 13.5091 / Avg. bwd time: 38.2335 / Avg. batch time: 638.1618 (ms) / GPU bubble ratio: 35.14%
[rank0]:2025-10-28 23:35:12,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:35:15,246 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 64.32GiB(46.00%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank1]:2025-10-28 23:35:15,246 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-28 23:35:15,243 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 57.29GiB(40.97%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank2]:2025-10-28 23:35:15,243 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 23:35:15,248 - INFO -  step: 1000  loss:  0.1276  grad_norm:  0.1068  memory: 73.38GiB(52.48%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank3]:2025-10-28 23:35:15,249 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 23:35:15,250 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 66.72GiB(47.72%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank0]:2025-10-28 23:35:15,250 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 23:35:30,152 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,488
[rank2]:2025-10-28 23:35:30,205 - INFO - validate step: 1000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,377
[rank1]:2025-10-28 23:35:30,183 - INFO - validate step: 1000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,422
[rank3]:2025-10-28 23:35:30,224 - INFO - validate step: 1000  loss:  0.2472  memory: 73.38GiB(52.48%)  tps: 27,353
[rank3]:2025-10-28 23:35:30,421 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2335_real_step1000_rank3.svg
[rank3]:> Batch Time: 620.34 ms, GPU Bubble Ratio: 33.16%, 27.74%, 36.10%, 26.56%
[rank2]:2025-10-28 23:35:30,858 - INFO - Avg. fwd time: 13.0515 / Avg. bwd time: 36.4025 / Avg. batch time: 523.5834 (ms) / GPU bubble ratio: 24.44%
[rank3]:2025-10-28 23:35:30,809 - INFO - Avg. fwd time: 14.3010 / Avg. bwd time: 42.6198 / Avg. batch time: 470.8462 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:35:30,904 - INFO - Avg. fwd time: 14.8572 / Avg. bwd time: 41.0577 / Avg. batch time: 582.8563 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-10-28 23:35:30,937 - INFO - Avg. fwd time: 13.4913 / Avg. bwd time: 38.2266 / Avg. batch time: 637.8021 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:37:37,471 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 23:37:40,083 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 66.72GiB(47.72%)  tps: 6,305  tflops: 294.06  mfu: 29.73%
[rank2]:2025-10-28 23:37:40,076 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 57.29GiB(40.97%)  tps: 6,308  tflops: 294.20  mfu: 29.75%
[rank1]:2025-10-28 23:37:40,079 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 64.32GiB(46.00%)  tps: 6,307  tflops: 294.14  mfu: 29.74%
[rank3]:2025-10-28 23:37:40,081 - INFO -  step: 1050  loss:  0.1321  grad_norm:  0.1188  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.23  mfu: 29.75%
[rank3]:2025-10-28 23:37:40,606 - INFO - Avg. fwd time: 14.2859 / Avg. bwd time: 42.6064 / Avg. batch time: 470.6035 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:37:40,651 - INFO - Avg. fwd time: 13.0391 / Avg. bwd time: 36.3946 / Avg. batch time: 523.3398 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-10-28 23:37:40,699 - INFO - Avg. fwd time: 14.8417 / Avg. bwd time: 41.0505 / Avg. batch time: 582.5934 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-10-28 23:37:40,746 - INFO - Avg. fwd time: 13.4749 / Avg. bwd time: 38.2196 / Avg. batch time: 637.5252 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:39:47,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:39:49,845 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-28 23:39:49,847 - INFO -  step: 1100  loss:  0.1014  grad_norm:  0.0931  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank2]:2025-10-28 23:39:49,843 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank0]:2025-10-28 23:39:49,849 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-28 23:39:50,042 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2339_real_step1100_rank3.svg
[rank3]:> Batch Time: 619.63 ms, GPU Bubble Ratio: 33.16%, 27.72%, 36.10%, 26.57%
[rank3]:2025-10-28 23:39:50,431 - INFO - Avg. fwd time: 14.2743 / Avg. bwd time: 42.5967 / Avg. batch time: 470.4218 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:39:50,526 - INFO - Avg. fwd time: 14.8305 / Avg. bwd time: 41.0426 / Avg. batch time: 582.3648 (ms) / GPU bubble ratio: 23.25%
[rank2]:2025-10-28 23:39:50,480 - INFO - Avg. fwd time: 13.0300 / Avg. bwd time: 36.3888 / Avg. batch time: 523.1322 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-10-28 23:39:50,559 - INFO - Avg. fwd time: 13.4634 / Avg. bwd time: 38.2133 / Avg. batch time: 637.2880 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:41:57,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:41:59,723 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 66.72GiB(47.72%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank1]:2025-10-28 23:41:59,719 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank3]:2025-10-28 23:41:59,721 - INFO -  step: 1150  loss:  0.1214  grad_norm:  0.1185  memory: 73.38GiB(52.48%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank2]:2025-10-28 23:41:59,716 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 57.29GiB(40.97%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank3]:2025-10-28 23:42:00,166 - INFO - Avg. fwd time: 14.2624 / Avg. bwd time: 42.5866 / Avg. batch time: 470.2337 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-28 23:42:00,261 - INFO - Avg. fwd time: 14.8174 / Avg. bwd time: 41.0339 / Avg. batch time: 582.1550 (ms) / GPU bubble ratio: 23.25%
[rank2]:2025-10-28 23:42:00,215 - INFO - Avg. fwd time: 13.0198 / Avg. bwd time: 36.3819 / Avg. batch time: 522.9442 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-10-28 23:42:00,294 - INFO - Avg. fwd time: 13.4508 / Avg. bwd time: 38.2065 / Avg. batch time: 637.0661 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:44:06,782 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:44:09,412 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank0]:2025-10-28 23:44:09,412 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 23:44:09,410 - INFO -  step: 1200  loss:  0.1043  grad_norm:  0.0961  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank3]:2025-10-28 23:44:09,410 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 23:44:09,408 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank1]:2025-10-28 23:44:09,408 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 23:44:09,405 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank2]:2025-10-28 23:44:09,405 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 23:44:24,338 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,444
[rank0]:2025-10-28 23:44:24,338 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 23:44:24,342 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-28 23:44:24,367 - INFO - validate step: 1200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,381
[rank1]:2025-10-28 23:44:24,368 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 23:44:24,413 - INFO - validate step: 1200  loss:  0.2496  memory: 73.38GiB(52.48%)  tps: 27,304
[rank3]:2025-10-28 23:44:24,414 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 23:44:24,394 - INFO - validate step: 1200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,329
[rank2]:2025-10-28 23:44:24,394 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 23:44:37,258 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.84 seconds.
[rank0]:2025-10-28 23:44:37,984 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 23:44:37,989 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.65 seconds.
[rank2]:2025-10-28 23:44:38,932 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.54 seconds.
[rank1]:2025-10-28 23:44:39,638 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.27 seconds.
[rank1]:2025-10-28 23:44:39,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-28 23:44:39,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-28 23:44:39,705 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-28 23:44:39,941 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2344_real_step1200_rank3.svg
[rank3]:> Batch Time: 619.18 ms, GPU Bubble Ratio: 33.19%, 27.74%, 36.09%, 26.57%
[rank3]:2025-10-28 23:44:39,954 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-28 23:44:40,986 - INFO - Avg. fwd time: 14.2527 / Avg. bwd time: 42.5772 / Avg. batch time: 470.1854 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-10-28 23:44:41,082 - INFO - Avg. fwd time: 14.8061 / Avg. bwd time: 41.0255 / Avg. batch time: 582.1009 (ms) / GPU bubble ratio: 23.27%
[rank2]:2025-10-28 23:44:41,032 - INFO - Avg. fwd time: 13.0115 / Avg. bwd time: 36.3753 / Avg. batch time: 522.9101 (ms) / GPU bubble ratio: 24.44%
[rank0]:2025-10-28 23:44:41,129 - INFO - Avg. fwd time: 13.4411 / Avg. bwd time: 38.1998 / Avg. batch time: 637.0002 (ms) / GPU bubble ratio: 35.14%
[rank0]:2025-10-28 23:46:54,509 - INFO - [GC] Peforming periodical GC collection 1.84 seconds
[rank0]:2025-10-28 23:46:57,430 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 66.72GiB(47.72%)  tps: 5,351  tflops: 249.57  mfu: 25.23%
[rank1]:2025-10-28 23:46:57,426 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 64.32GiB(46.00%)  tps: 5,352  tflops: 249.63  mfu: 25.24%
[rank2]:2025-10-28 23:46:57,424 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 57.29GiB(40.97%)  tps: 5,353  tflops: 249.67  mfu: 25.25%
[rank3]:2025-10-28 23:46:57,428 - INFO -  step: 1250  loss:  0.8946  grad_norm:  0.4648  memory: 73.38GiB(52.48%)  tps: 5,354  tflops: 249.70  mfu: 25.25%
[rank3]:2025-10-28 23:46:57,895 - INFO - Avg. fwd time: 14.2732 / Avg. bwd time: 42.5990 / Avg. batch time: 470.5173 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:46:57,991 - INFO - Avg. fwd time: 14.8213 / Avg. bwd time: 41.0316 / Avg. batch time: 582.4544 (ms) / GPU bubble ratio: 23.29%
[rank2]:2025-10-28 23:46:57,945 - INFO - Avg. fwd time: 13.0268 / Avg. bwd time: 36.3859 / Avg. batch time: 523.2509 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-28 23:46:58,025 - INFO - Avg. fwd time: 13.4579 / Avg. bwd time: 38.2074 / Avg. batch time: 637.3728 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-28 23:49:09,566 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:49:12,288 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank1]:2025-10-28 23:49:12,283 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank2]:2025-10-28 23:49:12,281 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:49:12,286 - INFO -  step: 1300  loss:  0.7896  grad_norm:  0.4175  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:49:12,475 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2349_real_step1300_rank3.svg
[rank3]:> Batch Time: 620.16 ms, GPU Bubble Ratio: 33.19%, 27.77%, 36.10%, 26.55%
[rank3]:2025-10-28 23:49:12,891 - INFO - Avg. fwd time: 14.2966 / Avg. bwd time: 42.6247 / Avg. batch time: 470.9037 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:49:12,987 - INFO - Avg. fwd time: 14.8393 / Avg. bwd time: 41.0394 / Avg. batch time: 582.8860 (ms) / GPU bubble ratio: 23.31%
[rank2]:2025-10-28 23:49:12,940 - INFO - Avg. fwd time: 13.0440 / Avg. bwd time: 36.3962 / Avg. batch time: 523.6665 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-28 23:49:13,020 - INFO - Avg. fwd time: 13.4758 / Avg. bwd time: 38.2165 / Avg. batch time: 637.8317 (ms) / GPU bubble ratio: 35.16%
[rank0]:2025-10-28 23:51:24,903 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:51:27,626 - INFO -  step: 1350  loss:  0.8085  grad_norm:  0.4560  memory: 73.38GiB(52.48%)  tps: 6,053  tflops: 282.31  mfu: 28.55%
[rank0]:2025-10-28 23:51:27,628 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 66.72GiB(47.72%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank1]:2025-10-28 23:51:27,624 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 64.32GiB(46.00%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank2]:2025-10-28 23:51:27,621 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 57.29GiB(40.97%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank3]:2025-10-28 23:51:28,180 - INFO - Avg. fwd time: 14.3183 / Avg. bwd time: 42.6485 / Avg. batch time: 471.2610 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:51:28,275 - INFO - Avg. fwd time: 14.8553 / Avg. bwd time: 41.0468 / Avg. batch time: 583.2933 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-10-28 23:51:28,226 - INFO - Avg. fwd time: 13.0600 / Avg. bwd time: 36.4057 / Avg. batch time: 524.0577 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-28 23:51:28,325 - INFO - Avg. fwd time: 13.4922 / Avg. bwd time: 38.2252 / Avg. batch time: 638.2601 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:53:40,226 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:53:42,952 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 66.72GiB(47.72%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank0]:2025-10-28 23:53:42,952 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 23:53:42,948 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 64.32GiB(46.00%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank1]:2025-10-28 23:53:42,948 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 23:53:42,945 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 57.29GiB(40.97%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank2]:2025-10-28 23:53:42,945 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 23:53:42,950 - INFO -  step: 1400  loss:  0.8072  grad_norm:  0.4309  memory: 73.38GiB(52.48%)  tps: 6,054  tflops: 282.35  mfu: 28.55%
[rank3]:2025-10-28 23:53:42,950 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 23:53:57,850 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,494
[rank1]:2025-10-28 23:53:57,880 - INFO - validate step: 1400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,431
[rank2]:2025-10-28 23:53:57,907 - INFO - validate step: 1400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,377
[rank3]:2025-10-28 23:53:57,927 - INFO - validate step: 1400  loss:  0.2457  memory: 73.38GiB(52.48%)  tps: 27,350
[rank3]:2025-10-28 23:53:58,124 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2353_real_step1400_rank3.svg
[rank3]:> Batch Time: 621.27 ms, GPU Bubble Ratio: 33.20%, 27.82%, 36.14%, 26.53%
[rank3]:2025-10-28 23:53:58,544 - INFO - Avg. fwd time: 14.3354 / Avg. bwd time: 42.6683 / Avg. batch time: 471.5512 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:53:58,594 - INFO - Avg. fwd time: 13.0726 / Avg. bwd time: 36.4133 / Avg. batch time: 524.3534 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-10-28 23:53:58,672 - INFO - Avg. fwd time: 13.5060 / Avg. bwd time: 38.2321 / Avg. batch time: 638.5862 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-28 23:53:58,640 - INFO - Avg. fwd time: 14.8685 / Avg. bwd time: 41.0536 / Avg. batch time: 583.6009 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-28 23:56:10,312 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:56:13,029 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 66.72GiB(47.72%)  tps: 6,060  tflops: 282.65  mfu: 28.58%
[rank1]:2025-10-28 23:56:13,024 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.72  mfu: 28.59%
[rank2]:2025-10-28 23:56:13,022 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 57.29GiB(40.97%)  tps: 6,063  tflops: 282.78  mfu: 28.59%
[rank3]:2025-10-28 23:56:13,027 - INFO -  step: 1450  loss:  0.8387  grad_norm:  0.4641  memory: 73.38GiB(52.48%)  tps: 6,064  tflops: 282.82  mfu: 28.60%
[rank2]:2025-10-28 23:56:13,542 - INFO - Avg. fwd time: 13.0862 / Avg. bwd time: 36.4210 / Avg. batch time: 524.7065 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-28 23:56:13,492 - INFO - Avg. fwd time: 14.3546 / Avg. bwd time: 42.6901 / Avg. batch time: 471.8736 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-10-28 23:56:13,621 - INFO - Avg. fwd time: 13.5198 / Avg. bwd time: 38.2396 / Avg. batch time: 638.9690 (ms) / GPU bubble ratio: 35.20%
[rank1]:2025-10-28 23:56:13,587 - INFO - Avg. fwd time: 14.8829 / Avg. bwd time: 41.0612 / Avg. batch time: 583.9696 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-28 23:58:25,181 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:58:27,881 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank0]:2025-10-28 23:58:27,886 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank2]:2025-10-28 23:58:27,879 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:58:27,883 - INFO -  step: 1500  loss:  0.7151  grad_norm:  0.3998  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.33  mfu: 28.65%
[rank3]:2025-10-28 23:58:28,078 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2358_real_step1500_rank3.svg
[rank3]:> Batch Time: 622.26 ms, GPU Bubble Ratio: 33.23%, 27.86%, 36.16%, 26.51%
[rank2]:2025-10-28 23:58:28,624 - INFO - Avg. fwd time: 13.0995 / Avg. bwd time: 36.4296 / Avg. batch time: 525.0113 (ms) / GPU bubble ratio: 24.53%
[rank3]:2025-10-28 23:58:28,579 - INFO - Avg. fwd time: 14.3710 / Avg. bwd time: 42.7087 / Avg. batch time: 472.1481 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:58:28,673 - INFO - Avg. fwd time: 14.8959 / Avg. bwd time: 41.0682 / Avg. batch time: 584.2891 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-28 23:58:28,721 - INFO - Avg. fwd time: 13.5328 / Avg. bwd time: 38.2465 / Avg. batch time: 639.3024 (ms) / GPU bubble ratio: 35.21%
[rank0]:2025-10-29 00:00:39,935 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:00:42,647 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 66.72GiB(47.72%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank2]:2025-10-29 00:00:42,640 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 57.29GiB(40.97%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank3]:2025-10-29 00:00:42,645 - INFO -  step: 1550  loss:  0.7768  grad_norm:  0.4054  memory: 73.38GiB(52.48%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank1]:2025-10-29 00:00:42,643 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 64.32GiB(46.00%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank3]:2025-10-29 00:00:43,105 - INFO - Avg. fwd time: 14.3843 / Avg. bwd time: 42.7176 / Avg. batch time: 472.3214 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:00:43,202 - INFO - Avg. fwd time: 14.9095 / Avg. bwd time: 41.0803 / Avg. batch time: 584.4896 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-29 00:00:43,236 - INFO - Avg. fwd time: 13.5449 / Avg. bwd time: 38.2538 / Avg. batch time: 639.5160 (ms) / GPU bubble ratio: 35.20%
[rank2]:2025-10-29 00:00:43,155 - INFO - Avg. fwd time: 13.1109 / Avg. bwd time: 36.4367 / Avg. batch time: 525.1900 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-10-29 00:02:53,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:02:56,027 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 64.32GiB(46.00%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank1]:2025-10-29 00:02:56,027 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 00:02:56,031 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 66.72GiB(47.72%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank0]:2025-10-29 00:02:56,031 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 00:02:56,025 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 57.29GiB(40.97%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank2]:2025-10-29 00:02:56,025 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 00:02:56,029 - INFO -  step: 1600  loss:  0.1115  grad_norm:  0.2100  memory: 73.38GiB(52.48%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank3]:2025-10-29 00:02:56,029 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 00:03:10,955 - INFO - validate step: 1600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,439
[rank0]:2025-10-29 00:03:10,926 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,501
[rank2]:2025-10-29 00:03:10,969 - INFO - validate step: 1600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,409
[rank3]:2025-10-29 00:03:10,985 - INFO - validate step: 1600  loss:  0.2506  memory: 73.38GiB(52.48%)  tps: 27,390
[rank3]:2025-10-29 00:03:11,176 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0003_real_step1600_rank3.svg
[rank3]:> Batch Time: 623.02 ms, GPU Bubble Ratio: 33.24%, 27.87%, 36.17%, 26.50%
[rank3]:2025-10-29 00:03:11,569 - INFO - Avg. fwd time: 14.3932 / Avg. bwd time: 42.7203 / Avg. batch time: 472.4084 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:03:11,619 - INFO - Avg. fwd time: 13.1188 / Avg. bwd time: 36.4422 / Avg. batch time: 525.2772 (ms) / GPU bubble ratio: 24.52%
[rank1]:2025-10-29 00:03:11,665 - INFO - Avg. fwd time: 14.9197 / Avg. bwd time: 41.0920 / Avg. batch time: 584.5970 (ms) / GPU bubble ratio: 23.35%
[rank0]:2025-10-29 00:03:11,697 - INFO - Avg. fwd time: 13.5528 / Avg. bwd time: 38.2597 / Avg. batch time: 639.6347 (ms) / GPU bubble ratio: 35.20%
[rank0]:2025-10-29 00:05:18,438 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:05:21,056 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 66.72GiB(47.72%)  tps: 6,295  tflops: 293.61  mfu: 29.69%
[rank1]:2025-10-29 00:05:21,052 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 64.32GiB(46.00%)  tps: 6,297  tflops: 293.69  mfu: 29.70%
[rank2]:2025-10-29 00:05:21,049 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 57.29GiB(40.97%)  tps: 6,298  tflops: 293.72  mfu: 29.70%
[rank3]:2025-10-29 00:05:21,054 - INFO -  step: 1650  loss:  0.0970  grad_norm:  0.1533  memory: 73.38GiB(52.48%)  tps: 6,298  tflops: 293.75  mfu: 29.70%
[rank2]:2025-10-29 00:05:21,628 - INFO - Avg. fwd time: 13.1092 / Avg. bwd time: 36.4376 / Avg. batch time: 525.0952 (ms) / GPU bubble ratio: 24.51%
[rank3]:2025-10-29 00:05:21,579 - INFO - Avg. fwd time: 14.3818 / Avg. bwd time: 42.7106 / Avg. batch time: 472.2297 (ms) / GPU bubble ratio: 3.28%
[rank0]:2025-10-29 00:05:21,729 - INFO - Avg. fwd time: 13.5425 / Avg. bwd time: 38.2549 / Avg. batch time: 639.4369 (ms) / GPU bubble ratio: 35.20%
[rank1]:2025-10-29 00:05:21,679 - INFO - Avg. fwd time: 14.9110 / Avg. bwd time: 41.0900 / Avg. batch time: 584.4074 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-29 00:07:28,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:07:30,824 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank0]:2025-10-29 00:07:30,828 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank2]:2025-10-29 00:07:30,821 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank3]:2025-10-29 00:07:30,826 - INFO -  step: 1700  loss:  0.0986  grad_norm:  0.1172  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:07:31,015 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0007_real_step1700_rank3.svg
[rank3]:> Batch Time: 622.35 ms, GPU Bubble Ratio: 33.23%, 27.84%, 36.15%, 26.51%
[rank2]:2025-10-29 00:07:31,448 - INFO - Avg. fwd time: 13.1014 / Avg. bwd time: 36.4337 / Avg. batch time: 524.9157 (ms) / GPU bubble ratio: 24.51%
[rank3]:2025-10-29 00:07:31,400 - INFO - Avg. fwd time: 14.3720 / Avg. bwd time: 42.7016 / Avg. batch time: 472.0719 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:07:31,494 - INFO - Avg. fwd time: 14.9023 / Avg. bwd time: 41.0845 / Avg. batch time: 584.2137 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:07:31,526 - INFO - Avg. fwd time: 13.5334 / Avg. bwd time: 38.2513 / Avg. batch time: 639.2355 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:09:38,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:09:40,727 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 64.32GiB(46.00%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank3]:2025-10-29 00:09:40,729 - INFO -  step: 1750  loss:  0.1070  grad_norm:  0.1126  memory: 73.38GiB(52.48%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank0]:2025-10-29 00:09:40,731 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank2]:2025-10-29 00:09:40,724 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 57.29GiB(40.97%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank3]:2025-10-29 00:09:41,164 - INFO - Avg. fwd time: 14.3618 / Avg. bwd time: 42.6927 / Avg. batch time: 471.9112 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:09:41,260 - INFO - Avg. fwd time: 14.8927 / Avg. bwd time: 41.0787 / Avg. batch time: 584.0352 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-10-29 00:09:41,214 - INFO - Avg. fwd time: 13.0931 / Avg. bwd time: 36.4294 / Avg. batch time: 524.7515 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-10-29 00:09:41,293 - INFO - Avg. fwd time: 13.5238 / Avg. bwd time: 38.2473 / Avg. batch time: 639.0486 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:11:47,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:11:50,469 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 57.29GiB(40.97%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank2]:2025-10-29 00:11:50,470 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 00:11:50,472 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 64.32GiB(46.00%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank1]:2025-10-29 00:11:50,472 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 00:11:50,477 - INFO -  step: 1800  loss:  0.0846  grad_norm:  0.0934  memory: 73.38GiB(52.48%)  tps: 6,314  tflops: 294.49  mfu: 29.78%
[rank3]:2025-10-29 00:11:50,477 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 00:11:50,476 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 66.72GiB(47.72%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank0]:2025-10-29 00:11:50,476 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 00:12:05,470 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,319
[rank1]:2025-10-29 00:12:05,500 - INFO - validate step: 1800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,256
[rank3]:2025-10-29 00:12:05,545 - INFO - validate step: 1800  loss:  0.2421  memory: 73.38GiB(52.48%)  tps: 27,186
[rank2]:2025-10-29 00:12:05,526 - INFO - validate step: 1800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,206
[rank3]:2025-10-29 00:12:05,742 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0012_real_step1800_rank3.svg
[rank3]:> Batch Time: 621.73 ms, GPU Bubble Ratio: 33.21%, 27.82%, 36.13%, 26.52%
[rank3]:2025-10-29 00:12:06,220 - INFO - Avg. fwd time: 14.3517 / Avg. bwd time: 42.6841 / Avg. batch time: 471.7525 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:12:06,267 - INFO - Avg. fwd time: 13.0851 / Avg. bwd time: 36.4251 / Avg. batch time: 524.5904 (ms) / GPU bubble ratio: 24.50%
[rank1]:2025-10-29 00:12:06,318 - INFO - Avg. fwd time: 14.8834 / Avg. bwd time: 41.0721 / Avg. batch time: 583.8592 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:12:06,365 - INFO - Avg. fwd time: 13.5140 / Avg. bwd time: 38.2430 / Avg. batch time: 638.8645 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:14:12,939 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:14:15,550 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 66.72GiB(47.72%)  tps: 6,298  tflops: 293.72  mfu: 29.70%
[rank3]:2025-10-29 00:14:15,548 - INFO -  step: 1850  loss:  0.0715  grad_norm:  0.1181  memory: 73.38GiB(52.48%)  tps: 6,301  tflops: 293.90  mfu: 29.72%
[rank2]:2025-10-29 00:14:15,543 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 57.29GiB(40.97%)  tps: 6,301  tflops: 293.87  mfu: 29.71%
[rank1]:2025-10-29 00:14:15,546 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 64.32GiB(46.00%)  tps: 6,299  tflops: 293.80  mfu: 29.71%
[rank3]:2025-10-29 00:14:15,991 - INFO - Avg. fwd time: 14.3442 / Avg. bwd time: 42.6779 / Avg. batch time: 471.6362 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:14:16,041 - INFO - Avg. fwd time: 13.0794 / Avg. bwd time: 36.4212 / Avg. batch time: 524.4571 (ms) / GPU bubble ratio: 24.49%
[rank1]:2025-10-29 00:14:16,086 - INFO - Avg. fwd time: 14.8769 / Avg. bwd time: 41.0672 / Avg. batch time: 583.7137 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:14:16,120 - INFO - Avg. fwd time: 13.5071 / Avg. bwd time: 38.2396 / Avg. batch time: 638.7140 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:16:22,693 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:16:25,311 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:16:25,315 - INFO -  step: 1900  loss:  0.0874  grad_norm:  0.0985  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank0]:2025-10-29 00:16:25,317 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank1]:2025-10-29 00:16:25,313 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:16:25,504 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0016_real_step1900_rank3.svg
[rank3]:> Batch Time: 621.34 ms, GPU Bubble Ratio: 33.22%, 27.82%, 36.15%, 26.53%
[rank2]:2025-10-29 00:16:25,948 - INFO - Avg. fwd time: 13.0722 / Avg. bwd time: 36.4172 / Avg. batch time: 524.2898 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-10-29 00:16:25,899 - INFO - Avg. fwd time: 14.3349 / Avg. bwd time: 42.6697 / Avg. batch time: 471.4892 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:16:25,993 - INFO - Avg. fwd time: 14.8688 / Avg. bwd time: 41.0610 / Avg. batch time: 583.5328 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:16:26,025 - INFO - Avg. fwd time: 13.4984 / Avg. bwd time: 38.2358 / Avg. batch time: 638.5254 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:18:32,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:18:35,292 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 57.29GiB(40.97%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank0]:2025-10-29 00:18:35,298 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 66.72GiB(47.72%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:18:35,297 - INFO -  step: 1950  loss:  0.1128  grad_norm:  0.1428  memory: 73.38GiB(52.48%)  tps: 6,303  tflops: 293.95  mfu: 29.72%
[rank1]:2025-10-29 00:18:35,294 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 64.32GiB(46.00%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:18:35,830 - INFO - Avg. fwd time: 14.3268 / Avg. bwd time: 42.6635 / Avg. batch time: 471.3682 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:18:35,878 - INFO - Avg. fwd time: 13.0660 / Avg. bwd time: 36.4132 / Avg. batch time: 524.1683 (ms) / GPU bubble ratio: 24.48%
[rank0]:2025-10-29 00:18:35,977 - INFO - Avg. fwd time: 13.4911 / Avg. bwd time: 38.2320 / Avg. batch time: 638.3863 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-29 00:18:35,928 - INFO - Avg. fwd time: 14.8617 / Avg. bwd time: 41.0552 / Avg. batch time: 583.3984 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:20:42,507 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:20:45,142 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank2]:2025-10-29 00:20:45,142 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 00:20:45,148 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 66.72GiB(47.72%)  tps: 6,309  tflops: 294.24  mfu: 29.75%
[rank0]:2025-10-29 00:20:45,148 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 00:20:45,146 - INFO -  step: 2000  loss:  0.0971  grad_norm:  0.1179  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank3]:2025-10-29 00:20:45,147 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 00:20:45,144 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 64.32GiB(46.00%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank1]:2025-10-29 00:20:45,144 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 00:21:00,069 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,452
[rank1]:2025-10-29 00:21:00,101 - INFO - validate step: 2000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,386
[rank3]:2025-10-29 00:21:00,144 - INFO - validate step: 2000  loss:  0.2433  memory: 73.38GiB(52.48%)  tps: 27,313
[rank2]:2025-10-29 00:21:00,128 - INFO - validate step: 2000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,333
[rank3]:2025-10-29 00:21:00,335 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0021_real_step2000_rank3.svg
[rank3]:> Batch Time: 620.81 ms, GPU Bubble Ratio: 33.21%, 27.81%, 36.12%, 26.54%
[rank3]:2025-10-29 00:21:00,737 - INFO - Avg. fwd time: 14.3197 / Avg. bwd time: 42.6580 / Avg. batch time: 471.2612 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:21:00,786 - INFO - Avg. fwd time: 13.0604 / Avg. bwd time: 36.4101 / Avg. batch time: 524.0452 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-10-29 00:21:00,832 - INFO - Avg. fwd time: 14.8551 / Avg. bwd time: 41.0508 / Avg. batch time: 583.2640 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:21:00,865 - INFO - Avg. fwd time: 13.4844 / Avg. bwd time: 38.2294 / Avg. batch time: 638.2469 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:23:07,555 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:23:10,175 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 57.29GiB(40.97%)  tps: 6,299  tflops: 293.80  mfu: 29.71%
[rank0]:2025-10-29 00:23:10,181 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 66.72GiB(47.72%)  tps: 6,296  tflops: 293.65  mfu: 29.69%
[rank3]:2025-10-29 00:23:10,179 - INFO -  step: 2050  loss:  0.1288  grad_norm:  0.1226  memory: 73.38GiB(52.48%)  tps: 6,300  tflops: 293.83  mfu: 29.71%
[rank1]:2025-10-29 00:23:10,177 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 64.32GiB(46.00%)  tps: 6,298  tflops: 293.73  mfu: 29.70%
[rank3]:2025-10-29 00:23:10,616 - INFO - Avg. fwd time: 14.3128 / Avg. bwd time: 42.6524 / Avg. batch time: 471.1550 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:23:10,665 - INFO - Avg. fwd time: 13.0551 / Avg. bwd time: 36.4066 / Avg. batch time: 523.9373 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-10-29 00:23:10,711 - INFO - Avg. fwd time: 14.8494 / Avg. bwd time: 41.0461 / Avg. batch time: 583.1450 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:23:10,744 - INFO - Avg. fwd time: 13.4779 / Avg. bwd time: 38.2262 / Avg. batch time: 638.1213 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:25:17,365 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:25:19,971 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 66.72GiB(47.72%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank3]:2025-10-29 00:25:19,969 - INFO -  step: 2100  loss:  0.1125  grad_norm:  0.1031  memory: 73.38GiB(52.48%)  tps: 6,312  tflops: 294.39  mfu: 29.77%
[rank1]:2025-10-29 00:25:19,966 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 64.32GiB(46.00%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank2]:2025-10-29 00:25:19,964 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 57.29GiB(40.97%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank3]:2025-10-29 00:25:20,161 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0025_real_step2100_rank3.svg
[rank3]:> Batch Time: 620.52 ms, GPU Bubble Ratio: 33.21%, 27.81%, 36.11%, 26.54%
[rank3]:2025-10-29 00:25:20,640 - INFO - Avg. fwd time: 14.3058 / Avg. bwd time: 42.6467 / Avg. batch time: 471.0482 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:25:20,737 - INFO - Avg. fwd time: 14.8431 / Avg. bwd time: 41.0416 / Avg. batch time: 583.0271 (ms) / GPU bubble ratio: 23.32%
[rank2]:2025-10-29 00:25:20,686 - INFO - Avg. fwd time: 13.0495 / Avg. bwd time: 36.4040 / Avg. batch time: 523.8301 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 00:25:20,785 - INFO - Avg. fwd time: 13.4712 / Avg. bwd time: 38.2234 / Avg. batch time: 637.9982 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:27:27,339 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:27:29,945 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 57.29GiB(40.97%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank0]:2025-10-29 00:27:29,952 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 66.72GiB(47.72%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank1]:2025-10-29 00:27:29,948 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 64.32GiB(46.00%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:27:29,950 - INFO -  step: 2150  loss:  0.1348  grad_norm:  0.1567  memory: 73.38GiB(52.48%)  tps: 6,303  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:27:30,391 - INFO - Avg. fwd time: 14.3007 / Avg. bwd time: 42.6419 / Avg. batch time: 470.9646 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:27:30,440 - INFO - Avg. fwd time: 13.0455 / Avg. bwd time: 36.4019 / Avg. batch time: 523.7320 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 00:27:30,520 - INFO - Avg. fwd time: 13.4660 / Avg. bwd time: 38.2207 / Avg. batch time: 637.8862 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-29 00:27:30,486 - INFO - Avg. fwd time: 14.8381 / Avg. bwd time: 41.0374 / Avg. batch time: 582.9194 (ms) / GPU bubble ratio: 23.32%

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 00:28:56 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] 
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] *****************************************
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 00:29:04,098 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 00:29:04,215 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 00:29:04,221 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 00:29:04,321 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 00:29:04,957 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 00:29:04,959 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 00:29:05,202 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 00:29:05,204 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:05,228 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 00:29:05,231 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:05,236 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 00:29:05,243 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 00:29:05,246 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:07,151 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 00:29:07,433 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 00:29:09,069 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 00:29:10,668 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 00:29:10,741 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 00:29:10,741 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 00:29:10,726 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 00:29:10,801 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 00:29:10,801 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 00:29:10,945 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 00:29:10,945 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 00:29:11,015 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 00:29:11,016 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 00:29:11,148 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 00:29:11,406 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 00:29:11,455 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 00:29:11,479 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 00:29:11,479 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-10-29 00:29:11,696 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 00:29:11,697 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: setting up run k3khcbe8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1/20251029-0029/wandb/run-20251029_002911-k3khcbe8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k3khcbe8
[rank3]:2025-10-29 00:29:12,682 - INFO - WandB logging enabled
[rank3]:2025-10-29 00:29:12,708 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 00:29:12,787 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 00:29:12,787 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 00:29:13,044 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 00:29:13,045 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:29:13,056 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank0]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:29:13,057 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 00:29:16,624 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank2]:2025-10-29 00:29:16,573 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank1]:2025-10-29 00:29:16,675 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank0]:2025-10-29 00:29:16,794 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 00:29:16,794 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank0]:2025-10-29 00:29:16,794 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200.
[rank0]:2025-10-29 00:29:23,912 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 00:29:23,912 - INFO - Finished loading the checkpoint in 7.12 seconds.
[rank0]:2025-10-29 00:29:23,913 - INFO - Training starts at step 1
[rank0]:2025-10-29 00:29:28,564 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 49.75GiB(35.58%)  tps: 958  tflops: 44.66  mfu: 4.52%
[rank0]:2025-10-29 00:29:28,564 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 00:29:28,540 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 44.28GiB(31.67%)  tps: 919  tflops: 42.87  mfu: 4.33%
[rank2]:2025-10-29 00:29:28,541 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 00:29:28,543 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 49.69GiB(35.54%)  tps: 922  tflops: 43.01  mfu: 4.35%
[rank1]:2025-10-29 00:29:28,543 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:29:28,545 - INFO -  step:  1  loss:  1.0507  grad_norm:  0.9701  memory: 58.03GiB(41.50%)  tps: 1,038  tflops: 48.42  mfu: 4.90%
[rank3]:2025-10-29 00:29:28,546 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 00:29:37,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:29:39,610 - INFO -  step: 2200  loss:  0.0977  grad_norm:  0.0972  memory: 73.38GiB(52.48%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank3]:2025-10-29 00:29:39,610 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 00:29:39,607 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 64.32GiB(46.00%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank1]:2025-10-29 00:29:39,607 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 00:29:39,612 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 66.72GiB(47.72%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank0]:2025-10-29 00:29:39,612 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 00:29:39,605 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 57.29GiB(40.97%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank2]:2025-10-29 00:29:39,605 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 00:29:46,830 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:54,833 - INFO - validate step: 2200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,903
[rank0]:2025-10-29 00:29:54,802 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,965
[rank2]:2025-10-29 00:29:54,845 - INFO - validate step: 2200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,876
[rank3]:2025-10-29 00:29:54,860 - INFO - validate step: 2200  loss:  0.2431  memory: 73.38GiB(52.48%)  tps: 26,860
[rank3]:2025-10-29 00:29:55,051 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0029_real_step2200_rank3.svg
[rank3]:> Batch Time: 620.08 ms, GPU Bubble Ratio: 33.20%, 27.78%, 36.09%, 26.55%
[rank3]:2025-10-29 00:29:55,441 - INFO - Avg. fwd time: 14.2933 / Avg. bwd time: 42.6341 / Avg. batch time: 470.8364 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:29:55,490 - INFO - Avg. fwd time: 13.0406 / Avg. bwd time: 36.4012 / Avg. batch time: 523.5903 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-10-29 00:29:55,535 - INFO - Avg. fwd time: 14.8333 / Avg. bwd time: 41.0369 / Avg. batch time: 582.7739 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-10-29 00:29:55,567 - INFO - Avg. fwd time: 13.4602 / Avg. bwd time: 38.2190 / Avg. batch time: 637.7372 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:31:38,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:31:40,989 - INFO -  step: 50  loss:  0.9059  grad_norm:  0.4167  memory: 73.38GiB(52.48%)  tps: 6,062  tflops: 282.72  mfu: 28.59%
[rank1]:2025-10-29 00:31:40,987 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank0]:2025-10-29 00:31:40,991 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 66.72GiB(47.72%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank2]:2025-10-29 00:31:40,984 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 57.29GiB(40.97%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank3]:2025-10-29 00:31:41,451 - INFO - Avg. fwd time: 14.7708 / Avg. bwd time: 42.9562 / Avg. batch time: 482.1768 (ms) / GPU bubble ratio: 4.22%
[rank2]:2025-10-29 00:31:41,501 - INFO - Avg. fwd time: 13.2962 / Avg. bwd time: 36.3898 / Avg. batch time: 535.0132 (ms) / GPU bubble ratio: 25.71%
[rank1]:2025-10-29 00:31:41,548 - INFO - Avg. fwd time: 15.4241 / Avg. bwd time: 41.6891 / Avg. batch time: 595.7353 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-10-29 00:31:41,582 - INFO - Avg. fwd time: 14.3031 / Avg. bwd time: 38.5742 / Avg. batch time: 651.7335 (ms) / GPU bubble ratio: 35.09%
[rank0]:2025-10-29 00:32:02,333 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:32:04,952 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 57.29GiB(40.97%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank0]:2025-10-29 00:32:04,958 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 66.72GiB(47.72%)  tps: 6,294  tflops: 293.55  mfu: 29.68%
[rank3]:2025-10-29 00:32:04,956 - INFO -  step: 2250  loss:  0.1172  grad_norm:  0.1311  memory: 73.38GiB(52.48%)  tps: 6,297  tflops: 293.69  mfu: 29.70%
[rank1]:2025-10-29 00:32:04,954 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 64.32GiB(46.00%)  tps: 6,296  tflops: 293.63  mfu: 29.69%
[rank3]:2025-10-29 00:32:05,489 - INFO - Avg. fwd time: 14.2869 / Avg. bwd time: 42.6292 / Avg. batch time: 470.7406 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:32:05,539 - INFO - Avg. fwd time: 13.0360 / Avg. bwd time: 36.3993 / Avg. batch time: 523.4966 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 00:32:05,643 - INFO - Avg. fwd time: 13.4552 / Avg. bwd time: 38.2176 / Avg. batch time: 637.6432 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-29 00:32:05,593 - INFO - Avg. fwd time: 14.8303 / Avg. bwd time: 41.0389 / Avg. batch time: 582.6819 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 00:33:53,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:33:56,366 - INFO -  step: 100  loss:  0.8034  grad_norm:  0.5327  memory: 73.38GiB(52.48%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank1]:2025-10-29 00:33:56,364 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 64.32GiB(46.00%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank2]:2025-10-29 00:33:56,362 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 57.29GiB(40.97%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank0]:2025-10-29 00:33:56,369 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 66.72GiB(47.72%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank3]:2025-10-29 00:33:56,562 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0033_real_step100_rank3.svg
[rank3]:> Batch Time: 634.28 ms, GPU Bubble Ratio: 32.99%, 27.10%, 36.82%, 26.60%
[rank3]:2025-10-29 00:33:56,975 - INFO - Avg. fwd time: 14.8358 / Avg. bwd time: 43.1073 / Avg. batch time: 481.2257 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-29 00:33:57,025 - INFO - Avg. fwd time: 13.3537 / Avg. bwd time: 36.5079 / Avg. batch time: 534.0995 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 00:33:57,071 - INFO - Avg. fwd time: 15.5459 / Avg. bwd time: 41.9582 / Avg. batch time: 595.0309 (ms) / GPU bubble ratio: 22.69%
[rank0]:2025-10-29 00:33:57,105 - INFO - Avg. fwd time: 14.2257 / Avg. bwd time: 38.7488 / Avg. batch time: 651.0923 (ms) / GPU bubble ratio: 34.91%
[rank0]:2025-10-29 00:34:12,602 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:34:15,233 - INFO -  step: 2300  loss:  0.0884  grad_norm:  0.0944  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 00:34:15,235 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank1]:2025-10-29 00:34:15,231 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank2]:2025-10-29 00:34:15,228 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank3]:2025-10-29 00:34:15,420 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0034_real_step2300_rank3.svg
[rank3]:> Batch Time: 619.94 ms, GPU Bubble Ratio: 33.20%, 27.76%, 36.09%, 26.56%
[rank3]:2025-10-29 00:34:15,817 - INFO - Avg. fwd time: 14.2826 / Avg. bwd time: 42.6280 / Avg. batch time: 470.6932 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:34:15,866 - INFO - Avg. fwd time: 13.0324 / Avg. bwd time: 36.3978 / Avg. batch time: 523.4377 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 00:34:15,944 - INFO - Avg. fwd time: 13.4514 / Avg. bwd time: 38.2166 / Avg. batch time: 637.5823 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-29 00:34:15,912 - INFO - Avg. fwd time: 14.8280 / Avg. bwd time: 41.0410 / Avg. batch time: 582.6232 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 00:36:09,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:36:11,882 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 64.32GiB(46.00%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank0]:2025-10-29 00:36:11,887 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 66.72GiB(47.72%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank3]:2025-10-29 00:36:11,885 - INFO -  step: 150  loss:  0.8485  grad_norm:  0.5197  memory: 73.38GiB(52.48%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank2]:2025-10-29 00:36:11,880 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 57.29GiB(40.97%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank3]:2025-10-29 00:36:12,438 - INFO - Avg. fwd time: 14.8544 / Avg. bwd time: 43.1588 / Avg. batch time: 480.9804 (ms) / GPU bubble ratio: 3.51%
[rank1]:2025-10-29 00:36:12,526 - INFO - Avg. fwd time: 15.5878 / Avg. bwd time: 42.0480 / Avg. batch time: 595.1100 (ms) / GPU bubble ratio: 22.52%
[rank2]:2025-10-29 00:36:12,479 - INFO - Avg. fwd time: 13.3679 / Avg. bwd time: 36.5419 / Avg. batch time: 534.0936 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-29 00:36:12,569 - INFO - Avg. fwd time: 14.2005 / Avg. bwd time: 38.8015 / Avg. batch time: 651.2039 (ms) / GPU bubble ratio: 34.89%
[rank0]:2025-10-29 00:36:23,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:36:25,669 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank3]:2025-10-29 00:36:25,673 - INFO -  step: 2350  loss:  0.1037  grad_norm:  0.0869  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank0]:2025-10-29 00:36:25,676 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank1]:2025-10-29 00:36:25,671 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank3]:2025-10-29 00:36:26,123 - INFO - Avg. fwd time: 14.2781 / Avg. bwd time: 42.6273 / Avg. batch time: 470.6470 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:36:26,173 - INFO - Avg. fwd time: 13.0281 / Avg. bwd time: 36.3957 / Avg. batch time: 523.3918 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-10-29 00:36:26,218 - INFO - Avg. fwd time: 14.8255 / Avg. bwd time: 41.0427 / Avg. batch time: 582.5759 (ms) / GPU bubble ratio: 23.28%
[rank0]:2025-10-29 00:36:26,251 - INFO - Avg. fwd time: 13.4469 / Avg. bwd time: 38.2151 / Avg. batch time: 637.5323 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:38:24,639 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:38:27,373 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 64.32GiB(46.00%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank1]:2025-10-29 00:38:27,373 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 00:38:27,370 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 57.29GiB(40.97%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank2]:2025-10-29 00:38:27,371 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 00:38:27,376 - INFO -  step: 200  loss:  0.8525  grad_norm:  0.6145  memory: 73.38GiB(52.48%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank3]:2025-10-29 00:38:27,376 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 00:38:27,377 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 66.72GiB(47.72%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank0]:2025-10-29 00:38:27,378 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 00:38:33,368 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:38:36,010 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank2]:2025-10-29 00:38:36,010 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,326  tflops: 295.05  mfu: 28.81%
[rank2]:2025-10-29 00:38:36,011 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 00:38:36,017 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank0]:2025-10-29 00:38:36,017 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,325  tflops: 295.02  mfu: 28.80%
[rank0]:2025-10-29 00:38:36,017 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 00:38:36,013 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank1]:2025-10-29 00:38:36,013 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,326  tflops: 295.04  mfu: 28.81%
[rank1]:2025-10-29 00:38:36,013 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 00:38:36,015 - INFO -  step: 2400  loss:  0.0978  grad_norm:  0.1108  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank3]:2025-10-29 00:38:36,015 - INFO -  final step: 2400  loss:  0.0978  grad_norm:  0.1108  tps: 6,328  tflops: 295.15  mfu: 28.82%
[rank3]:2025-10-29 00:38:36,016 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 00:38:44,225 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,306
[rank2]:2025-10-29 00:38:44,239 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,282
[rank3]:2025-10-29 00:38:44,253 - INFO - validate step: 200  loss:  0.2570  memory: 73.38GiB(52.48%)  tps: 24,271
[rank0]:2025-10-29 00:38:44,195 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,356
[rank3]:2025-10-29 00:38:44,438 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0038_real_step200_rank3.svg
[rank3]:> Batch Time: 635.02 ms, GPU Bubble Ratio: 33.01%, 27.05%, 36.88%, 26.63%
[rank3]:2025-10-29 00:38:44,847 - INFO - Avg. fwd time: 14.8617 / Avg. bwd time: 43.1853 / Avg. batch time: 480.9045 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 00:38:44,944 - INFO - Avg. fwd time: 15.5977 / Avg. bwd time: 42.0822 / Avg. batch time: 595.0054 (ms) / GPU bubble ratio: 22.45%
[rank2]:2025-10-29 00:38:44,897 - INFO - Avg. fwd time: 13.3713 / Avg. bwd time: 36.5531 / Avg. batch time: 533.9603 (ms) / GPU bubble ratio: 25.20%
[rank0]:2025-10-29 00:38:44,978 - INFO - Avg. fwd time: 14.1851 / Avg. bwd time: 38.8231 / Avg. batch time: 651.1069 (ms) / GPU bubble ratio: 34.87%
[rank0]:2025-10-29 00:38:50,986 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,363
[rank0]:2025-10-29 00:38:50,987 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 00:38:50,990 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 00:38:51,058 - INFO - validate step: 2400  loss:  0.2417  memory: 73.38GiB(52.48%)  tps: 27,230
[rank3]:2025-10-29 00:38:51,059 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 00:38:51,017 - INFO - validate step: 2400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,300
[rank1]:2025-10-29 00:38:51,018 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 00:38:51,023 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 00:38:51,039 - INFO - validate step: 2400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,255
[rank2]:2025-10-29 00:38:51,040 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 00:38:51,046 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 00:38:51,062 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 00:39:02,711 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 00:39:02,740 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 00:39:02,740 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 00:39:02,740 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 00:39:03,060 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0039_real_final2400_rank3.svg
[rank3]:> Batch Time: 619.84 ms, GPU Bubble Ratio: 33.21%, 27.76%, 36.11%, 26.56%
[rank3]:2025-10-29 00:39:03,362 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0039_thry_final2400_rank3.svg
[rank3]:> Batch Time: 456.82 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 00:39:03,362 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 360-364
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.58899
[rank3]:wandb:               final/avg_loss 0.09784
[rank3]:wandb:             final/avg_mfu(%) 28.81728
[rank3]:wandb:             final/avg_tflops 295.15411
[rank3]:wandb:    final/avg_throughput(tps) 6328.32528
[rank3]:wandb:              final/grad_norm 0.1108
[rank3]:wandb:               final/max_loss 0.09784
[rank3]:wandb:                    grad_norm 0.1108
[rank3]:wandb: loss_metrics/global_avg_loss 0.09784
[rank3]:wandb: loss_metrics/global_max_loss 0.09784
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/h40tt1xa
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_nofreeze_dm1/20251028-2250/wandb/run-20251028_225005-h40tt1xa/logs
[rank0]:2025-10-29 00:39:04,740 - INFO - Training completed
[rank0]:2025-10-29 00:39:04,740 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 00:39:05,018 - INFO - Process group destroyed
[rank1]:2025-10-29 00:39:04,985 - INFO - Process group destroyed
[rank3]:2025-10-29 00:39:05,013 - INFO - Process group destroyed
[rank0]:2025-10-29 00:39:05,157 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.15', 'layers.10', 'layers.9', 'layers.13', 'layers.11', 'layers.14', 'layers.12', 'layers.8'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.22', 'layers.21', 'layers.20', 'layers.23', 'layers.19', 'layers.17', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.5', 'layers.2', 'layers.0', 'layers.3', 'layers.4', 'layers.7', 'tok_embeddings', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.25', 'layers.30', 'layers.31', 'layers.28', 'layers.27', 'layers.26', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:2025-10-29 00:40:57,085 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:40:59,806 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 57.29GiB(40.97%)  tps: 6,043  tflops: 281.84  mfu: 28.50%
[rank1]:2025-10-29 00:40:59,809 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank3]:2025-10-29 00:40:59,811 - INFO -  step: 250  loss:  0.8870  grad_norm:  0.5384  memory: 73.38GiB(52.48%)  tps: 6,043  tflops: 281.86  mfu: 28.50%
[rank0]:2025-10-29 00:40:59,813 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 66.72GiB(47.72%)  tps: 6,041  tflops: 281.73  mfu: 28.49%
[rank3]:2025-10-29 00:41:00,271 - INFO - Avg. fwd time: 14.8717 / Avg. bwd time: 43.2035 / Avg. batch time: 480.8865 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-29 00:41:00,321 - INFO - Avg. fwd time: 13.3794 / Avg. bwd time: 36.5628 / Avg. batch time: 534.0358 (ms) / GPU bubble ratio: 25.19%
[rank1]:2025-10-29 00:41:00,368 - INFO - Avg. fwd time: 15.6086 / Avg. bwd time: 42.1110 / Avg. batch time: 595.1152 (ms) / GPU bubble ratio: 22.41%
[rank0]:2025-10-29 00:41:00,401 - INFO - Avg. fwd time: 14.1661 / Avg. bwd time: 38.8139 / Avg. batch time: 651.1863 (ms) / GPU bubble ratio: 34.91%
[rank0]:2025-10-29 00:43:12,565 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:43:15,280 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 57.29GiB(40.97%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank3]:2025-10-29 00:43:15,285 - INFO -  step: 300  loss:  0.7869  grad_norm:  0.4663  memory: 73.38GiB(52.48%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank1]:2025-10-29 00:43:15,282 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 64.32GiB(46.00%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank0]:2025-10-29 00:43:15,287 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 66.72GiB(47.72%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank3]:2025-10-29 00:43:15,468 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0043_real_step300_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.08%, 27.03%, 36.90%, 26.64%
[rank3]:2025-10-29 00:43:15,966 - INFO - Avg. fwd time: 14.8727 / Avg. bwd time: 43.2146 / Avg. batch time: 480.8234 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-10-29 00:43:16,008 - INFO - Avg. fwd time: 13.3840 / Avg. bwd time: 36.5697 / Avg. batch time: 534.0416 (ms) / GPU bubble ratio: 25.17%
[rank1]:2025-10-29 00:43:16,055 - INFO - Avg. fwd time: 15.6137 / Avg. bwd time: 42.1300 / Avg. batch time: 595.1451 (ms) / GPU bubble ratio: 22.38%
[rank0]:2025-10-29 00:43:16,099 - INFO - Avg. fwd time: 14.1540 / Avg. bwd time: 38.8184 / Avg. batch time: 651.2158 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:45:28,133 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:45:30,857 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank2]:2025-10-29 00:45:30,854 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 57.29GiB(40.97%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank3]:2025-10-29 00:45:30,860 - INFO -  step: 350  loss:  0.8326  grad_norm:  0.4684  memory: 73.38GiB(52.48%)  tps: 6,043  tflops: 281.82  mfu: 28.50%
[rank0]:2025-10-29 00:45:30,861 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank2]:2025-10-29 00:45:31,375 - INFO - Avg. fwd time: 13.3871 / Avg. bwd time: 36.5730 / Avg. batch time: 533.9992 (ms) / GPU bubble ratio: 25.15%
[rank3]:2025-10-29 00:45:31,326 - INFO - Avg. fwd time: 14.8750 / Avg. bwd time: 43.2249 / Avg. batch time: 480.8261 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-10-29 00:45:31,422 - INFO - Avg. fwd time: 15.6205 / Avg. bwd time: 42.1422 / Avg. batch time: 595.1243 (ms) / GPU bubble ratio: 22.35%
[rank0]:2025-10-29 00:45:31,456 - INFO - Avg. fwd time: 14.1485 / Avg. bwd time: 38.8191 / Avg. batch time: 651.1849 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:47:42,481 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:47:45,119 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 57.29GiB(40.97%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank2]:2025-10-29 00:47:45,119 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 00:47:45,122 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 64.32GiB(46.00%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank1]:2025-10-29 00:47:45,122 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 00:47:45,125 - INFO -  step: 400  loss:  0.1033  grad_norm:  0.1207  memory: 73.38GiB(52.48%)  tps: 6,102  tflops: 284.58  mfu: 28.77%
[rank3]:2025-10-29 00:47:45,126 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:47:45,126 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 66.72GiB(47.72%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank0]:2025-10-29 00:47:45,126 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 00:48:00,280 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,018
[rank1]:2025-10-29 00:48:00,266 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,047
[rank3]:2025-10-29 00:48:00,293 - INFO - validate step: 400  loss:  0.2487  memory: 73.38GiB(52.48%)  tps: 27,009
[rank0]:2025-10-29 00:48:00,235 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,110
[rank3]:2025-10-29 00:48:00,491 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0048_real_step400_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.10%, 27.01%, 36.91%, 26.64%
[rank3]:2025-10-29 00:48:00,885 - INFO - Avg. fwd time: 14.8552 / Avg. bwd time: 43.2112 / Avg. batch time: 480.4664 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-29 00:48:00,934 - INFO - Avg. fwd time: 13.3726 / Avg. bwd time: 36.5638 / Avg. batch time: 533.5771 (ms) / GPU bubble ratio: 25.13%
[rank1]:2025-10-29 00:48:00,980 - INFO - Avg. fwd time: 15.6077 / Avg. bwd time: 42.1397 / Avg. batch time: 594.6824 (ms) / GPU bubble ratio: 22.32%
[rank0]:2025-10-29 00:48:01,013 - INFO - Avg. fwd time: 14.1230 / Avg. bwd time: 38.8085 / Avg. batch time: 650.7159 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:50:08,050 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:50:10,667 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 00:50:10,669 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 64.32GiB(46.00%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank0]:2025-10-29 00:50:10,674 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.92  mfu: 29.62%
[rank3]:2025-10-29 00:50:10,672 - INFO -  step: 450  loss:  0.0968  grad_norm:  0.1381  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.06  mfu: 29.63%
[rank3]:2025-10-29 00:50:11,194 - INFO - Avg. fwd time: 14.7612 / Avg. bwd time: 43.1182 / Avg. batch time: 478.8834 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-29 00:50:11,236 - INFO - Avg. fwd time: 13.3027 / Avg. bwd time: 36.5236 / Avg. batch time: 531.9479 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 00:50:11,283 - INFO - Avg. fwd time: 15.5212 / Avg. bwd time: 42.0893 / Avg. batch time: 592.9801 (ms) / GPU bubble ratio: 22.28%
[rank0]:2025-10-29 00:50:11,327 - INFO - Avg. fwd time: 14.0351 / Avg. bwd time: 38.7673 / Avg. batch time: 648.9255 (ms) / GPU bubble ratio: 34.90%
[rank0]:2025-10-29 00:52:18,372 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:52:20,980 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank1]:2025-10-29 00:52:20,982 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank0]:2025-10-29 00:52:20,987 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank3]:2025-10-29 00:52:20,985 - INFO -  step: 500  loss:  0.1054  grad_norm:  0.1340  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank3]:2025-10-29 00:52:21,173 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0052_real_step500_rank3.svg
[rank3]:> Batch Time: 633.55 ms, GPU Bubble Ratio: 33.07%, 27.00%, 36.88%, 26.66%
[rank2]:2025-10-29 00:52:21,606 - INFO - Avg. fwd time: 13.2532 / Avg. bwd time: 36.4970 / Avg. batch time: 530.7586 (ms) / GPU bubble ratio: 25.01%
[rank3]:2025-10-29 00:52:21,556 - INFO - Avg. fwd time: 14.6942 / Avg. bwd time: 43.0560 / Avg. batch time: 477.7896 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-29 00:52:21,653 - INFO - Avg. fwd time: 15.4639 / Avg. bwd time: 42.0590 / Avg. batch time: 591.7458 (ms) / GPU bubble ratio: 22.23%
[rank0]:2025-10-29 00:52:21,686 - INFO - Avg. fwd time: 13.9741 / Avg. bwd time: 38.7422 / Avg. batch time: 647.6328 (ms) / GPU bubble ratio: 34.88%
[rank0]:2025-10-29 00:54:28,786 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:54:31,398 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 57.29GiB(40.97%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank1]:2025-10-29 00:54:31,401 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 64.32GiB(46.00%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank0]:2025-10-29 00:54:31,405 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 66.72GiB(47.72%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank3]:2025-10-29 00:54:31,403 - INFO -  step: 550  loss:  0.1195  grad_norm:  0.1301  memory: 73.38GiB(52.48%)  tps: 6,281  tflops: 292.97  mfu: 29.62%
[rank3]:2025-10-29 00:54:31,834 - INFO - Avg. fwd time: 14.6316 / Avg. bwd time: 42.9965 / Avg. batch time: 476.7553 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 00:54:31,885 - INFO - Avg. fwd time: 13.2073 / Avg. bwd time: 36.4727 / Avg. batch time: 529.6967 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-10-29 00:54:31,930 - INFO - Avg. fwd time: 15.4097 / Avg. bwd time: 42.0312 / Avg. batch time: 590.6437 (ms) / GPU bubble ratio: 22.20%
[rank0]:2025-10-29 00:54:31,963 - INFO - Avg. fwd time: 13.9189 / Avg. bwd time: 38.7173 / Avg. batch time: 646.4788 (ms) / GPU bubble ratio: 34.86%
[rank0]:2025-10-29 00:56:39,108 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:56:41,727 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 00:56:41,732 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 00:56:41,732 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 00:56:41,729 - INFO -  step: 600  loss:  0.0925  grad_norm:  0.0830  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank3]:2025-10-29 00:56:41,730 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 00:56:41,725 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank2]:2025-10-29 00:56:41,725 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 00:56:41,728 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 00:56:56,831 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,127
[rank2]:2025-10-29 00:56:56,876 - INFO - validate step: 600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,035
[rank1]:2025-10-29 00:56:56,862 - INFO - validate step: 600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,064
[rank3]:2025-10-29 00:56:56,890 - INFO - validate step: 600  loss:  0.2593  memory: 73.38GiB(52.48%)  tps: 27,020
[rank3]:2025-10-29 00:56:57,075 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0056_real_step600_rank3.svg
[rank3]:> Batch Time: 631.60 ms, GPU Bubble Ratio: 33.02%, 26.96%, 36.84%, 26.69%
[rank3]:2025-10-29 00:56:57,553 - INFO - Avg. fwd time: 14.5786 / Avg. bwd time: 42.9476 / Avg. batch time: 475.8929 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 00:56:57,595 - INFO - Avg. fwd time: 13.1677 / Avg. bwd time: 36.4513 / Avg. batch time: 528.8079 (ms) / GPU bubble ratio: 24.93%
[rank1]:2025-10-29 00:56:57,643 - INFO - Avg. fwd time: 15.3628 / Avg. bwd time: 42.0089 / Avg. batch time: 589.7214 (ms) / GPU bubble ratio: 22.17%
[rank0]:2025-10-29 00:56:57,687 - INFO - Avg. fwd time: 13.8701 / Avg. bwd time: 38.6976 / Avg. batch time: 645.5131 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-10-29 00:59:04,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:59:07,370 - INFO -  step: 650  loss:  0.0787  grad_norm:  0.1029  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank0]:2025-10-29 00:59:07,372 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 66.72GiB(47.72%)  tps: 6,275  tflops: 292.69  mfu: 29.59%
[rank2]:2025-10-29 00:59:07,365 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 00:59:07,368 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 64.32GiB(46.00%)  tps: 6,277  tflops: 292.77  mfu: 29.60%
[rank3]:2025-10-29 00:59:07,807 - INFO - Avg. fwd time: 14.5425 / Avg. bwd time: 42.9124 / Avg. batch time: 475.2888 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 00:59:07,856 - INFO - Avg. fwd time: 13.1405 / Avg. bwd time: 36.4347 / Avg. batch time: 528.1421 (ms) / GPU bubble ratio: 24.91%
[rank1]:2025-10-29 00:59:07,903 - INFO - Avg. fwd time: 15.3313 / Avg. bwd time: 41.9896 / Avg. batch time: 589.0287 (ms) / GPU bubble ratio: 22.15%
[rank0]:2025-10-29 00:59:07,936 - INFO - Avg. fwd time: 13.8355 / Avg. bwd time: 38.6812 / Avg. batch time: 644.7837 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:01:15,188 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:01:17,815 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank2]:2025-10-29 01:01:17,812 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank3]:2025-10-29 01:01:17,817 - INFO -  step: 700  loss:  0.0974  grad_norm:  0.1130  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank0]:2025-10-29 01:01:17,820 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank3]:2025-10-29 01:01:18,008 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0101_real_step700_rank3.svg
[rank3]:> Batch Time: 629.52 ms, GPU Bubble Ratio: 32.97%, 26.90%, 36.79%, 26.75%
[rank3]:2025-10-29 01:01:18,398 - INFO - Avg. fwd time: 14.5044 / Avg. bwd time: 42.8785 / Avg. batch time: 474.6784 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:01:18,494 - INFO - Avg. fwd time: 15.2981 / Avg. bwd time: 41.9740 / Avg. batch time: 588.3373 (ms) / GPU bubble ratio: 22.12%
[rank2]:2025-10-29 01:01:18,448 - INFO - Avg. fwd time: 13.1120 / Avg. bwd time: 36.4192 / Avg. batch time: 527.4723 (ms) / GPU bubble ratio: 24.88%
[rank0]:2025-10-29 01:01:18,526 - INFO - Avg. fwd time: 13.7999 / Avg. bwd time: 38.6658 / Avg. batch time: 644.0589 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:03:25,563 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:03:28,202 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 01:03:28,204 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:03:28,206 - INFO -  step: 750  loss:  0.1253  grad_norm:  0.1450  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 01:03:28,208 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:03:28,737 - INFO - Avg. fwd time: 14.4717 / Avg. bwd time: 42.8472 / Avg. batch time: 474.1370 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:03:28,780 - INFO - Avg. fwd time: 13.0880 / Avg. bwd time: 36.4040 / Avg. batch time: 526.9227 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-10-29 01:03:28,828 - INFO - Avg. fwd time: 15.2693 / Avg. bwd time: 41.9568 / Avg. batch time: 587.7620 (ms) / GPU bubble ratio: 22.11%
[rank0]:2025-10-29 01:03:28,873 - INFO - Avg. fwd time: 13.7717 / Avg. bwd time: 38.6487 / Avg. batch time: 643.4499 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:05:35,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:05:38,540 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank2]:2025-10-29 01:05:38,541 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 01:05:38,543 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank1]:2025-10-29 01:05:38,543 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 01:05:38,545 - INFO -  step: 800  loss:  0.1097  grad_norm:  0.1311  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.15  mfu: 29.64%
[rank3]:2025-10-29 01:05:38,546 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:05:38,547 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank0]:2025-10-29 01:05:38,547 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:05:53,804 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,847
[rank2]:2025-10-29 01:05:53,848 - INFO - validate step: 800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,759
[rank1]:2025-10-29 01:05:53,834 - INFO - validate step: 800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,788
[rank3]:2025-10-29 01:05:53,858 - INFO - validate step: 800  loss:  0.2605  memory: 73.38GiB(52.48%)  tps: 26,752
[rank3]:2025-10-29 01:05:54,047 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0105_real_step800_rank3.svg
[rank3]:> Batch Time: 627.81 ms, GPU Bubble Ratio: 32.94%, 26.85%, 36.75%, 26.80%
[rank3]:2025-10-29 01:05:54,441 - INFO - Avg. fwd time: 14.4455 / Avg. bwd time: 42.8243 / Avg. batch time: 473.7210 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:05:54,491 - INFO - Avg. fwd time: 13.0686 / Avg. bwd time: 36.3940 / Avg. batch time: 526.4637 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:05:54,537 - INFO - Avg. fwd time: 15.2481 / Avg. bwd time: 41.9463 / Avg. batch time: 587.2879 (ms) / GPU bubble ratio: 22.09%
[rank0]:2025-10-29 01:05:54,571 - INFO - Avg. fwd time: 13.7514 / Avg. bwd time: 38.6393 / Avg. batch time: 642.9548 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:08:01,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:08:04,314 - INFO -  step: 850  loss:  0.1324  grad_norm:  0.1210  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank0]:2025-10-29 01:08:04,316 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank1]:2025-10-29 01:08:04,312 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank2]:2025-10-29 01:08:04,310 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.87  mfu: 29.61%
[rank3]:2025-10-29 01:08:04,745 - INFO - Avg. fwd time: 14.4211 / Avg. bwd time: 42.8004 / Avg. batch time: 473.3121 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:08:04,841 - INFO - Avg. fwd time: 15.2276 / Avg. bwd time: 41.9321 / Avg. batch time: 586.8547 (ms) / GPU bubble ratio: 22.08%
[rank2]:2025-10-29 01:08:04,795 - INFO - Avg. fwd time: 13.0509 / Avg. bwd time: 36.3839 / Avg. batch time: 526.0503 (ms) / GPU bubble ratio: 24.82%
[rank0]:2025-10-29 01:08:04,874 - INFO - Avg. fwd time: 13.7300 / Avg. bwd time: 38.6257 / Avg. batch time: 642.4945 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:10:11,981 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:10:14,595 - INFO -  step: 900  loss:  0.1205  grad_norm:  0.1438  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 01:10:14,597 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank2]:2025-10-29 01:10:14,590 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank1]:2025-10-29 01:10:14,593 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank3]:2025-10-29 01:10:14,781 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0110_real_step900_rank3.svg
[rank3]:> Batch Time: 626.38 ms, GPU Bubble Ratio: 32.93%, 26.81%, 36.71%, 26.84%
[rank3]:2025-10-29 01:10:15,253 - INFO - Avg. fwd time: 14.3982 / Avg. bwd time: 42.7797 / Avg. batch time: 472.9430 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:10:15,297 - INFO - Avg. fwd time: 13.0339 / Avg. bwd time: 36.3752 / Avg. batch time: 525.6775 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-10-29 01:10:15,346 - INFO - Avg. fwd time: 15.2067 / Avg. bwd time: 41.9228 / Avg. batch time: 586.4700 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:10:15,391 - INFO - Avg. fwd time: 13.7093 / Avg. bwd time: 38.6151 / Avg. batch time: 642.0887 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:12:22,377 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:12:24,995 - INFO -  step: 950  loss:  0.1359  grad_norm:  0.1494  memory: 73.38GiB(52.48%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank0]:2025-10-29 01:12:24,997 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 66.72GiB(47.72%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank1]:2025-10-29 01:12:24,993 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 64.32GiB(46.00%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank2]:2025-10-29 01:12:24,990 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 57.29GiB(40.97%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank3]:2025-10-29 01:12:25,432 - INFO - Avg. fwd time: 14.3810 / Avg. bwd time: 42.7631 / Avg. batch time: 472.6571 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:12:25,527 - INFO - Avg. fwd time: 15.1923 / Avg. bwd time: 41.9148 / Avg. batch time: 586.1380 (ms) / GPU bubble ratio: 22.06%
[rank2]:2025-10-29 01:12:25,480 - INFO - Avg. fwd time: 13.0213 / Avg. bwd time: 36.3676 / Avg. batch time: 525.3573 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-10-29 01:12:25,560 - INFO - Avg. fwd time: 13.6941 / Avg. bwd time: 38.6077 / Avg. batch time: 641.7399 (ms) / GPU bubble ratio: 34.80%
[rank0]:2025-10-29 01:14:32,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:14:35,273 - INFO -  step: 1000  loss:  0.1165  grad_norm:  0.1152  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank3]:2025-10-29 01:14:35,274 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:14:35,275 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 01:14:35,275 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 01:14:35,271 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank1]:2025-10-29 01:14:35,271 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 01:14:35,268 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank2]:2025-10-29 01:14:35,269 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 01:14:50,447 - INFO - validate step: 1000  loss:  0.2591  memory: 73.38GiB(52.48%)  tps: 26,996
[rank0]:2025-10-29 01:14:50,385 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,109
[rank1]:2025-10-29 01:14:50,416 - INFO - validate step: 1000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,045
[rank2]:2025-10-29 01:14:50,429 - INFO - validate step: 1000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,018
[rank3]:2025-10-29 01:14:50,635 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0114_real_step1000_rank3.svg
[rank3]:> Batch Time: 625.19 ms, GPU Bubble Ratio: 32.91%, 26.76%, 36.68%, 26.87%
[rank3]:2025-10-29 01:14:51,022 - INFO - Avg. fwd time: 14.3610 / Avg. bwd time: 42.7461 / Avg. batch time: 472.3444 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:14:51,072 - INFO - Avg. fwd time: 13.0062 / Avg. bwd time: 36.3607 / Avg. batch time: 525.0083 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 01:14:51,151 - INFO - Avg. fwd time: 13.6766 / Avg. bwd time: 38.6010 / Avg. batch time: 641.3640 (ms) / GPU bubble ratio: 34.79%
[rank1]:2025-10-29 01:14:51,118 - INFO - Avg. fwd time: 15.1747 / Avg. bwd time: 41.9071 / Avg. batch time: 585.7797 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 01:16:58,287 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 01:17:00,912 - INFO -  step: 1050  loss:  0.1299  grad_norm:  0.1767  memory: 73.38GiB(52.48%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank2]:2025-10-29 01:17:00,908 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank1]:2025-10-29 01:17:00,910 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.79  mfu: 29.61%
[rank0]:2025-10-29 01:17:00,914 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 66.72GiB(47.72%)  tps: 6,276  tflops: 292.71  mfu: 29.60%
[rank3]:2025-10-29 01:17:01,442 - INFO - Avg. fwd time: 14.3439 / Avg. bwd time: 42.7311 / Avg. batch time: 472.0723 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:17:01,487 - INFO - Avg. fwd time: 12.9938 / Avg. bwd time: 36.3537 / Avg. batch time: 524.7383 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-29 01:17:01,537 - INFO - Avg. fwd time: 15.1593 / Avg. bwd time: 41.9001 / Avg. batch time: 585.5024 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 01:17:01,583 - INFO - Avg. fwd time: 13.6620 / Avg. bwd time: 38.5946 / Avg. batch time: 641.0734 (ms) / GPU bubble ratio: 34.79%
[rank0]:2025-10-29 01:19:08,660 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:19:11,293 - INFO -  step: 1100  loss:  0.0994  grad_norm:  0.0917  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank2]:2025-10-29 01:19:11,289 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank1]:2025-10-29 01:19:11,291 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank0]:2025-10-29 01:19:11,296 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank3]:2025-10-29 01:19:11,479 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0119_real_step1100_rank3.svg
[rank3]:> Batch Time: 624.39 ms, GPU Bubble Ratio: 32.89%, 26.74%, 36.66%, 26.90%
[rank3]:2025-10-29 01:19:11,868 - INFO - Avg. fwd time: 14.3313 / Avg. bwd time: 42.7199 / Avg. batch time: 471.8713 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:19:11,918 - INFO - Avg. fwd time: 12.9848 / Avg. bwd time: 36.3488 / Avg. batch time: 524.5133 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-29 01:19:11,964 - INFO - Avg. fwd time: 15.1482 / Avg. bwd time: 41.8941 / Avg. batch time: 585.2672 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 01:19:11,996 - INFO - Avg. fwd time: 13.6509 / Avg. bwd time: 38.5898 / Avg. batch time: 640.8277 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:21:19,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:21:21,806 - INFO -  step: 1150  loss:  0.1160  grad_norm:  0.1105  memory: 73.38GiB(52.48%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank2]:2025-10-29 01:21:21,801 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 57.29GiB(40.97%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank1]:2025-10-29 01:21:21,804 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 64.32GiB(46.00%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank0]:2025-10-29 01:21:21,808 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank3]:2025-10-29 01:21:22,247 - INFO - Avg. fwd time: 14.3182 / Avg. bwd time: 42.7074 / Avg. batch time: 471.6536 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:21:22,297 - INFO - Avg. fwd time: 12.9748 / Avg. bwd time: 36.3424 / Avg. batch time: 524.2938 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-10-29 01:21:22,343 - INFO - Avg. fwd time: 15.1365 / Avg. bwd time: 41.8871 / Avg. batch time: 585.0401 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 01:21:22,376 - INFO - Avg. fwd time: 13.6390 / Avg. bwd time: 38.5844 / Avg. batch time: 640.5904 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:23:29,554 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:23:32,195 - INFO -  step: 1200  loss:  0.1096  grad_norm:  0.1202  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:23:32,195 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 01:23:32,190 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank2]:2025-10-29 01:23:32,190 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 01:23:32,193 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 01:23:32,193 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:23:32,197 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 01:23:32,197 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 01:23:47,453 - INFO - validate step: 1200  loss:  0.2573  memory: 73.38GiB(52.48%)  tps: 26,846
[rank3]:2025-10-29 01:23:47,454 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 01:23:47,429 - INFO - validate step: 1200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,884
[rank1]:2025-10-29 01:23:47,430 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:23:47,442 - INFO - validate step: 1200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,857
[rank2]:2025-10-29 01:23:47,442 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:23:47,398 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,946
[rank0]:2025-10-29 01:23:47,399 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:23:47,403 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 01:23:58,449 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.01 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 01:24:01,144 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 01:24:01,152 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.75 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 01:24:04,065 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.64 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 01:24:04,504 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.05 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 01:24:04,586 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 01:24:04,585 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 01:24:04,585 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:24:04,760 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0124_real_step1200_rank3.svg
[rank3]:> Batch Time: 623.80 ms, GPU Bubble Ratio: 32.90%, 26.74%, 36.64%, 26.90%
[rank3]:2025-10-29 01:24:04,772 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:24:05,257 - INFO - Avg. fwd time: 14.3068 / Avg. bwd time: 42.6968 / Avg. batch time: 471.4664 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 01:24:05,303 - INFO - Avg. fwd time: 12.9668 / Avg. bwd time: 36.3363 / Avg. batch time: 524.1088 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-10-29 01:24:05,354 - INFO - Avg. fwd time: 15.1264 / Avg. bwd time: 41.8810 / Avg. batch time: 584.8491 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 01:24:05,401 - INFO - Avg. fwd time: 13.6286 / Avg. bwd time: 38.5786 / Avg. batch time: 640.3900 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:26:20,165 - INFO - [GC] Peforming periodical GC collection 1.97 seconds
[rank3]:2025-10-29 01:26:22,889 - INFO -  step: 1250  loss:  0.8588  grad_norm:  0.4771  memory: 73.38GiB(52.48%)  tps: 5,270  tflops: 245.81  mfu: 24.85%
[rank1]:2025-10-29 01:26:22,887 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 64.32GiB(46.00%)  tps: 5,270  tflops: 245.77  mfu: 24.85%
[rank0]:2025-10-29 01:26:22,892 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 66.72GiB(47.72%)  tps: 5,268  tflops: 245.72  mfu: 24.85%
[rank2]:2025-10-29 01:26:22,885 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 57.29GiB(40.97%)  tps: 5,270  tflops: 245.80  mfu: 24.85%
[rank3]:2025-10-29 01:26:23,356 - INFO - Avg. fwd time: 14.3287 / Avg. bwd time: 42.7159 / Avg. batch time: 471.9459 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 01:26:23,406 - INFO - Avg. fwd time: 12.9829 / Avg. bwd time: 36.3450 / Avg. batch time: 524.5966 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-10-29 01:26:23,454 - INFO - Avg. fwd time: 15.1456 / Avg. bwd time: 41.8897 / Avg. batch time: 585.3522 (ms) / GPU bubble ratio: 22.05%
[rank0]:2025-10-29 01:26:23,486 - INFO - Avg. fwd time: 13.6468 / Avg. bwd time: 38.5861 / Avg. batch time: 640.9109 (ms) / GPU bubble ratio: 34.80%
[rank0]:2025-10-29 01:28:35,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:28:38,406 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 57.29GiB(40.97%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank3]:2025-10-29 01:28:38,411 - INFO -  step: 1300  loss:  0.7258  grad_norm:  0.4589  memory: 73.38GiB(52.48%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank1]:2025-10-29 01:28:38,408 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 64.32GiB(46.00%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank0]:2025-10-29 01:28:38,413 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 66.72GiB(47.72%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank3]:2025-10-29 01:28:38,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0128_real_step1300_rank3.svg
[rank3]:> Batch Time: 624.84 ms, GPU Bubble Ratio: 32.91%, 26.76%, 36.66%, 26.88%
[rank3]:2025-10-29 01:28:39,015 - INFO - Avg. fwd time: 14.3524 / Avg. bwd time: 42.7384 / Avg. batch time: 472.3074 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 01:28:39,064 - INFO - Avg. fwd time: 13.0002 / Avg. bwd time: 36.3548 / Avg. batch time: 524.9680 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-29 01:28:39,112 - INFO - Avg. fwd time: 15.1664 / Avg. bwd time: 41.9016 / Avg. batch time: 585.7421 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-29 01:28:39,145 - INFO - Avg. fwd time: 13.6662 / Avg. bwd time: 38.5945 / Avg. batch time: 641.3195 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:30:51,260 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:30:53,991 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 57.29GiB(40.97%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank3]:2025-10-29 01:30:53,995 - INFO -  step: 1350  loss:  0.7554  grad_norm:  0.5214  memory: 73.38GiB(52.48%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank1]:2025-10-29 01:30:53,993 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank0]:2025-10-29 01:30:53,997 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank2]:2025-10-29 01:30:54,595 - INFO - Avg. fwd time: 13.0161 / Avg. bwd time: 36.3639 / Avg. batch time: 525.3291 (ms) / GPU bubble ratio: 24.80%
[rank3]:2025-10-29 01:30:54,549 - INFO - Avg. fwd time: 14.3734 / Avg. bwd time: 42.7593 / Avg. batch time: 472.6344 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:30:54,646 - INFO - Avg. fwd time: 15.1857 / Avg. bwd time: 41.9136 / Avg. batch time: 586.1256 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:30:54,693 - INFO - Avg. fwd time: 13.6830 / Avg. bwd time: 38.6025 / Avg. batch time: 641.7210 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 01:33:06,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:33:09,536 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 57.29GiB(40.97%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank2]:2025-10-29 01:33:09,536 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 01:33:09,540 - INFO -  step: 1400  loss:  0.7408  grad_norm:  0.4759  memory: 73.38GiB(52.48%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank3]:2025-10-29 01:33:09,541 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:09,538 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 64.32GiB(46.00%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank1]:2025-10-29 01:33:09,538 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:09,543 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 66.72GiB(47.72%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank0]:2025-10-29 01:33:09,543 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:24,655 - INFO - validate step: 1400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,096
[rank0]:2025-10-29 01:33:24,624 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,160
[rank3]:2025-10-29 01:33:24,683 - INFO - validate step: 1400  loss:  0.2538  memory: 73.38GiB(52.48%)  tps: 27,050
[rank2]:2025-10-29 01:33:24,668 - INFO - validate step: 1400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,068
[rank3]:2025-10-29 01:33:24,867 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0133_real_step1400_rank3.svg
[rank3]:> Batch Time: 626.05 ms, GPU Bubble Ratio: 32.93%, 26.80%, 36.71%, 26.85%
[rank3]:2025-10-29 01:33:25,284 - INFO - Avg. fwd time: 14.3898 / Avg. bwd time: 42.7761 / Avg. batch time: 472.8934 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:33:25,334 - INFO - Avg. fwd time: 13.0283 / Avg. bwd time: 36.3712 / Avg. batch time: 525.5939 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-10-29 01:33:25,381 - INFO - Avg. fwd time: 15.2010 / Avg. bwd time: 41.9229 / Avg. batch time: 586.4065 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:33:25,414 - INFO - Avg. fwd time: 13.6959 / Avg. bwd time: 38.6092 / Avg. batch time: 642.0156 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 01:35:37,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:35:40,319 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 57.29GiB(40.97%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank3]:2025-10-29 01:35:40,323 - INFO -  step: 1450  loss:  0.7782  grad_norm:  0.5112  memory: 73.38GiB(52.48%)  tps: 6,040  tflops: 281.69  mfu: 28.48%
[rank1]:2025-10-29 01:35:40,321 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 64.32GiB(46.00%)  tps: 6,038  tflops: 281.63  mfu: 28.48%
[rank0]:2025-10-29 01:35:40,325 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 66.72GiB(47.72%)  tps: 6,037  tflops: 281.56  mfu: 28.47%
[rank2]:2025-10-29 01:35:40,836 - INFO - Avg. fwd time: 13.0412 / Avg. bwd time: 36.3791 / Avg. batch time: 525.9164 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-10-29 01:35:40,785 - INFO - Avg. fwd time: 14.4087 / Avg. bwd time: 42.7947 / Avg. batch time: 473.1872 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:35:40,882 - INFO - Avg. fwd time: 15.2180 / Avg. bwd time: 41.9340 / Avg. batch time: 586.7492 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:35:40,916 - INFO - Avg. fwd time: 13.7106 / Avg. bwd time: 38.6171 / Avg. batch time: 642.3739 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:37:53,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:37:55,794 - INFO -  step: 1500  loss:  0.6643  grad_norm:  0.4642  memory: 73.38GiB(52.48%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank2]:2025-10-29 01:37:55,789 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 57.29GiB(40.97%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank1]:2025-10-29 01:37:55,792 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 64.32GiB(46.00%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank0]:2025-10-29 01:37:55,796 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 66.72GiB(47.72%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank3]:2025-10-29 01:37:55,980 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0137_real_step1500_rank3.svg
[rank3]:> Batch Time: 627.05 ms, GPU Bubble Ratio: 32.96%, 26.82%, 36.73%, 26.83%
[rank3]:2025-10-29 01:37:56,482 - INFO - Avg. fwd time: 14.4255 / Avg. bwd time: 42.8114 / Avg. batch time: 473.4486 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:37:56,527 - INFO - Avg. fwd time: 13.0533 / Avg. bwd time: 36.3861 / Avg. batch time: 526.2055 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:37:56,578 - INFO - Avg. fwd time: 15.2329 / Avg. bwd time: 41.9440 / Avg. batch time: 587.0549 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:37:56,624 - INFO - Avg. fwd time: 13.7238 / Avg. bwd time: 38.6238 / Avg. batch time: 642.6941 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:40:08,700 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:40:11,424 - INFO -  step: 1550  loss:  0.7235  grad_norm:  0.4610  memory: 73.38GiB(52.48%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank2]:2025-10-29 01:40:11,420 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 57.29GiB(40.97%)  tps: 6,040  tflops: 281.70  mfu: 28.48%
[rank1]:2025-10-29 01:40:11,422 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 64.32GiB(46.00%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank0]:2025-10-29 01:40:11,427 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 66.72GiB(47.72%)  tps: 6,040  tflops: 281.70  mfu: 28.48%
[rank3]:2025-10-29 01:40:11,887 - INFO - Avg. fwd time: 14.4398 / Avg. bwd time: 42.8250 / Avg. batch time: 473.6664 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:40:11,937 - INFO - Avg. fwd time: 13.0638 / Avg. bwd time: 36.3920 / Avg. batch time: 526.4287 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:40:11,984 - INFO - Avg. fwd time: 15.2462 / Avg. bwd time: 41.9524 / Avg. batch time: 587.2905 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:40:12,017 - INFO - Avg. fwd time: 13.7345 / Avg. bwd time: 38.6293 / Avg. batch time: 642.9398 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:42:23,151 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:42:25,791 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 57.29GiB(40.97%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank2]:2025-10-29 01:42:25,791 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 01:42:25,793 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 64.32GiB(46.00%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank1]:2025-10-29 01:42:25,793 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:42:25,798 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 66.72GiB(47.72%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank0]:2025-10-29 01:42:25,798 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 01:42:25,796 - INFO -  step: 1600  loss:  0.1055  grad_norm:  0.1717  memory: 73.38GiB(52.48%)  tps: 6,097  tflops: 284.35  mfu: 28.75%
[rank3]:2025-10-29 01:42:25,796 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:42:40,911 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,103
[rank3]:2025-10-29 01:42:40,968 - INFO - validate step: 1600  loss:  0.2535  memory: 73.38GiB(52.48%)  tps: 26,999
[rank2]:2025-10-29 01:42:40,955 - INFO - validate step: 1600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,012
[rank1]:2025-10-29 01:42:40,942 - INFO - validate step: 1600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,039
[rank3]:2025-10-29 01:42:41,155 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0142_real_step1600_rank3.svg
[rank3]:> Batch Time: 627.89 ms, GPU Bubble Ratio: 32.97%, 26.84%, 36.76%, 26.81%
[rank3]:2025-10-29 01:42:41,551 - INFO - Avg. fwd time: 14.4495 / Avg. bwd time: 42.8350 / Avg. batch time: 473.8171 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:42:41,600 - INFO - Avg. fwd time: 13.0709 / Avg. bwd time: 36.3958 / Avg. batch time: 526.5785 (ms) / GPU bubble ratio: 24.85%
[rank1]:2025-10-29 01:42:41,647 - INFO - Avg. fwd time: 15.2559 / Avg. bwd time: 41.9583 / Avg. batch time: 587.4475 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:42:41,680 - INFO - Avg. fwd time: 13.7422 / Avg. bwd time: 38.6337 / Avg. batch time: 643.1039 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-10-29 01:44:48,774 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 01:44:51,402 - INFO -  step: 1650  loss:  0.0896  grad_norm:  0.1604  memory: 73.38GiB(52.48%)  tps: 6,281  tflops: 292.93  mfu: 29.62%
[rank2]:2025-10-29 01:44:51,397 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank0]:2025-10-29 01:44:51,404 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 01:44:51,399 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 64.32GiB(46.00%)  tps: 6,279  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:44:51,925 - INFO - Avg. fwd time: 14.4369 / Avg. bwd time: 42.8226 / Avg. batch time: 473.6063 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:44:51,972 - INFO - Avg. fwd time: 13.0617 / Avg. bwd time: 36.3903 / Avg. batch time: 526.3651 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:44:52,025 - INFO - Avg. fwd time: 15.2443 / Avg. bwd time: 41.9513 / Avg. batch time: 587.2218 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:44:52,073 - INFO - Avg. fwd time: 13.7312 / Avg. bwd time: 38.6277 / Avg. batch time: 642.8682 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:46:59,154 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:47:01,767 - INFO -  step: 1700  loss:  0.0922  grad_norm:  0.1532  memory: 73.38GiB(52.48%)  tps: 6,284  tflops: 293.09  mfu: 29.63%
[rank2]:2025-10-29 01:47:01,762 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 57.29GiB(40.97%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank1]:2025-10-29 01:47:01,765 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 64.32GiB(46.00%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank0]:2025-10-29 01:47:01,769 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 66.72GiB(47.72%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank3]:2025-10-29 01:47:01,959 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0147_real_step1700_rank3.svg
[rank3]:> Batch Time: 627.08 ms, GPU Bubble Ratio: 32.96%, 26.82%, 36.72%, 26.83%
[rank3]:2025-10-29 01:47:02,347 - INFO - Avg. fwd time: 14.4258 / Avg. bwd time: 42.8129 / Avg. batch time: 473.4310 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:47:02,396 - INFO - Avg. fwd time: 13.0535 / Avg. bwd time: 36.3864 / Avg. batch time: 526.1711 (ms) / GPU bubble ratio: 24.83%
[rank1]:2025-10-29 01:47:02,443 - INFO - Avg. fwd time: 15.2347 / Avg. bwd time: 41.9470 / Avg. batch time: 587.0190 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:47:02,474 - INFO - Avg. fwd time: 13.7214 / Avg. bwd time: 38.6232 / Avg. batch time: 642.6559 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:49:09,619 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:49:12,230 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank0]:2025-10-29 01:49:12,237 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 66.72GiB(47.72%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank3]:2025-10-29 01:49:12,235 - INFO -  step: 1750  loss:  0.1020  grad_norm:  0.1470  memory: 73.38GiB(52.48%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank1]:2025-10-29 01:49:12,233 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 64.32GiB(46.00%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank3]:2025-10-29 01:49:12,675 - INFO - Avg. fwd time: 14.4143 / Avg. bwd time: 42.8028 / Avg. batch time: 473.2482 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:49:12,724 - INFO - Avg. fwd time: 13.0449 / Avg. bwd time: 36.3822 / Avg. batch time: 525.9862 (ms) / GPU bubble ratio: 24.82%
[rank1]:2025-10-29 01:49:12,770 - INFO - Avg. fwd time: 15.2240 / Avg. bwd time: 41.9422 / Avg. batch time: 586.8230 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:49:12,803 - INFO - Avg. fwd time: 13.7116 / Avg. bwd time: 38.6183 / Avg. batch time: 642.4504 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:51:19,934 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:51:22,555 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank2]:2025-10-29 01:51:22,555 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 01:51:22,557 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank1]:2025-10-29 01:51:22,557 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 01:51:22,560 - INFO -  step: 1800  loss:  0.0823  grad_norm:  0.1123  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.18  mfu: 29.64%
[rank3]:2025-10-29 01:51:22,560 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:51:22,562 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 01:51:22,562 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:51:37,765 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,943
[rank2]:2025-10-29 01:51:37,809 - INFO - validate step: 1800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,853
[rank1]:2025-10-29 01:51:37,798 - INFO - validate step: 1800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,876
[rank3]:2025-10-29 01:51:37,822 - INFO - validate step: 1800  loss:  0.2561  memory: 73.38GiB(52.48%)  tps: 26,840
[rank3]:2025-10-29 01:51:38,010 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0151_real_step1800_rank3.svg
[rank3]:> Batch Time: 626.41 ms, GPU Bubble Ratio: 32.94%, 26.79%, 36.72%, 26.84%
[rank2]:2025-10-29 01:51:38,531 - INFO - Avg. fwd time: 13.0363 / Avg. bwd time: 36.3781 / Avg. batch time: 525.8032 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-10-29 01:51:38,484 - INFO - Avg. fwd time: 14.4029 / Avg. bwd time: 42.7927 / Avg. batch time: 473.0673 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:51:38,584 - INFO - Avg. fwd time: 15.2134 / Avg. bwd time: 41.9369 / Avg. batch time: 586.6274 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-29 01:51:38,631 - INFO - Avg. fwd time: 13.7022 / Avg. bwd time: 38.6136 / Avg. batch time: 642.2457 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:53:45,662 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:53:48,276 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank2]:2025-10-29 01:53:48,274 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank3]:2025-10-29 01:53:48,278 - INFO -  step: 1850  loss:  0.0636  grad_norm:  0.1274  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank0]:2025-10-29 01:53:48,280 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.74  mfu: 29.60%
[rank3]:2025-10-29 01:53:48,719 - INFO - Avg. fwd time: 14.3943 / Avg. bwd time: 42.7844 / Avg. batch time: 472.9248 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:53:48,815 - INFO - Avg. fwd time: 15.2054 / Avg. bwd time: 41.9323 / Avg. batch time: 586.4552 (ms) / GPU bubble ratio: 22.06%
[rank2]:2025-10-29 01:53:48,770 - INFO - Avg. fwd time: 13.0301 / Avg. bwd time: 36.3744 / Avg. batch time: 525.6440 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 01:53:48,850 - INFO - Avg. fwd time: 13.6940 / Avg. bwd time: 38.6088 / Avg. batch time: 642.0642 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:55:56,029 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:55:58,659 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank2]:2025-10-29 01:55:58,656 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank3]:2025-10-29 01:55:58,661 - INFO -  step: 1900  loss:  0.0810  grad_norm:  0.1204  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank0]:2025-10-29 01:55:58,663 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank3]:2025-10-29 01:55:58,853 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0155_real_step1900_rank3.svg
[rank3]:> Batch Time: 625.80 ms, GPU Bubble Ratio: 32.94%, 26.79%, 36.70%, 26.86%
[rank3]:2025-10-29 01:55:59,247 - INFO - Avg. fwd time: 14.3846 / Avg. bwd time: 42.7755 / Avg. batch time: 472.7671 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:55:59,343 - INFO - Avg. fwd time: 15.1964 / Avg. bwd time: 41.9277 / Avg. batch time: 586.2670 (ms) / GPU bubble ratio: 22.05%
[rank2]:2025-10-29 01:55:59,296 - INFO - Avg. fwd time: 13.0228 / Avg. bwd time: 36.3705 / Avg. batch time: 525.4671 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-10-29 01:55:59,375 - INFO - Avg. fwd time: 13.6853 / Avg. bwd time: 38.6038 / Avg. batch time: 641.8656 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:58:06,478 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:58:09,113 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank2]:2025-10-29 01:58:09,110 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:58:09,115 - INFO -  step: 1950  loss:  0.1023  grad_norm:  0.1673  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.89  mfu: 29.61%
[rank0]:2025-10-29 01:58:09,117 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:58:09,648 - INFO - Avg. fwd time: 14.3755 / Avg. bwd time: 42.7670 / Avg. batch time: 472.6192 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:58:09,748 - INFO - Avg. fwd time: 15.1886 / Avg. bwd time: 41.9234 / Avg. batch time: 586.1070 (ms) / GPU bubble ratio: 22.05%
[rank2]:2025-10-29 01:58:09,695 - INFO - Avg. fwd time: 13.0162 / Avg. bwd time: 36.3665 / Avg. batch time: 525.3193 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-10-29 01:58:09,797 - INFO - Avg. fwd time: 13.6776 / Avg. bwd time: 38.5991 / Avg. batch time: 641.6977 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 02:00:16,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:00:19,456 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank1]:2025-10-29 02:00:19,456 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 02:00:19,453 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank2]:2025-10-29 02:00:19,453 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 02:00:19,458 - INFO -  step: 2000  loss:  0.0907  grad_norm:  0.1389  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank3]:2025-10-29 02:00:19,459 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 02:00:19,460 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank0]:2025-10-29 02:00:19,460 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 02:00:34,601 - INFO - validate step: 2000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,042
[rank0]:2025-10-29 02:00:34,557 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,132
[rank1]:2025-10-29 02:00:34,588 - INFO - validate step: 2000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,070
[rank3]:2025-10-29 02:00:34,614 - INFO - validate step: 2000  loss:  0.2573  memory: 73.38GiB(52.48%)  tps: 27,027
[rank3]:2025-10-29 02:00:34,803 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0200_real_step2000_rank3.svg
[rank3]:> Batch Time: 625.29 ms, GPU Bubble Ratio: 32.94%, 26.76%, 36.68%, 26.86%
[rank3]:2025-10-29 02:00:35,205 - INFO - Avg. fwd time: 14.3674 / Avg. bwd time: 42.7598 / Avg. batch time: 472.4899 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:00:35,254 - INFO - Avg. fwd time: 13.0101 / Avg. bwd time: 36.3635 / Avg. batch time: 525.1747 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-29 02:00:35,302 - INFO - Avg. fwd time: 15.1814 / Avg. bwd time: 41.9203 / Avg. batch time: 585.9532 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 02:00:35,334 - INFO - Avg. fwd time: 13.6703 / Avg. bwd time: 38.5952 / Avg. batch time: 641.5361 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:02:42,497 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:02:45,133 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 64.32GiB(46.00%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank2]:2025-10-29 02:02:45,131 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 57.29GiB(40.97%)  tps: 6,276  tflops: 292.71  mfu: 29.60%
[rank3]:2025-10-29 02:02:45,136 - INFO -  step: 2050  loss:  0.1219  grad_norm:  0.1369  memory: 73.38GiB(52.48%)  tps: 6,276  tflops: 292.73  mfu: 29.60%
[rank0]:2025-10-29 02:02:45,138 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 66.72GiB(47.72%)  tps: 6,274  tflops: 292.60  mfu: 29.59%
[rank3]:2025-10-29 02:02:45,574 - INFO - Avg. fwd time: 14.3597 / Avg. bwd time: 42.7523 / Avg. batch time: 472.3614 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:02:45,670 - INFO - Avg. fwd time: 15.1746 / Avg. bwd time: 41.9156 / Avg. batch time: 585.8123 (ms) / GPU bubble ratio: 22.04%
[rank2]:2025-10-29 02:02:45,623 - INFO - Avg. fwd time: 13.0045 / Avg. bwd time: 36.3603 / Avg. batch time: 525.0460 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 02:02:45,703 - INFO - Avg. fwd time: 13.6630 / Avg. bwd time: 38.5905 / Avg. batch time: 641.3869 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:04:52,810 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:04:55,416 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank3]:2025-10-29 02:04:55,421 - INFO -  step: 2100  loss:  0.1058  grad_norm:  0.1260  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank0]:2025-10-29 02:04:55,423 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank1]:2025-10-29 02:04:55,419 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank3]:2025-10-29 02:04:55,616 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0204_real_step2100_rank3.svg
[rank3]:> Batch Time: 624.84 ms, GPU Bubble Ratio: 32.93%, 26.74%, 36.66%, 26.88%
[rank3]:2025-10-29 02:04:56,093 - INFO - Avg. fwd time: 14.3518 / Avg. bwd time: 42.7450 / Avg. batch time: 472.2331 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:04:56,139 - INFO - Avg. fwd time: 12.9987 / Avg. bwd time: 36.3573 / Avg. batch time: 524.9188 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 02:04:56,239 - INFO - Avg. fwd time: 13.6563 / Avg. bwd time: 38.5869 / Avg. batch time: 641.2437 (ms) / GPU bubble ratio: 34.82%
[rank1]:2025-10-29 02:04:56,190 - INFO - Avg. fwd time: 15.1674 / Avg. bwd time: 41.9123 / Avg. batch time: 585.6756 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 02:07:03,293 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:07:05,904 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank3]:2025-10-29 02:07:05,909 - INFO -  step: 2150  loss:  0.1123  grad_norm:  0.1891  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank0]:2025-10-29 02:07:05,911 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank1]:2025-10-29 02:07:05,907 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank2]:2025-10-29 02:07:06,400 - INFO - Avg. fwd time: 12.9942 / Avg. bwd time: 36.3545 / Avg. batch time: 524.8048 (ms) / GPU bubble ratio: 24.77%
[rank3]:2025-10-29 02:07:06,351 - INFO - Avg. fwd time: 14.3458 / Avg. bwd time: 42.7391 / Avg. batch time: 472.1328 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:07:06,447 - INFO - Avg. fwd time: 15.1623 / Avg. bwd time: 41.9090 / Avg. batch time: 585.5535 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 02:07:06,480 - INFO - Avg. fwd time: 13.6509 / Avg. bwd time: 38.5836 / Avg. batch time: 641.1151 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:09:13,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:09:16,158 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 64.32GiB(46.00%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank1]:2025-10-29 02:09:16,158 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:09:16,156 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 57.29GiB(40.97%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank2]:2025-10-29 02:09:16,156 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 02:09:16,160 - INFO -  step: 2200  loss:  0.0939  grad_norm:  0.1147  memory: 73.38GiB(52.48%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank3]:2025-10-29 02:09:16,161 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 02:09:16,163 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 66.72GiB(47.72%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank0]:2025-10-29 02:09:16,163 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:09:31,357 - INFO - validate step: 2200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,946
[rank0]:2025-10-29 02:09:31,312 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,038
[rank1]:2025-10-29 02:09:31,344 - INFO - validate step: 2200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,974
[rank3]:2025-10-29 02:09:31,368 - INFO - validate step: 2200  loss:  0.2564  memory: 73.38GiB(52.48%)  tps: 26,936
[rank3]:2025-10-29 02:09:31,563 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0209_real_step2200_rank3.svg
[rank3]:> Batch Time: 624.55 ms, GPU Bubble Ratio: 32.95%, 26.76%, 36.67%, 26.88%
[rank3]:2025-10-29 02:09:31,956 - INFO - Avg. fwd time: 14.3379 / Avg. bwd time: 42.7322 / Avg. batch time: 472.0080 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:09:32,007 - INFO - Avg. fwd time: 12.9882 / Avg. bwd time: 36.3518 / Avg. batch time: 524.6634 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-29 02:09:32,052 - INFO - Avg. fwd time: 15.1552 / Avg. bwd time: 41.9057 / Avg. batch time: 585.4039 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:09:32,083 - INFO - Avg. fwd time: 13.6438 / Avg. bwd time: 38.5799 / Avg. batch time: 640.9575 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:11:39,145 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:11:41,763 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 57.29GiB(40.97%)  tps: 6,282  tflops: 292.99  mfu: 29.62%
[rank0]:2025-10-29 02:11:41,770 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 66.72GiB(47.72%)  tps: 6,279  tflops: 292.87  mfu: 29.61%
[rank1]:2025-10-29 02:11:41,766 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 64.32GiB(46.00%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank3]:2025-10-29 02:11:41,768 - INFO -  step: 2250  loss:  0.1085  grad_norm:  0.1608  memory: 73.38GiB(52.48%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank3]:2025-10-29 02:11:42,299 - INFO - Avg. fwd time: 14.3307 / Avg. bwd time: 42.7255 / Avg. batch time: 471.8911 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:11:42,348 - INFO - Avg. fwd time: 12.9828 / Avg. bwd time: 36.3487 / Avg. batch time: 524.5479 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-29 02:11:42,403 - INFO - Avg. fwd time: 15.1486 / Avg. bwd time: 41.9023 / Avg. batch time: 585.2801 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:11:42,452 - INFO - Avg. fwd time: 13.6370 / Avg. bwd time: 38.5756 / Avg. batch time: 640.8262 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:13:49,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:13:52,095 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank2]:2025-10-29 02:13:52,092 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank3]:2025-10-29 02:13:52,098 - INFO -  step: 2300  loss:  0.0830  grad_norm:  0.1165  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 02:13:52,099 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank3]:2025-10-29 02:13:52,292 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0213_real_step2300_rank3.svg
[rank3]:> Batch Time: 624.16 ms, GPU Bubble Ratio: 32.94%, 26.73%, 36.65%, 26.89%
[rank2]:2025-10-29 02:13:52,733 - INFO - Avg. fwd time: 12.9789 / Avg. bwd time: 36.3461 / Avg. batch time: 524.4465 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-10-29 02:13:52,686 - INFO - Avg. fwd time: 14.3253 / Avg. bwd time: 42.7204 / Avg. batch time: 471.8020 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:13:52,782 - INFO - Avg. fwd time: 15.1435 / Avg. bwd time: 41.8996 / Avg. batch time: 585.1719 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:13:52,813 - INFO - Avg. fwd time: 13.6313 / Avg. bwd time: 38.5718 / Avg. batch time: 640.7104 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:15:59,946 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:16:02,591 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 02:16:02,587 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank2]:2025-10-29 02:16:02,584 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank3]:2025-10-29 02:16:02,589 - INFO -  step: 2350  loss:  0.0948  grad_norm:  0.0993  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank3]:2025-10-29 02:16:03,038 - INFO - Avg. fwd time: 14.3188 / Avg. bwd time: 42.7147 / Avg. batch time: 471.6987 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:16:03,087 - INFO - Avg. fwd time: 12.9742 / Avg. bwd time: 36.3436 / Avg. batch time: 524.3438 (ms) / GPU bubble ratio: 24.76%
[rank0]:2025-10-29 02:16:03,165 - INFO - Avg. fwd time: 13.6264 / Avg. bwd time: 38.5697 / Avg. batch time: 640.5943 (ms) / GPU bubble ratio: 34.82%
[rank1]:2025-10-29 02:16:03,133 - INFO - Avg. fwd time: 15.1380 / Avg. bwd time: 41.8965 / Avg. batch time: 585.0610 (ms) / GPU bubble ratio: 22.01%
[rank0]:2025-10-29 02:18:10,328 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:18:12,972 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank2]:2025-10-29 02:18:12,972 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.75  mfu: 28.68%
[rank3]:2025-10-29 02:18:12,976 - INFO -  step: 2400  loss:  0.0983  grad_norm:  0.1400  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank2]:2025-10-29 02:18:12,972 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 02:18:12,977 - INFO -  final step: 2400  loss:  0.0983  grad_norm:  0.1400  tps: 6,300  tflops: 293.85  mfu: 28.69%
[rank3]:2025-10-29 02:18:12,977 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 02:18:12,974 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 02:18:12,974 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.74  mfu: 28.68%
[rank1]:2025-10-29 02:18:12,974 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:18:12,978 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 02:18:12,979 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.75  mfu: 28.68%
[rank0]:2025-10-29 02:18:12,979 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 02:18:28,398 - INFO - validate step: 2400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,553
[rank2]:2025-10-29 02:18:28,399 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:18:28,386 - INFO - validate step: 2400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,577
[rank1]:2025-10-29 02:18:28,387 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:18:28,391 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 02:18:28,353 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,642
[rank0]:2025-10-29 02:18:28,354 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:18:28,358 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 02:18:28,402 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 02:18:28,415 - INFO - validate step: 2400  loss:  0.2552  memory: 73.38GiB(52.48%)  tps: 26,535
[rank3]:2025-10-29 02:18:28,416 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 02:18:28,421 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 02:18:39,081 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 02:18:39,081 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 02:18:39,051 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 02:18:39,081 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 02:18:39,381 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0218_real_final2400_rank3.svg
[rank3]:> Batch Time: 623.91 ms, GPU Bubble Ratio: 32.93%, 26.72%, 36.65%, 26.89%
[rank3]:2025-10-29 02:18:39,620 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0218_thry_final2400_rank3.svg
[rank3]:> Batch Time: 460.91 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 02:18:39,620 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–…â–„â–…â–„â–„â–â–â–â–â–â–â–â–â–â–‚â–â–‚â–â–â–„â–„â–„â–„â–„â–‚â–‚â–‚â–‚â–â–â–‚â–â–â–‚â–â–‚â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–†â–‡â–‡â–†â–†â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–†â–†â–†â–†â–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–‡â–‡â–†â–†â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–‡â–†â–†â–†â–…â–†â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.6005
[rank3]:wandb:               final/avg_loss 0.09827
[rank3]:wandb:             final/avg_mfu(%) 28.69405
[rank3]:wandb:             final/avg_tflops 293.84804
[rank3]:wandb:    final/avg_throughput(tps) 6300.32227
[rank3]:wandb:              final/grad_norm 0.13997
[rank3]:wandb:               final/max_loss 0.09827
[rank3]:wandb:                    grad_norm 0.13997
[rank3]:wandb: loss_metrics/global_avg_loss 0.09827
[rank3]:wandb: loss_metrics/global_max_loss 0.09827
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/k3khcbe8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_nofreeze_dm1/20251029-0029/wandb/run-20251029_002911-k3khcbe8/logs
[rank0]:2025-10-29 02:18:41,081 - INFO - Training completed
[rank0]:2025-10-29 02:18:41,081 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 02:18:41,368 - INFO - Process group destroyed
[rank3]:2025-10-29 02:18:41,356 - INFO - Process group destroyed
[rank1]:2025-10-29 02:18:41,356 - INFO - Process group destroyed
[rank0]:2025-10-29 02:18:41,647 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.17', 'layers.18', 'layers.21', 'layers.20', 'layers.23', 'layers.22', 'layers.24'}
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.8', 'layers.10', 'layers.14', 'layers.15', 'layers.11', 'layers.13', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.0', 'layers.5', 'layers.7', 'layers.6', 'layers.3', 'layers.1', 'layers.2', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'layers.26', 'norm', 'layers.29', 'layers.30', 'layers.28', 'layers.31', 'output', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
