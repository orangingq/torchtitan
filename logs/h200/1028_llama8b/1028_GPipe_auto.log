
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 02:11:02 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] 
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] *****************************************
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 02:11:09,308 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 02:11:09,459 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 02:11:09,510 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 02:11:09,501 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 02:11:10,261 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 02:11:10,263 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:10,536 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 02:11:10,539 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:10,544 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 02:11:10,541 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 02:11:10,544 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 02:11:10,517 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 02:11:10,519 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:12,472 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 02:11:12,762 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 02:11:14,298 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 02:11:15,685 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 02:11:15,962 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 02:11:15,931 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:11:16,016 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 02:11:16,040 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 02:11:16,040 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 02:11:16,015 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 02:11:16,015 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 02:11:16,338 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:11:16,303 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 02:11:16,303 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 02:11:16,286 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 02:11:16,287 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 02:11:16,416 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 02:11:16,416 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 02:11:16,628 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 02:11:16,628 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run zn6bleq8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1/20251029-0211/wandb/run-20251029_021116-zn6bleq8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/zn6bleq8
[rank3]:2025-10-29 02:11:17,843 - INFO - WandB logging enabled
[rank3]:2025-10-29 02:11:17,846 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 02:11:17,920 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 02:11:17,921 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 02:11:18,269 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 02:11:18,270 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-29 02:11:18,286 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank0]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:11:18,287 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:11:22,191 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 02:11:22,191 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 02:11:31,708 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 02:11:31,709 - INFO - Finished loading the checkpoint in 9.52 seconds.
[rank0]:2025-10-29 02:11:31,709 - INFO - Training starts at step 1
[rank3]:2025-10-29 02:11:36,590 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.4601  memory: 58.03GiB(41.50%)  tps: 876  tflops: 40.88  mfu: 4.13%
[rank3]:2025-10-29 02:11:36,590 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 02:11:36,585 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 44.28GiB(31.67%)  tps: 795  tflops: 37.09  mfu: 3.75%
[rank2]:2025-10-29 02:11:36,586 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 02:11:36,588 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 49.69GiB(35.54%)  tps: 811  tflops: 37.84  mfu: 3.83%
[rank1]:2025-10-29 02:11:36,588 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 02:11:36,608 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 49.75GiB(35.58%)  tps: 796  tflops: 37.11  mfu: 3.75%
[rank0]:2025-10-29 02:11:36,609 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 02:11:54,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,975 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,013 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,013 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:13:46,437 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:13:49,168 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 57.29GiB(40.97%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank3]:2025-10-29 02:13:49,173 - INFO -  step: 50  loss:  3.2742  grad_norm: 16.2025  memory: 73.38GiB(52.48%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank0]:2025-10-29 02:13:49,175 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 66.72GiB(47.72%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank1]:2025-10-29 02:13:49,170 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 64.32GiB(46.00%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank2]:2025-10-29 02:13:49,687 - INFO - Avg. fwd time: 13.3889 / Avg. bwd time: 36.5073 / Avg. batch time: 537.9116 (ms) / GPU bubble ratio: 25.79%
[rank3]:2025-10-29 02:13:49,636 - INFO - Avg. fwd time: 14.8073 / Avg. bwd time: 43.1226 / Avg. batch time: 484.7709 (ms) / GPU bubble ratio: 4.40%
[rank0]:2025-10-29 02:13:49,766 - INFO - Avg. fwd time: 14.2094 / Avg. bwd time: 38.1518 / Avg. batch time: 653.1204 (ms) / GPU bubble ratio: 35.86%
[rank1]:2025-10-29 02:13:49,733 - INFO - Avg. fwd time: 15.1821 / Avg. bwd time: 40.9727 / Avg. batch time: 597.7095 (ms) / GPU bubble ratio: 24.84%
[rank0]:2025-10-29 02:14:16,248 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-29 02:14:16,240 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 02:14:16,244 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 02:14:16,244 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 02:14:43,356 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7274e+02
[rank0]:2025-10-29 02:14:43,360 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.5840e+02
[rank2]:2025-10-29 02:14:43,352 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.8365e+02
[rank1]:2025-10-29 02:14:43,355 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7263e+02
[rank3]:2025-10-29 02:15:09,338 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.7156e-01
[rank1]:2025-10-29 02:15:09,325 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9982e-01
[rank0]:2025-10-29 02:15:09,336 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0424e+00
[rank2]:2025-10-29 02:15:09,325 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.1885e-01
[rank1]:2025-10-29 02:15:35,971 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2171e+00
[rank3]:2025-10-29 02:15:35,965 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5224e+00
[rank0]:2025-10-29 02:15:35,975 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.0942e+00
[rank2]:2025-10-29 02:15:35,968 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.2875e+00
[rank0]:2025-10-29 02:15:59,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:16:01,997 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1782e+00
[rank0]:2025-10-29 02:16:01,998 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 68.59GiB(49.06%)  tps: 6,168  tflops: 287.66  mfu: 29.09%
[rank1]:2025-10-29 02:16:01,987 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7484e+00
[rank1]:2025-10-29 02:16:01,987 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 68.17GiB(48.76%)  tps: 6,168  tflops: 287.67  mfu: 29.09%
[rank3]:2025-10-29 02:16:01,999 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.3997e+00
[rank3]:2025-10-29 02:16:02,002 - INFO -  step: 100  loss:  1.3475  grad_norm: 11.1621  memory: 75.33GiB(53.88%)  tps: 6,167  tflops: 287.65  mfu: 29.08%
[rank2]:2025-10-29 02:16:01,987 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2081e+00
[rank2]:2025-10-29 02:16:01,987 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 60.18GiB(43.04%)  tps: 6,168  tflops: 287.67  mfu: 29.09%
[rank0]:2025-10-29 02:16:02,079 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0216_stage0_step100.svg
[rank1]:2025-10-29 02:16:02,082 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0216_stage1_step100.svg
[rank2]:2025-10-29 02:16:02,083 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0216_stage2_step100.svg
[rank3]:2025-10-29 02:16:02,192 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0216_real_step100_rank3.svg
[rank3]:> Batch Time: 632.94 ms, GPU Bubble Ratio: 33.81%, 28.27%, 36.50%, 26.23%
[rank3]:2025-10-29 02:16:02,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0216_stage3_step100.svg
[rank3]:2025-10-29 02:16:02,607 - INFO - Avg. fwd time: 14.9305 / Avg. bwd time: 42.7448 / Avg. batch time: 479.5341 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-29 02:16:02,674 - INFO - Avg. fwd time: 13.5880 / Avg. bwd time: 35.1947 / Avg. batch time: 531.2047 (ms) / GPU bubble ratio: 26.53%
[rank0]:2025-10-29 02:16:02,774 - INFO - Avg. fwd time: 14.1350 / Avg. bwd time: 37.3297 / Avg. batch time: 645.9271 (ms) / GPU bubble ratio: 36.26%
[rank1]:2025-10-29 02:16:02,742 - INFO - Avg. fwd time: 15.4828 / Avg. bwd time: 39.2713 / Avg. batch time: 591.5368 (ms) / GPU bubble ratio: 25.95%
[rank0]:2025-10-29 02:16:28,723 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.3170e+00
[rank3]:2025-10-29 02:16:28,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2520e+00
[rank1]:2025-10-29 02:16:28,719 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.8909e-01
[rank2]:2025-10-29 02:16:28,716 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.4083e+00
[rank0]:2025-10-29 02:16:54,738 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1622e+00
[rank1]:2025-10-29 02:16:54,728 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7047e+00
[rank3]:2025-10-29 02:16:54,740 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8783e+00
[rank2]:2025-10-29 02:16:54,728 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0175e+00
[rank0]:2025-10-29 02:17:21,260 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.7555e+02
[rank1]:2025-10-29 02:17:21,256 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6905e+02
[rank3]:2025-10-29 02:17:21,247 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2898e+02
[rank2]:2025-10-29 02:17:21,253 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.5757e+02
[rank0]:2025-10-29 02:17:45,052 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.7739e+00
[rank3]:2025-10-29 02:17:45,044 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.4225e+00
[rank1]:2025-10-29 02:17:45,041 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.7504e+00
[rank2]:2025-10-29 02:17:45,041 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7155e+00
[rank0]:2025-10-29 02:18:08,944 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:18:11,634 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.4622e+02
[rank0]:2025-10-29 02:18:11,635 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 68.59GiB(49.06%)  tps: 6,319  tflops: 294.73  mfu: 29.80%
[rank3]:2025-10-29 02:18:11,621 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.9254e+02
[rank3]:2025-10-29 02:18:11,623 - INFO -  step: 150  loss:  0.9535  grad_norm:  0.7350  memory: 76.44GiB(54.68%)  tps: 6,320  tflops: 294.77  mfu: 29.80%
[rank1]:2025-10-29 02:18:11,630 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4972e+02
[rank1]:2025-10-29 02:18:11,631 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 68.17GiB(48.76%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-29 02:18:11,627 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 3.4392e+02
[rank2]:2025-10-29 02:18:11,627 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 60.18GiB(43.04%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank3]:2025-10-29 02:18:12,129 - INFO - Avg. fwd time: 15.1329 / Avg. bwd time: 40.8857 / Avg. batch time: 465.2935 (ms) / GPU bubble ratio: 3.68%
[rank1]:2025-10-29 02:18:12,199 - INFO - Avg. fwd time: 15.6071 / Avg. bwd time: 38.4755 / Avg. batch time: 583.6389 (ms) / GPU bubble ratio: 25.87%
[rank2]:2025-10-29 02:18:12,163 - INFO - Avg. fwd time: 13.6565 / Avg. bwd time: 34.6350 / Avg. batch time: 519.1640 (ms) / GPU bubble ratio: 25.59%
[rank0]:2025-10-29 02:18:12,237 - INFO - Avg. fwd time: 14.1292 / Avg. bwd time: 36.9470 / Avg. batch time: 637.6037 (ms) / GPU bubble ratio: 35.91%
[rank3]:2025-10-29 02:18:35,388 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4385e+00
[rank0]:2025-10-29 02:18:35,389 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4378e-01
[rank1]:2025-10-29 02:18:35,379 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.3687e-01
[rank2]:2025-10-29 02:18:35,379 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0430e+00
[rank3]:2025-10-29 02:19:02,002 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.7472e+00
[rank0]:2025-10-29 02:19:02,018 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.8663e+00
[rank1]:2025-10-29 02:19:02,014 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.3590e+00
[rank2]:2025-10-29 02:19:02,011 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 7.3637e+00
[rank3]:2025-10-29 02:19:25,708 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.1595e+01
[rank0]:2025-10-29 02:19:25,715 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.1918e+01
[rank2]:2025-10-29 02:19:25,705 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0482e+01
[rank1]:2025-10-29 02:19:25,705 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5613e+01
[rank2]:2025-10-29 02:19:48,627 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 6.6895e-01
[rank3]:2025-10-29 02:19:48,630 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5057e+00
[rank0]:2025-10-29 02:19:48,641 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 2.8047e+00
[rank1]:2025-10-29 02:19:48,624 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0030e+00
[rank0]:2025-10-29 02:20:10,072 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:20:12,465 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.1339e+00
[rank3]:2025-10-29 02:20:12,467 - INFO -  step: 200  loss:  0.9658  grad_norm: 22.3585  memory: 77.56GiB(55.47%)  tps: 6,779  tflops: 316.18  mfu: 31.97%
[rank3]:2025-10-29 02:20:12,467 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 02:20:12,461 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.2860e+00
[rank2]:2025-10-29 02:20:12,462 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 61.15GiB(43.74%)  tps: 6,780  tflops: 316.20  mfu: 31.97%
[rank2]:2025-10-29 02:20:12,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:20:12,472 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.5390e+00
[rank0]:2025-10-29 02:20:12,472 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 68.59GiB(49.06%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank0]:2025-10-29 02:20:12,473 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 02:20:12,461 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.4459e+00
[rank1]:2025-10-29 02:20:12,462 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 70.12GiB(50.15%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank1]:2025-10-29 02:20:12,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:20:30,374 - INFO - validate step: 200  loss: -1.0000  memory: 68.59GiB(49.06%)  tps: 22,881
[rank2]:2025-10-29 02:20:30,423 - INFO - validate step: 200  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 22,806
[rank1]:2025-10-29 02:20:30,408 - INFO - validate step: 200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 22,824
[rank3]:2025-10-29 02:20:30,434 - INFO - validate step: 200  loss:  0.2701  memory: 77.56GiB(55.47%)  tps: 22,798
[rank0]:2025-10-29 02:20:30,515 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0220_stage0_step200.svg
[rank2]:2025-10-29 02:20:30,510 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0220_stage2_step200.svg
[rank1]:2025-10-29 02:20:30,515 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0220_stage1_step200.svg
[rank3]:2025-10-29 02:20:30,618 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0220_real_step200_rank3.svg
[rank3]:> Batch Time: 625.57 ms, GPU Bubble Ratio: 33.78%, 28.23%, 36.49%, 26.48%
[rank3]:2025-10-29 02:20:30,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0220_stage3_step200.svg
[rank3]:2025-10-29 02:20:31,024 - INFO - Avg. fwd time: 15.2802 / Avg. bwd time: 39.3765 / Avg. batch time: 453.9706 (ms) / GPU bubble ratio: 3.68%
[rank0]:2025-10-29 02:20:31,118 - INFO - Avg. fwd time: 14.1713 / Avg. bwd time: 36.4104 / Avg. batch time: 624.2830 (ms) / GPU bubble ratio: 35.18%
[rank2]:2025-10-29 02:20:31,059 - INFO - Avg. fwd time: 13.7691 / Avg. bwd time: 33.6257 / Avg. batch time: 507.7970 (ms) / GPU bubble ratio: 25.33%
[rank1]:2025-10-29 02:20:31,087 - INFO - Avg. fwd time: 15.7774 / Avg. bwd time: 37.0231 / Avg. batch time: 570.5100 (ms) / GPU bubble ratio: 25.96%
[rank3]:2025-10-29 02:20:53,129 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.4015e+01
[rank2]:2025-10-29 02:20:53,125 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2800e+02
[rank0]:2025-10-29 02:20:53,136 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4562e+02
[rank1]:2025-10-29 02:20:53,122 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4512e+02
[rank2]:2025-10-29 02:21:14,824 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.8613e+00
[rank3]:2025-10-29 02:21:14,824 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.7315e+00
[rank0]:2025-10-29 02:21:14,831 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.6808e+00
[rank1]:2025-10-29 02:21:14,822 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5777e+00
[rank2]:2025-10-29 02:21:37,246 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8602e+00
[rank3]:2025-10-29 02:21:37,252 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9319e+00
[rank0]:2025-10-29 02:21:37,259 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4539e+00
[rank1]:2025-10-29 02:21:37,242 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1790e+00
[rank2]:2025-10-29 02:21:58,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2830e-01
[rank3]:2025-10-29 02:21:58,815 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 8.3866e-01
[rank1]:2025-10-29 02:21:58,812 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5958e-01
[rank0]:2025-10-29 02:21:58,819 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.9544e-01
[rank0]:2025-10-29 02:22:18,960 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:22:21,197 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3003e+00
[rank2]:2025-10-29 02:22:21,197 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 63.09GiB(45.12%)  tps: 7,395  tflops: 344.92  mfu: 34.88%
[rank3]:2025-10-29 02:22:21,207 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.0452e+00
[rank3]:2025-10-29 02:22:21,209 - INFO -  step: 250  loss:  0.9395  grad_norm:  1.6791  memory: 78.44GiB(56.10%)  tps: 7,395  tflops: 344.92  mfu: 34.88%
[rank1]:2025-10-29 02:22:21,197 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6224e+00
[rank1]:2025-10-29 02:22:21,197 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 71.10GiB(50.85%)  tps: 7,394  tflops: 344.87  mfu: 34.87%
[rank0]:2025-10-29 02:22:21,214 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.2150e+00
[rank0]:2025-10-29 02:22:21,214 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 71.50GiB(51.14%)  tps: 7,391  tflops: 344.71  mfu: 34.85%
[rank3]:2025-10-29 02:22:21,589 - INFO - Avg. fwd time: 15.4396 / Avg. bwd time: 37.8722 / Avg. batch time: 442.9131 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-29 02:22:21,627 - INFO - Avg. fwd time: 13.9437 / Avg. bwd time: 31.8916 / Avg. batch time: 494.2708 (ms) / GPU bubble ratio: 25.81%
[rank1]:2025-10-29 02:22:21,655 - INFO - Avg. fwd time: 16.0571 / Avg. bwd time: 34.5664 / Avg. batch time: 552.9048 (ms) / GPU bubble ratio: 26.75%
[rank0]:2025-10-29 02:22:21,675 - INFO - Avg. fwd time: 14.3236 / Avg. bwd time: 34.9814 / Avg. batch time: 605.1592 (ms) / GPU bubble ratio: 34.82%
[rank3]:2025-10-29 02:22:42,815 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.0625e+00
[rank0]:2025-10-29 02:22:42,819 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.8112e+00
[rank2]:2025-10-29 02:22:42,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3229e+00
[rank1]:2025-10-29 02:22:42,812 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.2947e+00
[rank0]:2025-10-29 02:23:05,115 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.2581e-01
[rank2]:2025-10-29 02:23:05,098 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2533e-01
[rank3]:2025-10-29 02:23:05,108 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1378e-01
[rank1]:2025-10-29 02:23:05,098 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.6581e-01
[rank2]:2025-10-29 02:23:26,767 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0250e-01
[rank3]:2025-10-29 02:23:26,767 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.7917e-01
[rank1]:2025-10-29 02:23:26,764 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.1507e-01
[rank0]:2025-10-29 02:23:26,771 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0972e-01
[rank2]:2025-10-29 02:23:49,013 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1638e-01
[rank3]:2025-10-29 02:23:49,022 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.8524e-01
[rank0]:2025-10-29 02:23:49,029 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.1498e-01
[rank1]:2025-10-29 02:23:49,012 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.0781e-01
[rank0]:2025-10-29 02:24:08,451 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:24:10,612 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.6271e-01
[rank0]:2025-10-29 02:24:10,613 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 71.50GiB(51.14%)  tps: 7,488  tflops: 349.25  mfu: 35.31%
[rank0]:2025-10-29 02:24:10,685 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0224_stage0_step300.svg
[rank1]:2025-10-29 02:24:10,605 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.8337e-01
[rank1]:2025-10-29 02:24:10,606 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 71.10GiB(50.85%)  tps: 7,488  tflops: 349.22  mfu: 35.31%
[rank1]:2025-10-29 02:24:10,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0224_stage1_step300.svg
[rank3]:2025-10-29 02:24:10,608 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.6101e-01
[rank3]:2025-10-29 02:24:10,611 - INFO -  step: 300  loss:  0.8594  grad_norm:  1.0256  memory: 78.44GiB(56.10%)  tps: 7,488  tflops: 349.25  mfu: 35.31%
[rank2]:2025-10-29 02:24:10,608 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4709e-01
[rank2]:2025-10-29 02:24:10,609 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 63.09GiB(45.12%)  tps: 7,487  tflops: 349.21  mfu: 35.31%
[rank2]:2025-10-29 02:24:10,691 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0224_stage2_step300.svg
[rank3]:2025-10-29 02:24:10,792 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0224_real_step300_rank3.svg
[rank3]:> Batch Time: 556.19 ms, GPU Bubble Ratio: 31.00%, 31.81%, 37.82%, 26.28%
[rank3]:2025-10-29 02:24:10,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0224_stage3_step300.svg
[rank3]:2025-10-29 02:24:11,295 - INFO - Avg. fwd time: 15.5611 / Avg. bwd time: 36.7702 / Avg. batch time: 434.8807 (ms) / GPU bubble ratio: 3.73%
[rank0]:2025-10-29 02:24:11,386 - INFO - Avg. fwd time: 14.4432 / Avg. bwd time: 33.7504 / Avg. batch time: 591.2458 (ms) / GPU bubble ratio: 34.79%
[rank1]:2025-10-29 02:24:11,350 - INFO - Avg. fwd time: 16.2492 / Avg. bwd time: 32.8442 / Avg. batch time: 540.2995 (ms) / GPU bubble ratio: 27.31%
[rank2]:2025-10-29 02:24:11,322 - INFO - Avg. fwd time: 14.0778 / Avg. bwd time: 30.5568 / Avg. batch time: 484.4423 (ms) / GPU bubble ratio: 26.29%
[rank0]:2025-10-29 02:24:33,159 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5250e-01
[rank2]:2025-10-29 02:24:33,142 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7319e-01
[rank1]:2025-10-29 02:24:33,142 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5486e-01
[rank3]:2025-10-29 02:24:33,152 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5044e+00
[rank1]:2025-10-29 02:24:54,700 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.0452e-01
[rank2]:2025-10-29 02:24:54,703 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9386e-01
[rank3]:2025-10-29 02:24:54,703 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6029e+00
[rank0]:2025-10-29 02:24:54,707 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8229e-01
[rank1]:2025-10-29 02:25:16,994 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4364e+00
[rank2]:2025-10-29 02:25:16,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5397e+00
[rank3]:2025-10-29 02:25:17,004 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3339e+00
[rank0]:2025-10-29 02:25:17,011 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9302e+00
[rank2]:2025-10-29 02:25:38,606 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4230e+00
[rank1]:2025-10-29 02:25:38,602 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.8924e+00
[rank3]:2025-10-29 02:25:38,606 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.6484e+00
[rank0]:2025-10-29 02:25:38,610 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.2789e+00
[rank0]:2025-10-29 02:25:58,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:26:00,868 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9796e-01
[rank2]:2025-10-29 02:26:00,869 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 63.09GiB(45.12%)  tps: 7,430  tflops: 346.52  mfu: 35.04%
[rank1]:2025-10-29 02:26:00,868 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2538e-01
[rank1]:2025-10-29 02:26:00,869 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 71.10GiB(50.85%)  tps: 7,430  tflops: 346.52  mfu: 35.04%
[rank3]:2025-10-29 02:26:00,878 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.7506e-01
[rank3]:2025-10-29 02:26:00,881 - INFO -  step: 350  loss:  0.8901  grad_norm:  0.4211  memory: 78.44GiB(56.10%)  tps: 7,429  tflops: 346.50  mfu: 35.03%
[rank0]:2025-10-29 02:26:00,885 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4457e-01
[rank0]:2025-10-29 02:26:00,886 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 71.50GiB(51.14%)  tps: 7,429  tflops: 346.48  mfu: 35.03%
[rank3]:2025-10-29 02:26:01,268 - INFO - Avg. fwd time: 15.6320 / Avg. bwd time: 36.1363 / Avg. batch time: 430.2635 (ms) / GPU bubble ratio: 3.75%
[rank1]:2025-10-29 02:26:01,334 - INFO - Avg. fwd time: 16.3753 / Avg. bwd time: 31.7416 / Avg. batch time: 532.6477 (ms) / GPU bubble ratio: 27.73%
[rank0]:2025-10-29 02:26:01,355 - INFO - Avg. fwd time: 14.5119 / Avg. bwd time: 33.0805 / Avg. batch time: 582.8811 (ms) / GPU bubble ratio: 34.68%
[rank2]:2025-10-29 02:26:01,307 - INFO - Avg. fwd time: 14.1723 / Avg. bwd time: 29.6481 / Avg. batch time: 478.5461 (ms) / GPU bubble ratio: 26.74%
[rank2]:2025-10-29 02:26:22,523 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1007e-01
[rank1]:2025-10-29 02:26:22,520 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.6426e-01
[rank3]:2025-10-29 02:26:22,523 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0780e+00
[rank0]:2025-10-29 02:26:22,527 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1304e+00
[rank1]:2025-10-29 02:26:44,775 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5026e+00
[rank0]:2025-10-29 02:26:44,792 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2011e+00
[rank3]:2025-10-29 02:26:44,785 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.9115e-01
[rank2]:2025-10-29 02:26:44,775 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.7358e-01
[rank0]:2025-10-29 02:27:06,369 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.9842e-01
[rank1]:2025-10-29 02:27:06,362 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.0662e-01
[rank3]:2025-10-29 02:27:06,366 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.5567e-01
[rank2]:2025-10-29 02:27:06,366 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9835e-01
[rank2]:2025-10-29 02:27:28,470 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2580e+00
[rank1]:2025-10-29 02:27:28,470 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.0987e+00
[rank3]:2025-10-29 02:27:28,480 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7530e+00
[rank0]:2025-10-29 02:27:28,487 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2740e+00
[rank0]:2025-10-29 02:27:46,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:27:48,985 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.3665e+00
[rank2]:2025-10-29 02:27:48,985 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3778e+00
[rank2]:2025-10-29 02:27:48,985 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 63.09GiB(45.12%)  tps: 7,577  tflops: 353.40  mfu: 35.73%
[rank2]:2025-10-29 02:27:48,985 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 02:27:48,981 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.6782e+00
[rank1]:2025-10-29 02:27:48,982 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 71.10GiB(50.85%)  tps: 7,577  tflops: 353.40  mfu: 35.73%
[rank1]:2025-10-29 02:27:48,982 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 02:27:48,989 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3257e+00
[rank0]:2025-10-29 02:27:48,989 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 71.50GiB(51.14%)  tps: 7,578  tflops: 353.44  mfu: 35.74%
[rank0]:2025-10-29 02:27:48,989 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:27:48,987 - INFO -  step: 400  loss:  0.1203  grad_norm:  0.2912  memory: 78.44GiB(56.10%)  tps: 7,578  tflops: 353.43  mfu: 35.74%
[rank3]:2025-10-29 02:27:48,987 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:28:05,372 - INFO - validate step: 400  loss:  0.2434  memory: 78.44GiB(56.10%)  tps: 24,999
[rank0]:2025-10-29 02:28:05,313 - INFO - validate step: 400  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 25,093
[rank1]:2025-10-29 02:28:05,346 - INFO - validate step: 400  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,030
[rank2]:2025-10-29 02:28:05,362 - INFO - validate step: 400  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,011
[rank0]:2025-10-29 02:28:05,456 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0228_stage0_step400.svg
[rank1]:2025-10-29 02:28:05,459 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0228_stage1_step400.svg
[rank2]:2025-10-29 02:28:05,454 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0228_stage2_step400.svg
[rank3]:2025-10-29 02:28:05,547 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0228_real_step400_rank3.svg
[rank3]:> Batch Time: 534.10 ms, GPU Bubble Ratio: 29.22%, 35.62%, 38.31%, 26.27%
[rank3]:2025-10-29 02:28:05,620 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0228_stage3_step400.svg
[rank3]:2025-10-29 02:28:05,940 - INFO - Avg. fwd time: 15.6728 / Avg. bwd time: 35.5221 / Avg. batch time: 425.5715 (ms) / GPU bubble ratio: 3.76%
[rank1]:2025-10-29 02:28:05,992 - INFO - Avg. fwd time: 16.4673 / Avg. bwd time: 30.7874 / Avg. batch time: 525.3271 (ms) / GPU bubble ratio: 28.04%
[rank2]:2025-10-29 02:28:05,965 - INFO - Avg. fwd time: 14.2338 / Avg. bwd time: 28.8938 / Avg. batch time: 472.7635 (ms) / GPU bubble ratio: 27.02%
[rank0]:2025-10-29 02:28:06,026 - INFO - Avg. fwd time: 14.5595 / Avg. bwd time: 32.4233 / Avg. batch time: 574.8486 (ms) / GPU bubble ratio: 34.62%
[rank3]:2025-10-29 02:28:26,706 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8239e+00
[rank2]:2025-10-29 02:28:26,696 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4885e+00
[rank0]:2025-10-29 02:28:26,713 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.7034e-01
[rank1]:2025-10-29 02:28:26,696 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8961e+00
[rank3]:2025-10-29 02:28:47,218 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7700e+00
[rank1]:2025-10-29 02:28:47,214 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.6504e-01
[rank0]:2025-10-29 02:28:47,222 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5535e-01
[rank2]:2025-10-29 02:28:47,217 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1188e-01
[rank3]:2025-10-29 02:29:08,381 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.6242e+00
[rank1]:2025-10-29 02:29:08,371 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3261e+00
[rank0]:2025-10-29 02:29:08,388 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8079e+00
[rank2]:2025-10-29 02:29:08,371 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7905e+00
[rank1]:2025-10-29 02:29:28,768 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1552e+00
[rank2]:2025-10-29 02:29:28,771 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1452e-01
[rank3]:2025-10-29 02:29:28,771 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6739e+00
[rank0]:2025-10-29 02:29:28,775 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.5055e+00
[rank0]:2025-10-29 02:29:47,941 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:29:50,053 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4796e-01
[rank2]:2025-10-29 02:29:50,054 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 63.09GiB(45.12%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank1]:2025-10-29 02:29:50,053 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.1092e-01
[rank1]:2025-10-29 02:29:50,054 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 71.10GiB(50.85%)  tps: 7,824  tflops: 364.90  mfu: 36.90%
[rank3]:2025-10-29 02:29:50,063 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.9792e+00
[rank3]:2025-10-29 02:29:50,067 - INFO -  step: 450  loss:  0.1183  grad_norm:  0.9298  memory: 78.44GiB(56.10%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank0]:2025-10-29 02:29:50,070 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0733e+00
[rank0]:2025-10-29 02:29:50,071 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 71.50GiB(51.14%)  tps: 7,820  tflops: 364.72  mfu: 36.88%
[rank2]:2025-10-29 02:29:50,528 - INFO - Avg. fwd time: 14.2304 / Avg. bwd time: 28.2071 / Avg. batch time: 467.1057 (ms) / GPU bubble ratio: 27.32%
[rank1]:2025-10-29 02:29:50,559 - INFO - Avg. fwd time: 16.4744 / Avg. bwd time: 29.9775 / Avg. batch time: 518.3597 (ms) / GPU bubble ratio: 28.31%
[rank3]:2025-10-29 02:29:50,497 - INFO - Avg. fwd time: 15.6215 / Avg. bwd time: 34.9947 / Avg. batch time: 420.8459 (ms) / GPU bubble ratio: 3.78%
[rank0]:2025-10-29 02:29:50,589 - INFO - Avg. fwd time: 14.5295 / Avg. bwd time: 31.9390 / Avg. batch time: 567.3192 (ms) / GPU bubble ratio: 34.47%
[rank2]:2025-10-29 02:30:10,448 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3501e-01
[rank3]:2025-10-29 02:30:10,449 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2632e+00
[rank1]:2025-10-29 02:30:10,445 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4278e+00
[rank0]:2025-10-29 02:30:10,452 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9004e+00
[rank2]:2025-10-29 02:30:31,659 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0404e+00
[rank1]:2025-10-29 02:30:31,659 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.7987e-01
[rank3]:2025-10-29 02:30:31,669 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0903e-01
[rank0]:2025-10-29 02:30:31,676 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9317e-01
[rank3]:2025-10-29 02:30:52,182 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.4115e+00
[rank1]:2025-10-29 02:30:52,179 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3109e+00
[rank0]:2025-10-29 02:30:52,186 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1911e+00
[rank2]:2025-10-29 02:30:52,182 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1867e-01
[rank3]:2025-10-29 02:31:13,321 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9088e+00
[rank0]:2025-10-29 02:31:13,328 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.2141e-01
[rank1]:2025-10-29 02:31:13,311 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.0022e-01
[rank2]:2025-10-29 02:31:13,311 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5295e+00
[rank0]:2025-10-29 02:31:31,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:31:33,833 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.2900e+00
[rank3]:2025-10-29 02:31:33,837 - INFO -  step: 500  loss:  0.1230  grad_norm:  1.8859  memory: 78.44GiB(56.10%)  tps: 7,894  tflops: 368.20  mfu: 37.23%
[rank1]:2025-10-29 02:31:33,829 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.6676e+00
[rank1]:2025-10-29 02:31:33,830 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 71.10GiB(50.85%)  tps: 7,894  tflops: 368.18  mfu: 37.23%
[rank0]:2025-10-29 02:31:33,837 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.9781e+00
[rank0]:2025-10-29 02:31:33,837 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 71.50GiB(51.14%)  tps: 7,895  tflops: 368.21  mfu: 37.23%
[rank2]:2025-10-29 02:31:33,832 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7999e+00
[rank2]:2025-10-29 02:31:33,833 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 63.09GiB(45.12%)  tps: 7,894  tflops: 368.16  mfu: 37.23%
[rank1]:2025-10-29 02:31:33,918 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0231_stage1_step500.svg
[rank0]:2025-10-29 02:31:33,912 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0231_stage0_step500.svg
[rank2]:2025-10-29 02:31:33,912 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0231_stage2_step500.svg
[rank3]:2025-10-29 02:31:34,020 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0231_real_step500_rank3.svg
[rank3]:> Batch Time: 527.23 ms, GPU Bubble Ratio: 30.89%, 35.44%, 38.02%, 26.17%
[rank3]:2025-10-29 02:31:34,088 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0231_stage3_step500.svg
[rank3]:2025-10-29 02:31:34,404 - INFO - Avg. fwd time: 15.5880 / Avg. bwd time: 34.6009 / Avg. batch time: 417.3614 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-29 02:31:34,454 - INFO - Avg. fwd time: 16.4735 / Avg. bwd time: 29.4504 / Avg. batch time: 513.3677 (ms) / GPU bubble ratio: 28.44%
[rank2]:2025-10-29 02:31:34,428 - INFO - Avg. fwd time: 14.2197 / Avg. bwd time: 27.7938 / Avg. batch time: 462.9878 (ms) / GPU bubble ratio: 27.40%
[rank0]:2025-10-29 02:31:34,487 - INFO - Avg. fwd time: 14.5122 / Avg. bwd time: 31.5458 / Avg. batch time: 561.8761 (ms) / GPU bubble ratio: 34.42%
[rank0]:2025-10-29 02:31:55,217 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.9404e+00
[rank3]:2025-10-29 02:31:55,210 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.2362e+00
[rank1]:2025-10-29 02:31:55,200 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.2585e+00
[rank2]:2025-10-29 02:31:55,201 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.3308e+00
[rank0]:2025-10-29 02:32:15,659 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0209e-01
[rank3]:2025-10-29 02:32:15,655 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.7300e-01
[rank1]:2025-10-29 02:32:15,652 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1608e-01
[rank2]:2025-10-29 02:32:15,655 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2683e-01
[rank2]:2025-10-29 02:32:36,928 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7762e+00
[rank1]:2025-10-29 02:32:36,928 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8756e+00
[rank0]:2025-10-29 02:32:36,945 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.1214e+00
[rank3]:2025-10-29 02:32:36,938 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4257e+00
[rank1]:2025-10-29 02:32:57,289 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.9071e+00
[rank0]:2025-10-29 02:32:57,296 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.7621e+00
[rank3]:2025-10-29 02:32:57,293 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4725e+00
[rank2]:2025-10-29 02:32:57,292 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2540e+00
[rank0]:2025-10-29 02:33:16,386 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:33:18,505 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2683e+00
[rank3]:2025-10-29 02:33:18,508 - INFO -  step: 550  loss:  0.1337  grad_norm:  0.1283  memory: 78.44GiB(56.10%)  tps: 7,827  tflops: 365.03  mfu: 36.91%
[rank0]:2025-10-29 02:33:18,512 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.9260e-01
[rank0]:2025-10-29 02:33:18,512 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 71.50GiB(51.14%)  tps: 7,826  tflops: 365.01  mfu: 36.91%
[rank1]:2025-10-29 02:33:18,495 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8454e+00
[rank1]:2025-10-29 02:33:18,495 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 71.10GiB(50.85%)  tps: 7,827  tflops: 365.05  mfu: 36.91%
[rank2]:2025-10-29 02:33:18,495 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5857e+00
[rank2]:2025-10-29 02:33:18,495 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 63.09GiB(45.12%)  tps: 7,827  tflops: 365.06  mfu: 36.91%
[rank3]:2025-10-29 02:33:18,863 - INFO - Avg. fwd time: 15.5556 / Avg. bwd time: 34.2419 / Avg. batch time: 414.1692 (ms) / GPU bubble ratio: 3.81%
[rank0]:2025-10-29 02:33:18,947 - INFO - Avg. fwd time: 14.4925 / Avg. bwd time: 31.2111 / Avg. batch time: 556.8519 (ms) / GPU bubble ratio: 34.34%
[rank1]:2025-10-29 02:33:18,927 - INFO - Avg. fwd time: 16.4753 / Avg. bwd time: 28.9244 / Avg. batch time: 508.7327 (ms) / GPU bubble ratio: 28.61%
[rank2]:2025-10-29 02:33:18,899 - INFO - Avg. fwd time: 14.2163 / Avg. bwd time: 27.3562 / Avg. batch time: 459.2080 (ms) / GPU bubble ratio: 27.58%
[rank2]:2025-10-29 02:33:39,023 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6032e-01
[rank0]:2025-10-29 02:33:39,027 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.2549e-01
[rank3]:2025-10-29 02:33:39,023 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.3303e+00
[rank1]:2025-10-29 02:33:39,020 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.2783e-01
[rank0]:2025-10-29 02:34:00,155 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.0660e-01
[rank2]:2025-10-29 02:34:00,138 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3309e-01
[rank1]:2025-10-29 02:34:00,138 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.6979e-01
[rank3]:2025-10-29 02:34:00,148 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.6000e-01
[rank0]:2025-10-29 02:34:20,684 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3055e-01
[rank3]:2025-10-29 02:34:20,680 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.1119e+00
[rank1]:2025-10-29 02:34:20,676 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.9901e-01
[rank2]:2025-10-29 02:34:20,680 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7204e-01
[rank2]:2025-10-29 02:34:41,815 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0171e+00
[rank1]:2025-10-29 02:34:41,814 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0711e+00
[rank0]:2025-10-29 02:34:41,832 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8376e-01
[rank3]:2025-10-29 02:34:41,824 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4913e+00
[rank0]:2025-10-29 02:35:00,186 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:35:02,229 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.6998e-01
[rank3]:2025-10-29 02:35:02,232 - INFO -  step: 600  loss:  0.0967  grad_norm:  0.1238  memory: 78.44GiB(56.10%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank3]:2025-10-29 02:35:02,233 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 02:35:02,229 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8957e-01
[rank2]:2025-10-29 02:35:02,229 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 63.09GiB(45.12%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank2]:2025-10-29 02:35:02,229 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:35:02,233 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.2165e-01
[rank0]:2025-10-29 02:35:02,233 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 71.50GiB(51.14%)  tps: 7,898  tflops: 368.37  mfu: 37.25%
[rank0]:2025-10-29 02:35:02,233 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 02:35:02,226 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7605e+00
[rank1]:2025-10-29 02:35:02,226 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 71.10GiB(50.85%)  tps: 7,897  tflops: 368.33  mfu: 37.24%
[rank1]:2025-10-29 02:35:02,227 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:35:18,436 - INFO - validate step: 600  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 25,280
[rank1]:2025-10-29 02:35:18,471 - INFO - validate step: 600  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,216
[rank3]:2025-10-29 02:35:18,493 - INFO - validate step: 600  loss:  0.2463  memory: 78.44GiB(56.10%)  tps: 25,191
[rank2]:2025-10-29 02:35:18,486 - INFO - validate step: 600  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,196
[rank1]:2025-10-29 02:35:18,576 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0235_stage1_step600.svg
[rank2]:2025-10-29 02:35:18,570 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0235_stage2_step600.svg
[rank0]:2025-10-29 02:35:18,570 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0235_stage0_step600.svg
[rank3]:2025-10-29 02:35:18,676 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0235_real_step600_rank3.svg
[rank3]:> Batch Time: 522.97 ms, GPU Bubble Ratio: 30.71%, 35.31%, 37.87%, 26.31%
[rank3]:2025-10-29 02:35:18,747 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0235_stage3_step600.svg
[rank3]:2025-10-29 02:35:19,148 - INFO - Avg. fwd time: 15.5285 / Avg. bwd time: 33.9231 / Avg. batch time: 411.3485 (ms) / GPU bubble ratio: 3.83%
[rank1]:2025-10-29 02:35:19,203 - INFO - Avg. fwd time: 16.4737 / Avg. bwd time: 28.5145 / Avg. batch time: 504.7898 (ms) / GPU bubble ratio: 28.70%
[rank2]:2025-10-29 02:35:19,175 - INFO - Avg. fwd time: 14.2066 / Avg. bwd time: 27.0397 / Avg. batch time: 455.9450 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-10-29 02:35:19,239 - INFO - Avg. fwd time: 14.4791 / Avg. bwd time: 30.8886 / Avg. batch time: 552.5388 (ms) / GPU bubble ratio: 34.31%
[rank3]:2025-10-29 02:35:39,975 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.1143e+00
[rank2]:2025-10-29 02:35:39,965 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8765e+00
[rank0]:2025-10-29 02:35:39,982 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.0934e+00
[rank1]:2025-10-29 02:35:39,965 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2321e+00
[rank2]:2025-10-29 02:36:00,318 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5650e+01
[rank0]:2025-10-29 02:36:00,322 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0413e+02
[rank1]:2025-10-29 02:36:00,315 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1833e+02
[rank3]:2025-10-29 02:36:00,319 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.4728e+01
[rank1]:2025-10-29 02:36:19,559 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8932e+00
[rank2]:2025-10-29 02:36:19,559 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4082e+00
[rank0]:2025-10-29 02:36:19,567 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5239e+00
[rank3]:2025-10-29 02:36:19,563 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0713e+00
[rank1]:2025-10-29 02:36:40,075 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6779e+00
[rank2]:2025-10-29 02:36:40,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7499e-01
[rank0]:2025-10-29 02:36:40,082 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.9879e+00
[rank3]:2025-10-29 02:36:40,078 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4891e-01
[rank0]:2025-10-29 02:36:57,317 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:36:59,244 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.2519e-01
[rank1]:2025-10-29 02:36:59,244 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 71.10GiB(50.85%)  tps: 8,129  tflops: 379.14  mfu: 38.34%
[rank2]:2025-10-29 02:36:59,244 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3720e+00
[rank2]:2025-10-29 02:36:59,244 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 63.09GiB(45.12%)  tps: 8,130  tflops: 379.20  mfu: 38.34%
[rank3]:2025-10-29 02:36:59,247 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0443e+00
[rank3]:2025-10-29 02:36:59,250 - INFO -  step: 650  loss:  0.0882  grad_norm:  0.2923  memory: 79.24GiB(56.67%)  tps: 8,131  tflops: 379.21  mfu: 38.34%
[rank0]:2025-10-29 02:36:59,251 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.4110e-01
[rank0]:2025-10-29 02:36:59,251 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 72.50GiB(51.86%)  tps: 8,126  tflops: 378.99  mfu: 38.32%
[rank2]:2025-10-29 02:36:59,639 - INFO - Avg. fwd time: 14.2057 / Avg. bwd time: 26.7630 / Avg. batch time: 452.7842 (ms) / GPU bubble ratio: 27.61%
[rank3]:2025-10-29 02:36:59,603 - INFO - Avg. fwd time: 15.5203 / Avg. bwd time: 33.5925 / Avg. batch time: 408.5990 (ms) / GPU bubble ratio: 3.84%
[rank1]:2025-10-29 02:36:59,666 - INFO - Avg. fwd time: 16.4749 / Avg. bwd time: 28.1935 / Avg. batch time: 501.1111 (ms) / GPU bubble ratio: 28.69%
[rank0]:2025-10-29 02:36:59,687 - INFO - Avg. fwd time: 14.4837 / Avg. bwd time: 30.5171 / Avg. batch time: 548.4455 (ms) / GPU bubble ratio: 34.36%
[rank1]:2025-10-29 02:37:19,735 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2643e+00
[rank2]:2025-10-29 02:37:19,738 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9520e+00
[rank0]:2025-10-29 02:37:19,742 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6515e+00
[rank3]:2025-10-29 02:37:19,739 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1198e+00
[rank2]:2025-10-29 02:37:38,964 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3254e+00
[rank1]:2025-10-29 02:37:38,964 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.9140e+00
[rank0]:2025-10-29 02:37:38,971 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.6010e+00
[rank3]:2025-10-29 02:37:38,968 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.4113e+00
[rank1]:2025-10-29 02:37:59,399 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0505e+00
[rank2]:2025-10-29 02:37:59,402 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8437e-01
[rank0]:2025-10-29 02:37:59,406 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1610e+00
[rank3]:2025-10-29 02:37:59,402 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6632e-01
[rank2]:2025-10-29 02:38:18,724 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9321e+00
[rank1]:2025-10-29 02:38:18,724 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6529e+00
[rank0]:2025-10-29 02:38:18,732 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.3888e+00
[rank3]:2025-10-29 02:38:18,728 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.8571e+00
[rank0]:2025-10-29 02:38:37,056 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:38:39,112 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8173e-01
[rank2]:2025-10-29 02:38:39,112 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 63.09GiB(45.12%)  tps: 8,203  tflops: 382.58  mfu: 38.68%
[rank1]:2025-10-29 02:38:39,109 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1160e+00
[rank1]:2025-10-29 02:38:39,109 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 71.10GiB(50.85%)  tps: 8,203  tflops: 382.59  mfu: 38.68%
[rank0]:2025-10-29 02:38:39,116 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5914e+00
[rank0]:2025-10-29 02:38:39,116 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 72.50GiB(51.86%)  tps: 8,203  tflops: 382.59  mfu: 38.68%
[rank3]:2025-10-29 02:38:39,112 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5438e+00
[rank3]:2025-10-29 02:38:39,115 - INFO -  step: 700  loss:  0.1069  grad_norm:  0.1819  memory: 79.24GiB(56.67%)  tps: 8,203  tflops: 382.60  mfu: 38.69%
[rank2]:2025-10-29 02:38:39,196 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0238_stage2_step700.svg
[rank1]:2025-10-29 02:38:39,199 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0238_stage1_step700.svg
[rank0]:2025-10-29 02:38:39,196 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0238_stage0_step700.svg
[rank3]:2025-10-29 02:38:39,295 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0238_real_step700_rank3.svg
[rank3]:> Batch Time: 518.12 ms, GPU Bubble Ratio: 30.76%, 35.09%, 37.70%, 26.38%
[rank3]:2025-10-29 02:38:39,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0238_stage3_step700.svg
[rank2]:2025-10-29 02:38:39,678 - INFO - Avg. fwd time: 14.2001 / Avg. bwd time: 26.5192 / Avg. batch time: 449.1480 (ms) / GPU bubble ratio: 27.47%
[rank1]:2025-10-29 02:38:39,705 - INFO - Avg. fwd time: 16.4730 / Avg. bwd time: 27.8892 / Avg. batch time: 496.9748 (ms) / GPU bubble ratio: 28.59%
[rank0]:2025-10-29 02:38:39,723 - INFO - Avg. fwd time: 14.4969 / Avg. bwd time: 30.0357 / Avg. batch time: 543.7748 (ms) / GPU bubble ratio: 34.48%
[rank3]:2025-10-29 02:38:39,639 - INFO - Avg. fwd time: 15.5181 / Avg. bwd time: 33.1923 / Avg. batch time: 405.3400 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-10-29 02:38:58,555 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.5214e-01
[rank2]:2025-10-29 02:38:58,555 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5786e-01
[rank0]:2025-10-29 02:38:58,563 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.8246e-01
[rank3]:2025-10-29 02:38:58,559 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.2968e-01
[rank1]:2025-10-29 02:39:19,010 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2116e-01
[rank2]:2025-10-29 02:39:19,013 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2199e-01
[rank0]:2025-10-29 02:39:19,017 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1259e-01
[rank3]:2025-10-29 02:39:19,014 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.5404e-01
[rank1]:2025-10-29 02:39:38,220 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0008e+00
[rank2]:2025-10-29 02:39:38,220 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8843e+00
[rank0]:2025-10-29 02:39:38,227 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1170e+00
[rank3]:2025-10-29 02:39:38,223 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8457e+00
[rank1]:2025-10-29 02:39:58,731 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.6329e-01
[rank2]:2025-10-29 02:39:58,734 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2995e-01
[rank0]:2025-10-29 02:39:58,738 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.7078e-01
[rank3]:2025-10-29 02:39:58,734 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4390e-01
[rank0]:2025-10-29 02:40:15,995 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:40:17,939 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3465e+00
[rank1]:2025-10-29 02:40:17,939 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 71.10GiB(50.85%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank2]:2025-10-29 02:40:17,939 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5464e+00
[rank2]:2025-10-29 02:40:17,939 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 63.09GiB(45.12%)  tps: 8,289  tflops: 386.61  mfu: 39.09%
[rank0]:2025-10-29 02:40:17,946 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1961e+00
[rank0]:2025-10-29 02:40:17,946 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 72.50GiB(51.86%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank3]:2025-10-29 02:40:17,942 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.6927e+00
[rank3]:2025-10-29 02:40:17,946 - INFO -  step: 750  loss:  0.1378  grad_norm:  0.1292  memory: 79.24GiB(56.67%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank3]:2025-10-29 02:40:18,384 - INFO - Avg. fwd time: 15.5189 / Avg. bwd time: 32.8307 / Avg. batch time: 402.4190 (ms) / GPU bubble ratio: 3.88%
[rank1]:2025-10-29 02:40:18,447 - INFO - Avg. fwd time: 16.4761 / Avg. bwd time: 27.6122 / Avg. batch time: 493.2909 (ms) / GPU bubble ratio: 28.50%
[rank2]:2025-10-29 02:40:18,416 - INFO - Avg. fwd time: 14.2003 / Avg. bwd time: 26.2741 / Avg. batch time: 445.9072 (ms) / GPU bubble ratio: 27.39%
[rank0]:2025-10-29 02:40:18,479 - INFO - Avg. fwd time: 14.5116 / Avg. bwd time: 29.6041 / Avg. batch time: 539.6170 (ms) / GPU bubble ratio: 34.60%
[rank1]:2025-10-29 02:40:38,358 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4627e+00
[rank2]:2025-10-29 02:40:38,361 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3034e+00
[rank0]:2025-10-29 02:40:38,365 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4760e+00
[rank3]:2025-10-29 02:40:38,361 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1606e+00
[rank1]:2025-10-29 02:40:57,705 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2787e+00
[rank2]:2025-10-29 02:40:57,705 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6105e+00
[rank0]:2025-10-29 02:40:57,712 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1159e+00
[rank3]:2025-10-29 02:40:57,708 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3692e+00
[rank2]:2025-10-29 02:41:18,053 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4205e+00
[rank1]:2025-10-29 02:41:18,050 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.9423e+00
[rank0]:2025-10-29 02:41:18,057 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.7208e+00
[rank3]:2025-10-29 02:41:18,053 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2743e+00
[rank2]:2025-10-29 02:41:37,312 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7331e+00
[rank1]:2025-10-29 02:41:37,312 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.9164e-01
[rank0]:2025-10-29 02:41:37,319 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4102e-01
[rank3]:2025-10-29 02:41:37,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2266e+00
[rank0]:2025-10-29 02:41:55,731 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:41:57,803 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2864e-01
[rank2]:2025-10-29 02:41:57,803 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 63.09GiB(45.12%)  tps: 8,203  tflops: 382.60  mfu: 38.69%
[rank2]:2025-10-29 02:41:57,803 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 02:41:57,800 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.8971e-01
[rank1]:2025-10-29 02:41:57,800 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 71.10GiB(50.85%)  tps: 8,203  tflops: 382.61  mfu: 38.69%
[rank1]:2025-10-29 02:41:57,800 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:41:57,807 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5117e-01
[rank0]:2025-10-29 02:41:57,807 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 72.50GiB(51.86%)  tps: 8,203  tflops: 382.61  mfu: 38.69%
[rank0]:2025-10-29 02:41:57,807 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 02:41:57,803 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1459e+00
[rank3]:2025-10-29 02:41:57,805 - INFO -  step: 800  loss:  0.1154  grad_norm:  0.2685  memory: 79.24GiB(56.67%)  tps: 8,204  tflops: 382.62  mfu: 38.69%
[rank3]:2025-10-29 02:41:57,806 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:42:14,100 - INFO - validate step: 800  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,141
[rank2]:2025-10-29 02:42:14,149 - INFO - validate step: 800  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,058
[rank1]:2025-10-29 02:42:14,134 - INFO - validate step: 800  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,078
[rank3]:2025-10-29 02:42:14,159 - INFO - validate step: 800  loss:  0.2470  memory: 79.24GiB(56.67%)  tps: 25,048
[rank2]:2025-10-29 02:42:14,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0242_stage2_step800.svg
[rank1]:2025-10-29 02:42:14,245 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0242_stage1_step800.svg
[rank0]:2025-10-29 02:42:14,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0242_stage0_step800.svg
[rank3]:2025-10-29 02:42:14,340 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0242_real_step800_rank3.svg
[rank3]:> Batch Time: 513.38 ms, GPU Bubble Ratio: 30.82%, 34.65%, 37.26%, 26.53%
[rank3]:2025-10-29 02:42:14,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0242_stage3_step800.svg
[rank3]:2025-10-29 02:42:14,692 - INFO - Avg. fwd time: 15.5158 / Avg. bwd time: 32.5764 / Avg. batch time: 400.3338 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-29 02:42:14,732 - INFO - Avg. fwd time: 14.1952 / Avg. bwd time: 26.1272 / Avg. batch time: 443.5862 (ms) / GPU bubble ratio: 27.28%
[rank1]:2025-10-29 02:42:14,759 - INFO - Avg. fwd time: 16.4755 / Avg. bwd time: 27.4221 / Avg. batch time: 490.6537 (ms) / GPU bubble ratio: 28.43%
[rank0]:2025-10-29 02:42:14,777 - INFO - Avg. fwd time: 14.5184 / Avg. bwd time: 29.2972 / Avg. batch time: 536.6393 (ms) / GPU bubble ratio: 34.68%
[rank1]:2025-10-29 02:42:33,526 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0507e+00
[rank2]:2025-10-29 02:42:33,526 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2545e+00
[rank0]:2025-10-29 02:42:33,533 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.6047e-01
[rank3]:2025-10-29 02:42:33,529 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.3660e-01
[rank2]:2025-10-29 02:42:54,011 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1048e-01
[rank1]:2025-10-29 02:42:54,008 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.4715e-01
[rank0]:2025-10-29 02:42:54,015 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5062e-01
[rank3]:2025-10-29 02:42:54,012 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.5890e-01
[rank1]:2025-10-29 02:43:13,219 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0957e+00
[rank2]:2025-10-29 02:43:13,219 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6541e+00
[rank0]:2025-10-29 02:43:13,226 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0171e+00
[rank3]:2025-10-29 02:43:13,223 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6626e+00
[rank2]:2025-10-29 02:43:33,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0715e-01
[rank1]:2025-10-29 02:43:33,616 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2794e-01
[rank0]:2025-10-29 02:43:33,624 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0937e+00
[rank3]:2025-10-29 02:43:33,620 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0659e-01
[rank0]:2025-10-29 02:43:51,035 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:43:52,963 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2144e-01
[rank1]:2025-10-29 02:43:52,963 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 71.10GiB(50.85%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank2]:2025-10-29 02:43:52,963 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8806e+00
[rank2]:2025-10-29 02:43:52,963 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 63.09GiB(45.12%)  tps: 8,290  tflops: 386.66  mfu: 39.10%
[rank0]:2025-10-29 02:43:52,970 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.5473e-01
[rank0]:2025-10-29 02:43:52,970 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 72.50GiB(51.86%)  tps: 8,286  tflops: 386.44  mfu: 39.07%
[rank3]:2025-10-29 02:43:52,966 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.7581e+00
[rank3]:2025-10-29 02:43:52,969 - INFO -  step: 850  loss:  0.1377  grad_norm:  0.6444  memory: 79.24GiB(56.67%)  tps: 8,291  tflops: 386.68  mfu: 39.10%
[rank2]:2025-10-29 02:43:53,352 - INFO - Avg. fwd time: 14.1942 / Avg. bwd time: 25.9488 / Avg. batch time: 441.0966 (ms) / GPU bubble ratio: 27.19%
[rank1]:2025-10-29 02:43:53,379 - INFO - Avg. fwd time: 16.4778 / Avg. bwd time: 27.2117 / Avg. batch time: 487.8244 (ms) / GPU bubble ratio: 28.35%
[rank3]:2025-10-29 02:43:53,315 - INFO - Avg. fwd time: 15.5155 / Avg. bwd time: 32.2986 / Avg. batch time: 398.0814 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-10-29 02:43:53,399 - INFO - Avg. fwd time: 14.5298 / Avg. bwd time: 28.9679 / Avg. batch time: 533.4495 (ms) / GPU bubble ratio: 34.77%
[rank2]:2025-10-29 02:44:13,320 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4504e-01
[rank1]:2025-10-29 02:44:13,317 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6729e+00
[rank0]:2025-10-29 02:44:13,325 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3056e+00
[rank3]:2025-10-29 02:44:13,321 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1267e+00
[rank2]:2025-10-29 02:44:32,633 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0451e+00
[rank1]:2025-10-29 02:44:32,633 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4232e+00
[rank0]:2025-10-29 02:44:32,640 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9545e+00
[rank3]:2025-10-29 02:44:32,636 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3491e+00
[rank1]:2025-10-29 02:44:53,156 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6332e+00
[rank2]:2025-10-29 02:44:53,159 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3120e-01
[rank0]:2025-10-29 02:44:53,163 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8158e+00
[rank3]:2025-10-29 02:44:53,159 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.9519e-01
[rank1]:2025-10-29 02:45:12,334 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.6095e-01
[rank2]:2025-10-29 02:45:12,334 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.5785e-01
[rank0]:2025-10-29 02:45:12,341 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0748e+00
[rank3]:2025-10-29 02:45:12,337 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1529e+00
[rank0]:2025-10-29 02:45:30,834 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:45:32,868 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.7921e-01
[rank1]:2025-10-29 02:45:32,864 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1426e-01
[rank1]:2025-10-29 02:45:32,864 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 71.10GiB(50.85%)  tps: 8,200  tflops: 382.45  mfu: 38.67%
[rank1]:2025-10-29 02:45:32,949 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0245_stage1_step900.svg
[rank2]:2025-10-29 02:45:32,867 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7529e-01
[rank2]:2025-10-29 02:45:32,868 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 63.09GiB(45.12%)  tps: 8,200  tflops: 382.44  mfu: 38.67%
[rank2]:2025-10-29 02:45:32,948 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0245_stage2_step900.svg
[rank0]:2025-10-29 02:45:32,871 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.6424e-01
[rank0]:2025-10-29 02:45:32,872 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 72.50GiB(51.86%)  tps: 8,200  tflops: 382.45  mfu: 38.67%
[rank0]:2025-10-29 02:45:32,949 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0245_stage0_step900.svg
[rank3]:2025-10-29 02:45:32,870 - INFO -  step: 900  loss:  0.1240  grad_norm:  0.2012  memory: 79.24GiB(56.67%)  tps: 8,200  tflops: 382.46  mfu: 38.67%
[rank3]:2025-10-29 02:45:33,048 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0245_real_step900_rank3.svg
[rank3]:> Batch Time: 499.40 ms, GPU Bubble Ratio: 35.29%, 32.92%, 35.58%, 26.31%
[rank3]:2025-10-29 02:45:33,108 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0245_stage3_step900.svg
[rank1]:2025-10-29 02:45:33,531 - INFO - Avg. fwd time: 16.4782 / Avg. bwd time: 27.0423 / Avg. batch time: 485.5229 (ms) / GPU bubble ratio: 28.29%
[rank2]:2025-10-29 02:45:33,501 - INFO - Avg. fwd time: 14.1901 / Avg. bwd time: 25.8219 / Avg. batch time: 439.0766 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-29 02:45:33,560 - INFO - Avg. fwd time: 14.5378 / Avg. bwd time: 28.6914 / Avg. batch time: 530.8443 (ms) / GPU bubble ratio: 34.85%
[rank3]:2025-10-29 02:45:33,472 - INFO - Avg. fwd time: 15.5143 / Avg. bwd time: 32.0722 / Avg. batch time: 396.2371 (ms) / GPU bubble ratio: 3.92%
[rank1]:2025-10-29 02:45:52,311 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.0449e-01
[rank2]:2025-10-29 02:45:52,311 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3191e-01
[rank0]:2025-10-29 02:45:52,319 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.8096e-01
[rank3]:2025-10-29 02:45:52,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.5111e-01
[rank1]:2025-10-29 02:46:12,757 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0861e+00
[rank2]:2025-10-29 02:46:12,760 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8609e-01
[rank0]:2025-10-29 02:46:12,764 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4885e+00
[rank3]:2025-10-29 02:46:12,760 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0153e+00
[rank1]:2025-10-29 02:46:32,138 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0166e+00
[rank2]:2025-10-29 02:46:32,138 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4448e-01
[rank3]:2025-10-29 02:46:32,142 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1218e+00
[rank0]:2025-10-29 02:46:32,146 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.5929e-01
[rank1]:2025-10-29 02:46:52,540 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2574e-01
[rank2]:2025-10-29 02:46:52,543 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5635e-01
[rank3]:2025-10-29 02:46:52,544 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.9110e-01
[rank0]:2025-10-29 02:46:52,547 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7754e-01
[rank0]:2025-10-29 02:47:09,948 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:47:11,869 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.5796e-01
[rank1]:2025-10-29 02:47:11,869 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 71.10GiB(50.85%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank3]:2025-10-29 02:47:11,872 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1583e+00
[rank3]:2025-10-29 02:47:11,875 - INFO -  step: 950  loss:  0.1515  grad_norm:  0.1994  memory: 79.24GiB(56.67%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank2]:2025-10-29 02:47:11,869 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0823e-01
[rank2]:2025-10-29 02:47:11,869 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 63.09GiB(45.12%)  tps: 8,275  tflops: 385.93  mfu: 39.02%
[rank0]:2025-10-29 02:47:11,876 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.9068e-01
[rank0]:2025-10-29 02:47:11,876 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 72.50GiB(51.86%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank3]:2025-10-29 02:47:12,225 - INFO - Avg. fwd time: 15.5169 / Avg. bwd time: 31.8841 / Avg. batch time: 394.7356 (ms) / GPU bubble ratio: 3.93%
[rank1]:2025-10-29 02:47:12,288 - INFO - Avg. fwd time: 16.4822 / Avg. bwd time: 26.8974 / Avg. batch time: 483.5978 (ms) / GPU bubble ratio: 28.24%
[rank2]:2025-10-29 02:47:12,260 - INFO - Avg. fwd time: 14.1912 / Avg. bwd time: 25.6936 / Avg. batch time: 437.3821 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 02:47:12,308 - INFO - Avg. fwd time: 14.5471 / Avg. bwd time: 28.4647 / Avg. batch time: 528.6709 (ms) / GPU bubble ratio: 34.91%
[rank1]:2025-10-29 02:47:32,489 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.4256e+00
[rank3]:2025-10-29 02:47:32,493 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2479e+00
[rank2]:2025-10-29 02:47:32,492 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5696e+00
[rank0]:2025-10-29 02:47:32,496 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4447e+00
[rank3]:2025-10-29 02:47:51,696 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0625e+00
[rank1]:2025-10-29 02:47:51,693 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7309e+00
[rank2]:2025-10-29 02:47:51,693 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1025e+00
[rank0]:2025-10-29 02:47:51,700 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4861e+00
[rank1]:2025-10-29 02:48:12,312 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.8363e-01
[rank2]:2025-10-29 02:48:12,316 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3828e-01
[rank3]:2025-10-29 02:48:12,316 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.9233e-01
[rank0]:2025-10-29 02:48:12,320 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.5407e-01
[rank1]:2025-10-29 02:48:31,631 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1398e+00
[rank3]:2025-10-29 02:48:31,635 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.3215e+00
[rank2]:2025-10-29 02:48:31,631 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4150e+00
[rank0]:2025-10-29 02:48:31,639 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4266e+00
[rank0]:2025-10-29 02:48:50,117 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:48:52,168 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.7504e-01
[rank1]:2025-10-29 02:48:52,169 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 71.10GiB(50.85%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank2]:2025-10-29 02:48:52,172 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9215e-01
[rank1]:2025-10-29 02:48:52,169 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 02:48:52,172 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 63.09GiB(45.12%)  tps: 8,167  tflops: 380.92  mfu: 38.52%
[rank2]:2025-10-29 02:48:52,172 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 02:48:52,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3291e-01
[rank3]:2025-10-29 02:48:52,175 - INFO -  step: 1000  loss:  0.1238  grad_norm:  0.1284  memory: 79.24GiB(56.67%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank3]:2025-10-29 02:48:52,175 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:48:52,176 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.4436e-01
[rank0]:2025-10-29 02:48:52,176 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 72.50GiB(51.86%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank0]:2025-10-29 02:48:52,176 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:49:08,521 - INFO - validate step: 1000  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,061
[rank2]:2025-10-29 02:49:08,571 - INFO - validate step: 1000  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,977
[rank1]:2025-10-29 02:49:08,555 - INFO - validate step: 1000  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 24,997
[rank3]:2025-10-29 02:49:08,584 - INFO - validate step: 1000  loss:  0.2468  memory: 79.24GiB(56.67%)  tps: 24,963
[rank2]:2025-10-29 02:49:08,665 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0249_stage2_step1000.svg
[rank1]:2025-10-29 02:49:08,666 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0249_stage1_step1000.svg
[rank0]:2025-10-29 02:49:08,661 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0249_stage0_step1000.svg
[rank3]:2025-10-29 02:49:08,762 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0249_real_step1000_rank3.svg
[rank3]:> Batch Time: 496.53 ms, GPU Bubble Ratio: 35.17%, 32.57%, 35.26%, 26.40%
[rank3]:2025-10-29 02:49:08,823 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0249_stage3_step1000.svg
[rank3]:2025-10-29 02:49:09,103 - INFO - Avg. fwd time: 15.5197 / Avg. bwd time: 31.6997 / Avg. batch time: 393.2643 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-29 02:49:09,142 - INFO - Avg. fwd time: 14.1918 / Avg. bwd time: 25.5840 / Avg. batch time: 435.7357 (ms) / GPU bubble ratio: 26.97%
[rank1]:2025-10-29 02:49:09,169 - INFO - Avg. fwd time: 16.4876 / Avg. bwd time: 26.7599 / Avg. batch time: 481.7260 (ms) / GPU bubble ratio: 28.18%
[rank0]:2025-10-29 02:49:09,187 - INFO - Avg. fwd time: 14.5580 / Avg. bwd time: 28.2407 / Avg. batch time: 526.5555 (ms) / GPU bubble ratio: 34.98%
[rank3]:2025-10-29 02:49:28,174 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.8228e+00
[rank2]:2025-10-29 02:49:28,170 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1160e+00
[rank1]:2025-10-29 02:49:28,170 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2948e+00
[rank0]:2025-10-29 02:49:28,177 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.7272e-01
[rank3]:2025-10-29 02:49:48,512 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0777e+00
[rank2]:2025-10-29 02:49:48,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3458e-01
[rank1]:2025-10-29 02:49:48,508 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.1839e-01
[rank0]:2025-10-29 02:49:48,516 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6180e+00
[rank3]:2025-10-29 02:50:07,775 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5897e+00
[rank2]:2025-10-29 02:50:07,771 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5956e+00
[rank1]:2025-10-29 02:50:07,771 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6317e+00
[rank0]:2025-10-29 02:50:07,778 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.0946e+00
[rank3]:2025-10-29 02:50:28,290 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9997e-01
[rank1]:2025-10-29 02:50:28,287 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3584e+00
[rank2]:2025-10-29 02:50:28,290 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8857e-01
[rank0]:2025-10-29 02:50:28,294 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.2667e+00
[rank0]:2025-10-29 02:50:45,561 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:50:47,493 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.1801e-01
[rank1]:2025-10-29 02:50:47,493 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 71.10GiB(50.85%)  tps: 8,280  tflops: 386.18  mfu: 39.05%
[rank3]:2025-10-29 02:50:47,497 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6739e+00
[rank3]:2025-10-29 02:50:47,500 - INFO -  step: 1050  loss:  0.1288  grad_norm:  0.1258  memory: 79.24GiB(56.67%)  tps: 8,282  tflops: 386.27  mfu: 39.06%
[rank2]:2025-10-29 02:50:47,493 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0872e+00
[rank2]:2025-10-29 02:50:47,494 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 63.09GiB(45.12%)  tps: 8,281  tflops: 386.24  mfu: 39.05%
[rank0]:2025-10-29 02:50:47,500 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3539e+00
[rank0]:2025-10-29 02:50:47,501 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 72.50GiB(51.86%)  tps: 8,276  tflops: 386.01  mfu: 39.03%
[rank1]:2025-10-29 02:50:48,003 - INFO - Avg. fwd time: 16.4886 / Avg. bwd time: 26.6181 / Avg. batch time: 479.8650 (ms) / GPU bubble ratio: 28.14%
[rank3]:2025-10-29 02:50:47,936 - INFO - Avg. fwd time: 15.5204 / Avg. bwd time: 31.5164 / Avg. batch time: 391.7875 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-29 02:50:47,970 - INFO - Avg. fwd time: 14.1932 / Avg. bwd time: 25.4563 / Avg. batch time: 434.0987 (ms) / GPU bubble ratio: 26.93%
[rank0]:2025-10-29 02:50:48,035 - INFO - Avg. fwd time: 14.5656 / Avg. bwd time: 28.0231 / Avg. batch time: 524.4565 (ms) / GPU bubble ratio: 35.04%
[rank3]:2025-10-29 02:51:08,069 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3878e+00
[rank1]:2025-10-29 02:51:08,065 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0962e+00
[rank2]:2025-10-29 02:51:08,069 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7366e-01
[rank0]:2025-10-29 02:51:08,073 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5877e-01
[rank0]:2025-10-29 02:51:27,303 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.2815e+00
[rank3]:2025-10-29 02:51:27,299 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6618e+00
[rank1]:2025-10-29 02:51:27,295 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6151e+00
[rank2]:2025-10-29 02:51:27,295 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9554e+00
[rank0]:2025-10-29 02:51:47,736 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0618e+00
[rank3]:2025-10-29 02:51:47,733 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.3865e-01
[rank2]:2025-10-29 02:51:47,732 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5058e-01
[rank1]:2025-10-29 02:51:47,729 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.2247e-01
[rank0]:2025-10-29 02:52:07,134 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.1103e+00
[rank3]:2025-10-29 02:52:07,130 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.3934e+00
[rank1]:2025-10-29 02:52:07,127 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5362e+00
[rank2]:2025-10-29 02:52:07,127 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9281e+00
[rank0]:2025-10-29 02:52:25,461 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:52:27,529 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6849e+00
[rank0]:2025-10-29 02:52:27,529 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 72.50GiB(51.86%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank3]:2025-10-29 02:52:27,525 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4317e+00
[rank3]:2025-10-29 02:52:27,528 - INFO -  step: 1100  loss:  0.0984  grad_norm:  0.1037  memory: 79.24GiB(56.67%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank1]:2025-10-29 02:52:27,522 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4623e+00
[rank1]:2025-10-29 02:52:27,522 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 71.10GiB(50.85%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank2]:2025-10-29 02:52:27,525 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1199e+00
[rank2]:2025-10-29 02:52:27,526 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 63.09GiB(45.12%)  tps: 8,189  tflops: 381.95  mfu: 38.62%
[rank0]:2025-10-29 02:52:27,610 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0252_stage0_step1100.svg
[rank1]:2025-10-29 02:52:27,613 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0252_stage1_step1100.svg
[rank2]:2025-10-29 02:52:27,610 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0252_stage2_step1100.svg
[rank3]:2025-10-29 02:52:27,712 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0252_real_step1100_rank3.svg
[rank3]:> Batch Time: 494.43 ms, GPU Bubble Ratio: 35.07%, 32.55%, 35.36%, 26.46%
[rank3]:2025-10-29 02:52:27,775 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0252_stage3_step1100.svg
[rank3]:2025-10-29 02:52:28,055 - INFO - Avg. fwd time: 15.5203 / Avg. bwd time: 31.3884 / Avg. batch time: 390.7493 (ms) / GPU bubble ratio: 3.96%
[rank0]:2025-10-29 02:52:28,139 - INFO - Avg. fwd time: 14.5696 / Avg. bwd time: 27.8661 / Avg. batch time: 522.9628 (ms) / GPU bubble ratio: 35.08%
[rank1]:2025-10-29 02:52:28,121 - INFO - Avg. fwd time: 16.4891 / Avg. bwd time: 26.5213 / Avg. batch time: 478.5446 (ms) / GPU bubble ratio: 28.10%
[rank2]:2025-10-29 02:52:28,094 - INFO - Avg. fwd time: 14.1911 / Avg. bwd time: 25.3840 / Avg. batch time: 432.9395 (ms) / GPU bubble ratio: 26.87%
[rank1]:2025-10-29 02:52:47,013 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.9582e-01
[rank3]:2025-10-29 02:52:47,016 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0642e+00
[rank0]:2025-10-29 02:52:47,020 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.0480e-01
[rank2]:2025-10-29 02:52:47,013 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1733e+00
[rank0]:2025-10-29 02:53:07,538 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3769e-01
[rank1]:2025-10-29 02:53:07,531 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.1590e-01
[rank3]:2025-10-29 02:53:07,534 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.4021e-01
[rank2]:2025-10-29 02:53:07,534 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9778e-01
[rank1]:2025-10-29 02:53:26,703 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.7185e-01
[rank0]:2025-10-29 02:53:26,710 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.3561e-01
[rank3]:2025-10-29 02:53:26,706 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1214e+00
[rank2]:2025-10-29 02:53:26,703 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7734e-01
[rank3]:2025-10-29 02:53:47,230 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1359e+00
[rank0]:2025-10-29 02:53:47,234 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5125e+00
[rank2]:2025-10-29 02:53:47,230 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0518e-01
[rank1]:2025-10-29 02:53:47,227 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7116e+00
[rank0]:2025-10-29 02:54:04,547 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:54:06,497 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.9135e-01
[rank0]:2025-10-29 02:54:06,497 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 72.50GiB(51.86%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank3]:2025-10-29 02:54:06,493 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3735e+00
[rank3]:2025-10-29 02:54:06,497 - INFO -  step: 1150  loss:  0.1189  grad_norm:  0.1261  memory: 79.24GiB(56.67%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank2]:2025-10-29 02:54:06,490 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5893e+00
[rank2]:2025-10-29 02:54:06,490 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 63.09GiB(45.12%)  tps: 8,278  tflops: 386.07  mfu: 39.04%
[rank1]:2025-10-29 02:54:06,490 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9603e+00
[rank1]:2025-10-29 02:54:06,490 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 71.10GiB(50.85%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank3]:2025-10-29 02:54:06,854 - INFO - Avg. fwd time: 15.5207 / Avg. bwd time: 31.2405 / Avg. batch time: 389.5544 (ms) / GPU bubble ratio: 3.97%
[rank0]:2025-10-29 02:54:06,938 - INFO - Avg. fwd time: 14.5754 / Avg. bwd time: 27.6883 / Avg. batch time: 521.2661 (ms) / GPU bubble ratio: 35.14%
[rank2]:2025-10-29 02:54:06,891 - INFO - Avg. fwd time: 14.1907 / Avg. bwd time: 25.2863 / Avg. batch time: 431.6212 (ms) / GPU bubble ratio: 26.83%
[rank1]:2025-10-29 02:54:06,918 - INFO - Avg. fwd time: 16.4892 / Avg. bwd time: 26.4072 / Avg. batch time: 477.0434 (ms) / GPU bubble ratio: 28.06%
[rank2]:2025-10-29 02:54:26,981 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4143e-01
[rank1]:2025-10-29 02:54:26,978 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4505e+00
[rank3]:2025-10-29 02:54:26,981 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9129e-01
[rank0]:2025-10-29 02:54:26,985 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4335e-01
[rank0]:2025-10-29 02:54:46,370 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.4623e-01
[rank1]:2025-10-29 02:54:46,362 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2489e+00
[rank2]:2025-10-29 02:54:46,363 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1208e+00
[rank3]:2025-10-29 02:54:46,366 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9452e+00
[rank0]:2025-10-29 02:55:06,753 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4750e+00
[rank1]:2025-10-29 02:55:06,746 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6471e+00
[rank3]:2025-10-29 02:55:06,750 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.3283e-01
[rank2]:2025-10-29 02:55:06,749 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2675e-01
[rank3]:2025-10-29 02:55:26,042 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.5597e-01
[rank2]:2025-10-29 02:55:26,038 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9558e-01
[rank1]:2025-10-29 02:55:26,038 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.1199e-01
[rank0]:2025-10-29 02:55:26,046 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.1379e-01
[rank0]:2025-10-29 02:55:44,479 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:55:46,554 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2671e+00
[rank2]:2025-10-29 02:55:46,554 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 63.09GiB(45.12%)  tps: 8,187  tflops: 381.83  mfu: 38.61%
[rank1]:2025-10-29 02:55:46,551 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.7104e+00
[rank1]:2025-10-29 02:55:46,551 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 71.10GiB(50.85%)  tps: 8,187  tflops: 381.84  mfu: 38.61%
[rank2]:2025-10-29 02:55:46,555 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 02:55:46,551 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 02:55:46,554 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.5054e-01
[rank3]:2025-10-29 02:55:46,557 - INFO -  step: 1200  loss:  0.1004  grad_norm:  0.1267  memory: 79.24GiB(56.67%)  tps: 8,187  tflops: 381.85  mfu: 38.61%
[rank3]:2025-10-29 02:55:46,557 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 02:55:46,558 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4073e+00
[rank0]:2025-10-29 02:55:46,558 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 72.50GiB(51.86%)  tps: 8,187  tflops: 381.84  mfu: 38.61%
[rank0]:2025-10-29 02:55:46,559 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 02:56:03,068 - INFO - validate step: 1200  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 24,800
[rank1]:2025-10-29 02:56:03,069 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:56:03,033 - INFO - validate step: 1200  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 24,862
[rank0]:2025-10-29 02:56:03,034 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:56:03,038 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 02:56:03,096 - INFO - validate step: 1200  loss:  0.2473  memory: 79.24GiB(56.67%)  tps: 24,766
[rank3]:2025-10-29 02:56:03,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:56:03,084 - INFO - validate step: 1200  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,781
[rank2]:2025-10-29 02:56:03,084 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:56:13,633 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.55 seconds.
[rank1]:2025-10-29 02:56:15,102 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.03 seconds.
[rank0]:2025-10-29 02:56:17,109 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 02:56:17,115 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.08 seconds.
[rank3]:2025-10-29 02:56:19,687 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.59 seconds.
[rank1]:2025-10-29 02:56:19,814 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0256_stage1_step1200.svg
[rank1]:2025-10-29 02:56:19,826 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 02:56:19,807 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0256_stage2_step1200.svg
[rank2]:2025-10-29 02:56:19,819 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 02:56:19,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0256_stage0_step1200.svg
[rank3]:2025-10-29 02:56:19,978 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0256_real_step1200_rank3.svg
[rank3]:> Batch Time: 493.09 ms, GPU Bubble Ratio: 34.97%, 32.42%, 35.24%, 26.49%
[rank0]:2025-10-29 02:56:19,894 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 02:56:20,042 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0256_stage3_step1200.svg
[rank3]:2025-10-29 02:56:20,054 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 02:56:21,277 - INFO - Avg. fwd time: 15.5215 / Avg. bwd time: 31.1184 / Avg. batch time: 388.7490 (ms) / GPU bubble ratio: 4.02%
[rank1]:2025-10-29 02:56:21,341 - INFO - Avg. fwd time: 16.4897 / Avg. bwd time: 26.3153 / Avg. batch time: 475.9864 (ms) / GPU bubble ratio: 28.06%
[rank2]:2025-10-29 02:56:21,308 - INFO - Avg. fwd time: 14.1887 / Avg. bwd time: 25.2208 / Avg. batch time: 430.7179 (ms) / GPU bubble ratio: 26.80%
[rank0]:2025-10-29 02:56:21,375 - INFO - Avg. fwd time: 14.5814 / Avg. bwd time: 27.5376 / Avg. batch time: 520.0531 (ms) / GPU bubble ratio: 35.21%
[rank3]:2025-10-29 02:56:41,314 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6039e+01
[rank2]:2025-10-29 02:56:41,311 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2196e+01
[rank1]:2025-10-29 02:56:41,310 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6634e+01
[rank0]:2025-10-29 02:56:41,318 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5387e+01
[rank1]:2025-10-29 02:57:01,619 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.5564e-01
[rank2]:2025-10-29 02:57:01,622 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0109e-01
[rank3]:2025-10-29 02:57:01,625 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8841e+00
[rank0]:2025-10-29 02:57:01,629 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.0655e-01
[rank1]:2025-10-29 02:57:21,861 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9829e-01
[rank3]:2025-10-29 02:57:21,864 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1274e+00
[rank2]:2025-10-29 02:57:21,861 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3251e+00
[rank0]:2025-10-29 02:57:21,865 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5416e-01
[rank2]:2025-10-29 02:57:42,216 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4207e+00
[rank3]:2025-10-29 02:57:42,219 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0368e+00
[rank1]:2025-10-29 02:57:42,213 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.3961e-01
[rank0]:2025-10-29 02:57:42,223 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2596e-01
[rank0]:2025-10-29 02:58:02,298 - INFO - [GC] Peforming periodical GC collection 1.93 seconds
[rank2]:2025-10-29 02:58:04,322 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4776e-01
[rank2]:2025-10-29 02:58:04,323 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 64.04GiB(45.81%)  tps: 6,757  tflops: 315.14  mfu: 31.86%
[rank3]:2025-10-29 02:58:04,329 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1539e+00
[rank3]:2025-10-29 02:58:04,332 - INFO -  step: 1250  loss:  0.8744  grad_norm:  0.2396  memory: 79.24GiB(56.67%)  tps: 6,757  tflops: 315.16  mfu: 31.87%
[rank1]:2025-10-29 02:58:04,326 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.4045e-02
[rank1]:2025-10-29 02:58:04,326 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 72.05GiB(51.54%)  tps: 6,756  tflops: 315.09  mfu: 31.86%
[rank0]:2025-10-29 02:58:04,329 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9717e-01
[rank0]:2025-10-29 02:58:04,330 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 73.46GiB(52.54%)  tps: 6,754  tflops: 315.00  mfu: 31.85%
[rank2]:2025-10-29 02:58:04,723 - INFO - Avg. fwd time: 14.2215 / Avg. bwd time: 25.0691 / Avg. batch time: 429.8554 (ms) / GPU bubble ratio: 26.88%
[rank3]:2025-10-29 02:58:04,683 - INFO - Avg. fwd time: 15.5567 / Avg. bwd time: 30.9985 / Avg. batch time: 388.0611 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 02:58:04,746 - INFO - Avg. fwd time: 16.5237 / Avg. bwd time: 26.1628 / Avg. batch time: 474.9365 (ms) / GPU bubble ratio: 28.10%
[rank0]:2025-10-29 02:58:04,766 - INFO - Avg. fwd time: 14.6190 / Avg. bwd time: 27.3480 / Avg. batch time: 518.8222 (ms) / GPU bubble ratio: 35.29%
[rank2]:2025-10-29 02:58:24,651 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1972e-01
[rank1]:2025-10-29 02:58:24,648 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.5766e-01
[rank3]:2025-10-29 02:58:24,655 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6899e+00
[rank0]:2025-10-29 02:58:24,658 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4075e-01
[rank3]:2025-10-29 02:58:44,934 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5568e+00
[rank1]:2025-10-29 02:58:44,931 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5923e-01
[rank2]:2025-10-29 02:58:44,927 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4387e-01
[rank0]:2025-10-29 02:58:44,934 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8018e-01
[rank2]:2025-10-29 02:59:05,242 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0118e-01
[rank1]:2025-10-29 02:59:05,239 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.5591e-01
[rank3]:2025-10-29 02:59:05,245 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.0053e-01
[rank0]:2025-10-29 02:59:05,249 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7442e-01
[rank2]:2025-10-29 02:59:25,468 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7764e-01
[rank3]:2025-10-29 02:59:25,474 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.5670e-01
[rank1]:2025-10-29 02:59:25,471 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0591e-01
[rank0]:2025-10-29 02:59:25,475 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.5153e-01
[rank0]:2025-10-29 02:59:43,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:59:45,855 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.4511e-01
[rank1]:2025-10-29 02:59:45,855 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 72.05GiB(51.54%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank2]:2025-10-29 02:59:45,858 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3956e-01
[rank2]:2025-10-29 02:59:45,859 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 64.04GiB(45.81%)  tps: 8,068  tflops: 376.30  mfu: 38.05%
[rank2]:2025-10-29 02:59:45,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0259_stage2_step1300.svg
[rank3]:2025-10-29 02:59:45,862 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2090e+00
[rank3]:2025-10-29 02:59:45,866 - INFO -  step: 1300  loss:  0.7926  grad_norm:  0.2472  memory: 79.24GiB(56.67%)  tps: 8,068  tflops: 376.31  mfu: 38.05%
[rank1]:2025-10-29 02:59:45,941 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0259_stage1_step1300.svg
[rank0]:2025-10-29 02:59:45,865 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1411e-01
[rank0]:2025-10-29 02:59:45,866 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 73.46GiB(52.54%)  tps: 8,068  tflops: 376.30  mfu: 38.05%
[rank0]:2025-10-29 02:59:45,944 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0259_stage0_step1300.svg
[rank3]:2025-10-29 02:59:46,048 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0259_real_step1300_rank3.svg
[rank3]:> Batch Time: 492.33 ms, GPU Bubble Ratio: 34.89%, 32.40%, 35.24%, 26.52%
[rank3]:2025-10-29 02:59:46,112 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0259_stage3_step1300.svg
[rank2]:2025-10-29 02:59:46,455 - INFO - Avg. fwd time: 14.2623 / Avg. bwd time: 24.8686 / Avg. batch time: 428.9217 (ms) / GPU bubble ratio: 27.02%
[rank3]:2025-10-29 02:59:46,419 - INFO - Avg. fwd time: 15.5962 / Avg. bwd time: 30.8717 / Avg. batch time: 387.3522 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 02:59:46,484 - INFO - Avg. fwd time: 16.5644 / Avg. bwd time: 25.9922 / Avg. batch time: 473.7960 (ms) / GPU bubble ratio: 28.14%
[rank0]:2025-10-29 02:59:46,497 - INFO - Avg. fwd time: 14.6621 / Avg. bwd time: 27.1301 / Avg. batch time: 517.4726 (ms) / GPU bubble ratio: 35.39%
[rank2]:2025-10-29 03:00:06,254 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3437e-01
[rank3]:2025-10-29 03:00:06,261 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6700e+00
[rank1]:2025-10-29 03:00:06,257 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9661e-01
[rank0]:2025-10-29 03:00:06,261 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.3159e-01
[rank2]:2025-10-29 03:00:26,633 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.7824e-01
[rank1]:2025-10-29 03:00:26,630 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.7719e-01
[rank3]:2025-10-29 03:00:26,637 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3308e+00
[rank0]:2025-10-29 03:00:26,640 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.4005e-01
[rank2]:2025-10-29 03:00:46,858 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0781e+00
[rank1]:2025-10-29 03:00:46,861 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.7357e-01
[rank0]:2025-10-29 03:00:46,865 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4088e+00
[rank3]:2025-10-29 03:00:46,865 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0468e+00
[rank2]:2025-10-29 03:01:07,201 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.2413e-01
[rank1]:2025-10-29 03:01:07,198 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.3279e-01
[rank0]:2025-10-29 03:01:07,209 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1328e-01
[rank3]:2025-10-29 03:01:07,205 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0338e+00
[rank0]:2025-10-29 03:01:25,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:01:27,417 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1918e+00
[rank2]:2025-10-29 03:01:27,418 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 64.04GiB(45.81%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank0]:2025-10-29 03:01:27,425 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.0248e-01
[rank0]:2025-10-29 03:01:27,425 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 73.46GiB(52.54%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank3]:2025-10-29 03:01:27,424 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8538e+00
[rank3]:2025-10-29 03:01:27,427 - INFO -  step: 1350  loss:  0.8363  grad_norm:  0.2713  memory: 79.24GiB(56.67%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank1]:2025-10-29 03:01:27,421 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6581e-01
[rank1]:2025-10-29 03:01:27,421 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 72.05GiB(51.54%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank2]:2025-10-29 03:01:27,899 - INFO - Avg. fwd time: 14.3009 / Avg. bwd time: 24.6740 / Avg. batch time: 428.0932 (ms) / GPU bubble ratio: 27.17%
[rank3]:2025-10-29 03:01:27,870 - INFO - Avg. fwd time: 15.6335 / Avg. bwd time: 30.7563 / Avg. batch time: 386.7177 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 03:01:27,928 - INFO - Avg. fwd time: 16.6019 / Avg. bwd time: 25.8454 / Avg. batch time: 472.7897 (ms) / GPU bubble ratio: 28.18%
[rank0]:2025-10-29 03:01:27,960 - INFO - Avg. fwd time: 14.7028 / Avg. bwd time: 26.9195 / Avg. batch time: 516.2623 (ms) / GPU bubble ratio: 35.50%
[rank1]:2025-10-29 03:01:47,754 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.0762e-01
[rank2]:2025-10-29 03:01:47,757 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1890e-01
[rank0]:2025-10-29 03:01:47,764 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0163e-01
[rank3]:2025-10-29 03:01:47,761 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.2929e-01
[rank2]:2025-10-29 03:02:08,027 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3166e+00
[rank1]:2025-10-29 03:02:08,030 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0785e-01
[rank0]:2025-10-29 03:02:08,034 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0671e+00
[rank3]:2025-10-29 03:02:08,033 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.6905e-01
[rank2]:2025-10-29 03:02:28,352 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2566e-01
[rank1]:2025-10-29 03:02:28,349 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.9748e-01
[rank0]:2025-10-29 03:02:28,359 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3963e-01
[rank3]:2025-10-29 03:02:28,355 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3878e-01
[rank1]:2025-10-29 03:02:48,560 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9238e-01
[rank2]:2025-10-29 03:02:48,557 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2995e+00
[rank0]:2025-10-29 03:02:48,564 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1514e+00
[rank3]:2025-10-29 03:02:48,564 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8871e+00
[rank0]:2025-10-29 03:03:06,940 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:03:08,977 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0364e+00
[rank2]:2025-10-29 03:03:08,977 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 64.04GiB(45.81%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank1]:2025-10-29 03:03:08,974 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.2871e+00
[rank2]:2025-10-29 03:03:08,978 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 03:03:08,974 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 72.05GiB(51.54%)  tps: 8,067  tflops: 376.23  mfu: 38.04%
[rank1]:2025-10-29 03:03:08,974 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:03:08,984 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.1786e-01
[rank0]:2025-10-29 03:03:08,985 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 73.46GiB(52.54%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank0]:2025-10-29 03:03:08,985 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:03:08,981 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6821e+00
[rank3]:2025-10-29 03:03:08,983 - INFO -  step: 1400  loss:  0.8335  grad_norm:  0.3056  memory: 79.24GiB(56.67%)  tps: 8,067  tflops: 376.23  mfu: 38.04%
[rank3]:2025-10-29 03:03:08,983 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:03:25,315 - INFO - validate step: 1400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,082
[rank2]:2025-10-29 03:03:25,365 - INFO - validate step: 1400  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,995
[rank1]:2025-10-29 03:03:25,349 - INFO - validate step: 1400  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,014
[rank3]:2025-10-29 03:03:25,381 - INFO - validate step: 1400  loss:  0.2451  memory: 79.24GiB(56.67%)  tps: 24,980
[rank2]:2025-10-29 03:03:25,464 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0303_stage2_step1400.svg
[rank1]:2025-10-29 03:03:25,463 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0303_stage1_step1400.svg
[rank0]:2025-10-29 03:03:25,464 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0303_stage0_step1400.svg
[rank3]:2025-10-29 03:03:25,559 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0303_real_step1400_rank3.svg
[rank3]:> Batch Time: 491.65 ms, GPU Bubble Ratio: 34.79%, 32.44%, 35.30%, 26.53%
[rank3]:2025-10-29 03:03:25,624 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0303_stage3_step1400.svg
[rank3]:2025-10-29 03:03:25,935 - INFO - Avg. fwd time: 15.6628 / Avg. bwd time: 30.6641 / Avg. batch time: 386.2072 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-29 03:03:25,970 - INFO - Avg. fwd time: 14.3304 / Avg. bwd time: 24.5294 / Avg. batch time: 427.4200 (ms) / GPU bubble ratio: 27.27%
[rank1]:2025-10-29 03:03:26,001 - INFO - Avg. fwd time: 16.6329 / Avg. bwd time: 25.7179 / Avg. batch time: 471.9628 (ms) / GPU bubble ratio: 28.21%
[rank0]:2025-10-29 03:03:26,013 - INFO - Avg. fwd time: 14.7339 / Avg. bwd time: 26.7623 / Avg. batch time: 515.2827 (ms) / GPU bubble ratio: 35.58%
[rank2]:2025-10-29 03:03:45,753 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9684e-01
[rank1]:2025-10-29 03:03:45,756 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4052e-01
[rank0]:2025-10-29 03:03:45,760 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4901e-01
[rank3]:2025-10-29 03:03:45,760 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2719e-01
[rank2]:2025-10-29 03:04:06,067 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4619e-01
[rank1]:2025-10-29 03:04:06,064 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.5039e-01
[rank3]:2025-10-29 03:04:06,071 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3207e+00
[rank0]:2025-10-29 03:04:06,075 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0287e-01
[rank2]:2025-10-29 03:04:26,304 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4078e-01
[rank0]:2025-10-29 03:04:26,311 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5076e-01
[rank1]:2025-10-29 03:04:26,307 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0065e-01
[rank3]:2025-10-29 03:04:26,310 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1570e+00
[rank2]:2025-10-29 03:04:46,597 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6005e-01
[rank1]:2025-10-29 03:04:46,593 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.0055e-01
[rank0]:2025-10-29 03:04:46,604 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6467e-01
[rank3]:2025-10-29 03:04:46,600 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8740e-01
[rank0]:2025-10-29 03:05:04,870 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:05:06,890 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8827e-01
[rank2]:2025-10-29 03:05:06,891 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 64.04GiB(45.81%)  tps: 8,069  tflops: 376.34  mfu: 38.05%
[rank1]:2025-10-29 03:05:06,893 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9561e-02
[rank1]:2025-10-29 03:05:06,894 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 72.05GiB(51.54%)  tps: 8,067  tflops: 376.27  mfu: 38.05%
[rank0]:2025-10-29 03:05:06,897 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.8763e-01
[rank0]:2025-10-29 03:05:06,898 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 73.46GiB(52.54%)  tps: 8,064  tflops: 376.13  mfu: 38.03%
[rank3]:2025-10-29 03:05:06,897 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1271e-01
[rank3]:2025-10-29 03:05:06,900 - INFO -  step: 1450  loss:  0.8783  grad_norm:  0.4087  memory: 79.24GiB(56.67%)  tps: 8,070  tflops: 376.37  mfu: 38.06%
[rank2]:2025-10-29 03:05:07,292 - INFO - Avg. fwd time: 14.3635 / Avg. bwd time: 24.3641 / Avg. batch time: 426.6950 (ms) / GPU bubble ratio: 27.39%
[rank1]:2025-10-29 03:05:07,314 - INFO - Avg. fwd time: 16.6656 / Avg. bwd time: 25.5870 / Avg. batch time: 471.0796 (ms) / GPU bubble ratio: 28.25%
[rank3]:2025-10-29 03:05:07,250 - INFO - Avg. fwd time: 15.6949 / Avg. bwd time: 30.5633 / Avg. batch time: 385.6487 (ms) / GPU bubble ratio: 4.04%
[rank0]:2025-10-29 03:05:07,333 - INFO - Avg. fwd time: 14.7689 / Avg. bwd time: 26.5833 / Avg. batch time: 514.2260 (ms) / GPU bubble ratio: 35.67%
[rank2]:2025-10-29 03:05:27,227 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2019e-02
[rank1]:2025-10-29 03:05:27,224 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.8420e-01
[rank0]:2025-10-29 03:05:27,234 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1644e-01
[rank3]:2025-10-29 03:05:27,231 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2580e-01
[rank2]:2025-10-29 03:05:47,456 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0436e+00
[rank3]:2025-10-29 03:05:47,463 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2067e+00
[rank0]:2025-10-29 03:05:47,464 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6933e-01
[rank1]:2025-10-29 03:05:47,460 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7094e-01
[rank2]:2025-10-29 03:06:07,884 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1192e-01
[rank0]:2025-10-29 03:06:07,891 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0006e-01
[rank1]:2025-10-29 03:06:07,880 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.1860e-01
[rank3]:2025-10-29 03:06:07,887 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.1688e-01
[rank0]:2025-10-29 03:06:28,076 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.5405e-01
[rank2]:2025-10-29 03:06:28,069 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8801e-01
[rank1]:2025-10-29 03:06:28,072 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3123e-01
[rank3]:2025-10-29 03:06:28,075 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8608e-01
[rank0]:2025-10-29 03:06:46,373 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:06:48,414 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5324e+00
[rank0]:2025-10-29 03:06:48,418 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8336e-01
[rank0]:2025-10-29 03:06:48,418 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 73.46GiB(52.54%)  tps: 8,069  tflops: 376.35  mfu: 38.05%
[rank0]:2025-10-29 03:06:48,497 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0306_stage0_step1500.svg
[rank2]:2025-10-29 03:06:48,411 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0539e-01
[rank2]:2025-10-29 03:06:48,411 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 64.04GiB(45.81%)  tps: 8,069  tflops: 376.35  mfu: 38.05%
[rank2]:2025-10-29 03:06:48,498 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0306_stage2_step1500.svg
[rank1]:2025-10-29 03:06:48,408 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.5822e-01
[rank1]:2025-10-29 03:06:48,408 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 72.05GiB(51.54%)  tps: 8,070  tflops: 376.38  mfu: 38.06%
[rank1]:2025-10-29 03:06:48,498 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0306_stage1_step1500.svg
[rank3]:2025-10-29 03:06:48,417 - INFO -  step: 1500  loss:  0.7542  grad_norm:  0.4328  memory: 79.24GiB(56.67%)  tps: 8,070  tflops: 376.37  mfu: 38.06%
[rank3]:2025-10-29 03:06:48,597 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0306_real_step1500_rank3.svg
[rank3]:> Batch Time: 485.55 ms, GPU Bubble Ratio: 33.95%, 33.73%, 40.86%, 25.72%
[rank3]:2025-10-29 03:06:48,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0306_stage3_step1500.svg
[rank2]:2025-10-29 03:06:49,094 - INFO - Avg. fwd time: 14.3927 / Avg. bwd time: 24.2191 / Avg. batch time: 426.0309 (ms) / GPU bubble ratio: 27.49%
[rank3]:2025-10-29 03:06:49,066 - INFO - Avg. fwd time: 15.7244 / Avg. bwd time: 30.4697 / Avg. batch time: 385.1283 (ms) / GPU bubble ratio: 4.04%
[rank0]:2025-10-29 03:06:49,157 - INFO - Avg. fwd time: 14.8002 / Avg. bwd time: 26.4257 / Avg. batch time: 513.2540 (ms) / GPU bubble ratio: 35.74%
[rank1]:2025-10-29 03:06:49,128 - INFO - Avg. fwd time: 16.6963 / Avg. bwd time: 25.4562 / Avg. batch time: 470.2589 (ms) / GPU bubble ratio: 28.29%
[rank2]:2025-10-29 03:07:09,003 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4706e+00
[rank0]:2025-10-29 03:07:09,010 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4599e+00
[rank1]:2025-10-29 03:07:09,007 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.3725e-01
[rank3]:2025-10-29 03:07:09,009 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0577e+00
[rank1]:2025-10-29 03:07:29,337 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0647e+00
[rank3]:2025-10-29 03:07:29,344 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5015e+00
[rank2]:2025-10-29 03:07:29,340 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.8104e-01
[rank0]:2025-10-29 03:07:29,348 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1788e-01
[rank1]:2025-10-29 03:07:49,620 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8554e-01
[rank2]:2025-10-29 03:07:49,617 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8026e+00
[rank0]:2025-10-29 03:07:49,624 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.2073e-01
[rank3]:2025-10-29 03:07:49,624 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7828e-01
[rank2]:2025-10-29 03:08:09,980 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6853e-01
[rank1]:2025-10-29 03:08:09,977 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.4019e-01
[rank0]:2025-10-29 03:08:09,988 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9552e-01
[rank3]:2025-10-29 03:08:09,984 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2174e+00
[rank0]:2025-10-29 03:08:28,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:08:30,165 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2317e-01
[rank2]:2025-10-29 03:08:30,166 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 64.04GiB(45.81%)  tps: 8,051  tflops: 375.49  mfu: 37.97%
[rank1]:2025-10-29 03:08:30,168 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.1459e-02
[rank1]:2025-10-29 03:08:30,168 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 72.05GiB(51.54%)  tps: 8,050  tflops: 375.47  mfu: 37.96%
[rank0]:2025-10-29 03:08:30,172 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5868e-01
[rank0]:2025-10-29 03:08:30,172 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 73.46GiB(52.54%)  tps: 8,051  tflops: 375.49  mfu: 37.97%
[rank3]:2025-10-29 03:08:30,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2628e+00
[rank3]:2025-10-29 03:08:30,176 - INFO -  step: 1550  loss:  0.8153  grad_norm:  0.6395  memory: 79.24GiB(56.67%)  tps: 8,051  tflops: 375.48  mfu: 37.97%
[rank2]:2025-10-29 03:08:30,572 - INFO - Avg. fwd time: 14.4181 / Avg. bwd time: 24.0937 / Avg. batch time: 425.4828 (ms) / GPU bubble ratio: 27.59%
[rank3]:2025-10-29 03:08:30,532 - INFO - Avg. fwd time: 15.7488 / Avg. bwd time: 30.3952 / Avg. batch time: 384.7214 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-10-29 03:08:30,595 - INFO - Avg. fwd time: 16.7208 / Avg. bwd time: 25.3606 / Avg. batch time: 469.5941 (ms) / GPU bubble ratio: 28.31%
[rank0]:2025-10-29 03:08:30,615 - INFO - Avg. fwd time: 14.8269 / Avg. bwd time: 26.2898 / Avg. batch time: 512.4583 (ms) / GPU bubble ratio: 35.81%
[rank2]:2025-10-29 03:08:50,597 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.1185e-01
[rank1]:2025-10-29 03:08:50,594 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2290e-01
[rank0]:2025-10-29 03:08:50,605 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9935e-01
[rank3]:2025-10-29 03:08:50,601 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4651e+00
[rank2]:2025-10-29 03:09:10,827 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8090e-01
[rank0]:2025-10-29 03:09:10,835 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.3977e-01
[rank3]:2025-10-29 03:09:10,834 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.0748e-01
[rank1]:2025-10-29 03:09:10,831 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.2399e-02
[rank2]:2025-10-29 03:09:31,168 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6272e-01
[rank0]:2025-10-29 03:09:31,175 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2910e-01
[rank3]:2025-10-29 03:09:31,171 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0881e+00
[rank1]:2025-10-29 03:09:31,165 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2341e-01
[rank3]:2025-10-29 03:09:51,290 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2471e+00
[rank2]:2025-10-29 03:09:51,284 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2694e+00
[rank0]:2025-10-29 03:09:51,291 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.4494e+00
[rank1]:2025-10-29 03:09:51,287 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1962e+00
[rank0]:2025-10-29 03:10:08,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:10:10,614 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1578e+00
[rank3]:2025-10-29 03:10:10,618 - INFO -  step: 1600  loss:  0.1182  grad_norm:  0.1906  memory: 79.24GiB(56.67%)  tps: 8,156  tflops: 380.40  mfu: 38.46%
[rank3]:2025-10-29 03:10:10,619 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 03:10:10,611 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0705e+00
[rank2]:2025-10-29 03:10:10,611 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 64.04GiB(45.81%)  tps: 8,156  tflops: 380.39  mfu: 38.46%
[rank2]:2025-10-29 03:10:10,611 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 03:10:10,618 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6048e-01
[rank0]:2025-10-29 03:10:10,618 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 73.46GiB(52.54%)  tps: 8,156  tflops: 380.38  mfu: 38.46%
[rank0]:2025-10-29 03:10:10,618 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 03:10:10,608 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.4291e-01
[rank1]:2025-10-29 03:10:10,608 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 72.05GiB(51.54%)  tps: 8,156  tflops: 380.40  mfu: 38.46%
[rank1]:2025-10-29 03:10:10,608 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:10:26,966 - INFO - validate step: 1600  loss:  0.2458  memory: 79.24GiB(56.67%)  tps: 25,058
[rank2]:2025-10-29 03:10:26,958 - INFO - validate step: 1600  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,057
[rank0]:2025-10-29 03:10:26,908 - INFO - validate step: 1600  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,145
[rank1]:2025-10-29 03:10:26,942 - INFO - validate step: 1600  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,077
[rank2]:2025-10-29 03:10:27,053 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0310_stage2_step1600.svg
[rank0]:2025-10-29 03:10:27,048 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0310_stage0_step1600.svg
[rank1]:2025-10-29 03:10:27,052 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0310_stage1_step1600.svg
[rank3]:2025-10-29 03:10:27,150 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0310_real_step1600_rank3.svg
[rank3]:> Batch Time: 484.78 ms, GPU Bubble Ratio: 34.23%, 33.69%, 40.88%, 25.75%
[rank3]:2025-10-29 03:10:27,219 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0310_stage3_step1600.svg
[rank3]:2025-10-29 03:10:27,507 - INFO - Avg. fwd time: 15.7711 / Avg. bwd time: 30.3077 / Avg. batch time: 384.1923 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-10-29 03:10:27,542 - INFO - Avg. fwd time: 14.4415 / Avg. bwd time: 23.9604 / Avg. batch time: 424.7999 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-10-29 03:10:27,583 - INFO - Avg. fwd time: 14.8508 / Avg. bwd time: 26.1463 / Avg. batch time: 511.4929 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-10-29 03:10:27,571 - INFO - Avg. fwd time: 16.7443 / Avg. bwd time: 25.2462 / Avg. batch time: 468.7700 (ms) / GPU bubble ratio: 28.34%
[rank3]:2025-10-29 03:10:46,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9257e+00
[rank2]:2025-10-29 03:10:46,166 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7224e-01
[rank0]:2025-10-29 03:10:46,173 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4227e-01
[rank1]:2025-10-29 03:10:46,169 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.2879e-02
[rank3]:2025-10-29 03:11:05,497 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0776e-01
[rank2]:2025-10-29 03:11:05,494 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5242e+00
[rank0]:2025-10-29 03:11:05,501 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.0449e-01
[rank1]:2025-10-29 03:11:05,491 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1838e+00
[rank3]:2025-10-29 03:11:24,602 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.6495e-01
[rank2]:2025-10-29 03:11:24,596 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2489e-01
[rank0]:2025-10-29 03:11:24,603 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.1183e-01
[rank1]:2025-10-29 03:11:24,599 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0037e-01
[rank3]:2025-10-29 03:11:43,808 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.7524e-01
[rank2]:2025-10-29 03:11:43,805 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.1747e-01
[rank1]:2025-10-29 03:11:43,801 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3039e+00
[rank0]:2025-10-29 03:11:43,812 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3446e-01
[rank0]:2025-10-29 03:12:01,155 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:12:03,057 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0281e+00
[rank2]:2025-10-29 03:12:03,057 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 64.04GiB(45.81%)  tps: 8,525  tflops: 397.59  mfu: 40.20%
[rank1]:2025-10-29 03:12:03,060 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4255e-01
[rank1]:2025-10-29 03:12:03,061 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 72.05GiB(51.54%)  tps: 8,523  tflops: 397.51  mfu: 40.19%
[rank0]:2025-10-29 03:12:03,064 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7819e+00
[rank0]:2025-10-29 03:12:03,064 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 73.46GiB(52.54%)  tps: 8,519  tflops: 397.35  mfu: 40.18%
[rank3]:2025-10-29 03:12:03,063 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8415e+00
[rank3]:2025-10-29 03:12:03,066 - INFO -  step: 1650  loss:  0.1028  grad_norm:  0.1656  memory: 79.24GiB(56.67%)  tps: 8,525  tflops: 397.59  mfu: 40.20%
[rank3]:2025-10-29 03:12:03,480 - INFO - Avg. fwd time: 15.7721 / Avg. bwd time: 30.2054 / Avg. batch time: 383.3702 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 03:12:03,513 - INFO - Avg. fwd time: 14.4507 / Avg. bwd time: 23.8175 / Avg. batch time: 423.8247 (ms) / GPU bubble ratio: 27.77%
[rank1]:2025-10-29 03:12:03,544 - INFO - Avg. fwd time: 16.7504 / Avg. bwd time: 25.1387 / Avg. batch time: 467.6536 (ms) / GPU bubble ratio: 28.34%
[rank0]:2025-10-29 03:12:03,576 - INFO - Avg. fwd time: 14.8584 / Avg. bwd time: 25.9964 / Avg. batch time: 510.2142 (ms) / GPU bubble ratio: 35.94%
[rank3]:2025-10-29 03:12:22,265 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6569e+00
[rank2]:2025-10-29 03:12:22,262 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3361e+00
[rank1]:2025-10-29 03:12:22,259 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7174e+00
[rank0]:2025-10-29 03:12:22,269 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1074e+00
[rank2]:2025-10-29 03:12:41,388 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0255e+00
[rank1]:2025-10-29 03:12:41,391 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.5312e-01
[rank0]:2025-10-29 03:12:41,395 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3736e+00
[rank3]:2025-10-29 03:12:41,394 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.1481e-01
[rank3]:2025-10-29 03:13:00,754 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4554e+00
[rank2]:2025-10-29 03:13:00,750 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0805e+00
[rank0]:2025-10-29 03:13:00,758 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1761e-01
[rank1]:2025-10-29 03:13:00,747 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0714e+00
[rank3]:2025-10-29 03:13:19,816 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7249e+00
[rank2]:2025-10-29 03:13:19,809 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7976e-01
[rank0]:2025-10-29 03:13:19,817 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.3323e-01
[rank1]:2025-10-29 03:13:19,813 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3079e-01
[rank0]:2025-10-29 03:13:37,289 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:13:39,194 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.6720e-01
[rank3]:2025-10-29 03:13:39,196 - INFO -  step: 1700  loss:  0.1097  grad_norm:  0.1523  memory: 79.24GiB(56.67%)  tps: 8,522  tflops: 397.46  mfu: 40.19%
[rank2]:2025-10-29 03:13:39,190 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.7894e-01
[rank2]:2025-10-29 03:13:39,191 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 64.04GiB(45.81%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank0]:2025-10-29 03:13:39,197 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2716e-01
[rank0]:2025-10-29 03:13:39,198 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 73.46GiB(52.54%)  tps: 8,522  tflops: 397.44  mfu: 40.19%
[rank1]:2025-10-29 03:13:39,187 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.7601e-01
[rank1]:2025-10-29 03:13:39,188 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 72.05GiB(51.54%)  tps: 8,522  tflops: 397.47  mfu: 40.19%
[rank2]:2025-10-29 03:13:39,281 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0313_stage2_step1700.svg
[rank0]:2025-10-29 03:13:39,277 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0313_stage0_step1700.svg
[rank1]:2025-10-29 03:13:39,280 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0313_stage1_step1700.svg
[rank3]:2025-10-29 03:13:39,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0313_real_step1700_rank3.svg
[rank3]:> Batch Time: 483.50 ms, GPU Bubble Ratio: 34.09%, 33.62%, 40.79%, 25.78%
[rank3]:2025-10-29 03:13:39,444 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0313_stage3_step1700.svg
[rank3]:2025-10-29 03:13:39,724 - INFO - Avg. fwd time: 15.7727 / Avg. bwd time: 30.1232 / Avg. batch time: 382.7087 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 03:13:39,758 - INFO - Avg. fwd time: 14.4569 / Avg. bwd time: 23.7107 / Avg. batch time: 423.0307 (ms) / GPU bubble ratio: 27.82%
[rank0]:2025-10-29 03:13:39,799 - INFO - Avg. fwd time: 14.8633 / Avg. bwd time: 25.8840 / Avg. batch time: 509.1719 (ms) / GPU bubble ratio: 35.98%
[rank1]:2025-10-29 03:13:39,788 - INFO - Avg. fwd time: 16.7558 / Avg. bwd time: 25.0430 / Avg. batch time: 466.7344 (ms) / GPU bubble ratio: 28.36%
[rank3]:2025-10-29 03:13:58,525 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4015e+00
[rank2]:2025-10-29 03:13:58,519 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7353e+00
[rank0]:2025-10-29 03:13:58,526 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3987e+00
[rank1]:2025-10-29 03:13:58,522 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.6089e-01
[rank2]:2025-10-29 03:14:17,768 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.8925e-01
[rank1]:2025-10-29 03:14:17,765 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5350e+00
[rank3]:2025-10-29 03:14:17,772 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1781e+00
[rank0]:2025-10-29 03:14:17,775 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5344e-01
[rank3]:2025-10-29 03:14:37,027 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.1221e-01
[rank2]:2025-10-29 03:14:37,020 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0617e+00
[rank0]:2025-10-29 03:14:37,027 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2126e+00
[rank1]:2025-10-29 03:14:37,023 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8672e-01
[rank3]:2025-10-29 03:14:56,186 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9299e+00
[rank2]:2025-10-29 03:14:56,182 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8136e-01
[rank0]:2025-10-29 03:14:56,190 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3516e-01
[rank1]:2025-10-29 03:14:56,179 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.3373e-01
[rank0]:2025-10-29 03:15:13,428 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:15:15,323 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2572e+00
[rank2]:2025-10-29 03:15:15,323 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 64.04GiB(45.81%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank0]:2025-10-29 03:15:15,330 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8534e+00
[rank0]:2025-10-29 03:15:15,331 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 73.46GiB(52.54%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank1]:2025-10-29 03:15:15,326 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7549e-01
[rank1]:2025-10-29 03:15:15,327 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 72.05GiB(51.54%)  tps: 8,521  tflops: 397.42  mfu: 40.18%
[rank3]:2025-10-29 03:15:15,330 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8118e+00
[rank3]:2025-10-29 03:15:15,332 - INFO -  step: 1750  loss:  0.1102  grad_norm:  0.0860  memory: 79.24GiB(56.67%)  tps: 8,521  tflops: 397.44  mfu: 40.19%
[rank2]:2025-10-29 03:15:15,699 - INFO - Avg. fwd time: 14.4648 / Avg. bwd time: 23.5869 / Avg. batch time: 422.1719 (ms) / GPU bubble ratio: 27.89%
[rank1]:2025-10-29 03:15:15,721 - INFO - Avg. fwd time: 16.7610 / Avg. bwd time: 24.9442 / Avg. batch time: 465.7451 (ms) / GPU bubble ratio: 28.36%
[rank3]:2025-10-29 03:15:15,661 - INFO - Avg. fwd time: 15.7738 / Avg. bwd time: 30.0329 / Avg. batch time: 381.9848 (ms) / GPU bubble ratio: 4.07%
[rank0]:2025-10-29 03:15:15,741 - INFO - Avg. fwd time: 14.8694 / Avg. bwd time: 25.7535 / Avg. batch time: 508.0394 (ms) / GPU bubble ratio: 36.03%
[rank2]:2025-10-29 03:15:34,701 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6452e-01
[rank0]:2025-10-29 03:15:34,708 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0814e-01
[rank1]:2025-10-29 03:15:34,698 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.9964e-01
[rank3]:2025-10-29 03:15:34,704 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0847e+00
[rank2]:2025-10-29 03:15:53,750 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0694e+00
[rank1]:2025-10-29 03:15:53,753 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2768e-01
[rank3]:2025-10-29 03:15:53,757 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2114e+00
[rank0]:2025-10-29 03:15:53,757 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.8205e-01
[rank2]:2025-10-29 03:16:13,126 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.2973e-01
[rank0]:2025-10-29 03:16:13,133 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3919e-01
[rank1]:2025-10-29 03:16:13,123 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.2728e+00
[rank3]:2025-10-29 03:16:13,129 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4813e+00
[rank0]:2025-10-29 03:16:32,264 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5156e-01
[rank2]:2025-10-29 03:16:32,257 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1671e+00
[rank1]:2025-10-29 03:16:32,260 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1738e-01
[rank3]:2025-10-29 03:16:32,264 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2862e+00
[rank0]:2025-10-29 03:16:49,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:16:51,478 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9372e-01
[rank0]:2025-10-29 03:16:51,479 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 73.46GiB(52.54%)  tps: 8,520  tflops: 397.38  mfu: 40.18%
[rank0]:2025-10-29 03:16:51,479 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 03:16:51,471 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9764e-01
[rank2]:2025-10-29 03:16:51,471 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 64.04GiB(45.81%)  tps: 8,520  tflops: 397.38  mfu: 40.18%
[rank2]:2025-10-29 03:16:51,471 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 03:16:51,475 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0470e+00
[rank3]:2025-10-29 03:16:51,480 - INFO -  step: 1800  loss:  0.0866  grad_norm:  0.0764  memory: 79.24GiB(56.67%)  tps: 8,521  tflops: 397.40  mfu: 40.18%
[rank3]:2025-10-29 03:16:51,481 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 03:16:51,468 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.8994e-01
[rank1]:2025-10-29 03:16:51,468 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 72.05GiB(51.54%)  tps: 8,521  tflops: 397.41  mfu: 40.18%
[rank1]:2025-10-29 03:16:51,468 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 03:17:07,853 - INFO - validate step: 1800  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,015
[rank2]:2025-10-29 03:17:07,903 - INFO - validate step: 1800  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,928
[rank3]:2025-10-29 03:17:07,917 - INFO - validate step: 1800  loss:  0.2425  memory: 79.24GiB(56.67%)  tps: 24,921
[rank1]:2025-10-29 03:17:07,886 - INFO - validate step: 1800  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,949
[rank0]:2025-10-29 03:17:08,000 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0317_stage0_step1800.svg
[rank2]:2025-10-29 03:17:08,001 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0317_stage2_step1800.svg
[rank1]:2025-10-29 03:17:08,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0317_stage1_step1800.svg
[rank3]:2025-10-29 03:17:08,101 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0317_real_step1800_rank3.svg
[rank3]:> Batch Time: 481.48 ms, GPU Bubble Ratio: 33.93%, 33.42%, 40.58%, 25.87%
[rank3]:2025-10-29 03:17:08,168 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0317_stage3_step1800.svg
[rank2]:2025-10-29 03:17:08,570 - INFO - Avg. fwd time: 14.4706 / Avg. bwd time: 23.4775 / Avg. batch time: 421.3678 (ms) / GPU bubble ratio: 27.95%
[rank3]:2025-10-29 03:17:08,541 - INFO - Avg. fwd time: 15.7745 / Avg. bwd time: 29.9478 / Avg. batch time: 381.2999 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-29 03:17:08,602 - INFO - Avg. fwd time: 16.7663 / Avg. bwd time: 24.8435 / Avg. batch time: 464.8106 (ms) / GPU bubble ratio: 28.38%
[rank0]:2025-10-29 03:17:08,633 - INFO - Avg. fwd time: 14.8735 / Avg. bwd time: 25.6380 / Avg. batch time: 506.9781 (ms) / GPU bubble ratio: 36.07%
[rank0]:2025-10-29 03:17:27,424 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.6678e+00
[rank2]:2025-10-29 03:17:27,417 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8288e+00
[rank3]:2025-10-29 03:17:27,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8062e+00
[rank1]:2025-10-29 03:17:27,420 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4838e+00
[rank0]:2025-10-29 03:17:46,577 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7158e+00
[rank2]:2025-10-29 03:17:46,570 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1414e+00
[rank3]:2025-10-29 03:17:46,573 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1737e+00
[rank1]:2025-10-29 03:17:46,566 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2671e+00
[rank0]:2025-10-29 03:18:05,700 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1982e+00
[rank2]:2025-10-29 03:18:05,693 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0798e+00
[rank3]:2025-10-29 03:18:05,699 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7027e+00
[rank1]:2025-10-29 03:18:05,696 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.5715e-01
[rank0]:2025-10-29 03:18:25,071 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3219e-01
[rank2]:2025-10-29 03:18:25,064 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4430e+00
[rank3]:2025-10-29 03:18:25,068 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0110e+00
[rank1]:2025-10-29 03:18:25,061 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.8127e+00
[rank0]:2025-10-29 03:18:42,173 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:18:44,088 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.8959e+00
[rank0]:2025-10-29 03:18:44,089 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 73.46GiB(52.54%)  tps: 8,512  tflops: 397.02  mfu: 40.14%
[rank2]:2025-10-29 03:18:44,081 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2053e+00
[rank2]:2025-10-29 03:18:44,082 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 64.04GiB(45.81%)  tps: 8,518  tflops: 397.26  mfu: 40.17%
[rank3]:2025-10-29 03:18:44,088 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3204e+00
[rank3]:2025-10-29 03:18:44,090 - INFO -  step: 1850  loss:  0.0766  grad_norm:  0.0830  memory: 79.24GiB(56.67%)  tps: 8,518  tflops: 397.28  mfu: 40.17%
[rank1]:2025-10-29 03:18:44,084 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6642e-01
[rank1]:2025-10-29 03:18:44,085 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 72.05GiB(51.54%)  tps: 8,516  tflops: 397.18  mfu: 40.16%
[rank2]:2025-10-29 03:18:44,461 - INFO - Avg. fwd time: 14.4766 / Avg. bwd time: 23.3809 / Avg. batch time: 420.6897 (ms) / GPU bubble ratio: 28.01%
[rank3]:2025-10-29 03:18:44,420 - INFO - Avg. fwd time: 15.7751 / Avg. bwd time: 29.8782 / Avg. batch time: 380.7408 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-29 03:18:44,483 - INFO - Avg. fwd time: 16.7700 / Avg. bwd time: 24.7696 / Avg. batch time: 464.0343 (ms) / GPU bubble ratio: 28.39%
[rank0]:2025-10-29 03:18:44,502 - INFO - Avg. fwd time: 14.8783 / Avg. bwd time: 25.5375 / Avg. batch time: 506.0914 (ms) / GPU bubble ratio: 36.11%
[rank1]:2025-10-29 03:19:03,416 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0417e-01
[rank0]:2025-10-29 03:19:03,427 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0569e+00
[rank2]:2025-10-29 03:19:03,420 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1968e-01
[rank3]:2025-10-29 03:19:03,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6910e+00
[rank2]:2025-10-29 03:19:22,537 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3327e+00
[rank0]:2025-10-29 03:19:22,544 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1557e+00
[rank3]:2025-10-29 03:19:22,543 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4406e+00
[rank1]:2025-10-29 03:19:22,540 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9249e-01
[rank0]:2025-10-29 03:19:41,796 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1907e-01
[rank2]:2025-10-29 03:19:41,789 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6890e-01
[rank3]:2025-10-29 03:19:41,792 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.8710e-01
[rank1]:2025-10-29 03:19:41,786 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.2258e-01
[rank2]:2025-10-29 03:20:01,031 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3322e-01
[rank0]:2025-10-29 03:20:01,038 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5556e+00
[rank1]:2025-10-29 03:20:01,034 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.0395e-02
[rank3]:2025-10-29 03:20:01,037 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3079e-01
[rank0]:2025-10-29 03:20:18,292 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:20:20,236 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.2051e-01
[rank3]:2025-10-29 03:20:20,238 - INFO -  step: 1900  loss:  0.0896  grad_norm:  0.0921  memory: 79.24GiB(56.67%)  tps: 8,520  tflops: 397.39  mfu: 40.18%
[rank2]:2025-10-29 03:20:20,232 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0359e-01
[rank2]:2025-10-29 03:20:20,233 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 64.04GiB(45.81%)  tps: 8,520  tflops: 397.37  mfu: 40.18%
[rank0]:2025-10-29 03:20:20,240 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7458e-01
[rank0]:2025-10-29 03:20:20,240 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 73.46GiB(52.54%)  tps: 8,520  tflops: 397.37  mfu: 40.18%
[rank1]:2025-10-29 03:20:20,229 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.8937e-01
[rank1]:2025-10-29 03:20:20,230 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 72.05GiB(51.54%)  tps: 8,520  tflops: 397.40  mfu: 40.18%
[rank2]:2025-10-29 03:20:20,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0320_stage2_step1900.svg
[rank0]:2025-10-29 03:20:20,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0320_stage0_step1900.svg
[rank1]:2025-10-29 03:20:20,322 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0320_stage1_step1900.svg
[rank3]:2025-10-29 03:20:20,427 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0320_real_step1900_rank3.svg
[rank3]:> Batch Time: 474.38 ms, GPU Bubble Ratio: 35.57%, 32.50%, 39.74%, 25.88%
[rank3]:2025-10-29 03:20:20,496 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0320_stage3_step1900.svg
[rank2]:2025-10-29 03:20:20,817 - INFO - Avg. fwd time: 14.4823 / Avg. bwd time: 23.2799 / Avg. batch time: 419.9462 (ms) / GPU bubble ratio: 28.06%
[rank0]:2025-10-29 03:20:20,858 - INFO - Avg. fwd time: 14.8829 / Avg. bwd time: 25.4318 / Avg. batch time: 505.1160 (ms) / GPU bubble ratio: 36.15%
[rank3]:2025-10-29 03:20:20,782 - INFO - Avg. fwd time: 15.7757 / Avg. bwd time: 29.8014 / Avg. batch time: 380.1232 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-10-29 03:20:20,846 - INFO - Avg. fwd time: 16.7748 / Avg. bwd time: 24.6822 / Avg. batch time: 463.1761 (ms) / GPU bubble ratio: 28.40%
[rank3]:2025-10-29 03:20:39,575 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7918e-01
[rank0]:2025-10-29 03:20:39,576 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3727e+00
[rank2]:2025-10-29 03:20:39,569 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2423e-01
[rank1]:2025-10-29 03:20:39,572 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.3769e-01
[rank3]:2025-10-29 03:20:58,908 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4898e+00
[rank2]:2025-10-29 03:20:58,905 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1142e-01
[rank1]:2025-10-29 03:20:58,901 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.0595e-01
[rank0]:2025-10-29 03:20:58,912 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3745e-01
[rank0]:2025-10-29 03:21:17,964 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.0975e-01
[rank1]:2025-10-29 03:21:17,960 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7746e-01
[rank3]:2025-10-29 03:21:17,963 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2774e+00
[rank2]:2025-10-29 03:21:17,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2428e+00
[rank0]:2025-10-29 03:21:37,323 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7164e-01
[rank1]:2025-10-29 03:21:37,313 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0173e+00
[rank3]:2025-10-29 03:21:37,319 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8193e+00
[rank2]:2025-10-29 03:21:37,316 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.5479e-01
[rank0]:2025-10-29 03:21:54,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:21:56,426 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4011e+00
[rank0]:2025-10-29 03:21:56,426 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 73.46GiB(52.54%)  tps: 8,517  tflops: 397.23  mfu: 40.16%
[rank1]:2025-10-29 03:21:56,422 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.0009e-01
[rank1]:2025-10-29 03:21:56,422 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 72.05GiB(51.54%)  tps: 8,516  tflops: 397.20  mfu: 40.16%
[rank2]:2025-10-29 03:21:56,419 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0335e+00
[rank2]:2025-10-29 03:21:56,419 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 64.04GiB(45.81%)  tps: 8,517  tflops: 397.23  mfu: 40.16%
[rank3]:2025-10-29 03:21:56,426 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8015e+00
[rank3]:2025-10-29 03:21:56,428 - INFO -  step: 1950  loss:  0.1214  grad_norm:  0.1280  memory: 79.24GiB(56.67%)  tps: 8,517  tflops: 397.22  mfu: 40.16%
[rank3]:2025-10-29 03:21:56,855 - INFO - Avg. fwd time: 15.7771 / Avg. bwd time: 29.7289 / Avg. batch time: 379.5454 (ms) / GPU bubble ratio: 4.08%
[rank0]:2025-10-29 03:21:56,952 - INFO - Avg. fwd time: 14.8884 / Avg. bwd time: 25.3254 / Avg. batch time: 504.2141 (ms) / GPU bubble ratio: 36.20%
[rank1]:2025-10-29 03:21:56,918 - INFO - Avg. fwd time: 16.7787 / Avg. bwd time: 24.6061 / Avg. batch time: 462.3908 (ms) / GPU bubble ratio: 28.40%
[rank2]:2025-10-29 03:21:56,888 - INFO - Avg. fwd time: 14.4892 / Avg. bwd time: 23.1779 / Avg. batch time: 419.2611 (ms) / GPU bubble ratio: 28.13%
[rank1]:2025-10-29 03:22:15,671 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7620e+00
[rank2]:2025-10-29 03:22:15,674 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.5284e-01
[rank3]:2025-10-29 03:22:15,678 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0648e+00
[rank0]:2025-10-29 03:22:15,681 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2903e+00
[rank0]:2025-10-29 03:22:34,942 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.7153e+00
[rank1]:2025-10-29 03:22:34,938 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8576e+00
[rank2]:2025-10-29 03:22:34,935 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3488e+00
[rank3]:2025-10-29 03:22:34,942 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.8445e+00
[rank1]:2025-10-29 03:22:54,080 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2341e+01
[rank0]:2025-10-29 03:22:54,091 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8203e+01
[rank2]:2025-10-29 03:22:54,083 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9914e+01
[rank3]:2025-10-29 03:22:54,087 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8154e+01
[rank1]:2025-10-29 03:23:13,121 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1499e+00
[rank2]:2025-10-29 03:23:13,121 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8162e+00
[rank3]:2025-10-29 03:23:13,128 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6582e+00
[rank0]:2025-10-29 03:23:13,128 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.2876e+00
[rank0]:2025-10-29 03:23:30,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:23:32,480 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5579e+00
[rank1]:2025-10-29 03:23:32,481 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 72.05GiB(51.54%)  tps: 8,528  tflops: 397.75  mfu: 40.22%
[rank1]:2025-10-29 03:23:32,481 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 03:23:32,491 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.3670e-01
[rank0]:2025-10-29 03:23:32,491 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 73.46GiB(52.54%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank0]:2025-10-29 03:23:32,491 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 03:23:32,483 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.9969e-01
[rank2]:2025-10-29 03:23:32,484 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 64.04GiB(45.81%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank2]:2025-10-29 03:23:32,484 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 03:23:32,487 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3865e+00
[rank3]:2025-10-29 03:23:32,491 - INFO -  step: 2000  loss:  0.0996  grad_norm:  0.1331  memory: 79.24GiB(56.67%)  tps: 8,528  tflops: 397.74  mfu: 40.22%
[rank3]:2025-10-29 03:23:32,491 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 03:23:49,007 - INFO - validate step: 2000  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,785
[rank0]:2025-10-29 03:23:48,972 - INFO - validate step: 2000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,853
[rank2]:2025-10-29 03:23:49,024 - INFO - validate step: 2000  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,765
[rank3]:2025-10-29 03:23:49,029 - INFO - validate step: 2000  loss:  0.2443  memory: 79.24GiB(56.67%)  tps: 24,768
[rank1]:2025-10-29 03:23:49,116 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0323_stage1_step2000.svg
[rank0]:2025-10-29 03:23:49,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0323_stage0_step2000.svg
[rank2]:2025-10-29 03:23:49,119 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0323_stage2_step2000.svg
[rank3]:2025-10-29 03:23:49,212 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0323_real_step2000_rank3.svg
[rank3]:> Batch Time: 473.20 ms, GPU Bubble Ratio: 35.56%, 32.40%, 39.66%, 25.91%
[rank3]:2025-10-29 03:23:49,281 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0323_stage3_step2000.svg
[rank1]:2025-10-29 03:23:49,637 - INFO - Avg. fwd time: 16.7828 / Avg. bwd time: 24.5232 / Avg. batch time: 461.7090 (ms) / GPU bubble ratio: 28.43%
[rank0]:2025-10-29 03:23:49,647 - INFO - Avg. fwd time: 14.8912 / Avg. bwd time: 25.2454 / Avg. batch time: 503.4430 (ms) / GPU bubble ratio: 36.22%
[rank2]:2025-10-29 03:23:49,609 - INFO - Avg. fwd time: 14.4932 / Avg. bwd time: 23.1016 / Avg. batch time: 418.6852 (ms) / GPU bubble ratio: 28.17%
[rank3]:2025-10-29 03:23:49,573 - INFO - Avg. fwd time: 15.7774 / Avg. bwd time: 29.6694 / Avg. batch time: 379.0658 (ms) / GPU bubble ratio: 4.09%
[rank1]:2025-10-29 03:24:08,148 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.1284e-01
[rank0]:2025-10-29 03:24:08,155 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5023e-01
[rank2]:2025-10-29 03:24:08,148 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4596e-01
[rank3]:2025-10-29 03:24:08,155 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5873e+00
[rank2]:2025-10-29 03:24:27,498 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5918e-01
[rank1]:2025-10-29 03:24:27,495 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4545e-01
[rank0]:2025-10-29 03:24:27,505 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6839e-01
[rank3]:2025-10-29 03:24:27,502 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0959e+00
[rank0]:2025-10-29 03:24:46,519 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7208e+00
[rank2]:2025-10-29 03:24:46,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5611e+00
[rank1]:2025-10-29 03:24:46,512 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.4305e-01
[rank3]:2025-10-29 03:24:46,519 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0618e+00
[rank2]:2025-10-29 03:25:05,749 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.6756e-01
[rank1]:2025-10-29 03:25:05,746 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1081e+00
[rank0]:2025-10-29 03:25:05,756 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4361e-01
[rank3]:2025-10-29 03:25:05,753 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5863e+00
[rank0]:2025-10-29 03:25:23,039 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:25:24,956 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1213e+00
[rank0]:2025-10-29 03:25:24,957 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 73.46GiB(52.54%)  tps: 8,535  tflops: 398.06  mfu: 40.25%
[rank1]:2025-10-29 03:25:24,949 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1668e-01
[rank2]:2025-10-29 03:25:24,949 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3389e+00
[rank3]:2025-10-29 03:25:24,956 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7462e+00
[rank1]:2025-10-29 03:25:24,950 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 72.05GiB(51.54%)  tps: 8,539  tflops: 398.24  mfu: 40.27%
[rank3]:2025-10-29 03:25:24,959 - INFO -  step: 2050  loss:  0.1386  grad_norm:  0.1307  memory: 79.24GiB(56.67%)  tps: 8,540  tflops: 398.30  mfu: 40.27%
[rank2]:2025-10-29 03:25:24,950 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 64.04GiB(45.81%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank2]:2025-10-29 03:25:25,325 - INFO - Avg. fwd time: 14.4993 / Avg. bwd time: 23.0119 / Avg. batch time: 418.0775 (ms) / GPU bubble ratio: 28.22%
[rank3]:2025-10-29 03:25:25,286 - INFO - Avg. fwd time: 15.7793 / Avg. bwd time: 29.6044 / Avg. batch time: 378.5542 (ms) / GPU bubble ratio: 4.09%
[rank0]:2025-10-29 03:25:25,365 - INFO - Avg. fwd time: 14.8964 / Avg. bwd time: 25.1519 / Avg. batch time: 502.6018 (ms) / GPU bubble ratio: 36.25%
[rank1]:2025-10-29 03:25:25,346 - INFO - Avg. fwd time: 16.7910 / Avg. bwd time: 24.4172 / Avg. batch time: 460.9706 (ms) / GPU bubble ratio: 28.48%
[rank0]:2025-10-29 03:25:44,133 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0893e-01
[rank3]:2025-10-29 03:25:44,129 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8972e-01
[rank1]:2025-10-29 03:25:44,122 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0496e+00
[rank2]:2025-10-29 03:25:44,126 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7966e-01
[rank2]:2025-10-29 03:26:03,176 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3260e-01
[rank1]:2025-10-29 03:26:03,176 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0495e-01
[rank3]:2025-10-29 03:26:03,182 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0490e-01
[rank0]:2025-10-29 03:26:03,183 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.8326e-01
[rank3]:2025-10-29 03:26:22,554 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2416e-01
[rank0]:2025-10-29 03:26:22,558 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3983e-01
[rank2]:2025-10-29 03:26:22,550 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8445e-01
[rank1]:2025-10-29 03:26:22,547 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0093e+00
[rank0]:2025-10-29 03:26:41,458 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.9659e-01
[rank2]:2025-10-29 03:26:41,451 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6516e-01
[rank3]:2025-10-29 03:26:41,458 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4035e+00
[rank1]:2025-10-29 03:26:41,451 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.7591e-01
[rank0]:2025-10-29 03:26:58,912 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:27:00,824 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3793e-01
[rank0]:2025-10-29 03:27:00,824 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 73.46GiB(52.54%)  tps: 8,545  tflops: 398.55  mfu: 40.30%
[rank3]:2025-10-29 03:27:00,820 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2569e-01
[rank3]:2025-10-29 03:27:00,823 - INFO -  step: 2100  loss:  0.1186  grad_norm:  0.1124  memory: 79.24GiB(56.67%)  tps: 8,546  tflops: 398.56  mfu: 40.30%
[rank2]:2025-10-29 03:27:00,817 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0586e-01
[rank2]:2025-10-29 03:27:00,817 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 64.04GiB(45.81%)  tps: 8,545  tflops: 398.55  mfu: 40.30%
[rank1]:2025-10-29 03:27:00,814 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.9941e-01
[rank1]:2025-10-29 03:27:00,814 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 72.05GiB(51.54%)  tps: 8,545  tflops: 398.56  mfu: 40.30%
[rank0]:2025-10-29 03:27:00,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0327_stage0_step2100.svg
[rank2]:2025-10-29 03:27:00,903 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0327_stage2_step2100.svg
[rank1]:2025-10-29 03:27:00,902 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0327_stage1_step2100.svg
[rank3]:2025-10-29 03:27:01,005 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0327_real_step2100_rank3.svg
[rank3]:> Batch Time: 472.44 ms, GPU Bubble Ratio: 35.52%, 32.36%, 39.61%, 25.94%
[rank3]:2025-10-29 03:27:01,066 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0327_stage3_step2100.svg
[rank0]:2025-10-29 03:27:01,526 - INFO - Avg. fwd time: 14.9001 / Avg. bwd time: 25.0691 / Avg. batch time: 501.8044 (ms) / GPU bubble ratio: 36.28%
[rank1]:2025-10-29 03:27:01,496 - INFO - Avg. fwd time: 16.7978 / Avg. bwd time: 24.3162 / Avg. batch time: 460.2634 (ms) / GPU bubble ratio: 28.54%
[rank2]:2025-10-29 03:27:01,465 - INFO - Avg. fwd time: 14.5037 / Avg. bwd time: 22.9329 / Avg. batch time: 417.4942 (ms) / GPU bubble ratio: 28.26%
[rank3]:2025-10-29 03:27:01,435 - INFO - Avg. fwd time: 15.7801 / Avg. bwd time: 29.5421 / Avg. batch time: 378.0557 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-29 03:27:20,052 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5090e+00
[rank0]:2025-10-29 03:27:20,059 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8056e+00
[rank3]:2025-10-29 03:27:20,059 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6778e+00
[rank1]:2025-10-29 03:27:20,052 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2497e+00
[rank1]:2025-10-29 03:27:39,261 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4470e-01
[rank0]:2025-10-29 03:27:39,271 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9051e-01
[rank2]:2025-10-29 03:27:39,264 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6660e-01
[rank3]:2025-10-29 03:27:39,267 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1035e+00
[rank3]:2025-10-29 03:27:58,414 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2016e+00
[rank2]:2025-10-29 03:27:58,408 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5523e+00
[rank1]:2025-10-29 03:27:58,408 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9955e+00
[rank0]:2025-10-29 03:27:58,415 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8889e+00
[rank1]:2025-10-29 03:28:17,595 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1338e+00
[rank0]:2025-10-29 03:28:17,605 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3905e+00
[rank3]:2025-10-29 03:28:17,601 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7615e+00
[rank2]:2025-10-29 03:28:17,598 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3473e+00
[rank0]:2025-10-29 03:28:34,757 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:28:36,650 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6005e+00
[rank3]:2025-10-29 03:28:36,653 - INFO -  step: 2150  loss:  0.1533  grad_norm:  0.1153  memory: 79.24GiB(56.67%)  tps: 8,549  tflops: 398.71  mfu: 40.31%
[rank0]:2025-10-29 03:28:36,651 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3165e+00
[rank0]:2025-10-29 03:28:36,651 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 73.46GiB(52.54%)  tps: 8,549  tflops: 398.72  mfu: 40.32%
[rank2]:2025-10-29 03:28:36,644 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5428e+00
[rank2]:2025-10-29 03:28:36,644 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 64.04GiB(45.81%)  tps: 8,549  tflops: 398.72  mfu: 40.32%
[rank1]:2025-10-29 03:28:36,644 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9916e+00
[rank1]:2025-10-29 03:28:36,644 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 72.05GiB(51.54%)  tps: 8,548  tflops: 398.70  mfu: 40.31%
[rank3]:2025-10-29 03:28:36,983 - INFO - Avg. fwd time: 15.7808 / Avg. bwd time: 29.4916 / Avg. batch time: 377.6521 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:28:37,062 - INFO - Avg. fwd time: 14.9040 / Avg. bwd time: 24.9946 / Avg. batch time: 501.1291 (ms) / GPU bubble ratio: 36.31%
[rank2]:2025-10-29 03:28:37,021 - INFO - Avg. fwd time: 14.5085 / Avg. bwd time: 22.8615 / Avg. batch time: 417.0023 (ms) / GPU bubble ratio: 28.31%
[rank1]:2025-10-29 03:28:37,043 - INFO - Avg. fwd time: 16.8040 / Avg. bwd time: 24.2339 / Avg. batch time: 459.6699 (ms) / GPU bubble ratio: 28.58%
[rank2]:2025-10-29 03:28:56,028 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5886e+00
[rank1]:2025-10-29 03:28:56,025 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0531e+00
[rank3]:2025-10-29 03:28:56,032 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9810e+00
[rank0]:2025-10-29 03:28:56,036 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4272e+00
[rank2]:2025-10-29 03:29:14,946 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1883e+00
[rank1]:2025-10-29 03:29:14,946 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1001e+00
[rank0]:2025-10-29 03:29:14,953 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3844e+00
[rank3]:2025-10-29 03:29:14,953 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2774e+00
[rank0]:2025-10-29 03:29:34,326 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0735e+00
[rank3]:2025-10-29 03:29:34,323 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4851e+00
[rank2]:2025-10-29 03:29:34,319 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0539e+00
[rank1]:2025-10-29 03:29:34,316 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8497e+00
[rank2]:2025-10-29 03:29:53,307 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1237e+00
[rank3]:2025-10-29 03:29:53,313 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2052e+00
[rank0]:2025-10-29 03:29:53,314 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6486e+00
[rank1]:2025-10-29 03:29:53,307 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8339e+00
[rank0]:2025-10-29 03:30:10,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:30:12,557 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.6363e-01
[rank2]:2025-10-29 03:30:12,557 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 64.04GiB(45.81%)  tps: 8,541  tflops: 398.36  mfu: 40.28%
[rank2]:2025-10-29 03:30:12,557 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 03:30:12,564 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9651e-01
[rank0]:2025-10-29 03:30:12,564 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.36  mfu: 40.28%
[rank0]:2025-10-29 03:30:12,564 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:30:12,560 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2387e+00
[rank3]:2025-10-29 03:30:12,563 - INFO -  step: 2200  loss:  0.1005  grad_norm:  0.1071  memory: 79.24GiB(56.67%)  tps: 8,541  tflops: 398.38  mfu: 40.28%
[rank3]:2025-10-29 03:30:12,563 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 03:30:12,553 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5859e+00
[rank1]:2025-10-29 03:30:12,554 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 72.05GiB(51.54%)  tps: 8,541  tflops: 398.37  mfu: 40.28%
[rank1]:2025-10-29 03:30:12,554 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 03:30:29,094 - INFO - validate step: 2200  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,780
[rank2]:2025-10-29 03:30:29,144 - INFO - validate step: 2200  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,694
[rank3]:2025-10-29 03:30:29,151 - INFO - validate step: 2200  loss:  0.2431  memory: 79.24GiB(56.67%)  tps: 24,694
[rank1]:2025-10-29 03:30:29,128 - INFO - validate step: 2200  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,714
[rank0]:2025-10-29 03:30:29,230 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0330_stage0_step2200.svg
[rank2]:2025-10-29 03:30:29,231 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0330_stage2_step2200.svg
[rank1]:2025-10-29 03:30:29,227 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0330_stage1_step2200.svg
[rank3]:2025-10-29 03:30:29,341 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0330_real_step2200_rank3.svg
[rank3]:> Batch Time: 471.66 ms, GPU Bubble Ratio: 35.47%, 32.32%, 39.58%, 25.97%
[rank3]:2025-10-29 03:30:29,405 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0330_stage3_step2200.svg
[rank3]:2025-10-29 03:30:29,691 - INFO - Avg. fwd time: 15.7813 / Avg. bwd time: 29.4344 / Avg. batch time: 377.1926 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:30:29,765 - INFO - Avg. fwd time: 14.9068 / Avg. bwd time: 24.9165 / Avg. batch time: 500.3739 (ms) / GPU bubble ratio: 36.33%
[rank2]:2025-10-29 03:30:29,726 - INFO - Avg. fwd time: 14.5123 / Avg. bwd time: 22.7866 / Avg. batch time: 416.4481 (ms) / GPU bubble ratio: 28.35%
[rank1]:2025-10-29 03:30:29,751 - INFO - Avg. fwd time: 16.8096 / Avg. bwd time: 24.1416 / Avg. batch time: 459.0011 (ms) / GPU bubble ratio: 28.63%
[rank0]:2025-10-29 03:30:48,512 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8833e+00
[rank2]:2025-10-29 03:30:48,505 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4815e+00
[rank3]:2025-10-29 03:30:48,511 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4028e+00
[rank1]:2025-10-29 03:30:48,504 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5613e+00
[rank0]:2025-10-29 03:31:07,674 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.6206e-01
[rank2]:2025-10-29 03:31:07,667 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.2026e-01
[rank1]:2025-10-29 03:31:07,664 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3126e+00
[rank3]:2025-10-29 03:31:07,670 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3656e+00
[rank0]:2025-10-29 03:31:26,693 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1426e+00
[rank2]:2025-10-29 03:31:26,686 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3931e+00
[rank1]:2025-10-29 03:31:26,686 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0564e+00
[rank3]:2025-10-29 03:31:26,693 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1283e+00
[rank0]:2025-10-29 03:31:46,071 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2476e-01
[rank1]:2025-10-29 03:31:46,061 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7499e-01
[rank2]:2025-10-29 03:31:46,064 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5465e-01
[rank3]:2025-10-29 03:31:46,067 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7801e+00
[rank0]:2025-10-29 03:32:03,099 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:32:05,009 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3680e-01
[rank0]:2025-10-29 03:32:05,009 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.35  mfu: 40.28%
[rank2]:2025-10-29 03:32:05,002 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3868e+00
[rank2]:2025-10-29 03:32:05,002 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 64.04GiB(45.81%)  tps: 8,546  tflops: 398.59  mfu: 40.30%
[rank1]:2025-10-29 03:32:05,002 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2846e+00
[rank1]:2025-10-29 03:32:05,002 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 72.05GiB(51.54%)  tps: 8,545  tflops: 398.52  mfu: 40.30%
[rank3]:2025-10-29 03:32:05,009 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4019e-01
[rank3]:2025-10-29 03:32:05,012 - INFO -  step: 2250  loss:  0.1254  grad_norm:  0.1046  memory: 79.24GiB(56.67%)  tps: 8,546  tflops: 398.58  mfu: 40.30%
[rank2]:2025-10-29 03:32:05,465 - INFO - Avg. fwd time: 14.5170 / Avg. bwd time: 22.7095 / Avg. batch time: 415.9310 (ms) / GPU bubble ratio: 28.40%
[rank3]:2025-10-29 03:32:05,431 - INFO - Avg. fwd time: 15.7819 / Avg. bwd time: 29.3800 / Avg. batch time: 376.7556 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:32:05,533 - INFO - Avg. fwd time: 14.9104 / Avg. bwd time: 24.8360 / Avg. batch time: 499.6609 (ms) / GPU bubble ratio: 36.36%
[rank1]:2025-10-29 03:32:05,498 - INFO - Avg. fwd time: 16.8147 / Avg. bwd time: 24.0533 / Avg. batch time: 458.3759 (ms) / GPU bubble ratio: 28.67%
[rank1]:2025-10-29 03:32:24,430 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5800e+00
[rank3]:2025-10-29 03:32:24,436 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2203e+00
[rank0]:2025-10-29 03:32:24,440 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2302e+00
[rank2]:2025-10-29 03:32:24,433 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3204e+00
[rank1]:2025-10-29 03:32:43,447 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.9967e-01
[rank2]:2025-10-29 03:32:43,447 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5761e-01
[rank0]:2025-10-29 03:32:43,454 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4430e+00
[rank3]:2025-10-29 03:32:43,454 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0633e+00
[rank2]:2025-10-29 03:33:02,677 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0213e-01
[rank0]:2025-10-29 03:33:02,685 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5358e-01
[rank3]:2025-10-29 03:33:02,681 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.4359e-01
[rank1]:2025-10-29 03:33:02,674 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.7353e-01
[rank0]:2025-10-29 03:33:21,860 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.2577e-01
[rank2]:2025-10-29 03:33:21,853 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1237e+00
[rank1]:2025-10-29 03:33:21,853 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0638e-01
[rank3]:2025-10-29 03:33:21,859 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5949e+00
[rank0]:2025-10-29 03:33:39,086 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:33:41,035 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4332e+00
[rank0]:2025-10-29 03:33:41,036 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 73.46GiB(52.54%)  tps: 8,531  tflops: 397.89  mfu: 40.23%
[rank1]:2025-10-29 03:33:41,025 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9204e+00
[rank1]:2025-10-29 03:33:41,025 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 72.05GiB(51.54%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank2]:2025-10-29 03:33:41,028 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1447e+00
[rank2]:2025-10-29 03:33:41,029 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 64.04GiB(45.81%)  tps: 8,531  tflops: 397.89  mfu: 40.23%
[rank3]:2025-10-29 03:33:41,032 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6788e+00
[rank3]:2025-10-29 03:33:41,034 - INFO -  step: 2300  loss:  0.0911  grad_norm:  0.0960  memory: 79.24GiB(56.67%)  tps: 8,531  tflops: 397.91  mfu: 40.23%
[rank0]:2025-10-29 03:33:41,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0333_stage0_step2300.svg
[rank1]:2025-10-29 03:33:41,115 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0333_stage1_step2300.svg
[rank2]:2025-10-29 03:33:41,115 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0333_stage2_step2300.svg
[rank3]:2025-10-29 03:33:41,219 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0333_real_step2300_rank3.svg
[rank3]:> Batch Time: 471.04 ms, GPU Bubble Ratio: 35.44%, 32.30%, 39.56%, 25.99%
[rank3]:2025-10-29 03:33:41,280 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0333_stage3_step2300.svg
[rank3]:2025-10-29 03:33:41,570 - INFO - Avg. fwd time: 15.7828 / Avg. bwd time: 29.3358 / Avg. batch time: 376.4049 (ms) / GPU bubble ratio: 4.11%
[rank0]:2025-10-29 03:33:41,643 - INFO - Avg. fwd time: 14.9130 / Avg. bwd time: 24.7763 / Avg. batch time: 499.0828 (ms) / GPU bubble ratio: 36.38%
[rank1]:2025-10-29 03:33:41,629 - INFO - Avg. fwd time: 16.8191 / Avg. bwd time: 23.9807 / Avg. batch time: 457.8635 (ms) / GPU bubble ratio: 28.71%
[rank2]:2025-10-29 03:33:41,605 - INFO - Avg. fwd time: 14.5205 / Avg. bwd time: 22.6527 / Avg. batch time: 415.5079 (ms) / GPU bubble ratio: 28.43%
[rank3]:2025-10-29 03:34:00,282 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1285e+00
[rank0]:2025-10-29 03:34:00,283 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.0386e+00
[rank2]:2025-10-29 03:34:00,276 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7913e+00
[rank1]:2025-10-29 03:34:00,276 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6351e+00
[rank3]:2025-10-29 03:34:19,668 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8436e+00
[rank1]:2025-10-29 03:34:19,662 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8137e-01
[rank0]:2025-10-29 03:34:19,672 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6422e-01
[rank2]:2025-10-29 03:34:19,665 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6789e-01
[rank3]:2025-10-29 03:34:38,588 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4383e+00
[rank2]:2025-10-29 03:34:38,581 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3625e-01
[rank1]:2025-10-29 03:34:38,581 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8512e-01
[rank0]:2025-10-29 03:34:38,588 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.2849e-01
[rank1]:2025-10-29 03:34:57,922 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8115e-01
[rank3]:2025-10-29 03:34:57,928 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.7002e-01
[rank2]:2025-10-29 03:34:57,925 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5849e-01
[rank0]:2025-10-29 03:34:57,932 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2549e-01
[rank0]:2025-10-29 03:35:15,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:35:16,954 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7164e+00
[rank3]:2025-10-29 03:35:16,957 - INFO -  step: 2350  loss:  0.1136  grad_norm:  0.1114  memory: 79.24GiB(56.67%)  tps: 8,540  tflops: 398.32  mfu: 40.28%
[rank2]:2025-10-29 03:35:16,948 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8556e+00
[rank2]:2025-10-29 03:35:16,948 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 64.04GiB(45.81%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank1]:2025-10-29 03:35:16,948 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6520e+00
[rank1]:2025-10-29 03:35:16,948 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 72.05GiB(51.54%)  tps: 8,540  tflops: 398.32  mfu: 40.27%
[rank0]:2025-10-29 03:35:16,955 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8754e+00
[rank0]:2025-10-29 03:35:16,955 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank3]:2025-10-29 03:35:17,294 - INFO - Avg. fwd time: 15.7837 / Avg. bwd time: 29.2863 / Avg. batch time: 376.0110 (ms) / GPU bubble ratio: 4.11%
[rank2]:2025-10-29 03:35:17,334 - INFO - Avg. fwd time: 14.5247 / Avg. bwd time: 22.5844 / Avg. batch time: 415.0413 (ms) / GPU bubble ratio: 28.47%
[rank1]:2025-10-29 03:35:17,357 - INFO - Avg. fwd time: 16.8242 / Avg. bwd time: 23.8999 / Avg. batch time: 457.2971 (ms) / GPU bubble ratio: 28.76%
[rank0]:2025-10-29 03:35:17,375 - INFO - Avg. fwd time: 14.9166 / Avg. bwd time: 24.7050 / Avg. batch time: 498.4380 (ms) / GPU bubble ratio: 36.41%
[rank2]:2025-10-29 03:35:36,183 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2533e+00
[rank1]:2025-10-29 03:35:36,180 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8036e+00
[rank3]:2025-10-29 03:35:36,187 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0690e+00
[rank0]:2025-10-29 03:35:36,190 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0012e+00
[rank2]:2025-10-29 03:35:55,356 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8057e+00
[rank1]:2025-10-29 03:35:55,356 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7597e+00
[rank3]:2025-10-29 03:35:55,363 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6311e+00
[rank0]:2025-10-29 03:35:55,363 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1851e+00
[rank2]:2025-10-29 03:36:14,541 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2298e-01
[rank3]:2025-10-29 03:36:14,544 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8232e+00
[rank1]:2025-10-29 03:36:14,538 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3833e+00
[rank0]:2025-10-29 03:36:14,548 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8836e-01
[rank0]:2025-10-29 03:36:33,578 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.2595e-01
[rank2]:2025-10-29 03:36:33,571 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3569e+00
[rank1]:2025-10-29 03:36:33,571 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.5479e-01
[rank3]:2025-10-29 03:36:33,577 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3223e-01
[rank0]:2025-10-29 03:36:50,980 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:36:52,945 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6070e-01
[rank1]:2025-10-29 03:36:52,945 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 72.05GiB(51.54%)  tps: 8,534  tflops: 398.01  mfu: 40.24%
[rank1]:2025-10-29 03:36:52,945 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,102  tflops: 377.87  mfu: 37.14%
[rank1]:2025-10-29 03:36:52,945 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 03:36:52,948 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9517e+00
[rank2]:2025-10-29 03:36:52,948 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 64.04GiB(45.81%)  tps: 8,533  tflops: 398.00  mfu: 40.24%
[rank2]:2025-10-29 03:36:52,949 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,101  tflops: 377.85  mfu: 37.14%
[rank2]:2025-10-29 03:36:52,949 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:36:52,951 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3785e+00
[rank0]:2025-10-29 03:36:52,955 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7168e-01
[rank0]:2025-10-29 03:36:52,955 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 73.46GiB(52.54%)  tps: 8,533  tflops: 398.00  mfu: 40.24%
[rank0]:2025-10-29 03:36:52,956 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,100  tflops: 377.81  mfu: 37.14%
[rank0]:2025-10-29 03:36:52,956 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:36:52,954 - INFO -  step: 2400  loss:  0.1014  grad_norm:  0.1272  memory: 79.24GiB(56.67%)  tps: 8,534  tflops: 398.01  mfu: 40.24%
[rank3]:2025-10-29 03:36:52,955 - INFO -  final step: 2400  loss:  0.1014  grad_norm:  0.1272  tps: 8,105  tflops: 378.01  mfu: 37.15%
[rank3]:2025-10-29 03:36:52,955 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 03:37:09,449 - INFO - validate step: 2400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,835
[rank0]:2025-10-29 03:37:09,450 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:37:09,453 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 03:37:09,500 - INFO - validate step: 2400  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,748
[rank2]:2025-10-29 03:37:09,501 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:37:09,503 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 03:37:09,484 - INFO - validate step: 2400  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,767
[rank1]:2025-10-29 03:37:09,485 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:37:09,488 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 03:37:09,509 - INFO - validate step: 2400  loss:  0.2434  memory: 79.24GiB(56.67%)  tps: 24,744
[rank3]:2025-10-29 03:37:09,510 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 03:37:09,516 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 03:37:20,692 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 03:37:20,840 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0337_stage0_final2400.svg
[rank2]:2025-10-29 03:37:20,800 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0337_stage2_final2400.svg
[rank1]:2025-10-29 03:37:20,797 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0337_stage1_final2400.svg
[rank3]:2025-10-29 03:37:20,882 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0337_real_final2400_rank3.svg
[rank3]:> Batch Time: 470.50 ms, GPU Bubble Ratio: 35.39%, 32.30%, 39.53%, 26.00%
[rank3]:2025-10-29 03:37:21,051 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0337_thry_final2400_rank3.svg
[rank3]:> Batch Time: 512.22 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 03:37:21,090 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank2_stage2.svg
[rank2]:	> Counts Sum: 11763, Total Sum: 16920 (69.52%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 03:37:21,090 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 03:37:21,113 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank1_stage1.svg
[rank1]:	> Counts Sum: 14508, Total Sum: 19035 (76.22%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 03:37:21,114 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 03:37:21,114 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0337_stage3_final2400.svg
[rank0]:2025-10-29 03:37:21,296 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank0_stage0.svg
[rank0]:	> Counts Sum: 11592, Total Sum: 17155 (67.57%), Ratio(%) per element: [0.0, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 03:37:21,296 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 03:37:21,335 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank3_stage3.svg
[rank3]:	> Counts Sum: 11385, Total Sum: 15275 (74.53%), Ratio(%) per element: [98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 03:37:21,336 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.02153
[rank3]:wandb:               final/avg_loss 0.10141
[rank3]:wandb:             final/avg_mfu(%) 37.15263
[rank3]:wandb:             final/avg_tflops 378.00629
[rank3]:wandb:    final/avg_throughput(tps) 8104.73811
[rank3]:wandb:              final/grad_norm 0.1272
[rank3]:wandb:               final/max_loss 0.10141
[rank3]:wandb:                    grad_norm 0.1272
[rank3]:wandb: loss_metrics/global_avg_loss 0.10141
[rank3]:wandb: loss_metrics/global_max_loss 0.10141
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/zn6bleq8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_auto_dm1/20251029-0211/wandb/run-20251029_021116-zn6bleq8/logs
[rank0]:2025-10-29 03:37:23,296 - INFO - Training completed
[rank0]:2025-10-29 03:37:23,296 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 03:37:23,760 - INFO - Process group destroyed
[rank2]:2025-10-29 03:37:23,770 - INFO - Process group destroyed
[rank1]:2025-10-29 03:37:23,701 - INFO - Process group destroyed
[rank3]:2025-10-29 03:37:23,694 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.1', 'layers.6', 'layers.0', 'layers.7', 'layers.5', 'layers.3', 'tok_embeddings', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.21', 'layers.24', 'layers.23', 'layers.22', 'layers.17', 'layers.20', 'layers.18'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.8', 'layers.12', 'layers.10', 'layers.9', 'layers.16', 'layers.14', 'layers.11', 'layers.15'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.27', 'layers.26', 'layers.28', 'output', 'layers.31', 'layers.30', 'norm', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 03:52:52 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] 
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] *****************************************
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 03:53:00,104 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 03:53:00,032 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 03:53:00,049 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 03:53:00,105 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 03:53:01,085 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 03:53:01,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:53:01,093 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-29 03:53:01,079 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 03:53:01,083 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 03:53:01,079 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 03:53:01,082 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 03:53:01,085 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 03:53:01,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:53:03,005 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 03:53:03,288 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 03:53:04,897 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 03:53:06,248 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 03:53:06,506 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 03:53:06,435 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 03:53:06,507 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 03:53:06,507 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 03:53:06,555 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 03:53:06,578 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 03:53:06,578 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:53:06,704 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 03:53:06,705 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 03:53:06,789 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 03:53:06,789 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 03:53:06,911 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 03:53:06,985 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 03:53:06,985 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 03:53:07,193 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 03:53:07,194 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run fr7hk14p
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1/20251029-0353/wandb/run-20251029_035307-fr7hk14p
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/fr7hk14p
[rank3]:2025-10-29 03:53:08,567 - INFO - WandB logging enabled
[rank3]:2025-10-29 03:53:08,576 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 03:53:08,650 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 03:53:08,650 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 03:53:08,865 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank0]:2025-10-29 03:53:08,866 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:53:08,870 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 03:53:08,865 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 03:53:08,884 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:53:08,853 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 03:53:08,854 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 03:53:08,865 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:53:12,282 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:12,535 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 03:53:12,536 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:12,536 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400.
[rank1]:2025-10-29 03:53:12,529 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank2]:2025-10-29 03:53:13,235 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:22,280 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 03:53:22,280 - INFO - Finished loading the checkpoint in 9.74 seconds.
[rank0]:2025-10-29 03:53:22,280 - INFO - Training starts at step 1
[rank3]:2025-10-29 03:53:27,025 - INFO -  step:  1  loss:  0.8389  grad_norm:  0.5414  memory: 58.03GiB(41.50%)  tps: 891  tflops: 41.54  mfu: 4.20%
[rank3]:2025-10-29 03:53:27,025 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:53:27,020 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 44.28GiB(31.67%)  tps: 817  tflops: 38.10  mfu: 3.85%
[rank1]:2025-10-29 03:53:27,022 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 49.69GiB(35.54%)  tps: 798  tflops: 37.20  mfu: 3.76%
[rank2]:2025-10-29 03:53:27,020 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 03:53:27,022 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 03:53:27,041 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 49.75GiB(35.58%)  tps: 800  tflops: 37.30  mfu: 3.77%
[rank0]:2025-10-29 03:53:27,041 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 03:53:45,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,584 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,622 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,712 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,712 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:55:37,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:55:39,917 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 57.29GiB(40.97%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank1]:2025-10-29 03:55:39,919 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 64.32GiB(46.00%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank0]:2025-10-29 03:55:39,924 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank3]:2025-10-29 03:55:39,921 - INFO -  step: 50  loss:  0.8444  grad_norm:  0.4851  memory: 73.38GiB(52.48%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank2]:2025-10-29 03:55:40,435 - INFO - Avg. fwd time: 13.3386 / Avg. bwd time: 36.4492 / Avg. batch time: 537.3465 (ms) / GPU bubble ratio: 25.88%
[rank3]:2025-10-29 03:55:40,384 - INFO - Avg. fwd time: 14.7677 / Avg. bwd time: 42.9778 / Avg. batch time: 483.1551 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 03:55:40,482 - INFO - Avg. fwd time: 15.5422 / Avg. bwd time: 41.8686 / Avg. batch time: 598.4632 (ms) / GPU bubble ratio: 23.26%
[rank0]:2025-10-29 03:55:40,515 - INFO - Avg. fwd time: 14.5086 / Avg. bwd time: 38.7315 / Avg. batch time: 654.6791 (ms) / GPU bubble ratio: 34.94%
[rank2]:2025-10-29 03:56:07,026 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 03:56:07,029 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-29 03:56:07,033 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 03:56:07,029 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-29 03:56:34,157 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 4.5909e-01
[rank0]:2025-10-29 03:56:34,165 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.1391e-01
[rank1]:2025-10-29 03:56:34,161 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 3.7071e-01
[rank3]:2025-10-29 03:56:34,161 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0869e-01
[rank3]:2025-10-29 03:56:59,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1148e+00
[rank0]:2025-10-29 03:56:59,719 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5000e+00
[rank1]:2025-10-29 03:56:59,705 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8002e-01
[rank2]:2025-10-29 03:56:59,709 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0329e+00
[rank2]:2025-10-29 03:57:26,852 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 9.0351e-01
[rank0]:2025-10-29 03:57:26,860 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3975e+00
[rank1]:2025-10-29 03:57:26,856 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2388e-01
[rank3]:2025-10-29 03:57:26,856 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 8.4170e-01
[rank0]:2025-10-29 03:57:49,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:57:52,310 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6001e-01
[rank2]:2025-10-29 03:57:52,310 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 58.24GiB(41.66%)  tps: 6,188  tflops: 288.59  mfu: 29.18%
[rank1]:2025-10-29 03:57:52,304 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8914e-01
[rank1]:2025-10-29 03:57:52,304 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 68.17GiB(48.76%)  tps: 6,188  tflops: 288.61  mfu: 29.18%
[rank0]:2025-10-29 03:57:52,320 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.1123e+00
[rank0]:2025-10-29 03:57:52,321 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 66.72GiB(47.72%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank3]:2025-10-29 03:57:52,310 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8846e-01
[rank3]:2025-10-29 03:57:52,313 - INFO -  step: 100  loss:  0.7816  grad_norm:  0.4913  memory: 75.33GiB(53.88%)  tps: 6,188  tflops: 288.60  mfu: 29.18%
[rank2]:2025-10-29 03:57:52,403 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0357_stage2_step100.svg
[rank1]:2025-10-29 03:57:52,395 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0357_stage1_step100.svg
[rank0]:2025-10-29 03:57:52,398 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0357_stage0_step100.svg
[rank3]:2025-10-29 03:57:52,509 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0357_real_step100_rank3.svg
[rank3]:> Batch Time: 634.97 ms, GPU Bubble Ratio: 32.79%, 27.09%, 36.82%, 26.76%
[rank3]:2025-10-29 03:57:52,569 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0357_stage3_step100.svg
[rank2]:2025-10-29 03:57:53,030 - INFO - Avg. fwd time: 13.4324 / Avg. bwd time: 36.1159 / Avg. batch time: 527.8758 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 03:57:52,980 - INFO - Avg. fwd time: 14.9183 / Avg. bwd time: 42.1734 / Avg. batch time: 474.7746 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-29 03:57:53,077 - INFO - Avg. fwd time: 15.7945 / Avg. bwd time: 40.3626 / Avg. batch time: 587.3475 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-10-29 03:57:53,106 - INFO - Avg. fwd time: 14.3602 / Avg. bwd time: 38.9230 / Avg. batch time: 645.3505 (ms) / GPU bubble ratio: 33.95%
[rank2]:2025-10-29 03:58:19,397 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 7.4751e-01
[rank0]:2025-10-29 03:58:19,401 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8390e+00
[rank1]:2025-10-29 03:58:19,400 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.1862e-01
[rank3]:2025-10-29 03:58:19,400 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 8.3708e-01
[rank0]:2025-10-29 03:58:44,739 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.4641e+00
[rank1]:2025-10-29 03:58:44,722 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0088e+00
[rank2]:2025-10-29 03:58:44,725 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7798e+00
[rank3]:2025-10-29 03:58:44,729 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2099e+00
[rank1]:2025-10-29 03:59:11,597 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0500e+00
[rank0]:2025-10-29 03:59:11,598 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0955e+00
[rank2]:2025-10-29 03:59:11,594 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 2.4376e+00
[rank3]:2025-10-29 03:59:11,597 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2702e+00
[rank0]:2025-10-29 03:59:36,898 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.7639e+00
[rank1]:2025-10-29 03:59:36,881 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1916e+00
[rank2]:2025-10-29 03:59:36,884 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4818e+00
[rank3]:2025-10-29 03:59:36,887 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2920e+00
[rank0]:2025-10-29 04:00:01,109 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:00:03,831 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 1.0868e+00
[rank2]:2025-10-29 04:00:03,831 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 59.22GiB(42.36%)  tps: 6,229  tflops: 290.51  mfu: 29.37%
[rank1]:2025-10-29 04:00:03,834 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2147e+00
[rank1]:2025-10-29 04:00:03,835 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 68.17GiB(48.76%)  tps: 6,228  tflops: 290.48  mfu: 29.37%
[rank0]:2025-10-29 04:00:03,835 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2870e+00
[rank0]:2025-10-29 04:00:03,836 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 67.62GiB(48.36%)  tps: 6,229  tflops: 290.52  mfu: 29.38%
[rank3]:2025-10-29 04:00:03,834 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.1168e+00
[rank3]:2025-10-29 04:00:03,837 - INFO -  step: 150  loss:  0.7936  grad_norm:  0.5206  memory: 75.33GiB(53.88%)  tps: 6,229  tflops: 290.50  mfu: 29.37%
[rank3]:2025-10-29 04:00:04,348 - INFO - Avg. fwd time: 14.9773 / Avg. bwd time: 41.7674 / Avg. batch time: 471.0577 (ms) / GPU bubble ratio: 3.63%
[rank1]:2025-10-29 04:00:04,420 - INFO - Avg. fwd time: 15.9279 / Avg. bwd time: 39.3780 / Avg. batch time: 581.9873 (ms) / GPU bubble ratio: 23.98%
[rank2]:2025-10-29 04:00:04,384 - INFO - Avg. fwd time: 13.5025 / Avg. bwd time: 35.5734 / Avg. batch time: 523.5826 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 04:00:04,464 - INFO - Avg. fwd time: 14.3511 / Avg. bwd time: 38.4171 / Avg. batch time: 640.1222 (ms) / GPU bubble ratio: 34.05%
[rank3]:2025-10-29 04:00:29,094 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6416e-01
[rank2]:2025-10-29 04:00:29,090 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0047e-01
[rank1]:2025-10-29 04:00:29,087 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9694e-01
[rank0]:2025-10-29 04:00:29,104 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 9.0189e-01
[rank3]:2025-10-29 04:00:56,094 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.0315e+00
[rank1]:2025-10-29 04:00:56,093 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3387e+00
[rank2]:2025-10-29 04:00:56,090 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.1148e+00
[rank0]:2025-10-29 04:00:56,094 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8875e+00
[rank1]:2025-10-29 04:01:21,291 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9140e+00
[rank2]:2025-10-29 04:01:21,291 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2594e+00
[rank3]:2025-10-29 04:01:21,297 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6959e+00
[rank0]:2025-10-29 04:01:21,307 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.8465e+00
[rank1]:2025-10-29 04:01:48,213 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2143e+00
[rank2]:2025-10-29 04:01:48,210 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 5.7059e-01
[rank0]:2025-10-29 04:01:48,214 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8273e+00
[rank3]:2025-10-29 04:01:48,213 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.5650e-01
[rank0]:2025-10-29 04:02:10,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:02:13,459 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5123e+00
[rank3]:2025-10-29 04:02:13,461 - INFO -  step: 200  loss:  0.9271  grad_norm:  0.7524  memory: 75.33GiB(53.88%)  tps: 6,320  tflops: 294.76  mfu: 29.80%
[rank3]:2025-10-29 04:02:13,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:02:13,452 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2426e+00
[rank1]:2025-10-29 04:02:13,452 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 68.17GiB(48.76%)  tps: 6,320  tflops: 294.77  mfu: 29.81%
[rank1]:2025-10-29 04:02:13,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 04:02:13,452 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4079e+00
[rank2]:2025-10-29 04:02:13,452 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 60.18GiB(43.04%)  tps: 6,320  tflops: 294.76  mfu: 29.80%
[rank2]:2025-10-29 04:02:13,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 04:02:13,469 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.4914e+00
[rank0]:2025-10-29 04:02:13,469 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 67.62GiB(48.36%)  tps: 6,319  tflops: 294.74  mfu: 29.80%
[rank0]:2025-10-29 04:02:13,469 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:02:30,001 - INFO - validate step: 200  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 24,752
[rank2]:2025-10-29 04:02:30,017 - INFO - validate step: 200  loss: -1.0000  memory: 60.18GiB(43.04%)  tps: 24,728
[rank0]:2025-10-29 04:02:29,971 - INFO - validate step: 200  loss: -1.0000  memory: 67.62GiB(48.36%)  tps: 24,822
[rank3]:2025-10-29 04:02:30,027 - INFO - validate step: 200  loss:  0.2541  memory: 75.33GiB(53.88%)  tps: 24,727
[rank1]:2025-10-29 04:02:30,098 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0402_stage1_step200.svg
[rank2]:2025-10-29 04:02:30,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0402_stage2_step200.svg
[rank0]:2025-10-29 04:02:30,102 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0402_stage0_step200.svg
[rank3]:2025-10-29 04:02:30,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0402_real_step200_rank3.svg
[rank3]:> Batch Time: 634.36 ms, GPU Bubble Ratio: 32.74%, 27.80%, 37.05%, 26.81%
[rank3]:2025-10-29 04:02:30,270 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0402_stage3_step200.svg
[rank3]:2025-10-29 04:02:30,680 - INFO - Avg. fwd time: 15.0218 / Avg. bwd time: 41.4476 / Avg. batch time: 468.4528 (ms) / GPU bubble ratio: 3.56%
[rank2]:2025-10-29 04:02:30,730 - INFO - Avg. fwd time: 13.5711 / Avg. bwd time: 34.9569 / Avg. batch time: 520.2071 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 04:02:30,777 - INFO - Avg. fwd time: 16.0210 / Avg. bwd time: 38.6434 / Avg. batch time: 577.8059 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 04:02:30,795 - INFO - Avg. fwd time: 14.3441 / Avg. bwd time: 38.2889 / Avg. batch time: 636.3601 (ms) / GPU bubble ratio: 33.83%
[rank2]:2025-10-29 04:02:56,973 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1262e+00
[rank0]:2025-10-29 04:02:56,973 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1351e+00
[rank1]:2025-10-29 04:02:56,976 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6643e+00
[rank3]:2025-10-29 04:02:56,976 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.2531e+00
[rank0]:2025-10-29 04:03:22,091 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 9.0214e-01
[rank1]:2025-10-29 04:03:22,074 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3767e+00
[rank2]:2025-10-29 04:03:22,070 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4516e+00
[rank3]:2025-10-29 04:03:22,080 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.8588e-01
[rank3]:2025-10-29 04:03:48,926 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.5928e-01
[rank0]:2025-10-29 04:03:48,924 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4169e+00
[rank1]:2025-10-29 04:03:48,926 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1604e+00
[rank2]:2025-10-29 04:03:48,923 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5270e-01
[rank0]:2025-10-29 04:04:14,014 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 7.6286e-01
[rank2]:2025-10-29 04:04:13,994 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5446e-01
[rank1]:2025-10-29 04:04:13,997 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0557e+00
[rank3]:2025-10-29 04:04:14,004 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1236e-01
[rank0]:2025-10-29 04:04:38,201 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:04:40,897 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0605e-01
[rank3]:2025-10-29 04:04:40,899 - INFO -  step: 250  loss:  0.9058  grad_norm:  0.7571  memory: 75.33GiB(53.88%)  tps: 6,260  tflops: 291.95  mfu: 29.52%
[rank2]:2025-10-29 04:04:40,893 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8685e-02
[rank2]:2025-10-29 04:04:40,894 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 61.15GiB(43.74%)  tps: 6,259  tflops: 291.94  mfu: 29.52%
[rank0]:2025-10-29 04:04:40,894 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7988e+00
[rank0]:2025-10-29 04:04:40,895 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 68.59GiB(49.06%)  tps: 6,257  tflops: 291.83  mfu: 29.51%
[rank1]:2025-10-29 04:04:40,897 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6485e-01
[rank1]:2025-10-29 04:04:40,897 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 68.17GiB(48.76%)  tps: 6,258  tflops: 291.89  mfu: 29.51%
[rank2]:2025-10-29 04:04:41,343 - INFO - Avg. fwd time: 13.6491 / Avg. bwd time: 34.3271 / Avg. batch time: 518.4270 (ms) / GPU bubble ratio: 25.97%
[rank3]:2025-10-29 04:04:41,314 - INFO - Avg. fwd time: 15.0428 / Avg. bwd time: 41.3180 / Avg. batch time: 467.2999 (ms) / GPU bubble ratio: 3.51%
[rank0]:2025-10-29 04:04:41,434 - INFO - Avg. fwd time: 14.3704 / Avg. bwd time: 37.8448 / Avg. batch time: 633.9937 (ms) / GPU bubble ratio: 34.11%
[rank1]:2025-10-29 04:04:41,391 - INFO - Avg. fwd time: 16.0677 / Avg. bwd time: 38.3159 / Avg. batch time: 575.6731 (ms) / GPU bubble ratio: 24.42%
[rank3]:2025-10-29 04:05:06,013 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.9659e-01
[rank0]:2025-10-29 04:05:06,023 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.2697e+00
[rank1]:2025-10-29 04:05:06,007 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9521e-01
[rank2]:2025-10-29 04:05:06,003 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.3110e-01
[rank3]:2025-10-29 04:05:32,812 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.8501e-01
[rank2]:2025-10-29 04:05:32,809 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.1904e-02
[rank1]:2025-10-29 04:05:32,812 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9195e-01
[rank0]:2025-10-29 04:05:32,809 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3183e+00
[rank2]:2025-10-29 04:05:57,980 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5442e-01
[rank1]:2025-10-29 04:05:57,983 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5668e-01
[rank0]:2025-10-29 04:05:58,000 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.6125e-01
[rank3]:2025-10-29 04:05:57,990 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4896e-01
[rank3]:2025-10-29 04:06:24,766 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.6910e-01
[rank1]:2025-10-29 04:06:24,766 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1872e-01
[rank2]:2025-10-29 04:06:24,763 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4451e-01
[rank0]:2025-10-29 04:06:24,764 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0652e-01
[rank0]:2025-10-29 04:06:47,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:06:49,922 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0927e-01
[rank3]:2025-10-29 04:06:49,924 - INFO -  step: 300  loss:  0.8042  grad_norm:  0.5004  memory: 75.33GiB(53.88%)  tps: 6,349  tflops: 296.13  mfu: 29.94%
[rank1]:2025-10-29 04:06:49,915 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2382e-01
[rank1]:2025-10-29 04:06:49,915 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 68.17GiB(48.76%)  tps: 6,349  tflops: 296.14  mfu: 29.94%
[rank2]:2025-10-29 04:06:49,912 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7500e-01
[rank2]:2025-10-29 04:06:49,912 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 61.15GiB(43.74%)  tps: 6,349  tflops: 296.14  mfu: 29.94%
[rank0]:2025-10-29 04:06:49,932 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 8.9872e-01
[rank0]:2025-10-29 04:06:49,932 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 68.59GiB(49.06%)  tps: 6,349  tflops: 296.10  mfu: 29.94%
[rank1]:2025-10-29 04:06:50,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0406_stage1_step300.svg
[rank2]:2025-10-29 04:06:50,003 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0406_stage2_step300.svg
[rank0]:2025-10-29 04:06:50,002 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0406_stage0_step300.svg
[rank3]:2025-10-29 04:06:50,104 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0406_real_step300_rank3.svg
[rank3]:> Batch Time: 630.73 ms, GPU Bubble Ratio: 32.69%, 27.38%, 36.82%, 27.01%
[rank3]:2025-10-29 04:06:50,164 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0406_stage3_step300.svg
[rank3]:2025-10-29 04:06:50,659 - INFO - Avg. fwd time: 15.0651 / Avg. bwd time: 41.1400 / Avg. batch time: 465.8698 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-29 04:06:50,748 - INFO - Avg. fwd time: 16.1131 / Avg. bwd time: 37.9108 / Avg. batch time: 573.1673 (ms) / GPU bubble ratio: 24.60%
[rank2]:2025-10-29 04:06:50,701 - INFO - Avg. fwd time: 13.7193 / Avg. bwd time: 33.6939 / Avg. batch time: 516.3596 (ms) / GPU bubble ratio: 26.54%
[rank0]:2025-10-29 04:06:50,786 - INFO - Avg. fwd time: 14.3817 / Avg. bwd time: 37.6627 / Avg. batch time: 631.6326 (ms) / GPU bubble ratio: 34.08%
[rank3]:2025-10-29 04:07:16,987 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.3670e-01
[rank1]:2025-10-29 04:07:16,987 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4266e-01
[rank2]:2025-10-29 04:07:16,984 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3737e-01
[rank0]:2025-10-29 04:07:16,985 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5870e+00
[rank3]:2025-10-29 04:07:42,141 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6515e-01
[rank1]:2025-10-29 04:07:42,134 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5193e+00
[rank2]:2025-10-29 04:07:42,131 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4464e-01
[rank0]:2025-10-29 04:07:42,151 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.1021e+00
[rank1]:2025-10-29 04:08:08,998 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.0811e-01
[rank2]:2025-10-29 04:08:08,995 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2926e-01
[rank0]:2025-10-29 04:08:08,996 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3590e+00
[rank3]:2025-10-29 04:08:08,998 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.0930e-01
[rank3]:2025-10-29 04:08:34,172 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.2716e-01
[rank1]:2025-10-29 04:08:34,165 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2414e-01
[rank2]:2025-10-29 04:08:34,162 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4021e-01
[rank0]:2025-10-29 04:08:34,182 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 5.0071e-01
[rank0]:2025-10-29 04:08:58,254 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:09:00,952 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9271e-01
[rank1]:2025-10-29 04:09:00,953 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 68.17GiB(48.76%)  tps: 6,252  tflops: 291.58  mfu: 29.48%
[rank2]:2025-10-29 04:09:00,949 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6920e-01
[rank2]:2025-10-29 04:09:00,950 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 61.15GiB(43.74%)  tps: 6,252  tflops: 291.58  mfu: 29.48%
[rank0]:2025-10-29 04:09:00,950 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2374e+00
[rank0]:2025-10-29 04:09:00,951 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 68.59GiB(49.06%)  tps: 6,253  tflops: 291.62  mfu: 29.49%
[rank3]:2025-10-29 04:09:00,952 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 7.8052e-01
[rank3]:2025-10-29 04:09:00,955 - INFO -  step: 350  loss:  0.8462  grad_norm:  0.3836  memory: 75.33GiB(53.88%)  tps: 6,252  tflops: 291.60  mfu: 29.48%
[rank3]:2025-10-29 04:09:01,380 - INFO - Avg. fwd time: 15.0730 / Avg. bwd time: 41.1203 / Avg. batch time: 465.6643 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-10-29 04:09:01,457 - INFO - Avg. fwd time: 16.1268 / Avg. bwd time: 37.8468 / Avg. batch time: 572.6070 (ms) / GPU bubble ratio: 24.59%
[rank2]:2025-10-29 04:09:01,410 - INFO - Avg. fwd time: 13.7490 / Avg. bwd time: 33.4780 / Avg. batch time: 515.8678 (ms) / GPU bubble ratio: 26.76%
[rank0]:2025-10-29 04:09:01,502 - INFO - Avg. fwd time: 14.4033 / Avg. bwd time: 37.4655 / Avg. batch time: 630.9759 (ms) / GPU bubble ratio: 34.24%
[rank3]:2025-10-29 04:09:26,162 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3300e+00
[rank1]:2025-10-29 04:09:26,155 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.1128e+00
[rank2]:2025-10-29 04:09:26,152 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6970e+00
[rank0]:2025-10-29 04:09:26,172 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.7348e+00
[rank2]:2025-10-29 04:09:52,802 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5646e+00
[rank0]:2025-10-29 04:09:52,800 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.2629e+01
[rank3]:2025-10-29 04:09:52,806 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.1702e+01
[rank1]:2025-10-29 04:09:52,806 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0418e+01
[rank1]:2025-10-29 04:10:17,108 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1210e-01
[rank2]:2025-10-29 04:10:17,105 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0114e-01
[rank0]:2025-10-29 04:10:17,115 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.8239e-01
[rank3]:2025-10-29 04:10:17,115 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1599e+00
[rank3]:2025-10-29 04:10:43,606 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.9430e+00
[rank1]:2025-10-29 04:10:43,606 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.5378e+00
[rank2]:2025-10-29 04:10:43,602 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6368e+00
[rank0]:2025-10-29 04:10:43,600 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.1738e+00
[rank0]:2025-10-29 04:11:04,521 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:11:06,892 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6799e+00
[rank3]:2025-10-29 04:11:06,894 - INFO -  step: 400  loss:  0.1002  grad_norm:  0.2822  memory: 75.33GiB(53.88%)  tps: 6,505  tflops: 303.38  mfu: 30.68%
[rank3]:2025-10-29 04:11:06,895 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 04:11:06,885 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5855e+00
[rank1]:2025-10-29 04:11:06,886 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 68.17GiB(48.76%)  tps: 6,505  tflops: 303.40  mfu: 30.68%
[rank1]:2025-10-29 04:11:06,886 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 04:11:06,893 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2820e+00
[rank0]:2025-10-29 04:11:06,893 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 69.57GiB(49.76%)  tps: 6,505  tflops: 303.37  mfu: 30.67%
[rank0]:2025-10-29 04:11:06,893 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 04:11:06,882 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5028e+00
[rank2]:2025-10-29 04:11:06,883 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 61.15GiB(43.74%)  tps: 6,505  tflops: 303.40  mfu: 30.68%
[rank2]:2025-10-29 04:11:06,883 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 04:11:22,046 - INFO - validate step: 400  loss:  0.2484  memory: 75.33GiB(53.88%)  tps: 27,036
[rank1]:2025-10-29 04:11:22,018 - INFO - validate step: 400  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,069
[rank0]:2025-10-29 04:11:21,988 - INFO - validate step: 400  loss: -1.0000  memory: 69.57GiB(49.76%)  tps: 27,136
[rank2]:2025-10-29 04:11:22,031 - INFO - validate step: 400  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,040
[rank1]:2025-10-29 04:11:22,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0411_stage1_step400.svg
[rank0]:2025-10-29 04:11:22,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0411_stage0_step400.svg
[rank2]:2025-10-29 04:11:22,122 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0411_stage2_step400.svg
[rank3]:2025-10-29 04:11:22,225 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0411_real_step400_rank3.svg
[rank3]:> Batch Time: 630.52 ms, GPU Bubble Ratio: 32.75%, 27.36%, 37.16%, 27.03%
[rank3]:2025-10-29 04:11:22,294 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0411_stage3_step400.svg
[rank3]:2025-10-29 04:11:22,684 - INFO - Avg. fwd time: 15.0657 / Avg. bwd time: 41.0204 / Avg. batch time: 464.7031 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:11:22,734 - INFO - Avg. fwd time: 13.7668 / Avg. bwd time: 33.1617 / Avg. batch time: 514.5129 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 04:11:22,780 - INFO - Avg. fwd time: 16.1331 / Avg. bwd time: 37.6540 / Avg. batch time: 571.0304 (ms) / GPU bubble ratio: 24.65%
[rank0]:2025-10-29 04:11:22,782 - INFO - Avg. fwd time: 14.4425 / Avg. bwd time: 36.8436 / Avg. batch time: 628.4841 (ms) / GPU bubble ratio: 34.72%
[rank3]:2025-10-29 04:11:47,544 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.9499e+00
[rank1]:2025-10-29 04:11:47,543 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4355e+00
[rank2]:2025-10-29 04:11:47,540 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9185e+00
[rank0]:2025-10-29 04:11:47,534 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0753e+00
[rank3]:2025-10-29 04:12:10,829 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3249e+00
[rank0]:2025-10-29 04:12:10,830 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1218e-01
[rank1]:2025-10-29 04:12:10,823 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5980e-01
[rank2]:2025-10-29 04:12:10,819 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6751e-01
[rank3]:2025-10-29 04:12:36,246 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2799e+00
[rank2]:2025-10-29 04:12:36,243 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4102e-01
[rank0]:2025-10-29 04:12:36,237 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.8841e+00
[rank1]:2025-10-29 04:12:36,246 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5259e+00
[rank3]:2025-10-29 04:12:59,425 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0063e+00
[rank2]:2025-10-29 04:12:59,416 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0035e+00
[rank1]:2025-10-29 04:12:59,419 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9615e-01
[rank0]:2025-10-29 04:12:59,426 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.3457e-01
[rank0]:2025-10-29 04:13:22,319 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:13:24,863 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.1255e-01
[rank3]:2025-10-29 04:13:24,866 - INFO -  step: 450  loss:  0.1013  grad_norm:  0.1548  memory: 75.33GiB(53.88%)  tps: 6,670  tflops: 311.09  mfu: 31.46%
[rank0]:2025-10-29 04:13:24,851 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.7820e-01
[rank0]:2025-10-29 04:13:24,851 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 71.50GiB(51.14%)  tps: 6,668  tflops: 310.98  mfu: 31.44%
[rank2]:2025-10-29 04:13:24,860 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4362e-01
[rank1]:2025-10-29 04:13:24,863 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5399e-01
[rank1]:2025-10-29 04:13:24,864 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 68.17GiB(48.76%)  tps: 6,669  tflops: 311.02  mfu: 31.45%
[rank2]:2025-10-29 04:13:24,860 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 61.15GiB(43.74%)  tps: 6,669  tflops: 311.06  mfu: 31.45%
[rank3]:2025-10-29 04:13:25,316 - INFO - Avg. fwd time: 14.9790 / Avg. bwd time: 40.9126 / Avg. batch time: 463.0548 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:13:25,347 - INFO - Avg. fwd time: 13.7167 / Avg. bwd time: 32.9925 / Avg. batch time: 512.6607 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-29 04:13:25,419 - INFO - Avg. fwd time: 14.4532 / Avg. bwd time: 35.8947 / Avg. batch time: 625.1104 (ms) / GPU bubble ratio: 35.57%
[rank1]:2025-10-29 04:13:25,383 - INFO - Avg. fwd time: 16.0658 / Avg. bwd time: 37.5801 / Avg. batch time: 569.0772 (ms) / GPU bubble ratio: 24.59%
[rank3]:2025-10-29 04:13:47,269 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3183e+00
[rank1]:2025-10-29 04:13:47,266 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8540e-01
[rank0]:2025-10-29 04:13:47,273 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4730e-01
[rank2]:2025-10-29 04:13:47,262 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9567e+00
[rank0]:2025-10-29 04:14:12,579 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0470e+00
[rank1]:2025-10-29 04:14:12,591 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1510e+00
[rank2]:2025-10-29 04:14:12,587 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7499e-01
[rank3]:2025-10-29 04:14:12,591 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.7215e-01
[rank1]:2025-10-29 04:14:35,191 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2701e+00
[rank0]:2025-10-29 04:14:35,198 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.3402e+00
[rank2]:2025-10-29 04:14:35,188 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5205e+00
[rank3]:2025-10-29 04:14:35,194 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1685e+00
[rank3]:2025-10-29 04:15:00,367 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.7433e+00
[rank0]:2025-10-29 04:15:00,356 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.0155e+00
[rank1]:2025-10-29 04:15:00,367 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5039e+00
[rank2]:2025-10-29 04:15:00,364 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3416e+00
[rank0]:2025-10-29 04:15:20,721 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:15:22,962 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1103e+00
[rank0]:2025-10-29 04:15:22,963 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 71.50GiB(51.14%)  tps: 6,936  tflops: 323.49  mfu: 32.71%
[rank1]:2025-10-29 04:15:22,955 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8691e+00
[rank1]:2025-10-29 04:15:22,955 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 68.17GiB(48.76%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank2]:2025-10-29 04:15:22,952 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3180e+00
[rank2]:2025-10-29 04:15:22,952 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 61.15GiB(43.74%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank3]:2025-10-29 04:15:22,958 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6850e+00
[rank3]:2025-10-29 04:15:22,961 - INFO -  step: 500  loss:  0.1154  grad_norm:  0.2150  memory: 76.44GiB(54.68%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank0]:2025-10-29 04:15:23,035 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0415_stage0_step500.svg
[rank1]:2025-10-29 04:15:23,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0415_stage1_step500.svg
[rank2]:2025-10-29 04:15:23,033 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0415_stage2_step500.svg
[rank3]:2025-10-29 04:15:23,141 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0415_real_step500_rank3.svg
[rank3]:> Batch Time: 623.57 ms, GPU Bubble Ratio: 35.27%, 26.88%, 36.72%, 26.83%
[rank3]:2025-10-29 04:15:23,199 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0415_stage3_step500.svg
[rank3]:2025-10-29 04:15:23,583 - INFO - Avg. fwd time: 14.9370 / Avg. bwd time: 40.6490 / Avg. batch time: 460.5422 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:15:23,631 - INFO - Avg. fwd time: 13.6947 / Avg. bwd time: 32.7609 / Avg. batch time: 509.8378 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-29 04:15:23,675 - INFO - Avg. fwd time: 14.4620 / Avg. bwd time: 35.2193 / Avg. batch time: 621.0981 (ms) / GPU bubble ratio: 36.01%
[rank1]:2025-10-29 04:15:23,678 - INFO - Avg. fwd time: 16.0305 / Avg. bwd time: 37.4164 / Avg. batch time: 566.0634 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 04:15:48,405 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.7199e+00
[rank1]:2025-10-29 04:15:48,416 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2938e+00
[rank2]:2025-10-29 04:15:48,413 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0520e-01
[rank3]:2025-10-29 04:15:48,416 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.1872e-01
[rank3]:2025-10-29 04:16:10,920 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1856e-01
[rank0]:2025-10-29 04:16:10,924 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.7080e-01
[rank1]:2025-10-29 04:16:10,916 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5709e-01
[rank2]:2025-10-29 04:16:10,913 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0611e-01
[rank0]:2025-10-29 04:16:36,314 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.2650e+00
[rank1]:2025-10-29 04:16:36,326 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0296e+00
[rank2]:2025-10-29 04:16:36,322 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4351e+00
[rank3]:2025-10-29 04:16:36,326 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.6595e+00
[rank1]:2025-10-29 04:16:58,690 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1939e+00
[rank0]:2025-10-29 04:16:58,697 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.6231e+00
[rank2]:2025-10-29 04:16:58,687 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6353e+00
[rank3]:2025-10-29 04:16:58,693 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3097e+00
[rank0]:2025-10-29 04:17:21,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:17:23,988 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.8281e-01
[rank3]:2025-10-29 04:17:23,992 - INFO -  step: 550  loss:  0.1234  grad_norm:  0.1225  memory: 76.44GiB(54.68%)  tps: 6,769  tflops: 315.69  mfu: 31.92%
[rank1]:2025-10-29 04:17:23,988 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.4552e-01
[rank1]:2025-10-29 04:17:23,989 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 68.17GiB(48.76%)  tps: 6,768  tflops: 315.68  mfu: 31.92%
[rank0]:2025-10-29 04:17:23,976 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.7485e+00
[rank0]:2025-10-29 04:17:23,977 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 71.50GiB(51.14%)  tps: 6,769  tflops: 315.73  mfu: 31.92%
[rank2]:2025-10-29 04:17:23,985 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9512e-01
[rank2]:2025-10-29 04:17:23,985 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 61.15GiB(43.74%)  tps: 6,768  tflops: 315.68  mfu: 31.92%
[rank3]:2025-10-29 04:17:24,355 - INFO - Avg. fwd time: 14.8910 / Avg. bwd time: 40.4590 / Avg. batch time: 458.5910 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 04:17:24,430 - INFO - Avg. fwd time: 15.9883 / Avg. bwd time: 37.3429 / Avg. batch time: 563.8587 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-10-29 04:17:24,450 - INFO - Avg. fwd time: 14.4737 / Avg. bwd time: 34.5292 / Avg. batch time: 617.8913 (ms) / GPU bubble ratio: 36.55%
[rank2]:2025-10-29 04:17:24,386 - INFO - Avg. fwd time: 13.6648 / Avg. bwd time: 32.6211 / Avg. batch time: 507.7291 (ms) / GPU bubble ratio: 27.07%
[rank1]:2025-10-29 04:17:46,526 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0071e+00
[rank0]:2025-10-29 04:17:46,533 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.3515e-01
[rank2]:2025-10-29 04:17:46,522 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6047e+00
[rank3]:2025-10-29 04:17:46,529 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9171e+00
[rank1]:2025-10-29 04:18:11,703 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1181e+00
[rank2]:2025-10-29 04:18:11,699 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9740e-01
[rank0]:2025-10-29 04:18:11,691 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1880e+00
[rank3]:2025-10-29 04:18:11,703 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0935e+00
[rank1]:2025-10-29 04:18:34,271 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.9666e-01
[rank2]:2025-10-29 04:18:34,268 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.9204e-01
[rank0]:2025-10-29 04:18:34,278 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.9701e-01
[rank3]:2025-10-29 04:18:34,274 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5098e+00
[rank0]:2025-10-29 04:18:59,446 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0601e+00
[rank3]:2025-10-29 04:18:59,458 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.5042e-01
[rank1]:2025-10-29 04:18:59,458 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.3248e-01
[rank2]:2025-10-29 04:18:59,455 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2401e-01
[rank0]:2025-10-29 04:19:19,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:19:21,863 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4251e+00
[rank2]:2025-10-29 04:19:21,863 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 61.15GiB(43.74%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank2]:2025-10-29 04:19:21,863 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 04:19:21,869 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.7199e-01
[rank3]:2025-10-29 04:19:21,871 - INFO -  step: 600  loss:  0.0938  grad_norm:  0.0828  memory: 76.44GiB(54.68%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank3]:2025-10-29 04:19:21,872 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:19:21,873 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.5105e-01
[rank0]:2025-10-29 04:19:21,873 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 71.50GiB(51.14%)  tps: 6,948  tflops: 324.08  mfu: 32.77%
[rank0]:2025-10-29 04:19:21,873 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 04:19:21,866 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4295e-01
[rank1]:2025-10-29 04:19:21,866 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 68.17GiB(48.76%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank1]:2025-10-29 04:19:21,866 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:19:36,840 - INFO - validate step: 600  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,368
[rank1]:2025-10-29 04:19:36,870 - INFO - validate step: 600  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,301
[rank3]:2025-10-29 04:19:36,899 - INFO - validate step: 600  loss:  0.2667  memory: 76.44GiB(54.68%)  tps: 27,259
[rank1]:2025-10-29 04:19:36,969 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0419_stage1_step600.svg
[rank2]:2025-10-29 04:19:36,883 - INFO - validate step: 600  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,271
[rank0]:2025-10-29 04:19:36,975 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0419_stage0_step600.svg
[rank2]:2025-10-29 04:19:36,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0419_stage2_step600.svg
[rank3]:2025-10-29 04:19:37,077 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0419_real_step600_rank3.svg
[rank3]:> Batch Time: 618.18 ms, GPU Bubble Ratio: 37.76%, 26.46%, 36.41%, 26.60%
[rank3]:2025-10-29 04:19:37,137 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0419_stage3_step600.svg
[rank3]:2025-10-29 04:19:37,611 - INFO - Avg. fwd time: 14.8544 / Avg. bwd time: 40.2293 / Avg. batch time: 456.4070 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:19:37,653 - INFO - Avg. fwd time: 13.6447 / Avg. bwd time: 32.4134 / Avg. batch time: 505.3136 (ms) / GPU bubble ratio: 27.08%
[rank1]:2025-10-29 04:19:37,700 - INFO - Avg. fwd time: 15.9542 / Avg. bwd time: 37.1862 / Avg. batch time: 561.2591 (ms) / GPU bubble ratio: 24.26%
[rank0]:2025-10-29 04:19:37,731 - INFO - Avg. fwd time: 14.4728 / Avg. bwd time: 33.9994 / Avg. batch time: 614.5006 (ms) / GPU bubble ratio: 36.90%
[rank2]:2025-10-29 04:20:02,494 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.4287e-01
[rank0]:2025-10-29 04:20:02,485 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.2590e+00
[rank1]:2025-10-29 04:20:02,497 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7476e+00
[rank3]:2025-10-29 04:20:02,497 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.6871e+00
[rank1]:2025-10-29 04:20:24,893 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.0053e-01
[rank0]:2025-10-29 04:20:24,900 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4623e+00
[rank2]:2025-10-29 04:20:24,890 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7326e+00
[rank3]:2025-10-29 04:20:24,896 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6422e-01
[rank2]:2025-10-29 04:20:50,205 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1788e-01
[rank1]:2025-10-29 04:20:50,208 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.4166e-01
[rank0]:2025-10-29 04:20:50,196 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.5647e+00
[rank3]:2025-10-29 04:20:50,208 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5384e-01
[rank1]:2025-10-29 04:21:12,838 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1268e+00
[rank0]:2025-10-29 04:21:12,845 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.5720e+00
[rank2]:2025-10-29 04:21:12,834 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5361e+00
[rank3]:2025-10-29 04:21:12,841 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2801e+00
[rank0]:2025-10-29 04:21:35,459 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:21:37,997 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.1609e+00
[rank3]:2025-10-29 04:21:37,999 - INFO -  step: 650  loss:  0.0845  grad_norm:  0.1135  memory: 76.44GiB(54.68%)  tps: 6,765  tflops: 315.51  mfu: 31.90%
[rank0]:2025-10-29 04:21:37,985 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.8270e-01
[rank0]:2025-10-29 04:21:37,985 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 71.50GiB(51.14%)  tps: 6,762  tflops: 315.39  mfu: 31.89%
[rank2]:2025-10-29 04:21:37,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8353e-01
[rank2]:2025-10-29 04:21:37,994 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 61.15GiB(43.74%)  tps: 6,764  tflops: 315.48  mfu: 31.90%
[rank1]:2025-10-29 04:21:37,997 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.3091e-01
[rank1]:2025-10-29 04:21:37,997 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 68.17GiB(48.76%)  tps: 6,763  tflops: 315.43  mfu: 31.89%
[rank3]:2025-10-29 04:21:38,366 - INFO - Avg. fwd time: 14.8268 / Avg. bwd time: 40.1365 / Avg. batch time: 455.4057 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:21:38,398 - INFO - Avg. fwd time: 13.6250 / Avg. bwd time: 32.3558 / Avg. batch time: 504.2069 (ms) / GPU bubble ratio: 27.04%
[rank0]:2025-10-29 04:21:38,461 - INFO - Avg. fwd time: 14.4810 / Avg. bwd time: 33.5703 / Avg. batch time: 612.7427 (ms) / GPU bubble ratio: 37.26%
[rank1]:2025-10-29 04:21:38,442 - INFO - Avg. fwd time: 15.9274 / Avg. bwd time: 37.1678 / Avg. batch time: 560.1204 (ms) / GPU bubble ratio: 24.17%
[rank2]:2025-10-29 04:22:00,558 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7190e+00
[rank1]:2025-10-29 04:22:00,562 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9908e+00
[rank0]:2025-10-29 04:22:00,569 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.0621e+00
[rank3]:2025-10-29 04:22:00,565 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8412e+00
[rank0]:2025-10-29 04:22:25,810 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.7496e+00
[rank3]:2025-10-29 04:22:25,822 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.3617e+00
[rank2]:2025-10-29 04:22:25,819 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4819e+00
[rank1]:2025-10-29 04:22:25,822 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.3247e+00
[rank3]:2025-10-29 04:22:48,285 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1585e-01
[rank2]:2025-10-29 04:22:48,278 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0715e+00
[rank0]:2025-10-29 04:22:48,290 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.5452e-01
[rank1]:2025-10-29 04:22:48,282 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1222e+00
[rank0]:2025-10-29 04:23:13,651 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.2849e+00
[rank3]:2025-10-29 04:23:13,663 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5457e+00
[rank1]:2025-10-29 04:23:13,663 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.9104e+00
[rank2]:2025-10-29 04:23:13,660 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2762e+00
[rank0]:2025-10-29 04:23:33,768 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:23:36,048 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0669e+00
[rank0]:2025-10-29 04:23:36,049 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 71.50GiB(51.14%)  tps: 6,939  tflops: 323.62  mfu: 32.72%
[rank2]:2025-10-29 04:23:36,038 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1813e+00
[rank2]:2025-10-29 04:23:36,038 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 61.15GiB(43.74%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank1]:2025-10-29 04:23:36,041 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2686e+00
[rank1]:2025-10-29 04:23:36,041 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 68.17GiB(48.76%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank3]:2025-10-29 04:23:36,044 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2247e+00
[rank3]:2025-10-29 04:23:36,047 - INFO -  step: 700  loss:  0.0995  grad_norm:  0.1229  memory: 76.44GiB(54.68%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank0]:2025-10-29 04:23:36,127 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0423_stage0_step700.svg
[rank1]:2025-10-29 04:23:36,119 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0423_stage1_step700.svg
[rank2]:2025-10-29 04:23:36,121 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0423_stage2_step700.svg
[rank3]:2025-10-29 04:23:36,223 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0423_real_step700_rank3.svg
[rank3]:> Batch Time: 616.27 ms, GPU Bubble Ratio: 38.18%, 26.42%, 36.33%, 26.61%
[rank3]:2025-10-29 04:23:36,285 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0423_stage3_step700.svg
[rank3]:2025-10-29 04:23:36,674 - INFO - Avg. fwd time: 14.7998 / Avg. bwd time: 39.9911 / Avg. batch time: 453.9880 (ms) / GPU bubble ratio: 3.45%
[rank0]:2025-10-29 04:23:36,766 - INFO - Avg. fwd time: 14.4822 / Avg. bwd time: 33.1723 / Avg. batch time: 610.4455 (ms) / GPU bubble ratio: 37.55%
[rank1]:2025-10-29 04:23:36,770 - INFO - Avg. fwd time: 15.9036 / Avg. bwd time: 37.0817 / Avg. batch time: 558.4118 (ms) / GPU bubble ratio: 24.09%
[rank2]:2025-10-29 04:23:36,724 - INFO - Avg. fwd time: 13.6087 / Avg. bwd time: 32.2307 / Avg. batch time: 502.6106 (ms) / GPU bubble ratio: 27.04%
[rank3]:2025-10-29 04:24:01,454 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.1526e-01
[rank0]:2025-10-29 04:24:01,442 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3360e-01
[rank1]:2025-10-29 04:24:01,454 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6532e-01
[rank2]:2025-10-29 04:24:01,451 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7088e-01
[rank3]:2025-10-29 04:24:23,945 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1293e+00
[rank0]:2025-10-29 04:24:23,949 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.9499e-01
[rank2]:2025-10-29 04:24:23,938 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2380e-01
[rank1]:2025-10-29 04:24:23,941 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.2873e-01
[rank1]:2025-10-29 04:24:49,108 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7921e+00
[rank0]:2025-10-29 04:24:49,096 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.6957e+00
[rank2]:2025-10-29 04:24:49,105 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0504e+00
[rank3]:2025-10-29 04:24:49,108 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8115e+00
[rank1]:2025-10-29 04:25:11,658 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0983e+00
[rank2]:2025-10-29 04:25:11,655 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1562e+00
[rank3]:2025-10-29 04:25:11,662 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5991e+00
[rank0]:2025-10-29 04:25:11,666 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.0910e-01
[rank0]:2025-10-29 04:25:34,310 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:25:36,866 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.2558e+00
[rank0]:2025-10-29 04:25:36,867 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 71.50GiB(51.14%)  tps: 6,780  tflops: 316.24  mfu: 31.98%
[rank2]:2025-10-29 04:25:36,875 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9322e+00
[rank2]:2025-10-29 04:25:36,876 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 61.15GiB(43.74%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank1]:2025-10-29 04:25:36,878 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1418e+00
[rank1]:2025-10-29 04:25:36,879 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 68.17GiB(48.76%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank3]:2025-10-29 04:25:36,878 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.4558e+00
[rank3]:2025-10-29 04:25:36,881 - INFO -  step: 750  loss:  0.1319  grad_norm:  0.1488  memory: 76.44GiB(54.68%)  tps: 6,780  tflops: 316.20  mfu: 31.97%
[rank3]:2025-10-29 04:25:37,341 - INFO - Avg. fwd time: 14.7702 / Avg. bwd time: 39.9190 / Avg. batch time: 453.1412 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:25:37,374 - INFO - Avg. fwd time: 13.5856 / Avg. bwd time: 32.1935 / Avg. batch time: 501.7223 (ms) / GPU bubble ratio: 27.00%
[rank0]:2025-10-29 04:25:37,448 - INFO - Avg. fwd time: 14.4854 / Avg. bwd time: 32.7899 / Avg. batch time: 608.9889 (ms) / GPU bubble ratio: 37.90%
[rank1]:2025-10-29 04:25:37,411 - INFO - Avg. fwd time: 15.8734 / Avg. bwd time: 37.0796 / Avg. batch time: 557.5040 (ms) / GPU bubble ratio: 24.01%
[rank3]:2025-10-29 04:25:59,320 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7460e+00
[rank2]:2025-10-29 04:25:59,313 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5893e+00
[rank1]:2025-10-29 04:25:59,316 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9242e+00
[rank0]:2025-10-29 04:25:59,323 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.6705e+00
[rank2]:2025-10-29 04:26:24,701 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.6857e-01
[rank1]:2025-10-29 04:26:24,704 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6953e-01
[rank0]:2025-10-29 04:26:24,692 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8417e-01
[rank3]:2025-10-29 04:26:24,704 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.1857e-01
[rank3]:2025-10-29 04:26:47,060 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4149e+00
[rank2]:2025-10-29 04:26:47,054 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7138e+00
[rank1]:2025-10-29 04:26:47,057 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2459e+00
[rank0]:2025-10-29 04:26:47,064 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.2092e-01
[rank2]:2025-10-29 04:27:12,346 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1485e-01
[rank1]:2025-10-29 04:27:12,349 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0168e-01
[rank0]:2025-10-29 04:27:12,337 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.3020e-01
[rank3]:2025-10-29 04:27:12,349 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.6510e-01
[rank0]:2025-10-29 04:27:32,610 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:27:34,910 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9095e+00
[rank3]:2025-10-29 04:27:34,912 - INFO -  step: 800  loss:  0.1116  grad_norm:  0.1307  memory: 76.44GiB(54.68%)  tps: 6,941  tflops: 323.71  mfu: 32.73%
[rank3]:2025-10-29 04:27:34,913 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 04:27:34,904 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1679e+00
[rank2]:2025-10-29 04:27:34,904 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 61.15GiB(43.74%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank2]:2025-10-29 04:27:34,904 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:27:34,906 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0121e+00
[rank1]:2025-10-29 04:27:34,907 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 68.17GiB(48.76%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank1]:2025-10-29 04:27:34,907 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:27:34,914 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.6731e-01
[rank0]:2025-10-29 04:27:34,914 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 71.50GiB(51.14%)  tps: 6,940  tflops: 323.66  mfu: 32.73%
[rank0]:2025-10-29 04:27:34,914 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:27:49,998 - INFO - validate step: 800  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,142
[rank0]:2025-10-29 04:27:49,968 - INFO - validate step: 800  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,210
[rank3]:2025-10-29 04:27:50,025 - INFO - validate step: 800  loss:  0.2681  memory: 76.44GiB(54.68%)  tps: 27,106
[rank1]:2025-10-29 04:27:50,099 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0427_stage1_step800.svg
[rank2]:2025-10-29 04:27:50,012 - INFO - validate step: 800  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,113
[rank2]:2025-10-29 04:27:50,107 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0427_stage2_step800.svg
[rank0]:2025-10-29 04:27:50,106 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0427_stage0_step800.svg
[rank3]:2025-10-29 04:27:50,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0427_real_step800_rank3.svg
[rank3]:> Batch Time: 613.12 ms, GPU Bubble Ratio: 40.52%, 26.15%, 36.08%, 26.37%
[rank3]:2025-10-29 04:27:50,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0427_stage3_step800.svg
[rank3]:2025-10-29 04:27:50,668 - INFO - Avg. fwd time: 14.7531 / Avg. bwd time: 39.8107 / Avg. batch time: 452.1129 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:27:50,764 - INFO - Avg. fwd time: 15.8574 / Avg. bwd time: 37.0029 / Avg. batch time: 556.2414 (ms) / GPU bubble ratio: 23.97%
[rank2]:2025-10-29 04:27:50,718 - INFO - Avg. fwd time: 13.5759 / Avg. bwd time: 32.0935 / Avg. batch time: 500.5568 (ms) / GPU bubble ratio: 27.01%
[rank0]:2025-10-29 04:27:50,761 - INFO - Avg. fwd time: 14.4843 / Avg. bwd time: 32.5415 / Avg. batch time: 607.3555 (ms) / GPU bubble ratio: 38.06%
[rank3]:2025-10-29 04:28:15,362 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2249e+00
[rank1]:2025-10-29 04:28:15,362 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.8022e-01
[rank2]:2025-10-29 04:28:15,359 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6715e-01
[rank0]:2025-10-29 04:28:15,350 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5704e-01
[rank1]:2025-10-29 04:28:37,942 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1601e-01
[rank2]:2025-10-29 04:28:37,939 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2109e+00
[rank3]:2025-10-29 04:28:37,945 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3128e-01
[rank0]:2025-10-29 04:28:37,949 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.9213e-01
[rank1]:2025-10-29 04:29:03,163 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.1791e-01
[rank2]:2025-10-29 04:29:03,159 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8601e-01
[rank0]:2025-10-29 04:29:03,151 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.3444e+00
[rank3]:2025-10-29 04:29:03,163 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.7504e-01
[rank3]:2025-10-29 04:29:25,611 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1779e-01
[rank1]:2025-10-29 04:29:25,607 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8720e-01
[rank2]:2025-10-29 04:29:25,604 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2311e-01
[rank0]:2025-10-29 04:29:25,615 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7630e-01
[rank0]:2025-10-29 04:29:48,489 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:29:51,037 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0088e+00
[rank3]:2025-10-29 04:29:51,040 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.2988  memory: 76.44GiB(54.68%)  tps: 6,769  tflops: 315.73  mfu: 31.92%
[rank1]:2025-10-29 04:29:51,036 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1823e-01
[rank1]:2025-10-29 04:29:51,037 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 68.17GiB(48.76%)  tps: 6,768  tflops: 315.67  mfu: 31.92%
[rank0]:2025-10-29 04:29:51,024 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.4766e+00
[rank0]:2025-10-29 04:29:51,025 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 71.50GiB(51.14%)  tps: 6,767  tflops: 315.62  mfu: 31.91%
[rank2]:2025-10-29 04:29:51,033 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3368e-01
[rank2]:2025-10-29 04:29:51,033 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 61.15GiB(43.74%)  tps: 6,769  tflops: 315.71  mfu: 31.92%
[rank3]:2025-10-29 04:29:51,401 - INFO - Avg. fwd time: 14.7359 / Avg. bwd time: 39.7407 / Avg. batch time: 451.3906 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:29:51,476 - INFO - Avg. fwd time: 15.8383 / Avg. bwd time: 36.9783 / Avg. batch time: 555.4289 (ms) / GPU bubble ratio: 23.93%
[rank0]:2025-10-29 04:29:51,495 - INFO - Avg. fwd time: 14.4885 / Avg. bwd time: 32.2579 / Avg. batch time: 606.1297 (ms) / GPU bubble ratio: 38.30%
[rank2]:2025-10-29 04:29:51,432 - INFO - Avg. fwd time: 13.5636 / Avg. bwd time: 32.0449 / Avg. batch time: 499.7838 (ms) / GPU bubble ratio: 26.99%
[rank1]:2025-10-29 04:30:13,405 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9641e+00
[rank0]:2025-10-29 04:30:13,412 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.4446e-01
[rank2]:2025-10-29 04:30:13,401 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8344e+00
[rank3]:2025-10-29 04:30:13,408 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7550e+00
[rank1]:2025-10-29 04:30:38,726 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0695e+00
[rank2]:2025-10-29 04:30:38,723 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2894e-01
[rank0]:2025-10-29 04:30:38,714 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.2996e+00
[rank3]:2025-10-29 04:30:38,726 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.4743e-01
[rank1]:2025-10-29 04:31:01,325 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0020e+00
[rank2]:2025-10-29 04:31:01,321 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0292e+00
[rank0]:2025-10-29 04:31:01,332 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3432e+00
[rank3]:2025-10-29 04:31:01,328 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6326e+00
[rank1]:2025-10-29 04:31:26,479 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1940e-01
[rank2]:2025-10-29 04:31:26,476 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1435e-01
[rank0]:2025-10-29 04:31:26,467 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1480e+00
[rank3]:2025-10-29 04:31:26,480 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.9412e-01
[rank0]:2025-10-29 04:31:46,823 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:31:49,064 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.8418e-01
[rank3]:2025-10-29 04:31:49,067 - INFO -  step: 900  loss:  0.1227  grad_norm:  0.1846  memory: 76.44GiB(54.68%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank1]:2025-10-29 04:31:49,061 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.8285e-01
[rank1]:2025-10-29 04:31:49,061 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 68.17GiB(48.76%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank2]:2025-10-29 04:31:49,058 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5137e-01
[rank2]:2025-10-29 04:31:49,058 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 61.15GiB(43.74%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank0]:2025-10-29 04:31:49,068 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.8528e-01
[rank0]:2025-10-29 04:31:49,068 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 71.50GiB(51.14%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank1]:2025-10-29 04:31:49,135 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0431_stage1_step900.svg
[rank2]:2025-10-29 04:31:49,139 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0431_stage2_step900.svg
[rank0]:2025-10-29 04:31:49,141 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0431_stage0_step900.svg
[rank3]:2025-10-29 04:31:49,250 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0431_real_step900_rank3.svg
[rank3]:> Batch Time: 612.16 ms, GPU Bubble Ratio: 40.57%, 26.12%, 36.03%, 26.37%
[rank3]:2025-10-29 04:31:49,308 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0431_stage3_step900.svg
[rank3]:2025-10-29 04:31:49,777 - INFO - Avg. fwd time: 14.7231 / Avg. bwd time: 39.6330 / Avg. batch time: 450.4026 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:31:49,869 - INFO - Avg. fwd time: 15.8266 / Avg. bwd time: 36.8967 / Avg. batch time: 554.2444 (ms) / GPU bubble ratio: 23.90%
[rank0]:2025-10-29 04:31:49,902 - INFO - Avg. fwd time: 14.4899 / Avg. bwd time: 32.0385 / Avg. batch time: 604.6201 (ms) / GPU bubble ratio: 38.44%
[rank2]:2025-10-29 04:31:49,821 - INFO - Avg. fwd time: 13.5579 / Avg. bwd time: 31.9424 / Avg. batch time: 498.6945 (ms) / GPU bubble ratio: 27.01%
[rank3]:2025-10-29 04:32:14,488 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5763e-01
[rank1]:2025-10-29 04:32:14,488 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.6191e-01
[rank2]:2025-10-29 04:32:14,485 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9313e-01
[rank0]:2025-10-29 04:32:14,476 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.8253e+00
[rank2]:2025-10-29 04:32:36,949 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1818e+00
[rank3]:2025-10-29 04:32:36,956 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.7933e-01
[rank1]:2025-10-29 04:32:36,952 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3524e+00
[rank0]:2025-10-29 04:32:36,960 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2086e+00
[rank1]:2025-10-29 04:33:02,362 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1630e-01
[rank0]:2025-10-29 04:33:02,350 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0495e+00
[rank2]:2025-10-29 04:33:02,359 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.8411e-01
[rank3]:2025-10-29 04:33:02,362 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0928e+00
[rank2]:2025-10-29 04:33:24,788 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.2173e-01
[rank3]:2025-10-29 04:33:24,794 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4729e+00
[rank1]:2025-10-29 04:33:24,791 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.8615e-01
[rank0]:2025-10-29 04:33:24,798 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.7906e-01
[rank0]:2025-10-29 04:33:47,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:33:50,146 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5152e+00
[rank3]:2025-10-29 04:33:50,148 - INFO -  step: 950  loss:  0.1484  grad_norm:  0.1783  memory: 76.44GiB(54.68%)  tps: 6,766  tflops: 315.56  mfu: 31.91%
[rank1]:2025-10-29 04:33:50,146 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.5200e-01
[rank1]:2025-10-29 04:33:50,146 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 68.17GiB(48.76%)  tps: 6,766  tflops: 315.54  mfu: 31.91%
[rank0]:2025-10-29 04:33:50,134 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.7136e-01
[rank0]:2025-10-29 04:33:50,134 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 71.50GiB(51.14%)  tps: 6,767  tflops: 315.59  mfu: 31.91%
[rank2]:2025-10-29 04:33:50,142 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1769e-01
[rank2]:2025-10-29 04:33:50,143 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 61.15GiB(43.74%)  tps: 6,766  tflops: 315.55  mfu: 31.91%
[rank3]:2025-10-29 04:33:50,513 - INFO - Avg. fwd time: 14.7094 / Avg. bwd time: 39.5981 / Avg. batch time: 449.9972 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:33:50,589 - INFO - Avg. fwd time: 15.8125 / Avg. bwd time: 36.8991 / Avg. batch time: 553.7860 (ms) / GPU bubble ratio: 23.85%
[rank0]:2025-10-29 04:33:50,610 - INFO - Avg. fwd time: 14.4939 / Avg. bwd time: 31.8381 / Avg. batch time: 603.8768 (ms) / GPU bubble ratio: 38.62%
[rank2]:2025-10-29 04:33:50,545 - INFO - Avg. fwd time: 13.5473 / Avg. bwd time: 31.9259 / Avg. batch time: 498.2457 (ms) / GPU bubble ratio: 26.99%
[rank3]:2025-10-29 04:34:12,790 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8086e+00
[rank1]:2025-10-29 04:34:12,786 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6874e+00
[rank0]:2025-10-29 04:34:12,794 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.8185e+00
[rank2]:2025-10-29 04:34:12,783 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6606e+00
[rank0]:2025-10-29 04:34:37,945 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1017e+00
[rank3]:2025-10-29 04:34:37,957 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.4860e+00
[rank2]:2025-10-29 04:34:37,954 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3502e-01
[rank1]:2025-10-29 04:34:37,957 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0151e+00
[rank3]:2025-10-29 04:35:00,603 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9574e+00
[rank0]:2025-10-29 04:35:00,607 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7575e+00
[rank2]:2025-10-29 04:35:00,597 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4528e+00
[rank1]:2025-10-29 04:35:00,600 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7415e+00
[rank3]:2025-10-29 04:35:25,911 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.9188e+00
[rank0]:2025-10-29 04:35:25,898 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.9856e+00
[rank2]:2025-10-29 04:35:25,907 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0395e+00
[rank1]:2025-10-29 04:35:25,910 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.7714e+00
[rank0]:2025-10-29 04:35:46,193 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:35:48,461 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8936e+00
[rank3]:2025-10-29 04:35:48,463 - INFO -  step: 1000  loss:  0.1225  grad_norm:  0.1060  memory: 76.44GiB(54.68%)  tps: 6,924  tflops: 322.93  mfu: 32.65%
[rank3]:2025-10-29 04:35:48,464 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:35:48,464 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4109e+00
[rank0]:2025-10-29 04:35:48,465 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 71.50GiB(51.14%)  tps: 6,923  tflops: 322.89  mfu: 32.65%
[rank0]:2025-10-29 04:35:48,465 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 04:35:48,454 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4161e+00
[rank2]:2025-10-29 04:35:48,454 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 61.15GiB(43.74%)  tps: 6,924  tflops: 322.94  mfu: 32.65%
[rank2]:2025-10-29 04:35:48,454 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 04:35:48,457 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3185e+00
[rank1]:2025-10-29 04:35:48,458 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 68.17GiB(48.76%)  tps: 6,924  tflops: 322.94  mfu: 32.65%
[rank1]:2025-10-29 04:35:48,458 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:36:03,515 - INFO - validate step: 1000  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,216
[rank3]:2025-10-29 04:36:03,572 - INFO - validate step: 1000  loss:  0.2714  memory: 76.44GiB(54.68%)  tps: 27,112
[rank2]:2025-10-29 04:36:03,560 - INFO - validate step: 1000  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,117
[rank1]:2025-10-29 04:36:03,548 - INFO - validate step: 1000  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,144
[rank0]:2025-10-29 04:36:03,650 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0436_stage0_step1000.svg
[rank2]:2025-10-29 04:36:03,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0436_stage2_step1000.svg
[rank1]:2025-10-29 04:36:03,645 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0436_stage1_step1000.svg
[rank3]:2025-10-29 04:36:03,756 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0436_real_step1000_rank3.svg
[rank3]:> Batch Time: 611.54 ms, GPU Bubble Ratio: 40.58%, 26.09%, 36.01%, 26.38%
[rank3]:2025-10-29 04:36:03,816 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0436_stage3_step1000.svg
[rank3]:2025-10-29 04:36:04,205 - INFO - Avg. fwd time: 14.6989 / Avg. bwd time: 39.5295 / Avg. batch time: 449.3471 (ms) / GPU bubble ratio: 3.45%
[rank0]:2025-10-29 04:36:04,296 - INFO - Avg. fwd time: 14.4962 / Avg. bwd time: 31.6529 / Avg. batch time: 602.8095 (ms) / GPU bubble ratio: 38.75%
[rank2]:2025-10-29 04:36:04,254 - INFO - Avg. fwd time: 13.5417 / Avg. bwd time: 31.8647 / Avg. batch time: 497.5059 (ms) / GPU bubble ratio: 26.99%
[rank1]:2025-10-29 04:36:04,299 - INFO - Avg. fwd time: 15.8029 / Avg. bwd time: 36.8575 / Avg. batch time: 552.9919 (ms) / GPU bubble ratio: 23.82%
[rank0]:2025-10-29 04:36:29,212 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.9651e-01
[rank2]:2025-10-29 04:36:29,222 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2894e-01
[rank1]:2025-10-29 04:36:29,224 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4825e+00
[rank3]:2025-10-29 04:36:29,225 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2128e+00
[rank0]:2025-10-29 04:36:51,659 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.5951e-01
[rank2]:2025-10-29 04:36:51,648 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.7120e-01
[rank1]:2025-10-29 04:36:51,651 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2032e-01
[rank3]:2025-10-29 04:36:51,655 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3533e-01
[rank0]:2025-10-29 04:37:16,966 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.1389e+00
[rank2]:2025-10-29 04:37:16,974 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6705e+00
[rank1]:2025-10-29 04:37:16,978 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1887e+00
[rank3]:2025-10-29 04:37:16,978 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.2489e+00
[rank0]:2025-10-29 04:37:39,596 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.5503e+00
[rank2]:2025-10-29 04:37:39,585 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8432e+00
[rank1]:2025-10-29 04:37:39,588 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5712e+00
[rank3]:2025-10-29 04:37:39,591 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2789e+00
[rank0]:2025-10-29 04:38:02,236 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:38:04,776 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.6873e+00
[rank0]:2025-10-29 04:38:04,776 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 71.50GiB(51.14%)  tps: 6,756  tflops: 315.09  mfu: 31.86%
[rank2]:2025-10-29 04:38:04,785 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5507e+00
[rank2]:2025-10-29 04:38:04,786 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 61.15GiB(43.74%)  tps: 6,758  tflops: 315.18  mfu: 31.87%
[rank1]:2025-10-29 04:38:04,788 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.7683e+00
[rank1]:2025-10-29 04:38:04,789 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 68.17GiB(48.76%)  tps: 6,757  tflops: 315.14  mfu: 31.86%
[rank3]:2025-10-29 04:38:04,788 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.8705e-01
[rank3]:2025-10-29 04:38:04,791 - INFO -  step: 1050  loss:  0.1311  grad_norm:  0.1391  memory: 76.44GiB(54.68%)  tps: 6,758  tflops: 315.20  mfu: 31.87%
[rank3]:2025-10-29 04:38:05,248 - INFO - Avg. fwd time: 14.6862 / Avg. bwd time: 39.5061 / Avg. batch time: 449.0420 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:38:05,282 - INFO - Avg. fwd time: 13.5314 / Avg. bwd time: 31.8601 / Avg. batch time: 497.2023 (ms) / GPU bubble ratio: 26.97%
[rank1]:2025-10-29 04:38:05,320 - INFO - Avg. fwd time: 15.7885 / Avg. bwd time: 36.8709 / Avg. batch time: 552.6928 (ms) / GPU bubble ratio: 23.78%
[rank0]:2025-10-29 04:38:05,358 - INFO - Avg. fwd time: 14.5010 / Avg. bwd time: 31.4585 / Avg. batch time: 602.2345 (ms) / GPU bubble ratio: 38.95%
[rank2]:2025-10-29 04:38:27,434 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4924e+00
[rank1]:2025-10-29 04:38:27,437 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.5333e-01
[rank3]:2025-10-29 04:38:27,440 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6401e+00
[rank0]:2025-10-29 04:38:27,444 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.7281e-01
[rank2]:2025-10-29 04:38:52,740 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9350e-01
[rank0]:2025-10-29 04:38:52,731 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.3656e+00
[rank1]:2025-10-29 04:38:52,743 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7327e+00
[rank3]:2025-10-29 04:38:52,743 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5750e+00
[rank2]:2025-10-29 04:39:15,241 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1137e-01
[rank0]:2025-10-29 04:39:15,252 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9820e+00
[rank1]:2025-10-29 04:39:15,245 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2582e+00
[rank3]:2025-10-29 04:39:15,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3219e-01
[rank3]:2025-10-29 04:39:40,732 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.2832e+00
[rank0]:2025-10-29 04:39:40,720 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.4292e+00
[rank2]:2025-10-29 04:39:40,728 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7406e+00
[rank1]:2025-10-29 04:39:40,732 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6000e+00
[rank0]:2025-10-29 04:40:00,830 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:40:03,104 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4204e+00
[rank2]:2025-10-29 04:40:03,105 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 61.15GiB(43.74%)  tps: 6,924  tflops: 322.92  mfu: 32.65%
[rank0]:2025-10-29 04:40:03,115 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.1571e+00
[rank0]:2025-10-29 04:40:03,115 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 71.50GiB(51.14%)  tps: 6,923  tflops: 322.87  mfu: 32.65%
[rank1]:2025-10-29 04:40:03,107 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8633e+00
[rank1]:2025-10-29 04:40:03,108 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 68.17GiB(48.76%)  tps: 6,924  tflops: 322.92  mfu: 32.65%
[rank3]:2025-10-29 04:40:03,111 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2355e+00
[rank3]:2025-10-29 04:40:03,113 - INFO -  step: 1100  loss:  0.0994  grad_norm:  0.1065  memory: 76.44GiB(54.68%)  tps: 6,924  tflops: 322.91  mfu: 32.65%
[rank0]:2025-10-29 04:40:03,189 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0440_stage0_step1100.svg
[rank2]:2025-10-29 04:40:03,191 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0440_stage2_step1100.svg
[rank1]:2025-10-29 04:40:03,184 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0440_stage1_step1100.svg
[rank3]:2025-10-29 04:40:03,299 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0440_real_step1100_rank3.svg
[rank3]:> Batch Time: 611.23 ms, GPU Bubble Ratio: 40.60%, 26.07%, 36.00%, 26.39%
[rank3]:2025-10-29 04:40:03,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0440_stage3_step1100.svg
[rank3]:2025-10-29 04:40:03,749 - INFO - Avg. fwd time: 14.6821 / Avg. bwd time: 39.4482 / Avg. batch time: 448.5342 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:40:03,798 - INFO - Avg. fwd time: 13.5301 / Avg. bwd time: 31.8033 / Avg. batch time: 496.6183 (ms) / GPU bubble ratio: 26.97%
[rank0]:2025-10-29 04:40:03,842 - INFO - Avg. fwd time: 14.5033 / Avg. bwd time: 31.3351 / Avg. batch time: 601.4109 (ms) / GPU bubble ratio: 39.03%
[rank1]:2025-10-29 04:40:03,844 - INFO - Avg. fwd time: 15.7849 / Avg. bwd time: 36.8271 / Avg. batch time: 552.0537 (ms) / GPU bubble ratio: 23.76%
[rank0]:2025-10-29 04:40:28,629 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9589e+00
[rank2]:2025-10-29 04:40:28,638 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1705e+00
[rank1]:2025-10-29 04:40:28,642 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1978e+00
[rank3]:2025-10-29 04:40:28,642 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6857e+00
[rank2]:2025-10-29 04:40:51,257 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5469e-01
[rank1]:2025-10-29 04:40:51,261 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9454e-01
[rank3]:2025-10-29 04:40:51,264 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4301e+00
[rank0]:2025-10-29 04:40:51,268 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8559e-01
[rank0]:2025-10-29 04:41:16,434 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.9132e-01
[rank2]:2025-10-29 04:41:16,443 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1355e-01
[rank1]:2025-10-29 04:41:16,446 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2711e+00
[rank3]:2025-10-29 04:41:16,447 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.0257e-01
[rank2]:2025-10-29 04:41:39,069 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5105e+00
[rank0]:2025-10-29 04:41:39,079 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0521e+00
[rank1]:2025-10-29 04:41:39,072 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3137e+00
[rank3]:2025-10-29 04:41:39,075 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6560e+00
[rank0]:2025-10-29 04:42:01,785 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:42:04,361 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.0808e-01
[rank3]:2025-10-29 04:42:04,364 - INFO -  step: 1150  loss:  0.1188  grad_norm:  0.1401  memory: 76.44GiB(54.68%)  tps: 6,756  tflops: 315.12  mfu: 31.86%
[rank0]:2025-10-29 04:42:04,349 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.0291e+00
[rank0]:2025-10-29 04:42:04,350 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 71.50GiB(51.14%)  tps: 6,757  tflops: 315.15  mfu: 31.87%
[rank2]:2025-10-29 04:42:04,358 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0870e-01
[rank2]:2025-10-29 04:42:04,358 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 61.15GiB(43.74%)  tps: 6,756  tflops: 315.11  mfu: 31.86%
[rank1]:2025-10-29 04:42:04,361 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7920e+00
[rank1]:2025-10-29 04:42:04,361 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 68.17GiB(48.76%)  tps: 6,756  tflops: 315.11  mfu: 31.86%
[rank3]:2025-10-29 04:42:04,739 - INFO - Avg. fwd time: 14.6724 / Avg. bwd time: 39.4154 / Avg. batch time: 448.1810 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:42:04,770 - INFO - Avg. fwd time: 13.5230 / Avg. bwd time: 31.7822 / Avg. batch time: 496.2472 (ms) / GPU bubble ratio: 26.96%
[rank1]:2025-10-29 04:42:04,814 - INFO - Avg. fwd time: 15.7757 / Avg. bwd time: 36.8213 / Avg. batch time: 551.6734 (ms) / GPU bubble ratio: 23.73%
[rank0]:2025-10-29 04:42:04,834 - INFO - Avg. fwd time: 14.5062 / Avg. bwd time: 31.1829 / Avg. batch time: 600.8087 (ms) / GPU bubble ratio: 39.16%
[rank0]:2025-10-29 04:42:26,832 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.4004e+00
[rank2]:2025-10-29 04:42:26,822 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0061e+00
[rank1]:2025-10-29 04:42:26,825 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4848e+00
[rank3]:2025-10-29 04:42:26,828 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3499e-01
[rank0]:2025-10-29 04:42:52,234 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8485e+00
[rank2]:2025-10-29 04:42:52,242 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0475e+00
[rank1]:2025-10-29 04:42:52,246 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.9101e+00
[rank3]:2025-10-29 04:42:52,246 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7651e+00
[rank1]:2025-10-29 04:43:14,607 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4667e+00
[rank3]:2025-10-29 04:43:14,610 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1931e+00
[rank2]:2025-10-29 04:43:14,604 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4712e+00
[rank0]:2025-10-29 04:43:14,614 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5732e+00
[rank1]:2025-10-29 04:43:39,842 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3914e-01
[rank3]:2025-10-29 04:43:39,842 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.8363e-01
[rank0]:2025-10-29 04:43:39,830 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8323e-01
[rank2]:2025-10-29 04:43:39,839 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4243e-01
[rank0]:2025-10-29 04:44:00,082 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:44:02,364 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7751e+00
[rank1]:2025-10-29 04:44:02,364 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 68.17GiB(48.76%)  tps: 6,942  tflops: 323.79  mfu: 32.74%
[rank1]:2025-10-29 04:44:02,364 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 04:44:02,367 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8792e+00
[rank3]:2025-10-29 04:44:02,369 - INFO -  step: 1200  loss:  0.1061  grad_norm:  0.1122  memory: 76.44GiB(54.68%)  tps: 6,942  tflops: 323.78  mfu: 32.74%
[rank3]:2025-10-29 04:44:02,370 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:44:02,371 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.0730e+00
[rank0]:2025-10-29 04:44:02,371 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 71.50GiB(51.14%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank0]:2025-10-29 04:44:02,371 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 04:44:02,360 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2737e+00
[rank2]:2025-10-29 04:44:02,361 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 61.15GiB(43.74%)  tps: 6,942  tflops: 323.79  mfu: 32.74%
[rank2]:2025-10-29 04:44:02,361 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:44:17,265 - INFO - validate step: 1200  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,503
[rank0]:2025-10-29 04:44:17,265 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:44:17,269 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 04:44:17,308 - INFO - validate step: 1200  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,404
[rank2]:2025-10-29 04:44:17,309 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:44:17,294 - INFO - validate step: 1200  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,435
[rank1]:2025-10-29 04:44:17,295 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:44:17,323 - INFO - validate step: 1200  loss:  0.2650  memory: 76.44GiB(54.68%)  tps: 27,394
[rank3]:2025-10-29 04:44:17,324 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:44:28,195 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.89 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-10-29 04:44:32,758 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.46 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 04:44:33,590 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.27 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 04:44:35,725 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 04:44:35,730 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.46 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 04:44:35,826 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0444_stage2_step1200.svg
[rank2]:2025-10-29 04:44:35,838 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 04:44:35,814 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0444_stage1_step1200.svg
[rank1]:2025-10-29 04:44:35,824 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 04:44:35,860 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0444_stage0_step1200.svg
[rank0]:2025-10-29 04:44:35,867 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:44:35,929 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0444_real_step1200_rank3.svg
[rank3]:> Batch Time: 610.95 ms, GPU Bubble Ratio: 40.61%, 26.08%, 35.99%, 26.39%
[rank3]:2025-10-29 04:44:35,993 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0444_stage3_step1200.svg
[rank3]:2025-10-29 04:44:36,003 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:44:36,487 - INFO - Avg. fwd time: 14.6663 / Avg. bwd time: 39.3501 / Avg. batch time: 447.5976 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-29 04:44:36,532 - INFO - Avg. fwd time: 13.5208 / Avg. bwd time: 31.7168 / Avg. batch time: 495.5963 (ms) / GPU bubble ratio: 26.98%
[rank1]:2025-10-29 04:44:36,582 - INFO - Avg. fwd time: 15.7701 / Avg. bwd time: 36.7672 / Avg. batch time: 550.9554 (ms) / GPU bubble ratio: 23.71%
[rank0]:2025-10-29 04:44:36,615 - INFO - Avg. fwd time: 14.5066 / Avg. bwd time: 31.0652 / Avg. batch time: 599.9140 (ms) / GPU bubble ratio: 39.23%
[rank1]:2025-10-29 04:45:02,904 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.8735e+01
[rank3]:2025-10-29 04:45:02,904 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8877e+01
[rank2]:2025-10-29 04:45:02,901 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6041e+01
[rank0]:2025-10-29 04:45:02,892 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7097e+01
[rank3]:2025-10-29 04:45:25,999 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0250e-01
[rank1]:2025-10-29 04:45:25,996 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.3649e-01
[rank0]:2025-10-29 04:45:25,993 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7989e-01
[rank2]:2025-10-29 04:45:25,993 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4848e-01
[rank3]:2025-10-29 04:45:52,363 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7826e+00
[rank1]:2025-10-29 04:45:52,363 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.9652e-01
[rank0]:2025-10-29 04:45:52,351 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3365e+00
[rank2]:2025-10-29 04:45:52,360 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.8821e-01
[rank2]:2025-10-29 04:46:15,601 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2930e+00
[rank0]:2025-10-29 04:46:15,602 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.4243e-01
[rank3]:2025-10-29 04:46:15,607 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3899e+00
[rank1]:2025-10-29 04:46:15,604 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6875e-01
[rank0]:2025-10-29 04:46:41,446 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank2]:2025-10-29 04:46:44,120 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0758e-01
[rank2]:2025-10-29 04:46:44,120 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 61.15GiB(43.74%)  tps: 5,580  tflops: 260.25  mfu: 26.31%
[rank0]:2025-10-29 04:46:44,111 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.0054e-01
[rank0]:2025-10-29 04:46:44,112 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 72.50GiB(51.86%)  tps: 5,579  tflops: 260.19  mfu: 26.31%
[rank3]:2025-10-29 04:46:44,123 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.1584e-01
[rank3]:2025-10-29 04:46:44,126 - INFO -  step: 1250  loss:  0.8297  grad_norm:  0.3950  memory: 76.44GiB(54.68%)  tps: 5,580  tflops: 260.27  mfu: 26.32%
[rank1]:2025-10-29 04:46:44,123 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5782e-01
[rank1]:2025-10-29 04:46:44,123 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 68.17GiB(48.76%)  tps: 5,579  tflops: 260.22  mfu: 26.31%
[rank3]:2025-10-29 04:46:44,526 - INFO - Avg. fwd time: 14.6873 / Avg. bwd time: 39.3729 / Avg. batch time: 447.9449 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:46:44,604 - INFO - Avg. fwd time: 15.7844 / Avg. bwd time: 36.7886 / Avg. batch time: 551.3822 (ms) / GPU bubble ratio: 23.72%
[rank2]:2025-10-29 04:46:44,559 - INFO - Avg. fwd time: 13.5339 / Avg. bwd time: 31.7347 / Avg. batch time: 495.9979 (ms) / GPU bubble ratio: 26.99%
[rank0]:2025-10-29 04:46:44,608 - INFO - Avg. fwd time: 14.5438 / Avg. bwd time: 30.8329 / Avg. batch time: 600.0696 (ms) / GPU bubble ratio: 39.50%
[rank3]:2025-10-29 04:47:07,310 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4857e+00
[rank1]:2025-10-29 04:47:07,307 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0484e-01
[rank0]:2025-10-29 04:47:07,305 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.9364e-01
[rank2]:2025-10-29 04:47:07,304 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6702e-01
[rank1]:2025-10-29 04:47:33,760 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1786e-01
[rank0]:2025-10-29 04:47:33,748 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.9591e-01
[rank2]:2025-10-29 04:47:33,757 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6371e-01
[rank3]:2025-10-29 04:47:33,760 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9367e-01
[rank0]:2025-10-29 04:47:56,897 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4176e+00
[rank2]:2025-10-29 04:47:56,896 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1653e+00
[rank3]:2025-10-29 04:47:56,903 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1341e+00
[rank1]:2025-10-29 04:47:56,899 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8880e-01
[rank0]:2025-10-29 04:48:23,335 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.8777e-01
[rank3]:2025-10-29 04:48:23,346 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.2372e-01
[rank1]:2025-10-29 04:48:23,346 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3500e-01
[rank2]:2025-10-29 04:48:23,343 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8127e-01
[rank0]:2025-10-29 04:48:44,223 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:48:46,555 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.5401e+00
[rank0]:2025-10-29 04:48:46,556 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 72.50GiB(51.86%)  tps: 6,690  tflops: 312.04  mfu: 31.55%
[rank2]:2025-10-29 04:48:46,555 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.7593e-01
[rank2]:2025-10-29 04:48:46,555 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 61.15GiB(43.74%)  tps: 6,691  tflops: 312.07  mfu: 31.55%
[rank3]:2025-10-29 04:48:46,561 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3058e+00
[rank3]:2025-10-29 04:48:46,564 - INFO -  step: 1300  loss:  0.7279  grad_norm:  0.3157  memory: 76.44GiB(54.68%)  tps: 6,691  tflops: 312.06  mfu: 31.55%
[rank1]:2025-10-29 04:48:46,558 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.9750e-01
[rank1]:2025-10-29 04:48:46,558 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 68.17GiB(48.76%)  tps: 6,691  tflops: 312.07  mfu: 31.55%
[rank1]:2025-10-29 04:48:46,638 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0448_stage1_step1300.svg
[rank0]:2025-10-29 04:48:46,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0448_stage0_step1300.svg
[rank2]:2025-10-29 04:48:46,643 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0448_stage2_step1300.svg
[rank3]:2025-10-29 04:48:46,748 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0448_real_step1300_rank3.svg
[rank3]:> Batch Time: 610.99 ms, GPU Bubble Ratio: 40.64%, 26.06%, 35.99%, 26.37%
[rank3]:2025-10-29 04:48:46,811 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0448_stage3_step1300.svg
[rank3]:2025-10-29 04:48:47,227 - INFO - Avg. fwd time: 14.7124 / Avg. bwd time: 39.3652 / Avg. batch time: 448.0799 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:48:47,325 - INFO - Avg. fwd time: 15.8067 / Avg. bwd time: 36.7798 / Avg. batch time: 551.4907 (ms) / GPU bubble ratio: 23.72%
[rank0]:2025-10-29 04:48:47,321 - INFO - Avg. fwd time: 14.5861 / Avg. bwd time: 30.5749 / Avg. batch time: 599.8786 (ms) / GPU bubble ratio: 39.77%
[rank2]:2025-10-29 04:48:47,278 - INFO - Avg. fwd time: 13.5527 / Avg. bwd time: 31.7138 / Avg. batch time: 496.1091 (ms) / GPU bubble ratio: 27.01%
[rank3]:2025-10-29 04:49:13,106 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.9307e-01
[rank1]:2025-10-29 04:49:13,106 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9941e-01
[rank2]:2025-10-29 04:49:13,103 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3011e-01
[rank0]:2025-10-29 04:49:13,094 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.4556e-01
[rank3]:2025-10-29 04:49:36,305 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2850e+00
[rank1]:2025-10-29 04:49:36,302 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1152e+00
[rank2]:2025-10-29 04:49:36,299 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6877e+00
[rank0]:2025-10-29 04:49:36,299 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8084e+00
[rank3]:2025-10-29 04:50:02,669 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.7733e-01
[rank1]:2025-10-29 04:50:02,669 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1730e-01
[rank2]:2025-10-29 04:50:02,666 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2706e-01
[rank0]:2025-10-29 04:50:02,657 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.6071e-01
[rank1]:2025-10-29 04:50:25,819 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2806e+00
[rank0]:2025-10-29 04:50:25,817 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0854e+00
[rank2]:2025-10-29 04:50:25,816 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6516e+00
[rank3]:2025-10-29 04:50:25,823 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1595e+00
[rank0]:2025-10-29 04:50:49,581 - INFO - [GC] Peforming periodical GC collection 0.06 seconds
[rank1]:2025-10-29 04:50:52,249 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6454e+00
[rank1]:2025-10-29 04:50:52,250 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 68.17GiB(48.76%)  tps: 6,518  tflops: 303.98  mfu: 30.74%
[rank0]:2025-10-29 04:50:52,237 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3150e+00
[rank0]:2025-10-29 04:50:52,238 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 72.50GiB(51.86%)  tps: 6,518  tflops: 304.00  mfu: 30.74%
[rank2]:2025-10-29 04:50:52,246 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4774e-01
[rank2]:2025-10-29 04:50:52,247 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 61.15GiB(43.74%)  tps: 6,518  tflops: 303.98  mfu: 30.74%
[rank3]:2025-10-29 04:50:52,249 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.9937e+00
[rank3]:2025-10-29 04:50:52,252 - INFO -  step: 1350  loss:  0.7557  grad_norm:  0.4068  memory: 76.44GiB(54.68%)  tps: 6,518  tflops: 303.99  mfu: 30.74%
[rank3]:2025-10-29 04:50:52,737 - INFO - Avg. fwd time: 14.7316 / Avg. bwd time: 39.3879 / Avg. batch time: 448.4109 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:50:52,811 - INFO - Avg. fwd time: 15.8221 / Avg. bwd time: 36.8139 / Avg. batch time: 551.9060 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:50:52,843 - INFO - Avg. fwd time: 14.6221 / Avg. bwd time: 30.3454 / Avg. batch time: 600.0242 (ms) / GPU bubble ratio: 40.05%
[rank2]:2025-10-29 04:50:52,772 - INFO - Avg. fwd time: 13.5658 / Avg. bwd time: 31.7341 / Avg. batch time: 496.4819 (ms) / GPU bubble ratio: 27.01%
[rank1]:2025-10-29 04:51:15,361 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0310e-01
[rank0]:2025-10-29 04:51:15,359 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.3822e-01
[rank2]:2025-10-29 04:51:15,358 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.2973e-01
[rank3]:2025-10-29 04:51:15,365 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.5782e-01
[rank1]:2025-10-29 04:51:41,785 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.6019e-01
[rank0]:2025-10-29 04:51:41,773 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.8096e-01
[rank2]:2025-10-29 04:51:41,782 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4651e-01
[rank3]:2025-10-29 04:51:41,785 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9780e-01
[rank3]:2025-10-29 04:52:04,941 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2865e-01
[rank1]:2025-10-29 04:52:04,937 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.6549e-01
[rank0]:2025-10-29 04:52:04,935 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1856e+00
[rank2]:2025-10-29 04:52:04,934 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9297e-01
[rank3]:2025-10-29 04:52:31,280 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5255e+00
[rank1]:2025-10-29 04:52:31,280 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7801e+00
[rank0]:2025-10-29 04:52:31,268 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4211e+00
[rank2]:2025-10-29 04:52:31,276 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.5870e-01
[rank0]:2025-10-29 04:52:52,191 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:52:54,527 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3200e+00
[rank1]:2025-10-29 04:52:54,528 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 68.17GiB(48.76%)  tps: 6,699  tflops: 312.47  mfu: 31.59%
[rank1]:2025-10-29 04:52:54,528 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 04:52:54,524 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8759e+00
[rank2]:2025-10-29 04:52:54,525 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 61.15GiB(43.74%)  tps: 6,699  tflops: 312.47  mfu: 31.59%
[rank0]:2025-10-29 04:52:54,525 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7256e+00
[rank0]:2025-10-29 04:52:54,525 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 72.50GiB(51.86%)  tps: 6,699  tflops: 312.44  mfu: 31.59%
[rank2]:2025-10-29 04:52:54,525 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:52:54,525 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 04:52:54,531 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7737e+00
[rank3]:2025-10-29 04:52:54,534 - INFO -  step: 1400  loss:  0.7800  grad_norm:  0.3576  memory: 76.44GiB(54.68%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank3]:2025-10-29 04:52:54,534 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:53:09,541 - INFO - validate step: 1400  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,279
[rank3]:2025-10-29 04:53:09,602 - INFO - validate step: 1400  loss:  0.2592  memory: 76.44GiB(54.68%)  tps: 27,186
[rank1]:2025-10-29 04:53:09,574 - INFO - validate step: 1400  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,224
[rank2]:2025-10-29 04:53:09,586 - INFO - validate step: 1400  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,196
[rank1]:2025-10-29 04:53:09,683 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0453_stage1_step1400.svg
[rank0]:2025-10-29 04:53:09,690 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0453_stage0_step1400.svg
[rank2]:2025-10-29 04:53:09,688 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0453_stage2_step1400.svg
[rank3]:2025-10-29 04:53:09,789 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0453_real_step1400_rank3.svg
[rank3]:> Batch Time: 611.20 ms, GPU Bubble Ratio: 41.07%, 26.05%, 35.98%, 26.35%
[rank3]:2025-10-29 04:53:09,855 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0453_stage3_step1400.svg
[rank3]:2025-10-29 04:53:10,271 - INFO - Avg. fwd time: 14.7502 / Avg. bwd time: 39.3744 / Avg. batch time: 448.4488 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:53:10,369 - INFO - Avg. fwd time: 15.8390 / Avg. bwd time: 36.7962 / Avg. batch time: 551.8983 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:53:10,364 - INFO - Avg. fwd time: 14.6504 / Avg. bwd time: 30.1509 / Avg. batch time: 599.7879 (ms) / GPU bubble ratio: 40.24%
[rank2]:2025-10-29 04:53:10,321 - INFO - Avg. fwd time: 13.5803 / Avg. bwd time: 31.7081 / Avg. batch time: 496.4901 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 04:53:36,180 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.3639e-01
[rank0]:2025-10-29 04:53:36,168 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8272e-01
[rank2]:2025-10-29 04:53:36,176 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7091e-01
[rank3]:2025-10-29 04:53:36,180 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.5220e-01
[rank3]:2025-10-29 04:53:59,366 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7005e+00
[rank2]:2025-10-29 04:53:59,359 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.9316e-01
[rank0]:2025-10-29 04:53:59,360 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0195e+00
[rank1]:2025-10-29 04:53:59,362 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9562e-01
[rank1]:2025-10-29 04:54:25,823 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4921e-01
[rank2]:2025-10-29 04:54:25,820 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7042e-01
[rank0]:2025-10-29 04:54:25,811 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0140e+00
[rank3]:2025-10-29 04:54:25,823 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.1980e-01
[rank0]:2025-10-29 04:54:48,953 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.1105e-01
[rank2]:2025-10-29 04:54:48,952 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1295e-01
[rank1]:2025-10-29 04:54:48,956 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6290e-01
[rank3]:2025-10-29 04:54:48,959 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5161e-01
[rank0]:2025-10-29 04:55:12,745 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:55:15,408 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8196e-01
[rank3]:2025-10-29 04:55:15,411 - INFO -  step: 1450  loss:  0.8181  grad_norm:  0.4138  memory: 76.44GiB(54.68%)  tps: 6,512  tflops: 303.70  mfu: 30.71%
[rank2]:2025-10-29 04:55:15,405 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2815e-01
[rank2]:2025-10-29 04:55:15,405 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 61.15GiB(43.74%)  tps: 6,511  tflops: 303.67  mfu: 30.71%
[rank0]:2025-10-29 04:55:15,396 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9940e-01
[rank0]:2025-10-29 04:55:15,396 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 72.50GiB(51.86%)  tps: 6,509  tflops: 303.58  mfu: 30.70%
[rank1]:2025-10-29 04:55:15,408 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.8176e-01
[rank1]:2025-10-29 04:55:15,408 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 68.17GiB(48.76%)  tps: 6,510  tflops: 303.64  mfu: 30.70%
[rank3]:2025-10-29 04:55:15,806 - INFO - Avg. fwd time: 14.7689 / Avg. bwd time: 39.3836 / Avg. batch time: 448.6693 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:55:15,838 - INFO - Avg. fwd time: 13.5938 / Avg. bwd time: 31.7113 / Avg. batch time: 496.7317 (ms) / GPU bubble ratio: 27.03%
[rank0]:2025-10-29 04:55:15,888 - INFO - Avg. fwd time: 14.6827 / Avg. bwd time: 29.9478 / Avg. batch time: 599.8093 (ms) / GPU bubble ratio: 40.47%
[rank1]:2025-10-29 04:55:15,883 - INFO - Avg. fwd time: 15.8542 / Avg. bwd time: 36.8092 / Avg. batch time: 552.1559 (ms) / GPU bubble ratio: 23.70%
[rank3]:2025-10-29 04:55:38,563 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3059e-01
[rank2]:2025-10-29 04:55:38,557 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3360e-01
[rank0]:2025-10-29 04:55:38,557 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.6698e-01
[rank1]:2025-10-29 04:55:38,560 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8720e-01
[rank2]:2025-10-29 04:56:04,910 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0554e-01
[rank0]:2025-10-29 04:56:04,901 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.1374e-01
[rank1]:2025-10-29 04:56:04,913 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0954e-01
[rank3]:2025-10-29 04:56:04,913 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6239e-01
[rank2]:2025-10-29 04:56:28,118 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0710e-01
[rank1]:2025-10-29 04:56:28,121 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2917e-01
[rank0]:2025-10-29 04:56:28,119 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.8112e-01
[rank3]:2025-10-29 04:56:28,125 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2975e-01
[rank3]:2025-10-29 04:56:54,434 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.3837e-01
[rank2]:2025-10-29 04:56:54,431 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0230e-01
[rank1]:2025-10-29 04:56:54,434 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.8204e-01
[rank0]:2025-10-29 04:56:54,422 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.0936e-01
[rank0]:2025-10-29 04:57:15,255 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:57:17,564 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.8238e-01
[rank2]:2025-10-29 04:57:17,564 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 61.15GiB(43.74%)  tps: 6,706  tflops: 312.77  mfu: 31.62%
[rank1]:2025-10-29 04:57:17,567 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.0232e-01
[rank1]:2025-10-29 04:57:17,567 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 68.17GiB(48.76%)  tps: 6,706  tflops: 312.77  mfu: 31.62%
[rank0]:2025-10-29 04:57:17,565 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.3729e-01
[rank0]:2025-10-29 04:57:17,565 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 72.50GiB(51.86%)  tps: 6,705  tflops: 312.75  mfu: 31.62%
[rank3]:2025-10-29 04:57:17,570 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6230e+00
[rank3]:2025-10-29 04:57:17,573 - INFO -  step: 1500  loss:  0.7121  grad_norm:  0.2970  memory: 76.44GiB(54.68%)  tps: 6,706  tflops: 312.76  mfu: 31.62%
[rank2]:2025-10-29 04:57:17,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0457_stage2_step1500.svg
[rank1]:2025-10-29 04:57:17,653 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0457_stage1_step1500.svg
[rank0]:2025-10-29 04:57:17,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0457_stage0_step1500.svg
[rank3]:2025-10-29 04:57:17,754 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0457_real_step1500_rank3.svg
[rank3]:> Batch Time: 611.34 ms, GPU Bubble Ratio: 41.44%, 26.04%, 35.97%, 26.33%
[rank3]:2025-10-29 04:57:17,818 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0457_stage3_step1500.svg
[rank3]:2025-10-29 04:57:18,322 - INFO - Avg. fwd time: 14.7886 / Avg. bwd time: 39.3649 / Avg. batch time: 448.6739 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:57:18,368 - INFO - Avg. fwd time: 13.6096 / Avg. bwd time: 31.6780 / Avg. batch time: 496.7192 (ms) / GPU bubble ratio: 27.06%
[rank1]:2025-10-29 04:57:18,418 - INFO - Avg. fwd time: 15.8717 / Avg. bwd time: 36.7842 / Avg. batch time: 552.1223 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:57:18,452 - INFO - Avg. fwd time: 14.7124 / Avg. bwd time: 29.7496 / Avg. batch time: 599.5433 (ms) / GPU bubble ratio: 40.67%
[rank2]:2025-10-29 04:57:44,204 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5424e-01
[rank1]:2025-10-29 04:57:44,207 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2176e+00
[rank0]:2025-10-29 04:57:44,196 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4687e+00
[rank3]:2025-10-29 04:57:44,208 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2996e+00
[rank3]:2025-10-29 04:58:07,297 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6842e+00
[rank2]:2025-10-29 04:58:07,291 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6607e+00
[rank1]:2025-10-29 04:58:07,294 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3571e+00
[rank0]:2025-10-29 04:58:07,291 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9609e+00
[rank3]:2025-10-29 04:58:33,698 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.1982e-02
[rank2]:2025-10-29 04:58:33,695 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.3551e-02
[rank1]:2025-10-29 04:58:33,698 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6333e-01
[rank0]:2025-10-29 04:58:33,686 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3495e-01
[rank3]:2025-10-29 04:58:56,824 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2985e+00
[rank2]:2025-10-29 04:58:56,817 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1381e+00
[rank1]:2025-10-29 04:58:56,820 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6205e-01
[rank0]:2025-10-29 04:58:56,818 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1175e+00
[rank0]:2025-10-29 04:59:20,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:59:23,155 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.9971e-01
[rank3]:2025-10-29 04:59:23,157 - INFO -  step: 1550  loss:  0.7551  grad_norm:  0.4402  memory: 76.44GiB(54.68%)  tps: 6,523  tflops: 304.24  mfu: 30.76%
[rank2]:2025-10-29 04:59:23,152 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0984e-01
[rank2]:2025-10-29 04:59:23,152 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 61.15GiB(43.74%)  tps: 6,523  tflops: 304.23  mfu: 30.76%
[rank1]:2025-10-29 04:59:23,155 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6108e-01
[rank1]:2025-10-29 04:59:23,155 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 68.17GiB(48.76%)  tps: 6,523  tflops: 304.23  mfu: 30.76%
[rank0]:2025-10-29 04:59:23,143 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5697e+00
[rank0]:2025-10-29 04:59:23,143 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 72.50GiB(51.86%)  tps: 6,523  tflops: 304.25  mfu: 30.76%
[rank3]:2025-10-29 04:59:23,554 - INFO - Avg. fwd time: 14.8018 / Avg. bwd time: 39.3789 / Avg. batch time: 448.8894 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:59:23,587 - INFO - Avg. fwd time: 13.6189 / Avg. bwd time: 31.6895 / Avg. batch time: 496.9443 (ms) / GPU bubble ratio: 27.06%
[rank1]:2025-10-29 04:59:23,632 - INFO - Avg. fwd time: 15.8826 / Avg. bwd time: 36.8043 / Avg. batch time: 552.3738 (ms) / GPU bubble ratio: 23.69%
[rank0]:2025-10-29 04:59:23,636 - INFO - Avg. fwd time: 14.7360 / Avg. bwd time: 29.6000 / Avg. batch time: 599.6170 (ms) / GPU bubble ratio: 40.85%
[rank3]:2025-10-29 04:59:46,361 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5656e+00
[rank2]:2025-10-29 04:59:46,355 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1808e+00
[rank1]:2025-10-29 04:59:46,358 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.7637e-01
[rank0]:2025-10-29 04:59:46,356 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8134e+00
[rank3]:2025-10-29 05:00:12,697 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.6693e-01
[rank2]:2025-10-29 05:00:12,693 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0890e-01
[rank1]:2025-10-29 05:00:12,696 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6039e-01
[rank0]:2025-10-29 05:00:12,684 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0473e-01
[rank3]:2025-10-29 05:00:35,834 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6658e-01
[rank2]:2025-10-29 05:00:35,828 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3804e-01
[rank0]:2025-10-29 05:00:35,829 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.2585e-01
[rank1]:2025-10-29 05:00:35,831 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4513e-01
[rank3]:2025-10-29 05:01:02,055 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.1829e+00
[rank2]:2025-10-29 05:01:02,052 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0582e+00
[rank0]:2025-10-29 05:01:02,043 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.4141e+00
[rank1]:2025-10-29 05:01:02,055 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1371e+00
[rank0]:2025-10-29 05:01:21,952 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:01:24,208 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6709e+00
[rank3]:2025-10-29 05:01:24,211 - INFO -  step: 1600  loss:  0.1174  grad_norm:  0.2399  memory: 76.44GiB(54.68%)  tps: 6,767  tflops: 315.63  mfu: 31.91%
[rank3]:2025-10-29 05:01:24,211 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:01:24,202 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1289e+00
[rank0]:2025-10-29 05:01:24,202 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 72.50GiB(51.86%)  tps: 6,767  tflops: 315.61  mfu: 31.91%
[rank2]:2025-10-29 05:01:24,201 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9576e+00
[rank2]:2025-10-29 05:01:24,201 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 61.15GiB(43.74%)  tps: 6,768  tflops: 315.64  mfu: 31.91%
[rank0]:2025-10-29 05:01:24,202 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 05:01:24,201 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:01:24,204 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1439e-01
[rank1]:2025-10-29 05:01:24,205 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 68.17GiB(48.76%)  tps: 6,767  tflops: 315.64  mfu: 31.91%
[rank1]:2025-10-29 05:01:24,205 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 05:01:39,194 - INFO - validate step: 1600  loss:  0.2597  memory: 76.44GiB(54.68%)  tps: 27,338
[rank0]:2025-10-29 05:01:39,139 - INFO - validate step: 1600  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,423
[rank2]:2025-10-29 05:01:39,181 - INFO - validate step: 1600  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,344
[rank1]:2025-10-29 05:01:39,168 - INFO - validate step: 1600  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,375
[rank0]:2025-10-29 05:01:39,286 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0501_stage0_step1600.svg
[rank2]:2025-10-29 05:01:39,285 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0501_stage2_step1600.svg
[rank1]:2025-10-29 05:01:39,278 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0501_stage1_step1600.svg
[rank3]:2025-10-29 05:01:39,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0501_real_step1600_rank3.svg
[rank3]:> Batch Time: 611.10 ms, GPU Bubble Ratio: 41.67%, 25.99%, 35.96%, 26.29%
[rank3]:2025-10-29 05:01:39,450 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0501_stage3_step1600.svg
[rank3]:2025-10-29 05:01:39,846 - INFO - Avg. fwd time: 14.8141 / Avg. bwd time: 39.3673 / Avg. batch time: 448.8913 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:01:39,894 - INFO - Avg. fwd time: 13.6280 / Avg. bwd time: 31.6708 / Avg. batch time: 496.9203 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-29 05:01:39,938 - INFO - Avg. fwd time: 14.7581 / Avg. bwd time: 29.4275 / Avg. batch time: 599.3783 (ms) / GPU bubble ratio: 41.02%
[rank1]:2025-10-29 05:01:39,942 - INFO - Avg. fwd time: 15.8937 / Avg. bwd time: 36.7937 / Avg. batch time: 552.3413 (ms) / GPU bubble ratio: 23.69%
[rank0]:2025-10-29 05:02:04,521 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1231e+00
[rank2]:2025-10-29 05:02:04,530 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0402e-01
[rank1]:2025-10-29 05:02:04,533 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5411e+00
[rank3]:2025-10-29 05:02:04,533 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8047e+00
[rank3]:2025-10-29 05:02:26,690 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7415e+00
[rank1]:2025-10-29 05:02:26,687 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5575e+00
[rank2]:2025-10-29 05:02:26,684 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5096e+00
[rank0]:2025-10-29 05:02:26,684 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.6016e+00
[rank3]:2025-10-29 05:02:51,927 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.1043e-01
[rank1]:2025-10-29 05:02:51,927 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0939e-01
[rank0]:2025-10-29 05:02:51,915 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6242e-01
[rank2]:2025-10-29 05:02:51,924 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0127e-01
[rank3]:2025-10-29 05:03:13,935 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6099e+00
[rank1]:2025-10-29 05:03:13,931 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8956e+00
[rank0]:2025-10-29 05:03:13,929 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.2488e+00
[rank2]:2025-10-29 05:03:13,928 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7830e+00
[rank0]:2025-10-29 05:03:36,822 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:03:39,363 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.6564e+00
[rank3]:2025-10-29 05:03:39,366 - INFO -  step: 1650  loss:  0.0930  grad_norm:  0.1580  memory: 76.44GiB(54.68%)  tps: 6,817  tflops: 317.95  mfu: 32.15%
[rank1]:2025-10-29 05:03:39,363 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.4762e-01
[rank1]:2025-10-29 05:03:39,363 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 68.17GiB(48.76%)  tps: 6,816  tflops: 317.88  mfu: 32.14%
[rank2]:2025-10-29 05:03:39,360 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9389e-01
[rank2]:2025-10-29 05:03:39,360 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 61.15GiB(43.74%)  tps: 6,817  tflops: 317.92  mfu: 32.15%
[rank0]:2025-10-29 05:03:39,351 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6715e+00
[rank0]:2025-10-29 05:03:39,351 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 72.50GiB(51.86%)  tps: 6,815  tflops: 317.84  mfu: 32.14%
[rank3]:2025-10-29 05:03:39,818 - INFO - Avg. fwd time: 14.8024 / Avg. bwd time: 39.3562 / Avg. batch time: 448.7015 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:03:39,894 - INFO - Avg. fwd time: 15.8820 / Avg. bwd time: 36.8027 / Avg. batch time: 552.1601 (ms) / GPU bubble ratio: 23.67%
[rank2]:2025-10-29 05:03:39,854 - INFO - Avg. fwd time: 13.6183 / Avg. bwd time: 31.6733 / Avg. batch time: 496.7342 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:03:39,928 - INFO - Avg. fwd time: 14.7608 / Avg. bwd time: 29.2663 / Avg. batch time: 598.9952 (ms) / GPU bubble ratio: 41.20%
[rank3]:2025-10-29 05:04:01,313 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7581e+00
[rank1]:2025-10-29 05:04:01,310 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6905e+00
[rank2]:2025-10-29 05:04:01,306 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2382e+00
[rank0]:2025-10-29 05:04:01,307 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.7390e+00
[rank3]:2025-10-29 05:04:26,620 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8298e-01
[rank1]:2025-10-29 05:04:26,620 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3337e+00
[rank2]:2025-10-29 05:04:26,617 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1607e-01
[rank0]:2025-10-29 05:04:26,608 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6808e+00
[rank3]:2025-10-29 05:04:48,728 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8536e+00
[rank1]:2025-10-29 05:04:48,724 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6981e+00
[rank0]:2025-10-29 05:04:48,722 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.4101e+00
[rank2]:2025-10-29 05:04:48,721 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4771e+00
[rank2]:2025-10-29 05:05:13,895 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.7731e-01
[rank0]:2025-10-29 05:05:13,886 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.9576e-01
[rank3]:2025-10-29 05:05:13,898 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6213e+00
[rank1]:2025-10-29 05:05:13,898 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.7909e-01
[rank0]:2025-10-29 05:05:33,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:05:36,054 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9743e-01
[rank3]:2025-10-29 05:05:36,057 - INFO -  step: 1700  loss:  0.0976  grad_norm:  0.1111  memory: 76.44GiB(54.68%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank1]:2025-10-29 05:05:36,051 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.2503e-01
[rank1]:2025-10-29 05:05:36,051 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 68.17GiB(48.76%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank2]:2025-10-29 05:05:36,048 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.8981e-01
[rank2]:2025-10-29 05:05:36,048 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 61.15GiB(43.74%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank0]:2025-10-29 05:05:36,048 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1474e+00
[rank0]:2025-10-29 05:05:36,049 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 72.50GiB(51.86%)  tps: 7,020  tflops: 327.41  mfu: 33.10%
[rank1]:2025-10-29 05:05:36,134 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0505_stage1_step1700.svg
[rank2]:2025-10-29 05:05:36,144 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0505_stage2_step1700.svg
[rank0]:2025-10-29 05:05:36,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0505_stage0_step1700.svg
[rank3]:2025-10-29 05:05:36,245 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0505_real_step1700_rank3.svg
[rank3]:> Batch Time: 606.20 ms, GPU Bubble Ratio: 46.41%, 25.43%, 35.46%, 25.75%
[rank3]:2025-10-29 05:05:36,311 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0505_stage3_step1700.svg
[rank3]:2025-10-29 05:05:36,697 - INFO - Avg. fwd time: 14.7947 / Avg. bwd time: 39.3210 / Avg. batch time: 448.3522 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:05:36,791 - INFO - Avg. fwd time: 15.8754 / Avg. bwd time: 36.7746 / Avg. batch time: 551.7278 (ms) / GPU bubble ratio: 23.66%
[rank2]:2025-10-29 05:05:36,745 - INFO - Avg. fwd time: 13.6136 / Avg. bwd time: 31.6413 / Avg. batch time: 496.3365 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:05:36,789 - INFO - Avg. fwd time: 14.7630 / Avg. bwd time: 29.1273 / Avg. batch time: 598.3879 (ms) / GPU bubble ratio: 41.32%
[rank3]:2025-10-29 05:06:01,516 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.5261e+00
[rank1]:2025-10-29 05:06:01,517 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.9948e+00
[rank0]:2025-10-29 05:06:01,504 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4454e+00
[rank2]:2025-10-29 05:06:01,513 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3792e+00
[rank3]:2025-10-29 05:06:23,544 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.8973e-01
[rank1]:2025-10-29 05:06:23,541 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4490e+00
[rank0]:2025-10-29 05:06:23,538 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8951e+00
[rank2]:2025-10-29 05:06:23,537 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0582e+00
[rank3]:2025-10-29 05:06:48,959 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.9667e-01
[rank1]:2025-10-29 05:06:48,959 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6268e-01
[rank2]:2025-10-29 05:06:48,955 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9654e-01
[rank0]:2025-10-29 05:06:48,947 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5079e-01
[rank3]:2025-10-29 05:07:10,880 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8915e+00
[rank1]:2025-10-29 05:07:10,877 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9096e+00
[rank0]:2025-10-29 05:07:10,875 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7272e+00
[rank2]:2025-10-29 05:07:10,874 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1087e+00
[rank0]:2025-10-29 05:07:33,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:07:36,169 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7409e+00
[rank3]:2025-10-29 05:07:36,174 - INFO -  step: 1750  loss:  0.1049  grad_norm:  0.1153  memory: 76.44GiB(54.68%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank1]:2025-10-29 05:07:36,169 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1058e+00
[rank1]:2025-10-29 05:07:36,169 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 68.17GiB(48.76%)  tps: 6,820  tflops: 318.08  mfu: 32.16%
[rank2]:2025-10-29 05:07:36,166 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.1102e-01
[rank2]:2025-10-29 05:07:36,166 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 61.15GiB(43.74%)  tps: 6,820  tflops: 318.08  mfu: 32.16%
[rank0]:2025-10-29 05:07:36,157 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1518e+00
[rank0]:2025-10-29 05:07:36,158 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 72.50GiB(51.86%)  tps: 6,820  tflops: 318.11  mfu: 32.16%
[rank3]:2025-10-29 05:07:36,538 - INFO - Avg. fwd time: 14.7851 / Avg. bwd time: 39.3025 / Avg. batch time: 448.1205 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:07:36,615 - INFO - Avg. fwd time: 15.8665 / Avg. bwd time: 36.7711 / Avg. batch time: 551.4777 (ms) / GPU bubble ratio: 23.64%
[rank2]:2025-10-29 05:07:36,569 - INFO - Avg. fwd time: 13.6060 / Avg. bwd time: 31.6320 / Avg. batch time: 496.0954 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 05:07:36,620 - INFO - Avg. fwd time: 14.7649 / Avg. bwd time: 28.9812 / Avg. batch time: 597.9512 (ms) / GPU bubble ratio: 41.47%
[rank3]:2025-10-29 05:07:58,284 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5755e+00
[rank1]:2025-10-29 05:07:58,280 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.0399e-01
[rank2]:2025-10-29 05:07:58,277 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9533e+00
[rank0]:2025-10-29 05:07:58,278 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.5582e-01
[rank3]:2025-10-29 05:08:23,443 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.6274e-01
[rank1]:2025-10-29 05:08:23,442 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.8784e-01
[rank2]:2025-10-29 05:08:23,439 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8146e-01
[rank0]:2025-10-29 05:08:23,430 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3909e-01
[rank3]:2025-10-29 05:08:45,576 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9401e+00
[rank1]:2025-10-29 05:08:45,572 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0908e+00
[rank0]:2025-10-29 05:08:45,570 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4284e+00
[rank2]:2025-10-29 05:08:45,569 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2826e+00
[rank3]:2025-10-29 05:09:10,787 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.1211e+00
[rank0]:2025-10-29 05:09:10,775 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2158e+00
[rank2]:2025-10-29 05:09:10,784 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0385e-01
[rank1]:2025-10-29 05:09:10,787 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9838e+00
[rank0]:2025-10-29 05:09:30,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:09:32,764 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0766e+00
[rank3]:2025-10-29 05:09:32,767 - INFO -  step: 1800  loss:  0.0838  grad_norm:  0.0804  memory: 76.44GiB(54.68%)  tps: 7,026  tflops: 327.70  mfu: 33.13%
[rank3]:2025-10-29 05:09:32,767 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 05:09:32,760 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2194e+00
[rank1]:2025-10-29 05:09:32,761 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 68.17GiB(48.76%)  tps: 7,026  tflops: 327.71  mfu: 33.14%
[rank0]:2025-10-29 05:09:32,758 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0081e+00
[rank0]:2025-10-29 05:09:32,759 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 72.50GiB(51.86%)  tps: 7,026  tflops: 327.68  mfu: 33.13%
[rank1]:2025-10-29 05:09:32,761 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:09:32,757 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4140e-01
[rank0]:2025-10-29 05:09:32,759 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:09:32,758 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 61.15GiB(43.74%)  tps: 7,026  tflops: 327.71  mfu: 33.14%
[rank2]:2025-10-29 05:09:32,758 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:09:47,781 - INFO - validate step: 1800  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,267
[rank1]:2025-10-29 05:09:47,811 - INFO - validate step: 1800  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,215
[rank2]:2025-10-29 05:09:47,825 - INFO - validate step: 1800  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,185
[rank3]:2025-10-29 05:09:47,840 - INFO - validate step: 1800  loss:  0.2578  memory: 76.44GiB(54.68%)  tps: 27,176
[rank0]:2025-10-29 05:09:47,931 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0509_stage0_step1800.svg
[rank1]:2025-10-29 05:09:47,920 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0509_stage1_step1800.svg
[rank2]:2025-10-29 05:09:47,929 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0509_stage2_step1800.svg
[rank3]:2025-10-29 05:09:48,028 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0509_real_step1800_rank3.svg
[rank3]:> Batch Time: 605.88 ms, GPU Bubble Ratio: 46.46%, 25.41%, 35.43%, 25.75%
[rank3]:2025-10-29 05:09:48,093 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0509_stage3_step1800.svg
[rank3]:2025-10-29 05:09:48,569 - INFO - Avg. fwd time: 14.7770 / Avg. bwd time: 39.2617 / Avg. batch time: 447.7225 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:09:48,615 - INFO - Avg. fwd time: 13.6010 / Avg. bwd time: 31.5928 / Avg. batch time: 495.6565 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:09:48,702 - INFO - Avg. fwd time: 14.7667 / Avg. bwd time: 28.8357 / Avg. batch time: 597.2862 (ms) / GPU bubble ratio: 41.60%
[rank1]:2025-10-29 05:09:48,667 - INFO - Avg. fwd time: 15.8593 / Avg. bwd time: 36.7360 / Avg. batch time: 550.9962 (ms) / GPU bubble ratio: 23.64%
[rank3]:2025-10-29 05:10:13,493 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0643e+00
[rank2]:2025-10-29 05:10:13,489 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.5275e-01
[rank1]:2025-10-29 05:10:13,493 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5273e+00
[rank0]:2025-10-29 05:10:13,481 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.8276e+00
[rank3]:2025-10-29 05:10:35,407 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9045e+00
[rank0]:2025-10-29 05:10:35,401 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.5235e+00
[rank2]:2025-10-29 05:10:35,400 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6958e+00
[rank1]:2025-10-29 05:10:35,404 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2297e+00
[rank3]:2025-10-29 05:11:00,678 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.1843e+00
[rank2]:2025-10-29 05:11:00,674 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6123e+00
[rank0]:2025-10-29 05:11:00,666 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1593e-01
[rank1]:2025-10-29 05:11:00,678 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.7905e-01
[rank3]:2025-10-29 05:11:22,802 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5105e+00
[rank2]:2025-10-29 05:11:22,795 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4990e+00
[rank0]:2025-10-29 05:11:22,796 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.6117e+00
[rank1]:2025-10-29 05:11:22,799 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2152e-01
[rank0]:2025-10-29 05:11:45,389 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:11:47,925 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.9733e-01
[rank3]:2025-10-29 05:11:47,928 - INFO -  step: 1850  loss:  0.0669  grad_norm:  0.0978  memory: 76.44GiB(54.68%)  tps: 6,822  tflops: 318.17  mfu: 32.17%
[rank2]:2025-10-29 05:11:47,922 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.9803e-01
[rank2]:2025-10-29 05:11:47,923 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 61.15GiB(43.74%)  tps: 6,821  tflops: 318.14  mfu: 32.17%
[rank0]:2025-10-29 05:11:47,913 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.8788e-01
[rank0]:2025-10-29 05:11:47,914 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 72.50GiB(51.86%)  tps: 6,819  tflops: 318.05  mfu: 32.16%
[rank1]:2025-10-29 05:11:47,925 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5908e-01
[rank1]:2025-10-29 05:11:47,926 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 68.17GiB(48.76%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank3]:2025-10-29 05:11:48,299 - INFO - Avg. fwd time: 14.7688 / Avg. bwd time: 39.2531 / Avg. batch time: 447.5825 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:11:48,331 - INFO - Avg. fwd time: 13.5944 / Avg. bwd time: 31.5930 / Avg. batch time: 495.5033 (ms) / GPU bubble ratio: 27.04%
[rank0]:2025-10-29 05:11:48,380 - INFO - Avg. fwd time: 14.7673 / Avg. bwd time: 28.7253 / Avg. batch time: 596.9924 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 05:11:48,375 - INFO - Avg. fwd time: 15.8512 / Avg. bwd time: 36.7404 / Avg. batch time: 550.8437 (ms) / GPU bubble ratio: 23.62%
[rank1]:2025-10-29 05:12:10,032 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6154e+00
[rank2]:2025-10-29 05:12:10,029 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5309e+00
[rank0]:2025-10-29 05:12:10,030 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0051e+00
[rank3]:2025-10-29 05:12:10,036 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3353e+00
[rank1]:2025-10-29 05:12:35,277 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0977e+00
[rank2]:2025-10-29 05:12:35,274 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2829e+00
[rank0]:2025-10-29 05:12:35,265 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.3799e+00
[rank3]:2025-10-29 05:12:35,277 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.4062e+00
[rank1]:2025-10-29 05:12:57,287 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2323e+00
[rank0]:2025-10-29 05:12:57,284 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3214e+00
[rank2]:2025-10-29 05:12:57,284 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9642e+00
[rank3]:2025-10-29 05:12:57,290 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8647e+00
[rank1]:2025-10-29 05:13:22,680 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4970e-01
[rank0]:2025-10-29 05:13:22,668 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0613e+00
[rank2]:2025-10-29 05:13:22,677 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7920e-01
[rank3]:2025-10-29 05:13:22,680 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5778e-01
[rank0]:2025-10-29 05:13:42,409 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:13:44,636 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4180e+00
[rank1]:2025-10-29 05:13:44,637 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 68.17GiB(48.76%)  tps: 7,019  tflops: 327.37  mfu: 33.10%
[rank0]:2025-10-29 05:13:44,634 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.2149e-01
[rank0]:2025-10-29 05:13:44,634 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 72.50GiB(51.86%)  tps: 7,018  tflops: 327.34  mfu: 33.10%
[rank2]:2025-10-29 05:13:44,633 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5642e+00
[rank2]:2025-10-29 05:13:44,634 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 61.15GiB(43.74%)  tps: 7,019  tflops: 327.37  mfu: 33.10%
[rank3]:2025-10-29 05:13:44,640 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3463e+00
[rank3]:2025-10-29 05:13:44,642 - INFO -  step: 1900  loss:  0.0845  grad_norm:  0.0948  memory: 76.44GiB(54.68%)  tps: 7,019  tflops: 327.36  mfu: 33.10%
[rank1]:2025-10-29 05:13:44,724 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0513_stage1_step1900.svg
[rank0]:2025-10-29 05:13:44,732 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0513_stage0_step1900.svg
[rank2]:2025-10-29 05:13:44,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0513_stage2_step1900.svg
[rank3]:2025-10-29 05:13:44,832 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0513_real_step1900_rank3.svg
[rank3]:> Batch Time: 605.31 ms, GPU Bubble Ratio: 46.46%, 25.39%, 35.40%, 25.76%
[rank3]:2025-10-29 05:13:44,900 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0513_stage3_step1900.svg
[rank2]:2025-10-29 05:13:45,342 - INFO - Avg. fwd time: 13.5893 / Avg. bwd time: 31.5692 / Avg. batch time: 495.1712 (ms) / GPU bubble ratio: 27.04%
[rank3]:2025-10-29 05:13:45,294 - INFO - Avg. fwd time: 14.7606 / Avg. bwd time: 39.2254 / Avg. batch time: 447.2901 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:13:45,389 - INFO - Avg. fwd time: 15.8438 / Avg. bwd time: 36.7210 / Avg. batch time: 550.4847 (ms) / GPU bubble ratio: 23.61%
[rank0]:2025-10-29 05:13:45,386 - INFO - Avg. fwd time: 14.7683 / Avg. bwd time: 28.5975 / Avg. batch time: 596.4709 (ms) / GPU bubble ratio: 41.84%
[rank1]:2025-10-29 05:14:10,131 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6865e-01
[rank3]:2025-10-29 05:14:10,131 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.3803e-01
[rank0]:2025-10-29 05:14:10,119 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7186e-01
[rank2]:2025-10-29 05:14:10,128 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8127e-01
[rank1]:2025-10-29 05:14:32,214 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8310e-01
[rank3]:2025-10-29 05:14:32,217 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6373e+00
[rank2]:2025-10-29 05:14:32,210 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.5271e-01
[rank0]:2025-10-29 05:14:32,211 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.0744e-01
[rank1]:2025-10-29 05:14:57,376 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.9630e-01
[rank3]:2025-10-29 05:14:57,375 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8965e+00
[rank0]:2025-10-29 05:14:57,363 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.3481e-01
[rank2]:2025-10-29 05:14:57,372 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.4492e-01
[rank1]:2025-10-29 05:15:19,495 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0940e+00
[rank3]:2025-10-29 05:15:19,498 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1267e+00
[rank2]:2025-10-29 05:15:19,492 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8021e+00
[rank0]:2025-10-29 05:15:19,492 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8625e-01
[rank0]:2025-10-29 05:15:42,162 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:15:44,742 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.0011e+00
[rank1]:2025-10-29 05:15:44,742 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7385e+00
[rank1]:2025-10-29 05:15:44,743 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 68.17GiB(48.76%)  tps: 6,821  tflops: 318.12  mfu: 32.17%
[rank0]:2025-10-29 05:15:44,730 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8543e+00
[rank0]:2025-10-29 05:15:44,730 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 72.50GiB(51.86%)  tps: 6,821  tflops: 318.14  mfu: 32.17%
[rank2]:2025-10-29 05:15:44,739 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.4034e-01
[rank2]:2025-10-29 05:15:44,739 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 61.15GiB(43.74%)  tps: 6,821  tflops: 318.12  mfu: 32.17%
[rank3]:2025-10-29 05:15:44,745 - INFO -  step: 1950  loss:  0.1077  grad_norm:  0.1458  memory: 76.44GiB(54.68%)  tps: 6,821  tflops: 318.13  mfu: 32.17%
[rank3]:2025-10-29 05:15:45,212 - INFO - Avg. fwd time: 14.7518 / Avg. bwd time: 39.2207 / Avg. batch time: 447.1761 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:15:45,250 - INFO - Avg. fwd time: 13.5822 / Avg. bwd time: 31.5745 / Avg. batch time: 495.0649 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 05:15:45,292 - INFO - Avg. fwd time: 15.8352 / Avg. bwd time: 36.7314 / Avg. batch time: 550.3871 (ms) / GPU bubble ratio: 23.59%
[rank0]:2025-10-29 05:15:45,327 - INFO - Avg. fwd time: 14.7694 / Avg. bwd time: 28.4834 / Avg. batch time: 596.2271 (ms) / GPU bubble ratio: 41.96%
[rank3]:2025-10-29 05:16:06,757 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3563e+00
[rank1]:2025-10-29 05:16:06,754 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7576e+00
[rank0]:2025-10-29 05:16:06,751 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7761e+00
[rank2]:2025-10-29 05:16:06,751 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7989e+00
[rank3]:2025-10-29 05:16:32,148 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.7330e+00
[rank1]:2025-10-29 05:16:32,148 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.1477e+00
[rank2]:2025-10-29 05:16:32,144 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4850e+00
[rank0]:2025-10-29 05:16:32,136 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7637e+00
[rank3]:2025-10-29 05:16:54,040 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0687e+01
[rank1]:2025-10-29 05:16:54,037 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1513e+01
[rank0]:2025-10-29 05:16:54,034 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0412e+01
[rank2]:2025-10-29 05:16:54,033 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.0745e+01
[rank3]:2025-10-29 05:17:14,977 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.9964e+00
[rank1]:2025-10-29 05:17:14,980 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3327e+00
[rank0]:2025-10-29 05:17:14,974 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3163e+00
[rank2]:2025-10-29 05:17:14,973 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8873e+00
[rank0]:2025-10-29 05:17:34,840 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:17:37,090 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.0209e-01
[rank3]:2025-10-29 05:17:37,092 - INFO -  step: 2000  loss:  0.0941  grad_norm:  0.1235  memory: 78.44GiB(56.10%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank3]:2025-10-29 05:17:37,092 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 05:17:37,087 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 1.6058e+00
[rank1]:2025-10-29 05:17:37,087 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 68.17GiB(48.76%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank1]:2025-10-29 05:17:37,087 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 05:17:37,083 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.4478e+00
[rank2]:2025-10-29 05:17:37,084 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 62.11GiB(44.42%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank2]:2025-10-29 05:17:37,084 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 05:17:37,084 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5629e-01
[rank0]:2025-10-29 05:17:37,084 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 73.46GiB(52.54%)  tps: 7,291  tflops: 340.07  mfu: 34.38%
[rank0]:2025-10-29 05:17:37,084 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 05:17:53,434 - INFO - validate step: 2000  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 25,057
[rank2]:2025-10-29 05:17:53,449 - INFO - validate step: 2000  loss: -1.0000  memory: 62.11GiB(44.42%)  tps: 25,029
[rank0]:2025-10-29 05:17:53,399 - INFO - validate step: 2000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,106
[rank3]:2025-10-29 05:17:53,463 - INFO - validate step: 2000  loss:  0.2593  memory: 78.44GiB(56.10%)  tps: 25,021
[rank1]:2025-10-29 05:17:53,550 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0517_stage1_step2000.svg
[rank2]:2025-10-29 05:17:53,557 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0517_stage2_step2000.svg
[rank0]:2025-10-29 05:17:53,551 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0517_stage0_step2000.svg
[rank3]:2025-10-29 05:17:53,654 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0517_real_step2000_rank3.svg
[rank3]:> Batch Time: 604.59 ms, GPU Bubble Ratio: 46.44%, 25.36%, 35.35%, 25.77%
[rank3]:2025-10-29 05:17:53,732 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0517_stage3_step2000.svg
[rank3]:2025-10-29 05:17:54,048 - INFO - Avg. fwd time: 14.7530 / Avg. bwd time: 39.1299 / Avg. batch time: 446.4549 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 05:17:54,117 - INFO - Avg. fwd time: 15.8359 / Avg. bwd time: 36.6577 / Avg. batch time: 549.5513 (ms) / GPU bubble ratio: 23.58%
[rank2]:2025-10-29 05:17:54,082 - INFO - Avg. fwd time: 13.5860 / Avg. bwd time: 31.4854 / Avg. batch time: 494.2408 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 05:17:54,125 - INFO - Avg. fwd time: 14.7725 / Avg. bwd time: 28.3580 / Avg. batch time: 595.2370 (ms) / GPU bubble ratio: 42.03%
[rank3]:2025-10-29 05:18:13,904 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2409e+00
[rank1]:2025-10-29 05:18:13,904 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.7502e-01
[rank2]:2025-10-29 05:18:13,901 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0815e-01
[rank0]:2025-10-29 05:18:13,901 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0091e+00
[rank3]:2025-10-29 05:18:36,059 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1042e-01
[rank1]:2025-10-29 05:18:36,056 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 6.2703e-01
[rank2]:2025-10-29 05:18:36,052 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 4.2949e-01
[rank0]:2025-10-29 05:18:36,053 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3836e-02
[rank3]:2025-10-29 05:18:56,294 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9513e-01
[rank1]:2025-10-29 05:18:56,294 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.9671e-01
[rank0]:2025-10-29 05:18:56,291 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2126e+00
[rank2]:2025-10-29 05:18:56,290 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.4104e-01
[rank3]:2025-10-29 05:19:18,317 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.6308e-01
[rank1]:2025-10-29 05:19:18,314 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 1.2839e+00
[rank0]:2025-10-29 05:19:18,311 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.6382e-01
[rank2]:2025-10-29 05:19:18,310 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.2661e+00
[rank0]:2025-10-29 05:19:36,692 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:19:38,735 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.9449e+00
[rank1]:2025-10-29 05:19:38,734 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.6292e-01
[rank1]:2025-10-29 05:19:38,735 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 69.16GiB(49.47%)  tps: 7,780  tflops: 362.84  mfu: 36.69%
[rank0]:2025-10-29 05:19:38,732 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5814e+00
[rank0]:2025-10-29 05:19:38,732 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 73.46GiB(52.54%)  tps: 7,777  tflops: 362.73  mfu: 36.68%
[rank2]:2025-10-29 05:19:38,731 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1799e+00
[rank2]:2025-10-29 05:19:38,732 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 62.11GiB(44.42%)  tps: 7,781  tflops: 362.91  mfu: 36.69%
[rank3]:2025-10-29 05:19:38,737 - INFO -  step: 2050  loss:  0.1246  grad_norm:  0.0996  memory: 78.44GiB(56.10%)  tps: 7,782  tflops: 362.94  mfu: 36.70%
[rank3]:2025-10-29 05:19:39,112 - INFO - Avg. fwd time: 14.7651 / Avg. bwd time: 38.9465 / Avg. batch time: 445.0848 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-29 05:19:39,145 - INFO - Avg. fwd time: 13.5996 / Avg. bwd time: 31.3093 / Avg. batch time: 492.6952 (ms) / GPU bubble ratio: 27.08%
[rank1]:2025-10-29 05:19:39,192 - INFO - Avg. fwd time: 15.8492 / Avg. bwd time: 36.4824 / Avg. batch time: 547.8180 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 05:19:39,193 - INFO - Avg. fwd time: 14.7814 / Avg. bwd time: 28.1851 / Avg. batch time: 593.3005 (ms) / GPU bubble ratio: 42.06%
[rank3]:2025-10-29 05:20:00,654 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9044e-01
[rank1]:2025-10-29 05:20:00,651 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.5157e-01
[rank2]:2025-10-29 05:20:00,648 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 7.6301e-01
[rank0]:2025-10-29 05:20:00,648 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3879e-01
[rank3]:2025-10-29 05:20:20,812 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5466e-01
[rank1]:2025-10-29 05:20:20,809 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.6495e-01
[rank0]:2025-10-29 05:20:20,810 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1024e+00
[rank2]:2025-10-29 05:20:20,809 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0632e-01
[rank3]:2025-10-29 05:20:42,954 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0698e-01
[rank1]:2025-10-29 05:20:42,951 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2869e-01
[rank0]:2025-10-29 05:20:42,948 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7494e-01
[rank2]:2025-10-29 05:20:42,947 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2867e+00
[rank2]:2025-10-29 05:21:02,836 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6819e-01
[rank0]:2025-10-29 05:21:02,840 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5839e-01
[rank3]:2025-10-29 05:21:02,842 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.2789e-01
[rank1]:2025-10-29 05:21:02,839 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6658e-01
[rank0]:2025-10-29 05:21:22,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:21:25,007 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4662e-01
[rank3]:2025-10-29 05:21:25,009 - INFO -  step: 2100  loss:  0.1117  grad_norm:  0.1099  memory: 78.44GiB(56.10%)  tps: 7,709  tflops: 359.53  mfu: 36.35%
[rank1]:2025-10-29 05:21:25,004 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.4244e-01
[rank1]:2025-10-29 05:21:25,004 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 70.12GiB(50.15%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank0]:2025-10-29 05:21:25,001 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0176e-01
[rank0]:2025-10-29 05:21:25,001 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 73.46GiB(52.54%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank2]:2025-10-29 05:21:25,001 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1615e-01
[rank2]:2025-10-29 05:21:25,001 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 63.09GiB(45.12%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank1]:2025-10-29 05:21:25,091 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0521_stage1_step2100.svg
[rank0]:2025-10-29 05:21:25,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0521_stage0_step2100.svg
[rank2]:2025-10-29 05:21:25,097 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0521_stage2_step2100.svg
[rank3]:2025-10-29 05:21:25,188 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0521_real_step2100_rank3.svg
[rank3]:> Batch Time: 567.58 ms, GPU Bubble Ratio: 42.96%, 32.57%, 35.99%, 25.10%
[rank3]:2025-10-29 05:21:25,254 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0521_stage3_step2100.svg
[rank3]:2025-10-29 05:21:25,639 - INFO - Avg. fwd time: 14.7744 / Avg. bwd time: 38.7848 / Avg. batch time: 443.8603 (ms) / GPU bubble ratio: 3.47%
[rank1]:2025-10-29 05:21:25,708 - INFO - Avg. fwd time: 15.8620 / Avg. bwd time: 36.2939 / Avg. batch time: 546.2143 (ms) / GPU bubble ratio: 23.61%
[rank0]:2025-10-29 05:21:25,739 - INFO - Avg. fwd time: 14.7889 / Avg. bwd time: 28.0267 / Avg. batch time: 591.5096 (ms) / GPU bubble ratio: 42.09%
[rank2]:2025-10-29 05:21:25,671 - INFO - Avg. fwd time: 13.6127 / Avg. bwd time: 31.1354 / Avg. batch time: 491.2963 (ms) / GPU bubble ratio: 27.13%
[rank3]:2025-10-29 05:21:45,238 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.5747e+00
[rank1]:2025-10-29 05:21:45,235 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.3346e+00
[rank2]:2025-10-29 05:21:45,231 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6887e+00
[rank0]:2025-10-29 05:21:45,235 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9174e+00
[rank3]:2025-10-29 05:22:07,239 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0892e-01
[rank1]:2025-10-29 05:22:07,236 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2163e+00
[rank0]:2025-10-29 05:22:07,233 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1105e-01
[rank2]:2025-10-29 05:22:07,232 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9756e-01
[rank3]:2025-10-29 05:22:27,387 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8464e+00
[rank1]:2025-10-29 05:22:27,384 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5655e+00
[rank2]:2025-10-29 05:22:27,381 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6304e+00
[rank0]:2025-10-29 05:22:27,385 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.7083e+00
[rank3]:2025-10-29 05:22:49,351 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9645e+00
[rank1]:2025-10-29 05:22:49,347 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.9578e+00
[rank0]:2025-10-29 05:22:49,345 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9071e+00
[rank2]:2025-10-29 05:22:49,344 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7338e+00
[rank0]:2025-10-29 05:23:07,405 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:23:09,399 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.3470e+00
[rank3]:2025-10-29 05:23:09,402 - INFO -  step: 2150  loss:  0.1264  grad_norm:  0.1341  memory: 78.44GiB(56.10%)  tps: 7,847  tflops: 366.01  mfu: 37.01%
[rank1]:2025-10-29 05:23:09,396 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6308e+00
[rank1]:2025-10-29 05:23:09,396 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 70.12GiB(50.15%)  tps: 7,847  tflops: 366.00  mfu: 37.01%
[rank0]:2025-10-29 05:23:09,397 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8814e+00
[rank0]:2025-10-29 05:23:09,397 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 73.46GiB(52.54%)  tps: 7,847  tflops: 365.99  mfu: 37.01%
[rank2]:2025-10-29 05:23:09,393 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9330e+00
[rank2]:2025-10-29 05:23:09,393 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 63.09GiB(45.12%)  tps: 7,847  tflops: 366.00  mfu: 37.01%
[rank3]:2025-10-29 05:23:09,781 - INFO - Avg. fwd time: 14.7836 / Avg. bwd time: 38.6394 / Avg. batch time: 442.7672 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-29 05:23:09,813 - INFO - Avg. fwd time: 13.6266 / Avg. bwd time: 30.9673 / Avg. batch time: 490.0214 (ms) / GPU bubble ratio: 27.20%
[rank1]:2025-10-29 05:23:09,857 - INFO - Avg. fwd time: 15.8746 / Avg. bwd time: 36.1237 / Avg. batch time: 544.7545 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-29 05:23:09,863 - INFO - Avg. fwd time: 14.7958 / Avg. bwd time: 27.8909 / Avg. batch time: 589.8898 (ms) / GPU bubble ratio: 42.11%
[rank1]:2025-10-29 05:23:31,541 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.1767e+00
[rank0]:2025-10-29 05:23:31,539 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4880e+00
[rank2]:2025-10-29 05:23:31,538 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9287e+00
[rank3]:2025-10-29 05:23:31,545 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3138e+00
[rank3]:2025-10-29 05:23:51,430 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.3014e+00
[rank1]:2025-10-29 05:23:51,427 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.5665e+00
[rank2]:2025-10-29 05:23:51,423 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0340e+00
[rank0]:2025-10-29 05:23:51,427 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8715e+00
[rank1]:2025-10-29 05:24:13,581 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.3521e+00
[rank0]:2025-10-29 05:24:13,578 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3984e+00
[rank2]:2025-10-29 05:24:13,577 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2721e+00
[rank3]:2025-10-29 05:24:13,584 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9075e+00
[rank3]:2025-10-29 05:24:33,565 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.7601e+00
[rank1]:2025-10-29 05:24:33,562 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1784e+00
[rank0]:2025-10-29 05:24:33,562 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.2583e+00
[rank2]:2025-10-29 05:24:33,558 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5463e+00
[rank0]:2025-10-29 05:24:53,381 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:24:55,592 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.1305e-01
[rank3]:2025-10-29 05:24:55,595 - INFO -  step: 2200  loss:  0.0970  grad_norm:  0.0830  memory: 78.44GiB(56.10%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank3]:2025-10-29 05:24:55,595 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 05:24:55,589 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5355e+00
[rank1]:2025-10-29 05:24:55,589 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 70.12GiB(50.15%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank1]:2025-10-29 05:24:55,589 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 05:24:55,585 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1377e-01
[rank2]:2025-10-29 05:24:55,586 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 63.09GiB(45.12%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank2]:2025-10-29 05:24:55,586 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 05:24:55,586 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7427e-01
[rank0]:2025-10-29 05:24:55,587 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 73.46GiB(52.54%)  tps: 7,715  tflops: 359.81  mfu: 36.38%
[rank0]:2025-10-29 05:24:55,587 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 05:25:11,946 - INFO - validate step: 2200  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,039
[rank3]:2025-10-29 05:25:12,007 - INFO - validate step: 2200  loss:  0.2574  memory: 78.44GiB(56.10%)  tps: 24,959
[rank1]:2025-10-29 05:25:11,980 - INFO - validate step: 2200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 24,990
[rank2]:2025-10-29 05:25:11,996 - INFO - validate step: 2200  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,961
[rank1]:2025-10-29 05:25:12,090 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0525_stage1_step2200.svg
[rank0]:2025-10-29 05:25:12,086 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0525_stage0_step2200.svg
[rank2]:2025-10-29 05:25:12,096 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0525_stage2_step2200.svg
[rank3]:2025-10-29 05:25:12,191 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0525_real_step2200_rank3.svg
[rank3]:> Batch Time: 559.67 ms, GPU Bubble Ratio: 42.17%, 31.91%, 42.17%, 24.52%
[rank3]:2025-10-29 05:25:12,259 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0525_stage3_step2200.svg
[rank3]:2025-10-29 05:25:12,567 - INFO - Avg. fwd time: 14.7921 / Avg. bwd time: 38.4862 / Avg. batch time: 441.6037 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-29 05:25:12,625 - INFO - Avg. fwd time: 15.8861 / Avg. bwd time: 35.9439 / Avg. batch time: 543.2008 (ms) / GPU bubble ratio: 23.67%
[rank0]:2025-10-29 05:25:12,636 - INFO - Avg. fwd time: 14.8022 / Avg. bwd time: 27.7445 / Avg. batch time: 588.1622 (ms) / GPU bubble ratio: 42.13%
[rank2]:2025-10-29 05:25:12,594 - INFO - Avg. fwd time: 13.6402 / Avg. bwd time: 30.7896 / Avg. batch time: 488.6643 (ms) / GPU bubble ratio: 27.26%
[rank3]:2025-10-29 05:25:32,391 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.4417e+00
[rank1]:2025-10-29 05:25:32,388 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5887e+00
[rank2]:2025-10-29 05:25:32,385 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0937e+00
[rank0]:2025-10-29 05:25:32,389 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6520e+00
[rank3]:2025-10-29 05:25:54,324 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6833e+00
[rank1]:2025-10-29 05:25:54,321 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2223e+00
[rank2]:2025-10-29 05:25:54,317 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7264e-01
[rank0]:2025-10-29 05:25:54,318 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3017e+00
[rank3]:2025-10-29 05:26:14,374 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8618e+00
[rank1]:2025-10-29 05:26:14,371 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2116e+00
[rank2]:2025-10-29 05:26:14,368 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5958e+00
[rank0]:2025-10-29 05:26:14,371 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5207e+00
[rank1]:2025-10-29 05:26:36,501 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.4608e+00
[rank2]:2025-10-29 05:26:36,498 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9652e-01
[rank0]:2025-10-29 05:26:36,499 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0025e+00
[rank3]:2025-10-29 05:26:36,505 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.1148e-01
[rank0]:2025-10-29 05:26:54,419 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:26:56,427 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.7447e-01
[rank1]:2025-10-29 05:26:56,427 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 70.12GiB(50.15%)  tps: 7,843  tflops: 365.81  mfu: 36.99%
[rank2]:2025-10-29 05:26:56,424 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.7302e-01
[rank2]:2025-10-29 05:26:56,424 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 63.09GiB(45.12%)  tps: 7,845  tflops: 365.88  mfu: 36.99%
[rank0]:2025-10-29 05:26:56,427 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.1749e-01
[rank0]:2025-10-29 05:26:56,428 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 73.46GiB(52.54%)  tps: 7,841  tflops: 365.69  mfu: 36.98%
[rank3]:2025-10-29 05:26:56,430 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5571e-01
[rank3]:2025-10-29 05:26:56,433 - INFO -  step: 2250  loss:  0.1149  grad_norm:  0.1007  memory: 78.44GiB(56.10%)  tps: 7,845  tflops: 365.89  mfu: 37.00%
[rank3]:2025-10-29 05:26:56,901 - INFO - Avg. fwd time: 14.8020 / Avg. bwd time: 38.3284 / Avg. batch time: 440.4168 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-29 05:26:56,941 - INFO - Avg. fwd time: 13.6546 / Avg. bwd time: 30.6086 / Avg. batch time: 487.2964 (ms) / GPU bubble ratio: 27.33%
[rank1]:2025-10-29 05:26:56,984 - INFO - Avg. fwd time: 15.8989 / Avg. bwd time: 35.7604 / Avg. batch time: 541.6347 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 05:26:57,020 - INFO - Avg. fwd time: 14.8096 / Avg. bwd time: 27.5994 / Avg. batch time: 586.4262 (ms) / GPU bubble ratio: 42.15%
[rank1]:2025-10-29 05:27:18,646 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3255e+00
[rank0]:2025-10-29 05:27:18,644 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.7908e-01
[rank2]:2025-10-29 05:27:18,643 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1580e+00
[rank3]:2025-10-29 05:27:18,649 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0271e+00
[rank1]:2025-10-29 05:27:38,659 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7543e+00
[rank0]:2025-10-29 05:27:38,660 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2097e+00
[rank2]:2025-10-29 05:27:38,656 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2328e+00
[rank3]:2025-10-29 05:27:38,662 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.2457e-01
[rank3]:2025-10-29 05:28:00,679 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.5234e-01
[rank1]:2025-10-29 05:28:00,676 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6264e-01
[rank2]:2025-10-29 05:28:00,672 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8479e-01
[rank0]:2025-10-29 05:28:00,673 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6477e-01
[rank3]:2025-10-29 05:28:20,860 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.3643e+00
[rank1]:2025-10-29 05:28:20,857 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.8973e-01
[rank0]:2025-10-29 05:28:20,858 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.7761e-01
[rank2]:2025-10-29 05:28:20,854 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7898e-01
[rank0]:2025-10-29 05:28:40,562 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:28:42,793 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.0915e-01
[rank3]:2025-10-29 05:28:42,796 - INFO -  step: 2300  loss:  0.0875  grad_norm:  0.0896  memory: 78.44GiB(56.10%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank1]:2025-10-29 05:28:42,790 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3089e+00
[rank1]:2025-10-29 05:28:42,790 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 70.12GiB(50.15%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank0]:2025-10-29 05:28:42,788 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1377e+00
[rank0]:2025-10-29 05:28:42,788 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 73.46GiB(52.54%)  tps: 7,702  tflops: 359.23  mfu: 36.32%
[rank2]:2025-10-29 05:28:42,787 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9648e-01
[rank2]:2025-10-29 05:28:42,787 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 63.09GiB(45.12%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank1]:2025-10-29 05:28:42,879 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0528_stage1_step2300.svg
[rank2]:2025-10-29 05:28:42,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0528_stage2_step2300.svg
[rank0]:2025-10-29 05:28:42,874 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0528_stage0_step2300.svg
[rank3]:2025-10-29 05:28:42,979 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0528_real_step2300_rank3.svg
[rank3]:> Batch Time: 557.41 ms, GPU Bubble Ratio: 41.95%, 31.72%, 42.20%, 24.58%
[rank3]:2025-10-29 05:28:43,047 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0528_stage3_step2300.svg
[rank3]:2025-10-29 05:28:43,360 - INFO - Avg. fwd time: 14.8091 / Avg. bwd time: 38.2127 / Avg. batch time: 439.5437 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-10-29 05:28:43,419 - INFO - Avg. fwd time: 15.9086 / Avg. bwd time: 35.6231 / Avg. batch time: 540.4634 (ms) / GPU bubble ratio: 23.72%
[rank2]:2025-10-29 05:28:43,387 - INFO - Avg. fwd time: 13.6652 / Avg. bwd time: 30.4727 / Avg. batch time: 486.2751 (ms) / GPU bubble ratio: 27.39%
[rank0]:2025-10-29 05:28:43,430 - INFO - Avg. fwd time: 14.8152 / Avg. bwd time: 27.4866 / Avg. batch time: 585.1215 (ms) / GPU bubble ratio: 42.16%
[rank2]:2025-10-29 05:29:03,062 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7553e-01
[rank3]:2025-10-29 05:29:03,068 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2045e+00
[rank1]:2025-10-29 05:29:03,065 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2816e+00
[rank0]:2025-10-29 05:29:03,066 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0141e+00
[rank3]:2025-10-29 05:29:25,233 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3729e+00
[rank1]:2025-10-29 05:29:25,230 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9189e+00
[rank0]:2025-10-29 05:29:25,227 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.1913e-01
[rank2]:2025-10-29 05:29:25,227 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2833e-01
[rank3]:2025-10-29 05:29:45,135 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.3943e+00
[rank1]:2025-10-29 05:29:45,132 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.2435e+00
[rank0]:2025-10-29 05:29:45,132 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3690e+00
[rank2]:2025-10-29 05:29:45,128 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9679e+00
[rank3]:2025-10-29 05:30:07,287 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9250e-01
[rank1]:2025-10-29 05:30:07,283 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1466e+00
[rank0]:2025-10-29 05:30:07,281 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9841e-01
[rank2]:2025-10-29 05:30:07,280 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2633e-01
[rank0]:2025-10-29 05:30:25,250 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:30:27,287 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8718e+00
[rank3]:2025-10-29 05:30:27,289 - INFO -  step: 2350  loss:  0.1004  grad_norm:  0.0891  memory: 78.44GiB(56.10%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank1]:2025-10-29 05:30:27,284 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0921e+00
[rank1]:2025-10-29 05:30:27,284 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 70.12GiB(50.15%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank0]:2025-10-29 05:30:27,284 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.7120e+00
[rank0]:2025-10-29 05:30:27,285 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 73.46GiB(52.54%)  tps: 7,839  tflops: 365.64  mfu: 36.97%
[rank2]:2025-10-29 05:30:27,280 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4914e+00
[rank2]:2025-10-29 05:30:27,281 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 63.09GiB(45.12%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank3]:2025-10-29 05:30:27,681 - INFO - Avg. fwd time: 14.8178 / Avg. bwd time: 38.0731 / Avg. batch time: 438.4923 (ms) / GPU bubble ratio: 3.50%
[rank2]:2025-10-29 05:30:27,711 - INFO - Avg. fwd time: 13.6782 / Avg. bwd time: 30.3115 / Avg. batch time: 485.0617 (ms) / GPU bubble ratio: 27.45%
[rank1]:2025-10-29 05:30:27,756 - INFO - Avg. fwd time: 15.9202 / Avg. bwd time: 35.4597 / Avg. batch time: 539.0721 (ms) / GPU bubble ratio: 23.75%
[rank0]:2025-10-29 05:30:27,762 - INFO - Avg. fwd time: 14.8224 / Avg. bwd time: 27.3558 / Avg. batch time: 583.5762 (ms) / GPU bubble ratio: 42.18%
[rank3]:2025-10-29 05:30:49,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4124e+00
[rank1]:2025-10-29 05:30:49,312 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.7869e+00
[rank2]:2025-10-29 05:30:49,309 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8862e+00
[rank0]:2025-10-29 05:30:49,310 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4569e+00
[rank3]:2025-10-29 05:31:09,502 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5295e+00
[rank1]:2025-10-29 05:31:09,498 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1689e+00
[rank2]:2025-10-29 05:31:09,495 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.8064e-01
[rank0]:2025-10-29 05:31:09,499 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1452e-01
[rank3]:2025-10-29 05:31:31,454 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.8827e-01
[rank1]:2025-10-29 05:31:31,451 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2070e+00
[rank2]:2025-10-29 05:31:31,448 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5800e-01
[rank0]:2025-10-29 05:31:31,449 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1525e-01
[rank3]:2025-10-29 05:31:51,475 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5813e-01
[rank1]:2025-10-29 05:31:51,472 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1725e-01
[rank2]:2025-10-29 05:31:51,469 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1996e+00
[rank0]:2025-10-29 05:31:51,473 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.9034e-01
[rank0]:2025-10-29 05:32:11,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:32:13,606 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.5895e-01
[rank0]:2025-10-29 05:32:13,607 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 73.46GiB(52.54%)  tps: 7,705  tflops: 359.36  mfu: 36.34%
[rank0]:2025-10-29 05:32:13,607 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,947  tflops: 324.03  mfu: 31.78%
[rank0]:2025-10-29 05:32:13,607 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 05:32:13,605 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6481e+00
[rank2]:2025-10-29 05:32:13,606 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 63.09GiB(45.12%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank2]:2025-10-29 05:32:13,606 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,949  tflops: 324.08  mfu: 31.79%
[rank2]:2025-10-29 05:32:13,606 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 05:32:13,612 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3209e+00
[rank3]:2025-10-29 05:32:13,614 - INFO -  step: 2400  loss:  0.0993  grad_norm:  0.1285  memory: 78.44GiB(56.10%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank3]:2025-10-29 05:32:13,615 - INFO -  final step: 2400  loss:  0.0993  grad_norm:  0.1285  tps: 6,951  tflops: 324.18  mfu: 31.79%
[rank3]:2025-10-29 05:32:13,615 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 05:32:13,609 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.5609e-01
[rank1]:2025-10-29 05:32:13,609 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 70.12GiB(50.15%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank1]:2025-10-29 05:32:13,609 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,948  tflops: 324.04  mfu: 31.78%
[rank1]:2025-10-29 05:32:13,609 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 05:32:29,925 - INFO - validate step: 2400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,101
[rank0]:2025-10-29 05:32:29,926 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 05:32:29,933 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank3]:2025-10-29 05:32:29,982 - INFO - validate step: 2400  loss:  0.2571  memory: 78.44GiB(56.10%)  tps: 25,028
[rank3]:2025-10-29 05:32:29,983 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 05:32:29,988 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 05:32:29,962 - INFO - validate step: 2400  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,049
[rank1]:2025-10-29 05:32:29,962 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 05:32:29,967 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 05:32:29,978 - INFO - validate step: 2400  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,020
[rank2]:2025-10-29 05:32:29,978 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 05:32:29,981 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 05:32:41,668 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 05:32:41,757 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0532_stage0_final2400.svg
[rank1]:2025-10-29 05:32:41,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0532_stage1_final2400.svg
[rank2]:2025-10-29 05:32:41,768 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0532_stage2_final2400.svg
[rank3]:2025-10-29 05:32:41,866 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0532_real_final2400_rank3.svg
[rank3]:> Batch Time: 552.80 ms, GPU Bubble Ratio: 41.49%, 31.22%, 41.82%, 24.77%
[rank1]:2025-10-29 05:32:42,005 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank1_stage1.svg
[rank1]:	> Counts Sum: 5346, Total Sum: 19035 (28.09%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 05:32:42,005 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 05:32:42,018 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank2_stage2.svg
[rank2]:	> Counts Sum: 5229, Total Sum: 16920 (30.90%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 05:32:42,018 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 05:32:41,998 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank0_stage0.svg
[rank0]:	> Counts Sum: 9540, Total Sum: 17155 (55.61%), Ratio(%) per element: [0.0, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 05:32:41,998 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 05:32:42,036 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0532_thry_final2400_rank3.svg
[rank3]:> Batch Time: 489.46 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 05:32:42,108 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0532_stage3_final2400.svg
[rank3]:2025-10-29 05:32:42,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank3_stage3.svg
[rank3]:	> Counts Sum: 3978, Total Sum: 15275 (26.04%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 05:32:42,331 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–†â–…â–…â–†â–ˆâ–…â–„â–‚â–‚â–â–â–â–‚â–â–ƒâ–‚â–â–‚â–â–‚â–„â–ƒâ–„â–„â–„â–…â–ƒâ–‚â–â–â–â–â–‚â–â–â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–‡â–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–‚â–â–â–‚â–â–‚â–â–â–‡â–†â–‡â–‡â–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–‡â–‡â–‡â–ˆâ–‡â–â–â–â–â–â–â–‚â–â–‚â–‚â–â–‚â–â–â–‡â–†â–‡â–‡â–‡â–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.35718
[rank3]:wandb:               final/avg_loss 0.09927
[rank3]:wandb:             final/avg_mfu(%) 31.79282
[rank3]:wandb:             final/avg_tflops 324.1807
[rank3]:wandb:    final/avg_throughput(tps) 6950.67716
[rank3]:wandb:              final/grad_norm 0.12851
[rank3]:wandb:               final/max_loss 0.09927
[rank3]:wandb:                    grad_norm 0.12851
[rank3]:wandb: loss_metrics/global_avg_loss 0.09927
[rank3]:wandb: loss_metrics/global_max_loss 0.09927
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/fr7hk14p
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_auto_dm1/20251029-0353/wandb/run-20251029_035307-fr7hk14p/logs
[rank0]:2025-10-29 05:32:43,998 - INFO - Training completed
[rank0]:2025-10-29 05:32:43,998 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 05:32:44,177 - INFO - Process group destroyed
[rank2]:2025-10-29 05:32:44,192 - INFO - Process group destroyed
[rank0]:2025-10-29 05:32:44,342 - INFO - Process group destroyed
[rank3]:2025-10-29 05:32:44,334 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.12', 'layers.16', 'layers.11', 'layers.14', 'layers.8', 'layers.9', 'layers.15', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.7', 'layers.6', 'tok_embeddings', 'layers.5', 'layers.0', 'layers.1', 'layers.3', 'layers.4', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.21', 'layers.24', 'layers.23', 'layers.22', 'layers.17', 'layers.19', 'layers.20'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'layers.26', 'output', 'layers.27', 'layers.30', 'layers.31', 'layers.29', 'norm', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
