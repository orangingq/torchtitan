âœ”ï¸ SLURM JOB GPUS: 3,4,5,7
âœ”ï¸ Using Slurm-assigned GPU(s): 3,4,5,7

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 00:28:56 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] 
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] *****************************************
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 00:28:58.176000 1334017 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 00:29:04,098 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 00:29:04,215 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 00:29:04,221 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 00:29:04,321 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 00:29:04,957 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 00:29:04,959 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 00:29:05,202 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 00:29:05,204 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:05,228 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 00:29:05,231 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:05,236 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 00:29:05,243 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 00:29:05,246 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:29:07,151 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 00:29:07,433 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 00:29:09,069 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 00:29:10,668 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 00:29:10,741 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 00:29:10,741 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 00:29:10,726 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 00:29:10,801 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 00:29:10,801 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 00:29:10,945 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 00:29:10,945 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 00:29:11,015 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 00:29:11,016 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 00:29:11,148 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 00:29:11,406 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 00:29:11,455 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 00:29:11,479 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 00:29:11,479 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-10-29 00:29:11,696 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 00:29:11,697 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: setting up run k3khcbe8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1/20251029-0029/wandb/run-20251029_002911-k3khcbe8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/k3khcbe8
[rank3]:2025-10-29 00:29:12,682 - INFO - WandB logging enabled
[rank3]:2025-10-29 00:29:12,708 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 00:29:12,787 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 00:29:12,787 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 00:29:13,044 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 00:29:13,045 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:29:13,056 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank0]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:29:13,057 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 00:29:13,056 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 00:29:16,624 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank2]:2025-10-29 00:29:16,573 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank1]:2025-10-29 00:29:16,675 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank0]:2025-10-29 00:29:16,794 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 00:29:16,794 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1.
[rank0]:2025-10-29 00:29:16,794 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200.
[rank0]:2025-10-29 00:29:23,912 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 00:29:23,912 - INFO - Finished loading the checkpoint in 7.12 seconds.
[rank0]:2025-10-29 00:29:23,913 - INFO - Training starts at step 1
[rank0]:2025-10-29 00:29:28,564 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 49.75GiB(35.58%)  tps: 958  tflops: 44.66  mfu: 4.52%
[rank0]:2025-10-29 00:29:28,564 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 00:29:28,540 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 44.28GiB(31.67%)  tps: 919  tflops: 42.87  mfu: 4.33%
[rank2]:2025-10-29 00:29:28,541 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 00:29:28,543 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.9701  memory: 49.69GiB(35.54%)  tps: 922  tflops: 43.01  mfu: 4.35%
[rank1]:2025-10-29 00:29:28,543 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:29:28,545 - INFO -  step:  1  loss:  1.0507  grad_norm:  0.9701  memory: 58.03GiB(41.50%)  tps: 1,038  tflops: 48.42  mfu: 4.90%
[rank3]:2025-10-29 00:29:28,546 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:29:46,830 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,831 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,832 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,833 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,834 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:29:46,835 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,873 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,874 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,875 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:29:46,876 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,920 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,921 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:29:46,922 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,964 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:29:46,965 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:31:38,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:31:40,989 - INFO -  step: 50  loss:  0.9059  grad_norm:  0.4167  memory: 73.38GiB(52.48%)  tps: 6,062  tflops: 282.72  mfu: 28.59%
[rank1]:2025-10-29 00:31:40,987 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank0]:2025-10-29 00:31:40,991 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 66.72GiB(47.72%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank2]:2025-10-29 00:31:40,984 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4167  memory: 57.29GiB(40.97%)  tps: 6,062  tflops: 282.71  mfu: 28.59%
[rank3]:2025-10-29 00:31:41,451 - INFO - Avg. fwd time: 14.7708 / Avg. bwd time: 42.9562 / Avg. batch time: 482.1768 (ms) / GPU bubble ratio: 4.22%
[rank2]:2025-10-29 00:31:41,501 - INFO - Avg. fwd time: 13.2962 / Avg. bwd time: 36.3898 / Avg. batch time: 535.0132 (ms) / GPU bubble ratio: 25.71%
[rank1]:2025-10-29 00:31:41,548 - INFO - Avg. fwd time: 15.4241 / Avg. bwd time: 41.6891 / Avg. batch time: 595.7353 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-10-29 00:31:41,582 - INFO - Avg. fwd time: 14.3031 / Avg. bwd time: 38.5742 / Avg. batch time: 651.7335 (ms) / GPU bubble ratio: 35.09%
[rank0]:2025-10-29 00:33:53,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:33:56,366 - INFO -  step: 100  loss:  0.8034  grad_norm:  0.5327  memory: 73.38GiB(52.48%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank1]:2025-10-29 00:33:56,364 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 64.32GiB(46.00%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank2]:2025-10-29 00:33:56,362 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 57.29GiB(40.97%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank0]:2025-10-29 00:33:56,369 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.5327  memory: 66.72GiB(47.72%)  tps: 6,051  tflops: 282.23  mfu: 28.54%
[rank3]:2025-10-29 00:33:56,562 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0033_real_step100_rank3.svg
[rank3]:> Batch Time: 634.28 ms, GPU Bubble Ratio: 32.99%, 27.10%, 36.82%, 26.60%
[rank3]:2025-10-29 00:33:56,975 - INFO - Avg. fwd time: 14.8358 / Avg. bwd time: 43.1073 / Avg. batch time: 481.2257 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-29 00:33:57,025 - INFO - Avg. fwd time: 13.3537 / Avg. bwd time: 36.5079 / Avg. batch time: 534.0995 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 00:33:57,071 - INFO - Avg. fwd time: 15.5459 / Avg. bwd time: 41.9582 / Avg. batch time: 595.0309 (ms) / GPU bubble ratio: 22.69%
[rank0]:2025-10-29 00:33:57,105 - INFO - Avg. fwd time: 14.2257 / Avg. bwd time: 38.7488 / Avg. batch time: 651.0923 (ms) / GPU bubble ratio: 34.91%
[rank0]:2025-10-29 00:36:09,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:36:11,882 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 64.32GiB(46.00%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank0]:2025-10-29 00:36:11,887 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 66.72GiB(47.72%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank3]:2025-10-29 00:36:11,885 - INFO -  step: 150  loss:  0.8485  grad_norm:  0.5197  memory: 73.38GiB(52.48%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank2]:2025-10-29 00:36:11,880 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5197  memory: 57.29GiB(40.97%)  tps: 6,045  tflops: 281.94  mfu: 28.51%
[rank3]:2025-10-29 00:36:12,438 - INFO - Avg. fwd time: 14.8544 / Avg. bwd time: 43.1588 / Avg. batch time: 480.9804 (ms) / GPU bubble ratio: 3.51%
[rank1]:2025-10-29 00:36:12,526 - INFO - Avg. fwd time: 15.5878 / Avg. bwd time: 42.0480 / Avg. batch time: 595.1100 (ms) / GPU bubble ratio: 22.52%
[rank2]:2025-10-29 00:36:12,479 - INFO - Avg. fwd time: 13.3679 / Avg. bwd time: 36.5419 / Avg. batch time: 534.0936 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-29 00:36:12,569 - INFO - Avg. fwd time: 14.2005 / Avg. bwd time: 38.8015 / Avg. batch time: 651.2039 (ms) / GPU bubble ratio: 34.89%
[rank0]:2025-10-29 00:38:24,639 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:38:27,373 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 64.32GiB(46.00%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank1]:2025-10-29 00:38:27,373 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 00:38:27,370 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 57.29GiB(40.97%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank2]:2025-10-29 00:38:27,371 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 00:38:27,376 - INFO -  step: 200  loss:  0.8525  grad_norm:  0.6145  memory: 73.38GiB(52.48%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank3]:2025-10-29 00:38:27,376 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 00:38:27,377 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.6145  memory: 66.72GiB(47.72%)  tps: 6,046  tflops: 282.00  mfu: 28.51%
[rank0]:2025-10-29 00:38:27,378 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 00:38:44,225 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,306
[rank2]:2025-10-29 00:38:44,239 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,282
[rank3]:2025-10-29 00:38:44,253 - INFO - validate step: 200  loss:  0.2570  memory: 73.38GiB(52.48%)  tps: 24,271
[rank0]:2025-10-29 00:38:44,195 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,356
[rank3]:2025-10-29 00:38:44,438 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0038_real_step200_rank3.svg
[rank3]:> Batch Time: 635.02 ms, GPU Bubble Ratio: 33.01%, 27.05%, 36.88%, 26.63%
[rank3]:2025-10-29 00:38:44,847 - INFO - Avg. fwd time: 14.8617 / Avg. bwd time: 43.1853 / Avg. batch time: 480.9045 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 00:38:44,944 - INFO - Avg. fwd time: 15.5977 / Avg. bwd time: 42.0822 / Avg. batch time: 595.0054 (ms) / GPU bubble ratio: 22.45%
[rank2]:2025-10-29 00:38:44,897 - INFO - Avg. fwd time: 13.3713 / Avg. bwd time: 36.5531 / Avg. batch time: 533.9603 (ms) / GPU bubble ratio: 25.20%
[rank0]:2025-10-29 00:38:44,978 - INFO - Avg. fwd time: 14.1851 / Avg. bwd time: 38.8231 / Avg. batch time: 651.1069 (ms) / GPU bubble ratio: 34.87%
[rank0]:2025-10-29 00:40:57,085 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:40:59,806 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 57.29GiB(40.97%)  tps: 6,043  tflops: 281.84  mfu: 28.50%
[rank1]:2025-10-29 00:40:59,809 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank3]:2025-10-29 00:40:59,811 - INFO -  step: 250  loss:  0.8870  grad_norm:  0.5384  memory: 73.38GiB(52.48%)  tps: 6,043  tflops: 281.86  mfu: 28.50%
[rank0]:2025-10-29 00:40:59,813 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.5384  memory: 66.72GiB(47.72%)  tps: 6,041  tflops: 281.73  mfu: 28.49%
[rank3]:2025-10-29 00:41:00,271 - INFO - Avg. fwd time: 14.8717 / Avg. bwd time: 43.2035 / Avg. batch time: 480.8865 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-29 00:41:00,321 - INFO - Avg. fwd time: 13.3794 / Avg. bwd time: 36.5628 / Avg. batch time: 534.0358 (ms) / GPU bubble ratio: 25.19%
[rank1]:2025-10-29 00:41:00,368 - INFO - Avg. fwd time: 15.6086 / Avg. bwd time: 42.1110 / Avg. batch time: 595.1152 (ms) / GPU bubble ratio: 22.41%
[rank0]:2025-10-29 00:41:00,401 - INFO - Avg. fwd time: 14.1661 / Avg. bwd time: 38.8139 / Avg. batch time: 651.1863 (ms) / GPU bubble ratio: 34.91%
[rank0]:2025-10-29 00:43:12,565 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:43:15,280 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 57.29GiB(40.97%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank3]:2025-10-29 00:43:15,285 - INFO -  step: 300  loss:  0.7869  grad_norm:  0.4663  memory: 73.38GiB(52.48%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank1]:2025-10-29 00:43:15,282 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 64.32GiB(46.00%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank0]:2025-10-29 00:43:15,287 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4663  memory: 66.72GiB(47.72%)  tps: 6,047  tflops: 282.03  mfu: 28.52%
[rank3]:2025-10-29 00:43:15,468 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0043_real_step300_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.08%, 27.03%, 36.90%, 26.64%
[rank3]:2025-10-29 00:43:15,966 - INFO - Avg. fwd time: 14.8727 / Avg. bwd time: 43.2146 / Avg. batch time: 480.8234 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-10-29 00:43:16,008 - INFO - Avg. fwd time: 13.3840 / Avg. bwd time: 36.5697 / Avg. batch time: 534.0416 (ms) / GPU bubble ratio: 25.17%
[rank1]:2025-10-29 00:43:16,055 - INFO - Avg. fwd time: 15.6137 / Avg. bwd time: 42.1300 / Avg. batch time: 595.1451 (ms) / GPU bubble ratio: 22.38%
[rank0]:2025-10-29 00:43:16,099 - INFO - Avg. fwd time: 14.1540 / Avg. bwd time: 38.8184 / Avg. batch time: 651.2158 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:45:28,133 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:45:30,857 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank2]:2025-10-29 00:45:30,854 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 57.29GiB(40.97%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank3]:2025-10-29 00:45:30,860 - INFO -  step: 350  loss:  0.8326  grad_norm:  0.4684  memory: 73.38GiB(52.48%)  tps: 6,043  tflops: 281.82  mfu: 28.50%
[rank0]:2025-10-29 00:45:30,861 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4684  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.82  mfu: 28.50%
[rank2]:2025-10-29 00:45:31,375 - INFO - Avg. fwd time: 13.3871 / Avg. bwd time: 36.5730 / Avg. batch time: 533.9992 (ms) / GPU bubble ratio: 25.15%
[rank3]:2025-10-29 00:45:31,326 - INFO - Avg. fwd time: 14.8750 / Avg. bwd time: 43.2249 / Avg. batch time: 480.8261 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-10-29 00:45:31,422 - INFO - Avg. fwd time: 15.6205 / Avg. bwd time: 42.1422 / Avg. batch time: 595.1243 (ms) / GPU bubble ratio: 22.35%
[rank0]:2025-10-29 00:45:31,456 - INFO - Avg. fwd time: 14.1485 / Avg. bwd time: 38.8191 / Avg. batch time: 651.1849 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:47:42,481 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:47:45,119 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 57.29GiB(40.97%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank2]:2025-10-29 00:47:45,119 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 00:47:45,122 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 64.32GiB(46.00%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank1]:2025-10-29 00:47:45,122 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 00:47:45,125 - INFO -  step: 400  loss:  0.1033  grad_norm:  0.1207  memory: 73.38GiB(52.48%)  tps: 6,102  tflops: 284.58  mfu: 28.77%
[rank3]:2025-10-29 00:47:45,126 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:47:45,126 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1207  memory: 66.72GiB(47.72%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank0]:2025-10-29 00:47:45,126 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 00:48:00,280 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,018
[rank1]:2025-10-29 00:48:00,266 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,047
[rank3]:2025-10-29 00:48:00,293 - INFO - validate step: 400  loss:  0.2487  memory: 73.38GiB(52.48%)  tps: 27,009
[rank0]:2025-10-29 00:48:00,235 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,110
[rank3]:2025-10-29 00:48:00,491 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0048_real_step400_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.10%, 27.01%, 36.91%, 26.64%
[rank3]:2025-10-29 00:48:00,885 - INFO - Avg. fwd time: 14.8552 / Avg. bwd time: 43.2112 / Avg. batch time: 480.4664 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-29 00:48:00,934 - INFO - Avg. fwd time: 13.3726 / Avg. bwd time: 36.5638 / Avg. batch time: 533.5771 (ms) / GPU bubble ratio: 25.13%
[rank1]:2025-10-29 00:48:00,980 - INFO - Avg. fwd time: 15.6077 / Avg. bwd time: 42.1397 / Avg. batch time: 594.6824 (ms) / GPU bubble ratio: 22.32%
[rank0]:2025-10-29 00:48:01,013 - INFO - Avg. fwd time: 14.1230 / Avg. bwd time: 38.8085 / Avg. batch time: 650.7159 (ms) / GPU bubble ratio: 34.93%
[rank0]:2025-10-29 00:50:08,050 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:50:10,667 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 00:50:10,669 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 64.32GiB(46.00%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank0]:2025-10-29 00:50:10,674 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1381  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.92  mfu: 29.62%
[rank3]:2025-10-29 00:50:10,672 - INFO -  step: 450  loss:  0.0968  grad_norm:  0.1381  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.06  mfu: 29.63%
[rank3]:2025-10-29 00:50:11,194 - INFO - Avg. fwd time: 14.7612 / Avg. bwd time: 43.1182 / Avg. batch time: 478.8834 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-29 00:50:11,236 - INFO - Avg. fwd time: 13.3027 / Avg. bwd time: 36.5236 / Avg. batch time: 531.9479 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 00:50:11,283 - INFO - Avg. fwd time: 15.5212 / Avg. bwd time: 42.0893 / Avg. batch time: 592.9801 (ms) / GPU bubble ratio: 22.28%
[rank0]:2025-10-29 00:50:11,327 - INFO - Avg. fwd time: 14.0351 / Avg. bwd time: 38.7673 / Avg. batch time: 648.9255 (ms) / GPU bubble ratio: 34.90%
[rank0]:2025-10-29 00:52:18,372 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:52:20,980 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank1]:2025-10-29 00:52:20,982 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank0]:2025-10-29 00:52:20,987 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1340  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank3]:2025-10-29 00:52:20,985 - INFO -  step: 500  loss:  0.1054  grad_norm:  0.1340  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank3]:2025-10-29 00:52:21,173 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0052_real_step500_rank3.svg
[rank3]:> Batch Time: 633.55 ms, GPU Bubble Ratio: 33.07%, 27.00%, 36.88%, 26.66%
[rank2]:2025-10-29 00:52:21,606 - INFO - Avg. fwd time: 13.2532 / Avg. bwd time: 36.4970 / Avg. batch time: 530.7586 (ms) / GPU bubble ratio: 25.01%
[rank3]:2025-10-29 00:52:21,556 - INFO - Avg. fwd time: 14.6942 / Avg. bwd time: 43.0560 / Avg. batch time: 477.7896 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-29 00:52:21,653 - INFO - Avg. fwd time: 15.4639 / Avg. bwd time: 42.0590 / Avg. batch time: 591.7458 (ms) / GPU bubble ratio: 22.23%
[rank0]:2025-10-29 00:52:21,686 - INFO - Avg. fwd time: 13.9741 / Avg. bwd time: 38.7422 / Avg. batch time: 647.6328 (ms) / GPU bubble ratio: 34.88%
[rank0]:2025-10-29 00:54:28,786 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:54:31,398 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 57.29GiB(40.97%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank1]:2025-10-29 00:54:31,401 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 64.32GiB(46.00%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank0]:2025-10-29 00:54:31,405 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1301  memory: 66.72GiB(47.72%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank3]:2025-10-29 00:54:31,403 - INFO -  step: 550  loss:  0.1195  grad_norm:  0.1301  memory: 73.38GiB(52.48%)  tps: 6,281  tflops: 292.97  mfu: 29.62%
[rank3]:2025-10-29 00:54:31,834 - INFO - Avg. fwd time: 14.6316 / Avg. bwd time: 42.9965 / Avg. batch time: 476.7553 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 00:54:31,885 - INFO - Avg. fwd time: 13.2073 / Avg. bwd time: 36.4727 / Avg. batch time: 529.6967 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-10-29 00:54:31,930 - INFO - Avg. fwd time: 15.4097 / Avg. bwd time: 42.0312 / Avg. batch time: 590.6437 (ms) / GPU bubble ratio: 22.20%
[rank0]:2025-10-29 00:54:31,963 - INFO - Avg. fwd time: 13.9189 / Avg. bwd time: 38.7173 / Avg. batch time: 646.4788 (ms) / GPU bubble ratio: 34.86%
[rank0]:2025-10-29 00:56:39,108 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:56:41,727 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 00:56:41,732 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 00:56:41,732 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 00:56:41,729 - INFO -  step: 600  loss:  0.0925  grad_norm:  0.0830  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank3]:2025-10-29 00:56:41,730 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 00:56:41,725 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0830  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank2]:2025-10-29 00:56:41,725 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 00:56:41,728 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 00:56:56,831 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,127
[rank2]:2025-10-29 00:56:56,876 - INFO - validate step: 600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,035
[rank1]:2025-10-29 00:56:56,862 - INFO - validate step: 600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,064
[rank3]:2025-10-29 00:56:56,890 - INFO - validate step: 600  loss:  0.2593  memory: 73.38GiB(52.48%)  tps: 27,020
[rank3]:2025-10-29 00:56:57,075 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0056_real_step600_rank3.svg
[rank3]:> Batch Time: 631.60 ms, GPU Bubble Ratio: 33.02%, 26.96%, 36.84%, 26.69%
[rank3]:2025-10-29 00:56:57,553 - INFO - Avg. fwd time: 14.5786 / Avg. bwd time: 42.9476 / Avg. batch time: 475.8929 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 00:56:57,595 - INFO - Avg. fwd time: 13.1677 / Avg. bwd time: 36.4513 / Avg. batch time: 528.8079 (ms) / GPU bubble ratio: 24.93%
[rank1]:2025-10-29 00:56:57,643 - INFO - Avg. fwd time: 15.3628 / Avg. bwd time: 42.0089 / Avg. batch time: 589.7214 (ms) / GPU bubble ratio: 22.17%
[rank0]:2025-10-29 00:56:57,687 - INFO - Avg. fwd time: 13.8701 / Avg. bwd time: 38.6976 / Avg. batch time: 645.5131 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-10-29 00:59:04,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:59:07,370 - INFO -  step: 650  loss:  0.0787  grad_norm:  0.1029  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank0]:2025-10-29 00:59:07,372 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 66.72GiB(47.72%)  tps: 6,275  tflops: 292.69  mfu: 29.59%
[rank2]:2025-10-29 00:59:07,365 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 00:59:07,368 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1029  memory: 64.32GiB(46.00%)  tps: 6,277  tflops: 292.77  mfu: 29.60%
[rank3]:2025-10-29 00:59:07,807 - INFO - Avg. fwd time: 14.5425 / Avg. bwd time: 42.9124 / Avg. batch time: 475.2888 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 00:59:07,856 - INFO - Avg. fwd time: 13.1405 / Avg. bwd time: 36.4347 / Avg. batch time: 528.1421 (ms) / GPU bubble ratio: 24.91%
[rank1]:2025-10-29 00:59:07,903 - INFO - Avg. fwd time: 15.3313 / Avg. bwd time: 41.9896 / Avg. batch time: 589.0287 (ms) / GPU bubble ratio: 22.15%
[rank0]:2025-10-29 00:59:07,936 - INFO - Avg. fwd time: 13.8355 / Avg. bwd time: 38.6812 / Avg. batch time: 644.7837 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:01:15,188 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:01:17,815 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank2]:2025-10-29 01:01:17,812 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank3]:2025-10-29 01:01:17,817 - INFO -  step: 700  loss:  0.0974  grad_norm:  0.1130  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank0]:2025-10-29 01:01:17,820 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1130  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.90  mfu: 29.62%
[rank3]:2025-10-29 01:01:18,008 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0101_real_step700_rank3.svg
[rank3]:> Batch Time: 629.52 ms, GPU Bubble Ratio: 32.97%, 26.90%, 36.79%, 26.75%
[rank3]:2025-10-29 01:01:18,398 - INFO - Avg. fwd time: 14.5044 / Avg. bwd time: 42.8785 / Avg. batch time: 474.6784 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:01:18,494 - INFO - Avg. fwd time: 15.2981 / Avg. bwd time: 41.9740 / Avg. batch time: 588.3373 (ms) / GPU bubble ratio: 22.12%
[rank2]:2025-10-29 01:01:18,448 - INFO - Avg. fwd time: 13.1120 / Avg. bwd time: 36.4192 / Avg. batch time: 527.4723 (ms) / GPU bubble ratio: 24.88%
[rank0]:2025-10-29 01:01:18,526 - INFO - Avg. fwd time: 13.7999 / Avg. bwd time: 38.6658 / Avg. batch time: 644.0589 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:03:25,563 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:03:28,202 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 01:03:28,204 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:03:28,206 - INFO -  step: 750  loss:  0.1253  grad_norm:  0.1450  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 01:03:28,208 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1450  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:03:28,737 - INFO - Avg. fwd time: 14.4717 / Avg. bwd time: 42.8472 / Avg. batch time: 474.1370 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:03:28,780 - INFO - Avg. fwd time: 13.0880 / Avg. bwd time: 36.4040 / Avg. batch time: 526.9227 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-10-29 01:03:28,828 - INFO - Avg. fwd time: 15.2693 / Avg. bwd time: 41.9568 / Avg. batch time: 587.7620 (ms) / GPU bubble ratio: 22.11%
[rank0]:2025-10-29 01:03:28,873 - INFO - Avg. fwd time: 13.7717 / Avg. bwd time: 38.6487 / Avg. batch time: 643.4499 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:05:35,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:05:38,540 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank2]:2025-10-29 01:05:38,541 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 01:05:38,543 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank1]:2025-10-29 01:05:38,543 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 01:05:38,545 - INFO -  step: 800  loss:  0.1097  grad_norm:  0.1311  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.15  mfu: 29.64%
[rank3]:2025-10-29 01:05:38,546 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:05:38,547 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1311  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank0]:2025-10-29 01:05:38,547 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:05:53,804 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,847
[rank2]:2025-10-29 01:05:53,848 - INFO - validate step: 800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,759
[rank1]:2025-10-29 01:05:53,834 - INFO - validate step: 800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,788
[rank3]:2025-10-29 01:05:53,858 - INFO - validate step: 800  loss:  0.2605  memory: 73.38GiB(52.48%)  tps: 26,752
[rank3]:2025-10-29 01:05:54,047 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0105_real_step800_rank3.svg
[rank3]:> Batch Time: 627.81 ms, GPU Bubble Ratio: 32.94%, 26.85%, 36.75%, 26.80%
[rank3]:2025-10-29 01:05:54,441 - INFO - Avg. fwd time: 14.4455 / Avg. bwd time: 42.8243 / Avg. batch time: 473.7210 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:05:54,491 - INFO - Avg. fwd time: 13.0686 / Avg. bwd time: 36.3940 / Avg. batch time: 526.4637 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:05:54,537 - INFO - Avg. fwd time: 15.2481 / Avg. bwd time: 41.9463 / Avg. batch time: 587.2879 (ms) / GPU bubble ratio: 22.09%
[rank0]:2025-10-29 01:05:54,571 - INFO - Avg. fwd time: 13.7514 / Avg. bwd time: 38.6393 / Avg. batch time: 642.9548 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:08:01,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:08:04,314 - INFO -  step: 850  loss:  0.1324  grad_norm:  0.1210  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank0]:2025-10-29 01:08:04,316 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank1]:2025-10-29 01:08:04,312 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank2]:2025-10-29 01:08:04,310 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1210  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.87  mfu: 29.61%
[rank3]:2025-10-29 01:08:04,745 - INFO - Avg. fwd time: 14.4211 / Avg. bwd time: 42.8004 / Avg. batch time: 473.3121 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:08:04,841 - INFO - Avg. fwd time: 15.2276 / Avg. bwd time: 41.9321 / Avg. batch time: 586.8547 (ms) / GPU bubble ratio: 22.08%
[rank2]:2025-10-29 01:08:04,795 - INFO - Avg. fwd time: 13.0509 / Avg. bwd time: 36.3839 / Avg. batch time: 526.0503 (ms) / GPU bubble ratio: 24.82%
[rank0]:2025-10-29 01:08:04,874 - INFO - Avg. fwd time: 13.7300 / Avg. bwd time: 38.6257 / Avg. batch time: 642.4945 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:10:11,981 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:10:14,595 - INFO -  step: 900  loss:  0.1205  grad_norm:  0.1438  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 01:10:14,597 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank2]:2025-10-29 01:10:14,590 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank1]:2025-10-29 01:10:14,593 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1438  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank3]:2025-10-29 01:10:14,781 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0110_real_step900_rank3.svg
[rank3]:> Batch Time: 626.38 ms, GPU Bubble Ratio: 32.93%, 26.81%, 36.71%, 26.84%
[rank3]:2025-10-29 01:10:15,253 - INFO - Avg. fwd time: 14.3982 / Avg. bwd time: 42.7797 / Avg. batch time: 472.9430 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:10:15,297 - INFO - Avg. fwd time: 13.0339 / Avg. bwd time: 36.3752 / Avg. batch time: 525.6775 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-10-29 01:10:15,346 - INFO - Avg. fwd time: 15.2067 / Avg. bwd time: 41.9228 / Avg. batch time: 586.4700 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:10:15,391 - INFO - Avg. fwd time: 13.7093 / Avg. bwd time: 38.6151 / Avg. batch time: 642.0887 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:12:22,377 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:12:24,995 - INFO -  step: 950  loss:  0.1359  grad_norm:  0.1494  memory: 73.38GiB(52.48%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank0]:2025-10-29 01:12:24,997 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 66.72GiB(47.72%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank1]:2025-10-29 01:12:24,993 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 64.32GiB(46.00%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank2]:2025-10-29 01:12:24,990 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1494  memory: 57.29GiB(40.97%)  tps: 6,282  tflops: 293.00  mfu: 29.63%
[rank3]:2025-10-29 01:12:25,432 - INFO - Avg. fwd time: 14.3810 / Avg. bwd time: 42.7631 / Avg. batch time: 472.6571 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:12:25,527 - INFO - Avg. fwd time: 15.1923 / Avg. bwd time: 41.9148 / Avg. batch time: 586.1380 (ms) / GPU bubble ratio: 22.06%
[rank2]:2025-10-29 01:12:25,480 - INFO - Avg. fwd time: 13.0213 / Avg. bwd time: 36.3676 / Avg. batch time: 525.3573 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-10-29 01:12:25,560 - INFO - Avg. fwd time: 13.6941 / Avg. bwd time: 38.6077 / Avg. batch time: 641.7399 (ms) / GPU bubble ratio: 34.80%
[rank0]:2025-10-29 01:14:32,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:14:35,273 - INFO -  step: 1000  loss:  0.1165  grad_norm:  0.1152  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank3]:2025-10-29 01:14:35,274 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:14:35,275 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 01:14:35,275 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 01:14:35,271 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank1]:2025-10-29 01:14:35,271 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 01:14:35,268 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1152  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank2]:2025-10-29 01:14:35,269 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 01:14:50,447 - INFO - validate step: 1000  loss:  0.2591  memory: 73.38GiB(52.48%)  tps: 26,996
[rank0]:2025-10-29 01:14:50,385 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,109
[rank1]:2025-10-29 01:14:50,416 - INFO - validate step: 1000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,045
[rank2]:2025-10-29 01:14:50,429 - INFO - validate step: 1000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,018
[rank3]:2025-10-29 01:14:50,635 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0114_real_step1000_rank3.svg
[rank3]:> Batch Time: 625.19 ms, GPU Bubble Ratio: 32.91%, 26.76%, 36.68%, 26.87%
[rank3]:2025-10-29 01:14:51,022 - INFO - Avg. fwd time: 14.3610 / Avg. bwd time: 42.7461 / Avg. batch time: 472.3444 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:14:51,072 - INFO - Avg. fwd time: 13.0062 / Avg. bwd time: 36.3607 / Avg. batch time: 525.0083 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 01:14:51,151 - INFO - Avg. fwd time: 13.6766 / Avg. bwd time: 38.6010 / Avg. batch time: 641.3640 (ms) / GPU bubble ratio: 34.79%
[rank1]:2025-10-29 01:14:51,118 - INFO - Avg. fwd time: 15.1747 / Avg. bwd time: 41.9071 / Avg. batch time: 585.7797 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 01:16:58,287 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 01:17:00,912 - INFO -  step: 1050  loss:  0.1299  grad_norm:  0.1767  memory: 73.38GiB(52.48%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank2]:2025-10-29 01:17:00,908 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank1]:2025-10-29 01:17:00,910 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.79  mfu: 29.61%
[rank0]:2025-10-29 01:17:00,914 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1767  memory: 66.72GiB(47.72%)  tps: 6,276  tflops: 292.71  mfu: 29.60%
[rank3]:2025-10-29 01:17:01,442 - INFO - Avg. fwd time: 14.3439 / Avg. bwd time: 42.7311 / Avg. batch time: 472.0723 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:17:01,487 - INFO - Avg. fwd time: 12.9938 / Avg. bwd time: 36.3537 / Avg. batch time: 524.7383 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-29 01:17:01,537 - INFO - Avg. fwd time: 15.1593 / Avg. bwd time: 41.9001 / Avg. batch time: 585.5024 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 01:17:01,583 - INFO - Avg. fwd time: 13.6620 / Avg. bwd time: 38.5946 / Avg. batch time: 641.0734 (ms) / GPU bubble ratio: 34.79%
[rank0]:2025-10-29 01:19:08,660 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:19:11,293 - INFO -  step: 1100  loss:  0.0994  grad_norm:  0.0917  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank2]:2025-10-29 01:19:11,289 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank1]:2025-10-29 01:19:11,291 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank0]:2025-10-29 01:19:11,296 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0917  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank3]:2025-10-29 01:19:11,479 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0119_real_step1100_rank3.svg
[rank3]:> Batch Time: 624.39 ms, GPU Bubble Ratio: 32.89%, 26.74%, 36.66%, 26.90%
[rank3]:2025-10-29 01:19:11,868 - INFO - Avg. fwd time: 14.3313 / Avg. bwd time: 42.7199 / Avg. batch time: 471.8713 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:19:11,918 - INFO - Avg. fwd time: 12.9848 / Avg. bwd time: 36.3488 / Avg. batch time: 524.5133 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-29 01:19:11,964 - INFO - Avg. fwd time: 15.1482 / Avg. bwd time: 41.8941 / Avg. batch time: 585.2672 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 01:19:11,996 - INFO - Avg. fwd time: 13.6509 / Avg. bwd time: 38.5898 / Avg. batch time: 640.8277 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:21:19,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:21:21,806 - INFO -  step: 1150  loss:  0.1160  grad_norm:  0.1105  memory: 73.38GiB(52.48%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank2]:2025-10-29 01:21:21,801 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 57.29GiB(40.97%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank1]:2025-10-29 01:21:21,804 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 64.32GiB(46.00%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank0]:2025-10-29 01:21:21,808 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1105  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.75  mfu: 29.60%
[rank3]:2025-10-29 01:21:22,247 - INFO - Avg. fwd time: 14.3182 / Avg. bwd time: 42.7074 / Avg. batch time: 471.6536 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:21:22,297 - INFO - Avg. fwd time: 12.9748 / Avg. bwd time: 36.3424 / Avg. batch time: 524.2938 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-10-29 01:21:22,343 - INFO - Avg. fwd time: 15.1365 / Avg. bwd time: 41.8871 / Avg. batch time: 585.0401 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 01:21:22,376 - INFO - Avg. fwd time: 13.6390 / Avg. bwd time: 38.5844 / Avg. batch time: 640.5904 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:23:29,554 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:23:32,195 - INFO -  step: 1200  loss:  0.1096  grad_norm:  0.1202  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank3]:2025-10-29 01:23:32,195 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 01:23:32,190 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank2]:2025-10-29 01:23:32,190 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 01:23:32,193 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 01:23:32,193 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:23:32,197 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1202  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 01:23:32,197 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 01:23:47,453 - INFO - validate step: 1200  loss:  0.2573  memory: 73.38GiB(52.48%)  tps: 26,846
[rank3]:2025-10-29 01:23:47,454 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 01:23:47,429 - INFO - validate step: 1200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,884
[rank1]:2025-10-29 01:23:47,430 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:23:47,442 - INFO - validate step: 1200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,857
[rank2]:2025-10-29 01:23:47,442 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:23:47,398 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,946
[rank0]:2025-10-29 01:23:47,399 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:23:47,403 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 01:23:58,449 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.01 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 01:24:01,144 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 01:24:01,152 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.75 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 01:24:04,065 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.64 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 01:24:04,504 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.05 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 01:24:04,586 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 01:24:04,585 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 01:24:04,585 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:24:04,760 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0124_real_step1200_rank3.svg
[rank3]:> Batch Time: 623.80 ms, GPU Bubble Ratio: 32.90%, 26.74%, 36.64%, 26.90%
[rank3]:2025-10-29 01:24:04,772 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:24:05,257 - INFO - Avg. fwd time: 14.3068 / Avg. bwd time: 42.6968 / Avg. batch time: 471.4664 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 01:24:05,303 - INFO - Avg. fwd time: 12.9668 / Avg. bwd time: 36.3363 / Avg. batch time: 524.1088 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-10-29 01:24:05,354 - INFO - Avg. fwd time: 15.1264 / Avg. bwd time: 41.8810 / Avg. batch time: 584.8491 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 01:24:05,401 - INFO - Avg. fwd time: 13.6286 / Avg. bwd time: 38.5786 / Avg. batch time: 640.3900 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 01:26:20,165 - INFO - [GC] Peforming periodical GC collection 1.97 seconds
[rank3]:2025-10-29 01:26:22,889 - INFO -  step: 1250  loss:  0.8588  grad_norm:  0.4771  memory: 73.38GiB(52.48%)  tps: 5,270  tflops: 245.81  mfu: 24.85%
[rank1]:2025-10-29 01:26:22,887 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 64.32GiB(46.00%)  tps: 5,270  tflops: 245.77  mfu: 24.85%
[rank0]:2025-10-29 01:26:22,892 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 66.72GiB(47.72%)  tps: 5,268  tflops: 245.72  mfu: 24.85%
[rank2]:2025-10-29 01:26:22,885 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4771  memory: 57.29GiB(40.97%)  tps: 5,270  tflops: 245.80  mfu: 24.85%
[rank3]:2025-10-29 01:26:23,356 - INFO - Avg. fwd time: 14.3287 / Avg. bwd time: 42.7159 / Avg. batch time: 471.9459 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 01:26:23,406 - INFO - Avg. fwd time: 12.9829 / Avg. bwd time: 36.3450 / Avg. batch time: 524.5966 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-10-29 01:26:23,454 - INFO - Avg. fwd time: 15.1456 / Avg. bwd time: 41.8897 / Avg. batch time: 585.3522 (ms) / GPU bubble ratio: 22.05%
[rank0]:2025-10-29 01:26:23,486 - INFO - Avg. fwd time: 13.6468 / Avg. bwd time: 38.5861 / Avg. batch time: 640.9109 (ms) / GPU bubble ratio: 34.80%
[rank0]:2025-10-29 01:28:35,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:28:38,406 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 57.29GiB(40.97%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank3]:2025-10-29 01:28:38,411 - INFO -  step: 1300  loss:  0.7258  grad_norm:  0.4589  memory: 73.38GiB(52.48%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank1]:2025-10-29 01:28:38,408 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 64.32GiB(46.00%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank0]:2025-10-29 01:28:38,413 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4589  memory: 66.72GiB(47.72%)  tps: 6,045  tflops: 281.93  mfu: 28.51%
[rank3]:2025-10-29 01:28:38,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0128_real_step1300_rank3.svg
[rank3]:> Batch Time: 624.84 ms, GPU Bubble Ratio: 32.91%, 26.76%, 36.66%, 26.88%
[rank3]:2025-10-29 01:28:39,015 - INFO - Avg. fwd time: 14.3524 / Avg. bwd time: 42.7384 / Avg. batch time: 472.3074 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-29 01:28:39,064 - INFO - Avg. fwd time: 13.0002 / Avg. bwd time: 36.3548 / Avg. batch time: 524.9680 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-29 01:28:39,112 - INFO - Avg. fwd time: 15.1664 / Avg. bwd time: 41.9016 / Avg. batch time: 585.7421 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-29 01:28:39,145 - INFO - Avg. fwd time: 13.6662 / Avg. bwd time: 38.5945 / Avg. batch time: 641.3195 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-10-29 01:30:51,260 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:30:53,991 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 57.29GiB(40.97%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank3]:2025-10-29 01:30:53,995 - INFO -  step: 1350  loss:  0.7554  grad_norm:  0.5214  memory: 73.38GiB(52.48%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank1]:2025-10-29 01:30:53,993 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 64.32GiB(46.00%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank0]:2025-10-29 01:30:53,997 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.5214  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.80  mfu: 28.49%
[rank2]:2025-10-29 01:30:54,595 - INFO - Avg. fwd time: 13.0161 / Avg. bwd time: 36.3639 / Avg. batch time: 525.3291 (ms) / GPU bubble ratio: 24.80%
[rank3]:2025-10-29 01:30:54,549 - INFO - Avg. fwd time: 14.3734 / Avg. bwd time: 42.7593 / Avg. batch time: 472.6344 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:30:54,646 - INFO - Avg. fwd time: 15.1857 / Avg. bwd time: 41.9136 / Avg. batch time: 586.1256 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:30:54,693 - INFO - Avg. fwd time: 13.6830 / Avg. bwd time: 38.6025 / Avg. batch time: 641.7210 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 01:33:06,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:33:09,536 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 57.29GiB(40.97%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank2]:2025-10-29 01:33:09,536 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 01:33:09,540 - INFO -  step: 1400  loss:  0.7408  grad_norm:  0.4759  memory: 73.38GiB(52.48%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank3]:2025-10-29 01:33:09,541 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:09,538 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 64.32GiB(46.00%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank1]:2025-10-29 01:33:09,538 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:09,543 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4759  memory: 66.72GiB(47.72%)  tps: 6,044  tflops: 281.88  mfu: 28.50%
[rank0]:2025-10-29 01:33:09,543 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:24,655 - INFO - validate step: 1400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,096
[rank0]:2025-10-29 01:33:24,624 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,160
[rank3]:2025-10-29 01:33:24,683 - INFO - validate step: 1400  loss:  0.2538  memory: 73.38GiB(52.48%)  tps: 27,050
[rank2]:2025-10-29 01:33:24,668 - INFO - validate step: 1400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,068
[rank3]:2025-10-29 01:33:24,867 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0133_real_step1400_rank3.svg
[rank3]:> Batch Time: 626.05 ms, GPU Bubble Ratio: 32.93%, 26.80%, 36.71%, 26.85%
[rank3]:2025-10-29 01:33:25,284 - INFO - Avg. fwd time: 14.3898 / Avg. bwd time: 42.7761 / Avg. batch time: 472.8934 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:33:25,334 - INFO - Avg. fwd time: 13.0283 / Avg. bwd time: 36.3712 / Avg. batch time: 525.5939 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-10-29 01:33:25,381 - INFO - Avg. fwd time: 15.2010 / Avg. bwd time: 41.9229 / Avg. batch time: 586.4065 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:33:25,414 - INFO - Avg. fwd time: 13.6959 / Avg. bwd time: 38.6092 / Avg. batch time: 642.0156 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 01:35:37,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:35:40,319 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 57.29GiB(40.97%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank3]:2025-10-29 01:35:40,323 - INFO -  step: 1450  loss:  0.7782  grad_norm:  0.5112  memory: 73.38GiB(52.48%)  tps: 6,040  tflops: 281.69  mfu: 28.48%
[rank1]:2025-10-29 01:35:40,321 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 64.32GiB(46.00%)  tps: 6,038  tflops: 281.63  mfu: 28.48%
[rank0]:2025-10-29 01:35:40,325 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.5112  memory: 66.72GiB(47.72%)  tps: 6,037  tflops: 281.56  mfu: 28.47%
[rank2]:2025-10-29 01:35:40,836 - INFO - Avg. fwd time: 13.0412 / Avg. bwd time: 36.3791 / Avg. batch time: 525.9164 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-10-29 01:35:40,785 - INFO - Avg. fwd time: 14.4087 / Avg. bwd time: 42.7947 / Avg. batch time: 473.1872 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-29 01:35:40,882 - INFO - Avg. fwd time: 15.2180 / Avg. bwd time: 41.9340 / Avg. batch time: 586.7492 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:35:40,916 - INFO - Avg. fwd time: 13.7106 / Avg. bwd time: 38.6171 / Avg. batch time: 642.3739 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:37:53,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:37:55,794 - INFO -  step: 1500  loss:  0.6643  grad_norm:  0.4642  memory: 73.38GiB(52.48%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank2]:2025-10-29 01:37:55,789 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 57.29GiB(40.97%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank1]:2025-10-29 01:37:55,792 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 64.32GiB(46.00%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank0]:2025-10-29 01:37:55,796 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4642  memory: 66.72GiB(47.72%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank3]:2025-10-29 01:37:55,980 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0137_real_step1500_rank3.svg
[rank3]:> Batch Time: 627.05 ms, GPU Bubble Ratio: 32.96%, 26.82%, 36.73%, 26.83%
[rank3]:2025-10-29 01:37:56,482 - INFO - Avg. fwd time: 14.4255 / Avg. bwd time: 42.8114 / Avg. batch time: 473.4486 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-29 01:37:56,527 - INFO - Avg. fwd time: 13.0533 / Avg. bwd time: 36.3861 / Avg. batch time: 526.2055 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:37:56,578 - INFO - Avg. fwd time: 15.2329 / Avg. bwd time: 41.9440 / Avg. batch time: 587.0549 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:37:56,624 - INFO - Avg. fwd time: 13.7238 / Avg. bwd time: 38.6238 / Avg. batch time: 642.6941 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:40:08,700 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:40:11,424 - INFO -  step: 1550  loss:  0.7235  grad_norm:  0.4610  memory: 73.38GiB(52.48%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank2]:2025-10-29 01:40:11,420 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 57.29GiB(40.97%)  tps: 6,040  tflops: 281.70  mfu: 28.48%
[rank1]:2025-10-29 01:40:11,422 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 64.32GiB(46.00%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank0]:2025-10-29 01:40:11,427 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4610  memory: 66.72GiB(47.72%)  tps: 6,040  tflops: 281.70  mfu: 28.48%
[rank3]:2025-10-29 01:40:11,887 - INFO - Avg. fwd time: 14.4398 / Avg. bwd time: 42.8250 / Avg. batch time: 473.6664 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:40:11,937 - INFO - Avg. fwd time: 13.0638 / Avg. bwd time: 36.3920 / Avg. batch time: 526.4287 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:40:11,984 - INFO - Avg. fwd time: 15.2462 / Avg. bwd time: 41.9524 / Avg. batch time: 587.2905 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:40:12,017 - INFO - Avg. fwd time: 13.7345 / Avg. bwd time: 38.6293 / Avg. batch time: 642.9398 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:42:23,151 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:42:25,791 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 57.29GiB(40.97%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank2]:2025-10-29 01:42:25,791 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 01:42:25,793 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 64.32GiB(46.00%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank1]:2025-10-29 01:42:25,793 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:42:25,798 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1717  memory: 66.72GiB(47.72%)  tps: 6,097  tflops: 284.34  mfu: 28.75%
[rank0]:2025-10-29 01:42:25,798 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 01:42:25,796 - INFO -  step: 1600  loss:  0.1055  grad_norm:  0.1717  memory: 73.38GiB(52.48%)  tps: 6,097  tflops: 284.35  mfu: 28.75%
[rank3]:2025-10-29 01:42:25,796 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:42:40,911 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,103
[rank3]:2025-10-29 01:42:40,968 - INFO - validate step: 1600  loss:  0.2535  memory: 73.38GiB(52.48%)  tps: 26,999
[rank2]:2025-10-29 01:42:40,955 - INFO - validate step: 1600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,012
[rank1]:2025-10-29 01:42:40,942 - INFO - validate step: 1600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,039
[rank3]:2025-10-29 01:42:41,155 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0142_real_step1600_rank3.svg
[rank3]:> Batch Time: 627.89 ms, GPU Bubble Ratio: 32.97%, 26.84%, 36.76%, 26.81%
[rank3]:2025-10-29 01:42:41,551 - INFO - Avg. fwd time: 14.4495 / Avg. bwd time: 42.8350 / Avg. batch time: 473.8171 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:42:41,600 - INFO - Avg. fwd time: 13.0709 / Avg. bwd time: 36.3958 / Avg. batch time: 526.5785 (ms) / GPU bubble ratio: 24.85%
[rank1]:2025-10-29 01:42:41,647 - INFO - Avg. fwd time: 15.2559 / Avg. bwd time: 41.9583 / Avg. batch time: 587.4475 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:42:41,680 - INFO - Avg. fwd time: 13.7422 / Avg. bwd time: 38.6337 / Avg. batch time: 643.1039 (ms) / GPU bubble ratio: 34.85%
[rank0]:2025-10-29 01:44:48,774 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 01:44:51,402 - INFO -  step: 1650  loss:  0.0896  grad_norm:  0.1604  memory: 73.38GiB(52.48%)  tps: 6,281  tflops: 292.93  mfu: 29.62%
[rank2]:2025-10-29 01:44:51,397 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank0]:2025-10-29 01:44:51,404 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 01:44:51,399 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1604  memory: 64.32GiB(46.00%)  tps: 6,279  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:44:51,925 - INFO - Avg. fwd time: 14.4369 / Avg. bwd time: 42.8226 / Avg. batch time: 473.6063 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:44:51,972 - INFO - Avg. fwd time: 13.0617 / Avg. bwd time: 36.3903 / Avg. batch time: 526.3651 (ms) / GPU bubble ratio: 24.84%
[rank1]:2025-10-29 01:44:52,025 - INFO - Avg. fwd time: 15.2443 / Avg. bwd time: 41.9513 / Avg. batch time: 587.2218 (ms) / GPU bubble ratio: 22.08%
[rank0]:2025-10-29 01:44:52,073 - INFO - Avg. fwd time: 13.7312 / Avg. bwd time: 38.6277 / Avg. batch time: 642.8682 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:46:59,154 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 01:47:01,767 - INFO -  step: 1700  loss:  0.0922  grad_norm:  0.1532  memory: 73.38GiB(52.48%)  tps: 6,284  tflops: 293.09  mfu: 29.63%
[rank2]:2025-10-29 01:47:01,762 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 57.29GiB(40.97%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank1]:2025-10-29 01:47:01,765 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 64.32GiB(46.00%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank0]:2025-10-29 01:47:01,769 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1532  memory: 66.72GiB(47.72%)  tps: 6,284  tflops: 293.08  mfu: 29.63%
[rank3]:2025-10-29 01:47:01,959 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0147_real_step1700_rank3.svg
[rank3]:> Batch Time: 627.08 ms, GPU Bubble Ratio: 32.96%, 26.82%, 36.72%, 26.83%
[rank3]:2025-10-29 01:47:02,347 - INFO - Avg. fwd time: 14.4258 / Avg. bwd time: 42.8129 / Avg. batch time: 473.4310 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:47:02,396 - INFO - Avg. fwd time: 13.0535 / Avg. bwd time: 36.3864 / Avg. batch time: 526.1711 (ms) / GPU bubble ratio: 24.83%
[rank1]:2025-10-29 01:47:02,443 - INFO - Avg. fwd time: 15.2347 / Avg. bwd time: 41.9470 / Avg. batch time: 587.0190 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:47:02,474 - INFO - Avg. fwd time: 13.7214 / Avg. bwd time: 38.6232 / Avg. batch time: 642.6559 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:49:09,619 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:49:12,230 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank0]:2025-10-29 01:49:12,237 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 66.72GiB(47.72%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank3]:2025-10-29 01:49:12,235 - INFO -  step: 1750  loss:  0.1020  grad_norm:  0.1470  memory: 73.38GiB(52.48%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank1]:2025-10-29 01:49:12,233 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1470  memory: 64.32GiB(46.00%)  tps: 6,279  tflops: 292.85  mfu: 29.61%
[rank3]:2025-10-29 01:49:12,675 - INFO - Avg. fwd time: 14.4143 / Avg. bwd time: 42.8028 / Avg. batch time: 473.2482 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 01:49:12,724 - INFO - Avg. fwd time: 13.0449 / Avg. bwd time: 36.3822 / Avg. batch time: 525.9862 (ms) / GPU bubble ratio: 24.82%
[rank1]:2025-10-29 01:49:12,770 - INFO - Avg. fwd time: 15.2240 / Avg. bwd time: 41.9422 / Avg. batch time: 586.8230 (ms) / GPU bubble ratio: 22.07%
[rank0]:2025-10-29 01:49:12,803 - INFO - Avg. fwd time: 13.7116 / Avg. bwd time: 38.6183 / Avg. batch time: 642.4504 (ms) / GPU bubble ratio: 34.84%
[rank0]:2025-10-29 01:51:19,934 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:51:22,555 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank2]:2025-10-29 01:51:22,555 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 01:51:22,557 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank1]:2025-10-29 01:51:22,557 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 01:51:22,560 - INFO -  step: 1800  loss:  0.0823  grad_norm:  0.1123  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.18  mfu: 29.64%
[rank3]:2025-10-29 01:51:22,560 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:51:22,562 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1123  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 01:51:22,562 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:51:37,765 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,943
[rank2]:2025-10-29 01:51:37,809 - INFO - validate step: 1800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,853
[rank1]:2025-10-29 01:51:37,798 - INFO - validate step: 1800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,876
[rank3]:2025-10-29 01:51:37,822 - INFO - validate step: 1800  loss:  0.2561  memory: 73.38GiB(52.48%)  tps: 26,840
[rank3]:2025-10-29 01:51:38,010 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0151_real_step1800_rank3.svg
[rank3]:> Batch Time: 626.41 ms, GPU Bubble Ratio: 32.94%, 26.79%, 36.72%, 26.84%
[rank2]:2025-10-29 01:51:38,531 - INFO - Avg. fwd time: 13.0363 / Avg. bwd time: 36.3781 / Avg. batch time: 525.8032 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-10-29 01:51:38,484 - INFO - Avg. fwd time: 14.4029 / Avg. bwd time: 42.7927 / Avg. batch time: 473.0673 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:51:38,584 - INFO - Avg. fwd time: 15.2134 / Avg. bwd time: 41.9369 / Avg. batch time: 586.6274 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-29 01:51:38,631 - INFO - Avg. fwd time: 13.7022 / Avg. bwd time: 38.6136 / Avg. batch time: 642.2457 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:53:45,662 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:53:48,276 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank2]:2025-10-29 01:53:48,274 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 57.29GiB(40.97%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank3]:2025-10-29 01:53:48,278 - INFO -  step: 1850  loss:  0.0636  grad_norm:  0.1274  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank0]:2025-10-29 01:53:48,280 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1274  memory: 66.72GiB(47.72%)  tps: 6,277  tflops: 292.74  mfu: 29.60%
[rank3]:2025-10-29 01:53:48,719 - INFO - Avg. fwd time: 14.3943 / Avg. bwd time: 42.7844 / Avg. batch time: 472.9248 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:53:48,815 - INFO - Avg. fwd time: 15.2054 / Avg. bwd time: 41.9323 / Avg. batch time: 586.4552 (ms) / GPU bubble ratio: 22.06%
[rank2]:2025-10-29 01:53:48,770 - INFO - Avg. fwd time: 13.0301 / Avg. bwd time: 36.3744 / Avg. batch time: 525.6440 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 01:53:48,850 - INFO - Avg. fwd time: 13.6940 / Avg. bwd time: 38.6088 / Avg. batch time: 642.0642 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:55:56,029 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:55:58,659 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank2]:2025-10-29 01:55:58,656 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank3]:2025-10-29 01:55:58,661 - INFO -  step: 1900  loss:  0.0810  grad_norm:  0.1204  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.05  mfu: 29.63%
[rank0]:2025-10-29 01:55:58,663 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1204  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank3]:2025-10-29 01:55:58,853 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0155_real_step1900_rank3.svg
[rank3]:> Batch Time: 625.80 ms, GPU Bubble Ratio: 32.94%, 26.79%, 36.70%, 26.86%
[rank3]:2025-10-29 01:55:59,247 - INFO - Avg. fwd time: 14.3846 / Avg. bwd time: 42.7755 / Avg. batch time: 472.7671 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:55:59,343 - INFO - Avg. fwd time: 15.1964 / Avg. bwd time: 41.9277 / Avg. batch time: 586.2670 (ms) / GPU bubble ratio: 22.05%
[rank2]:2025-10-29 01:55:59,296 - INFO - Avg. fwd time: 13.0228 / Avg. bwd time: 36.3705 / Avg. batch time: 525.4671 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-10-29 01:55:59,375 - INFO - Avg. fwd time: 13.6853 / Avg. bwd time: 38.6038 / Avg. batch time: 641.8656 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 01:58:06,478 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:58:09,113 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank2]:2025-10-29 01:58:09,110 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:58:09,115 - INFO -  step: 1950  loss:  0.1023  grad_norm:  0.1673  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.89  mfu: 29.61%
[rank0]:2025-10-29 01:58:09,117 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1673  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.88  mfu: 29.61%
[rank3]:2025-10-29 01:58:09,648 - INFO - Avg. fwd time: 14.3755 / Avg. bwd time: 42.7670 / Avg. batch time: 472.6192 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 01:58:09,748 - INFO - Avg. fwd time: 15.1886 / Avg. bwd time: 41.9234 / Avg. batch time: 586.1070 (ms) / GPU bubble ratio: 22.05%
[rank2]:2025-10-29 01:58:09,695 - INFO - Avg. fwd time: 13.0162 / Avg. bwd time: 36.3665 / Avg. batch time: 525.3193 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-10-29 01:58:09,797 - INFO - Avg. fwd time: 13.6776 / Avg. bwd time: 38.5991 / Avg. batch time: 641.6977 (ms) / GPU bubble ratio: 34.83%
[rank0]:2025-10-29 02:00:16,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:00:19,456 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank1]:2025-10-29 02:00:19,456 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 02:00:19,453 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank2]:2025-10-29 02:00:19,453 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 02:00:19,458 - INFO -  step: 2000  loss:  0.0907  grad_norm:  0.1389  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank3]:2025-10-29 02:00:19,459 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 02:00:19,460 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1389  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank0]:2025-10-29 02:00:19,460 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 02:00:34,601 - INFO - validate step: 2000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,042
[rank0]:2025-10-29 02:00:34,557 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,132
[rank1]:2025-10-29 02:00:34,588 - INFO - validate step: 2000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,070
[rank3]:2025-10-29 02:00:34,614 - INFO - validate step: 2000  loss:  0.2573  memory: 73.38GiB(52.48%)  tps: 27,027
[rank3]:2025-10-29 02:00:34,803 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0200_real_step2000_rank3.svg
[rank3]:> Batch Time: 625.29 ms, GPU Bubble Ratio: 32.94%, 26.76%, 36.68%, 26.86%
[rank3]:2025-10-29 02:00:35,205 - INFO - Avg. fwd time: 14.3674 / Avg. bwd time: 42.7598 / Avg. batch time: 472.4899 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:00:35,254 - INFO - Avg. fwd time: 13.0101 / Avg. bwd time: 36.3635 / Avg. batch time: 525.1747 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-29 02:00:35,302 - INFO - Avg. fwd time: 15.1814 / Avg. bwd time: 41.9203 / Avg. batch time: 585.9532 (ms) / GPU bubble ratio: 22.04%
[rank0]:2025-10-29 02:00:35,334 - INFO - Avg. fwd time: 13.6703 / Avg. bwd time: 38.5952 / Avg. batch time: 641.5361 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:02:42,497 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:02:45,133 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 64.32GiB(46.00%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank2]:2025-10-29 02:02:45,131 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 57.29GiB(40.97%)  tps: 6,276  tflops: 292.71  mfu: 29.60%
[rank3]:2025-10-29 02:02:45,136 - INFO -  step: 2050  loss:  0.1219  grad_norm:  0.1369  memory: 73.38GiB(52.48%)  tps: 6,276  tflops: 292.73  mfu: 29.60%
[rank0]:2025-10-29 02:02:45,138 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1369  memory: 66.72GiB(47.72%)  tps: 6,274  tflops: 292.60  mfu: 29.59%
[rank3]:2025-10-29 02:02:45,574 - INFO - Avg. fwd time: 14.3597 / Avg. bwd time: 42.7523 / Avg. batch time: 472.3614 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:02:45,670 - INFO - Avg. fwd time: 15.1746 / Avg. bwd time: 41.9156 / Avg. batch time: 585.8123 (ms) / GPU bubble ratio: 22.04%
[rank2]:2025-10-29 02:02:45,623 - INFO - Avg. fwd time: 13.0045 / Avg. bwd time: 36.3603 / Avg. batch time: 525.0460 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 02:02:45,703 - INFO - Avg. fwd time: 13.6630 / Avg. bwd time: 38.5905 / Avg. batch time: 641.3869 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:04:52,810 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:04:55,416 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank3]:2025-10-29 02:04:55,421 - INFO -  step: 2100  loss:  0.1058  grad_norm:  0.1260  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.27  mfu: 29.65%
[rank0]:2025-10-29 02:04:55,423 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank1]:2025-10-29 02:04:55,419 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1260  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank3]:2025-10-29 02:04:55,616 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0204_real_step2100_rank3.svg
[rank3]:> Batch Time: 624.84 ms, GPU Bubble Ratio: 32.93%, 26.74%, 36.66%, 26.88%
[rank3]:2025-10-29 02:04:56,093 - INFO - Avg. fwd time: 14.3518 / Avg. bwd time: 42.7450 / Avg. batch time: 472.2331 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:04:56,139 - INFO - Avg. fwd time: 12.9987 / Avg. bwd time: 36.3573 / Avg. batch time: 524.9188 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 02:04:56,239 - INFO - Avg. fwd time: 13.6563 / Avg. bwd time: 38.5869 / Avg. batch time: 641.2437 (ms) / GPU bubble ratio: 34.82%
[rank1]:2025-10-29 02:04:56,190 - INFO - Avg. fwd time: 15.1674 / Avg. bwd time: 41.9123 / Avg. batch time: 585.6756 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 02:07:03,293 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:07:05,904 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank3]:2025-10-29 02:07:05,909 - INFO -  step: 2150  loss:  0.1123  grad_norm:  0.1891  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank0]:2025-10-29 02:07:05,911 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank1]:2025-10-29 02:07:05,907 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1891  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank2]:2025-10-29 02:07:06,400 - INFO - Avg. fwd time: 12.9942 / Avg. bwd time: 36.3545 / Avg. batch time: 524.8048 (ms) / GPU bubble ratio: 24.77%
[rank3]:2025-10-29 02:07:06,351 - INFO - Avg. fwd time: 14.3458 / Avg. bwd time: 42.7391 / Avg. batch time: 472.1328 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:07:06,447 - INFO - Avg. fwd time: 15.1623 / Avg. bwd time: 41.9090 / Avg. batch time: 585.5535 (ms) / GPU bubble ratio: 22.03%
[rank0]:2025-10-29 02:07:06,480 - INFO - Avg. fwd time: 13.6509 / Avg. bwd time: 38.5836 / Avg. batch time: 641.1151 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:09:13,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:09:16,158 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 64.32GiB(46.00%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank1]:2025-10-29 02:09:16,158 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:09:16,156 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 57.29GiB(40.97%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank2]:2025-10-29 02:09:16,156 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 02:09:16,160 - INFO -  step: 2200  loss:  0.0939  grad_norm:  0.1147  memory: 73.38GiB(52.48%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank3]:2025-10-29 02:09:16,161 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 02:09:16,163 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1147  memory: 66.72GiB(47.72%)  tps: 6,289  tflops: 293.34  mfu: 29.66%
[rank0]:2025-10-29 02:09:16,163 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:09:31,357 - INFO - validate step: 2200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,946
[rank0]:2025-10-29 02:09:31,312 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,038
[rank1]:2025-10-29 02:09:31,344 - INFO - validate step: 2200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,974
[rank3]:2025-10-29 02:09:31,368 - INFO - validate step: 2200  loss:  0.2564  memory: 73.38GiB(52.48%)  tps: 26,936
[rank3]:2025-10-29 02:09:31,563 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0209_real_step2200_rank3.svg
[rank3]:> Batch Time: 624.55 ms, GPU Bubble Ratio: 32.95%, 26.76%, 36.67%, 26.88%
[rank3]:2025-10-29 02:09:31,956 - INFO - Avg. fwd time: 14.3379 / Avg. bwd time: 42.7322 / Avg. batch time: 472.0080 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:09:32,007 - INFO - Avg. fwd time: 12.9882 / Avg. bwd time: 36.3518 / Avg. batch time: 524.6634 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-29 02:09:32,052 - INFO - Avg. fwd time: 15.1552 / Avg. bwd time: 41.9057 / Avg. batch time: 585.4039 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:09:32,083 - INFO - Avg. fwd time: 13.6438 / Avg. bwd time: 38.5799 / Avg. batch time: 640.9575 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:11:39,145 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:11:41,763 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 57.29GiB(40.97%)  tps: 6,282  tflops: 292.99  mfu: 29.62%
[rank0]:2025-10-29 02:11:41,770 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 66.72GiB(47.72%)  tps: 6,279  tflops: 292.87  mfu: 29.61%
[rank1]:2025-10-29 02:11:41,766 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1608  memory: 64.32GiB(46.00%)  tps: 6,281  tflops: 292.96  mfu: 29.62%
[rank3]:2025-10-29 02:11:41,768 - INFO -  step: 2250  loss:  0.1085  grad_norm:  0.1608  memory: 73.38GiB(52.48%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank3]:2025-10-29 02:11:42,299 - INFO - Avg. fwd time: 14.3307 / Avg. bwd time: 42.7255 / Avg. batch time: 471.8911 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:11:42,348 - INFO - Avg. fwd time: 12.9828 / Avg. bwd time: 36.3487 / Avg. batch time: 524.5479 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-29 02:11:42,403 - INFO - Avg. fwd time: 15.1486 / Avg. bwd time: 41.9023 / Avg. batch time: 585.2801 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:11:42,452 - INFO - Avg. fwd time: 13.6370 / Avg. bwd time: 38.5756 / Avg. batch time: 640.8262 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:13:49,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:13:52,095 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 64.32GiB(46.00%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank2]:2025-10-29 02:13:52,092 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 57.29GiB(40.97%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank3]:2025-10-29 02:13:52,098 - INFO -  step: 2300  loss:  0.0830  grad_norm:  0.1165  memory: 73.38GiB(52.48%)  tps: 6,286  tflops: 293.17  mfu: 29.64%
[rank0]:2025-10-29 02:13:52,099 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1165  memory: 66.72GiB(47.72%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank3]:2025-10-29 02:13:52,292 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0213_real_step2300_rank3.svg
[rank3]:> Batch Time: 624.16 ms, GPU Bubble Ratio: 32.94%, 26.73%, 36.65%, 26.89%
[rank2]:2025-10-29 02:13:52,733 - INFO - Avg. fwd time: 12.9789 / Avg. bwd time: 36.3461 / Avg. batch time: 524.4465 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-10-29 02:13:52,686 - INFO - Avg. fwd time: 14.3253 / Avg. bwd time: 42.7204 / Avg. batch time: 471.8020 (ms) / GPU bubble ratio: 3.27%
[rank1]:2025-10-29 02:13:52,782 - INFO - Avg. fwd time: 15.1435 / Avg. bwd time: 41.8996 / Avg. batch time: 585.1719 (ms) / GPU bubble ratio: 22.02%
[rank0]:2025-10-29 02:13:52,813 - INFO - Avg. fwd time: 13.6313 / Avg. bwd time: 38.5718 / Avg. batch time: 640.7104 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 02:15:59,946 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:16:02,591 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 66.72GiB(47.72%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank1]:2025-10-29 02:16:02,587 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 64.32GiB(46.00%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank2]:2025-10-29 02:16:02,584 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0993  memory: 57.29GiB(40.97%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank3]:2025-10-29 02:16:02,589 - INFO -  step: 2350  loss:  0.0948  grad_norm:  0.0993  memory: 73.38GiB(52.48%)  tps: 6,278  tflops: 292.80  mfu: 29.61%
[rank3]:2025-10-29 02:16:03,038 - INFO - Avg. fwd time: 14.3188 / Avg. bwd time: 42.7147 / Avg. batch time: 471.6987 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 02:16:03,087 - INFO - Avg. fwd time: 12.9742 / Avg. bwd time: 36.3436 / Avg. batch time: 524.3438 (ms) / GPU bubble ratio: 24.76%
[rank0]:2025-10-29 02:16:03,165 - INFO - Avg. fwd time: 13.6264 / Avg. bwd time: 38.5697 / Avg. batch time: 640.5943 (ms) / GPU bubble ratio: 34.82%
[rank1]:2025-10-29 02:16:03,133 - INFO - Avg. fwd time: 15.1380 / Avg. bwd time: 41.8965 / Avg. batch time: 585.0610 (ms) / GPU bubble ratio: 22.01%
[rank0]:2025-10-29 02:18:10,328 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:18:12,972 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 57.29GiB(40.97%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank2]:2025-10-29 02:18:12,972 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.75  mfu: 28.68%
[rank3]:2025-10-29 02:18:12,976 - INFO -  step: 2400  loss:  0.0983  grad_norm:  0.1400  memory: 73.38GiB(52.48%)  tps: 6,283  tflops: 293.04  mfu: 29.63%
[rank2]:2025-10-29 02:18:12,972 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 02:18:12,977 - INFO -  final step: 2400  loss:  0.0983  grad_norm:  0.1400  tps: 6,300  tflops: 293.85  mfu: 28.69%
[rank3]:2025-10-29 02:18:12,977 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 02:18:12,974 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 64.32GiB(46.00%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank1]:2025-10-29 02:18:12,974 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.74  mfu: 28.68%
[rank1]:2025-10-29 02:18:12,974 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:18:12,978 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1400  memory: 66.72GiB(47.72%)  tps: 6,283  tflops: 293.03  mfu: 29.63%
[rank0]:2025-10-29 02:18:12,979 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1400  tps: 6,298  tflops: 293.75  mfu: 28.68%
[rank0]:2025-10-29 02:18:12,979 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 02:18:28,398 - INFO - validate step: 2400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,553
[rank2]:2025-10-29 02:18:28,399 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:18:28,386 - INFO - validate step: 2400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,577
[rank1]:2025-10-29 02:18:28,387 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:18:28,391 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 02:18:28,353 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,642
[rank0]:2025-10-29 02:18:28,354 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:18:28,358 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 02:18:28,402 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 02:18:28,415 - INFO - validate step: 2400  loss:  0.2552  memory: 73.38GiB(52.48%)  tps: 26,535
[rank3]:2025-10-29 02:18:28,416 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 02:18:28,421 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 02:18:39,081 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 02:18:39,081 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 02:18:39,051 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 02:18:39,081 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 02:18:39,381 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0218_real_final2400_rank3.svg
[rank3]:> Batch Time: 623.91 ms, GPU Bubble Ratio: 32.93%, 26.72%, 36.65%, 26.89%
[rank3]:2025-10-29 02:18:39,620 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0218_thry_final2400_rank3.svg
[rank3]:> Batch Time: 460.91 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 02:18:39,620 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–…â–„â–…â–„â–„â–â–â–â–â–â–â–â–â–â–‚â–â–‚â–â–â–„â–„â–„â–„â–„â–‚â–‚â–‚â–‚â–â–â–‚â–â–â–‚â–â–‚â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‡â–†â–‡â–‡â–†â–†â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–†â–†â–†â–†â–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‡â–†â–‡â–‡â–†â–†â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–‡â–†â–†â–†â–…â–†â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.6005
[rank3]:wandb:               final/avg_loss 0.09827
[rank3]:wandb:             final/avg_mfu(%) 28.69405
[rank3]:wandb:             final/avg_tflops 293.84804
[rank3]:wandb:    final/avg_throughput(tps) 6300.32227
[rank3]:wandb:              final/grad_norm 0.13997
[rank3]:wandb:               final/max_loss 0.09827
[rank3]:wandb:                    grad_norm 0.13997
[rank3]:wandb: loss_metrics/global_avg_loss 0.09827
[rank3]:wandb: loss_metrics/global_max_loss 0.09827
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/k3khcbe8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_nofreeze_dm1/20251029-0029/wandb/run-20251029_002911-k3khcbe8/logs
[rank0]:2025-10-29 02:18:41,081 - INFO - Training completed
[rank0]:2025-10-29 02:18:41,081 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 02:18:41,368 - INFO - Process group destroyed
[rank3]:2025-10-29 02:18:41,356 - INFO - Process group destroyed
[rank1]:2025-10-29 02:18:41,356 - INFO - Process group destroyed
[rank0]:2025-10-29 02:18:41,647 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.17', 'layers.18', 'layers.21', 'layers.20', 'layers.23', 'layers.22', 'layers.24'}
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.8', 'layers.10', 'layers.14', 'layers.15', 'layers.11', 'layers.13', 'layers.12', 'layers.9'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.0', 'layers.5', 'layers.7', 'layers.6', 'layers.3', 'layers.1', 'layers.2', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'layers.26', 'norm', 'layers.29', 'layers.30', 'layers.28', 'layers.31', 'output', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 02:18:50 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_apf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] 
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] *****************************************
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 02:18:51.525000 1440926 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 02:18:57,222 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 02:18:57,388 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 02:18:57,507 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 02:18:57,551 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 02:18:58,234 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 02:18:58,236 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:18:58,241 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 02:18:58,294 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 02:18:58,297 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 02:18:58,446 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 02:18:58,448 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 02:18:58,438 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 02:18:58,440 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:19:00,100 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 02:19:00,376 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 02:19:01,996 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-29 02:19:03,528 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 02:19:03,602 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 02:19:03,603 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 02:19:03,628 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 02:19:03,725 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 02:19:03,796 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 02:19:03,796 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 02:19:03,826 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 02:19:03,826 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 02:19:03,923 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:19:03,973 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 02:19:03,996 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 02:19:03,996 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 02:19:04,251 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 02:19:04,251 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 02:19:04,221 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 02:19:04,221 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 2pi1be3k
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1/20251029-0219/wandb/run-20251029_021904-2pi1be3k
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2pi1be3k
[rank3]:2025-10-29 02:19:05,655 - INFO - WandB logging enabled
[rank3]:2025-10-29 02:19:05,659 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 02:19:05,731 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 02:19:05,731 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 02:19:05,957 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-29 02:19:05,958 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:19:05,958 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 02:19:05,956 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 02:19:05,944 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 02:19:05,931 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 02:19:05,932 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 02:19:05,944 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:19:09,177 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 02:19:09,177 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 02:19:09,177 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400.
[rank3]:2025-10-29 02:19:09,270 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank2]:2025-10-29 02:19:09,397 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank1]:2025-10-29 02:19:09,516 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 02:19:18,385 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 02:19:18,385 - INFO - Finished loading the checkpoint in 9.21 seconds.
[rank0]:2025-10-29 02:19:18,385 - INFO - Training starts at step 1
[rank2]:2025-10-29 02:19:22,883 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 44.28GiB(31.67%)  tps: 857  tflops: 39.98  mfu: 4.04%
[rank2]:2025-10-29 02:19:22,884 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 02:19:22,905 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 49.75GiB(35.58%)  tps: 865  tflops: 40.36  mfu: 4.08%
[rank0]:2025-10-29 02:19:22,905 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 02:19:22,886 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5047  memory: 49.69GiB(35.54%)  tps: 849  tflops: 39.58  mfu: 4.00%
[rank1]:2025-10-29 02:19:22,886 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 02:19:22,889 - INFO -  step:  1  loss:  0.8886  grad_norm:  0.5047  memory: 58.03GiB(41.50%)  tps: 954  tflops: 44.48  mfu: 4.50%
[rank3]:2025-10-29 02:19:22,889 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 02:19:41,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,598 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,599 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,600 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:19:41,601 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,556 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,557 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,558 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,559 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:19:41,560 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,687 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,688 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,689 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:19:41,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,646 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:19:41,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:21:33,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:21:36,115 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 57.29GiB(40.97%)  tps: 6,026  tflops: 281.04  mfu: 28.42%
[rank0]:2025-10-29 02:21:36,122 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 66.72GiB(47.72%)  tps: 6,026  tflops: 281.07  mfu: 28.42%
[rank1]:2025-10-29 02:21:36,117 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5268  memory: 64.32GiB(46.00%)  tps: 6,026  tflops: 281.04  mfu: 28.42%
[rank3]:2025-10-29 02:21:36,120 - INFO -  step: 50  loss:  0.7675  grad_norm:  0.5268  memory: 73.38GiB(52.48%)  tps: 6,026  tflops: 281.05  mfu: 28.42%
[rank2]:2025-10-29 02:21:36,635 - INFO - Avg. fwd time: 13.3965 / Avg. bwd time: 36.5105 / Avg. batch time: 537.8620 (ms) / GPU bubble ratio: 25.77%
[rank3]:2025-10-29 02:21:36,584 - INFO - Avg. fwd time: 14.8153 / Avg. bwd time: 43.1820 / Avg. batch time: 484.3336 (ms) / GPU bubble ratio: 4.20%
[rank0]:2025-10-29 02:21:36,715 - INFO - Avg. fwd time: 14.3545 / Avg. bwd time: 38.6574 / Avg. batch time: 655.2174 (ms) / GPU bubble ratio: 35.27%
[rank1]:2025-10-29 02:21:36,682 - INFO - Avg. fwd time: 15.6435 / Avg. bwd time: 42.0094 / Avg. batch time: 599.0835 (ms) / GPU bubble ratio: 23.01%
[rank2]:2025-10-29 02:22:03,259 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:03,266 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:03,261 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:04,417 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:22:21,224 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:21,225 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:21,225 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:26,758 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:22:53,790 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:22:53,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:22:53,786 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:22:59,364 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:23:15,982 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:23:21,409 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:36,367 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:23:38,027 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,720  tflops: 313.42  mfu: 31.69%
[rank2]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:23:38,027 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0030  memory: 64.67GiB(46.25%)  tps: 6,720  tflops: 313.40  mfu: 31.69%
[rank1]:2025-10-29 02:23:38,027 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:23:38,028 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0030  memory: 72.68GiB(51.98%)  tps: 6,720  tflops: 313.41  mfu: 31.69%
[rank3]:2025-10-29 02:23:43,545 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:23:43,550 - INFO -  step: 100  loss:  0.8954  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,429  tflops: 299.84  mfu: 30.32%
[rank2]:2025-10-29 02:23:43,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0223_stage2_step100.svg
[rank0]:2025-10-29 02:23:43,627 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0223_stage0_step100.svg
[rank1]:2025-10-29 02:23:43,625 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0223_stage1_step100.svg
[rank3]:2025-10-29 02:23:43,748 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0223_real_step100_rank3.svg
[rank3]:> Batch Time: 635.27 ms, GPU Bubble Ratio: 33.11%, 27.02%, 36.69%, 26.72%
[rank3]:2025-10-29 02:23:43,807 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0223_stage3_step100.svg
[rank3]:2025-10-29 02:23:44,221 - INFO - Avg. fwd time: 15.6045 / Avg. bwd time: 36.4549 / Avg. batch time: 434.4065 (ms) / GPU bubble ratio: 4.13%
[rank2]:2025-10-29 02:23:44,272 - INFO - Avg. fwd time: 14.0946 / Avg. bwd time: 30.8596 / Avg. batch time: 526.7763 (ms) / GPU bubble ratio: 31.73%
[rank1]:2025-10-29 02:23:44,319 - INFO - Avg. fwd time: 16.4497 / Avg. bwd time: 35.5277 / Avg. batch time: 581.5286 (ms) / GPU bubble ratio: 28.50%
[rank0]:2025-10-29 02:23:44,353 - INFO - Avg. fwd time: 14.8084 / Avg. bwd time: 27.7423 / Avg. batch time: 626.3358 (ms) / GPU bubble ratio: 45.65%
[rank2]:2025-10-29 02:24:10,799 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:10,806 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:10,802 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:24:16,328 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:24:32,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:32,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:32,971 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:24:38,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:24:55,036 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:24:55,037 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:24:55,036 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:00,519 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:25:17,169 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:17,170 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:25:17,169 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:22,572 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:46,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:25:49,634 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:25:49,634 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 64.67GiB(46.25%)  tps: 6,225  tflops: 290.32  mfu: 29.35%
[rank0]:2025-10-29 02:25:49,641 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:25:49,641 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 66.72GiB(47.72%)  tps: 6,224  tflops: 290.30  mfu: 29.35%
[rank1]:2025-10-29 02:25:49,637 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:25:49,637 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5343  memory: 72.68GiB(51.98%)  tps: 6,224  tflops: 290.31  mfu: 29.35%
[rank3]:2025-10-29 02:25:55,135 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:25:55,139 - INFO -  step: 150  loss:  0.8346  grad_norm:  0.5343  memory: 83.85GiB(59.97%)  tps: 6,226  tflops: 290.36  mfu: 29.36%
[rank2]:2025-10-29 02:25:55,498 - INFO - Avg. fwd time: 14.3489 / Avg. bwd time: 28.5081 / Avg. batch time: 533.2337 (ms) / GPU bubble ratio: 35.70%
[rank0]:2025-10-29 02:25:55,527 - INFO - Avg. fwd time: 14.9903 / Avg. bwd time: 23.3595 / Avg. batch time: 625.5779 (ms) / GPU bubble ratio: 50.96%
[rank1]:2025-10-29 02:25:55,522 - INFO - Avg. fwd time: 16.7421 / Avg. bwd time: 32.8208 / Avg. batch time: 585.2950 (ms) / GPU bubble ratio: 32.26%
[rank3]:2025-10-29 02:25:55,477 - INFO - Avg. fwd time: 15.9195 / Avg. bwd time: 33.6594 / Avg. batch time: 413.6318 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:11,773 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:26:17,233 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:33,922 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:33,923 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:26:33,922 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:26:39,362 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:26:56,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:26:56,033 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:26:56,032 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:01,479 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:18,114 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:23,530 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:47,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:27:50,650 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:27:50,650 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 72.68GiB(51.98%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank1]:2025-10-29 02:27:50,650 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 02:27:50,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:27:50,647 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 64.67GiB(46.25%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank2]:2025-10-29 02:27:50,648 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:27:50,654 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:27:50,654 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7066  memory: 66.72GiB(47.72%)  tps: 6,770  tflops: 315.73  mfu: 31.92%
[rank0]:2025-10-29 02:27:50,654 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 02:27:56,136 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:27:56,140 - INFO -  step: 200  loss:  0.8445  grad_norm:  0.7066  memory: 83.85GiB(59.97%)  tps: 6,770  tflops: 315.77  mfu: 31.93%
[rank3]:2025-10-29 02:27:56,140 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:28:14,728 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 17,015
[rank1]:2025-10-29 02:28:14,765 - INFO - validate step: 200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 16,986
[rank2]:2025-10-29 02:28:14,779 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 16,974
[rank2]:2025-10-29 02:28:14,861 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0228_stage2_step200.svg
[rank1]:2025-10-29 02:28:14,867 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0228_stage1_step200.svg
[rank3]:2025-10-29 02:28:14,791 - INFO - validate step: 200  loss:  0.2454  memory: 83.85GiB(59.97%)  tps: 21,962
[rank0]:2025-10-29 02:28:14,866 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0228_stage0_step200.svg
[rank3]:2025-10-29 02:28:14,977 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0228_real_step200_rank3.svg
[rank3]:> Batch Time: 385.74 ms, GPU Bubble Ratio: 65.03%, 23.32%, 33.44%, 23.73%
[rank0]:2025-10-29 02:28:14,967 - INFO - Avg. fwd time: 15.1781 / Avg. bwd time: 19.2522 / Avg. batch time: 607.6521 (ms) / GPU bubble ratio: 54.67%
[rank3]:2025-10-29 02:28:15,041 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0228_stage3_step200.svg
[rank2]:2025-10-29 02:28:15,330 - INFO - Avg. fwd time: 14.5924 / Avg. bwd time: 26.2714 / Avg. batch time: 522.0555 (ms) / GPU bubble ratio: 37.38%
[rank1]:2025-10-29 02:28:15,356 - INFO - Avg. fwd time: 17.0236 / Avg. bwd time: 30.2450 / Avg. batch time: 571.5864 (ms) / GPU bubble ratio: 33.84%
[rank3]:2025-10-29 02:28:15,308 - INFO - Avg. fwd time: 16.2082 / Avg. bwd time: 31.0038 / Avg. batch time: 394.2941 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-29 02:28:31,676 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:28:31,676 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:28:31,677 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:28:37,126 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:28:53,791 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:28:59,332 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:16,033 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:29:16,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:29:16,032 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:29:21,523 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:38,155 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:29:38,154 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:29:38,154 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:29:43,545 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:29:58,609 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:30:00,276 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 66.72GiB(47.72%)  tps: 7,761  tflops: 361.99  mfu: 36.60%
[rank2]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:00,275 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 64.67GiB(46.25%)  tps: 7,765  tflops: 362.17  mfu: 36.62%
[rank1]:2025-10-29 02:30:00,275 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:00,275 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0049  memory: 72.68GiB(51.98%)  tps: 7,764  tflops: 362.12  mfu: 36.61%
[rank3]:2025-10-29 02:30:05,659 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:30:05,663 - INFO -  step: 250  loss:  0.9926  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,389  tflops: 344.62  mfu: 34.85%
[rank3]:2025-10-29 02:30:06,072 - INFO - Avg. fwd time: 16.4376 / Avg. bwd time: 29.0020 / Avg. batch time: 379.8405 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-29 02:30:06,124 - INFO - Avg. fwd time: 14.7794 / Avg. bwd time: 24.5756 / Avg. batch time: 509.8560 (ms) / GPU bubble ratio: 38.25%
[rank0]:2025-10-29 02:30:06,202 - INFO - Avg. fwd time: 15.3317 / Avg. bwd time: 16.1396 / Avg. batch time: 590.3369 (ms) / GPU bubble ratio: 57.35%
[rank1]:2025-10-29 02:30:06,169 - INFO - Avg. fwd time: 17.2416 / Avg. bwd time: 28.2990 / Avg. batch time: 557.4667 (ms) / GPU bubble ratio: 34.65%
[rank0]:2025-10-29 02:30:32,701 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:32,694 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:32,696 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:30:38,116 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:30:54,758 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:00,182 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:16,863 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:31:16,862 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:31:16,862 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:22,274 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:38,890 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:31:38,889 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:31:38,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:31:44,313 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:31:59,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:32:00,935 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 72.68GiB(51.98%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank2]:2025-10-29 02:32:00,936 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 64.67GiB(46.25%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank0]:2025-10-29 02:32:00,936 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:00,936 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0044  memory: 66.72GiB(47.72%)  tps: 6,789  tflops: 316.65  mfu: 32.02%
[rank3]:2025-10-29 02:32:06,401 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:06,406 - INFO -  step: 300  loss:  0.9126  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,785  tflops: 316.44  mfu: 32.00%
[rank0]:2025-10-29 02:32:06,476 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0232_stage0_step300.svg
[rank1]:2025-10-29 02:32:06,477 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0232_stage1_step300.svg
[rank2]:2025-10-29 02:32:06,480 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0232_stage2_step300.svg
[rank3]:2025-10-29 02:32:06,601 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0232_real_step300_rank3.svg
[rank3]:> Batch Time: 387.21 ms, GPU Bubble Ratio: 64.80%, 23.28%, 33.66%, 23.89%
[rank3]:2025-10-29 02:32:06,666 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0232_stage3_step300.svg
[rank1]:2025-10-29 02:32:07,047 - INFO - Avg. fwd time: 17.3297 / Avg. bwd time: 27.4308 / Avg. batch time: 556.1645 (ms) / GPU bubble ratio: 35.62%
[rank2]:2025-10-29 02:32:07,024 - INFO - Avg. fwd time: 14.8573 / Avg. bwd time: 23.8247 / Avg. batch time: 509.4368 (ms) / GPU bubble ratio: 39.26%
[rank3]:2025-10-29 02:32:07,001 - INFO - Avg. fwd time: 16.5296 / Avg. bwd time: 28.1142 / Avg. batch time: 373.3002 (ms) / GPU bubble ratio: 4.33%
[rank0]:2025-10-29 02:32:07,053 - INFO - Avg. fwd time: 15.3894 / Avg. bwd time: 14.7703 / Avg. batch time: 587.6251 (ms) / GPU bubble ratio: 58.94%
[rank1]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:23,359 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:28,745 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:32:45,353 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:32:50,749 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:33:17,807 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:33:17,804 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:33:17,811 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:33:23,225 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:33:39,854 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:33:39,853 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:33:39,853 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:33:45,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:00,198 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:34:01,865 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 64.67GiB(46.25%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank0]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:01,866 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 66.72GiB(47.72%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank1]:2025-10-29 02:34:01,865 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:01,865 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0043  memory: 72.68GiB(51.98%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank0]:2025-10-29 02:34:01,971 - INFO - Avg. fwd time: 15.4174 / Avg. bwd time: 14.0837 / Avg. batch time: 585.7604 (ms) / GPU bubble ratio: 59.71%
[rank3]:2025-10-29 02:34:07,271 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:07,275 - INFO -  step: 350  loss:  0.9350  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,778  tflops: 316.11  mfu: 31.96%
[rank3]:2025-10-29 02:34:07,547 - INFO - Avg. fwd time: 16.5756 / Avg. bwd time: 27.6634 / Avg. batch time: 369.9547 (ms) / GPU bubble ratio: 4.34%
[rank2]:2025-10-29 02:34:07,570 - INFO - Avg. fwd time: 14.8977 / Avg. bwd time: 23.4485 / Avg. batch time: 508.7184 (ms) / GPU bubble ratio: 39.70%
[rank1]:2025-10-29 02:34:07,596 - INFO - Avg. fwd time: 17.3712 / Avg. bwd time: 26.9921 / Avg. batch time: 555.0023 (ms) / GPU bubble ratio: 36.05%
[rank2]:2025-10-29 02:34:23,953 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:23,952 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:23,953 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:29,326 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:34:45,944 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:34:51,335 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:07,965 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:07,964 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:07,964 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:13,326 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:29,798 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:29,797 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:29,797 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:35,202 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:49,316 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:35:50,899 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank0]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 02:35:50,898 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank2]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 02:35:50,898 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:35:50,899 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,513  tflops: 350.42  mfu: 35.43%
[rank1]:2025-10-29 02:35:50,899 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:35:56,295 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:35:56,300 - INFO -  step: 400  loss:  0.1160  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,514  tflops: 350.45  mfu: 35.44%
[rank3]:2025-10-29 02:35:56,300 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 02:36:11,006 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,372
[rank2]:2025-10-29 02:36:11,053 - INFO - validate step: 400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,323
[rank1]:2025-10-29 02:36:11,038 - INFO - validate step: 400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,338
[rank3]:2025-10-29 02:36:11,061 - INFO - validate step: 400  loss:  0.2399  memory: 83.85GiB(59.97%)  tps: 27,751
[rank0]:2025-10-29 02:36:11,139 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0236_stage0_step400.svg
[rank2]:2025-10-29 02:36:11,147 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0236_stage2_step400.svg
[rank1]:2025-10-29 02:36:11,138 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0236_stage1_step400.svg
[rank3]:2025-10-29 02:36:11,251 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0236_real_step400_rank3.svg
[rank3]:> Batch Time: 386.92 ms, GPU Bubble Ratio: 64.72%, 23.28%, 33.66%, 23.91%
[rank3]:2025-10-29 02:36:11,320 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0236_stage3_step400.svg
[rank3]:2025-10-29 02:36:11,711 - INFO - Avg. fwd time: 16.6668 / Avg. bwd time: 26.5514 / Avg. batch time: 361.6866 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-29 02:36:11,760 - INFO - Avg. fwd time: 14.9815 / Avg. bwd time: 22.5179 / Avg. batch time: 503.2190 (ms) / GPU bubble ratio: 40.38%
[rank0]:2025-10-29 02:36:11,840 - INFO - Avg. fwd time: 15.4815 / Avg. bwd time: 12.3770 / Avg. batch time: 577.4496 (ms) / GPU bubble ratio: 61.40%
[rank1]:2025-10-29 02:36:11,807 - INFO - Avg. fwd time: 17.4627 / Avg. bwd time: 25.9188 / Avg. batch time: 548.4461 (ms) / GPU bubble ratio: 36.72%
[rank2]:2025-10-29 02:36:37,297 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:36:37,300 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:36:37,304 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:36:42,752 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:36:58,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:36:58,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:36:58,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:03,827 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:37:19,438 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:24,858 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:37:40,426 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:37:40,426 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:40,427 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:37:45,819 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:37:59,918 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:38:01,479 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 72.68GiB(51.98%)  tps: 7,418  tflops: 345.96  mfu: 34.98%
[rank0]:2025-10-29 02:38:01,480 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 66.72GiB(47.72%)  tps: 7,415  tflops: 345.85  mfu: 34.97%
[rank2]:2025-10-29 02:38:01,479 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:38:01,480 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0012  memory: 64.67GiB(46.25%)  tps: 7,419  tflops: 346.00  mfu: 34.99%
[rank3]:2025-10-29 02:38:06,865 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:06,869 - INFO -  step: 450  loss:  0.1115  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,074  tflops: 329.93  mfu: 33.36%
[rank3]:2025-10-29 02:38:07,177 - INFO - Avg. fwd time: 16.6018 / Avg. bwd time: 26.1631 / Avg. batch time: 357.9702 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-10-29 02:38:07,231 - INFO - Avg. fwd time: 15.4318 / Avg. bwd time: 11.8969 / Avg. batch time: 575.5848 (ms) / GPU bubble ratio: 62.02%
[rank2]:2025-10-29 02:38:07,199 - INFO - Avg. fwd time: 14.9436 / Avg. bwd time: 22.2235 / Avg. batch time: 502.1686 (ms) / GPU bubble ratio: 40.79%
[rank1]:2025-10-29 02:38:07,224 - INFO - Avg. fwd time: 17.4141 / Avg. bwd time: 25.5858 / Avg. batch time: 547.1176 (ms) / GPU bubble ratio: 37.13%
[rank2]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:22,460 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:27,824 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:38:43,428 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:38:43,427 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:38:43,427 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:38:49,031 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:04,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:04,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:04,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:39:10,275 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:25,850 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:25,851 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:25,850 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:39:31,303 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:54,725 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:39:57,334 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:39:57,334 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 64.67GiB(46.25%)  tps: 7,071  tflops: 329.79  mfu: 33.35%
[rank1]:2025-10-29 02:39:57,336 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:39:57,337 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 72.68GiB(51.98%)  tps: 7,071  tflops: 329.78  mfu: 33.35%
[rank0]:2025-10-29 02:39:57,340 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:39:57,341 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1305  memory: 66.72GiB(47.72%)  tps: 7,071  tflops: 329.77  mfu: 33.34%
[rank3]:2025-10-29 02:40:02,759 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:02,764 - INFO -  step: 500  loss:  0.1032  grad_norm:  0.1305  memory: 83.85GiB(59.97%)  tps: 7,069  tflops: 329.68  mfu: 33.33%
[rank2]:2025-10-29 02:40:02,837 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0239_stage2_step500.svg
[rank1]:2025-10-29 02:40:02,839 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0239_stage1_step500.svg
[rank0]:2025-10-29 02:40:02,836 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0239_stage0_step500.svg
[rank0]:2025-10-29 02:40:02,928 - INFO - Avg. fwd time: 15.4060 / Avg. bwd time: 11.3146 / Avg. batch time: 571.9348 (ms) / GPU bubble ratio: 62.62%
[rank3]:2025-10-29 02:40:02,953 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0240_real_step500_rank3.svg
[rank3]:> Batch Time: 384.93 ms, GPU Bubble Ratio: 64.77%, 23.27%, 33.68%, 23.94%
[rank3]:2025-10-29 02:40:03,015 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0240_stage3_step500.svg
[rank2]:2025-10-29 02:40:03,281 - INFO - Avg. fwd time: 14.9315 / Avg. bwd time: 21.8866 / Avg. batch time: 499.4996 (ms) / GPU bubble ratio: 41.03%
[rank3]:2025-10-29 02:40:03,259 - INFO - Avg. fwd time: 16.5723 / Avg. bwd time: 25.7362 / Avg. batch time: 354.2556 (ms) / GPU bubble ratio: 4.46%
[rank1]:2025-10-29 02:40:03,306 - INFO - Avg. fwd time: 17.3939 / Avg. bwd time: 25.1988 / Avg. batch time: 544.0994 (ms) / GPU bubble ratio: 37.38%
[rank0]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:40:18,639 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:23,996 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:40:39,621 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:40:39,620 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:40:39,620 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:40:44,998 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:00,662 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:00,661 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:00,661 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:06,123 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:21,709 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:21,709 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:21,710 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:27,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:41,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:41:42,690 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:41:42,691 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 7,776  tflops: 362.68  mfu: 36.67%
[rank2]:2025-10-29 02:41:42,689 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:41:42,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 7,776  tflops: 362.65  mfu: 36.67%
[rank1]:2025-10-29 02:41:42,689 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:41:42,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 7,776  tflops: 362.66  mfu: 36.67%
[rank0]:2025-10-29 02:41:42,782 - INFO - Avg. fwd time: 15.3879 / Avg. bwd time: 10.6630 / Avg. batch time: 566.0072 (ms) / GPU bubble ratio: 63.18%
[rank3]:2025-10-29 02:41:48,107 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:41:48,116 - INFO -  step: 550  loss:  0.1058  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,776  tflops: 362.67  mfu: 36.67%
[rank3]:2025-10-29 02:41:48,362 - INFO - Avg. fwd time: 16.5508 / Avg. bwd time: 25.2702 / Avg. batch time: 350.2957 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-10-29 02:41:48,383 - INFO - Avg. fwd time: 14.9253 / Avg. bwd time: 21.5146 / Avg. batch time: 494.6653 (ms) / GPU bubble ratio: 41.07%
[rank1]:2025-10-29 02:41:48,408 - INFO - Avg. fwd time: 17.3811 / Avg. bwd time: 24.7720 / Avg. batch time: 538.8702 (ms) / GPU bubble ratio: 37.42%
[rank2]:2025-10-29 02:42:03,769 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:03,769 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:03,770 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:09,102 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:24,694 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:24,695 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:42:24,694 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:30,041 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:42:45,688 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:42:45,688 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:42:45,689 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:42:51,045 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:43:06,634 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:06,635 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:43:06,634 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:43:12,015 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:35,347 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:43:37,967 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:43:37,967 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 72.68GiB(51.98%)  tps: 7,106  tflops: 331.44  mfu: 33.51%
[rank1]:2025-10-29 02:43:37,967 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:43:37,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:43:37,972 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 66.72GiB(47.72%)  tps: 7,106  tflops: 331.43  mfu: 33.51%
[rank0]:2025-10-29 02:43:37,972 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 02:43:37,964 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:43:37,965 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0855  memory: 64.67GiB(46.25%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank2]:2025-10-29 02:43:37,965 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 02:43:43,317 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:43:43,321 - INFO -  step: 600  loss:  0.0889  grad_norm:  0.0855  memory: 83.85GiB(59.97%)  tps: 7,111  tflops: 331.65  mfu: 33.53%
[rank3]:2025-10-29 02:43:43,322 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 02:44:00,387 - INFO - validate step: 600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,270
[rank3]:2025-10-29 02:44:00,414 - INFO - validate step: 600  loss:  0.2489  memory: 83.85GiB(59.97%)  tps: 23,965
[rank0]:2025-10-29 02:44:00,350 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,304
[rank2]:2025-10-29 02:44:00,403 - INFO - validate step: 600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,255
[rank0]:2025-10-29 02:44:00,487 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0244_stage0_step600.svg
[rank2]:2025-10-29 02:44:00,491 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0244_stage2_step600.svg
[rank1]:2025-10-29 02:44:00,490 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0244_stage1_step600.svg
[rank3]:2025-10-29 02:44:00,600 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0244_real_step600_rank3.svg
[rank3]:> Batch Time: 382.24 ms, GPU Bubble Ratio: 64.81%, 23.16%, 33.65%, 24.24%
[rank3]:2025-10-29 02:44:00,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0244_stage3_step600.svg
[rank3]:2025-10-29 02:44:00,975 - INFO - Avg. fwd time: 16.5090 / Avg. bwd time: 25.0912 / Avg. batch time: 348.4806 (ms) / GPU bubble ratio: 4.50%
[rank2]:2025-10-29 02:44:00,998 - INFO - Avg. fwd time: 14.8993 / Avg. bwd time: 21.3843 / Avg. batch time: 494.4921 (ms) / GPU bubble ratio: 41.30%
[rank1]:2025-10-29 02:44:01,023 - INFO - Avg. fwd time: 17.3445 / Avg. bwd time: 24.6190 / Avg. batch time: 538.5510 (ms) / GPU bubble ratio: 37.66%
[rank0]:2025-10-29 02:44:01,030 - INFO - Avg. fwd time: 15.3532 / Avg. bwd time: 10.4503 / Avg. batch time: 565.4450 (ms) / GPU bubble ratio: 63.49%
[rank1]:2025-10-29 02:44:16,377 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:16,378 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:16,377 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:44:21,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:37,567 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:44:37,567 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:37,568 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:44:43,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:44:58,652 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:44:58,651 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:44:58,651 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:04,122 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:19,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:45:19,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:45:19,784 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:25,245 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:39,261 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:45:40,824 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 8,158  tflops: 380.47  mfu: 38.47%
[rank1]:2025-10-29 02:45:40,824 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 8,156  tflops: 380.41  mfu: 38.46%
[rank0]:2025-10-29 02:45:40,825 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:45:40,825 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 8,153  tflops: 380.27  mfu: 38.45%
[rank0]:2025-10-29 02:45:40,916 - INFO - Avg. fwd time: 15.3571 / Avg. bwd time: 9.8009 / Avg. batch time: 561.3437 (ms) / GPU bubble ratio: 64.15%
[rank3]:2025-10-29 02:45:46,333 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:45:46,337 - INFO -  step: 650  loss:  0.0924  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,734  tflops: 360.71  mfu: 36.47%
[rank3]:2025-10-29 02:45:46,584 - INFO - Avg. fwd time: 16.5156 / Avg. bwd time: 24.6446 / Avg. batch time: 344.9238 (ms) / GPU bubble ratio: 4.54%
[rank2]:2025-10-29 02:45:46,605 - INFO - Avg. fwd time: 14.9119 / Avg. bwd time: 21.0200 / Avg. batch time: 491.4400 (ms) / GPU bubble ratio: 41.51%
[rank1]:2025-10-29 02:45:46,630 - INFO - Avg. fwd time: 17.3574 / Avg. bwd time: 24.2039 / Avg. batch time: 535.1345 (ms) / GPU bubble ratio: 37.87%
[rank1]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:01,975 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:07,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:23,024 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:23,023 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:46:23,023 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:28,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:46:44,020 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:46:44,019 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:46:44,019 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:46:49,401 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:05,064 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:05,063 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:05,063 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:47:10,466 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:24,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:47:26,062 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank2]:2025-10-29 02:47:26,061 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank1]:2025-10-29 02:47:26,061 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:26,062 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank3]:2025-10-29 02:47:31,444 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:47:31,448 - INFO -  step: 700  loss:  0.0719  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,794  tflops: 363.50  mfu: 36.75%
[rank1]:2025-10-29 02:47:31,525 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0247_stage1_step700.svg
[rank0]:2025-10-29 02:47:31,524 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0247_stage0_step700.svg
[rank2]:2025-10-29 02:47:31,527 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0247_stage2_step700.svg
[rank3]:2025-10-29 02:47:31,640 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0247_real_step700_rank3.svg
[rank3]:> Batch Time: 380.68 ms, GPU Bubble Ratio: 64.87%, 23.09%, 33.61%, 24.26%
[rank3]:2025-10-29 02:47:31,706 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0247_stage3_step700.svg
[rank3]:2025-10-29 02:47:32,093 - INFO - Avg. fwd time: 16.5205 / Avg. bwd time: 24.1969 / Avg. batch time: 341.3453 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 02:47:32,142 - INFO - Avg. fwd time: 14.9233 / Avg. bwd time: 20.6540 / Avg. batch time: 488.8636 (ms) / GPU bubble ratio: 41.78%
[rank1]:2025-10-29 02:47:32,189 - INFO - Avg. fwd time: 17.3677 / Avg. bwd time: 23.7870 / Avg. batch time: 532.1857 (ms) / GPU bubble ratio: 38.13%
[rank0]:2025-10-29 02:47:32,221 - INFO - Avg. fwd time: 15.3587 / Avg. bwd time: 9.1492 / Avg. batch time: 557.7072 (ms) / GPU bubble ratio: 64.84%
[rank0]:2025-10-29 02:47:57,670 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:47:57,663 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:47:57,665 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:03,046 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:48:18,686 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:48:18,685 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:48:18,685 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:24,095 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:48:39,705 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:48:39,704 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:48:39,704 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:48:45,174 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:00,838 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:49:00,837 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:00,838 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:06,189 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:20,240 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:49:21,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank0]:2025-10-29 02:49:21,812 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank2]:2025-10-29 02:49:21,811 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:49:21,812 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,077  tflops: 330.09  mfu: 33.38%
[rank3]:2025-10-29 02:49:27,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:27,196 - INFO -  step: 750  loss:  0.1113  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,078  tflops: 330.10  mfu: 33.38%
[rank3]:2025-10-29 02:49:27,508 - INFO - Avg. fwd time: 16.4920 / Avg. bwd time: 24.1298 / Avg. batch time: 340.5512 (ms) / GPU bubble ratio: 4.57%
[rank0]:2025-10-29 02:49:27,564 - INFO - Avg. fwd time: 15.3360 / Avg. bwd time: 9.0860 / Avg. batch time: 557.9307 (ms) / GPU bubble ratio: 64.98%
[rank2]:2025-10-29 02:49:27,531 - INFO - Avg. fwd time: 14.9057 / Avg. bwd time: 20.6099 / Avg. batch time: 489.2213 (ms) / GPU bubble ratio: 41.92%
[rank1]:2025-10-29 02:49:27,556 - INFO - Avg. fwd time: 17.3434 / Avg. bwd time: 23.7335 / Avg. batch time: 532.4885 (ms) / GPU bubble ratio: 38.29%
[rank2]:2025-10-29 02:49:42,801 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:49:42,802 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:49:42,802 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:49:48,156 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:03,837 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:03,838 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:03,837 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:09,241 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:24,814 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:24,813 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:24,813 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:30,252 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:50:45,880 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:50:51,238 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:51:05,323 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:51:06,897 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:51:06,897 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 72.68GiB(51.98%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank1]:2025-10-29 02:51:06,897 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:51:06,898 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:51:06,898 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 66.72GiB(47.72%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank0]:2025-10-29 02:51:06,898 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 02:51:06,897 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:51:06,897 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0016  memory: 64.67GiB(46.25%)  tps: 7,796  tflops: 363.59  mfu: 36.76%
[rank2]:2025-10-29 02:51:06,897 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 02:51:12,262 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:51:12,266 - INFO -  step: 800  loss:  0.1375  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,797  tflops: 363.64  mfu: 36.77%
[rank3]:2025-10-29 02:51:12,266 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:51:28,867 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,645
[rank1]:2025-10-29 02:51:28,903 - INFO - validate step: 800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,613
[rank2]:2025-10-29 02:51:28,920 - INFO - validate step: 800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,599
[rank3]:2025-10-29 02:51:28,931 - INFO - validate step: 800  loss:  0.2563  memory: 83.85GiB(59.97%)  tps: 24,579
[rank1]:2025-10-29 02:51:29,010 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0251_stage1_step800.svg
[rank0]:2025-10-29 02:51:29,011 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0251_stage0_step800.svg
[rank2]:2025-10-29 02:51:29,011 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0251_stage2_step800.svg
[rank3]:2025-10-29 02:51:29,120 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0251_real_step800_rank3.svg
[rank3]:> Batch Time: 379.35 ms, GPU Bubble Ratio: 64.89%, 23.01%, 33.50%, 24.31%
[rank0]:2025-10-29 02:51:29,101 - INFO - Avg. fwd time: 15.3364 / Avg. bwd time: 8.6363 / Avg. batch time: 554.8642 (ms) / GPU bubble ratio: 65.44%
[rank3]:2025-10-29 02:51:29,188 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0251_stage3_step800.svg
[rank2]:2025-10-29 02:51:29,461 - INFO - Avg. fwd time: 14.9149 / Avg. bwd time: 20.3591 / Avg. batch time: 486.9142 (ms) / GPU bubble ratio: 42.04%
[rank3]:2025-10-29 02:51:29,438 - INFO - Avg. fwd time: 16.4966 / Avg. bwd time: 23.8258 / Avg. batch time: 338.1324 (ms) / GPU bubble ratio: 4.60%
[rank1]:2025-10-29 02:51:29,485 - INFO - Avg. fwd time: 17.3490 / Avg. bwd time: 23.4445 / Avg. batch time: 529.8954 (ms) / GPU bubble ratio: 38.41%
[rank0]:2025-10-29 02:51:44,787 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:51:44,786 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:51:44,786 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:51:50,188 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:05,859 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:52:11,250 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:37,263 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:37,267 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:37,261 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:52:42,889 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:52:58,499 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:52:58,498 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:52:58,498 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:03,996 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:53:18,114 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:53:19,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 7,396  tflops: 344.96  mfu: 34.88%
[rank1]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:53:19,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 7,395  tflops: 344.91  mfu: 34.87%
[rank0]:2025-10-29 02:53:19,680 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:53:19,681 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 7,393  tflops: 344.79  mfu: 34.86%
[rank0]:2025-10-29 02:53:19,770 - INFO - Avg. fwd time: 15.3183 / Avg. bwd time: 8.6121 / Avg. batch time: 553.7727 (ms) / GPU bubble ratio: 65.43%
[rank3]:2025-10-29 02:53:25,055 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:25,059 - INFO -  step: 850  loss:  0.1484  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,054  tflops: 329.02  mfu: 33.27%
[rank3]:2025-10-29 02:53:25,300 - INFO - Avg. fwd time: 16.4742 / Avg. bwd time: 23.7917 / Avg. batch time: 337.6580 (ms) / GPU bubble ratio: 4.60%
[rank2]:2025-10-29 02:53:25,322 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 20.3364 / Avg. batch time: 485.8901 (ms) / GPU bubble ratio: 41.98%
[rank1]:2025-10-29 02:53:25,347 - INFO - Avg. fwd time: 17.3316 / Avg. bwd time: 23.4197 / Avg. batch time: 528.8443 (ms) / GPU bubble ratio: 38.35%
[rank0]:2025-10-29 02:53:40,627 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:53:40,626 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:53:40,626 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:53:45,993 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:01,612 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:01,612 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:01,613 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:07,119 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:22,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:22,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:22,784 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:28,231 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:54:43,788 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:54:49,202 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:03,295 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:55:04,850 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank1]:2025-10-29 02:55:04,850 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank0]:2025-10-29 02:55:04,851 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:04,851 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,789  tflops: 363.29  mfu: 36.73%
[rank3]:2025-10-29 02:55:10,297 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:10,305 - INFO -  step: 900  loss:  0.1336  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,784  tflops: 363.04  mfu: 36.71%
[rank1]:2025-10-29 02:55:10,377 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0255_stage1_step900.svg
[rank0]:2025-10-29 02:55:10,378 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0255_stage0_step900.svg
[rank2]:2025-10-29 02:55:10,381 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0255_stage2_step900.svg
[rank3]:2025-10-29 02:55:10,502 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0255_real_step900_rank3.svg
[rank3]:> Batch Time: 378.22 ms, GPU Bubble Ratio: 64.86%, 22.90%, 33.42%, 24.37%
[rank3]:2025-10-29 02:55:10,564 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0255_stage3_step900.svg
[rank3]:2025-10-29 02:55:10,875 - INFO - Avg. fwd time: 16.4808 / Avg. bwd time: 23.4980 / Avg. batch time: 335.3400 (ms) / GPU bubble ratio: 4.63%
[rank0]:2025-10-29 02:55:10,931 - INFO - Avg. fwd time: 15.3223 / Avg. bwd time: 8.1763 / Avg. batch time: 551.4515 (ms) / GPU bubble ratio: 65.91%
[rank2]:2025-10-29 02:55:10,898 - INFO - Avg. fwd time: 14.9101 / Avg. bwd time: 20.0931 / Avg. batch time: 484.2935 (ms) / GPU bubble ratio: 42.18%
[rank1]:2025-10-29 02:55:10,924 - INFO - Avg. fwd time: 17.3416 / Avg. bwd time: 23.1420 / Avg. batch time: 526.9825 (ms) / GPU bubble ratio: 38.54%
[rank2]:2025-10-29 02:55:26,179 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:26,179 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:26,180 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:31,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:55:47,165 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:55:47,164 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:55:47,164 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:55:52,653 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:08,338 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:08,337 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:08,337 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:14,940 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:30,535 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:30,536 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:30,535 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:37,146 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:51,202 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:56:52,760 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:56:52,761 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank0]:2025-10-29 02:56:52,761 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:56:52,762 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank2]:2025-10-29 02:56:52,760 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:56:52,761 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,592  tflops: 354.07  mfu: 35.80%
[rank3]:2025-10-29 02:56:59,579 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:56:59,584 - INFO -  step: 950  loss:  0.1614  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,497  tflops: 349.64  mfu: 35.35%
[rank3]:2025-10-29 02:56:59,973 - INFO - Avg. fwd time: 16.4868 / Avg. bwd time: 23.2718 / Avg. batch time: 333.5623 (ms) / GPU bubble ratio: 4.64%
[rank2]:2025-10-29 02:57:00,024 - INFO - Avg. fwd time: 14.9185 / Avg. bwd time: 19.9056 / Avg. batch time: 483.2710 (ms) / GPU bubble ratio: 42.35%
[rank1]:2025-10-29 02:57:00,069 - INFO - Avg. fwd time: 17.3501 / Avg. bwd time: 22.9273 / Avg. batch time: 525.7539 (ms) / GPU bubble ratio: 38.71%
[rank0]:2025-10-29 02:57:00,103 - INFO - Avg. fwd time: 15.3254 / Avg. bwd time: 7.8413 / Avg. batch time: 549.8697 (ms) / GPU bubble ratio: 66.30%
[rank0]:2025-10-29 02:57:25,620 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:57:25,613 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:57:25,616 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:57:32,623 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:57:48,283 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:57:48,283 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:57:48,284 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:57:55,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:10,969 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:10,968 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:10,968 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:16,547 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:32,262 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:32,261 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:32,261 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:38,070 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:52,188 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:58:53,767 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank0]:2025-10-29 02:58:53,767 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:58:53,766 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank2]:2025-10-29 02:58:53,766 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 02:58:53,766 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:58:53,766 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 6,770  tflops: 315.75  mfu: 31.93%
[rank1]:2025-10-29 02:58:53,766 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 02:58:59,499 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:58:59,507 - INFO -  step: 1000  loss:  0.1154  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,831  tflops: 318.61  mfu: 32.21%
[rank3]:2025-10-29 02:58:59,508 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:59:16,289 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,187
[rank2]:2025-10-29 02:59:16,342 - INFO - validate step: 1000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,144
[rank1]:2025-10-29 02:59:16,326 - INFO - validate step: 1000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,156
[rank3]:2025-10-29 02:59:16,356 - INFO - validate step: 1000  loss:  0.2549  memory: 83.85GiB(59.97%)  tps: 24,312
[rank0]:2025-10-29 02:59:16,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0259_stage0_step1000.svg
[rank2]:2025-10-29 02:59:16,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0259_stage2_step1000.svg
[rank1]:2025-10-29 02:59:16,431 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0259_stage1_step1000.svg
[rank0]:2025-10-29 02:59:16,523 - INFO - Avg. fwd time: 15.3065 / Avg. bwd time: 7.8621 / Avg. batch time: 551.7823 (ms) / GPU bubble ratio: 66.41%
[rank3]:2025-10-29 02:59:16,553 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0259_real_step1000_rank3.svg
[rank3]:> Batch Time: 377.45 ms, GPU Bubble Ratio: 64.85%, 22.81%, 33.36%, 24.41%
[rank3]:2025-10-29 02:59:16,618 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0259_stage3_step1000.svg
[rank3]:2025-10-29 02:59:16,868 - INFO - Avg. fwd time: 16.4744 / Avg. bwd time: 23.2703 / Avg. batch time: 333.4362 (ms) / GPU bubble ratio: 4.64%
[rank2]:2025-10-29 02:59:16,889 - INFO - Avg. fwd time: 14.9102 / Avg. bwd time: 19.9078 / Avg. batch time: 485.1595 (ms) / GPU bubble ratio: 42.59%
[rank1]:2025-10-29 02:59:16,915 - INFO - Avg. fwd time: 17.3392 / Avg. bwd time: 22.9327 / Avg. batch time: 527.6575 (ms) / GPU bubble ratio: 38.94%
[rank2]:2025-10-29 02:59:32,364 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:59:32,365 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:59:32,365 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:59:37,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:59:53,674 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:59:53,673 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:59:53,673 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:59:59,210 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:14,915 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:14,916 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:14,915 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:00:20,414 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:36,165 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:36,164 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:36,164 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:00:41,845 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:55,957 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:00:57,537 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 8,091  tflops: 377.37  mfu: 38.16%
[rank2]:2025-10-29 03:00:57,536 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 8,095  tflops: 377.57  mfu: 38.18%
[rank1]:2025-10-29 03:00:57,536 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:00:57,537 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 8,094  tflops: 377.51  mfu: 38.17%
[rank3]:2025-10-29 03:01:03,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:03,260 - INFO -  step: 1050  loss:  0.1488  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,663  tflops: 357.41  mfu: 36.14%
[rank3]:2025-10-29 03:01:03,576 - INFO - Avg. fwd time: 16.4925 / Avg. bwd time: 23.0447 / Avg. batch time: 331.7632 (ms) / GPU bubble ratio: 4.66%
[rank0]:2025-10-29 03:01:03,636 - INFO - Avg. fwd time: 15.3105 / Avg. bwd time: 7.5261 / Avg. batch time: 550.2476 (ms) / GPU bubble ratio: 66.80%
[rank2]:2025-10-29 03:01:03,601 - INFO - Avg. fwd time: 14.9278 / Avg. bwd time: 19.7187 / Avg. batch time: 484.1611 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-10-29 03:01:03,627 - INFO - Avg. fwd time: 17.3600 / Avg. bwd time: 22.7206 / Avg. batch time: 526.4768 (ms) / GPU bubble ratio: 39.10%
[rank0]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:01:19,021 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:24,576 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:01:40,304 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:01:40,305 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:01:40,304 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:01:45,773 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:01,457 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:01,458 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:01,457 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:06,862 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:22,618 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:28,048 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:51,369 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:02:54,011 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:02:54,012 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 66.72GiB(47.72%)  tps: 7,033  tflops: 328.03  mfu: 33.17%
[rank2]:2025-10-29 03:02:54,005 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:02:54,005 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 64.67GiB(46.25%)  tps: 7,034  tflops: 328.05  mfu: 33.17%
[rank1]:2025-10-29 03:02:54,007 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:02:54,008 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1059  memory: 72.68GiB(51.98%)  tps: 7,034  tflops: 328.04  mfu: 33.17%
[rank3]:2025-10-29 03:02:59,451 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:02:59,456 - INFO -  step: 1100  loss:  0.0991  grad_norm:  0.1059  memory: 83.85GiB(59.97%)  tps: 7,050  tflops: 328.83  mfu: 33.25%
[rank0]:2025-10-29 03:02:59,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0302_stage0_step1100.svg
[rank2]:2025-10-29 03:02:59,530 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0302_stage2_step1100.svg
[rank1]:2025-10-29 03:02:59,531 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0302_stage1_step1100.svg
[rank0]:2025-10-29 03:02:59,621 - INFO - Avg. fwd time: 15.3034 / Avg. bwd time: 7.4420 / Avg. batch time: 549.6965 (ms) / GPU bubble ratio: 66.90%
[rank3]:2025-10-29 03:02:59,647 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0302_real_step1100_rank3.svg
[rank3]:> Batch Time: 377.36 ms, GPU Bubble Ratio: 64.87%, 22.78%, 33.34%, 24.41%
[rank3]:2025-10-29 03:02:59,710 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0302_stage3_step1100.svg
[rank3]:2025-10-29 03:02:59,960 - INFO - Avg. fwd time: 16.4930 / Avg. bwd time: 22.9814 / Avg. batch time: 331.2506 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-10-29 03:02:59,981 - INFO - Avg. fwd time: 14.9294 / Avg. bwd time: 19.6669 / Avg. batch time: 483.7482 (ms) / GPU bubble ratio: 42.79%
[rank1]:2025-10-29 03:03:00,006 - INFO - Avg. fwd time: 17.3618 / Avg. bwd time: 22.6641 / Avg. batch time: 526.0202 (ms) / GPU bubble ratio: 39.13%
[rank0]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:15,340 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:03:20,746 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:36,428 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:03:41,822 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:03:57,361 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:03:57,360 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:03:57,360 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:02,826 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:18,468 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:04:18,467 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:04:18,467 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:23,898 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:37,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:04:39,558 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,762  tflops: 362.00  mfu: 36.60%
[rank2]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:04:39,557 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,761  tflops: 361.98  mfu: 36.60%
[rank1]:2025-10-29 03:04:39,557 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:04:39,557 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,761  tflops: 361.99  mfu: 36.60%
[rank0]:2025-10-29 03:04:39,649 - INFO - Avg. fwd time: 15.2987 / Avg. bwd time: 7.3086 / Avg. batch time: 547.9377 (ms) / GPU bubble ratio: 66.99%
[rank3]:2025-10-29 03:04:45,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:04:45,037 - INFO -  step: 1150  loss:  0.1295  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,759  tflops: 361.88  mfu: 36.59%
[rank3]:2025-10-29 03:04:45,287 - INFO - Avg. fwd time: 16.4883 / Avg. bwd time: 22.8863 / Avg. batch time: 330.4403 (ms) / GPU bubble ratio: 4.67%
[rank2]:2025-10-29 03:04:45,307 - INFO - Avg. fwd time: 14.9280 / Avg. bwd time: 19.5899 / Avg. batch time: 482.2214 (ms) / GPU bubble ratio: 42.74%
[rank1]:2025-10-29 03:04:45,332 - INFO - Avg. fwd time: 17.3578 / Avg. bwd time: 22.5764 / Avg. batch time: 524.4069 (ms) / GPU bubble ratio: 39.08%
[rank0]:2025-10-29 03:05:00,630 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:00,629 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:00,629 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:06,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:21,748 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:21,748 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:05:21,749 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:27,173 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:05:42,763 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:05:42,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:05:42,762 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:05:48,225 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:06:03,836 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:06:09,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:23,358 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:06:24,931 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank2]:2025-10-29 03:06:24,931 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:06:24,932 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank0]:2025-10-29 03:06:24,932 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 03:06:24,931 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:06:24,931 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank1]:2025-10-29 03:06:24,931 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 03:06:30,359 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:06:30,368 - INFO -  step: 1200  loss:  0.1143  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,778  tflops: 362.75  mfu: 36.68%
[rank3]:2025-10-29 03:06:30,368 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 03:06:47,018 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,546
[rank0]:2025-10-29 03:06:47,019 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:06:47,022 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 03:06:47,082 - INFO - validate step: 1200  loss:  0.2502  memory: 83.85GiB(59.97%)  tps: 24,508
[rank3]:2025-10-29 03:06:47,083 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:06:47,072 - INFO - validate step: 1200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,500
[rank2]:2025-10-29 03:06:47,073 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:06:47,056 - INFO - validate step: 1200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,513
[rank1]:2025-10-29 03:06:47,057 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:06:59,293 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.24 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 03:07:01,456 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.38 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 03:07:04,990 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.91 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 03:07:05,917 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 03:07:05,922 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.90 seconds.
[rank0]:2025-10-29 03:07:05,922 - INFO - Checkpointer is deleting /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 03:07:06,010 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0307_stage2_step1200.svg
[rank2]:2025-10-29 03:07:06,022 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 03:07:06,009 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0306_stage1_step1200.svg
[rank1]:2025-10-29 03:07:06,021 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 03:07:06,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0307_stage0_step1200.svg
[rank0]:2025-10-29 03:07:06,059 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 03:07:06,139 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0307_real_step1200_rank3.svg
[rank3]:> Batch Time: 377.00 ms, GPU Bubble Ratio: 64.87%, 22.77%, 33.32%, 24.41%
[rank3]:2025-10-29 03:07:06,208 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0307_stage3_step1200.svg
[rank3]:2025-10-29 03:07:06,219 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 03:07:07,017 - INFO - Avg. fwd time: 16.4955 / Avg. bwd time: 22.7061 / Avg. batch time: 329.1442 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 03:07:07,043 - INFO - Avg. fwd time: 14.9363 / Avg. bwd time: 19.4402 / Avg. batch time: 481.3299 (ms) / GPU bubble ratio: 42.86%
[rank1]:2025-10-29 03:07:07,071 - INFO - Avg. fwd time: 17.3670 / Avg. bwd time: 22.4047 / Avg. batch time: 523.3510 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 03:07:07,080 - INFO - Avg. fwd time: 15.3033 / Avg. bwd time: 7.0388 / Avg. batch time: 546.5988 (ms) / GPU bubble ratio: 67.30%
[rank0]:2025-10-29 03:07:11,811 - INFO - Checkpointer deleted /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1200 in 5.88 seconds.
[rank2]:2025-10-29 03:07:24,541 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:07:24,542 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:07:24,542 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:07:30,607 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:07:47,219 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:07:47,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:07:47,220 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:07:52,879 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:08:09,603 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:08:09,603 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:08:09,604 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:08:15,335 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:08:32,102 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:08:32,102 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:08:32,103 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:08:38,026 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:04,397 - INFO - [GC] Peforming periodical GC collection 2.04 seconds
[rank1]:2025-10-29 03:09:07,124 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:09:07,125 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 72.68GiB(51.98%)  tps: 5,849  tflops: 272.78  mfu: 27.58%
[rank2]:2025-10-29 03:09:07,122 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:07,122 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 64.67GiB(46.25%)  tps: 5,849  tflops: 272.81  mfu: 27.58%
[rank0]:2025-10-29 03:09:07,129 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:07,129 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.9824  memory: 66.72GiB(47.72%)  tps: 5,847  tflops: 272.70  mfu: 27.57%
[rank0]:2025-10-29 03:09:07,232 - INFO - Avg. fwd time: 15.3217 / Avg. bwd time: 6.9838 / Avg. batch time: 547.1777 (ms) / GPU bubble ratio: 67.39%
[rank3]:2025-10-29 03:09:12,682 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:12,690 - INFO -  step: 1250  loss:  0.7846  grad_norm:  0.9824  memory: 83.85GiB(59.97%)  tps: 5,626  tflops: 262.41  mfu: 26.53%
[rank3]:2025-10-29 03:09:12,968 - INFO - Avg. fwd time: 16.5194 / Avg. bwd time: 22.6862 / Avg. batch time: 329.2671 (ms) / GPU bubble ratio: 4.74%
[rank1]:2025-10-29 03:09:13,015 - INFO - Avg. fwd time: 17.3844 / Avg. bwd time: 22.3738 / Avg. batch time: 523.9669 (ms) / GPU bubble ratio: 39.30%
[rank2]:2025-10-29 03:09:12,990 - INFO - Avg. fwd time: 14.9515 / Avg. bwd time: 19.4324 / Avg. batch time: 481.9938 (ms) / GPU bubble ratio: 42.93%
[rank1]:2025-10-29 03:09:29,389 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:29,389 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:29,390 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:35,044 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:09:51,766 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:09:51,766 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:09:51,767 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:09:57,103 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:13,785 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:13,785 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:13,786 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:10:19,776 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:36,493 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:10:42,092 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:57,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:10:58,759 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 64.67GiB(46.25%)  tps: 7,338  tflops: 342.25  mfu: 34.61%
[rank1]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:10:58,759 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 72.68GiB(51.98%)  tps: 7,338  tflops: 342.26  mfu: 34.61%
[rank0]:2025-10-29 03:10:58,759 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:10:58,760 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0046  memory: 66.72GiB(47.72%)  tps: 7,338  tflops: 342.27  mfu: 34.61%
[rank3]:2025-10-29 03:11:03,738 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:03,748 - INFO -  step: 1300  loss:  0.9636  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,376  tflops: 344.04  mfu: 34.79%
[rank2]:2025-10-29 03:11:03,832 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0310_stage2_step1300.svg
[rank1]:2025-10-29 03:11:03,829 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0310_stage1_step1300.svg
[rank0]:2025-10-29 03:11:03,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0310_stage0_step1300.svg
[rank3]:2025-10-29 03:11:03,956 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0311_real_step1300_rank3.svg
[rank3]:> Batch Time: 377.74 ms, GPU Bubble Ratio: 64.84%, 22.80%, 33.36%, 24.39%
[rank0]:2025-10-29 03:11:03,935 - INFO - Avg. fwd time: 15.3432 / Avg. bwd time: 6.8855 / Avg. batch time: 547.4723 (ms) / GPU bubble ratio: 67.52%
[rank3]:2025-10-29 03:11:04,026 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0311_stage3_step1300.svg
[rank3]:2025-10-29 03:11:04,303 - INFO - Avg. fwd time: 16.5480 / Avg. bwd time: 22.6389 / Avg. batch time: 329.1069 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 03:11:04,325 - INFO - Avg. fwd time: 14.9705 / Avg. bwd time: 19.3845 / Avg. batch time: 482.4491 (ms) / GPU bubble ratio: 43.03%
[rank1]:2025-10-29 03:11:04,351 - INFO - Avg. fwd time: 17.4071 / Avg. bwd time: 22.3176 / Avg. batch time: 524.3501 (ms) / GPU bubble ratio: 39.39%
[rank2]:2025-10-29 03:11:20,620 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:11:20,619 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:11:20,620 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:25,900 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:11:42,570 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:11:47,559 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:04,197 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:09,250 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:25,863 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:25,863 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:25,864 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:30,880 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:45,875 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:12:47,545 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:12:47,545 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 72.68GiB(51.98%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank2]:2025-10-29 03:12:47,545 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:12:47,545 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 64.67GiB(46.25%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank0]:2025-10-29 03:12:47,546 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:12:47,546 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0036  memory: 66.72GiB(47.72%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank3]:2025-10-29 03:12:52,564 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:12:52,568 - INFO -  step: 1350  loss:  0.8039  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,528  tflops: 351.11  mfu: 35.50%
[rank3]:2025-10-29 03:12:52,906 - INFO - Avg. fwd time: 16.5829 / Avg. bwd time: 22.5117 / Avg. batch time: 328.3581 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:12:52,960 - INFO - Avg. fwd time: 17.4367 / Avg. bwd time: 22.1854 / Avg. batch time: 523.4518 (ms) / GPU bubble ratio: 39.44%
[rank2]:2025-10-29 03:12:52,932 - INFO - Avg. fwd time: 14.9963 / Avg. bwd time: 19.2706 / Avg. batch time: 481.6944 (ms) / GPU bubble ratio: 43.09%
[rank0]:2025-10-29 03:12:52,970 - INFO - Avg. fwd time: 15.3696 / Avg. bwd time: 6.6627 / Avg. batch time: 546.3572 (ms) / GPU bubble ratio: 67.74%
[rank1]:2025-10-29 03:13:09,210 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:09,210 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:09,211 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:14,221 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:13:30,939 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:30,939 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:30,940 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:35,972 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:13:52,591 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:13:57,664 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:14:14,293 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:14,293 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:14,294 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:14:19,415 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:34,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:36,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 72.68GiB(51.98%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank2]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:14:36,112 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 03:14:36,112 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 64.67GiB(46.25%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank2]:2025-10-29 03:14:36,112 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:14:36,112 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:14:36,113 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0034  memory: 66.72GiB(47.72%)  tps: 7,546  tflops: 351.93  mfu: 35.58%
[rank0]:2025-10-29 03:14:36,113 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:14:41,352 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:14:41,356 - INFO -  step: 1400  loss:  0.7860  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,530  tflops: 351.22  mfu: 35.51%
[rank3]:2025-10-29 03:14:41,356 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:14:56,077 - INFO - validate step: 1400  loss:  0.2452  memory: 83.85GiB(59.97%)  tps: 27,826
[rank1]:2025-10-29 03:14:56,052 - INFO - validate step: 1400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,542
[rank2]:2025-10-29 03:14:56,065 - INFO - validate step: 1400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,529
[rank0]:2025-10-29 03:14:56,020 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,576
[rank1]:2025-10-29 03:14:56,160 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0314_stage1_step1400.svg
[rank2]:2025-10-29 03:14:56,158 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0314_stage2_step1400.svg
[rank0]:2025-10-29 03:14:56,160 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0314_stage0_step1400.svg
[rank3]:2025-10-29 03:14:56,269 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0314_real_step1400_rank3.svg
[rank3]:> Batch Time: 378.61 ms, GPU Bubble Ratio: 64.80%, 22.86%, 33.41%, 24.36%
[rank3]:2025-10-29 03:14:56,338 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0314_stage3_step1400.svg
[rank3]:2025-10-29 03:14:56,754 - INFO - Avg. fwd time: 16.6104 / Avg. bwd time: 22.4097 / Avg. batch time: 327.7533 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 03:14:56,804 - INFO - Avg. fwd time: 15.0163 / Avg. bwd time: 19.1790 / Avg. batch time: 480.7902 (ms) / GPU bubble ratio: 43.10%
[rank1]:2025-10-29 03:14:56,851 - INFO - Avg. fwd time: 17.4612 / Avg. bwd time: 22.0798 / Avg. batch time: 522.4333 (ms) / GPU bubble ratio: 39.45%
[rank0]:2025-10-29 03:14:56,884 - INFO - Avg. fwd time: 15.3905 / Avg. bwd time: 6.4851 / Avg. batch time: 545.1644 (ms) / GPU bubble ratio: 67.90%
[rank1]:2025-10-29 03:15:23,400 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:15:23,398 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:15:23,405 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:15:28,625 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:15:45,344 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:15:45,344 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:15:45,345 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:15:50,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:07,252 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:07,253 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:07,253 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:12,360 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:29,014 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:29,013 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:29,014 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:34,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:49,328 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:16:50,997 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 72.68GiB(51.98%)  tps: 7,127  tflops: 332.40  mfu: 33.61%
[rank2]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:16:50,997 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 64.67GiB(46.25%)  tps: 7,128  tflops: 332.44  mfu: 33.61%
[rank0]:2025-10-29 03:16:50,997 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:16:50,998 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0032  memory: 66.72GiB(47.72%)  tps: 7,125  tflops: 332.31  mfu: 33.60%
[rank0]:2025-10-29 03:16:51,103 - INFO - Avg. fwd time: 15.4009 / Avg. bwd time: 6.5514 / Avg. batch time: 545.1708 (ms) / GPU bubble ratio: 67.79%
[rank3]:2025-10-29 03:16:56,097 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:16:56,101 - INFO -  step: 1450  loss:  0.9693  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,825  tflops: 318.34  mfu: 32.19%
[rank3]:2025-10-29 03:16:56,374 - INFO - Avg. fwd time: 16.6237 / Avg. bwd time: 22.4649 / Avg. batch time: 328.2939 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-29 03:16:56,396 - INFO - Avg. fwd time: 15.0234 / Avg. bwd time: 19.2191 / Avg. batch time: 480.6817 (ms) / GPU bubble ratio: 43.01%
[rank1]:2025-10-29 03:16:56,421 - INFO - Avg. fwd time: 17.4702 / Avg. bwd time: 22.1264 / Avg. batch time: 522.3611 (ms) / GPU bubble ratio: 39.36%
[rank1]:2025-10-29 03:17:12,754 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:12,753 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:12,754 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:17:17,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:17:34,621 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:34,621 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:34,622 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:17:39,814 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:17:56,502 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:17:56,502 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:17:56,503 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:01,644 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:18:18,237 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:18:18,237 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:18,238 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:23,369 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:38,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:18:40,015 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:18:40,015 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 72.68GiB(51.98%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank2]:2025-10-29 03:18:40,014 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:18:40,015 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 64.67GiB(46.25%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank0]:2025-10-29 03:18:40,015 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:18:40,016 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0031  memory: 66.72GiB(47.72%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank3]:2025-10-29 03:18:45,109 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:18:45,113 - INFO -  step: 1500  loss:  0.8418  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,515  tflops: 350.50  mfu: 35.44%
[rank0]:2025-10-29 03:18:45,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0318_stage0_step1500.svg
[rank1]:2025-10-29 03:18:45,193 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0318_stage1_step1500.svg
[rank2]:2025-10-29 03:18:45,196 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0318_stage2_step1500.svg
[rank3]:2025-10-29 03:18:45,306 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0318_real_step1500_rank3.svg
[rank3]:> Batch Time: 379.54 ms, GPU Bubble Ratio: 64.79%, 22.94%, 33.49%, 24.32%
[rank3]:2025-10-29 03:18:45,374 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0318_stage3_step1500.svg
[rank1]:2025-10-29 03:18:45,765 - INFO - Avg. fwd time: 17.4939 / Avg. bwd time: 22.0137 / Avg. batch time: 521.6731 (ms) / GPU bubble ratio: 39.41%
[rank2]:2025-10-29 03:18:45,738 - INFO - Avg. fwd time: 15.0437 / Avg. bwd time: 19.1215 / Avg. batch time: 480.1149 (ms) / GPU bubble ratio: 43.07%
[rank3]:2025-10-29 03:18:45,712 - INFO - Avg. fwd time: 16.6518 / Avg. bwd time: 22.3557 / Avg. batch time: 327.6363 (ms) / GPU bubble ratio: 4.75%
[rank0]:2025-10-29 03:18:45,775 - INFO - Avg. fwd time: 15.4221 / Avg. bwd time: 6.3626 / Avg. batch time: 544.2998 (ms) / GPU bubble ratio: 67.98%
[rank1]:2025-10-29 03:19:02,064 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:02,064 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:02,065 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:07,214 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:23,811 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:19:23,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:23,812 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:28,922 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:19:45,582 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:19:45,582 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:19:45,583 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:19:50,738 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:07,388 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:20:07,388 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:07,389 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:12,511 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:27,444 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:20:29,113 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 64.67GiB(46.25%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank1]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:29,113 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 72.68GiB(51.98%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank0]:2025-10-29 03:20:29,113 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:29,114 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0031  memory: 66.72GiB(47.72%)  tps: 7,509  tflops: 350.21  mfu: 35.41%
[rank0]:2025-10-29 03:20:29,222 - INFO - Avg. fwd time: 15.4396 / Avg. bwd time: 6.2109 / Avg. batch time: 543.3343 (ms) / GPU bubble ratio: 68.12%
[rank3]:2025-10-29 03:20:34,329 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:34,333 - INFO -  step: 1550  loss:  0.9173  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,501  tflops: 349.83  mfu: 35.37%
[rank2]:2025-10-29 03:20:34,627 - INFO - Avg. fwd time: 15.0605 / Avg. bwd time: 19.0428 / Avg. batch time: 479.3926 (ms) / GPU bubble ratio: 43.09%
[rank1]:2025-10-29 03:20:34,652 - INFO - Avg. fwd time: 17.5144 / Avg. bwd time: 21.9236 / Avg. batch time: 520.8550 (ms) / GPU bubble ratio: 39.43%
[rank3]:2025-10-29 03:20:34,605 - INFO - Avg. fwd time: 16.6747 / Avg. bwd time: 22.2680 / Avg. batch time: 327.1112 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 03:20:51,047 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:20:51,047 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:20:51,048 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:20:56,150 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:21:12,796 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:21:12,796 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:21:12,797 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:21:17,920 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:21:44,983 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:21:44,981 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:21:44,988 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:21:50,155 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:06,670 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:22:06,669 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:22:06,669 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:22:11,810 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:25,905 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:22:27,491 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 66.72GiB(47.72%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank0]:2025-10-29 03:22:27,491 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:22:27,490 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 64.67GiB(46.25%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank2]:2025-10-29 03:22:27,490 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 03:22:27,490 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:22:27,490 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0011  memory: 72.68GiB(51.98%)  tps: 6,920  tflops: 322.76  mfu: 32.64%
[rank1]:2025-10-29 03:22:27,490 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:22:32,582 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:22:32,588 - INFO -  step: 1600  loss:  0.1334  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,928  tflops: 323.10  mfu: 32.67%
[rank3]:2025-10-29 03:22:32,588 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 03:22:49,202 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,866
[rank1]:2025-10-29 03:22:49,240 - INFO - validate step: 1600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,833
[rank2]:2025-10-29 03:22:49,257 - INFO - validate step: 1600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,818
[rank3]:2025-10-29 03:22:49,266 - INFO - validate step: 1600  loss:  0.2432  memory: 83.85GiB(59.97%)  tps: 24,560
[rank1]:2025-10-29 03:22:49,352 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0322_stage1_step1600.svg
[rank2]:2025-10-29 03:22:49,351 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0322_stage2_step1600.svg
[rank0]:2025-10-29 03:22:49,351 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0322_stage0_step1600.svg
[rank3]:2025-10-29 03:22:49,458 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0322_real_step1600_rank3.svg
[rank3]:> Batch Time: 380.27 ms, GPU Bubble Ratio: 64.77%, 22.99%, 33.55%, 24.29%
[rank0]:2025-10-29 03:22:49,444 - INFO - Avg. fwd time: 15.4431 / Avg. bwd time: 6.2796 / Avg. batch time: 544.0655 (ms) / GPU bubble ratio: 68.06%
[rank3]:2025-10-29 03:22:49,528 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0322_stage3_step1600.svg
[rank3]:2025-10-29 03:22:49,779 - INFO - Avg. fwd time: 16.6796 / Avg. bwd time: 22.3179 / Avg. batch time: 327.5414 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:22:49,825 - INFO - Avg. fwd time: 17.5163 / Avg. bwd time: 21.9685 / Avg. batch time: 521.5109 (ms) / GPU bubble ratio: 39.43%
[rank2]:2025-10-29 03:22:49,800 - INFO - Avg. fwd time: 15.0620 / Avg. bwd time: 19.0811 / Avg. batch time: 480.0063 (ms) / GPU bubble ratio: 43.10%
[rank1]:2025-10-29 03:23:05,095 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:05,095 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:05,096 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:10,300 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:25,986 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:31,043 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:23:46,661 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:23:46,660 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:23:46,660 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:23:51,729 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:24:07,312 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:07,312 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:07,313 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:12,393 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:26,532 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:24:28,094 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:28,094 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,284  tflops: 386.36  mfu: 39.07%
[rank1]:2025-10-29 03:24:28,093 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:24:28,093 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,287  tflops: 386.51  mfu: 39.08%
[rank2]:2025-10-29 03:24:28,093 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:28,093 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,288  tflops: 386.58  mfu: 39.09%
[rank3]:2025-10-29 03:24:33,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:33,270 - INFO -  step: 1650  loss:  0.1183  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,877  tflops: 367.37  mfu: 37.15%
[rank3]:2025-10-29 03:24:33,579 - INFO - Avg. fwd time: 16.6783 / Avg. bwd time: 22.2018 / Avg. batch time: 326.5910 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-10-29 03:24:33,635 - INFO - Avg. fwd time: 17.5165 / Avg. bwd time: 21.8633 / Avg. batch time: 520.5047 (ms) / GPU bubble ratio: 39.47%
[rank2]:2025-10-29 03:24:33,606 - INFO - Avg. fwd time: 15.0634 / Avg. bwd time: 18.9873 / Avg. batch time: 479.0821 (ms) / GPU bubble ratio: 43.14%
[rank0]:2025-10-29 03:24:33,648 - INFO - Avg. fwd time: 15.4424 / Avg. bwd time: 6.1160 / Avg. batch time: 542.8866 (ms) / GPU bubble ratio: 68.23%
[rank1]:2025-10-29 03:24:48,840 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:24:48,840 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:24:48,841 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:24:53,977 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:09,599 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:14,700 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:30,346 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:30,345 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:30,345 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:35,462 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:25:51,019 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:25:51,019 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:25:51,020 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:25:56,189 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:10,326 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:26:11,870 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank1]:2025-10-29 03:26:11,869 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank2]:2025-10-29 03:26:11,869 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:11,870 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,894  tflops: 368.17  mfu: 37.23%
[rank3]:2025-10-29 03:26:16,966 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:16,972 - INFO -  step: 1700  loss:  0.1048  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,900  tflops: 368.44  mfu: 37.25%
[rank0]:2025-10-29 03:26:17,059 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0326_stage0_step1700.svg
[rank1]:2025-10-29 03:26:17,055 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0326_stage1_step1700.svg
[rank2]:2025-10-29 03:26:17,056 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0326_stage2_step1700.svg
[rank3]:2025-10-29 03:26:17,167 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0326_real_step1700_rank3.svg
[rank3]:> Batch Time: 379.52 ms, GPU Bubble Ratio: 64.76%, 22.92%, 33.48%, 24.32%
[rank0]:2025-10-29 03:26:17,153 - INFO - Avg. fwd time: 15.4407 / Avg. bwd time: 5.9839 / Avg. batch time: 541.6995 (ms) / GPU bubble ratio: 68.36%
[rank3]:2025-10-29 03:26:17,236 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0326_stage3_step1700.svg
[rank3]:2025-10-29 03:26:17,480 - INFO - Avg. fwd time: 16.6769 / Avg. bwd time: 22.1084 / Avg. batch time: 325.8227 (ms) / GPU bubble ratio: 4.77%
[rank1]:2025-10-29 03:26:17,526 - INFO - Avg. fwd time: 17.5158 / Avg. bwd time: 21.7777 / Avg. batch time: 519.4599 (ms) / GPU bubble ratio: 39.49%
[rank2]:2025-10-29 03:26:17,500 - INFO - Avg. fwd time: 15.0639 / Avg. bwd time: 18.9112 / Avg. batch time: 478.1112 (ms) / GPU bubble ratio: 43.15%
[rank0]:2025-10-29 03:26:32,830 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:32,830 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:32,829 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:37,920 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:26:53,515 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:26:53,514 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:26:53,514 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:26:58,624 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:14,294 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:27:19,403 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:34,948 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:27:40,229 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:54,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:27:55,853 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:27:55,853 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank1]:2025-10-29 03:27:55,852 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:27:55,853 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank2]:2025-10-29 03:27:55,852 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:27:55,852 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 7,878  tflops: 367.44  mfu: 37.15%
[rank3]:2025-10-29 03:28:00,975 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:00,979 - INFO -  step: 1750  loss:  0.1059  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,877  tflops: 367.36  mfu: 37.14%
[rank3]:2025-10-29 03:28:01,370 - INFO - Avg. fwd time: 16.6753 / Avg. bwd time: 22.0051 / Avg. batch time: 324.9721 (ms) / GPU bubble ratio: 4.78%
[rank2]:2025-10-29 03:28:01,419 - INFO - Avg. fwd time: 15.0646 / Avg. bwd time: 18.8272 / Avg. batch time: 476.5808 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 03:28:01,498 - INFO - Avg. fwd time: 15.4388 / Avg. bwd time: 5.8383 / Avg. batch time: 539.9349 (ms) / GPU bubble ratio: 68.47%
[rank1]:2025-10-29 03:28:01,464 - INFO - Avg. fwd time: 17.5152 / Avg. bwd time: 21.6836 / Avg. batch time: 517.8522 (ms) / GPU bubble ratio: 39.44%
[rank1]:2025-10-29 03:28:27,035 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:28:27,032 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:28:27,039 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:32,134 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:28:47,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:28:47,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:28:47,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:28:52,799 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:08,496 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:13,571 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:29,177 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:29,177 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:29,178 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:34,288 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:48,319 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:29:49,877 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank0]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 03:29:49,876 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank2]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 03:29:49,876 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:29:49,877 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,184  tflops: 335.08  mfu: 33.88%
[rank1]:2025-10-29 03:29:49,877 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 03:29:54,971 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:29:54,975 - INFO -  step: 1800  loss:  0.0849  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,186  tflops: 335.17  mfu: 33.89%
[rank3]:2025-10-29 03:29:54,976 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 03:30:11,667 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,798
[rank1]:2025-10-29 03:30:11,701 - INFO - validate step: 1800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,768
[rank2]:2025-10-29 03:30:11,717 - INFO - validate step: 1800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,754
[rank3]:2025-10-29 03:30:11,728 - INFO - validate step: 1800  loss:  0.2401  memory: 83.85GiB(59.97%)  tps: 24,451
[rank1]:2025-10-29 03:30:11,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0330_stage1_step1800.svg
[rank2]:2025-10-29 03:30:11,812 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0330_stage2_step1800.svg
[rank0]:2025-10-29 03:30:11,814 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0330_stage0_step1800.svg
[rank3]:2025-10-29 03:30:11,921 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0330_real_step1800_rank3.svg
[rank3]:> Batch Time: 379.00 ms, GPU Bubble Ratio: 64.76%, 22.88%, 33.45%, 24.35%
[rank3]:2025-10-29 03:30:11,990 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0330_stage3_step1800.svg
[rank3]:2025-10-29 03:30:12,303 - INFO - Avg. fwd time: 16.6594 / Avg. bwd time: 22.0404 / Avg. batch time: 325.1178 (ms) / GPU bubble ratio: 4.77%
[rank0]:2025-10-29 03:30:12,369 - INFO - Avg. fwd time: 15.4264 / Avg. bwd time: 5.9086 / Avg. batch time: 540.3441 (ms) / GPU bubble ratio: 68.41%
[rank1]:2025-10-29 03:30:12,358 - INFO - Avg. fwd time: 17.5011 / Avg. bwd time: 21.7236 / Avg. batch time: 518.1962 (ms) / GPU bubble ratio: 39.44%
[rank2]:2025-10-29 03:30:12,329 - INFO - Avg. fwd time: 15.0531 / Avg. bwd time: 18.8619 / Avg. batch time: 476.8770 (ms) / GPU bubble ratio: 43.10%
[rank0]:2025-10-29 03:30:27,785 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:30:27,785 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:30:27,784 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:30:32,887 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:30:48,456 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:30:48,456 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:30:48,457 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:30:53,526 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:09,186 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:09,185 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:09,185 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:14,250 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:29,959 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:29,958 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:29,958 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:35,004 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:49,008 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:31:50,570 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:31:50,570 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 8,283  tflops: 386.32  mfu: 39.06%
[rank1]:2025-10-29 03:31:50,569 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:31:50,569 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 8,286  tflops: 386.45  mfu: 39.08%
[rank2]:2025-10-29 03:31:50,569 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:31:50,569 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 8,287  tflops: 386.51  mfu: 39.08%
[rank0]:2025-10-29 03:31:50,665 - INFO - Avg. fwd time: 15.4260 / Avg. bwd time: 5.7923 / Avg. batch time: 539.3074 (ms) / GPU bubble ratio: 68.53%
[rank3]:2025-10-29 03:31:55,656 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:31:55,660 - INFO -  step: 1850  loss:  0.0917  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,882  tflops: 367.63  mfu: 37.17%
[rank3]:2025-10-29 03:31:55,911 - INFO - Avg. fwd time: 16.6592 / Avg. bwd time: 21.9601 / Avg. batch time: 324.4659 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 03:31:55,957 - INFO - Avg. fwd time: 17.5031 / Avg. bwd time: 21.6498 / Avg. batch time: 517.2839 (ms) / GPU bubble ratio: 39.45%
[rank2]:2025-10-29 03:31:55,932 - INFO - Avg. fwd time: 15.0551 / Avg. bwd time: 18.7964 / Avg. batch time: 476.0271 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:11,351 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:16,411 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:32:32,042 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:32,041 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:32,041 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:37,113 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:32:52,741 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:32:52,741 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:32:52,742 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:32:57,868 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:13,574 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:33:18,693 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:32,718 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:33:34,293 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:33:34,293 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank1]:2025-10-29 03:33:34,292 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:34,292 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank2]:2025-10-29 03:33:34,292 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:34,292 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank3]:2025-10-29 03:33:39,327 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:33:39,332 - INFO -  step: 1900  loss:  0.0776  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,902  tflops: 368.55  mfu: 37.26%
[rank0]:2025-10-29 03:33:39,417 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0333_stage0_step1900.svg
[rank1]:2025-10-29 03:33:39,415 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0333_stage1_step1900.svg
[rank2]:2025-10-29 03:33:39,417 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0333_stage2_step1900.svg
[rank0]:2025-10-29 03:33:39,512 - INFO - Avg. fwd time: 15.4248 / Avg. bwd time: 5.6636 / Avg. batch time: 538.3879 (ms) / GPU bubble ratio: 68.66%
[rank3]:2025-10-29 03:33:39,527 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0333_real_step1900_rank3.svg
[rank3]:> Batch Time: 378.54 ms, GPU Bubble Ratio: 64.76%, 22.83%, 33.41%, 24.38%
[rank3]:2025-10-29 03:33:39,597 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0333_stage3_step1900.svg
[rank3]:2025-10-29 03:33:39,850 - INFO - Avg. fwd time: 16.6587 / Avg. bwd time: 21.8711 / Avg. batch time: 323.7403 (ms) / GPU bubble ratio: 4.79%
[rank2]:2025-10-29 03:33:39,870 - INFO - Avg. fwd time: 15.0566 / Avg. bwd time: 18.7239 / Avg. batch time: 475.3178 (ms) / GPU bubble ratio: 43.14%
[rank1]:2025-10-29 03:33:39,895 - INFO - Avg. fwd time: 17.5043 / Avg. bwd time: 21.5678 / Avg. batch time: 516.5026 (ms) / GPU bubble ratio: 39.48%
[rank0]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:33:55,229 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:00,319 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:15,999 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:21,061 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:36,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:34:41,733 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:34:57,433 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:34:57,433 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:34:57,434 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:02,602 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:35:25,981 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:35:28,635 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:35:28,635 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 66.72GiB(47.72%)  tps: 7,164  tflops: 334.15  mfu: 33.79%
[rank2]:2025-10-29 03:35:28,628 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:35:28,628 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 64.67GiB(46.25%)  tps: 7,165  tflops: 334.17  mfu: 33.79%
[rank1]:2025-10-29 03:35:28,630 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:35:28,631 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1659  memory: 72.68GiB(51.98%)  tps: 7,165  tflops: 334.16  mfu: 33.79%
[rank3]:2025-10-29 03:35:33,761 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:33,765 - INFO -  step: 1950  loss:  0.1049  grad_norm:  0.1659  memory: 83.85GiB(59.97%)  tps: 7,159  tflops: 333.89  mfu: 33.76%
[rank3]:2025-10-29 03:35:34,085 - INFO - Avg. fwd time: 16.6456 / Avg. bwd time: 21.9082 / Avg. batch time: 323.9251 (ms) / GPU bubble ratio: 4.78%
[rank0]:2025-10-29 03:35:34,155 - INFO - Avg. fwd time: 15.4141 / Avg. bwd time: 5.7330 / Avg. batch time: 538.8301 (ms) / GPU bubble ratio: 68.60%
[rank1]:2025-10-29 03:35:34,142 - INFO - Avg. fwd time: 17.4932 / Avg. bwd time: 21.6081 / Avg. batch time: 516.8783 (ms) / GPU bubble ratio: 39.48%
[rank2]:2025-10-29 03:35:34,113 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.7581 / Avg. batch time: 475.6462 (ms) / GPU bubble ratio: 43.14%
[rank0]:2025-10-29 03:35:49,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:35:49,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:35:49,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:35:54,495 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:10,225 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:10,224 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:10,224 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:15,276 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:30,847 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:30,846 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:30,846 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:35,966 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:36:51,632 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:36:56,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:37:10,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:37:12,416 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:37:12,417 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,894  tflops: 368.16  mfu: 37.23%
[rank0]:2025-10-29 03:37:12,417 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 03:37:12,416 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:37:12,416 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,893  tflops: 368.14  mfu: 37.22%
[rank1]:2025-10-29 03:37:12,416 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 03:37:12,415 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:37:12,416 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,893  tflops: 368.13  mfu: 37.22%
[rank2]:2025-10-29 03:37:12,416 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 03:37:17,915 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:37:17,918 - INFO -  step: 2000  loss:  0.1202  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,865  tflops: 366.85  mfu: 37.09%
[rank3]:2025-10-29 03:37:17,919 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 03:37:34,609 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,457
[rank1]:2025-10-29 03:37:34,646 - INFO - validate step: 2000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,426
[rank2]:2025-10-29 03:37:34,661 - INFO - validate step: 2000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,413
[rank3]:2025-10-29 03:37:34,674 - INFO - validate step: 2000  loss:  0.2392  memory: 83.85GiB(59.97%)  tps: 24,447
[rank1]:2025-10-29 03:37:34,763 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0337_stage1_step2000.svg
[rank2]:2025-10-29 03:37:34,761 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0337_stage2_step2000.svg
[rank0]:2025-10-29 03:37:34,761 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0337_stage0_step2000.svg
[rank3]:2025-10-29 03:37:34,863 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0337_real_step2000_rank3.svg
[rank3]:> Batch Time: 378.19 ms, GPU Bubble Ratio: 64.76%, 22.82%, 33.39%, 24.38%
[rank0]:2025-10-29 03:37:34,857 - INFO - Avg. fwd time: 15.4131 / Avg. bwd time: 5.6294 / Avg. batch time: 537.9011 (ms) / GPU bubble ratio: 68.70%
[rank3]:2025-10-29 03:37:34,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0337_stage3_step2000.svg
[rank1]:2025-10-29 03:37:35,237 - INFO - Avg. fwd time: 17.4940 / Avg. bwd time: 21.5420 / Avg. batch time: 516.0601 (ms) / GPU bubble ratio: 39.49%
[rank2]:2025-10-29 03:37:35,210 - INFO - Avg. fwd time: 15.0481 / Avg. bwd time: 18.6998 / Avg. batch time: 474.8865 (ms) / GPU bubble ratio: 43.15%
[rank3]:2025-10-29 03:37:35,191 - INFO - Avg. fwd time: 16.6451 / Avg. bwd time: 21.8366 / Avg. batch time: 323.3405 (ms) / GPU bubble ratio: 4.79%
[rank0]:2025-10-29 03:37:50,530 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:37:50,529 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:37:50,529 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:37:55,627 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:11,331 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:11,330 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:11,330 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:16,805 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:32,447 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:32,446 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:32,446 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:37,839 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:38:53,448 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:38:58,838 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:13,009 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:39:14,581 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:14,581 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 8,194  tflops: 382.18  mfu: 38.64%
[rank2]:2025-10-29 03:39:14,580 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:39:14,580 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 8,199  tflops: 382.39  mfu: 38.66%
[rank1]:2025-10-29 03:39:14,580 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:14,581 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 8,197  tflops: 382.33  mfu: 38.66%
[rank0]:2025-10-29 03:39:14,676 - INFO - Avg. fwd time: 15.4125 / Avg. bwd time: 5.5143 / Avg. batch time: 536.6162 (ms) / GPU bubble ratio: 68.80%
[rank3]:2025-10-29 03:39:19,893 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:39:19,897 - INFO -  step: 2050  loss:  0.1601  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,785  tflops: 363.12  mfu: 36.72%
[rank3]:2025-10-29 03:39:20,146 - INFO - Avg. fwd time: 16.6459 / Avg. bwd time: 21.7573 / Avg. batch time: 322.7052 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 03:39:20,166 - INFO - Avg. fwd time: 15.0508 / Avg. bwd time: 18.6352 / Avg. batch time: 473.7872 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 03:39:20,191 - INFO - Avg. fwd time: 17.4968 / Avg. bwd time: 21.4690 / Avg. batch time: 514.8986 (ms) / GPU bubble ratio: 39.46%
[rank2]:2025-10-29 03:39:35,460 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:35,460 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:35,461 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:39:40,760 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:39:56,421 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:01,642 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:17,336 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:22,600 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:38,149 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:38,148 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:38,148 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:40:43,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:57,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:40:59,010 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank1]:2025-10-29 03:40:59,009 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank2]:2025-10-29 03:40:59,009 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:40:59,010 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,845  tflops: 365.87  mfu: 36.99%
[rank3]:2025-10-29 03:41:04,256 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:04,260 - INFO -  step: 2100  loss:  0.1397  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,850  tflops: 366.11  mfu: 37.02%
[rank2]:2025-10-29 03:41:04,337 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0340_stage2_step2100.svg
[rank0]:2025-10-29 03:41:04,341 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0340_stage0_step2100.svg
[rank1]:2025-10-29 03:41:04,338 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0340_stage1_step2100.svg
[rank3]:2025-10-29 03:41:04,458 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0341_real_step2100_rank3.svg
[rank3]:> Batch Time: 377.97 ms, GPU Bubble Ratio: 64.77%, 22.80%, 33.37%, 24.39%
[rank3]:2025-10-29 03:41:04,523 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0341_stage3_step2100.svg
[rank3]:2025-10-29 03:41:04,834 - INFO - Avg. fwd time: 16.6457 / Avg. bwd time: 21.6816 / Avg. batch time: 322.0904 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 03:41:04,902 - INFO - Avg. fwd time: 15.4116 / Avg. bwd time: 5.4049 / Avg. batch time: 535.9645 (ms) / GPU bubble ratio: 68.93%
[rank1]:2025-10-29 03:41:04,890 - INFO - Avg. fwd time: 17.4983 / Avg. bwd time: 21.3992 / Avg. batch time: 514.3634 (ms) / GPU bubble ratio: 39.50%
[rank2]:2025-10-29 03:41:04,861 - INFO - Avg. fwd time: 15.0525 / Avg. bwd time: 18.5737 / Avg. batch time: 473.3114 (ms) / GPU bubble ratio: 43.16%
[rank0]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:41:20,170 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:25,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:41:41,011 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:41:41,010 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:41:41,010 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:41:46,283 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:01,991 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:07,323 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:22,896 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:22,896 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:22,897 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:28,216 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:51,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:42:54,287 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:42:54,288 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 66.72GiB(47.72%)  tps: 7,106  tflops: 331.44  mfu: 33.51%
[rank2]:2025-10-29 03:42:54,281 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:42:54,281 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 64.67GiB(46.25%)  tps: 7,107  tflops: 331.46  mfu: 33.51%
[rank1]:2025-10-29 03:42:54,283 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:42:54,284 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2284  memory: 72.68GiB(51.98%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank0]:2025-10-29 03:42:54,385 - INFO - Avg. fwd time: 15.4062 / Avg. bwd time: 5.4067 / Avg. batch time: 535.8734 (ms) / GPU bubble ratio: 68.93%
[rank3]:2025-10-29 03:42:59,529 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:42:59,534 - INFO -  step: 2150  loss:  0.1815  grad_norm:  0.2284  memory: 83.85GiB(59.97%)  tps: 7,107  tflops: 331.45  mfu: 33.51%
[rank2]:2025-10-29 03:42:59,809 - INFO - Avg. fwd time: 15.0486 / Avg. bwd time: 18.5722 / Avg. batch time: 473.2180 (ms) / GPU bubble ratio: 43.16%
[rank1]:2025-10-29 03:42:59,834 - INFO - Avg. fwd time: 17.4936 / Avg. bwd time: 21.3984 / Avg. batch time: 514.2743 (ms) / GPU bubble ratio: 39.50%
[rank3]:2025-10-29 03:42:59,787 - INFO - Avg. fwd time: 16.6398 / Avg. bwd time: 21.6778 / Avg. batch time: 322.0071 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 03:43:15,221 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:15,220 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:15,220 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:43:20,601 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:36,139 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:43:41,497 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:43:57,176 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:43:57,176 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:43:57,177 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:02,531 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:18,143 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:44:18,142 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:44:18,142 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:23,450 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:37,514 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:44:39,075 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:44:39,075 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,818  tflops: 364.62  mfu: 36.87%
[rank0]:2025-10-29 03:44:39,075 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 03:44:39,074 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:44:39,074 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,817  tflops: 364.60  mfu: 36.87%
[rank2]:2025-10-29 03:44:39,075 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 03:44:39,074 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:44:39,074 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,818  tflops: 364.61  mfu: 36.87%
[rank1]:2025-10-29 03:44:39,074 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:44:44,399 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:44:44,403 - INFO -  step: 2200  loss:  0.1049  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,812  tflops: 364.34  mfu: 36.84%
[rank3]:2025-10-29 03:44:44,403 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:45:01,191 - INFO - validate step: 2200  loss:  0.2388  memory: 83.85GiB(59.97%)  tps: 24,401
[rank0]:2025-10-29 03:45:01,128 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,574
[rank2]:2025-10-29 03:45:01,180 - INFO - validate step: 2200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,530
[rank1]:2025-10-29 03:45:01,165 - INFO - validate step: 2200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,543
[rank0]:2025-10-29 03:45:01,273 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0345_stage0_step2200.svg
[rank2]:2025-10-29 03:45:01,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0345_stage2_step2200.svg
[rank1]:2025-10-29 03:45:01,273 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0345_stage1_step2200.svg
[rank3]:2025-10-29 03:45:01,388 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0345_real_step2200_rank3.svg
[rank3]:> Batch Time: 377.73 ms, GPU Bubble Ratio: 64.78%, 22.78%, 33.37%, 24.40%
[rank0]:2025-10-29 03:45:01,371 - INFO - Avg. fwd time: 15.4010 / Avg. bwd time: 5.3854 / Avg. batch time: 535.8252 (ms) / GPU bubble ratio: 68.97%
[rank3]:2025-10-29 03:45:01,452 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0345_stage3_step2200.svg
[rank2]:2025-10-29 03:45:01,723 - INFO - Avg. fwd time: 15.0451 / Avg. bwd time: 18.5586 / Avg. batch time: 473.2054 (ms) / GPU bubble ratio: 43.19%
[rank3]:2025-10-29 03:45:01,702 - INFO - Avg. fwd time: 16.6335 / Avg. bwd time: 21.6582 / Avg. batch time: 321.7932 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 03:45:01,749 - INFO - Avg. fwd time: 17.4888 / Avg. bwd time: 21.3832 / Avg. batch time: 514.2533 (ms) / GPU bubble ratio: 39.53%
[rank0]:2025-10-29 03:45:17,209 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:17,208 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:17,208 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:45:22,483 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:45:38,075 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:38,074 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:38,075 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:45:43,395 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:45:59,052 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:45:59,052 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:45:59,051 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:04,312 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:20,004 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:46:20,003 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:46:20,003 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:25,336 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:39,365 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:46:40,933 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,208  tflops: 382.82  mfu: 38.71%
[rank1]:2025-10-29 03:46:40,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,211  tflops: 382.97  mfu: 38.72%
[rank2]:2025-10-29 03:46:40,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:46:40,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,212  tflops: 383.02  mfu: 38.73%
[rank3]:2025-10-29 03:46:46,232 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:46:46,239 - INFO -  step: 2250  loss:  0.1445  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,798  tflops: 363.72  mfu: 36.78%
[rank3]:2025-10-29 03:46:46,560 - INFO - Avg. fwd time: 16.6337 / Avg. bwd time: 21.5900 / Avg. batch time: 321.2431 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 03:46:46,589 - INFO - Avg. fwd time: 15.0468 / Avg. bwd time: 18.5031 / Avg. batch time: 472.8025 (ms) / GPU bubble ratio: 43.23%
[rank0]:2025-10-29 03:46:46,635 - INFO - Avg. fwd time: 15.4009 / Avg. bwd time: 5.2863 / Avg. batch time: 535.2670 (ms) / GPU bubble ratio: 69.08%
[rank1]:2025-10-29 03:46:46,621 - INFO - Avg. fwd time: 17.4909 / Avg. bwd time: 21.3207 / Avg. batch time: 513.7996 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 03:47:01,985 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:01,985 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:01,984 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:07,298 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:47:22,933 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:22,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:22,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:28,201 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:47:43,792 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:47:43,791 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:47:43,791 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:47:49,211 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:04,932 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:10,378 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:24,354 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:48:25,928 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:48:25,928 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank0]:2025-10-29 03:48:25,929 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:25,929 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank2]:2025-10-29 03:48:25,928 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:25,929 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,802  tflops: 363.90  mfu: 36.79%
[rank3]:2025-10-29 03:48:31,379 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:31,383 - INFO -  step: 2300  loss:  0.0886  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,791  tflops: 363.39  mfu: 36.74%
[rank1]:2025-10-29 03:48:31,465 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0348_stage1_step2300.svg
[rank0]:2025-10-29 03:48:31,465 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0348_stage0_step2300.svg
[rank2]:2025-10-29 03:48:31,466 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0348_stage2_step2300.svg
[rank0]:2025-10-29 03:48:31,559 - INFO - Avg. fwd time: 15.4008 / Avg. bwd time: 5.2050 / Avg. batch time: 534.6559 (ms) / GPU bubble ratio: 69.17%
[rank3]:2025-10-29 03:48:31,581 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0348_real_step2300_rank3.svg
[rank3]:> Batch Time: 377.53 ms, GPU Bubble Ratio: 64.78%, 22.77%, 33.35%, 24.41%
[rank3]:2025-10-29 03:48:31,644 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0348_stage3_step2300.svg
[rank3]:2025-10-29 03:48:31,896 - INFO - Avg. fwd time: 16.6340 / Avg. bwd time: 21.5339 / Avg. batch time: 320.7921 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 03:48:31,943 - INFO - Avg. fwd time: 17.4926 / Avg. bwd time: 21.2688 / Avg. batch time: 513.2757 (ms) / GPU bubble ratio: 39.59%
[rank2]:2025-10-29 03:48:31,917 - INFO - Avg. fwd time: 15.0483 / Avg. bwd time: 18.4574 / Avg. batch time: 472.3237 (ms) / GPU bubble ratio: 43.25%
[rank1]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:48:47,291 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:48:52,781 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:08,469 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:08,470 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:08,469 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:13,969 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:29,520 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:29,521 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:29,520 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:34,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:49:50,670 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:49:50,670 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:49:50,671 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:49:56,169 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:50:10,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:50:11,799 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank0]:2025-10-29 03:50:11,800 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank2]:2025-10-29 03:50:11,799 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:50:11,800 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,738  tflops: 360.89  mfu: 36.49%
[rank3]:2025-10-29 03:50:17,218 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:50:17,227 - INFO -  step: 2350  loss:  0.1327  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,740  tflops: 360.99  mfu: 36.50%
[rank3]:2025-10-29 03:50:17,628 - INFO - Avg. fwd time: 16.6343 / Avg. bwd time: 21.4711 / Avg. batch time: 320.2859 (ms) / GPU bubble ratio: 4.82%
[rank2]:2025-10-29 03:50:17,677 - INFO - Avg. fwd time: 15.0500 / Avg. bwd time: 18.4065 / Avg. batch time: 471.4758 (ms) / GPU bubble ratio: 43.23%
[rank1]:2025-10-29 03:50:17,723 - INFO - Avg. fwd time: 17.4943 / Avg. bwd time: 21.2106 / Avg. batch time: 512.3774 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 03:50:17,756 - INFO - Avg. fwd time: 15.4004 / Avg. bwd time: 5.1141 / Avg. batch time: 533.6602 (ms) / GPU bubble ratio: 69.25%
[rank0]:2025-10-29 03:50:43,223 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:50:43,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:50:43,216 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:50:48,742 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:04,482 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:04,481 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:04,481 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:09,813 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:25,391 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:30,910 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:51:46,548 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:51:51,936 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:52:06,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 03:52:07,616 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank0]:2025-10-29 03:52:07,616 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,513  tflops: 350.41  mfu: 34.40%
[rank0]:2025-10-29 03:52:07,616 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 03:52:07,615 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank1]:2025-10-29 03:52:07,616 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,513  tflops: 350.41  mfu: 34.40%
[rank1]:2025-10-29 03:52:07,616 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 03:52:07,615 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 03:52:07,615 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,073  tflops: 329.90  mfu: 33.36%
[rank2]:2025-10-29 03:52:07,615 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0007  tps: 7,514  tflops: 350.43  mfu: 34.40%
[rank2]:2025-10-29 03:52:07,615 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:52:13,031 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 03:52:13,035 - INFO -  step: 2400  loss:  0.1171  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,074  tflops: 329.93  mfu: 33.36%
[rank3]:2025-10-29 03:52:13,035 - INFO -  final step: 2400  loss:  0.1171  grad_norm:  0.0000  tps: 7,427  tflops: 346.39  mfu: 33.99%
[rank3]:2025-10-29 03:52:13,035 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 03:52:29,663 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,579
[rank0]:2025-10-29 03:52:29,664 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:52:29,668 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 03:52:29,700 - INFO - validate step: 2400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,547
[rank1]:2025-10-29 03:52:29,700 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:52:29,703 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 03:52:29,717 - INFO - validate step: 2400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,533
[rank2]:2025-10-29 03:52:29,718 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:52:29,724 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 03:52:29,725 - INFO - validate step: 2400  loss:  0.2374  memory: 83.85GiB(59.97%)  tps: 24,543
[rank3]:2025-10-29 03:52:29,726 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 03:52:29,729 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 03:52:40,798 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 03:52:40,888 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0352_stage1_final2400.svg
[rank2]:2025-10-29 03:52:40,892 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0352_stage2_final2400.svg
[rank0]:2025-10-29 03:52:40,906 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0352_stage0_final2400.svg
[rank3]:2025-10-29 03:52:41,017 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0352_real_final2400_rank3.svg
[rank3]:> Batch Time: 377.37 ms, GPU Bubble Ratio: 64.79%, 22.76%, 33.34%, 24.42%
[rank1]:2025-10-29 03:52:41,138 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank1_stage1.svg
[rank1]:	> Counts Sum: 17201, Total Sum: 19035 (90.37%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank1]:2025-10-29 03:52:41,139 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 03:52:41,186 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank0_stage0.svg
[rank0]:	> Counts Sum: 15484, Total Sum: 17155 (90.26%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 1.7]
[rank0]:2025-10-29 03:52:41,186 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 03:52:41,166 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank2_stage2.svg
[rank2]:	> Counts Sum: 15266, Total Sum: 16920 (90.22%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank2]:2025-10-29 03:52:41,167 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 03:52:41,372 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0352_thry_final2400_rank3.svg
[rank3]:> Batch Time: 537.24 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 03:52:41,501 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0352_stage3_final2400.svg
[rank3]:2025-10-29 03:52:41,912 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0352_rank3_stage3.svg
[rank3]:	> Counts Sum: 13975, Total Sum: 15275 (91.49%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48]
[rank3]:2025-10-29 03:52:41,913 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank0]:2025-10-29 03:52:43,186 - INFO - Training completed
[rank0]:2025-10-29 03:52:43,187 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 03:52:43,247 - INFO - Process group destroyed
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–…â–…â–â–…â–†â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–‚â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–ƒâ–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–†â–‡â–‡â–‡â–ˆâ–ˆâ–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–â–†â–ˆâ–‡â–†â–ˆâ–‡â–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–†â–‡â–‡â–‡â–ˆâ–ˆâ–â–â–â–â–â–â–â–‚â–â–‚â–â–‚â–â–â–‡â–ˆâ–‡â–‡â–‡â–â–â–â–â–â–â–â–â–‚â–‚â–â–‚â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.20605
[rank3]:wandb:               final/avg_loss 0.1171
[rank3]:wandb:             final/avg_mfu(%) 33.98818
[rank3]:wandb:             final/avg_tflops 346.38981
[rank3]:wandb:    final/avg_throughput(tps) 7426.85721
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.1171
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.1171
[rank3]:wandb: loss_metrics/global_max_loss 0.1171
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2pi1be3k
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_apf_dm1/20251029-0219/wandb/run-20251029_021904-2pi1be3k/logs
[rank0]:2025-10-29 03:52:43,763 - INFO - Process group destroyed
[rank2]:2025-10-29 03:52:43,762 - INFO - Process group destroyed
[rank3]:2025-10-29 03:52:43,901 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.11', 'layers.12', 'layers.8', 'layers.10', 'layers.15', 'layers.16', 'layers.9', 'layers.14'}
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.17', 'layers.19', 'layers.23', 'layers.18', 'layers.20', 'layers.21', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.5', 'layers.6', 'layers.3', 'tok_embeddings', 'layers.7', 'layers.4', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'layers.29', 'output', 'layers.25', 'layers.31', 'norm', 'layers.26', 'layers.27', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 03:52:52 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] 
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] *****************************************
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 03:52:53.989000 1533873 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 03:53:00,104 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 03:53:00,032 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 03:53:00,049 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 03:53:00,105 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 03:53:01,085 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 03:53:01,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:53:01,093 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-29 03:53:01,079 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 03:53:01,083 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 03:53:01,079 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 03:53:01,082 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 03:53:01,085 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 03:53:01,088 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:53:03,005 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 03:53:03,288 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 03:53:04,897 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 03:53:06,248 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 03:53:06,506 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 03:53:06,435 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 03:53:06,507 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 03:53:06,507 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 03:53:06,555 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 03:53:06,578 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 03:53:06,578 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:53:06,704 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 03:53:06,705 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 03:53:06,789 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 03:53:06,789 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 03:53:06,911 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 03:53:06,985 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 03:53:06,985 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 03:53:07,193 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 03:53:07,194 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run fr7hk14p
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1/20251029-0353/wandb/run-20251029_035307-fr7hk14p
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/fr7hk14p
[rank3]:2025-10-29 03:53:08,567 - INFO - WandB logging enabled
[rank3]:2025-10-29 03:53:08,576 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 03:53:08,650 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 03:53:08,650 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 03:53:08,865 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank0]:2025-10-29 03:53:08,866 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:53:08,870 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 03:53:08,865 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 03:53:08,884 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:53:08,853 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 03:53:08,854 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 03:53:08,865 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:53:12,282 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:12,535 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 03:53:12,536 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:12,536 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400.
[rank1]:2025-10-29 03:53:12,529 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank2]:2025-10-29 03:53:13,235 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1.
[rank0]:2025-10-29 03:53:22,280 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 03:53:22,280 - INFO - Finished loading the checkpoint in 9.74 seconds.
[rank0]:2025-10-29 03:53:22,280 - INFO - Training starts at step 1
[rank3]:2025-10-29 03:53:27,025 - INFO -  step:  1  loss:  0.8389  grad_norm:  0.5414  memory: 58.03GiB(41.50%)  tps: 891  tflops: 41.54  mfu: 4.20%
[rank3]:2025-10-29 03:53:27,025 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:53:27,020 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 44.28GiB(31.67%)  tps: 817  tflops: 38.10  mfu: 3.85%
[rank1]:2025-10-29 03:53:27,022 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 49.69GiB(35.54%)  tps: 798  tflops: 37.20  mfu: 3.76%
[rank2]:2025-10-29 03:53:27,020 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 03:53:27,022 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 03:53:27,041 - INFO -  step:  1  loss: -4.0000  grad_norm:  0.5414  memory: 49.75GiB(35.58%)  tps: 800  tflops: 37.30  mfu: 3.77%
[rank0]:2025-10-29 03:53:27,041 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 03:53:45,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,579 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,580 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,581 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,582 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,583 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:53:45,584 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,622 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,623 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,624 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:53:45,625 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,712 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,712 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,713 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,714 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:53:45,715 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,669 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,670 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,671 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:53:45,672 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:55:37,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:55:39,917 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 57.29GiB(40.97%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank1]:2025-10-29 03:55:39,919 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 64.32GiB(46.00%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank0]:2025-10-29 03:55:39,924 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.4851  memory: 66.72GiB(47.72%)  tps: 6,042  tflops: 281.78  mfu: 28.49%
[rank3]:2025-10-29 03:55:39,921 - INFO -  step: 50  loss:  0.8444  grad_norm:  0.4851  memory: 73.38GiB(52.48%)  tps: 6,041  tflops: 281.75  mfu: 28.49%
[rank2]:2025-10-29 03:55:40,435 - INFO - Avg. fwd time: 13.3386 / Avg. bwd time: 36.4492 / Avg. batch time: 537.3465 (ms) / GPU bubble ratio: 25.88%
[rank3]:2025-10-29 03:55:40,384 - INFO - Avg. fwd time: 14.7677 / Avg. bwd time: 42.9778 / Avg. batch time: 483.1551 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 03:55:40,482 - INFO - Avg. fwd time: 15.5422 / Avg. bwd time: 41.8686 / Avg. batch time: 598.4632 (ms) / GPU bubble ratio: 23.26%
[rank0]:2025-10-29 03:55:40,515 - INFO - Avg. fwd time: 14.5086 / Avg. bwd time: 38.7315 / Avg. batch time: 654.6791 (ms) / GPU bubble ratio: 34.94%
[rank2]:2025-10-29 03:56:07,026 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 03:56:07,029 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-29 03:56:07,033 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 03:56:07,029 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-29 03:56:34,157 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 4.5909e-01
[rank0]:2025-10-29 03:56:34,165 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.1391e-01
[rank1]:2025-10-29 03:56:34,161 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 3.7071e-01
[rank3]:2025-10-29 03:56:34,161 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0869e-01
[rank3]:2025-10-29 03:56:59,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1148e+00
[rank0]:2025-10-29 03:56:59,719 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5000e+00
[rank1]:2025-10-29 03:56:59,705 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8002e-01
[rank2]:2025-10-29 03:56:59,709 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0329e+00
[rank2]:2025-10-29 03:57:26,852 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 9.0351e-01
[rank0]:2025-10-29 03:57:26,860 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3975e+00
[rank1]:2025-10-29 03:57:26,856 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2388e-01
[rank3]:2025-10-29 03:57:26,856 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 8.4170e-01
[rank0]:2025-10-29 03:57:49,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:57:52,310 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6001e-01
[rank2]:2025-10-29 03:57:52,310 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 58.24GiB(41.66%)  tps: 6,188  tflops: 288.59  mfu: 29.18%
[rank1]:2025-10-29 03:57:52,304 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8914e-01
[rank1]:2025-10-29 03:57:52,304 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 68.17GiB(48.76%)  tps: 6,188  tflops: 288.61  mfu: 29.18%
[rank0]:2025-10-29 03:57:52,320 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.1123e+00
[rank0]:2025-10-29 03:57:52,321 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.4913  memory: 66.72GiB(47.72%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank3]:2025-10-29 03:57:52,310 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8846e-01
[rank3]:2025-10-29 03:57:52,313 - INFO -  step: 100  loss:  0.7816  grad_norm:  0.4913  memory: 75.33GiB(53.88%)  tps: 6,188  tflops: 288.60  mfu: 29.18%
[rank2]:2025-10-29 03:57:52,403 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0357_stage2_step100.svg
[rank1]:2025-10-29 03:57:52,395 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0357_stage1_step100.svg
[rank0]:2025-10-29 03:57:52,398 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0357_stage0_step100.svg
[rank3]:2025-10-29 03:57:52,509 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0357_real_step100_rank3.svg
[rank3]:> Batch Time: 634.97 ms, GPU Bubble Ratio: 32.79%, 27.09%, 36.82%, 26.76%
[rank3]:2025-10-29 03:57:52,569 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0357_stage3_step100.svg
[rank2]:2025-10-29 03:57:53,030 - INFO - Avg. fwd time: 13.4324 / Avg. bwd time: 36.1159 / Avg. batch time: 527.8758 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 03:57:52,980 - INFO - Avg. fwd time: 14.9183 / Avg. bwd time: 42.1734 / Avg. batch time: 474.7746 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-29 03:57:53,077 - INFO - Avg. fwd time: 15.7945 / Avg. bwd time: 40.3626 / Avg. batch time: 587.3475 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-10-29 03:57:53,106 - INFO - Avg. fwd time: 14.3602 / Avg. bwd time: 38.9230 / Avg. batch time: 645.3505 (ms) / GPU bubble ratio: 33.95%
[rank2]:2025-10-29 03:58:19,397 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 7.4751e-01
[rank0]:2025-10-29 03:58:19,401 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8390e+00
[rank1]:2025-10-29 03:58:19,400 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.1862e-01
[rank3]:2025-10-29 03:58:19,400 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 8.3708e-01
[rank0]:2025-10-29 03:58:44,739 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.4641e+00
[rank1]:2025-10-29 03:58:44,722 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0088e+00
[rank2]:2025-10-29 03:58:44,725 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7798e+00
[rank3]:2025-10-29 03:58:44,729 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2099e+00
[rank1]:2025-10-29 03:59:11,597 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0500e+00
[rank0]:2025-10-29 03:59:11,598 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0955e+00
[rank2]:2025-10-29 03:59:11,594 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 2.4376e+00
[rank3]:2025-10-29 03:59:11,597 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2702e+00
[rank0]:2025-10-29 03:59:36,898 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.7639e+00
[rank1]:2025-10-29 03:59:36,881 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1916e+00
[rank2]:2025-10-29 03:59:36,884 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4818e+00
[rank3]:2025-10-29 03:59:36,887 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2920e+00
[rank0]:2025-10-29 04:00:01,109 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:00:03,831 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 1.0868e+00
[rank2]:2025-10-29 04:00:03,831 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 59.22GiB(42.36%)  tps: 6,229  tflops: 290.51  mfu: 29.37%
[rank1]:2025-10-29 04:00:03,834 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2147e+00
[rank1]:2025-10-29 04:00:03,835 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 68.17GiB(48.76%)  tps: 6,228  tflops: 290.48  mfu: 29.37%
[rank0]:2025-10-29 04:00:03,835 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2870e+00
[rank0]:2025-10-29 04:00:03,836 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5206  memory: 67.62GiB(48.36%)  tps: 6,229  tflops: 290.52  mfu: 29.38%
[rank3]:2025-10-29 04:00:03,834 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.1168e+00
[rank3]:2025-10-29 04:00:03,837 - INFO -  step: 150  loss:  0.7936  grad_norm:  0.5206  memory: 75.33GiB(53.88%)  tps: 6,229  tflops: 290.50  mfu: 29.37%
[rank3]:2025-10-29 04:00:04,348 - INFO - Avg. fwd time: 14.9773 / Avg. bwd time: 41.7674 / Avg. batch time: 471.0577 (ms) / GPU bubble ratio: 3.63%
[rank1]:2025-10-29 04:00:04,420 - INFO - Avg. fwd time: 15.9279 / Avg. bwd time: 39.3780 / Avg. batch time: 581.9873 (ms) / GPU bubble ratio: 23.98%
[rank2]:2025-10-29 04:00:04,384 - INFO - Avg. fwd time: 13.5025 / Avg. bwd time: 35.5734 / Avg. batch time: 523.5826 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 04:00:04,464 - INFO - Avg. fwd time: 14.3511 / Avg. bwd time: 38.4171 / Avg. batch time: 640.1222 (ms) / GPU bubble ratio: 34.05%
[rank3]:2025-10-29 04:00:29,094 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.6416e-01
[rank2]:2025-10-29 04:00:29,090 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0047e-01
[rank1]:2025-10-29 04:00:29,087 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9694e-01
[rank0]:2025-10-29 04:00:29,104 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 9.0189e-01
[rank3]:2025-10-29 04:00:56,094 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.0315e+00
[rank1]:2025-10-29 04:00:56,093 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3387e+00
[rank2]:2025-10-29 04:00:56,090 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.1148e+00
[rank0]:2025-10-29 04:00:56,094 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8875e+00
[rank1]:2025-10-29 04:01:21,291 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9140e+00
[rank2]:2025-10-29 04:01:21,291 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2594e+00
[rank3]:2025-10-29 04:01:21,297 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6959e+00
[rank0]:2025-10-29 04:01:21,307 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.8465e+00
[rank1]:2025-10-29 04:01:48,213 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2143e+00
[rank2]:2025-10-29 04:01:48,210 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 5.7059e-01
[rank0]:2025-10-29 04:01:48,214 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.8273e+00
[rank3]:2025-10-29 04:01:48,213 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.5650e-01
[rank0]:2025-10-29 04:02:10,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:02:13,459 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5123e+00
[rank3]:2025-10-29 04:02:13,461 - INFO -  step: 200  loss:  0.9271  grad_norm:  0.7524  memory: 75.33GiB(53.88%)  tps: 6,320  tflops: 294.76  mfu: 29.80%
[rank3]:2025-10-29 04:02:13,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:02:13,452 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2426e+00
[rank1]:2025-10-29 04:02:13,452 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 68.17GiB(48.76%)  tps: 6,320  tflops: 294.77  mfu: 29.81%
[rank1]:2025-10-29 04:02:13,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 04:02:13,452 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4079e+00
[rank2]:2025-10-29 04:02:13,452 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 60.18GiB(43.04%)  tps: 6,320  tflops: 294.76  mfu: 29.80%
[rank2]:2025-10-29 04:02:13,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 04:02:13,469 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.4914e+00
[rank0]:2025-10-29 04:02:13,469 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.7524  memory: 67.62GiB(48.36%)  tps: 6,319  tflops: 294.74  mfu: 29.80%
[rank0]:2025-10-29 04:02:13,469 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:02:30,001 - INFO - validate step: 200  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 24,752
[rank2]:2025-10-29 04:02:30,017 - INFO - validate step: 200  loss: -1.0000  memory: 60.18GiB(43.04%)  tps: 24,728
[rank0]:2025-10-29 04:02:29,971 - INFO - validate step: 200  loss: -1.0000  memory: 67.62GiB(48.36%)  tps: 24,822
[rank3]:2025-10-29 04:02:30,027 - INFO - validate step: 200  loss:  0.2541  memory: 75.33GiB(53.88%)  tps: 24,727
[rank1]:2025-10-29 04:02:30,098 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0402_stage1_step200.svg
[rank2]:2025-10-29 04:02:30,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0402_stage2_step200.svg
[rank0]:2025-10-29 04:02:30,102 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0402_stage0_step200.svg
[rank3]:2025-10-29 04:02:30,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0402_real_step200_rank3.svg
[rank3]:> Batch Time: 634.36 ms, GPU Bubble Ratio: 32.74%, 27.80%, 37.05%, 26.81%
[rank3]:2025-10-29 04:02:30,270 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0402_stage3_step200.svg
[rank3]:2025-10-29 04:02:30,680 - INFO - Avg. fwd time: 15.0218 / Avg. bwd time: 41.4476 / Avg. batch time: 468.4528 (ms) / GPU bubble ratio: 3.56%
[rank2]:2025-10-29 04:02:30,730 - INFO - Avg. fwd time: 13.5711 / Avg. bwd time: 34.9569 / Avg. batch time: 520.2071 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 04:02:30,777 - INFO - Avg. fwd time: 16.0210 / Avg. bwd time: 38.6434 / Avg. batch time: 577.8059 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 04:02:30,795 - INFO - Avg. fwd time: 14.3441 / Avg. bwd time: 38.2889 / Avg. batch time: 636.3601 (ms) / GPU bubble ratio: 33.83%
[rank2]:2025-10-29 04:02:56,973 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1262e+00
[rank0]:2025-10-29 04:02:56,973 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1351e+00
[rank1]:2025-10-29 04:02:56,976 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6643e+00
[rank3]:2025-10-29 04:02:56,976 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.2531e+00
[rank0]:2025-10-29 04:03:22,091 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 9.0214e-01
[rank1]:2025-10-29 04:03:22,074 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3767e+00
[rank2]:2025-10-29 04:03:22,070 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4516e+00
[rank3]:2025-10-29 04:03:22,080 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.8588e-01
[rank3]:2025-10-29 04:03:48,926 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.5928e-01
[rank0]:2025-10-29 04:03:48,924 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4169e+00
[rank1]:2025-10-29 04:03:48,926 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1604e+00
[rank2]:2025-10-29 04:03:48,923 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5270e-01
[rank0]:2025-10-29 04:04:14,014 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 7.6286e-01
[rank2]:2025-10-29 04:04:13,994 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5446e-01
[rank1]:2025-10-29 04:04:13,997 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0557e+00
[rank3]:2025-10-29 04:04:14,004 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1236e-01
[rank0]:2025-10-29 04:04:38,201 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:04:40,897 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0605e-01
[rank3]:2025-10-29 04:04:40,899 - INFO -  step: 250  loss:  0.9058  grad_norm:  0.7571  memory: 75.33GiB(53.88%)  tps: 6,260  tflops: 291.95  mfu: 29.52%
[rank2]:2025-10-29 04:04:40,893 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.8685e-02
[rank2]:2025-10-29 04:04:40,894 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 61.15GiB(43.74%)  tps: 6,259  tflops: 291.94  mfu: 29.52%
[rank0]:2025-10-29 04:04:40,894 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.7988e+00
[rank0]:2025-10-29 04:04:40,895 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 68.59GiB(49.06%)  tps: 6,257  tflops: 291.83  mfu: 29.51%
[rank1]:2025-10-29 04:04:40,897 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6485e-01
[rank1]:2025-10-29 04:04:40,897 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.7571  memory: 68.17GiB(48.76%)  tps: 6,258  tflops: 291.89  mfu: 29.51%
[rank2]:2025-10-29 04:04:41,343 - INFO - Avg. fwd time: 13.6491 / Avg. bwd time: 34.3271 / Avg. batch time: 518.4270 (ms) / GPU bubble ratio: 25.97%
[rank3]:2025-10-29 04:04:41,314 - INFO - Avg. fwd time: 15.0428 / Avg. bwd time: 41.3180 / Avg. batch time: 467.2999 (ms) / GPU bubble ratio: 3.51%
[rank0]:2025-10-29 04:04:41,434 - INFO - Avg. fwd time: 14.3704 / Avg. bwd time: 37.8448 / Avg. batch time: 633.9937 (ms) / GPU bubble ratio: 34.11%
[rank1]:2025-10-29 04:04:41,391 - INFO - Avg. fwd time: 16.0677 / Avg. bwd time: 38.3159 / Avg. batch time: 575.6731 (ms) / GPU bubble ratio: 24.42%
[rank3]:2025-10-29 04:05:06,013 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.9659e-01
[rank0]:2025-10-29 04:05:06,023 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.2697e+00
[rank1]:2025-10-29 04:05:06,007 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9521e-01
[rank2]:2025-10-29 04:05:06,003 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.3110e-01
[rank3]:2025-10-29 04:05:32,812 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.8501e-01
[rank2]:2025-10-29 04:05:32,809 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.1904e-02
[rank1]:2025-10-29 04:05:32,812 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9195e-01
[rank0]:2025-10-29 04:05:32,809 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3183e+00
[rank2]:2025-10-29 04:05:57,980 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5442e-01
[rank1]:2025-10-29 04:05:57,983 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5668e-01
[rank0]:2025-10-29 04:05:58,000 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.6125e-01
[rank3]:2025-10-29 04:05:57,990 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.4896e-01
[rank3]:2025-10-29 04:06:24,766 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.6910e-01
[rank1]:2025-10-29 04:06:24,766 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1872e-01
[rank2]:2025-10-29 04:06:24,763 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4451e-01
[rank0]:2025-10-29 04:06:24,764 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0652e-01
[rank0]:2025-10-29 04:06:47,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:06:49,922 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.0927e-01
[rank3]:2025-10-29 04:06:49,924 - INFO -  step: 300  loss:  0.8042  grad_norm:  0.5004  memory: 75.33GiB(53.88%)  tps: 6,349  tflops: 296.13  mfu: 29.94%
[rank1]:2025-10-29 04:06:49,915 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2382e-01
[rank1]:2025-10-29 04:06:49,915 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 68.17GiB(48.76%)  tps: 6,349  tflops: 296.14  mfu: 29.94%
[rank2]:2025-10-29 04:06:49,912 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7500e-01
[rank2]:2025-10-29 04:06:49,912 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 61.15GiB(43.74%)  tps: 6,349  tflops: 296.14  mfu: 29.94%
[rank0]:2025-10-29 04:06:49,932 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 8.9872e-01
[rank0]:2025-10-29 04:06:49,932 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.5004  memory: 68.59GiB(49.06%)  tps: 6,349  tflops: 296.10  mfu: 29.94%
[rank1]:2025-10-29 04:06:50,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0406_stage1_step300.svg
[rank2]:2025-10-29 04:06:50,003 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0406_stage2_step300.svg
[rank0]:2025-10-29 04:06:50,002 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0406_stage0_step300.svg
[rank3]:2025-10-29 04:06:50,104 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0406_real_step300_rank3.svg
[rank3]:> Batch Time: 630.73 ms, GPU Bubble Ratio: 32.69%, 27.38%, 36.82%, 27.01%
[rank3]:2025-10-29 04:06:50,164 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0406_stage3_step300.svg
[rank3]:2025-10-29 04:06:50,659 - INFO - Avg. fwd time: 15.0651 / Avg. bwd time: 41.1400 / Avg. batch time: 465.8698 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-29 04:06:50,748 - INFO - Avg. fwd time: 16.1131 / Avg. bwd time: 37.9108 / Avg. batch time: 573.1673 (ms) / GPU bubble ratio: 24.60%
[rank2]:2025-10-29 04:06:50,701 - INFO - Avg. fwd time: 13.7193 / Avg. bwd time: 33.6939 / Avg. batch time: 516.3596 (ms) / GPU bubble ratio: 26.54%
[rank0]:2025-10-29 04:06:50,786 - INFO - Avg. fwd time: 14.3817 / Avg. bwd time: 37.6627 / Avg. batch time: 631.6326 (ms) / GPU bubble ratio: 34.08%
[rank3]:2025-10-29 04:07:16,987 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.3670e-01
[rank1]:2025-10-29 04:07:16,987 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4266e-01
[rank2]:2025-10-29 04:07:16,984 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3737e-01
[rank0]:2025-10-29 04:07:16,985 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.5870e+00
[rank3]:2025-10-29 04:07:42,141 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.6515e-01
[rank1]:2025-10-29 04:07:42,134 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5193e+00
[rank2]:2025-10-29 04:07:42,131 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.4464e-01
[rank0]:2025-10-29 04:07:42,151 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.1021e+00
[rank1]:2025-10-29 04:08:08,998 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.0811e-01
[rank2]:2025-10-29 04:08:08,995 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2926e-01
[rank0]:2025-10-29 04:08:08,996 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.3590e+00
[rank3]:2025-10-29 04:08:08,998 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.0930e-01
[rank3]:2025-10-29 04:08:34,172 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.2716e-01
[rank1]:2025-10-29 04:08:34,165 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.2414e-01
[rank2]:2025-10-29 04:08:34,162 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.4021e-01
[rank0]:2025-10-29 04:08:34,182 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 5.0071e-01
[rank0]:2025-10-29 04:08:58,254 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:09:00,952 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9271e-01
[rank1]:2025-10-29 04:09:00,953 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 68.17GiB(48.76%)  tps: 6,252  tflops: 291.58  mfu: 29.48%
[rank2]:2025-10-29 04:09:00,949 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6920e-01
[rank2]:2025-10-29 04:09:00,950 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 61.15GiB(43.74%)  tps: 6,252  tflops: 291.58  mfu: 29.48%
[rank0]:2025-10-29 04:09:00,950 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.2374e+00
[rank0]:2025-10-29 04:09:00,951 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3836  memory: 68.59GiB(49.06%)  tps: 6,253  tflops: 291.62  mfu: 29.49%
[rank3]:2025-10-29 04:09:00,952 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 7.8052e-01
[rank3]:2025-10-29 04:09:00,955 - INFO -  step: 350  loss:  0.8462  grad_norm:  0.3836  memory: 75.33GiB(53.88%)  tps: 6,252  tflops: 291.60  mfu: 29.48%
[rank3]:2025-10-29 04:09:01,380 - INFO - Avg. fwd time: 15.0730 / Avg. bwd time: 41.1203 / Avg. batch time: 465.6643 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-10-29 04:09:01,457 - INFO - Avg. fwd time: 16.1268 / Avg. bwd time: 37.8468 / Avg. batch time: 572.6070 (ms) / GPU bubble ratio: 24.59%
[rank2]:2025-10-29 04:09:01,410 - INFO - Avg. fwd time: 13.7490 / Avg. bwd time: 33.4780 / Avg. batch time: 515.8678 (ms) / GPU bubble ratio: 26.76%
[rank0]:2025-10-29 04:09:01,502 - INFO - Avg. fwd time: 14.4033 / Avg. bwd time: 37.4655 / Avg. batch time: 630.9759 (ms) / GPU bubble ratio: 34.24%
[rank3]:2025-10-29 04:09:26,162 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.3300e+00
[rank1]:2025-10-29 04:09:26,155 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.1128e+00
[rank2]:2025-10-29 04:09:26,152 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.6970e+00
[rank0]:2025-10-29 04:09:26,172 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.7348e+00
[rank2]:2025-10-29 04:09:52,802 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5646e+00
[rank0]:2025-10-29 04:09:52,800 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.2629e+01
[rank3]:2025-10-29 04:09:52,806 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.1702e+01
[rank1]:2025-10-29 04:09:52,806 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0418e+01
[rank1]:2025-10-29 04:10:17,108 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.1210e-01
[rank2]:2025-10-29 04:10:17,105 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.0114e-01
[rank0]:2025-10-29 04:10:17,115 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.8239e-01
[rank3]:2025-10-29 04:10:17,115 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1599e+00
[rank3]:2025-10-29 04:10:43,606 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.9430e+00
[rank1]:2025-10-29 04:10:43,606 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.5378e+00
[rank2]:2025-10-29 04:10:43,602 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6368e+00
[rank0]:2025-10-29 04:10:43,600 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.1738e+00
[rank0]:2025-10-29 04:11:04,521 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:11:06,892 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.6799e+00
[rank3]:2025-10-29 04:11:06,894 - INFO -  step: 400  loss:  0.1002  grad_norm:  0.2822  memory: 75.33GiB(53.88%)  tps: 6,505  tflops: 303.38  mfu: 30.68%
[rank3]:2025-10-29 04:11:06,895 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 04:11:06,885 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.5855e+00
[rank1]:2025-10-29 04:11:06,886 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 68.17GiB(48.76%)  tps: 6,505  tflops: 303.40  mfu: 30.68%
[rank1]:2025-10-29 04:11:06,886 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 04:11:06,893 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2820e+00
[rank0]:2025-10-29 04:11:06,893 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 69.57GiB(49.76%)  tps: 6,505  tflops: 303.37  mfu: 30.67%
[rank0]:2025-10-29 04:11:06,893 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 04:11:06,882 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5028e+00
[rank2]:2025-10-29 04:11:06,883 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2822  memory: 61.15GiB(43.74%)  tps: 6,505  tflops: 303.40  mfu: 30.68%
[rank2]:2025-10-29 04:11:06,883 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 04:11:22,046 - INFO - validate step: 400  loss:  0.2484  memory: 75.33GiB(53.88%)  tps: 27,036
[rank1]:2025-10-29 04:11:22,018 - INFO - validate step: 400  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,069
[rank0]:2025-10-29 04:11:21,988 - INFO - validate step: 400  loss: -1.0000  memory: 69.57GiB(49.76%)  tps: 27,136
[rank2]:2025-10-29 04:11:22,031 - INFO - validate step: 400  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,040
[rank1]:2025-10-29 04:11:22,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0411_stage1_step400.svg
[rank0]:2025-10-29 04:11:22,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0411_stage0_step400.svg
[rank2]:2025-10-29 04:11:22,122 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0411_stage2_step400.svg
[rank3]:2025-10-29 04:11:22,225 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0411_real_step400_rank3.svg
[rank3]:> Batch Time: 630.52 ms, GPU Bubble Ratio: 32.75%, 27.36%, 37.16%, 27.03%
[rank3]:2025-10-29 04:11:22,294 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0411_stage3_step400.svg
[rank3]:2025-10-29 04:11:22,684 - INFO - Avg. fwd time: 15.0657 / Avg. bwd time: 41.0204 / Avg. batch time: 464.7031 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:11:22,734 - INFO - Avg. fwd time: 13.7668 / Avg. bwd time: 33.1617 / Avg. batch time: 514.5129 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 04:11:22,780 - INFO - Avg. fwd time: 16.1331 / Avg. bwd time: 37.6540 / Avg. batch time: 571.0304 (ms) / GPU bubble ratio: 24.65%
[rank0]:2025-10-29 04:11:22,782 - INFO - Avg. fwd time: 14.4425 / Avg. bwd time: 36.8436 / Avg. batch time: 628.4841 (ms) / GPU bubble ratio: 34.72%
[rank3]:2025-10-29 04:11:47,544 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.9499e+00
[rank1]:2025-10-29 04:11:47,543 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4355e+00
[rank2]:2025-10-29 04:11:47,540 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9185e+00
[rank0]:2025-10-29 04:11:47,534 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0753e+00
[rank3]:2025-10-29 04:12:10,829 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3249e+00
[rank0]:2025-10-29 04:12:10,830 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1218e-01
[rank1]:2025-10-29 04:12:10,823 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.5980e-01
[rank2]:2025-10-29 04:12:10,819 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6751e-01
[rank3]:2025-10-29 04:12:36,246 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2799e+00
[rank2]:2025-10-29 04:12:36,243 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4102e-01
[rank0]:2025-10-29 04:12:36,237 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.8841e+00
[rank1]:2025-10-29 04:12:36,246 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5259e+00
[rank3]:2025-10-29 04:12:59,425 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0063e+00
[rank2]:2025-10-29 04:12:59,416 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0035e+00
[rank1]:2025-10-29 04:12:59,419 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9615e-01
[rank0]:2025-10-29 04:12:59,426 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.3457e-01
[rank0]:2025-10-29 04:13:22,319 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:13:24,863 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.1255e-01
[rank3]:2025-10-29 04:13:24,866 - INFO -  step: 450  loss:  0.1013  grad_norm:  0.1548  memory: 75.33GiB(53.88%)  tps: 6,670  tflops: 311.09  mfu: 31.46%
[rank0]:2025-10-29 04:13:24,851 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.7820e-01
[rank0]:2025-10-29 04:13:24,851 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 71.50GiB(51.14%)  tps: 6,668  tflops: 310.98  mfu: 31.44%
[rank2]:2025-10-29 04:13:24,860 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4362e-01
[rank1]:2025-10-29 04:13:24,863 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5399e-01
[rank1]:2025-10-29 04:13:24,864 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 68.17GiB(48.76%)  tps: 6,669  tflops: 311.02  mfu: 31.45%
[rank2]:2025-10-29 04:13:24,860 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.1548  memory: 61.15GiB(43.74%)  tps: 6,669  tflops: 311.06  mfu: 31.45%
[rank3]:2025-10-29 04:13:25,316 - INFO - Avg. fwd time: 14.9790 / Avg. bwd time: 40.9126 / Avg. batch time: 463.0548 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:13:25,347 - INFO - Avg. fwd time: 13.7167 / Avg. bwd time: 32.9925 / Avg. batch time: 512.6607 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-29 04:13:25,419 - INFO - Avg. fwd time: 14.4532 / Avg. bwd time: 35.8947 / Avg. batch time: 625.1104 (ms) / GPU bubble ratio: 35.57%
[rank1]:2025-10-29 04:13:25,383 - INFO - Avg. fwd time: 16.0658 / Avg. bwd time: 37.5801 / Avg. batch time: 569.0772 (ms) / GPU bubble ratio: 24.59%
[rank3]:2025-10-29 04:13:47,269 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3183e+00
[rank1]:2025-10-29 04:13:47,266 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8540e-01
[rank0]:2025-10-29 04:13:47,273 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4730e-01
[rank2]:2025-10-29 04:13:47,262 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9567e+00
[rank0]:2025-10-29 04:14:12,579 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0470e+00
[rank1]:2025-10-29 04:14:12,591 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1510e+00
[rank2]:2025-10-29 04:14:12,587 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7499e-01
[rank3]:2025-10-29 04:14:12,591 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.7215e-01
[rank1]:2025-10-29 04:14:35,191 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.2701e+00
[rank0]:2025-10-29 04:14:35,198 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.3402e+00
[rank2]:2025-10-29 04:14:35,188 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5205e+00
[rank3]:2025-10-29 04:14:35,194 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1685e+00
[rank3]:2025-10-29 04:15:00,367 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.7433e+00
[rank0]:2025-10-29 04:15:00,356 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.0155e+00
[rank1]:2025-10-29 04:15:00,367 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5039e+00
[rank2]:2025-10-29 04:15:00,364 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3416e+00
[rank0]:2025-10-29 04:15:20,721 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:15:22,962 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1103e+00
[rank0]:2025-10-29 04:15:22,963 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 71.50GiB(51.14%)  tps: 6,936  tflops: 323.49  mfu: 32.71%
[rank1]:2025-10-29 04:15:22,955 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8691e+00
[rank1]:2025-10-29 04:15:22,955 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 68.17GiB(48.76%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank2]:2025-10-29 04:15:22,952 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.3180e+00
[rank2]:2025-10-29 04:15:22,952 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2150  memory: 61.15GiB(43.74%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank3]:2025-10-29 04:15:22,958 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6850e+00
[rank3]:2025-10-29 04:15:22,961 - INFO -  step: 500  loss:  0.1154  grad_norm:  0.2150  memory: 76.44GiB(54.68%)  tps: 6,937  tflops: 323.54  mfu: 32.71%
[rank0]:2025-10-29 04:15:23,035 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0415_stage0_step500.svg
[rank1]:2025-10-29 04:15:23,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0415_stage1_step500.svg
[rank2]:2025-10-29 04:15:23,033 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0415_stage2_step500.svg
[rank3]:2025-10-29 04:15:23,141 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0415_real_step500_rank3.svg
[rank3]:> Batch Time: 623.57 ms, GPU Bubble Ratio: 35.27%, 26.88%, 36.72%, 26.83%
[rank3]:2025-10-29 04:15:23,199 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0415_stage3_step500.svg
[rank3]:2025-10-29 04:15:23,583 - INFO - Avg. fwd time: 14.9370 / Avg. bwd time: 40.6490 / Avg. batch time: 460.5422 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:15:23,631 - INFO - Avg. fwd time: 13.6947 / Avg. bwd time: 32.7609 / Avg. batch time: 509.8378 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-29 04:15:23,675 - INFO - Avg. fwd time: 14.4620 / Avg. bwd time: 35.2193 / Avg. batch time: 621.0981 (ms) / GPU bubble ratio: 36.01%
[rank1]:2025-10-29 04:15:23,678 - INFO - Avg. fwd time: 16.0305 / Avg. bwd time: 37.4164 / Avg. batch time: 566.0634 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 04:15:48,405 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.7199e+00
[rank1]:2025-10-29 04:15:48,416 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2938e+00
[rank2]:2025-10-29 04:15:48,413 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0520e-01
[rank3]:2025-10-29 04:15:48,416 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.1872e-01
[rank3]:2025-10-29 04:16:10,920 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.1856e-01
[rank0]:2025-10-29 04:16:10,924 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.7080e-01
[rank1]:2025-10-29 04:16:10,916 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5709e-01
[rank2]:2025-10-29 04:16:10,913 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0611e-01
[rank0]:2025-10-29 04:16:36,314 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.2650e+00
[rank1]:2025-10-29 04:16:36,326 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0296e+00
[rank2]:2025-10-29 04:16:36,322 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4351e+00
[rank3]:2025-10-29 04:16:36,326 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.6595e+00
[rank1]:2025-10-29 04:16:58,690 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1939e+00
[rank0]:2025-10-29 04:16:58,697 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.6231e+00
[rank2]:2025-10-29 04:16:58,687 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.6353e+00
[rank3]:2025-10-29 04:16:58,693 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.3097e+00
[rank0]:2025-10-29 04:17:21,460 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:17:23,988 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.8281e-01
[rank3]:2025-10-29 04:17:23,992 - INFO -  step: 550  loss:  0.1234  grad_norm:  0.1225  memory: 76.44GiB(54.68%)  tps: 6,769  tflops: 315.69  mfu: 31.92%
[rank1]:2025-10-29 04:17:23,988 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.4552e-01
[rank1]:2025-10-29 04:17:23,989 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 68.17GiB(48.76%)  tps: 6,768  tflops: 315.68  mfu: 31.92%
[rank0]:2025-10-29 04:17:23,976 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.7485e+00
[rank0]:2025-10-29 04:17:23,977 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 71.50GiB(51.14%)  tps: 6,769  tflops: 315.73  mfu: 31.92%
[rank2]:2025-10-29 04:17:23,985 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9512e-01
[rank2]:2025-10-29 04:17:23,985 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1225  memory: 61.15GiB(43.74%)  tps: 6,768  tflops: 315.68  mfu: 31.92%
[rank3]:2025-10-29 04:17:24,355 - INFO - Avg. fwd time: 14.8910 / Avg. bwd time: 40.4590 / Avg. batch time: 458.5910 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 04:17:24,430 - INFO - Avg. fwd time: 15.9883 / Avg. bwd time: 37.3429 / Avg. batch time: 563.8587 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-10-29 04:17:24,450 - INFO - Avg. fwd time: 14.4737 / Avg. bwd time: 34.5292 / Avg. batch time: 617.8913 (ms) / GPU bubble ratio: 36.55%
[rank2]:2025-10-29 04:17:24,386 - INFO - Avg. fwd time: 13.6648 / Avg. bwd time: 32.6211 / Avg. batch time: 507.7291 (ms) / GPU bubble ratio: 27.07%
[rank1]:2025-10-29 04:17:46,526 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0071e+00
[rank0]:2025-10-29 04:17:46,533 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.3515e-01
[rank2]:2025-10-29 04:17:46,522 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6047e+00
[rank3]:2025-10-29 04:17:46,529 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9171e+00
[rank1]:2025-10-29 04:18:11,703 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1181e+00
[rank2]:2025-10-29 04:18:11,699 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9740e-01
[rank0]:2025-10-29 04:18:11,691 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1880e+00
[rank3]:2025-10-29 04:18:11,703 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0935e+00
[rank1]:2025-10-29 04:18:34,271 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.9666e-01
[rank2]:2025-10-29 04:18:34,268 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.9204e-01
[rank0]:2025-10-29 04:18:34,278 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.9701e-01
[rank3]:2025-10-29 04:18:34,274 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5098e+00
[rank0]:2025-10-29 04:18:59,446 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0601e+00
[rank3]:2025-10-29 04:18:59,458 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.5042e-01
[rank1]:2025-10-29 04:18:59,458 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.3248e-01
[rank2]:2025-10-29 04:18:59,455 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2401e-01
[rank0]:2025-10-29 04:19:19,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:19:21,863 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4251e+00
[rank2]:2025-10-29 04:19:21,863 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 61.15GiB(43.74%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank2]:2025-10-29 04:19:21,863 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 04:19:21,869 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.7199e-01
[rank3]:2025-10-29 04:19:21,871 - INFO -  step: 600  loss:  0.0938  grad_norm:  0.0828  memory: 76.44GiB(54.68%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank3]:2025-10-29 04:19:21,872 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:19:21,873 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.5105e-01
[rank0]:2025-10-29 04:19:21,873 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 71.50GiB(51.14%)  tps: 6,948  tflops: 324.08  mfu: 32.77%
[rank0]:2025-10-29 04:19:21,873 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 04:19:21,866 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.4295e-01
[rank1]:2025-10-29 04:19:21,866 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0828  memory: 68.17GiB(48.76%)  tps: 6,950  tflops: 324.13  mfu: 32.77%
[rank1]:2025-10-29 04:19:21,866 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 04:19:36,840 - INFO - validate step: 600  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,368
[rank1]:2025-10-29 04:19:36,870 - INFO - validate step: 600  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,301
[rank3]:2025-10-29 04:19:36,899 - INFO - validate step: 600  loss:  0.2667  memory: 76.44GiB(54.68%)  tps: 27,259
[rank1]:2025-10-29 04:19:36,969 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0419_stage1_step600.svg
[rank2]:2025-10-29 04:19:36,883 - INFO - validate step: 600  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,271
[rank0]:2025-10-29 04:19:36,975 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0419_stage0_step600.svg
[rank2]:2025-10-29 04:19:36,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0419_stage2_step600.svg
[rank3]:2025-10-29 04:19:37,077 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0419_real_step600_rank3.svg
[rank3]:> Batch Time: 618.18 ms, GPU Bubble Ratio: 37.76%, 26.46%, 36.41%, 26.60%
[rank3]:2025-10-29 04:19:37,137 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0419_stage3_step600.svg
[rank3]:2025-10-29 04:19:37,611 - INFO - Avg. fwd time: 14.8544 / Avg. bwd time: 40.2293 / Avg. batch time: 456.4070 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:19:37,653 - INFO - Avg. fwd time: 13.6447 / Avg. bwd time: 32.4134 / Avg. batch time: 505.3136 (ms) / GPU bubble ratio: 27.08%
[rank1]:2025-10-29 04:19:37,700 - INFO - Avg. fwd time: 15.9542 / Avg. bwd time: 37.1862 / Avg. batch time: 561.2591 (ms) / GPU bubble ratio: 24.26%
[rank0]:2025-10-29 04:19:37,731 - INFO - Avg. fwd time: 14.4728 / Avg. bwd time: 33.9994 / Avg. batch time: 614.5006 (ms) / GPU bubble ratio: 36.90%
[rank2]:2025-10-29 04:20:02,494 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.4287e-01
[rank0]:2025-10-29 04:20:02,485 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.2590e+00
[rank1]:2025-10-29 04:20:02,497 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7476e+00
[rank3]:2025-10-29 04:20:02,497 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.6871e+00
[rank1]:2025-10-29 04:20:24,893 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.0053e-01
[rank0]:2025-10-29 04:20:24,900 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4623e+00
[rank2]:2025-10-29 04:20:24,890 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7326e+00
[rank3]:2025-10-29 04:20:24,896 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6422e-01
[rank2]:2025-10-29 04:20:50,205 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1788e-01
[rank1]:2025-10-29 04:20:50,208 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.4166e-01
[rank0]:2025-10-29 04:20:50,196 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.5647e+00
[rank3]:2025-10-29 04:20:50,208 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5384e-01
[rank1]:2025-10-29 04:21:12,838 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.1268e+00
[rank0]:2025-10-29 04:21:12,845 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.5720e+00
[rank2]:2025-10-29 04:21:12,834 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5361e+00
[rank3]:2025-10-29 04:21:12,841 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2801e+00
[rank0]:2025-10-29 04:21:35,459 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:21:37,997 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.1609e+00
[rank3]:2025-10-29 04:21:37,999 - INFO -  step: 650  loss:  0.0845  grad_norm:  0.1135  memory: 76.44GiB(54.68%)  tps: 6,765  tflops: 315.51  mfu: 31.90%
[rank0]:2025-10-29 04:21:37,985 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.8270e-01
[rank0]:2025-10-29 04:21:37,985 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 71.50GiB(51.14%)  tps: 6,762  tflops: 315.39  mfu: 31.89%
[rank2]:2025-10-29 04:21:37,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.8353e-01
[rank2]:2025-10-29 04:21:37,994 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 61.15GiB(43.74%)  tps: 6,764  tflops: 315.48  mfu: 31.90%
[rank1]:2025-10-29 04:21:37,997 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.3091e-01
[rank1]:2025-10-29 04:21:37,997 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1135  memory: 68.17GiB(48.76%)  tps: 6,763  tflops: 315.43  mfu: 31.89%
[rank3]:2025-10-29 04:21:38,366 - INFO - Avg. fwd time: 14.8268 / Avg. bwd time: 40.1365 / Avg. batch time: 455.4057 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:21:38,398 - INFO - Avg. fwd time: 13.6250 / Avg. bwd time: 32.3558 / Avg. batch time: 504.2069 (ms) / GPU bubble ratio: 27.04%
[rank0]:2025-10-29 04:21:38,461 - INFO - Avg. fwd time: 14.4810 / Avg. bwd time: 33.5703 / Avg. batch time: 612.7427 (ms) / GPU bubble ratio: 37.26%
[rank1]:2025-10-29 04:21:38,442 - INFO - Avg. fwd time: 15.9274 / Avg. bwd time: 37.1678 / Avg. batch time: 560.1204 (ms) / GPU bubble ratio: 24.17%
[rank2]:2025-10-29 04:22:00,558 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.7190e+00
[rank1]:2025-10-29 04:22:00,562 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9908e+00
[rank0]:2025-10-29 04:22:00,569 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.0621e+00
[rank3]:2025-10-29 04:22:00,565 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8412e+00
[rank0]:2025-10-29 04:22:25,810 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.7496e+00
[rank3]:2025-10-29 04:22:25,822 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.3617e+00
[rank2]:2025-10-29 04:22:25,819 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4819e+00
[rank1]:2025-10-29 04:22:25,822 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.3247e+00
[rank3]:2025-10-29 04:22:48,285 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.1585e-01
[rank2]:2025-10-29 04:22:48,278 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0715e+00
[rank0]:2025-10-29 04:22:48,290 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.5452e-01
[rank1]:2025-10-29 04:22:48,282 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1222e+00
[rank0]:2025-10-29 04:23:13,651 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.2849e+00
[rank3]:2025-10-29 04:23:13,663 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5457e+00
[rank1]:2025-10-29 04:23:13,663 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.9104e+00
[rank2]:2025-10-29 04:23:13,660 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2762e+00
[rank0]:2025-10-29 04:23:33,768 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:23:36,048 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0669e+00
[rank0]:2025-10-29 04:23:36,049 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 71.50GiB(51.14%)  tps: 6,939  tflops: 323.62  mfu: 32.72%
[rank2]:2025-10-29 04:23:36,038 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1813e+00
[rank2]:2025-10-29 04:23:36,038 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 61.15GiB(43.74%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank1]:2025-10-29 04:23:36,041 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2686e+00
[rank1]:2025-10-29 04:23:36,041 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1229  memory: 68.17GiB(48.76%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank3]:2025-10-29 04:23:36,044 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.2247e+00
[rank3]:2025-10-29 04:23:36,047 - INFO -  step: 700  loss:  0.0995  grad_norm:  0.1229  memory: 76.44GiB(54.68%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank0]:2025-10-29 04:23:36,127 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0423_stage0_step700.svg
[rank1]:2025-10-29 04:23:36,119 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0423_stage1_step700.svg
[rank2]:2025-10-29 04:23:36,121 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0423_stage2_step700.svg
[rank3]:2025-10-29 04:23:36,223 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0423_real_step700_rank3.svg
[rank3]:> Batch Time: 616.27 ms, GPU Bubble Ratio: 38.18%, 26.42%, 36.33%, 26.61%
[rank3]:2025-10-29 04:23:36,285 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0423_stage3_step700.svg
[rank3]:2025-10-29 04:23:36,674 - INFO - Avg. fwd time: 14.7998 / Avg. bwd time: 39.9911 / Avg. batch time: 453.9880 (ms) / GPU bubble ratio: 3.45%
[rank0]:2025-10-29 04:23:36,766 - INFO - Avg. fwd time: 14.4822 / Avg. bwd time: 33.1723 / Avg. batch time: 610.4455 (ms) / GPU bubble ratio: 37.55%
[rank1]:2025-10-29 04:23:36,770 - INFO - Avg. fwd time: 15.9036 / Avg. bwd time: 37.0817 / Avg. batch time: 558.4118 (ms) / GPU bubble ratio: 24.09%
[rank2]:2025-10-29 04:23:36,724 - INFO - Avg. fwd time: 13.6087 / Avg. bwd time: 32.2307 / Avg. batch time: 502.6106 (ms) / GPU bubble ratio: 27.04%
[rank3]:2025-10-29 04:24:01,454 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.1526e-01
[rank0]:2025-10-29 04:24:01,442 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3360e-01
[rank1]:2025-10-29 04:24:01,454 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6532e-01
[rank2]:2025-10-29 04:24:01,451 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7088e-01
[rank3]:2025-10-29 04:24:23,945 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1293e+00
[rank0]:2025-10-29 04:24:23,949 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.9499e-01
[rank2]:2025-10-29 04:24:23,938 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2380e-01
[rank1]:2025-10-29 04:24:23,941 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.2873e-01
[rank1]:2025-10-29 04:24:49,108 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7921e+00
[rank0]:2025-10-29 04:24:49,096 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.6957e+00
[rank2]:2025-10-29 04:24:49,105 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0504e+00
[rank3]:2025-10-29 04:24:49,108 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8115e+00
[rank1]:2025-10-29 04:25:11,658 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0983e+00
[rank2]:2025-10-29 04:25:11,655 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1562e+00
[rank3]:2025-10-29 04:25:11,662 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5991e+00
[rank0]:2025-10-29 04:25:11,666 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.0910e-01
[rank0]:2025-10-29 04:25:34,310 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:25:36,866 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.2558e+00
[rank0]:2025-10-29 04:25:36,867 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 71.50GiB(51.14%)  tps: 6,780  tflops: 316.24  mfu: 31.98%
[rank2]:2025-10-29 04:25:36,875 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9322e+00
[rank2]:2025-10-29 04:25:36,876 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 61.15GiB(43.74%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank1]:2025-10-29 04:25:36,878 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1418e+00
[rank1]:2025-10-29 04:25:36,879 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1488  memory: 68.17GiB(48.76%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank3]:2025-10-29 04:25:36,878 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.4558e+00
[rank3]:2025-10-29 04:25:36,881 - INFO -  step: 750  loss:  0.1319  grad_norm:  0.1488  memory: 76.44GiB(54.68%)  tps: 6,780  tflops: 316.20  mfu: 31.97%
[rank3]:2025-10-29 04:25:37,341 - INFO - Avg. fwd time: 14.7702 / Avg. bwd time: 39.9190 / Avg. batch time: 453.1412 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:25:37,374 - INFO - Avg. fwd time: 13.5856 / Avg. bwd time: 32.1935 / Avg. batch time: 501.7223 (ms) / GPU bubble ratio: 27.00%
[rank0]:2025-10-29 04:25:37,448 - INFO - Avg. fwd time: 14.4854 / Avg. bwd time: 32.7899 / Avg. batch time: 608.9889 (ms) / GPU bubble ratio: 37.90%
[rank1]:2025-10-29 04:25:37,411 - INFO - Avg. fwd time: 15.8734 / Avg. bwd time: 37.0796 / Avg. batch time: 557.5040 (ms) / GPU bubble ratio: 24.01%
[rank3]:2025-10-29 04:25:59,320 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7460e+00
[rank2]:2025-10-29 04:25:59,313 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5893e+00
[rank1]:2025-10-29 04:25:59,316 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9242e+00
[rank0]:2025-10-29 04:25:59,323 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.6705e+00
[rank2]:2025-10-29 04:26:24,701 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.6857e-01
[rank1]:2025-10-29 04:26:24,704 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6953e-01
[rank0]:2025-10-29 04:26:24,692 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8417e-01
[rank3]:2025-10-29 04:26:24,704 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.1857e-01
[rank3]:2025-10-29 04:26:47,060 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.4149e+00
[rank2]:2025-10-29 04:26:47,054 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.7138e+00
[rank1]:2025-10-29 04:26:47,057 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2459e+00
[rank0]:2025-10-29 04:26:47,064 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.2092e-01
[rank2]:2025-10-29 04:27:12,346 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1485e-01
[rank1]:2025-10-29 04:27:12,349 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0168e-01
[rank0]:2025-10-29 04:27:12,337 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.3020e-01
[rank3]:2025-10-29 04:27:12,349 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.6510e-01
[rank0]:2025-10-29 04:27:32,610 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:27:34,910 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9095e+00
[rank3]:2025-10-29 04:27:34,912 - INFO -  step: 800  loss:  0.1116  grad_norm:  0.1307  memory: 76.44GiB(54.68%)  tps: 6,941  tflops: 323.71  mfu: 32.73%
[rank3]:2025-10-29 04:27:34,913 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 04:27:34,904 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1679e+00
[rank2]:2025-10-29 04:27:34,904 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 61.15GiB(43.74%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank2]:2025-10-29 04:27:34,904 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:27:34,906 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0121e+00
[rank1]:2025-10-29 04:27:34,907 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 68.17GiB(48.76%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank1]:2025-10-29 04:27:34,907 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:27:34,914 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.6731e-01
[rank0]:2025-10-29 04:27:34,914 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1307  memory: 71.50GiB(51.14%)  tps: 6,940  tflops: 323.66  mfu: 32.73%
[rank0]:2025-10-29 04:27:34,914 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:27:49,998 - INFO - validate step: 800  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,142
[rank0]:2025-10-29 04:27:49,968 - INFO - validate step: 800  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,210
[rank3]:2025-10-29 04:27:50,025 - INFO - validate step: 800  loss:  0.2681  memory: 76.44GiB(54.68%)  tps: 27,106
[rank1]:2025-10-29 04:27:50,099 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0427_stage1_step800.svg
[rank2]:2025-10-29 04:27:50,012 - INFO - validate step: 800  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,113
[rank2]:2025-10-29 04:27:50,107 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0427_stage2_step800.svg
[rank0]:2025-10-29 04:27:50,106 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0427_stage0_step800.svg
[rank3]:2025-10-29 04:27:50,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0427_real_step800_rank3.svg
[rank3]:> Batch Time: 613.12 ms, GPU Bubble Ratio: 40.52%, 26.15%, 36.08%, 26.37%
[rank3]:2025-10-29 04:27:50,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0427_stage3_step800.svg
[rank3]:2025-10-29 04:27:50,668 - INFO - Avg. fwd time: 14.7531 / Avg. bwd time: 39.8107 / Avg. batch time: 452.1129 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:27:50,764 - INFO - Avg. fwd time: 15.8574 / Avg. bwd time: 37.0029 / Avg. batch time: 556.2414 (ms) / GPU bubble ratio: 23.97%
[rank2]:2025-10-29 04:27:50,718 - INFO - Avg. fwd time: 13.5759 / Avg. bwd time: 32.0935 / Avg. batch time: 500.5568 (ms) / GPU bubble ratio: 27.01%
[rank0]:2025-10-29 04:27:50,761 - INFO - Avg. fwd time: 14.4843 / Avg. bwd time: 32.5415 / Avg. batch time: 607.3555 (ms) / GPU bubble ratio: 38.06%
[rank3]:2025-10-29 04:28:15,362 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2249e+00
[rank1]:2025-10-29 04:28:15,362 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.8022e-01
[rank2]:2025-10-29 04:28:15,359 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6715e-01
[rank0]:2025-10-29 04:28:15,350 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5704e-01
[rank1]:2025-10-29 04:28:37,942 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1601e-01
[rank2]:2025-10-29 04:28:37,939 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2109e+00
[rank3]:2025-10-29 04:28:37,945 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3128e-01
[rank0]:2025-10-29 04:28:37,949 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.9213e-01
[rank1]:2025-10-29 04:29:03,163 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.1791e-01
[rank2]:2025-10-29 04:29:03,159 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8601e-01
[rank0]:2025-10-29 04:29:03,151 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.3444e+00
[rank3]:2025-10-29 04:29:03,163 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.7504e-01
[rank3]:2025-10-29 04:29:25,611 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.1779e-01
[rank1]:2025-10-29 04:29:25,607 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.8720e-01
[rank2]:2025-10-29 04:29:25,604 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.2311e-01
[rank0]:2025-10-29 04:29:25,615 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7630e-01
[rank0]:2025-10-29 04:29:48,489 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:29:51,037 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0088e+00
[rank3]:2025-10-29 04:29:51,040 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.2988  memory: 76.44GiB(54.68%)  tps: 6,769  tflops: 315.73  mfu: 31.92%
[rank1]:2025-10-29 04:29:51,036 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1823e-01
[rank1]:2025-10-29 04:29:51,037 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 68.17GiB(48.76%)  tps: 6,768  tflops: 315.67  mfu: 31.92%
[rank0]:2025-10-29 04:29:51,024 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.4766e+00
[rank0]:2025-10-29 04:29:51,025 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 71.50GiB(51.14%)  tps: 6,767  tflops: 315.62  mfu: 31.91%
[rank2]:2025-10-29 04:29:51,033 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3368e-01
[rank2]:2025-10-29 04:29:51,033 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2988  memory: 61.15GiB(43.74%)  tps: 6,769  tflops: 315.71  mfu: 31.92%
[rank3]:2025-10-29 04:29:51,401 - INFO - Avg. fwd time: 14.7359 / Avg. bwd time: 39.7407 / Avg. batch time: 451.3906 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:29:51,476 - INFO - Avg. fwd time: 15.8383 / Avg. bwd time: 36.9783 / Avg. batch time: 555.4289 (ms) / GPU bubble ratio: 23.93%
[rank0]:2025-10-29 04:29:51,495 - INFO - Avg. fwd time: 14.4885 / Avg. bwd time: 32.2579 / Avg. batch time: 606.1297 (ms) / GPU bubble ratio: 38.30%
[rank2]:2025-10-29 04:29:51,432 - INFO - Avg. fwd time: 13.5636 / Avg. bwd time: 32.0449 / Avg. batch time: 499.7838 (ms) / GPU bubble ratio: 26.99%
[rank1]:2025-10-29 04:30:13,405 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9641e+00
[rank0]:2025-10-29 04:30:13,412 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.4446e-01
[rank2]:2025-10-29 04:30:13,401 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8344e+00
[rank3]:2025-10-29 04:30:13,408 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7550e+00
[rank1]:2025-10-29 04:30:38,726 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0695e+00
[rank2]:2025-10-29 04:30:38,723 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2894e-01
[rank0]:2025-10-29 04:30:38,714 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.2996e+00
[rank3]:2025-10-29 04:30:38,726 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.4743e-01
[rank1]:2025-10-29 04:31:01,325 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0020e+00
[rank2]:2025-10-29 04:31:01,321 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0292e+00
[rank0]:2025-10-29 04:31:01,332 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3432e+00
[rank3]:2025-10-29 04:31:01,328 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6326e+00
[rank1]:2025-10-29 04:31:26,479 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1940e-01
[rank2]:2025-10-29 04:31:26,476 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1435e-01
[rank0]:2025-10-29 04:31:26,467 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1480e+00
[rank3]:2025-10-29 04:31:26,480 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.9412e-01
[rank0]:2025-10-29 04:31:46,823 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:31:49,064 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.8418e-01
[rank3]:2025-10-29 04:31:49,067 - INFO -  step: 900  loss:  0.1227  grad_norm:  0.1846  memory: 76.44GiB(54.68%)  tps: 6,941  tflops: 323.72  mfu: 32.73%
[rank1]:2025-10-29 04:31:49,061 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.8285e-01
[rank1]:2025-10-29 04:31:49,061 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 68.17GiB(48.76%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank2]:2025-10-29 04:31:49,058 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5137e-01
[rank2]:2025-10-29 04:31:49,058 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 61.15GiB(43.74%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank0]:2025-10-29 04:31:49,068 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.8528e-01
[rank0]:2025-10-29 04:31:49,068 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1846  memory: 71.50GiB(51.14%)  tps: 6,940  tflops: 323.67  mfu: 32.73%
[rank1]:2025-10-29 04:31:49,135 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0431_stage1_step900.svg
[rank2]:2025-10-29 04:31:49,139 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0431_stage2_step900.svg
[rank0]:2025-10-29 04:31:49,141 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0431_stage0_step900.svg
[rank3]:2025-10-29 04:31:49,250 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0431_real_step900_rank3.svg
[rank3]:> Batch Time: 612.16 ms, GPU Bubble Ratio: 40.57%, 26.12%, 36.03%, 26.37%
[rank3]:2025-10-29 04:31:49,308 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0431_stage3_step900.svg
[rank3]:2025-10-29 04:31:49,777 - INFO - Avg. fwd time: 14.7231 / Avg. bwd time: 39.6330 / Avg. batch time: 450.4026 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:31:49,869 - INFO - Avg. fwd time: 15.8266 / Avg. bwd time: 36.8967 / Avg. batch time: 554.2444 (ms) / GPU bubble ratio: 23.90%
[rank0]:2025-10-29 04:31:49,902 - INFO - Avg. fwd time: 14.4899 / Avg. bwd time: 32.0385 / Avg. batch time: 604.6201 (ms) / GPU bubble ratio: 38.44%
[rank2]:2025-10-29 04:31:49,821 - INFO - Avg. fwd time: 13.5579 / Avg. bwd time: 31.9424 / Avg. batch time: 498.6945 (ms) / GPU bubble ratio: 27.01%
[rank3]:2025-10-29 04:32:14,488 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5763e-01
[rank1]:2025-10-29 04:32:14,488 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.6191e-01
[rank2]:2025-10-29 04:32:14,485 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9313e-01
[rank0]:2025-10-29 04:32:14,476 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.8253e+00
[rank2]:2025-10-29 04:32:36,949 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1818e+00
[rank3]:2025-10-29 04:32:36,956 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.7933e-01
[rank1]:2025-10-29 04:32:36,952 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3524e+00
[rank0]:2025-10-29 04:32:36,960 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2086e+00
[rank1]:2025-10-29 04:33:02,362 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1630e-01
[rank0]:2025-10-29 04:33:02,350 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0495e+00
[rank2]:2025-10-29 04:33:02,359 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.8411e-01
[rank3]:2025-10-29 04:33:02,362 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0928e+00
[rank2]:2025-10-29 04:33:24,788 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.2173e-01
[rank3]:2025-10-29 04:33:24,794 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4729e+00
[rank1]:2025-10-29 04:33:24,791 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.8615e-01
[rank0]:2025-10-29 04:33:24,798 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.7906e-01
[rank0]:2025-10-29 04:33:47,611 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:33:50,146 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5152e+00
[rank3]:2025-10-29 04:33:50,148 - INFO -  step: 950  loss:  0.1484  grad_norm:  0.1783  memory: 76.44GiB(54.68%)  tps: 6,766  tflops: 315.56  mfu: 31.91%
[rank1]:2025-10-29 04:33:50,146 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.5200e-01
[rank1]:2025-10-29 04:33:50,146 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 68.17GiB(48.76%)  tps: 6,766  tflops: 315.54  mfu: 31.91%
[rank0]:2025-10-29 04:33:50,134 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.7136e-01
[rank0]:2025-10-29 04:33:50,134 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 71.50GiB(51.14%)  tps: 6,767  tflops: 315.59  mfu: 31.91%
[rank2]:2025-10-29 04:33:50,142 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1769e-01
[rank2]:2025-10-29 04:33:50,143 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1783  memory: 61.15GiB(43.74%)  tps: 6,766  tflops: 315.55  mfu: 31.91%
[rank3]:2025-10-29 04:33:50,513 - INFO - Avg. fwd time: 14.7094 / Avg. bwd time: 39.5981 / Avg. batch time: 449.9972 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:33:50,589 - INFO - Avg. fwd time: 15.8125 / Avg. bwd time: 36.8991 / Avg. batch time: 553.7860 (ms) / GPU bubble ratio: 23.85%
[rank0]:2025-10-29 04:33:50,610 - INFO - Avg. fwd time: 14.4939 / Avg. bwd time: 31.8381 / Avg. batch time: 603.8768 (ms) / GPU bubble ratio: 38.62%
[rank2]:2025-10-29 04:33:50,545 - INFO - Avg. fwd time: 13.5473 / Avg. bwd time: 31.9259 / Avg. batch time: 498.2457 (ms) / GPU bubble ratio: 26.99%
[rank3]:2025-10-29 04:34:12,790 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8086e+00
[rank1]:2025-10-29 04:34:12,786 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6874e+00
[rank0]:2025-10-29 04:34:12,794 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.8185e+00
[rank2]:2025-10-29 04:34:12,783 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.6606e+00
[rank0]:2025-10-29 04:34:37,945 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1017e+00
[rank3]:2025-10-29 04:34:37,957 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.4860e+00
[rank2]:2025-10-29 04:34:37,954 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3502e-01
[rank1]:2025-10-29 04:34:37,957 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0151e+00
[rank3]:2025-10-29 04:35:00,603 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9574e+00
[rank0]:2025-10-29 04:35:00,607 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7575e+00
[rank2]:2025-10-29 04:35:00,597 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4528e+00
[rank1]:2025-10-29 04:35:00,600 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7415e+00
[rank3]:2025-10-29 04:35:25,911 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.9188e+00
[rank0]:2025-10-29 04:35:25,898 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.9856e+00
[rank2]:2025-10-29 04:35:25,907 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0395e+00
[rank1]:2025-10-29 04:35:25,910 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.7714e+00
[rank0]:2025-10-29 04:35:46,193 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:35:48,461 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8936e+00
[rank3]:2025-10-29 04:35:48,463 - INFO -  step: 1000  loss:  0.1225  grad_norm:  0.1060  memory: 76.44GiB(54.68%)  tps: 6,924  tflops: 322.93  mfu: 32.65%
[rank3]:2025-10-29 04:35:48,464 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:35:48,464 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4109e+00
[rank0]:2025-10-29 04:35:48,465 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 71.50GiB(51.14%)  tps: 6,923  tflops: 322.89  mfu: 32.65%
[rank0]:2025-10-29 04:35:48,465 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 04:35:48,454 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4161e+00
[rank2]:2025-10-29 04:35:48,454 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 61.15GiB(43.74%)  tps: 6,924  tflops: 322.94  mfu: 32.65%
[rank2]:2025-10-29 04:35:48,454 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 04:35:48,457 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3185e+00
[rank1]:2025-10-29 04:35:48,458 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1060  memory: 68.17GiB(48.76%)  tps: 6,924  tflops: 322.94  mfu: 32.65%
[rank1]:2025-10-29 04:35:48,458 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:36:03,515 - INFO - validate step: 1000  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,216
[rank3]:2025-10-29 04:36:03,572 - INFO - validate step: 1000  loss:  0.2714  memory: 76.44GiB(54.68%)  tps: 27,112
[rank2]:2025-10-29 04:36:03,560 - INFO - validate step: 1000  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,117
[rank1]:2025-10-29 04:36:03,548 - INFO - validate step: 1000  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,144
[rank0]:2025-10-29 04:36:03,650 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0436_stage0_step1000.svg
[rank2]:2025-10-29 04:36:03,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0436_stage2_step1000.svg
[rank1]:2025-10-29 04:36:03,645 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0436_stage1_step1000.svg
[rank3]:2025-10-29 04:36:03,756 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0436_real_step1000_rank3.svg
[rank3]:> Batch Time: 611.54 ms, GPU Bubble Ratio: 40.58%, 26.09%, 36.01%, 26.38%
[rank3]:2025-10-29 04:36:03,816 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0436_stage3_step1000.svg
[rank3]:2025-10-29 04:36:04,205 - INFO - Avg. fwd time: 14.6989 / Avg. bwd time: 39.5295 / Avg. batch time: 449.3471 (ms) / GPU bubble ratio: 3.45%
[rank0]:2025-10-29 04:36:04,296 - INFO - Avg. fwd time: 14.4962 / Avg. bwd time: 31.6529 / Avg. batch time: 602.8095 (ms) / GPU bubble ratio: 38.75%
[rank2]:2025-10-29 04:36:04,254 - INFO - Avg. fwd time: 13.5417 / Avg. bwd time: 31.8647 / Avg. batch time: 497.5059 (ms) / GPU bubble ratio: 26.99%
[rank1]:2025-10-29 04:36:04,299 - INFO - Avg. fwd time: 15.8029 / Avg. bwd time: 36.8575 / Avg. batch time: 552.9919 (ms) / GPU bubble ratio: 23.82%
[rank0]:2025-10-29 04:36:29,212 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.9651e-01
[rank2]:2025-10-29 04:36:29,222 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2894e-01
[rank1]:2025-10-29 04:36:29,224 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4825e+00
[rank3]:2025-10-29 04:36:29,225 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2128e+00
[rank0]:2025-10-29 04:36:51,659 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.5951e-01
[rank2]:2025-10-29 04:36:51,648 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.7120e-01
[rank1]:2025-10-29 04:36:51,651 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2032e-01
[rank3]:2025-10-29 04:36:51,655 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.3533e-01
[rank0]:2025-10-29 04:37:16,966 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.1389e+00
[rank2]:2025-10-29 04:37:16,974 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6705e+00
[rank1]:2025-10-29 04:37:16,978 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1887e+00
[rank3]:2025-10-29 04:37:16,978 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.2489e+00
[rank0]:2025-10-29 04:37:39,596 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.5503e+00
[rank2]:2025-10-29 04:37:39,585 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8432e+00
[rank1]:2025-10-29 04:37:39,588 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.5712e+00
[rank3]:2025-10-29 04:37:39,591 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2789e+00
[rank0]:2025-10-29 04:38:02,236 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:38:04,776 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.6873e+00
[rank0]:2025-10-29 04:38:04,776 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 71.50GiB(51.14%)  tps: 6,756  tflops: 315.09  mfu: 31.86%
[rank2]:2025-10-29 04:38:04,785 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5507e+00
[rank2]:2025-10-29 04:38:04,786 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 61.15GiB(43.74%)  tps: 6,758  tflops: 315.18  mfu: 31.87%
[rank1]:2025-10-29 04:38:04,788 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.7683e+00
[rank1]:2025-10-29 04:38:04,789 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1391  memory: 68.17GiB(48.76%)  tps: 6,757  tflops: 315.14  mfu: 31.86%
[rank3]:2025-10-29 04:38:04,788 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.8705e-01
[rank3]:2025-10-29 04:38:04,791 - INFO -  step: 1050  loss:  0.1311  grad_norm:  0.1391  memory: 76.44GiB(54.68%)  tps: 6,758  tflops: 315.20  mfu: 31.87%
[rank3]:2025-10-29 04:38:05,248 - INFO - Avg. fwd time: 14.6862 / Avg. bwd time: 39.5061 / Avg. batch time: 449.0420 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:38:05,282 - INFO - Avg. fwd time: 13.5314 / Avg. bwd time: 31.8601 / Avg. batch time: 497.2023 (ms) / GPU bubble ratio: 26.97%
[rank1]:2025-10-29 04:38:05,320 - INFO - Avg. fwd time: 15.7885 / Avg. bwd time: 36.8709 / Avg. batch time: 552.6928 (ms) / GPU bubble ratio: 23.78%
[rank0]:2025-10-29 04:38:05,358 - INFO - Avg. fwd time: 14.5010 / Avg. bwd time: 31.4585 / Avg. batch time: 602.2345 (ms) / GPU bubble ratio: 38.95%
[rank2]:2025-10-29 04:38:27,434 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4924e+00
[rank1]:2025-10-29 04:38:27,437 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.5333e-01
[rank3]:2025-10-29 04:38:27,440 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6401e+00
[rank0]:2025-10-29 04:38:27,444 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.7281e-01
[rank2]:2025-10-29 04:38:52,740 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.9350e-01
[rank0]:2025-10-29 04:38:52,731 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.3656e+00
[rank1]:2025-10-29 04:38:52,743 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7327e+00
[rank3]:2025-10-29 04:38:52,743 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5750e+00
[rank2]:2025-10-29 04:39:15,241 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.1137e-01
[rank0]:2025-10-29 04:39:15,252 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9820e+00
[rank1]:2025-10-29 04:39:15,245 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2582e+00
[rank3]:2025-10-29 04:39:15,248 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3219e-01
[rank3]:2025-10-29 04:39:40,732 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.2832e+00
[rank0]:2025-10-29 04:39:40,720 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.4292e+00
[rank2]:2025-10-29 04:39:40,728 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7406e+00
[rank1]:2025-10-29 04:39:40,732 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6000e+00
[rank0]:2025-10-29 04:40:00,830 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:40:03,104 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4204e+00
[rank2]:2025-10-29 04:40:03,105 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 61.15GiB(43.74%)  tps: 6,924  tflops: 322.92  mfu: 32.65%
[rank0]:2025-10-29 04:40:03,115 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.1571e+00
[rank0]:2025-10-29 04:40:03,115 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 71.50GiB(51.14%)  tps: 6,923  tflops: 322.87  mfu: 32.65%
[rank1]:2025-10-29 04:40:03,107 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8633e+00
[rank1]:2025-10-29 04:40:03,108 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1065  memory: 68.17GiB(48.76%)  tps: 6,924  tflops: 322.92  mfu: 32.65%
[rank3]:2025-10-29 04:40:03,111 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.2355e+00
[rank3]:2025-10-29 04:40:03,113 - INFO -  step: 1100  loss:  0.0994  grad_norm:  0.1065  memory: 76.44GiB(54.68%)  tps: 6,924  tflops: 322.91  mfu: 32.65%
[rank0]:2025-10-29 04:40:03,189 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0440_stage0_step1100.svg
[rank2]:2025-10-29 04:40:03,191 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0440_stage2_step1100.svg
[rank1]:2025-10-29 04:40:03,184 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0440_stage1_step1100.svg
[rank3]:2025-10-29 04:40:03,299 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0440_real_step1100_rank3.svg
[rank3]:> Batch Time: 611.23 ms, GPU Bubble Ratio: 40.60%, 26.07%, 36.00%, 26.39%
[rank3]:2025-10-29 04:40:03,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0440_stage3_step1100.svg
[rank3]:2025-10-29 04:40:03,749 - INFO - Avg. fwd time: 14.6821 / Avg. bwd time: 39.4482 / Avg. batch time: 448.5342 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:40:03,798 - INFO - Avg. fwd time: 13.5301 / Avg. bwd time: 31.8033 / Avg. batch time: 496.6183 (ms) / GPU bubble ratio: 26.97%
[rank0]:2025-10-29 04:40:03,842 - INFO - Avg. fwd time: 14.5033 / Avg. bwd time: 31.3351 / Avg. batch time: 601.4109 (ms) / GPU bubble ratio: 39.03%
[rank1]:2025-10-29 04:40:03,844 - INFO - Avg. fwd time: 15.7849 / Avg. bwd time: 36.8271 / Avg. batch time: 552.0537 (ms) / GPU bubble ratio: 23.76%
[rank0]:2025-10-29 04:40:28,629 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9589e+00
[rank2]:2025-10-29 04:40:28,638 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1705e+00
[rank1]:2025-10-29 04:40:28,642 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1978e+00
[rank3]:2025-10-29 04:40:28,642 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6857e+00
[rank2]:2025-10-29 04:40:51,257 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 6.5469e-01
[rank1]:2025-10-29 04:40:51,261 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9454e-01
[rank3]:2025-10-29 04:40:51,264 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4301e+00
[rank0]:2025-10-29 04:40:51,268 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8559e-01
[rank0]:2025-10-29 04:41:16,434 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.9132e-01
[rank2]:2025-10-29 04:41:16,443 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1355e-01
[rank1]:2025-10-29 04:41:16,446 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2711e+00
[rank3]:2025-10-29 04:41:16,447 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.0257e-01
[rank2]:2025-10-29 04:41:39,069 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5105e+00
[rank0]:2025-10-29 04:41:39,079 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0521e+00
[rank1]:2025-10-29 04:41:39,072 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3137e+00
[rank3]:2025-10-29 04:41:39,075 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6560e+00
[rank0]:2025-10-29 04:42:01,785 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:42:04,361 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.0808e-01
[rank3]:2025-10-29 04:42:04,364 - INFO -  step: 1150  loss:  0.1188  grad_norm:  0.1401  memory: 76.44GiB(54.68%)  tps: 6,756  tflops: 315.12  mfu: 31.86%
[rank0]:2025-10-29 04:42:04,349 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.0291e+00
[rank0]:2025-10-29 04:42:04,350 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 71.50GiB(51.14%)  tps: 6,757  tflops: 315.15  mfu: 31.87%
[rank2]:2025-10-29 04:42:04,358 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0870e-01
[rank2]:2025-10-29 04:42:04,358 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 61.15GiB(43.74%)  tps: 6,756  tflops: 315.11  mfu: 31.86%
[rank1]:2025-10-29 04:42:04,361 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7920e+00
[rank1]:2025-10-29 04:42:04,361 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1401  memory: 68.17GiB(48.76%)  tps: 6,756  tflops: 315.11  mfu: 31.86%
[rank3]:2025-10-29 04:42:04,739 - INFO - Avg. fwd time: 14.6724 / Avg. bwd time: 39.4154 / Avg. batch time: 448.1810 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-29 04:42:04,770 - INFO - Avg. fwd time: 13.5230 / Avg. bwd time: 31.7822 / Avg. batch time: 496.2472 (ms) / GPU bubble ratio: 26.96%
[rank1]:2025-10-29 04:42:04,814 - INFO - Avg. fwd time: 15.7757 / Avg. bwd time: 36.8213 / Avg. batch time: 551.6734 (ms) / GPU bubble ratio: 23.73%
[rank0]:2025-10-29 04:42:04,834 - INFO - Avg. fwd time: 14.5062 / Avg. bwd time: 31.1829 / Avg. batch time: 600.8087 (ms) / GPU bubble ratio: 39.16%
[rank0]:2025-10-29 04:42:26,832 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.4004e+00
[rank2]:2025-10-29 04:42:26,822 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0061e+00
[rank1]:2025-10-29 04:42:26,825 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4848e+00
[rank3]:2025-10-29 04:42:26,828 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.3499e-01
[rank0]:2025-10-29 04:42:52,234 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8485e+00
[rank2]:2025-10-29 04:42:52,242 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0475e+00
[rank1]:2025-10-29 04:42:52,246 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.9101e+00
[rank3]:2025-10-29 04:42:52,246 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7651e+00
[rank1]:2025-10-29 04:43:14,607 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4667e+00
[rank3]:2025-10-29 04:43:14,610 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.1931e+00
[rank2]:2025-10-29 04:43:14,604 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.4712e+00
[rank0]:2025-10-29 04:43:14,614 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5732e+00
[rank1]:2025-10-29 04:43:39,842 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3914e-01
[rank3]:2025-10-29 04:43:39,842 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.8363e-01
[rank0]:2025-10-29 04:43:39,830 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8323e-01
[rank2]:2025-10-29 04:43:39,839 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.4243e-01
[rank0]:2025-10-29 04:44:00,082 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:44:02,364 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.7751e+00
[rank1]:2025-10-29 04:44:02,364 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 68.17GiB(48.76%)  tps: 6,942  tflops: 323.79  mfu: 32.74%
[rank1]:2025-10-29 04:44:02,364 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 04:44:02,367 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8792e+00
[rank3]:2025-10-29 04:44:02,369 - INFO -  step: 1200  loss:  0.1061  grad_norm:  0.1122  memory: 76.44GiB(54.68%)  tps: 6,942  tflops: 323.78  mfu: 32.74%
[rank3]:2025-10-29 04:44:02,370 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:44:02,371 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.0730e+00
[rank0]:2025-10-29 04:44:02,371 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 71.50GiB(51.14%)  tps: 6,941  tflops: 323.73  mfu: 32.73%
[rank0]:2025-10-29 04:44:02,371 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 04:44:02,360 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2737e+00
[rank2]:2025-10-29 04:44:02,361 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1122  memory: 61.15GiB(43.74%)  tps: 6,942  tflops: 323.79  mfu: 32.74%
[rank2]:2025-10-29 04:44:02,361 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:44:17,265 - INFO - validate step: 1200  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 27,503
[rank0]:2025-10-29 04:44:17,265 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:44:17,269 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 04:44:17,308 - INFO - validate step: 1200  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,404
[rank2]:2025-10-29 04:44:17,309 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:44:17,294 - INFO - validate step: 1200  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,435
[rank1]:2025-10-29 04:44:17,295 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:44:17,323 - INFO - validate step: 1200  loss:  0.2650  memory: 76.44GiB(54.68%)  tps: 27,394
[rank3]:2025-10-29 04:44:17,324 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:44:28,195 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.89 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-10-29 04:44:32,758 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.46 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 04:44:33,590 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.27 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 04:44:35,725 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 04:44:35,730 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.46 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 04:44:35,826 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0444_stage2_step1200.svg
[rank2]:2025-10-29 04:44:35,838 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 04:44:35,814 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0444_stage1_step1200.svg
[rank1]:2025-10-29 04:44:35,824 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 04:44:35,860 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0444_stage0_step1200.svg
[rank0]:2025-10-29 04:44:35,867 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:44:35,929 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0444_real_step1200_rank3.svg
[rank3]:> Batch Time: 610.95 ms, GPU Bubble Ratio: 40.61%, 26.08%, 35.99%, 26.39%
[rank3]:2025-10-29 04:44:35,993 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0444_stage3_step1200.svg
[rank3]:2025-10-29 04:44:36,003 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:44:36,487 - INFO - Avg. fwd time: 14.6663 / Avg. bwd time: 39.3501 / Avg. batch time: 447.5976 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-29 04:44:36,532 - INFO - Avg. fwd time: 13.5208 / Avg. bwd time: 31.7168 / Avg. batch time: 495.5963 (ms) / GPU bubble ratio: 26.98%
[rank1]:2025-10-29 04:44:36,582 - INFO - Avg. fwd time: 15.7701 / Avg. bwd time: 36.7672 / Avg. batch time: 550.9554 (ms) / GPU bubble ratio: 23.71%
[rank0]:2025-10-29 04:44:36,615 - INFO - Avg. fwd time: 14.5066 / Avg. bwd time: 31.0652 / Avg. batch time: 599.9140 (ms) / GPU bubble ratio: 39.23%
[rank1]:2025-10-29 04:45:02,904 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.8735e+01
[rank3]:2025-10-29 04:45:02,904 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8877e+01
[rank2]:2025-10-29 04:45:02,901 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6041e+01
[rank0]:2025-10-29 04:45:02,892 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7097e+01
[rank3]:2025-10-29 04:45:25,999 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.0250e-01
[rank1]:2025-10-29 04:45:25,996 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.3649e-01
[rank0]:2025-10-29 04:45:25,993 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7989e-01
[rank2]:2025-10-29 04:45:25,993 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4848e-01
[rank3]:2025-10-29 04:45:52,363 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7826e+00
[rank1]:2025-10-29 04:45:52,363 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.9652e-01
[rank0]:2025-10-29 04:45:52,351 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3365e+00
[rank2]:2025-10-29 04:45:52,360 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.8821e-01
[rank2]:2025-10-29 04:46:15,601 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2930e+00
[rank0]:2025-10-29 04:46:15,602 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.4243e-01
[rank3]:2025-10-29 04:46:15,607 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3899e+00
[rank1]:2025-10-29 04:46:15,604 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6875e-01
[rank0]:2025-10-29 04:46:41,446 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank2]:2025-10-29 04:46:44,120 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0758e-01
[rank2]:2025-10-29 04:46:44,120 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 61.15GiB(43.74%)  tps: 5,580  tflops: 260.25  mfu: 26.31%
[rank0]:2025-10-29 04:46:44,111 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.0054e-01
[rank0]:2025-10-29 04:46:44,112 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 72.50GiB(51.86%)  tps: 5,579  tflops: 260.19  mfu: 26.31%
[rank3]:2025-10-29 04:46:44,123 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.1584e-01
[rank3]:2025-10-29 04:46:44,126 - INFO -  step: 1250  loss:  0.8297  grad_norm:  0.3950  memory: 76.44GiB(54.68%)  tps: 5,580  tflops: 260.27  mfu: 26.32%
[rank1]:2025-10-29 04:46:44,123 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5782e-01
[rank1]:2025-10-29 04:46:44,123 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.3950  memory: 68.17GiB(48.76%)  tps: 5,579  tflops: 260.22  mfu: 26.31%
[rank3]:2025-10-29 04:46:44,526 - INFO - Avg. fwd time: 14.6873 / Avg. bwd time: 39.3729 / Avg. batch time: 447.9449 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:46:44,604 - INFO - Avg. fwd time: 15.7844 / Avg. bwd time: 36.7886 / Avg. batch time: 551.3822 (ms) / GPU bubble ratio: 23.72%
[rank2]:2025-10-29 04:46:44,559 - INFO - Avg. fwd time: 13.5339 / Avg. bwd time: 31.7347 / Avg. batch time: 495.9979 (ms) / GPU bubble ratio: 26.99%
[rank0]:2025-10-29 04:46:44,608 - INFO - Avg. fwd time: 14.5438 / Avg. bwd time: 30.8329 / Avg. batch time: 600.0696 (ms) / GPU bubble ratio: 39.50%
[rank3]:2025-10-29 04:47:07,310 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4857e+00
[rank1]:2025-10-29 04:47:07,307 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.0484e-01
[rank0]:2025-10-29 04:47:07,305 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.9364e-01
[rank2]:2025-10-29 04:47:07,304 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.6702e-01
[rank1]:2025-10-29 04:47:33,760 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1786e-01
[rank0]:2025-10-29 04:47:33,748 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.9591e-01
[rank2]:2025-10-29 04:47:33,757 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6371e-01
[rank3]:2025-10-29 04:47:33,760 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9367e-01
[rank0]:2025-10-29 04:47:56,897 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4176e+00
[rank2]:2025-10-29 04:47:56,896 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1653e+00
[rank3]:2025-10-29 04:47:56,903 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1341e+00
[rank1]:2025-10-29 04:47:56,899 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.8880e-01
[rank0]:2025-10-29 04:48:23,335 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.8777e-01
[rank3]:2025-10-29 04:48:23,346 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.2372e-01
[rank1]:2025-10-29 04:48:23,346 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3500e-01
[rank2]:2025-10-29 04:48:23,343 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8127e-01
[rank0]:2025-10-29 04:48:44,223 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:48:46,555 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.5401e+00
[rank0]:2025-10-29 04:48:46,556 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 72.50GiB(51.86%)  tps: 6,690  tflops: 312.04  mfu: 31.55%
[rank2]:2025-10-29 04:48:46,555 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.7593e-01
[rank2]:2025-10-29 04:48:46,555 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 61.15GiB(43.74%)  tps: 6,691  tflops: 312.07  mfu: 31.55%
[rank3]:2025-10-29 04:48:46,561 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3058e+00
[rank3]:2025-10-29 04:48:46,564 - INFO -  step: 1300  loss:  0.7279  grad_norm:  0.3157  memory: 76.44GiB(54.68%)  tps: 6,691  tflops: 312.06  mfu: 31.55%
[rank1]:2025-10-29 04:48:46,558 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.9750e-01
[rank1]:2025-10-29 04:48:46,558 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3157  memory: 68.17GiB(48.76%)  tps: 6,691  tflops: 312.07  mfu: 31.55%
[rank1]:2025-10-29 04:48:46,638 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0448_stage1_step1300.svg
[rank0]:2025-10-29 04:48:46,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0448_stage0_step1300.svg
[rank2]:2025-10-29 04:48:46,643 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0448_stage2_step1300.svg
[rank3]:2025-10-29 04:48:46,748 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0448_real_step1300_rank3.svg
[rank3]:> Batch Time: 610.99 ms, GPU Bubble Ratio: 40.64%, 26.06%, 35.99%, 26.37%
[rank3]:2025-10-29 04:48:46,811 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0448_stage3_step1300.svg
[rank3]:2025-10-29 04:48:47,227 - INFO - Avg. fwd time: 14.7124 / Avg. bwd time: 39.3652 / Avg. batch time: 448.0799 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:48:47,325 - INFO - Avg. fwd time: 15.8067 / Avg. bwd time: 36.7798 / Avg. batch time: 551.4907 (ms) / GPU bubble ratio: 23.72%
[rank0]:2025-10-29 04:48:47,321 - INFO - Avg. fwd time: 14.5861 / Avg. bwd time: 30.5749 / Avg. batch time: 599.8786 (ms) / GPU bubble ratio: 39.77%
[rank2]:2025-10-29 04:48:47,278 - INFO - Avg. fwd time: 13.5527 / Avg. bwd time: 31.7138 / Avg. batch time: 496.1091 (ms) / GPU bubble ratio: 27.01%
[rank3]:2025-10-29 04:49:13,106 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.9307e-01
[rank1]:2025-10-29 04:49:13,106 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9941e-01
[rank2]:2025-10-29 04:49:13,103 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3011e-01
[rank0]:2025-10-29 04:49:13,094 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.4556e-01
[rank3]:2025-10-29 04:49:36,305 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2850e+00
[rank1]:2025-10-29 04:49:36,302 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1152e+00
[rank2]:2025-10-29 04:49:36,299 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6877e+00
[rank0]:2025-10-29 04:49:36,299 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8084e+00
[rank3]:2025-10-29 04:50:02,669 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.7733e-01
[rank1]:2025-10-29 04:50:02,669 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1730e-01
[rank2]:2025-10-29 04:50:02,666 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2706e-01
[rank0]:2025-10-29 04:50:02,657 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.6071e-01
[rank1]:2025-10-29 04:50:25,819 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2806e+00
[rank0]:2025-10-29 04:50:25,817 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0854e+00
[rank2]:2025-10-29 04:50:25,816 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6516e+00
[rank3]:2025-10-29 04:50:25,823 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1595e+00
[rank0]:2025-10-29 04:50:49,581 - INFO - [GC] Peforming periodical GC collection 0.06 seconds
[rank1]:2025-10-29 04:50:52,249 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6454e+00
[rank1]:2025-10-29 04:50:52,250 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 68.17GiB(48.76%)  tps: 6,518  tflops: 303.98  mfu: 30.74%
[rank0]:2025-10-29 04:50:52,237 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3150e+00
[rank0]:2025-10-29 04:50:52,238 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 72.50GiB(51.86%)  tps: 6,518  tflops: 304.00  mfu: 30.74%
[rank2]:2025-10-29 04:50:52,246 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.4774e-01
[rank2]:2025-10-29 04:50:52,247 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4068  memory: 61.15GiB(43.74%)  tps: 6,518  tflops: 303.98  mfu: 30.74%
[rank3]:2025-10-29 04:50:52,249 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.9937e+00
[rank3]:2025-10-29 04:50:52,252 - INFO -  step: 1350  loss:  0.7557  grad_norm:  0.4068  memory: 76.44GiB(54.68%)  tps: 6,518  tflops: 303.99  mfu: 30.74%
[rank3]:2025-10-29 04:50:52,737 - INFO - Avg. fwd time: 14.7316 / Avg. bwd time: 39.3879 / Avg. batch time: 448.4109 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:50:52,811 - INFO - Avg. fwd time: 15.8221 / Avg. bwd time: 36.8139 / Avg. batch time: 551.9060 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:50:52,843 - INFO - Avg. fwd time: 14.6221 / Avg. bwd time: 30.3454 / Avg. batch time: 600.0242 (ms) / GPU bubble ratio: 40.05%
[rank2]:2025-10-29 04:50:52,772 - INFO - Avg. fwd time: 13.5658 / Avg. bwd time: 31.7341 / Avg. batch time: 496.4819 (ms) / GPU bubble ratio: 27.01%
[rank1]:2025-10-29 04:51:15,361 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0310e-01
[rank0]:2025-10-29 04:51:15,359 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.3822e-01
[rank2]:2025-10-29 04:51:15,358 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.2973e-01
[rank3]:2025-10-29 04:51:15,365 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.5782e-01
[rank1]:2025-10-29 04:51:41,785 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.6019e-01
[rank0]:2025-10-29 04:51:41,773 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.8096e-01
[rank2]:2025-10-29 04:51:41,782 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4651e-01
[rank3]:2025-10-29 04:51:41,785 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9780e-01
[rank3]:2025-10-29 04:52:04,941 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2865e-01
[rank1]:2025-10-29 04:52:04,937 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.6549e-01
[rank0]:2025-10-29 04:52:04,935 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1856e+00
[rank2]:2025-10-29 04:52:04,934 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9297e-01
[rank3]:2025-10-29 04:52:31,280 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5255e+00
[rank1]:2025-10-29 04:52:31,280 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7801e+00
[rank0]:2025-10-29 04:52:31,268 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4211e+00
[rank2]:2025-10-29 04:52:31,276 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.5870e-01
[rank0]:2025-10-29 04:52:52,191 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:52:54,527 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3200e+00
[rank1]:2025-10-29 04:52:54,528 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 68.17GiB(48.76%)  tps: 6,699  tflops: 312.47  mfu: 31.59%
[rank1]:2025-10-29 04:52:54,528 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 04:52:54,524 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8759e+00
[rank2]:2025-10-29 04:52:54,525 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 61.15GiB(43.74%)  tps: 6,699  tflops: 312.47  mfu: 31.59%
[rank0]:2025-10-29 04:52:54,525 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7256e+00
[rank0]:2025-10-29 04:52:54,525 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3576  memory: 72.50GiB(51.86%)  tps: 6,699  tflops: 312.44  mfu: 31.59%
[rank2]:2025-10-29 04:52:54,525 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:52:54,525 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 04:52:54,531 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7737e+00
[rank3]:2025-10-29 04:52:54,534 - INFO -  step: 1400  loss:  0.7800  grad_norm:  0.3576  memory: 76.44GiB(54.68%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank3]:2025-10-29 04:52:54,534 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:53:09,541 - INFO - validate step: 1400  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,279
[rank3]:2025-10-29 04:53:09,602 - INFO - validate step: 1400  loss:  0.2592  memory: 76.44GiB(54.68%)  tps: 27,186
[rank1]:2025-10-29 04:53:09,574 - INFO - validate step: 1400  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,224
[rank2]:2025-10-29 04:53:09,586 - INFO - validate step: 1400  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,196
[rank1]:2025-10-29 04:53:09,683 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0453_stage1_step1400.svg
[rank0]:2025-10-29 04:53:09,690 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0453_stage0_step1400.svg
[rank2]:2025-10-29 04:53:09,688 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0453_stage2_step1400.svg
[rank3]:2025-10-29 04:53:09,789 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0453_real_step1400_rank3.svg
[rank3]:> Batch Time: 611.20 ms, GPU Bubble Ratio: 41.07%, 26.05%, 35.98%, 26.35%
[rank3]:2025-10-29 04:53:09,855 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0453_stage3_step1400.svg
[rank3]:2025-10-29 04:53:10,271 - INFO - Avg. fwd time: 14.7502 / Avg. bwd time: 39.3744 / Avg. batch time: 448.4488 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 04:53:10,369 - INFO - Avg. fwd time: 15.8390 / Avg. bwd time: 36.7962 / Avg. batch time: 551.8983 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:53:10,364 - INFO - Avg. fwd time: 14.6504 / Avg. bwd time: 30.1509 / Avg. batch time: 599.7879 (ms) / GPU bubble ratio: 40.24%
[rank2]:2025-10-29 04:53:10,321 - INFO - Avg. fwd time: 13.5803 / Avg. bwd time: 31.7081 / Avg. batch time: 496.4901 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 04:53:36,180 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.3639e-01
[rank0]:2025-10-29 04:53:36,168 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8272e-01
[rank2]:2025-10-29 04:53:36,176 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7091e-01
[rank3]:2025-10-29 04:53:36,180 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.5220e-01
[rank3]:2025-10-29 04:53:59,366 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7005e+00
[rank2]:2025-10-29 04:53:59,359 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.9316e-01
[rank0]:2025-10-29 04:53:59,360 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0195e+00
[rank1]:2025-10-29 04:53:59,362 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.9562e-01
[rank1]:2025-10-29 04:54:25,823 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4921e-01
[rank2]:2025-10-29 04:54:25,820 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7042e-01
[rank0]:2025-10-29 04:54:25,811 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0140e+00
[rank3]:2025-10-29 04:54:25,823 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.1980e-01
[rank0]:2025-10-29 04:54:48,953 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.1105e-01
[rank2]:2025-10-29 04:54:48,952 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.1295e-01
[rank1]:2025-10-29 04:54:48,956 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6290e-01
[rank3]:2025-10-29 04:54:48,959 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.5161e-01
[rank0]:2025-10-29 04:55:12,745 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 04:55:15,408 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8196e-01
[rank3]:2025-10-29 04:55:15,411 - INFO -  step: 1450  loss:  0.8181  grad_norm:  0.4138  memory: 76.44GiB(54.68%)  tps: 6,512  tflops: 303.70  mfu: 30.71%
[rank2]:2025-10-29 04:55:15,405 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2815e-01
[rank2]:2025-10-29 04:55:15,405 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 61.15GiB(43.74%)  tps: 6,511  tflops: 303.67  mfu: 30.71%
[rank0]:2025-10-29 04:55:15,396 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9940e-01
[rank0]:2025-10-29 04:55:15,396 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 72.50GiB(51.86%)  tps: 6,509  tflops: 303.58  mfu: 30.70%
[rank1]:2025-10-29 04:55:15,408 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.8176e-01
[rank1]:2025-10-29 04:55:15,408 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4138  memory: 68.17GiB(48.76%)  tps: 6,510  tflops: 303.64  mfu: 30.70%
[rank3]:2025-10-29 04:55:15,806 - INFO - Avg. fwd time: 14.7689 / Avg. bwd time: 39.3836 / Avg. batch time: 448.6693 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:55:15,838 - INFO - Avg. fwd time: 13.5938 / Avg. bwd time: 31.7113 / Avg. batch time: 496.7317 (ms) / GPU bubble ratio: 27.03%
[rank0]:2025-10-29 04:55:15,888 - INFO - Avg. fwd time: 14.6827 / Avg. bwd time: 29.9478 / Avg. batch time: 599.8093 (ms) / GPU bubble ratio: 40.47%
[rank1]:2025-10-29 04:55:15,883 - INFO - Avg. fwd time: 15.8542 / Avg. bwd time: 36.8092 / Avg. batch time: 552.1559 (ms) / GPU bubble ratio: 23.70%
[rank3]:2025-10-29 04:55:38,563 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 7.3059e-01
[rank2]:2025-10-29 04:55:38,557 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3360e-01
[rank0]:2025-10-29 04:55:38,557 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.6698e-01
[rank1]:2025-10-29 04:55:38,560 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.8720e-01
[rank2]:2025-10-29 04:56:04,910 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0554e-01
[rank0]:2025-10-29 04:56:04,901 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.1374e-01
[rank1]:2025-10-29 04:56:04,913 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0954e-01
[rank3]:2025-10-29 04:56:04,913 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6239e-01
[rank2]:2025-10-29 04:56:28,118 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.0710e-01
[rank1]:2025-10-29 04:56:28,121 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2917e-01
[rank0]:2025-10-29 04:56:28,119 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.8112e-01
[rank3]:2025-10-29 04:56:28,125 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2975e-01
[rank3]:2025-10-29 04:56:54,434 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.3837e-01
[rank2]:2025-10-29 04:56:54,431 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0230e-01
[rank1]:2025-10-29 04:56:54,434 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.8204e-01
[rank0]:2025-10-29 04:56:54,422 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.0936e-01
[rank0]:2025-10-29 04:57:15,255 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:57:17,564 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.8238e-01
[rank2]:2025-10-29 04:57:17,564 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 61.15GiB(43.74%)  tps: 6,706  tflops: 312.77  mfu: 31.62%
[rank1]:2025-10-29 04:57:17,567 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.0232e-01
[rank1]:2025-10-29 04:57:17,567 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 68.17GiB(48.76%)  tps: 6,706  tflops: 312.77  mfu: 31.62%
[rank0]:2025-10-29 04:57:17,565 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.3729e-01
[rank0]:2025-10-29 04:57:17,565 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2970  memory: 72.50GiB(51.86%)  tps: 6,705  tflops: 312.75  mfu: 31.62%
[rank3]:2025-10-29 04:57:17,570 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6230e+00
[rank3]:2025-10-29 04:57:17,573 - INFO -  step: 1500  loss:  0.7121  grad_norm:  0.2970  memory: 76.44GiB(54.68%)  tps: 6,706  tflops: 312.76  mfu: 31.62%
[rank2]:2025-10-29 04:57:17,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0457_stage2_step1500.svg
[rank1]:2025-10-29 04:57:17,653 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0457_stage1_step1500.svg
[rank0]:2025-10-29 04:57:17,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0457_stage0_step1500.svg
[rank3]:2025-10-29 04:57:17,754 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0457_real_step1500_rank3.svg
[rank3]:> Batch Time: 611.34 ms, GPU Bubble Ratio: 41.44%, 26.04%, 35.97%, 26.33%
[rank3]:2025-10-29 04:57:17,818 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0457_stage3_step1500.svg
[rank3]:2025-10-29 04:57:18,322 - INFO - Avg. fwd time: 14.7886 / Avg. bwd time: 39.3649 / Avg. batch time: 448.6739 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:57:18,368 - INFO - Avg. fwd time: 13.6096 / Avg. bwd time: 31.6780 / Avg. batch time: 496.7192 (ms) / GPU bubble ratio: 27.06%
[rank1]:2025-10-29 04:57:18,418 - INFO - Avg. fwd time: 15.8717 / Avg. bwd time: 36.7842 / Avg. batch time: 552.1223 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 04:57:18,452 - INFO - Avg. fwd time: 14.7124 / Avg. bwd time: 29.7496 / Avg. batch time: 599.5433 (ms) / GPU bubble ratio: 40.67%
[rank2]:2025-10-29 04:57:44,204 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.5424e-01
[rank1]:2025-10-29 04:57:44,207 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2176e+00
[rank0]:2025-10-29 04:57:44,196 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4687e+00
[rank3]:2025-10-29 04:57:44,208 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2996e+00
[rank3]:2025-10-29 04:58:07,297 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6842e+00
[rank2]:2025-10-29 04:58:07,291 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6607e+00
[rank1]:2025-10-29 04:58:07,294 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3571e+00
[rank0]:2025-10-29 04:58:07,291 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9609e+00
[rank3]:2025-10-29 04:58:33,698 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.1982e-02
[rank2]:2025-10-29 04:58:33,695 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.3551e-02
[rank1]:2025-10-29 04:58:33,698 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6333e-01
[rank0]:2025-10-29 04:58:33,686 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3495e-01
[rank3]:2025-10-29 04:58:56,824 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.2985e+00
[rank2]:2025-10-29 04:58:56,817 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1381e+00
[rank1]:2025-10-29 04:58:56,820 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.6205e-01
[rank0]:2025-10-29 04:58:56,818 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1175e+00
[rank0]:2025-10-29 04:59:20,492 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:59:23,155 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.9971e-01
[rank3]:2025-10-29 04:59:23,157 - INFO -  step: 1550  loss:  0.7551  grad_norm:  0.4402  memory: 76.44GiB(54.68%)  tps: 6,523  tflops: 304.24  mfu: 30.76%
[rank2]:2025-10-29 04:59:23,152 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0984e-01
[rank2]:2025-10-29 04:59:23,152 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 61.15GiB(43.74%)  tps: 6,523  tflops: 304.23  mfu: 30.76%
[rank1]:2025-10-29 04:59:23,155 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6108e-01
[rank1]:2025-10-29 04:59:23,155 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 68.17GiB(48.76%)  tps: 6,523  tflops: 304.23  mfu: 30.76%
[rank0]:2025-10-29 04:59:23,143 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5697e+00
[rank0]:2025-10-29 04:59:23,143 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4402  memory: 72.50GiB(51.86%)  tps: 6,523  tflops: 304.25  mfu: 30.76%
[rank3]:2025-10-29 04:59:23,554 - INFO - Avg. fwd time: 14.8018 / Avg. bwd time: 39.3789 / Avg. batch time: 448.8894 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 04:59:23,587 - INFO - Avg. fwd time: 13.6189 / Avg. bwd time: 31.6895 / Avg. batch time: 496.9443 (ms) / GPU bubble ratio: 27.06%
[rank1]:2025-10-29 04:59:23,632 - INFO - Avg. fwd time: 15.8826 / Avg. bwd time: 36.8043 / Avg. batch time: 552.3738 (ms) / GPU bubble ratio: 23.69%
[rank0]:2025-10-29 04:59:23,636 - INFO - Avg. fwd time: 14.7360 / Avg. bwd time: 29.6000 / Avg. batch time: 599.6170 (ms) / GPU bubble ratio: 40.85%
[rank3]:2025-10-29 04:59:46,361 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5656e+00
[rank2]:2025-10-29 04:59:46,355 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.1808e+00
[rank1]:2025-10-29 04:59:46,358 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.7637e-01
[rank0]:2025-10-29 04:59:46,356 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8134e+00
[rank3]:2025-10-29 05:00:12,697 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.6693e-01
[rank2]:2025-10-29 05:00:12,693 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0890e-01
[rank1]:2025-10-29 05:00:12,696 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6039e-01
[rank0]:2025-10-29 05:00:12,684 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0473e-01
[rank3]:2025-10-29 05:00:35,834 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 9.6658e-01
[rank2]:2025-10-29 05:00:35,828 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.3804e-01
[rank0]:2025-10-29 05:00:35,829 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.2585e-01
[rank1]:2025-10-29 05:00:35,831 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.4513e-01
[rank3]:2025-10-29 05:01:02,055 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.1829e+00
[rank2]:2025-10-29 05:01:02,052 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0582e+00
[rank0]:2025-10-29 05:01:02,043 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.4141e+00
[rank1]:2025-10-29 05:01:02,055 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1371e+00
[rank0]:2025-10-29 05:01:21,952 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:01:24,208 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6709e+00
[rank3]:2025-10-29 05:01:24,211 - INFO -  step: 1600  loss:  0.1174  grad_norm:  0.2399  memory: 76.44GiB(54.68%)  tps: 6,767  tflops: 315.63  mfu: 31.91%
[rank3]:2025-10-29 05:01:24,211 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:01:24,202 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1289e+00
[rank0]:2025-10-29 05:01:24,202 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 72.50GiB(51.86%)  tps: 6,767  tflops: 315.61  mfu: 31.91%
[rank2]:2025-10-29 05:01:24,201 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9576e+00
[rank2]:2025-10-29 05:01:24,201 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 61.15GiB(43.74%)  tps: 6,768  tflops: 315.64  mfu: 31.91%
[rank0]:2025-10-29 05:01:24,202 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 05:01:24,201 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:01:24,204 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.1439e-01
[rank1]:2025-10-29 05:01:24,205 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2399  memory: 68.17GiB(48.76%)  tps: 6,767  tflops: 315.64  mfu: 31.91%
[rank1]:2025-10-29 05:01:24,205 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 05:01:39,194 - INFO - validate step: 1600  loss:  0.2597  memory: 76.44GiB(54.68%)  tps: 27,338
[rank0]:2025-10-29 05:01:39,139 - INFO - validate step: 1600  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,423
[rank2]:2025-10-29 05:01:39,181 - INFO - validate step: 1600  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,344
[rank1]:2025-10-29 05:01:39,168 - INFO - validate step: 1600  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,375
[rank0]:2025-10-29 05:01:39,286 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0501_stage0_step1600.svg
[rank2]:2025-10-29 05:01:39,285 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0501_stage2_step1600.svg
[rank1]:2025-10-29 05:01:39,278 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0501_stage1_step1600.svg
[rank3]:2025-10-29 05:01:39,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0501_real_step1600_rank3.svg
[rank3]:> Batch Time: 611.10 ms, GPU Bubble Ratio: 41.67%, 25.99%, 35.96%, 26.29%
[rank3]:2025-10-29 05:01:39,450 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0501_stage3_step1600.svg
[rank3]:2025-10-29 05:01:39,846 - INFO - Avg. fwd time: 14.8141 / Avg. bwd time: 39.3673 / Avg. batch time: 448.8913 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:01:39,894 - INFO - Avg. fwd time: 13.6280 / Avg. bwd time: 31.6708 / Avg. batch time: 496.9203 (ms) / GPU bubble ratio: 27.07%
[rank0]:2025-10-29 05:01:39,938 - INFO - Avg. fwd time: 14.7581 / Avg. bwd time: 29.4275 / Avg. batch time: 599.3783 (ms) / GPU bubble ratio: 41.02%
[rank1]:2025-10-29 05:01:39,942 - INFO - Avg. fwd time: 15.8937 / Avg. bwd time: 36.7937 / Avg. batch time: 552.3413 (ms) / GPU bubble ratio: 23.69%
[rank0]:2025-10-29 05:02:04,521 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1231e+00
[rank2]:2025-10-29 05:02:04,530 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.0402e-01
[rank1]:2025-10-29 05:02:04,533 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5411e+00
[rank3]:2025-10-29 05:02:04,533 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8047e+00
[rank3]:2025-10-29 05:02:26,690 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7415e+00
[rank1]:2025-10-29 05:02:26,687 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.5575e+00
[rank2]:2025-10-29 05:02:26,684 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5096e+00
[rank0]:2025-10-29 05:02:26,684 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.6016e+00
[rank3]:2025-10-29 05:02:51,927 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.1043e-01
[rank1]:2025-10-29 05:02:51,927 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0939e-01
[rank0]:2025-10-29 05:02:51,915 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6242e-01
[rank2]:2025-10-29 05:02:51,924 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0127e-01
[rank3]:2025-10-29 05:03:13,935 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.6099e+00
[rank1]:2025-10-29 05:03:13,931 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8956e+00
[rank0]:2025-10-29 05:03:13,929 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.2488e+00
[rank2]:2025-10-29 05:03:13,928 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7830e+00
[rank0]:2025-10-29 05:03:36,822 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:03:39,363 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.6564e+00
[rank3]:2025-10-29 05:03:39,366 - INFO -  step: 1650  loss:  0.0930  grad_norm:  0.1580  memory: 76.44GiB(54.68%)  tps: 6,817  tflops: 317.95  mfu: 32.15%
[rank1]:2025-10-29 05:03:39,363 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.4762e-01
[rank1]:2025-10-29 05:03:39,363 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 68.17GiB(48.76%)  tps: 6,816  tflops: 317.88  mfu: 32.14%
[rank2]:2025-10-29 05:03:39,360 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9389e-01
[rank2]:2025-10-29 05:03:39,360 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 61.15GiB(43.74%)  tps: 6,817  tflops: 317.92  mfu: 32.15%
[rank0]:2025-10-29 05:03:39,351 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6715e+00
[rank0]:2025-10-29 05:03:39,351 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1580  memory: 72.50GiB(51.86%)  tps: 6,815  tflops: 317.84  mfu: 32.14%
[rank3]:2025-10-29 05:03:39,818 - INFO - Avg. fwd time: 14.8024 / Avg. bwd time: 39.3562 / Avg. batch time: 448.7015 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:03:39,894 - INFO - Avg. fwd time: 15.8820 / Avg. bwd time: 36.8027 / Avg. batch time: 552.1601 (ms) / GPU bubble ratio: 23.67%
[rank2]:2025-10-29 05:03:39,854 - INFO - Avg. fwd time: 13.6183 / Avg. bwd time: 31.6733 / Avg. batch time: 496.7342 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:03:39,928 - INFO - Avg. fwd time: 14.7608 / Avg. bwd time: 29.2663 / Avg. batch time: 598.9952 (ms) / GPU bubble ratio: 41.20%
[rank3]:2025-10-29 05:04:01,313 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7581e+00
[rank1]:2025-10-29 05:04:01,310 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6905e+00
[rank2]:2025-10-29 05:04:01,306 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.2382e+00
[rank0]:2025-10-29 05:04:01,307 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.7390e+00
[rank3]:2025-10-29 05:04:26,620 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8298e-01
[rank1]:2025-10-29 05:04:26,620 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3337e+00
[rank2]:2025-10-29 05:04:26,617 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.1607e-01
[rank0]:2025-10-29 05:04:26,608 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6808e+00
[rank3]:2025-10-29 05:04:48,728 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.8536e+00
[rank1]:2025-10-29 05:04:48,724 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.6981e+00
[rank0]:2025-10-29 05:04:48,722 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.4101e+00
[rank2]:2025-10-29 05:04:48,721 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.4771e+00
[rank2]:2025-10-29 05:05:13,895 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.7731e-01
[rank0]:2025-10-29 05:05:13,886 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.9576e-01
[rank3]:2025-10-29 05:05:13,898 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.6213e+00
[rank1]:2025-10-29 05:05:13,898 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.7909e-01
[rank0]:2025-10-29 05:05:33,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:05:36,054 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.9743e-01
[rank3]:2025-10-29 05:05:36,057 - INFO -  step: 1700  loss:  0.0976  grad_norm:  0.1111  memory: 76.44GiB(54.68%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank1]:2025-10-29 05:05:36,051 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.2503e-01
[rank1]:2025-10-29 05:05:36,051 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 68.17GiB(48.76%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank2]:2025-10-29 05:05:36,048 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.8981e-01
[rank2]:2025-10-29 05:05:36,048 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 61.15GiB(43.74%)  tps: 7,020  tflops: 327.43  mfu: 33.11%
[rank0]:2025-10-29 05:05:36,048 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1474e+00
[rank0]:2025-10-29 05:05:36,049 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1111  memory: 72.50GiB(51.86%)  tps: 7,020  tflops: 327.41  mfu: 33.10%
[rank1]:2025-10-29 05:05:36,134 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0505_stage1_step1700.svg
[rank2]:2025-10-29 05:05:36,144 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0505_stage2_step1700.svg
[rank0]:2025-10-29 05:05:36,147 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0505_stage0_step1700.svg
[rank3]:2025-10-29 05:05:36,245 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0505_real_step1700_rank3.svg
[rank3]:> Batch Time: 606.20 ms, GPU Bubble Ratio: 46.41%, 25.43%, 35.46%, 25.75%
[rank3]:2025-10-29 05:05:36,311 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0505_stage3_step1700.svg
[rank3]:2025-10-29 05:05:36,697 - INFO - Avg. fwd time: 14.7947 / Avg. bwd time: 39.3210 / Avg. batch time: 448.3522 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:05:36,791 - INFO - Avg. fwd time: 15.8754 / Avg. bwd time: 36.7746 / Avg. batch time: 551.7278 (ms) / GPU bubble ratio: 23.66%
[rank2]:2025-10-29 05:05:36,745 - INFO - Avg. fwd time: 13.6136 / Avg. bwd time: 31.6413 / Avg. batch time: 496.3365 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:05:36,789 - INFO - Avg. fwd time: 14.7630 / Avg. bwd time: 29.1273 / Avg. batch time: 598.3879 (ms) / GPU bubble ratio: 41.32%
[rank3]:2025-10-29 05:06:01,516 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.5261e+00
[rank1]:2025-10-29 05:06:01,517 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.9948e+00
[rank0]:2025-10-29 05:06:01,504 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4454e+00
[rank2]:2025-10-29 05:06:01,513 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3792e+00
[rank3]:2025-10-29 05:06:23,544 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 6.8973e-01
[rank1]:2025-10-29 05:06:23,541 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4490e+00
[rank0]:2025-10-29 05:06:23,538 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8951e+00
[rank2]:2025-10-29 05:06:23,537 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0582e+00
[rank3]:2025-10-29 05:06:48,959 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 7.9667e-01
[rank1]:2025-10-29 05:06:48,959 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6268e-01
[rank2]:2025-10-29 05:06:48,955 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9654e-01
[rank0]:2025-10-29 05:06:48,947 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5079e-01
[rank3]:2025-10-29 05:07:10,880 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.8915e+00
[rank1]:2025-10-29 05:07:10,877 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.9096e+00
[rank0]:2025-10-29 05:07:10,875 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.7272e+00
[rank2]:2025-10-29 05:07:10,874 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.1087e+00
[rank0]:2025-10-29 05:07:33,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:07:36,169 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7409e+00
[rank3]:2025-10-29 05:07:36,174 - INFO -  step: 1750  loss:  0.1049  grad_norm:  0.1153  memory: 76.44GiB(54.68%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank1]:2025-10-29 05:07:36,169 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1058e+00
[rank1]:2025-10-29 05:07:36,169 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 68.17GiB(48.76%)  tps: 6,820  tflops: 318.08  mfu: 32.16%
[rank2]:2025-10-29 05:07:36,166 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.1102e-01
[rank2]:2025-10-29 05:07:36,166 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 61.15GiB(43.74%)  tps: 6,820  tflops: 318.08  mfu: 32.16%
[rank0]:2025-10-29 05:07:36,157 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1518e+00
[rank0]:2025-10-29 05:07:36,158 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1153  memory: 72.50GiB(51.86%)  tps: 6,820  tflops: 318.11  mfu: 32.16%
[rank3]:2025-10-29 05:07:36,538 - INFO - Avg. fwd time: 14.7851 / Avg. bwd time: 39.3025 / Avg. batch time: 448.1205 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:07:36,615 - INFO - Avg. fwd time: 15.8665 / Avg. bwd time: 36.7711 / Avg. batch time: 551.4777 (ms) / GPU bubble ratio: 23.64%
[rank2]:2025-10-29 05:07:36,569 - INFO - Avg. fwd time: 13.6060 / Avg. bwd time: 31.6320 / Avg. batch time: 496.0954 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 05:07:36,620 - INFO - Avg. fwd time: 14.7649 / Avg. bwd time: 28.9812 / Avg. batch time: 597.9512 (ms) / GPU bubble ratio: 41.47%
[rank3]:2025-10-29 05:07:58,284 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.5755e+00
[rank1]:2025-10-29 05:07:58,280 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 9.0399e-01
[rank2]:2025-10-29 05:07:58,277 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9533e+00
[rank0]:2025-10-29 05:07:58,278 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.5582e-01
[rank3]:2025-10-29 05:08:23,443 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.6274e-01
[rank1]:2025-10-29 05:08:23,442 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.8784e-01
[rank2]:2025-10-29 05:08:23,439 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.8146e-01
[rank0]:2025-10-29 05:08:23,430 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3909e-01
[rank3]:2025-10-29 05:08:45,576 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9401e+00
[rank1]:2025-10-29 05:08:45,572 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.0908e+00
[rank0]:2025-10-29 05:08:45,570 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4284e+00
[rank2]:2025-10-29 05:08:45,569 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2826e+00
[rank3]:2025-10-29 05:09:10,787 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.1211e+00
[rank0]:2025-10-29 05:09:10,775 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2158e+00
[rank2]:2025-10-29 05:09:10,784 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.0385e-01
[rank1]:2025-10-29 05:09:10,787 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9838e+00
[rank0]:2025-10-29 05:09:30,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:09:32,764 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.0766e+00
[rank3]:2025-10-29 05:09:32,767 - INFO -  step: 1800  loss:  0.0838  grad_norm:  0.0804  memory: 76.44GiB(54.68%)  tps: 7,026  tflops: 327.70  mfu: 33.13%
[rank3]:2025-10-29 05:09:32,767 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 05:09:32,760 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2194e+00
[rank1]:2025-10-29 05:09:32,761 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 68.17GiB(48.76%)  tps: 7,026  tflops: 327.71  mfu: 33.14%
[rank0]:2025-10-29 05:09:32,758 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0081e+00
[rank0]:2025-10-29 05:09:32,759 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 72.50GiB(51.86%)  tps: 7,026  tflops: 327.68  mfu: 33.13%
[rank1]:2025-10-29 05:09:32,761 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:09:32,757 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.4140e-01
[rank0]:2025-10-29 05:09:32,759 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:09:32,758 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0804  memory: 61.15GiB(43.74%)  tps: 7,026  tflops: 327.71  mfu: 33.14%
[rank2]:2025-10-29 05:09:32,758 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:09:47,781 - INFO - validate step: 1800  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 27,267
[rank1]:2025-10-29 05:09:47,811 - INFO - validate step: 1800  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 27,215
[rank2]:2025-10-29 05:09:47,825 - INFO - validate step: 1800  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 27,185
[rank3]:2025-10-29 05:09:47,840 - INFO - validate step: 1800  loss:  0.2578  memory: 76.44GiB(54.68%)  tps: 27,176
[rank0]:2025-10-29 05:09:47,931 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0509_stage0_step1800.svg
[rank1]:2025-10-29 05:09:47,920 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0509_stage1_step1800.svg
[rank2]:2025-10-29 05:09:47,929 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0509_stage2_step1800.svg
[rank3]:2025-10-29 05:09:48,028 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0509_real_step1800_rank3.svg
[rank3]:> Batch Time: 605.88 ms, GPU Bubble Ratio: 46.46%, 25.41%, 35.43%, 25.75%
[rank3]:2025-10-29 05:09:48,093 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0509_stage3_step1800.svg
[rank3]:2025-10-29 05:09:48,569 - INFO - Avg. fwd time: 14.7770 / Avg. bwd time: 39.2617 / Avg. batch time: 447.7225 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:09:48,615 - INFO - Avg. fwd time: 13.6010 / Avg. bwd time: 31.5928 / Avg. batch time: 495.6565 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-10-29 05:09:48,702 - INFO - Avg. fwd time: 14.7667 / Avg. bwd time: 28.8357 / Avg. batch time: 597.2862 (ms) / GPU bubble ratio: 41.60%
[rank1]:2025-10-29 05:09:48,667 - INFO - Avg. fwd time: 15.8593 / Avg. bwd time: 36.7360 / Avg. batch time: 550.9962 (ms) / GPU bubble ratio: 23.64%
[rank3]:2025-10-29 05:10:13,493 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0643e+00
[rank2]:2025-10-29 05:10:13,489 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.5275e-01
[rank1]:2025-10-29 05:10:13,493 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5273e+00
[rank0]:2025-10-29 05:10:13,481 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.8276e+00
[rank3]:2025-10-29 05:10:35,407 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.9045e+00
[rank0]:2025-10-29 05:10:35,401 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.5235e+00
[rank2]:2025-10-29 05:10:35,400 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6958e+00
[rank1]:2025-10-29 05:10:35,404 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.2297e+00
[rank3]:2025-10-29 05:11:00,678 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.1843e+00
[rank2]:2025-10-29 05:11:00,674 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6123e+00
[rank0]:2025-10-29 05:11:00,666 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1593e-01
[rank1]:2025-10-29 05:11:00,678 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.7905e-01
[rank3]:2025-10-29 05:11:22,802 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.5105e+00
[rank2]:2025-10-29 05:11:22,795 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.4990e+00
[rank0]:2025-10-29 05:11:22,796 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.6117e+00
[rank1]:2025-10-29 05:11:22,799 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.2152e-01
[rank0]:2025-10-29 05:11:45,389 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:11:47,925 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.9733e-01
[rank3]:2025-10-29 05:11:47,928 - INFO -  step: 1850  loss:  0.0669  grad_norm:  0.0978  memory: 76.44GiB(54.68%)  tps: 6,822  tflops: 318.17  mfu: 32.17%
[rank2]:2025-10-29 05:11:47,922 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.9803e-01
[rank2]:2025-10-29 05:11:47,923 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 61.15GiB(43.74%)  tps: 6,821  tflops: 318.14  mfu: 32.17%
[rank0]:2025-10-29 05:11:47,913 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.8788e-01
[rank0]:2025-10-29 05:11:47,914 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 72.50GiB(51.86%)  tps: 6,819  tflops: 318.05  mfu: 32.16%
[rank1]:2025-10-29 05:11:47,925 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5908e-01
[rank1]:2025-10-29 05:11:47,926 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0978  memory: 68.17GiB(48.76%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank3]:2025-10-29 05:11:48,299 - INFO - Avg. fwd time: 14.7688 / Avg. bwd time: 39.2531 / Avg. batch time: 447.5825 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:11:48,331 - INFO - Avg. fwd time: 13.5944 / Avg. bwd time: 31.5930 / Avg. batch time: 495.5033 (ms) / GPU bubble ratio: 27.04%
[rank0]:2025-10-29 05:11:48,380 - INFO - Avg. fwd time: 14.7673 / Avg. bwd time: 28.7253 / Avg. batch time: 596.9924 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 05:11:48,375 - INFO - Avg. fwd time: 15.8512 / Avg. bwd time: 36.7404 / Avg. batch time: 550.8437 (ms) / GPU bubble ratio: 23.62%
[rank1]:2025-10-29 05:12:10,032 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.6154e+00
[rank2]:2025-10-29 05:12:10,029 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5309e+00
[rank0]:2025-10-29 05:12:10,030 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0051e+00
[rank3]:2025-10-29 05:12:10,036 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3353e+00
[rank1]:2025-10-29 05:12:35,277 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0977e+00
[rank2]:2025-10-29 05:12:35,274 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2829e+00
[rank0]:2025-10-29 05:12:35,265 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.3799e+00
[rank3]:2025-10-29 05:12:35,277 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.4062e+00
[rank1]:2025-10-29 05:12:57,287 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.2323e+00
[rank0]:2025-10-29 05:12:57,284 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3214e+00
[rank2]:2025-10-29 05:12:57,284 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.9642e+00
[rank3]:2025-10-29 05:12:57,290 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8647e+00
[rank1]:2025-10-29 05:13:22,680 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4970e-01
[rank0]:2025-10-29 05:13:22,668 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0613e+00
[rank2]:2025-10-29 05:13:22,677 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7920e-01
[rank3]:2025-10-29 05:13:22,680 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5778e-01
[rank0]:2025-10-29 05:13:42,409 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:13:44,636 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4180e+00
[rank1]:2025-10-29 05:13:44,637 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 68.17GiB(48.76%)  tps: 7,019  tflops: 327.37  mfu: 33.10%
[rank0]:2025-10-29 05:13:44,634 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.2149e-01
[rank0]:2025-10-29 05:13:44,634 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 72.50GiB(51.86%)  tps: 7,018  tflops: 327.34  mfu: 33.10%
[rank2]:2025-10-29 05:13:44,633 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.5642e+00
[rank2]:2025-10-29 05:13:44,634 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0948  memory: 61.15GiB(43.74%)  tps: 7,019  tflops: 327.37  mfu: 33.10%
[rank3]:2025-10-29 05:13:44,640 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.3463e+00
[rank3]:2025-10-29 05:13:44,642 - INFO -  step: 1900  loss:  0.0845  grad_norm:  0.0948  memory: 76.44GiB(54.68%)  tps: 7,019  tflops: 327.36  mfu: 33.10%
[rank1]:2025-10-29 05:13:44,724 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0513_stage1_step1900.svg
[rank0]:2025-10-29 05:13:44,732 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0513_stage0_step1900.svg
[rank2]:2025-10-29 05:13:44,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0513_stage2_step1900.svg
[rank3]:2025-10-29 05:13:44,832 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0513_real_step1900_rank3.svg
[rank3]:> Batch Time: 605.31 ms, GPU Bubble Ratio: 46.46%, 25.39%, 35.40%, 25.76%
[rank3]:2025-10-29 05:13:44,900 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0513_stage3_step1900.svg
[rank2]:2025-10-29 05:13:45,342 - INFO - Avg. fwd time: 13.5893 / Avg. bwd time: 31.5692 / Avg. batch time: 495.1712 (ms) / GPU bubble ratio: 27.04%
[rank3]:2025-10-29 05:13:45,294 - INFO - Avg. fwd time: 14.7606 / Avg. bwd time: 39.2254 / Avg. batch time: 447.2901 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-29 05:13:45,389 - INFO - Avg. fwd time: 15.8438 / Avg. bwd time: 36.7210 / Avg. batch time: 550.4847 (ms) / GPU bubble ratio: 23.61%
[rank0]:2025-10-29 05:13:45,386 - INFO - Avg. fwd time: 14.7683 / Avg. bwd time: 28.5975 / Avg. batch time: 596.4709 (ms) / GPU bubble ratio: 41.84%
[rank1]:2025-10-29 05:14:10,131 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6865e-01
[rank3]:2025-10-29 05:14:10,131 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 4.3803e-01
[rank0]:2025-10-29 05:14:10,119 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7186e-01
[rank2]:2025-10-29 05:14:10,128 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8127e-01
[rank1]:2025-10-29 05:14:32,214 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.8310e-01
[rank3]:2025-10-29 05:14:32,217 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.6373e+00
[rank2]:2025-10-29 05:14:32,210 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 9.5271e-01
[rank0]:2025-10-29 05:14:32,211 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.0744e-01
[rank1]:2025-10-29 05:14:57,376 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.9630e-01
[rank3]:2025-10-29 05:14:57,375 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8965e+00
[rank0]:2025-10-29 05:14:57,363 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.3481e-01
[rank2]:2025-10-29 05:14:57,372 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.4492e-01
[rank1]:2025-10-29 05:15:19,495 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0940e+00
[rank3]:2025-10-29 05:15:19,498 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1267e+00
[rank2]:2025-10-29 05:15:19,492 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.8021e+00
[rank0]:2025-10-29 05:15:19,492 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8625e-01
[rank0]:2025-10-29 05:15:42,162 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:15:44,742 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.0011e+00
[rank1]:2025-10-29 05:15:44,742 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7385e+00
[rank1]:2025-10-29 05:15:44,743 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 68.17GiB(48.76%)  tps: 6,821  tflops: 318.12  mfu: 32.17%
[rank0]:2025-10-29 05:15:44,730 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8543e+00
[rank0]:2025-10-29 05:15:44,730 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 72.50GiB(51.86%)  tps: 6,821  tflops: 318.14  mfu: 32.17%
[rank2]:2025-10-29 05:15:44,739 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.4034e-01
[rank2]:2025-10-29 05:15:44,739 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1458  memory: 61.15GiB(43.74%)  tps: 6,821  tflops: 318.12  mfu: 32.17%
[rank3]:2025-10-29 05:15:44,745 - INFO -  step: 1950  loss:  0.1077  grad_norm:  0.1458  memory: 76.44GiB(54.68%)  tps: 6,821  tflops: 318.13  mfu: 32.17%
[rank3]:2025-10-29 05:15:45,212 - INFO - Avg. fwd time: 14.7518 / Avg. bwd time: 39.2207 / Avg. batch time: 447.1761 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-10-29 05:15:45,250 - INFO - Avg. fwd time: 13.5822 / Avg. bwd time: 31.5745 / Avg. batch time: 495.0649 (ms) / GPU bubble ratio: 27.03%
[rank1]:2025-10-29 05:15:45,292 - INFO - Avg. fwd time: 15.8352 / Avg. bwd time: 36.7314 / Avg. batch time: 550.3871 (ms) / GPU bubble ratio: 23.59%
[rank0]:2025-10-29 05:15:45,327 - INFO - Avg. fwd time: 14.7694 / Avg. bwd time: 28.4834 / Avg. batch time: 596.2271 (ms) / GPU bubble ratio: 41.96%
[rank3]:2025-10-29 05:16:06,757 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3563e+00
[rank1]:2025-10-29 05:16:06,754 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.7576e+00
[rank0]:2025-10-29 05:16:06,751 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.7761e+00
[rank2]:2025-10-29 05:16:06,751 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.7989e+00
[rank3]:2025-10-29 05:16:32,148 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.7330e+00
[rank1]:2025-10-29 05:16:32,148 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.1477e+00
[rank2]:2025-10-29 05:16:32,144 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4850e+00
[rank0]:2025-10-29 05:16:32,136 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7637e+00
[rank3]:2025-10-29 05:16:54,040 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0687e+01
[rank1]:2025-10-29 05:16:54,037 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1513e+01
[rank0]:2025-10-29 05:16:54,034 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0412e+01
[rank2]:2025-10-29 05:16:54,033 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.0745e+01
[rank3]:2025-10-29 05:17:14,977 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.9964e+00
[rank1]:2025-10-29 05:17:14,980 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3327e+00
[rank0]:2025-10-29 05:17:14,974 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3163e+00
[rank2]:2025-10-29 05:17:14,973 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8873e+00
[rank0]:2025-10-29 05:17:34,840 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:17:37,090 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.0209e-01
[rank3]:2025-10-29 05:17:37,092 - INFO -  step: 2000  loss:  0.0941  grad_norm:  0.1235  memory: 78.44GiB(56.10%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank3]:2025-10-29 05:17:37,092 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 05:17:37,087 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 1.6058e+00
[rank1]:2025-10-29 05:17:37,087 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 68.17GiB(48.76%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank1]:2025-10-29 05:17:37,087 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 05:17:37,083 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.4478e+00
[rank2]:2025-10-29 05:17:37,084 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 62.11GiB(44.42%)  tps: 7,292  tflops: 340.09  mfu: 34.39%
[rank2]:2025-10-29 05:17:37,084 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 05:17:37,084 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5629e-01
[rank0]:2025-10-29 05:17:37,084 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1235  memory: 73.46GiB(52.54%)  tps: 7,291  tflops: 340.07  mfu: 34.38%
[rank0]:2025-10-29 05:17:37,084 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 05:17:53,434 - INFO - validate step: 2000  loss: -1.0000  memory: 68.17GiB(48.76%)  tps: 25,057
[rank2]:2025-10-29 05:17:53,449 - INFO - validate step: 2000  loss: -1.0000  memory: 62.11GiB(44.42%)  tps: 25,029
[rank0]:2025-10-29 05:17:53,399 - INFO - validate step: 2000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,106
[rank3]:2025-10-29 05:17:53,463 - INFO - validate step: 2000  loss:  0.2593  memory: 78.44GiB(56.10%)  tps: 25,021
[rank1]:2025-10-29 05:17:53,550 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0517_stage1_step2000.svg
[rank2]:2025-10-29 05:17:53,557 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0517_stage2_step2000.svg
[rank0]:2025-10-29 05:17:53,551 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0517_stage0_step2000.svg
[rank3]:2025-10-29 05:17:53,654 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0517_real_step2000_rank3.svg
[rank3]:> Batch Time: 604.59 ms, GPU Bubble Ratio: 46.44%, 25.36%, 35.35%, 25.77%
[rank3]:2025-10-29 05:17:53,732 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0517_stage3_step2000.svg
[rank3]:2025-10-29 05:17:54,048 - INFO - Avg. fwd time: 14.7530 / Avg. bwd time: 39.1299 / Avg. batch time: 446.4549 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-29 05:17:54,117 - INFO - Avg. fwd time: 15.8359 / Avg. bwd time: 36.6577 / Avg. batch time: 549.5513 (ms) / GPU bubble ratio: 23.58%
[rank2]:2025-10-29 05:17:54,082 - INFO - Avg. fwd time: 13.5860 / Avg. bwd time: 31.4854 / Avg. batch time: 494.2408 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 05:17:54,125 - INFO - Avg. fwd time: 14.7725 / Avg. bwd time: 28.3580 / Avg. batch time: 595.2370 (ms) / GPU bubble ratio: 42.03%
[rank3]:2025-10-29 05:18:13,904 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2409e+00
[rank1]:2025-10-29 05:18:13,904 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.7502e-01
[rank2]:2025-10-29 05:18:13,901 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0815e-01
[rank0]:2025-10-29 05:18:13,901 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0091e+00
[rank3]:2025-10-29 05:18:36,059 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1042e-01
[rank1]:2025-10-29 05:18:36,056 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 6.2703e-01
[rank2]:2025-10-29 05:18:36,052 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 4.2949e-01
[rank0]:2025-10-29 05:18:36,053 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3836e-02
[rank3]:2025-10-29 05:18:56,294 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.9513e-01
[rank1]:2025-10-29 05:18:56,294 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.9671e-01
[rank0]:2025-10-29 05:18:56,291 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2126e+00
[rank2]:2025-10-29 05:18:56,290 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.4104e-01
[rank3]:2025-10-29 05:19:18,317 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.6308e-01
[rank1]:2025-10-29 05:19:18,314 - INFO - Freezing Ratio: [Stage1] 0.56, Threshold: 1.2839e+00
[rank0]:2025-10-29 05:19:18,311 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.6382e-01
[rank2]:2025-10-29 05:19:18,310 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.2661e+00
[rank0]:2025-10-29 05:19:36,692 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 05:19:38,735 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.9449e+00
[rank1]:2025-10-29 05:19:38,734 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.6292e-01
[rank1]:2025-10-29 05:19:38,735 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 69.16GiB(49.47%)  tps: 7,780  tflops: 362.84  mfu: 36.69%
[rank0]:2025-10-29 05:19:38,732 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5814e+00
[rank0]:2025-10-29 05:19:38,732 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 73.46GiB(52.54%)  tps: 7,777  tflops: 362.73  mfu: 36.68%
[rank2]:2025-10-29 05:19:38,731 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1799e+00
[rank2]:2025-10-29 05:19:38,732 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0996  memory: 62.11GiB(44.42%)  tps: 7,781  tflops: 362.91  mfu: 36.69%
[rank3]:2025-10-29 05:19:38,737 - INFO -  step: 2050  loss:  0.1246  grad_norm:  0.0996  memory: 78.44GiB(56.10%)  tps: 7,782  tflops: 362.94  mfu: 36.70%
[rank3]:2025-10-29 05:19:39,112 - INFO - Avg. fwd time: 14.7651 / Avg. bwd time: 38.9465 / Avg. batch time: 445.0848 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-29 05:19:39,145 - INFO - Avg. fwd time: 13.5996 / Avg. bwd time: 31.3093 / Avg. batch time: 492.6952 (ms) / GPU bubble ratio: 27.08%
[rank1]:2025-10-29 05:19:39,192 - INFO - Avg. fwd time: 15.8492 / Avg. bwd time: 36.4824 / Avg. batch time: 547.8180 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 05:19:39,193 - INFO - Avg. fwd time: 14.7814 / Avg. bwd time: 28.1851 / Avg. batch time: 593.3005 (ms) / GPU bubble ratio: 42.06%
[rank3]:2025-10-29 05:20:00,654 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9044e-01
[rank1]:2025-10-29 05:20:00,651 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.5157e-01
[rank2]:2025-10-29 05:20:00,648 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 7.6301e-01
[rank0]:2025-10-29 05:20:00,648 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3879e-01
[rank3]:2025-10-29 05:20:20,812 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5466e-01
[rank1]:2025-10-29 05:20:20,809 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.6495e-01
[rank0]:2025-10-29 05:20:20,810 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1024e+00
[rank2]:2025-10-29 05:20:20,809 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0632e-01
[rank3]:2025-10-29 05:20:42,954 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0698e-01
[rank1]:2025-10-29 05:20:42,951 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2869e-01
[rank0]:2025-10-29 05:20:42,948 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7494e-01
[rank2]:2025-10-29 05:20:42,947 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2867e+00
[rank2]:2025-10-29 05:21:02,836 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6819e-01
[rank0]:2025-10-29 05:21:02,840 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5839e-01
[rank3]:2025-10-29 05:21:02,842 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.2789e-01
[rank1]:2025-10-29 05:21:02,839 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6658e-01
[rank0]:2025-10-29 05:21:22,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:21:25,007 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4662e-01
[rank3]:2025-10-29 05:21:25,009 - INFO -  step: 2100  loss:  0.1117  grad_norm:  0.1099  memory: 78.44GiB(56.10%)  tps: 7,709  tflops: 359.53  mfu: 36.35%
[rank1]:2025-10-29 05:21:25,004 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.4244e-01
[rank1]:2025-10-29 05:21:25,004 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 70.12GiB(50.15%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank0]:2025-10-29 05:21:25,001 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0176e-01
[rank0]:2025-10-29 05:21:25,001 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 73.46GiB(52.54%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank2]:2025-10-29 05:21:25,001 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1615e-01
[rank2]:2025-10-29 05:21:25,001 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1099  memory: 63.09GiB(45.12%)  tps: 7,709  tflops: 359.54  mfu: 36.35%
[rank1]:2025-10-29 05:21:25,091 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0521_stage1_step2100.svg
[rank0]:2025-10-29 05:21:25,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0521_stage0_step2100.svg
[rank2]:2025-10-29 05:21:25,097 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0521_stage2_step2100.svg
[rank3]:2025-10-29 05:21:25,188 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0521_real_step2100_rank3.svg
[rank3]:> Batch Time: 567.58 ms, GPU Bubble Ratio: 42.96%, 32.57%, 35.99%, 25.10%
[rank3]:2025-10-29 05:21:25,254 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0521_stage3_step2100.svg
[rank3]:2025-10-29 05:21:25,639 - INFO - Avg. fwd time: 14.7744 / Avg. bwd time: 38.7848 / Avg. batch time: 443.8603 (ms) / GPU bubble ratio: 3.47%
[rank1]:2025-10-29 05:21:25,708 - INFO - Avg. fwd time: 15.8620 / Avg. bwd time: 36.2939 / Avg. batch time: 546.2143 (ms) / GPU bubble ratio: 23.61%
[rank0]:2025-10-29 05:21:25,739 - INFO - Avg. fwd time: 14.7889 / Avg. bwd time: 28.0267 / Avg. batch time: 591.5096 (ms) / GPU bubble ratio: 42.09%
[rank2]:2025-10-29 05:21:25,671 - INFO - Avg. fwd time: 13.6127 / Avg. bwd time: 31.1354 / Avg. batch time: 491.2963 (ms) / GPU bubble ratio: 27.13%
[rank3]:2025-10-29 05:21:45,238 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.5747e+00
[rank1]:2025-10-29 05:21:45,235 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.3346e+00
[rank2]:2025-10-29 05:21:45,231 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6887e+00
[rank0]:2025-10-29 05:21:45,235 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9174e+00
[rank3]:2025-10-29 05:22:07,239 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0892e-01
[rank1]:2025-10-29 05:22:07,236 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2163e+00
[rank0]:2025-10-29 05:22:07,233 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1105e-01
[rank2]:2025-10-29 05:22:07,232 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9756e-01
[rank3]:2025-10-29 05:22:27,387 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8464e+00
[rank1]:2025-10-29 05:22:27,384 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5655e+00
[rank2]:2025-10-29 05:22:27,381 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6304e+00
[rank0]:2025-10-29 05:22:27,385 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.7083e+00
[rank3]:2025-10-29 05:22:49,351 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9645e+00
[rank1]:2025-10-29 05:22:49,347 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.9578e+00
[rank0]:2025-10-29 05:22:49,345 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9071e+00
[rank2]:2025-10-29 05:22:49,344 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.7338e+00
[rank0]:2025-10-29 05:23:07,405 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:23:09,399 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.3470e+00
[rank3]:2025-10-29 05:23:09,402 - INFO -  step: 2150  loss:  0.1264  grad_norm:  0.1341  memory: 78.44GiB(56.10%)  tps: 7,847  tflops: 366.01  mfu: 37.01%
[rank1]:2025-10-29 05:23:09,396 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.6308e+00
[rank1]:2025-10-29 05:23:09,396 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 70.12GiB(50.15%)  tps: 7,847  tflops: 366.00  mfu: 37.01%
[rank0]:2025-10-29 05:23:09,397 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8814e+00
[rank0]:2025-10-29 05:23:09,397 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 73.46GiB(52.54%)  tps: 7,847  tflops: 365.99  mfu: 37.01%
[rank2]:2025-10-29 05:23:09,393 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9330e+00
[rank2]:2025-10-29 05:23:09,393 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1341  memory: 63.09GiB(45.12%)  tps: 7,847  tflops: 366.00  mfu: 37.01%
[rank3]:2025-10-29 05:23:09,781 - INFO - Avg. fwd time: 14.7836 / Avg. bwd time: 38.6394 / Avg. batch time: 442.7672 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-10-29 05:23:09,813 - INFO - Avg. fwd time: 13.6266 / Avg. bwd time: 30.9673 / Avg. batch time: 490.0214 (ms) / GPU bubble ratio: 27.20%
[rank1]:2025-10-29 05:23:09,857 - INFO - Avg. fwd time: 15.8746 / Avg. bwd time: 36.1237 / Avg. batch time: 544.7545 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-29 05:23:09,863 - INFO - Avg. fwd time: 14.7958 / Avg. bwd time: 27.8909 / Avg. batch time: 589.8898 (ms) / GPU bubble ratio: 42.11%
[rank1]:2025-10-29 05:23:31,541 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.1767e+00
[rank0]:2025-10-29 05:23:31,539 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4880e+00
[rank2]:2025-10-29 05:23:31,538 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9287e+00
[rank3]:2025-10-29 05:23:31,545 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3138e+00
[rank3]:2025-10-29 05:23:51,430 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.3014e+00
[rank1]:2025-10-29 05:23:51,427 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.5665e+00
[rank2]:2025-10-29 05:23:51,423 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0340e+00
[rank0]:2025-10-29 05:23:51,427 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8715e+00
[rank1]:2025-10-29 05:24:13,581 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.3521e+00
[rank0]:2025-10-29 05:24:13,578 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3984e+00
[rank2]:2025-10-29 05:24:13,577 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2721e+00
[rank3]:2025-10-29 05:24:13,584 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9075e+00
[rank3]:2025-10-29 05:24:33,565 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.7601e+00
[rank1]:2025-10-29 05:24:33,562 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1784e+00
[rank0]:2025-10-29 05:24:33,562 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.2583e+00
[rank2]:2025-10-29 05:24:33,558 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5463e+00
[rank0]:2025-10-29 05:24:53,381 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:24:55,592 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.1305e-01
[rank3]:2025-10-29 05:24:55,595 - INFO -  step: 2200  loss:  0.0970  grad_norm:  0.0830  memory: 78.44GiB(56.10%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank3]:2025-10-29 05:24:55,595 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 05:24:55,589 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5355e+00
[rank1]:2025-10-29 05:24:55,589 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 70.12GiB(50.15%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank1]:2025-10-29 05:24:55,589 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 05:24:55,585 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1377e-01
[rank2]:2025-10-29 05:24:55,586 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 63.09GiB(45.12%)  tps: 7,714  tflops: 359.80  mfu: 36.38%
[rank2]:2025-10-29 05:24:55,586 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 05:24:55,586 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7427e-01
[rank0]:2025-10-29 05:24:55,587 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0830  memory: 73.46GiB(52.54%)  tps: 7,715  tflops: 359.81  mfu: 36.38%
[rank0]:2025-10-29 05:24:55,587 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 05:25:11,946 - INFO - validate step: 2200  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,039
[rank3]:2025-10-29 05:25:12,007 - INFO - validate step: 2200  loss:  0.2574  memory: 78.44GiB(56.10%)  tps: 24,959
[rank1]:2025-10-29 05:25:11,980 - INFO - validate step: 2200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 24,990
[rank2]:2025-10-29 05:25:11,996 - INFO - validate step: 2200  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,961
[rank1]:2025-10-29 05:25:12,090 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0525_stage1_step2200.svg
[rank0]:2025-10-29 05:25:12,086 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0525_stage0_step2200.svg
[rank2]:2025-10-29 05:25:12,096 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0525_stage2_step2200.svg
[rank3]:2025-10-29 05:25:12,191 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0525_real_step2200_rank3.svg
[rank3]:> Batch Time: 559.67 ms, GPU Bubble Ratio: 42.17%, 31.91%, 42.17%, 24.52%
[rank3]:2025-10-29 05:25:12,259 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0525_stage3_step2200.svg
[rank3]:2025-10-29 05:25:12,567 - INFO - Avg. fwd time: 14.7921 / Avg. bwd time: 38.4862 / Avg. batch time: 441.6037 (ms) / GPU bubble ratio: 3.48%
[rank1]:2025-10-29 05:25:12,625 - INFO - Avg. fwd time: 15.8861 / Avg. bwd time: 35.9439 / Avg. batch time: 543.2008 (ms) / GPU bubble ratio: 23.67%
[rank0]:2025-10-29 05:25:12,636 - INFO - Avg. fwd time: 14.8022 / Avg. bwd time: 27.7445 / Avg. batch time: 588.1622 (ms) / GPU bubble ratio: 42.13%
[rank2]:2025-10-29 05:25:12,594 - INFO - Avg. fwd time: 13.6402 / Avg. bwd time: 30.7896 / Avg. batch time: 488.6643 (ms) / GPU bubble ratio: 27.26%
[rank3]:2025-10-29 05:25:32,391 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.4417e+00
[rank1]:2025-10-29 05:25:32,388 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5887e+00
[rank2]:2025-10-29 05:25:32,385 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0937e+00
[rank0]:2025-10-29 05:25:32,389 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6520e+00
[rank3]:2025-10-29 05:25:54,324 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6833e+00
[rank1]:2025-10-29 05:25:54,321 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2223e+00
[rank2]:2025-10-29 05:25:54,317 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7264e-01
[rank0]:2025-10-29 05:25:54,318 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3017e+00
[rank3]:2025-10-29 05:26:14,374 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.8618e+00
[rank1]:2025-10-29 05:26:14,371 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2116e+00
[rank2]:2025-10-29 05:26:14,368 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5958e+00
[rank0]:2025-10-29 05:26:14,371 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5207e+00
[rank1]:2025-10-29 05:26:36,501 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.4608e+00
[rank2]:2025-10-29 05:26:36,498 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9652e-01
[rank0]:2025-10-29 05:26:36,499 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0025e+00
[rank3]:2025-10-29 05:26:36,505 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.1148e-01
[rank0]:2025-10-29 05:26:54,419 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:26:56,427 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.7447e-01
[rank1]:2025-10-29 05:26:56,427 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 70.12GiB(50.15%)  tps: 7,843  tflops: 365.81  mfu: 36.99%
[rank2]:2025-10-29 05:26:56,424 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.7302e-01
[rank2]:2025-10-29 05:26:56,424 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 63.09GiB(45.12%)  tps: 7,845  tflops: 365.88  mfu: 36.99%
[rank0]:2025-10-29 05:26:56,427 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.1749e-01
[rank0]:2025-10-29 05:26:56,428 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1007  memory: 73.46GiB(52.54%)  tps: 7,841  tflops: 365.69  mfu: 36.98%
[rank3]:2025-10-29 05:26:56,430 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.5571e-01
[rank3]:2025-10-29 05:26:56,433 - INFO -  step: 2250  loss:  0.1149  grad_norm:  0.1007  memory: 78.44GiB(56.10%)  tps: 7,845  tflops: 365.89  mfu: 37.00%
[rank3]:2025-10-29 05:26:56,901 - INFO - Avg. fwd time: 14.8020 / Avg. bwd time: 38.3284 / Avg. batch time: 440.4168 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-29 05:26:56,941 - INFO - Avg. fwd time: 13.6546 / Avg. bwd time: 30.6086 / Avg. batch time: 487.2964 (ms) / GPU bubble ratio: 27.33%
[rank1]:2025-10-29 05:26:56,984 - INFO - Avg. fwd time: 15.8989 / Avg. bwd time: 35.7604 / Avg. batch time: 541.6347 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-10-29 05:26:57,020 - INFO - Avg. fwd time: 14.8096 / Avg. bwd time: 27.5994 / Avg. batch time: 586.4262 (ms) / GPU bubble ratio: 42.15%
[rank1]:2025-10-29 05:27:18,646 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3255e+00
[rank0]:2025-10-29 05:27:18,644 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.7908e-01
[rank2]:2025-10-29 05:27:18,643 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1580e+00
[rank3]:2025-10-29 05:27:18,649 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0271e+00
[rank1]:2025-10-29 05:27:38,659 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7543e+00
[rank0]:2025-10-29 05:27:38,660 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2097e+00
[rank2]:2025-10-29 05:27:38,656 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2328e+00
[rank3]:2025-10-29 05:27:38,662 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.2457e-01
[rank3]:2025-10-29 05:28:00,679 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.5234e-01
[rank1]:2025-10-29 05:28:00,676 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6264e-01
[rank2]:2025-10-29 05:28:00,672 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8479e-01
[rank0]:2025-10-29 05:28:00,673 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6477e-01
[rank3]:2025-10-29 05:28:20,860 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.3643e+00
[rank1]:2025-10-29 05:28:20,857 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.8973e-01
[rank0]:2025-10-29 05:28:20,858 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.7761e-01
[rank2]:2025-10-29 05:28:20,854 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7898e-01
[rank0]:2025-10-29 05:28:40,562 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:28:42,793 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.0915e-01
[rank3]:2025-10-29 05:28:42,796 - INFO -  step: 2300  loss:  0.0875  grad_norm:  0.0896  memory: 78.44GiB(56.10%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank1]:2025-10-29 05:28:42,790 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3089e+00
[rank1]:2025-10-29 05:28:42,790 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 70.12GiB(50.15%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank0]:2025-10-29 05:28:42,788 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1377e+00
[rank0]:2025-10-29 05:28:42,788 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 73.46GiB(52.54%)  tps: 7,702  tflops: 359.23  mfu: 36.32%
[rank2]:2025-10-29 05:28:42,787 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9648e-01
[rank2]:2025-10-29 05:28:42,787 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0896  memory: 63.09GiB(45.12%)  tps: 7,702  tflops: 359.22  mfu: 36.32%
[rank1]:2025-10-29 05:28:42,879 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0528_stage1_step2300.svg
[rank2]:2025-10-29 05:28:42,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0528_stage2_step2300.svg
[rank0]:2025-10-29 05:28:42,874 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0528_stage0_step2300.svg
[rank3]:2025-10-29 05:28:42,979 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0528_real_step2300_rank3.svg
[rank3]:> Batch Time: 557.41 ms, GPU Bubble Ratio: 41.95%, 31.72%, 42.20%, 24.58%
[rank3]:2025-10-29 05:28:43,047 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0528_stage3_step2300.svg
[rank3]:2025-10-29 05:28:43,360 - INFO - Avg. fwd time: 14.8091 / Avg. bwd time: 38.2127 / Avg. batch time: 439.5437 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-10-29 05:28:43,419 - INFO - Avg. fwd time: 15.9086 / Avg. bwd time: 35.6231 / Avg. batch time: 540.4634 (ms) / GPU bubble ratio: 23.72%
[rank2]:2025-10-29 05:28:43,387 - INFO - Avg. fwd time: 13.6652 / Avg. bwd time: 30.4727 / Avg. batch time: 486.2751 (ms) / GPU bubble ratio: 27.39%
[rank0]:2025-10-29 05:28:43,430 - INFO - Avg. fwd time: 14.8152 / Avg. bwd time: 27.4866 / Avg. batch time: 585.1215 (ms) / GPU bubble ratio: 42.16%
[rank2]:2025-10-29 05:29:03,062 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7553e-01
[rank3]:2025-10-29 05:29:03,068 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2045e+00
[rank1]:2025-10-29 05:29:03,065 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2816e+00
[rank0]:2025-10-29 05:29:03,066 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0141e+00
[rank3]:2025-10-29 05:29:25,233 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3729e+00
[rank1]:2025-10-29 05:29:25,230 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9189e+00
[rank0]:2025-10-29 05:29:25,227 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.1913e-01
[rank2]:2025-10-29 05:29:25,227 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2833e-01
[rank3]:2025-10-29 05:29:45,135 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.3943e+00
[rank1]:2025-10-29 05:29:45,132 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.2435e+00
[rank0]:2025-10-29 05:29:45,132 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3690e+00
[rank2]:2025-10-29 05:29:45,128 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9679e+00
[rank3]:2025-10-29 05:30:07,287 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9250e-01
[rank1]:2025-10-29 05:30:07,283 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1466e+00
[rank0]:2025-10-29 05:30:07,281 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9841e-01
[rank2]:2025-10-29 05:30:07,280 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.2633e-01
[rank0]:2025-10-29 05:30:25,250 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:30:27,287 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8718e+00
[rank3]:2025-10-29 05:30:27,289 - INFO -  step: 2350  loss:  0.1004  grad_norm:  0.0891  memory: 78.44GiB(56.10%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank1]:2025-10-29 05:30:27,284 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0921e+00
[rank1]:2025-10-29 05:30:27,284 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 70.12GiB(50.15%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank0]:2025-10-29 05:30:27,284 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.7120e+00
[rank0]:2025-10-29 05:30:27,285 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 73.46GiB(52.54%)  tps: 7,839  tflops: 365.64  mfu: 36.97%
[rank2]:2025-10-29 05:30:27,280 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4914e+00
[rank2]:2025-10-29 05:30:27,281 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0891  memory: 63.09GiB(45.12%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank3]:2025-10-29 05:30:27,681 - INFO - Avg. fwd time: 14.8178 / Avg. bwd time: 38.0731 / Avg. batch time: 438.4923 (ms) / GPU bubble ratio: 3.50%
[rank2]:2025-10-29 05:30:27,711 - INFO - Avg. fwd time: 13.6782 / Avg. bwd time: 30.3115 / Avg. batch time: 485.0617 (ms) / GPU bubble ratio: 27.45%
[rank1]:2025-10-29 05:30:27,756 - INFO - Avg. fwd time: 15.9202 / Avg. bwd time: 35.4597 / Avg. batch time: 539.0721 (ms) / GPU bubble ratio: 23.75%
[rank0]:2025-10-29 05:30:27,762 - INFO - Avg. fwd time: 14.8224 / Avg. bwd time: 27.3558 / Avg. batch time: 583.5762 (ms) / GPU bubble ratio: 42.18%
[rank3]:2025-10-29 05:30:49,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4124e+00
[rank1]:2025-10-29 05:30:49,312 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.7869e+00
[rank2]:2025-10-29 05:30:49,309 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8862e+00
[rank0]:2025-10-29 05:30:49,310 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4569e+00
[rank3]:2025-10-29 05:31:09,502 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5295e+00
[rank1]:2025-10-29 05:31:09,498 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1689e+00
[rank2]:2025-10-29 05:31:09,495 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.8064e-01
[rank0]:2025-10-29 05:31:09,499 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1452e-01
[rank3]:2025-10-29 05:31:31,454 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.8827e-01
[rank1]:2025-10-29 05:31:31,451 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2070e+00
[rank2]:2025-10-29 05:31:31,448 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.5800e-01
[rank0]:2025-10-29 05:31:31,449 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1525e-01
[rank3]:2025-10-29 05:31:51,475 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 5.5813e-01
[rank1]:2025-10-29 05:31:51,472 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1725e-01
[rank2]:2025-10-29 05:31:51,469 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1996e+00
[rank0]:2025-10-29 05:31:51,473 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.9034e-01
[rank0]:2025-10-29 05:32:11,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:32:13,606 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.5895e-01
[rank0]:2025-10-29 05:32:13,607 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 73.46GiB(52.54%)  tps: 7,705  tflops: 359.36  mfu: 36.34%
[rank0]:2025-10-29 05:32:13,607 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,947  tflops: 324.03  mfu: 31.78%
[rank0]:2025-10-29 05:32:13,607 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 05:32:13,605 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6481e+00
[rank2]:2025-10-29 05:32:13,606 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 63.09GiB(45.12%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank2]:2025-10-29 05:32:13,606 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,949  tflops: 324.08  mfu: 31.79%
[rank2]:2025-10-29 05:32:13,606 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 05:32:13,612 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3209e+00
[rank3]:2025-10-29 05:32:13,614 - INFO -  step: 2400  loss:  0.0993  grad_norm:  0.1285  memory: 78.44GiB(56.10%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank3]:2025-10-29 05:32:13,615 - INFO -  final step: 2400  loss:  0.0993  grad_norm:  0.1285  tps: 6,951  tflops: 324.18  mfu: 31.79%
[rank3]:2025-10-29 05:32:13,615 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 05:32:13,609 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.5609e-01
[rank1]:2025-10-29 05:32:13,609 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1285  memory: 70.12GiB(50.15%)  tps: 7,705  tflops: 359.35  mfu: 36.33%
[rank1]:2025-10-29 05:32:13,609 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1285  tps: 6,948  tflops: 324.04  mfu: 31.78%
[rank1]:2025-10-29 05:32:13,609 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 05:32:29,925 - INFO - validate step: 2400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,101
[rank0]:2025-10-29 05:32:29,926 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 05:32:29,933 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank3]:2025-10-29 05:32:29,982 - INFO - validate step: 2400  loss:  0.2571  memory: 78.44GiB(56.10%)  tps: 25,028
[rank3]:2025-10-29 05:32:29,983 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 05:32:29,988 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 05:32:29,962 - INFO - validate step: 2400  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,049
[rank1]:2025-10-29 05:32:29,962 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 05:32:29,967 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 05:32:29,978 - INFO - validate step: 2400  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,020
[rank2]:2025-10-29 05:32:29,978 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 05:32:29,981 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 05:32:41,668 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 05:32:41,757 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0532_stage0_final2400.svg
[rank1]:2025-10-29 05:32:41,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0532_stage1_final2400.svg
[rank2]:2025-10-29 05:32:41,768 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0532_stage2_final2400.svg
[rank3]:2025-10-29 05:32:41,866 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0532_real_final2400_rank3.svg
[rank3]:> Batch Time: 552.80 ms, GPU Bubble Ratio: 41.49%, 31.22%, 41.82%, 24.77%
[rank1]:2025-10-29 05:32:42,005 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank1_stage1.svg
[rank1]:	> Counts Sum: 5346, Total Sum: 19035 (28.09%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 58.72, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 8.93, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 7.65, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 05:32:42,005 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 05:32:42,018 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank2_stage2.svg
[rank2]:	> Counts Sum: 5229, Total Sum: 16920 (30.90%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 58.29, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 57.02, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 56.17, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 7.23, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 05:32:42,018 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 05:32:41,998 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank0_stage0.svg
[rank0]:	> Counts Sum: 9540, Total Sum: 17155 (55.61%), Ratio(%) per element: [0.0, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 92.76, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 90.63, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 87.23, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 68.51, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 67.65, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 05:32:41,998 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 05:32:42,036 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0532_thry_final2400_rank3.svg
[rank3]:> Batch Time: 489.46 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 05:32:42,108 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0532_stage3_final2400.svg
[rank3]:2025-10-29 05:32:42,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0532_rank3_stage3.svg
[rank3]:	> Counts Sum: 3978, Total Sum: 15275 (26.04%), Ratio(%) per element: [59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 59.14, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 51.06, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 9.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 05:32:42,331 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–†â–…â–…â–†â–ˆâ–…â–„â–‚â–‚â–â–â–â–‚â–â–ƒâ–‚â–â–‚â–â–‚â–„â–ƒâ–„â–„â–„â–…â–ƒâ–‚â–â–â–â–â–‚â–â–â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–‡â–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–‚â–â–â–‚â–â–‚â–â–â–‡â–†â–‡â–‡â–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–‡â–‡â–‡â–ˆâ–‡â–â–â–â–â–â–â–‚â–â–‚â–‚â–â–‚â–â–â–‡â–†â–‡â–‡â–‡â–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.35718
[rank3]:wandb:               final/avg_loss 0.09927
[rank3]:wandb:             final/avg_mfu(%) 31.79282
[rank3]:wandb:             final/avg_tflops 324.1807
[rank3]:wandb:    final/avg_throughput(tps) 6950.67716
[rank3]:wandb:              final/grad_norm 0.12851
[rank3]:wandb:               final/max_loss 0.09927
[rank3]:wandb:                    grad_norm 0.12851
[rank3]:wandb: loss_metrics/global_avg_loss 0.09927
[rank3]:wandb: loss_metrics/global_max_loss 0.09927
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/fr7hk14p
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_auto_dm1/20251029-0353/wandb/run-20251029_035307-fr7hk14p/logs
[rank0]:2025-10-29 05:32:43,998 - INFO - Training completed
[rank0]:2025-10-29 05:32:43,998 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 05:32:44,177 - INFO - Process group destroyed
[rank2]:2025-10-29 05:32:44,192 - INFO - Process group destroyed
[rank0]:2025-10-29 05:32:44,342 - INFO - Process group destroyed
[rank3]:2025-10-29 05:32:44,334 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.12', 'layers.16', 'layers.11', 'layers.14', 'layers.8', 'layers.9', 'layers.15', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.7', 'layers.6', 'tok_embeddings', 'layers.5', 'layers.0', 'layers.1', 'layers.3', 'layers.4', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.21', 'layers.24', 'layers.23', 'layers.22', 'layers.17', 'layers.19', 'layers.20'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'layers.26', 'output', 'layers.27', 'layers.30', 'layers.31', 'layers.29', 'norm', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 05:32:53 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] 
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] *****************************************
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 05:32:54.616000 1617370 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 05:33:00,286 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 05:33:00,250 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 05:33:00,321 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 05:33:00,310 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 05:33:01,487 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 05:33:01,489 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 05:33:01,458 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 05:33:01,461 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 05:33:01,518 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 05:33:01,520 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:33:01,512 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 05:33:01,515 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 05:33:01,520 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 05:33:03,481 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 05:33:03,790 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 05:33:05,294 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 05:33:06,615 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 05:33:06,870 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 05:33:06,951 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 05:33:06,917 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 05:33:06,941 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 05:33:06,941 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 05:33:07,024 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 05:33:07,024 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 05:33:07,152 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 05:33:07,153 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 05:33:07,459 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 05:33:07,459 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-10-29 05:33:08,080 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 05:33:08,155 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 05:33:08,156 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 05:33:08,363 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 05:33:08,364 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: setting up run 2224xvmg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1/20251029-0533/wandb/run-20251029_053307-2224xvmg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2224xvmg
[rank3]:2025-10-29 05:33:08,711 - INFO - WandB logging enabled
[rank3]:2025-10-29 05:33:08,713 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 05:33:08,786 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 05:33:08,786 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 05:33:09,000 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 05:33:09,001 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank2]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 05:33:09,013 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank0]:2025-10-29 05:33:09,013 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 05:33:09,013 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 05:33:09,017 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 05:33:12,308 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank2]:2025-10-29 05:33:12,481 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:12,759 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 05:33:12,759 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:12,759 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400.
[rank1]:2025-10-29 05:33:12,905 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1.
[rank0]:2025-10-29 05:33:21,705 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 05:33:21,705 - INFO - Finished loading the checkpoint in 8.95 seconds.
[rank0]:2025-10-29 05:33:21,705 - INFO - Training starts at step 1
[rank2]:2025-10-29 05:33:26,388 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 44.28GiB(31.67%)  tps: 845  tflops: 39.41  mfu: 3.99%
[rank2]:2025-10-29 05:33:26,388 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 05:33:26,392 - INFO -  step:  1  loss:  0.9414  grad_norm:  1.0722  memory: 58.03GiB(41.50%)  tps: 929  tflops: 43.34  mfu: 4.38%
[rank3]:2025-10-29 05:33:26,392 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 05:33:26,390 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 49.69GiB(35.54%)  tps: 897  tflops: 41.85  mfu: 4.23%
[rank1]:2025-10-29 05:33:26,390 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 05:33:26,409 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.0722  memory: 49.75GiB(35.58%)  tps: 841  tflops: 39.20  mfu: 3.96%
[rank0]:2025-10-29 05:33:26,409 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 05:33:44,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,642 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,685 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 05:33:44,686 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,643 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,644 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 05:33:44,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 05:33:44,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:33:44,775 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 05:35:35,795 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:35:38,518 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 57.29GiB(40.97%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank1]:2025-10-29 05:35:38,521 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 64.32GiB(46.00%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank0]:2025-10-29 05:35:38,526 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5068  memory: 66.72GiB(47.72%)  tps: 6,077  tflops: 283.41  mfu: 28.66%
[rank3]:2025-10-29 05:35:38,523 - INFO -  step: 50  loss:  0.8893  grad_norm:  0.5068  memory: 73.38GiB(52.48%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank3]:2025-10-29 05:35:38,985 - INFO - Avg. fwd time: 14.6866 / Avg. bwd time: 42.8933 / Avg. batch time: 481.3084 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-10-29 05:35:39,035 - INFO - Avg. fwd time: 13.2387 / Avg. bwd time: 36.4394 / Avg. batch time: 534.1678 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 05:35:39,082 - INFO - Avg. fwd time: 15.3921 / Avg. bwd time: 41.6531 / Avg. batch time: 594.9250 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 05:35:39,115 - INFO - Avg. fwd time: 14.2845 / Avg. bwd time: 38.4378 / Avg. batch time: 650.6706 (ms) / GPU bubble ratio: 35.18%
[rank3]:2025-10-29 05:36:05,330 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 05:36:32,361 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 05:36:32,578 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 05:36:32,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,693 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,686 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,719 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,752 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,702 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,737 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,687 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,712 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,709 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,853 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,771 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,849 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,861 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,889 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,927 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:32,965 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,926 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:36:32,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,899 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,937 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:32,975 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,921 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,958 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:32,997 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 05:36:33,003 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:33,014 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 05:36:33,052 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:33,036 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 05:36:33,073 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 05:37:07,194 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 05:37:07,510 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_max_batch_time.svg
[rank3]:> Batch Time: 634.38 ms, GPU Bubble Ratio: 33.22%, 26.98%, 36.74%, 26.69%
[rank3]:2025-10-29 05:37:07,699 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_min_batch_time.svg
[rank3]:> Batch Time: 394.26 ms, GPU Bubble Ratio: 71.44%, 30.80%, 40.05%, 21.69%
[rank3]:2025-10-29 05:37:07,906 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 394.26 ms, GPU Bubble Ratio: 32.34%, 23.16%, 27.03%, 21.69%
[rank3]:2025-10-29 05:37:07,906 - INFO - 	> Batch Time: 394.26 ms (Average Freeze Ratio: 0.76, Time Reduction Rate: 0.38)
[rank0]:2025-10-29 05:37:22,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:37:24,451 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.63, [MB1] 0.21/0.63, [MB2] 0.00/0.00, [MB3] 0.20/0.59, [MB4] 0.32/0.97, [MB5] 0.33/1.00, [MB6] 0.23/0.69, [MB7] 0.33/1.00
[rank2]:2025-10-29 05:37:24,470 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,732  tflops: 360.61  mfu: 36.46%
[rank3]:2025-10-29 05:37:24,437 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 05:37:24,471 - INFO -  step: 100  loss:  0.8663  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,732  tflops: 360.63  mfu: 36.46%
[rank1]:2025-10-29 05:37:24,472 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.26/0.77, [MB1] 0.04/0.13, [MB2] 0.27/0.80, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 05:37:24,472 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,732  tflops: 360.62  mfu: 36.46%
[rank0]:2025-10-29 05:37:24,471 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.01/0.02, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 05:37:24,472 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,732  tflops: 360.63  mfu: 36.46%
[rank2]:2025-10-29 05:37:24,548 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0537_stage2_step100.svg
[rank1]:2025-10-29 05:37:24,549 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0537_stage1_step100.svg
[rank0]:2025-10-29 05:37:24,547 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0537_stage0_step100.svg
[rank0]:2025-10-29 05:37:24,646 - INFO - Avg. fwd time: 14.7164 / Avg. bwd time: 27.6796 / Avg. batch time: 583.1536 (ms) / GPU bubble ratio: 41.84%
[rank3]:2025-10-29 05:37:24,649 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0537_real_step100_rank3.svg
[rank3]:> Batch Time: 631.94 ms, GPU Bubble Ratio: 33.11%, 27.09%, 36.66%, 26.64%
[rank3]:2025-10-29 05:37:24,708 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0537_stage3_step100.svg
[rank2]:2025-10-29 05:37:24,993 - INFO - Avg. fwd time: 13.9197 / Avg. bwd time: 30.7924 / Avg. batch time: 484.2851 (ms) / GPU bubble ratio: 26.14%
[rank3]:2025-10-29 05:37:24,971 - INFO - Avg. fwd time: 15.4029 / Avg. bwd time: 36.8401 / Avg. batch time: 435.8669 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 05:37:25,019 - INFO - Avg. fwd time: 16.2548 / Avg. bwd time: 35.2998 / Avg. batch time: 538.5016 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-10-29 05:39:15,156 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:39:17,088 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 05:39:17,178 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.42/0.63, [MB1] 0.42/0.63, [MB2] 0.00/0.00, [MB3] 0.39/0.59, [MB4] 0.64/0.97, [MB5] 0.67/1.00, [MB6] 0.46/0.69, [MB7] 0.67/1.00
[rank2]:2025-10-29 05:39:17,265 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 64.67GiB(46.25%)  tps: 7,263  tflops: 338.74  mfu: 34.25%
[rank3]:2025-10-29 05:39:17,264 - INFO -  step: 150  loss:  0.8765  grad_norm:  0.1878  memory: 84.29GiB(60.29%)  tps: 7,263  tflops: 338.75  mfu: 34.25%
[rank1]:2025-10-29 05:39:17,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.51/0.77, [MB1] 0.09/0.13, [MB2] 0.54/0.80, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 05:39:17,267 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 72.68GiB(51.98%)  tps: 7,263  tflops: 338.74  mfu: 34.25%
[rank0]:2025-10-29 05:39:17,257 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.01/0.02, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 05:39:17,271 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1878  memory: 72.70GiB(52.00%)  tps: 7,262  tflops: 338.72  mfu: 34.25%
[rank3]:2025-10-29 05:39:17,692 - INFO - Avg. fwd time: 15.5767 / Avg. bwd time: 34.9522 / Avg. batch time: 421.2274 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-29 05:39:17,720 - INFO - Avg. fwd time: 14.0930 / Avg. bwd time: 29.1136 / Avg. batch time: 467.8554 (ms) / GPU bubble ratio: 26.12%
[rank1]:2025-10-29 05:39:17,766 - INFO - Avg. fwd time: 16.4333 / Avg. bwd time: 33.5825 / Avg. batch time: 521.9209 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-29 05:39:17,794 - INFO - Avg. fwd time: 14.8408 / Avg. bwd time: 27.2951 / Avg. batch time: 566.3430 (ms) / GPU bubble ratio: 40.48%
[rank0]:2025-10-29 05:40:50,473 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:40:52,175 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.63, [MB1] 0.63/0.63, [MB2] 0.00/0.00, [MB3] 0.59/0.59, [MB4] 0.97/0.97, [MB5] 1.00/1.00, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:40:52,095 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:40:52,212 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.02/0.02, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 72.70GiB(52.00%)  tps: 8,628  tflops: 402.43  mfu: 40.69%
[rank0]:2025-10-29 05:40:52,213 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 05:40:52,212 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 65.57GiB(46.90%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank2]:2025-10-29 05:40:52,212 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss:  0.9093  grad_norm:  0.0614  memory: 84.29GiB(60.29%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank3]:2025-10-29 05:40:52,213 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 05:40:52,207 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.77/0.77, [MB1] 0.13/0.13, [MB2] 0.80/0.80, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:40:52,213 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 73.44GiB(52.53%)  tps: 8,628  tflops: 402.41  mfu: 40.69%
[rank1]:2025-10-29 05:40:52,214 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 05:41:09,987 - INFO - validate step: 200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 23,045
[rank2]:2025-10-29 05:41:10,039 - INFO - validate step: 200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 22,977
[rank3]:2025-10-29 05:41:10,055 - INFO - validate step: 200  loss:  0.2354  memory: 84.29GiB(60.29%)  tps: 22,958
[rank1]:2025-10-29 05:41:10,024 - INFO - validate step: 200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 22,998
[rank0]:2025-10-29 05:41:10,129 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0541_stage0_step200.svg
[rank2]:2025-10-29 05:41:10,128 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0541_stage2_step200.svg
[rank1]:2025-10-29 05:41:10,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0541_stage1_step200.svg
[rank3]:2025-10-29 05:41:10,239 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0541_real_step200_rank3.svg
[rank3]:> Batch Time: 526.34 ms, GPU Bubble Ratio: 34.81%, 28.38%, 38.11%, 26.84%
[rank3]:2025-10-29 05:41:10,305 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0541_stage3_step200.svg
[rank0]:2025-10-29 05:41:10,254 - INFO - Avg. fwd time: 15.0188 / Avg. bwd time: 24.6771 / Avg. batch time: 541.4354 (ms) / GPU bubble ratio: 41.35%
[rank2]:2025-10-29 05:41:10,598 - INFO - Avg. fwd time: 14.3098 / Avg. bwd time: 27.1018 / Avg. batch time: 448.1811 (ms) / GPU bubble ratio: 26.08%
[rank3]:2025-10-29 05:41:10,575 - INFO - Avg. fwd time: 15.8186 / Avg. bwd time: 32.5804 / Avg. batch time: 403.7805 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-10-29 05:41:10,628 - INFO - Avg. fwd time: 16.7008 / Avg. bwd time: 31.1700 / Avg. batch time: 499.7156 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-29 05:42:31,395 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:42:33,027 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.63, [MB1] 0.63/0.63, [MB2] 0.00/0.00, [MB3] 0.59/0.59, [MB4] 0.97/0.97, [MB5] 1.00/1.00, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:42:33,047 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,869  tflops: 460.29  mfu: 46.54%
[rank3]:2025-10-29 05:42:33,012 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:42:33,048 - INFO -  step: 250  loss:  0.9115  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank1]:2025-10-29 05:42:33,048 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.77/0.77, [MB1] 0.13/0.13, [MB2] 0.80/0.80, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:42:33,048 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,867  tflops: 460.20  mfu: 46.53%
[rank0]:2025-10-29 05:42:33,048 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.02/0.02, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:42:33,049 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,863  tflops: 459.99  mfu: 46.51%
[rank0]:2025-10-29 05:42:33,145 - INFO - Avg. fwd time: 15.2099 / Avg. bwd time: 19.5513 / Avg. batch time: 511.0191 (ms) / GPU bubble ratio: 45.58%
[rank3]:2025-10-29 05:42:33,361 - INFO - Avg. fwd time: 16.1406 / Avg. bwd time: 29.7769 / Avg. batch time: 383.6417 (ms) / GPU bubble ratio: 4.25%
[rank2]:2025-10-29 05:42:33,382 - INFO - Avg. fwd time: 14.5655 / Avg. bwd time: 24.8428 / Avg. batch time: 425.6678 (ms) / GPU bubble ratio: 25.94%
[rank1]:2025-10-29 05:42:33,408 - INFO - Avg. fwd time: 17.0103 / Avg. bwd time: 28.6064 / Avg. batch time: 474.5775 (ms) / GPU bubble ratio: 23.10%
[rank0]:2025-10-29 05:43:54,195 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:43:55,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank2_trend_line.svg
[rank2]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.92/0.92, [MB2] 0.83/0.83, [MB3] 0.75/0.75, [MB4] 0.66/0.66, [MB5] 0.64/0.64, [MB6] 0.50/0.50, [MB7] 0.56/0.56
[rank3]:2025-10-29 05:43:55,983 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank3_trend_line.svg
[rank2]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.92/0.92, [MB2] 0.83/0.83, [MB3] 0.75/0.75, [MB4] 0.66/0.66, [MB5] 0.64/0.64, [MB6] 0.50/0.50, [MB7] 0.56/0.56
[rank2]:2025-10-29 05:43:56,039 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank1]:2025-10-29 05:43:56,032 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank1_trend_line.svg
[rank1]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:43:56,040 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,871  tflops: 460.38  mfu: 46.55%
[rank0]:2025-10-29 05:43:56,017 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0543_rank0_trend_line.svg
[rank0]:2025-10-29 05:43:56,038 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:43:56,039 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:43:56,039 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank3]:2025-10-29 05:43:56,228 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0543_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 369.78 ms, GPU Bubble Ratio: 42.28%, 23.35%, 30.85%, 26.14%
[rank3]:2025-10-29 05:43:56,229 - INFO - 	> Batch Time: 369.78 ms (Average Freeze Ratio: 0.71)
[rank3]:2025-10-29 05:43:56,229 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.96/0.96
[rank3]:2025-10-29 05:43:56,230 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.96/0.96
[rank3]:2025-10-29 05:43:56,233 - INFO -  step: 300  loss:  0.8355  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,848  tflops: 459.32  mfu: 46.44%
[rank2]:2025-10-29 05:43:56,299 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0543_stage2_step300.svg
[rank1]:2025-10-29 05:43:56,303 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0543_stage1_step300.svg
[rank0]:2025-10-29 05:43:56,299 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0543_stage0_step300.svg
[rank3]:2025-10-29 05:43:56,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0543_real_step300_rank3.svg
[rank3]:> Batch Time: 444.33 ms, GPU Bubble Ratio: 40.71%, 26.96%, 36.26%, 26.50%
[rank3]:2025-10-29 05:43:56,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0543_stage3_step300.svg
[rank2]:2025-10-29 05:43:56,823 - INFO - Avg. fwd time: 14.7328 / Avg. bwd time: 23.3579 / Avg. batch time: 410.9017 (ms) / GPU bubble ratio: 25.84%
[rank3]:2025-10-29 05:43:56,801 - INFO - Avg. fwd time: 16.3475 / Avg. bwd time: 27.9426 / Avg. batch time: 370.4422 (ms) / GPU bubble ratio: 4.35%
[rank1]:2025-10-29 05:43:56,847 - INFO - Avg. fwd time: 17.2133 / Avg. bwd time: 26.9127 / Avg. batch time: 457.9767 (ms) / GPU bubble ratio: 22.92%
[rank0]:2025-10-29 05:43:56,852 - INFO - Avg. fwd time: 15.3335 / Avg. bwd time: 16.1333 / Avg. batch time: 490.9000 (ms) / GPU bubble ratio: 48.72%
[rank0]:2025-10-29 05:45:27,186 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:45:29,015 - INFO -  step: 350  loss:  0.8641  grad_norm:  0.0596  memory: 84.29GiB(60.29%)  tps: 8,829  tflops: 411.81  mfu: 41.64%
[rank1]:2025-10-29 05:45:29,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 8,811  tflops: 410.95  mfu: 41.55%
[rank0]:2025-10-29 05:45:29,014 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 8,811  tflops: 410.95  mfu: 41.55%
[rank2]:2025-10-29 05:45:29,022 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0596  memory: 65.57GiB(46.90%)  tps: 8,810  tflops: 410.91  mfu: 41.55%
[rank0]:2025-10-29 05:45:29,114 - INFO - Avg. fwd time: 15.4138 / Avg. bwd time: 14.0309 / Avg. batch time: 484.9678 (ms) / GPU bubble ratio: 51.43%
[rank2]:2025-10-29 05:45:29,392 - INFO - Avg. fwd time: 14.6879 / Avg. bwd time: 23.5923 / Avg. batch time: 408.5100 (ms) / GPU bubble ratio: 25.03%
[rank3]:2025-10-29 05:45:29,333 - INFO - Avg. fwd time: 16.4618 / Avg. bwd time: 26.9551 / Avg. batch time: 363.3476 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-10-29 05:45:29,408 - INFO - Avg. fwd time: 17.3321 / Avg. bwd time: 25.8054 / Avg. batch time: 454.2051 (ms) / GPU bubble ratio: 24.02%
[rank0]:2025-10-29 05:46:57,147 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:46:59,062 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank2_trend_line.svg
[rank1]:2025-10-29 05:46:59,084 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank1_trend_line.svg
[rank1]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 0.95/0.95, [MB4] 0.95/0.95, [MB5] 0.95/0.95, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:46:59,091 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,095  tflops: 424.17  mfu: 42.89%
[rank1]:2025-10-29 05:46:59,091 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:46:59,039 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank3_trend_line.svg
[rank0]:2025-10-29 05:46:59,084 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0546_rank0_trend_line.svg
[rank0]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:46:59,091 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,094  tflops: 424.17  mfu: 42.89%
[rank0]:2025-10-29 05:46:59,091 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 05:46:59,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:46:59,090 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0163  memory: 65.57GiB(46.90%)  tps: 9,095  tflops: 424.21  mfu: 42.89%
[rank2]:2025-10-29 05:46:59,090 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:46:59,286 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0546_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.23 ms, GPU Bubble Ratio: 54.02%, 24.04%, 28.74%, 25.70%
[rank3]:2025-10-29 05:46:59,286 - INFO - 	> Batch Time: 371.23 ms (Average Freeze Ratio: 0.77)
[rank3]:2025-10-29 05:46:59,287 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.98/0.98, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:46:59,292 - INFO -  step: 400  loss:  0.1114  grad_norm:  0.0163  memory: 84.29GiB(60.29%)  tps: 9,075  tflops: 423.24  mfu: 42.79%
[rank3]:2025-10-29 05:46:59,292 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:47:15,987 - INFO - validate step: 400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,243
[rank3]:2025-10-29 05:47:16,010 - INFO - validate step: 400  loss:  0.2307  memory: 84.29GiB(60.29%)  tps: 24,502
[rank0]:2025-10-29 05:47:15,950 - INFO - validate step: 400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,296
[rank2]:2025-10-29 05:47:16,003 - INFO - validate step: 400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,219
[rank2]:2025-10-29 05:47:16,087 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0547_stage2_step400.svg
[rank1]:2025-10-29 05:47:16,090 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0547_stage1_step400.svg
[rank0]:2025-10-29 05:47:16,089 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0547_stage0_step400.svg
[rank3]:2025-10-29 05:47:16,180 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0547_real_step400_rank3.svg
[rank3]:> Batch Time: 420.03 ms, GPU Bubble Ratio: 69.96%, 29.63%, 27.12%, 28.37%
[rank0]:2025-10-29 05:47:16,175 - INFO - Avg. fwd time: 15.4637 / Avg. bwd time: 12.1794 / Avg. batch time: 478.3093 (ms) / GPU bubble ratio: 53.77%
[rank3]:2025-10-29 05:47:16,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0547_stage3_step400.svg
[rank3]:2025-10-29 05:47:16,498 - INFO - Avg. fwd time: 16.5360 / Avg. bwd time: 26.0558 / Avg. batch time: 356.6458 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-29 05:47:16,550 - INFO - Avg. fwd time: 14.6529 / Avg. bwd time: 23.6541 / Avg. batch time: 405.0062 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-10-29 05:47:16,567 - INFO - Avg. fwd time: 17.4194 / Avg. bwd time: 24.8249 / Avg. batch time: 449.4699 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 05:48:32,095 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:48:33,645 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,551  tflops: 492.10  mfu: 49.76%
[rank1]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,549  tflops: 492.00  mfu: 49.75%
[rank3]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss:  0.1230  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,552  tflops: 492.15  mfu: 49.76%
[rank0]:2025-10-29 05:48:33,646 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,544  tflops: 491.76  mfu: 49.72%
[rank2]:2025-10-29 05:48:34,021 - INFO - Avg. fwd time: 14.6831 / Avg. bwd time: 22.8011 / Avg. batch time: 396.2199 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-10-29 05:48:34,045 - INFO - Avg. fwd time: 17.4138 / Avg. bwd time: 24.0794 / Avg. batch time: 439.9188 (ms) / GPU bubble ratio: 24.54%
[rank3]:2025-10-29 05:48:33,999 - INFO - Avg. fwd time: 16.5286 / Avg. bwd time: 25.1888 / Avg. batch time: 349.5580 (ms) / GPU bubble ratio: 4.53%
[rank0]:2025-10-29 05:48:34,050 - INFO - Avg. fwd time: 15.4380 / Avg. bwd time: 10.7596 / Avg. batch time: 467.2409 (ms) / GPU bubble ratio: 55.14%
[rank0]:2025-10-29 05:49:49,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank2]:2025-10-29 05:49:51,074 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank1]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,580  tflops: 493.45  mfu: 49.89%
[rank3]:2025-10-29 05:49:51,075 - INFO -  step: 500  loss:  0.1262  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,580  tflops: 493.46  mfu: 49.89%
[rank0]:2025-10-29 05:49:51,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0549_stage0_step500.svg
[rank2]:2025-10-29 05:49:51,146 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0549_stage2_step500.svg
[rank1]:2025-10-29 05:49:51,148 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0549_stage1_step500.svg
[rank3]:2025-10-29 05:49:51,258 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0549_real_step500_rank3.svg
[rank3]:> Batch Time: 390.43 ms, GPU Bubble Ratio: 68.03%, 25.05%, 28.09%, 24.77%
[rank0]:2025-10-29 05:49:51,231 - INFO - Avg. fwd time: 15.4187 / Avg. bwd time: 9.7823 / Avg. batch time: 459.4052 (ms) / GPU bubble ratio: 56.12%
[rank3]:2025-10-29 05:49:51,321 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0549_stage3_step500.svg
[rank3]:2025-10-29 05:49:51,562 - INFO - Avg. fwd time: 16.5234 / Avg. bwd time: 24.5880 / Avg. batch time: 344.6487 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 05:49:51,583 - INFO - Avg. fwd time: 14.7062 / Avg. bwd time: 22.1836 / Avg. batch time: 389.9383 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-10-29 05:49:51,609 - INFO - Avg. fwd time: 17.4105 / Avg. bwd time: 23.5690 / Avg. batch time: 433.1327 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 05:51:07,177 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:51:08,725 - INFO -  step: 550  loss:  0.1387  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,550  tflops: 492.06  mfu: 49.75%
[rank0]:2025-10-29 05:51:08,726 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,550  tflops: 492.04  mfu: 49.75%
[rank2]:2025-10-29 05:51:08,724 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank1]:2025-10-29 05:51:08,725 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank0]:2025-10-29 05:51:08,814 - INFO - Avg. fwd time: 15.4001 / Avg. bwd time: 8.8450 / Avg. batch time: 451.9827 (ms) / GPU bubble ratio: 57.09%
[rank3]:2025-10-29 05:51:09,014 - INFO - Avg. fwd time: 16.5185 / Avg. bwd time: 24.0149 / Avg. batch time: 339.9647 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-29 05:51:09,036 - INFO - Avg. fwd time: 14.7286 / Avg. bwd time: 21.5920 / Avg. batch time: 383.9987 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-10-29 05:51:09,061 - INFO - Avg. fwd time: 17.4085 / Avg. bwd time: 23.0827 / Avg. batch time: 426.7150 (ms) / GPU bubble ratio: 24.09%
[rank0]:2025-10-29 05:52:24,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:52:26,462 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank3_trend_line.svg
[rank0]:2025-10-29 05:52:26,508 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank0_trend_line.svg
[rank0]:2025-10-29 05:52:26,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank0]:2025-10-29 05:52:26,515 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 05:52:26,478 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank2_trend_line.svg
[rank2]:2025-10-29 05:52:26,514 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.78/0.78, [MB1] 0.78/0.78, [MB2] 0.78/0.78, [MB3] 0.78/0.78, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,531  tflops: 491.16  mfu: 49.66%
[rank2]:2025-10-29 05:52:26,516 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 05:52:26,497 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0552_rank1_trend_line.svg
[rank1]:2025-10-29 05:52:26,513 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:52:26,515 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank1]:2025-10-29 05:52:26,515 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:52:26,701 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0552_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 361.91 ms, GPU Bubble Ratio: 59.97%, 23.86%, 29.29%, 25.07%
[rank3]:2025-10-29 05:52:26,701 - INFO - 	> Batch Time: 361.91 ms (Average Freeze Ratio: 0.71)
[rank3]:2025-10-29 05:52:26,701 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:52:26,706 - INFO -  step: 600  loss:  0.1042  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank3]:2025-10-29 05:52:26,706 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:52:43,415 - INFO - validate step: 600  loss:  0.2321  memory: 84.29GiB(60.29%)  tps: 24,514
[rank0]:2025-10-29 05:52:43,351 - INFO - validate step: 600  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,330
[rank2]:2025-10-29 05:52:43,405 - INFO - validate step: 600  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,253
[rank1]:2025-10-29 05:52:43,389 - INFO - validate step: 600  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,275
[rank0]:2025-10-29 05:52:43,490 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0552_stage0_step600.svg
[rank2]:2025-10-29 05:52:43,490 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0552_stage2_step600.svg
[rank1]:2025-10-29 05:52:43,489 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0552_stage1_step600.svg
[rank3]:2025-10-29 05:52:43,597 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0552_real_step600_rank3.svg
[rank3]:> Batch Time: 379.78 ms, GPU Bubble Ratio: 67.42%, 23.43%, 33.87%, 23.88%
[rank3]:2025-10-29 05:52:43,662 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0552_stage3_step600.svg
[rank3]:2025-10-29 05:52:43,971 - INFO - Avg. fwd time: 16.5135 / Avg. bwd time: 23.5393 / Avg. batch time: 336.0713 (ms) / GPU bubble ratio: 4.66%
[rank0]:2025-10-29 05:52:44,025 - INFO - Avg. fwd time: 15.3830 / Avg. bwd time: 8.0717 / Avg. batch time: 445.8346 (ms) / GPU bubble ratio: 57.91%
[rank2]:2025-10-29 05:52:43,994 - INFO - Avg. fwd time: 14.7459 / Avg. bwd time: 21.1035 / Avg. batch time: 379.0682 (ms) / GPU bubble ratio: 24.34%
[rank1]:2025-10-29 05:52:44,018 - INFO - Avg. fwd time: 17.4050 / Avg. bwd time: 22.6809 / Avg. batch time: 421.3948 (ms) / GPU bubble ratio: 23.90%
[rank0]:2025-10-29 05:54:36,227 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:54:38,519 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,116  tflops: 331.91  mfu: 33.56%
[rank1]:2025-10-29 05:54:38,519 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,115  tflops: 331.87  mfu: 33.56%
[rank3]:2025-10-29 05:54:38,520 - INFO -  step: 650  loss:  0.0855  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,117  tflops: 331.94  mfu: 33.56%
[rank0]:2025-10-29 05:54:38,546 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0762  memory: 72.70GiB(52.00%)  tps: 7,111  tflops: 331.68  mfu: 33.54%
[rank2]:2025-10-29 05:54:38,859 - INFO - Avg. fwd time: 14.7617 / Avg. bwd time: 20.7457 / Avg. batch time: 376.7287 (ms) / GPU bubble ratio: 24.60%
[rank3]:2025-10-29 05:54:38,838 - INFO - Avg. fwd time: 16.5114 / Avg. bwd time: 23.1890 / Avg. batch time: 333.2161 (ms) / GPU bubble ratio: 4.69%
[rank1]:2025-10-29 05:54:38,918 - INFO - Avg. fwd time: 17.3872 / Avg. bwd time: 22.3587 / Avg. batch time: 422.8919 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-29 05:54:39,040 - INFO - Avg. fwd time: 15.2713 / Avg. bwd time: 10.2044 / Avg. batch time: 453.7027 (ms) / GPU bubble ratio: 55.08%
[rank0]:2025-10-29 05:56:31,470 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:56:33,780 - INFO -  step: 700  loss:  0.0993  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,108  tflops: 331.50  mfu: 33.52%
[rank0]:2025-10-29 05:56:33,806 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0977  memory: 72.70GiB(52.00%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank1]:2025-10-29 05:56:33,779 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank2]:2025-10-29 05:56:33,779 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank0]:2025-10-29 05:56:33,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0556_stage0_step700.svg
[rank1]:2025-10-29 05:56:33,882 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0556_stage1_step700.svg
[rank2]:2025-10-29 05:56:33,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0556_stage2_step700.svg
[rank3]:2025-10-29 05:56:33,991 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0556_real_step700_rank3.svg
[rank3]:> Batch Time: 376.73 ms, GPU Bubble Ratio: 67.41%, 23.31%, 33.69%, 23.81%
[rank3]:2025-10-29 05:56:34,060 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0556_stage3_step700.svg
[rank3]:2025-10-29 05:56:34,305 - INFO - Avg. fwd time: 16.5085 / Avg. bwd time: 22.8401 / Avg. batch time: 330.3650 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-29 05:56:34,326 - INFO - Avg. fwd time: 14.7782 / Avg. bwd time: 20.3890 / Avg. batch time: 374.3996 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-10-29 05:56:34,384 - INFO - Avg. fwd time: 17.3658 / Avg. bwd time: 22.0355 / Avg. batch time: 424.4242 (ms) / GPU bubble ratio: 25.73%
[rank0]:2025-10-29 05:56:34,505 - INFO - Avg. fwd time: 15.1599 / Avg. bwd time: 12.3520 / Avg. batch time: 461.6534 (ms) / GPU bubble ratio: 52.32%
[rank0]:2025-10-29 05:58:26,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:58:29,244 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1491  memory: 72.70GiB(52.00%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank1]:2025-10-29 05:58:29,216 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank2]:2025-10-29 05:58:29,216 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,097  tflops: 330.98  mfu: 33.47%
[rank3]:2025-10-29 05:58:29,218 - INFO -  step: 750  loss:  0.1311  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,097  tflops: 330.99  mfu: 33.47%
[rank3]:2025-10-29 05:58:29,603 - INFO - Avg. fwd time: 16.5071 / Avg. bwd time: 22.5430 / Avg. batch time: 327.9459 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 05:58:29,632 - INFO - Avg. fwd time: 14.7933 / Avg. bwd time: 20.0831 / Avg. batch time: 372.4575 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 05:58:29,712 - INFO - Avg. fwd time: 17.3479 / Avg. bwd time: 21.7573 / Avg. batch time: 425.7989 (ms) / GPU bubble ratio: 26.53%
[rank0]:2025-10-29 05:58:29,811 - INFO - Avg. fwd time: 15.0654 / Avg. bwd time: 14.1993 / Avg. batch time: 468.5505 (ms) / GPU bubble ratio: 50.03%
[rank0]:2025-10-29 06:00:22,174 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:00:24,808 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank3_trend_line.svg
[rank1]:2025-10-29 06:00:24,820 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank1_trend_line.svg
[rank2]:2025-10-29 06:00:24,803 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank2_trend_line.svg
[rank0]:2025-10-29 06:00:24,898 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0600_rank0_trend_line.svg
[rank0]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:00:24,905 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1498  memory: 72.70GiB(52.00%)  tps: 7,083  tflops: 330.34  mfu: 33.40%
[rank0]:2025-10-29 06:00:24,905 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:00:24,906 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,081  tflops: 330.26  mfu: 33.39%
[rank1]:2025-10-29 06:00:24,906 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 06:00:24,904 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.72/0.72, [MB1] 0.72/0.72, [MB2] 0.72/0.72, [MB3] 0.72/0.72, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:00:24,906 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,081  tflops: 330.26  mfu: 33.39%
[rank2]:2025-10-29 06:00:24,906 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 06:00:25,100 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0600_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 359.24 ms, GPU Bubble Ratio: 36.67%, 23.88%, 29.73%, 24.90%
[rank3]:2025-10-29 06:00:25,101 - INFO - 	> Batch Time: 359.24 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 06:00:25,101 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:00:25,106 - INFO -  step: 800  loss:  0.1166  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,069  tflops: 329.70  mfu: 33.34%
[rank3]:2025-10-29 06:00:25,106 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:00:41,568 - INFO - validate step: 800  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,583
[rank3]:2025-10-29 06:00:41,626 - INFO - validate step: 800  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,797
[rank1]:2025-10-29 06:00:41,597 - INFO - validate step: 800  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,540
[rank2]:2025-10-29 06:00:41,613 - INFO - validate step: 800  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,517
[rank2]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0600_stage2_step800.svg
[rank0]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0600_stage0_step800.svg
[rank1]:2025-10-29 06:00:41,703 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0600_stage1_step800.svg
[rank3]:2025-10-29 06:00:41,808 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0600_real_step800_rank3.svg
[rank3]:> Batch Time: 374.22 ms, GPU Bubble Ratio: 67.40%, 23.19%, 33.45%, 23.84%
[rank3]:2025-10-29 06:00:41,877 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0600_stage3_step800.svg
[rank3]:2025-10-29 06:00:42,125 - INFO - Avg. fwd time: 16.5050 / Avg. bwd time: 22.3193 / Avg. batch time: 326.1169 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 06:00:42,146 - INFO - Avg. fwd time: 14.8037 / Avg. bwd time: 19.8527 / Avg. batch time: 370.9528 (ms) / GPU bubble ratio: 25.26%
[rank1]:2025-10-29 06:00:42,206 - INFO - Avg. fwd time: 17.3327 / Avg. bwd time: 21.5481 / Avg. batch time: 426.7927 (ms) / GPU bubble ratio: 27.12%
[rank0]:2025-10-29 06:00:42,323 - INFO - Avg. fwd time: 14.9928 / Avg. bwd time: 15.5899 / Avg. batch time: 473.7020 (ms) / GPU bubble ratio: 48.35%
[rank0]:2025-10-29 06:01:58,111 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:01:59,668 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,495  tflops: 489.50  mfu: 49.49%
[rank3]:2025-10-29 06:01:59,670 - INFO -  step: 850  loss:  0.1418  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,497  tflops: 489.58  mfu: 49.50%
[rank0]:2025-10-29 06:01:59,669 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,489  tflops: 489.21  mfu: 49.46%
[rank1]:2025-10-29 06:01:59,670 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,493  tflops: 489.39  mfu: 49.48%
[rank0]:2025-10-29 06:01:59,754 - INFO - Avg. fwd time: 15.0028 / Avg. bwd time: 14.8526 / Avg. batch time: 469.1115 (ms) / GPU bubble ratio: 49.09%
[rank2]:2025-10-29 06:01:59,976 - INFO - Avg. fwd time: 14.8159 / Avg. bwd time: 19.6163 / Avg. batch time: 368.4449 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 06:01:59,955 - INFO - Avg. fwd time: 16.5072 / Avg. bwd time: 22.0901 / Avg. batch time: 324.2773 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 06:02:00,002 - INFO - Avg. fwd time: 17.3351 / Avg. bwd time: 21.3559 / Avg. batch time: 423.5388 (ms) / GPU bubble ratio: 26.92%
[rank0]:2025-10-29 06:03:15,736 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank1]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank2]:2025-10-29 06:03:17,272 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,556  tflops: 492.34  mfu: 49.78%
[rank2]:2025-10-29 06:03:17,342 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0603_stage2_step900.svg
[rank3]:2025-10-29 06:03:17,273 - INFO -  step: 900  loss:  0.1267  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,556  tflops: 492.35  mfu: 49.78%
[rank0]:2025-10-29 06:03:17,345 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0603_stage0_step900.svg
[rank1]:2025-10-29 06:03:17,341 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0603_stage1_step900.svg
[rank3]:2025-10-29 06:03:17,460 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0603_real_step900_rank3.svg
[rank3]:> Batch Time: 372.67 ms, GPU Bubble Ratio: 67.25%, 22.92%, 33.28%, 23.92%
[rank3]:2025-10-29 06:03:17,522 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0603_stage3_step900.svg
[rank3]:2025-10-29 06:03:17,829 - INFO - Avg. fwd time: 16.5078 / Avg. bwd time: 21.8876 / Avg. batch time: 322.6435 (ms) / GPU bubble ratio: 4.80%
[rank0]:2025-10-29 06:03:17,883 - INFO - Avg. fwd time: 15.0167 / Avg. bwd time: 13.9866 / Avg. batch time: 464.0771 (ms) / GPU bubble ratio: 50.00%
[rank1]:2025-10-29 06:03:17,877 - INFO - Avg. fwd time: 17.3400 / Avg. bwd time: 21.1908 / Avg. batch time: 420.2401 (ms) / GPU bubble ratio: 26.65%
[rank2]:2025-10-29 06:03:17,852 - INFO - Avg. fwd time: 14.8257 / Avg. bwd time: 19.4076 / Avg. batch time: 366.1195 (ms) / GPU bubble ratio: 25.20%
[rank0]:2025-10-29 06:04:33,522 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank1]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank2]:2025-10-29 06:04:35,069 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,530  tflops: 491.13  mfu: 49.66%
[rank3]:2025-10-29 06:04:35,070 - INFO -  step: 950  loss:  0.1541  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,530  tflops: 491.14  mfu: 49.66%
[rank0]:2025-10-29 06:04:35,156 - INFO - Avg. fwd time: 15.0275 / Avg. bwd time: 13.3210 / Avg. batch time: 460.1735 (ms) / GPU bubble ratio: 50.72%
[rank2]:2025-10-29 06:04:35,379 - INFO - Avg. fwd time: 14.8334 / Avg. bwd time: 19.2472 / Avg. batch time: 364.3120 (ms) / GPU bubble ratio: 25.16%
[rank3]:2025-10-29 06:04:35,358 - INFO - Avg. fwd time: 16.5093 / Avg. bwd time: 21.7324 / Avg. batch time: 321.3986 (ms) / GPU bubble ratio: 4.81%
[rank1]:2025-10-29 06:04:35,404 - INFO - Avg. fwd time: 17.3438 / Avg. bwd time: 21.0627 / Avg. batch time: 417.6718 (ms) / GPU bubble ratio: 26.44%
[rank0]:2025-10-29 06:05:51,093 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank1]:2025-10-29 06:05:52,641 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss:  0.1268  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,561  tflops: 492.56  mfu: 49.80%
[rank3]:2025-10-29 06:05:52,642 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:05:52,640 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank2]:2025-10-29 06:05:52,640 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 06:05:52,641 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,561  tflops: 492.55  mfu: 49.80%
[rank0]:2025-10-29 06:05:52,641 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 06:06:09,382 - INFO - validate step: 1000  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,467
[rank1]:2025-10-29 06:06:09,421 - INFO - validate step: 1000  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,411
[rank3]:2025-10-29 06:06:09,446 - INFO - validate step: 1000  loss:  0.2341  memory: 84.29GiB(60.29%)  tps: 24,376
[rank2]:2025-10-29 06:06:09,437 - INFO - validate step: 1000  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,386
[rank0]:2025-10-29 06:06:09,521 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0606_stage0_step1000.svg
[rank1]:2025-10-29 06:06:09,522 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0606_stage1_step1000.svg
[rank2]:2025-10-29 06:06:09,520 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0606_stage2_step1000.svg
[rank0]:2025-10-29 06:06:09,608 - INFO - Avg. fwd time: 15.0375 / Avg. bwd time: 12.6202 / Avg. batch time: 456.0439 (ms) / GPU bubble ratio: 51.48%
[rank3]:2025-10-29 06:06:09,628 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0606_real_step1000_rank3.svg
[rank3]:> Batch Time: 372.16 ms, GPU Bubble Ratio: 67.20%, 22.82%, 33.25%, 23.96%
[rank3]:2025-10-29 06:06:09,691 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0606_stage3_step1000.svg
[rank3]:2025-10-29 06:06:09,934 - INFO - Avg. fwd time: 16.5089 / Avg. bwd time: 21.5680 / Avg. batch time: 320.0635 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 06:06:09,955 - INFO - Avg. fwd time: 14.8403 / Avg. bwd time: 19.0785 / Avg. batch time: 362.3837 (ms) / GPU bubble ratio: 25.12%
[rank1]:2025-10-29 06:06:09,983 - INFO - Avg. fwd time: 17.3456 / Avg. bwd time: 20.9283 / Avg. batch time: 414.9485 (ms) / GPU bubble ratio: 26.21%
[rank0]:2025-10-29 06:07:25,706 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss:  0.1331  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,528  tflops: 491.03  mfu: 49.65%
[rank2]:2025-10-29 06:07:27,258 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank0]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank1]:2025-10-29 06:07:27,259 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,524  tflops: 490.86  mfu: 49.63%
[rank3]:2025-10-29 06:07:27,618 - INFO - Avg. fwd time: 16.5093 / Avg. bwd time: 21.4204 / Avg. batch time: 318.8725 (ms) / GPU bubble ratio: 4.84%
[rank2]:2025-10-29 06:07:27,642 - INFO - Avg. fwd time: 14.8471 / Avg. bwd time: 18.9266 / Avg. batch time: 360.6902 (ms) / GPU bubble ratio: 25.09%
[rank0]:2025-10-29 06:07:27,676 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 11.9895 / Avg. batch time: 452.3726 (ms) / GPU bubble ratio: 52.19%
[rank1]:2025-10-29 06:07:27,668 - INFO - Avg. fwd time: 17.3473 / Avg. bwd time: 20.8073 / Avg. batch time: 412.5403 (ms) / GPU bubble ratio: 26.01%
[rank0]:2025-10-29 06:08:43,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank1]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank3]:2025-10-29 06:08:44,882 - INFO -  step: 1100  loss:  0.1016  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,554  tflops: 492.23  mfu: 49.77%
[rank2]:2025-10-29 06:08:44,881 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank0]:2025-10-29 06:08:44,954 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0608_stage0_step1100.svg
[rank1]:2025-10-29 06:08:44,957 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0608_stage1_step1100.svg
[rank2]:2025-10-29 06:08:44,954 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0608_stage2_step1100.svg
[rank0]:2025-10-29 06:08:45,040 - INFO - Avg. fwd time: 15.0545 / Avg. bwd time: 11.4971 / Avg. batch time: 449.4882 (ms) / GPU bubble ratio: 52.74%
[rank3]:2025-10-29 06:08:45,062 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0608_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.79 ms, GPU Bubble Ratio: 67.19%, 22.74%, 33.22%, 23.97%
[rank3]:2025-10-29 06:08:45,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0608_stage3_step1100.svg
[rank3]:2025-10-29 06:08:45,369 - INFO - Avg. fwd time: 16.5101 / Avg. bwd time: 21.3056 / Avg. batch time: 317.9494 (ms) / GPU bubble ratio: 4.85%
[rank2]:2025-10-29 06:08:45,389 - INFO - Avg. fwd time: 14.8527 / Avg. bwd time: 18.8079 / Avg. batch time: 359.3496 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-10-29 06:08:45,416 - INFO - Avg. fwd time: 17.3505 / Avg. bwd time: 20.7132 / Avg. batch time: 410.6431 (ms) / GPU bubble ratio: 25.85%
[rank0]:2025-10-29 06:10:01,116 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:10:02,678 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank3]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss:  0.1222  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,530  tflops: 491.13  mfu: 49.66%
[rank0]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank1]:2025-10-29 06:10:02,679 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,530  tflops: 491.12  mfu: 49.66%
[rank0]:2025-10-29 06:10:02,766 - INFO - Avg. fwd time: 15.0629 / Avg. bwd time: 10.9713 / Avg. batch time: 446.4269 (ms) / GPU bubble ratio: 53.35%
[rank2]:2025-10-29 06:10:02,993 - INFO - Avg. fwd time: 14.8584 / Avg. bwd time: 18.6810 / Avg. batch time: 357.9422 (ms) / GPU bubble ratio: 25.04%
[rank3]:2025-10-29 06:10:02,972 - INFO - Avg. fwd time: 16.5105 / Avg. bwd time: 21.1832 / Avg. batch time: 316.9609 (ms) / GPU bubble ratio: 4.86%
[rank1]:2025-10-29 06:10:03,018 - INFO - Avg. fwd time: 17.3530 / Avg. bwd time: 20.6122 / Avg. batch time: 408.6364 (ms) / GPU bubble ratio: 25.67%
[rank0]:2025-10-29 06:11:18,732 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank0]:2025-10-29 06:11:20,297 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank1]:2025-10-29 06:11:20,298 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 06:11:20,296 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,554  tflops: 492.25  mfu: 49.77%
[rank2]:2025-10-29 06:11:20,296 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 06:11:20,297 - INFO -  step: 1200  loss:  0.1056  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,554  tflops: 492.26  mfu: 49.77%
[rank3]:2025-10-29 06:11:20,297 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:11:36,987 - INFO - validate step: 1200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,542
[rank0]:2025-10-29 06:11:36,988 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:11:36,993 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-29 06:11:37,025 - INFO - validate step: 1200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,487
[rank1]:2025-10-29 06:11:37,025 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:11:37,041 - INFO - validate step: 1200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,462
[rank2]:2025-10-29 06:11:37,041 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:11:37,052 - INFO - validate step: 1200  loss:  0.2356  memory: 84.29GiB(60.29%)  tps: 24,448
[rank3]:2025-10-29 06:11:37,053 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:11:49,179 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.15 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank2]:2025-10-29 06:11:51,912 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.87 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 06:11:53,701 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.65 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 06:11:55,394 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 06:11:55,400 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.41 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 06:11:55,498 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0611_stage2_step1200.svg
[rank0]:2025-10-29 06:11:55,531 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0611_stage0_step1200.svg
[rank0]:2025-10-29 06:11:55,541 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 06:11:55,491 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0611_stage1_step1200.svg
[rank1]:2025-10-29 06:11:55,498 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 06:11:55,509 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 06:11:55,605 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0611_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.60 ms, GPU Bubble Ratio: 67.19%, 22.70%, 33.21%, 23.99%
[rank3]:2025-10-29 06:11:55,672 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0611_stage3_step1200.svg
[rank3]:2025-10-29 06:11:55,684 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 06:11:56,001 - INFO - Avg. fwd time: 16.5120 / Avg. bwd time: 21.0721 / Avg. batch time: 316.0737 (ms) / GPU bubble ratio: 4.87%
[rank1]:2025-10-29 06:11:56,053 - INFO - Avg. fwd time: 17.3564 / Avg. bwd time: 20.5196 / Avg. batch time: 406.8139 (ms) / GPU bubble ratio: 25.52%
[rank2]:2025-10-29 06:11:56,027 - INFO - Avg. fwd time: 14.8645 / Avg. bwd time: 18.5654 / Avg. batch time: 356.6682 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 06:11:56,063 - INFO - Avg. fwd time: 15.0715 / Avg. bwd time: 10.4916 / Avg. batch time: 443.6439 (ms) / GPU bubble ratio: 53.90%
[rank0]:2025-10-29 06:13:20,535 - INFO - [GC] Peforming periodical GC collection 2.13 seconds
[rank0]:2025-10-29 06:13:22,194 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 7,787  tflops: 363.17  mfu: 36.72%
[rank1]:2025-10-29 06:13:22,193 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 7,789  tflops: 363.30  mfu: 36.73%
[rank2]:2025-10-29 06:13:22,192 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 7,791  tflops: 363.36  mfu: 36.74%
[rank3]:2025-10-29 06:13:22,194 - INFO -  step: 1250  loss:  0.8492  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 7,792  tflops: 363.40  mfu: 36.74%
[rank0]:2025-10-29 06:13:22,297 - INFO - Avg. fwd time: 15.1035 / Avg. bwd time: 10.1126 / Avg. batch time: 442.1798 (ms) / GPU bubble ratio: 54.38%
[rank2]:2025-10-29 06:13:22,531 - INFO - Avg. fwd time: 14.8900 / Avg. bwd time: 18.4862 / Avg. batch time: 356.3756 (ms) / GPU bubble ratio: 25.08%
[rank3]:2025-10-29 06:13:22,509 - INFO - Avg. fwd time: 16.5429 / Avg. bwd time: 21.0223 / Avg. batch time: 315.9915 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:13:22,556 - INFO - Avg. fwd time: 17.3842 / Avg. bwd time: 20.4691 / Avg. batch time: 406.0836 (ms) / GPU bubble ratio: 25.43%
[rank0]:2025-10-29 06:14:43,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:14:45,042 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank3]:2025-10-29 06:14:45,044 - INFO -  step: 1300  loss:  0.8770  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank0]:2025-10-29 06:14:45,043 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank1]:2025-10-29 06:14:45,044 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank2]:2025-10-29 06:14:45,121 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0614_stage2_step1300.svg
[rank0]:2025-10-29 06:14:45,122 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0614_stage0_step1300.svg
[rank1]:2025-10-29 06:14:45,123 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0614_stage1_step1300.svg
[rank3]:2025-10-29 06:14:45,230 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0614_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.50 ms, GPU Bubble Ratio: 67.16%, 22.73%, 33.25%, 23.99%
[rank0]:2025-10-29 06:14:45,221 - INFO - Avg. fwd time: 15.1365 / Avg. bwd time: 9.7036 / Avg. batch time: 440.3093 (ms) / GPU bubble ratio: 54.87%
[rank3]:2025-10-29 06:14:45,297 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0614_stage3_step1300.svg
[rank1]:2025-10-29 06:14:45,613 - INFO - Avg. fwd time: 17.4161 / Avg. bwd time: 20.4042 / Avg. batch time: 405.0128 (ms) / GPU bubble ratio: 25.30%
[rank2]:2025-10-29 06:14:45,586 - INFO - Avg. fwd time: 14.9173 / Avg. bwd time: 18.4005 / Avg. batch time: 355.7761 (ms) / GPU bubble ratio: 25.08%
[rank3]:2025-10-29 06:14:45,564 - INFO - Avg. fwd time: 16.5761 / Avg. bwd time: 20.9547 / Avg. batch time: 315.7105 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 06:16:06,315 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank2]:2025-10-29 06:16:07,977 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank3]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss:  0.8536  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,878  tflops: 460.71  mfu: 46.58%
[rank0]:2025-10-29 06:16:07,978 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,878  tflops: 460.70  mfu: 46.58%
[rank2]:2025-10-29 06:16:08,388 - INFO - Avg. fwd time: 14.9424 / Avg. bwd time: 18.3217 / Avg. batch time: 355.2449 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-29 06:16:08,362 - INFO - Avg. fwd time: 16.6068 / Avg. bwd time: 20.8919 / Avg. batch time: 315.4488 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 06:16:08,425 - INFO - Avg. fwd time: 15.1669 / Avg. bwd time: 9.3265 / Avg. batch time: 438.6111 (ms) / GPU bubble ratio: 55.33%
[rank1]:2025-10-29 06:16:08,415 - INFO - Avg. fwd time: 17.4464 / Avg. bwd time: 20.3457 / Avg. batch time: 404.0524 (ms) / GPU bubble ratio: 25.17%
[rank0]:2025-10-29 06:17:29,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank0]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank1]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 06:17:30,834 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank2]:2025-10-29 06:17:30,834 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 06:17:30,835 - INFO -  step: 1400  loss:  0.9120  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank3]:2025-10-29 06:17:30,835 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 06:17:47,608 - INFO - validate step: 1400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,421
[rank1]:2025-10-29 06:17:47,646 - INFO - validate step: 1400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,365
[rank2]:2025-10-29 06:17:47,661 - INFO - validate step: 1400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,342
[rank3]:2025-10-29 06:17:47,674 - INFO - validate step: 1400  loss:  0.2334  memory: 84.29GiB(60.29%)  tps: 24,326
[rank0]:2025-10-29 06:17:47,756 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0617_stage0_step1400.svg
[rank1]:2025-10-29 06:17:47,758 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0617_stage1_step1400.svg
[rank2]:2025-10-29 06:17:47,756 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0617_stage2_step1400.svg
[rank0]:2025-10-29 06:17:47,858 - INFO - Avg. fwd time: 15.1906 / Avg. bwd time: 9.0258 / Avg. batch time: 437.2333 (ms) / GPU bubble ratio: 55.69%
[rank3]:2025-10-29 06:17:47,863 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0617_real_step1400_rank3.svg
[rank3]:> Batch Time: 373.55 ms, GPU Bubble Ratio: 67.14%, 22.78%, 33.32%, 23.99%
[rank3]:2025-10-29 06:17:47,930 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0617_stage3_step1400.svg
[rank3]:2025-10-29 06:17:48,201 - INFO - Avg. fwd time: 16.6310 / Avg. bwd time: 20.8420 / Avg. batch time: 315.2397 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:17:48,248 - INFO - Avg. fwd time: 17.4704 / Avg. bwd time: 20.2987 / Avg. batch time: 403.2631 (ms) / GPU bubble ratio: 25.07%
[rank2]:2025-10-29 06:17:48,223 - INFO - Avg. fwd time: 14.9620 / Avg. bwd time: 18.2586 / Avg. batch time: 354.8000 (ms) / GPU bubble ratio: 25.09%
[rank0]:2025-10-29 06:19:09,006 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:19:10,659 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,868  tflops: 460.27  mfu: 46.54%
[rank2]:2025-10-29 06:19:10,657 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,870  tflops: 460.36  mfu: 46.55%
[rank3]:2025-10-29 06:19:10,658 - INFO -  step: 1450  loss:  0.9425  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,872  tflops: 460.43  mfu: 46.56%
[rank0]:2025-10-29 06:19:10,658 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,864  tflops: 460.06  mfu: 46.52%
[rank0]:2025-10-29 06:19:10,759 - INFO - Avg. fwd time: 15.2169 / Avg. bwd time: 8.6986 / Avg. batch time: 435.7611 (ms) / GPU bubble ratio: 56.09%
[rank3]:2025-10-29 06:19:10,973 - INFO - Avg. fwd time: 16.6577 / Avg. bwd time: 20.7878 / Avg. batch time: 315.0156 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 06:19:11,020 - INFO - Avg. fwd time: 17.4970 / Avg. bwd time: 20.2478 / Avg. batch time: 402.4315 (ms) / GPU bubble ratio: 24.97%
[rank2]:2025-10-29 06:19:10,994 - INFO - Avg. fwd time: 14.9836 / Avg. bwd time: 18.1902 / Avg. batch time: 354.3420 (ms) / GPU bubble ratio: 25.10%
[rank0]:2025-10-29 06:20:31,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:20:33,387 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank2]:2025-10-29 06:20:33,386 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank1]:2025-10-29 06:20:33,388 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,902  tflops: 461.84  mfu: 46.70%
[rank3]:2025-10-29 06:20:33,388 - INFO -  step: 1500  loss:  0.8219  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,902  tflops: 461.85  mfu: 46.70%
[rank0]:2025-10-29 06:20:33,469 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0620_stage0_step1500.svg
[rank2]:2025-10-29 06:20:33,469 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0620_stage2_step1500.svg
[rank1]:2025-10-29 06:20:33,470 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0620_stage1_step1500.svg
[rank3]:2025-10-29 06:20:33,572 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0620_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.72 ms, GPU Bubble Ratio: 67.14%, 22.84%, 33.41%, 23.99%
[rank3]:2025-10-29 06:20:33,639 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0620_stage3_step1500.svg
[rank2]:2025-10-29 06:20:34,002 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 18.1266 / Avg. batch time: 353.9090 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:20:34,029 - INFO - Avg. fwd time: 17.5207 / Avg. bwd time: 20.2003 / Avg. batch time: 401.6525 (ms) / GPU bubble ratio: 24.87%
[rank3]:2025-10-29 06:20:33,976 - INFO - Avg. fwd time: 16.6819 / Avg. bwd time: 20.7372 / Avg. batch time: 314.8001 (ms) / GPU bubble ratio: 4.91%
[rank0]:2025-10-29 06:20:34,038 - INFO - Avg. fwd time: 15.2411 / Avg. bwd time: 8.3943 / Avg. batch time: 434.3871 (ms) / GPU bubble ratio: 56.47%
[rank0]:2025-10-29 06:21:54,734 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:21:56,387 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank1]:2025-10-29 06:21:56,388 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank3]:2025-10-29 06:21:56,389 - INFO -  step: 1550  loss:  0.8815  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,870  tflops: 460.34  mfu: 46.55%
[rank0]:2025-10-29 06:21:56,388 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,870  tflops: 460.33  mfu: 46.54%
[rank0]:2025-10-29 06:21:56,490 - INFO - Avg. fwd time: 15.2606 / Avg. bwd time: 8.1500 / Avg. batch time: 433.2704 (ms) / GPU bubble ratio: 56.77%
[rank3]:2025-10-29 06:21:56,704 - INFO - Avg. fwd time: 16.7019 / Avg. bwd time: 20.6967 / Avg. batch time: 314.6332 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 06:21:56,727 - INFO - Avg. fwd time: 15.0196 / Avg. bwd time: 18.0755 / Avg. batch time: 353.5501 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:21:56,751 - INFO - Avg. fwd time: 17.5410 / Avg. bwd time: 20.1622 / Avg. batch time: 401.0139 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 06:23:16,475 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:23:18,793 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank2_trend_line.svg
[rank1]:2025-10-29 06:23:18,882 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank1_trend_line.svg
[rank3]:2025-10-29 06:23:18,793 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank3_trend_line.svg
[rank0]:2025-10-29 06:23:18,844 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0623_rank0_trend_line.svg
[rank0]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:23:18,891 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 9,929  tflops: 463.11  mfu: 46.83%
[rank0]:2025-10-29 06:23:18,891 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.54/0.54, [MB1] 0.55/0.55, [MB2] 0.62/0.62, [MB3] 0.70/0.70, [MB4] 0.77/0.77, [MB5] 0.85/0.85, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:23:18,892 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 9,929  tflops: 463.10  mfu: 46.82%
[rank2]:2025-10-29 06:23:18,892 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 06:23:18,888 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:23:18,891 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 9,929  tflops: 463.11  mfu: 46.83%
[rank1]:2025-10-29 06:23:18,891 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 06:23:19,081 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0623_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.56 ms, GPU Bubble Ratio: 53.58%, 23.63%, 30.80%, 24.45%
[rank3]:2025-10-29 06:23:19,081 - INFO - 	> Batch Time: 357.56 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 06:23:19,082 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:23:19,088 - INFO -  step: 1600  loss:  0.1183  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 9,906  tflops: 462.01  mfu: 46.72%
[rank3]:2025-10-29 06:23:19,088 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 06:23:35,714 - INFO - validate step: 1600  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,348
[rank2]:2025-10-29 06:23:35,768 - INFO - validate step: 1600  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,272
[rank1]:2025-10-29 06:23:35,753 - INFO - validate step: 1600  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,292
[rank3]:2025-10-29 06:23:35,777 - INFO - validate step: 1600  loss:  0.2360  memory: 84.29GiB(60.29%)  tps: 24,546
[rank2]:2025-10-29 06:23:35,861 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0623_stage2_step1600.svg
[rank1]:2025-10-29 06:23:35,866 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0623_stage1_step1600.svg
[rank0]:2025-10-29 06:23:35,863 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0623_stage0_step1600.svg
[rank3]:2025-10-29 06:23:35,965 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0623_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.93 ms, GPU Bubble Ratio: 67.15%, 22.93%, 33.50%, 23.96%
[rank0]:2025-10-29 06:23:35,951 - INFO - Avg. fwd time: 15.2768 / Avg. bwd time: 7.8823 / Avg. batch time: 431.9550 (ms) / GPU bubble ratio: 57.11%
[rank3]:2025-10-29 06:23:36,036 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0623_stage3_step1600.svg
[rank3]:2025-10-29 06:23:36,287 - INFO - Avg. fwd time: 16.7181 / Avg. bwd time: 20.6480 / Avg. batch time: 314.3676 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 06:23:36,309 - INFO - Avg. fwd time: 15.0339 / Avg. bwd time: 18.0172 / Avg. batch time: 353.0687 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-10-29 06:23:36,333 - INFO - Avg. fwd time: 17.5574 / Avg. bwd time: 20.1177 / Avg. batch time: 400.2262 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-10-29 06:24:52,086 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:24:53,637 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,520  tflops: 490.67  mfu: 49.61%
[rank3]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss:  0.1127  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,521  tflops: 490.72  mfu: 49.62%
[rank1]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,518  tflops: 490.56  mfu: 49.60%
[rank0]:2025-10-29 06:24:53,638 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,513  tflops: 490.32  mfu: 49.58%
[rank2]:2025-10-29 06:24:54,025 - INFO - Avg. fwd time: 15.0326 / Avg. bwd time: 17.9542 / Avg. batch time: 352.2975 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-29 06:24:53,997 - INFO - Avg. fwd time: 16.7123 / Avg. bwd time: 20.5839 / Avg. batch time: 313.8001 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 06:24:54,053 - INFO - Avg. fwd time: 17.5527 / Avg. bwd time: 20.0667 / Avg. batch time: 399.1741 (ms) / GPU bubble ratio: 24.61%
[rank0]:2025-10-29 06:24:54,064 - INFO - Avg. fwd time: 15.2763 / Avg. bwd time: 7.6316 / Avg. batch time: 430.3977 (ms) / GPU bubble ratio: 57.42%
[rank0]:2025-10-29 06:26:09,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:26:11,304 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank3]:2025-10-29 06:26:11,306 - INFO -  step: 1700  loss:  0.1205  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank1]:2025-10-29 06:26:11,305 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank0]:2025-10-29 06:26:11,305 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank2]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0626_stage2_step1700.svg
[rank1]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0626_stage1_step1700.svg
[rank0]:2025-10-29 06:26:11,390 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0626_stage0_step1700.svg
[rank3]:2025-10-29 06:26:11,498 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0626_real_step1700_rank3.svg
[rank3]:> Batch Time: 375.07 ms, GPU Bubble Ratio: 67.12%, 22.82%, 33.42%, 23.99%
[rank0]:2025-10-29 06:26:11,478 - INFO - Avg. fwd time: 15.2751 / Avg. bwd time: 7.4291 / Avg. batch time: 429.1162 (ms) / GPU bubble ratio: 57.67%
[rank3]:2025-10-29 06:26:11,569 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0626_stage3_step1700.svg
[rank3]:2025-10-29 06:26:11,813 - INFO - Avg. fwd time: 16.7072 / Avg. bwd time: 20.5318 / Avg. batch time: 313.3360 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 06:26:11,834 - INFO - Avg. fwd time: 15.0311 / Avg. bwd time: 17.9033 / Avg. batch time: 351.6515 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 06:26:11,859 - INFO - Avg. fwd time: 17.5484 / Avg. bwd time: 20.0258 / Avg. batch time: 398.3021 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-10-29 06:27:27,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank2]:2025-10-29 06:27:29,126 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank3]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss:  0.1236  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,527  tflops: 490.98  mfu: 49.64%
[rank1]:2025-10-29 06:27:29,127 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank0]:2025-10-29 06:27:29,216 - INFO - Avg. fwd time: 15.2744 / Avg. bwd time: 7.2061 / Avg. batch time: 427.7242 (ms) / GPU bubble ratio: 57.95%
[rank2]:2025-10-29 06:27:29,441 - INFO - Avg. fwd time: 15.0297 / Avg. bwd time: 17.8475 / Avg. batch time: 350.9640 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 06:27:29,420 - INFO - Avg. fwd time: 16.7019 / Avg. bwd time: 20.4748 / Avg. batch time: 312.8290 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 06:27:29,467 - INFO - Avg. fwd time: 17.5443 / Avg. bwd time: 19.9801 / Avg. batch time: 397.3608 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 06:28:45,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:28:46,708 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank2]:2025-10-29 06:28:46,708 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 06:28:46,710 - INFO -  step: 1800  loss:  0.0989  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,559  tflops: 492.49  mfu: 49.80%
[rank3]:2025-10-29 06:28:46,710 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 06:28:46,709 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank1]:2025-10-29 06:28:46,709 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 06:28:46,709 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,559  tflops: 492.48  mfu: 49.80%
[rank0]:2025-10-29 06:28:46,709 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 06:29:03,496 - INFO - validate step: 1800  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,400
[rank2]:2025-10-29 06:29:03,549 - INFO - validate step: 1800  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,322
[rank3]:2025-10-29 06:29:03,559 - INFO - validate step: 1800  loss:  0.2342  memory: 84.29GiB(60.29%)  tps: 24,310
[rank1]:2025-10-29 06:29:03,533 - INFO - validate step: 1800  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,347
[rank2]:2025-10-29 06:29:03,645 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0629_stage2_step1800.svg
[rank1]:2025-10-29 06:29:03,646 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0629_stage1_step1800.svg
[rank0]:2025-10-29 06:29:03,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0629_stage0_step1800.svg
[rank3]:2025-10-29 06:29:03,750 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0629_real_step1800_rank3.svg
[rank3]:> Batch Time: 374.46 ms, GPU Bubble Ratio: 67.11%, 22.76%, 33.37%, 24.00%
[rank3]:2025-10-29 06:29:03,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0629_stage3_step1800.svg
[rank3]:2025-10-29 06:29:04,131 - INFO - Avg. fwd time: 16.6963 / Avg. bwd time: 20.4209 / Avg. batch time: 312.3459 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 06:29:04,186 - INFO - Avg. fwd time: 17.5396 / Avg. bwd time: 19.9374 / Avg. batch time: 396.4687 (ms) / GPU bubble ratio: 24.38%
[rank0]:2025-10-29 06:29:04,197 - INFO - Avg. fwd time: 15.2730 / Avg. bwd time: 6.9960 / Avg. batch time: 426.4079 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-10-29 06:29:04,157 - INFO - Avg. fwd time: 15.0280 / Avg. bwd time: 17.7946 / Avg. batch time: 350.3107 (ms) / GPU bubble ratio: 25.04%
[rank0]:2025-10-29 06:30:19,958 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:30:21,504 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,509  tflops: 490.13  mfu: 49.56%
[rank3]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss:  0.0795  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,510  tflops: 490.19  mfu: 49.56%
[rank1]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,506  tflops: 490.02  mfu: 49.55%
[rank0]:2025-10-29 06:30:21,505 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,501  tflops: 489.79  mfu: 49.52%
[rank0]:2025-10-29 06:30:21,594 - INFO - Avg. fwd time: 15.2728 / Avg. bwd time: 6.8255 / Avg. batch time: 425.3310 (ms) / GPU bubble ratio: 58.44%
[rank3]:2025-10-29 06:30:21,801 - INFO - Avg. fwd time: 16.6926 / Avg. bwd time: 20.3771 / Avg. batch time: 311.9604 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 06:30:21,847 - INFO - Avg. fwd time: 17.5365 / Avg. bwd time: 19.9023 / Avg. batch time: 395.7350 (ms) / GPU bubble ratio: 24.32%
[rank2]:2025-10-29 06:30:21,822 - INFO - Avg. fwd time: 15.0271 / Avg. bwd time: 17.7519 / Avg. batch time: 349.7720 (ms) / GPU bubble ratio: 25.03%
[rank0]:2025-10-29 06:31:37,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:31:39,257 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 06:31:39,257 - INFO -  step: 1900  loss:  0.0945  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,536  tflops: 491.41  mfu: 49.69%
[rank1]:2025-10-29 06:31:39,258 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank0]:2025-10-29 06:31:39,258 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank2]:2025-10-29 06:31:39,341 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0631_stage2_step1900.svg
[rank1]:2025-10-29 06:31:39,343 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0631_stage1_step1900.svg
[rank0]:2025-10-29 06:31:39,343 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0631_stage0_step1900.svg
[rank3]:2025-10-29 06:31:39,443 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0631_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.93 ms, GPU Bubble Ratio: 67.11%, 22.71%, 33.31%, 24.01%
[rank0]:2025-10-29 06:31:39,435 - INFO - Avg. fwd time: 15.2721 / Avg. bwd time: 6.6368 / Avg. batch time: 424.1405 (ms) / GPU bubble ratio: 58.68%
[rank3]:2025-10-29 06:31:39,512 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0631_stage3_step1900.svg
[rank3]:2025-10-29 06:31:39,761 - INFO - Avg. fwd time: 16.6882 / Avg. bwd time: 20.3285 / Avg. batch time: 311.5300 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 06:31:39,807 - INFO - Avg. fwd time: 17.5331 / Avg. bwd time: 19.8642 / Avg. batch time: 394.9249 (ms) / GPU bubble ratio: 24.24%
[rank2]:2025-10-29 06:31:39,782 - INFO - Avg. fwd time: 15.0258 / Avg. bwd time: 17.7046 / Avg. batch time: 349.1714 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-10-29 06:32:55,567 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:32:57,132 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:32:57,132 - INFO -  step: 1950  loss:  0.1212  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,520  tflops: 490.64  mfu: 49.61%
[rank1]:2025-10-29 06:32:57,133 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 06:32:57,133 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:32:57,525 - INFO - Avg. fwd time: 15.0249 / Avg. bwd time: 17.6597 / Avg. batch time: 348.6258 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-10-29 06:32:57,498 - INFO - Avg. fwd time: 16.6843 / Avg. bwd time: 20.2830 / Avg. batch time: 311.1285 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 06:32:57,554 - INFO - Avg. fwd time: 17.5302 / Avg. bwd time: 19.8277 / Avg. batch time: 394.1760 (ms) / GPU bubble ratio: 24.18%
[rank0]:2025-10-29 06:32:57,567 - INFO - Avg. fwd time: 15.2720 / Avg. bwd time: 6.4582 / Avg. batch time: 423.0331 (ms) / GPU bubble ratio: 58.91%
[rank0]:2025-10-29 06:34:13,287 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank0]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 06:34:14,850 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank2]:2025-10-29 06:34:14,851 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss:  0.1106  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank3]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 06:34:14,851 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,541  tflops: 491.62  mfu: 49.71%
[rank1]:2025-10-29 06:34:14,852 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 06:34:31,551 - INFO - validate step: 2000  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,529
[rank2]:2025-10-29 06:34:31,604 - INFO - validate step: 2000  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,449
[rank3]:2025-10-29 06:34:31,616 - INFO - validate step: 2000  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,434
[rank1]:2025-10-29 06:34:31,590 - INFO - validate step: 2000  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,470
[rank2]:2025-10-29 06:34:31,702 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0634_stage2_step2000.svg
[rank1]:2025-10-29 06:34:31,708 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0634_stage1_step2000.svg
[rank0]:2025-10-29 06:34:31,704 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0634_stage0_step2000.svg
[rank3]:2025-10-29 06:34:31,810 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0634_real_step2000_rank3.svg
[rank3]:> Batch Time: 373.63 ms, GPU Bubble Ratio: 67.11%, 22.68%, 33.29%, 24.03%
[rank0]:2025-10-29 06:34:31,795 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 6.3126 / Avg. batch time: 422.1076 (ms) / GPU bubble ratio: 59.09%
[rank3]:2025-10-29 06:34:31,882 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0634_stage3_step2000.svg
[rank3]:2025-10-29 06:34:32,134 - INFO - Avg. fwd time: 16.6802 / Avg. bwd time: 20.2455 / Avg. batch time: 310.7907 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 06:34:32,155 - INFO - Avg. fwd time: 15.0237 / Avg. bwd time: 17.6234 / Avg. batch time: 348.1561 (ms) / GPU bubble ratio: 24.98%
[rank1]:2025-10-29 06:34:32,181 - INFO - Avg. fwd time: 17.5276 / Avg. bwd time: 19.7985 / Avg. batch time: 393.5442 (ms) / GPU bubble ratio: 24.12%
[rank0]:2025-10-29 06:35:47,967 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,512  tflops: 490.28  mfu: 49.57%
[rank0]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,507  tflops: 490.03  mfu: 49.55%
[rank2]:2025-10-29 06:35:49,521 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,514  tflops: 490.37  mfu: 49.58%
[rank3]:2025-10-29 06:35:49,522 - INFO -  step: 2050  loss:  0.1565  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,516  tflops: 490.45  mfu: 49.59%
[rank0]:2025-10-29 06:35:49,615 - INFO - Avg. fwd time: 15.2717 / Avg. bwd time: 6.1509 / Avg. batch time: 421.1016 (ms) / GPU bubble ratio: 59.30%
[rank2]:2025-10-29 06:35:49,836 - INFO - Avg. fwd time: 15.0230 / Avg. bwd time: 17.5828 / Avg. batch time: 347.6617 (ms) / GPU bubble ratio: 24.97%
[rank3]:2025-10-29 06:35:49,816 - INFO - Avg. fwd time: 16.6767 / Avg. bwd time: 20.2041 / Avg. batch time: 310.4263 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 06:35:49,862 - INFO - Avg. fwd time: 17.5249 / Avg. bwd time: 19.7652 / Avg. batch time: 392.8637 (ms) / GPU bubble ratio: 24.07%
[rank0]:2025-10-29 06:37:05,615 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss:  0.1372  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,552  tflops: 492.15  mfu: 49.76%
[rank1]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank0]:2025-10-29 06:37:07,158 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank2]:2025-10-29 06:37:07,157 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,552  tflops: 492.14  mfu: 49.76%
[rank2]:2025-10-29 06:37:07,236 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0637_stage2_step2100.svg
[rank1]:2025-10-29 06:37:07,238 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0637_stage1_step2100.svg
[rank0]:2025-10-29 06:37:07,237 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0637_stage0_step2100.svg
[rank3]:2025-10-29 06:37:07,348 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0637_real_step2100_rank3.svg
[rank3]:> Batch Time: 373.39 ms, GPU Bubble Ratio: 67.11%, 22.67%, 33.29%, 24.04%
[rank3]:2025-10-29 06:37:07,411 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0637_stage3_step2100.svg
[rank3]:2025-10-29 06:37:07,721 - INFO - Avg. fwd time: 16.6730 / Avg. bwd time: 20.1649 / Avg. batch time: 310.0772 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 06:37:07,777 - INFO - Avg. fwd time: 17.5226 / Avg. bwd time: 19.7339 / Avg. batch time: 392.2179 (ms) / GPU bubble ratio: 24.01%
[rank0]:2025-10-29 06:37:07,788 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 5.9972 / Avg. batch time: 420.1470 (ms) / GPU bubble ratio: 59.50%
[rank2]:2025-10-29 06:37:07,748 - INFO - Avg. fwd time: 15.0220 / Avg. bwd time: 17.5441 / Avg. batch time: 347.1891 (ms) / GPU bubble ratio: 24.96%
[rank0]:2025-10-29 06:38:23,509 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:38:25,059 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank3]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss:  0.1780  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,516  tflops: 490.47  mfu: 49.59%
[rank1]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank0]:2025-10-29 06:38:25,060 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,516  tflops: 490.46  mfu: 49.59%
[rank0]:2025-10-29 06:38:25,153 - INFO - Avg. fwd time: 15.2714 / Avg. bwd time: 5.8715 / Avg. batch time: 419.3530 (ms) / GPU bubble ratio: 59.67%
[rank2]:2025-10-29 06:38:25,377 - INFO - Avg. fwd time: 15.0214 / Avg. bwd time: 17.5126 / Avg. batch time: 346.7908 (ms) / GPU bubble ratio: 24.95%
[rank3]:2025-10-29 06:38:25,357 - INFO - Avg. fwd time: 16.6701 / Avg. bwd time: 20.1328 / Avg. batch time: 309.7928 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 06:38:25,403 - INFO - Avg. fwd time: 17.5208 / Avg. bwd time: 19.7082 / Avg. batch time: 391.6772 (ms) / GPU bubble ratio: 23.96%
[rank0]:2025-10-29 06:39:41,118 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:39:42,668 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank2]:2025-10-29 06:39:42,668 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss:  0.1158  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,556  tflops: 492.32  mfu: 49.78%
[rank3]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank1]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 06:39:42,669 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,556  tflops: 492.31  mfu: 49.78%
[rank0]:2025-10-29 06:39:42,669 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:39:59,615 - INFO - validate step: 2200  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,171
[rank0]:2025-10-29 06:39:59,578 - INFO - validate step: 2200  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,224
[rank2]:2025-10-29 06:39:59,630 - INFO - validate step: 2200  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,148
[rank3]:2025-10-29 06:39:59,643 - INFO - validate step: 2200  loss:  0.2350  memory: 84.29GiB(60.29%)  tps: 24,133
[rank1]:2025-10-29 06:39:59,723 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0639_stage1_step2200.svg
[rank0]:2025-10-29 06:39:59,723 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0639_stage0_step2200.svg
[rank2]:2025-10-29 06:39:59,721 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0639_stage2_step2200.svg
[rank0]:2025-10-29 06:39:59,813 - INFO - Avg. fwd time: 15.2705 / Avg. bwd time: 5.7313 / Avg. batch time: 418.4569 (ms) / GPU bubble ratio: 59.85%
[rank3]:2025-10-29 06:39:59,838 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0639_real_step2200_rank3.svg
[rank3]:> Batch Time: 373.16 ms, GPU Bubble Ratio: 67.11%, 22.65%, 33.26%, 24.04%
[rank3]:2025-10-29 06:39:59,901 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0639_stage3_step2200.svg
[rank2]:2025-10-29 06:40:00,170 - INFO - Avg. fwd time: 15.0203 / Avg. bwd time: 17.4777 / Avg. batch time: 346.3375 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-10-29 06:40:00,150 - INFO - Avg. fwd time: 16.6659 / Avg. bwd time: 20.0968 / Avg. batch time: 309.4666 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:40:00,196 - INFO - Avg. fwd time: 17.5177 / Avg. bwd time: 19.6797 / Avg. batch time: 391.0643 (ms) / GPU bubble ratio: 23.91%
[rank0]:2025-10-29 06:41:15,896 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 06:41:17,453 - INFO -  step: 2250  loss:  0.1409  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,529  tflops: 491.05  mfu: 49.65%
[rank1]:2025-10-29 06:41:17,453 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,525  tflops: 490.86  mfu: 49.63%
[rank0]:2025-10-29 06:41:17,452 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:41:17,451 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,527  tflops: 490.97  mfu: 49.64%
[rank2]:2025-10-29 06:41:17,844 - INFO - Avg. fwd time: 15.0193 / Avg. bwd time: 17.4440 / Avg. batch time: 345.9242 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-10-29 06:41:17,816 - INFO - Avg. fwd time: 16.6624 / Avg. bwd time: 20.0625 / Avg. batch time: 309.1595 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:41:17,874 - INFO - Avg. fwd time: 17.5143 / Avg. bwd time: 19.6520 / Avg. batch time: 390.4981 (ms) / GPU bubble ratio: 23.86%
[rank0]:2025-10-29 06:41:17,888 - INFO - Avg. fwd time: 15.2700 / Avg. bwd time: 5.5977 / Avg. batch time: 417.6217 (ms) / GPU bubble ratio: 60.03%
[rank0]:2025-10-29 06:42:33,601 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,543  tflops: 491.72  mfu: 49.72%
[rank0]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,543  tflops: 491.71  mfu: 49.72%
[rank2]:2025-10-29 06:42:35,155 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,543  tflops: 491.71  mfu: 49.72%
[rank3]:2025-10-29 06:42:35,156 - INFO -  step: 2300  loss:  0.1056  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,543  tflops: 491.72  mfu: 49.72%
[rank1]:2025-10-29 06:42:35,236 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0642_stage1_step2300.svg
[rank0]:2025-10-29 06:42:35,236 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0642_stage0_step2300.svg
[rank2]:2025-10-29 06:42:35,235 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0642_stage2_step2300.svg
[rank0]:2025-10-29 06:42:35,326 - INFO - Avg. fwd time: 15.2697 / Avg. bwd time: 5.4880 / Avg. batch time: 416.9271 (ms) / GPU bubble ratio: 60.17%
[rank3]:2025-10-29 06:42:35,344 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0642_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.94 ms, GPU Bubble Ratio: 67.10%, 22.63%, 33.25%, 24.05%
[rank3]:2025-10-29 06:42:35,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0642_stage3_step2300.svg
[rank2]:2025-10-29 06:42:35,677 - INFO - Avg. fwd time: 15.0186 / Avg. bwd time: 17.4165 / Avg. batch time: 345.5751 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 06:42:35,657 - INFO - Avg. fwd time: 16.6598 / Avg. bwd time: 20.0345 / Avg. batch time: 308.9107 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:42:35,703 - INFO - Avg. fwd time: 17.5125 / Avg. bwd time: 19.6298 / Avg. batch time: 390.0251 (ms) / GPU bubble ratio: 23.82%
[rank0]:2025-10-29 06:43:51,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank1]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank2]:2025-10-29 06:43:53,017 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,521  tflops: 490.71  mfu: 49.62%
[rank3]:2025-10-29 06:43:53,018 - INFO -  step: 2350  loss:  0.1306  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,521  tflops: 490.72  mfu: 49.62%
[rank0]:2025-10-29 06:43:53,113 - INFO - Avg. fwd time: 15.2690 / Avg. bwd time: 5.3654 / Avg. batch time: 416.1618 (ms) / GPU bubble ratio: 60.33%
[rank2]:2025-10-29 06:43:53,340 - INFO - Avg. fwd time: 15.0176 / Avg. bwd time: 17.3857 / Avg. batch time: 345.1962 (ms) / GPU bubble ratio: 24.90%
[rank3]:2025-10-29 06:43:53,319 - INFO - Avg. fwd time: 16.6566 / Avg. bwd time: 20.0032 / Avg. batch time: 308.6307 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 06:43:53,364 - INFO - Avg. fwd time: 17.5100 / Avg. bwd time: 19.6049 / Avg. batch time: 389.5078 (ms) / GPU bubble ratio: 23.77%
[rank0]:2025-10-29 06:45:09,118 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:45:10,686 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.44GiB(52.53%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank1]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,704  tflops: 452.59  mfu: 45.11%
[rank1]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 06:45:10,684 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.57GiB(46.90%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank2]:2025-10-29 06:45:10,685 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,702  tflops: 452.49  mfu: 45.10%
[rank2]:2025-10-29 06:45:10,685 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 06:45:10,685 - INFO -  step: 2400  loss:  0.1136  grad_norm:  0.0000  memory: 84.29GiB(60.29%)  tps: 10,548  tflops: 491.95  mfu: 49.74%
[rank3]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss:  0.1136  grad_norm:  0.0000  tps: 9,704  tflops: 452.61  mfu: 45.11%
[rank3]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:45:10,686 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.70GiB(52.00%)  tps: 10,548  tflops: 491.94  mfu: 49.74%
[rank0]:2025-10-29 06:45:10,686 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,700  tflops: 452.41  mfu: 45.10%
[rank0]:2025-10-29 06:45:10,686 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:45:27,572 - INFO - validate step: 2400  loss: -1.0000  memory: 72.70GiB(52.00%)  tps: 24,257
[rank0]:2025-10-29 06:45:27,573 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:45:27,577 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 06:45:27,628 - INFO - validate step: 2400  loss: -1.0000  memory: 65.57GiB(46.90%)  tps: 24,175
[rank2]:2025-10-29 06:45:27,629 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:45:27,634 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 06:45:27,638 - INFO - validate step: 2400  loss:  0.2338  memory: 84.29GiB(60.29%)  tps: 24,164
[rank3]:2025-10-29 06:45:27,639 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:45:27,643 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 06:45:27,611 - INFO - validate step: 2400  loss: -1.0000  memory: 73.44GiB(52.53%)  tps: 24,200
[rank1]:2025-10-29 06:45:27,612 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:45:27,615 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 06:45:39,082 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 06:45:39,167 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0645_stage0_final2400.svg
[rank1]:2025-10-29 06:45:39,170 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0645_stage1_final2400.svg
[rank2]:2025-10-29 06:45:39,167 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0645_stage2_final2400.svg
[rank3]:2025-10-29 06:45:39,278 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0645_real_final2400_rank3.svg
[rank3]:> Batch Time: 372.82 ms, GPU Bubble Ratio: 67.11%, 22.62%, 33.25%, 24.05%
[rank0]:2025-10-29 06:45:39,405 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank0_stage0.svg
[rank0]:	> Counts Sum: 4638200, Total Sum: 5442880 (85.22%), Ratio(%) per element: [84.92, 84.71, 84.65, 84.76, 84.92, 84.87, 84.71, 84.97, 84.65, 84.76, 84.6, 85.03, 85.03, 85.08, 84.81, 84.65, 84.92, 84.81, 84.76, 84.87, 85.03, 84.87, 84.87, 85.08, 84.97, 85.13, 84.92, 85.08, 84.97, 84.87, 85.13, 85.08, 85.03, 85.13, 84.97, 85.03, 84.81, 85.13, 84.97, 85.19, 84.97, 85.19, 84.81, 85.46, 85.3, 85.4, 85.19, 85.67, 85.35, 85.35, 85.3, 85.51, 85.35, 85.51, 85.35, 85.4, 85.94, 85.72, 85.56, 85.56, 85.56, 85.99, 85.46, 85.89, 85.72, 85.72, 85.72, 86.1, 85.94, 85.89, 86.05, 85.78, 85.94]
[rank0]:2025-10-29 06:45:39,405 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-29 06:45:39,408 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank2_stage2.svg
[rank2]:	> Counts Sum: 1179800, Total Sum: 5368320 (21.98%), Ratio(%) per element: [22.63, 21.03, 21.88, 22.63, 20.17, 20.86, 22.47, 22.53, 20.22, 22.53, 21.94, 20.22, 22.96, 22.42, 22.47, 21.4, 19.25, 22.8, 22.53, 22.1, 22.42, 22.42, 22.1, 21.4, 21.83, 22.42, 22.37, 21.78, 22.74, 21.99, 23.12, 20.86, 22.26, 21.62, 22.04, 22.69, 22.21, 21.78, 21.03, 22.69, 23.01, 19.52, 24.73, 22.8, 21.78, 22.96, 21.19, 21.67, 22.53, 21.78, 21.99, 22.53, 20.86, 23.06, 21.83, 22.47, 21.83, 22.69, 23.01, 21.94, 22.69, 22.15, 21.78, 21.62, 21.35, 21.13, 21.51, 20.92, 22.53, 21.83, 21.94, 21.62]
[rank2]:2025-10-29 06:45:39,408 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:45:39,455 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0645_thry_final2400_rank3.svg
[rank3]:> Batch Time: 531.86 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-10-29 06:45:39,424 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank1_stage1.svg
[rank1]:	> Counts Sum: 249440, Total Sum: 6039360 (4.13%), Ratio(%) per element: [4.45, 4.77, 3.96, 3.96, 4.02, 4.07, 4.23, 4.02, 4.5, 4.29, 4.13, 3.7, 3.91, 4.98, 3.64, 4.23, 4.56, 3.91, 3.96, 4.29, 3.21, 3.75, 4.13, 3.86, 3.96, 3.7, 3.75, 4.02, 3.7, 4.02, 3.86, 4.02, 4.23, 4.5, 4.13, 4.02, 4.39, 3.16, 3.96, 3.8, 4.34, 4.77, 4.07, 4.39, 4.29, 4.5, 4.39, 4.39, 4.45, 4.34, 3.91, 4.34, 4.07, 3.75, 3.75, 3.59, 4.02, 3.37, 4.5, 4.61, 4.29, 3.86, 4.82, 4.18, 4.29, 3.75, 4.23, 4.07, 3.48, 4.45, 4.23, 3.7, 3.91, 4.18, 4.45, 4.23, 4.13, 4.5, 5.09, 4.02, 4.66]
[rank1]:2025-10-29 06:45:39,424 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:45:39,523 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0645_stage3_final2400.svg
[rank3]:2025-10-29 06:45:39,750 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0645_rank3_stage3.svg
[rank3]:	> Counts Sum: 79600, Total Sum: 4846400 (1.64%), Ratio(%) per element: [1.18, 1.55, 1.6, 1.66, 1.82, 1.98, 1.66, 1.82, 1.77, 1.55, 1.28, 1.77, 1.66, 1.23, 1.66, 1.55, 1.55, 1.44, 1.6, 1.6, 1.44, 1.82, 1.77, 2.09, 1.55, 1.6, 1.77, 1.5, 1.66, 1.71, 1.55, 1.77, 1.5, 1.93, 1.71, 1.66, 1.5, 1.44, 1.6, 1.18, 1.77, 1.44, 1.77, 1.6, 1.5, 1.87, 2.14, 1.82, 1.87, 1.87, 1.93, 2.14, 1.55, 1.71, 1.34, 1.93, 1.34, 1.66, 1.87, 1.77, 1.28, 1.5, 1.12, 1.71, 1.28]
[rank3]:2025-10-29 06:45:39,751 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–â–â–â–â–â–â–â–â–‚â–‚â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‡â–‡â–ˆâ–‡â–‡â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–‡â–‡â–‡â–ˆâ–‡â–ˆâ–â–â–â–â–â–â–â–‚â–‚â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.68832
[rank3]:wandb:               final/avg_loss 0.11356
[rank3]:wandb:             final/avg_mfu(%) 45.10672
[rank3]:wandb:             final/avg_tflops 452.61184
[rank3]:wandb:    final/avg_throughput(tps) 9704.33707
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11356
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11356
[rank3]:wandb: loss_metrics/global_max_loss 0.11356
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/2224xvmg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_fullrand7_dm1/20251029-0533/wandb/run-20251029_053307-2224xvmg/logs
[rank0]:2025-10-29 06:45:41,405 - INFO - Training completed
[rank0]:2025-10-29 06:45:41,405 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 06:45:41,601 - INFO - Process group destroyed
[rank2]:2025-10-29 06:45:41,630 - INFO - Process group destroyed
[rank0]:2025-10-29 06:45:41,631 - INFO - Process group destroyed
[rank3]:2025-10-29 06:45:41,699 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.4', 'layers.1', 'layers.7', 'layers.6', 'layers.3', 'layers.0', 'layers.2', 'layers.5'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.24', 'layers.19', 'layers.22', 'layers.18', 'layers.23', 'layers.20', 'layers.17'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.16', 'layers.9', 'layers.10', 'layers.12', 'layers.11', 'layers.15', 'layers.13', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.27', 'layers.25', 'layers.26', 'layers.31', 'norm', 'output', 'layers.30', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 06:45:50 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] 
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] *****************************************
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 06:45:57,020 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 06:45:57,428 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 06:45:57,383 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 06:45:57,522 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 06:45:57,656 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 06:45:57,657 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:45:57,662 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 06:45:58,261 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 06:45:58,264 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 06:45:58,251 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 06:45:58,254 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 06:45:58,292 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 06:45:58,294 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:46:00,142 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 06:46:00,419 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 06:46:02,042 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 06:46:03,659 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-29 06:46:03,836 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:46:03,909 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 06:46:03,909 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 06:46:03,927 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 06:46:03,978 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 06:46:04,002 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 06:46:04,002 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:46:04,069 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:46:04,133 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 06:46:04,133 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 06:46:04,162 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 06:46:04,162 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 06:46:04,219 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 06:46:04,219 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 06:46:04,356 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 06:46:04,356 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run q8s4zzdk
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1/20251029-0646/wandb/run-20251029_064604-q8s4zzdk
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/q8s4zzdk
[rank3]:2025-10-29 06:46:05,710 - INFO - WandB logging enabled
[rank3]:2025-10-29 06:46:05,716 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 06:46:05,790 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 06:46:05,790 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 06:46:06,110 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 06:46:06,111 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 06:46:06,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:06,144 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:06,144 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:09,126 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 06:46:09,126 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank0]:2025-10-29 06:46:09,127 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400.
[rank1]:2025-10-29 06:46:09,487 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank2]:2025-10-29 06:46:09,692 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank3]:2025-10-29 06:46:09,887 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank0]:2025-10-29 06:46:18,461 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 06:46:18,461 - INFO - Finished loading the checkpoint in 9.33 seconds.
[rank0]:2025-10-29 06:46:18,461 - INFO - Training starts at step 1
[rank3]:2025-10-29 06:46:23,161 - INFO -  step:  1  loss:  2.5272  grad_norm: 19.5148  memory: 58.03GiB(41.50%)  tps: 942  tflops: 43.93  mfu: 4.44%
[rank3]:2025-10-29 06:46:23,161 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 06:46:23,158 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 49.69GiB(35.54%)  tps: 850  tflops: 39.65  mfu: 4.01%
[rank1]:2025-10-29 06:46:23,158 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 06:46:23,177 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 49.75GiB(35.58%)  tps: 853  tflops: 39.80  mfu: 4.02%
[rank0]:2025-10-29 06:46:23,177 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 06:46:23,156 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 44.28GiB(31.67%)  tps: 862  tflops: 40.18  mfu: 4.06%
[rank2]:2025-10-29 06:46:23,156 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:46:41,435 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,478 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,524 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,524 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,527 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,527 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:48:32,707 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:48:35,438 - INFO -  step: 50  loss:  1.7159  grad_norm: 15.3070  memory: 73.38GiB(52.48%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank1]:2025-10-29 06:48:35,435 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 64.32GiB(46.00%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank2]:2025-10-29 06:48:35,433 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 57.29GiB(40.97%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank0]:2025-10-29 06:48:35,440 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 66.72GiB(47.72%)  tps: 6,070  tflops: 283.10  mfu: 28.62%
[rank3]:2025-10-29 06:48:35,898 - INFO - Avg. fwd time: 14.7209 / Avg. bwd time: 42.9299 / Avg. batch time: 481.8718 (ms) / GPU bubble ratio: 4.29%
[rank1]:2025-10-29 06:48:35,995 - INFO - Avg. fwd time: 15.3898 / Avg. bwd time: 41.6207 / Avg. batch time: 595.3210 (ms) / GPU bubble ratio: 23.39%
[rank2]:2025-10-29 06:48:35,948 - INFO - Avg. fwd time: 13.2507 / Avg. bwd time: 36.3665 / Avg. batch time: 534.6699 (ms) / GPU bubble ratio: 25.76%
[rank0]:2025-10-29 06:48:36,028 - INFO - Avg. fwd time: 14.2287 / Avg. bwd time: 38.3977 / Avg. batch time: 651.0325 (ms) / GPU bubble ratio: 35.33%
[rank3]:2025-10-29 06:49:02,213 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 06:49:30,251 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 06:49:30,468 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 06:49:30,571 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:30,587 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:30,611 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,745 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,831 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,781 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,770 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,803 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,838 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,865 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,907 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,942 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,946 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,979 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:36,017 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,955 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,991 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,029 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,014 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,051 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,981 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,019 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,056 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:36,053 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,067 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,104 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,142 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,088 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,127 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,093 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,165 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:50:14,035 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 06:50:14,339 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_max_batch_time.svg
[rank3]:> Batch Time: 634.46 ms, GPU Bubble Ratio: 33.16%, 27.09%, 36.92%, 26.64%
[rank3]:2025-10-29 06:50:14,520 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_min_batch_time.svg
[rank3]:> Batch Time: 362.15 ms, GPU Bubble Ratio: 68.84%, 24.11%, 34.71%, 23.68%
[rank3]:2025-10-29 06:50:14,737 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.15 ms, GPU Bubble Ratio: 31.86%, 23.05%, 29.57%, 23.68%
[rank3]:2025-10-29 06:50:14,738 - INFO - 	> Batch Time: 362.15 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 06:50:34,800 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:50:36,459 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.90, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 06:50:36,460 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 6,769  tflops: 315.70  mfu: 31.92%
[rank2]:2025-10-29 06:50:36,458 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.83, [MB1] 0.27/0.82, [MB2] 0.26/0.78, [MB3] 0.30/0.89, [MB4] 0.30/0.89, [MB5] 0.31/0.92, [MB6] 0.32/0.96, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:50:36,459 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 6,769  tflops: 315.70  mfu: 31.92%
[rank0]:2025-10-29 06:50:36,459 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/1.00, [MB4] 0.18/0.54, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 06:50:36,460 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,769  tflops: 315.71  mfu: 31.92%
[rank3]:2025-10-29 06:50:41,575 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 06:50:41,580 - INFO -  step: 100  loss:  1.1361  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 6,494  tflops: 302.90  mfu: 30.63%
[rank1]:2025-10-29 06:50:41,658 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0650_stage1_step100.svg
[rank0]:2025-10-29 06:50:41,664 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0650_stage0_step100.svg
[rank2]:2025-10-29 06:50:41,658 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0650_stage2_step100.svg
[rank3]:2025-10-29 06:50:41,765 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_real_step100_rank3.svg
[rank3]:> Batch Time: 632.17 ms, GPU Bubble Ratio: 33.23%, 27.20%, 36.77%, 26.58%
[rank0]:2025-10-29 06:50:41,767 - INFO - Avg. fwd time: 14.6887 / Avg. bwd time: 27.6591 / Avg. batch time: 621.9454 (ms) / GPU bubble ratio: 45.53%
[rank3]:2025-10-29 06:50:41,827 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0650_stage3_step100.svg
[rank3]:2025-10-29 06:50:42,097 - INFO - Avg. fwd time: 15.4773 / Avg. bwd time: 36.3774 / Avg. batch time: 432.7173 (ms) / GPU bubble ratio: 4.13%
[rank1]:2025-10-29 06:50:42,145 - INFO - Avg. fwd time: 16.2270 / Avg. bwd time: 35.2832 / Avg. batch time: 577.3002 (ms) / GPU bubble ratio: 28.62%
[rank2]:2025-10-29 06:50:42,119 - INFO - Avg. fwd time: 13.9083 / Avg. bwd time: 30.7610 / Avg. batch time: 523.1093 (ms) / GPU bubble ratio: 31.69%
[rank0]:2025-10-29 06:52:49,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:52:51,387 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.62/0.94, [MB1] 0.60/0.90, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 06:52:51,388 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 72.68GiB(51.98%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank0]:2025-10-29 06:52:51,386 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.36/0.54, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 06:52:51,386 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 73.18GiB(52.34%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank2]:2025-10-29 06:52:51,386 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.55/0.83, [MB1] 0.55/0.82, [MB2] 0.52/0.78, [MB3] 0.59/0.89, [MB4] 0.59/0.89, [MB5] 0.62/0.92, [MB6] 0.64/0.96, [MB7] 0.67/1.00
[rank2]:2025-10-29 06:52:51,386 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 64.67GiB(46.25%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank3]:2025-10-29 06:52:56,534 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 06:52:56,538 - INFO -  step: 150  loss:  1.1314  grad_norm:  0.1799  memory: 84.24GiB(60.25%)  tps: 6,070  tflops: 283.11  mfu: 28.63%
[rank1]:2025-10-29 06:52:56,975 - INFO - Avg. fwd time: 16.3954 / Avg. bwd time: 33.3781 / Avg. batch time: 583.6007 (ms) / GPU bubble ratio: 31.77%
[rank3]:2025-10-29 06:52:56,916 - INFO - Avg. fwd time: 15.7609 / Avg. bwd time: 33.4484 / Avg. batch time: 410.6262 (ms) / GPU bubble ratio: 4.13%
[rank0]:2025-10-29 06:52:57,003 - INFO - Avg. fwd time: 14.8414 / Avg. bwd time: 27.2767 / Avg. batch time: 628.1178 (ms) / GPU bubble ratio: 46.36%
[rank2]:2025-10-29 06:52:56,944 - INFO - Avg. fwd time: 14.0989 / Avg. bwd time: 28.8593 / Avg. batch time: 526.9112 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 06:54:49,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.90/0.90, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:54:51,500 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 72.72GiB(52.01%)  tps: 6,820  tflops: 318.10  mfu: 32.16%
[rank1]:2025-10-29 06:54:51,500 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.82/0.82, [MB2] 0.78/0.78, [MB3] 0.89/0.89, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:54:51,501 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 65.27GiB(46.69%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank2]:2025-10-29 06:54:51,501 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.54/0.54, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:54:51,501 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 74.20GiB(53.07%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank0]:2025-10-29 06:54:51,501 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 06:54:56,684 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:54:56,688 - INFO -  step: 200  loss:  1.1825  grad_norm:  0.1038  memory: 84.24GiB(60.25%)  tps: 6,818  tflops: 318.00  mfu: 32.15%
[rank3]:2025-10-29 06:54:56,689 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:55:13,745 - INFO - validate step: 200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,414
[rank0]:2025-10-29 06:55:13,692 - INFO - validate step: 200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,458
[rank3]:2025-10-29 06:55:13,756 - INFO - validate step: 200  loss:  0.3711  memory: 84.24GiB(60.25%)  tps: 24,000
[rank1]:2025-10-29 06:55:13,729 - INFO - validate step: 200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,427
[rank2]:2025-10-29 06:55:13,832 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0655_stage2_step200.svg
[rank0]:2025-10-29 06:55:13,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0655_stage0_step200.svg
[rank1]:2025-10-29 06:55:13,830 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0655_stage1_step200.svg
[rank3]:2025-10-29 06:55:13,930 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0655_real_step200_rank3.svg
[rank3]:> Batch Time: 497.13 ms, GPU Bubble Ratio: 31.53%, 25.85%, 35.91%, 28.10%
[rank3]:2025-10-29 06:55:13,995 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0655_stage3_step200.svg
[rank0]:2025-10-29 06:55:14,249 - INFO - Avg. fwd time: 15.0404 / Avg. bwd time: 25.3181 / Avg. batch time: 614.6784 (ms) / GPU bubble ratio: 47.47%
[rank3]:2025-10-29 06:55:14,264 - INFO - Avg. fwd time: 15.9965 / Avg. bwd time: 31.0946 / Avg. batch time: 393.2789 (ms) / GPU bubble ratio: 4.21%
[rank1]:2025-10-29 06:55:14,313 - INFO - Avg. fwd time: 16.6239 / Avg. bwd time: 31.1401 / Avg. batch time: 572.1262 (ms) / GPU bubble ratio: 33.21%
[rank2]:2025-10-29 06:55:14,286 - INFO - Avg. fwd time: 14.3049 / Avg. bwd time: 26.9279 / Avg. batch time: 517.5220 (ms) / GPU bubble ratio: 36.26%
[rank0]:2025-10-29 06:56:56,132 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:56:57,781 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.90/0.90, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:56:57,781 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,873  tflops: 367.20  mfu: 37.13%
[rank0]:2025-10-29 06:56:57,780 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.54/0.54, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:56:57,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,870  tflops: 367.07  mfu: 37.12%
[rank2]:2025-10-29 06:56:57,780 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.82/0.82, [MB2] 0.78/0.78, [MB3] 0.89/0.89, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:56:57,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,874  tflops: 367.26  mfu: 37.13%
[rank0]:2025-10-29 06:56:57,878 - INFO - Avg. fwd time: 15.2460 / Avg. bwd time: 20.1338 / Avg. batch time: 590.0931 (ms) / GPU bubble ratio: 52.03%
[rank3]:2025-10-29 06:57:03,019 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:57:03,024 - INFO -  step: 250  loss:  1.2228  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,497  tflops: 349.68  mfu: 35.36%
[rank3]:2025-10-29 06:57:03,292 - INFO - Avg. fwd time: 16.2801 / Avg. bwd time: 28.6188 / Avg. batch time: 375.4646 (ms) / GPU bubble ratio: 4.33%
[rank2]:2025-10-29 06:57:03,313 - INFO - Avg. fwd time: 14.5586 / Avg. bwd time: 24.7040 / Avg. batch time: 501.8409 (ms) / GPU bubble ratio: 37.41%
[rank1]:2025-10-29 06:57:03,338 - INFO - Avg. fwd time: 16.9330 / Avg. bwd time: 28.5399 / Avg. batch time: 552.9145 (ms) / GPU bubble ratio: 34.21%
[rank0]:2025-10-29 06:58:44,431 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:58:46,217 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank3_trend_line.svg
[rank1]:2025-10-29 06:58:46,262 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank1_trend_line.svg
[rank1]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:58:46,270 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank2]:2025-10-29 06:58:46,241 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank2_trend_line.svg
[rank2]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,252 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank0_trend_line.svg
[rank2]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:58:46,271 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank0]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,270 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank3]:2025-10-29 06:58:46,455 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0658_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 363.44 ms, GPU Bubble Ratio: 37.35%, 24.57%, 32.02%, 24.73%
[rank3]:2025-10-29 06:58:46,456 - INFO - 	> Batch Time: 363.44 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 06:58:46,456 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:58:51,672 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:58:51,676 - INFO -  step: 300  loss:  1.1753  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,540  tflops: 351.66  mfu: 35.56%
[rank1]:2025-10-29 06:58:51,746 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0658_stage1_step300.svg
[rank0]:2025-10-29 06:58:51,744 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0658_stage0_step300.svg
[rank2]:2025-10-29 06:58:51,746 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0658_stage2_step300.svg
[rank3]:2025-10-29 06:58:51,849 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0658_real_step300_rank3.svg
[rank3]:> Batch Time: 435.12 ms, GPU Bubble Ratio: 36.80%, 25.58%, 34.73%, 27.07%
[rank3]:2025-10-29 06:58:51,912 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0658_stage3_step300.svg
[rank1]:2025-10-29 06:58:52,290 - INFO - Avg. fwd time: 17.1291 / Avg. bwd time: 26.8306 / Avg. batch time: 543.8897 (ms) / GPU bubble ratio: 35.34%
[rank3]:2025-10-29 06:58:52,245 - INFO - Avg. fwd time: 16.4636 / Avg. bwd time: 26.9825 / Avg. batch time: 363.6650 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-10-29 06:58:52,295 - INFO - Avg. fwd time: 15.3713 / Avg. bwd time: 16.6139 / Avg. batch time: 577.4203 (ms) / GPU bubble ratio: 55.69%
[rank2]:2025-10-29 06:58:52,266 - INFO - Avg. fwd time: 14.7226 / Avg. bwd time: 23.2367 / Avg. batch time: 495.1207 (ms) / GPU bubble ratio: 38.67%
[rank0]:2025-10-29 07:00:36,183 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:00:37,841 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,342  tflops: 342.45  mfu: 34.63%
[rank2]:2025-10-29 07:00:37,840 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,343  tflops: 342.46  mfu: 34.63%
[rank0]:2025-10-29 07:00:37,840 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,342  tflops: 342.45  mfu: 34.63%
[rank0]:2025-10-29 07:00:37,940 - INFO - Avg. fwd time: 15.4507 / Avg. bwd time: 14.4489 / Avg. batch time: 570.5860 (ms) / GPU bubble ratio: 58.08%
[rank3]:2025-10-29 07:00:44,249 - INFO -  step: 350  loss:  1.1710  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,277  tflops: 339.41  mfu: 34.32%
[rank3]:2025-10-29 07:00:44,522 - INFO - Avg. fwd time: 16.5804 / Avg. bwd time: 25.9805 / Avg. batch time: 356.4793 (ms) / GPU bubble ratio: 4.49%
[rank1]:2025-10-29 07:00:44,569 - INFO - Avg. fwd time: 17.2505 / Avg. bwd time: 25.7785 / Avg. batch time: 539.2973 (ms) / GPU bubble ratio: 36.17%
[rank2]:2025-10-29 07:00:44,544 - INFO - Avg. fwd time: 14.8255 / Avg. bwd time: 22.3366 / Avg. batch time: 491.9557 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 07:02:26,415 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:02:28,166 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank3_trend_line.svg
[rank0]:2025-10-29 07:02:28,199 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank0_trend_line.svg
[rank2]:2025-10-29 07:02:28,192 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank2_trend_line.svg
[rank1]:2025-10-29 07:02:28,211 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank1_trend_line.svg
[rank1]:2025-10-29 07:02:28,216 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:02:28,219 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank1]:2025-10-29 07:02:28,219 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 07:02:28,217 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:02:28,219 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank0]:2025-10-29 07:02:28,219 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 07:02:28,217 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.72/0.72, [MB1] 0.72/0.72, [MB2] 0.76/0.76, [MB3] 0.81/0.81, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:02:28,220 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank2]:2025-10-29 07:02:28,220 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 07:02:28,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0702_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.84 ms, GPU Bubble Ratio: 51.82%, 24.61%, 32.82%, 24.76%
[rank3]:2025-10-29 07:02:28,407 - INFO - 	> Batch Time: 362.84 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:02:28,407 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:02:33,695 - INFO -  step: 400  loss:  0.6926  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,485  tflops: 349.11  mfu: 35.30%
[rank3]:2025-10-29 07:02:33,695 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 07:02:50,166 - INFO - validate step: 400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,663
[rank2]:2025-10-29 07:02:50,219 - INFO - validate step: 400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,619
[rank3]:2025-10-29 07:02:50,230 - INFO - validate step: 400  loss:  0.3658  memory: 84.24GiB(60.25%)  tps: 24,772
[rank1]:2025-10-29 07:02:50,205 - INFO - validate step: 400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,631
[rank0]:2025-10-29 07:02:50,309 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0702_stage0_step400.svg
[rank2]:2025-10-29 07:02:50,311 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0702_stage2_step400.svg
[rank1]:2025-10-29 07:02:50,307 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0702_stage1_step400.svg
[rank0]:2025-10-29 07:02:50,394 - INFO - Avg. fwd time: 15.4985 / Avg. bwd time: 12.5422 / Avg. batch time: 565.0481 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-29 07:02:50,412 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0702_real_step400_rank3.svg
[rank3]:> Batch Time: 383.66 ms, GPU Bubble Ratio: 67.07%, 23.25%, 33.52%, 23.58%
[rank3]:2025-10-29 07:02:50,481 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0702_stage3_step400.svg
[rank3]:2025-10-29 07:02:50,726 - INFO - Avg. fwd time: 16.6579 / Avg. bwd time: 25.0731 / Avg. batch time: 349.7427 (ms) / GPU bubble ratio: 4.54%
[rank1]:2025-10-29 07:02:50,773 - INFO - Avg. fwd time: 17.3342 / Avg. bwd time: 24.8369 / Avg. batch time: 535.7492 (ms) / GPU bubble ratio: 37.03%
[rank2]:2025-10-29 07:02:50,747 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 21.5283 / Avg. batch time: 489.6826 (ms) / GPU bubble ratio: 40.49%
[rank0]:2025-10-29 07:04:27,150 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:04:28,687 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,315  tflops: 387.81  mfu: 39.21%
[rank2]:2025-10-29 07:04:28,687 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,319  tflops: 388.02  mfu: 39.23%
[rank1]:2025-10-29 07:04:28,688 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,318  tflops: 387.96  mfu: 39.23%
[rank3]:2025-10-29 07:04:34,041 - INFO -  step: 450  loss:  0.8578  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,891  tflops: 368.06  mfu: 37.22%
[rank3]:2025-10-29 07:04:34,348 - INFO - Avg. fwd time: 16.6340 / Avg. bwd time: 24.3009 / Avg. batch time: 343.2840 (ms) / GPU bubble ratio: 4.60%
[rank0]:2025-10-29 07:04:34,398 - INFO - Avg. fwd time: 15.4738 / Avg. bwd time: 11.0802 / Avg. batch time: 558.1618 (ms) / GPU bubble ratio: 61.94%
[rank2]:2025-10-29 07:04:34,369 - INFO - Avg. fwd time: 14.9010 / Avg. bwd time: 20.8613 / Avg. batch time: 485.4100 (ms) / GPU bubble ratio: 41.06%
[rank1]:2025-10-29 07:04:34,392 - INFO - Avg. fwd time: 17.3247 / Avg. bwd time: 24.0605 / Avg. batch time: 530.4294 (ms) / GPU bubble ratio: 37.58%
[rank0]:2025-10-29 07:06:10,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,948  tflops: 370.71  mfu: 37.48%
[rank0]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,948  tflops: 370.70  mfu: 37.48%
[rank2]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,948  tflops: 370.70  mfu: 37.48%
[rank3]:2025-10-29 07:06:17,019 - INFO -  step: 500  loss:  0.9205  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,955  tflops: 371.03  mfu: 37.52%
[rank0]:2025-10-29 07:06:17,094 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0706_stage0_step500.svg
[rank2]:2025-10-29 07:06:17,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0706_stage2_step500.svg
[rank1]:2025-10-29 07:06:17,092 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0706_stage1_step500.svg
[rank0]:2025-10-29 07:06:17,182 - INFO - Avg. fwd time: 15.4532 / Avg. bwd time: 10.0737 / Avg. batch time: 552.3181 (ms) / GPU bubble ratio: 63.03%
[rank3]:2025-10-29 07:06:17,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0706_real_step500_rank3.svg
[rank3]:> Batch Time: 379.31 ms, GPU Bubble Ratio: 67.08%, 23.20%, 33.59%, 23.67%
[rank3]:2025-10-29 07:06:17,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0706_stage3_step500.svg
[rank3]:2025-10-29 07:06:17,509 - INFO - Avg. fwd time: 16.6148 / Avg. bwd time: 23.7647 / Avg. batch time: 338.7783 (ms) / GPU bubble ratio: 4.65%
[rank1]:2025-10-29 07:06:17,554 - INFO - Avg. fwd time: 17.3146 / Avg. bwd time: 23.5232 / Avg. batch time: 525.6673 (ms) / GPU bubble ratio: 37.85%
[rank2]:2025-10-29 07:06:17,529 - INFO - Avg. fwd time: 14.9004 / Avg. bwd time: 20.3993 / Avg. batch time: 481.3703 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 07:07:53,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:07:54,990 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank1]:2025-10-29 07:07:54,991 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank0]:2025-10-29 07:07:54,991 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank0]:2025-10-29 07:07:55,079 - INFO - Avg. fwd time: 15.4341 / Avg. bwd time: 9.1085 / Avg. batch time: 545.2257 (ms) / GPU bubble ratio: 63.99%
[rank3]:2025-10-29 07:08:00,502 - INFO -  step: 550  loss:  0.8960  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,916  tflops: 369.22  mfu: 37.33%
[rank3]:2025-10-29 07:08:00,742 - INFO - Avg. fwd time: 16.5971 / Avg. bwd time: 23.2515 / Avg. batch time: 334.4713 (ms) / GPU bubble ratio: 4.69%
[rank2]:2025-10-29 07:08:00,762 - INFO - Avg. fwd time: 14.9007 / Avg. bwd time: 19.9576 / Avg. batch time: 476.0017 (ms) / GPU bubble ratio: 41.41%
[rank1]:2025-10-29 07:08:00,786 - INFO - Avg. fwd time: 17.3056 / Avg. bwd time: 23.0095 / Avg. batch time: 519.6088 (ms) / GPU bubble ratio: 37.93%
[rank0]:2025-10-29 07:09:36,614 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:09:38,416 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank3_trend_line.svg
[rank0]:2025-10-29 07:09:38,457 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank0_trend_line.svg
[rank0]:2025-10-29 07:09:38,462 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,917  tflops: 369.25  mfu: 37.34%
[rank0]:2025-10-29 07:09:38,465 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 07:09:38,450 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank2_trend_line.svg
[rank2]:2025-10-29 07:09:38,463 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.77/0.77, [MB2] 0.80/0.80, [MB3] 0.84/0.84, [MB4] 0.88/0.88, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,917  tflops: 369.24  mfu: 37.34%
[rank2]:2025-10-29 07:09:38,466 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 07:09:38,454 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank1_trend_line.svg
[rank1]:2025-10-29 07:09:38,462 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,917  tflops: 369.25  mfu: 37.34%
[rank1]:2025-10-29 07:09:38,465 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 07:09:38,648 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0709_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.93 ms, GPU Bubble Ratio: 59.16%, 24.02%, 33.50%, 24.39%
[rank3]:2025-10-29 07:09:38,648 - INFO - 	> Batch Time: 356.93 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 07:09:38,649 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:09:43,775 - INFO -  step: 600  loss:  0.8387  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,933  tflops: 369.98  mfu: 37.41%
[rank3]:2025-10-29 07:09:43,775 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 07:10:00,235 - INFO - validate step: 600  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,815
[rank2]:2025-10-29 07:10:00,288 - INFO - validate step: 600  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,770
[rank3]:2025-10-29 07:10:00,300 - INFO - validate step: 600  loss:  0.3725  memory: 84.24GiB(60.25%)  tps: 24,789
[rank1]:2025-10-29 07:10:00,272 - INFO - validate step: 600  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,783
[rank0]:2025-10-29 07:10:00,374 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0710_stage0_step600.svg
[rank2]:2025-10-29 07:10:00,375 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0710_stage2_step600.svg
[rank1]:2025-10-29 07:10:00,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0710_stage1_step600.svg
[rank3]:2025-10-29 07:10:00,479 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0710_real_step600_rank3.svg
[rank3]:> Batch Time: 376.68 ms, GPU Bubble Ratio: 67.14%, 23.17%, 33.52%, 23.70%
[rank3]:2025-10-29 07:10:00,543 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0710_stage3_step600.svg
[rank2]:2025-10-29 07:10:00,873 - INFO - Avg. fwd time: 14.9009 / Avg. bwd time: 19.5934 / Avg. batch time: 473.7886 (ms) / GPU bubble ratio: 41.76%
[rank3]:2025-10-29 07:10:00,851 - INFO - Avg. fwd time: 16.5819 / Avg. bwd time: 22.8271 / Avg. batch time: 330.9063 (ms) / GPU bubble ratio: 4.72%
[rank1]:2025-10-29 07:10:00,897 - INFO - Avg. fwd time: 17.2964 / Avg. bwd time: 22.5825 / Avg. batch time: 516.8145 (ms) / GPU bubble ratio: 38.27%
[rank0]:2025-10-29 07:10:00,903 - INFO - Avg. fwd time: 15.4181 / Avg. bwd time: 8.3122 / Avg. batch time: 541.5777 (ms) / GPU bubble ratio: 64.95%
[rank0]:2025-10-29 07:12:12,963 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:12:15,250 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank0]:2025-10-29 07:12:15,277 - INFO -  step: 650  loss: -4.0000  grad_norm: 10.9795  memory: 74.20GiB(53.07%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank2]:2025-10-29 07:12:15,250 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 6,070  tflops: 283.10  mfu: 28.62%
[rank3]:2025-10-29 07:12:20,367 - INFO -  step: 650  loss:  0.7035  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,849  tflops: 272.78  mfu: 27.58%
[rank3]:2025-10-29 07:12:20,609 - INFO - Avg. fwd time: 16.5710 / Avg. bwd time: 22.5194 / Avg. batch time: 328.3219 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-29 07:12:20,630 - INFO - Avg. fwd time: 14.9015 / Avg. bwd time: 19.3293 / Avg. batch time: 472.5338 (ms) / GPU bubble ratio: 42.05%
[rank1]:2025-10-29 07:12:20,689 - INFO - Avg. fwd time: 17.2807 / Avg. bwd time: 22.2533 / Avg. batch time: 519.3359 (ms) / GPU bubble ratio: 39.10%
[rank0]:2025-10-29 07:12:20,808 - INFO - Avg. fwd time: 15.3060 / Avg. bwd time: 10.4231 / Avg. batch time: 550.4501 (ms) / GPU bubble ratio: 62.61%
[rank0]:2025-10-29 07:14:33,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:14:35,523 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank1]:2025-10-29 07:14:35,523 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank0]:2025-10-29 07:14:35,549 - INFO -  step: 700  loss: -4.0000  grad_norm: 51.0152  memory: 74.20GiB(53.07%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank3]:2025-10-29 07:14:40,615 - INFO -  step: 700  loss:  0.7788  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,841  tflops: 272.43  mfu: 27.55%
[rank0]:2025-10-29 07:14:40,692 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0714_stage0_step700.svg
[rank2]:2025-10-29 07:14:40,696 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0714_stage2_step700.svg
[rank1]:2025-10-29 07:14:40,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0714_stage1_step700.svg
[rank3]:2025-10-29 07:14:40,798 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0714_real_step700_rank3.svg
[rank3]:> Batch Time: 374.50 ms, GPU Bubble Ratio: 67.19%, 23.20%, 33.42%, 23.70%
[rank3]:2025-10-29 07:14:40,865 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0714_stage3_step700.svg
[rank2]:2025-10-29 07:14:41,129 - INFO - Avg. fwd time: 14.9008 / Avg. bwd time: 19.0636 / Avg. batch time: 471.9456 (ms) / GPU bubble ratio: 42.43%
[rank3]:2025-10-29 07:14:41,108 - INFO - Avg. fwd time: 16.5574 / Avg. bwd time: 22.2103 / Avg. batch time: 325.7030 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 07:14:41,188 - INFO - Avg. fwd time: 17.2600 / Avg. bwd time: 21.9185 / Avg. batch time: 522.5380 (ms) / GPU bubble ratio: 40.02%
[rank0]:2025-10-29 07:14:41,308 - INFO - Avg. fwd time: 15.1924 / Avg. bwd time: 12.5451 / Avg. batch time: 560.0415 (ms) / GPU bubble ratio: 60.38%
[rank0]:2025-10-29 07:16:53,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:16:55,719 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank1]:2025-10-29 07:16:55,719 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank0]:2025-10-29 07:16:55,745 - INFO -  step: 750  loss: -4.0000  grad_norm:  9.7250  memory: 74.20GiB(53.07%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank3]:2025-10-29 07:17:00,842 - INFO -  step: 750  loss:  0.7182  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,842  tflops: 272.47  mfu: 27.55%
[rank3]:2025-10-29 07:17:01,155 - INFO - Avg. fwd time: 16.5460 / Avg. bwd time: 21.9451 / Avg. batch time: 323.4585 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 07:17:01,184 - INFO - Avg. fwd time: 14.9003 / Avg. bwd time: 18.8351 / Avg. batch time: 471.4291 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-10-29 07:17:01,264 - INFO - Avg. fwd time: 17.2418 / Avg. bwd time: 21.6294 / Avg. batch time: 525.2817 (ms) / GPU bubble ratio: 40.80%
[rank0]:2025-10-29 07:17:01,363 - INFO - Avg. fwd time: 15.0936 / Avg. bwd time: 14.3686 / Avg. batch time: 568.2701 (ms) / GPU bubble ratio: 58.52%
[rank0]:2025-10-29 07:19:13,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:19:15,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank1_trend_line.svg
[rank3]:2025-10-29 07:19:15,983 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank3_trend_line.svg
[rank2]:2025-10-29 07:19:16,014 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank2_trend_line.svg
[rank1]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:19:16,092 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,836  tflops: 272.19  mfu: 27.52%
[rank1]:2025-10-29 07:19:16,092 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 07:19:16,083 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank0_trend_line.svg
[rank0]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:19:16,091 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.0141  memory: 74.20GiB(53.07%)  tps: 5,837  tflops: 272.24  mfu: 27.53%
[rank0]:2025-10-29 07:19:16,091 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.74/0.74, [MB2] 0.79/0.79, [MB3] 0.83/0.83, [MB4] 0.87/0.87, [MB5] 0.91/0.91, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:19:16,093 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,836  tflops: 272.19  mfu: 27.52%
[rank2]:2025-10-29 07:19:16,093 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 07:19:16,279 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0719_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.54 ms, GPU Bubble Ratio: 35.10%, 24.07%, 33.08%, 24.44%
[rank3]:2025-10-29 07:19:16,279 - INFO - 	> Batch Time: 355.54 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:19:16,279 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:19:21,406 - INFO -  step: 800  loss:  0.6972  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,828  tflops: 271.82  mfu: 27.48%
[rank3]:2025-10-29 07:19:21,407 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 07:19:37,791 - INFO - validate step: 800  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,876
[rank2]:2025-10-29 07:19:37,840 - INFO - validate step: 800  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,835
[rank1]:2025-10-29 07:19:37,823 - INFO - validate step: 800  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,849
[rank3]:2025-10-29 07:19:37,852 - INFO - validate step: 800  loss:  0.3536  memory: 84.24GiB(60.25%)  tps: 24,908
[rank0]:2025-10-29 07:19:37,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0719_stage0_step800.svg
[rank2]:2025-10-29 07:19:37,934 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0719_stage2_step800.svg
[rank1]:2025-10-29 07:19:37,929 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0719_stage1_step800.svg
[rank3]:2025-10-29 07:19:38,039 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0719_real_step800_rank3.svg
[rank3]:> Batch Time: 372.46 ms, GPU Bubble Ratio: 67.21%, 23.20%, 33.29%, 23.73%
[rank3]:2025-10-29 07:19:38,110 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0719_stage3_step800.svg
[rank2]:2025-10-29 07:19:38,379 - INFO - Avg. fwd time: 14.8991 / Avg. bwd time: 18.6623 / Avg. batch time: 470.5374 (ms) / GPU bubble ratio: 42.94%
[rank3]:2025-10-29 07:19:38,358 - INFO - Avg. fwd time: 16.5364 / Avg. bwd time: 21.7437 / Avg. batch time: 321.7467 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 07:19:38,438 - INFO - Avg. fwd time: 17.2268 / Avg. bwd time: 21.4108 / Avg. batch time: 526.8372 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 07:19:38,555 - INFO - Avg. fwd time: 15.0175 / Avg. bwd time: 15.7386 / Avg. batch time: 573.9442 (ms) / GPU bubble ratio: 57.13%
[rank0]:2025-10-29 07:21:14,448 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,344  tflops: 389.18  mfu: 39.35%
[rank0]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,342  tflops: 389.06  mfu: 39.34%
[rank2]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,346  tflops: 389.25  mfu: 39.36%
[rank0]:2025-10-29 07:21:16,084 - INFO - Avg. fwd time: 15.0250 / Avg. bwd time: 14.9924 / Avg. batch time: 569.0565 (ms) / GPU bubble ratio: 57.80%
[rank3]:2025-10-29 07:21:21,102 - INFO -  step: 850  loss:  0.7170  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,934  tflops: 370.06  mfu: 37.42%
[rank2]:2025-10-29 07:21:21,362 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 18.4879 / Avg. batch time: 467.8385 (ms) / GPU bubble ratio: 42.91%
[rank1]:2025-10-29 07:21:21,386 - INFO - Avg. fwd time: 17.2245 / Avg. bwd time: 21.2086 / Avg. batch time: 523.2969 (ms) / GPU bubble ratio: 41.24%
[rank3]:2025-10-29 07:21:21,342 - INFO - Avg. fwd time: 16.5302 / Avg. bwd time: 21.5414 / Avg. batch time: 320.0555 (ms) / GPU bubble ratio: 4.84%
[rank0]:2025-10-29 07:22:56,691 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank2]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank1]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank3]:2025-10-29 07:23:03,358 - INFO -  step: 900  loss:  0.7021  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,011  tflops: 373.66  mfu: 37.78%
[rank0]:2025-10-29 07:23:03,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0722_stage0_step900.svg
[rank2]:2025-10-29 07:23:03,431 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0722_stage2_step900.svg
[rank1]:2025-10-29 07:23:03,426 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0722_stage1_step900.svg
[rank3]:2025-10-29 07:23:03,541 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0723_real_step900_rank3.svg
[rank3]:> Batch Time: 371.28 ms, GPU Bubble Ratio: 67.12%, 23.18%, 33.21%, 23.78%
[rank3]:2025-10-29 07:23:03,602 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0723_stage3_step900.svg
[rank2]:2025-10-29 07:23:03,928 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 18.3335 / Avg. batch time: 466.6112 (ms) / GPU bubble ratio: 43.02%
[rank1]:2025-10-29 07:23:03,953 - INFO - Avg. fwd time: 17.2232 / Avg. bwd time: 21.0313 / Avg. batch time: 520.9951 (ms) / GPU bubble ratio: 41.26%
[rank3]:2025-10-29 07:23:03,906 - INFO - Avg. fwd time: 16.5242 / Avg. bwd time: 21.3619 / Avg. batch time: 318.5521 (ms) / GPU bubble ratio: 4.85%
[rank0]:2025-10-29 07:23:03,959 - INFO - Avg. fwd time: 15.0381 / Avg. bwd time: 14.1183 / Avg. batch time: 565.0090 (ms) / GPU bubble ratio: 58.72%
[rank0]:2025-10-29 07:24:39,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank1]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank2]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank0]:2025-10-29 07:24:41,098 - INFO - Avg. fwd time: 15.0482 / Avg. bwd time: 13.4463 / Avg. batch time: 561.5692 (ms) / GPU bubble ratio: 59.41%
[rank3]:2025-10-29 07:24:46,162 - INFO -  step: 950  loss:  0.7228  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank1]:2025-10-29 07:24:46,447 - INFO - Avg. fwd time: 17.2230 / Avg. bwd time: 20.8959 / Avg. batch time: 518.8987 (ms) / GPU bubble ratio: 41.23%
[rank3]:2025-10-29 07:24:46,403 - INFO - Avg. fwd time: 16.5199 / Avg. bwd time: 21.2242 / Avg. batch time: 317.4005 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 07:24:46,423 - INFO - Avg. fwd time: 14.8999 / Avg. bwd time: 18.2151 / Avg. batch time: 465.3413 (ms) / GPU bubble ratio: 43.07%
[rank0]:2025-10-29 07:26:21,885 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:26:23,412 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank1]:2025-10-29 07:26:23,412 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 07:26:23,411 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank2]:2025-10-29 07:26:23,411 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 07:26:23,411 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank0]:2025-10-29 07:26:23,411 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 07:26:28,569 - INFO -  step: 1000  loss:  0.7074  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,000  tflops: 373.10  mfu: 37.72%
[rank3]:2025-10-29 07:26:28,569 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 07:26:44,963 - INFO - validate step: 1000  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,006
[rank1]:2025-10-29 07:26:44,999 - INFO - validate step: 1000  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,975
[rank3]:2025-10-29 07:26:45,025 - INFO - validate step: 1000  loss:  0.3541  memory: 84.24GiB(60.25%)  tps: 24,892
[rank2]:2025-10-29 07:26:45,015 - INFO - validate step: 1000  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,960
[rank0]:2025-10-29 07:26:45,103 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0726_stage0_step1000.svg
[rank1]:2025-10-29 07:26:45,097 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0726_stage1_step1000.svg
[rank2]:2025-10-29 07:26:45,101 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0726_stage2_step1000.svg
[rank0]:2025-10-29 07:26:45,193 - INFO - Avg. fwd time: 15.0574 / Avg. bwd time: 12.7390 / Avg. batch time: 558.3107 (ms) / GPU bubble ratio: 60.17%
[rank3]:2025-10-29 07:26:45,204 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0726_real_step1000_rank3.svg
[rank3]:> Batch Time: 370.54 ms, GPU Bubble Ratio: 67.06%, 23.15%, 33.18%, 23.79%
[rank3]:2025-10-29 07:26:45,266 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0726_stage3_step1000.svg
[rank1]:2025-10-29 07:26:45,555 - INFO - Avg. fwd time: 17.2210 / Avg. bwd time: 20.7522 / Avg. batch time: 517.0541 (ms) / GPU bubble ratio: 41.25%
[rank3]:2025-10-29 07:26:45,509 - INFO - Avg. fwd time: 16.5144 / Avg. bwd time: 21.0770 / Avg. batch time: 316.1617 (ms) / GPU bubble ratio: 4.88%
[rank2]:2025-10-29 07:26:45,530 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 18.0889 / Avg. batch time: 464.3673 (ms) / GPU bubble ratio: 43.17%
[rank0]:2025-10-29 07:28:21,315 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,373  tflops: 390.51  mfu: 39.49%
[rank0]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,368  tflops: 390.30  mfu: 39.46%
[rank1]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,371  tflops: 390.45  mfu: 39.48%
[rank3]:2025-10-29 07:28:27,993 - INFO -  step: 1050  loss:  0.7136  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,956  tflops: 371.07  mfu: 37.52%
[rank3]:2025-10-29 07:28:28,303 - INFO - Avg. fwd time: 16.5107 / Avg. bwd time: 20.9463 / Avg. batch time: 315.0721 (ms) / GPU bubble ratio: 4.89%
[rank2]:2025-10-29 07:28:28,327 - INFO - Avg. fwd time: 14.8992 / Avg. bwd time: 17.9759 / Avg. batch time: 463.5846 (ms) / GPU bubble ratio: 43.27%
[rank0]:2025-10-29 07:28:28,361 - INFO - Avg. fwd time: 15.0671 / Avg. bwd time: 12.1023 / Avg. batch time: 555.4776 (ms) / GPU bubble ratio: 60.87%
[rank1]:2025-10-29 07:28:28,353 - INFO - Avg. fwd time: 17.2214 / Avg. bwd time: 20.6241 / Avg. batch time: 515.4922 (ms) / GPU bubble ratio: 41.27%
[rank0]:2025-10-29 07:30:03,690 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank0]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank1]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank3]:2025-10-29 07:30:10,370 - INFO -  step: 1100  loss:  0.6967  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,002  tflops: 373.21  mfu: 37.74%
[rank2]:2025-10-29 07:30:10,449 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0730_stage2_step1100.svg
[rank0]:2025-10-29 07:30:10,448 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0730_stage0_step1100.svg
[rank1]:2025-10-29 07:30:10,443 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0730_stage1_step1100.svg
[rank0]:2025-10-29 07:30:10,536 - INFO - Avg. fwd time: 15.0743 / Avg. bwd time: 11.6052 / Avg. batch time: 552.8424 (ms) / GPU bubble ratio: 61.39%
[rank3]:2025-10-29 07:30:10,553 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0730_real_step1100_rank3.svg
[rank3]:> Batch Time: 369.96 ms, GPU Bubble Ratio: 67.03%, 23.11%, 33.16%, 23.81%
[rank3]:2025-10-29 07:30:10,616 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0730_stage3_step1100.svg
[rank1]:2025-10-29 07:30:10,905 - INFO - Avg. fwd time: 17.2210 / Avg. bwd time: 20.5241 / Avg. batch time: 513.8504 (ms) / GPU bubble ratio: 41.24%
[rank3]:2025-10-29 07:30:10,859 - INFO - Avg. fwd time: 16.5074 / Avg. bwd time: 20.8442 / Avg. batch time: 314.2177 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 07:30:10,880 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 17.8883 / Avg. batch time: 462.5530 (ms) / GPU bubble ratio: 43.29%
[rank0]:2025-10-29 07:31:46,273 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank0]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank1]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank0]:2025-10-29 07:31:47,922 - INFO - Avg. fwd time: 15.0818 / Avg. bwd time: 11.0746 / Avg. batch time: 549.3111 (ms) / GPU bubble ratio: 61.91%
[rank3]:2025-10-29 07:31:53,004 - INFO -  step: 1150  loss:  0.7053  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,982  tflops: 372.28  mfu: 37.64%
[rank1]:2025-10-29 07:31:53,297 - INFO - Avg. fwd time: 17.2204 / Avg. bwd time: 20.4170 / Avg. batch time: 511.3800 (ms) / GPU bubble ratio: 41.12%
[rank3]:2025-10-29 07:31:53,252 - INFO - Avg. fwd time: 16.5035 / Avg. bwd time: 20.7344 / Avg. batch time: 313.2958 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 07:31:53,272 - INFO - Avg. fwd time: 14.8993 / Avg. bwd time: 17.7948 / Avg. batch time: 460.7326 (ms) / GPU bubble ratio: 43.23%
[rank0]:2025-10-29 07:33:28,749 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank2]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank0]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank1]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 07:33:35,464 - INFO -  step: 1200  loss:  0.6884  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,996  tflops: 372.91  mfu: 37.71%
[rank3]:2025-10-29 07:33:35,464 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 07:33:51,945 - INFO - validate step: 1200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,939
[rank2]:2025-10-29 07:33:51,945 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 07:33:51,892 - INFO - validate step: 1200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,985
[rank0]:2025-10-29 07:33:51,893 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 07:33:51,896 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-29 07:33:51,929 - INFO - validate step: 1200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,953
[rank1]:2025-10-29 07:33:51,930 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 07:33:51,957 - INFO - validate step: 1200  loss:  0.3527  memory: 84.24GiB(60.25%)  tps: 24,837
[rank3]:2025-10-29 07:33:51,958 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 07:34:06,725 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.78 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 07:34:07,172 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 07:34:07,178 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.28 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 07:34:08,952 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.02 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 07:34:09,087 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.13 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 07:34:09,236 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0734_stage2_step1200.svg
[rank2]:2025-10-29 07:34:09,248 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 07:34:09,229 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0734_stage0_step1200.svg
[rank0]:2025-10-29 07:34:09,239 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 07:34:09,226 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0734_stage1_step1200.svg
[rank1]:2025-10-29 07:34:09,234 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 07:34:09,361 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0734_real_step1200_rank3.svg
[rank3]:> Batch Time: 369.50 ms, GPU Bubble Ratio: 67.01%, 23.07%, 33.12%, 23.81%
[rank3]:2025-10-29 07:34:09,432 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0734_stage3_step1200.svg
[rank3]:2025-10-29 07:34:09,444 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 07:34:09,814 - INFO - Avg. fwd time: 17.2208 / Avg. bwd time: 20.3201 / Avg. batch time: 510.2425 (ms) / GPU bubble ratio: 41.14%
[rank3]:2025-10-29 07:34:09,762 - INFO - Avg. fwd time: 16.5013 / Avg. bwd time: 20.6368 / Avg. batch time: 312.4871 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 07:34:09,788 - INFO - Avg. fwd time: 14.8999 / Avg. bwd time: 17.7104 / Avg. batch time: 460.1908 (ms) / GPU bubble ratio: 43.31%
[rank0]:2025-10-29 07:34:09,823 - INFO - Avg. fwd time: 15.0894 / Avg. bwd time: 10.5903 / Avg. batch time: 547.2074 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-29 07:35:56,753 - INFO - [GC] Peforming periodical GC collection 2.38 seconds
[rank2]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 6,478  tflops: 302.12  mfu: 30.55%
[rank0]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 6,475  tflops: 301.99  mfu: 30.54%
[rank1]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 6,477  tflops: 302.08  mfu: 30.54%
[rank0]:2025-10-29 07:35:58,512 - INFO - Avg. fwd time: 15.1216 / Avg. bwd time: 10.2077 / Avg. batch time: 546.4894 (ms) / GPU bubble ratio: 62.92%
[rank3]:2025-10-29 07:36:04,158 - INFO -  step: 1250  loss:  1.1092  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank2]:2025-10-29 07:36:04,449 - INFO - Avg. fwd time: 14.9223 / Avg. bwd time: 17.6608 / Avg. batch time: 460.6531 (ms) / GPU bubble ratio: 43.41%
[rank1]:2025-10-29 07:36:04,475 - INFO - Avg. fwd time: 17.2508 / Avg. bwd time: 20.2630 / Avg. batch time: 510.2644 (ms) / GPU bubble ratio: 41.19%
[rank3]:2025-10-29 07:36:04,428 - INFO - Avg. fwd time: 16.5310 / Avg. bwd time: 20.5871 / Avg. batch time: 312.4604 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 07:37:43,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:37:45,141 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank0]:2025-10-29 07:37:45,141 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank1]:2025-10-29 07:37:45,142 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank3]:2025-10-29 07:37:49,717 - INFO -  step: 1300  loss:  1.1526  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,761  tflops: 361.96  mfu: 36.60%
[rank2]:2025-10-29 07:37:49,796 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0737_stage2_step1300.svg
[rank0]:2025-10-29 07:37:49,797 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0737_stage0_step1300.svg
[rank1]:2025-10-29 07:37:49,796 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0737_stage1_step1300.svg
[rank0]:2025-10-29 07:37:49,900 - INFO - Avg. fwd time: 15.1553 / Avg. bwd time: 9.7949 / Avg. batch time: 544.9941 (ms) / GPU bubble ratio: 63.38%
[rank3]:2025-10-29 07:37:49,900 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0737_real_step1300_rank3.svg
[rank3]:> Batch Time: 370.75 ms, GPU Bubble Ratio: 67.02%, 23.08%, 33.20%, 23.83%
[rank3]:2025-10-29 07:37:49,965 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0737_stage3_step1300.svg
[rank2]:2025-10-29 07:37:50,256 - INFO - Avg. fwd time: 14.9463 / Avg. bwd time: 17.6073 / Avg. batch time: 460.4389 (ms) / GPU bubble ratio: 43.44%
[rank3]:2025-10-29 07:37:50,236 - INFO - Avg. fwd time: 16.5641 / Avg. bwd time: 20.5344 / Avg. batch time: 312.2960 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:37:50,283 - INFO - Avg. fwd time: 17.2825 / Avg. bwd time: 20.2025 / Avg. batch time: 509.5730 (ms) / GPU bubble ratio: 41.15%
[rank0]:2025-10-29 07:39:29,107 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:39:30,763 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank2]:2025-10-29 07:39:30,762 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank1]:2025-10-29 07:39:30,763 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank3]:2025-10-29 07:39:35,372 - INFO -  step: 1350  loss:  1.1264  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,754  tflops: 361.63  mfu: 36.57%
[rank2]:2025-10-29 07:39:35,735 - INFO - Avg. fwd time: 14.9681 / Avg. bwd time: 17.5571 / Avg. batch time: 460.0435 (ms) / GPU bubble ratio: 43.44%
[rank1]:2025-10-29 07:39:35,763 - INFO - Avg. fwd time: 17.3123 / Avg. bwd time: 20.1474 / Avg. batch time: 508.7384 (ms) / GPU bubble ratio: 41.09%
[rank3]:2025-10-29 07:39:35,710 - INFO - Avg. fwd time: 16.5946 / Avg. bwd time: 20.4860 / Avg. batch time: 312.1454 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 07:39:35,772 - INFO - Avg. fwd time: 15.1860 / Avg. bwd time: 9.4142 / Avg. batch time: 543.4184 (ms) / GPU bubble ratio: 63.78%
[rank0]:2025-10-29 07:41:14,546 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank1]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank0]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank2]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 07:41:20,822 - INFO -  step: 1400  loss:  1.1698  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,769  tflops: 362.33  mfu: 36.64%
[rank3]:2025-10-29 07:41:20,823 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:41:37,316 - INFO - validate step: 1400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,400
[rank1]:2025-10-29 07:41:37,350 - INFO - validate step: 1400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,369
[rank2]:2025-10-29 07:41:37,366 - INFO - validate step: 1400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,354
[rank1]:2025-10-29 07:41:37,461 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0741_stage1_step1400.svg
[rank3]:2025-10-29 07:41:37,380 - INFO - validate step: 1400  loss:  0.3529  memory: 84.24GiB(60.25%)  tps: 24,740
[rank2]:2025-10-29 07:41:37,463 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0741_stage2_step1400.svg
[rank0]:2025-10-29 07:41:37,466 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0741_stage0_step1400.svg
[rank0]:2025-10-29 07:41:37,571 - INFO - Avg. fwd time: 15.2104 / Avg. bwd time: 9.1107 / Avg. batch time: 541.8839 (ms) / GPU bubble ratio: 64.09%
[rank3]:2025-10-29 07:41:37,569 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0741_real_step1400_rank3.svg
[rank3]:> Batch Time: 371.83 ms, GPU Bubble Ratio: 67.02%, 23.09%, 33.24%, 23.84%
[rank3]:2025-10-29 07:41:37,638 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0741_stage3_step1400.svg
[rank1]:2025-10-29 07:41:37,959 - INFO - Avg. fwd time: 17.3362 / Avg. bwd time: 20.1029 / Avg. batch time: 507.7958 (ms) / GPU bubble ratio: 41.02%
[rank3]:2025-10-29 07:41:37,911 - INFO - Avg. fwd time: 16.6184 / Avg. bwd time: 20.4471 / Avg. batch time: 312.0195 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:41:37,932 - INFO - Avg. fwd time: 14.9857 / Avg. bwd time: 17.5178 / Avg. batch time: 459.4527 (ms) / GPU bubble ratio: 43.40%
[rank0]:2025-10-29 07:43:17,416 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,055  tflops: 375.69  mfu: 37.99%
[rank0]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,051  tflops: 375.51  mfu: 37.97%
[rank1]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,054  tflops: 375.63  mfu: 37.98%
[rank0]:2025-10-29 07:43:19,168 - INFO - Avg. fwd time: 15.2375 / Avg. bwd time: 8.7804 / Avg. batch time: 539.8402 (ms) / GPU bubble ratio: 64.41%
[rank3]:2025-10-29 07:43:23,668 - INFO -  step: 1450  loss:  1.2087  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,708  tflops: 359.48  mfu: 36.35%
[rank3]:2025-10-29 07:43:23,940 - INFO - Avg. fwd time: 16.6448 / Avg. bwd time: 20.4057 / Avg. batch time: 311.8936 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:43:23,960 - INFO - Avg. fwd time: 15.0044 / Avg. bwd time: 17.4743 / Avg. batch time: 458.4306 (ms) / GPU bubble ratio: 43.32%
[rank1]:2025-10-29 07:43:23,986 - INFO - Avg. fwd time: 17.3632 / Avg. bwd time: 20.0559 / Avg. batch time: 506.3950 (ms) / GPU bubble ratio: 40.89%
[rank0]:2025-10-29 07:45:02,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:45:04,509 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank1]:2025-10-29 07:45:04,510 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank2]:2025-10-29 07:45:04,509 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank0]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0745_stage0_step1500.svg
[rank3]:2025-10-29 07:45:09,138 - INFO -  step: 1500  loss:  1.1331  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,767  tflops: 362.27  mfu: 36.63%
[rank1]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0745_stage1_step1500.svg
[rank2]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0745_stage2_step1500.svg
[rank3]:2025-10-29 07:45:09,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0745_real_step1500_rank3.svg
[rank3]:> Batch Time: 372.91 ms, GPU Bubble Ratio: 67.02%, 23.10%, 33.29%, 23.85%
[rank3]:2025-10-29 07:45:09,397 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0745_stage3_step1500.svg
[rank0]:2025-10-29 07:45:09,796 - INFO - Avg. fwd time: 15.2620 / Avg. bwd time: 8.4733 / Avg. batch time: 538.5996 (ms) / GPU bubble ratio: 64.75%
[rank3]:2025-10-29 07:45:09,734 - INFO - Avg. fwd time: 16.6684 / Avg. bwd time: 20.3657 / Avg. batch time: 311.7560 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:45:09,787 - INFO - Avg. fwd time: 17.3875 / Avg. bwd time: 20.0116 / Avg. batch time: 505.7525 (ms) / GPU bubble ratio: 40.84%
[rank2]:2025-10-29 07:45:09,759 - INFO - Avg. fwd time: 15.0217 / Avg. bwd time: 17.4337 / Avg. batch time: 458.1387 (ms) / GPU bubble ratio: 43.33%
[rank0]:2025-10-29 07:46:48,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:46:50,212 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank0]:2025-10-29 07:46:50,212 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank1]:2025-10-29 07:46:50,213 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank0]:2025-10-29 07:46:50,315 - INFO - Avg. fwd time: 15.2820 / Avg. bwd time: 8.2266 / Avg. batch time: 537.3716 (ms) / GPU bubble ratio: 65.00%
[rank3]:2025-10-29 07:46:54,824 - INFO -  step: 1550  loss:  1.1869  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,751  tflops: 361.53  mfu: 36.55%
[rank3]:2025-10-29 07:46:55,096 - INFO - Avg. fwd time: 16.6880 / Avg. bwd time: 20.3344 / Avg. batch time: 311.6573 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:46:55,116 - INFO - Avg. fwd time: 15.0360 / Avg. bwd time: 17.4019 / Avg. batch time: 457.6757 (ms) / GPU bubble ratio: 43.30%
[rank1]:2025-10-29 07:46:55,142 - INFO - Avg. fwd time: 17.4072 / Avg. bwd time: 19.9761 / Avg. batch time: 505.0054 (ms) / GPU bubble ratio: 40.78%
[rank0]:2025-10-29 07:48:32,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:48:35,101 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank2_trend_line.svg
[rank0]:2025-10-29 07:48:35,121 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank0_trend_line.svg
[rank0]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank0]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:48:35,089 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank3_trend_line.svg
[rank1]:2025-10-29 07:48:35,143 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank1_trend_line.svg
[rank1]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank1]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.70/0.70, [MB2] 0.75/0.75, [MB3] 0.80/0.80, [MB4] 0.85/0.85, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank2]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:48:35,343 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0748_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.71 ms, GPU Bubble Ratio: 53.04%, 23.66%, 32.81%, 24.31%
[rank3]:2025-10-29 07:48:35,343 - INFO - 	> Batch Time: 355.71 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:48:35,344 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:48:39,933 - INFO -  step: 1600  loss:  0.6898  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,794  tflops: 363.51  mfu: 36.76%
[rank3]:2025-10-29 07:48:39,934 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 07:48:56,382 - INFO - validate step: 1600  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,294
[rank2]:2025-10-29 07:48:56,435 - INFO - validate step: 1600  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,247
[rank3]:2025-10-29 07:48:56,449 - INFO - validate step: 1600  loss:  0.3538  memory: 84.24GiB(60.25%)  tps: 24,803
[rank1]:2025-10-29 07:48:56,419 - INFO - validate step: 1600  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,261
[rank2]:2025-10-29 07:48:56,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0748_stage2_step1600.svg
[rank0]:2025-10-29 07:48:56,534 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0748_stage0_step1600.svg
[rank1]:2025-10-29 07:48:56,535 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0748_stage1_step1600.svg
[rank0]:2025-10-29 07:48:56,624 - INFO - Avg. fwd time: 15.2996 / Avg. bwd time: 7.9564 / Avg. batch time: 536.1473 (ms) / GPU bubble ratio: 65.30%
[rank3]:2025-10-29 07:48:56,640 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0748_real_step1600_rank3.svg
[rank3]:> Batch Time: 373.78 ms, GPU Bubble Ratio: 67.01%, 23.12%, 33.34%, 23.81%
[rank3]:2025-10-29 07:48:56,710 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0748_stage3_step1600.svg
[rank3]:2025-10-29 07:48:56,960 - INFO - Avg. fwd time: 16.7039 / Avg. bwd time: 20.2947 / Avg. batch time: 311.4613 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:48:57,006 - INFO - Avg. fwd time: 17.4234 / Avg. bwd time: 19.9333 / Avg. batch time: 504.3112 (ms) / GPU bubble ratio: 40.74%
[rank2]:2025-10-29 07:48:56,980 - INFO - Avg. fwd time: 15.0472 / Avg. bwd time: 17.3631 / Avg. batch time: 457.2977 (ms) / GPU bubble ratio: 43.30%
[rank0]:2025-10-29 07:50:30,813 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,536  tflops: 398.11  mfu: 40.25%
[rank1]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,539  tflops: 398.26  mfu: 40.27%
[rank2]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank3]:2025-10-29 07:50:36,945 - INFO -  step: 1650  loss:  0.6963  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,152  tflops: 380.20  mfu: 38.44%
[rank3]:2025-10-29 07:50:37,257 - INFO - Avg. fwd time: 16.6958 / Avg. bwd time: 20.2375 / Avg. batch time: 310.9290 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:50:37,283 - INFO - Avg. fwd time: 15.0427 / Avg. bwd time: 17.3151 / Avg. batch time: 456.6701 (ms) / GPU bubble ratio: 43.32%
[rank0]:2025-10-29 07:50:37,322 - INFO - Avg. fwd time: 15.2983 / Avg. bwd time: 7.7034 / Avg. batch time: 534.6982 (ms) / GPU bubble ratio: 65.59%
[rank1]:2025-10-29 07:50:37,311 - INFO - Avg. fwd time: 17.4179 / Avg. bwd time: 19.8787 / Avg. batch time: 503.3706 (ms) / GPU bubble ratio: 40.72%
[rank0]:2025-10-29 07:52:10,549 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:52:12,065 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank2]:2025-10-29 07:52:12,064 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank0]:2025-10-29 07:52:12,064 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank3]:2025-10-29 07:52:16,639 - INFO -  step: 1700  loss:  0.7020  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,217  tflops: 383.26  mfu: 38.75%
[rank0]:2025-10-29 07:52:16,724 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0752_stage0_step1700.svg
[rank1]:2025-10-29 07:52:16,723 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0752_stage1_step1700.svg
[rank2]:2025-10-29 07:52:16,725 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0752_stage2_step1700.svg
[rank0]:2025-10-29 07:52:16,816 - INFO - Avg. fwd time: 15.2962 / Avg. bwd time: 7.4990 / Avg. batch time: 533.2356 (ms) / GPU bubble ratio: 65.80%
[rank3]:2025-10-29 07:52:16,827 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0752_real_step1700_rank3.svg
[rank3]:> Batch Time: 373.11 ms, GPU Bubble Ratio: 67.00%, 23.09%, 33.31%, 23.84%
[rank3]:2025-10-29 07:52:16,896 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0752_stage3_step1700.svg
[rank3]:2025-10-29 07:52:17,140 - INFO - Avg. fwd time: 16.6886 / Avg. bwd time: 20.1902 / Avg. batch time: 310.4843 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 07:52:17,158 - INFO - Avg. fwd time: 15.0388 / Avg. bwd time: 17.2758 / Avg. batch time: 455.8732 (ms) / GPU bubble ratio: 43.29%
[rank1]:2025-10-29 07:52:17,183 - INFO - Avg. fwd time: 17.4124 / Avg. bwd time: 19.8339 / Avg. batch time: 502.3201 (ms) / GPU bubble ratio: 40.68%
[rank0]:2025-10-29 07:53:50,368 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:53:51,886 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank1]:2025-10-29 07:53:51,887 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank2]:2025-10-29 07:53:51,886 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank0]:2025-10-29 07:53:51,979 - INFO - Avg. fwd time: 15.2942 / Avg. bwd time: 7.2739 / Avg. batch time: 531.2052 (ms) / GPU bubble ratio: 66.01%
[rank3]:2025-10-29 07:53:56,458 - INFO -  step: 1750  loss:  0.7026  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,207  tflops: 382.78  mfu: 38.70%
[rank3]:2025-10-29 07:53:56,707 - INFO - Avg. fwd time: 16.6810 / Avg. bwd time: 20.1385 / Avg. batch time: 309.9998 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:53:56,751 - INFO - Avg. fwd time: 17.4066 / Avg. bwd time: 19.7843 / Avg. batch time: 500.7436 (ms) / GPU bubble ratio: 40.58%
[rank2]:2025-10-29 07:53:56,726 - INFO - Avg. fwd time: 15.0345 / Avg. bwd time: 17.2324 / Avg. batch time: 454.5793 (ms) / GPU bubble ratio: 43.21%
[rank0]:2025-10-29 07:55:29,872 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:55:31,399 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank1]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:55:31,398 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank2]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:55:31,399 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank0]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 07:55:35,964 - INFO -  step: 1800  loss:  0.6912  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,233  tflops: 383.98  mfu: 38.83%
[rank3]:2025-10-29 07:55:35,965 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:55:52,582 - INFO - validate step: 1800  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,336
[rank0]:2025-10-29 07:55:52,530 - INFO - validate step: 1800  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,384
[rank3]:2025-10-29 07:55:52,594 - INFO - validate step: 1800  loss:  0.3519  memory: 84.24GiB(60.25%)  tps: 24,633
[rank1]:2025-10-29 07:55:52,566 - INFO - validate step: 1800  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,351
[rank2]:2025-10-29 07:55:52,679 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0755_stage2_step1800.svg
[rank0]:2025-10-29 07:55:52,680 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0755_stage0_step1800.svg
[rank1]:2025-10-29 07:55:52,683 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0755_stage1_step1800.svg
[rank3]:2025-10-29 07:55:52,780 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0755_real_step1800_rank3.svg
[rank3]:> Batch Time: 372.56 ms, GPU Bubble Ratio: 67.00%, 23.08%, 33.27%, 23.85%
[rank3]:2025-10-29 07:55:52,848 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0755_stage3_step1800.svg
[rank2]:2025-10-29 07:55:53,185 - INFO - Avg. fwd time: 15.0302 / Avg. bwd time: 17.1914 / Avg. batch time: 453.9659 (ms) / GPU bubble ratio: 43.22%
[rank3]:2025-10-29 07:55:53,160 - INFO - Avg. fwd time: 16.6734 / Avg. bwd time: 20.0891 / Avg. batch time: 309.5351 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:55:53,214 - INFO - Avg. fwd time: 17.4004 / Avg. bwd time: 19.7372 / Avg. batch time: 499.8636 (ms) / GPU bubble ratio: 40.56%
[rank0]:2025-10-29 07:55:53,226 - INFO - Avg. fwd time: 15.2921 / Avg. bwd time: 7.0618 / Avg. batch time: 529.8987 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-10-29 07:57:26,432 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:57:27,967 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,584  tflops: 400.35  mfu: 40.48%
[rank1]:2025-10-29 07:57:27,967 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,587  tflops: 400.50  mfu: 40.50%
[rank2]:2025-10-29 07:57:27,966 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,588  tflops: 400.57  mfu: 40.50%
[rank0]:2025-10-29 07:57:28,059 - INFO - Avg. fwd time: 15.2912 / Avg. bwd time: 6.8897 / Avg. batch time: 528.6743 (ms) / GPU bubble ratio: 66.44%
[rank3]:2025-10-29 07:57:32,551 - INFO -  step: 1850  loss:  0.6855  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,196  tflops: 382.25  mfu: 38.65%
[rank2]:2025-10-29 07:57:32,819 - INFO - Avg. fwd time: 15.0273 / Avg. bwd time: 17.1590 / Avg. batch time: 453.2997 (ms) / GPU bubble ratio: 43.20%
[rank3]:2025-10-29 07:57:32,799 - INFO - Avg. fwd time: 16.6681 / Avg. bwd time: 20.0502 / Avg. batch time: 309.1748 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:57:32,844 - INFO - Avg. fwd time: 17.3968 / Avg. bwd time: 19.7006 / Avg. batch time: 498.9856 (ms) / GPU bubble ratio: 40.52%
[rank0]:2025-10-29 07:59:06,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:59:07,628 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,220  tflops: 383.37  mfu: 38.76%
[rank0]:2025-10-29 07:59:07,628 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,220  tflops: 383.38  mfu: 38.76%
[rank1]:2025-10-29 07:59:07,629 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,220  tflops: 383.38  mfu: 38.76%
[rank3]:2025-10-29 07:59:12,228 - INFO -  step: 1900  loss:  0.6965  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,219  tflops: 383.32  mfu: 38.76%
[rank2]:2025-10-29 07:59:12,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0759_stage2_step1900.svg
[rank0]:2025-10-29 07:59:12,314 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0759_stage0_step1900.svg
[rank1]:2025-10-29 07:59:12,313 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0759_stage1_step1900.svg
[rank0]:2025-10-29 07:59:12,406 - INFO - Avg. fwd time: 15.2896 / Avg. bwd time: 6.6992 / Avg. batch time: 527.5027 (ms) / GPU bubble ratio: 66.65%
[rank3]:2025-10-29 07:59:12,413 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0759_real_step1900_rank3.svg
[rank3]:> Batch Time: 372.01 ms, GPU Bubble Ratio: 67.00%, 23.05%, 33.25%, 23.84%
[rank3]:2025-10-29 07:59:12,483 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0759_stage3_step1900.svg
[rank3]:2025-10-29 07:59:12,734 - INFO - Avg. fwd time: 16.6613 / Avg. bwd time: 20.0062 / Avg. batch time: 308.7603 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:59:12,779 - INFO - Avg. fwd time: 17.3918 / Avg. bwd time: 19.6588 / Avg. batch time: 498.1979 (ms) / GPU bubble ratio: 40.50%
[rank2]:2025-10-29 07:59:12,753 - INFO - Avg. fwd time: 15.0235 / Avg. bwd time: 17.1221 / Avg. batch time: 452.7498 (ms) / GPU bubble ratio: 43.20%
[rank0]:2025-10-29 08:00:46,077 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:00:47,639 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank2]:2025-10-29 08:00:47,638 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank0]:2025-10-29 08:00:47,638 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank3]:2025-10-29 08:00:52,226 - INFO -  step: 1950  loss:  0.7139  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.09  mfu: 38.63%
[rank3]:2025-10-29 08:00:52,545 - INFO - Avg. fwd time: 16.6552 / Avg. bwd time: 19.9651 / Avg. batch time: 308.3756 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 08:00:52,573 - INFO - Avg. fwd time: 15.0201 / Avg. bwd time: 17.0877 / Avg. batch time: 452.2737 (ms) / GPU bubble ratio: 43.21%
[rank0]:2025-10-29 08:00:52,614 - INFO - Avg. fwd time: 15.2883 / Avg. bwd time: 6.5190 / Avg. batch time: 526.4399 (ms) / GPU bubble ratio: 66.86%
[rank1]:2025-10-29 08:00:52,602 - INFO - Avg. fwd time: 17.3869 / Avg. bwd time: 19.6195 / Avg. batch time: 497.4975 (ms) / GPU bubble ratio: 40.49%
[rank0]:2025-10-29 08:02:25,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank2]:2025-10-29 08:02:27,270 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank0]:2025-10-29 08:02:27,270 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank1]:2025-10-29 08:02:27,271 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 08:02:31,872 - INFO -  step: 2000  loss:  0.6918  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,221  tflops: 383.44  mfu: 38.77%
[rank3]:2025-10-29 08:02:31,872 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 08:02:48,330 - INFO - validate step: 2000  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,450
[rank2]:2025-10-29 08:02:48,383 - INFO - validate step: 2000  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,401
[rank3]:2025-10-29 08:02:48,394 - INFO - validate step: 2000  loss:  0.3541  memory: 84.24GiB(60.25%)  tps: 24,792
[rank1]:2025-10-29 08:02:48,367 - INFO - validate step: 2000  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,416
[rank2]:2025-10-29 08:02:48,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0802_stage2_step2000.svg
[rank0]:2025-10-29 08:02:48,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0802_stage0_step2000.svg
[rank1]:2025-10-29 08:02:48,481 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0802_stage1_step2000.svg
[rank0]:2025-10-29 08:02:48,575 - INFO - Avg. fwd time: 15.2866 / Avg. bwd time: 6.3720 / Avg. batch time: 525.3640 (ms) / GPU bubble ratio: 67.02%
[rank3]:2025-10-29 08:02:48,578 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0802_real_step2000_rank3.svg
[rank3]:> Batch Time: 371.60 ms, GPU Bubble Ratio: 67.00%, 23.03%, 33.24%, 23.85%
[rank3]:2025-10-29 08:02:48,651 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0802_stage3_step2000.svg
[rank2]:2025-10-29 08:02:48,924 - INFO - Avg. fwd time: 15.0170 / Avg. bwd time: 17.0589 / Avg. batch time: 451.6800 (ms) / GPU bubble ratio: 43.19%
[rank3]:2025-10-29 08:02:48,904 - INFO - Avg. fwd time: 16.6498 / Avg. bwd time: 19.9306 / Avg. batch time: 308.0497 (ms) / GPU bubble ratio: 5.00%
[rank1]:2025-10-29 08:02:48,950 - INFO - Avg. fwd time: 17.3825 / Avg. bwd time: 19.5866 / Avg. batch time: 496.7183 (ms) / GPU bubble ratio: 40.46%
[rank0]:2025-10-29 08:04:22,351 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:04:23,901 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,572  tflops: 399.78  mfu: 40.42%
[rank2]:2025-10-29 08:04:23,900 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,576  tflops: 400.01  mfu: 40.45%
[rank1]:2025-10-29 08:04:23,901 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,575  tflops: 399.94  mfu: 40.44%
[rank0]:2025-10-29 08:04:23,993 - INFO - Avg. fwd time: 15.2858 / Avg. bwd time: 6.2087 / Avg. batch time: 523.8529 (ms) / GPU bubble ratio: 67.17%
[rank3]:2025-10-29 08:04:28,393 - INFO -  step: 2050  loss:  0.7268  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.09  mfu: 38.63%
[rank3]:2025-10-29 08:04:28,638 - INFO - Avg. fwd time: 16.6447 / Avg. bwd time: 19.8942 / Avg. batch time: 307.7113 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 08:04:28,658 - INFO - Avg. fwd time: 15.0142 / Avg. bwd time: 17.0282 / Avg. batch time: 450.6982 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:04:28,682 - INFO - Avg. fwd time: 17.3793 / Avg. bwd time: 19.5520 / Avg. batch time: 495.5350 (ms) / GPU bubble ratio: 40.38%
[rank0]:2025-10-29 08:06:01,880 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:06:03,400 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank0]:2025-10-29 08:06:03,399 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank2]:2025-10-29 08:06:03,400 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank3]:2025-10-29 08:06:07,971 - INFO -  step: 2100  loss:  0.7099  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,227  tflops: 383.70  mfu: 38.80%
[rank0]:2025-10-29 08:06:08,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0806_stage0_step2100.svg
[rank2]:2025-10-29 08:06:08,051 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0806_stage2_step2100.svg
[rank1]:2025-10-29 08:06:08,053 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0806_stage1_step2100.svg
[rank3]:2025-10-29 08:06:08,157 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0806_real_step2100_rank3.svg
[rank3]:> Batch Time: 371.28 ms, GPU Bubble Ratio: 67.00%, 23.01%, 33.22%, 23.85%
[rank3]:2025-10-29 08:06:08,220 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0806_stage3_step2100.svg
[rank3]:2025-10-29 08:06:08,528 - INFO - Avg. fwd time: 16.6394 / Avg. bwd time: 19.8583 / Avg. batch time: 307.3752 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:06:08,555 - INFO - Avg. fwd time: 15.0112 / Avg. bwd time: 16.9983 / Avg. batch time: 450.2723 (ms) / GPU bubble ratio: 43.13%
[rank1]:2025-10-29 08:06:08,585 - INFO - Avg. fwd time: 17.3752 / Avg. bwd time: 19.5179 / Avg. batch time: 494.9167 (ms) / GPU bubble ratio: 40.36%
[rank0]:2025-10-29 08:06:08,596 - INFO - Avg. fwd time: 15.2847 / Avg. bwd time: 6.0536 / Avg. batch time: 522.9241 (ms) / GPU bubble ratio: 67.36%
[rank0]:2025-10-29 08:07:41,704 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:07:43,232 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank2]:2025-10-29 08:07:43,232 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank1]:2025-10-29 08:07:43,233 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank0]:2025-10-29 08:07:43,327 - INFO - Avg. fwd time: 15.2837 / Avg. bwd time: 5.9267 / Avg. batch time: 522.0114 (ms) / GPU bubble ratio: 67.49%
[rank3]:2025-10-29 08:07:47,828 - INFO -  step: 2150  loss:  0.7396  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,204  tflops: 382.63  mfu: 38.69%
[rank3]:2025-10-29 08:07:48,077 - INFO - Avg. fwd time: 16.6351 / Avg. bwd time: 19.8296 / Avg. batch time: 307.1060 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:07:48,096 - INFO - Avg. fwd time: 15.0088 / Avg. bwd time: 16.9741 / Avg. batch time: 449.7761 (ms) / GPU bubble ratio: 43.11%
[rank1]:2025-10-29 08:07:48,121 - INFO - Avg. fwd time: 17.3719 / Avg. bwd time: 19.4901 / Avg. batch time: 494.2598 (ms) / GPU bubble ratio: 40.34%
[rank0]:2025-10-29 08:09:21,172 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank0]:2025-10-29 08:09:22,698 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank2]:2025-10-29 08:09:22,698 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank1]:2025-10-29 08:09:22,699 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 08:09:27,334 - INFO -  step: 2200  loss:  0.7021  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,233  tflops: 383.98  mfu: 38.83%
[rank3]:2025-10-29 08:09:27,335 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 08:09:43,798 - INFO - validate step: 2200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,413
[rank3]:2025-10-29 08:09:43,862 - INFO - validate step: 2200  loss:  0.3521  memory: 84.24GiB(60.25%)  tps: 24,785
[rank2]:2025-10-29 08:09:43,851 - INFO - validate step: 2200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,364
[rank1]:2025-10-29 08:09:43,834 - INFO - validate step: 2200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,380
[rank0]:2025-10-29 08:09:43,947 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0809_stage0_step2200.svg
[rank2]:2025-10-29 08:09:43,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0809_stage2_step2200.svg
[rank1]:2025-10-29 08:09:43,945 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0809_stage1_step2200.svg
[rank0]:2025-10-29 08:09:44,042 - INFO - Avg. fwd time: 15.2819 / Avg. bwd time: 5.7852 / Avg. batch time: 521.1466 (ms) / GPU bubble ratio: 67.66%
[rank3]:2025-10-29 08:09:44,054 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0809_real_step2200_rank3.svg
[rank3]:> Batch Time: 370.90 ms, GPU Bubble Ratio: 66.99%, 23.00%, 33.21%, 23.85%
[rank3]:2025-10-29 08:09:44,119 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0809_stage3_step2200.svg
[rank3]:2025-10-29 08:09:44,367 - INFO - Avg. fwd time: 16.6300 / Avg. bwd time: 19.7964 / Avg. batch time: 306.7933 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:09:44,387 - INFO - Avg. fwd time: 15.0058 / Avg. bwd time: 16.9464 / Avg. batch time: 449.3734 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:09:44,410 - INFO - Avg. fwd time: 17.3677 / Avg. bwd time: 19.4588 / Avg. batch time: 493.6807 (ms) / GPU bubble ratio: 40.32%
[rank0]:2025-10-29 08:11:17,766 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:11:19,305 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,577  tflops: 400.05  mfu: 40.45%
[rank2]:2025-10-29 08:11:19,305 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,582  tflops: 400.27  mfu: 40.47%
[rank1]:2025-10-29 08:11:19,306 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,581  tflops: 400.20  mfu: 40.47%
[rank3]:2025-10-29 08:11:23,867 - INFO -  step: 2250  loss:  0.7197  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.06  mfu: 38.63%
[rank3]:2025-10-29 08:11:24,184 - INFO - Avg. fwd time: 16.6254 / Avg. bwd time: 19.7653 / Avg. batch time: 306.5025 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 08:11:24,214 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 16.9205 / Avg. batch time: 449.0257 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:11:24,245 - INFO - Avg. fwd time: 17.3645 / Avg. bwd time: 19.4295 / Avg. batch time: 493.1663 (ms) / GPU bubble ratio: 40.31%
[rank0]:2025-10-29 08:11:24,259 - INFO - Avg. fwd time: 15.2811 / Avg. bwd time: 5.6503 / Avg. batch time: 520.3621 (ms) / GPU bubble ratio: 67.82%
[rank0]:2025-10-29 08:12:57,673 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:12:59,219 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank1]:2025-10-29 08:12:59,220 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank2]:2025-10-29 08:12:59,219 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank3]:2025-10-29 08:13:03,812 - INFO -  step: 2300  loss:  0.6980  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,197  tflops: 382.29  mfu: 38.65%
[rank0]:2025-10-29 08:13:03,898 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0812_stage0_step2300.svg
[rank1]:2025-10-29 08:13:03,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0812_stage1_step2300.svg
[rank2]:2025-10-29 08:13:03,898 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0812_stage2_step2300.svg
[rank3]:2025-10-29 08:13:04,005 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0813_real_step2300_rank3.svg
[rank3]:> Batch Time: 370.65 ms, GPU Bubble Ratio: 66.99%, 22.99%, 33.20%, 23.85%
[rank0]:2025-10-29 08:13:03,991 - INFO - Avg. fwd time: 15.2801 / Avg. bwd time: 5.5396 / Avg. batch time: 519.5830 (ms) / GPU bubble ratio: 67.94%
[rank3]:2025-10-29 08:13:04,070 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0813_stage3_step2300.svg
[rank3]:2025-10-29 08:13:04,320 - INFO - Avg. fwd time: 16.6218 / Avg. bwd time: 19.7400 / Avg. batch time: 306.2664 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 08:13:04,339 - INFO - Avg. fwd time: 15.0014 / Avg. bwd time: 16.8995 / Avg. batch time: 448.6079 (ms) / GPU bubble ratio: 43.11%
[rank1]:2025-10-29 08:13:04,365 - INFO - Avg. fwd time: 17.3616 / Avg. bwd time: 19.4052 / Avg. batch time: 492.6098 (ms) / GPU bubble ratio: 40.29%
[rank0]:2025-10-29 08:14:37,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:14:39,201 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank1]:2025-10-29 08:14:39,200 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank2]:2025-10-29 08:14:39,200 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank0]:2025-10-29 08:14:39,296 - INFO - Avg. fwd time: 15.2790 / Avg. bwd time: 5.4158 / Avg. batch time: 518.3767 (ms) / GPU bubble ratio: 68.06%
[rank3]:2025-10-29 08:14:43,792 - INFO -  step: 2350  loss:  0.7101  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,194  tflops: 382.16  mfu: 38.64%
[rank3]:2025-10-29 08:14:44,047 - INFO - Avg. fwd time: 16.6176 / Avg. bwd time: 19.7116 / Avg. batch time: 306.0014 (ms) / GPU bubble ratio: 5.02%
[rank1]:2025-10-29 08:14:44,092 - INFO - Avg. fwd time: 17.3583 / Avg. bwd time: 19.3779 / Avg. batch time: 491.6525 (ms) / GPU bubble ratio: 40.22%
[rank2]:2025-10-29 08:14:44,067 - INFO - Avg. fwd time: 14.9991 / Avg. bwd time: 16.8758 / Avg. batch time: 447.8077 (ms) / GPU bubble ratio: 43.06%
[rank0]:2025-10-29 08:16:17,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:16:18,844 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,221  tflops: 383.44  mfu: 38.77%
[rank1]:2025-10-29 08:16:18,844 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,752  tflops: 361.55  mfu: 35.71%
[rank1]:2025-10-29 08:16:18,844 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 08:16:18,843 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,221  tflops: 383.45  mfu: 38.77%
[rank0]:2025-10-29 08:16:18,843 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,751  tflops: 361.53  mfu: 35.71%
[rank0]:2025-10-29 08:16:18,843 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 08:16:18,843 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,221  tflops: 383.45  mfu: 38.77%
[rank2]:2025-10-29 08:16:18,844 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,753  tflops: 361.58  mfu: 35.72%
[rank2]:2025-10-29 08:16:18,844 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 08:16:23,429 - INFO -  step: 2400  loss:  0.6894  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,222  tflops: 383.48  mfu: 38.77%
[rank3]:2025-10-29 08:16:23,429 - INFO -  final step: 2400  loss:  0.6894  grad_norm:  0.0000  tps: 7,667  tflops: 357.61  mfu: 35.31%
[rank3]:2025-10-29 08:16:23,429 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 08:16:39,903 - INFO - validate step: 2400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,451
[rank1]:2025-10-29 08:16:39,904 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 08:16:39,909 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 08:16:39,865 - INFO - validate step: 2400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,485
[rank0]:2025-10-29 08:16:39,866 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 08:16:39,869 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 08:16:39,920 - INFO - validate step: 2400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,434
[rank2]:2025-10-29 08:16:39,921 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:16:39,924 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 08:16:39,927 - INFO - validate step: 2400  loss:  0.3534  memory: 84.24GiB(60.25%)  tps: 24,829
[rank3]:2025-10-29 08:16:39,928 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 08:16:39,930 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 08:16:50,898 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 08:16:50,991 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0816_stage1_final2400.svg
[rank0]:2025-10-29 08:16:51,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0816_stage0_final2400.svg
[rank2]:2025-10-29 08:16:50,994 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0816_stage2_final2400.svg
[rank3]:2025-10-29 08:16:51,107 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0816_real_final2400_rank3.svg
[rank3]:> Batch Time: 370.43 ms, GPU Bubble Ratio: 66.98%, 22.98%, 33.19%, 23.86%
[rank2]:2025-10-29 08:16:51,246 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank2_stage2.svg
[rank2]:	> Counts Sum: 892480, Total Sum: 5368320 (16.62%), Ratio(%) per element: [16.84, 15.66, 18.07, 17.0, 15.98, 16.41, 17.27, 17.27, 15.93, 16.46, 16.3, 15.12, 15.93, 17.75, 17.75, 16.36, 16.36, 14.59, 16.63, 15.77, 16.79, 16.57, 17.16, 17.22, 15.55, 15.93, 16.79, 16.73, 17.75, 17.22, 17.0, 17.22, 17.38, 17.22, 15.98, 17.43, 17.65, 16.36, 16.73, 15.23, 17.48, 15.66, 16.41, 17.38, 16.25, 17.65, 16.63, 15.98, 16.41, 15.87, 15.82, 16.3, 16.09, 16.41, 17.43, 17.91, 16.09, 16.68, 16.52, 16.95, 17.11, 16.09, 15.98, 16.04, 17.7, 18.18, 15.23, 16.41, 16.63, 16.46, 16.09, 17.43]
[rank2]:2025-10-29 08:16:51,246 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 08:16:51,290 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0816_thry_final2400_rank3.svg
[rank3]:> Batch Time: 528.42 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-10-29 08:16:51,240 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank1_stage1.svg
[rank1]:	> Counts Sum: 108960, Total Sum: 6039360 (1.80%), Ratio(%) per element: [1.6, 1.98, 1.87, 2.03, 1.6, 1.66, 2.09, 1.71, 2.09, 1.77, 1.98, 1.39, 2.03, 1.77, 1.34, 2.03, 1.82, 1.82, 1.82, 1.6, 1.5, 1.66, 2.46, 1.77, 1.77, 1.5, 1.93, 2.25, 2.03, 2.3, 1.71, 1.6, 1.87, 1.44, 2.3, 2.03, 1.39, 1.82, 1.82, 1.77, 1.87, 2.03, 1.82, 1.93, 1.71, 1.82, 2.14, 1.71, 1.66, 1.5, 2.14, 1.87, 1.66, 1.66, 1.93, 1.98, 1.39, 1.44, 2.14, 2.03, 2.14, 1.66, 2.14, 1.5, 1.77, 1.77, 1.77, 1.93, 1.82, 1.55, 1.44, 1.93, 1.93, 1.87, 2.09, 1.77, 1.44, 1.66, 1.82, 2.03, 0.37]
[rank1]:2025-10-29 08:16:51,241 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 08:16:51,308 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank0_stage0.svg
[rank0]:	> Counts Sum: 4611840, Total Sum: 5442880 (84.73%), Ratio(%) per element: [85.03, 84.44, 84.71, 84.6, 84.97, 84.44, 84.49, 84.81, 84.44, 84.97, 84.81, 84.65, 84.49, 84.6, 85.08, 84.71, 84.81, 85.24, 84.92, 85.08, 84.38, 84.87, 84.49, 84.65, 84.81, 84.65, 84.65, 84.6, 85.3, 84.49, 84.33, 84.76, 84.81, 84.44, 84.38, 84.6, 84.76, 84.76, 84.6, 84.71, 84.49, 84.6, 84.6, 84.76, 84.76, 84.92, 84.71, 84.71, 84.97, 84.76, 84.71, 84.92, 84.65, 84.87, 84.76, 84.71, 85.03, 84.81, 84.6, 84.92, 84.97, 84.92, 84.6, 84.44, 84.65, 85.13, 84.65, 84.54, 85.03, 84.6, 84.97, 84.6, 84.38]
[rank0]:2025-10-29 08:16:51,308 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 08:16:51,372 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0816_stage3_final2400.svg
[rank3]:2025-10-29 08:16:51,616 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.5, 1.55, 1.6, 1.5, 1.66, 1.44, 1.87, 1.5, 1.98, 1.77, 1.87, 1.82, 1.28, 1.34, 1.82, 1.66, 1.71, 1.5, 1.5, 1.66, 1.12, 1.77, 1.71, 1.82, 1.6, 1.28, 1.93, 1.39, 1.6, 1.82, 1.44, 1.93, 1.66, 1.77, 1.82, 1.66, 1.98, 1.44, 1.5, 1.28, 1.93, 1.6, 1.87, 1.5, 1.82, 1.55, 1.82, 1.39, 1.93, 1.28, 1.87, 1.66, 1.6, 1.55, 1.71, 1.55, 1.6, 1.77, 1.34, 1.23, 1.44, 0.91, 1.28, 1.44, 0.0]
[rank3]:2025-10-29 08:16:51,617 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.13685
[rank3]:wandb:               final/avg_loss 0.6894
[rank3]:wandb:             final/avg_mfu(%) 35.31101
[rank3]:wandb:             final/avg_tflops 357.60658
[rank3]:wandb:    final/avg_throughput(tps) 7667.35305
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.6894
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.6894
[rank3]:wandb: loss_metrics/global_max_loss 0.6894
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/q8s4zzdk
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyapf_dm1/20251029-0646/wandb/run-20251029_064604-q8s4zzdk/logs
[rank0]:2025-10-29 08:16:53,308 - INFO - Training completed
[rank0]:2025-10-29 08:16:53,308 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 08:16:53,561 - INFO - Process group destroyed
[rank1]:2025-10-29 08:16:53,554 - INFO - Process group destroyed
[rank2]:2025-10-29 08:16:53,586 - INFO - Process group destroyed
[rank0]:2025-10-29 08:16:53,689 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.10', 'layers.13', 'layers.15', 'layers.9', 'layers.12', 'layers.16', 'layers.8', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.7', 'layers.6', 'layers.3', 'tok_embeddings', 'layers.5', 'layers.2', 'layers.1', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.20', 'layers.17', 'layers.22', 'layers.24', 'layers.19', 'layers.18', 'layers.21', 'layers.23'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.31', 'layers.26', 'output', 'layers.25', 'layers.30', 'layers.27', 'layers.28', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 08:17:02 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] 
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] *****************************************
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 08:17:03.662000 1754845 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-10-29 08:17:09,457 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 08:17:09,483 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 08:17:09,470 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 08:17:09,466 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 08:17:10,483 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 08:17:10,485 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 08:17:10,466 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 08:17:10,468 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 08:17:10,475 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 08:17:10,477 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 08:17:10,476 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 08:17:10,479 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 08:17:10,483 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 08:17:12,359 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 08:17:12,631 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 08:17:14,213 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank1]:2025-10-29 08:17:15,798 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:15,765 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-29 08:17:15,871 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 08:17:15,871 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 08:17:16,015 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:16,024 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 08:17:16,090 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 08:17:16,113 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 08:17:16,113 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 08:17:16,102 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 08:17:16,102 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 08:17:16,211 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 08:17:16,212 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 08:17:16,359 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 08:17:16,359 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 08:17:16,342 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 08:17:16,343 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run am0tnl8r
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1/20251029-0817/wandb/run-20251029_081716-am0tnl8r
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/am0tnl8r
[rank3]:2025-10-29 08:17:17,944 - INFO - WandB logging enabled
[rank3]:2025-10-29 08:17:17,945 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 08:17:18,020 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 08:17:18,021 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 08:17:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 08:17:18,372 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 08:17:18,372 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 08:17:18,384 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 08:17:18,387 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-29 08:17:18,387 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 08:17:18,388 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 08:17:18,387 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 08:17:21,739 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank3]:2025-10-29 08:17:22,141 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank2]:2025-10-29 08:17:22,172 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank0]:2025-10-29 08:17:22,296 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 08:17:22,296 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1.
[rank0]:2025-10-29 08:17:22,296 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400.
[rank0]:2025-10-29 08:17:31,010 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 08:17:31,010 - INFO - Finished loading the checkpoint in 8.71 seconds.
[rank0]:2025-10-29 08:17:31,011 - INFO - Training starts at step 1
[rank1]:2025-10-29 08:17:35,820 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 49.69GiB(35.54%)  tps: 820  tflops: 38.26  mfu: 3.87%
[rank1]:2025-10-29 08:17:35,820 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 08:17:35,822 - INFO -  step:  1  loss:  0.9694  grad_norm:  2.3281  memory: 58.03GiB(41.50%)  tps: 919  tflops: 42.87  mfu: 4.33%
[rank3]:2025-10-29 08:17:35,822 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 08:17:35,817 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 44.28GiB(31.67%)  tps: 830  tflops: 38.71  mfu: 3.91%
[rank2]:2025-10-29 08:17:35,817 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 08:17:35,838 - INFO -  step:  1  loss: -4.0000  grad_norm:  2.3281  memory: 49.75GiB(35.58%)  tps: 830  tflops: 38.69  mfu: 3.91%
[rank0]:2025-10-29 08:17:35,838 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 08:17:54,081 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,081 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,082 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,082 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,083 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,084 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,085 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 08:17:54,086 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,124 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,125 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,126 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 08:17:54,127 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,213 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,214 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,215 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,216 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:17:54,216 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,170 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,171 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,172 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 08:17:54,173 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 08:19:45,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:19:48,219 - INFO -  step: 50  loss:  0.8921  grad_norm:  0.5945  memory: 73.38GiB(52.48%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank1]:2025-10-29 08:19:48,217 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 64.32GiB(46.00%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank0]:2025-10-29 08:19:48,221 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 66.72GiB(47.72%)  tps: 6,064  tflops: 282.84  mfu: 28.60%
[rank2]:2025-10-29 08:19:48,214 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5945  memory: 57.29GiB(40.97%)  tps: 6,064  tflops: 282.81  mfu: 28.60%
[rank3]:2025-10-29 08:19:48,681 - INFO - Avg. fwd time: 14.7311 / Avg. bwd time: 42.9603 / Avg. batch time: 481.0782 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 08:19:48,732 - INFO - Avg. fwd time: 13.2849 / Avg. bwd time: 36.4670 / Avg. batch time: 534.0333 (ms) / GPU bubble ratio: 25.47%
[rank0]:2025-10-29 08:19:48,812 - INFO - Avg. fwd time: 14.2030 / Avg. bwd time: 38.5726 / Avg. batch time: 650.6763 (ms) / GPU bubble ratio: 35.11%
[rank1]:2025-10-29 08:19:48,779 - INFO - Avg. fwd time: 15.4079 / Avg. bwd time: 41.6510 / Avg. batch time: 594.6645 (ms) / GPU bubble ratio: 23.24%
[rank3]:2025-10-29 08:20:15,062 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 08:20:42,146 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 08:20:42,363 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-10-29 08:20:42,479 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,484 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,506 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,494 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,469 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,485 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,503 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,512 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,545 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,528 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,561 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,603 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,643 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,679 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,651 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,689 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,639 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,677 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,717 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,755 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 08:20:42,792 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,727 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,765 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,802 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,711 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,748 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,787 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,715 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:20:42,753 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 08:20:42,840 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,825 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 08:20:42,863 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 08:21:15,729 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 08:21:16,037 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_max_batch_time.svg
[rank3]:> Batch Time: 635.25 ms, GPU Bubble Ratio: 33.04%, 27.14%, 36.75%, 26.69%
[rank3]:2025-10-29 08:21:16,224 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_min_batch_time.svg
[rank3]:> Batch Time: 360.16 ms, GPU Bubble Ratio: 68.64%, 23.38%, 33.95%, 23.98%
[rank3]:2025-10-29 08:21:16,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 360.16 ms, GPU Bubble Ratio: 31.84%, 23.09%, 30.76%, 23.98%
[rank3]:2025-10-29 08:21:16,430 - INFO - 	> Batch Time: 360.16 ms (Average Freeze Ratio: 0.87, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 08:21:31,346 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:21:33,007 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.19/0.58, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 08:21:33,008 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,818  tflops: 364.63  mfu: 36.87%
[rank2]:2025-10-29 08:21:32,987 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.30/0.90, [MB3] 0.31/0.94, [MB4] 0.32/0.96, [MB5] 0.33/0.98, [MB6] 0.33/0.99, [MB7] 0.33/1.00
[rank2]:2025-10-29 08:21:33,005 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,817  tflops: 364.61  mfu: 36.87%
[rank3]:2025-10-29 08:21:32,972 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 08:21:33,006 - INFO -  step: 100  loss:  0.8837  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,818  tflops: 364.63  mfu: 36.87%
[rank1]:2025-10-29 08:21:33,008 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.95, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 08:21:33,008 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,817  tflops: 364.61  mfu: 36.87%
[rank0]:2025-10-29 08:21:33,085 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0821_stage0_step100.svg
[rank2]:2025-10-29 08:21:33,085 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0821_stage2_step100.svg
[rank1]:2025-10-29 08:21:33,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0821_stage1_step100.svg
[rank0]:2025-10-29 08:21:33,187 - INFO - Avg. fwd time: 14.6950 / Avg. bwd time: 27.7886 / Avg. batch time: 580.0868 (ms) / GPU bubble ratio: 41.41%
[rank3]:2025-10-29 08:21:33,191 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0821_real_step100_rank3.svg
[rank3]:> Batch Time: 632.80 ms, GPU Bubble Ratio: 32.97%, 27.20%, 36.63%, 26.62%
[rank3]:2025-10-29 08:21:33,251 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0821_stage3_step100.svg
[rank2]:2025-10-29 08:21:33,536 - INFO - Avg. fwd time: 13.9554 / Avg. bwd time: 30.8540 / Avg. batch time: 480.9322 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-10-29 08:21:33,514 - INFO - Avg. fwd time: 15.5040 / Avg. bwd time: 36.3734 / Avg. batch time: 432.3901 (ms) / GPU bubble ratio: 4.02%
[rank1]:2025-10-29 08:21:33,562 - INFO - Avg. fwd time: 16.2639 / Avg. bwd time: 35.3395 / Avg. batch time: 535.2476 (ms) / GPU bubble ratio: 22.87%
[rank0]:2025-10-29 08:23:20,788 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:23:22,879 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.60/0.90, [MB3] 0.62/0.94, [MB4] 0.64/0.96, [MB5] 0.65/0.98, [MB6] 0.66/0.99, [MB7] 0.67/1.00
[rank2]:2025-10-29 08:23:22,879 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 64.67GiB(46.25%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank0]:2025-10-29 08:23:22,889 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.39/0.58, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 08:23:22,890 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 74.22GiB(53.08%)  tps: 7,455  tflops: 347.71  mfu: 35.16%
[rank3]:2025-10-29 08:23:22,880 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 08:23:22,883 - INFO -  step: 150  loss:  0.8737  grad_norm:  0.3395  memory: 84.49GiB(60.43%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank1]:2025-10-29 08:23:22,881 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.64/0.95, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 08:23:22,882 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.3395  memory: 72.68GiB(51.98%)  tps: 7,456  tflops: 347.74  mfu: 35.16%
[rank2]:2025-10-29 08:23:23,345 - INFO - Avg. fwd time: 14.1601 / Avg. bwd time: 28.7960 / Avg. batch time: 461.3653 (ms) / GPU bubble ratio: 25.51%
[rank3]:2025-10-29 08:23:23,318 - INFO - Avg. fwd time: 15.7215 / Avg. bwd time: 34.0674 / Avg. batch time: 414.9423 (ms) / GPU bubble ratio: 4.01%
[rank0]:2025-10-29 08:23:23,407 - INFO - Avg. fwd time: 14.8232 / Avg. bwd time: 27.5460 / Avg. batch time: 559.4825 (ms) / GPU bubble ratio: 39.42%
[rank1]:2025-10-29 08:23:23,376 - INFO - Avg. fwd time: 16.4974 / Avg. bwd time: 33.1080 / Avg. batch time: 514.6032 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-10-29 08:24:57,088 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:24:58,999 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.90/0.90, [MB3] 0.94/0.94, [MB4] 0.96/0.96, [MB5] 0.98/0.98, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:24:59,000 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 64.67GiB(46.25%)  tps: 8,523  tflops: 397.50  mfu: 40.19%
[rank1]:2025-10-29 08:24:58,998 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:24:59,000 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 08:24:58,999 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 72.99GiB(52.21%)  tps: 8,523  tflops: 397.51  mfu: 40.19%
[rank1]:2025-10-29 08:24:58,999 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 08:24:59,005 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:24:59,007 - INFO -  step: 200  loss:  2.1141  grad_norm: 87.6197  memory: 84.59GiB(60.50%)  tps: 8,522  tflops: 397.49  mfu: 40.19%
[rank0]:2025-10-29 08:24:59,005 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:24:59,007 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 08:24:59,005 - INFO -  step: 200  loss: -4.0000  grad_norm: 87.6197  memory: 75.21GiB(53.80%)  tps: 8,523  tflops: 397.52  mfu: 40.19%
[rank0]:2025-10-29 08:24:59,005 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 08:25:17,849 - INFO - validate step: 200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 21,737
[rank2]:2025-10-29 08:25:17,901 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 21,671
[rank3]:2025-10-29 08:25:17,905 - INFO - validate step: 200  loss:  1.5024  memory: 84.59GiB(60.50%)  tps: 21,676
[rank1]:2025-10-29 08:25:17,886 - INFO - validate step: 200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 21,687
[rank2]:2025-10-29 08:25:17,979 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0825_stage2_step200.svg
[rank0]:2025-10-29 08:25:17,974 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0825_stage0_step200.svg
[rank1]:2025-10-29 08:25:17,978 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0825_stage1_step200.svg
[rank3]:2025-10-29 08:25:18,083 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0825_real_step200_rank3.svg
[rank3]:> Batch Time: 511.41 ms, GPU Bubble Ratio: 32.34%, 27.92%, 38.69%, 27.14%
[rank3]:2025-10-29 08:25:18,148 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0825_stage3_step200.svg
[rank2]:2025-10-29 08:25:18,456 - INFO - Avg. fwd time: 14.3609 / Avg. bwd time: 26.8939 / Avg. batch time: 442.2483 (ms) / GPU bubble ratio: 25.37%
[rank3]:2025-10-29 08:25:18,430 - INFO - Avg. fwd time: 15.9583 / Avg. bwd time: 31.7422 / Avg. batch time: 397.9136 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 08:25:18,492 - INFO - Avg. fwd time: 15.0309 / Avg. bwd time: 25.0929 / Avg. batch time: 536.5669 (ms) / GPU bubble ratio: 40.18%
[rank1]:2025-10-29 08:25:18,487 - INFO - Avg. fwd time: 16.7582 / Avg. bwd time: 30.7420 / Avg. batch time: 494.2305 (ms) / GPU bubble ratio: 23.11%
[rank0]:2025-10-29 08:26:39,295 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:26:40,911 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:26:40,926 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.90/0.90, [MB3] 0.94/0.94, [MB4] 0.96/0.96, [MB5] 0.98/0.98, [MB6] 0.99/0.99, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:26:40,945 - INFO -  step: 250  loss:  4.5668  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank0]:2025-10-29 08:26:40,946 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.58/0.58, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:26:40,947 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,858  tflops: 459.79  mfu: 46.49%
[rank2]:2025-10-29 08:26:40,944 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,865  tflops: 460.10  mfu: 46.52%
[rank1]:2025-10-29 08:26:40,946 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:26:40,947 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.00  mfu: 46.51%
[rank0]:2025-10-29 08:26:41,041 - INFO - Avg. fwd time: 15.2365 / Avg. bwd time: 20.1484 / Avg. batch time: 508.0392 (ms) / GPU bubble ratio: 44.28%
[rank3]:2025-10-29 08:26:41,258 - INFO - Avg. fwd time: 16.2394 / Avg. bwd time: 29.2188 / Avg. batch time: 379.7537 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-29 08:26:41,279 - INFO - Avg. fwd time: 14.6104 / Avg. bwd time: 24.6965 / Avg. batch time: 421.7390 (ms) / GPU bubble ratio: 25.44%
[rank1]:2025-10-29 08:26:41,305 - INFO - Avg. fwd time: 17.0556 / Avg. bwd time: 28.2397 / Avg. batch time: 470.8211 (ms) / GPU bubble ratio: 23.04%
[rank0]:2025-10-29 08:28:02,159 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:28:03,972 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank2_trend_line.svg
[rank2]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.89/0.89, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:28:04,003 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.89/0.89, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 08:28:03,995 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank0_trend_line.svg
[rank1]:2025-10-29 08:28:03,987 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank1_trend_line.svg
[rank1]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:28:04,003 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:03,956 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0828_rank3_trend_line.svg
[rank0]:2025-10-29 08:28:04,001 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:28:04,002 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank1]:2025-10-29 08:28:04,003 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank3]:2025-10-29 08:28:04,196 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0828_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.62 ms, GPU Bubble Ratio: 37.91%, 24.53%, 31.10%, 24.88%
[rank3]:2025-10-29 08:28:04,196 - INFO - 	> Batch Time: 366.62 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 08:28:04,196 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:04,199 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:28:04,202 - INFO -  step: 300  loss:  5.6260  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,840  tflops: 458.92  mfu: 46.40%
[rank2]:2025-10-29 08:28:04,270 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0828_stage2_step300.svg
[rank0]:2025-10-29 08:28:04,271 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0828_stage0_step300.svg
[rank1]:2025-10-29 08:28:04,268 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0828_stage1_step300.svg
[rank3]:2025-10-29 08:28:04,376 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0828_real_step300_rank3.svg
[rank3]:> Batch Time: 448.12 ms, GPU Bubble Ratio: 39.12%, 29.34%, 35.81%, 26.54%
[rank3]:2025-10-29 08:28:04,439 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0828_stage3_step300.svg
[rank2]:2025-10-29 08:28:04,789 - INFO - Avg. fwd time: 14.7765 / Avg. bwd time: 23.2381 / Avg. batch time: 407.6518 (ms) / GPU bubble ratio: 25.40%
[rank3]:2025-10-29 08:28:04,768 - INFO - Avg. fwd time: 16.4300 / Avg. bwd time: 27.4802 / Avg. batch time: 367.2273 (ms) / GPU bubble ratio: 4.34%
[rank0]:2025-10-29 08:28:04,818 - INFO - Avg. fwd time: 15.3590 / Avg. bwd time: 16.6260 / Avg. batch time: 488.4073 (ms) / GPU bubble ratio: 47.61%
[rank1]:2025-10-29 08:28:04,812 - INFO - Avg. fwd time: 17.2476 / Avg. bwd time: 26.6005 / Avg. batch time: 454.8396 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-10-29 08:29:25,588 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 08:29:27,238 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,842  tflops: 459.04  mfu: 46.41%
[rank1]:2025-10-29 08:29:27,240 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,842  tflops: 459.02  mfu: 46.41%
[rank0]:2025-10-29 08:29:27,240 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,842  tflops: 459.03  mfu: 46.41%
[rank3]:2025-10-29 08:29:27,239 - INFO -  step: 350  loss:  4.1776  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,866  tflops: 460.14  mfu: 46.53%
[rank0]:2025-10-29 08:29:27,337 - INFO - Avg. fwd time: 15.4358 / Avg. bwd time: 14.4594 / Avg. batch time: 476.3046 (ms) / GPU bubble ratio: 49.79%
[rank2]:2025-10-29 08:29:27,577 - INFO - Avg. fwd time: 14.8795 / Avg. bwd time: 22.3408 / Avg. batch time: 398.9537 (ms) / GPU bubble ratio: 25.36%
[rank3]:2025-10-29 08:29:27,555 - INFO - Avg. fwd time: 16.5502 / Avg. bwd time: 26.4133 / Avg. batch time: 359.5691 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-10-29 08:29:27,603 - INFO - Avg. fwd time: 17.3679 / Avg. bwd time: 25.5941 / Avg. batch time: 444.9812 (ms) / GPU bubble ratio: 22.76%
[rank0]:2025-10-29 08:30:47,182 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:30:48,949 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank2_trend_line.svg
[rank3]:2025-10-29 08:30:48,940 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank3_trend_line.svg
[rank1]:2025-10-29 08:30:48,967 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank1_trend_line.svg
[rank1]:2025-10-29 08:30:48,972 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:30:48,973 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.77/0.77, [MB3] 0.81/0.81, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:30:48,967 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0830_rank0_trend_line.svg
[rank0]:2025-10-29 08:30:48,972 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,023  tflops: 467.46  mfu: 47.27%
[rank2]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,022  tflops: 467.45  mfu: 47.26%
[rank0]:2025-10-29 08:30:48,975 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,023  tflops: 467.46  mfu: 47.27%
[rank1]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 08:30:48,975 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 08:30:49,165 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0830_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.78 ms, GPU Bubble Ratio: 52.15%, 24.59%, 32.09%, 24.89%
[rank3]:2025-10-29 08:30:49,166 - INFO - 	> Batch Time: 364.78 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 08:30:49,166 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:30:49,172 - INFO -  step: 400  loss:  0.7527  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank3]:2025-10-29 08:30:49,172 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 08:31:05,758 - INFO - validate step: 400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,406
[rank3]:2025-10-29 08:31:05,822 - INFO - validate step: 400  loss:  1.2537  memory: 84.59GiB(60.50%)  tps: 24,602
[rank1]:2025-10-29 08:31:05,796 - INFO - validate step: 400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,351
[rank2]:2025-10-29 08:31:05,811 - INFO - validate step: 400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,329
[rank1]:2025-10-29 08:31:05,899 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0831_stage1_step400.svg
[rank0]:2025-10-29 08:31:05,895 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0831_stage0_step400.svg
[rank2]:2025-10-29 08:31:05,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0831_stage2_step400.svg
[rank3]:2025-10-29 08:31:06,007 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0831_real_step400_rank3.svg
[rank3]:> Batch Time: 384.51 ms, GPU Bubble Ratio: 67.11%, 23.02%, 33.51%, 23.82%
[rank0]:2025-10-29 08:31:05,978 - INFO - Avg. fwd time: 15.4846 / Avg. bwd time: 12.5513 / Avg. batch time: 465.2262 (ms) / GPU bubble ratio: 51.79%
[rank3]:2025-10-29 08:31:06,078 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0831_stage3_step400.svg
[rank3]:2025-10-29 08:31:06,322 - INFO - Avg. fwd time: 16.6331 / Avg. bwd time: 25.4505 / Avg. batch time: 352.4513 (ms) / GPU bubble ratio: 4.48%
[rank1]:2025-10-29 08:31:06,369 - INFO - Avg. fwd time: 17.4543 / Avg. bwd time: 24.6932 / Avg. batch time: 435.8979 (ms) / GPU bubble ratio: 22.65%
[rank2]:2025-10-29 08:31:06,344 - INFO - Avg. fwd time: 14.9536 / Avg. bwd time: 21.5380 / Avg. batch time: 390.8980 (ms) / GPU bubble ratio: 25.32%
[rank0]:2025-10-29 08:32:21,636 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 08:32:23,182 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,586  tflops: 493.73  mfu: 49.92%
[rank2]:2025-10-29 08:32:23,180 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,588  tflops: 493.84  mfu: 49.93%
[rank0]:2025-10-29 08:32:23,181 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,581  tflops: 493.49  mfu: 49.90%
[rank3]:2025-10-29 08:32:23,181 - INFO -  step: 450  loss:  8.8215  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,590  tflops: 493.91  mfu: 49.94%
[rank3]:2025-10-29 08:32:23,531 - INFO - Avg. fwd time: 16.6178 / Avg. bwd time: 24.6339 / Avg. batch time: 345.7209 (ms) / GPU bubble ratio: 4.54%
[rank1]:2025-10-29 08:32:23,576 - INFO - Avg. fwd time: 17.4468 / Avg. bwd time: 23.9528 / Avg. batch time: 427.6213 (ms) / GPU bubble ratio: 22.55%
[rank2]:2025-10-29 08:32:23,552 - INFO - Avg. fwd time: 14.9566 / Avg. bwd time: 20.8766 / Avg. batch time: 383.4259 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-29 08:32:23,581 - INFO - Avg. fwd time: 15.4601 / Avg. bwd time: 11.0882 / Avg. batch time: 455.3762 (ms) / GPU bubble ratio: 53.36%
[rank0]:2025-10-29 08:33:38,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:33:40,340 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank0]:2025-10-29 08:33:40,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0833_stage0_step500.svg
[rank1]:2025-10-29 08:33:40,341 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank1]:2025-10-29 08:33:40,411 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0833_stage1_step500.svg
[rank2]:2025-10-29 08:33:40,339 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,617  tflops: 495.18  mfu: 50.07%
[rank2]:2025-10-29 08:33:40,412 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0833_stage2_step500.svg
[rank3]:2025-10-29 08:33:40,340 - INFO -  step: 500  loss: 13.0543  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,617  tflops: 495.19  mfu: 50.07%
[rank0]:2025-10-29 08:33:40,496 - INFO - Avg. fwd time: 15.4411 / Avg. bwd time: 10.0810 / Avg. batch time: 448.5026 (ms) / GPU bubble ratio: 54.48%
[rank3]:2025-10-29 08:33:40,519 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0833_real_step500_rank3.svg
[rank3]:> Batch Time: 380.98 ms, GPU Bubble Ratio: 67.14%, 22.97%, 33.64%, 23.98%
[rank3]:2025-10-29 08:33:40,581 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0833_stage3_step500.svg
[rank3]:2025-10-29 08:33:40,821 - INFO - Avg. fwd time: 16.6058 / Avg. bwd time: 24.0700 / Avg. batch time: 341.0616 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-29 08:33:40,867 - INFO - Avg. fwd time: 17.4410 / Avg. bwd time: 23.4426 / Avg. batch time: 421.8340 (ms) / GPU bubble ratio: 22.46%
[rank2]:2025-10-29 08:33:40,841 - INFO - Avg. fwd time: 14.9567 / Avg. bwd time: 20.4197 / Avg. batch time: 378.1932 (ms) / GPU bubble ratio: 25.17%
[rank0]:2025-10-29 08:34:56,100 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:34:57,631 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,599  tflops: 494.34  mfu: 49.98%
[rank2]:2025-10-29 08:34:57,628 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,599  tflops: 494.35  mfu: 49.98%
[rank0]:2025-10-29 08:34:57,630 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,599  tflops: 494.34  mfu: 49.98%
[rank3]:2025-10-29 08:34:57,630 - INFO -  step: 550  loss: 11.2601  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,599  tflops: 494.35  mfu: 49.98%
[rank0]:2025-10-29 08:34:57,714 - INFO - Avg. fwd time: 15.4244 / Avg. bwd time: 9.1151 / Avg. batch time: 441.9685 (ms) / GPU bubble ratio: 55.58%
[rank1]:2025-10-29 08:34:57,964 - INFO - Avg. fwd time: 17.4350 / Avg. bwd time: 22.9521 / Avg. batch time: 416.3401 (ms) / GPU bubble ratio: 22.40%
[rank2]:2025-10-29 08:34:57,938 - INFO - Avg. fwd time: 14.9577 / Avg. bwd time: 19.9833 / Avg. batch time: 373.2393 (ms) / GPU bubble ratio: 25.11%
[rank3]:2025-10-29 08:34:57,918 - INFO - Avg. fwd time: 16.5941 / Avg. bwd time: 23.5299 / Avg. batch time: 336.5977 (ms) / GPU bubble ratio: 4.64%
[rank0]:2025-10-29 08:36:13,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:36:15,047 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank2_trend_line.svg
[rank3]:2025-10-29 08:36:15,037 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank3_trend_line.svg
[rank1]:2025-10-29 08:36:15,071 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank1_trend_line.svg
[rank1]:2025-10-29 08:36:15,078 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,577  tflops: 493.32  mfu: 49.88%
[rank1]:2025-10-29 08:36:15,082 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 08:36:15,073 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0836_rank0_trend_line.svg
[rank0]:2025-10-29 08:36:15,078 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,577  tflops: 493.32  mfu: 49.88%
[rank0]:2025-10-29 08:36:15,081 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 08:36:15,079 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.79/0.79, [MB2] 0.83/0.83, [MB3] 0.86/0.86, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:36:15,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,577  tflops: 493.30  mfu: 49.88%
[rank2]:2025-10-29 08:36:15,081 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 08:36:15,270 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0836_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.16 ms, GPU Bubble Ratio: 59.36%, 23.91%, 33.32%, 24.50%
[rank3]:2025-10-29 08:36:15,270 - INFO - 	> Batch Time: 358.16 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 08:36:15,271 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:36:15,278 - INFO -  step: 600  loss:  9.0968  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,550  tflops: 492.08  mfu: 49.75%
[rank3]:2025-10-29 08:36:15,278 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 08:36:31,813 - INFO - validate step: 600  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,480
[rank1]:2025-10-29 08:36:31,851 - INFO - validate step: 600  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,425
[rank2]:2025-10-29 08:36:31,867 - INFO - validate step: 600  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,402
[rank3]:2025-10-29 08:36:31,879 - INFO - validate step: 600  loss:  1.5320  memory: 84.59GiB(60.50%)  tps: 24,676
[rank0]:2025-10-29 08:36:31,952 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0836_stage0_step600.svg
[rank1]:2025-10-29 08:36:31,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0836_stage1_step600.svg
[rank2]:2025-10-29 08:36:31,956 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0836_stage2_step600.svg
[rank3]:2025-10-29 08:36:32,061 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0836_real_step600_rank3.svg
[rank3]:> Batch Time: 378.43 ms, GPU Bubble Ratio: 67.20%, 22.93%, 33.62%, 23.97%
[rank3]:2025-10-29 08:36:32,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0836_stage3_step600.svg
[rank2]:2025-10-29 08:36:32,457 - INFO - Avg. fwd time: 14.9575 / Avg. bwd time: 19.6224 / Avg. batch time: 369.1340 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 08:36:32,434 - INFO - Avg. fwd time: 16.5832 / Avg. bwd time: 23.0833 / Avg. batch time: 332.8977 (ms) / GPU bubble ratio: 4.68%
[rank1]:2025-10-29 08:36:32,481 - INFO - Avg. fwd time: 17.4292 / Avg. bwd time: 22.5483 / Avg. batch time: 411.7946 (ms) / GPU bubble ratio: 22.34%
[rank0]:2025-10-29 08:36:32,488 - INFO - Avg. fwd time: 15.4095 / Avg. bwd time: 8.3182 / Avg. batch time: 436.5642 (ms) / GPU bubble ratio: 56.52%
[rank0]:2025-10-29 08:38:25,089 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:38:27,388 - INFO -  step: 650  loss:  0.0867  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,092  tflops: 330.78  mfu: 33.45%
[rank0]:2025-10-29 08:38:27,420 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0831  memory: 75.21GiB(53.80%)  tps: 7,086  tflops: 330.50  mfu: 33.42%
[rank1]:2025-10-29 08:38:27,386 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,091  tflops: 330.70  mfu: 33.44%
[rank2]:2025-10-29 08:38:27,387 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,091  tflops: 330.75  mfu: 33.44%
[rank3]:2025-10-29 08:38:27,709 - INFO - Avg. fwd time: 16.5782 / Avg. bwd time: 22.7657 / Avg. batch time: 330.2876 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 08:38:27,730 - INFO - Avg. fwd time: 14.9604 / Avg. bwd time: 19.3707 / Avg. batch time: 367.5391 (ms) / GPU bubble ratio: 25.27%
[rank1]:2025-10-29 08:38:27,790 - INFO - Avg. fwd time: 17.4113 / Avg. bwd time: 22.2368 / Avg. batch time: 414.0419 (ms) / GPU bubble ratio: 23.39%
[rank0]:2025-10-29 08:38:27,911 - INFO - Avg. fwd time: 15.2988 / Avg. bwd time: 10.4468 / Avg. batch time: 445.2106 (ms) / GPU bubble ratio: 53.74%
[rank0]:2025-10-29 08:40:20,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:40:23,062 - INFO -  step: 700  loss:  0.1000  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,082  tflops: 330.31  mfu: 33.40%
[rank2]:2025-10-29 08:40:23,061 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank1]:2025-10-29 08:40:23,061 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank0]:2025-10-29 08:40:23,094 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1030  memory: 75.21GiB(53.80%)  tps: 7,082  tflops: 330.30  mfu: 33.40%
[rank0]:2025-10-29 08:40:23,166 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0840_stage0_step700.svg
[rank2]:2025-10-29 08:40:23,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0840_stage2_step700.svg
[rank1]:2025-10-29 08:40:23,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0840_stage1_step700.svg
[rank3]:2025-10-29 08:40:23,277 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0840_real_step700_rank3.svg
[rank3]:> Batch Time: 376.06 ms, GPU Bubble Ratio: 67.26%, 22.94%, 33.45%, 23.91%
[rank3]:2025-10-29 08:40:23,345 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0840_stage3_step700.svg
[rank3]:2025-10-29 08:40:23,591 - INFO - Avg. fwd time: 16.5719 / Avg. bwd time: 22.4496 / Avg. batch time: 327.6784 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 08:40:23,671 - INFO - Avg. fwd time: 17.3858 / Avg. bwd time: 21.9245 / Avg. batch time: 416.3300 (ms) / GPU bubble ratio: 24.46%
[rank2]:2025-10-29 08:40:23,612 - INFO - Avg. fwd time: 14.9633 / Avg. bwd time: 19.1224 / Avg. batch time: 365.9645 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-10-29 08:40:23,792 - INFO - Avg. fwd time: 15.1864 / Avg. bwd time: 12.5901 / Avg. batch time: 453.9376 (ms) / GPU bubble ratio: 51.05%
[rank0]:2025-10-29 08:42:16,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:42:19,020 - INFO -  step: 750  loss:  0.1327  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank0]:2025-10-29 08:42:19,052 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1419  memory: 75.21GiB(53.80%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank2]:2025-10-29 08:42:19,019 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank1]:2025-10-29 08:42:19,019 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,065  tflops: 329.50  mfu: 33.32%
[rank3]:2025-10-29 08:42:19,413 - INFO - Avg. fwd time: 16.5679 / Avg. bwd time: 22.1806 / Avg. batch time: 325.4678 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 08:42:19,442 - INFO - Avg. fwd time: 14.9669 / Avg. bwd time: 18.9098 / Avg. batch time: 364.6683 (ms) / GPU bubble ratio: 25.68%
[rank1]:2025-10-29 08:42:19,522 - INFO - Avg. fwd time: 17.3648 / Avg. bwd time: 21.6555 / Avg. batch time: 418.3510 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 08:42:19,622 - INFO - Avg. fwd time: 15.0927 / Avg. bwd time: 14.4317 / Avg. batch time: 461.4987 (ms) / GPU bubble ratio: 48.82%
[rank0]:2025-10-29 08:44:12,458 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:44:15,105 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank3_trend_line.svg
[rank1]:2025-10-29 08:44:15,104 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank1_trend_line.svg
[rank2]:2025-10-29 08:44:15,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank2_trend_line.svg
[rank0]:2025-10-29 08:44:15,206 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0844_rank0_trend_line.svg
[rank0]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 08:44:15,221 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2231  memory: 75.21GiB(53.80%)  tps: 7,052  tflops: 328.90  mfu: 33.26%
[rank0]:2025-10-29 08:44:15,221 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 08:44:15,215 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,050  tflops: 328.82  mfu: 33.25%
[rank1]:2025-10-29 08:44:15,215 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 08:44:15,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.75/0.75, [MB1] 0.78/0.78, [MB2] 0.82/0.82, [MB3] 0.85/0.85, [MB4] 0.89/0.89, [MB5] 0.93/0.93, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 08:44:15,215 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,050  tflops: 328.82  mfu: 33.25%
[rank2]:2025-10-29 08:44:15,215 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 08:44:15,407 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0844_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.13 ms, GPU Bubble Ratio: 35.14%, 23.95%, 33.01%, 24.57%
[rank3]:2025-10-29 08:44:15,407 - INFO - 	> Batch Time: 357.13 ms (Average Freeze Ratio: 0.75)
[rank3]:2025-10-29 08:44:15,407 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 08:44:15,414 - INFO -  step: 800  loss:  0.1177  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,038  tflops: 328.27  mfu: 33.19%
[rank3]:2025-10-29 08:44:15,414 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 08:44:31,894 - INFO - validate step: 800  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,568
[rank3]:2025-10-29 08:44:31,949 - INFO - validate step: 800  loss:  0.2351  memory: 84.59GiB(60.50%)  tps: 24,772
[rank2]:2025-10-29 08:44:31,940 - INFO - validate step: 800  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,492
[rank1]:2025-10-29 08:44:31,924 - INFO - validate step: 800  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,514
[rank0]:2025-10-29 08:44:32,028 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0844_stage0_step800.svg
[rank2]:2025-10-29 08:44:32,029 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0844_stage2_step800.svg
[rank1]:2025-10-29 08:44:32,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0844_stage1_step800.svg
[rank3]:2025-10-29 08:44:32,135 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0844_real_step800_rank3.svg
[rank3]:> Batch Time: 373.82 ms, GPU Bubble Ratio: 67.27%, 22.95%, 33.20%, 23.90%
[rank3]:2025-10-29 08:44:32,207 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0844_stage3_step800.svg
[rank3]:2025-10-29 08:44:32,456 - INFO - Avg. fwd time: 16.5640 / Avg. bwd time: 21.9797 / Avg. batch time: 323.8109 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 08:44:32,477 - INFO - Avg. fwd time: 14.9691 / Avg. bwd time: 18.7508 / Avg. batch time: 363.6510 (ms) / GPU bubble ratio: 25.82%
[rank1]:2025-10-29 08:44:32,537 - INFO - Avg. fwd time: 17.3476 / Avg. bwd time: 21.4539 / Avg. batch time: 419.8287 (ms) / GPU bubble ratio: 26.06%
[rank0]:2025-10-29 08:44:32,655 - INFO - Avg. fwd time: 15.0208 / Avg. bwd time: 15.8175 / Avg. batch time: 467.1470 (ms) / GPU bubble ratio: 47.19%
[rank0]:2025-10-29 08:45:48,699 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:45:50,259 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,454  tflops: 487.56  mfu: 49.30%
[rank2]:2025-10-29 08:45:50,257 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,460  tflops: 487.86  mfu: 49.33%
[rank1]:2025-10-29 08:45:50,260 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,458  tflops: 487.74  mfu: 49.32%
[rank3]:2025-10-29 08:45:50,259 - INFO -  step: 850  loss:  0.1432  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,461  tflops: 487.92  mfu: 49.33%
[rank0]:2025-10-29 08:45:50,344 - INFO - Avg. fwd time: 15.0311 / Avg. bwd time: 15.0672 / Avg. batch time: 463.0305 (ms) / GPU bubble ratio: 48.00%
[rank2]:2025-10-29 08:45:50,567 - INFO - Avg. fwd time: 14.9729 / Avg. bwd time: 18.5867 / Avg. batch time: 361.6454 (ms) / GPU bubble ratio: 25.76%
[rank3]:2025-10-29 08:45:50,546 - INFO - Avg. fwd time: 16.5645 / Avg. bwd time: 21.7751 / Avg. batch time: 322.1602 (ms) / GPU bubble ratio: 4.79%
[rank1]:2025-10-29 08:45:50,592 - INFO - Avg. fwd time: 17.3480 / Avg. bwd time: 21.2714 / Avg. batch time: 417.0663 (ms) / GPU bubble ratio: 25.92%
[rank0]:2025-10-29 08:47:06,560 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:47:08,102 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank1]:2025-10-29 08:47:08,103 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank2]:2025-10-29 08:47:08,100 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank3]:2025-10-29 08:47:08,101 - INFO -  step: 900  loss:  0.1284  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 08:47:08,174 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0847_stage0_step900.svg
[rank2]:2025-10-29 08:47:08,173 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0847_stage2_step900.svg
[rank1]:2025-10-29 08:47:08,174 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0847_stage1_step900.svg
[rank3]:2025-10-29 08:47:08,280 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0847_real_step900_rank3.svg
[rank3]:> Batch Time: 372.90 ms, GPU Bubble Ratio: 67.18%, 22.83%, 33.11%, 23.95%
[rank3]:2025-10-29 08:47:08,340 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0847_stage3_step900.svg
[rank3]:2025-10-29 08:47:08,647 - INFO - Avg. fwd time: 16.5641 / Avg. bwd time: 21.5946 / Avg. batch time: 320.6961 (ms) / GPU bubble ratio: 4.81%
[rank0]:2025-10-29 08:47:08,702 - INFO - Avg. fwd time: 15.0452 / Avg. bwd time: 14.1887 / Avg. batch time: 458.4033 (ms) / GPU bubble ratio: 48.98%
[rank1]:2025-10-29 08:47:08,696 - INFO - Avg. fwd time: 17.3508 / Avg. bwd time: 21.1140 / Avg. batch time: 414.1940 (ms) / GPU bubble ratio: 25.71%
[rank2]:2025-10-29 08:47:08,671 - INFO - Avg. fwd time: 14.9758 / Avg. bwd time: 18.4421 / Avg. batch time: 359.7671 (ms) / GPU bubble ratio: 25.69%
[rank0]:2025-10-29 08:48:24,586 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:48:26,136 - INFO -  step: 950  loss:  0.1557  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank1]:2025-10-29 08:48:26,137 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,498  tflops: 489.62  mfu: 49.51%
[rank0]:2025-10-29 08:48:26,137 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank2]:2025-10-29 08:48:26,135 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank0]:2025-10-29 08:48:26,224 - INFO - Avg. fwd time: 15.0557 / Avg. bwd time: 13.5134 / Avg. batch time: 454.8272 (ms) / GPU bubble ratio: 49.75%
[rank3]:2025-10-29 08:48:26,426 - INFO - Avg. fwd time: 16.5648 / Avg. bwd time: 21.4561 / Avg. batch time: 319.5822 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 08:48:26,473 - INFO - Avg. fwd time: 17.3537 / Avg. bwd time: 20.9934 / Avg. batch time: 411.9694 (ms) / GPU bubble ratio: 25.53%
[rank2]:2025-10-29 08:48:26,448 - INFO - Avg. fwd time: 14.9784 / Avg. bwd time: 18.3309 / Avg. batch time: 358.3066 (ms) / GPU bubble ratio: 25.63%
[rank0]:2025-10-29 08:49:42,376 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:49:43,926 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank2]:2025-10-29 08:49:43,924 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank1]:2025-10-29 08:49:43,927 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,531  tflops: 491.17  mfu: 49.66%
[rank0]:2025-10-29 08:49:43,926 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 08:49:43,924 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 08:49:43,927 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 08:49:43,925 - INFO -  step: 1000  loss:  0.1286  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,531  tflops: 491.18  mfu: 49.66%
[rank3]:2025-10-29 08:49:43,926 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 08:50:00,927 - INFO - validate step: 1000  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,093
[rank1]:2025-10-29 08:50:00,966 - INFO - validate step: 1000  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,039
[rank2]:2025-10-29 08:50:00,981 - INFO - validate step: 1000  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,014
[rank3]:2025-10-29 08:50:00,991 - INFO - validate step: 1000  loss:  0.2341  memory: 84.59GiB(60.50%)  tps: 24,003
[rank0]:2025-10-29 08:50:01,066 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0850_stage0_step1000.svg
[rank2]:2025-10-29 08:50:01,067 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0850_stage2_step1000.svg
[rank1]:2025-10-29 08:50:01,064 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0850_stage1_step1000.svg
[rank0]:2025-10-29 08:50:01,155 - INFO - Avg. fwd time: 15.0645 / Avg. bwd time: 12.8025 / Avg. batch time: 451.0396 (ms) / GPU bubble ratio: 50.57%
[rank3]:2025-10-29 08:50:01,172 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0850_real_step1000_rank3.svg
[rank3]:> Batch Time: 372.57 ms, GPU Bubble Ratio: 67.16%, 22.78%, 33.09%, 23.98%
[rank3]:2025-10-29 08:50:01,234 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0850_stage3_step1000.svg
[rank2]:2025-10-29 08:50:01,499 - INFO - Avg. fwd time: 14.9798 / Avg. bwd time: 18.2142 / Avg. batch time: 356.7456 (ms) / GPU bubble ratio: 25.56%
[rank3]:2025-10-29 08:50:01,478 - INFO - Avg. fwd time: 16.5634 / Avg. bwd time: 21.3096 / Avg. batch time: 318.3864 (ms) / GPU bubble ratio: 4.84%
[rank1]:2025-10-29 08:50:01,525 - INFO - Avg. fwd time: 17.3554 / Avg. bwd time: 20.8664 / Avg. batch time: 409.6052 (ms) / GPU bubble ratio: 25.35%
[rank0]:2025-10-29 08:51:17,431 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 08:51:18,986 - INFO -  step: 1050  loss:  0.1343  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.89  mfu: 49.53%
[rank1]:2025-10-29 08:51:18,987 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.71  mfu: 49.52%
[rank2]:2025-10-29 08:51:18,985 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,502  tflops: 489.82  mfu: 49.53%
[rank0]:2025-10-29 08:51:18,987 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,495  tflops: 489.47  mfu: 49.49%
[rank2]:2025-10-29 08:51:19,369 - INFO - Avg. fwd time: 14.9812 / Avg. bwd time: 18.1091 / Avg. batch time: 355.3743 (ms) / GPU bubble ratio: 25.51%
[rank3]:2025-10-29 08:51:19,345 - INFO - Avg. fwd time: 16.5630 / Avg. bwd time: 21.1775 / Avg. batch time: 317.3145 (ms) / GPU bubble ratio: 4.85%
[rank1]:2025-10-29 08:51:19,395 - INFO - Avg. fwd time: 17.3572 / Avg. bwd time: 20.7516 / Avg. batch time: 407.5103 (ms) / GPU bubble ratio: 25.19%
[rank0]:2025-10-29 08:51:19,403 - INFO - Avg. fwd time: 15.0739 / Avg. bwd time: 12.1627 / Avg. batch time: 447.6654 (ms) / GPU bubble ratio: 51.33%
[rank0]:2025-10-29 08:52:35,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:52:36,815 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,526  tflops: 490.91  mfu: 49.64%
[rank0]:2025-10-29 08:52:36,816 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,526  tflops: 490.92  mfu: 49.64%
[rank1]:2025-10-29 08:52:36,817 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,526  tflops: 490.91  mfu: 49.64%
[rank3]:2025-10-29 08:52:36,816 - INFO -  step: 1100  loss:  0.1026  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,526  tflops: 490.92  mfu: 49.64%
[rank2]:2025-10-29 08:52:36,892 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0852_stage2_step1100.svg
[rank0]:2025-10-29 08:52:36,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0852_stage0_step1100.svg
[rank1]:2025-10-29 08:52:36,889 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0852_stage1_step1100.svg
[rank0]:2025-10-29 08:52:36,977 - INFO - Avg. fwd time: 15.0810 / Avg. bwd time: 11.6632 / Avg. batch time: 445.0133 (ms) / GPU bubble ratio: 51.92%
[rank3]:2025-10-29 08:52:37,006 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0852_real_step1100_rank3.svg
[rank3]:> Batch Time: 372.23 ms, GPU Bubble Ratio: 67.16%, 22.71%, 33.05%, 23.99%
[rank3]:2025-10-29 08:52:37,071 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0852_stage3_step1100.svg
[rank2]:2025-10-29 08:52:37,338 - INFO - Avg. fwd time: 14.9828 / Avg. bwd time: 18.0273 / Avg. batch time: 354.2851 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-10-29 08:52:37,317 - INFO - Avg. fwd time: 16.5631 / Avg. bwd time: 21.0744 / Avg. batch time: 316.4821 (ms) / GPU bubble ratio: 4.86%
[rank1]:2025-10-29 08:52:37,363 - INFO - Avg. fwd time: 17.3590 / Avg. bwd time: 20.6622 / Avg. batch time: 405.8581 (ms) / GPU bubble ratio: 25.06%
[rank0]:2025-10-29 08:53:53,237 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:53:54,807 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,504  tflops: 489.90  mfu: 49.53%
[rank1]:2025-10-29 08:53:54,808 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,504  tflops: 489.90  mfu: 49.54%
[rank2]:2025-10-29 08:53:54,805 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,504  tflops: 489.90  mfu: 49.54%
[rank3]:2025-10-29 08:53:54,806 - INFO -  step: 1150  loss:  0.1231  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.91  mfu: 49.54%
[rank0]:2025-10-29 08:53:54,895 - INFO - Avg. fwd time: 15.0883 / Avg. bwd time: 11.1298 / Avg. batch time: 442.1998 (ms) / GPU bubble ratio: 52.57%
[rank3]:2025-10-29 08:53:55,102 - INFO - Avg. fwd time: 16.5627 / Avg. bwd time: 20.9641 / Avg. batch time: 315.5867 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 08:53:55,123 - INFO - Avg. fwd time: 14.9842 / Avg. bwd time: 17.9391 / Avg. batch time: 353.1429 (ms) / GPU bubble ratio: 25.42%
[rank1]:2025-10-29 08:53:55,149 - INFO - Avg. fwd time: 17.3605 / Avg. bwd time: 20.5663 / Avg. batch time: 404.1126 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-10-29 08:55:11,080 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:55:12,655 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank1]:2025-10-29 08:55:12,655 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 08:55:12,655 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank0]:2025-10-29 08:55:12,655 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 08:55:12,653 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,523  tflops: 490.80  mfu: 49.63%
[rank2]:2025-10-29 08:55:12,653 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 08:55:12,654 - INFO -  step: 1200  loss:  0.1066  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,523  tflops: 490.81  mfu: 49.63%
[rank3]:2025-10-29 08:55:12,654 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 08:55:29,371 - INFO - validate step: 1200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,504
[rank0]:2025-10-29 08:55:29,371 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 08:55:29,375 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 08:55:29,435 - INFO - validate step: 1200  loss:  0.2358  memory: 84.59GiB(60.50%)  tps: 24,410
[rank3]:2025-10-29 08:55:29,436 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 08:55:29,408 - INFO - validate step: 1200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,450
[rank1]:2025-10-29 08:55:29,409 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:55:29,424 - INFO - validate step: 1200  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,424
[rank2]:2025-10-29 08:55:29,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:55:41,875 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.45 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 08:55:43,788 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.35 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 08:55:44,878 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.47 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 08:55:47,187 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 08:55:47,192 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.82 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank0]:2025-10-29 08:55:47,321 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0855_stage0_step1200.svg
[rank0]:2025-10-29 08:55:47,331 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 08:55:47,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0855_stage1_step1200.svg
[rank1]:2025-10-29 08:55:47,334 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 08:55:47,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0855_stage2_step1200.svg
[rank2]:2025-10-29 08:55:47,334 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 08:55:47,433 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0855_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.99 ms, GPU Bubble Ratio: 67.17%, 22.67%, 33.04%, 23.98%
[rank3]:2025-10-29 08:55:47,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0855_stage3_step1200.svg
[rank3]:2025-10-29 08:55:47,512 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 08:55:47,834 - INFO - Avg. fwd time: 16.5636 / Avg. bwd time: 20.8646 / Avg. batch time: 314.7891 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 08:55:47,886 - INFO - Avg. fwd time: 17.3634 / Avg. bwd time: 20.4789 / Avg. batch time: 402.5404 (ms) / GPU bubble ratio: 24.79%
[rank2]:2025-10-29 08:55:47,859 - INFO - Avg. fwd time: 14.9864 / Avg. bwd time: 17.8590 / Avg. batch time: 352.1228 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 08:55:47,895 - INFO - Avg. fwd time: 15.0963 / Avg. bwd time: 10.6432 / Avg. batch time: 439.6551 (ms) / GPU bubble ratio: 53.16%
[rank0]:2025-10-29 08:57:12,198 - INFO - [GC] Peforming periodical GC collection 2.50 seconds
[rank3]:2025-10-29 08:57:13,862 - INFO -  step: 1250  loss:  0.8541  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,845  tflops: 365.89  mfu: 37.00%
[rank1]:2025-10-29 08:57:13,863 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 7,843  tflops: 365.78  mfu: 36.99%
[rank0]:2025-10-29 08:57:13,863 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 7,840  tflops: 365.65  mfu: 36.97%
[rank2]:2025-10-29 08:57:13,860 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 7,844  tflops: 365.85  mfu: 36.99%
[rank0]:2025-10-29 08:57:13,962 - INFO - Avg. fwd time: 15.1277 / Avg. bwd time: 10.2587 / Avg. batch time: 438.2348 (ms) / GPU bubble ratio: 53.66%
[rank3]:2025-10-29 08:57:14,182 - INFO - Avg. fwd time: 16.5938 / Avg. bwd time: 20.8113 / Avg. batch time: 314.6504 (ms) / GPU bubble ratio: 4.90%
[rank1]:2025-10-29 08:57:14,229 - INFO - Avg. fwd time: 17.3907 / Avg. bwd time: 20.4190 / Avg. batch time: 401.8624 (ms) / GPU bubble ratio: 24.73%
[rank2]:2025-10-29 08:57:14,203 - INFO - Avg. fwd time: 15.0080 / Avg. bwd time: 17.8060 / Avg. batch time: 351.8957 (ms) / GPU bubble ratio: 25.40%
[rank0]:2025-10-29 08:58:35,195 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:58:36,851 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank0]:2025-10-29 08:58:36,853 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank1]:2025-10-29 08:58:36,853 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,871  tflops: 460.39  mfu: 46.55%
[rank3]:2025-10-29 08:58:36,852 - INFO -  step: 1300  loss:  0.8901  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank2]:2025-10-29 08:58:36,931 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0858_stage2_step1300.svg
[rank0]:2025-10-29 08:58:36,930 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0858_stage0_step1300.svg
[rank1]:2025-10-29 08:58:36,928 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0858_stage1_step1300.svg
[rank3]:2025-10-29 08:58:37,046 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0858_real_step1300_rank3.svg
[rank3]:> Batch Time: 373.00 ms, GPU Bubble Ratio: 67.14%, 22.72%, 33.09%, 23.99%
[rank0]:2025-10-29 08:58:37,029 - INFO - Avg. fwd time: 15.1616 / Avg. bwd time: 9.8438 / Avg. batch time: 436.5543 (ms) / GPU bubble ratio: 54.18%
[rank3]:2025-10-29 08:58:37,115 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0858_stage3_step1300.svg
[rank3]:2025-10-29 08:58:37,385 - INFO - Avg. fwd time: 16.6266 / Avg. bwd time: 20.7536 / Avg. batch time: 314.4480 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 08:58:37,407 - INFO - Avg. fwd time: 15.0320 / Avg. bwd time: 17.7493 / Avg. batch time: 351.5043 (ms) / GPU bubble ratio: 25.39%
[rank1]:2025-10-29 08:58:37,433 - INFO - Avg. fwd time: 17.4230 / Avg. bwd time: 20.3572 / Avg. batch time: 400.9916 (ms) / GPU bubble ratio: 24.63%
[rank0]:2025-10-29 08:59:58,213 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 08:59:59,881 - INFO -  step: 1350  loss:  0.8666  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank0]:2025-10-29 08:59:59,882 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank2]:2025-10-29 08:59:59,880 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank1]:2025-10-29 08:59:59,882 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank3]:2025-10-29 09:00:00,268 - INFO - Avg. fwd time: 16.6564 / Avg. bwd time: 20.6999 / Avg. batch time: 314.2545 (ms) / GPU bubble ratio: 4.90%
[rank0]:2025-10-29 09:00:00,330 - INFO - Avg. fwd time: 15.1921 / Avg. bwd time: 9.4612 / Avg. batch time: 435.0252 (ms) / GPU bubble ratio: 54.66%
[rank1]:2025-10-29 09:00:00,321 - INFO - Avg. fwd time: 17.4527 / Avg. bwd time: 20.3003 / Avg. batch time: 400.2097 (ms) / GPU bubble ratio: 24.53%
[rank2]:2025-10-29 09:00:00,293 - INFO - Avg. fwd time: 15.0535 / Avg. bwd time: 17.6973 / Avg. batch time: 351.1636 (ms) / GPU bubble ratio: 25.39%
[rank0]:2025-10-29 09:01:21,205 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:01:22,869 - INFO -  step: 1400  loss:  0.9290  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,871  tflops: 460.41  mfu: 46.55%
[rank3]:2025-10-29 09:01:22,869 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 09:01:22,868 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank2]:2025-10-29 09:01:22,868 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 09:01:22,870 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank0]:2025-10-29 09:01:22,870 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,871  tflops: 460.40  mfu: 46.55%
[rank1]:2025-10-29 09:01:22,870 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 09:01:22,870 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 09:01:39,627 - INFO - validate step: 1400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,441
[rank1]:2025-10-29 09:01:39,611 - INFO - validate step: 1400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,468
[rank0]:2025-10-29 09:01:39,571 - INFO - validate step: 1400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,525
[rank3]:2025-10-29 09:01:39,638 - INFO - validate step: 1400  loss:  0.2334  memory: 84.59GiB(60.50%)  tps: 24,427
[rank2]:2025-10-29 09:01:39,722 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0901_stage2_step1400.svg
[rank1]:2025-10-29 09:01:39,719 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0901_stage1_step1400.svg
[rank0]:2025-10-29 09:01:39,719 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0901_stage0_step1400.svg
[rank0]:2025-10-29 09:01:39,819 - INFO - Avg. fwd time: 15.2162 / Avg. bwd time: 9.1562 / Avg. batch time: 433.7855 (ms) / GPU bubble ratio: 55.05%
[rank3]:2025-10-29 09:01:39,831 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0901_real_step1400_rank3.svg
[rank3]:> Batch Time: 374.03 ms, GPU Bubble Ratio: 67.12%, 22.75%, 33.15%, 23.99%
[rank3]:2025-10-29 09:01:39,902 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0901_stage3_step1400.svg
[rank3]:2025-10-29 09:01:40,173 - INFO - Avg. fwd time: 16.6802 / Avg. bwd time: 20.6571 / Avg. batch time: 314.1007 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 09:01:40,194 - INFO - Avg. fwd time: 15.0708 / Avg. bwd time: 17.6556 / Avg. batch time: 350.8697 (ms) / GPU bubble ratio: 25.38%
[rank1]:2025-10-29 09:01:40,221 - INFO - Avg. fwd time: 17.4761 / Avg. bwd time: 20.2549 / Avg. batch time: 399.5633 (ms) / GPU bubble ratio: 24.46%
[rank0]:2025-10-29 09:03:01,010 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:03:02,667 - INFO -  step: 1450  loss:  0.9559  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank1]:2025-10-29 09:03:02,668 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.02  mfu: 46.51%
[rank2]:2025-10-29 09:03:02,666 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank0]:2025-10-29 09:03:02,668 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,858  tflops: 459.80  mfu: 46.49%
[rank0]:2025-10-29 09:03:02,771 - INFO - Avg. fwd time: 15.2425 / Avg. bwd time: 8.8242 / Avg. batch time: 432.4548 (ms) / GPU bubble ratio: 55.48%
[rank3]:2025-10-29 09:03:02,984 - INFO - Avg. fwd time: 16.7063 / Avg. bwd time: 20.6101 / Avg. batch time: 313.9308 (ms) / GPU bubble ratio: 4.91%
[rank1]:2025-10-29 09:03:03,034 - INFO - Avg. fwd time: 17.5011 / Avg. bwd time: 20.2053 / Avg. batch time: 398.8816 (ms) / GPU bubble ratio: 24.38%
[rank2]:2025-10-29 09:03:03,007 - INFO - Avg. fwd time: 15.0896 / Avg. bwd time: 17.6105 / Avg. batch time: 350.5712 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-10-29 09:04:23,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:04:25,532 - INFO -  step: 1500  loss:  0.8341  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,886  tflops: 461.09  mfu: 46.62%
[rank1]:2025-10-29 09:04:25,533 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,886  tflops: 461.08  mfu: 46.62%
[rank2]:2025-10-29 09:04:25,531 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,886  tflops: 461.08  mfu: 46.62%
[rank0]:2025-10-29 09:04:25,533 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,886  tflops: 461.09  mfu: 46.62%
[rank1]:2025-10-29 09:04:25,612 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0904_stage1_step1500.svg
[rank2]:2025-10-29 09:04:25,614 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0904_stage2_step1500.svg
[rank0]:2025-10-29 09:04:25,613 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0904_stage0_step1500.svg
[rank3]:2025-10-29 09:04:25,722 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0904_real_step1500_rank3.svg
[rank3]:> Batch Time: 375.12 ms, GPU Bubble Ratio: 67.12%, 22.79%, 33.22%, 23.97%
[rank3]:2025-10-29 09:04:25,792 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0904_stage3_step1500.svg
[rank3]:2025-10-29 09:04:26,130 - INFO - Avg. fwd time: 16.7302 / Avg. bwd time: 20.5667 / Avg. batch time: 313.7723 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:04:26,156 - INFO - Avg. fwd time: 15.1067 / Avg. bwd time: 17.5689 / Avg. batch time: 350.2937 (ms) / GPU bubble ratio: 25.38%
[rank1]:2025-10-29 09:04:26,184 - INFO - Avg. fwd time: 17.5245 / Avg. bwd time: 20.1597 / Avg. batch time: 398.2493 (ms) / GPU bubble ratio: 24.30%
[rank0]:2025-10-29 09:04:26,193 - INFO - Avg. fwd time: 15.2665 / Avg. bwd time: 8.5156 / Avg. batch time: 431.2194 (ms) / GPU bubble ratio: 55.88%
[rank0]:2025-10-29 09:05:46,937 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:05:48,591 - INFO -  step: 1550  loss:  0.9017  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 09:05:48,592 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank1]:2025-10-29 09:05:48,593 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank2]:2025-10-29 09:05:48,590 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,863  tflops: 460.01  mfu: 46.51%
[rank0]:2025-10-29 09:05:48,692 - INFO - Avg. fwd time: 15.2861 / Avg. bwd time: 8.2677 / Avg. batch time: 430.2120 (ms) / GPU bubble ratio: 56.20%
[rank3]:2025-10-29 09:05:48,907 - INFO - Avg. fwd time: 16.7498 / Avg. bwd time: 20.5321 / Avg. batch time: 313.6516 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:05:48,929 - INFO - Avg. fwd time: 15.1209 / Avg. bwd time: 17.5353 / Avg. batch time: 350.0583 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 09:05:48,956 - INFO - Avg. fwd time: 17.5440 / Avg. bwd time: 20.1226 / Avg. batch time: 397.7268 (ms) / GPU bubble ratio: 24.24%
[rank0]:2025-10-29 09:07:08,751 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:07:11,063 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank2_trend_line.svg
[rank0]:2025-10-29 09:07:11,081 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank0_trend_line.svg
[rank1]:2025-10-29 09:07:11,085 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank1_trend_line.svg
[rank3]:2025-10-29 09:07:11,123 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0907_rank3_trend_line.svg
[rank2]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.77/0.77, [MB2] 0.81/0.81, [MB3] 0.85/0.85, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 09:07:11,134 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 9,924  tflops: 462.88  mfu: 46.80%
[rank2]:2025-10-29 09:07:11,134 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 09:07:11,134 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 9,925  tflops: 462.89  mfu: 46.80%
[rank0]:2025-10-29 09:07:11,134 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 09:07:11,130 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 09:07:11,135 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 9,925  tflops: 462.89  mfu: 46.80%
[rank1]:2025-10-29 09:07:11,135 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 09:07:11,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0907_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.39 ms, GPU Bubble Ratio: 53.15%, 23.50%, 33.06%, 24.40%
[rank3]:2025-10-29 09:07:11,327 - INFO - 	> Batch Time: 357.39 ms (Average Freeze Ratio: 0.75)
[rank3]:2025-10-29 09:07:11,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 09:07:11,336 - INFO -  step: 1600  loss:  0.1197  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 9,900  tflops: 461.76  mfu: 46.69%
[rank3]:2025-10-29 09:07:11,336 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 09:07:28,036 - INFO - validate step: 1600  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,236
[rank0]:2025-10-29 09:07:27,997 - INFO - validate step: 1600  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,290
[rank3]:2025-10-29 09:07:28,062 - INFO - validate step: 1600  loss:  0.2361  memory: 84.59GiB(60.50%)  tps: 24,490
[rank2]:2025-10-29 09:07:28,050 - INFO - validate step: 1600  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,214
[rank0]:2025-10-29 09:07:28,142 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0907_stage0_step1600.svg
[rank2]:2025-10-29 09:07:28,149 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0907_stage2_step1600.svg
[rank1]:2025-10-29 09:07:28,146 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0907_stage1_step1600.svg
[rank0]:2025-10-29 09:07:28,229 - INFO - Avg. fwd time: 15.3031 / Avg. bwd time: 7.9961 / Avg. batch time: 429.0191 (ms) / GPU bubble ratio: 56.55%
[rank3]:2025-10-29 09:07:28,251 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0907_real_step1600_rank3.svg
[rank3]:> Batch Time: 376.14 ms, GPU Bubble Ratio: 67.12%, 22.84%, 33.28%, 23.94%
[rank3]:2025-10-29 09:07:28,323 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0907_stage3_step1600.svg
[rank3]:2025-10-29 09:07:28,574 - INFO - Avg. fwd time: 16.7656 / Avg. bwd time: 20.4896 / Avg. batch time: 313.4351 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 09:07:28,595 - INFO - Avg. fwd time: 15.1326 / Avg. bwd time: 17.4970 / Avg. batch time: 349.7115 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-10-29 09:07:28,624 - INFO - Avg. fwd time: 17.5606 / Avg. bwd time: 20.0805 / Avg. batch time: 397.0680 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-10-29 09:08:44,481 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:08:46,030 - INFO -  step: 1650  loss:  0.1139  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank2]:2025-10-29 09:08:46,029 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank1]:2025-10-29 09:08:46,032 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank0]:2025-10-29 09:08:46,031 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,498  tflops: 489.63  mfu: 49.51%
[rank3]:2025-10-29 09:08:46,388 - INFO - Avg. fwd time: 16.7594 / Avg. bwd time: 20.4318 / Avg. batch time: 312.9162 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 09:08:46,414 - INFO - Avg. fwd time: 15.1296 / Avg. bwd time: 17.4527 / Avg. batch time: 349.0716 (ms) / GPU bubble ratio: 25.33%
[rank1]:2025-10-29 09:08:46,442 - INFO - Avg. fwd time: 17.5553 / Avg. bwd time: 20.0319 / Avg. batch time: 396.1409 (ms) / GPU bubble ratio: 24.09%
[rank0]:2025-10-29 09:08:46,453 - INFO - Avg. fwd time: 15.3018 / Avg. bwd time: 7.7419 / Avg. batch time: 427.5796 (ms) / GPU bubble ratio: 56.89%
[rank0]:2025-10-29 09:10:02,268 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:10:03,808 - INFO -  step: 1700  loss:  0.1215  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:10:03,810 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank0]:2025-10-29 09:10:03,809 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank2]:2025-10-29 09:10:03,807 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank1]:2025-10-29 09:10:03,888 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0910_stage1_step1700.svg
[rank0]:2025-10-29 09:10:03,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0910_stage0_step1700.svg
[rank0]:2025-10-29 09:10:03,979 - INFO - Avg. fwd time: 15.2999 / Avg. bwd time: 7.5365 / Avg. batch time: 426.3883 (ms) / GPU bubble ratio: 57.15%
[rank2]:2025-10-29 09:10:03,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0910_stage2_step1700.svg
[rank3]:2025-10-29 09:10:04,002 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0910_real_step1700_rank3.svg
[rank3]:> Batch Time: 375.43 ms, GPU Bubble Ratio: 67.11%, 22.78%, 33.22%, 23.97%
[rank3]:2025-10-29 09:10:04,073 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0910_stage3_step1700.svg
[rank3]:2025-10-29 09:10:04,317 - INFO - Avg. fwd time: 16.7539 / Avg. bwd time: 20.3848 / Avg. batch time: 312.4913 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 09:10:04,364 - INFO - Avg. fwd time: 17.5504 / Avg. bwd time: 19.9920 / Avg. batch time: 395.3647 (ms) / GPU bubble ratio: 24.03%
[rank2]:2025-10-29 09:10:04,338 - INFO - Avg. fwd time: 15.1266 / Avg. bwd time: 17.4172 / Avg. batch time: 348.5310 (ms) / GPU bubble ratio: 25.30%
[rank0]:2025-10-29 09:11:20,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:11:21,775 - INFO -  step: 1750  loss:  0.1251  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,507  tflops: 490.06  mfu: 49.55%
[rank1]:2025-10-29 09:11:21,776 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank0]:2025-10-29 09:11:21,776 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank2]:2025-10-29 09:11:21,774 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank0]:2025-10-29 09:11:21,866 - INFO - Avg. fwd time: 15.2983 / Avg. bwd time: 7.3102 / Avg. batch time: 425.1046 (ms) / GPU bubble ratio: 57.45%
[rank3]:2025-10-29 09:11:22,069 - INFO - Avg. fwd time: 16.7482 / Avg. bwd time: 20.3332 / Avg. batch time: 312.0257 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 09:11:22,116 - INFO - Avg. fwd time: 17.5456 / Avg. bwd time: 19.9492 / Avg. batch time: 394.5380 (ms) / GPU bubble ratio: 23.97%
[rank2]:2025-10-29 09:11:22,090 - INFO - Avg. fwd time: 15.1235 / Avg. bwd time: 17.3781 / Avg. batch time: 347.9577 (ms) / GPU bubble ratio: 25.27%
[rank0]:2025-10-29 09:12:37,969 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 09:12:39,516 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank1]:2025-10-29 09:12:39,516 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 09:12:39,515 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank0]:2025-10-29 09:12:39,515 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 09:12:39,513 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,538  tflops: 491.49  mfu: 49.70%
[rank2]:2025-10-29 09:12:39,513 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 09:12:39,514 - INFO -  step: 1800  loss:  0.1005  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,538  tflops: 491.50  mfu: 49.70%
[rank3]:2025-10-29 09:12:39,514 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 09:12:56,233 - INFO - validate step: 1800  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,501
[rank1]:2025-10-29 09:12:56,271 - INFO - validate step: 1800  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,446
[rank2]:2025-10-29 09:12:56,287 - INFO - validate step: 1800  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,420
[rank3]:2025-10-29 09:12:56,301 - INFO - validate step: 1800  loss:  0.2343  memory: 84.59GiB(60.50%)  tps: 24,402
[rank1]:2025-10-29 09:12:56,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0912_stage1_step1800.svg
[rank0]:2025-10-29 09:12:56,385 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0912_stage0_step1800.svg
[rank2]:2025-10-29 09:12:56,388 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0912_stage2_step1800.svg
[rank3]:2025-10-29 09:12:56,485 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0912_real_step1800_rank3.svg
[rank3]:> Batch Time: 374.95 ms, GPU Bubble Ratio: 67.12%, 22.75%, 33.19%, 23.99%
[rank3]:2025-10-29 09:12:56,553 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0912_stage3_step1800.svg
[rank3]:2025-10-29 09:12:56,867 - INFO - Avg. fwd time: 16.7421 / Avg. bwd time: 20.2845 / Avg. batch time: 311.5821 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 09:12:56,934 - INFO - Avg. fwd time: 15.2964 / Avg. bwd time: 7.0971 / Avg. batch time: 423.8862 (ms) / GPU bubble ratio: 57.74%
[rank1]:2025-10-29 09:12:56,923 - INFO - Avg. fwd time: 17.5405 / Avg. bwd time: 19.9085 / Avg. batch time: 393.7494 (ms) / GPU bubble ratio: 23.91%
[rank2]:2025-10-29 09:12:56,894 - INFO - Avg. fwd time: 15.1201 / Avg. bwd time: 17.3413 / Avg. batch time: 347.4109 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 09:14:12,761 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 09:14:14,313 - INFO -  step: 1850  loss:  0.0802  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,501  tflops: 489.77  mfu: 49.52%
[rank0]:2025-10-29 09:14:14,314 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,492  tflops: 489.34  mfu: 49.48%
[rank0]:2025-10-29 09:14:14,404 - INFO - Avg. fwd time: 15.2954 / Avg. bwd time: 6.9241 / Avg. batch time: 422.8903 (ms) / GPU bubble ratio: 57.97%
[rank1]:2025-10-29 09:14:14,314 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,497  tflops: 489.57  mfu: 49.50%
[rank2]:2025-10-29 09:14:14,312 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,499  tflops: 489.69  mfu: 49.51%
[rank3]:2025-10-29 09:14:14,610 - INFO - Avg. fwd time: 16.7379 / Avg. bwd time: 20.2456 / Avg. batch time: 311.2322 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 09:14:14,655 - INFO - Avg. fwd time: 17.5370 / Avg. bwd time: 19.8753 / Avg. batch time: 393.1028 (ms) / GPU bubble ratio: 23.86%
[rank2]:2025-10-29 09:14:14,631 - INFO - Avg. fwd time: 15.1178 / Avg. bwd time: 17.3112 / Avg. batch time: 346.9621 (ms) / GPU bubble ratio: 25.23%
[rank0]:2025-10-29 09:15:30,528 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:15:32,086 - INFO -  step: 1900  loss:  0.0954  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.28  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,087 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,172 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0915_stage0_step1900.svg
[rank1]:2025-10-29 09:15:32,088 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank1]:2025-10-29 09:15:32,170 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0915_stage1_step1900.svg
[rank2]:2025-10-29 09:15:32,085 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank0]:2025-10-29 09:15:32,261 - INFO - Avg. fwd time: 15.2936 / Avg. bwd time: 6.7326 / Avg. batch time: 421.7799 (ms) / GPU bubble ratio: 58.22%
[rank2]:2025-10-29 09:15:32,173 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0915_stage2_step1900.svg
[rank3]:2025-10-29 09:15:32,279 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0915_real_step1900_rank3.svg
[rank3]:> Batch Time: 374.43 ms, GPU Bubble Ratio: 67.12%, 22.71%, 33.15%, 23.99%
[rank3]:2025-10-29 09:15:32,349 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0915_stage3_step1900.svg
[rank3]:2025-10-29 09:15:32,599 - INFO - Avg. fwd time: 16.7327 / Avg. bwd time: 20.2019 / Avg. batch time: 310.8355 (ms) / GPU bubble ratio: 4.94%
[rank2]:2025-10-29 09:15:32,620 - INFO - Avg. fwd time: 15.1147 / Avg. bwd time: 17.2780 / Avg. batch time: 346.4559 (ms) / GPU bubble ratio: 25.20%
[rank1]:2025-10-29 09:15:32,646 - INFO - Avg. fwd time: 17.5329 / Avg. bwd time: 19.8389 / Avg. batch time: 392.3795 (ms) / GPU bubble ratio: 23.80%
[rank0]:2025-10-29 09:16:48,506 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:16:50,070 - INFO -  step: 1950  loss:  0.1223  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,505  tflops: 489.95  mfu: 49.54%
[rank0]:2025-10-29 09:16:50,071 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,505  tflops: 489.94  mfu: 49.54%
[rank2]:2025-10-29 09:16:50,069 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,505  tflops: 489.95  mfu: 49.54%
[rank1]:2025-10-29 09:16:50,072 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,505  tflops: 489.94  mfu: 49.54%
[rank3]:2025-10-29 09:16:50,436 - INFO - Avg. fwd time: 16.7281 / Avg. bwd time: 20.1606 / Avg. batch time: 310.4644 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 09:16:50,507 - INFO - Avg. fwd time: 15.2925 / Avg. bwd time: 6.5515 / Avg. batch time: 420.7556 (ms) / GPU bubble ratio: 58.47%
[rank2]:2025-10-29 09:16:50,464 - INFO - Avg. fwd time: 15.1122 / Avg. bwd time: 17.2462 / Avg. batch time: 345.9983 (ms) / GPU bubble ratio: 25.18%
[rank1]:2025-10-29 09:16:50,495 - INFO - Avg. fwd time: 17.5298 / Avg. bwd time: 19.8048 / Avg. batch time: 391.7201 (ms) / GPU bubble ratio: 23.75%
[rank0]:2025-10-29 09:18:06,278 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:18:07,846 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank0]:2025-10-29 09:18:07,847 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:18:07,848 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank1]:2025-10-29 09:18:07,848 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 09:18:07,848 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 09:18:07,846 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 09:18:07,846 - INFO -  step: 2000  loss:  0.1122  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank3]:2025-10-29 09:18:07,847 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 09:18:24,521 - INFO - validate step: 2000  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,566
[rank2]:2025-10-29 09:18:24,574 - INFO - validate step: 2000  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,486
[rank1]:2025-10-29 09:18:24,559 - INFO - validate step: 2000  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,512
[rank3]:2025-10-29 09:18:24,586 - INFO - validate step: 2000  loss:  0.2351  memory: 84.59GiB(60.50%)  tps: 24,471
[rank2]:2025-10-29 09:18:24,672 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0918_stage2_step2000.svg
[rank0]:2025-10-29 09:18:24,672 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0918_stage0_step2000.svg
[rank1]:2025-10-29 09:18:24,669 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0918_stage1_step2000.svg
[rank0]:2025-10-29 09:18:24,762 - INFO - Avg. fwd time: 15.2909 / Avg. bwd time: 6.4038 / Avg. batch time: 419.8914 (ms) / GPU bubble ratio: 58.67%
[rank3]:2025-10-29 09:18:24,771 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0918_real_step2000_rank3.svg
[rank3]:> Batch Time: 374.06 ms, GPU Bubble Ratio: 67.13%, 22.68%, 33.12%, 23.99%
[rank3]:2025-10-29 09:18:24,841 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0918_stage3_step2000.svg
[rank2]:2025-10-29 09:18:25,118 - INFO - Avg. fwd time: 15.1097 / Avg. bwd time: 17.2203 / Avg. batch time: 345.5981 (ms) / GPU bubble ratio: 25.16%
[rank3]:2025-10-29 09:18:25,097 - INFO - Avg. fwd time: 16.7236 / Avg. bwd time: 20.1264 / Avg. batch time: 310.1499 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 09:18:25,144 - INFO - Avg. fwd time: 17.5261 / Avg. bwd time: 19.7766 / Avg. batch time: 391.1546 (ms) / GPU bubble ratio: 23.71%
[rank0]:2025-10-29 09:19:41,009 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 09:19:42,566 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,504  tflops: 489.89  mfu: 49.53%
[rank1]:2025-10-29 09:19:42,569 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,501  tflops: 489.78  mfu: 49.52%
[rank0]:2025-10-29 09:19:42,568 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,496  tflops: 489.55  mfu: 49.50%
[rank3]:2025-10-29 09:19:42,567 - INFO -  step: 2050  loss:  0.1585  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank0]:2025-10-29 09:19:42,659 - INFO - Avg. fwd time: 15.2902 / Avg. bwd time: 6.2397 / Avg. batch time: 418.9623 (ms) / GPU bubble ratio: 58.89%
[rank2]:2025-10-29 09:19:42,881 - INFO - Avg. fwd time: 15.1077 / Avg. bwd time: 17.1917 / Avg. batch time: 345.1876 (ms) / GPU bubble ratio: 25.14%
[rank3]:2025-10-29 09:19:42,860 - INFO - Avg. fwd time: 16.7200 / Avg. bwd time: 20.0892 / Avg. batch time: 309.8187 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 09:19:42,907 - INFO - Avg. fwd time: 17.5231 / Avg. bwd time: 19.7451 / Avg. batch time: 390.5566 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-29 09:20:58,749 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:21:00,294 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank1]:2025-10-29 09:21:00,296 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank0]:2025-10-29 09:21:00,295 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,539  tflops: 491.56  mfu: 49.70%
[rank3]:2025-10-29 09:21:00,295 - INFO -  step: 2100  loss:  0.1390  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank2]:2025-10-29 09:21:00,375 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0921_stage2_step2100.svg
[rank1]:2025-10-29 09:21:00,374 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0921_stage1_step2100.svg
[rank0]:2025-10-29 09:21:00,376 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0921_stage0_step2100.svg
[rank3]:2025-10-29 09:21:00,482 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0921_real_step2100_rank3.svg
[rank3]:> Batch Time: 373.81 ms, GPU Bubble Ratio: 67.14%, 22.67%, 33.11%, 23.99%
[rank3]:2025-10-29 09:21:00,545 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0921_stage3_step2100.svg
[rank3]:2025-10-29 09:21:00,856 - INFO - Avg. fwd time: 16.7158 / Avg. bwd time: 20.0536 / Avg. batch time: 309.4964 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 09:21:00,914 - INFO - Avg. fwd time: 17.5197 / Avg. bwd time: 19.7156 / Avg. batch time: 389.9855 (ms) / GPU bubble ratio: 23.62%
[rank2]:2025-10-29 09:21:00,883 - INFO - Avg. fwd time: 15.1053 / Avg. bwd time: 17.1647 / Avg. batch time: 344.7905 (ms) / GPU bubble ratio: 25.13%
[rank0]:2025-10-29 09:21:00,924 - INFO - Avg. fwd time: 15.2890 / Avg. bwd time: 6.0838 / Avg. batch time: 418.0773 (ms) / GPU bubble ratio: 59.10%
[rank0]:2025-10-29 09:22:16,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 09:22:18,293 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank1]:2025-10-29 09:22:18,293 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank2]:2025-10-29 09:22:18,291 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,503  tflops: 489.86  mfu: 49.53%
[rank3]:2025-10-29 09:22:18,292 - INFO -  step: 2150  loss:  0.1793  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank0]:2025-10-29 09:22:18,385 - INFO - Avg. fwd time: 15.2882 / Avg. bwd time: 5.9563 / Avg. batch time: 417.3456 (ms) / GPU bubble ratio: 59.28%
[rank2]:2025-10-29 09:22:18,611 - INFO - Avg. fwd time: 15.1037 / Avg. bwd time: 17.1428 / Avg. batch time: 344.4580 (ms) / GPU bubble ratio: 25.11%
[rank3]:2025-10-29 09:22:18,590 - INFO - Avg. fwd time: 16.7129 / Avg. bwd time: 20.0245 / Avg. batch time: 309.2371 (ms) / GPU bubble ratio: 4.96%
[rank1]:2025-10-29 09:22:18,636 - INFO - Avg. fwd time: 17.5179 / Avg. bwd time: 19.6916 / Avg. batch time: 389.5113 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 09:23:34,473 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:23:36,018 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,540  tflops: 491.56  mfu: 49.70%
[rank2]:2025-10-29 09:23:36,018 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 09:23:36,020 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,540  tflops: 491.56  mfu: 49.70%
[rank1]:2025-10-29 09:23:36,020 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 09:23:36,020 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank0]:2025-10-29 09:23:36,020 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 09:23:36,019 - INFO -  step: 2200  loss:  0.1173  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank3]:2025-10-29 09:23:36,019 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 09:23:52,751 - INFO - validate step: 2200  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,481
[rank1]:2025-10-29 09:23:52,788 - INFO - validate step: 2200  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,429
[rank3]:2025-10-29 09:23:52,817 - INFO - validate step: 2200  loss:  0.2352  memory: 84.59GiB(60.50%)  tps: 24,386
[rank2]:2025-10-29 09:23:52,803 - INFO - validate step: 2200  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,403
[rank2]:2025-10-29 09:23:52,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0923_stage2_step2200.svg
[rank0]:2025-10-29 09:23:52,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0923_stage0_step2200.svg
[rank0]:2025-10-29 09:23:52,990 - INFO - Avg. fwd time: 15.2867 / Avg. bwd time: 5.8141 / Avg. batch time: 416.5144 (ms) / GPU bubble ratio: 59.47%
[rank1]:2025-10-29 09:23:52,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0923_stage1_step2200.svg
[rank3]:2025-10-29 09:23:53,014 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0923_real_step2200_rank3.svg
[rank3]:> Batch Time: 373.53 ms, GPU Bubble Ratio: 67.13%, 22.65%, 33.08%, 23.99%
[rank3]:2025-10-29 09:23:53,080 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0923_stage3_step2200.svg
[rank2]:2025-10-29 09:23:53,351 - INFO - Avg. fwd time: 15.1014 / Avg. bwd time: 17.1183 / Avg. batch time: 344.0747 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 09:23:53,377 - INFO - Avg. fwd time: 17.5146 / Avg. bwd time: 19.6645 / Avg. batch time: 388.9678 (ms) / GPU bubble ratio: 23.53%
[rank3]:2025-10-29 09:23:53,332 - INFO - Avg. fwd time: 16.7085 / Avg. bwd time: 19.9917 / Avg. batch time: 308.9363 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 09:25:09,254 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 09:25:10,809 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,495  tflops: 489.49  mfu: 49.49%
[rank2]:2025-10-29 09:25:10,807 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,502  tflops: 489.82  mfu: 49.53%
[rank1]:2025-10-29 09:25:10,809 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.71  mfu: 49.52%
[rank3]:2025-10-29 09:25:10,808 - INFO -  step: 2250  loss:  0.1420  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,504  tflops: 489.91  mfu: 49.54%
[rank3]:2025-10-29 09:25:11,172 - INFO - Avg. fwd time: 16.7047 / Avg. bwd time: 19.9606 / Avg. batch time: 308.6531 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 09:25:11,247 - INFO - Avg. fwd time: 15.2857 / Avg. bwd time: 5.6785 / Avg. batch time: 415.7446 (ms) / GPU bubble ratio: 59.66%
[rank2]:2025-10-29 09:25:11,202 - INFO - Avg. fwd time: 15.0992 / Avg. bwd time: 17.0948 / Avg. batch time: 343.7293 (ms) / GPU bubble ratio: 25.07%
[rank1]:2025-10-29 09:25:11,232 - INFO - Avg. fwd time: 17.5115 / Avg. bwd time: 19.6389 / Avg. batch time: 388.4706 (ms) / GPU bubble ratio: 23.49%
[rank0]:2025-10-29 09:26:27,127 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 09:26:28,686 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank2]:2025-10-29 09:26:28,684 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank1]:2025-10-29 09:26:28,686 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank3]:2025-10-29 09:26:28,685 - INFO -  step: 2300  loss:  0.1069  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 09:26:28,765 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0926_stage0_step2300.svg
[rank2]:2025-10-29 09:26:28,766 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0926_stage2_step2300.svg
[rank1]:2025-10-29 09:26:28,762 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0926_stage1_step2300.svg
[rank0]:2025-10-29 09:26:28,855 - INFO - Avg. fwd time: 15.2849 / Avg. bwd time: 5.5673 / Avg. batch time: 415.1059 (ms) / GPU bubble ratio: 59.81%
[rank3]:2025-10-29 09:26:28,876 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0926_real_step2300_rank3.svg
[rank3]:> Batch Time: 373.39 ms, GPU Bubble Ratio: 67.14%, 22.64%, 33.09%, 23.99%
[rank3]:2025-10-29 09:26:28,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0926_stage3_step2300.svg
[rank2]:2025-10-29 09:26:29,211 - INFO - Avg. fwd time: 15.0978 / Avg. bwd time: 17.0757 / Avg. batch time: 343.4407 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-10-29 09:26:29,190 - INFO - Avg. fwd time: 16.7022 / Avg. bwd time: 19.9356 / Avg. batch time: 308.4293 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 09:26:29,237 - INFO - Avg. fwd time: 17.5095 / Avg. bwd time: 19.6177 / Avg. batch time: 388.0565 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-10-29 09:27:45,132 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 09:27:46,705 - INFO -  step: 2350  loss:  0.1314  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,501  tflops: 489.75  mfu: 49.52%
[rank0]:2025-10-29 09:27:46,702 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank2]:2025-10-29 09:27:46,700 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank1]:2025-10-29 09:27:46,702 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,500  tflops: 489.74  mfu: 49.52%
[rank0]:2025-10-29 09:27:46,795 - INFO - Avg. fwd time: 15.2842 / Avg. bwd time: 5.4428 / Avg. batch time: 414.4011 (ms) / GPU bubble ratio: 59.99%
[rank3]:2025-10-29 09:27:47,001 - INFO - Avg. fwd time: 16.6990 / Avg. bwd time: 19.9071 / Avg. batch time: 308.1734 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 09:27:47,023 - INFO - Avg. fwd time: 15.0960 / Avg. bwd time: 17.0541 / Avg. batch time: 343.1261 (ms) / GPU bubble ratio: 25.04%
[rank1]:2025-10-29 09:27:47,049 - INFO - Avg. fwd time: 17.5070 / Avg. bwd time: 19.5943 / Avg. batch time: 387.6031 (ms) / GPU bubble ratio: 23.42%
[rank0]:2025-10-29 09:29:03,027 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 09:29:04,599 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.20GiB(46.63%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank2]:2025-10-29 09:29:04,599 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,739  tflops: 454.25  mfu: 45.26%
[rank2]:2025-10-29 09:29:04,599 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 09:29:04,601 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 75.21GiB(53.80%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank0]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,738  tflops: 454.18  mfu: 45.25%
[rank0]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 09:29:04,601 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.99GiB(52.21%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank1]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,738  tflops: 454.20  mfu: 45.26%
[rank1]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 09:29:04,600 - INFO -  step: 2400  loss:  0.1148  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 10,517  tflops: 490.51  mfu: 49.60%
[rank3]:2025-10-29 09:29:04,601 - INFO -  final step: 2400  loss:  0.1148  grad_norm:  0.0000  tps: 9,743  tflops: 454.39  mfu: 45.26%
[rank3]:2025-10-29 09:29:04,601 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 09:29:21,246 - INFO - validate step: 2400  loss: -1.0000  memory: 75.21GiB(53.80%)  tps: 24,609
[rank0]:2025-10-29 09:29:21,247 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 09:29:21,254 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 09:29:21,296 - INFO - validate step: 2400  loss: -1.0000  memory: 65.20GiB(46.63%)  tps: 24,532
[rank2]:2025-10-29 09:29:21,297 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 09:29:21,302 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank1]:2025-10-29 09:29:21,285 - INFO - validate step: 2400  loss: -1.0000  memory: 72.99GiB(52.21%)  tps: 24,551
[rank1]:2025-10-29 09:29:21,286 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 09:29:21,289 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 09:29:21,310 - INFO - validate step: 2400  loss:  0.2338  memory: 84.59GiB(60.50%)  tps: 24,516
[rank3]:2025-10-29 09:29:21,310 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 09:29:21,315 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 09:29:32,183 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 09:29:32,286 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0929_stage2_final2400.svg
[rank0]:2025-10-29 09:29:32,290 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0929_stage0_final2400.svg
[rank1]:2025-10-29 09:29:32,277 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0929_stage1_final2400.svg
[rank3]:2025-10-29 09:29:32,429 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0929_real_final2400_rank3.svg
[rank3]:> Batch Time: 373.21 ms, GPU Bubble Ratio: 67.14%, 22.64%, 33.08%, 24.00%
[rank2]:2025-10-29 09:29:32,550 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank2_stage2.svg
[rank2]:	> Counts Sum: 749760, Total Sum: 5368320 (13.97%), Ratio(%) per element: [12.76, 14.0, 13.14, 12.6, 12.12, 13.78, 13.62, 12.71, 12.92, 13.03, 13.94, 13.51, 12.55, 14.32, 12.12, 13.35, 12.07, 12.71, 13.78, 15.28, 14.43, 14.1, 14.05, 15.02, 14.8, 15.23, 13.46, 14.59, 14.59, 12.44, 14.16, 13.25, 13.3, 13.3, 14.69, 15.12, 13.14, 13.62, 14.43, 13.51, 15.02, 15.02, 13.73, 14.37, 14.21, 15.23, 15.71, 12.23, 14.86, 14.21, 12.87, 13.94, 13.89, 14.21, 14.37, 13.51, 14.53, 13.62, 14.96, 14.59, 13.41, 15.39, 12.6, 15.5, 14.43, 16.25, 14.64, 14.1, 14.69, 14.21, 14.64, 14.69]
[rank2]:2025-10-29 09:29:32,551 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 09:29:32,543 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank0_stage0.svg
[rank0]:	> Counts Sum: 4609240, Total Sum: 5442880 (84.68%), Ratio(%) per element: [85.24, 84.06, 84.28, 84.12, 84.54, 84.38, 84.12, 84.49, 84.33, 84.17, 83.95, 84.12, 83.95, 84.22, 84.28, 84.44, 84.22, 83.95, 84.17, 84.33, 84.38, 84.06, 84.33, 84.65, 84.22, 84.6, 84.44, 84.22, 84.38, 84.38, 84.38, 84.6, 84.6, 84.6, 84.44, 84.54, 84.54, 84.81, 85.08, 84.81, 85.08, 85.35, 84.97, 84.81, 85.19, 84.97, 84.97, 85.24, 85.08, 84.97, 84.71, 85.3, 85.08, 85.03, 85.03, 85.13, 85.03, 85.24, 84.97, 84.92, 85.35, 85.03, 84.97, 84.97, 84.92, 85.13, 85.03, 84.81, 84.76, 84.97, 85.13, 84.92, 85.03]
[rank0]:2025-10-29 09:29:32,543 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 09:29:32,547 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank1_stage1.svg
[rank1]:	> Counts Sum: 104960, Total Sum: 6039360 (1.74%), Ratio(%) per element: [0.91, 0.91, 0.8, 1.07, 1.18, 0.8, 1.18, 0.75, 0.69, 1.34, 1.39, 1.66, 1.44, 1.18, 1.39, 2.03, 1.12, 1.66, 1.12, 1.44, 1.77, 1.77, 1.44, 1.77, 1.6, 2.03, 1.39, 1.5, 1.23, 1.6, 1.6, 1.55, 1.5, 1.55, 1.71, 1.87, 1.66, 1.82, 1.55, 1.39, 1.44, 1.39, 1.82, 1.39, 1.23, 2.3, 1.6, 2.09, 2.09, 2.03, 1.98, 2.25, 2.3, 2.03, 2.46, 2.03, 2.3, 2.19, 1.98, 2.19, 2.19, 1.93, 1.98, 1.87, 2.25, 2.41, 2.09, 2.3, 2.25, 1.98, 2.52, 2.36, 2.36, 2.03, 1.93, 2.03, 2.03, 1.98, 2.14, 1.87, 2.41]
[rank1]:2025-10-29 09:29:32,548 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 09:29:32,650 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0929_thry_final2400_rank3.svg
[rank3]:> Batch Time: 532.55 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 09:29:32,733 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0929_stage3_final2400.svg
[rank3]:2025-10-29 09:29:32,992 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0929_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.07, 1.01, 0.85, 1.18, 0.96, 1.01, 0.85, 1.07, 1.12, 2.03, 1.55, 1.5, 1.39, 1.23, 1.28, 1.82, 1.23, 1.5, 1.39, 1.39, 1.87, 1.98, 1.44, 1.77, 2.19, 1.44, 1.87, 1.39, 1.39, 1.87, 2.19, 1.28, 1.82, 1.39, 1.5, 1.87, 1.71, 1.39, 1.66, 1.39, 1.82, 1.44, 1.71, 1.77, 1.87, 2.09, 1.77, 1.77, 1.34, 1.82, 1.87, 1.77, 2.03, 1.87, 1.55, 2.03, 1.71, 1.34, 1.6, 1.6, 1.77, 1.87, 1.71, 1.82, 1.87]
[rank3]:2025-10-29 09:29:32,993 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 437-444
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–â–â–â–â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–â–â–â–â–‚â–ƒâ–â–†â–ˆâ–‡â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–â–â–â–â–‚â–„â–ƒâ–â–†â–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.6817
[rank3]:wandb:               final/avg_loss 0.11478
[rank3]:wandb:             final/avg_mfu(%) 45.26392
[rank3]:wandb:             final/avg_tflops 454.39233
[rank3]:wandb:    final/avg_throughput(tps) 9742.51203
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11478
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11478
[rank3]:wandb: loss_metrics/global_max_loss 0.11478
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/am0tnl8r
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyauto_dm1/20251029-0817/wandb/run-20251029_081716-am0tnl8r/logs
[rank0]:2025-10-29 09:29:34,544 - INFO - Training completed
[rank0]:2025-10-29 09:29:34,544 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 09:29:34,795 - INFO - Process group destroyed
[rank2]:2025-10-29 09:29:34,853 - INFO - Process group destroyed
[rank0]:2025-10-29 09:29:34,856 - INFO - Process group destroyed
[rank1]:2025-10-29 09:29:34,788 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.16', 'layers.8', 'layers.13', 'layers.14', 'layers.9', 'layers.11', 'layers.12', 'layers.15'}
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.0', 'tok_embeddings', 'layers.4', 'layers.2', 'layers.6', 'layers.7', 'layers.1', 'layers.3'}
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.18', 'layers.20', 'layers.21', 'layers.23', 'layers.17', 'layers.19', 'layers.24'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.28', 'layers.29', 'layers.25', 'layers.31', 'layers.26', 'layers.30', 'layers.27', 'norm'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
âœ… All runs completed. Logs saved in /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b.
