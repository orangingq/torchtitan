âœ”ï¸ SLURM JOB GPUS: 0,1,2,6
âœ”ï¸ Using Slurm-assigned GPU(s): 0,1,2,6

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Oct 28 22:49:42 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] 
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] *****************************************
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1028 22:49:43.596000 1230007 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-28 22:49:49,782 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-28 22:49:49,780 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-28 22:49:49,803 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-28 22:49:49,726 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-28 22:49:50,751 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-28 22:49:50,754 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:50,823 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-28 22:49:50,826 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:50,831 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-28 22:49:50,826 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-28 22:49:50,829 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-28 22:49:50,827 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-28 22:49:50,829 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-28 22:49:52,661 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-28 22:49:52,946 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank3]:
[rank3]:Generating train split:   0%|          | 0/24887 [00:00<?, ? examples/s][rank3]:
[rank3]:Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24887/24887 [00:01<00:00, 20249.92 examples/s]
[rank3]:Generating train split: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24887/24887 [00:01<00:00, 20237.90 examples/s]
[rank0]:2025-10-28 22:50:02,667 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-28 22:50:04,307 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-28 22:50:04,565 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-28 22:50:04,579 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-28 22:50:04,585 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-28 22:50:04,661 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-28 22:50:04,662 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-28 22:50:04,666 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-28 22:50:04,690 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-28 22:50:04,690 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-28 22:50:04,693 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-28 22:50:04,694 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-28 22:50:04,971 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-28 22:50:04,971 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-28 22:50:05,016 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-28 22:50:05,016 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-28 22:50:05,020 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-28 22:50:05,021 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run h40tt1xa
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1/20251028-2250/wandb/run-20251028_225005-h40tt1xa
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_nofreeze_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/h40tt1xa
[rank3]:2025-10-28 22:50:06,602 - INFO - WandB logging enabled
[rank3]:2025-10-28 22:50:06,603 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-28 22:50:06,676 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-28 22:50:06,676 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-28 22:50:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-28 22:50:06,847 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-28 22:50:06,848 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-28 22:50:06,859 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-28 22:50:06,862 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-28 22:50:06,870 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank0]:2025-10-28 22:50:06,870 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-28 22:50:06,870 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-10-28 22:50:09,325 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-28 22:50:09,325 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-28 22:50:19,886 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-28 22:50:19,887 - INFO - Finished loading the checkpoint in 10.56 seconds.
[rank0]:2025-10-28 22:50:19,887 - INFO - Training starts at step 1
[rank1]:2025-10-28 22:50:24,330 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 49.69GiB(35.54%)  tps: 833  tflops: 38.87  mfu: 3.93%
[rank1]:2025-10-28 22:50:24,330 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:50:24,333 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.4101  memory: 58.03GiB(41.50%)  tps: 927  tflops: 43.22  mfu: 4.37%
[rank3]:2025-10-28 22:50:24,333 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-28 22:50:24,330 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 44.28GiB(31.67%)  tps: 832  tflops: 38.80  mfu: 3.92%
[rank2]:2025-10-28 22:50:24,330 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-28 22:50:24,350 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4101  memory: 49.75GiB(35.58%)  tps: 832  tflops: 38.82  mfu: 3.93%
[rank0]:2025-10-28 22:50:24,350 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-28 22:50:42,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,757 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,758 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,759 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,760 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-28 22:50:42,761 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,846 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,846 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,847 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,848 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-28 22:50:42,849 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,800 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,801 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,802 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-28 22:50:42,803 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,889 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,890 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,891 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:50:42,892 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-28 22:52:33,850 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 22:52:36,568 - INFO -  step: 50  loss:  3.2236  grad_norm: 16.3336  memory: 73.38GiB(52.48%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank0]:2025-10-28 22:52:36,570 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 66.72GiB(47.72%)  tps: 6,072  tflops: 283.19  mfu: 28.63%
[rank1]:2025-10-28 22:52:36,566 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 64.32GiB(46.00%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank2]:2025-10-28 22:52:36,563 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3336  memory: 57.29GiB(40.97%)  tps: 6,071  tflops: 283.16  mfu: 28.63%
[rank3]:2025-10-28 22:52:37,028 - INFO - Avg. fwd time: 14.7696 / Avg. bwd time: 42.9832 / Avg. batch time: 482.3891 (ms) / GPU bubble ratio: 4.22%
[rank1]:2025-10-28 22:52:37,125 - INFO - Avg. fwd time: 15.1546 / Avg. bwd time: 40.8205 / Avg. batch time: 595.1324 (ms) / GPU bubble ratio: 24.76%
[rank2]:2025-10-28 22:52:37,079 - INFO - Avg. fwd time: 13.3788 / Avg. bwd time: 36.4166 / Avg. batch time: 535.5559 (ms) / GPU bubble ratio: 25.62%
[rank0]:2025-10-28 22:52:37,158 - INFO - Avg. fwd time: 14.0659 / Avg. bwd time: 38.2517 / Avg. batch time: 650.5830 (ms) / GPU bubble ratio: 35.67%
[rank0]:2025-10-28 22:54:48,574 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 22:54:51,287 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 64.32GiB(46.00%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 22:54:51,289 - INFO -  step: 100  loss:  1.0432  grad_norm:  5.4804  memory: 73.38GiB(52.48%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank0]:2025-10-28 22:54:51,291 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 66.72GiB(47.72%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank2]:2025-10-28 22:54:51,284 - INFO -  step: 100  loss: -4.0000  grad_norm:  5.4804  memory: 57.29GiB(40.97%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 22:54:51,488 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2254_real_step100_rank3.svg
[rank3]:> Batch Time: 630.94 ms, GPU Bubble Ratio: 33.52%, 28.37%, 36.39%, 26.30%
[rank3]:2025-10-28 22:54:51,899 - INFO - Avg. fwd time: 14.7994 / Avg. bwd time: 43.1026 / Avg. batch time: 480.8920 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-28 22:54:51,949 - INFO - Avg. fwd time: 13.4005 / Avg. bwd time: 36.5233 / Avg. batch time: 533.9076 (ms) / GPU bubble ratio: 25.19%
[rank1]:2025-10-28 22:54:51,995 - INFO - Avg. fwd time: 15.1934 / Avg. bwd time: 41.0312 / Avg. batch time: 593.4770 (ms) / GPU bubble ratio: 24.21%
[rank0]:2025-10-28 22:54:52,028 - INFO - Avg. fwd time: 13.9696 / Avg. bwd time: 38.3515 / Avg. batch time: 648.8791 (ms) / GPU bubble ratio: 35.49%
[rank0]:2025-10-28 22:57:03,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 22:57:06,125 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank3]:2025-10-28 22:57:06,130 - INFO -  step: 150  loss:  0.9229  grad_norm:  0.5022  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.36  mfu: 28.65%
[rank1]:2025-10-28 22:57:06,128 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank0]:2025-10-28 22:57:06,132 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.5022  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.35  mfu: 28.65%
[rank2]:2025-10-28 22:57:06,723 - INFO - Avg. fwd time: 13.4026 / Avg. bwd time: 36.5584 / Avg. batch time: 533.5594 (ms) / GPU bubble ratio: 25.09%
[rank3]:2025-10-28 22:57:06,681 - INFO - Avg. fwd time: 14.7953 / Avg. bwd time: 43.1385 / Avg. batch time: 480.3348 (ms) / GPU bubble ratio: 3.51%
[rank1]:2025-10-28 22:57:06,769 - INFO - Avg. fwd time: 15.2123 / Avg. bwd time: 41.1018 / Avg. batch time: 593.1583 (ms) / GPU bubble ratio: 24.05%
[rank0]:2025-10-28 22:57:06,811 - INFO - Avg. fwd time: 13.9471 / Avg. bwd time: 38.3775 / Avg. batch time: 648.5499 (ms) / GPU bubble ratio: 35.46%
[rank0]:2025-10-28 22:59:18,071 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 22:59:20,787 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 64.32GiB(46.00%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank1]:2025-10-28 22:59:20,787 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-28 22:59:20,790 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 66.72GiB(47.72%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank0]:2025-10-28 22:59:20,791 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-28 22:59:20,784 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5123  memory: 57.29GiB(40.97%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank2]:2025-10-28 22:59:20,784 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-28 22:59:20,788 - INFO -  step: 200  loss:  0.9315  grad_norm:  0.5123  memory: 73.38GiB(52.48%)  tps: 6,084  tflops: 283.74  mfu: 28.69%
[rank3]:2025-10-28 22:59:20,789 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-28 22:59:36,648 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 25,824
[rank0]:2025-10-28 22:59:36,618 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 25,880
[rank2]:2025-10-28 22:59:36,661 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 25,799
[rank3]:2025-10-28 22:59:36,676 - INFO - validate step: 200  loss:  0.2364  memory: 73.38GiB(52.48%)  tps: 25,783
[rank3]:2025-10-28 22:59:36,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2259_real_step200_rank3.svg
[rank3]:> Batch Time: 630.86 ms, GPU Bubble Ratio: 33.46%, 28.21%, 36.34%, 26.33%
[rank3]:2025-10-28 22:59:37,276 - INFO - Avg. fwd time: 14.7872 / Avg. bwd time: 43.1262 / Avg. batch time: 479.8219 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-10-28 22:59:37,373 - INFO - Avg. fwd time: 15.2348 / Avg. bwd time: 41.1667 / Avg. batch time: 592.7018 (ms) / GPU bubble ratio: 23.87%
[rank2]:2025-10-28 22:59:37,326 - INFO - Avg. fwd time: 13.4239 / Avg. bwd time: 36.6094 / Avg. batch time: 533.0315 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-10-28 22:59:37,406 - INFO - Avg. fwd time: 13.9402 / Avg. bwd time: 38.3962 / Avg. batch time: 648.0985 (ms) / GPU bubble ratio: 35.40%
[rank0]:2025-10-28 23:01:48,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 23:01:51,236 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 57.29GiB(40.97%)  tps: 6,087  tflops: 283.91  mfu: 28.71%
[rank3]:2025-10-28 23:01:51,241 - INFO -  step: 250  loss:  0.9241  grad_norm:  0.4044  memory: 73.38GiB(52.48%)  tps: 6,088  tflops: 283.94  mfu: 28.71%
[rank1]:2025-10-28 23:01:51,239 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 64.32GiB(46.00%)  tps: 6,087  tflops: 283.88  mfu: 28.70%
[rank0]:2025-10-28 23:01:51,243 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.4044  memory: 66.72GiB(47.72%)  tps: 6,085  tflops: 283.81  mfu: 28.70%
[rank3]:2025-10-28 23:01:51,701 - INFO - Avg. fwd time: 14.7829 / Avg. bwd time: 43.0879 / Avg. batch time: 479.2327 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-10-28 23:01:51,751 - INFO - Avg. fwd time: 13.4316 / Avg. bwd time: 36.6281 / Avg. batch time: 532.5514 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-10-28 23:01:51,797 - INFO - Avg. fwd time: 15.2721 / Avg. bwd time: 41.2535 / Avg. batch time: 592.3393 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-28 23:01:51,830 - INFO - Avg. fwd time: 13.9534 / Avg. bwd time: 38.4244 / Avg. batch time: 647.7661 (ms) / GPU bubble ratio: 35.31%
[rank0]:2025-10-28 23:04:03,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:04:05,956 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 64.32GiB(46.00%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 23:04:05,958 - INFO -  step: 300  loss:  0.8420  grad_norm:  0.4258  memory: 73.38GiB(52.48%)  tps: 6,081  tflops: 283.62  mfu: 28.68%
[rank2]:2025-10-28 23:04:05,954 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 57.29GiB(40.97%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank0]:2025-10-28 23:04:05,961 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.4258  memory: 66.72GiB(47.72%)  tps: 6,081  tflops: 283.61  mfu: 28.68%
[rank3]:2025-10-28 23:04:06,140 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2304_real_step300_rank3.svg
[rank3]:> Batch Time: 630.70 ms, GPU Bubble Ratio: 33.35%, 27.98%, 36.29%, 26.39%
[rank3]:2025-10-28 23:04:06,637 - INFO - Avg. fwd time: 14.7864 / Avg. bwd time: 43.0847 / Avg. batch time: 479.0770 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-10-28 23:04:06,680 - INFO - Avg. fwd time: 13.4362 / Avg. bwd time: 36.6382 / Avg. batch time: 532.4574 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-28 23:04:06,726 - INFO - Avg. fwd time: 15.2939 / Avg. bwd time: 41.3033 / Avg. batch time: 592.3087 (ms) / GPU bubble ratio: 23.56%
[rank0]:2025-10-28 23:04:06,770 - INFO - Avg. fwd time: 13.9609 / Avg. bwd time: 38.4399 / Avg. batch time: 647.7533 (ms) / GPU bubble ratio: 35.28%
[rank0]:2025-10-28 23:06:18,361 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:06:21,078 - INFO -  step: 350  loss:  0.8813  grad_norm:  0.4043  memory: 73.38GiB(52.48%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank1]:2025-10-28 23:06:21,076 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 64.32GiB(46.00%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank2]:2025-10-28 23:06:21,074 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 57.29GiB(40.97%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank0]:2025-10-28 23:06:21,080 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4043  memory: 66.72GiB(47.72%)  tps: 6,063  tflops: 282.77  mfu: 28.59%
[rank3]:2025-10-28 23:06:21,545 - INFO - Avg. fwd time: 14.7949 / Avg. bwd time: 43.1103 / Avg. batch time: 479.2545 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-10-28 23:06:21,595 - INFO - Avg. fwd time: 13.4449 / Avg. bwd time: 36.6411 / Avg. batch time: 532.5908 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-10-28 23:06:21,641 - INFO - Avg. fwd time: 15.3015 / Avg. bwd time: 41.3135 / Avg. batch time: 592.4425 (ms) / GPU bubble ratio: 23.55%
[rank0]:2025-10-28 23:06:21,674 - INFO - Avg. fwd time: 13.9616 / Avg. bwd time: 38.4423 / Avg. batch time: 647.8864 (ms) / GPU bubble ratio: 35.29%
[rank0]:2025-10-28 23:08:32,225 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:08:34,848 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 64.32GiB(46.00%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank3]:2025-10-28 23:08:34,850 - INFO -  step: 400  loss:  0.1093  grad_norm:  0.1434  memory: 73.38GiB(52.48%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank1]:2025-10-28 23:08:34,848 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-28 23:08:34,851 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-28 23:08:34,846 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 57.29GiB(40.97%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank2]:2025-10-28 23:08:34,846 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 23:08:34,852 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1434  memory: 66.72GiB(47.72%)  tps: 6,124  tflops: 285.62  mfu: 28.88%
[rank0]:2025-10-28 23:08:34,852 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-28 23:08:49,842 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,326
[rank3]:2025-10-28 23:08:49,917 - INFO - validate step: 400  loss:  0.2384  memory: 73.38GiB(52.48%)  tps: 27,189
[rank1]:2025-10-28 23:08:49,871 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,265
[rank2]:2025-10-28 23:08:49,898 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,212
[rank3]:2025-10-28 23:08:50,100 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2308_real_step400_rank3.svg
[rank3]:> Batch Time: 630.98 ms, GPU Bubble Ratio: 33.40%, 28.01%, 36.32%, 26.37%
[rank3]:2025-10-28 23:08:50,489 - INFO - Avg. fwd time: 14.7800 / Avg. bwd time: 43.1086 / Avg. batch time: 479.0330 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-10-28 23:08:50,540 - INFO - Avg. fwd time: 13.4325 / Avg. bwd time: 36.6310 / Avg. batch time: 532.3007 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-28 23:08:50,585 - INFO - Avg. fwd time: 15.2859 / Avg. bwd time: 41.3024 / Avg. batch time: 592.1138 (ms) / GPU bubble ratio: 23.54%
[rank0]:2025-10-28 23:08:50,618 - INFO - Avg. fwd time: 13.9428 / Avg. bwd time: 38.4328 / Avg. batch time: 647.5345 (ms) / GPU bubble ratio: 35.29%
[rank0]:2025-10-28 23:10:56,912 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-28 23:10:59,511 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 64.32GiB(46.00%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank2]:2025-10-28 23:10:59,509 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 57.29GiB(40.97%)  tps: 6,320  tflops: 294.79  mfu: 29.81%
[rank3]:2025-10-28 23:10:59,514 - INFO -  step: 450  loss:  0.1187  grad_norm:  0.3102  memory: 73.38GiB(52.48%)  tps: 6,321  tflops: 294.82  mfu: 29.81%
[rank0]:2025-10-28 23:10:59,515 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3102  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.65  mfu: 29.79%
[rank3]:2025-10-28 23:11:00,035 - INFO - Avg. fwd time: 14.6850 / Avg. bwd time: 43.0182 / Avg. batch time: 477.4625 (ms) / GPU bubble ratio: 3.32%
[rank1]:2025-10-28 23:11:00,123 - INFO - Avg. fwd time: 15.2045 / Avg. bwd time: 41.2480 / Avg. batch time: 590.3499 (ms) / GPU bubble ratio: 23.50%
[rank2]:2025-10-28 23:11:00,078 - INFO - Avg. fwd time: 13.3570 / Avg. bwd time: 36.5811 / Avg. batch time: 530.6510 (ms) / GPU bubble ratio: 24.71%
[rank0]:2025-10-28 23:11:00,167 - INFO - Avg. fwd time: 13.8588 / Avg. bwd time: 38.3909 / Avg. batch time: 645.6701 (ms) / GPU bubble ratio: 35.26%
[rank0]:2025-10-28 23:13:06,420 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-28 23:13:09,009 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 57.29GiB(40.97%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank1]:2025-10-28 23:13:09,011 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 64.32GiB(46.00%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank3]:2025-10-28 23:13:09,013 - INFO -  step: 500  loss:  0.1215  grad_norm:  0.1729  memory: 73.38GiB(52.48%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank0]:2025-10-28 23:13:09,015 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1729  memory: 66.72GiB(47.72%)  tps: 6,326  tflops: 295.04  mfu: 29.83%
[rank3]:2025-10-28 23:13:09,196 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2313_real_step500_rank3.svg
[rank3]:> Batch Time: 629.04 ms, GPU Bubble Ratio: 33.35%, 28.00%, 36.30%, 26.40%
[rank2]:2025-10-28 23:13:09,630 - INFO - Avg. fwd time: 13.3035 / Avg. bwd time: 36.5493 / Avg. batch time: 529.4184 (ms) / GPU bubble ratio: 24.67%
[rank3]:2025-10-28 23:13:09,581 - INFO - Avg. fwd time: 14.6178 / Avg. bwd time: 42.9522 / Avg. batch time: 476.3364 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-10-28 23:13:09,676 - INFO - Avg. fwd time: 15.1473 / Avg. bwd time: 41.2100 / Avg. batch time: 589.0374 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-10-28 23:13:09,708 - INFO - Avg. fwd time: 13.8002 / Avg. bwd time: 38.3640 / Avg. batch time: 644.2942 (ms) / GPU bubble ratio: 35.23%
[rank0]:2025-10-28 23:15:16,088 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:15:18,696 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank2]:2025-10-28 23:15:18,690 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank3]:2025-10-28 23:15:18,694 - INFO -  step: 550  loss:  0.1341  grad_norm:  0.1360  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank1]:2025-10-28 23:15:18,692 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1360  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.63  mfu: 29.79%
[rank3]:2025-10-28 23:15:19,127 - INFO - Avg. fwd time: 14.5581 / Avg. bwd time: 42.8924 / Avg. batch time: 475.3240 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-10-28 23:15:19,176 - INFO - Avg. fwd time: 13.2561 / Avg. bwd time: 36.5181 / Avg. batch time: 528.3635 (ms) / GPU bubble ratio: 24.64%
[rank1]:2025-10-28 23:15:19,222 - INFO - Avg. fwd time: 15.0955 / Avg. bwd time: 41.1755 / Avg. batch time: 587.9065 (ms) / GPU bubble ratio: 23.43%
[rank0]:2025-10-28 23:15:19,254 - INFO - Avg. fwd time: 13.7460 / Avg. bwd time: 38.3402 / Avg. batch time: 643.1072 (ms) / GPU bubble ratio: 35.21%
[rank0]:2025-10-28 23:17:25,648 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:17:28,255 - INFO -  step: 600  loss:  0.0983  grad_norm:  0.0999  memory: 73.38GiB(52.48%)  tps: 6,323  tflops: 294.91  mfu: 29.82%
[rank3]:2025-10-28 23:17:28,255 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-28 23:17:28,250 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 57.29GiB(40.97%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank2]:2025-10-28 23:17:28,250 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 23:17:28,252 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 64.32GiB(46.00%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank1]:2025-10-28 23:17:28,252 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-28 23:17:28,256 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0999  memory: 66.72GiB(47.72%)  tps: 6,323  tflops: 294.90  mfu: 29.82%
[rank0]:2025-10-28 23:17:28,257 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-28 23:17:43,186 - INFO - validate step: 600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,428
[rank0]:2025-10-28 23:17:43,156 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,491
[rank3]:2025-10-28 23:17:43,224 - INFO - validate step: 600  loss:  0.2432  memory: 73.38GiB(52.48%)  tps: 27,365
[rank2]:2025-10-28 23:17:43,207 - INFO - validate step: 600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,386
[rank3]:2025-10-28 23:17:43,416 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2317_real_step600_rank3.svg
[rank3]:> Batch Time: 627.01 ms, GPU Bubble Ratio: 33.30%, 27.97%, 36.25%, 26.43%
[rank3]:2025-10-28 23:17:43,893 - INFO - Avg. fwd time: 14.5078 / Avg. bwd time: 42.8429 / Avg. batch time: 474.4794 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-10-28 23:17:43,936 - INFO - Avg. fwd time: 13.2147 / Avg. bwd time: 36.4949 / Avg. batch time: 527.4885 (ms) / GPU bubble ratio: 24.61%
[rank1]:2025-10-28 23:17:43,983 - INFO - Avg. fwd time: 15.0470 / Avg. bwd time: 41.1447 / Avg. batch time: 586.9658 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-10-28 23:17:44,027 - INFO - Avg. fwd time: 13.6979 / Avg. bwd time: 38.3175 / Avg. batch time: 642.1153 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-28 23:19:50,466 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-28 23:19:53,063 - INFO -  step: 650  loss:  0.0902  grad_norm:  0.1144  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.27  mfu: 29.75%
[rank1]:2025-10-28 23:19:53,060 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank2]:2025-10-28 23:19:53,058 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.24  mfu: 29.75%
[rank0]:2025-10-28 23:19:53,065 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1144  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.11  mfu: 29.74%
[rank3]:2025-10-28 23:19:53,497 - INFO - Avg. fwd time: 14.4752 / Avg. bwd time: 42.8103 / Avg. batch time: 473.9241 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:19:53,592 - INFO - Avg. fwd time: 15.0162 / Avg. bwd time: 41.1248 / Avg. batch time: 586.2965 (ms) / GPU bubble ratio: 23.40%
[rank2]:2025-10-28 23:19:53,547 - INFO - Avg. fwd time: 13.1866 / Avg. bwd time: 36.4772 / Avg. batch time: 526.8665 (ms) / GPU bubble ratio: 24.59%
[rank0]:2025-10-28 23:19:53,624 - INFO - Avg. fwd time: 13.6629 / Avg. bwd time: 38.3006 / Avg. batch time: 641.4073 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-28 23:22:00,063 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:22:02,679 - INFO -  step: 700  loss:  0.1095  grad_norm:  0.1308  memory: 73.38GiB(52.48%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank2]:2025-10-28 23:22:02,674 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 57.29GiB(40.97%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank1]:2025-10-28 23:22:02,677 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 64.32GiB(46.00%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank0]:2025-10-28 23:22:02,681 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1308  memory: 66.72GiB(47.72%)  tps: 6,320  tflops: 294.78  mfu: 29.81%
[rank3]:2025-10-28 23:22:02,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2322_real_step700_rank3.svg
[rank3]:> Batch Time: 624.79 ms, GPU Bubble Ratio: 33.25%, 27.93%, 36.20%, 26.47%
[rank2]:2025-10-28 23:22:03,304 - INFO - Avg. fwd time: 13.1568 / Avg. bwd time: 36.4597 / Avg. batch time: 526.1862 (ms) / GPU bubble ratio: 24.56%
[rank3]:2025-10-28 23:22:03,255 - INFO - Avg. fwd time: 14.4391 / Avg. bwd time: 42.7743 / Avg. batch time: 473.3141 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:22:03,350 - INFO - Avg. fwd time: 14.9794 / Avg. bwd time: 41.1010 / Avg. batch time: 585.5654 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-28 23:22:03,382 - INFO - Avg. fwd time: 13.6245 / Avg. bwd time: 38.2815 / Avg. batch time: 640.6324 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:24:09,699 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:24:12,327 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 66.72GiB(47.72%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank1]:2025-10-28 23:24:12,323 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 64.32GiB(46.00%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-28 23:24:12,321 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1559  memory: 57.29GiB(40.97%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank3]:2025-10-28 23:24:12,325 - INFO -  step: 750  loss:  0.1419  grad_norm:  0.1559  memory: 73.38GiB(52.48%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-28 23:24:12,897 - INFO - Avg. fwd time: 13.1302 / Avg. bwd time: 36.4425 / Avg. batch time: 525.6397 (ms) / GPU bubble ratio: 24.55%
[rank3]:2025-10-28 23:24:12,852 - INFO - Avg. fwd time: 14.4068 / Avg. bwd time: 42.7437 / Avg. batch time: 472.7810 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:24:12,944 - INFO - Avg. fwd time: 14.9452 / Avg. bwd time: 41.0782 / Avg. batch time: 584.9705 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-28 23:24:12,988 - INFO - Avg. fwd time: 13.5929 / Avg. bwd time: 38.2644 / Avg. batch time: 640.0055 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:26:19,375 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:26:22,010 - INFO -  step: 800  loss:  0.1190  grad_norm:  0.1343  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank3]:2025-10-28 23:26:22,011 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-28 23:26:22,005 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank2]:2025-10-28 23:26:22,006 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-28 23:26:22,008 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank1]:2025-10-28 23:26:22,008 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 23:26:22,012 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1343  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.62  mfu: 29.79%
[rank0]:2025-10-28 23:26:22,012 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-28 23:26:37,019 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,294
[rank2]:2025-10-28 23:26:37,074 - INFO - validate step: 800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,184
[rank3]:2025-10-28 23:26:37,091 - INFO - validate step: 800  loss:  0.2471  memory: 73.38GiB(52.48%)  tps: 27,162
[rank1]:2025-10-28 23:26:37,049 - INFO - validate step: 800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,233
[rank3]:2025-10-28 23:26:37,278 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2326_real_step800_rank3.svg
[rank3]:> Batch Time: 622.91 ms, GPU Bubble Ratio: 33.20%, 27.89%, 36.18%, 26.49%
[rank2]:2025-10-28 23:26:37,723 - INFO - Avg. fwd time: 13.1100 / Avg. bwd time: 36.4307 / Avg. batch time: 525.2040 (ms) / GPU bubble ratio: 24.54%
[rank3]:2025-10-28 23:26:37,673 - INFO - Avg. fwd time: 14.3821 / Avg. bwd time: 42.7226 / Avg. batch time: 472.3924 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:26:37,769 - INFO - Avg. fwd time: 14.9209 / Avg. bwd time: 41.0649 / Avg. batch time: 584.5009 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-28 23:26:37,801 - INFO - Avg. fwd time: 13.5684 / Avg. bwd time: 38.2547 / Avg. batch time: 639.5143 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-28 23:28:44,307 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:28:46,918 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.20  mfu: 29.75%
[rank2]:2025-10-28 23:28:46,915 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.26  mfu: 29.75%
[rank3]:2025-10-28 23:28:46,921 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.1056  memory: 73.38GiB(52.48%)  tps: 6,310  tflops: 294.30  mfu: 29.76%
[rank0]:2025-10-28 23:28:46,922 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1056  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank2]:2025-10-28 23:28:47,397 - INFO - Avg. fwd time: 13.0941 / Avg. bwd time: 36.4222 / Avg. batch time: 524.8303 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-28 23:28:47,348 - INFO - Avg. fwd time: 14.3602 / Avg. bwd time: 42.7009 / Avg. batch time: 472.0216 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-10-28 23:28:47,476 - INFO - Avg. fwd time: 13.5447 / Avg. bwd time: 38.2439 / Avg. batch time: 639.0870 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-28 23:28:47,444 - INFO - Avg. fwd time: 14.9001 / Avg. bwd time: 41.0535 / Avg. batch time: 584.0995 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-28 23:30:53,538 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:30:56,125 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 64.32GiB(46.00%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank2]:2025-10-28 23:30:56,122 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 57.29GiB(40.97%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank3]:2025-10-28 23:30:56,127 - INFO -  step: 900  loss:  0.1272  grad_norm:  0.1407  memory: 73.38GiB(52.48%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank0]:2025-10-28 23:30:56,129 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1407  memory: 66.72GiB(47.72%)  tps: 6,340  tflops: 295.71  mfu: 29.90%
[rank3]:2025-10-28 23:30:56,313 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2330_real_step900_rank3.svg
[rank3]:> Batch Time: 621.51 ms, GPU Bubble Ratio: 33.18%, 27.82%, 36.14%, 26.53%
[rank2]:2025-10-28 23:30:56,823 - INFO - Avg. fwd time: 13.0776 / Avg. bwd time: 36.4151 / Avg. batch time: 524.3267 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-10-28 23:30:56,781 - INFO - Avg. fwd time: 14.3368 / Avg. bwd time: 42.6644 / Avg. batch time: 471.5218 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:30:56,871 - INFO - Avg. fwd time: 14.8827 / Avg. bwd time: 41.0564 / Avg. batch time: 583.6051 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-28 23:30:56,915 - INFO - Avg. fwd time: 13.5241 / Avg. bwd time: 38.2374 / Avg. batch time: 638.5735 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-28 23:33:02,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:33:05,582 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 66.72GiB(47.72%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank2]:2025-10-28 23:33:05,575 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 57.29GiB(40.97%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank1]:2025-10-28 23:33:05,578 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1471  memory: 64.32GiB(46.00%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank3]:2025-10-28 23:33:05,581 - INFO -  step: 950  loss:  0.1548  grad_norm:  0.1471  memory: 73.38GiB(52.48%)  tps: 6,328  tflops: 295.15  mfu: 29.84%
[rank3]:2025-10-28 23:33:06,015 - INFO - Avg. fwd time: 14.3198 / Avg. bwd time: 42.6362 / Avg. batch time: 471.1446 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:33:06,064 - INFO - Avg. fwd time: 13.0659 / Avg. bwd time: 36.4093 / Avg. batch time: 523.9177 (ms) / GPU bubble ratio: 24.45%
[rank1]:2025-10-28 23:33:06,109 - INFO - Avg. fwd time: 14.8726 / Avg. bwd time: 41.0603 / Avg. batch time: 583.2041 (ms) / GPU bubble ratio: 23.28%
[rank0]:2025-10-28 23:33:06,143 - INFO - Avg. fwd time: 13.5091 / Avg. bwd time: 38.2335 / Avg. batch time: 638.1618 (ms) / GPU bubble ratio: 35.14%
[rank0]:2025-10-28 23:35:12,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:35:15,246 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 64.32GiB(46.00%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank1]:2025-10-28 23:35:15,246 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-28 23:35:15,243 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 57.29GiB(40.97%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank2]:2025-10-28 23:35:15,243 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-28 23:35:15,248 - INFO -  step: 1000  loss:  0.1276  grad_norm:  0.1068  memory: 73.38GiB(52.48%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank3]:2025-10-28 23:35:15,249 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 23:35:15,250 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1068  memory: 66.72GiB(47.72%)  tps: 6,318  tflops: 294.66  mfu: 29.79%
[rank0]:2025-10-28 23:35:15,250 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-28 23:35:30,152 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,488
[rank2]:2025-10-28 23:35:30,205 - INFO - validate step: 1000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,377
[rank1]:2025-10-28 23:35:30,183 - INFO - validate step: 1000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,422
[rank3]:2025-10-28 23:35:30,224 - INFO - validate step: 1000  loss:  0.2472  memory: 73.38GiB(52.48%)  tps: 27,353
[rank3]:2025-10-28 23:35:30,421 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2335_real_step1000_rank3.svg
[rank3]:> Batch Time: 620.34 ms, GPU Bubble Ratio: 33.16%, 27.74%, 36.10%, 26.56%
[rank2]:2025-10-28 23:35:30,858 - INFO - Avg. fwd time: 13.0515 / Avg. bwd time: 36.4025 / Avg. batch time: 523.5834 (ms) / GPU bubble ratio: 24.44%
[rank3]:2025-10-28 23:35:30,809 - INFO - Avg. fwd time: 14.3010 / Avg. bwd time: 42.6198 / Avg. batch time: 470.8462 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:35:30,904 - INFO - Avg. fwd time: 14.8572 / Avg. bwd time: 41.0577 / Avg. batch time: 582.8563 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-10-28 23:35:30,937 - INFO - Avg. fwd time: 13.4913 / Avg. bwd time: 38.2266 / Avg. batch time: 637.8021 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:37:37,471 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-28 23:37:40,083 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 66.72GiB(47.72%)  tps: 6,305  tflops: 294.06  mfu: 29.73%
[rank2]:2025-10-28 23:37:40,076 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 57.29GiB(40.97%)  tps: 6,308  tflops: 294.20  mfu: 29.75%
[rank1]:2025-10-28 23:37:40,079 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1188  memory: 64.32GiB(46.00%)  tps: 6,307  tflops: 294.14  mfu: 29.74%
[rank3]:2025-10-28 23:37:40,081 - INFO -  step: 1050  loss:  0.1321  grad_norm:  0.1188  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.23  mfu: 29.75%
[rank3]:2025-10-28 23:37:40,606 - INFO - Avg. fwd time: 14.2859 / Avg. bwd time: 42.6064 / Avg. batch time: 470.6035 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:37:40,651 - INFO - Avg. fwd time: 13.0391 / Avg. bwd time: 36.3946 / Avg. batch time: 523.3398 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-10-28 23:37:40,699 - INFO - Avg. fwd time: 14.8417 / Avg. bwd time: 41.0505 / Avg. batch time: 582.5934 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-10-28 23:37:40,746 - INFO - Avg. fwd time: 13.4749 / Avg. bwd time: 38.2196 / Avg. batch time: 637.5252 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:39:47,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:39:49,845 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-28 23:39:49,847 - INFO -  step: 1100  loss:  0.1014  grad_norm:  0.0931  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank2]:2025-10-28 23:39:49,843 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank0]:2025-10-28 23:39:49,849 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0931  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-28 23:39:50,042 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2339_real_step1100_rank3.svg
[rank3]:> Batch Time: 619.63 ms, GPU Bubble Ratio: 33.16%, 27.72%, 36.10%, 26.57%
[rank3]:2025-10-28 23:39:50,431 - INFO - Avg. fwd time: 14.2743 / Avg. bwd time: 42.5967 / Avg. batch time: 470.4218 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:39:50,526 - INFO - Avg. fwd time: 14.8305 / Avg. bwd time: 41.0426 / Avg. batch time: 582.3648 (ms) / GPU bubble ratio: 23.25%
[rank2]:2025-10-28 23:39:50,480 - INFO - Avg. fwd time: 13.0300 / Avg. bwd time: 36.3888 / Avg. batch time: 523.1322 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-10-28 23:39:50,559 - INFO - Avg. fwd time: 13.4634 / Avg. bwd time: 38.2133 / Avg. batch time: 637.2880 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:41:57,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:41:59,723 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 66.72GiB(47.72%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank1]:2025-10-28 23:41:59,719 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 64.32GiB(46.00%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank3]:2025-10-28 23:41:59,721 - INFO -  step: 1150  loss:  0.1214  grad_norm:  0.1185  memory: 73.38GiB(52.48%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank2]:2025-10-28 23:41:59,716 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1185  memory: 57.29GiB(40.97%)  tps: 6,308  tflops: 294.19  mfu: 29.75%
[rank3]:2025-10-28 23:42:00,166 - INFO - Avg. fwd time: 14.2624 / Avg. bwd time: 42.5866 / Avg. batch time: 470.2337 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-28 23:42:00,261 - INFO - Avg. fwd time: 14.8174 / Avg. bwd time: 41.0339 / Avg. batch time: 582.1550 (ms) / GPU bubble ratio: 23.25%
[rank2]:2025-10-28 23:42:00,215 - INFO - Avg. fwd time: 13.0198 / Avg. bwd time: 36.3819 / Avg. batch time: 522.9442 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-10-28 23:42:00,294 - INFO - Avg. fwd time: 13.4508 / Avg. bwd time: 38.2065 / Avg. batch time: 637.0661 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-10-28 23:44:06,782 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:44:09,412 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 66.72GiB(47.72%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank0]:2025-10-28 23:44:09,412 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-28 23:44:09,410 - INFO -  step: 1200  loss:  0.1043  grad_norm:  0.0961  memory: 73.38GiB(52.48%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank3]:2025-10-28 23:44:09,410 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-28 23:44:09,408 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 64.32GiB(46.00%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank1]:2025-10-28 23:44:09,408 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-28 23:44:09,405 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0961  memory: 57.29GiB(40.97%)  tps: 6,317  tflops: 294.61  mfu: 29.79%
[rank2]:2025-10-28 23:44:09,405 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-28 23:44:24,338 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,444
[rank0]:2025-10-28 23:44:24,338 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-28 23:44:24,342 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-28 23:44:24,367 - INFO - validate step: 1200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,381
[rank1]:2025-10-28 23:44:24,368 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 23:44:24,413 - INFO - validate step: 1200  loss:  0.2496  memory: 73.38GiB(52.48%)  tps: 27,304
[rank3]:2025-10-28 23:44:24,414 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-28 23:44:24,394 - INFO - validate step: 1200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,329
[rank2]:2025-10-28 23:44:24,394 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-28 23:44:37,258 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.84 seconds.
[rank0]:2025-10-28 23:44:37,984 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-28 23:44:37,989 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.65 seconds.
[rank2]:2025-10-28 23:44:38,932 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.54 seconds.
[rank1]:2025-10-28 23:44:39,638 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.27 seconds.
[rank1]:2025-10-28 23:44:39,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-28 23:44:39,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-28 23:44:39,705 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-28 23:44:39,941 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2344_real_step1200_rank3.svg
[rank3]:> Batch Time: 619.18 ms, GPU Bubble Ratio: 33.19%, 27.74%, 36.09%, 26.57%
[rank3]:2025-10-28 23:44:39,954 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-28 23:44:40,986 - INFO - Avg. fwd time: 14.2527 / Avg. bwd time: 42.5772 / Avg. batch time: 470.1854 (ms) / GPU bubble ratio: 3.31%
[rank1]:2025-10-28 23:44:41,082 - INFO - Avg. fwd time: 14.8061 / Avg. bwd time: 41.0255 / Avg. batch time: 582.1009 (ms) / GPU bubble ratio: 23.27%
[rank2]:2025-10-28 23:44:41,032 - INFO - Avg. fwd time: 13.0115 / Avg. bwd time: 36.3753 / Avg. batch time: 522.9101 (ms) / GPU bubble ratio: 24.44%
[rank0]:2025-10-28 23:44:41,129 - INFO - Avg. fwd time: 13.4411 / Avg. bwd time: 38.1998 / Avg. batch time: 637.0002 (ms) / GPU bubble ratio: 35.14%
[rank0]:2025-10-28 23:46:54,509 - INFO - [GC] Peforming periodical GC collection 1.84 seconds
[rank0]:2025-10-28 23:46:57,430 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 66.72GiB(47.72%)  tps: 5,351  tflops: 249.57  mfu: 25.23%
[rank1]:2025-10-28 23:46:57,426 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 64.32GiB(46.00%)  tps: 5,352  tflops: 249.63  mfu: 25.24%
[rank2]:2025-10-28 23:46:57,424 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4648  memory: 57.29GiB(40.97%)  tps: 5,353  tflops: 249.67  mfu: 25.25%
[rank3]:2025-10-28 23:46:57,428 - INFO -  step: 1250  loss:  0.8946  grad_norm:  0.4648  memory: 73.38GiB(52.48%)  tps: 5,354  tflops: 249.70  mfu: 25.25%
[rank3]:2025-10-28 23:46:57,895 - INFO - Avg. fwd time: 14.2732 / Avg. bwd time: 42.5990 / Avg. batch time: 470.5173 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:46:57,991 - INFO - Avg. fwd time: 14.8213 / Avg. bwd time: 41.0316 / Avg. batch time: 582.4544 (ms) / GPU bubble ratio: 23.29%
[rank2]:2025-10-28 23:46:57,945 - INFO - Avg. fwd time: 13.0268 / Avg. bwd time: 36.3859 / Avg. batch time: 523.2509 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-28 23:46:58,025 - INFO - Avg. fwd time: 13.4579 / Avg. bwd time: 38.2074 / Avg. batch time: 637.3728 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-28 23:49:09,566 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:49:12,288 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank1]:2025-10-28 23:49:12,283 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank2]:2025-10-28 23:49:12,281 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.4175  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:49:12,286 - INFO -  step: 1300  loss:  0.7896  grad_norm:  0.4175  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:49:12,475 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2349_real_step1300_rank3.svg
[rank3]:> Batch Time: 620.16 ms, GPU Bubble Ratio: 33.19%, 27.77%, 36.10%, 26.55%
[rank3]:2025-10-28 23:49:12,891 - INFO - Avg. fwd time: 14.2966 / Avg. bwd time: 42.6247 / Avg. batch time: 470.9037 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-10-28 23:49:12,987 - INFO - Avg. fwd time: 14.8393 / Avg. bwd time: 41.0394 / Avg. batch time: 582.8860 (ms) / GPU bubble ratio: 23.31%
[rank2]:2025-10-28 23:49:12,940 - INFO - Avg. fwd time: 13.0440 / Avg. bwd time: 36.3962 / Avg. batch time: 523.6665 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-28 23:49:13,020 - INFO - Avg. fwd time: 13.4758 / Avg. bwd time: 38.2165 / Avg. batch time: 637.8317 (ms) / GPU bubble ratio: 35.16%
[rank0]:2025-10-28 23:51:24,903 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-28 23:51:27,626 - INFO -  step: 1350  loss:  0.8085  grad_norm:  0.4560  memory: 73.38GiB(52.48%)  tps: 6,053  tflops: 282.31  mfu: 28.55%
[rank0]:2025-10-28 23:51:27,628 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 66.72GiB(47.72%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank1]:2025-10-28 23:51:27,624 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 64.32GiB(46.00%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank2]:2025-10-28 23:51:27,621 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.4560  memory: 57.29GiB(40.97%)  tps: 6,053  tflops: 282.31  mfu: 28.54%
[rank3]:2025-10-28 23:51:28,180 - INFO - Avg. fwd time: 14.3183 / Avg. bwd time: 42.6485 / Avg. batch time: 471.2610 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:51:28,275 - INFO - Avg. fwd time: 14.8553 / Avg. bwd time: 41.0468 / Avg. batch time: 583.2933 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-10-28 23:51:28,226 - INFO - Avg. fwd time: 13.0600 / Avg. bwd time: 36.4057 / Avg. batch time: 524.0577 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-28 23:51:28,325 - INFO - Avg. fwd time: 13.4922 / Avg. bwd time: 38.2252 / Avg. batch time: 638.2601 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-28 23:53:40,226 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:53:42,952 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 66.72GiB(47.72%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank0]:2025-10-28 23:53:42,952 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-28 23:53:42,948 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 64.32GiB(46.00%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank1]:2025-10-28 23:53:42,948 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-28 23:53:42,945 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.4309  memory: 57.29GiB(40.97%)  tps: 6,054  tflops: 282.34  mfu: 28.55%
[rank2]:2025-10-28 23:53:42,945 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-28 23:53:42,950 - INFO -  step: 1400  loss:  0.8072  grad_norm:  0.4309  memory: 73.38GiB(52.48%)  tps: 6,054  tflops: 282.35  mfu: 28.55%
[rank3]:2025-10-28 23:53:42,950 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-28 23:53:57,850 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,494
[rank1]:2025-10-28 23:53:57,880 - INFO - validate step: 1400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,431
[rank2]:2025-10-28 23:53:57,907 - INFO - validate step: 1400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,377
[rank3]:2025-10-28 23:53:57,927 - INFO - validate step: 1400  loss:  0.2457  memory: 73.38GiB(52.48%)  tps: 27,350
[rank3]:2025-10-28 23:53:58,124 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2353_real_step1400_rank3.svg
[rank3]:> Batch Time: 621.27 ms, GPU Bubble Ratio: 33.20%, 27.82%, 36.14%, 26.53%
[rank3]:2025-10-28 23:53:58,544 - INFO - Avg. fwd time: 14.3354 / Avg. bwd time: 42.6683 / Avg. batch time: 471.5512 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-10-28 23:53:58,594 - INFO - Avg. fwd time: 13.0726 / Avg. bwd time: 36.4133 / Avg. batch time: 524.3534 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-10-28 23:53:58,672 - INFO - Avg. fwd time: 13.5060 / Avg. bwd time: 38.2321 / Avg. batch time: 638.5862 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-28 23:53:58,640 - INFO - Avg. fwd time: 14.8685 / Avg. bwd time: 41.0536 / Avg. batch time: 583.6009 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-28 23:56:10,312 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-28 23:56:13,029 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 66.72GiB(47.72%)  tps: 6,060  tflops: 282.65  mfu: 28.58%
[rank1]:2025-10-28 23:56:13,024 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.72  mfu: 28.59%
[rank2]:2025-10-28 23:56:13,022 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4641  memory: 57.29GiB(40.97%)  tps: 6,063  tflops: 282.78  mfu: 28.59%
[rank3]:2025-10-28 23:56:13,027 - INFO -  step: 1450  loss:  0.8387  grad_norm:  0.4641  memory: 73.38GiB(52.48%)  tps: 6,064  tflops: 282.82  mfu: 28.60%
[rank2]:2025-10-28 23:56:13,542 - INFO - Avg. fwd time: 13.0862 / Avg. bwd time: 36.4210 / Avg. batch time: 524.7065 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-28 23:56:13,492 - INFO - Avg. fwd time: 14.3546 / Avg. bwd time: 42.6901 / Avg. batch time: 471.8736 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-10-28 23:56:13,621 - INFO - Avg. fwd time: 13.5198 / Avg. bwd time: 38.2396 / Avg. batch time: 638.9690 (ms) / GPU bubble ratio: 35.20%
[rank1]:2025-10-28 23:56:13,587 - INFO - Avg. fwd time: 14.8829 / Avg. bwd time: 41.0612 / Avg. batch time: 583.9696 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-28 23:58:25,181 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-28 23:58:27,881 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 64.32GiB(46.00%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank0]:2025-10-28 23:58:27,886 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 66.72GiB(47.72%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank2]:2025-10-28 23:58:27,879 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3998  memory: 57.29GiB(40.97%)  tps: 6,075  tflops: 283.32  mfu: 28.65%
[rank3]:2025-10-28 23:58:27,883 - INFO -  step: 1500  loss:  0.7151  grad_norm:  0.3998  memory: 73.38GiB(52.48%)  tps: 6,075  tflops: 283.33  mfu: 28.65%
[rank3]:2025-10-28 23:58:28,078 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251028_2358_real_step1500_rank3.svg
[rank3]:> Batch Time: 622.26 ms, GPU Bubble Ratio: 33.23%, 27.86%, 36.16%, 26.51%
[rank2]:2025-10-28 23:58:28,624 - INFO - Avg. fwd time: 13.0995 / Avg. bwd time: 36.4296 / Avg. batch time: 525.0113 (ms) / GPU bubble ratio: 24.53%
[rank3]:2025-10-28 23:58:28,579 - INFO - Avg. fwd time: 14.3710 / Avg. bwd time: 42.7087 / Avg. batch time: 472.1481 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-10-28 23:58:28,673 - INFO - Avg. fwd time: 14.8959 / Avg. bwd time: 41.0682 / Avg. batch time: 584.2891 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-28 23:58:28,721 - INFO - Avg. fwd time: 13.5328 / Avg. bwd time: 38.2465 / Avg. batch time: 639.3024 (ms) / GPU bubble ratio: 35.21%
[rank0]:2025-10-29 00:00:39,935 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:00:42,647 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 66.72GiB(47.72%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank2]:2025-10-29 00:00:42,640 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 57.29GiB(40.97%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank3]:2025-10-29 00:00:42,645 - INFO -  step: 1550  loss:  0.7768  grad_norm:  0.4054  memory: 73.38GiB(52.48%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank1]:2025-10-29 00:00:42,643 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4054  memory: 64.32GiB(46.00%)  tps: 6,079  tflops: 283.52  mfu: 28.67%
[rank3]:2025-10-29 00:00:43,105 - INFO - Avg. fwd time: 14.3843 / Avg. bwd time: 42.7176 / Avg. batch time: 472.3214 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:00:43,202 - INFO - Avg. fwd time: 14.9095 / Avg. bwd time: 41.0803 / Avg. batch time: 584.4896 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-29 00:00:43,236 - INFO - Avg. fwd time: 13.5449 / Avg. bwd time: 38.2538 / Avg. batch time: 639.5160 (ms) / GPU bubble ratio: 35.20%
[rank2]:2025-10-29 00:00:43,155 - INFO - Avg. fwd time: 13.1109 / Avg. bwd time: 36.4367 / Avg. batch time: 525.1900 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-10-29 00:02:53,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:02:56,027 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 64.32GiB(46.00%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank1]:2025-10-29 00:02:56,027 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 00:02:56,031 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 66.72GiB(47.72%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank0]:2025-10-29 00:02:56,031 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 00:02:56,025 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2100  memory: 57.29GiB(40.97%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank2]:2025-10-29 00:02:56,025 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 00:02:56,029 - INFO -  step: 1600  loss:  0.1115  grad_norm:  0.2100  memory: 73.38GiB(52.48%)  tps: 6,142  tflops: 286.45  mfu: 28.96%
[rank3]:2025-10-29 00:02:56,029 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 00:03:10,955 - INFO - validate step: 1600  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,439
[rank0]:2025-10-29 00:03:10,926 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,501
[rank2]:2025-10-29 00:03:10,969 - INFO - validate step: 1600  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,409
[rank3]:2025-10-29 00:03:10,985 - INFO - validate step: 1600  loss:  0.2506  memory: 73.38GiB(52.48%)  tps: 27,390
[rank3]:2025-10-29 00:03:11,176 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0003_real_step1600_rank3.svg
[rank3]:> Batch Time: 623.02 ms, GPU Bubble Ratio: 33.24%, 27.87%, 36.17%, 26.50%
[rank3]:2025-10-29 00:03:11,569 - INFO - Avg. fwd time: 14.3932 / Avg. bwd time: 42.7203 / Avg. batch time: 472.4084 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:03:11,619 - INFO - Avg. fwd time: 13.1188 / Avg. bwd time: 36.4422 / Avg. batch time: 525.2772 (ms) / GPU bubble ratio: 24.52%
[rank1]:2025-10-29 00:03:11,665 - INFO - Avg. fwd time: 14.9197 / Avg. bwd time: 41.0920 / Avg. batch time: 584.5970 (ms) / GPU bubble ratio: 23.35%
[rank0]:2025-10-29 00:03:11,697 - INFO - Avg. fwd time: 13.5528 / Avg. bwd time: 38.2597 / Avg. batch time: 639.6347 (ms) / GPU bubble ratio: 35.20%
[rank0]:2025-10-29 00:05:18,438 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:05:21,056 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 66.72GiB(47.72%)  tps: 6,295  tflops: 293.61  mfu: 29.69%
[rank1]:2025-10-29 00:05:21,052 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 64.32GiB(46.00%)  tps: 6,297  tflops: 293.69  mfu: 29.70%
[rank2]:2025-10-29 00:05:21,049 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1533  memory: 57.29GiB(40.97%)  tps: 6,298  tflops: 293.72  mfu: 29.70%
[rank3]:2025-10-29 00:05:21,054 - INFO -  step: 1650  loss:  0.0970  grad_norm:  0.1533  memory: 73.38GiB(52.48%)  tps: 6,298  tflops: 293.75  mfu: 29.70%
[rank2]:2025-10-29 00:05:21,628 - INFO - Avg. fwd time: 13.1092 / Avg. bwd time: 36.4376 / Avg. batch time: 525.0952 (ms) / GPU bubble ratio: 24.51%
[rank3]:2025-10-29 00:05:21,579 - INFO - Avg. fwd time: 14.3818 / Avg. bwd time: 42.7106 / Avg. batch time: 472.2297 (ms) / GPU bubble ratio: 3.28%
[rank0]:2025-10-29 00:05:21,729 - INFO - Avg. fwd time: 13.5425 / Avg. bwd time: 38.2549 / Avg. batch time: 639.4369 (ms) / GPU bubble ratio: 35.20%
[rank1]:2025-10-29 00:05:21,679 - INFO - Avg. fwd time: 14.9110 / Avg. bwd time: 41.0900 / Avg. batch time: 584.4074 (ms) / GPU bubble ratio: 23.34%
[rank0]:2025-10-29 00:07:28,230 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:07:30,824 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank0]:2025-10-29 00:07:30,828 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank2]:2025-10-29 00:07:30,821 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1172  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.42  mfu: 29.77%
[rank3]:2025-10-29 00:07:30,826 - INFO -  step: 1700  loss:  0.0986  grad_norm:  0.1172  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:07:31,015 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0007_real_step1700_rank3.svg
[rank3]:> Batch Time: 622.35 ms, GPU Bubble Ratio: 33.23%, 27.84%, 36.15%, 26.51%
[rank2]:2025-10-29 00:07:31,448 - INFO - Avg. fwd time: 13.1014 / Avg. bwd time: 36.4337 / Avg. batch time: 524.9157 (ms) / GPU bubble ratio: 24.51%
[rank3]:2025-10-29 00:07:31,400 - INFO - Avg. fwd time: 14.3720 / Avg. bwd time: 42.7016 / Avg. batch time: 472.0719 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:07:31,494 - INFO - Avg. fwd time: 14.9023 / Avg. bwd time: 41.0845 / Avg. batch time: 584.2137 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:07:31,526 - INFO - Avg. fwd time: 13.5334 / Avg. bwd time: 38.2513 / Avg. batch time: 639.2355 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:09:38,126 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 00:09:40,727 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 64.32GiB(46.00%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank3]:2025-10-29 00:09:40,729 - INFO -  step: 1750  loss:  0.1070  grad_norm:  0.1126  memory: 73.38GiB(52.48%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank0]:2025-10-29 00:09:40,731 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 66.72GiB(47.72%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank2]:2025-10-29 00:09:40,724 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1126  memory: 57.29GiB(40.97%)  tps: 6,306  tflops: 294.13  mfu: 29.74%
[rank3]:2025-10-29 00:09:41,164 - INFO - Avg. fwd time: 14.3618 / Avg. bwd time: 42.6927 / Avg. batch time: 471.9112 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:09:41,260 - INFO - Avg. fwd time: 14.8927 / Avg. bwd time: 41.0787 / Avg. batch time: 584.0352 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-10-29 00:09:41,214 - INFO - Avg. fwd time: 13.0931 / Avg. bwd time: 36.4294 / Avg. batch time: 524.7515 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-10-29 00:09:41,293 - INFO - Avg. fwd time: 13.5238 / Avg. bwd time: 38.2473 / Avg. batch time: 639.0486 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:11:47,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:11:50,469 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 57.29GiB(40.97%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank2]:2025-10-29 00:11:50,470 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 00:11:50,472 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 64.32GiB(46.00%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank1]:2025-10-29 00:11:50,472 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 00:11:50,477 - INFO -  step: 1800  loss:  0.0846  grad_norm:  0.0934  memory: 73.38GiB(52.48%)  tps: 6,314  tflops: 294.49  mfu: 29.78%
[rank3]:2025-10-29 00:11:50,477 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 00:11:50,476 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0934  memory: 66.72GiB(47.72%)  tps: 6,314  tflops: 294.48  mfu: 29.78%
[rank0]:2025-10-29 00:11:50,476 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 00:12:05,470 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,319
[rank1]:2025-10-29 00:12:05,500 - INFO - validate step: 1800  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,256
[rank3]:2025-10-29 00:12:05,545 - INFO - validate step: 1800  loss:  0.2421  memory: 73.38GiB(52.48%)  tps: 27,186
[rank2]:2025-10-29 00:12:05,526 - INFO - validate step: 1800  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,206
[rank3]:2025-10-29 00:12:05,742 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0012_real_step1800_rank3.svg
[rank3]:> Batch Time: 621.73 ms, GPU Bubble Ratio: 33.21%, 27.82%, 36.13%, 26.52%
[rank3]:2025-10-29 00:12:06,220 - INFO - Avg. fwd time: 14.3517 / Avg. bwd time: 42.6841 / Avg. batch time: 471.7525 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:12:06,267 - INFO - Avg. fwd time: 13.0851 / Avg. bwd time: 36.4251 / Avg. batch time: 524.5904 (ms) / GPU bubble ratio: 24.50%
[rank1]:2025-10-29 00:12:06,318 - INFO - Avg. fwd time: 14.8834 / Avg. bwd time: 41.0721 / Avg. batch time: 583.8592 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:12:06,365 - INFO - Avg. fwd time: 13.5140 / Avg. bwd time: 38.2430 / Avg. batch time: 638.8645 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:14:12,939 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:14:15,550 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 66.72GiB(47.72%)  tps: 6,298  tflops: 293.72  mfu: 29.70%
[rank3]:2025-10-29 00:14:15,548 - INFO -  step: 1850  loss:  0.0715  grad_norm:  0.1181  memory: 73.38GiB(52.48%)  tps: 6,301  tflops: 293.90  mfu: 29.72%
[rank2]:2025-10-29 00:14:15,543 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 57.29GiB(40.97%)  tps: 6,301  tflops: 293.87  mfu: 29.71%
[rank1]:2025-10-29 00:14:15,546 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1181  memory: 64.32GiB(46.00%)  tps: 6,299  tflops: 293.80  mfu: 29.71%
[rank3]:2025-10-29 00:14:15,991 - INFO - Avg. fwd time: 14.3442 / Avg. bwd time: 42.6779 / Avg. batch time: 471.6362 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:14:16,041 - INFO - Avg. fwd time: 13.0794 / Avg. bwd time: 36.4212 / Avg. batch time: 524.4571 (ms) / GPU bubble ratio: 24.49%
[rank1]:2025-10-29 00:14:16,086 - INFO - Avg. fwd time: 14.8769 / Avg. bwd time: 41.0672 / Avg. batch time: 583.7137 (ms) / GPU bubble ratio: 23.33%
[rank0]:2025-10-29 00:14:16,120 - INFO - Avg. fwd time: 13.5071 / Avg. bwd time: 38.2396 / Avg. batch time: 638.7140 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-29 00:16:22,693 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:16:25,311 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 57.29GiB(40.97%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:16:25,315 - INFO -  step: 1900  loss:  0.0874  grad_norm:  0.0985  memory: 73.38GiB(52.48%)  tps: 6,313  tflops: 294.44  mfu: 29.77%
[rank0]:2025-10-29 00:16:25,317 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 66.72GiB(47.72%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank1]:2025-10-29 00:16:25,313 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0985  memory: 64.32GiB(46.00%)  tps: 6,313  tflops: 294.43  mfu: 29.77%
[rank3]:2025-10-29 00:16:25,504 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0016_real_step1900_rank3.svg
[rank3]:> Batch Time: 621.34 ms, GPU Bubble Ratio: 33.22%, 27.82%, 36.15%, 26.53%
[rank2]:2025-10-29 00:16:25,948 - INFO - Avg. fwd time: 13.0722 / Avg. bwd time: 36.4172 / Avg. batch time: 524.2898 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-10-29 00:16:25,899 - INFO - Avg. fwd time: 14.3349 / Avg. bwd time: 42.6697 / Avg. batch time: 471.4892 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:16:25,993 - INFO - Avg. fwd time: 14.8688 / Avg. bwd time: 41.0610 / Avg. batch time: 583.5328 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:16:26,025 - INFO - Avg. fwd time: 13.4984 / Avg. bwd time: 38.2358 / Avg. batch time: 638.5254 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:18:32,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:18:35,292 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 57.29GiB(40.97%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank0]:2025-10-29 00:18:35,298 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 66.72GiB(47.72%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:18:35,297 - INFO -  step: 1950  loss:  0.1128  grad_norm:  0.1428  memory: 73.38GiB(52.48%)  tps: 6,303  tflops: 293.95  mfu: 29.72%
[rank1]:2025-10-29 00:18:35,294 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1428  memory: 64.32GiB(46.00%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:18:35,830 - INFO - Avg. fwd time: 14.3268 / Avg. bwd time: 42.6635 / Avg. batch time: 471.3682 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:18:35,878 - INFO - Avg. fwd time: 13.0660 / Avg. bwd time: 36.4132 / Avg. batch time: 524.1683 (ms) / GPU bubble ratio: 24.48%
[rank0]:2025-10-29 00:18:35,977 - INFO - Avg. fwd time: 13.4911 / Avg. bwd time: 38.2320 / Avg. batch time: 638.3863 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-29 00:18:35,928 - INFO - Avg. fwd time: 14.8617 / Avg. bwd time: 41.0552 / Avg. batch time: 583.3984 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:20:42,507 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:20:45,142 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 57.29GiB(40.97%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank2]:2025-10-29 00:20:45,142 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 00:20:45,148 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 66.72GiB(47.72%)  tps: 6,309  tflops: 294.24  mfu: 29.75%
[rank0]:2025-10-29 00:20:45,148 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 00:20:45,146 - INFO -  step: 2000  loss:  0.0971  grad_norm:  0.1179  memory: 73.38GiB(52.48%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank3]:2025-10-29 00:20:45,147 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 00:20:45,144 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1179  memory: 64.32GiB(46.00%)  tps: 6,309  tflops: 294.25  mfu: 29.75%
[rank1]:2025-10-29 00:20:45,144 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 00:21:00,069 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,452
[rank1]:2025-10-29 00:21:00,101 - INFO - validate step: 2000  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,386
[rank3]:2025-10-29 00:21:00,144 - INFO - validate step: 2000  loss:  0.2433  memory: 73.38GiB(52.48%)  tps: 27,313
[rank2]:2025-10-29 00:21:00,128 - INFO - validate step: 2000  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,333
[rank3]:2025-10-29 00:21:00,335 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0021_real_step2000_rank3.svg
[rank3]:> Batch Time: 620.81 ms, GPU Bubble Ratio: 33.21%, 27.81%, 36.12%, 26.54%
[rank3]:2025-10-29 00:21:00,737 - INFO - Avg. fwd time: 14.3197 / Avg. bwd time: 42.6580 / Avg. batch time: 471.2612 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:21:00,786 - INFO - Avg. fwd time: 13.0604 / Avg. bwd time: 36.4101 / Avg. batch time: 524.0452 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-10-29 00:21:00,832 - INFO - Avg. fwd time: 14.8551 / Avg. bwd time: 41.0508 / Avg. batch time: 583.2640 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:21:00,865 - INFO - Avg. fwd time: 13.4844 / Avg. bwd time: 38.2294 / Avg. batch time: 638.2469 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:23:07,555 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:23:10,175 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 57.29GiB(40.97%)  tps: 6,299  tflops: 293.80  mfu: 29.71%
[rank0]:2025-10-29 00:23:10,181 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 66.72GiB(47.72%)  tps: 6,296  tflops: 293.65  mfu: 29.69%
[rank3]:2025-10-29 00:23:10,179 - INFO -  step: 2050  loss:  0.1288  grad_norm:  0.1226  memory: 73.38GiB(52.48%)  tps: 6,300  tflops: 293.83  mfu: 29.71%
[rank1]:2025-10-29 00:23:10,177 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1226  memory: 64.32GiB(46.00%)  tps: 6,298  tflops: 293.73  mfu: 29.70%
[rank3]:2025-10-29 00:23:10,616 - INFO - Avg. fwd time: 14.3128 / Avg. bwd time: 42.6524 / Avg. batch time: 471.1550 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-10-29 00:23:10,665 - INFO - Avg. fwd time: 13.0551 / Avg. bwd time: 36.4066 / Avg. batch time: 523.9373 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-10-29 00:23:10,711 - INFO - Avg. fwd time: 14.8494 / Avg. bwd time: 41.0461 / Avg. batch time: 583.1450 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:23:10,744 - INFO - Avg. fwd time: 13.4779 / Avg. bwd time: 38.2262 / Avg. batch time: 638.1213 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:25:17,365 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:25:19,971 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 66.72GiB(47.72%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank3]:2025-10-29 00:25:19,969 - INFO -  step: 2100  loss:  0.1125  grad_norm:  0.1031  memory: 73.38GiB(52.48%)  tps: 6,312  tflops: 294.39  mfu: 29.77%
[rank1]:2025-10-29 00:25:19,966 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 64.32GiB(46.00%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank2]:2025-10-29 00:25:19,964 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1031  memory: 57.29GiB(40.97%)  tps: 6,312  tflops: 294.38  mfu: 29.77%
[rank3]:2025-10-29 00:25:20,161 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0025_real_step2100_rank3.svg
[rank3]:> Batch Time: 620.52 ms, GPU Bubble Ratio: 33.21%, 27.81%, 36.11%, 26.54%
[rank3]:2025-10-29 00:25:20,640 - INFO - Avg. fwd time: 14.3058 / Avg. bwd time: 42.6467 / Avg. batch time: 471.0482 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-10-29 00:25:20,737 - INFO - Avg. fwd time: 14.8431 / Avg. bwd time: 41.0416 / Avg. batch time: 583.0271 (ms) / GPU bubble ratio: 23.32%
[rank2]:2025-10-29 00:25:20,686 - INFO - Avg. fwd time: 13.0495 / Avg. bwd time: 36.4040 / Avg. batch time: 523.8301 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 00:25:20,785 - INFO - Avg. fwd time: 13.4712 / Avg. bwd time: 38.2234 / Avg. batch time: 637.9982 (ms) / GPU bubble ratio: 35.18%
[rank0]:2025-10-29 00:27:27,339 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:27:29,945 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 57.29GiB(40.97%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank0]:2025-10-29 00:27:29,952 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 66.72GiB(47.72%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank1]:2025-10-29 00:27:29,948 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1567  memory: 64.32GiB(46.00%)  tps: 6,302  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:27:29,950 - INFO -  step: 2150  loss:  0.1348  grad_norm:  0.1567  memory: 73.38GiB(52.48%)  tps: 6,303  tflops: 293.95  mfu: 29.72%
[rank3]:2025-10-29 00:27:30,391 - INFO - Avg. fwd time: 14.3007 / Avg. bwd time: 42.6419 / Avg. batch time: 470.9646 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:27:30,440 - INFO - Avg. fwd time: 13.0455 / Avg. bwd time: 36.4019 / Avg. batch time: 523.7320 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-29 00:27:30,520 - INFO - Avg. fwd time: 13.4660 / Avg. bwd time: 38.2207 / Avg. batch time: 637.8862 (ms) / GPU bubble ratio: 35.18%
[rank1]:2025-10-29 00:27:30,486 - INFO - Avg. fwd time: 14.8381 / Avg. bwd time: 41.0374 / Avg. batch time: 582.9194 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-29 00:29:37,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:29:39,610 - INFO -  step: 2200  loss:  0.0977  grad_norm:  0.0972  memory: 73.38GiB(52.48%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank3]:2025-10-29 00:29:39,610 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 00:29:39,607 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 64.32GiB(46.00%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank1]:2025-10-29 00:29:39,607 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 00:29:39,612 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 66.72GiB(47.72%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank0]:2025-10-29 00:29:39,612 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 00:29:39,605 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0972  memory: 57.29GiB(40.97%)  tps: 6,318  tflops: 294.68  mfu: 29.80%
[rank2]:2025-10-29 00:29:39,605 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 00:29:54,833 - INFO - validate step: 2200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 26,903
[rank0]:2025-10-29 00:29:54,802 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 26,965
[rank2]:2025-10-29 00:29:54,845 - INFO - validate step: 2200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 26,876
[rank3]:2025-10-29 00:29:54,860 - INFO - validate step: 2200  loss:  0.2431  memory: 73.38GiB(52.48%)  tps: 26,860
[rank3]:2025-10-29 00:29:55,051 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0029_real_step2200_rank3.svg
[rank3]:> Batch Time: 620.08 ms, GPU Bubble Ratio: 33.20%, 27.78%, 36.09%, 26.55%
[rank3]:2025-10-29 00:29:55,441 - INFO - Avg. fwd time: 14.2933 / Avg. bwd time: 42.6341 / Avg. batch time: 470.8364 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:29:55,490 - INFO - Avg. fwd time: 13.0406 / Avg. bwd time: 36.4012 / Avg. batch time: 523.5903 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-10-29 00:29:55,535 - INFO - Avg. fwd time: 14.8333 / Avg. bwd time: 41.0369 / Avg. batch time: 582.7739 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-10-29 00:29:55,567 - INFO - Avg. fwd time: 13.4602 / Avg. bwd time: 38.2190 / Avg. batch time: 637.7372 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:32:02,333 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:32:04,952 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 57.29GiB(40.97%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank0]:2025-10-29 00:32:04,958 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 66.72GiB(47.72%)  tps: 6,294  tflops: 293.55  mfu: 29.68%
[rank3]:2025-10-29 00:32:04,956 - INFO -  step: 2250  loss:  0.1172  grad_norm:  0.1311  memory: 73.38GiB(52.48%)  tps: 6,297  tflops: 293.69  mfu: 29.70%
[rank1]:2025-10-29 00:32:04,954 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1311  memory: 64.32GiB(46.00%)  tps: 6,296  tflops: 293.63  mfu: 29.69%
[rank3]:2025-10-29 00:32:05,489 - INFO - Avg. fwd time: 14.2869 / Avg. bwd time: 42.6292 / Avg. batch time: 470.7406 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:32:05,539 - INFO - Avg. fwd time: 13.0360 / Avg. bwd time: 36.3993 / Avg. batch time: 523.4966 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 00:32:05,643 - INFO - Avg. fwd time: 13.4552 / Avg. bwd time: 38.2176 / Avg. batch time: 637.6432 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-29 00:32:05,593 - INFO - Avg. fwd time: 14.8303 / Avg. bwd time: 41.0389 / Avg. batch time: 582.6819 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 00:34:12,602 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:34:15,233 - INFO -  step: 2300  loss:  0.0884  grad_norm:  0.0944  memory: 73.38GiB(52.48%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-10-29 00:34:15,235 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank1]:2025-10-29 00:34:15,231 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 64.32GiB(46.00%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank2]:2025-10-29 00:34:15,228 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0944  memory: 57.29GiB(40.97%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank3]:2025-10-29 00:34:15,420 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0034_real_step2300_rank3.svg
[rank3]:> Batch Time: 619.94 ms, GPU Bubble Ratio: 33.20%, 27.76%, 36.09%, 26.56%
[rank3]:2025-10-29 00:34:15,817 - INFO - Avg. fwd time: 14.2826 / Avg. bwd time: 42.6280 / Avg. batch time: 470.6932 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:34:15,866 - INFO - Avg. fwd time: 13.0324 / Avg. bwd time: 36.3978 / Avg. batch time: 523.4377 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-29 00:34:15,944 - INFO - Avg. fwd time: 13.4514 / Avg. bwd time: 38.2166 / Avg. batch time: 637.5823 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-29 00:34:15,912 - INFO - Avg. fwd time: 14.8280 / Avg. bwd time: 41.0410 / Avg. batch time: 582.6232 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-10-29 00:36:23,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:36:25,669 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 57.29GiB(40.97%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank3]:2025-10-29 00:36:25,673 - INFO -  step: 2350  loss:  0.1037  grad_norm:  0.0869  memory: 73.38GiB(52.48%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank0]:2025-10-29 00:36:25,676 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 66.72GiB(47.72%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank1]:2025-10-29 00:36:25,671 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0869  memory: 64.32GiB(46.00%)  tps: 6,280  tflops: 292.91  mfu: 29.62%
[rank3]:2025-10-29 00:36:26,123 - INFO - Avg. fwd time: 14.2781 / Avg. bwd time: 42.6273 / Avg. batch time: 470.6470 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-10-29 00:36:26,173 - INFO - Avg. fwd time: 13.0281 / Avg. bwd time: 36.3957 / Avg. batch time: 523.3918 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-10-29 00:36:26,218 - INFO - Avg. fwd time: 14.8255 / Avg. bwd time: 41.0427 / Avg. batch time: 582.5759 (ms) / GPU bubble ratio: 23.28%
[rank0]:2025-10-29 00:36:26,251 - INFO - Avg. fwd time: 13.4469 / Avg. bwd time: 38.2151 / Avg. batch time: 637.5323 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:38:33,368 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:38:36,010 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 57.29GiB(40.97%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank2]:2025-10-29 00:38:36,010 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,326  tflops: 295.05  mfu: 28.81%
[rank2]:2025-10-29 00:38:36,011 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 00:38:36,017 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 66.72GiB(47.72%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank0]:2025-10-29 00:38:36,017 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,325  tflops: 295.02  mfu: 28.80%
[rank0]:2025-10-29 00:38:36,017 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 00:38:36,013 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1108  memory: 64.32GiB(46.00%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank1]:2025-10-29 00:38:36,013 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1108  tps: 6,326  tflops: 295.04  mfu: 28.81%
[rank1]:2025-10-29 00:38:36,013 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 00:38:36,015 - INFO -  step: 2400  loss:  0.0978  grad_norm:  0.1108  memory: 73.38GiB(52.48%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank3]:2025-10-29 00:38:36,015 - INFO -  final step: 2400  loss:  0.0978  grad_norm:  0.1108  tps: 6,328  tflops: 295.15  mfu: 28.82%
[rank3]:2025-10-29 00:38:36,016 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 00:38:50,986 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,363
[rank0]:2025-10-29 00:38:50,987 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 00:38:50,990 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 00:38:51,058 - INFO - validate step: 2400  loss:  0.2417  memory: 73.38GiB(52.48%)  tps: 27,230
[rank3]:2025-10-29 00:38:51,059 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 00:38:51,017 - INFO - validate step: 2400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,300
[rank1]:2025-10-29 00:38:51,018 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 00:38:51,023 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 00:38:51,039 - INFO - validate step: 2400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,255
[rank2]:2025-10-29 00:38:51,040 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 00:38:51,046 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 00:38:51,062 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 00:39:02,711 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 00:39:02,740 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 00:39:02,740 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 00:39:02,740 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 00:39:03,060 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0039_real_final2400_rank3.svg
[rank3]:> Batch Time: 619.84 ms, GPU Bubble Ratio: 33.21%, 27.76%, 36.11%, 26.56%
[rank3]:2025-10-29 00:39:03,362 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1/pipeline_schedule/251029_0039_thry_final2400_rank3.svg
[rank3]:> Batch Time: 456.82 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 00:39:03,362 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 360-364
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.58899
[rank3]:wandb:               final/avg_loss 0.09784
[rank3]:wandb:             final/avg_mfu(%) 28.81728
[rank3]:wandb:             final/avg_tflops 295.15411
[rank3]:wandb:    final/avg_throughput(tps) 6328.32528
[rank3]:wandb:              final/grad_norm 0.1108
[rank3]:wandb:               final/max_loss 0.09784
[rank3]:wandb:                    grad_norm 0.1108
[rank3]:wandb: loss_metrics/global_avg_loss 0.09784
[rank3]:wandb: loss_metrics/global_max_loss 0.09784
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_nofreeze_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/h40tt1xa
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_nofreeze_dm1/20251028-2250/wandb/run-20251028_225005-h40tt1xa/logs
[rank0]:2025-10-29 00:39:04,740 - INFO - Training completed
[rank0]:2025-10-29 00:39:04,740 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 00:39:05,018 - INFO - Process group destroyed
[rank1]:2025-10-29 00:39:04,985 - INFO - Process group destroyed
[rank3]:2025-10-29 00:39:05,013 - INFO - Process group destroyed
[rank0]:2025-10-29 00:39:05,157 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.15', 'layers.10', 'layers.9', 'layers.13', 'layers.11', 'layers.14', 'layers.12', 'layers.8'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.22', 'layers.21', 'layers.20', 'layers.23', 'layers.19', 'layers.17', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.5', 'layers.2', 'layers.0', 'layers.3', 'layers.4', 'layers.7', 'tok_embeddings', 'layers.1'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.25', 'layers.30', 'layers.31', 'layers.28', 'layers.27', 'layers.26', 'output', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_nofreeze_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_nofreeze_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_nofreeze_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_nofreeze_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_nofreeze_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_nofreeze_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_nofreeze_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_nofreeze_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 00:39:14 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_apf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with apf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=apf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] 
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] *****************************************
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 00:39:15.260000 1343979 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 00:39:20,959 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 00:39:21,089 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 00:39:21,185 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 00:39:21,377 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 00:39:21,418 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 00:39:21,421 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:39:21,427 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 00:39:21,897 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 00:39:21,899 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 00:39:21,922 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 00:39:21,924 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 00:39:22,075 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 00:39:22,078 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 00:39:23,811 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 00:39:24,089 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 00:39:25,752 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 00:39:27,102 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 00:39:27,368 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 00:39:27,356 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 00:39:27,374 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 00:39:27,455 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 00:39:27,479 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 00:39:27,479 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 00:39:27,456 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 00:39:27,456 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 00:39:27,482 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 00:39:27,483 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 00:39:27,796 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 00:39:27,796 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-29 00:39:27,736 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 00:39:27,736 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-10-29 00:39:27,787 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 00:39:27,787 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run em62i16u
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1/20251029-0039/wandb/run-20251029_003928-em62i16u
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_apf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/em62i16u
[rank3]:2025-10-29 00:39:29,031 - INFO - WandB logging enabled
[rank3]:2025-10-29 00:39:29,051 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 00:39:29,123 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 00:39:29,123 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 00:39:29,445 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank0]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 00:39:29,445 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-29 00:39:29,433 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 00:39:29,434 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 00:39:29,445 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 00:39:32,875 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank1]:2025-10-29 00:39:32,827 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank2]:2025-10-29 00:39:32,944 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 00:39:33,256 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 00:39:33,256 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1.
[rank0]:2025-10-29 00:39:33,256 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-1600.
[rank0]:2025-10-29 00:39:43,419 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 00:39:43,419 - INFO - Finished loading the checkpoint in 10.16 seconds.
[rank0]:2025-10-29 00:39:43,419 - INFO - Training starts at step 1
[rank0]:2025-10-29 00:39:48,004 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 49.75GiB(35.58%)  tps: 797  tflops: 37.19  mfu: 3.76%
[rank0]:2025-10-29 00:39:48,004 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:39:47,987 - INFO -  step:  1  loss:  1.2019  grad_norm:  1.4112  memory: 58.03GiB(41.50%)  tps: 867  tflops: 40.46  mfu: 4.09%
[rank3]:2025-10-29 00:39:47,988 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 00:39:47,983 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 44.28GiB(31.67%)  tps: 798  tflops: 37.23  mfu: 3.76%
[rank2]:2025-10-29 00:39:47,983 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 00:39:47,985 - INFO -  step:  1  loss: -4.0000  grad_norm:  1.4112  memory: 49.69GiB(35.54%)  tps: 797  tflops: 37.18  mfu: 3.76%
[rank1]:2025-10-29 00:39:47,986 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 00:40:06,231 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,231 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,232 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,232 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,233 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,234 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,235 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 00:40:06,236 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,321 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,322 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,323 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 00:40:06,324 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,275 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,276 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,277 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 00:40:06,278 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,364 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,365 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:40:06,366 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 00:41:57,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 00:42:00,544 - INFO -  step: 50  loss:  0.9452  grad_norm:  0.5079  memory: 73.38GiB(52.48%)  tps: 6,057  tflops: 282.48  mfu: 28.56%
[rank0]:2025-10-29 00:42:00,545 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 66.72GiB(47.72%)  tps: 6,057  tflops: 282.51  mfu: 28.56%
[rank2]:2025-10-29 00:42:00,538 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 57.29GiB(40.97%)  tps: 6,056  tflops: 282.47  mfu: 28.56%
[rank1]:2025-10-29 00:42:00,541 - INFO -  step: 50  loss: -4.0000  grad_norm:  0.5079  memory: 64.32GiB(46.00%)  tps: 6,056  tflops: 282.47  mfu: 28.56%
[rank3]:2025-10-29 00:42:01,005 - INFO - Avg. fwd time: 14.7542 / Avg. bwd time: 43.1361 / Avg. batch time: 483.4858 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-29 00:42:01,056 - INFO - Avg. fwd time: 13.3732 / Avg. bwd time: 36.4739 / Avg. batch time: 536.4654 (ms) / GPU bubble ratio: 25.67%
[rank0]:2025-10-29 00:42:01,135 - INFO - Avg. fwd time: 14.1955 / Avg. bwd time: 38.2318 / Avg. batch time: 651.7722 (ms) / GPU bubble ratio: 35.65%
[rank1]:2025-10-29 00:42:01,102 - INFO - Avg. fwd time: 15.2345 / Avg. bwd time: 41.0440 / Avg. batch time: 596.2550 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-29 00:42:27,640 - INFO - Freezing Ratio: [Stage0] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:42:27,636 - INFO - Freezing Ratio: [Stage1] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:42:27,633 - INFO - Freezing Ratio: [Stage2] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:42:28,641 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:42:45,285 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:42:49,996 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:16,999 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:16,992 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:16,994 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:43:21,604 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:38,203 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:38,202 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:38,202 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:43:42,820 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:57,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:43:59,432 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 66.72GiB(47.72%)  tps: 6,891  tflops: 321.38  mfu: 32.50%
[rank1]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:43:59,431 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 72.68GiB(51.98%)  tps: 6,890  tflops: 321.37  mfu: 32.49%
[rank2]:2025-10-29 00:43:59,431 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:43:59,431 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0026  memory: 64.67GiB(46.25%)  tps: 6,890  tflops: 321.36  mfu: 32.49%
[rank3]:2025-10-29 00:44:04,058 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:04,062 - INFO -  step: 100  loss:  0.8794  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,632  tflops: 309.33  mfu: 31.28%
[rank0]:2025-10-29 00:44:04,142 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0043_stage0_step100.svg
[rank1]:2025-10-29 00:44:04,139 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0043_stage1_step100.svg
[rank2]:2025-10-29 00:44:04,137 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0043_stage2_step100.svg
[rank3]:2025-10-29 00:44:04,258 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0044_real_step100_rank3.svg
[rank3]:> Batch Time: 632.08 ms, GPU Bubble Ratio: 33.52%, 28.12%, 36.44%, 26.26%
[rank3]:2025-10-29 00:44:04,318 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0044_stage3_step100.svg
[rank3]:2025-10-29 00:44:04,729 - INFO - Avg. fwd time: 15.5687 / Avg. bwd time: 36.4839 / Avg. batch time: 434.0366 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-29 00:44:04,825 - INFO - Avg. fwd time: 16.0590 / Avg. bwd time: 34.7553 / Avg. batch time: 572.3828 (ms) / GPU bubble ratio: 28.98%
[rank2]:2025-10-29 00:44:04,779 - INFO - Avg. fwd time: 14.0705 / Avg. bwd time: 30.8264 / Avg. batch time: 519.0536 (ms) / GPU bubble ratio: 30.80%
[rank0]:2025-10-29 00:44:04,858 - INFO - Avg. fwd time: 14.6540 / Avg. bwd time: 27.6478 / Avg. batch time: 616.9579 (ms) / GPU bubble ratio: 45.15%
[rank1]:2025-10-29 00:44:31,296 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:44:31,293 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:44:31,300 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:35,989 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:44:52,559 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:44:52,558 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:44:52,558 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:44:57,186 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:45:13,737 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:45:13,736 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:45:13,736 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:45:18,357 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:45:34,922 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:45:34,921 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:45:34,921 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:45:39,565 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:03,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:46:06,547 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:06,548 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 66.72GiB(47.72%)  tps: 6,445  tflops: 300.57  mfu: 30.39%
[rank1]:2025-10-29 00:46:06,543 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:06,543 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 72.68GiB(51.98%)  tps: 6,445  tflops: 300.58  mfu: 30.39%
[rank2]:2025-10-29 00:46:06,541 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:06,541 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.4892  memory: 64.67GiB(46.25%)  tps: 6,445  tflops: 300.59  mfu: 30.39%
[rank3]:2025-10-29 00:46:11,139 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:11,143 - INFO -  step: 150  loss:  0.9237  grad_norm:  0.4892  memory: 83.85GiB(59.97%)  tps: 6,446  tflops: 300.66  mfu: 30.40%
[rank0]:2025-10-29 00:46:11,524 - INFO - Avg. fwd time: 14.8429 / Avg. bwd time: 23.3480 / Avg. batch time: 611.9667 (ms) / GPU bubble ratio: 50.07%
[rank3]:2025-10-29 00:46:11,475 - INFO - Avg. fwd time: 15.8748 / Avg. bwd time: 33.7008 / Avg. batch time: 413.3985 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-29 00:46:11,519 - INFO - Avg. fwd time: 16.3640 / Avg. bwd time: 32.0982 / Avg. batch time: 571.8168 (ms) / GPU bubble ratio: 32.20%
[rank2]:2025-10-29 00:46:11,496 - INFO - Avg. fwd time: 14.3236 / Avg. bwd time: 28.4734 / Avg. batch time: 521.2272 (ms) / GPU bubble ratio: 34.31%
[rank0]:2025-10-29 00:46:27,672 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:27,671 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:27,671 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:32,261 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:46:48,834 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:46:53,435 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:47:09,971 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:47:09,970 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:47:09,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:47:14,637 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:47:31,172 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:47:31,171 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:47:31,171 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:47:35,787 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:00,070 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:48:02,796 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:02,797 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 66.72GiB(47.72%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank0]:2025-10-29 00:48:02,797 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 00:48:02,790 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:48:02,790 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 64.67GiB(46.25%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank2]:2025-10-29 00:48:02,790 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 00:48:02,792 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:48:02,793 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5840  memory: 72.68GiB(51.98%)  tps: 7,047  tflops: 328.67  mfu: 33.23%
[rank1]:2025-10-29 00:48:02,793 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 00:48:07,448 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:48:07,452 - INFO -  step: 200  loss:  0.9406  grad_norm:  0.5840  memory: 83.85GiB(59.97%)  tps: 7,043  tflops: 328.50  mfu: 33.22%
[rank3]:2025-10-29 00:48:07,452 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 00:48:25,501 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,041
[rank1]:2025-10-29 00:48:25,536 - INFO - validate step: 200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,010
[rank2]:2025-10-29 00:48:25,565 - INFO - validate step: 200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 17,985
[rank3]:2025-10-29 00:48:25,591 - INFO - validate step: 200  loss:  0.2413  memory: 83.85GiB(59.97%)  tps: 22,583
[rank0]:2025-10-29 00:48:25,666 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0048_stage0_step200.svg
[rank1]:2025-10-29 00:48:25,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0048_stage1_step200.svg
[rank2]:2025-10-29 00:48:25,662 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0048_stage2_step200.svg
[rank3]:2025-10-29 00:48:25,774 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0048_real_step200_rank3.svg
[rank3]:> Batch Time: 382.68 ms, GPU Bubble Ratio: 65.02%, 24.36%, 33.16%, 23.21%
[rank0]:2025-10-29 00:48:25,768 - INFO - Avg. fwd time: 15.0348 / Avg. bwd time: 19.2314 / Avg. batch time: 592.4201 (ms) / GPU bubble ratio: 53.73%
[rank3]:2025-10-29 00:48:25,838 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0048_stage3_step200.svg
[rank3]:2025-10-29 00:48:26,107 - INFO - Avg. fwd time: 16.1555 / Avg. bwd time: 31.0441 / Avg. batch time: 394.0320 (ms) / GPU bubble ratio: 4.17%
[rank1]:2025-10-29 00:48:26,154 - INFO - Avg. fwd time: 16.6352 / Avg. bwd time: 29.5622 / Avg. batch time: 556.4888 (ms) / GPU bubble ratio: 33.59%
[rank2]:2025-10-29 00:48:26,129 - INFO - Avg. fwd time: 14.5598 / Avg. bwd time: 26.2294 / Avg. batch time: 508.4828 (ms) / GPU bubble ratio: 35.83%
[rank2]:2025-10-29 00:48:42,391 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:48:42,391 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:48:42,392 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:48:47,023 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:03,579 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:08,191 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:24,758 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:29,394 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:49:45,909 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:49:50,560 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:05,538 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 00:50:07,193 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:07,193 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 8,061  tflops: 375.96  mfu: 38.01%
[rank1]:2025-10-29 00:50:07,193 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:50:07,193 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 8,058  tflops: 375.85  mfu: 38.00%
[rank0]:2025-10-29 00:50:07,194 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:07,194 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 8,056  tflops: 375.72  mfu: 37.99%
[rank3]:2025-10-29 00:50:11,807 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:50:11,815 - INFO -  step: 250  loss:  0.9329  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,712  tflops: 359.69  mfu: 36.37%
[rank3]:2025-10-29 00:50:12,227 - INFO - Avg. fwd time: 16.3734 / Avg. bwd time: 29.0352 / Avg. batch time: 379.4604 (ms) / GPU bubble ratio: 4.27%
[rank2]:2025-10-29 00:50:12,276 - INFO - Avg. fwd time: 14.7425 / Avg. bwd time: 24.5344 / Avg. batch time: 495.5911 (ms) / GPU bubble ratio: 36.60%
[rank0]:2025-10-29 00:50:12,355 - INFO - Avg. fwd time: 15.1865 / Avg. bwd time: 16.1141 / Avg. batch time: 574.3840 (ms) / GPU bubble ratio: 56.40%
[rank1]:2025-10-29 00:50:12,322 - INFO - Avg. fwd time: 16.8464 / Avg. bwd time: 27.6441 / Avg. batch time: 541.6468 (ms) / GPU bubble ratio: 34.29%
[rank1]:2025-10-29 00:50:38,798 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:38,796 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:38,802 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:50:43,433 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:50:59,991 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:04,634 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:51:21,270 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:51:21,269 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:51:21,270 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:25,885 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:51:42,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:51:42,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:51:42,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:51:47,010 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:01,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:52:03,567 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:03,567 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank1]:2025-10-29 00:52:03,566 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:03,566 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank2]:2025-10-29 00:52:03,566 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:03,566 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank0]:2025-10-29 00:52:08,264 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0052_stage0_step300.svg
[rank3]:2025-10-29 00:52:08,188 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:08,192 - INFO -  step: 300  loss:  0.8592  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,039  tflops: 328.31  mfu: 33.20%
[rank1]:2025-10-29 00:52:08,263 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0052_stage1_step300.svg
[rank2]:2025-10-29 00:52:08,264 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0052_stage2_step300.svg
[rank3]:2025-10-29 00:52:08,380 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0052_real_step300_rank3.svg
[rank3]:> Batch Time: 383.49 ms, GPU Bubble Ratio: 64.72%, 24.34%, 33.18%, 23.30%
[rank3]:2025-10-29 00:52:08,443 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0052_stage3_step300.svg
[rank3]:2025-10-29 00:52:08,773 - INFO - Avg. fwd time: 16.4672 / Avg. bwd time: 28.1483 / Avg. batch time: 372.9632 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-29 00:52:08,795 - INFO - Avg. fwd time: 14.8240 / Avg. bwd time: 23.7861 / Avg. batch time: 494.3263 (ms) / GPU bubble ratio: 37.51%
[rank0]:2025-10-29 00:52:08,824 - INFO - Avg. fwd time: 15.2467 / Avg. bwd time: 14.7370 / Avg. batch time: 570.8283 (ms) / GPU bubble ratio: 57.98%
[rank1]:2025-10-29 00:52:08,818 - INFO - Avg. fwd time: 16.9312 / Avg. bwd time: 26.7891 / Avg. batch time: 539.5002 (ms) / GPU bubble ratio: 35.17%
[rank0]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:25,024 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:29,630 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:52:46,133 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:52:50,768 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:53:17,755 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:53:17,753 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:17,760 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:53:22,441 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:39,009 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:53:39,008 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:53:39,008 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:53:43,586 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:53:58,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:54:00,121 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:54:00,121 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 66.72GiB(47.72%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank2]:2025-10-29 00:54:00,120 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:00,120 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 64.67GiB(46.25%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank1]:2025-10-29 00:54:00,120 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:00,120 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0021  memory: 72.68GiB(51.98%)  tps: 7,029  tflops: 327.81  mfu: 33.15%
[rank0]:2025-10-29 00:54:00,223 - INFO - Avg. fwd time: 15.2755 / Avg. bwd time: 14.0433 / Avg. batch time: 568.6623 (ms) / GPU bubble ratio: 58.75%
[rank3]:2025-10-29 00:54:04,741 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:04,745 - INFO -  step: 350  loss:  0.8905  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,029  tflops: 327.82  mfu: 33.15%
[rank3]:2025-10-29 00:54:05,016 - INFO - Avg. fwd time: 16.5132 / Avg. bwd time: 27.7027 / Avg. batch time: 369.6738 (ms) / GPU bubble ratio: 4.31%
[rank1]:2025-10-29 00:54:05,064 - INFO - Avg. fwd time: 16.9747 / Avg. bwd time: 26.3568 / Avg. batch time: 538.0459 (ms) / GPU bubble ratio: 35.57%
[rank2]:2025-10-29 00:54:05,038 - INFO - Avg. fwd time: 14.8659 / Avg. bwd time: 23.4094 / Avg. batch time: 493.3168 (ms) / GPU bubble ratio: 37.93%
[rank0]:2025-10-29 00:54:21,336 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:21,335 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:21,335 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:25,923 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:54:42,479 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:54:42,478 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:54:42,478 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:54:47,105 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:03,652 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:08,266 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:24,647 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:24,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:24,648 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:29,254 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:43,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 00:55:44,777 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 64.67GiB(46.25%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank2]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 00:55:44,777 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 72.68GiB(51.98%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank1]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:55:44,778 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:55:44,778 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0013  memory: 66.72GiB(47.72%)  tps: 7,827  tflops: 365.07  mfu: 36.91%
[rank0]:2025-10-29 00:55:44,778 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 00:55:49,398 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:55:49,402 - INFO -  step: 400  loss:  0.1265  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,828  tflops: 365.08  mfu: 36.91%
[rank3]:2025-10-29 00:55:49,402 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 00:56:03,846 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 21,482
[rank2]:2025-10-29 00:56:03,902 - INFO - validate step: 400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 21,418
[rank1]:2025-10-29 00:56:03,878 - INFO - validate step: 400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 21,445
[rank3]:2025-10-29 00:56:03,921 - INFO - validate step: 400  loss:  0.2379  memory: 83.85GiB(59.97%)  tps: 28,213
[rank2]:2025-10-29 00:56:03,997 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0056_stage2_step400.svg
[rank1]:2025-10-29 00:56:04,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0056_stage1_step400.svg
[rank0]:2025-10-29 00:56:04,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0056_stage0_step400.svg
[rank3]:2025-10-29 00:56:04,116 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0056_real_step400_rank3.svg
[rank3]:> Batch Time: 383.19 ms, GPU Bubble Ratio: 64.65%, 24.35%, 33.18%, 23.28%
[rank3]:2025-10-29 00:56:04,187 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0056_stage3_step400.svg
[rank3]:2025-10-29 00:56:04,578 - INFO - Avg. fwd time: 16.6081 / Avg. bwd time: 26.5879 / Avg. batch time: 361.4261 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 00:56:04,675 - INFO - Avg. fwd time: 17.0701 / Avg. bwd time: 25.3041 / Avg. batch time: 531.0332 (ms) / GPU bubble ratio: 36.16%
[rank2]:2025-10-29 00:56:04,628 - INFO - Avg. fwd time: 14.9489 / Avg. bwd time: 22.4748 / Avg. batch time: 487.3731 (ms) / GPU bubble ratio: 38.57%
[rank0]:2025-10-29 00:56:04,707 - INFO - Avg. fwd time: 15.3419 / Avg. bwd time: 12.3405 / Avg. batch time: 559.8957 (ms) / GPU bubble ratio: 60.45%
[rank2]:2025-10-29 00:56:30,112 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:30,114 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:30,119 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:35,293 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:56:50,817 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:56:55,430 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:10,885 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:10,884 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:10,884 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:15,686 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:31,128 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:31,127 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:31,127 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:35,710 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:49,696 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:57:51,249 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 66.72GiB(47.72%)  tps: 7,627  tflops: 355.74  mfu: 35.97%
[rank1]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:57:51,248 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 72.68GiB(51.98%)  tps: 7,630  tflops: 355.85  mfu: 35.98%
[rank2]:2025-10-29 00:57:51,248 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:57:51,248 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0007  memory: 64.67GiB(46.25%)  tps: 7,631  tflops: 355.93  mfu: 35.99%
[rank3]:2025-10-29 00:57:55,839 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:57:55,843 - INFO -  step: 450  loss:  0.1056  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,320  tflops: 341.38  mfu: 34.52%
[rank3]:2025-10-29 00:57:56,150 - INFO - Avg. fwd time: 16.5429 / Avg. bwd time: 26.1951 / Avg. batch time: 357.6817 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-10-29 00:57:56,172 - INFO - Avg. fwd time: 14.9097 / Avg. bwd time: 22.1806 / Avg. batch time: 486.2533 (ms) / GPU bubble ratio: 38.98%
[rank1]:2025-10-29 00:57:56,196 - INFO - Avg. fwd time: 17.0288 / Avg. bwd time: 24.9813 / Avg. batch time: 529.5857 (ms) / GPU bubble ratio: 36.54%
[rank0]:2025-10-29 00:57:56,203 - INFO - Avg. fwd time: 15.2919 / Avg. bwd time: 11.8549 / Avg. batch time: 557.9056 (ms) / GPU bubble ratio: 61.07%
[rank2]:2025-10-29 00:58:11,301 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:11,301 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:11,302 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:15,905 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:31,400 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:31,400 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:31,401 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:36,144 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:58:51,647 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:58:51,647 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:58:51,648 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:58:56,217 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:11,702 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:11,701 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:11,701 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:16,285 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:39,638 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 00:59:42,245 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 00:59:42,245 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 66.72GiB(47.72%)  tps: 7,380  tflops: 344.23  mfu: 34.81%
[rank1]:2025-10-29 00:59:42,240 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 00:59:42,241 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 72.68GiB(51.98%)  tps: 7,381  tflops: 344.24  mfu: 34.81%
[rank2]:2025-10-29 00:59:42,238 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 00:59:42,238 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1229  memory: 64.67GiB(46.25%)  tps: 7,381  tflops: 344.24  mfu: 34.81%
[rank3]:2025-10-29 00:59:46,847 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 00:59:46,851 - INFO -  step: 500  loss:  0.1172  grad_norm:  0.1229  memory: 83.85GiB(59.97%)  tps: 7,380  tflops: 344.19  mfu: 34.80%
[rank2]:2025-10-29 00:59:46,921 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0059_stage2_step500.svg
[rank0]:2025-10-29 00:59:46,924 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0059_stage0_step500.svg
[rank1]:2025-10-29 00:59:46,924 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0059_stage1_step500.svg
[rank0]:2025-10-29 00:59:47,013 - INFO - Avg. fwd time: 15.2671 / Avg. bwd time: 11.2730 / Avg. batch time: 553.8146 (ms) / GPU bubble ratio: 61.66%
[rank3]:2025-10-29 00:59:47,039 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0059_real_step500_rank3.svg
[rank3]:> Batch Time: 381.39 ms, GPU Bubble Ratio: 64.74%, 24.33%, 33.23%, 23.37%
[rank3]:2025-10-29 00:59:47,101 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0059_stage3_step500.svg
[rank3]:2025-10-29 00:59:47,342 - INFO - Avg. fwd time: 16.5136 / Avg. bwd time: 25.7636 / Avg. batch time: 353.9377 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-10-29 00:59:47,388 - INFO - Avg. fwd time: 17.0135 / Avg. bwd time: 24.6056 / Avg. batch time: 526.1277 (ms) / GPU bubble ratio: 36.72%
[rank2]:2025-10-29 00:59:47,364 - INFO - Avg. fwd time: 14.8975 / Avg. bwd time: 21.8436 / Avg. batch time: 483.1792 (ms) / GPU bubble ratio: 39.17%
[rank2]:2025-10-29 01:00:02,604 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:02,604 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:02,605 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:07,215 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:22,742 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:22,741 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:22,742 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:27,355 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:00:42,923 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:00:47,558 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:03,044 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:03,044 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:03,045 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:07,648 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:21,657 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:01:23,206 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:01:23,207 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,114  tflops: 378.42  mfu: 38.26%
[rank2]:2025-10-29 01:01:23,206 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:23,206 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,113  tflops: 378.41  mfu: 38.26%
[rank0]:2025-10-29 01:01:23,207 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:23,207 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,114  tflops: 378.44  mfu: 38.26%
[rank0]:2025-10-29 01:01:23,294 - INFO - Avg. fwd time: 15.2508 / Avg. bwd time: 10.6229 / Avg. batch time: 548.0308 (ms) / GPU bubble ratio: 62.23%
[rank3]:2025-10-29 01:01:27,822 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:27,826 - INFO -  step: 550  loss:  0.1045  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,113  tflops: 378.39  mfu: 38.26%
[rank2]:2025-10-29 01:01:28,091 - INFO - Avg. fwd time: 14.8943 / Avg. bwd time: 21.4727 / Avg. batch time: 478.5168 (ms) / GPU bubble ratio: 39.20%
[rank3]:2025-10-29 01:01:28,069 - INFO - Avg. fwd time: 16.4981 / Avg. bwd time: 25.2967 / Avg. batch time: 350.0255 (ms) / GPU bubble ratio: 4.48%
[rank1]:2025-10-29 01:01:28,116 - INFO - Avg. fwd time: 17.0113 / Avg. bwd time: 24.1923 / Avg. batch time: 521.0427 (ms) / GPU bubble ratio: 36.74%
[rank1]:2025-10-29 01:01:43,377 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:01:43,377 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:01:43,378 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:01:48,010 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:03,509 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:08,171 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:23,756 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:23,756 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:23,757 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:28,383 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:02:43,909 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:02:43,908 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:02:43,908 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:02:49,061 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:12,359 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:03:14,972 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:03:14,973 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 72.68GiB(51.98%)  tps: 7,330  tflops: 341.85  mfu: 34.57%
[rank1]:2025-10-29 01:03:14,973 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 01:03:14,970 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:14,970 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 64.67GiB(46.25%)  tps: 7,330  tflops: 341.86  mfu: 34.57%
[rank2]:2025-10-29 01:03:14,970 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 01:03:14,977 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:14,977 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1011  memory: 66.72GiB(47.72%)  tps: 7,329  tflops: 341.84  mfu: 34.56%
[rank0]:2025-10-29 01:03:14,977 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 01:03:19,684 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:19,689 - INFO -  step: 600  loss:  0.0962  grad_norm:  0.1011  memory: 83.85GiB(59.97%)  tps: 7,323  tflops: 341.57  mfu: 34.54%
[rank3]:2025-10-29 01:03:19,689 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 01:03:36,505 - INFO - validate step: 600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,023
[rank0]:2025-10-29 01:03:36,468 - INFO - validate step: 600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,059
[rank2]:2025-10-29 01:03:36,540 - INFO - validate step: 600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,989
[rank3]:2025-10-29 01:03:36,564 - INFO - validate step: 600  loss:  0.2376  memory: 83.85GiB(59.97%)  tps: 24,274
[rank0]:2025-10-29 01:03:36,640 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0103_stage0_step600.svg
[rank1]:2025-10-29 01:03:36,640 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0103_stage1_step600.svg
[rank2]:2025-10-29 01:03:36,639 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0103_stage2_step600.svg
[rank3]:2025-10-29 01:03:36,755 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0103_real_step600_rank3.svg
[rank3]:> Batch Time: 379.38 ms, GPU Bubble Ratio: 64.84%, 24.26%, 33.23%, 23.60%
[rank3]:2025-10-29 01:03:36,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0103_stage3_step600.svg
[rank3]:2025-10-29 01:03:37,132 - INFO - Avg. fwd time: 16.4618 / Avg. bwd time: 25.1188 / Avg. batch time: 348.2693 (ms) / GPU bubble ratio: 4.49%
[rank1]:2025-10-29 01:03:37,179 - INFO - Avg. fwd time: 16.9848 / Avg. bwd time: 24.0488 / Avg. batch time: 520.8479 (ms) / GPU bubble ratio: 36.97%
[rank2]:2025-10-29 01:03:37,155 - INFO - Avg. fwd time: 14.8720 / Avg. bwd time: 21.3437 / Avg. batch time: 478.4777 (ms) / GPU bubble ratio: 39.45%
[rank0]:2025-10-29 01:03:37,186 - INFO - Avg. fwd time: 15.2181 / Avg. bwd time: 10.4091 / Avg. batch time: 547.5887 (ms) / GPU bubble ratio: 62.56%
[rank1]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:03:52,507 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:03:57,814 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:13,328 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:13,328 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:13,329 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:17,892 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:33,471 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:33,471 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:33,472 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:38,678 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:04:54,301 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:04:54,300 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:04:54,300 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:04:58,881 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:12,848 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:05:14,401 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:14,402 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,368  tflops: 390.28  mfu: 39.46%
[rank2]:2025-10-29 01:05:14,401 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:14,402 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,371  tflops: 390.43  mfu: 39.48%
[rank0]:2025-10-29 01:05:14,402 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:14,403 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,365  tflops: 390.14  mfu: 39.45%
[rank0]:2025-10-29 01:05:14,491 - INFO - Avg. fwd time: 15.2232 / Avg. bwd time: 9.7621 / Avg. batch time: 543.7522 (ms) / GPU bubble ratio: 63.24%
[rank3]:2025-10-29 01:05:19,243 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:19,248 - INFO -  step: 650  loss:  0.0871  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,978  tflops: 372.10  mfu: 37.62%
[rank2]:2025-10-29 01:05:19,512 - INFO - Avg. fwd time: 14.8872 / Avg. bwd time: 20.9818 / Avg. batch time: 475.7197 (ms) / GPU bubble ratio: 39.68%
[rank3]:2025-10-29 01:05:19,491 - INFO - Avg. fwd time: 16.4742 / Avg. bwd time: 24.6783 / Avg. batch time: 344.8130 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-29 01:05:19,538 - INFO - Avg. fwd time: 17.0066 / Avg. bwd time: 23.6475 / Avg. batch time: 517.6924 (ms) / GPU bubble ratio: 37.18%
[rank1]:2025-10-29 01:05:34,855 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:34,855 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:34,856 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:39,459 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:05:54,999 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:05:54,999 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:05:55,000 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:05:59,604 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:15,136 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:19,756 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:35,360 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:35,360 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:35,361 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:06:40,215 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:54,156 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:06:55,718 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank1]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:06:55,717 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank2]:2025-10-29 01:06:55,717 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:06:55,717 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,086  tflops: 377.12  mfu: 38.13%
[rank3]:2025-10-29 01:07:00,349 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:00,354 - INFO -  step: 700  loss:  0.0734  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,103  tflops: 377.90  mfu: 38.21%
[rank1]:2025-10-29 01:07:00,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0106_stage1_step700.svg
[rank2]:2025-10-29 01:07:00,430 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0106_stage2_step700.svg
[rank0]:2025-10-29 01:07:00,435 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0106_stage0_step700.svg
[rank3]:2025-10-29 01:07:00,551 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0107_real_step700_rank3.svg
[rank3]:> Batch Time: 377.88 ms, GPU Bubble Ratio: 64.92%, 24.17%, 33.20%, 23.64%
[rank3]:2025-10-29 01:07:00,620 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0107_stage3_step700.svg
[rank3]:2025-10-29 01:07:01,009 - INFO - Avg. fwd time: 16.4838 / Avg. bwd time: 24.2332 / Avg. batch time: 341.2969 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-10-29 01:07:01,104 - INFO - Avg. fwd time: 17.0233 / Avg. bwd time: 23.2410 / Avg. batch time: 514.6657 (ms) / GPU bubble ratio: 37.41%
[rank2]:2025-10-29 01:07:01,058 - INFO - Avg. fwd time: 14.9011 / Avg. bwd time: 20.6187 / Avg. batch time: 473.1019 (ms) / GPU bubble ratio: 39.94%
[rank0]:2025-10-29 01:07:01,136 - INFO - Avg. fwd time: 15.2257 / Avg. bwd time: 9.1126 / Avg. batch time: 540.0403 (ms) / GPU bubble ratio: 63.95%
[rank1]:2025-10-29 01:07:26,582 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:26,580 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:26,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:31,224 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:07:46,799 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:07:46,799 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:07:46,800 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:07:51,484 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:07,015 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:07,015 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:07,016 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:11,784 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:27,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:27,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:27,381 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:32,023 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:46,015 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:08:47,586 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:08:47,586 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank2]:2025-10-29 01:08:47,585 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:08:47,586 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank0]:2025-10-29 01:08:47,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:08:47,587 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,323  tflops: 341.54  mfu: 34.53%
[rank3]:2025-10-29 01:08:52,534 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:08:52,539 - INFO -  step: 750  loss:  0.1053  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,302  tflops: 340.58  mfu: 34.44%
[rank1]:2025-10-29 01:08:52,901 - INFO - Avg. fwd time: 17.0069 / Avg. bwd time: 23.1936 / Avg. batch time: 515.0142 (ms) / GPU bubble ratio: 37.55%
[rank2]:2025-10-29 01:08:52,876 - INFO - Avg. fwd time: 14.8850 / Avg. bwd time: 20.5731 / Avg. batch time: 473.5075 (ms) / GPU bubble ratio: 40.09%
[rank0]:2025-10-29 01:08:52,908 - INFO - Avg. fwd time: 15.2029 / Avg. bwd time: 9.0476 / Avg. batch time: 540.3081 (ms) / GPU bubble ratio: 64.09%
[rank3]:2025-10-29 01:08:52,854 - INFO - Avg. fwd time: 16.4596 / Avg. bwd time: 24.1684 / Avg. batch time: 340.5598 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-10-29 01:09:08,072 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:08,072 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:08,073 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:12,766 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:28,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:28,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:28,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:32,963 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:09:48,454 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:09:48,454 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:09:48,455 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:09:53,083 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:08,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:13,291 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:27,297 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:10:28,870 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank1]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 01:10:28,870 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank2]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:10:28,871 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:10:28,871 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,088  tflops: 377.23  mfu: 38.14%
[rank0]:2025-10-29 01:10:28,871 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 01:10:33,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:10:33,523 - INFO -  step: 800  loss:  0.1210  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank3]:2025-10-29 01:10:33,524 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 01:10:50,002 - INFO - validate step: 800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,384
[rank2]:2025-10-29 01:10:50,071 - INFO - validate step: 800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,321
[rank1]:2025-10-29 01:10:50,038 - INFO - validate step: 800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,351
[rank3]:2025-10-29 01:10:50,092 - INFO - validate step: 800  loss:  0.2397  memory: 83.85GiB(59.97%)  tps: 24,722
[rank2]:2025-10-29 01:10:50,172 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0110_stage2_step800.svg
[rank1]:2025-10-29 01:10:50,174 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0110_stage1_step800.svg
[rank0]:2025-10-29 01:10:50,172 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0110_stage0_step800.svg
[rank3]:2025-10-29 01:10:50,285 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0110_real_step800_rank3.svg
[rank3]:> Batch Time: 376.60 ms, GPU Bubble Ratio: 64.94%, 24.06%, 33.13%, 23.67%
[rank0]:2025-10-29 01:10:50,262 - INFO - Avg. fwd time: 15.2054 / Avg. bwd time: 8.5996 / Avg. batch time: 537.2036 (ms) / GPU bubble ratio: 64.55%
[rank3]:2025-10-29 01:10:50,356 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0110_stage3_step800.svg
[rank3]:2025-10-29 01:10:50,606 - INFO - Avg. fwd time: 16.4672 / Avg. bwd time: 23.8640 / Avg. batch time: 338.1650 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-10-29 01:10:50,627 - INFO - Avg. fwd time: 14.8952 / Avg. bwd time: 20.3224 / Avg. batch time: 471.1630 (ms) / GPU bubble ratio: 40.20%
[rank1]:2025-10-29 01:10:50,652 - INFO - Avg. fwd time: 17.0194 / Avg. bwd time: 22.9120 / Avg. batch time: 512.3819 (ms) / GPU bubble ratio: 37.65%
[rank2]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:05,908 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:10,636 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:26,296 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:26,295 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:26,295 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:11:30,926 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:11:56,907 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:11:56,903 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:11:56,900 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:01,525 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:17,048 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:21,733 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:35,814 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:12:37,375 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,630  tflops: 355.84  mfu: 35.98%
[rank1]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:37,374 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,632  tflops: 355.96  mfu: 35.99%
[rank2]:2025-10-29 01:12:37,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:37,374 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,634  tflops: 356.07  mfu: 36.00%
[rank0]:2025-10-29 01:12:37,464 - INFO - Avg. fwd time: 15.1876 / Avg. bwd time: 8.5738 / Avg. batch time: 536.1698 (ms) / GPU bubble ratio: 64.55%
[rank3]:2025-10-29 01:12:42,153 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:12:42,157 - INFO -  step: 850  loss:  0.1398  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,310  tflops: 340.95  mfu: 34.47%
[rank3]:2025-10-29 01:12:42,396 - INFO - Avg. fwd time: 16.4487 / Avg. bwd time: 23.8294 / Avg. batch time: 337.7207 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-29 01:12:42,442 - INFO - Avg. fwd time: 17.0077 / Avg. bwd time: 22.8917 / Avg. batch time: 511.3848 (ms) / GPU bubble ratio: 37.58%
[rank2]:2025-10-29 01:12:42,418 - INFO - Avg. fwd time: 14.8824 / Avg. bwd time: 20.2993 / Avg. batch time: 470.1854 (ms) / GPU bubble ratio: 40.14%
[rank0]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:12:57,595 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:02,216 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:17,750 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:22,520 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:38,105 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:13:42,742 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:13:58,178 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:02,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:16,882 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:14:18,420 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:18,420 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 66.72GiB(47.72%)  tps: 8,107  tflops: 378.12  mfu: 38.23%
[rank1]:2025-10-29 01:14:18,419 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:18,419 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 72.68GiB(51.98%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank2]:2025-10-29 01:14:18,419 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:18,419 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0010  memory: 64.67GiB(46.25%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank3]:2025-10-29 01:14:23,067 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:23,071 - INFO -  step: 900  loss:  0.1320  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,118  tflops: 378.62  mfu: 38.28%
[rank0]:2025-10-29 01:14:23,146 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0114_stage0_step900.svg
[rank2]:2025-10-29 01:14:23,144 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0114_stage2_step900.svg
[rank1]:2025-10-29 01:14:23,145 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0114_stage1_step900.svg
[rank3]:2025-10-29 01:14:23,263 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0114_real_step900_rank3.svg
[rank3]:> Batch Time: 375.38 ms, GPU Bubble Ratio: 64.90%, 23.90%, 33.02%, 23.72%
[rank3]:2025-10-29 01:14:23,324 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0114_stage3_step900.svg
[rank0]:2025-10-29 01:14:23,686 - INFO - Avg. fwd time: 15.1924 / Avg. bwd time: 8.1397 / Avg. batch time: 533.7192 (ms) / GPU bubble ratio: 65.03%
[rank2]:2025-10-29 01:14:23,654 - INFO - Avg. fwd time: 14.8939 / Avg. bwd time: 20.0511 / Avg. batch time: 468.4451 (ms) / GPU bubble ratio: 40.32%
[rank1]:2025-10-29 01:14:23,679 - INFO - Avg. fwd time: 17.0220 / Avg. bwd time: 22.6202 / Avg. batch time: 509.3893 (ms) / GPU bubble ratio: 37.74%
[rank3]:2025-10-29 01:14:23,631 - INFO - Avg. fwd time: 16.4589 / Avg. bwd time: 23.5266 / Avg. batch time: 335.3610 (ms) / GPU bubble ratio: 4.62%
[rank0]:2025-10-29 01:14:38,826 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:38,825 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:38,825 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:14:43,462 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:14:58,935 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:14:58,934 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:14:58,934 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:03,578 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:19,153 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:19,152 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:19,152 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:23,798 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:39,220 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:39,219 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:39,219 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:15:43,866 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:57,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:15:59,403 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 66.72GiB(47.72%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank1]:2025-10-29 01:15:59,402 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 72.68GiB(51.98%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank2]:2025-10-29 01:15:59,402 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:15:59,403 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0009  memory: 64.67GiB(46.25%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank3]:2025-10-29 01:16:04,118 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:04,122 - INFO -  step: 950  loss:  0.1562  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,107  tflops: 378.11  mfu: 38.23%
[rank2]:2025-10-29 01:16:04,555 - INFO - Avg. fwd time: 14.9043 / Avg. bwd time: 19.8611 / Avg. batch time: 466.6749 (ms) / GPU bubble ratio: 40.40%
[rank3]:2025-10-29 01:16:04,507 - INFO - Avg. fwd time: 16.4668 / Avg. bwd time: 23.2938 / Avg. batch time: 333.5481 (ms) / GPU bubble ratio: 4.64%
[rank0]:2025-10-29 01:16:04,634 - INFO - Avg. fwd time: 15.1962 / Avg. bwd time: 7.8060 / Avg. batch time: 531.3966 (ms) / GPU bubble ratio: 65.37%
[rank1]:2025-10-29 01:16:04,601 - INFO - Avg. fwd time: 17.0332 / Avg. bwd time: 22.4109 / Avg. batch time: 507.4187 (ms) / GPU bubble ratio: 37.81%
[rank0]:2025-10-29 01:16:30,133 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:30,129 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:30,127 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:34,763 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:16:50,274 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:16:50,273 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:16:50,273 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:16:54,894 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:10,513 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:15,175 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:30,708 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:35,357 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:49,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:17:50,928 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:17:50,929 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank0]:2025-10-29 01:17:50,929 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 01:17:50,927 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:17:50,928 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank1]:2025-10-29 01:17:50,928 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 01:17:50,927 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:17:50,928 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 7,345  tflops: 342.59  mfu: 34.64%
[rank2]:2025-10-29 01:17:50,928 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 01:17:55,580 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:17:55,584 - INFO -  step: 1000  loss:  0.1058  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,350  tflops: 342.79  mfu: 34.66%
[rank3]:2025-10-29 01:17:55,584 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 01:18:12,029 - INFO - validate step: 1000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,412
[rank1]:2025-10-29 01:18:12,066 - INFO - validate step: 1000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,377
[rank2]:2025-10-29 01:18:12,105 - INFO - validate step: 1000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,342
[rank3]:2025-10-29 01:18:12,125 - INFO - validate step: 1000  loss:  0.2373  memory: 83.85GiB(59.97%)  tps: 24,763
[rank0]:2025-10-29 01:18:12,202 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0118_stage0_step1000.svg
[rank0]:2025-10-29 01:18:12,292 - INFO - Avg. fwd time: 15.1790 / Avg. bwd time: 7.8258 / Avg. batch time: 531.8945 (ms) / GPU bubble ratio: 65.40%
[rank2]:2025-10-29 01:18:12,202 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0118_stage2_step1000.svg
[rank1]:2025-10-29 01:18:12,203 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0118_stage1_step1000.svg
[rank3]:2025-10-29 01:18:12,314 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0118_real_step1000_rank3.svg
[rank3]:> Batch Time: 374.34 ms, GPU Bubble Ratio: 64.86%, 23.78%, 32.92%, 23.75%
[rank3]:2025-10-29 01:18:12,378 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0118_stage3_step1000.svg
[rank2]:2025-10-29 01:18:12,646 - INFO - Avg. fwd time: 14.8910 / Avg. bwd time: 19.8662 / Avg. batch time: 467.1547 (ms) / GPU bubble ratio: 40.48%
[rank1]:2025-10-29 01:18:12,670 - INFO - Avg. fwd time: 17.0186 / Avg. bwd time: 22.4190 / Avg. batch time: 507.9062 (ms) / GPU bubble ratio: 37.88%
[rank3]:2025-10-29 01:18:12,625 - INFO - Avg. fwd time: 16.4490 / Avg. bwd time: 23.2922 / Avg. batch time: 333.3787 (ms) / GPU bubble ratio: 4.63%
[rank0]:2025-10-29 01:18:28,029 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:28,028 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:28,028 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:32,810 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:18:48,305 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:18:48,304 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:18:48,304 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:18:52,953 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:08,545 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:13,419 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:29,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:29,020 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:29,020 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:33,670 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:47,630 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:19:49,192 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:19:49,193 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,431  tflops: 393.23  mfu: 39.76%
[rank2]:2025-10-29 01:19:49,191 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:19:49,192 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,438  tflops: 393.54  mfu: 39.79%
[rank1]:2025-10-29 01:19:49,192 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:19:49,192 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank3]:2025-10-29 01:19:53,849 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:19:53,853 - INFO -  step: 1050  loss:  0.1308  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,053  tflops: 375.59  mfu: 37.98%
[rank3]:2025-10-29 01:19:54,166 - INFO - Avg. fwd time: 16.4590 / Avg. bwd time: 23.0680 / Avg. batch time: 331.6519 (ms) / GPU bubble ratio: 4.65%
[rank2]:2025-10-29 01:19:54,191 - INFO - Avg. fwd time: 14.9008 / Avg. bwd time: 19.6807 / Avg. batch time: 465.9338 (ms) / GPU bubble ratio: 40.62%
[rank0]:2025-10-29 01:19:54,226 - INFO - Avg. fwd time: 15.1835 / Avg. bwd time: 7.4912 / Avg. batch time: 530.1146 (ms) / GPU bubble ratio: 65.78%
[rank1]:2025-10-29 01:19:54,217 - INFO - Avg. fwd time: 17.0319 / Avg. bwd time: 22.2113 / Avg. batch time: 506.4776 (ms) / GPU bubble ratio: 38.01%
[rank2]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:09,506 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:14,148 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:29,683 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:34,310 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:20:49,840 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:20:54,472 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:10,117 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:14,934 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:38,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:21:40,815 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:21:40,815 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 66.72GiB(47.72%)  tps: 7,339  tflops: 342.29  mfu: 34.61%
[rank1]:2025-10-29 01:21:40,811 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:21:40,811 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 72.68GiB(51.98%)  tps: 7,339  tflops: 342.30  mfu: 34.61%
[rank2]:2025-10-29 01:21:40,808 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:21:40,809 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1015  memory: 64.67GiB(46.25%)  tps: 7,339  tflops: 342.31  mfu: 34.61%
[rank3]:2025-10-29 01:21:45,453 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:21:45,461 - INFO -  step: 1100  loss:  0.0996  grad_norm:  0.1015  memory: 83.85GiB(59.97%)  tps: 7,340  tflops: 342.34  mfu: 34.62%
[rank0]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0121_stage0_step1100.svg
[rank1]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0121_stage1_step1100.svg
[rank2]:2025-10-29 01:21:45,539 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0121_stage2_step1100.svg
[rank3]:2025-10-29 01:21:45,654 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0121_real_step1100_rank3.svg
[rank3]:> Batch Time: 373.80 ms, GPU Bubble Ratio: 64.84%, 23.72%, 32.87%, 23.76%
[rank0]:2025-10-29 01:21:45,630 - INFO - Avg. fwd time: 15.1770 / Avg. bwd time: 7.4068 / Avg. batch time: 529.5396 (ms) / GPU bubble ratio: 65.88%
[rank3]:2025-10-29 01:21:45,717 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0121_stage3_step1100.svg
[rank3]:2025-10-29 01:21:45,964 - INFO - Avg. fwd time: 16.4546 / Avg. bwd time: 23.0057 / Avg. batch time: 331.1087 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 01:21:45,986 - INFO - Avg. fwd time: 14.8977 / Avg. bwd time: 19.6315 / Avg. batch time: 465.5117 (ms) / GPU bubble ratio: 40.66%
[rank1]:2025-10-29 01:21:46,010 - INFO - Avg. fwd time: 17.0293 / Avg. bwd time: 22.1567 / Avg. batch time: 505.9971 (ms) / GPU bubble ratio: 38.05%
[rank0]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:01,278 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:06,139 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:21,737 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:21,737 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:21,736 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:26,425 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:22:41,907 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:22:41,906 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:22:41,906 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:22:46,578 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:02,183 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:02,182 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:02,182 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:06,866 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:20,831 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:23:22,404 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,064  tflops: 376.10  mfu: 38.03%
[rank1]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:22,403 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,064  tflops: 376.09  mfu: 38.03%
[rank2]:2025-10-29 01:23:22,403 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:22,403 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,063  tflops: 376.08  mfu: 38.03%
[rank0]:2025-10-29 01:23:22,494 - INFO - Avg. fwd time: 15.1731 / Avg. bwd time: 7.2732 / Avg. batch time: 528.0146 (ms) / GPU bubble ratio: 65.99%
[rank3]:2025-10-29 01:23:27,183 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:27,187 - INFO -  step: 1150  loss:  0.1189  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 8,053  tflops: 375.60  mfu: 37.98%
[rank3]:2025-10-29 01:23:27,433 - INFO - Avg. fwd time: 16.4526 / Avg. bwd time: 22.9089 / Avg. batch time: 330.3073 (ms) / GPU bubble ratio: 4.67%
[rank1]:2025-10-29 01:23:27,480 - INFO - Avg. fwd time: 17.0297 / Avg. bwd time: 22.0731 / Avg. batch time: 504.6169 (ms) / GPU bubble ratio: 38.01%
[rank2]:2025-10-29 01:23:27,455 - INFO - Avg. fwd time: 14.8979 / Avg. bwd time: 19.5542 / Avg. batch time: 464.2114 (ms) / GPU bubble ratio: 40.63%
[rank0]:2025-10-29 01:23:42,709 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:23:42,708 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:23:42,708 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:23:47,329 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:03,102 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:03,102 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:03,103 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:08,909 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:24,434 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:24,434 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:24,435 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:29,504 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:24:45,054 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:24:45,054 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:24:45,055 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:24:50,370 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:04,399 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:25:05,977 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:25:05,977 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank0]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 01:25:05,976 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:25:05,977 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank1]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 01:25:05,976 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:25:05,976 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,909  tflops: 368.90  mfu: 37.30%
[rank2]:2025-10-29 01:25:05,977 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 01:25:11,055 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:25:11,065 - INFO -  step: 1200  loss:  0.1033  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,886  tflops: 367.82  mfu: 37.19%
[rank3]:2025-10-29 01:25:11,065 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 01:25:27,526 - INFO - validate step: 1200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,008
[rank0]:2025-10-29 01:25:27,528 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 01:25:27,533 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 01:25:27,562 - INFO - validate step: 1200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,976
[rank1]:2025-10-29 01:25:27,563 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 01:25:27,586 - INFO - validate step: 1200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,955
[rank2]:2025-10-29 01:25:27,587 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 01:25:27,610 - INFO - validate step: 1200  loss:  0.2378  memory: 83.85GiB(59.97%)  tps: 24,759
[rank3]:2025-10-29 01:25:27,611 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 01:25:40,730 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.12 seconds.
[rank0]:2025-10-29 01:25:42,266 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 01:25:42,272 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.74 seconds.
[rank0]:2025-10-29 01:25:42,273 - INFO - Checkpointer is deleting /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-800.
[rank2]:2025-10-29 01:25:42,492 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.90 seconds.
[rank1]:2025-10-29 01:25:44,969 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.41 seconds.
[rank2]:2025-10-29 01:25:45,078 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0125_stage2_step1200.svg
[rank2]:2025-10-29 01:25:45,091 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 01:25:45,074 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0125_stage1_step1200.svg
[rank1]:2025-10-29 01:25:45,087 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 01:25:45,185 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0125_stage0_step1200.svg
[rank0]:2025-10-29 01:25:45,197 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:25:45,283 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0125_real_step1200_rank3.svg
[rank3]:> Batch Time: 373.38 ms, GPU Bubble Ratio: 64.82%, 23.67%, 32.84%, 23.77%
[rank3]:2025-10-29 01:25:45,352 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0125_stage3_step1200.svg
[rank3]:2025-10-29 01:25:45,365 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 01:25:46,231 - INFO - Avg. fwd time: 16.4615 / Avg. bwd time: 22.7255 / Avg. batch time: 329.0161 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 01:25:46,256 - INFO - Avg. fwd time: 14.9096 / Avg. bwd time: 19.4061 / Avg. batch time: 463.7707 (ms) / GPU bubble ratio: 40.81%
[rank1]:2025-10-29 01:25:46,283 - INFO - Avg. fwd time: 17.0413 / Avg. bwd time: 21.9062 / Avg. batch time: 504.0169 (ms) / GPU bubble ratio: 38.18%
[rank0]:2025-10-29 01:25:46,294 - INFO - Avg. fwd time: 15.1800 / Avg. bwd time: 7.0046 / Avg. batch time: 527.1413 (ms) / GPU bubble ratio: 66.33%
[rank0]:2025-10-29 01:25:50,619 - INFO - Checkpointer deleted /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1/step-800 in 8.34 seconds.
[rank0]:2025-10-29 01:26:02,555 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:02,554 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:02,554 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:08,264 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:24,879 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:24,878 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:24,878 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:29,807 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:26:46,368 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:26:46,368 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:26:46,367 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:26:51,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:08,498 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:08,498 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:08,497 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:13,374 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:39,671 - INFO - [GC] Peforming periodical GC collection 2.04 seconds
[rank2]:2025-10-29 01:27:42,392 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:27:42,393 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 64.67GiB(46.25%)  tps: 6,077  tflops: 283.43  mfu: 28.66%
[rank1]:2025-10-29 01:27:42,395 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:27:42,396 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 72.68GiB(51.98%)  tps: 6,076  tflops: 283.37  mfu: 28.65%
[rank0]:2025-10-29 01:27:42,399 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:27:42,399 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5491  memory: 66.72GiB(47.72%)  tps: 6,074  tflops: 283.29  mfu: 28.64%
[rank0]:2025-10-29 01:27:42,504 - INFO - Avg. fwd time: 15.1982 / Avg. bwd time: 6.9496 / Avg. batch time: 527.6700 (ms) / GPU bubble ratio: 66.42%
[rank3]:2025-10-29 01:27:48,116 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:27:48,121 - INFO -  step: 1250  loss:  0.8856  grad_norm:  0.5491  memory: 83.85GiB(59.97%)  tps: 5,830  tflops: 271.92  mfu: 27.49%
[rank3]:2025-10-29 01:27:48,391 - INFO - Avg. fwd time: 16.4854 / Avg. bwd time: 22.7054 / Avg. batch time: 329.0402 (ms) / GPU bubble ratio: 4.71%
[rank1]:2025-10-29 01:27:48,440 - INFO - Avg. fwd time: 17.0604 / Avg. bwd time: 21.8767 / Avg. batch time: 504.5875 (ms) / GPU bubble ratio: 38.27%
[rank2]:2025-10-29 01:27:48,412 - INFO - Avg. fwd time: 14.9273 / Avg. bwd time: 19.3825 / Avg. batch time: 464.3717 (ms) / GPU bubble ratio: 40.89%
[rank1]:2025-10-29 01:28:04,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:04,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:04,708 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:09,855 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:26,498 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:26,497 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:26,497 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:31,600 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:28:48,132 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:28:53,242 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:09,855 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:09,855 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:09,856 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:14,969 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:29,923 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:29:31,585 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:31,585 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 64.67GiB(46.25%)  tps: 7,502  tflops: 349.91  mfu: 35.38%
[rank1]:2025-10-29 01:29:31,585 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:31,586 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 72.68GiB(51.98%)  tps: 7,503  tflops: 349.92  mfu: 35.38%
[rank0]:2025-10-29 01:29:31,586 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:29:31,586 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0022  memory: 66.72GiB(47.72%)  tps: 7,503  tflops: 349.93  mfu: 35.38%
[rank3]:2025-10-29 01:29:36,972 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:36,977 - INFO -  step: 1300  loss:  0.8851  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,526  tflops: 351.00  mfu: 35.49%
[rank0]:2025-10-29 01:29:37,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0129_stage0_step1300.svg
[rank2]:2025-10-29 01:29:37,057 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0129_stage2_step1300.svg
[rank1]:2025-10-29 01:29:37,064 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0129_stage1_step1300.svg
[rank0]:2025-10-29 01:29:37,170 - INFO - Avg. fwd time: 15.2210 / Avg. bwd time: 6.8515 / Avg. batch time: 528.3174 (ms) / GPU bubble ratio: 66.58%
[rank3]:2025-10-29 01:29:37,171 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0129_real_step1300_rank3.svg
[rank3]:> Batch Time: 374.46 ms, GPU Bubble Ratio: 64.83%, 23.75%, 32.90%, 23.76%
[rank3]:2025-10-29 01:29:37,237 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0129_stage3_step1300.svg
[rank3]:2025-10-29 01:29:37,509 - INFO - Avg. fwd time: 16.5151 / Avg. bwd time: 22.6596 / Avg. batch time: 328.9046 (ms) / GPU bubble ratio: 4.71%
[rank2]:2025-10-29 01:29:37,531 - INFO - Avg. fwd time: 14.9502 / Avg. bwd time: 19.3355 / Avg. batch time: 465.1606 (ms) / GPU bubble ratio: 41.03%
[rank1]:2025-10-29 01:29:37,557 - INFO - Avg. fwd time: 17.0864 / Avg. bwd time: 21.8222 / Avg. batch time: 505.3237 (ms) / GPU bubble ratio: 38.40%
[rank0]:2025-10-29 01:29:53,745 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:29:53,744 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:29:53,744 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:29:59,287 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:15,878 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:15,877 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:15,877 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:20,836 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:37,362 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:30:42,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:30:58,869 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:30:58,869 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:30:58,870 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:03,842 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:18,731 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:20,396 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 66.72GiB(47.72%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank1]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:31:20,395 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 72.68GiB(51.98%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank2]:2025-10-29 01:31:20,395 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:20,395 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0045  memory: 64.67GiB(46.25%)  tps: 7,529  tflops: 351.14  mfu: 35.50%
[rank3]:2025-10-29 01:31:25,349 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:25,354 - INFO -  step: 1350  loss:  1.2334  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,559  tflops: 352.55  mfu: 35.65%
[rank0]:2025-10-29 01:31:25,756 - INFO - Avg. fwd time: 15.2483 / Avg. bwd time: 6.6297 / Avg. batch time: 527.8916 (ms) / GPU bubble ratio: 66.84%
[rank3]:2025-10-29 01:31:25,693 - INFO - Avg. fwd time: 16.5511 / Avg. bwd time: 22.5326 / Avg. batch time: 328.1703 (ms) / GPU bubble ratio: 4.72%
[rank1]:2025-10-29 01:31:25,745 - INFO - Avg. fwd time: 17.1185 / Avg. bwd time: 21.6907 / Avg. batch time: 505.1134 (ms) / GPU bubble ratio: 38.53%
[rank2]:2025-10-29 01:31:25,718 - INFO - Avg. fwd time: 14.9785 / Avg. bwd time: 19.2207 / Avg. batch time: 465.0805 (ms) / GPU bubble ratio: 41.17%
[rank1]:2025-10-29 01:31:41,897 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:31:41,897 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:31:41,898 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:31:46,853 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:03,478 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:03,477 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:03,477 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:08,415 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:24,978 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:24,977 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:24,977 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:29,947 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:32:46,496 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:32:46,495 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:32:46,495 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:32:51,441 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:06,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:08,060 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 72.68GiB(51.98%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank2]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:33:08,060 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 64.67GiB(46.25%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank2]:2025-10-29 01:33:08,060 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 01:33:08,060 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:08,060 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:08,061 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1565  memory: 66.72GiB(47.72%)  tps: 7,609  tflops: 354.88  mfu: 35.88%
[rank0]:2025-10-29 01:33:08,061 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 01:33:13,018 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:33:13,022 - INFO -  step: 1400  loss:  2.7328  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,609  tflops: 354.87  mfu: 35.88%
[rank3]:2025-10-29 01:33:13,023 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 01:33:27,591 - INFO - validate step: 1400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 20,974
[rank1]:2025-10-29 01:33:27,623 - INFO - validate step: 1400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 20,938
[rank2]:2025-10-29 01:33:27,649 - INFO - validate step: 1400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 20,910
[rank3]:2025-10-29 01:33:27,668 - INFO - validate step: 1400  loss:  1.3556  memory: 83.85GiB(59.97%)  tps: 27,969
[rank0]:2025-10-29 01:33:27,751 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0133_stage0_step1400.svg
[rank1]:2025-10-29 01:33:27,762 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0133_stage1_step1400.svg
[rank2]:2025-10-29 01:33:27,751 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0133_stage2_step1400.svg
[rank3]:2025-10-29 01:33:27,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0133_real_step1400_rank3.svg
[rank3]:> Batch Time: 375.73 ms, GPU Bubble Ratio: 64.83%, 23.82%, 33.00%, 23.76%
[rank3]:2025-10-29 01:33:27,928 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0133_stage3_step1400.svg
[rank3]:2025-10-29 01:33:28,345 - INFO - Avg. fwd time: 16.5800 / Avg. bwd time: 22.4317 / Avg. batch time: 327.5897 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 01:33:28,396 - INFO - Avg. fwd time: 15.0013 / Avg. bwd time: 19.1288 / Avg. batch time: 464.6536 (ms) / GPU bubble ratio: 41.24%
[rank1]:2025-10-29 01:33:28,442 - INFO - Avg. fwd time: 17.1442 / Avg. bwd time: 21.5864 / Avg. batch time: 504.5824 (ms) / GPU bubble ratio: 38.59%
[rank0]:2025-10-29 01:33:28,474 - INFO - Avg. fwd time: 15.2697 / Avg. bwd time: 6.4529 / Avg. batch time: 527.1877 (ms) / GPU bubble ratio: 67.04%
[rank2]:2025-10-29 01:33:54,917 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:33:54,924 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:33:54,919 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:00,047 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:16,629 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:16,629 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:16,630 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:21,615 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:38,242 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:34:43,207 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:34:59,759 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:34:59,759 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:34:59,760 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:04,729 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:19,733 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:35:21,391 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 66.72GiB(47.72%)  tps: 7,199  tflops: 335.74  mfu: 33.95%
[rank2]:2025-10-29 01:35:21,390 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 64.67GiB(46.25%)  tps: 7,202  tflops: 335.92  mfu: 33.97%
[rank1]:2025-10-29 01:35:21,390 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:21,391 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0022  memory: 72.68GiB(51.98%)  tps: 7,201  tflops: 335.84  mfu: 33.96%
[rank0]:2025-10-29 01:35:21,493 - INFO - Avg. fwd time: 15.2802 / Avg. bwd time: 6.5179 / Avg. batch time: 527.6817 (ms) / GPU bubble ratio: 66.95%
[rank3]:2025-10-29 01:35:26,364 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:26,369 - INFO -  step: 1450  loss:  0.9433  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,902  tflops: 321.89  mfu: 32.55%
[rank3]:2025-10-29 01:35:26,639 - INFO - Avg. fwd time: 16.5941 / Avg. bwd time: 22.4885 / Avg. batch time: 328.1528 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-10-29 01:35:26,661 - INFO - Avg. fwd time: 15.0115 / Avg. bwd time: 19.1704 / Avg. batch time: 465.0232 (ms) / GPU bubble ratio: 41.20%
[rank1]:2025-10-29 01:35:26,686 - INFO - Avg. fwd time: 17.1560 / Avg. bwd time: 21.6322 / Avg. batch time: 505.0010 (ms) / GPU bubble ratio: 38.55%
[rank0]:2025-10-29 01:35:42,950 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:35:42,949 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:35:42,949 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:35:47,944 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:04,498 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:09,497 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:26,124 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:26,124 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:26,125 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:31,141 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:36:47,683 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:36:47,682 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:36:47,682 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:36:52,806 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:07,724 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:37:09,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 64.67GiB(46.25%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank1]:2025-10-29 01:37:09,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 72.68GiB(51.98%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank0]:2025-10-29 01:37:09,375 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:09,375 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0023  memory: 66.72GiB(47.72%)  tps: 7,586  tflops: 353.83  mfu: 35.78%
[rank3]:2025-10-29 01:37:14,485 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:14,490 - INFO -  step: 1500  loss:  0.8235  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,577  tflops: 353.38  mfu: 35.73%
[rank1]:2025-10-29 01:37:14,579 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0137_stage1_step1500.svg
[rank2]:2025-10-29 01:37:14,575 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0137_stage2_step1500.svg
[rank0]:2025-10-29 01:37:14,574 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0137_stage0_step1500.svg
[rank3]:2025-10-29 01:37:14,679 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0137_real_step1500_rank3.svg
[rank3]:> Batch Time: 376.99 ms, GPU Bubble Ratio: 64.84%, 23.94%, 33.10%, 23.73%
[rank3]:2025-10-29 01:37:14,746 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0137_stage3_step1500.svg
[rank3]:2025-10-29 01:37:15,087 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 22.3809 / Avg. batch time: 327.5221 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 01:37:15,139 - INFO - Avg. fwd time: 17.1822 / Avg. bwd time: 21.5220 / Avg. batch time: 504.7824 (ms) / GPU bubble ratio: 38.66%
[rank2]:2025-10-29 01:37:15,112 - INFO - Avg. fwd time: 15.0347 / Avg. bwd time: 19.0742 / Avg. batch time: 464.9143 (ms) / GPU bubble ratio: 41.31%
[rank0]:2025-10-29 01:37:15,148 - INFO - Avg. fwd time: 15.3021 / Avg. bwd time: 6.3301 / Avg. batch time: 527.2797 (ms) / GPU bubble ratio: 67.18%
[rank2]:2025-10-29 01:37:31,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:31,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:31,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:36,473 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:37:52,987 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:37:57,976 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:14,564 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:14,563 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:14,564 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:19,541 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:36,098 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:36,097 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:36,097 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:38:41,085 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:55,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:38:57,627 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 64.67GiB(46.25%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank1]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:38:57,627 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 72.68GiB(51.98%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank0]:2025-10-29 01:38:57,627 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:38:57,628 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0021  memory: 66.72GiB(47.72%)  tps: 7,568  tflops: 352.95  mfu: 35.69%
[rank0]:2025-10-29 01:38:57,732 - INFO - Avg. fwd time: 15.3203 / Avg. bwd time: 6.1792 / Avg. batch time: 526.7076 (ms) / GPU bubble ratio: 67.35%
[rank3]:2025-10-29 01:39:02,643 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:02,648 - INFO -  step: 1550  loss:  0.8942  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,574  tflops: 353.26  mfu: 35.72%
[rank3]:2025-10-29 01:39:02,922 - INFO - Avg. fwd time: 16.6474 / Avg. bwd time: 22.2949 / Avg. batch time: 327.0213 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 01:39:02,942 - INFO - Avg. fwd time: 15.0538 / Avg. bwd time: 18.9965 / Avg. batch time: 464.5788 (ms) / GPU bubble ratio: 41.37%
[rank1]:2025-10-29 01:39:02,969 - INFO - Avg. fwd time: 17.2037 / Avg. bwd time: 21.4335 / Avg. batch time: 504.3582 (ms) / GPU bubble ratio: 38.71%
[rank1]:2025-10-29 01:39:19,281 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:19,281 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:19,282 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:24,275 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:39:40,836 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:39:40,835 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:39:40,835 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:39:45,799 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:12,795 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:12,792 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:12,799 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:17,756 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:34,236 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:39,173 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:53,197 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:40:54,774 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank0]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 01:40:54,773 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank2]:2025-10-29 01:40:54,773 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:40:54,774 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 6,993  tflops: 326.15  mfu: 32.98%
[rank1]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 01:40:54,774 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 01:40:59,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:40:59,741 - INFO -  step: 1600  loss:  0.1246  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 6,996  tflops: 326.31  mfu: 32.99%
[rank3]:2025-10-29 01:40:59,741 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 01:41:16,154 - INFO - validate step: 1600  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,159
[rank1]:2025-10-29 01:41:16,192 - INFO - validate step: 1600  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 19,124
[rank2]:2025-10-29 01:41:16,217 - INFO - validate step: 1600  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 19,102
[rank3]:2025-10-29 01:41:16,240 - INFO - validate step: 1600  loss:  0.2372  memory: 83.85GiB(59.97%)  tps: 24,826
[rank0]:2025-10-29 01:41:16,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0141_stage0_step1600.svg
[rank1]:2025-10-29 01:41:16,326 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0141_stage1_step1600.svg
[rank2]:2025-10-29 01:41:16,325 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0141_stage2_step1600.svg
[rank0]:2025-10-29 01:41:16,418 - INFO - Avg. fwd time: 15.3232 / Avg. bwd time: 6.2470 / Avg. batch time: 527.8131 (ms) / GPU bubble ratio: 67.31%
[rank3]:2025-10-29 01:41:16,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0141_real_step1600_rank3.svg
[rank3]:> Batch Time: 377.91 ms, GPU Bubble Ratio: 64.84%, 24.02%, 33.16%, 23.70%
[rank3]:2025-10-29 01:41:16,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0141_stage3_step1600.svg
[rank2]:2025-10-29 01:41:16,772 - INFO - Avg. fwd time: 15.0568 / Avg. bwd time: 19.0364 / Avg. batch time: 465.5662 (ms) / GPU bubble ratio: 41.42%
[rank3]:2025-10-29 01:41:16,750 - INFO - Avg. fwd time: 16.6528 / Avg. bwd time: 22.3468 / Avg. batch time: 327.4754 (ms) / GPU bubble ratio: 4.73%
[rank1]:2025-10-29 01:41:16,797 - INFO - Avg. fwd time: 17.2068 / Avg. bwd time: 21.4781 / Avg. batch time: 505.3909 (ms) / GPU bubble ratio: 38.76%
[rank0]:2025-10-29 01:41:32,002 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:41:32,001 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:41:32,001 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:41:37,142 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:41:52,761 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:41:52,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:41:52,762 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:41:57,752 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:13,297 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:18,312 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:33,820 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:38,790 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:52,863 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 01:42:54,413 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:42:54,414 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,340  tflops: 388.99  mfu: 39.33%
[rank2]:2025-10-29 01:42:54,413 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:42:54,414 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,342  tflops: 389.09  mfu: 39.34%
[rank0]:2025-10-29 01:42:54,414 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:42:54,415 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,337  tflops: 388.84  mfu: 39.32%
[rank3]:2025-10-29 01:42:59,363 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:42:59,367 - INFO -  step: 1650  loss:  0.1110  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,944  tflops: 370.50  mfu: 37.46%
[rank3]:2025-10-29 01:42:59,678 - INFO - Avg. fwd time: 16.6525 / Avg. bwd time: 22.2330 / Avg. batch time: 326.5527 (ms) / GPU bubble ratio: 4.74%
[rank1]:2025-10-29 01:42:59,734 - INFO - Avg. fwd time: 17.2112 / Avg. bwd time: 21.3770 / Avg. batch time: 504.7793 (ms) / GPU bubble ratio: 38.84%
[rank2]:2025-10-29 01:42:59,705 - INFO - Avg. fwd time: 15.0590 / Avg. bwd time: 18.9451 / Avg. batch time: 465.0491 (ms) / GPU bubble ratio: 41.50%
[rank0]:2025-10-29 01:42:59,746 - INFO - Avg. fwd time: 15.3229 / Avg. bwd time: 6.0843 / Avg. batch time: 527.0294 (ms) / GPU bubble ratio: 67.51%
[rank1]:2025-10-29 01:43:14,868 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:14,868 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:14,869 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:43:19,824 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:43:35,374 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:35,374 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:35,375 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:43:40,355 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:43:55,935 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:43:55,934 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:43:55,934 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:00,919 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:16,410 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:21,500 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:35,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:37,098 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank1]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:44:37,098 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank0]:2025-10-29 01:44:37,098 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:37,099 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,978  tflops: 372.09  mfu: 37.62%
[rank3]:2025-10-29 01:44:42,119 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:44:42,127 - INFO -  step: 1700  loss:  0.1070  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank2]:2025-10-29 01:44:42,212 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0144_stage2_step1700.svg
[rank1]:2025-10-29 01:44:42,212 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0144_stage1_step1700.svg
[rank0]:2025-10-29 01:44:42,213 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0144_stage0_step1700.svg
[rank3]:2025-10-29 01:44:42,319 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0144_real_step1700_rank3.svg
[rank3]:> Batch Time: 377.10 ms, GPU Bubble Ratio: 64.81%, 23.91%, 33.09%, 23.74%
[rank3]:2025-10-29 01:44:42,387 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0144_stage3_step1700.svg
[rank0]:2025-10-29 01:44:42,305 - INFO - Avg. fwd time: 15.3215 / Avg. bwd time: 5.9528 / Avg. batch time: 526.1448 (ms) / GPU bubble ratio: 67.65%
[rank2]:2025-10-29 01:44:42,653 - INFO - Avg. fwd time: 15.0598 / Avg. bwd time: 18.8710 / Avg. batch time: 464.3872 (ms) / GPU bubble ratio: 41.55%
[rank3]:2025-10-29 01:44:42,631 - INFO - Avg. fwd time: 16.6515 / Avg. bwd time: 22.1403 / Avg. batch time: 325.7958 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 01:44:42,677 - INFO - Avg. fwd time: 17.2130 / Avg. bwd time: 21.2947 / Avg. batch time: 504.0355 (ms) / GPU bubble ratio: 38.88%
[rank1]:2025-10-29 01:44:57,910 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:44:57,910 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:44:57,911 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:02,868 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:18,409 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:18,408 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:18,408 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:23,396 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:39,010 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:45:44,017 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:45:59,496 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:45:59,496 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:45:59,497 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:04,581 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:18,593 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:46:20,140 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank1]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:46:20,140 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank0]:2025-10-29 01:46:20,140 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:20,141 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,950  tflops: 370.80  mfu: 37.49%
[rank3]:2025-10-29 01:46:25,217 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:25,222 - INFO -  step: 1750  loss:  0.1009  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,946  tflops: 370.61  mfu: 37.47%
[rank3]:2025-10-29 01:46:25,614 - INFO - Avg. fwd time: 16.6510 / Avg. bwd time: 22.0385 / Avg. batch time: 324.9694 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:46:25,663 - INFO - Avg. fwd time: 15.0614 / Avg. bwd time: 18.7897 / Avg. batch time: 463.2151 (ms) / GPU bubble ratio: 41.54%
[rank1]:2025-10-29 01:46:25,709 - INFO - Avg. fwd time: 17.2157 / Avg. bwd time: 21.2039 / Avg. batch time: 502.7728 (ms) / GPU bubble ratio: 38.87%
[rank0]:2025-10-29 01:46:25,741 - INFO - Avg. fwd time: 15.3203 / Avg. bwd time: 5.8080 / Avg. batch time: 524.7274 (ms) / GPU bubble ratio: 67.79%
[rank2]:2025-10-29 01:46:51,259 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:46:51,262 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:46:51,266 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:46:56,345 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:11,845 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:11,845 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:11,846 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:17,091 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:32,713 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:37,786 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:47:53,329 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:47:53,329 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:47:53,330 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:47:58,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:12,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:48:13,912 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank2]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 01:48:13,912 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank1]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:48:13,913 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:13,913 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,200  tflops: 335.83  mfu: 33.96%
[rank0]:2025-10-29 01:48:13,913 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 01:48:18,937 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:48:18,942 - INFO -  step: 1800  loss:  0.0894  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,204  tflops: 335.99  mfu: 33.97%
[rank3]:2025-10-29 01:48:18,943 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 01:48:35,449 - INFO - validate step: 1800  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,020
[rank2]:2025-10-29 01:48:35,510 - INFO - validate step: 1800  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,966
[rank1]:2025-10-29 01:48:35,487 - INFO - validate step: 1800  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,986
[rank3]:2025-10-29 01:48:35,533 - INFO - validate step: 1800  loss:  0.2347  memory: 83.85GiB(59.97%)  tps: 24,690
[rank2]:2025-10-29 01:48:35,620 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0148_stage2_step1800.svg
[rank1]:2025-10-29 01:48:35,621 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0148_stage1_step1800.svg
[rank0]:2025-10-29 01:48:35,617 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0148_stage0_step1800.svg
[rank3]:2025-10-29 01:48:35,726 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0148_real_step1800_rank3.svg
[rank3]:> Batch Time: 376.45 ms, GPU Bubble Ratio: 64.80%, 23.83%, 33.03%, 23.77%
[rank3]:2025-10-29 01:48:35,794 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0148_stage3_step1800.svg
[rank2]:2025-10-29 01:48:36,134 - INFO - Avg. fwd time: 15.0503 / Avg. bwd time: 18.8259 / Avg. batch time: 463.9305 (ms) / GPU bubble ratio: 41.58%
[rank1]:2025-10-29 01:48:36,162 - INFO - Avg. fwd time: 17.2035 / Avg. bwd time: 21.2448 / Avg. batch time: 503.5285 (ms) / GPU bubble ratio: 38.91%
[rank3]:2025-10-29 01:48:36,108 - INFO - Avg. fwd time: 16.6359 / Avg. bwd time: 22.0752 / Avg. batch time: 325.1348 (ms) / GPU bubble ratio: 4.75%
[rank0]:2025-10-29 01:48:36,171 - INFO - Avg. fwd time: 15.3080 / Avg. bwd time: 5.8776 / Avg. batch time: 525.5484 (ms) / GPU bubble ratio: 67.75%
[rank1]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:48:51,502 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:48:56,542 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:12,052 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:12,052 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:12,053 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:17,050 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:32,626 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:32,625 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:32,626 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:37,624 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:49:53,246 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:49:58,247 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:12,196 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:13,756 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 8,333  tflops: 388.66  mfu: 39.30%
[rank2]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:13,755 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 8,338  tflops: 388.90  mfu: 39.32%
[rank1]:2025-10-29 01:50:13,755 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:13,755 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 8,336  tflops: 388.81  mfu: 39.31%
[rank0]:2025-10-29 01:50:13,848 - INFO - Avg. fwd time: 15.3080 / Avg. bwd time: 5.7619 / Avg. batch time: 524.8044 (ms) / GPU bubble ratio: 67.88%
[rank3]:2025-10-29 01:50:18,781 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:18,786 - INFO -  step: 1850  loss:  0.0879  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,934  tflops: 370.05  mfu: 37.42%
[rank3]:2025-10-29 01:50:19,037 - INFO - Avg. fwd time: 16.6368 / Avg. bwd time: 21.9954 / Avg. batch time: 324.4975 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:50:19,057 - INFO - Avg. fwd time: 15.0522 / Avg. bwd time: 18.7617 / Avg. batch time: 463.3783 (ms) / GPU bubble ratio: 41.62%
[rank1]:2025-10-29 01:50:19,083 - INFO - Avg. fwd time: 17.2072 / Avg. bwd time: 21.1734 / Avg. batch time: 502.9077 (ms) / GPU bubble ratio: 38.95%
[rank0]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:34,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:39,392 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:50:54,953 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:50:54,953 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:50:54,954 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:50:59,936 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:15,478 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:15,478 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:15,479 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:51:20,451 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:36,077 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:36,077 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:36,078 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:51:41,053 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:54,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:51:56,549 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank2]:2025-10-29 01:51:56,548 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank1]:2025-10-29 01:51:56,548 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:51:56,549 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 7,969  tflops: 371.69  mfu: 37.58%
[rank3]:2025-10-29 01:52:01,562 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:01,567 - INFO -  step: 1900  loss:  0.0774  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,971  tflops: 371.75  mfu: 37.59%
[rank0]:2025-10-29 01:52:01,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0151_stage0_step1900.svg
[rank2]:2025-10-29 01:52:01,653 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0151_stage2_step1900.svg
[rank1]:2025-10-29 01:52:01,656 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0151_stage1_step1900.svg
[rank0]:2025-10-29 01:52:01,744 - INFO - Avg. fwd time: 15.3071 / Avg. bwd time: 5.6338 / Avg. batch time: 524.1678 (ms) / GPU bubble ratio: 68.04%
[rank3]:2025-10-29 01:52:01,761 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0152_real_step1900_rank3.svg
[rank3]:> Batch Time: 375.89 ms, GPU Bubble Ratio: 64.79%, 23.76%, 32.98%, 23.81%
[rank3]:2025-10-29 01:52:01,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0152_stage3_step1900.svg
[rank2]:2025-10-29 01:52:02,103 - INFO - Avg. fwd time: 15.0538 / Avg. bwd time: 18.6906 / Avg. batch time: 462.9579 (ms) / GPU bubble ratio: 41.69%
[rank1]:2025-10-29 01:52:02,128 - INFO - Avg. fwd time: 17.2096 / Avg. bwd time: 21.0935 / Avg. batch time: 502.4080 (ms) / GPU bubble ratio: 39.01%
[rank3]:2025-10-29 01:52:02,082 - INFO - Avg. fwd time: 16.6365 / Avg. bwd time: 21.9063 / Avg. batch time: 323.7754 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:17,370 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:22,333 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:37,915 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:52:42,877 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:52:58,379 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:52:58,379 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:52:58,380 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:03,370 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:18,975 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:23,990 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:47,302 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 01:53:49,946 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:53:49,947 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 64.67GiB(46.25%)  tps: 7,224  tflops: 336.93  mfu: 34.07%
[rank1]:2025-10-29 01:53:49,949 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:53:49,949 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 72.68GiB(51.98%)  tps: 7,224  tflops: 336.93  mfu: 34.07%
[rank0]:2025-10-29 01:53:49,953 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:53:49,954 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1606  memory: 66.72GiB(47.72%)  tps: 7,224  tflops: 336.92  mfu: 34.07%
[rank3]:2025-10-29 01:53:55,005 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:53:55,010 - INFO -  step: 1950  loss:  0.1055  grad_norm:  0.1606  memory: 83.85GiB(59.97%)  tps: 7,221  tflops: 336.81  mfu: 34.06%
[rank3]:2025-10-29 01:53:55,330 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 21.9439 / Avg. batch time: 323.9656 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 01:53:55,357 - INFO - Avg. fwd time: 15.0445 / Avg. bwd time: 18.7262 / Avg. batch time: 463.5589 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 01:53:55,387 - INFO - Avg. fwd time: 17.1992 / Avg. bwd time: 21.1340 / Avg. batch time: 503.0478 (ms) / GPU bubble ratio: 39.04%
[rank0]:2025-10-29 01:53:55,400 - INFO - Avg. fwd time: 15.2969 / Avg. bwd time: 5.7024 / Avg. batch time: 524.8734 (ms) / GPU bubble ratio: 67.99%
[rank2]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:10,575 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:15,644 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:54:31,303 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:31,303 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:31,304 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:36,524 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:54:52,017 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:54:57,082 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:55:12,657 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:55:12,657 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:12,658 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:55:17,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:31,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:55:33,339 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:55:33,339 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,924  tflops: 369.57  mfu: 37.37%
[rank0]:2025-10-29 01:55:33,339 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 01:55:33,338 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:55:33,338 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,923  tflops: 369.54  mfu: 37.37%
[rank2]:2025-10-29 01:55:33,338 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 01:55:33,338 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:55:33,338 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,923  tflops: 369.55  mfu: 37.37%
[rank1]:2025-10-29 01:55:33,338 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 01:55:38,439 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:55:38,449 - INFO -  step: 2000  loss:  0.1163  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,920  tflops: 369.38  mfu: 37.35%
[rank3]:2025-10-29 01:55:38,449 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 01:55:54,910 - INFO - validate step: 2000  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,988
[rank0]:2025-10-29 01:55:54,873 - INFO - validate step: 2000  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 19,021
[rank2]:2025-10-29 01:55:54,940 - INFO - validate step: 2000  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,962
[rank3]:2025-10-29 01:55:54,963 - INFO - validate step: 2000  loss:  0.2348  memory: 83.85GiB(59.97%)  tps: 24,803
[rank0]:2025-10-29 01:55:55,051 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0155_stage0_step2000.svg
[rank2]:2025-10-29 01:55:55,052 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0155_stage2_step2000.svg
[rank1]:2025-10-29 01:55:55,054 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0155_stage1_step2000.svg
[rank3]:2025-10-29 01:55:55,157 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0155_real_step2000_rank3.svg
[rank3]:> Batch Time: 375.46 ms, GPU Bubble Ratio: 64.78%, 23.71%, 32.94%, 23.82%
[rank0]:2025-10-29 01:55:55,143 - INFO - Avg. fwd time: 15.2962 / Avg. bwd time: 5.5993 / Avg. batch time: 524.2330 (ms) / GPU bubble ratio: 68.11%
[rank3]:2025-10-29 01:55:55,228 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0155_stage3_step2000.svg
[rank2]:2025-10-29 01:55:55,501 - INFO - Avg. fwd time: 15.0459 / Avg. bwd time: 18.6690 / Avg. batch time: 463.0918 (ms) / GPU bubble ratio: 41.76%
[rank1]:2025-10-29 01:55:55,526 - INFO - Avg. fwd time: 17.2014 / Avg. bwd time: 21.0700 / Avg. batch time: 502.5178 (ms) / GPU bubble ratio: 39.07%
[rank3]:2025-10-29 01:55:55,480 - INFO - Avg. fwd time: 16.6235 / Avg. bwd time: 21.8723 / Avg. batch time: 323.3885 (ms) / GPU bubble ratio: 4.77%
[rank0]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:10,762 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:16,408 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:56:32,030 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:37,132 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:56:52,707 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:56:57,843 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:13,380 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:57:13,380 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:13,381 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:18,521 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:32,627 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 01:57:34,189 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 64.67GiB(46.25%)  tps: 8,254  tflops: 384.96  mfu: 38.92%
[rank1]:2025-10-29 01:57:34,190 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 72.68GiB(51.98%)  tps: 8,251  tflops: 384.85  mfu: 38.91%
[rank0]:2025-10-29 01:57:34,190 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:34,190 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0006  memory: 66.72GiB(47.72%)  tps: 8,248  tflops: 384.70  mfu: 38.90%
[rank0]:2025-10-29 01:57:34,283 - INFO - Avg. fwd time: 15.2967 / Avg. bwd time: 5.4848 / Avg. batch time: 523.2208 (ms) / GPU bubble ratio: 68.23%
[rank3]:2025-10-29 01:57:39,313 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:39,317 - INFO -  step: 2050  loss:  0.1540  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,850  tflops: 366.14  mfu: 37.02%
[rank2]:2025-10-29 01:57:39,584 - INFO - Avg. fwd time: 15.0485 / Avg. bwd time: 18.6053 / Avg. batch time: 462.2713 (ms) / GPU bubble ratio: 41.76%
[rank1]:2025-10-29 01:57:39,609 - INFO - Avg. fwd time: 17.2058 / Avg. bwd time: 20.9992 / Avg. batch time: 501.6275 (ms) / GPU bubble ratio: 39.07%
[rank3]:2025-10-29 01:57:39,563 - INFO - Avg. fwd time: 16.6250 / Avg. bwd time: 21.7942 / Avg. batch time: 322.7695 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 01:57:54,805 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:57:54,805 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:57:54,806 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:57:59,929 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:15,523 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:15,523 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:15,524 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:58:20,653 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:36,282 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:36,281 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:36,282 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:58:41,440 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:58:56,929 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:02,092 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:16,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:17,710 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank2]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:59:17,709 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank1]:2025-10-29 01:59:17,709 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:17,709 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank3]:2025-10-29 01:59:22,841 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:22,845 - INFO -  step: 2100  loss:  0.1347  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,913  tflops: 369.06  mfu: 37.32%
[rank0]:2025-10-29 01:59:22,926 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0159_stage0_step2100.svg
[rank2]:2025-10-29 01:59:22,928 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0159_stage2_step2100.svg
[rank1]:2025-10-29 01:59:22,929 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0159_stage1_step2100.svg
[rank3]:2025-10-29 01:59:23,040 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0159_real_step2100_rank3.svg
[rank3]:> Batch Time: 375.18 ms, GPU Bubble Ratio: 64.78%, 23.68%, 32.91%, 23.82%
[rank3]:2025-10-29 01:59:23,104 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0159_stage3_step2100.svg
[rank3]:2025-10-29 01:59:23,416 - INFO - Avg. fwd time: 16.6257 / Avg. bwd time: 21.7194 / Avg. batch time: 322.1710 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 01:59:23,472 - INFO - Avg. fwd time: 17.2086 / Avg. bwd time: 20.9313 / Avg. batch time: 501.3240 (ms) / GPU bubble ratio: 39.14%
[rank2]:2025-10-29 01:59:23,443 - INFO - Avg. fwd time: 15.0504 / Avg. bwd time: 18.5450 / Avg. batch time: 462.0348 (ms) / GPU bubble ratio: 41.83%
[rank0]:2025-10-29 01:59:23,484 - INFO - Avg. fwd time: 15.2965 / Avg. bwd time: 5.3760 / Avg. batch time: 522.8021 (ms) / GPU bubble ratio: 68.37%
[rank2]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:38,695 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 01:59:43,844 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 01:59:59,376 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 01:59:59,375 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 01:59:59,375 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:04,554 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:00:20,187 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:00:20,186 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:00:20,186 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:25,372 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:00:40,879 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:00:46,033 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:09,403 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:01:12,021 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:12,021 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 66.72GiB(47.72%)  tps: 7,166  tflops: 334.24  mfu: 33.80%
[rank2]:2025-10-29 02:01:12,014 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:01:12,015 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 64.67GiB(46.25%)  tps: 7,167  tflops: 334.26  mfu: 33.80%
[rank1]:2025-10-29 02:01:12,017 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:12,017 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1753  memory: 72.68GiB(51.98%)  tps: 7,167  tflops: 334.25  mfu: 33.80%
[rank0]:2025-10-29 02:01:12,117 - INFO - Avg. fwd time: 15.2919 / Avg. bwd time: 5.3777 / Avg. batch time: 522.8968 (ms) / GPU bubble ratio: 68.38%
[rank3]:2025-10-29 02:01:17,170 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:17,175 - INFO -  step: 2150  loss:  0.1752  grad_norm:  0.1753  memory: 83.85GiB(59.97%)  tps: 7,165  tflops: 334.19  mfu: 33.79%
[rank3]:2025-10-29 02:01:17,426 - INFO - Avg. fwd time: 16.6200 / Avg. bwd time: 21.7160 / Avg. batch time: 322.0939 (ms) / GPU bubble ratio: 4.78%
[rank2]:2025-10-29 02:01:17,448 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.5449 / Avg. batch time: 462.1323 (ms) / GPU bubble ratio: 41.85%
[rank1]:2025-10-29 02:01:17,473 - INFO - Avg. fwd time: 17.2046 / Avg. bwd time: 20.9311 / Avg. batch time: 501.4204 (ms) / GPU bubble ratio: 39.16%
[rank2]:2025-10-29 02:01:32,798 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:32,798 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:32,799 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:37,937 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:01:53,437 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:01:58,595 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:14,216 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:14,216 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:14,217 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:02:19,366 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:34,912 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:34,911 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:34,911 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:02:40,033 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:54,035 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:02:55,593 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:02:55,593 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,910  tflops: 368.90  mfu: 37.30%
[rank0]:2025-10-29 02:02:55,593 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 02:02:55,592 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:02:55,592 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,909  tflops: 368.88  mfu: 37.30%
[rank2]:2025-10-29 02:02:55,593 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 02:02:55,592 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:02:55,592 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,909  tflops: 368.89  mfu: 37.30%
[rank1]:2025-10-29 02:02:55,592 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 02:03:00,736 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:00,741 - INFO -  step: 2200  loss:  0.1032  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,910  tflops: 368.93  mfu: 37.30%
[rank3]:2025-10-29 02:03:00,741 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 02:03:17,285 - INFO - validate step: 2200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,883
[rank2]:2025-10-29 02:03:17,341 - INFO - validate step: 2200  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,833
[rank1]:2025-10-29 02:03:17,322 - INFO - validate step: 2200  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,850
[rank3]:2025-10-29 02:03:17,365 - INFO - validate step: 2200  loss:  0.2347  memory: 83.85GiB(59.97%)  tps: 24,640
[rank0]:2025-10-29 02:03:17,451 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0203_stage0_step2200.svg
[rank2]:2025-10-29 02:03:17,447 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0203_stage2_step2200.svg
[rank1]:2025-10-29 02:03:17,447 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0203_stage1_step2200.svg
[rank0]:2025-10-29 02:03:17,547 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.3563 / Avg. batch time: 523.0181 (ms) / GPU bubble ratio: 68.42%
[rank3]:2025-10-29 02:03:17,568 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0203_real_step2200_rank3.svg
[rank3]:> Batch Time: 374.88 ms, GPU Bubble Ratio: 64.78%, 23.66%, 32.89%, 23.82%
[rank3]:2025-10-29 02:03:17,632 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0203_stage3_step2200.svg
[rank2]:2025-10-29 02:03:17,904 - INFO - Avg. fwd time: 15.0434 / Avg. bwd time: 18.5324 / Avg. batch time: 462.2936 (ms) / GPU bubble ratio: 41.90%
[rank3]:2025-10-29 02:03:17,884 - INFO - Avg. fwd time: 16.6145 / Avg. bwd time: 21.6970 / Avg. batch time: 321.8930 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 02:03:17,930 - INFO - Avg. fwd time: 17.2012 / Avg. bwd time: 20.9172 / Avg. batch time: 501.5683 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 02:03:33,333 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:03:33,332 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:03:33,332 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:39,009 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:03:54,540 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:03:54,539 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:03:54,539 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:03:59,597 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:15,199 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:15,198 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:15,198 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:04:20,237 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:35,884 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:35,883 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:35,883 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:04:40,953 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:54,929 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:04:56,494 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 64.67GiB(46.25%)  tps: 8,262  tflops: 385.34  mfu: 38.96%
[rank0]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:04:56,495 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 66.72GiB(47.72%)  tps: 8,257  tflops: 385.12  mfu: 38.94%
[rank1]:2025-10-29 02:04:56,494 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:04:56,494 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0008  memory: 72.68GiB(51.98%)  tps: 8,260  tflops: 385.27  mfu: 38.96%
[rank3]:2025-10-29 02:05:01,537 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:01,542 - INFO -  step: 2250  loss:  0.1395  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,864  tflops: 366.77  mfu: 37.08%
[rank2]:2025-10-29 02:05:01,889 - INFO - Avg. fwd time: 15.0453 / Avg. bwd time: 18.4779 / Avg. batch time: 462.0968 (ms) / GPU bubble ratio: 41.96%
[rank3]:2025-10-29 02:05:01,860 - INFO - Avg. fwd time: 16.6157 / Avg. bwd time: 21.6296 / Avg. batch time: 321.3583 (ms) / GPU bubble ratio: 4.79%
[rank0]:2025-10-29 02:05:01,935 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.2577 / Avg. batch time: 522.6588 (ms) / GPU bubble ratio: 68.55%
[rank1]:2025-10-29 02:05:01,921 - INFO - Avg. fwd time: 17.2039 / Avg. bwd time: 20.8565 / Avg. batch time: 501.3118 (ms) / GPU bubble ratio: 39.26%
[rank0]:2025-10-29 02:05:17,221 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:17,220 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:17,220 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:22,315 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:05:37,889 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:05:43,003 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:05:58,536 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:05:58,536 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:05:58,537 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:03,614 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:06:19,263 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:19,264 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:06:19,263 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:24,495 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:38,418 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:06:39,984 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank0]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:06:39,985 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank1]:2025-10-29 02:06:39,984 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:06:39,984 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,916  tflops: 369.19  mfu: 37.33%
[rank3]:2025-10-29 02:06:45,122 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:06:45,127 - INFO -  step: 2300  loss:  0.0946  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,909  tflops: 368.86  mfu: 37.30%
[rank0]:2025-10-29 02:06:45,212 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0206_stage0_step2300.svg
[rank1]:2025-10-29 02:06:45,210 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0206_stage1_step2300.svg
[rank2]:2025-10-29 02:06:45,211 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0206_stage2_step2300.svg
[rank3]:2025-10-29 02:06:45,324 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0206_real_step2300_rank3.svg
[rank3]:> Batch Time: 374.71 ms, GPU Bubble Ratio: 64.78%, 23.64%, 32.88%, 23.84%
[rank0]:2025-10-29 02:06:45,304 - INFO - Avg. fwd time: 15.2869 / Avg. bwd time: 5.1768 / Avg. batch time: 522.1612 (ms) / GPU bubble ratio: 68.65%
[rank3]:2025-10-29 02:06:45,386 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0206_stage3_step2300.svg
[rank2]:2025-10-29 02:06:45,657 - INFO - Avg. fwd time: 15.0469 / Avg. bwd time: 18.4327 / Avg. batch time: 461.7354 (ms) / GPU bubble ratio: 41.99%
[rank3]:2025-10-29 02:06:45,635 - INFO - Avg. fwd time: 16.6164 / Avg. bwd time: 21.5737 / Avg. batch time: 320.9134 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 02:06:45,683 - INFO - Avg. fwd time: 17.2061 / Avg. bwd time: 20.8058 / Avg. batch time: 500.8995 (ms) / GPU bubble ratio: 39.29%
[rank1]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:00,963 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:06,120 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:07:21,725 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:26,860 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:07:42,354 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:07:42,353 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:07:42,353 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:07:47,518 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:03,134 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:08:03,134 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:03,135 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:08:08,259 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:22,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:08:23,833 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:23,833 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 72.68GiB(51.98%)  tps: 7,888  tflops: 367.91  mfu: 37.20%
[rank2]:2025-10-29 02:08:23,833 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:08:23,833 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 64.67GiB(46.25%)  tps: 7,888  tflops: 367.91  mfu: 37.20%
[rank0]:2025-10-29 02:08:23,834 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:23,834 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0004  memory: 66.72GiB(47.72%)  tps: 7,888  tflops: 367.92  mfu: 37.20%
[rank3]:2025-10-29 02:08:28,935 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:08:28,941 - INFO -  step: 2350  loss:  0.1287  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,891  tflops: 368.05  mfu: 37.21%
[rank2]:2025-10-29 02:08:29,389 - INFO - Avg. fwd time: 15.0485 / Avg. bwd time: 18.3823 / Avg. batch time: 460.9888 (ms) / GPU bubble ratio: 41.98%
[rank3]:2025-10-29 02:08:29,343 - INFO - Avg. fwd time: 16.6171 / Avg. bwd time: 21.5113 / Avg. batch time: 320.4153 (ms) / GPU bubble ratio: 4.80%
[rank1]:2025-10-29 02:08:29,437 - INFO - Avg. fwd time: 17.2085 / Avg. bwd time: 20.7494 / Avg. batch time: 500.0973 (ms) / GPU bubble ratio: 39.28%
[rank0]:2025-10-29 02:08:29,468 - INFO - Avg. fwd time: 15.2868 / Avg. bwd time: 5.0863 / Avg. batch time: 521.2630 (ms) / GPU bubble ratio: 68.73%
[rank2]:2025-10-29 02:08:54,886 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:08:54,893 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:08:54,889 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:00,000 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:15,666 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:15,665 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:15,665 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:20,795 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:36,292 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:36,292 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:36,293 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:09:41,420 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:09:56,978 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:10:02,111 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:10:16,140 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage1] 0.99, Threshold: 5.0000e-02
[rank1]:2025-10-29 02:10:17,720 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 72.68GiB(51.98%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank1]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,694  tflops: 358.85  mfu: 35.22%
[rank1]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage2] 0.99, Threshold: 5.0000e-02
[rank2]:2025-10-29 02:10:17,720 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 64.67GiB(46.25%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank2]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,695  tflops: 358.87  mfu: 35.22%
[rank2]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:10:17,720 - INFO - Freezing Ratio: [Stage0] 0.99, Threshold: 5.0000e-02
[rank0]:2025-10-29 02:10:17,721 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0005  memory: 66.72GiB(47.72%)  tps: 7,193  tflops: 335.49  mfu: 33.92%
[rank0]:2025-10-29 02:10:17,721 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0005  tps: 7,693  tflops: 358.82  mfu: 35.22%
[rank0]:2025-10-29 02:10:17,721 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 02:10:22,859 - INFO - Freezing Ratio: [Stage3] 1.00, Threshold: 5.0000e-02
[rank3]:2025-10-29 02:10:22,869 - INFO -  step: 2400  loss:  0.1134  grad_norm:  0.0000  memory: 83.85GiB(59.97%)  tps: 7,191  tflops: 335.37  mfu: 33.91%
[rank3]:2025-10-29 02:10:22,870 - INFO -  final step: 2400  loss:  0.1134  grad_norm:  0.0000  tps: 7,612  tflops: 355.01  mfu: 34.83%
[rank3]:2025-10-29 02:10:22,870 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 02:10:39,420 - INFO - validate step: 2400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 18,877
[rank0]:2025-10-29 02:10:39,420 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:10:39,424 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 02:10:39,458 - INFO - validate step: 2400  loss: -1.0000  memory: 72.68GiB(51.98%)  tps: 18,843
[rank1]:2025-10-29 02:10:39,460 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 02:10:39,467 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 02:10:39,474 - INFO - validate step: 2400  loss: -1.0000  memory: 64.67GiB(46.25%)  tps: 18,829
[rank2]:2025-10-29 02:10:39,475 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:10:39,478 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 02:10:39,498 - INFO - validate step: 2400  loss:  0.2336  memory: 83.85GiB(59.97%)  tps: 24,634
[rank3]:2025-10-29 02:10:39,499 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 02:10:39,502 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 02:10:49,767 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 02:10:49,859 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank1/251029_0210_stage1_final2400.svg
[rank2]:2025-10-29 02:10:49,857 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank2/251029_0210_stage2_final2400.svg
[rank0]:2025-10-29 02:10:49,885 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank0/251029_0210_stage0_final2400.svg
[rank3]:2025-10-29 02:10:49,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0210_real_final2400_rank3.svg
[rank3]:> Batch Time: 374.49 ms, GPU Bubble Ratio: 64.79%, 23.62%, 32.87%, 23.83%
[rank2]:2025-10-29 02:10:50,094 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank2_stage2.svg
[rank2]:	> Counts Sum: 15266, Total Sum: 16920 (90.22%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank2]:2025-10-29 02:10:50,094 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 02:10:50,112 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank1_stage1.svg
[rank1]:	> Counts Sum: 17201, Total Sum: 19035 (90.37%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank1]:2025-10-29 02:10:50,112 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 02:10:50,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/pipeline_schedule/251029_0210_thry_final2400_rank3.svg
[rank3]:> Batch Time: 533.61 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 02:10:50,235 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/freeze_ratio_history/rank3/251029_0210_stage3_final2400.svg
[rank0]:2025-10-29 02:10:50,285 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank0_stage0.svg
[rank0]:	> Counts Sum: 15481, Total Sum: 17155 (90.24%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 0.42]
[rank0]:2025-10-29 02:10:50,285 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 02:10:50,467 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1/frozen_params_histogram/251029_0210_rank3_stage3.svg
[rank3]:	> Counts Sum: 13975, Total Sum: 15275 (91.49%), Ratio(%) per element: [91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48, 91.48]
[rank3]:2025-10-29 02:10:50,468 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–„â–â–ƒâ–„â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–‚â–â–„â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–„â–ˆâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–„â–ˆâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.15249
[rank3]:wandb:               final/avg_loss 0.11336
[rank3]:wandb:             final/avg_mfu(%) 34.82821
[rank3]:wandb:             final/avg_tflops 355.00774
[rank3]:wandb:    final/avg_throughput(tps) 7611.63209
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.11336
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.11336
[rank3]:wandb: loss_metrics/global_max_loss 0.11336
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_apf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/em62i16u
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_apf_dm1/20251029-0039/wandb/run-20251029_003928-em62i16u/logs
[rank0]:2025-10-29 02:10:52,285 - INFO - Training completed
[rank0]:2025-10-29 02:10:52,286 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 02:10:52,534 - INFO - Process group destroyed
[rank1]:2025-10-29 02:10:52,496 - INFO - Process group destroyed
[rank2]:2025-10-29 02:10:52,542 - INFO - Process group destroyed
[rank3]:2025-10-29 02:10:52,602 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.5', 'layers.3', 'tok_embeddings', 'layers.2', 'layers.4', 'layers.6', 'layers.7', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.23', 'layers.22', 'layers.24', 'layers.17', 'layers.19', 'layers.18', 'layers.20'}
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.12', 'layers.13', 'layers.16', 'layers.14', 'layers.9', 'layers.8', 'layers.15', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'output', 'norm', 'layers.26', 'layers.28', 'layers.27', 'layers.31', 'layers.30', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_apf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_apf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_apf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_apf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_apf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_apf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_apf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_apf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 02:11:02 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] 
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] *****************************************
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 02:11:03.480000 1433265 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-29 02:11:09,308 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 02:11:09,459 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 02:11:09,510 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 02:11:09,501 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 02:11:10,261 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 02:11:10,263 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:10,536 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 02:11:10,539 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:10,544 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-29 02:11:10,541 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 02:11:10,544 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 02:11:10,517 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 02:11:10,519 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 02:11:12,472 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 02:11:12,762 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 02:11:14,298 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 02:11:15,685 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-29 02:11:15,962 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 02:11:15,931 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:11:16,016 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 02:11:16,040 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 02:11:16,040 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 02:11:16,015 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 02:11:16,015 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 02:11:16,338 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 02:11:16,303 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 02:11:16,303 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 02:11:16,286 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 02:11:16,287 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 02:11:16,416 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 02:11:16,416 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 02:11:16,628 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 02:11:16,628 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run zn6bleq8
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1/20251029-0211/wandb/run-20251029_021116-zn6bleq8
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/zn6bleq8
[rank3]:2025-10-29 02:11:17,843 - INFO - WandB logging enabled
[rank3]:2025-10-29 02:11:17,846 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 02:11:17,920 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 02:11:17,921 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-29 02:11:18,269 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 02:11:18,270 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-10-29 02:11:18,286 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank0]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:11:18,287 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-29 02:11:18,286 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 02:11:22,191 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 02:11:22,191 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 02:11:31,708 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 02:11:31,709 - INFO - Finished loading the checkpoint in 9.52 seconds.
[rank0]:2025-10-29 02:11:31,709 - INFO - Training starts at step 1
[rank3]:2025-10-29 02:11:36,590 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.4601  memory: 58.03GiB(41.50%)  tps: 876  tflops: 40.88  mfu: 4.13%
[rank3]:2025-10-29 02:11:36,590 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 02:11:36,585 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 44.28GiB(31.67%)  tps: 795  tflops: 37.09  mfu: 3.75%
[rank2]:2025-10-29 02:11:36,586 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 02:11:36,588 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 49.69GiB(35.54%)  tps: 811  tflops: 37.84  mfu: 3.83%
[rank1]:2025-10-29 02:11:36,588 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 02:11:36,608 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.4601  memory: 49.75GiB(35.58%)  tps: 796  tflops: 37.11  mfu: 3.75%
[rank0]:2025-10-29 02:11:36,609 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 02:11:54,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,970 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,971 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,972 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,973 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,974 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 02:11:54,975 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,013 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,013 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,059 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,060 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,014 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,061 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,102 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 02:11:55,062 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,015 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 02:11:55,016 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,103 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,104 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:11:55,105 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 02:13:46,437 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:13:49,168 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 57.29GiB(40.97%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank3]:2025-10-29 02:13:49,173 - INFO -  step: 50  loss:  3.2742  grad_norm: 16.2025  memory: 73.38GiB(52.48%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank0]:2025-10-29 02:13:49,175 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 66.72GiB(47.72%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank1]:2025-10-29 02:13:49,170 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.2025  memory: 64.32GiB(46.00%)  tps: 6,055  tflops: 282.42  mfu: 28.56%
[rank2]:2025-10-29 02:13:49,687 - INFO - Avg. fwd time: 13.3889 / Avg. bwd time: 36.5073 / Avg. batch time: 537.9116 (ms) / GPU bubble ratio: 25.79%
[rank3]:2025-10-29 02:13:49,636 - INFO - Avg. fwd time: 14.8073 / Avg. bwd time: 43.1226 / Avg. batch time: 484.7709 (ms) / GPU bubble ratio: 4.40%
[rank0]:2025-10-29 02:13:49,766 - INFO - Avg. fwd time: 14.2094 / Avg. bwd time: 38.1518 / Avg. batch time: 653.1204 (ms) / GPU bubble ratio: 35.86%
[rank1]:2025-10-29 02:13:49,733 - INFO - Avg. fwd time: 15.1821 / Avg. bwd time: 40.9727 / Avg. batch time: 597.7095 (ms) / GPU bubble ratio: 24.84%
[rank0]:2025-10-29 02:14:16,248 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-29 02:14:16,240 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 02:14:16,244 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-29 02:14:16,244 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-29 02:14:43,356 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.7274e+02
[rank0]:2025-10-29 02:14:43,360 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.5840e+02
[rank2]:2025-10-29 02:14:43,352 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.8365e+02
[rank1]:2025-10-29 02:14:43,355 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7263e+02
[rank3]:2025-10-29 02:15:09,338 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 9.7156e-01
[rank1]:2025-10-29 02:15:09,325 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9982e-01
[rank0]:2025-10-29 02:15:09,336 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0424e+00
[rank2]:2025-10-29 02:15:09,325 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 7.1885e-01
[rank1]:2025-10-29 02:15:35,971 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2171e+00
[rank3]:2025-10-29 02:15:35,965 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.5224e+00
[rank0]:2025-10-29 02:15:35,975 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.0942e+00
[rank2]:2025-10-29 02:15:35,968 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.2875e+00
[rank0]:2025-10-29 02:15:59,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:16:01,997 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1782e+00
[rank0]:2025-10-29 02:16:01,998 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 68.59GiB(49.06%)  tps: 6,168  tflops: 287.66  mfu: 29.09%
[rank1]:2025-10-29 02:16:01,987 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7484e+00
[rank1]:2025-10-29 02:16:01,987 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 68.17GiB(48.76%)  tps: 6,168  tflops: 287.67  mfu: 29.09%
[rank3]:2025-10-29 02:16:01,999 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.3997e+00
[rank3]:2025-10-29 02:16:02,002 - INFO -  step: 100  loss:  1.3475  grad_norm: 11.1621  memory: 75.33GiB(53.88%)  tps: 6,167  tflops: 287.65  mfu: 29.08%
[rank2]:2025-10-29 02:16:01,987 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.2081e+00
[rank2]:2025-10-29 02:16:01,987 - INFO -  step: 100  loss: -4.0000  grad_norm: 11.1621  memory: 60.18GiB(43.04%)  tps: 6,168  tflops: 287.67  mfu: 29.09%
[rank0]:2025-10-29 02:16:02,079 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0216_stage0_step100.svg
[rank1]:2025-10-29 02:16:02,082 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0216_stage1_step100.svg
[rank2]:2025-10-29 02:16:02,083 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0216_stage2_step100.svg
[rank3]:2025-10-29 02:16:02,192 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0216_real_step100_rank3.svg
[rank3]:> Batch Time: 632.94 ms, GPU Bubble Ratio: 33.81%, 28.27%, 36.50%, 26.23%
[rank3]:2025-10-29 02:16:02,249 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0216_stage3_step100.svg
[rank3]:2025-10-29 02:16:02,607 - INFO - Avg. fwd time: 14.9305 / Avg. bwd time: 42.7448 / Avg. batch time: 479.5341 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-10-29 02:16:02,674 - INFO - Avg. fwd time: 13.5880 / Avg. bwd time: 35.1947 / Avg. batch time: 531.2047 (ms) / GPU bubble ratio: 26.53%
[rank0]:2025-10-29 02:16:02,774 - INFO - Avg. fwd time: 14.1350 / Avg. bwd time: 37.3297 / Avg. batch time: 645.9271 (ms) / GPU bubble ratio: 36.26%
[rank1]:2025-10-29 02:16:02,742 - INFO - Avg. fwd time: 15.4828 / Avg. bwd time: 39.2713 / Avg. batch time: 591.5368 (ms) / GPU bubble ratio: 25.95%
[rank0]:2025-10-29 02:16:28,723 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.3170e+00
[rank3]:2025-10-29 02:16:28,709 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 5.2520e+00
[rank1]:2025-10-29 02:16:28,719 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.8909e-01
[rank2]:2025-10-29 02:16:28,716 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.4083e+00
[rank0]:2025-10-29 02:16:54,738 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.1622e+00
[rank1]:2025-10-29 02:16:54,728 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7047e+00
[rank3]:2025-10-29 02:16:54,740 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.8783e+00
[rank2]:2025-10-29 02:16:54,728 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 4.0175e+00
[rank0]:2025-10-29 02:17:21,260 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 1.7555e+02
[rank1]:2025-10-29 02:17:21,256 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6905e+02
[rank3]:2025-10-29 02:17:21,247 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.2898e+02
[rank2]:2025-10-29 02:17:21,253 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.5757e+02
[rank0]:2025-10-29 02:17:45,052 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.7739e+00
[rank3]:2025-10-29 02:17:45,044 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 8.4225e+00
[rank1]:2025-10-29 02:17:45,041 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 8.7504e+00
[rank2]:2025-10-29 02:17:45,041 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.7155e+00
[rank0]:2025-10-29 02:18:08,944 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:18:11,634 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.4622e+02
[rank0]:2025-10-29 02:18:11,635 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 68.59GiB(49.06%)  tps: 6,319  tflops: 294.73  mfu: 29.80%
[rank3]:2025-10-29 02:18:11,621 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.9254e+02
[rank3]:2025-10-29 02:18:11,623 - INFO -  step: 150  loss:  0.9535  grad_norm:  0.7350  memory: 76.44GiB(54.68%)  tps: 6,320  tflops: 294.77  mfu: 29.80%
[rank1]:2025-10-29 02:18:11,630 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4972e+02
[rank1]:2025-10-29 02:18:11,631 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 68.17GiB(48.76%)  tps: 6,319  tflops: 294.71  mfu: 29.80%
[rank2]:2025-10-29 02:18:11,627 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 3.4392e+02
[rank2]:2025-10-29 02:18:11,627 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.7350  memory: 60.18GiB(43.04%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank3]:2025-10-29 02:18:12,129 - INFO - Avg. fwd time: 15.1329 / Avg. bwd time: 40.8857 / Avg. batch time: 465.2935 (ms) / GPU bubble ratio: 3.68%
[rank1]:2025-10-29 02:18:12,199 - INFO - Avg. fwd time: 15.6071 / Avg. bwd time: 38.4755 / Avg. batch time: 583.6389 (ms) / GPU bubble ratio: 25.87%
[rank2]:2025-10-29 02:18:12,163 - INFO - Avg. fwd time: 13.6565 / Avg. bwd time: 34.6350 / Avg. batch time: 519.1640 (ms) / GPU bubble ratio: 25.59%
[rank0]:2025-10-29 02:18:12,237 - INFO - Avg. fwd time: 14.1292 / Avg. bwd time: 36.9470 / Avg. batch time: 637.6037 (ms) / GPU bubble ratio: 35.91%
[rank3]:2025-10-29 02:18:35,388 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4385e+00
[rank0]:2025-10-29 02:18:35,389 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4378e-01
[rank1]:2025-10-29 02:18:35,379 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.3687e-01
[rank2]:2025-10-29 02:18:35,379 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0430e+00
[rank3]:2025-10-29 02:19:02,002 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 6.7472e+00
[rank0]:2025-10-29 02:19:02,018 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 6.8663e+00
[rank1]:2025-10-29 02:19:02,014 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.3590e+00
[rank2]:2025-10-29 02:19:02,011 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 7.3637e+00
[rank3]:2025-10-29 02:19:25,708 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.1595e+01
[rank0]:2025-10-29 02:19:25,715 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.1918e+01
[rank2]:2025-10-29 02:19:25,705 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.0482e+01
[rank1]:2025-10-29 02:19:25,705 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5613e+01
[rank2]:2025-10-29 02:19:48,627 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 6.6895e-01
[rank3]:2025-10-29 02:19:48,630 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.5057e+00
[rank0]:2025-10-29 02:19:48,641 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 2.8047e+00
[rank1]:2025-10-29 02:19:48,624 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0030e+00
[rank0]:2025-10-29 02:20:10,072 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:20:12,465 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.1339e+00
[rank3]:2025-10-29 02:20:12,467 - INFO -  step: 200  loss:  0.9658  grad_norm: 22.3585  memory: 77.56GiB(55.47%)  tps: 6,779  tflops: 316.18  mfu: 31.97%
[rank3]:2025-10-29 02:20:12,467 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 02:20:12,461 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.2860e+00
[rank2]:2025-10-29 02:20:12,462 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 61.15GiB(43.74%)  tps: 6,780  tflops: 316.20  mfu: 31.97%
[rank2]:2025-10-29 02:20:12,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:20:12,472 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.5390e+00
[rank0]:2025-10-29 02:20:12,472 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 68.59GiB(49.06%)  tps: 6,779  tflops: 316.19  mfu: 31.97%
[rank0]:2025-10-29 02:20:12,473 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 02:20:12,461 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.4459e+00
[rank1]:2025-10-29 02:20:12,462 - INFO -  step: 200  loss: -4.0000  grad_norm: 22.3585  memory: 70.12GiB(50.15%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank1]:2025-10-29 02:20:12,462 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 02:20:30,374 - INFO - validate step: 200  loss: -1.0000  memory: 68.59GiB(49.06%)  tps: 22,881
[rank2]:2025-10-29 02:20:30,423 - INFO - validate step: 200  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 22,806
[rank1]:2025-10-29 02:20:30,408 - INFO - validate step: 200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 22,824
[rank3]:2025-10-29 02:20:30,434 - INFO - validate step: 200  loss:  0.2701  memory: 77.56GiB(55.47%)  tps: 22,798
[rank0]:2025-10-29 02:20:30,515 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0220_stage0_step200.svg
[rank2]:2025-10-29 02:20:30,510 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0220_stage2_step200.svg
[rank1]:2025-10-29 02:20:30,515 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0220_stage1_step200.svg
[rank3]:2025-10-29 02:20:30,618 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0220_real_step200_rank3.svg
[rank3]:> Batch Time: 625.57 ms, GPU Bubble Ratio: 33.78%, 28.23%, 36.49%, 26.48%
[rank3]:2025-10-29 02:20:30,684 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0220_stage3_step200.svg
[rank3]:2025-10-29 02:20:31,024 - INFO - Avg. fwd time: 15.2802 / Avg. bwd time: 39.3765 / Avg. batch time: 453.9706 (ms) / GPU bubble ratio: 3.68%
[rank0]:2025-10-29 02:20:31,118 - INFO - Avg. fwd time: 14.1713 / Avg. bwd time: 36.4104 / Avg. batch time: 624.2830 (ms) / GPU bubble ratio: 35.18%
[rank2]:2025-10-29 02:20:31,059 - INFO - Avg. fwd time: 13.7691 / Avg. bwd time: 33.6257 / Avg. batch time: 507.7970 (ms) / GPU bubble ratio: 25.33%
[rank1]:2025-10-29 02:20:31,087 - INFO - Avg. fwd time: 15.7774 / Avg. bwd time: 37.0231 / Avg. batch time: 570.5100 (ms) / GPU bubble ratio: 25.96%
[rank3]:2025-10-29 02:20:53,129 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.4015e+01
[rank2]:2025-10-29 02:20:53,125 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2800e+02
[rank0]:2025-10-29 02:20:53,136 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4562e+02
[rank1]:2025-10-29 02:20:53,122 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4512e+02
[rank2]:2025-10-29 02:21:14,824 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.8613e+00
[rank3]:2025-10-29 02:21:14,824 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.7315e+00
[rank0]:2025-10-29 02:21:14,831 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.6808e+00
[rank1]:2025-10-29 02:21:14,822 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5777e+00
[rank2]:2025-10-29 02:21:37,246 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8602e+00
[rank3]:2025-10-29 02:21:37,252 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9319e+00
[rank0]:2025-10-29 02:21:37,259 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4539e+00
[rank1]:2025-10-29 02:21:37,242 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1790e+00
[rank2]:2025-10-29 02:21:58,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2830e-01
[rank3]:2025-10-29 02:21:58,815 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 8.3866e-01
[rank1]:2025-10-29 02:21:58,812 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5958e-01
[rank0]:2025-10-29 02:21:58,819 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.9544e-01
[rank0]:2025-10-29 02:22:18,960 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:22:21,197 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3003e+00
[rank2]:2025-10-29 02:22:21,197 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 63.09GiB(45.12%)  tps: 7,395  tflops: 344.92  mfu: 34.88%
[rank3]:2025-10-29 02:22:21,207 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.0452e+00
[rank3]:2025-10-29 02:22:21,209 - INFO -  step: 250  loss:  0.9395  grad_norm:  1.6791  memory: 78.44GiB(56.10%)  tps: 7,395  tflops: 344.92  mfu: 34.88%
[rank1]:2025-10-29 02:22:21,197 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6224e+00
[rank1]:2025-10-29 02:22:21,197 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 71.10GiB(50.85%)  tps: 7,394  tflops: 344.87  mfu: 34.87%
[rank0]:2025-10-29 02:22:21,214 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.2150e+00
[rank0]:2025-10-29 02:22:21,214 - INFO -  step: 250  loss: -4.0000  grad_norm:  1.6791  memory: 71.50GiB(51.14%)  tps: 7,391  tflops: 344.71  mfu: 34.85%
[rank3]:2025-10-29 02:22:21,589 - INFO - Avg. fwd time: 15.4396 / Avg. bwd time: 37.8722 / Avg. batch time: 442.9131 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-29 02:22:21,627 - INFO - Avg. fwd time: 13.9437 / Avg. bwd time: 31.8916 / Avg. batch time: 494.2708 (ms) / GPU bubble ratio: 25.81%
[rank1]:2025-10-29 02:22:21,655 - INFO - Avg. fwd time: 16.0571 / Avg. bwd time: 34.5664 / Avg. batch time: 552.9048 (ms) / GPU bubble ratio: 26.75%
[rank0]:2025-10-29 02:22:21,675 - INFO - Avg. fwd time: 14.3236 / Avg. bwd time: 34.9814 / Avg. batch time: 605.1592 (ms) / GPU bubble ratio: 34.82%
[rank3]:2025-10-29 02:22:42,815 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.0625e+00
[rank0]:2025-10-29 02:22:42,819 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.8112e+00
[rank2]:2025-10-29 02:22:42,815 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3229e+00
[rank1]:2025-10-29 02:22:42,812 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.2947e+00
[rank0]:2025-10-29 02:23:05,115 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.2581e-01
[rank2]:2025-10-29 02:23:05,098 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.2533e-01
[rank3]:2025-10-29 02:23:05,108 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1378e-01
[rank1]:2025-10-29 02:23:05,098 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.6581e-01
[rank2]:2025-10-29 02:23:26,767 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0250e-01
[rank3]:2025-10-29 02:23:26,767 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.7917e-01
[rank1]:2025-10-29 02:23:26,764 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.1507e-01
[rank0]:2025-10-29 02:23:26,771 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0972e-01
[rank2]:2025-10-29 02:23:49,013 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.1638e-01
[rank3]:2025-10-29 02:23:49,022 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.8524e-01
[rank0]:2025-10-29 02:23:49,029 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.1498e-01
[rank1]:2025-10-29 02:23:49,012 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.0781e-01
[rank0]:2025-10-29 02:24:08,451 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:24:10,612 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.6271e-01
[rank0]:2025-10-29 02:24:10,613 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 71.50GiB(51.14%)  tps: 7,488  tflops: 349.25  mfu: 35.31%
[rank0]:2025-10-29 02:24:10,685 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0224_stage0_step300.svg
[rank1]:2025-10-29 02:24:10,605 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.8337e-01
[rank1]:2025-10-29 02:24:10,606 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 71.10GiB(50.85%)  tps: 7,488  tflops: 349.22  mfu: 35.31%
[rank1]:2025-10-29 02:24:10,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0224_stage1_step300.svg
[rank3]:2025-10-29 02:24:10,608 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.6101e-01
[rank3]:2025-10-29 02:24:10,611 - INFO -  step: 300  loss:  0.8594  grad_norm:  1.0256  memory: 78.44GiB(56.10%)  tps: 7,488  tflops: 349.25  mfu: 35.31%
[rank2]:2025-10-29 02:24:10,608 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4709e-01
[rank2]:2025-10-29 02:24:10,609 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.0256  memory: 63.09GiB(45.12%)  tps: 7,487  tflops: 349.21  mfu: 35.31%
[rank2]:2025-10-29 02:24:10,691 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0224_stage2_step300.svg
[rank3]:2025-10-29 02:24:10,792 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0224_real_step300_rank3.svg
[rank3]:> Batch Time: 556.19 ms, GPU Bubble Ratio: 31.00%, 31.81%, 37.82%, 26.28%
[rank3]:2025-10-29 02:24:10,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0224_stage3_step300.svg
[rank3]:2025-10-29 02:24:11,295 - INFO - Avg. fwd time: 15.5611 / Avg. bwd time: 36.7702 / Avg. batch time: 434.8807 (ms) / GPU bubble ratio: 3.73%
[rank0]:2025-10-29 02:24:11,386 - INFO - Avg. fwd time: 14.4432 / Avg. bwd time: 33.7504 / Avg. batch time: 591.2458 (ms) / GPU bubble ratio: 34.79%
[rank1]:2025-10-29 02:24:11,350 - INFO - Avg. fwd time: 16.2492 / Avg. bwd time: 32.8442 / Avg. batch time: 540.2995 (ms) / GPU bubble ratio: 27.31%
[rank2]:2025-10-29 02:24:11,322 - INFO - Avg. fwd time: 14.0778 / Avg. bwd time: 30.5568 / Avg. batch time: 484.4423 (ms) / GPU bubble ratio: 26.29%
[rank0]:2025-10-29 02:24:33,159 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5250e-01
[rank2]:2025-10-29 02:24:33,142 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7319e-01
[rank1]:2025-10-29 02:24:33,142 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5486e-01
[rank3]:2025-10-29 02:24:33,152 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5044e+00
[rank1]:2025-10-29 02:24:54,700 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.0452e-01
[rank2]:2025-10-29 02:24:54,703 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9386e-01
[rank3]:2025-10-29 02:24:54,703 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6029e+00
[rank0]:2025-10-29 02:24:54,707 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8229e-01
[rank1]:2025-10-29 02:25:16,994 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4364e+00
[rank2]:2025-10-29 02:25:16,994 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5397e+00
[rank3]:2025-10-29 02:25:17,004 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3339e+00
[rank0]:2025-10-29 02:25:17,011 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9302e+00
[rank2]:2025-10-29 02:25:38,606 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4230e+00
[rank1]:2025-10-29 02:25:38,602 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.8924e+00
[rank3]:2025-10-29 02:25:38,606 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.6484e+00
[rank0]:2025-10-29 02:25:38,610 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.2789e+00
[rank0]:2025-10-29 02:25:58,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:26:00,868 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9796e-01
[rank2]:2025-10-29 02:26:00,869 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 63.09GiB(45.12%)  tps: 7,430  tflops: 346.52  mfu: 35.04%
[rank1]:2025-10-29 02:26:00,868 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2538e-01
[rank1]:2025-10-29 02:26:00,869 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 71.10GiB(50.85%)  tps: 7,430  tflops: 346.52  mfu: 35.04%
[rank3]:2025-10-29 02:26:00,878 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.7506e-01
[rank3]:2025-10-29 02:26:00,881 - INFO -  step: 350  loss:  0.8901  grad_norm:  0.4211  memory: 78.44GiB(56.10%)  tps: 7,429  tflops: 346.50  mfu: 35.03%
[rank0]:2025-10-29 02:26:00,885 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4457e-01
[rank0]:2025-10-29 02:26:00,886 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.4211  memory: 71.50GiB(51.14%)  tps: 7,429  tflops: 346.48  mfu: 35.03%
[rank3]:2025-10-29 02:26:01,268 - INFO - Avg. fwd time: 15.6320 / Avg. bwd time: 36.1363 / Avg. batch time: 430.2635 (ms) / GPU bubble ratio: 3.75%
[rank1]:2025-10-29 02:26:01,334 - INFO - Avg. fwd time: 16.3753 / Avg. bwd time: 31.7416 / Avg. batch time: 532.6477 (ms) / GPU bubble ratio: 27.73%
[rank0]:2025-10-29 02:26:01,355 - INFO - Avg. fwd time: 14.5119 / Avg. bwd time: 33.0805 / Avg. batch time: 582.8811 (ms) / GPU bubble ratio: 34.68%
[rank2]:2025-10-29 02:26:01,307 - INFO - Avg. fwd time: 14.1723 / Avg. bwd time: 29.6481 / Avg. batch time: 478.5461 (ms) / GPU bubble ratio: 26.74%
[rank2]:2025-10-29 02:26:22,523 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1007e-01
[rank1]:2025-10-29 02:26:22,520 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.6426e-01
[rank3]:2025-10-29 02:26:22,523 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0780e+00
[rank0]:2025-10-29 02:26:22,527 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1304e+00
[rank1]:2025-10-29 02:26:44,775 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5026e+00
[rank0]:2025-10-29 02:26:44,792 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2011e+00
[rank3]:2025-10-29 02:26:44,785 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.9115e-01
[rank2]:2025-10-29 02:26:44,775 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.7358e-01
[rank0]:2025-10-29 02:27:06,369 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.9842e-01
[rank1]:2025-10-29 02:27:06,362 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.0662e-01
[rank3]:2025-10-29 02:27:06,366 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.5567e-01
[rank2]:2025-10-29 02:27:06,366 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9835e-01
[rank2]:2025-10-29 02:27:28,470 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2580e+00
[rank1]:2025-10-29 02:27:28,470 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.0987e+00
[rank3]:2025-10-29 02:27:28,480 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7530e+00
[rank0]:2025-10-29 02:27:28,487 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.2740e+00
[rank0]:2025-10-29 02:27:46,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:27:48,985 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.3665e+00
[rank2]:2025-10-29 02:27:48,985 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3778e+00
[rank2]:2025-10-29 02:27:48,985 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 63.09GiB(45.12%)  tps: 7,577  tflops: 353.40  mfu: 35.73%
[rank2]:2025-10-29 02:27:48,985 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 02:27:48,981 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.6782e+00
[rank1]:2025-10-29 02:27:48,982 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 71.10GiB(50.85%)  tps: 7,577  tflops: 353.40  mfu: 35.73%
[rank1]:2025-10-29 02:27:48,982 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 02:27:48,989 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3257e+00
[rank0]:2025-10-29 02:27:48,989 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2912  memory: 71.50GiB(51.14%)  tps: 7,578  tflops: 353.44  mfu: 35.74%
[rank0]:2025-10-29 02:27:48,989 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:27:48,987 - INFO -  step: 400  loss:  0.1203  grad_norm:  0.2912  memory: 78.44GiB(56.10%)  tps: 7,578  tflops: 353.43  mfu: 35.74%
[rank3]:2025-10-29 02:27:48,987 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 02:28:05,372 - INFO - validate step: 400  loss:  0.2434  memory: 78.44GiB(56.10%)  tps: 24,999
[rank0]:2025-10-29 02:28:05,313 - INFO - validate step: 400  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 25,093
[rank1]:2025-10-29 02:28:05,346 - INFO - validate step: 400  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,030
[rank2]:2025-10-29 02:28:05,362 - INFO - validate step: 400  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,011
[rank0]:2025-10-29 02:28:05,456 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0228_stage0_step400.svg
[rank1]:2025-10-29 02:28:05,459 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0228_stage1_step400.svg
[rank2]:2025-10-29 02:28:05,454 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0228_stage2_step400.svg
[rank3]:2025-10-29 02:28:05,547 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0228_real_step400_rank3.svg
[rank3]:> Batch Time: 534.10 ms, GPU Bubble Ratio: 29.22%, 35.62%, 38.31%, 26.27%
[rank3]:2025-10-29 02:28:05,620 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0228_stage3_step400.svg
[rank3]:2025-10-29 02:28:05,940 - INFO - Avg. fwd time: 15.6728 / Avg. bwd time: 35.5221 / Avg. batch time: 425.5715 (ms) / GPU bubble ratio: 3.76%
[rank1]:2025-10-29 02:28:05,992 - INFO - Avg. fwd time: 16.4673 / Avg. bwd time: 30.7874 / Avg. batch time: 525.3271 (ms) / GPU bubble ratio: 28.04%
[rank2]:2025-10-29 02:28:05,965 - INFO - Avg. fwd time: 14.2338 / Avg. bwd time: 28.8938 / Avg. batch time: 472.7635 (ms) / GPU bubble ratio: 27.02%
[rank0]:2025-10-29 02:28:06,026 - INFO - Avg. fwd time: 14.5595 / Avg. bwd time: 32.4233 / Avg. batch time: 574.8486 (ms) / GPU bubble ratio: 34.62%
[rank3]:2025-10-29 02:28:26,706 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8239e+00
[rank2]:2025-10-29 02:28:26,696 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4885e+00
[rank0]:2025-10-29 02:28:26,713 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.7034e-01
[rank1]:2025-10-29 02:28:26,696 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8961e+00
[rank3]:2025-10-29 02:28:47,218 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7700e+00
[rank1]:2025-10-29 02:28:47,214 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.6504e-01
[rank0]:2025-10-29 02:28:47,222 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5535e-01
[rank2]:2025-10-29 02:28:47,217 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1188e-01
[rank3]:2025-10-29 02:29:08,381 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.6242e+00
[rank1]:2025-10-29 02:29:08,371 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3261e+00
[rank0]:2025-10-29 02:29:08,388 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8079e+00
[rank2]:2025-10-29 02:29:08,371 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7905e+00
[rank1]:2025-10-29 02:29:28,768 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1552e+00
[rank2]:2025-10-29 02:29:28,771 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1452e-01
[rank3]:2025-10-29 02:29:28,771 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6739e+00
[rank0]:2025-10-29 02:29:28,775 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.5055e+00
[rank0]:2025-10-29 02:29:47,941 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 02:29:50,053 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4796e-01
[rank2]:2025-10-29 02:29:50,054 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 63.09GiB(45.12%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank1]:2025-10-29 02:29:50,053 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.1092e-01
[rank1]:2025-10-29 02:29:50,054 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 71.10GiB(50.85%)  tps: 7,824  tflops: 364.90  mfu: 36.90%
[rank3]:2025-10-29 02:29:50,063 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.9792e+00
[rank3]:2025-10-29 02:29:50,067 - INFO -  step: 450  loss:  0.1183  grad_norm:  0.9298  memory: 78.44GiB(56.10%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank0]:2025-10-29 02:29:50,070 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0733e+00
[rank0]:2025-10-29 02:29:50,071 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.9298  memory: 71.50GiB(51.14%)  tps: 7,820  tflops: 364.72  mfu: 36.88%
[rank2]:2025-10-29 02:29:50,528 - INFO - Avg. fwd time: 14.2304 / Avg. bwd time: 28.2071 / Avg. batch time: 467.1057 (ms) / GPU bubble ratio: 27.32%
[rank1]:2025-10-29 02:29:50,559 - INFO - Avg. fwd time: 16.4744 / Avg. bwd time: 29.9775 / Avg. batch time: 518.3597 (ms) / GPU bubble ratio: 28.31%
[rank3]:2025-10-29 02:29:50,497 - INFO - Avg. fwd time: 15.6215 / Avg. bwd time: 34.9947 / Avg. batch time: 420.8459 (ms) / GPU bubble ratio: 3.78%
[rank0]:2025-10-29 02:29:50,589 - INFO - Avg. fwd time: 14.5295 / Avg. bwd time: 31.9390 / Avg. batch time: 567.3192 (ms) / GPU bubble ratio: 34.47%
[rank2]:2025-10-29 02:30:10,448 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3501e-01
[rank3]:2025-10-29 02:30:10,449 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2632e+00
[rank1]:2025-10-29 02:30:10,445 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4278e+00
[rank0]:2025-10-29 02:30:10,452 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9004e+00
[rank2]:2025-10-29 02:30:31,659 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0404e+00
[rank1]:2025-10-29 02:30:31,659 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.7987e-01
[rank3]:2025-10-29 02:30:31,669 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.0903e-01
[rank0]:2025-10-29 02:30:31,676 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9317e-01
[rank3]:2025-10-29 02:30:52,182 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.4115e+00
[rank1]:2025-10-29 02:30:52,179 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3109e+00
[rank0]:2025-10-29 02:30:52,186 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.1911e+00
[rank2]:2025-10-29 02:30:52,182 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1867e-01
[rank3]:2025-10-29 02:31:13,321 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9088e+00
[rank0]:2025-10-29 02:31:13,328 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.2141e-01
[rank1]:2025-10-29 02:31:13,311 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.0022e-01
[rank2]:2025-10-29 02:31:13,311 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5295e+00
[rank0]:2025-10-29 02:31:31,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:31:33,833 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.2900e+00
[rank3]:2025-10-29 02:31:33,837 - INFO -  step: 500  loss:  0.1230  grad_norm:  1.8859  memory: 78.44GiB(56.10%)  tps: 7,894  tflops: 368.20  mfu: 37.23%
[rank1]:2025-10-29 02:31:33,829 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.6676e+00
[rank1]:2025-10-29 02:31:33,830 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 71.10GiB(50.85%)  tps: 7,894  tflops: 368.18  mfu: 37.23%
[rank0]:2025-10-29 02:31:33,837 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.9781e+00
[rank0]:2025-10-29 02:31:33,837 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 71.50GiB(51.14%)  tps: 7,895  tflops: 368.21  mfu: 37.23%
[rank2]:2025-10-29 02:31:33,832 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7999e+00
[rank2]:2025-10-29 02:31:33,833 - INFO -  step: 500  loss: -4.0000  grad_norm:  1.8859  memory: 63.09GiB(45.12%)  tps: 7,894  tflops: 368.16  mfu: 37.23%
[rank1]:2025-10-29 02:31:33,918 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0231_stage1_step500.svg
[rank0]:2025-10-29 02:31:33,912 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0231_stage0_step500.svg
[rank2]:2025-10-29 02:31:33,912 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0231_stage2_step500.svg
[rank3]:2025-10-29 02:31:34,020 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0231_real_step500_rank3.svg
[rank3]:> Batch Time: 527.23 ms, GPU Bubble Ratio: 30.89%, 35.44%, 38.02%, 26.17%
[rank3]:2025-10-29 02:31:34,088 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0231_stage3_step500.svg
[rank3]:2025-10-29 02:31:34,404 - INFO - Avg. fwd time: 15.5880 / Avg. bwd time: 34.6009 / Avg. batch time: 417.3614 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-29 02:31:34,454 - INFO - Avg. fwd time: 16.4735 / Avg. bwd time: 29.4504 / Avg. batch time: 513.3677 (ms) / GPU bubble ratio: 28.44%
[rank2]:2025-10-29 02:31:34,428 - INFO - Avg. fwd time: 14.2197 / Avg. bwd time: 27.7938 / Avg. batch time: 462.9878 (ms) / GPU bubble ratio: 27.40%
[rank0]:2025-10-29 02:31:34,487 - INFO - Avg. fwd time: 14.5122 / Avg. bwd time: 31.5458 / Avg. batch time: 561.8761 (ms) / GPU bubble ratio: 34.42%
[rank0]:2025-10-29 02:31:55,217 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.9404e+00
[rank3]:2025-10-29 02:31:55,210 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.2362e+00
[rank1]:2025-10-29 02:31:55,200 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.2585e+00
[rank2]:2025-10-29 02:31:55,201 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.3308e+00
[rank0]:2025-10-29 02:32:15,659 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0209e-01
[rank3]:2025-10-29 02:32:15,655 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.7300e-01
[rank1]:2025-10-29 02:32:15,652 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1608e-01
[rank2]:2025-10-29 02:32:15,655 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2683e-01
[rank2]:2025-10-29 02:32:36,928 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7762e+00
[rank1]:2025-10-29 02:32:36,928 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8756e+00
[rank0]:2025-10-29 02:32:36,945 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.1214e+00
[rank3]:2025-10-29 02:32:36,938 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4257e+00
[rank1]:2025-10-29 02:32:57,289 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.9071e+00
[rank0]:2025-10-29 02:32:57,296 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.7621e+00
[rank3]:2025-10-29 02:32:57,293 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4725e+00
[rank2]:2025-10-29 02:32:57,292 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2540e+00
[rank0]:2025-10-29 02:33:16,386 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:33:18,505 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2683e+00
[rank3]:2025-10-29 02:33:18,508 - INFO -  step: 550  loss:  0.1337  grad_norm:  0.1283  memory: 78.44GiB(56.10%)  tps: 7,827  tflops: 365.03  mfu: 36.91%
[rank0]:2025-10-29 02:33:18,512 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.9260e-01
[rank0]:2025-10-29 02:33:18,512 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 71.50GiB(51.14%)  tps: 7,826  tflops: 365.01  mfu: 36.91%
[rank1]:2025-10-29 02:33:18,495 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8454e+00
[rank1]:2025-10-29 02:33:18,495 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 71.10GiB(50.85%)  tps: 7,827  tflops: 365.05  mfu: 36.91%
[rank2]:2025-10-29 02:33:18,495 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.5857e+00
[rank2]:2025-10-29 02:33:18,495 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1283  memory: 63.09GiB(45.12%)  tps: 7,827  tflops: 365.06  mfu: 36.91%
[rank3]:2025-10-29 02:33:18,863 - INFO - Avg. fwd time: 15.5556 / Avg. bwd time: 34.2419 / Avg. batch time: 414.1692 (ms) / GPU bubble ratio: 3.81%
[rank0]:2025-10-29 02:33:18,947 - INFO - Avg. fwd time: 14.4925 / Avg. bwd time: 31.2111 / Avg. batch time: 556.8519 (ms) / GPU bubble ratio: 34.34%
[rank1]:2025-10-29 02:33:18,927 - INFO - Avg. fwd time: 16.4753 / Avg. bwd time: 28.9244 / Avg. batch time: 508.7327 (ms) / GPU bubble ratio: 28.61%
[rank2]:2025-10-29 02:33:18,899 - INFO - Avg. fwd time: 14.2163 / Avg. bwd time: 27.3562 / Avg. batch time: 459.2080 (ms) / GPU bubble ratio: 27.58%
[rank2]:2025-10-29 02:33:39,023 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6032e-01
[rank0]:2025-10-29 02:33:39,027 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.2549e-01
[rank3]:2025-10-29 02:33:39,023 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.3303e+00
[rank1]:2025-10-29 02:33:39,020 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.2783e-01
[rank0]:2025-10-29 02:34:00,155 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.0660e-01
[rank2]:2025-10-29 02:34:00,138 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3309e-01
[rank1]:2025-10-29 02:34:00,138 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.6979e-01
[rank3]:2025-10-29 02:34:00,148 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.6000e-01
[rank0]:2025-10-29 02:34:20,684 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.3055e-01
[rank3]:2025-10-29 02:34:20,680 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.1119e+00
[rank1]:2025-10-29 02:34:20,676 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.9901e-01
[rank2]:2025-10-29 02:34:20,680 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.7204e-01
[rank2]:2025-10-29 02:34:41,815 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0171e+00
[rank1]:2025-10-29 02:34:41,814 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0711e+00
[rank0]:2025-10-29 02:34:41,832 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.8376e-01
[rank3]:2025-10-29 02:34:41,824 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4913e+00
[rank0]:2025-10-29 02:35:00,186 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:35:02,229 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.6998e-01
[rank3]:2025-10-29 02:35:02,232 - INFO -  step: 600  loss:  0.0967  grad_norm:  0.1238  memory: 78.44GiB(56.10%)  tps: 7,898  tflops: 368.36  mfu: 37.25%
[rank3]:2025-10-29 02:35:02,233 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 02:35:02,229 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8957e-01
[rank2]:2025-10-29 02:35:02,229 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 63.09GiB(45.12%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank2]:2025-10-29 02:35:02,229 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:35:02,233 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.2165e-01
[rank0]:2025-10-29 02:35:02,233 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 71.50GiB(51.14%)  tps: 7,898  tflops: 368.37  mfu: 37.25%
[rank0]:2025-10-29 02:35:02,233 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 02:35:02,226 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7605e+00
[rank1]:2025-10-29 02:35:02,226 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1238  memory: 71.10GiB(50.85%)  tps: 7,897  tflops: 368.33  mfu: 37.24%
[rank1]:2025-10-29 02:35:02,227 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 02:35:18,436 - INFO - validate step: 600  loss: -1.0000  memory: 71.50GiB(51.14%)  tps: 25,280
[rank1]:2025-10-29 02:35:18,471 - INFO - validate step: 600  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,216
[rank3]:2025-10-29 02:35:18,493 - INFO - validate step: 600  loss:  0.2463  memory: 78.44GiB(56.10%)  tps: 25,191
[rank2]:2025-10-29 02:35:18,486 - INFO - validate step: 600  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,196
[rank1]:2025-10-29 02:35:18,576 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0235_stage1_step600.svg
[rank2]:2025-10-29 02:35:18,570 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0235_stage2_step600.svg
[rank0]:2025-10-29 02:35:18,570 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0235_stage0_step600.svg
[rank3]:2025-10-29 02:35:18,676 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0235_real_step600_rank3.svg
[rank3]:> Batch Time: 522.97 ms, GPU Bubble Ratio: 30.71%, 35.31%, 37.87%, 26.31%
[rank3]:2025-10-29 02:35:18,747 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0235_stage3_step600.svg
[rank3]:2025-10-29 02:35:19,148 - INFO - Avg. fwd time: 15.5285 / Avg. bwd time: 33.9231 / Avg. batch time: 411.3485 (ms) / GPU bubble ratio: 3.83%
[rank1]:2025-10-29 02:35:19,203 - INFO - Avg. fwd time: 16.4737 / Avg. bwd time: 28.5145 / Avg. batch time: 504.7898 (ms) / GPU bubble ratio: 28.70%
[rank2]:2025-10-29 02:35:19,175 - INFO - Avg. fwd time: 14.2066 / Avg. bwd time: 27.0397 / Avg. batch time: 455.9450 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-10-29 02:35:19,239 - INFO - Avg. fwd time: 14.4791 / Avg. bwd time: 30.8886 / Avg. batch time: 552.5388 (ms) / GPU bubble ratio: 34.31%
[rank3]:2025-10-29 02:35:39,975 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.1143e+00
[rank2]:2025-10-29 02:35:39,965 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.8765e+00
[rank0]:2025-10-29 02:35:39,982 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.0934e+00
[rank1]:2025-10-29 02:35:39,965 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2321e+00
[rank2]:2025-10-29 02:36:00,318 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5650e+01
[rank0]:2025-10-29 02:36:00,322 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0413e+02
[rank1]:2025-10-29 02:36:00,315 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1833e+02
[rank3]:2025-10-29 02:36:00,319 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.4728e+01
[rank1]:2025-10-29 02:36:19,559 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8932e+00
[rank2]:2025-10-29 02:36:19,559 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.4082e+00
[rank0]:2025-10-29 02:36:19,567 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5239e+00
[rank3]:2025-10-29 02:36:19,563 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0713e+00
[rank1]:2025-10-29 02:36:40,075 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6779e+00
[rank2]:2025-10-29 02:36:40,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7499e-01
[rank0]:2025-10-29 02:36:40,082 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.9879e+00
[rank3]:2025-10-29 02:36:40,078 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4891e-01
[rank0]:2025-10-29 02:36:57,317 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:36:59,244 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.2519e-01
[rank1]:2025-10-29 02:36:59,244 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 71.10GiB(50.85%)  tps: 8,129  tflops: 379.14  mfu: 38.34%
[rank2]:2025-10-29 02:36:59,244 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3720e+00
[rank2]:2025-10-29 02:36:59,244 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 63.09GiB(45.12%)  tps: 8,130  tflops: 379.20  mfu: 38.34%
[rank3]:2025-10-29 02:36:59,247 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0443e+00
[rank3]:2025-10-29 02:36:59,250 - INFO -  step: 650  loss:  0.0882  grad_norm:  0.2923  memory: 79.24GiB(56.67%)  tps: 8,131  tflops: 379.21  mfu: 38.34%
[rank0]:2025-10-29 02:36:59,251 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.4110e-01
[rank0]:2025-10-29 02:36:59,251 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.2923  memory: 72.50GiB(51.86%)  tps: 8,126  tflops: 378.99  mfu: 38.32%
[rank2]:2025-10-29 02:36:59,639 - INFO - Avg. fwd time: 14.2057 / Avg. bwd time: 26.7630 / Avg. batch time: 452.7842 (ms) / GPU bubble ratio: 27.61%
[rank3]:2025-10-29 02:36:59,603 - INFO - Avg. fwd time: 15.5203 / Avg. bwd time: 33.5925 / Avg. batch time: 408.5990 (ms) / GPU bubble ratio: 3.84%
[rank1]:2025-10-29 02:36:59,666 - INFO - Avg. fwd time: 16.4749 / Avg. bwd time: 28.1935 / Avg. batch time: 501.1111 (ms) / GPU bubble ratio: 28.69%
[rank0]:2025-10-29 02:36:59,687 - INFO - Avg. fwd time: 14.4837 / Avg. bwd time: 30.5171 / Avg. batch time: 548.4455 (ms) / GPU bubble ratio: 34.36%
[rank1]:2025-10-29 02:37:19,735 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2643e+00
[rank2]:2025-10-29 02:37:19,738 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9520e+00
[rank0]:2025-10-29 02:37:19,742 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6515e+00
[rank3]:2025-10-29 02:37:19,739 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1198e+00
[rank2]:2025-10-29 02:37:38,964 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.3254e+00
[rank1]:2025-10-29 02:37:38,964 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.9140e+00
[rank0]:2025-10-29 02:37:38,971 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.6010e+00
[rank3]:2025-10-29 02:37:38,968 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.4113e+00
[rank1]:2025-10-29 02:37:59,399 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0505e+00
[rank2]:2025-10-29 02:37:59,402 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.8437e-01
[rank0]:2025-10-29 02:37:59,406 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1610e+00
[rank3]:2025-10-29 02:37:59,402 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6632e-01
[rank2]:2025-10-29 02:38:18,724 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9321e+00
[rank1]:2025-10-29 02:38:18,724 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6529e+00
[rank0]:2025-10-29 02:38:18,732 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.3888e+00
[rank3]:2025-10-29 02:38:18,728 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.8571e+00
[rank0]:2025-10-29 02:38:37,056 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:38:39,112 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8173e-01
[rank2]:2025-10-29 02:38:39,112 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 63.09GiB(45.12%)  tps: 8,203  tflops: 382.58  mfu: 38.68%
[rank1]:2025-10-29 02:38:39,109 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1160e+00
[rank1]:2025-10-29 02:38:39,109 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 71.10GiB(50.85%)  tps: 8,203  tflops: 382.59  mfu: 38.68%
[rank0]:2025-10-29 02:38:39,116 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5914e+00
[rank0]:2025-10-29 02:38:39,116 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1819  memory: 72.50GiB(51.86%)  tps: 8,203  tflops: 382.59  mfu: 38.68%
[rank3]:2025-10-29 02:38:39,112 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5438e+00
[rank3]:2025-10-29 02:38:39,115 - INFO -  step: 700  loss:  0.1069  grad_norm:  0.1819  memory: 79.24GiB(56.67%)  tps: 8,203  tflops: 382.60  mfu: 38.69%
[rank2]:2025-10-29 02:38:39,196 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0238_stage2_step700.svg
[rank1]:2025-10-29 02:38:39,199 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0238_stage1_step700.svg
[rank0]:2025-10-29 02:38:39,196 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0238_stage0_step700.svg
[rank3]:2025-10-29 02:38:39,295 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0238_real_step700_rank3.svg
[rank3]:> Batch Time: 518.12 ms, GPU Bubble Ratio: 30.76%, 35.09%, 37.70%, 26.38%
[rank3]:2025-10-29 02:38:39,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0238_stage3_step700.svg
[rank2]:2025-10-29 02:38:39,678 - INFO - Avg. fwd time: 14.2001 / Avg. bwd time: 26.5192 / Avg. batch time: 449.1480 (ms) / GPU bubble ratio: 27.47%
[rank1]:2025-10-29 02:38:39,705 - INFO - Avg. fwd time: 16.4730 / Avg. bwd time: 27.8892 / Avg. batch time: 496.9748 (ms) / GPU bubble ratio: 28.59%
[rank0]:2025-10-29 02:38:39,723 - INFO - Avg. fwd time: 14.4969 / Avg. bwd time: 30.0357 / Avg. batch time: 543.7748 (ms) / GPU bubble ratio: 34.48%
[rank3]:2025-10-29 02:38:39,639 - INFO - Avg. fwd time: 15.5181 / Avg. bwd time: 33.1923 / Avg. batch time: 405.3400 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-10-29 02:38:58,555 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.5214e-01
[rank2]:2025-10-29 02:38:58,555 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5786e-01
[rank0]:2025-10-29 02:38:58,563 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.8246e-01
[rank3]:2025-10-29 02:38:58,559 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.2968e-01
[rank1]:2025-10-29 02:39:19,010 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2116e-01
[rank2]:2025-10-29 02:39:19,013 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2199e-01
[rank0]:2025-10-29 02:39:19,017 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1259e-01
[rank3]:2025-10-29 02:39:19,014 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.5404e-01
[rank1]:2025-10-29 02:39:38,220 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0008e+00
[rank2]:2025-10-29 02:39:38,220 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8843e+00
[rank0]:2025-10-29 02:39:38,227 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1170e+00
[rank3]:2025-10-29 02:39:38,223 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8457e+00
[rank1]:2025-10-29 02:39:58,731 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.6329e-01
[rank2]:2025-10-29 02:39:58,734 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2995e-01
[rank0]:2025-10-29 02:39:58,738 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.7078e-01
[rank3]:2025-10-29 02:39:58,734 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4390e-01
[rank0]:2025-10-29 02:40:15,995 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:40:17,939 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.3465e+00
[rank1]:2025-10-29 02:40:17,939 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 71.10GiB(50.85%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank2]:2025-10-29 02:40:17,939 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5464e+00
[rank2]:2025-10-29 02:40:17,939 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 63.09GiB(45.12%)  tps: 8,289  tflops: 386.61  mfu: 39.09%
[rank0]:2025-10-29 02:40:17,946 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.1961e+00
[rank0]:2025-10-29 02:40:17,946 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1292  memory: 72.50GiB(51.86%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank3]:2025-10-29 02:40:17,942 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.6927e+00
[rank3]:2025-10-29 02:40:17,946 - INFO -  step: 750  loss:  0.1378  grad_norm:  0.1292  memory: 79.24GiB(56.67%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank3]:2025-10-29 02:40:18,384 - INFO - Avg. fwd time: 15.5189 / Avg. bwd time: 32.8307 / Avg. batch time: 402.4190 (ms) / GPU bubble ratio: 3.88%
[rank1]:2025-10-29 02:40:18,447 - INFO - Avg. fwd time: 16.4761 / Avg. bwd time: 27.6122 / Avg. batch time: 493.2909 (ms) / GPU bubble ratio: 28.50%
[rank2]:2025-10-29 02:40:18,416 - INFO - Avg. fwd time: 14.2003 / Avg. bwd time: 26.2741 / Avg. batch time: 445.9072 (ms) / GPU bubble ratio: 27.39%
[rank0]:2025-10-29 02:40:18,479 - INFO - Avg. fwd time: 14.5116 / Avg. bwd time: 29.6041 / Avg. batch time: 539.6170 (ms) / GPU bubble ratio: 34.60%
[rank1]:2025-10-29 02:40:38,358 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4627e+00
[rank2]:2025-10-29 02:40:38,361 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3034e+00
[rank0]:2025-10-29 02:40:38,365 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4760e+00
[rank3]:2025-10-29 02:40:38,361 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1606e+00
[rank1]:2025-10-29 02:40:57,705 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2787e+00
[rank2]:2025-10-29 02:40:57,705 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6105e+00
[rank0]:2025-10-29 02:40:57,712 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.1159e+00
[rank3]:2025-10-29 02:40:57,708 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3692e+00
[rank2]:2025-10-29 02:41:18,053 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4205e+00
[rank1]:2025-10-29 02:41:18,050 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.9423e+00
[rank0]:2025-10-29 02:41:18,057 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.7208e+00
[rank3]:2025-10-29 02:41:18,053 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2743e+00
[rank2]:2025-10-29 02:41:37,312 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7331e+00
[rank1]:2025-10-29 02:41:37,312 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.9164e-01
[rank0]:2025-10-29 02:41:37,319 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.4102e-01
[rank3]:2025-10-29 02:41:37,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2266e+00
[rank0]:2025-10-29 02:41:55,731 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:41:57,803 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2864e-01
[rank2]:2025-10-29 02:41:57,803 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 63.09GiB(45.12%)  tps: 8,203  tflops: 382.60  mfu: 38.69%
[rank2]:2025-10-29 02:41:57,803 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 02:41:57,800 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.8971e-01
[rank1]:2025-10-29 02:41:57,800 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 71.10GiB(50.85%)  tps: 8,203  tflops: 382.61  mfu: 38.69%
[rank1]:2025-10-29 02:41:57,800 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:41:57,807 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5117e-01
[rank0]:2025-10-29 02:41:57,807 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.2685  memory: 72.50GiB(51.86%)  tps: 8,203  tflops: 382.61  mfu: 38.69%
[rank0]:2025-10-29 02:41:57,807 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 02:41:57,803 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1459e+00
[rank3]:2025-10-29 02:41:57,805 - INFO -  step: 800  loss:  0.1154  grad_norm:  0.2685  memory: 79.24GiB(56.67%)  tps: 8,204  tflops: 382.62  mfu: 38.69%
[rank3]:2025-10-29 02:41:57,806 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 02:42:14,100 - INFO - validate step: 800  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,141
[rank2]:2025-10-29 02:42:14,149 - INFO - validate step: 800  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,058
[rank1]:2025-10-29 02:42:14,134 - INFO - validate step: 800  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,078
[rank3]:2025-10-29 02:42:14,159 - INFO - validate step: 800  loss:  0.2470  memory: 79.24GiB(56.67%)  tps: 25,048
[rank2]:2025-10-29 02:42:14,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0242_stage2_step800.svg
[rank1]:2025-10-29 02:42:14,245 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0242_stage1_step800.svg
[rank0]:2025-10-29 02:42:14,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0242_stage0_step800.svg
[rank3]:2025-10-29 02:42:14,340 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0242_real_step800_rank3.svg
[rank3]:> Batch Time: 513.38 ms, GPU Bubble Ratio: 30.82%, 34.65%, 37.26%, 26.53%
[rank3]:2025-10-29 02:42:14,407 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0242_stage3_step800.svg
[rank3]:2025-10-29 02:42:14,692 - INFO - Avg. fwd time: 15.5158 / Avg. bwd time: 32.5764 / Avg. batch time: 400.3338 (ms) / GPU bubble ratio: 3.90%
[rank2]:2025-10-29 02:42:14,732 - INFO - Avg. fwd time: 14.1952 / Avg. bwd time: 26.1272 / Avg. batch time: 443.5862 (ms) / GPU bubble ratio: 27.28%
[rank1]:2025-10-29 02:42:14,759 - INFO - Avg. fwd time: 16.4755 / Avg. bwd time: 27.4221 / Avg. batch time: 490.6537 (ms) / GPU bubble ratio: 28.43%
[rank0]:2025-10-29 02:42:14,777 - INFO - Avg. fwd time: 14.5184 / Avg. bwd time: 29.2972 / Avg. batch time: 536.6393 (ms) / GPU bubble ratio: 34.68%
[rank1]:2025-10-29 02:42:33,526 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0507e+00
[rank2]:2025-10-29 02:42:33,526 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.2545e+00
[rank0]:2025-10-29 02:42:33,533 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.6047e-01
[rank3]:2025-10-29 02:42:33,529 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.3660e-01
[rank2]:2025-10-29 02:42:54,011 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1048e-01
[rank1]:2025-10-29 02:42:54,008 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.4715e-01
[rank0]:2025-10-29 02:42:54,015 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5062e-01
[rank3]:2025-10-29 02:42:54,012 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.5890e-01
[rank1]:2025-10-29 02:43:13,219 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0957e+00
[rank2]:2025-10-29 02:43:13,219 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6541e+00
[rank0]:2025-10-29 02:43:13,226 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0171e+00
[rank3]:2025-10-29 02:43:13,223 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6626e+00
[rank2]:2025-10-29 02:43:33,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0715e-01
[rank1]:2025-10-29 02:43:33,616 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2794e-01
[rank0]:2025-10-29 02:43:33,624 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0937e+00
[rank3]:2025-10-29 02:43:33,620 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0659e-01
[rank0]:2025-10-29 02:43:51,035 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:43:52,963 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2144e-01
[rank1]:2025-10-29 02:43:52,963 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 71.10GiB(50.85%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank2]:2025-10-29 02:43:52,963 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8806e+00
[rank2]:2025-10-29 02:43:52,963 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 63.09GiB(45.12%)  tps: 8,290  tflops: 386.66  mfu: 39.10%
[rank0]:2025-10-29 02:43:52,970 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.5473e-01
[rank0]:2025-10-29 02:43:52,970 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.6444  memory: 72.50GiB(51.86%)  tps: 8,286  tflops: 386.44  mfu: 39.07%
[rank3]:2025-10-29 02:43:52,966 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.7581e+00
[rank3]:2025-10-29 02:43:52,969 - INFO -  step: 850  loss:  0.1377  grad_norm:  0.6444  memory: 79.24GiB(56.67%)  tps: 8,291  tflops: 386.68  mfu: 39.10%
[rank2]:2025-10-29 02:43:53,352 - INFO - Avg. fwd time: 14.1942 / Avg. bwd time: 25.9488 / Avg. batch time: 441.0966 (ms) / GPU bubble ratio: 27.19%
[rank1]:2025-10-29 02:43:53,379 - INFO - Avg. fwd time: 16.4778 / Avg. bwd time: 27.2117 / Avg. batch time: 487.8244 (ms) / GPU bubble ratio: 28.35%
[rank3]:2025-10-29 02:43:53,315 - INFO - Avg. fwd time: 15.5155 / Avg. bwd time: 32.2986 / Avg. batch time: 398.0814 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-10-29 02:43:53,399 - INFO - Avg. fwd time: 14.5298 / Avg. bwd time: 28.9679 / Avg. batch time: 533.4495 (ms) / GPU bubble ratio: 34.77%
[rank2]:2025-10-29 02:44:13,320 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4504e-01
[rank1]:2025-10-29 02:44:13,317 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6729e+00
[rank0]:2025-10-29 02:44:13,325 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3056e+00
[rank3]:2025-10-29 02:44:13,321 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1267e+00
[rank2]:2025-10-29 02:44:32,633 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0451e+00
[rank1]:2025-10-29 02:44:32,633 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4232e+00
[rank0]:2025-10-29 02:44:32,640 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.9545e+00
[rank3]:2025-10-29 02:44:32,636 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3491e+00
[rank1]:2025-10-29 02:44:53,156 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6332e+00
[rank2]:2025-10-29 02:44:53,159 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3120e-01
[rank0]:2025-10-29 02:44:53,163 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8158e+00
[rank3]:2025-10-29 02:44:53,159 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.9519e-01
[rank1]:2025-10-29 02:45:12,334 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.6095e-01
[rank2]:2025-10-29 02:45:12,334 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.5785e-01
[rank0]:2025-10-29 02:45:12,341 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.0748e+00
[rank3]:2025-10-29 02:45:12,337 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1529e+00
[rank0]:2025-10-29 02:45:30,834 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 02:45:32,868 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.7921e-01
[rank1]:2025-10-29 02:45:32,864 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.1426e-01
[rank1]:2025-10-29 02:45:32,864 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 71.10GiB(50.85%)  tps: 8,200  tflops: 382.45  mfu: 38.67%
[rank1]:2025-10-29 02:45:32,949 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0245_stage1_step900.svg
[rank2]:2025-10-29 02:45:32,867 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7529e-01
[rank2]:2025-10-29 02:45:32,868 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 63.09GiB(45.12%)  tps: 8,200  tflops: 382.44  mfu: 38.67%
[rank2]:2025-10-29 02:45:32,948 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0245_stage2_step900.svg
[rank0]:2025-10-29 02:45:32,871 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.6424e-01
[rank0]:2025-10-29 02:45:32,872 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2012  memory: 72.50GiB(51.86%)  tps: 8,200  tflops: 382.45  mfu: 38.67%
[rank0]:2025-10-29 02:45:32,949 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0245_stage0_step900.svg
[rank3]:2025-10-29 02:45:32,870 - INFO -  step: 900  loss:  0.1240  grad_norm:  0.2012  memory: 79.24GiB(56.67%)  tps: 8,200  tflops: 382.46  mfu: 38.67%
[rank3]:2025-10-29 02:45:33,048 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0245_real_step900_rank3.svg
[rank3]:> Batch Time: 499.40 ms, GPU Bubble Ratio: 35.29%, 32.92%, 35.58%, 26.31%
[rank3]:2025-10-29 02:45:33,108 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0245_stage3_step900.svg
[rank1]:2025-10-29 02:45:33,531 - INFO - Avg. fwd time: 16.4782 / Avg. bwd time: 27.0423 / Avg. batch time: 485.5229 (ms) / GPU bubble ratio: 28.29%
[rank2]:2025-10-29 02:45:33,501 - INFO - Avg. fwd time: 14.1901 / Avg. bwd time: 25.8219 / Avg. batch time: 439.0766 (ms) / GPU bubble ratio: 27.10%
[rank0]:2025-10-29 02:45:33,560 - INFO - Avg. fwd time: 14.5378 / Avg. bwd time: 28.6914 / Avg. batch time: 530.8443 (ms) / GPU bubble ratio: 34.85%
[rank3]:2025-10-29 02:45:33,472 - INFO - Avg. fwd time: 15.5143 / Avg. bwd time: 32.0722 / Avg. batch time: 396.2371 (ms) / GPU bubble ratio: 3.92%
[rank1]:2025-10-29 02:45:52,311 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.0449e-01
[rank2]:2025-10-29 02:45:52,311 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.3191e-01
[rank0]:2025-10-29 02:45:52,319 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.8096e-01
[rank3]:2025-10-29 02:45:52,315 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.5111e-01
[rank1]:2025-10-29 02:46:12,757 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0861e+00
[rank2]:2025-10-29 02:46:12,760 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8609e-01
[rank0]:2025-10-29 02:46:12,764 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4885e+00
[rank3]:2025-10-29 02:46:12,760 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0153e+00
[rank1]:2025-10-29 02:46:32,138 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0166e+00
[rank2]:2025-10-29 02:46:32,138 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4448e-01
[rank3]:2025-10-29 02:46:32,142 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1218e+00
[rank0]:2025-10-29 02:46:32,146 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.5929e-01
[rank1]:2025-10-29 02:46:52,540 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2574e-01
[rank2]:2025-10-29 02:46:52,543 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5635e-01
[rank3]:2025-10-29 02:46:52,544 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.9110e-01
[rank0]:2025-10-29 02:46:52,547 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7754e-01
[rank0]:2025-10-29 02:47:09,948 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:47:11,869 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.5796e-01
[rank1]:2025-10-29 02:47:11,869 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 71.10GiB(50.85%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank3]:2025-10-29 02:47:11,872 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1583e+00
[rank3]:2025-10-29 02:47:11,875 - INFO -  step: 950  loss:  0.1515  grad_norm:  0.1994  memory: 79.24GiB(56.67%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank2]:2025-10-29 02:47:11,869 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.0823e-01
[rank2]:2025-10-29 02:47:11,869 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 63.09GiB(45.12%)  tps: 8,275  tflops: 385.93  mfu: 39.02%
[rank0]:2025-10-29 02:47:11,876 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.9068e-01
[rank0]:2025-10-29 02:47:11,876 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.1994  memory: 72.50GiB(51.86%)  tps: 8,274  tflops: 385.92  mfu: 39.02%
[rank3]:2025-10-29 02:47:12,225 - INFO - Avg. fwd time: 15.5169 / Avg. bwd time: 31.8841 / Avg. batch time: 394.7356 (ms) / GPU bubble ratio: 3.93%
[rank1]:2025-10-29 02:47:12,288 - INFO - Avg. fwd time: 16.4822 / Avg. bwd time: 26.8974 / Avg. batch time: 483.5978 (ms) / GPU bubble ratio: 28.24%
[rank2]:2025-10-29 02:47:12,260 - INFO - Avg. fwd time: 14.1912 / Avg. bwd time: 25.6936 / Avg. batch time: 437.3821 (ms) / GPU bubble ratio: 27.05%
[rank0]:2025-10-29 02:47:12,308 - INFO - Avg. fwd time: 14.5471 / Avg. bwd time: 28.4647 / Avg. batch time: 528.6709 (ms) / GPU bubble ratio: 34.91%
[rank1]:2025-10-29 02:47:32,489 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.4256e+00
[rank3]:2025-10-29 02:47:32,493 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2479e+00
[rank2]:2025-10-29 02:47:32,492 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5696e+00
[rank0]:2025-10-29 02:47:32,496 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4447e+00
[rank3]:2025-10-29 02:47:51,696 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0625e+00
[rank1]:2025-10-29 02:47:51,693 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7309e+00
[rank2]:2025-10-29 02:47:51,693 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1025e+00
[rank0]:2025-10-29 02:47:51,700 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4861e+00
[rank1]:2025-10-29 02:48:12,312 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.8363e-01
[rank2]:2025-10-29 02:48:12,316 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3828e-01
[rank3]:2025-10-29 02:48:12,316 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.9233e-01
[rank0]:2025-10-29 02:48:12,320 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.5407e-01
[rank1]:2025-10-29 02:48:31,631 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1398e+00
[rank3]:2025-10-29 02:48:31,635 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.3215e+00
[rank2]:2025-10-29 02:48:31,631 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4150e+00
[rank0]:2025-10-29 02:48:31,639 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4266e+00
[rank0]:2025-10-29 02:48:50,117 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:48:52,168 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.7504e-01
[rank1]:2025-10-29 02:48:52,169 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 71.10GiB(50.85%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank2]:2025-10-29 02:48:52,172 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9215e-01
[rank1]:2025-10-29 02:48:52,169 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 02:48:52,172 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 63.09GiB(45.12%)  tps: 8,167  tflops: 380.92  mfu: 38.52%
[rank2]:2025-10-29 02:48:52,172 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 02:48:52,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3291e-01
[rank3]:2025-10-29 02:48:52,175 - INFO -  step: 1000  loss:  0.1238  grad_norm:  0.1284  memory: 79.24GiB(56.67%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank3]:2025-10-29 02:48:52,175 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:48:52,176 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.4436e-01
[rank0]:2025-10-29 02:48:52,176 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1284  memory: 72.50GiB(51.86%)  tps: 8,168  tflops: 380.94  mfu: 38.52%
[rank0]:2025-10-29 02:48:52,176 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 02:49:08,521 - INFO - validate step: 1000  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,061
[rank2]:2025-10-29 02:49:08,571 - INFO - validate step: 1000  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,977
[rank1]:2025-10-29 02:49:08,555 - INFO - validate step: 1000  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 24,997
[rank3]:2025-10-29 02:49:08,584 - INFO - validate step: 1000  loss:  0.2468  memory: 79.24GiB(56.67%)  tps: 24,963
[rank2]:2025-10-29 02:49:08,665 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0249_stage2_step1000.svg
[rank1]:2025-10-29 02:49:08,666 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0249_stage1_step1000.svg
[rank0]:2025-10-29 02:49:08,661 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0249_stage0_step1000.svg
[rank3]:2025-10-29 02:49:08,762 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0249_real_step1000_rank3.svg
[rank3]:> Batch Time: 496.53 ms, GPU Bubble Ratio: 35.17%, 32.57%, 35.26%, 26.40%
[rank3]:2025-10-29 02:49:08,823 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0249_stage3_step1000.svg
[rank3]:2025-10-29 02:49:09,103 - INFO - Avg. fwd time: 15.5197 / Avg. bwd time: 31.6997 / Avg. batch time: 393.2643 (ms) / GPU bubble ratio: 3.94%
[rank2]:2025-10-29 02:49:09,142 - INFO - Avg. fwd time: 14.1918 / Avg. bwd time: 25.5840 / Avg. batch time: 435.7357 (ms) / GPU bubble ratio: 26.97%
[rank1]:2025-10-29 02:49:09,169 - INFO - Avg. fwd time: 16.4876 / Avg. bwd time: 26.7599 / Avg. batch time: 481.7260 (ms) / GPU bubble ratio: 28.18%
[rank0]:2025-10-29 02:49:09,187 - INFO - Avg. fwd time: 14.5580 / Avg. bwd time: 28.2407 / Avg. batch time: 526.5555 (ms) / GPU bubble ratio: 34.98%
[rank3]:2025-10-29 02:49:28,174 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.8228e+00
[rank2]:2025-10-29 02:49:28,170 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1160e+00
[rank1]:2025-10-29 02:49:28,170 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2948e+00
[rank0]:2025-10-29 02:49:28,177 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.7272e-01
[rank3]:2025-10-29 02:49:48,512 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0777e+00
[rank2]:2025-10-29 02:49:48,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3458e-01
[rank1]:2025-10-29 02:49:48,508 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.1839e-01
[rank0]:2025-10-29 02:49:48,516 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6180e+00
[rank3]:2025-10-29 02:50:07,775 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5897e+00
[rank2]:2025-10-29 02:50:07,771 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5956e+00
[rank1]:2025-10-29 02:50:07,771 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6317e+00
[rank0]:2025-10-29 02:50:07,778 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.0946e+00
[rank3]:2025-10-29 02:50:28,290 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9997e-01
[rank1]:2025-10-29 02:50:28,287 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3584e+00
[rank2]:2025-10-29 02:50:28,290 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8857e-01
[rank0]:2025-10-29 02:50:28,294 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.2667e+00
[rank0]:2025-10-29 02:50:45,561 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 02:50:47,493 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.1801e-01
[rank1]:2025-10-29 02:50:47,493 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 71.10GiB(50.85%)  tps: 8,280  tflops: 386.18  mfu: 39.05%
[rank3]:2025-10-29 02:50:47,497 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6739e+00
[rank3]:2025-10-29 02:50:47,500 - INFO -  step: 1050  loss:  0.1288  grad_norm:  0.1258  memory: 79.24GiB(56.67%)  tps: 8,282  tflops: 386.27  mfu: 39.06%
[rank2]:2025-10-29 02:50:47,493 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0872e+00
[rank2]:2025-10-29 02:50:47,494 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 63.09GiB(45.12%)  tps: 8,281  tflops: 386.24  mfu: 39.05%
[rank0]:2025-10-29 02:50:47,500 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.3539e+00
[rank0]:2025-10-29 02:50:47,501 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1258  memory: 72.50GiB(51.86%)  tps: 8,276  tflops: 386.01  mfu: 39.03%
[rank1]:2025-10-29 02:50:48,003 - INFO - Avg. fwd time: 16.4886 / Avg. bwd time: 26.6181 / Avg. batch time: 479.8650 (ms) / GPU bubble ratio: 28.14%
[rank3]:2025-10-29 02:50:47,936 - INFO - Avg. fwd time: 15.5204 / Avg. bwd time: 31.5164 / Avg. batch time: 391.7875 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-10-29 02:50:47,970 - INFO - Avg. fwd time: 14.1932 / Avg. bwd time: 25.4563 / Avg. batch time: 434.0987 (ms) / GPU bubble ratio: 26.93%
[rank0]:2025-10-29 02:50:48,035 - INFO - Avg. fwd time: 14.5656 / Avg. bwd time: 28.0231 / Avg. batch time: 524.4565 (ms) / GPU bubble ratio: 35.04%
[rank3]:2025-10-29 02:51:08,069 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3878e+00
[rank1]:2025-10-29 02:51:08,065 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0962e+00
[rank2]:2025-10-29 02:51:08,069 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7366e-01
[rank0]:2025-10-29 02:51:08,073 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5877e-01
[rank0]:2025-10-29 02:51:27,303 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.2815e+00
[rank3]:2025-10-29 02:51:27,299 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.6618e+00
[rank1]:2025-10-29 02:51:27,295 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6151e+00
[rank2]:2025-10-29 02:51:27,295 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.9554e+00
[rank0]:2025-10-29 02:51:47,736 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0618e+00
[rank3]:2025-10-29 02:51:47,733 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.3865e-01
[rank2]:2025-10-29 02:51:47,732 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5058e-01
[rank1]:2025-10-29 02:51:47,729 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.2247e-01
[rank0]:2025-10-29 02:52:07,134 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 6.1103e+00
[rank3]:2025-10-29 02:52:07,130 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.3934e+00
[rank1]:2025-10-29 02:52:07,127 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5362e+00
[rank2]:2025-10-29 02:52:07,127 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.9281e+00
[rank0]:2025-10-29 02:52:25,461 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:52:27,529 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6849e+00
[rank0]:2025-10-29 02:52:27,529 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 72.50GiB(51.86%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank3]:2025-10-29 02:52:27,525 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4317e+00
[rank3]:2025-10-29 02:52:27,528 - INFO -  step: 1100  loss:  0.0984  grad_norm:  0.1037  memory: 79.24GiB(56.67%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank1]:2025-10-29 02:52:27,522 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4623e+00
[rank1]:2025-10-29 02:52:27,522 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 71.10GiB(50.85%)  tps: 8,190  tflops: 381.97  mfu: 38.62%
[rank2]:2025-10-29 02:52:27,525 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1199e+00
[rank2]:2025-10-29 02:52:27,526 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1037  memory: 63.09GiB(45.12%)  tps: 8,189  tflops: 381.95  mfu: 38.62%
[rank0]:2025-10-29 02:52:27,610 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0252_stage0_step1100.svg
[rank1]:2025-10-29 02:52:27,613 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0252_stage1_step1100.svg
[rank2]:2025-10-29 02:52:27,610 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0252_stage2_step1100.svg
[rank3]:2025-10-29 02:52:27,712 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0252_real_step1100_rank3.svg
[rank3]:> Batch Time: 494.43 ms, GPU Bubble Ratio: 35.07%, 32.55%, 35.36%, 26.46%
[rank3]:2025-10-29 02:52:27,775 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0252_stage3_step1100.svg
[rank3]:2025-10-29 02:52:28,055 - INFO - Avg. fwd time: 15.5203 / Avg. bwd time: 31.3884 / Avg. batch time: 390.7493 (ms) / GPU bubble ratio: 3.96%
[rank0]:2025-10-29 02:52:28,139 - INFO - Avg. fwd time: 14.5696 / Avg. bwd time: 27.8661 / Avg. batch time: 522.9628 (ms) / GPU bubble ratio: 35.08%
[rank1]:2025-10-29 02:52:28,121 - INFO - Avg. fwd time: 16.4891 / Avg. bwd time: 26.5213 / Avg. batch time: 478.5446 (ms) / GPU bubble ratio: 28.10%
[rank2]:2025-10-29 02:52:28,094 - INFO - Avg. fwd time: 14.1911 / Avg. bwd time: 25.3840 / Avg. batch time: 432.9395 (ms) / GPU bubble ratio: 26.87%
[rank1]:2025-10-29 02:52:47,013 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.9582e-01
[rank3]:2025-10-29 02:52:47,016 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0642e+00
[rank0]:2025-10-29 02:52:47,020 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.0480e-01
[rank2]:2025-10-29 02:52:47,013 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1733e+00
[rank0]:2025-10-29 02:53:07,538 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.3769e-01
[rank1]:2025-10-29 02:53:07,531 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.1590e-01
[rank3]:2025-10-29 02:53:07,534 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.4021e-01
[rank2]:2025-10-29 02:53:07,534 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9778e-01
[rank1]:2025-10-29 02:53:26,703 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.7185e-01
[rank0]:2025-10-29 02:53:26,710 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.3561e-01
[rank3]:2025-10-29 02:53:26,706 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1214e+00
[rank2]:2025-10-29 02:53:26,703 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7734e-01
[rank3]:2025-10-29 02:53:47,230 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1359e+00
[rank0]:2025-10-29 02:53:47,234 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5125e+00
[rank2]:2025-10-29 02:53:47,230 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.0518e-01
[rank1]:2025-10-29 02:53:47,227 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7116e+00
[rank0]:2025-10-29 02:54:04,547 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 02:54:06,497 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 7.9135e-01
[rank0]:2025-10-29 02:54:06,497 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 72.50GiB(51.86%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank3]:2025-10-29 02:54:06,493 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3735e+00
[rank3]:2025-10-29 02:54:06,497 - INFO -  step: 1150  loss:  0.1189  grad_norm:  0.1261  memory: 79.24GiB(56.67%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank2]:2025-10-29 02:54:06,490 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5893e+00
[rank2]:2025-10-29 02:54:06,490 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 63.09GiB(45.12%)  tps: 8,278  tflops: 386.07  mfu: 39.04%
[rank1]:2025-10-29 02:54:06,490 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9603e+00
[rank1]:2025-10-29 02:54:06,490 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1261  memory: 71.10GiB(50.85%)  tps: 8,277  tflops: 386.06  mfu: 39.04%
[rank3]:2025-10-29 02:54:06,854 - INFO - Avg. fwd time: 15.5207 / Avg. bwd time: 31.2405 / Avg. batch time: 389.5544 (ms) / GPU bubble ratio: 3.97%
[rank0]:2025-10-29 02:54:06,938 - INFO - Avg. fwd time: 14.5754 / Avg. bwd time: 27.6883 / Avg. batch time: 521.2661 (ms) / GPU bubble ratio: 35.14%
[rank2]:2025-10-29 02:54:06,891 - INFO - Avg. fwd time: 14.1907 / Avg. bwd time: 25.2863 / Avg. batch time: 431.6212 (ms) / GPU bubble ratio: 26.83%
[rank1]:2025-10-29 02:54:06,918 - INFO - Avg. fwd time: 16.4892 / Avg. bwd time: 26.4072 / Avg. batch time: 477.0434 (ms) / GPU bubble ratio: 28.06%
[rank2]:2025-10-29 02:54:26,981 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4143e-01
[rank1]:2025-10-29 02:54:26,978 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4505e+00
[rank3]:2025-10-29 02:54:26,981 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9129e-01
[rank0]:2025-10-29 02:54:26,985 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4335e-01
[rank0]:2025-10-29 02:54:46,370 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 9.4623e-01
[rank1]:2025-10-29 02:54:46,362 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2489e+00
[rank2]:2025-10-29 02:54:46,363 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1208e+00
[rank3]:2025-10-29 02:54:46,366 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9452e+00
[rank0]:2025-10-29 02:55:06,753 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4750e+00
[rank1]:2025-10-29 02:55:06,746 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6471e+00
[rank3]:2025-10-29 02:55:06,750 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.3283e-01
[rank2]:2025-10-29 02:55:06,749 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2675e-01
[rank3]:2025-10-29 02:55:26,042 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.5597e-01
[rank2]:2025-10-29 02:55:26,038 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9558e-01
[rank1]:2025-10-29 02:55:26,038 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.1199e-01
[rank0]:2025-10-29 02:55:26,046 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.1379e-01
[rank0]:2025-10-29 02:55:44,479 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 02:55:46,554 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2671e+00
[rank2]:2025-10-29 02:55:46,554 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 63.09GiB(45.12%)  tps: 8,187  tflops: 381.83  mfu: 38.61%
[rank1]:2025-10-29 02:55:46,551 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.7104e+00
[rank1]:2025-10-29 02:55:46,551 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 71.10GiB(50.85%)  tps: 8,187  tflops: 381.84  mfu: 38.61%
[rank2]:2025-10-29 02:55:46,555 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 02:55:46,551 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 02:55:46,554 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.5054e-01
[rank3]:2025-10-29 02:55:46,557 - INFO -  step: 1200  loss:  0.1004  grad_norm:  0.1267  memory: 79.24GiB(56.67%)  tps: 8,187  tflops: 381.85  mfu: 38.61%
[rank3]:2025-10-29 02:55:46,557 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 02:55:46,558 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4073e+00
[rank0]:2025-10-29 02:55:46,558 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1267  memory: 72.50GiB(51.86%)  tps: 8,187  tflops: 381.84  mfu: 38.61%
[rank0]:2025-10-29 02:55:46,559 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 02:56:03,068 - INFO - validate step: 1200  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 24,800
[rank1]:2025-10-29 02:56:03,069 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:56:03,033 - INFO - validate step: 1200  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 24,862
[rank0]:2025-10-29 02:56:03,034 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 02:56:03,038 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-10-29 02:56:03,096 - INFO - validate step: 1200  loss:  0.2473  memory: 79.24GiB(56.67%)  tps: 24,766
[rank3]:2025-10-29 02:56:03,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:56:03,084 - INFO - validate step: 1200  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 24,781
[rank2]:2025-10-29 02:56:03,084 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 02:56:13,633 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.55 seconds.
[rank1]:2025-10-29 02:56:15,102 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.03 seconds.
[rank0]:2025-10-29 02:56:17,109 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 02:56:17,115 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.08 seconds.
[rank3]:2025-10-29 02:56:19,687 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.59 seconds.
[rank1]:2025-10-29 02:56:19,814 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0256_stage1_step1200.svg
[rank1]:2025-10-29 02:56:19,826 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 02:56:19,807 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0256_stage2_step1200.svg
[rank2]:2025-10-29 02:56:19,819 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 02:56:19,882 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0256_stage0_step1200.svg
[rank3]:2025-10-29 02:56:19,978 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0256_real_step1200_rank3.svg
[rank3]:> Batch Time: 493.09 ms, GPU Bubble Ratio: 34.97%, 32.42%, 35.24%, 26.49%
[rank0]:2025-10-29 02:56:19,894 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 02:56:20,042 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0256_stage3_step1200.svg
[rank3]:2025-10-29 02:56:20,054 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 02:56:21,277 - INFO - Avg. fwd time: 15.5215 / Avg. bwd time: 31.1184 / Avg. batch time: 388.7490 (ms) / GPU bubble ratio: 4.02%
[rank1]:2025-10-29 02:56:21,341 - INFO - Avg. fwd time: 16.4897 / Avg. bwd time: 26.3153 / Avg. batch time: 475.9864 (ms) / GPU bubble ratio: 28.06%
[rank2]:2025-10-29 02:56:21,308 - INFO - Avg. fwd time: 14.1887 / Avg. bwd time: 25.2208 / Avg. batch time: 430.7179 (ms) / GPU bubble ratio: 26.80%
[rank0]:2025-10-29 02:56:21,375 - INFO - Avg. fwd time: 14.5814 / Avg. bwd time: 27.5376 / Avg. batch time: 520.0531 (ms) / GPU bubble ratio: 35.21%
[rank3]:2025-10-29 02:56:41,314 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6039e+01
[rank2]:2025-10-29 02:56:41,311 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2196e+01
[rank1]:2025-10-29 02:56:41,310 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6634e+01
[rank0]:2025-10-29 02:56:41,318 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5387e+01
[rank1]:2025-10-29 02:57:01,619 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.5564e-01
[rank2]:2025-10-29 02:57:01,622 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.0109e-01
[rank3]:2025-10-29 02:57:01,625 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8841e+00
[rank0]:2025-10-29 02:57:01,629 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.0655e-01
[rank1]:2025-10-29 02:57:21,861 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9829e-01
[rank3]:2025-10-29 02:57:21,864 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1274e+00
[rank2]:2025-10-29 02:57:21,861 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3251e+00
[rank0]:2025-10-29 02:57:21,865 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5416e-01
[rank2]:2025-10-29 02:57:42,216 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4207e+00
[rank3]:2025-10-29 02:57:42,219 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0368e+00
[rank1]:2025-10-29 02:57:42,213 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.3961e-01
[rank0]:2025-10-29 02:57:42,223 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2596e-01
[rank0]:2025-10-29 02:58:02,298 - INFO - [GC] Peforming periodical GC collection 1.93 seconds
[rank2]:2025-10-29 02:58:04,322 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4776e-01
[rank2]:2025-10-29 02:58:04,323 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 64.04GiB(45.81%)  tps: 6,757  tflops: 315.14  mfu: 31.86%
[rank3]:2025-10-29 02:58:04,329 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1539e+00
[rank3]:2025-10-29 02:58:04,332 - INFO -  step: 1250  loss:  0.8744  grad_norm:  0.2396  memory: 79.24GiB(56.67%)  tps: 6,757  tflops: 315.16  mfu: 31.87%
[rank1]:2025-10-29 02:58:04,326 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.4045e-02
[rank1]:2025-10-29 02:58:04,326 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 72.05GiB(51.54%)  tps: 6,756  tflops: 315.09  mfu: 31.86%
[rank0]:2025-10-29 02:58:04,329 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9717e-01
[rank0]:2025-10-29 02:58:04,330 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.2396  memory: 73.46GiB(52.54%)  tps: 6,754  tflops: 315.00  mfu: 31.85%
[rank2]:2025-10-29 02:58:04,723 - INFO - Avg. fwd time: 14.2215 / Avg. bwd time: 25.0691 / Avg. batch time: 429.8554 (ms) / GPU bubble ratio: 26.88%
[rank3]:2025-10-29 02:58:04,683 - INFO - Avg. fwd time: 15.5567 / Avg. bwd time: 30.9985 / Avg. batch time: 388.0611 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 02:58:04,746 - INFO - Avg. fwd time: 16.5237 / Avg. bwd time: 26.1628 / Avg. batch time: 474.9365 (ms) / GPU bubble ratio: 28.10%
[rank0]:2025-10-29 02:58:04,766 - INFO - Avg. fwd time: 14.6190 / Avg. bwd time: 27.3480 / Avg. batch time: 518.8222 (ms) / GPU bubble ratio: 35.29%
[rank2]:2025-10-29 02:58:24,651 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1972e-01
[rank1]:2025-10-29 02:58:24,648 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.5766e-01
[rank3]:2025-10-29 02:58:24,655 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6899e+00
[rank0]:2025-10-29 02:58:24,658 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4075e-01
[rank3]:2025-10-29 02:58:44,934 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5568e+00
[rank1]:2025-10-29 02:58:44,931 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5923e-01
[rank2]:2025-10-29 02:58:44,927 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4387e-01
[rank0]:2025-10-29 02:58:44,934 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.8018e-01
[rank2]:2025-10-29 02:59:05,242 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0118e-01
[rank1]:2025-10-29 02:59:05,239 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.5591e-01
[rank3]:2025-10-29 02:59:05,245 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.0053e-01
[rank0]:2025-10-29 02:59:05,249 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7442e-01
[rank2]:2025-10-29 02:59:25,468 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7764e-01
[rank3]:2025-10-29 02:59:25,474 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.5670e-01
[rank1]:2025-10-29 02:59:25,471 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0591e-01
[rank0]:2025-10-29 02:59:25,475 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.5153e-01
[rank0]:2025-10-29 02:59:43,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 02:59:45,855 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.4511e-01
[rank1]:2025-10-29 02:59:45,855 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 72.05GiB(51.54%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank2]:2025-10-29 02:59:45,858 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3956e-01
[rank2]:2025-10-29 02:59:45,859 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 64.04GiB(45.81%)  tps: 8,068  tflops: 376.30  mfu: 38.05%
[rank2]:2025-10-29 02:59:45,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0259_stage2_step1300.svg
[rank3]:2025-10-29 02:59:45,862 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2090e+00
[rank3]:2025-10-29 02:59:45,866 - INFO -  step: 1300  loss:  0.7926  grad_norm:  0.2472  memory: 79.24GiB(56.67%)  tps: 8,068  tflops: 376.31  mfu: 38.05%
[rank1]:2025-10-29 02:59:45,941 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0259_stage1_step1300.svg
[rank0]:2025-10-29 02:59:45,865 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1411e-01
[rank0]:2025-10-29 02:59:45,866 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2472  memory: 73.46GiB(52.54%)  tps: 8,068  tflops: 376.30  mfu: 38.05%
[rank0]:2025-10-29 02:59:45,944 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0259_stage0_step1300.svg
[rank3]:2025-10-29 02:59:46,048 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0259_real_step1300_rank3.svg
[rank3]:> Batch Time: 492.33 ms, GPU Bubble Ratio: 34.89%, 32.40%, 35.24%, 26.52%
[rank3]:2025-10-29 02:59:46,112 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0259_stage3_step1300.svg
[rank2]:2025-10-29 02:59:46,455 - INFO - Avg. fwd time: 14.2623 / Avg. bwd time: 24.8686 / Avg. batch time: 428.9217 (ms) / GPU bubble ratio: 27.02%
[rank3]:2025-10-29 02:59:46,419 - INFO - Avg. fwd time: 15.5962 / Avg. bwd time: 30.8717 / Avg. batch time: 387.3522 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 02:59:46,484 - INFO - Avg. fwd time: 16.5644 / Avg. bwd time: 25.9922 / Avg. batch time: 473.7960 (ms) / GPU bubble ratio: 28.14%
[rank0]:2025-10-29 02:59:46,497 - INFO - Avg. fwd time: 14.6621 / Avg. bwd time: 27.1301 / Avg. batch time: 517.4726 (ms) / GPU bubble ratio: 35.39%
[rank2]:2025-10-29 03:00:06,254 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3437e-01
[rank3]:2025-10-29 03:00:06,261 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6700e+00
[rank1]:2025-10-29 03:00:06,257 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9661e-01
[rank0]:2025-10-29 03:00:06,261 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.3159e-01
[rank2]:2025-10-29 03:00:26,633 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.7824e-01
[rank1]:2025-10-29 03:00:26,630 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.7719e-01
[rank3]:2025-10-29 03:00:26,637 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3308e+00
[rank0]:2025-10-29 03:00:26,640 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.4005e-01
[rank2]:2025-10-29 03:00:46,858 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0781e+00
[rank1]:2025-10-29 03:00:46,861 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.7357e-01
[rank0]:2025-10-29 03:00:46,865 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4088e+00
[rank3]:2025-10-29 03:00:46,865 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0468e+00
[rank2]:2025-10-29 03:01:07,201 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.2413e-01
[rank1]:2025-10-29 03:01:07,198 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.3279e-01
[rank0]:2025-10-29 03:01:07,209 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1328e-01
[rank3]:2025-10-29 03:01:07,205 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0338e+00
[rank0]:2025-10-29 03:01:25,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:01:27,417 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1918e+00
[rank2]:2025-10-29 03:01:27,418 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 64.04GiB(45.81%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank0]:2025-10-29 03:01:27,425 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.0248e-01
[rank0]:2025-10-29 03:01:27,425 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 73.46GiB(52.54%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank3]:2025-10-29 03:01:27,424 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8538e+00
[rank3]:2025-10-29 03:01:27,427 - INFO -  step: 1350  loss:  0.8363  grad_norm:  0.2713  memory: 79.24GiB(56.67%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank1]:2025-10-29 03:01:27,421 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6581e-01
[rank1]:2025-10-29 03:01:27,421 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2713  memory: 72.05GiB(51.54%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank2]:2025-10-29 03:01:27,899 - INFO - Avg. fwd time: 14.3009 / Avg. bwd time: 24.6740 / Avg. batch time: 428.0932 (ms) / GPU bubble ratio: 27.17%
[rank3]:2025-10-29 03:01:27,870 - INFO - Avg. fwd time: 15.6335 / Avg. bwd time: 30.7563 / Avg. batch time: 386.7177 (ms) / GPU bubble ratio: 4.03%
[rank1]:2025-10-29 03:01:27,928 - INFO - Avg. fwd time: 16.6019 / Avg. bwd time: 25.8454 / Avg. batch time: 472.7897 (ms) / GPU bubble ratio: 28.18%
[rank0]:2025-10-29 03:01:27,960 - INFO - Avg. fwd time: 14.7028 / Avg. bwd time: 26.9195 / Avg. batch time: 516.2623 (ms) / GPU bubble ratio: 35.50%
[rank1]:2025-10-29 03:01:47,754 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.0762e-01
[rank2]:2025-10-29 03:01:47,757 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1890e-01
[rank0]:2025-10-29 03:01:47,764 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0163e-01
[rank3]:2025-10-29 03:01:47,761 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.2929e-01
[rank2]:2025-10-29 03:02:08,027 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3166e+00
[rank1]:2025-10-29 03:02:08,030 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0785e-01
[rank0]:2025-10-29 03:02:08,034 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0671e+00
[rank3]:2025-10-29 03:02:08,033 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.6905e-01
[rank2]:2025-10-29 03:02:28,352 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2566e-01
[rank1]:2025-10-29 03:02:28,349 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.9748e-01
[rank0]:2025-10-29 03:02:28,359 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3963e-01
[rank3]:2025-10-29 03:02:28,355 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3878e-01
[rank1]:2025-10-29 03:02:48,560 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9238e-01
[rank2]:2025-10-29 03:02:48,557 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2995e+00
[rank0]:2025-10-29 03:02:48,564 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1514e+00
[rank3]:2025-10-29 03:02:48,564 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8871e+00
[rank0]:2025-10-29 03:03:06,940 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:03:08,977 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0364e+00
[rank2]:2025-10-29 03:03:08,977 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 64.04GiB(45.81%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank1]:2025-10-29 03:03:08,974 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.2871e+00
[rank2]:2025-10-29 03:03:08,978 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 03:03:08,974 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 72.05GiB(51.54%)  tps: 8,067  tflops: 376.23  mfu: 38.04%
[rank1]:2025-10-29 03:03:08,974 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:03:08,984 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.1786e-01
[rank0]:2025-10-29 03:03:08,985 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3056  memory: 73.46GiB(52.54%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank0]:2025-10-29 03:03:08,985 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 03:03:08,981 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6821e+00
[rank3]:2025-10-29 03:03:08,983 - INFO -  step: 1400  loss:  0.8335  grad_norm:  0.3056  memory: 79.24GiB(56.67%)  tps: 8,067  tflops: 376.23  mfu: 38.04%
[rank3]:2025-10-29 03:03:08,983 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 03:03:25,315 - INFO - validate step: 1400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,082
[rank2]:2025-10-29 03:03:25,365 - INFO - validate step: 1400  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,995
[rank1]:2025-10-29 03:03:25,349 - INFO - validate step: 1400  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,014
[rank3]:2025-10-29 03:03:25,381 - INFO - validate step: 1400  loss:  0.2451  memory: 79.24GiB(56.67%)  tps: 24,980
[rank2]:2025-10-29 03:03:25,464 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0303_stage2_step1400.svg
[rank1]:2025-10-29 03:03:25,463 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0303_stage1_step1400.svg
[rank0]:2025-10-29 03:03:25,464 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0303_stage0_step1400.svg
[rank3]:2025-10-29 03:03:25,559 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0303_real_step1400_rank3.svg
[rank3]:> Batch Time: 491.65 ms, GPU Bubble Ratio: 34.79%, 32.44%, 35.30%, 26.53%
[rank3]:2025-10-29 03:03:25,624 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0303_stage3_step1400.svg
[rank3]:2025-10-29 03:03:25,935 - INFO - Avg. fwd time: 15.6628 / Avg. bwd time: 30.6641 / Avg. batch time: 386.2072 (ms) / GPU bubble ratio: 4.04%
[rank2]:2025-10-29 03:03:25,970 - INFO - Avg. fwd time: 14.3304 / Avg. bwd time: 24.5294 / Avg. batch time: 427.4200 (ms) / GPU bubble ratio: 27.27%
[rank1]:2025-10-29 03:03:26,001 - INFO - Avg. fwd time: 16.6329 / Avg. bwd time: 25.7179 / Avg. batch time: 471.9628 (ms) / GPU bubble ratio: 28.21%
[rank0]:2025-10-29 03:03:26,013 - INFO - Avg. fwd time: 14.7339 / Avg. bwd time: 26.7623 / Avg. batch time: 515.2827 (ms) / GPU bubble ratio: 35.58%
[rank2]:2025-10-29 03:03:45,753 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9684e-01
[rank1]:2025-10-29 03:03:45,756 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4052e-01
[rank0]:2025-10-29 03:03:45,760 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4901e-01
[rank3]:2025-10-29 03:03:45,760 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2719e-01
[rank2]:2025-10-29 03:04:06,067 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4619e-01
[rank1]:2025-10-29 03:04:06,064 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.5039e-01
[rank3]:2025-10-29 03:04:06,071 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3207e+00
[rank0]:2025-10-29 03:04:06,075 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0287e-01
[rank2]:2025-10-29 03:04:26,304 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.4078e-01
[rank0]:2025-10-29 03:04:26,311 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5076e-01
[rank1]:2025-10-29 03:04:26,307 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0065e-01
[rank3]:2025-10-29 03:04:26,310 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1570e+00
[rank2]:2025-10-29 03:04:46,597 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6005e-01
[rank1]:2025-10-29 03:04:46,593 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.0055e-01
[rank0]:2025-10-29 03:04:46,604 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6467e-01
[rank3]:2025-10-29 03:04:46,600 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8740e-01
[rank0]:2025-10-29 03:05:04,870 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:05:06,890 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8827e-01
[rank2]:2025-10-29 03:05:06,891 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 64.04GiB(45.81%)  tps: 8,069  tflops: 376.34  mfu: 38.05%
[rank1]:2025-10-29 03:05:06,893 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9561e-02
[rank1]:2025-10-29 03:05:06,894 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 72.05GiB(51.54%)  tps: 8,067  tflops: 376.27  mfu: 38.05%
[rank0]:2025-10-29 03:05:06,897 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.8763e-01
[rank0]:2025-10-29 03:05:06,898 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.4087  memory: 73.46GiB(52.54%)  tps: 8,064  tflops: 376.13  mfu: 38.03%
[rank3]:2025-10-29 03:05:06,897 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1271e-01
[rank3]:2025-10-29 03:05:06,900 - INFO -  step: 1450  loss:  0.8783  grad_norm:  0.4087  memory: 79.24GiB(56.67%)  tps: 8,070  tflops: 376.37  mfu: 38.06%
[rank2]:2025-10-29 03:05:07,292 - INFO - Avg. fwd time: 14.3635 / Avg. bwd time: 24.3641 / Avg. batch time: 426.6950 (ms) / GPU bubble ratio: 27.39%
[rank1]:2025-10-29 03:05:07,314 - INFO - Avg. fwd time: 16.6656 / Avg. bwd time: 25.5870 / Avg. batch time: 471.0796 (ms) / GPU bubble ratio: 28.25%
[rank3]:2025-10-29 03:05:07,250 - INFO - Avg. fwd time: 15.6949 / Avg. bwd time: 30.5633 / Avg. batch time: 385.6487 (ms) / GPU bubble ratio: 4.04%
[rank0]:2025-10-29 03:05:07,333 - INFO - Avg. fwd time: 14.7689 / Avg. bwd time: 26.5833 / Avg. batch time: 514.2260 (ms) / GPU bubble ratio: 35.67%
[rank2]:2025-10-29 03:05:27,227 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2019e-02
[rank1]:2025-10-29 03:05:27,224 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.8420e-01
[rank0]:2025-10-29 03:05:27,234 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1644e-01
[rank3]:2025-10-29 03:05:27,231 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2580e-01
[rank2]:2025-10-29 03:05:47,456 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0436e+00
[rank3]:2025-10-29 03:05:47,463 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2067e+00
[rank0]:2025-10-29 03:05:47,464 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6933e-01
[rank1]:2025-10-29 03:05:47,460 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7094e-01
[rank2]:2025-10-29 03:06:07,884 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1192e-01
[rank0]:2025-10-29 03:06:07,891 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0006e-01
[rank1]:2025-10-29 03:06:07,880 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.1860e-01
[rank3]:2025-10-29 03:06:07,887 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.1688e-01
[rank0]:2025-10-29 03:06:28,076 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.5405e-01
[rank2]:2025-10-29 03:06:28,069 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8801e-01
[rank1]:2025-10-29 03:06:28,072 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3123e-01
[rank3]:2025-10-29 03:06:28,075 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8608e-01
[rank0]:2025-10-29 03:06:46,373 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:06:48,414 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5324e+00
[rank0]:2025-10-29 03:06:48,418 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8336e-01
[rank0]:2025-10-29 03:06:48,418 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 73.46GiB(52.54%)  tps: 8,069  tflops: 376.35  mfu: 38.05%
[rank0]:2025-10-29 03:06:48,497 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0306_stage0_step1500.svg
[rank2]:2025-10-29 03:06:48,411 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0539e-01
[rank2]:2025-10-29 03:06:48,411 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 64.04GiB(45.81%)  tps: 8,069  tflops: 376.35  mfu: 38.05%
[rank2]:2025-10-29 03:06:48,498 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0306_stage2_step1500.svg
[rank1]:2025-10-29 03:06:48,408 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.5822e-01
[rank1]:2025-10-29 03:06:48,408 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.4328  memory: 72.05GiB(51.54%)  tps: 8,070  tflops: 376.38  mfu: 38.06%
[rank1]:2025-10-29 03:06:48,498 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0306_stage1_step1500.svg
[rank3]:2025-10-29 03:06:48,417 - INFO -  step: 1500  loss:  0.7542  grad_norm:  0.4328  memory: 79.24GiB(56.67%)  tps: 8,070  tflops: 376.37  mfu: 38.06%
[rank3]:2025-10-29 03:06:48,597 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0306_real_step1500_rank3.svg
[rank3]:> Batch Time: 485.55 ms, GPU Bubble Ratio: 33.95%, 33.73%, 40.86%, 25.72%
[rank3]:2025-10-29 03:06:48,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0306_stage3_step1500.svg
[rank2]:2025-10-29 03:06:49,094 - INFO - Avg. fwd time: 14.3927 / Avg. bwd time: 24.2191 / Avg. batch time: 426.0309 (ms) / GPU bubble ratio: 27.49%
[rank3]:2025-10-29 03:06:49,066 - INFO - Avg. fwd time: 15.7244 / Avg. bwd time: 30.4697 / Avg. batch time: 385.1283 (ms) / GPU bubble ratio: 4.04%
[rank0]:2025-10-29 03:06:49,157 - INFO - Avg. fwd time: 14.8002 / Avg. bwd time: 26.4257 / Avg. batch time: 513.2540 (ms) / GPU bubble ratio: 35.74%
[rank1]:2025-10-29 03:06:49,128 - INFO - Avg. fwd time: 16.6963 / Avg. bwd time: 25.4562 / Avg. batch time: 470.2589 (ms) / GPU bubble ratio: 28.29%
[rank2]:2025-10-29 03:07:09,003 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4706e+00
[rank0]:2025-10-29 03:07:09,010 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4599e+00
[rank1]:2025-10-29 03:07:09,007 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.3725e-01
[rank3]:2025-10-29 03:07:09,009 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0577e+00
[rank1]:2025-10-29 03:07:29,337 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0647e+00
[rank3]:2025-10-29 03:07:29,344 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5015e+00
[rank2]:2025-10-29 03:07:29,340 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.8104e-01
[rank0]:2025-10-29 03:07:29,348 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1788e-01
[rank1]:2025-10-29 03:07:49,620 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8554e-01
[rank2]:2025-10-29 03:07:49,617 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8026e+00
[rank0]:2025-10-29 03:07:49,624 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.2073e-01
[rank3]:2025-10-29 03:07:49,624 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7828e-01
[rank2]:2025-10-29 03:08:09,980 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6853e-01
[rank1]:2025-10-29 03:08:09,977 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.4019e-01
[rank0]:2025-10-29 03:08:09,988 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9552e-01
[rank3]:2025-10-29 03:08:09,984 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2174e+00
[rank0]:2025-10-29 03:08:28,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:08:30,165 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2317e-01
[rank2]:2025-10-29 03:08:30,166 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 64.04GiB(45.81%)  tps: 8,051  tflops: 375.49  mfu: 37.97%
[rank1]:2025-10-29 03:08:30,168 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.1459e-02
[rank1]:2025-10-29 03:08:30,168 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 72.05GiB(51.54%)  tps: 8,050  tflops: 375.47  mfu: 37.96%
[rank0]:2025-10-29 03:08:30,172 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5868e-01
[rank0]:2025-10-29 03:08:30,172 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.6395  memory: 73.46GiB(52.54%)  tps: 8,051  tflops: 375.49  mfu: 37.97%
[rank3]:2025-10-29 03:08:30,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2628e+00
[rank3]:2025-10-29 03:08:30,176 - INFO -  step: 1550  loss:  0.8153  grad_norm:  0.6395  memory: 79.24GiB(56.67%)  tps: 8,051  tflops: 375.48  mfu: 37.97%
[rank2]:2025-10-29 03:08:30,572 - INFO - Avg. fwd time: 14.4181 / Avg. bwd time: 24.0937 / Avg. batch time: 425.4828 (ms) / GPU bubble ratio: 27.59%
[rank3]:2025-10-29 03:08:30,532 - INFO - Avg. fwd time: 15.7488 / Avg. bwd time: 30.3952 / Avg. batch time: 384.7214 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-10-29 03:08:30,595 - INFO - Avg. fwd time: 16.7208 / Avg. bwd time: 25.3606 / Avg. batch time: 469.5941 (ms) / GPU bubble ratio: 28.31%
[rank0]:2025-10-29 03:08:30,615 - INFO - Avg. fwd time: 14.8269 / Avg. bwd time: 26.2898 / Avg. batch time: 512.4583 (ms) / GPU bubble ratio: 35.81%
[rank2]:2025-10-29 03:08:50,597 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.1185e-01
[rank1]:2025-10-29 03:08:50,594 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.2290e-01
[rank0]:2025-10-29 03:08:50,605 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9935e-01
[rank3]:2025-10-29 03:08:50,601 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4651e+00
[rank2]:2025-10-29 03:09:10,827 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8090e-01
[rank0]:2025-10-29 03:09:10,835 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.3977e-01
[rank3]:2025-10-29 03:09:10,834 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.0748e-01
[rank1]:2025-10-29 03:09:10,831 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.2399e-02
[rank2]:2025-10-29 03:09:31,168 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6272e-01
[rank0]:2025-10-29 03:09:31,175 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2910e-01
[rank3]:2025-10-29 03:09:31,171 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0881e+00
[rank1]:2025-10-29 03:09:31,165 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2341e-01
[rank3]:2025-10-29 03:09:51,290 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2471e+00
[rank2]:2025-10-29 03:09:51,284 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2694e+00
[rank0]:2025-10-29 03:09:51,291 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.4494e+00
[rank1]:2025-10-29 03:09:51,287 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1962e+00
[rank0]:2025-10-29 03:10:08,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:10:10,614 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1578e+00
[rank3]:2025-10-29 03:10:10,618 - INFO -  step: 1600  loss:  0.1182  grad_norm:  0.1906  memory: 79.24GiB(56.67%)  tps: 8,156  tflops: 380.40  mfu: 38.46%
[rank3]:2025-10-29 03:10:10,619 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 03:10:10,611 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0705e+00
[rank2]:2025-10-29 03:10:10,611 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 64.04GiB(45.81%)  tps: 8,156  tflops: 380.39  mfu: 38.46%
[rank2]:2025-10-29 03:10:10,611 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 03:10:10,618 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6048e-01
[rank0]:2025-10-29 03:10:10,618 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 73.46GiB(52.54%)  tps: 8,156  tflops: 380.38  mfu: 38.46%
[rank0]:2025-10-29 03:10:10,618 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 03:10:10,608 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.4291e-01
[rank1]:2025-10-29 03:10:10,608 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1906  memory: 72.05GiB(51.54%)  tps: 8,156  tflops: 380.40  mfu: 38.46%
[rank1]:2025-10-29 03:10:10,608 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 03:10:26,966 - INFO - validate step: 1600  loss:  0.2458  memory: 79.24GiB(56.67%)  tps: 25,058
[rank2]:2025-10-29 03:10:26,958 - INFO - validate step: 1600  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,057
[rank0]:2025-10-29 03:10:26,908 - INFO - validate step: 1600  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,145
[rank1]:2025-10-29 03:10:26,942 - INFO - validate step: 1600  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,077
[rank2]:2025-10-29 03:10:27,053 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0310_stage2_step1600.svg
[rank0]:2025-10-29 03:10:27,048 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0310_stage0_step1600.svg
[rank1]:2025-10-29 03:10:27,052 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0310_stage1_step1600.svg
[rank3]:2025-10-29 03:10:27,150 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0310_real_step1600_rank3.svg
[rank3]:> Batch Time: 484.78 ms, GPU Bubble Ratio: 34.23%, 33.69%, 40.88%, 25.75%
[rank3]:2025-10-29 03:10:27,219 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0310_stage3_step1600.svg
[rank3]:2025-10-29 03:10:27,507 - INFO - Avg. fwd time: 15.7711 / Avg. bwd time: 30.3077 / Avg. batch time: 384.1923 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-10-29 03:10:27,542 - INFO - Avg. fwd time: 14.4415 / Avg. bwd time: 23.9604 / Avg. batch time: 424.7999 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-10-29 03:10:27,583 - INFO - Avg. fwd time: 14.8508 / Avg. bwd time: 26.1463 / Avg. batch time: 511.4929 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-10-29 03:10:27,571 - INFO - Avg. fwd time: 16.7443 / Avg. bwd time: 25.2462 / Avg. batch time: 468.7700 (ms) / GPU bubble ratio: 28.34%
[rank3]:2025-10-29 03:10:46,172 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9257e+00
[rank2]:2025-10-29 03:10:46,166 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.7224e-01
[rank0]:2025-10-29 03:10:46,173 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4227e-01
[rank1]:2025-10-29 03:10:46,169 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.2879e-02
[rank3]:2025-10-29 03:11:05,497 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0776e-01
[rank2]:2025-10-29 03:11:05,494 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5242e+00
[rank0]:2025-10-29 03:11:05,501 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.0449e-01
[rank1]:2025-10-29 03:11:05,491 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1838e+00
[rank3]:2025-10-29 03:11:24,602 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.6495e-01
[rank2]:2025-10-29 03:11:24,596 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2489e-01
[rank0]:2025-10-29 03:11:24,603 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.1183e-01
[rank1]:2025-10-29 03:11:24,599 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0037e-01
[rank3]:2025-10-29 03:11:43,808 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.7524e-01
[rank2]:2025-10-29 03:11:43,805 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.1747e-01
[rank1]:2025-10-29 03:11:43,801 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3039e+00
[rank0]:2025-10-29 03:11:43,812 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3446e-01
[rank0]:2025-10-29 03:12:01,155 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:12:03,057 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0281e+00
[rank2]:2025-10-29 03:12:03,057 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 64.04GiB(45.81%)  tps: 8,525  tflops: 397.59  mfu: 40.20%
[rank1]:2025-10-29 03:12:03,060 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4255e-01
[rank1]:2025-10-29 03:12:03,061 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 72.05GiB(51.54%)  tps: 8,523  tflops: 397.51  mfu: 40.19%
[rank0]:2025-10-29 03:12:03,064 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7819e+00
[rank0]:2025-10-29 03:12:03,064 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1656  memory: 73.46GiB(52.54%)  tps: 8,519  tflops: 397.35  mfu: 40.18%
[rank3]:2025-10-29 03:12:03,063 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8415e+00
[rank3]:2025-10-29 03:12:03,066 - INFO -  step: 1650  loss:  0.1028  grad_norm:  0.1656  memory: 79.24GiB(56.67%)  tps: 8,525  tflops: 397.59  mfu: 40.20%
[rank3]:2025-10-29 03:12:03,480 - INFO - Avg. fwd time: 15.7721 / Avg. bwd time: 30.2054 / Avg. batch time: 383.3702 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 03:12:03,513 - INFO - Avg. fwd time: 14.4507 / Avg. bwd time: 23.8175 / Avg. batch time: 423.8247 (ms) / GPU bubble ratio: 27.77%
[rank1]:2025-10-29 03:12:03,544 - INFO - Avg. fwd time: 16.7504 / Avg. bwd time: 25.1387 / Avg. batch time: 467.6536 (ms) / GPU bubble ratio: 28.34%
[rank0]:2025-10-29 03:12:03,576 - INFO - Avg. fwd time: 14.8584 / Avg. bwd time: 25.9964 / Avg. batch time: 510.2142 (ms) / GPU bubble ratio: 35.94%
[rank3]:2025-10-29 03:12:22,265 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6569e+00
[rank2]:2025-10-29 03:12:22,262 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3361e+00
[rank1]:2025-10-29 03:12:22,259 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7174e+00
[rank0]:2025-10-29 03:12:22,269 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1074e+00
[rank2]:2025-10-29 03:12:41,388 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0255e+00
[rank1]:2025-10-29 03:12:41,391 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.5312e-01
[rank0]:2025-10-29 03:12:41,395 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3736e+00
[rank3]:2025-10-29 03:12:41,394 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.1481e-01
[rank3]:2025-10-29 03:13:00,754 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4554e+00
[rank2]:2025-10-29 03:13:00,750 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0805e+00
[rank0]:2025-10-29 03:13:00,758 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1761e-01
[rank1]:2025-10-29 03:13:00,747 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0714e+00
[rank3]:2025-10-29 03:13:19,816 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7249e+00
[rank2]:2025-10-29 03:13:19,809 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7976e-01
[rank0]:2025-10-29 03:13:19,817 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.3323e-01
[rank1]:2025-10-29 03:13:19,813 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3079e-01
[rank0]:2025-10-29 03:13:37,289 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:13:39,194 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.6720e-01
[rank3]:2025-10-29 03:13:39,196 - INFO -  step: 1700  loss:  0.1097  grad_norm:  0.1523  memory: 79.24GiB(56.67%)  tps: 8,522  tflops: 397.46  mfu: 40.19%
[rank2]:2025-10-29 03:13:39,190 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.7894e-01
[rank2]:2025-10-29 03:13:39,191 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 64.04GiB(45.81%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank0]:2025-10-29 03:13:39,197 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2716e-01
[rank0]:2025-10-29 03:13:39,198 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 73.46GiB(52.54%)  tps: 8,522  tflops: 397.44  mfu: 40.19%
[rank1]:2025-10-29 03:13:39,187 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.7601e-01
[rank1]:2025-10-29 03:13:39,188 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1523  memory: 72.05GiB(51.54%)  tps: 8,522  tflops: 397.47  mfu: 40.19%
[rank2]:2025-10-29 03:13:39,281 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0313_stage2_step1700.svg
[rank0]:2025-10-29 03:13:39,277 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0313_stage0_step1700.svg
[rank1]:2025-10-29 03:13:39,280 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0313_stage1_step1700.svg
[rank3]:2025-10-29 03:13:39,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0313_real_step1700_rank3.svg
[rank3]:> Batch Time: 483.50 ms, GPU Bubble Ratio: 34.09%, 33.62%, 40.79%, 25.78%
[rank3]:2025-10-29 03:13:39,444 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0313_stage3_step1700.svg
[rank3]:2025-10-29 03:13:39,724 - INFO - Avg. fwd time: 15.7727 / Avg. bwd time: 30.1232 / Avg. batch time: 382.7087 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-10-29 03:13:39,758 - INFO - Avg. fwd time: 14.4569 / Avg. bwd time: 23.7107 / Avg. batch time: 423.0307 (ms) / GPU bubble ratio: 27.82%
[rank0]:2025-10-29 03:13:39,799 - INFO - Avg. fwd time: 14.8633 / Avg. bwd time: 25.8840 / Avg. batch time: 509.1719 (ms) / GPU bubble ratio: 35.98%
[rank1]:2025-10-29 03:13:39,788 - INFO - Avg. fwd time: 16.7558 / Avg. bwd time: 25.0430 / Avg. batch time: 466.7344 (ms) / GPU bubble ratio: 28.36%
[rank3]:2025-10-29 03:13:58,525 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4015e+00
[rank2]:2025-10-29 03:13:58,519 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7353e+00
[rank0]:2025-10-29 03:13:58,526 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3987e+00
[rank1]:2025-10-29 03:13:58,522 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.6089e-01
[rank2]:2025-10-29 03:14:17,768 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.8925e-01
[rank1]:2025-10-29 03:14:17,765 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5350e+00
[rank3]:2025-10-29 03:14:17,772 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1781e+00
[rank0]:2025-10-29 03:14:17,775 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5344e-01
[rank3]:2025-10-29 03:14:37,027 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.1221e-01
[rank2]:2025-10-29 03:14:37,020 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0617e+00
[rank0]:2025-10-29 03:14:37,027 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2126e+00
[rank1]:2025-10-29 03:14:37,023 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8672e-01
[rank3]:2025-10-29 03:14:56,186 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9299e+00
[rank2]:2025-10-29 03:14:56,182 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8136e-01
[rank0]:2025-10-29 03:14:56,190 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3516e-01
[rank1]:2025-10-29 03:14:56,179 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.3373e-01
[rank0]:2025-10-29 03:15:13,428 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:15:15,323 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2572e+00
[rank2]:2025-10-29 03:15:15,323 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 64.04GiB(45.81%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank0]:2025-10-29 03:15:15,330 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8534e+00
[rank0]:2025-10-29 03:15:15,331 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 73.46GiB(52.54%)  tps: 8,522  tflops: 397.45  mfu: 40.19%
[rank1]:2025-10-29 03:15:15,326 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7549e-01
[rank1]:2025-10-29 03:15:15,327 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0860  memory: 72.05GiB(51.54%)  tps: 8,521  tflops: 397.42  mfu: 40.18%
[rank3]:2025-10-29 03:15:15,330 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8118e+00
[rank3]:2025-10-29 03:15:15,332 - INFO -  step: 1750  loss:  0.1102  grad_norm:  0.0860  memory: 79.24GiB(56.67%)  tps: 8,521  tflops: 397.44  mfu: 40.19%
[rank2]:2025-10-29 03:15:15,699 - INFO - Avg. fwd time: 14.4648 / Avg. bwd time: 23.5869 / Avg. batch time: 422.1719 (ms) / GPU bubble ratio: 27.89%
[rank1]:2025-10-29 03:15:15,721 - INFO - Avg. fwd time: 16.7610 / Avg. bwd time: 24.9442 / Avg. batch time: 465.7451 (ms) / GPU bubble ratio: 28.36%
[rank3]:2025-10-29 03:15:15,661 - INFO - Avg. fwd time: 15.7738 / Avg. bwd time: 30.0329 / Avg. batch time: 381.9848 (ms) / GPU bubble ratio: 4.07%
[rank0]:2025-10-29 03:15:15,741 - INFO - Avg. fwd time: 14.8694 / Avg. bwd time: 25.7535 / Avg. batch time: 508.0394 (ms) / GPU bubble ratio: 36.03%
[rank2]:2025-10-29 03:15:34,701 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6452e-01
[rank0]:2025-10-29 03:15:34,708 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0814e-01
[rank1]:2025-10-29 03:15:34,698 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.9964e-01
[rank3]:2025-10-29 03:15:34,704 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0847e+00
[rank2]:2025-10-29 03:15:53,750 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0694e+00
[rank1]:2025-10-29 03:15:53,753 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2768e-01
[rank3]:2025-10-29 03:15:53,757 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2114e+00
[rank0]:2025-10-29 03:15:53,757 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.8205e-01
[rank2]:2025-10-29 03:16:13,126 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.2973e-01
[rank0]:2025-10-29 03:16:13,133 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3919e-01
[rank1]:2025-10-29 03:16:13,123 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.2728e+00
[rank3]:2025-10-29 03:16:13,129 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4813e+00
[rank0]:2025-10-29 03:16:32,264 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.5156e-01
[rank2]:2025-10-29 03:16:32,257 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1671e+00
[rank1]:2025-10-29 03:16:32,260 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1738e-01
[rank3]:2025-10-29 03:16:32,264 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2862e+00
[rank0]:2025-10-29 03:16:49,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:16:51,478 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9372e-01
[rank0]:2025-10-29 03:16:51,479 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 73.46GiB(52.54%)  tps: 8,520  tflops: 397.38  mfu: 40.18%
[rank0]:2025-10-29 03:16:51,479 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 03:16:51,471 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9764e-01
[rank2]:2025-10-29 03:16:51,471 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 64.04GiB(45.81%)  tps: 8,520  tflops: 397.38  mfu: 40.18%
[rank2]:2025-10-29 03:16:51,471 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 03:16:51,475 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0470e+00
[rank3]:2025-10-29 03:16:51,480 - INFO -  step: 1800  loss:  0.0866  grad_norm:  0.0764  memory: 79.24GiB(56.67%)  tps: 8,521  tflops: 397.40  mfu: 40.18%
[rank3]:2025-10-29 03:16:51,481 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 03:16:51,468 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.8994e-01
[rank1]:2025-10-29 03:16:51,468 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0764  memory: 72.05GiB(51.54%)  tps: 8,521  tflops: 397.41  mfu: 40.18%
[rank1]:2025-10-29 03:16:51,468 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 03:17:07,853 - INFO - validate step: 1800  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,015
[rank2]:2025-10-29 03:17:07,903 - INFO - validate step: 1800  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,928
[rank3]:2025-10-29 03:17:07,917 - INFO - validate step: 1800  loss:  0.2425  memory: 79.24GiB(56.67%)  tps: 24,921
[rank1]:2025-10-29 03:17:07,886 - INFO - validate step: 1800  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,949
[rank0]:2025-10-29 03:17:08,000 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0317_stage0_step1800.svg
[rank2]:2025-10-29 03:17:08,001 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0317_stage2_step1800.svg
[rank1]:2025-10-29 03:17:08,001 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0317_stage1_step1800.svg
[rank3]:2025-10-29 03:17:08,101 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0317_real_step1800_rank3.svg
[rank3]:> Batch Time: 481.48 ms, GPU Bubble Ratio: 33.93%, 33.42%, 40.58%, 25.87%
[rank3]:2025-10-29 03:17:08,168 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0317_stage3_step1800.svg
[rank2]:2025-10-29 03:17:08,570 - INFO - Avg. fwd time: 14.4706 / Avg. bwd time: 23.4775 / Avg. batch time: 421.3678 (ms) / GPU bubble ratio: 27.95%
[rank3]:2025-10-29 03:17:08,541 - INFO - Avg. fwd time: 15.7745 / Avg. bwd time: 29.9478 / Avg. batch time: 381.2999 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-29 03:17:08,602 - INFO - Avg. fwd time: 16.7663 / Avg. bwd time: 24.8435 / Avg. batch time: 464.8106 (ms) / GPU bubble ratio: 28.38%
[rank0]:2025-10-29 03:17:08,633 - INFO - Avg. fwd time: 14.8735 / Avg. bwd time: 25.6380 / Avg. batch time: 506.9781 (ms) / GPU bubble ratio: 36.07%
[rank0]:2025-10-29 03:17:27,424 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.6678e+00
[rank2]:2025-10-29 03:17:27,417 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8288e+00
[rank3]:2025-10-29 03:17:27,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8062e+00
[rank1]:2025-10-29 03:17:27,420 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4838e+00
[rank0]:2025-10-29 03:17:46,577 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7158e+00
[rank2]:2025-10-29 03:17:46,570 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1414e+00
[rank3]:2025-10-29 03:17:46,573 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1737e+00
[rank1]:2025-10-29 03:17:46,566 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2671e+00
[rank0]:2025-10-29 03:18:05,700 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1982e+00
[rank2]:2025-10-29 03:18:05,693 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0798e+00
[rank3]:2025-10-29 03:18:05,699 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7027e+00
[rank1]:2025-10-29 03:18:05,696 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.5715e-01
[rank0]:2025-10-29 03:18:25,071 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3219e-01
[rank2]:2025-10-29 03:18:25,064 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4430e+00
[rank3]:2025-10-29 03:18:25,068 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0110e+00
[rank1]:2025-10-29 03:18:25,061 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.8127e+00
[rank0]:2025-10-29 03:18:42,173 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:18:44,088 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.8959e+00
[rank0]:2025-10-29 03:18:44,089 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 73.46GiB(52.54%)  tps: 8,512  tflops: 397.02  mfu: 40.14%
[rank2]:2025-10-29 03:18:44,081 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2053e+00
[rank2]:2025-10-29 03:18:44,082 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 64.04GiB(45.81%)  tps: 8,518  tflops: 397.26  mfu: 40.17%
[rank3]:2025-10-29 03:18:44,088 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3204e+00
[rank3]:2025-10-29 03:18:44,090 - INFO -  step: 1850  loss:  0.0766  grad_norm:  0.0830  memory: 79.24GiB(56.67%)  tps: 8,518  tflops: 397.28  mfu: 40.17%
[rank1]:2025-10-29 03:18:44,084 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6642e-01
[rank1]:2025-10-29 03:18:44,085 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0830  memory: 72.05GiB(51.54%)  tps: 8,516  tflops: 397.18  mfu: 40.16%
[rank2]:2025-10-29 03:18:44,461 - INFO - Avg. fwd time: 14.4766 / Avg. bwd time: 23.3809 / Avg. batch time: 420.6897 (ms) / GPU bubble ratio: 28.01%
[rank3]:2025-10-29 03:18:44,420 - INFO - Avg. fwd time: 15.7751 / Avg. bwd time: 29.8782 / Avg. batch time: 380.7408 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-10-29 03:18:44,483 - INFO - Avg. fwd time: 16.7700 / Avg. bwd time: 24.7696 / Avg. batch time: 464.0343 (ms) / GPU bubble ratio: 28.39%
[rank0]:2025-10-29 03:18:44,502 - INFO - Avg. fwd time: 14.8783 / Avg. bwd time: 25.5375 / Avg. batch time: 506.0914 (ms) / GPU bubble ratio: 36.11%
[rank1]:2025-10-29 03:19:03,416 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0417e-01
[rank0]:2025-10-29 03:19:03,427 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0569e+00
[rank2]:2025-10-29 03:19:03,420 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1968e-01
[rank3]:2025-10-29 03:19:03,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6910e+00
[rank2]:2025-10-29 03:19:22,537 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3327e+00
[rank0]:2025-10-29 03:19:22,544 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1557e+00
[rank3]:2025-10-29 03:19:22,543 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4406e+00
[rank1]:2025-10-29 03:19:22,540 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9249e-01
[rank0]:2025-10-29 03:19:41,796 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1907e-01
[rank2]:2025-10-29 03:19:41,789 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6890e-01
[rank3]:2025-10-29 03:19:41,792 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.8710e-01
[rank1]:2025-10-29 03:19:41,786 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.2258e-01
[rank2]:2025-10-29 03:20:01,031 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3322e-01
[rank0]:2025-10-29 03:20:01,038 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5556e+00
[rank1]:2025-10-29 03:20:01,034 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.0395e-02
[rank3]:2025-10-29 03:20:01,037 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3079e-01
[rank0]:2025-10-29 03:20:18,292 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:20:20,236 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.2051e-01
[rank3]:2025-10-29 03:20:20,238 - INFO -  step: 1900  loss:  0.0896  grad_norm:  0.0921  memory: 79.24GiB(56.67%)  tps: 8,520  tflops: 397.39  mfu: 40.18%
[rank2]:2025-10-29 03:20:20,232 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0359e-01
[rank2]:2025-10-29 03:20:20,233 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 64.04GiB(45.81%)  tps: 8,520  tflops: 397.37  mfu: 40.18%
[rank0]:2025-10-29 03:20:20,240 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7458e-01
[rank0]:2025-10-29 03:20:20,240 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 73.46GiB(52.54%)  tps: 8,520  tflops: 397.37  mfu: 40.18%
[rank1]:2025-10-29 03:20:20,229 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.8937e-01
[rank1]:2025-10-29 03:20:20,230 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 72.05GiB(51.54%)  tps: 8,520  tflops: 397.40  mfu: 40.18%
[rank2]:2025-10-29 03:20:20,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0320_stage2_step1900.svg
[rank0]:2025-10-29 03:20:20,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0320_stage0_step1900.svg
[rank1]:2025-10-29 03:20:20,322 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0320_stage1_step1900.svg
[rank3]:2025-10-29 03:20:20,427 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0320_real_step1900_rank3.svg
[rank3]:> Batch Time: 474.38 ms, GPU Bubble Ratio: 35.57%, 32.50%, 39.74%, 25.88%
[rank3]:2025-10-29 03:20:20,496 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0320_stage3_step1900.svg
[rank2]:2025-10-29 03:20:20,817 - INFO - Avg. fwd time: 14.4823 / Avg. bwd time: 23.2799 / Avg. batch time: 419.9462 (ms) / GPU bubble ratio: 28.06%
[rank0]:2025-10-29 03:20:20,858 - INFO - Avg. fwd time: 14.8829 / Avg. bwd time: 25.4318 / Avg. batch time: 505.1160 (ms) / GPU bubble ratio: 36.15%
[rank3]:2025-10-29 03:20:20,782 - INFO - Avg. fwd time: 15.7757 / Avg. bwd time: 29.8014 / Avg. batch time: 380.1232 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-10-29 03:20:20,846 - INFO - Avg. fwd time: 16.7748 / Avg. bwd time: 24.6822 / Avg. batch time: 463.1761 (ms) / GPU bubble ratio: 28.40%
[rank3]:2025-10-29 03:20:39,575 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7918e-01
[rank0]:2025-10-29 03:20:39,576 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3727e+00
[rank2]:2025-10-29 03:20:39,569 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2423e-01
[rank1]:2025-10-29 03:20:39,572 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.3769e-01
[rank3]:2025-10-29 03:20:58,908 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4898e+00
[rank2]:2025-10-29 03:20:58,905 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1142e-01
[rank1]:2025-10-29 03:20:58,901 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 9.0595e-01
[rank0]:2025-10-29 03:20:58,912 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3745e-01
[rank0]:2025-10-29 03:21:17,964 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.0975e-01
[rank1]:2025-10-29 03:21:17,960 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7746e-01
[rank3]:2025-10-29 03:21:17,963 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2774e+00
[rank2]:2025-10-29 03:21:17,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2428e+00
[rank0]:2025-10-29 03:21:37,323 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7164e-01
[rank1]:2025-10-29 03:21:37,313 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0173e+00
[rank3]:2025-10-29 03:21:37,319 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8193e+00
[rank2]:2025-10-29 03:21:37,316 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.5479e-01
[rank0]:2025-10-29 03:21:54,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:21:56,426 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4011e+00
[rank0]:2025-10-29 03:21:56,426 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 73.46GiB(52.54%)  tps: 8,517  tflops: 397.23  mfu: 40.16%
[rank1]:2025-10-29 03:21:56,422 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.0009e-01
[rank1]:2025-10-29 03:21:56,422 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 72.05GiB(51.54%)  tps: 8,516  tflops: 397.20  mfu: 40.16%
[rank2]:2025-10-29 03:21:56,419 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0335e+00
[rank2]:2025-10-29 03:21:56,419 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1280  memory: 64.04GiB(45.81%)  tps: 8,517  tflops: 397.23  mfu: 40.16%
[rank3]:2025-10-29 03:21:56,426 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8015e+00
[rank3]:2025-10-29 03:21:56,428 - INFO -  step: 1950  loss:  0.1214  grad_norm:  0.1280  memory: 79.24GiB(56.67%)  tps: 8,517  tflops: 397.22  mfu: 40.16%
[rank3]:2025-10-29 03:21:56,855 - INFO - Avg. fwd time: 15.7771 / Avg. bwd time: 29.7289 / Avg. batch time: 379.5454 (ms) / GPU bubble ratio: 4.08%
[rank0]:2025-10-29 03:21:56,952 - INFO - Avg. fwd time: 14.8884 / Avg. bwd time: 25.3254 / Avg. batch time: 504.2141 (ms) / GPU bubble ratio: 36.20%
[rank1]:2025-10-29 03:21:56,918 - INFO - Avg. fwd time: 16.7787 / Avg. bwd time: 24.6061 / Avg. batch time: 462.3908 (ms) / GPU bubble ratio: 28.40%
[rank2]:2025-10-29 03:21:56,888 - INFO - Avg. fwd time: 14.4892 / Avg. bwd time: 23.1779 / Avg. batch time: 419.2611 (ms) / GPU bubble ratio: 28.13%
[rank1]:2025-10-29 03:22:15,671 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7620e+00
[rank2]:2025-10-29 03:22:15,674 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.5284e-01
[rank3]:2025-10-29 03:22:15,678 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0648e+00
[rank0]:2025-10-29 03:22:15,681 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2903e+00
[rank0]:2025-10-29 03:22:34,942 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.7153e+00
[rank1]:2025-10-29 03:22:34,938 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8576e+00
[rank2]:2025-10-29 03:22:34,935 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.3488e+00
[rank3]:2025-10-29 03:22:34,942 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.8445e+00
[rank1]:2025-10-29 03:22:54,080 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2341e+01
[rank0]:2025-10-29 03:22:54,091 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8203e+01
[rank2]:2025-10-29 03:22:54,083 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9914e+01
[rank3]:2025-10-29 03:22:54,087 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8154e+01
[rank1]:2025-10-29 03:23:13,121 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1499e+00
[rank2]:2025-10-29 03:23:13,121 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8162e+00
[rank3]:2025-10-29 03:23:13,128 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6582e+00
[rank0]:2025-10-29 03:23:13,128 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.2876e+00
[rank0]:2025-10-29 03:23:30,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:23:32,480 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5579e+00
[rank1]:2025-10-29 03:23:32,481 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 72.05GiB(51.54%)  tps: 8,528  tflops: 397.75  mfu: 40.22%
[rank1]:2025-10-29 03:23:32,481 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 03:23:32,491 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.3670e-01
[rank0]:2025-10-29 03:23:32,491 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 73.46GiB(52.54%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank0]:2025-10-29 03:23:32,491 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 03:23:32,483 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.9969e-01
[rank2]:2025-10-29 03:23:32,484 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1331  memory: 64.04GiB(45.81%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank2]:2025-10-29 03:23:32,484 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 03:23:32,487 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3865e+00
[rank3]:2025-10-29 03:23:32,491 - INFO -  step: 2000  loss:  0.0996  grad_norm:  0.1331  memory: 79.24GiB(56.67%)  tps: 8,528  tflops: 397.74  mfu: 40.22%
[rank3]:2025-10-29 03:23:32,491 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 03:23:49,007 - INFO - validate step: 2000  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,785
[rank0]:2025-10-29 03:23:48,972 - INFO - validate step: 2000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,853
[rank2]:2025-10-29 03:23:49,024 - INFO - validate step: 2000  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,765
[rank3]:2025-10-29 03:23:49,029 - INFO - validate step: 2000  loss:  0.2443  memory: 79.24GiB(56.67%)  tps: 24,768
[rank1]:2025-10-29 03:23:49,116 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0323_stage1_step2000.svg
[rank0]:2025-10-29 03:23:49,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0323_stage0_step2000.svg
[rank2]:2025-10-29 03:23:49,119 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0323_stage2_step2000.svg
[rank3]:2025-10-29 03:23:49,212 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0323_real_step2000_rank3.svg
[rank3]:> Batch Time: 473.20 ms, GPU Bubble Ratio: 35.56%, 32.40%, 39.66%, 25.91%
[rank3]:2025-10-29 03:23:49,281 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0323_stage3_step2000.svg
[rank1]:2025-10-29 03:23:49,637 - INFO - Avg. fwd time: 16.7828 / Avg. bwd time: 24.5232 / Avg. batch time: 461.7090 (ms) / GPU bubble ratio: 28.43%
[rank0]:2025-10-29 03:23:49,647 - INFO - Avg. fwd time: 14.8912 / Avg. bwd time: 25.2454 / Avg. batch time: 503.4430 (ms) / GPU bubble ratio: 36.22%
[rank2]:2025-10-29 03:23:49,609 - INFO - Avg. fwd time: 14.4932 / Avg. bwd time: 23.1016 / Avg. batch time: 418.6852 (ms) / GPU bubble ratio: 28.17%
[rank3]:2025-10-29 03:23:49,573 - INFO - Avg. fwd time: 15.7774 / Avg. bwd time: 29.6694 / Avg. batch time: 379.0658 (ms) / GPU bubble ratio: 4.09%
[rank1]:2025-10-29 03:24:08,148 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.1284e-01
[rank0]:2025-10-29 03:24:08,155 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5023e-01
[rank2]:2025-10-29 03:24:08,148 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4596e-01
[rank3]:2025-10-29 03:24:08,155 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5873e+00
[rank2]:2025-10-29 03:24:27,498 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5918e-01
[rank1]:2025-10-29 03:24:27,495 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4545e-01
[rank0]:2025-10-29 03:24:27,505 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6839e-01
[rank3]:2025-10-29 03:24:27,502 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0959e+00
[rank0]:2025-10-29 03:24:46,519 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7208e+00
[rank2]:2025-10-29 03:24:46,512 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5611e+00
[rank1]:2025-10-29 03:24:46,512 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.4305e-01
[rank3]:2025-10-29 03:24:46,519 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0618e+00
[rank2]:2025-10-29 03:25:05,749 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.6756e-01
[rank1]:2025-10-29 03:25:05,746 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1081e+00
[rank0]:2025-10-29 03:25:05,756 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4361e-01
[rank3]:2025-10-29 03:25:05,753 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5863e+00
[rank0]:2025-10-29 03:25:23,039 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:25:24,956 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1213e+00
[rank0]:2025-10-29 03:25:24,957 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 73.46GiB(52.54%)  tps: 8,535  tflops: 398.06  mfu: 40.25%
[rank1]:2025-10-29 03:25:24,949 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1668e-01
[rank2]:2025-10-29 03:25:24,949 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3389e+00
[rank3]:2025-10-29 03:25:24,956 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7462e+00
[rank1]:2025-10-29 03:25:24,950 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 72.05GiB(51.54%)  tps: 8,539  tflops: 398.24  mfu: 40.27%
[rank3]:2025-10-29 03:25:24,959 - INFO -  step: 2050  loss:  0.1386  grad_norm:  0.1307  memory: 79.24GiB(56.67%)  tps: 8,540  tflops: 398.30  mfu: 40.27%
[rank2]:2025-10-29 03:25:24,950 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1307  memory: 64.04GiB(45.81%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank2]:2025-10-29 03:25:25,325 - INFO - Avg. fwd time: 14.4993 / Avg. bwd time: 23.0119 / Avg. batch time: 418.0775 (ms) / GPU bubble ratio: 28.22%
[rank3]:2025-10-29 03:25:25,286 - INFO - Avg. fwd time: 15.7793 / Avg. bwd time: 29.6044 / Avg. batch time: 378.5542 (ms) / GPU bubble ratio: 4.09%
[rank0]:2025-10-29 03:25:25,365 - INFO - Avg. fwd time: 14.8964 / Avg. bwd time: 25.1519 / Avg. batch time: 502.6018 (ms) / GPU bubble ratio: 36.25%
[rank1]:2025-10-29 03:25:25,346 - INFO - Avg. fwd time: 16.7910 / Avg. bwd time: 24.4172 / Avg. batch time: 460.9706 (ms) / GPU bubble ratio: 28.48%
[rank0]:2025-10-29 03:25:44,133 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0893e-01
[rank3]:2025-10-29 03:25:44,129 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8972e-01
[rank1]:2025-10-29 03:25:44,122 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0496e+00
[rank2]:2025-10-29 03:25:44,126 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7966e-01
[rank2]:2025-10-29 03:26:03,176 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3260e-01
[rank1]:2025-10-29 03:26:03,176 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0495e-01
[rank3]:2025-10-29 03:26:03,182 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0490e-01
[rank0]:2025-10-29 03:26:03,183 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.8326e-01
[rank3]:2025-10-29 03:26:22,554 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2416e-01
[rank0]:2025-10-29 03:26:22,558 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3983e-01
[rank2]:2025-10-29 03:26:22,550 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8445e-01
[rank1]:2025-10-29 03:26:22,547 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0093e+00
[rank0]:2025-10-29 03:26:41,458 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.9659e-01
[rank2]:2025-10-29 03:26:41,451 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6516e-01
[rank3]:2025-10-29 03:26:41,458 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4035e+00
[rank1]:2025-10-29 03:26:41,451 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.7591e-01
[rank0]:2025-10-29 03:26:58,912 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:27:00,824 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3793e-01
[rank0]:2025-10-29 03:27:00,824 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 73.46GiB(52.54%)  tps: 8,545  tflops: 398.55  mfu: 40.30%
[rank3]:2025-10-29 03:27:00,820 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2569e-01
[rank3]:2025-10-29 03:27:00,823 - INFO -  step: 2100  loss:  0.1186  grad_norm:  0.1124  memory: 79.24GiB(56.67%)  tps: 8,546  tflops: 398.56  mfu: 40.30%
[rank2]:2025-10-29 03:27:00,817 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0586e-01
[rank2]:2025-10-29 03:27:00,817 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 64.04GiB(45.81%)  tps: 8,545  tflops: 398.55  mfu: 40.30%
[rank1]:2025-10-29 03:27:00,814 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.9941e-01
[rank1]:2025-10-29 03:27:00,814 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1124  memory: 72.05GiB(51.54%)  tps: 8,545  tflops: 398.56  mfu: 40.30%
[rank0]:2025-10-29 03:27:00,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0327_stage0_step2100.svg
[rank2]:2025-10-29 03:27:00,903 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0327_stage2_step2100.svg
[rank1]:2025-10-29 03:27:00,902 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0327_stage1_step2100.svg
[rank3]:2025-10-29 03:27:01,005 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0327_real_step2100_rank3.svg
[rank3]:> Batch Time: 472.44 ms, GPU Bubble Ratio: 35.52%, 32.36%, 39.61%, 25.94%
[rank3]:2025-10-29 03:27:01,066 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0327_stage3_step2100.svg
[rank0]:2025-10-29 03:27:01,526 - INFO - Avg. fwd time: 14.9001 / Avg. bwd time: 25.0691 / Avg. batch time: 501.8044 (ms) / GPU bubble ratio: 36.28%
[rank1]:2025-10-29 03:27:01,496 - INFO - Avg. fwd time: 16.7978 / Avg. bwd time: 24.3162 / Avg. batch time: 460.2634 (ms) / GPU bubble ratio: 28.54%
[rank2]:2025-10-29 03:27:01,465 - INFO - Avg. fwd time: 14.5037 / Avg. bwd time: 22.9329 / Avg. batch time: 417.4942 (ms) / GPU bubble ratio: 28.26%
[rank3]:2025-10-29 03:27:01,435 - INFO - Avg. fwd time: 15.7801 / Avg. bwd time: 29.5421 / Avg. batch time: 378.0557 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-10-29 03:27:20,052 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5090e+00
[rank0]:2025-10-29 03:27:20,059 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8056e+00
[rank3]:2025-10-29 03:27:20,059 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6778e+00
[rank1]:2025-10-29 03:27:20,052 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2497e+00
[rank1]:2025-10-29 03:27:39,261 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4470e-01
[rank0]:2025-10-29 03:27:39,271 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9051e-01
[rank2]:2025-10-29 03:27:39,264 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6660e-01
[rank3]:2025-10-29 03:27:39,267 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1035e+00
[rank3]:2025-10-29 03:27:58,414 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2016e+00
[rank2]:2025-10-29 03:27:58,408 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5523e+00
[rank1]:2025-10-29 03:27:58,408 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9955e+00
[rank0]:2025-10-29 03:27:58,415 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8889e+00
[rank1]:2025-10-29 03:28:17,595 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1338e+00
[rank0]:2025-10-29 03:28:17,605 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3905e+00
[rank3]:2025-10-29 03:28:17,601 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7615e+00
[rank2]:2025-10-29 03:28:17,598 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3473e+00
[rank0]:2025-10-29 03:28:34,757 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:28:36,650 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6005e+00
[rank3]:2025-10-29 03:28:36,653 - INFO -  step: 2150  loss:  0.1533  grad_norm:  0.1153  memory: 79.24GiB(56.67%)  tps: 8,549  tflops: 398.71  mfu: 40.31%
[rank0]:2025-10-29 03:28:36,651 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3165e+00
[rank0]:2025-10-29 03:28:36,651 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 73.46GiB(52.54%)  tps: 8,549  tflops: 398.72  mfu: 40.32%
[rank2]:2025-10-29 03:28:36,644 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5428e+00
[rank2]:2025-10-29 03:28:36,644 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 64.04GiB(45.81%)  tps: 8,549  tflops: 398.72  mfu: 40.32%
[rank1]:2025-10-29 03:28:36,644 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9916e+00
[rank1]:2025-10-29 03:28:36,644 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1153  memory: 72.05GiB(51.54%)  tps: 8,548  tflops: 398.70  mfu: 40.31%
[rank3]:2025-10-29 03:28:36,983 - INFO - Avg. fwd time: 15.7808 / Avg. bwd time: 29.4916 / Avg. batch time: 377.6521 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:28:37,062 - INFO - Avg. fwd time: 14.9040 / Avg. bwd time: 24.9946 / Avg. batch time: 501.1291 (ms) / GPU bubble ratio: 36.31%
[rank2]:2025-10-29 03:28:37,021 - INFO - Avg. fwd time: 14.5085 / Avg. bwd time: 22.8615 / Avg. batch time: 417.0023 (ms) / GPU bubble ratio: 28.31%
[rank1]:2025-10-29 03:28:37,043 - INFO - Avg. fwd time: 16.8040 / Avg. bwd time: 24.2339 / Avg. batch time: 459.6699 (ms) / GPU bubble ratio: 28.58%
[rank2]:2025-10-29 03:28:56,028 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5886e+00
[rank1]:2025-10-29 03:28:56,025 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0531e+00
[rank3]:2025-10-29 03:28:56,032 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9810e+00
[rank0]:2025-10-29 03:28:56,036 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4272e+00
[rank2]:2025-10-29 03:29:14,946 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1883e+00
[rank1]:2025-10-29 03:29:14,946 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1001e+00
[rank0]:2025-10-29 03:29:14,953 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3844e+00
[rank3]:2025-10-29 03:29:14,953 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2774e+00
[rank0]:2025-10-29 03:29:34,326 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0735e+00
[rank3]:2025-10-29 03:29:34,323 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4851e+00
[rank2]:2025-10-29 03:29:34,319 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0539e+00
[rank1]:2025-10-29 03:29:34,316 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8497e+00
[rank2]:2025-10-29 03:29:53,307 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1237e+00
[rank3]:2025-10-29 03:29:53,313 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2052e+00
[rank0]:2025-10-29 03:29:53,314 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6486e+00
[rank1]:2025-10-29 03:29:53,307 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8339e+00
[rank0]:2025-10-29 03:30:10,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:30:12,557 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.6363e-01
[rank2]:2025-10-29 03:30:12,557 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 64.04GiB(45.81%)  tps: 8,541  tflops: 398.36  mfu: 40.28%
[rank2]:2025-10-29 03:30:12,557 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 03:30:12,564 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9651e-01
[rank0]:2025-10-29 03:30:12,564 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.36  mfu: 40.28%
[rank0]:2025-10-29 03:30:12,564 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 03:30:12,560 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2387e+00
[rank3]:2025-10-29 03:30:12,563 - INFO -  step: 2200  loss:  0.1005  grad_norm:  0.1071  memory: 79.24GiB(56.67%)  tps: 8,541  tflops: 398.38  mfu: 40.28%
[rank3]:2025-10-29 03:30:12,563 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 03:30:12,553 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5859e+00
[rank1]:2025-10-29 03:30:12,554 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1071  memory: 72.05GiB(51.54%)  tps: 8,541  tflops: 398.37  mfu: 40.28%
[rank1]:2025-10-29 03:30:12,554 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 03:30:29,094 - INFO - validate step: 2200  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,780
[rank2]:2025-10-29 03:30:29,144 - INFO - validate step: 2200  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,694
[rank3]:2025-10-29 03:30:29,151 - INFO - validate step: 2200  loss:  0.2431  memory: 79.24GiB(56.67%)  tps: 24,694
[rank1]:2025-10-29 03:30:29,128 - INFO - validate step: 2200  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,714
[rank0]:2025-10-29 03:30:29,230 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0330_stage0_step2200.svg
[rank2]:2025-10-29 03:30:29,231 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0330_stage2_step2200.svg
[rank1]:2025-10-29 03:30:29,227 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0330_stage1_step2200.svg
[rank3]:2025-10-29 03:30:29,341 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0330_real_step2200_rank3.svg
[rank3]:> Batch Time: 471.66 ms, GPU Bubble Ratio: 35.47%, 32.32%, 39.58%, 25.97%
[rank3]:2025-10-29 03:30:29,405 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0330_stage3_step2200.svg
[rank3]:2025-10-29 03:30:29,691 - INFO - Avg. fwd time: 15.7813 / Avg. bwd time: 29.4344 / Avg. batch time: 377.1926 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:30:29,765 - INFO - Avg. fwd time: 14.9068 / Avg. bwd time: 24.9165 / Avg. batch time: 500.3739 (ms) / GPU bubble ratio: 36.33%
[rank2]:2025-10-29 03:30:29,726 - INFO - Avg. fwd time: 14.5123 / Avg. bwd time: 22.7866 / Avg. batch time: 416.4481 (ms) / GPU bubble ratio: 28.35%
[rank1]:2025-10-29 03:30:29,751 - INFO - Avg. fwd time: 16.8096 / Avg. bwd time: 24.1416 / Avg. batch time: 459.0011 (ms) / GPU bubble ratio: 28.63%
[rank0]:2025-10-29 03:30:48,512 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8833e+00
[rank2]:2025-10-29 03:30:48,505 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.4815e+00
[rank3]:2025-10-29 03:30:48,511 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4028e+00
[rank1]:2025-10-29 03:30:48,504 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5613e+00
[rank0]:2025-10-29 03:31:07,674 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.6206e-01
[rank2]:2025-10-29 03:31:07,667 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.2026e-01
[rank1]:2025-10-29 03:31:07,664 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3126e+00
[rank3]:2025-10-29 03:31:07,670 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3656e+00
[rank0]:2025-10-29 03:31:26,693 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1426e+00
[rank2]:2025-10-29 03:31:26,686 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3931e+00
[rank1]:2025-10-29 03:31:26,686 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0564e+00
[rank3]:2025-10-29 03:31:26,693 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1283e+00
[rank0]:2025-10-29 03:31:46,071 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2476e-01
[rank1]:2025-10-29 03:31:46,061 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7499e-01
[rank2]:2025-10-29 03:31:46,064 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5465e-01
[rank3]:2025-10-29 03:31:46,067 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7801e+00
[rank0]:2025-10-29 03:32:03,099 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:32:05,009 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3680e-01
[rank0]:2025-10-29 03:32:05,009 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.35  mfu: 40.28%
[rank2]:2025-10-29 03:32:05,002 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3868e+00
[rank2]:2025-10-29 03:32:05,002 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 64.04GiB(45.81%)  tps: 8,546  tflops: 398.59  mfu: 40.30%
[rank1]:2025-10-29 03:32:05,002 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2846e+00
[rank1]:2025-10-29 03:32:05,002 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1046  memory: 72.05GiB(51.54%)  tps: 8,545  tflops: 398.52  mfu: 40.30%
[rank3]:2025-10-29 03:32:05,009 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4019e-01
[rank3]:2025-10-29 03:32:05,012 - INFO -  step: 2250  loss:  0.1254  grad_norm:  0.1046  memory: 79.24GiB(56.67%)  tps: 8,546  tflops: 398.58  mfu: 40.30%
[rank2]:2025-10-29 03:32:05,465 - INFO - Avg. fwd time: 14.5170 / Avg. bwd time: 22.7095 / Avg. batch time: 415.9310 (ms) / GPU bubble ratio: 28.40%
[rank3]:2025-10-29 03:32:05,431 - INFO - Avg. fwd time: 15.7819 / Avg. bwd time: 29.3800 / Avg. batch time: 376.7556 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-10-29 03:32:05,533 - INFO - Avg. fwd time: 14.9104 / Avg. bwd time: 24.8360 / Avg. batch time: 499.6609 (ms) / GPU bubble ratio: 36.36%
[rank1]:2025-10-29 03:32:05,498 - INFO - Avg. fwd time: 16.8147 / Avg. bwd time: 24.0533 / Avg. batch time: 458.3759 (ms) / GPU bubble ratio: 28.67%
[rank1]:2025-10-29 03:32:24,430 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5800e+00
[rank3]:2025-10-29 03:32:24,436 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2203e+00
[rank0]:2025-10-29 03:32:24,440 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2302e+00
[rank2]:2025-10-29 03:32:24,433 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3204e+00
[rank1]:2025-10-29 03:32:43,447 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.9967e-01
[rank2]:2025-10-29 03:32:43,447 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.5761e-01
[rank0]:2025-10-29 03:32:43,454 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4430e+00
[rank3]:2025-10-29 03:32:43,454 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0633e+00
[rank2]:2025-10-29 03:33:02,677 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0213e-01
[rank0]:2025-10-29 03:33:02,685 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5358e-01
[rank3]:2025-10-29 03:33:02,681 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.4359e-01
[rank1]:2025-10-29 03:33:02,674 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.7353e-01
[rank0]:2025-10-29 03:33:21,860 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.2577e-01
[rank2]:2025-10-29 03:33:21,853 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1237e+00
[rank1]:2025-10-29 03:33:21,853 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0638e-01
[rank3]:2025-10-29 03:33:21,859 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5949e+00
[rank0]:2025-10-29 03:33:39,086 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:33:41,035 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4332e+00
[rank0]:2025-10-29 03:33:41,036 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 73.46GiB(52.54%)  tps: 8,531  tflops: 397.89  mfu: 40.23%
[rank1]:2025-10-29 03:33:41,025 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9204e+00
[rank1]:2025-10-29 03:33:41,025 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 72.05GiB(51.54%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank2]:2025-10-29 03:33:41,028 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1447e+00
[rank2]:2025-10-29 03:33:41,029 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0960  memory: 64.04GiB(45.81%)  tps: 8,531  tflops: 397.89  mfu: 40.23%
[rank3]:2025-10-29 03:33:41,032 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6788e+00
[rank3]:2025-10-29 03:33:41,034 - INFO -  step: 2300  loss:  0.0911  grad_norm:  0.0960  memory: 79.24GiB(56.67%)  tps: 8,531  tflops: 397.91  mfu: 40.23%
[rank0]:2025-10-29 03:33:41,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0333_stage0_step2300.svg
[rank1]:2025-10-29 03:33:41,115 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0333_stage1_step2300.svg
[rank2]:2025-10-29 03:33:41,115 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0333_stage2_step2300.svg
[rank3]:2025-10-29 03:33:41,219 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0333_real_step2300_rank3.svg
[rank3]:> Batch Time: 471.04 ms, GPU Bubble Ratio: 35.44%, 32.30%, 39.56%, 25.99%
[rank3]:2025-10-29 03:33:41,280 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0333_stage3_step2300.svg
[rank3]:2025-10-29 03:33:41,570 - INFO - Avg. fwd time: 15.7828 / Avg. bwd time: 29.3358 / Avg. batch time: 376.4049 (ms) / GPU bubble ratio: 4.11%
[rank0]:2025-10-29 03:33:41,643 - INFO - Avg. fwd time: 14.9130 / Avg. bwd time: 24.7763 / Avg. batch time: 499.0828 (ms) / GPU bubble ratio: 36.38%
[rank1]:2025-10-29 03:33:41,629 - INFO - Avg. fwd time: 16.8191 / Avg. bwd time: 23.9807 / Avg. batch time: 457.8635 (ms) / GPU bubble ratio: 28.71%
[rank2]:2025-10-29 03:33:41,605 - INFO - Avg. fwd time: 14.5205 / Avg. bwd time: 22.6527 / Avg. batch time: 415.5079 (ms) / GPU bubble ratio: 28.43%
[rank3]:2025-10-29 03:34:00,282 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1285e+00
[rank0]:2025-10-29 03:34:00,283 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.0386e+00
[rank2]:2025-10-29 03:34:00,276 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7913e+00
[rank1]:2025-10-29 03:34:00,276 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6351e+00
[rank3]:2025-10-29 03:34:19,668 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8436e+00
[rank1]:2025-10-29 03:34:19,662 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8137e-01
[rank0]:2025-10-29 03:34:19,672 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6422e-01
[rank2]:2025-10-29 03:34:19,665 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6789e-01
[rank3]:2025-10-29 03:34:38,588 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4383e+00
[rank2]:2025-10-29 03:34:38,581 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.3625e-01
[rank1]:2025-10-29 03:34:38,581 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8512e-01
[rank0]:2025-10-29 03:34:38,588 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.2849e-01
[rank1]:2025-10-29 03:34:57,922 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8115e-01
[rank3]:2025-10-29 03:34:57,928 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.7002e-01
[rank2]:2025-10-29 03:34:57,925 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5849e-01
[rank0]:2025-10-29 03:34:57,932 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2549e-01
[rank0]:2025-10-29 03:35:15,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:35:16,954 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7164e+00
[rank3]:2025-10-29 03:35:16,957 - INFO -  step: 2350  loss:  0.1136  grad_norm:  0.1114  memory: 79.24GiB(56.67%)  tps: 8,540  tflops: 398.32  mfu: 40.28%
[rank2]:2025-10-29 03:35:16,948 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8556e+00
[rank2]:2025-10-29 03:35:16,948 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 64.04GiB(45.81%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank1]:2025-10-29 03:35:16,948 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6520e+00
[rank1]:2025-10-29 03:35:16,948 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 72.05GiB(51.54%)  tps: 8,540  tflops: 398.32  mfu: 40.27%
[rank0]:2025-10-29 03:35:16,955 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8754e+00
[rank0]:2025-10-29 03:35:16,955 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1114  memory: 73.46GiB(52.54%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank3]:2025-10-29 03:35:17,294 - INFO - Avg. fwd time: 15.7837 / Avg. bwd time: 29.2863 / Avg. batch time: 376.0110 (ms) / GPU bubble ratio: 4.11%
[rank2]:2025-10-29 03:35:17,334 - INFO - Avg. fwd time: 14.5247 / Avg. bwd time: 22.5844 / Avg. batch time: 415.0413 (ms) / GPU bubble ratio: 28.47%
[rank1]:2025-10-29 03:35:17,357 - INFO - Avg. fwd time: 16.8242 / Avg. bwd time: 23.8999 / Avg. batch time: 457.2971 (ms) / GPU bubble ratio: 28.76%
[rank0]:2025-10-29 03:35:17,375 - INFO - Avg. fwd time: 14.9166 / Avg. bwd time: 24.7050 / Avg. batch time: 498.4380 (ms) / GPU bubble ratio: 36.41%
[rank2]:2025-10-29 03:35:36,183 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2533e+00
[rank1]:2025-10-29 03:35:36,180 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8036e+00
[rank3]:2025-10-29 03:35:36,187 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0690e+00
[rank0]:2025-10-29 03:35:36,190 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0012e+00
[rank2]:2025-10-29 03:35:55,356 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8057e+00
[rank1]:2025-10-29 03:35:55,356 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7597e+00
[rank3]:2025-10-29 03:35:55,363 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6311e+00
[rank0]:2025-10-29 03:35:55,363 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1851e+00
[rank2]:2025-10-29 03:36:14,541 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2298e-01
[rank3]:2025-10-29 03:36:14,544 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8232e+00
[rank1]:2025-10-29 03:36:14,538 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3833e+00
[rank0]:2025-10-29 03:36:14,548 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8836e-01
[rank0]:2025-10-29 03:36:33,578 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.2595e-01
[rank2]:2025-10-29 03:36:33,571 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3569e+00
[rank1]:2025-10-29 03:36:33,571 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.5479e-01
[rank3]:2025-10-29 03:36:33,577 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3223e-01
[rank0]:2025-10-29 03:36:50,980 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:36:52,945 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6070e-01
[rank1]:2025-10-29 03:36:52,945 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 72.05GiB(51.54%)  tps: 8,534  tflops: 398.01  mfu: 40.24%
[rank1]:2025-10-29 03:36:52,945 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,102  tflops: 377.87  mfu: 37.14%
[rank1]:2025-10-29 03:36:52,945 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 03:36:52,948 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9517e+00
[rank2]:2025-10-29 03:36:52,948 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 64.04GiB(45.81%)  tps: 8,533  tflops: 398.00  mfu: 40.24%
[rank2]:2025-10-29 03:36:52,949 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,101  tflops: 377.85  mfu: 37.14%
[rank2]:2025-10-29 03:36:52,949 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:36:52,951 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3785e+00
[rank0]:2025-10-29 03:36:52,955 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7168e-01
[rank0]:2025-10-29 03:36:52,955 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1272  memory: 73.46GiB(52.54%)  tps: 8,533  tflops: 398.00  mfu: 40.24%
[rank0]:2025-10-29 03:36:52,956 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.1272  tps: 8,100  tflops: 377.81  mfu: 37.14%
[rank0]:2025-10-29 03:36:52,956 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 03:36:52,954 - INFO -  step: 2400  loss:  0.1014  grad_norm:  0.1272  memory: 79.24GiB(56.67%)  tps: 8,534  tflops: 398.01  mfu: 40.24%
[rank3]:2025-10-29 03:36:52,955 - INFO -  final step: 2400  loss:  0.1014  grad_norm:  0.1272  tps: 8,105  tflops: 378.01  mfu: 37.15%
[rank3]:2025-10-29 03:36:52,955 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 03:37:09,449 - INFO - validate step: 2400  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 24,835
[rank0]:2025-10-29 03:37:09,450 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 03:37:09,453 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 03:37:09,500 - INFO - validate step: 2400  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 24,748
[rank2]:2025-10-29 03:37:09,501 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 03:37:09,503 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 03:37:09,484 - INFO - validate step: 2400  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 24,767
[rank1]:2025-10-29 03:37:09,485 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 03:37:09,488 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 03:37:09,509 - INFO - validate step: 2400  loss:  0.2434  memory: 79.24GiB(56.67%)  tps: 24,744
[rank3]:2025-10-29 03:37:09,510 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 03:37:09,516 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 03:37:20,692 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 03:37:20,840 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank0/251029_0337_stage0_final2400.svg
[rank2]:2025-10-29 03:37:20,800 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank2/251029_0337_stage2_final2400.svg
[rank1]:2025-10-29 03:37:20,797 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank1/251029_0337_stage1_final2400.svg
[rank3]:2025-10-29 03:37:20,882 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0337_real_final2400_rank3.svg
[rank3]:> Batch Time: 470.50 ms, GPU Bubble Ratio: 35.39%, 32.30%, 39.53%, 26.00%
[rank3]:2025-10-29 03:37:21,051 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/pipeline_schedule/251029_0337_thry_final2400_rank3.svg
[rank3]:> Batch Time: 512.22 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 03:37:21,090 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank2_stage2.svg
[rank2]:	> Counts Sum: 11763, Total Sum: 16920 (69.52%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 71.91, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 25.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-29 03:37:21,090 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 03:37:21,113 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank1_stage1.svg
[rank1]:	> Counts Sum: 14508, Total Sum: 19035 (76.22%), Ratio(%) per element: [97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 94.46, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 72.34, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 34.89, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-29 03:37:21,114 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 03:37:21,114 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/freeze_ratio_history/rank3/251029_0337_stage3_final2400.svg
[rank0]:2025-10-29 03:37:21,296 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank0_stage0.svg
[rank0]:	> Counts Sum: 11592, Total Sum: 17155 (67.57%), Ratio(%) per element: [0.0, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 94.04, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 84.68, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 25.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-29 03:37:21,296 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 03:37:21,335 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1/frozen_params_histogram/251029_0337_rank3_stage3.svg
[rank3]:	> Counts Sum: 11385, Total Sum: 15275 (74.53%), Ratio(%) per element: [98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 98.29, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 97.87, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 94.89, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 85.1, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 63.82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-29 03:37:21,336 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.02153
[rank3]:wandb:               final/avg_loss 0.10141
[rank3]:wandb:             final/avg_mfu(%) 37.15263
[rank3]:wandb:             final/avg_tflops 378.00629
[rank3]:wandb:    final/avg_throughput(tps) 8104.73811
[rank3]:wandb:              final/grad_norm 0.1272
[rank3]:wandb:               final/max_loss 0.10141
[rank3]:wandb:                    grad_norm 0.1272
[rank3]:wandb: loss_metrics/global_avg_loss 0.10141
[rank3]:wandb: loss_metrics/global_max_loss 0.10141
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/zn6bleq8
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_auto_dm1/20251029-0211/wandb/run-20251029_021116-zn6bleq8/logs
[rank0]:2025-10-29 03:37:23,296 - INFO - Training completed
[rank0]:2025-10-29 03:37:23,296 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 03:37:23,760 - INFO - Process group destroyed
[rank2]:2025-10-29 03:37:23,770 - INFO - Process group destroyed
[rank1]:2025-10-29 03:37:23,701 - INFO - Process group destroyed
[rank3]:2025-10-29 03:37:23,694 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.1', 'layers.6', 'layers.0', 'layers.7', 'layers.5', 'layers.3', 'tok_embeddings', 'layers.2'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.21', 'layers.24', 'layers.23', 'layers.22', 'layers.17', 'layers.20', 'layers.18'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.8', 'layers.12', 'layers.10', 'layers.9', 'layers.16', 'layers.14', 'layers.11', 'layers.15'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.27', 'layers.26', 'layers.28', 'output', 'layers.31', 'layers.30', 'norm', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 03:37:32 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] 
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] *****************************************
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 03:37:33.648000 1518225 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-10-29 03:37:39,334 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 03:37:39,437 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 03:37:39,462 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 03:37:39,569 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 03:37:40,142 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 03:37:40,145 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 03:37:40,431 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 03:37:40,432 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 03:37:40,411 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 03:37:40,413 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:37:40,462 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 03:37:40,465 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 03:37:40,470 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 03:37:42,421 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 03:37:42,717 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 03:37:44,255 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 03:37:45,807 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 03:37:45,978 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-29 03:37:46,050 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 03:37:46,050 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:46,125 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 03:37:46,066 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 03:37:46,118 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 03:37:46,143 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 03:37:46,143 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:46,202 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 03:37:46,203 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 03:37:46,251 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 03:37:46,252 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-29 03:37:46,430 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 03:37:46,430 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 03:37:46,368 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 03:37:46,368 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run i08zgsmr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1/20251029-0337/wandb/run-20251029_033746-i08zgsmr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/i08zgsmr
[rank3]:2025-10-29 03:37:47,993 - INFO - WandB logging enabled
[rank3]:2025-10-29 03:37:47,994 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 03:37:48,069 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 03:37:48,069 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:48,281 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank0]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:48,281 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 03:37:48,269 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 03:37:48,270 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 03:37:48,281 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 03:37:51,709 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 03:37:51,709 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 03:38:01,129 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 03:38:01,130 - INFO - Finished loading the checkpoint in 9.42 seconds.
[rank0]:2025-10-29 03:38:01,130 - INFO - Training starts at step 1
[rank0]:2025-10-29 03:38:05,993 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 49.75GiB(35.58%)  tps: 824  tflops: 38.45  mfu: 3.89%
[rank0]:2025-10-29 03:38:05,994 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 03:38:05,975 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 49.69GiB(35.54%)  tps: 827  tflops: 38.59  mfu: 3.90%
[rank1]:2025-10-29 03:38:05,976 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 03:38:05,977 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.3708  memory: 58.03GiB(41.50%)  tps: 914  tflops: 42.62  mfu: 4.31%
[rank3]:2025-10-29 03:38:05,978 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:38:05,974 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3708  memory: 44.28GiB(31.67%)  tps: 821  tflops: 38.31  mfu: 3.87%
[rank2]:2025-10-29 03:38:05,974 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,441 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,442 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 03:38:24,443 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,397 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,398 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,399 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,400 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 03:38:24,401 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,485 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,486 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,487 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,528 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:38:24,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 03:38:24,488 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 03:40:15,870 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:40:18,604 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 64.32GiB(46.00%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank2]:2025-10-29 03:40:18,601 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 57.29GiB(40.97%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank3]:2025-10-29 03:40:18,606 - INFO -  step: 50  loss:  3.2514  grad_norm: 16.1512  memory: 73.38GiB(52.48%)  tps: 6,053  tflops: 282.32  mfu: 28.55%
[rank0]:2025-10-29 03:40:18,608 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.1512  memory: 66.72GiB(47.72%)  tps: 6,054  tflops: 282.35  mfu: 28.55%
[rank3]:2025-10-29 03:40:19,069 - INFO - Avg. fwd time: 14.8050 / Avg. bwd time: 43.1365 / Avg. batch time: 484.7553 (ms) / GPU bubble ratio: 4.38%
[rank1]:2025-10-29 03:40:19,167 - INFO - Avg. fwd time: 15.2321 / Avg. bwd time: 41.0241 / Avg. batch time: 598.1378 (ms) / GPU bubble ratio: 24.76%
[rank2]:2025-10-29 03:40:19,120 - INFO - Avg. fwd time: 13.3992 / Avg. bwd time: 36.5862 / Avg. batch time: 538.2795 (ms) / GPU bubble ratio: 25.71%
[rank0]:2025-10-29 03:40:19,200 - INFO - Avg. fwd time: 14.2054 / Avg. bwd time: 38.1712 / Avg. batch time: 653.5159 (ms) / GPU bubble ratio: 35.88%
[rank3]:2025-10-29 03:40:45,446 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 03:41:12,540 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 03:41:12,756 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-10-29 03:41:12,881 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,915 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,864 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,897 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:12,866 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:12,890 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,858 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,874 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:12,890 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,950 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:12,993 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:12,929 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,029 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,067 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,105 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,032 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,069 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,107 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,041 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,079 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,117 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,100 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:13,143 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,145 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 03:41:13,183 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,155 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,193 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,137 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,176 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,216 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 03:41:13,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 03:41:13,254 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 03:41:46,361 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 03:41:46,671 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_max_batch_time.svg
[rank3]:> Batch Time: 634.28 ms, GPU Bubble Ratio: 33.80%, 28.02%, 36.56%, 26.32%
[rank3]:2025-10-29 03:41:46,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_min_batch_time.svg
[rank3]:> Batch Time: 358.78 ms, GPU Bubble Ratio: 68.97%, 24.19%, 33.56%, 23.50%
[rank3]:2025-10-29 03:41:47,082 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0341_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.78 ms, GPU Bubble Ratio: 32.09%, 23.23%, 29.08%, 23.50%
[rank3]:2025-10-29 03:41:47,083 - INFO - 	> Batch Time: 358.78 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 03:42:01,986 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 03:42:03,652 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.91, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 03:42:03,633 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.28/0.84, [MB3] 0.29/0.87, [MB4] 0.30/0.91, [MB5] 0.31/0.94, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 03:42:03,651 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,798  tflops: 363.71  mfu: 36.78%
[rank1]:2025-10-29 03:42:03,653 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,798  tflops: 363.71  mfu: 36.78%
[rank3]:2025-10-29 03:42:03,618 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 03:42:03,652 - INFO -  step: 100  loss:  2.4528  grad_norm:  0.0000  memory: 84.59GiB(60.50%)  tps: 7,799  tflops: 363.73  mfu: 36.78%
[rank0]:2025-10-29 03:42:03,652 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.19/0.56, [MB7] 0.33/1.00
[rank0]:2025-10-29 03:42:03,652 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,799  tflops: 363.73  mfu: 36.78%
[rank2]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0342_stage2_step100.svg
[rank1]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0342_stage1_step100.svg
[rank0]:2025-10-29 03:42:03,729 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0342_stage0_step100.svg
[rank3]:2025-10-29 03:42:03,834 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0342_real_step100_rank3.svg
[rank3]:> Batch Time: 631.96 ms, GPU Bubble Ratio: 33.68%, 28.10%, 36.43%, 26.25%
[rank0]:2025-10-29 03:42:03,825 - INFO - Avg. fwd time: 14.5982 / Avg. bwd time: 27.4813 / Avg. batch time: 582.2292 (ms) / GPU bubble ratio: 42.18%
[rank3]:2025-10-29 03:42:03,896 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0342_stage3_step100.svg
[rank3]:2025-10-29 03:42:04,164 - INFO - Avg. fwd time: 15.5666 / Avg. bwd time: 36.5185 / Avg. batch time: 435.6104 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-10-29 03:42:04,186 - INFO - Avg. fwd time: 14.0379 / Avg. bwd time: 30.9046 / Avg. batch time: 484.4686 (ms) / GPU bubble ratio: 25.79%
[rank1]:2025-10-29 03:42:04,212 - INFO - Avg. fwd time: 16.1693 / Avg. bwd time: 34.7983 / Avg. batch time: 537.8812 (ms) / GPU bubble ratio: 24.19%
[rank0]:2025-10-29 03:43:50,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:43:52,848 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-10-29 03:43:52,939 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.56/0.84, [MB3] 0.58/0.87, [MB4] 0.60/0.91, [MB5] 0.63/0.94, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank1]:2025-10-29 03:43:52,969 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.61/0.91, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 03:43:52,998 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 72.81GiB(52.08%)  tps: 7,492  tflops: 349.42  mfu: 35.33%
[rank3]:2025-10-29 03:43:52,998 - INFO -  step: 150  loss:  1.1602  grad_norm:  0.2062  memory: 86.11GiB(61.59%)  tps: 7,492  tflops: 349.42  mfu: 35.33%
[rank2]:2025-10-29 03:43:53,000 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 64.67GiB(46.25%)  tps: 7,492  tflops: 349.41  mfu: 35.33%
[rank0]:2025-10-29 03:43:52,991 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.37/0.56, [MB7] 0.67/1.00
[rank0]:2025-10-29 03:43:52,997 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2062  memory: 72.54GiB(51.88%)  tps: 7,492  tflops: 349.43  mfu: 35.33%
[rank3]:2025-10-29 03:43:53,417 - INFO - Avg. fwd time: 15.7969 / Avg. bwd time: 34.0124 / Avg. batch time: 416.1354 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-29 03:43:53,445 - INFO - Avg. fwd time: 14.1622 / Avg. bwd time: 29.3397 / Avg. batch time: 464.3881 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-10-29 03:43:53,475 - INFO - Avg. fwd time: 16.3500 / Avg. bwd time: 32.5039 / Avg. batch time: 516.6364 (ms) / GPU bubble ratio: 24.35%
[rank0]:2025-10-29 03:43:53,501 - INFO - Avg. fwd time: 14.7235 / Avg. bwd time: 26.6225 / Avg. batch time: 560.2172 (ms) / GPU bubble ratio: 40.96%
[rank0]:2025-10-29 03:45:26,025 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:45:27,724 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.84/0.84, [MB3] 0.87/0.87, [MB4] 0.91/0.91, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:45:27,641 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 64.90GiB(46.42%)  tps: 8,646  tflops: 403.23  mfu: 40.77%
[rank2]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss:  0.9320  grad_norm:  0.0634  memory: 86.11GiB(61.59%)  tps: 8,646  tflops: 403.23  mfu: 40.77%
[rank3]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 03:45:27,746 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 74.10GiB(53.00%)  tps: 8,645  tflops: 403.23  mfu: 40.77%
[rank1]:2025-10-29 03:45:27,753 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 03:45:27,753 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:45:27,753 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0634  memory: 72.54GiB(51.88%)  tps: 8,645  tflops: 403.22  mfu: 40.77%
[rank0]:2025-10-29 03:45:27,754 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 03:45:45,529 - INFO - validate step: 200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 23,043
[rank1]:2025-10-29 03:45:45,504 - INFO - validate step: 200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 23,075
[rank0]:2025-10-29 03:45:45,468 - INFO - validate step: 200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 23,123
[rank2]:2025-10-29 03:45:45,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0345_stage2_step200.svg
[rank3]:2025-10-29 03:45:45,553 - INFO - validate step: 200  loss:  0.2415  memory: 86.11GiB(61.59%)  tps: 23,013
[rank1]:2025-10-29 03:45:45,630 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0345_stage1_step200.svg
[rank0]:2025-10-29 03:45:45,626 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0345_stage0_step200.svg
[rank3]:2025-10-29 03:45:45,740 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0345_real_step200_rank3.svg
[rank3]:> Batch Time: 502.30 ms, GPU Bubble Ratio: 34.11%, 27.97%, 35.93%, 26.84%
[rank3]:2025-10-29 03:45:45,807 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0345_stage3_step200.svg
[rank0]:2025-10-29 03:45:45,762 - INFO - Avg. fwd time: 14.9083 / Avg. bwd time: 24.3428 / Avg. batch time: 536.6707 (ms) / GPU bubble ratio: 41.49%
[rank2]:2025-10-29 03:45:46,098 - INFO - Avg. fwd time: 14.3708 / Avg. bwd time: 27.2645 / Avg. batch time: 445.5535 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 03:45:46,074 - INFO - Avg. fwd time: 16.0128 / Avg. bwd time: 31.8321 / Avg. batch time: 399.8652 (ms) / GPU bubble ratio: 4.28%
[rank1]:2025-10-29 03:45:46,126 - INFO - Avg. fwd time: 16.5855 / Avg. bwd time: 30.2525 / Avg. batch time: 495.4200 (ms) / GPU bubble ratio: 24.37%
[rank0]:2025-10-29 03:47:06,999 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:47:08,637 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.84/0.84, [MB3] 0.87/0.87, [MB4] 0.91/0.91, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:47:08,656 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,855  tflops: 459.63  mfu: 46.47%
[rank3]:2025-10-29 03:47:08,623 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss:  0.9256  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,858  tflops: 459.77  mfu: 46.49%
[rank1]:2025-10-29 03:47:08,656 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,852  tflops: 459.49  mfu: 46.46%
[rank0]:2025-10-29 03:47:08,657 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:47:08,657 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,847  tflops: 459.29  mfu: 46.44%
[rank0]:2025-10-29 03:47:08,753 - INFO - Avg. fwd time: 15.1067 / Avg. bwd time: 19.3038 / Avg. batch time: 507.3678 (ms) / GPU bubble ratio: 45.74%
[rank2]:2025-10-29 03:47:08,991 - INFO - Avg. fwd time: 14.6250 / Avg. bwd time: 24.9895 / Avg. batch time: 424.0850 (ms) / GPU bubble ratio: 25.27%
[rank3]:2025-10-29 03:47:08,969 - INFO - Avg. fwd time: 16.3123 / Avg. bwd time: 29.2257 / Avg. batch time: 381.0217 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 03:47:09,017 - INFO - Avg. fwd time: 16.8788 / Avg. bwd time: 27.8092 / Avg. batch time: 471.2932 (ms) / GPU bubble ratio: 24.14%
[rank0]:2025-10-29 03:48:29,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:48:31,657 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank3_trend_line.svg
[rank2]:2025-10-29 03:48:31,660 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank2_trend_line.svg
[rank1]:2025-10-29 03:48:31,686 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank1_trend_line.svg
[rank1]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,685 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0348_rank0_trend_line.svg
[rank0]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:48:31,694 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,866  tflops: 460.13  mfu: 46.52%
[rank2]:2025-10-29 03:48:31,692 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.80/0.80, [MB5] 0.87/0.87, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.80/0.80, [MB5] 0.87/0.87, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:48:31,693 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,865  tflops: 460.12  mfu: 46.52%
[rank1]:2025-10-29 03:48:31,693 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/0.67, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:48:31,693 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,866  tflops: 460.13  mfu: 46.52%
[rank3]:2025-10-29 03:48:31,891 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0348_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 363.33 ms, GPU Bubble Ratio: 40.20%, 23.23%, 31.91%, 24.13%
[rank3]:2025-10-29 03:48:31,892 - INFO - 	> Batch Time: 363.33 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 03:48:31,892 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:48:31,893 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:48:31,896 - INFO -  step: 300  loss:  0.8513  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,842  tflops: 459.01  mfu: 46.41%
[rank2]:2025-10-29 03:48:31,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0348_stage2_step300.svg
[rank1]:2025-10-29 03:48:31,966 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0348_stage1_step300.svg
[rank0]:2025-10-29 03:48:31,964 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0348_stage0_step300.svg
[rank3]:2025-10-29 03:48:32,074 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0348_real_step300_rank3.svg
[rank3]:> Batch Time: 433.46 ms, GPU Bubble Ratio: 39.15%, 26.85%, 35.63%, 26.32%
[rank3]:2025-10-29 03:48:32,139 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0348_stage3_step300.svg
[rank3]:2025-10-29 03:48:32,471 - INFO - Avg. fwd time: 16.5045 / Avg. bwd time: 27.5194 / Avg. batch time: 368.6605 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-29 03:48:32,492 - INFO - Avg. fwd time: 14.7917 / Avg. bwd time: 23.4873 / Avg. batch time: 409.9877 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 03:48:32,516 - INFO - Avg. fwd time: 17.0623 / Avg. bwd time: 26.1859 / Avg. batch time: 455.3915 (ms) / GPU bubble ratio: 24.02%
[rank0]:2025-10-29 03:48:32,521 - INFO - Avg. fwd time: 15.2317 / Avg. bwd time: 15.9290 / Avg. batch time: 487.9953 (ms) / GPU bubble ratio: 48.92%
[rank0]:2025-10-29 03:49:53,205 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 03:49:54,862 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,850  tflops: 459.40  mfu: 46.45%
[rank3]:2025-10-29 03:49:54,864 - INFO -  step: 350  loss:  0.8848  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,874  tflops: 460.52  mfu: 46.56%
[rank0]:2025-10-29 03:49:54,863 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,850  tflops: 459.39  mfu: 46.45%
[rank1]:2025-10-29 03:49:54,863 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,850  tflops: 459.39  mfu: 46.45%
[rank0]:2025-10-29 03:49:54,964 - INFO - Avg. fwd time: 15.3092 / Avg. bwd time: 13.8533 / Avg. batch time: 475.9730 (ms) / GPU bubble ratio: 50.98%
[rank2]:2025-10-29 03:49:55,205 - INFO - Avg. fwd time: 14.8967 / Avg. bwd time: 22.5638 / Avg. batch time: 401.2230 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-10-29 03:49:55,183 - INFO - Avg. fwd time: 16.6230 / Avg. bwd time: 26.4673 / Avg. batch time: 361.0420 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-29 03:49:55,230 - INFO - Avg. fwd time: 17.1715 / Avg. bwd time: 25.1847 / Avg. batch time: 445.5054 (ms) / GPU bubble ratio: 23.94%
[rank0]:2025-10-29 03:51:15,001 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 03:51:16,767 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank2_trend_line.svg
[rank2]:2025-10-29 03:51:16,793 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.74/0.74, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,999  tflops: 466.33  mfu: 47.15%
[rank2]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 03:51:16,756 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank3_trend_line.svg
[rank0]:2025-10-29 03:51:16,788 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank0_trend_line.svg
[rank0]:2025-10-29 03:51:16,794 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank0]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 03:51:16,784 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0351_rank1_trend_line.svg
[rank1]:2025-10-29 03:51:16,793 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.65/0.65, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:51:16,795 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,999  tflops: 466.34  mfu: 47.15%
[rank1]:2025-10-29 03:51:16,795 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 03:51:16,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0351_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.55 ms, GPU Bubble Ratio: 53.57%, 23.27%, 31.92%, 24.16%
[rank3]:2025-10-29 03:51:16,985 - INFO - 	> Batch Time: 362.55 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 03:51:16,985 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:51:16,989 - INFO -  step: 400  loss:  0.2454  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,975  tflops: 465.24  mfu: 47.04%
[rank3]:2025-10-29 03:51:16,990 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 03:51:33,529 - INFO - validate step: 400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,478
[rank0]:2025-10-29 03:51:33,456 - INFO - validate step: 400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,585
[rank1]:2025-10-29 03:51:33,493 - INFO - validate step: 400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,530
[rank3]:2025-10-29 03:51:33,553 - INFO - validate step: 400  loss:  0.2392  memory: 86.11GiB(61.59%)  tps: 24,729
[rank2]:2025-10-29 03:51:33,632 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0351_stage2_step400.svg
[rank0]:2025-10-29 03:51:33,633 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0351_stage0_step400.svg
[rank1]:2025-10-29 03:51:33,633 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0351_stage1_step400.svg
[rank3]:2025-10-29 03:51:33,730 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0351_real_step400_rank3.svg
[rank3]:> Batch Time: 383.39 ms, GPU Bubble Ratio: 67.26%, 24.02%, 33.24%, 23.15%
[rank0]:2025-10-29 03:51:33,717 - INFO - Avg. fwd time: 15.3607 / Avg. bwd time: 12.0252 / Avg. batch time: 465.0628 (ms) / GPU bubble ratio: 52.89%
[rank3]:2025-10-29 03:51:33,797 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0351_stage3_step400.svg
[rank3]:2025-10-29 03:51:34,043 - INFO - Avg. fwd time: 16.7069 / Avg. bwd time: 25.5265 / Avg. batch time: 354.0501 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 03:51:34,064 - INFO - Avg. fwd time: 14.9731 / Avg. bwd time: 21.7434 / Avg. batch time: 393.2040 (ms) / GPU bubble ratio: 25.30%
[rank1]:2025-10-29 03:51:34,089 - INFO - Avg. fwd time: 17.2478 / Avg. bwd time: 24.2947 / Avg. batch time: 436.4869 (ms) / GPU bubble ratio: 23.86%
[rank0]:2025-10-29 03:52:49,994 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-29 03:52:51,549 - INFO -  step: 450  loss:  0.2560  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,503  tflops: 489.88  mfu: 49.53%
[rank2]:2025-10-29 03:52:51,548 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,500  tflops: 489.72  mfu: 49.52%
[rank0]:2025-10-29 03:52:51,549 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,490  tflops: 489.26  mfu: 49.47%
[rank1]:2025-10-29 03:52:51,550 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,495  tflops: 489.49  mfu: 49.49%
[rank3]:2025-10-29 03:52:51,904 - INFO - Avg. fwd time: 16.6955 / Avg. bwd time: 24.7476 / Avg. batch time: 347.6098 (ms) / GPU bubble ratio: 4.62%
[rank2]:2025-10-29 03:52:51,926 - INFO - Avg. fwd time: 14.9774 / Avg. bwd time: 21.0881 / Avg. batch time: 385.9690 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 03:52:51,955 - INFO - Avg. fwd time: 15.3404 / Avg. bwd time: 10.6234 / Avg. batch time: 455.5550 (ms) / GPU bubble ratio: 54.40%
[rank1]:2025-10-29 03:52:51,950 - INFO - Avg. fwd time: 17.2448 / Avg. bwd time: 23.5900 / Avg. batch time: 428.4703 (ms) / GPU bubble ratio: 23.76%
[rank0]:2025-10-29 03:54:07,493 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss:  0.2602  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,573  tflops: 493.12  mfu: 49.86%
[rank2]:2025-10-29 03:54:09,032 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank0]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank1]:2025-10-29 03:54:09,033 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,573  tflops: 493.11  mfu: 49.86%
[rank2]:2025-10-29 03:54:09,105 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0354_stage2_step500.svg
[rank0]:2025-10-29 03:54:09,104 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0354_stage0_step500.svg
[rank1]:2025-10-29 03:54:09,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0354_stage1_step500.svg
[rank3]:2025-10-29 03:54:09,210 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0354_real_step500_rank3.svg
[rank3]:> Batch Time: 380.12 ms, GPU Bubble Ratio: 67.31%, 23.98%, 33.34%, 23.29%
[rank0]:2025-10-29 03:54:09,189 - INFO - Avg. fwd time: 15.3239 / Avg. bwd time: 9.6585 / Avg. batch time: 448.8093 (ms) / GPU bubble ratio: 55.47%
[rank3]:2025-10-29 03:54:09,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0354_stage3_step500.svg
[rank3]:2025-10-29 03:54:09,513 - INFO - Avg. fwd time: 16.6798 / Avg. bwd time: 24.2015 / Avg. batch time: 343.0325 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 03:54:09,534 - INFO - Avg. fwd time: 14.9790 / Avg. bwd time: 20.6367 / Avg. batch time: 380.7897 (ms) / GPU bubble ratio: 25.18%
[rank1]:2025-10-29 03:54:09,560 - INFO - Avg. fwd time: 17.2400 / Avg. bwd time: 23.1034 / Avg. batch time: 422.7563 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-29 03:55:25,263 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss:  0.2778  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,533  tflops: 491.27  mfu: 49.67%
[rank2]:2025-10-29 03:55:26,807 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank0]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank1]:2025-10-29 03:55:26,808 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,533  tflops: 491.26  mfu: 49.67%
[rank0]:2025-10-29 03:55:26,893 - INFO - Avg. fwd time: 15.3091 / Avg. bwd time: 8.7331 / Avg. batch time: 442.4677 (ms) / GPU bubble ratio: 56.53%
[rank3]:2025-10-29 03:55:27,098 - INFO - Avg. fwd time: 16.6687 / Avg. bwd time: 23.6827 / Avg. batch time: 338.7145 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 03:55:27,120 - INFO - Avg. fwd time: 14.9814 / Avg. bwd time: 20.2044 / Avg. batch time: 375.9501 (ms) / GPU bubble ratio: 25.13%
[rank1]:2025-10-29 03:55:27,144 - INFO - Avg. fwd time: 17.2336 / Avg. bwd time: 22.6374 / Avg. batch time: 417.4030 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-10-29 03:56:42,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 03:56:44,780 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank0_trend_line.svg
[rank0]:2025-10-29 03:56:44,785 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,505  tflops: 489.98  mfu: 49.54%
[rank0]:2025-10-29 03:56:44,787 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:56:44,751 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank3_trend_line.svg
[rank2]:2025-10-29 03:56:44,769 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank2_trend_line.svg
[rank2]:2025-10-29 03:56:44,786 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.72/0.72, [MB2] 0.72/0.72, [MB3] 0.72/0.72, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank2]:2025-10-29 03:56:44,788 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 03:56:44,780 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0356_rank1_trend_line.svg
[rank1]:2025-10-29 03:56:44,785 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.62/0.62, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 03:56:44,787 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,505  tflops: 489.97  mfu: 49.54%
[rank1]:2025-10-29 03:56:44,787 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 03:56:44,979 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0356_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.68 ms, GPU Bubble Ratio: 60.41%, 22.89%, 31.59%, 23.84%
[rank3]:2025-10-29 03:56:44,979 - INFO - 	> Batch Time: 357.68 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 03:56:44,980 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 03:56:44,984 - INFO -  step: 600  loss:  0.2381  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,479  tflops: 488.74  mfu: 49.42%
[rank3]:2025-10-29 03:56:44,984 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 03:57:01,485 - INFO - validate step: 600  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,531
[rank3]:2025-10-29 03:57:01,576 - INFO - validate step: 600  loss:  0.2407  memory: 86.11GiB(61.59%)  tps: 24,688
[rank2]:2025-10-29 03:57:01,553 - INFO - validate step: 600  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,432
[rank1]:2025-10-29 03:57:01,521 - INFO - validate step: 600  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,477
[rank0]:2025-10-29 03:57:01,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0357_stage0_step600.svg
[rank2]:2025-10-29 03:57:01,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0357_stage2_step600.svg
[rank1]:2025-10-29 03:57:01,653 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0357_stage1_step600.svg
[rank3]:2025-10-29 03:57:01,756 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0357_real_step600_rank3.svg
[rank3]:> Batch Time: 377.73 ms, GPU Bubble Ratio: 67.37%, 23.95%, 33.23%, 23.27%
[rank3]:2025-10-29 03:57:01,820 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0357_stage3_step600.svg
[rank0]:2025-10-29 03:57:02,185 - INFO - Avg. fwd time: 15.2956 / Avg. bwd time: 7.9695 / Avg. batch time: 437.2576 (ms) / GPU bubble ratio: 57.43%
[rank3]:2025-10-29 03:57:02,132 - INFO - Avg. fwd time: 16.6609 / Avg. bwd time: 23.2573 / Avg. batch time: 335.1847 (ms) / GPU bubble ratio: 4.73%
[rank2]:2025-10-29 03:57:02,154 - INFO - Avg. fwd time: 14.9824 / Avg. bwd time: 19.8480 / Avg. batch time: 371.9899 (ms) / GPU bubble ratio: 25.09%
[rank1]:2025-10-29 03:57:02,178 - INFO - Avg. fwd time: 17.2262 / Avg. bwd time: 22.2511 / Avg. batch time: 413.0076 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-10-29 03:58:54,163 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 03:58:56,475 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1078  memory: 72.54GiB(51.88%)  tps: 7,124  tflops: 332.27  mfu: 33.60%
[rank2]:2025-10-29 03:58:56,447 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,130  tflops: 332.55  mfu: 33.62%
[rank3]:2025-10-29 03:58:56,448 - INFO -  step: 650  loss:  0.1212  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,132  tflops: 332.62  mfu: 33.63%
[rank1]:2025-10-29 03:58:56,447 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,128  tflops: 332.46  mfu: 33.62%
[rank2]:2025-10-29 03:58:56,786 - INFO - Avg. fwd time: 14.9839 / Avg. bwd time: 19.5842 / Avg. batch time: 370.1420 (ms) / GPU bubble ratio: 25.29%
[rank3]:2025-10-29 03:58:56,765 - INFO - Avg. fwd time: 16.6493 / Avg. bwd time: 22.9394 / Avg. batch time: 332.5003 (ms) / GPU bubble ratio: 4.75%
[rank1]:2025-10-29 03:58:56,845 - INFO - Avg. fwd time: 17.2115 / Avg. bwd time: 21.9502 / Avg. batch time: 415.0399 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-10-29 03:58:56,965 - INFO - Avg. fwd time: 15.1836 / Avg. bwd time: 10.0963 / Avg. batch time: 445.6289 (ms) / GPU bubble ratio: 54.62%
[rank0]:2025-10-29 04:00:48,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:00:51,299 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank0]:2025-10-29 04:00:51,326 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0887  memory: 72.54GiB(51.88%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank3]:2025-10-29 04:00:51,300 - INFO -  step: 700  loss:  0.1358  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank2]:2025-10-29 04:00:51,299 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 04:00:51,404 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0400_stage1_step700.svg
[rank0]:2025-10-29 04:00:51,403 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0400_stage0_step700.svg
[rank2]:2025-10-29 04:00:51,402 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0400_stage2_step700.svg
[rank3]:2025-10-29 04:00:51,504 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0400_real_step700_rank3.svg
[rank3]:> Batch Time: 375.74 ms, GPU Bubble Ratio: 67.45%, 23.91%, 33.10%, 23.29%
[rank3]:2025-10-29 04:00:51,571 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0400_stage3_step700.svg
[rank3]:2025-10-29 04:00:51,815 - INFO - Avg. fwd time: 16.6347 / Avg. bwd time: 22.6175 / Avg. batch time: 329.7581 (ms) / GPU bubble ratio: 4.77%
[rank2]:2025-10-29 04:00:51,836 - INFO - Avg. fwd time: 14.9833 / Avg. bwd time: 19.3204 / Avg. batch time: 368.2615 (ms) / GPU bubble ratio: 25.48%
[rank1]:2025-10-29 04:00:51,895 - INFO - Avg. fwd time: 17.1949 / Avg. bwd time: 21.6498 / Avg. batch time: 417.0583 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-10-29 04:00:52,014 - INFO - Avg. fwd time: 15.0710 / Avg. bwd time: 12.2330 / Avg. batch time: 454.0194 (ms) / GPU bubble ratio: 51.89%
[rank0]:2025-10-29 04:02:43,989 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:02:46,298 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank0]:2025-10-29 04:02:46,325 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1105  memory: 72.54GiB(51.88%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank3]:2025-10-29 04:02:46,299 - INFO -  step: 750  loss:  0.1670  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,124  tflops: 332.25  mfu: 33.59%
[rank2]:2025-10-29 04:02:46,298 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,124  tflops: 332.24  mfu: 33.59%
[rank3]:2025-10-29 04:02:46,686 - INFO - Avg. fwd time: 16.6223 / Avg. bwd time: 22.3414 / Avg. batch time: 327.4075 (ms) / GPU bubble ratio: 4.79%
[rank2]:2025-10-29 04:02:46,714 - INFO - Avg. fwd time: 14.9834 / Avg. bwd time: 19.0962 / Avg. batch time: 366.6895 (ms) / GPU bubble ratio: 25.65%
[rank1]:2025-10-29 04:02:46,794 - INFO - Avg. fwd time: 17.1800 / Avg. bwd time: 21.3916 / Avg. batch time: 418.8379 (ms) / GPU bubble ratio: 26.33%
[rank0]:2025-10-29 04:02:46,892 - INFO - Avg. fwd time: 14.9736 / Avg. bwd time: 14.0715 / Avg. batch time: 461.2846 (ms) / GPU bubble ratio: 49.63%
[rank0]:2025-10-29 04:04:38,862 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:04:41,486 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank2_trend_line.svg
[rank1]:2025-10-29 04:04:41,497 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank1_trend_line.svg
[rank3]:2025-10-29 04:04:41,493 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank3_trend_line.svg
[rank2]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.69/0.69, [MB2] 0.69/0.69, [MB3] 0.69/0.69, [MB4] 0.77/0.77, [MB5] 0.84/0.84, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:04:41,585 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 7,106  tflops: 331.42  mfu: 33.51%
[rank2]:2025-10-29 04:04:41,585 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.59/0.59, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:04:41,584 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 7,106  tflops: 331.42  mfu: 33.51%
[rank1]:2025-10-29 04:04:41,584 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:04:41,576 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0404_rank0_trend_line.svg
[rank0]:2025-10-29 04:04:41,582 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:04:41,585 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0946  memory: 72.54GiB(51.88%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank0]:2025-10-29 04:04:41,585 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 04:04:41,774 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0404_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.23 ms, GPU Bubble Ratio: 36.25%, 22.91%, 31.37%, 23.89%
[rank3]:2025-10-29 04:04:41,775 - INFO - 	> Batch Time: 356.23 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 04:04:41,775 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:04:41,780 - INFO -  step: 800  loss:  0.1462  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 7,094  tflops: 330.86  mfu: 33.45%
[rank3]:2025-10-29 04:04:41,781 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 04:04:58,250 - INFO - validate step: 800  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,578
[rank2]:2025-10-29 04:04:58,297 - INFO - validate step: 800  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,510
[rank1]:2025-10-29 04:04:58,282 - INFO - validate step: 800  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,531
[rank3]:2025-10-29 04:04:58,317 - INFO - validate step: 800  loss:  0.2367  memory: 86.11GiB(61.59%)  tps: 24,770
[rank2]:2025-10-29 04:04:58,396 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0404_stage2_step800.svg
[rank1]:2025-10-29 04:04:58,398 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0404_stage1_step800.svg
[rank0]:2025-10-29 04:04:58,401 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0404_stage0_step800.svg
[rank3]:2025-10-29 04:04:58,498 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0404_real_step800_rank3.svg
[rank3]:> Batch Time: 373.37 ms, GPU Bubble Ratio: 67.45%, 23.71%, 32.87%, 23.40%
[rank3]:2025-10-29 04:04:58,567 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0404_stage3_step800.svg
[rank3]:2025-10-29 04:04:58,816 - INFO - Avg. fwd time: 16.6120 / Avg. bwd time: 22.1333 / Avg. batch time: 325.6280 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 04:04:58,838 - INFO - Avg. fwd time: 14.9825 / Avg. bwd time: 18.9279 / Avg. batch time: 365.4737 (ms) / GPU bubble ratio: 25.77%
[rank1]:2025-10-29 04:04:58,894 - INFO - Avg. fwd time: 17.1675 / Avg. bwd time: 21.1984 / Avg. batch time: 420.1393 (ms) / GPU bubble ratio: 26.95%
[rank0]:2025-10-29 04:04:59,009 - INFO - Avg. fwd time: 14.8997 / Avg. bwd time: 15.4547 / Avg. batch time: 466.7124 (ms) / GPU bubble ratio: 47.97%
[rank0]:2025-10-29 04:06:15,121 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,449  tflops: 487.36  mfu: 49.28%
[rank0]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,445  tflops: 487.16  mfu: 49.26%
[rank2]:2025-10-29 04:06:16,679 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,451  tflops: 487.46  mfu: 49.29%
[rank3]:2025-10-29 04:06:16,680 - INFO -  step: 850  loss:  0.1682  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,454  tflops: 487.58  mfu: 49.30%
[rank0]:2025-10-29 04:06:16,765 - INFO - Avg. fwd time: 14.9111 / Avg. bwd time: 14.7249 / Avg. batch time: 462.5954 (ms) / GPU bubble ratio: 48.75%
[rank3]:2025-10-29 04:06:16,966 - INFO - Avg. fwd time: 16.6104 / Avg. bwd time: 21.9273 / Avg. batch time: 323.9378 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 04:06:16,988 - INFO - Avg. fwd time: 14.9831 / Avg. bwd time: 18.7550 / Avg. batch time: 363.4136 (ms) / GPU bubble ratio: 25.73%
[rank1]:2025-10-29 04:06:17,013 - INFO - Avg. fwd time: 17.1700 / Avg. bwd time: 21.0207 / Avg. batch time: 417.3382 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-10-29 04:07:32,957 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank2]:2025-10-29 04:07:34,496 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank3]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss:  0.1552  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,527  tflops: 491.00  mfu: 49.65%
[rank1]:2025-10-29 04:07:34,497 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,527  tflops: 490.99  mfu: 49.65%
[rank0]:2025-10-29 04:07:34,568 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0407_stage0_step900.svg
[rank2]:2025-10-29 04:07:34,569 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0407_stage2_step900.svg
[rank1]:2025-10-29 04:07:34,568 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0407_stage1_step900.svg
[rank3]:2025-10-29 04:07:34,676 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0407_real_step900_rank3.svg
[rank3]:> Batch Time: 372.33 ms, GPU Bubble Ratio: 67.35%, 23.55%, 32.80%, 23.46%
[rank3]:2025-10-29 04:07:34,736 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0407_stage3_step900.svg
[rank0]:2025-10-29 04:07:35,098 - INFO - Avg. fwd time: 14.9263 / Avg. bwd time: 13.8664 / Avg. batch time: 457.9863 (ms) / GPU bubble ratio: 49.71%
[rank2]:2025-10-29 04:07:35,066 - INFO - Avg. fwd time: 14.9839 / Avg. bwd time: 18.6031 / Avg. batch time: 361.5267 (ms) / GPU bubble ratio: 25.68%
[rank3]:2025-10-29 04:07:35,043 - INFO - Avg. fwd time: 16.6096 / Avg. bwd time: 21.7474 / Avg. batch time: 322.4663 (ms) / GPU bubble ratio: 4.84%
[rank1]:2025-10-29 04:07:35,092 - INFO - Avg. fwd time: 17.1714 / Avg. bwd time: 20.8621 / Avg. batch time: 414.4478 (ms) / GPU bubble ratio: 26.58%
[rank0]:2025-10-29 04:08:50,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank2]:2025-10-29 04:08:52,449 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank3]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss:  0.1804  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,509  tflops: 490.15  mfu: 49.56%
[rank1]:2025-10-29 04:08:52,450 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank0]:2025-10-29 04:08:52,536 - INFO - Avg. fwd time: 14.9377 / Avg. bwd time: 13.2064 / Avg. batch time: 454.4178 (ms) / GPU bubble ratio: 50.45%
[rank2]:2025-10-29 04:08:52,761 - INFO - Avg. fwd time: 14.9849 / Avg. bwd time: 18.4862 / Avg. batch time: 360.0606 (ms) / GPU bubble ratio: 25.63%
[rank3]:2025-10-29 04:08:52,740 - INFO - Avg. fwd time: 16.6102 / Avg. bwd time: 21.6095 / Avg. batch time: 321.3476 (ms) / GPU bubble ratio: 4.85%
[rank1]:2025-10-29 04:08:52,786 - INFO - Avg. fwd time: 17.1711 / Avg. bwd time: 20.7392 / Avg. batch time: 412.2031 (ms) / GPU bubble ratio: 26.42%
[rank0]:2025-10-29 04:10:08,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss:  0.1545  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,541  tflops: 491.65  mfu: 49.71%
[rank3]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank1]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:10:10,165 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank0]:2025-10-29 04:10:10,165 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 04:10:10,164 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank2]:2025-10-29 04:10:10,164 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 04:10:26,787 - INFO - validate step: 1000  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,642
[rank2]:2025-10-29 04:10:26,858 - INFO - validate step: 1000  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,536
[rank3]:2025-10-29 04:10:26,879 - INFO - validate step: 1000  loss:  0.2358  memory: 86.11GiB(61.59%)  tps: 24,508
[rank1]:2025-10-29 04:10:26,825 - INFO - validate step: 1000  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,586
[rank1]:2025-10-29 04:10:26,957 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0410_stage1_step1000.svg
[rank0]:2025-10-29 04:10:26,959 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0410_stage0_step1000.svg
[rank2]:2025-10-29 04:10:26,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0410_stage2_step1000.svg
[rank3]:2025-10-29 04:10:27,063 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0410_real_step1000_rank3.svg
[rank3]:> Batch Time: 371.87 ms, GPU Bubble Ratio: 67.31%, 23.52%, 32.77%, 23.46%
[rank0]:2025-10-29 04:10:27,045 - INFO - Avg. fwd time: 14.9479 / Avg. bwd time: 12.5117 / Avg. batch time: 450.6334 (ms) / GPU bubble ratio: 51.25%
[rank3]:2025-10-29 04:10:27,125 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0410_stage3_step1000.svg
[rank3]:2025-10-29 04:10:27,371 - INFO - Avg. fwd time: 16.6085 / Avg. bwd time: 21.4634 / Avg. batch time: 320.1433 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 04:10:27,394 - INFO - Avg. fwd time: 14.9849 / Avg. bwd time: 18.3630 / Avg. batch time: 358.4886 (ms) / GPU bubble ratio: 25.58%
[rank1]:2025-10-29 04:10:27,417 - INFO - Avg. fwd time: 17.1683 / Avg. bwd time: 20.6087 / Avg. batch time: 409.8128 (ms) / GPU bubble ratio: 26.26%
[rank0]:2025-10-29 04:11:43,236 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank2]:2025-10-29 04:11:44,787 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,512  tflops: 490.30  mfu: 49.58%
[rank1]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,508  tflops: 490.08  mfu: 49.55%
[rank3]:2025-10-29 04:11:44,788 - INFO -  step: 1050  loss:  0.1603  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,515  tflops: 490.42  mfu: 49.59%
[rank3]:2025-10-29 04:11:45,148 - INFO - Avg. fwd time: 16.6073 / Avg. bwd time: 21.3311 / Avg. batch time: 319.0566 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 04:11:45,174 - INFO - Avg. fwd time: 14.9854 / Avg. bwd time: 18.2525 / Avg. batch time: 357.1023 (ms) / GPU bubble ratio: 25.54%
[rank1]:2025-10-29 04:11:45,200 - INFO - Avg. fwd time: 17.1670 / Avg. bwd time: 20.4915 / Avg. batch time: 407.6944 (ms) / GPU bubble ratio: 26.10%
[rank0]:2025-10-29 04:11:45,207 - INFO - Avg. fwd time: 14.9582 / Avg. bwd time: 11.8864 / Avg. batch time: 447.2617 (ms) / GPU bubble ratio: 51.98%
[rank0]:2025-10-29 04:13:01,011 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:13:02,570 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank1]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank3]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss:  0.1300  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,532  tflops: 491.22  mfu: 49.67%
[rank0]:2025-10-29 04:13:02,571 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,532  tflops: 491.21  mfu: 49.67%
[rank0]:2025-10-29 04:13:02,650 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0413_stage0_step1100.svg
[rank2]:2025-10-29 04:13:02,656 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0413_stage2_step1100.svg
[rank1]:2025-10-29 04:13:02,643 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0413_stage1_step1100.svg
[rank0]:2025-10-29 04:13:02,740 - INFO - Avg. fwd time: 14.9661 / Avg. bwd time: 11.3982 / Avg. batch time: 444.6003 (ms) / GPU bubble ratio: 52.56%
[rank3]:2025-10-29 04:13:02,754 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0413_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.46 ms, GPU Bubble Ratio: 67.29%, 23.49%, 32.74%, 23.43%
[rank3]:2025-10-29 04:13:02,818 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0413_stage3_step1100.svg
[rank2]:2025-10-29 04:13:03,085 - INFO - Avg. fwd time: 14.9858 / Avg. bwd time: 18.1657 / Avg. batch time: 355.9962 (ms) / GPU bubble ratio: 25.50%
[rank3]:2025-10-29 04:13:03,063 - INFO - Avg. fwd time: 16.6062 / Avg. bwd time: 21.2281 / Avg. batch time: 318.2092 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 04:13:03,109 - INFO - Avg. fwd time: 17.1652 / Avg. bwd time: 20.3995 / Avg. batch time: 406.0108 (ms) / GPU bubble ratio: 25.98%
[rank0]:2025-10-29 04:14:19,030 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank2]:2025-10-29 04:14:20,602 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank1]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,498  tflops: 489.64  mfu: 49.51%
[rank3]:2025-10-29 04:14:20,603 - INFO -  step: 1150  loss:  0.1490  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,499  tflops: 489.65  mfu: 49.51%
[rank0]:2025-10-29 04:14:20,695 - INFO - Avg. fwd time: 14.9747 / Avg. bwd time: 10.8770 / Avg. batch time: 441.7965 (ms) / GPU bubble ratio: 53.19%
[rank2]:2025-10-29 04:14:20,921 - INFO - Avg. fwd time: 14.9860 / Avg. bwd time: 18.0733 / Avg. batch time: 354.8538 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:14:20,945 - INFO - Avg. fwd time: 17.1632 / Avg. bwd time: 20.3007 / Avg. batch time: 404.2508 (ms) / GPU bubble ratio: 25.86%
[rank3]:2025-10-29 04:14:20,899 - INFO - Avg. fwd time: 16.6058 / Avg. bwd time: 21.1190 / Avg. batch time: 317.3173 (ms) / GPU bubble ratio: 4.89%
[rank0]:2025-10-29 04:15:36,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:15:38,381 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank2]:2025-10-29 04:15:38,381 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,533  tflops: 491.24  mfu: 49.67%
[rank1]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss:  0.1340  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,533  tflops: 491.25  mfu: 49.67%
[rank3]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:15:38,382 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,532  tflops: 491.24  mfu: 49.67%
[rank0]:2025-10-29 04:15:38,382 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 04:15:55,007 - INFO - validate step: 1200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,638
[rank0]:2025-10-29 04:15:55,008 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:15:55,013 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 04:15:55,077 - INFO - validate step: 1200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,533
[rank2]:2025-10-29 04:15:55,078 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:15:55,043 - INFO - validate step: 1200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,585
[rank1]:2025-10-29 04:15:55,044 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:15:55,101 - INFO - validate step: 1200  loss:  0.2373  memory: 86.11GiB(61.59%)  tps: 24,500
[rank3]:2025-10-29 04:15:55,102 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:16:05,624 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.55 seconds.
[rank1]:2025-10-29 04:16:07,066 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.02 seconds.
[rank3]:2025-10-29 04:16:07,252 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.15 seconds.
[rank0]:2025-10-29 04:16:11,412 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 04:16:11,419 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.41 seconds.
[rank0]:2025-10-29 04:16:11,647 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0416_stage0_step1200.svg
[rank0]:2025-10-29 04:16:11,658 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 04:16:11,641 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0416_stage2_step1200.svg
[rank2]:2025-10-29 04:16:11,650 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 04:16:11,664 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0416_stage1_step1200.svg
[rank1]:2025-10-29 04:16:11,675 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:16:11,744 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0416_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.17 ms, GPU Bubble Ratio: 67.29%, 23.48%, 32.72%, 23.42%
[rank3]:2025-10-29 04:16:11,811 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0416_stage3_step1200.svg
[rank3]:2025-10-29 04:16:11,822 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 04:16:12,820 - INFO - Avg. fwd time: 16.6066 / Avg. bwd time: 21.0195 / Avg. batch time: 316.6518 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:16:12,885 - INFO - Avg. fwd time: 14.9840 / Avg. bwd time: 10.4014 / Avg. batch time: 439.3878 (ms) / GPU bubble ratio: 53.78%
[rank2]:2025-10-29 04:16:12,847 - INFO - Avg. fwd time: 14.9870 / Avg. bwd time: 17.9888 / Avg. batch time: 353.9567 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:16:12,874 - INFO - Avg. fwd time: 17.1624 / Avg. bwd time: 20.2108 / Avg. batch time: 402.7901 (ms) / GPU bubble ratio: 25.77%
[rank0]:2025-10-29 04:17:35,571 - INFO - [GC] Peforming periodical GC collection 1.82 seconds
[rank3]:2025-10-29 04:17:37,229 - INFO -  step: 1250  loss:  0.9494  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 8,021  tflops: 374.12  mfu: 37.83%
[rank0]:2025-10-29 04:17:37,230 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 8,014  tflops: 373.77  mfu: 37.79%
[rank2]:2025-10-29 04:17:37,228 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 8,020  tflops: 374.03  mfu: 37.82%
[rank1]:2025-10-29 04:17:37,229 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 8,017  tflops: 373.90  mfu: 37.81%
[rank0]:2025-10-29 04:17:37,329 - INFO - Avg. fwd time: 15.0151 / Avg. bwd time: 10.0256 / Avg. batch time: 437.8187 (ms) / GPU bubble ratio: 54.24%
[rank3]:2025-10-29 04:17:37,547 - INFO - Avg. fwd time: 16.6354 / Avg. bwd time: 20.9632 / Avg. batch time: 316.4213 (ms) / GPU bubble ratio: 4.94%
[rank2]:2025-10-29 04:17:37,569 - INFO - Avg. fwd time: 15.0088 / Avg. bwd time: 17.9313 / Avg. batch time: 353.5535 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:17:37,595 - INFO - Avg. fwd time: 17.1861 / Avg. bwd time: 20.1466 / Avg. batch time: 401.9472 (ms) / GPU bubble ratio: 25.70%
[rank0]:2025-10-29 04:18:58,569 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:19:00,223 - INFO -  step: 1300  loss:  0.9214  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank0]:2025-10-29 04:19:00,224 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank2]:2025-10-29 04:19:00,222 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank1]:2025-10-29 04:19:00,223 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,871  tflops: 460.37  mfu: 46.55%
[rank0]:2025-10-29 04:19:00,306 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0419_stage0_step1300.svg
[rank2]:2025-10-29 04:19:00,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0419_stage2_step1300.svg
[rank1]:2025-10-29 04:19:00,301 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0419_stage1_step1300.svg
[rank3]:2025-10-29 04:19:00,401 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0419_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.10 ms, GPU Bubble Ratio: 67.26%, 23.54%, 32.78%, 23.41%
[rank0]:2025-10-29 04:19:00,410 - INFO - Avg. fwd time: 15.0476 / Avg. bwd time: 9.6202 / Avg. batch time: 436.1441 (ms) / GPU bubble ratio: 54.75%
[rank3]:2025-10-29 04:19:00,466 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0419_stage3_step1300.svg
[rank2]:2025-10-29 04:19:00,761 - INFO - Avg. fwd time: 15.0324 / Avg. bwd time: 17.8695 / Avg. batch time: 353.1448 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-10-29 04:19:00,787 - INFO - Avg. fwd time: 17.2127 / Avg. bwd time: 20.0782 / Avg. batch time: 401.0660 (ms) / GPU bubble ratio: 25.62%
[rank3]:2025-10-29 04:19:00,739 - INFO - Avg. fwd time: 16.6681 / Avg. bwd time: 20.9040 / Avg. batch time: 316.1986 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:20:21,673 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:20:23,332 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank1]:2025-10-29 04:20:23,333 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,857  tflops: 459.72  mfu: 46.48%
[rank3]:2025-10-29 04:20:23,334 - INFO -  step: 1350  loss:  0.9308  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank0]:2025-10-29 04:20:23,334 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,857  tflops: 459.73  mfu: 46.48%
[rank2]:2025-10-29 04:20:23,745 - INFO - Avg. fwd time: 15.0542 / Avg. bwd time: 17.8122 / Avg. batch time: 352.7816 (ms) / GPU bubble ratio: 25.47%
[rank3]:2025-10-29 04:20:23,720 - INFO - Avg. fwd time: 16.6978 / Avg. bwd time: 20.8489 / Avg. batch time: 315.9857 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:20:23,781 - INFO - Avg. fwd time: 15.0775 / Avg. bwd time: 9.2462 / Avg. batch time: 434.6131 (ms) / GPU bubble ratio: 55.23%
[rank1]:2025-10-29 04:20:23,771 - INFO - Avg. fwd time: 17.2365 / Avg. bwd time: 20.0144 / Avg. batch time: 400.2664 (ms) / GPU bubble ratio: 25.55%
[rank0]:2025-10-29 04:21:44,689 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:21:46,354 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank0]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 04:21:46,353 - INFO -  step: 1400  loss:  0.9568  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,868  tflops: 460.23  mfu: 46.54%
[rank3]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 04:21:46,353 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank1]:2025-10-29 04:21:46,354 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 04:21:46,352 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,868  tflops: 460.22  mfu: 46.53%
[rank2]:2025-10-29 04:21:46,353 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 04:22:02,891 - INFO - validate step: 1400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,768
[rank1]:2025-10-29 04:22:02,926 - INFO - validate step: 1400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,716
[rank3]:2025-10-29 04:22:02,990 - INFO - validate step: 1400  loss:  0.2352  memory: 86.11GiB(61.59%)  tps: 24,622
[rank2]:2025-10-29 04:22:02,965 - INFO - validate step: 1400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,656
[rank0]:2025-10-29 04:22:03,078 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0422_stage0_step1400.svg
[rank1]:2025-10-29 04:22:03,072 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0422_stage1_step1400.svg
[rank2]:2025-10-29 04:22:03,072 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0422_stage2_step1400.svg
[rank0]:2025-10-29 04:22:03,189 - INFO - Avg. fwd time: 15.1011 / Avg. bwd time: 8.9481 / Avg. batch time: 433.3778 (ms) / GPU bubble ratio: 55.61%
[rank3]:2025-10-29 04:22:03,183 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0422_real_step1400_rank3.svg
[rank3]:> Batch Time: 372.98 ms, GPU Bubble Ratio: 67.24%, 23.61%, 32.84%, 23.40%
[rank3]:2025-10-29 04:22:03,253 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0422_stage3_step1400.svg
[rank3]:2025-10-29 04:22:03,527 - INFO - Avg. fwd time: 16.7212 / Avg. bwd time: 20.8058 / Avg. batch time: 315.8196 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:22:03,574 - INFO - Avg. fwd time: 17.2566 / Avg. bwd time: 19.9644 / Avg. batch time: 399.6157 (ms) / GPU bubble ratio: 25.49%
[rank2]:2025-10-29 04:22:03,549 - INFO - Avg. fwd time: 15.0712 / Avg. bwd time: 17.7666 / Avg. batch time: 352.4777 (ms) / GPU bubble ratio: 25.47%
[rank0]:2025-10-29 04:23:24,672 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,818  tflops: 457.92  mfu: 46.30%
[rank3]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss:  0.9778  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,830  tflops: 458.47  mfu: 46.36%
[rank1]:2025-10-29 04:23:26,329 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,822  tflops: 458.11  mfu: 46.32%
[rank2]:2025-10-29 04:23:26,328 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,827  tflops: 458.33  mfu: 46.34%
[rank0]:2025-10-29 04:23:26,430 - INFO - Avg. fwd time: 15.1279 / Avg. bwd time: 8.6238 / Avg. batch time: 432.0751 (ms) / GPU bubble ratio: 56.02%
[rank3]:2025-10-29 04:23:26,644 - INFO - Avg. fwd time: 16.7480 / Avg. bwd time: 20.7594 / Avg. batch time: 315.6538 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:23:26,691 - INFO - Avg. fwd time: 17.2793 / Avg. bwd time: 19.9108 / Avg. batch time: 398.9469 (ms) / GPU bubble ratio: 25.42%
[rank2]:2025-10-29 04:23:26,666 - INFO - Avg. fwd time: 15.0900 / Avg. bwd time: 17.7174 / Avg. batch time: 352.1844 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:24:47,637 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:24:49,283 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank3]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss:  0.8592  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank0]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,875  tflops: 460.59  mfu: 46.57%
[rank1]:2025-10-29 04:24:49,284 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,875  tflops: 460.58  mfu: 46.57%
[rank1]:2025-10-29 04:24:49,364 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0424_stage1_step1500.svg
[rank2]:2025-10-29 04:24:49,366 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0424_stage2_step1500.svg
[rank0]:2025-10-29 04:24:49,367 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0424_stage0_step1500.svg
[rank3]:2025-10-29 04:24:49,472 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0424_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.01 ms, GPU Bubble Ratio: 67.24%, 23.68%, 32.92%, 23.38%
[rank3]:2025-10-29 04:24:49,543 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0424_stage3_step1500.svg
[rank3]:2025-10-29 04:24:49,883 - INFO - Avg. fwd time: 16.7719 / Avg. bwd time: 20.7154 / Avg. batch time: 315.4843 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 04:24:49,945 - INFO - Avg. fwd time: 15.1516 / Avg. bwd time: 8.3221 / Avg. batch time: 430.8487 (ms) / GPU bubble ratio: 56.41%
[rank1]:2025-10-29 04:24:49,936 - INFO - Avg. fwd time: 17.2990 / Avg. bwd time: 19.8607 / Avg. batch time: 398.3104 (ms) / GPU bubble ratio: 25.37%
[rank2]:2025-10-29 04:24:49,909 - INFO - Avg. fwd time: 15.1071 / Avg. bwd time: 17.6715 / Avg. batch time: 351.8976 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:26:10,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:26:12,559 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank3]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss:  0.9272  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,837  tflops: 458.82  mfu: 46.39%
[rank0]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank1]:2025-10-29 04:26:12,560 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,837  tflops: 458.81  mfu: 46.39%
[rank0]:2025-10-29 04:26:12,663 - INFO - Avg. fwd time: 15.1715 / Avg. bwd time: 8.0799 / Avg. batch time: 429.8552 (ms) / GPU bubble ratio: 56.73%
[rank3]:2025-10-29 04:26:12,882 - INFO - Avg. fwd time: 16.7917 / Avg. bwd time: 20.6807 / Avg. batch time: 315.3593 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:26:12,929 - INFO - Avg. fwd time: 17.3156 / Avg. bwd time: 19.8207 / Avg. batch time: 397.7909 (ms) / GPU bubble ratio: 25.31%
[rank2]:2025-10-29 04:26:12,903 - INFO - Avg. fwd time: 15.1214 / Avg. bwd time: 17.6349 / Avg. batch time: 351.6597 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-29 04:27:32,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 04:27:35,177 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank3_trend_line.svg
[rank1]:2025-10-29 04:27:35,195 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank1_trend_line.svg
[rank2]:2025-10-29 04:27:35,175 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank2_trend_line.svg
[rank2]:2025-10-29 04:27:35,212 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.54/0.54, [MB4] 0.65/0.65, [MB5] 0.77/0.77, [MB6] 0.88/0.88, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:27:35,215 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 9,911  tflops: 462.25  mfu: 46.74%
[rank2]:2025-10-29 04:27:35,215 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 04:27:35,204 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule_adjustment/251029_0427_rank0_trend_line.svg
[rank0]:2025-10-29 04:27:35,211 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:27:35,214 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 9,911  tflops: 462.26  mfu: 46.74%
[rank0]:2025-10-29 04:27:35,214 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 04:27:35,211 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.36/0.36, [MB1] 0.87/0.87, [MB2] 0.88/0.88, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:27:35,214 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 9,911  tflops: 462.26  mfu: 46.74%
[rank1]:2025-10-29 04:27:35,214 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 04:27:35,411 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0427_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.78 ms, GPU Bubble Ratio: 53.90%, 22.81%, 30.79%, 23.83%
[rank3]:2025-10-29 04:27:35,411 - INFO - 	> Batch Time: 356.78 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 04:27:35,412 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:27:35,418 - INFO -  step: 1600  loss:  0.1447  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 9,887  tflops: 461.13  mfu: 46.63%
[rank3]:2025-10-29 04:27:35,418 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 04:27:51,826 - INFO - validate step: 1600  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,657
[rank1]:2025-10-29 04:27:51,860 - INFO - validate step: 1600  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,607
[rank2]:2025-10-29 04:27:51,893 - INFO - validate step: 1600  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,561
[rank0]:2025-10-29 04:27:52,003 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0427_stage0_step1600.svg
[rank3]:2025-10-29 04:27:51,916 - INFO - validate step: 1600  loss:  0.2377  memory: 86.11GiB(61.59%)  tps: 24,829
[rank1]:2025-10-29 04:27:51,998 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0427_stage1_step1600.svg
[rank2]:2025-10-29 04:27:52,001 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0427_stage2_step1600.svg
[rank0]:2025-10-29 04:27:52,096 - INFO - Avg. fwd time: 15.1885 / Avg. bwd time: 7.8145 / Avg. batch time: 428.6770 (ms) / GPU bubble ratio: 57.07%
[rank3]:2025-10-29 04:27:52,105 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0427_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.10 ms, GPU Bubble Ratio: 67.24%, 23.78%, 33.00%, 23.34%
[rank3]:2025-10-29 04:27:52,177 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0427_stage3_step1600.svg
[rank2]:2025-10-29 04:27:52,449 - INFO - Avg. fwd time: 15.1332 / Avg. bwd time: 17.5927 / Avg. batch time: 351.3163 (ms) / GPU bubble ratio: 25.48%
[rank3]:2025-10-29 04:27:52,429 - INFO - Avg. fwd time: 16.8080 / Avg. bwd time: 20.6386 / Avg. batch time: 315.1450 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-29 04:27:52,474 - INFO - Avg. fwd time: 17.3287 / Avg. bwd time: 19.7746 / Avg. batch time: 397.1356 (ms) / GPU bubble ratio: 25.26%
[rank0]:2025-10-29 04:29:08,223 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,514  tflops: 490.38  mfu: 49.58%
[rank2]:2025-10-29 04:29:09,773 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,519  tflops: 490.60  mfu: 49.61%
[rank3]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss:  0.1408  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,522  tflops: 490.75  mfu: 49.62%
[rank0]:2025-10-29 04:29:09,774 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,510  tflops: 490.17  mfu: 49.56%
[rank3]:2025-10-29 04:29:10,133 - INFO - Avg. fwd time: 16.8006 / Avg. bwd time: 20.5803 / Avg. batch time: 314.6069 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 04:29:10,160 - INFO - Avg. fwd time: 15.1289 / Avg. bwd time: 17.5464 / Avg. batch time: 350.6573 (ms) / GPU bubble ratio: 25.45%
[rank0]:2025-10-29 04:29:10,200 - INFO - Avg. fwd time: 15.1880 / Avg. bwd time: 7.5660 / Avg. batch time: 427.2214 (ms) / GPU bubble ratio: 57.39%
[rank1]:2025-10-29 04:29:10,188 - INFO - Avg. fwd time: 17.3218 / Avg. bwd time: 19.7253 / Avg. batch time: 396.1805 (ms) / GPU bubble ratio: 25.19%
[rank0]:2025-10-29 04:30:26,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:30:27,576 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank3]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss:  0.1490  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,529  tflops: 491.09  mfu: 49.66%
[rank0]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank1]:2025-10-29 04:30:27,577 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,529  tflops: 491.08  mfu: 49.65%
[rank2]:2025-10-29 04:30:27,657 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0430_stage2_step1700.svg
[rank0]:2025-10-29 04:30:27,662 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0430_stage0_step1700.svg
[rank1]:2025-10-29 04:30:27,658 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0430_stage1_step1700.svg
[rank3]:2025-10-29 04:30:27,761 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0430_real_step1700_rank3.svg
[rank3]:> Batch Time: 374.22 ms, GPU Bubble Ratio: 67.22%, 23.70%, 32.93%, 23.36%
[rank3]:2025-10-29 04:30:27,830 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0430_stage3_step1700.svg
[rank0]:2025-10-29 04:30:27,751 - INFO - Avg. fwd time: 15.1868 / Avg. bwd time: 7.3652 / Avg. batch time: 426.0333 (ms) / GPU bubble ratio: 57.65%
[rank2]:2025-10-29 04:30:28,096 - INFO - Avg. fwd time: 15.1252 / Avg. bwd time: 17.5092 / Avg. batch time: 350.1152 (ms) / GPU bubble ratio: 25.43%
[rank3]:2025-10-29 04:30:28,076 - INFO - Avg. fwd time: 16.7946 / Avg. bwd time: 20.5340 / Avg. batch time: 314.1793 (ms) / GPU bubble ratio: 4.95%
[rank1]:2025-10-29 04:30:28,120 - INFO - Avg. fwd time: 17.3163 / Avg. bwd time: 19.6857 / Avg. batch time: 395.3977 (ms) / GPU bubble ratio: 25.13%
[rank0]:2025-10-29 04:31:43,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:31:45,489 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank3]:2025-10-29 04:31:45,488 - INFO -  step: 1750  loss:  0.1516  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,515  tflops: 490.41  mfu: 49.59%
[rank1]:2025-10-29 04:31:45,489 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank2]:2025-10-29 04:31:45,487 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,515  tflops: 490.40  mfu: 49.59%
[rank0]:2025-10-29 04:31:45,579 - INFO - Avg. fwd time: 15.1857 / Avg. bwd time: 7.1441 / Avg. batch time: 424.7485 (ms) / GPU bubble ratio: 57.94%
[rank3]:2025-10-29 04:31:45,782 - INFO - Avg. fwd time: 16.7887 / Avg. bwd time: 20.4830 / Avg. batch time: 313.7129 (ms) / GPU bubble ratio: 4.95%
[rank2]:2025-10-29 04:31:45,804 - INFO - Avg. fwd time: 15.1215 / Avg. bwd time: 17.4686 / Avg. batch time: 349.5409 (ms) / GPU bubble ratio: 25.41%
[rank1]:2025-10-29 04:31:45,829 - INFO - Avg. fwd time: 17.3104 / Avg. bwd time: 19.6421 / Avg. batch time: 394.5605 (ms) / GPU bubble ratio: 25.08%
[rank0]:2025-10-29 04:33:01,658 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:33:03,204 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank2]:2025-10-29 04:33:03,204 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank1]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss:  0.1281  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,541  tflops: 491.64  mfu: 49.71%
[rank3]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 04:33:03,205 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,541  tflops: 491.63  mfu: 49.71%
[rank0]:2025-10-29 04:33:03,205 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 04:33:19,786 - INFO - validate step: 1800  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,703
[rank2]:2025-10-29 04:33:19,854 - INFO - validate step: 1800  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,601
[rank1]:2025-10-29 04:33:19,823 - INFO - validate step: 1800  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,648
[rank3]:2025-10-29 04:33:19,878 - INFO - validate step: 1800  loss:  0.2360  memory: 86.11GiB(61.59%)  tps: 24,569
[rank1]:2025-10-29 04:33:19,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0433_stage1_step1800.svg
[rank0]:2025-10-29 04:33:19,964 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0433_stage0_step1800.svg
[rank2]:2025-10-29 04:33:19,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0433_stage2_step1800.svg
[rank3]:2025-10-29 04:33:20,066 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0433_real_step1800_rank3.svg
[rank3]:> Batch Time: 373.59 ms, GPU Bubble Ratio: 67.21%, 23.65%, 32.86%, 23.37%
[rank3]:2025-10-29 04:33:20,134 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0433_stage3_step1800.svg
[rank3]:2025-10-29 04:33:20,449 - INFO - Avg. fwd time: 16.7828 / Avg. bwd time: 20.4347 / Avg. batch time: 313.2685 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:33:20,475 - INFO - Avg. fwd time: 15.1176 / Avg. bwd time: 17.4300 / Avg. batch time: 348.9955 (ms) / GPU bubble ratio: 25.39%
[rank1]:2025-10-29 04:33:20,504 - INFO - Avg. fwd time: 17.3045 / Avg. bwd time: 19.6013 / Avg. batch time: 393.7669 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-10-29 04:33:20,513 - INFO - Avg. fwd time: 15.1845 / Avg. bwd time: 6.9359 / Avg. batch time: 423.5340 (ms) / GPU bubble ratio: 58.22%
[rank0]:2025-10-29 04:34:36,362 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:34:37,909 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,495  tflops: 489.50  mfu: 49.49%
[rank1]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,491  tflops: 489.30  mfu: 49.47%
[rank3]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss:  0.1133  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,498  tflops: 489.65  mfu: 49.51%
[rank0]:2025-10-29 04:34:37,910 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,486  tflops: 489.07  mfu: 49.45%
[rank0]:2025-10-29 04:34:38,000 - INFO - Avg. fwd time: 15.1841 / Avg. bwd time: 6.7668 / Avg. batch time: 422.5475 (ms) / GPU bubble ratio: 58.44%
[rank3]:2025-10-29 04:34:38,208 - INFO - Avg. fwd time: 16.7787 / Avg. bwd time: 20.3962 / Avg. batch time: 312.9200 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:34:38,227 - INFO - Avg. fwd time: 15.1149 / Avg. bwd time: 17.3988 / Avg. batch time: 348.5502 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 04:34:38,252 - INFO - Avg. fwd time: 17.3010 / Avg. bwd time: 19.5690 / Avg. batch time: 393.1222 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-10-29 04:35:54,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:35:55,679 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank1]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank0]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,534  tflops: 491.29  mfu: 49.68%
[rank3]:2025-10-29 04:35:55,680 - INFO -  step: 1900  loss:  0.1303  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,534  tflops: 491.30  mfu: 49.68%
[rank2]:2025-10-29 04:35:55,764 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0435_stage2_step1900.svg
[rank1]:2025-10-29 04:35:55,764 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0435_stage1_step1900.svg
[rank0]:2025-10-29 04:35:55,762 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0435_stage0_step1900.svg
[rank3]:2025-10-29 04:35:55,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0435_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.17 ms, GPU Bubble Ratio: 67.22%, 23.62%, 32.85%, 23.36%
[rank0]:2025-10-29 04:35:55,851 - INFO - Avg. fwd time: 15.1832 / Avg. bwd time: 6.5797 / Avg. batch time: 421.4442 (ms) / GPU bubble ratio: 58.69%
[rank3]:2025-10-29 04:35:55,937 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0435_stage3_step1900.svg
[rank3]:2025-10-29 04:35:56,190 - INFO - Avg. fwd time: 16.7736 / Avg. bwd time: 20.3530 / Avg. batch time: 312.5247 (ms) / GPU bubble ratio: 4.96%
[rank2]:2025-10-29 04:35:56,210 - INFO - Avg. fwd time: 15.1115 / Avg. bwd time: 17.3643 / Avg. batch time: 348.0478 (ms) / GPU bubble ratio: 25.35%
[rank1]:2025-10-29 04:35:56,235 - INFO - Avg. fwd time: 17.2962 / Avg. bwd time: 19.5328 / Avg. batch time: 392.3976 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-10-29 04:37:11,955 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:37:13,521 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank1]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank3]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss:  0.1576  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 04:37:13,523 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,524  tflops: 490.83  mfu: 49.63%
[rank2]:2025-10-29 04:37:13,920 - INFO - Avg. fwd time: 15.1084 / Avg. bwd time: 17.3313 / Avg. batch time: 347.5836 (ms) / GPU bubble ratio: 25.34%
[rank1]:2025-10-29 04:37:13,949 - INFO - Avg. fwd time: 17.2914 / Avg. bwd time: 19.4975 / Avg. batch time: 391.7219 (ms) / GPU bubble ratio: 24.87%
[rank3]:2025-10-29 04:37:13,893 - INFO - Avg. fwd time: 16.7685 / Avg. bwd time: 20.3118 / Avg. batch time: 312.1448 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:37:13,961 - INFO - Avg. fwd time: 15.1825 / Avg. bwd time: 6.4027 / Avg. batch time: 420.4114 (ms) / GPU bubble ratio: 58.93%
[rank0]:2025-10-29 04:38:29,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:38:31,280 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank2]:2025-10-29 04:38:31,281 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 04:38:31,282 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank1]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 04:38:31,281 - INFO -  step: 2000  loss:  0.1418  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.37  mfu: 49.68%
[rank0]:2025-10-29 04:38:31,282 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.36  mfu: 49.68%
[rank3]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 04:38:31,282 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 04:38:47,843 - INFO - validate step: 2000  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,733
[rank0]:2025-10-29 04:38:47,806 - INFO - validate step: 2000  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,788
[rank2]:2025-10-29 04:38:47,874 - INFO - validate step: 2000  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,684
[rank3]:2025-10-29 04:38:47,898 - INFO - validate step: 2000  loss:  0.2368  memory: 86.11GiB(61.59%)  tps: 24,652
[rank2]:2025-10-29 04:38:47,988 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0438_stage2_step2000.svg
[rank1]:2025-10-29 04:38:47,987 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0438_stage1_step2000.svg
[rank0]:2025-10-29 04:38:47,986 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0438_stage0_step2000.svg
[rank0]:2025-10-29 04:38:48,075 - INFO - Avg. fwd time: 15.1813 / Avg. bwd time: 6.2583 / Avg. batch time: 419.5502 (ms) / GPU bubble ratio: 59.12%
[rank3]:2025-10-29 04:38:48,099 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0438_real_step2000_rank3.svg
[rank3]:> Batch Time: 372.85 ms, GPU Bubble Ratio: 67.22%, 23.59%, 32.82%, 23.36%
[rank3]:2025-10-29 04:38:48,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0438_stage3_step2000.svg
[rank3]:2025-10-29 04:38:48,430 - INFO - Avg. fwd time: 16.7640 / Avg. bwd time: 20.2778 / Avg. batch time: 311.8303 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 04:38:48,452 - INFO - Avg. fwd time: 15.1055 / Avg. bwd time: 17.3045 / Avg. batch time: 347.1852 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-10-29 04:38:48,476 - INFO - Avg. fwd time: 17.2873 / Avg. bwd time: 19.4695 / Avg. batch time: 391.1531 (ms) / GPU bubble ratio: 24.82%
[rank0]:2025-10-29 04:40:04,409 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 04:40:05,966 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,490  tflops: 489.27  mfu: 49.47%
[rank1]:2025-10-29 04:40:05,968 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,486  tflops: 489.06  mfu: 49.45%
[rank0]:2025-10-29 04:40:05,967 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,481  tflops: 488.83  mfu: 49.43%
[rank3]:2025-10-29 04:40:05,967 - INFO -  step: 2050  loss:  0.1833  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,493  tflops: 489.42  mfu: 49.49%
[rank0]:2025-10-29 04:40:06,059 - INFO - Avg. fwd time: 15.1813 / Avg. bwd time: 6.0980 / Avg. batch time: 418.6307 (ms) / GPU bubble ratio: 59.34%
[rank2]:2025-10-29 04:40:06,283 - INFO - Avg. fwd time: 15.1030 / Avg. bwd time: 17.2750 / Avg. batch time: 346.7790 (ms) / GPU bubble ratio: 25.31%
[rank1]:2025-10-29 04:40:06,307 - INFO - Avg. fwd time: 17.2841 / Avg. bwd time: 19.4389 / Avg. batch time: 390.5572 (ms) / GPU bubble ratio: 24.78%
[rank3]:2025-10-29 04:40:06,262 - INFO - Avg. fwd time: 16.7602 / Avg. bwd time: 20.2411 / Avg. batch time: 311.4984 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:41:22,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank2]:2025-10-29 04:41:23,729 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank0]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank3]:2025-10-29 04:41:23,730 - INFO -  step: 2100  loss:  0.1654  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank1]:2025-10-29 04:41:23,807 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0441_stage1_step2100.svg
[rank2]:2025-10-29 04:41:23,809 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0441_stage2_step2100.svg
[rank0]:2025-10-29 04:41:23,810 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0441_stage0_step2100.svg
[rank3]:2025-10-29 04:41:23,917 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0441_real_step2100_rank3.svg
[rank3]:> Batch Time: 372.55 ms, GPU Bubble Ratio: 67.22%, 23.57%, 32.80%, 23.36%
[rank3]:2025-10-29 04:41:23,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0441_stage3_step2100.svg
[rank1]:2025-10-29 04:41:24,349 - INFO - Avg. fwd time: 17.2805 / Avg. bwd time: 19.4095 / Avg. batch time: 389.9854 (ms) / GPU bubble ratio: 24.74%
[rank2]:2025-10-29 04:41:24,320 - INFO - Avg. fwd time: 15.1004 / Avg. bwd time: 17.2470 / Avg. batch time: 346.3878 (ms) / GPU bubble ratio: 25.29%
[rank0]:2025-10-29 04:41:24,360 - INFO - Avg. fwd time: 15.1808 / Avg. bwd time: 5.9456 / Avg. batch time: 417.7522 (ms) / GPU bubble ratio: 59.54%
[rank3]:2025-10-29 04:41:24,293 - INFO - Avg. fwd time: 16.7561 / Avg. bwd time: 20.2063 / Avg. batch time: 311.1798 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 04:42:40,183 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:42:41,731 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank0]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank3]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss:  0.2036  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank1]:2025-10-29 04:42:41,732 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,502  tflops: 489.83  mfu: 49.53%
[rank0]:2025-10-29 04:42:41,824 - INFO - Avg. fwd time: 15.1805 / Avg. bwd time: 5.8210 / Avg. batch time: 417.0190 (ms) / GPU bubble ratio: 59.71%
[rank3]:2025-10-29 04:42:42,031 - INFO - Avg. fwd time: 16.7529 / Avg. bwd time: 20.1778 / Avg. batch time: 310.9194 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:42:42,076 - INFO - Avg. fwd time: 17.2773 / Avg. bwd time: 19.3851 / Avg. batch time: 389.5036 (ms) / GPU bubble ratio: 24.70%
[rank2]:2025-10-29 04:42:42,051 - INFO - Avg. fwd time: 15.0983 / Avg. bwd time: 17.2239 / Avg. batch time: 346.0548 (ms) / GPU bubble ratio: 25.28%
[rank0]:2025-10-29 04:43:57,935 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:43:59,483 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank1]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 04:43:59,481 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank2]:2025-10-29 04:43:59,481 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 04:43:59,482 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,536  tflops: 491.42  mfu: 49.69%
[rank0]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 04:43:59,482 - INFO -  step: 2200  loss:  0.1441  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,537  tflops: 491.43  mfu: 49.69%
[rank3]:2025-10-29 04:43:59,483 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 04:44:16,094 - INFO - validate step: 2200  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,659
[rank2]:2025-10-29 04:44:16,120 - INFO - validate step: 2200  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,618
[rank0]:2025-10-29 04:44:16,054 - INFO - validate step: 2200  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,717
[rank3]:2025-10-29 04:44:16,142 - INFO - validate step: 2200  loss:  0.2368  memory: 86.11GiB(61.59%)  tps: 24,589
[rank0]:2025-10-29 04:44:16,223 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0444_stage0_step2200.svg
[rank1]:2025-10-29 04:44:16,223 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0444_stage1_step2200.svg
[rank2]:2025-10-29 04:44:16,226 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0444_stage2_step2200.svg
[rank3]:2025-10-29 04:44:16,331 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0444_real_step2200_rank3.svg
[rank3]:> Batch Time: 372.26 ms, GPU Bubble Ratio: 67.21%, 23.56%, 32.77%, 23.34%
[rank0]:2025-10-29 04:44:16,314 - INFO - Avg. fwd time: 15.1793 / Avg. bwd time: 5.6820 / Avg. batch time: 416.1913 (ms) / GPU bubble ratio: 59.90%
[rank3]:2025-10-29 04:44:16,394 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0444_stage3_step2200.svg
[rank1]:2025-10-29 04:44:16,693 - INFO - Avg. fwd time: 17.2734 / Avg. bwd time: 19.3576 / Avg. batch time: 388.9565 (ms) / GPU bubble ratio: 24.66%
[rank2]:2025-10-29 04:44:16,667 - INFO - Avg. fwd time: 15.0955 / Avg. bwd time: 17.1981 / Avg. batch time: 345.6743 (ms) / GPU bubble ratio: 25.26%
[rank3]:2025-10-29 04:44:16,647 - INFO - Avg. fwd time: 16.7485 / Avg. bwd time: 20.1456 / Avg. batch time: 310.6203 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 04:45:32,463 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 04:45:34,021 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,512  tflops: 490.30  mfu: 49.58%
[rank2]:2025-10-29 04:45:34,019 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank3]:2025-10-29 04:45:34,021 - INFO -  step: 2250  loss:  0.1680  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,519  tflops: 490.62  mfu: 49.61%
[rank0]:2025-10-29 04:45:34,020 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,507  tflops: 490.06  mfu: 49.55%
[rank3]:2025-10-29 04:45:34,387 - INFO - Avg. fwd time: 16.7444 / Avg. bwd time: 20.1143 / Avg. batch time: 310.3302 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:45:34,447 - INFO - Avg. fwd time: 17.2697 / Avg. bwd time: 19.3316 / Avg. batch time: 388.4491 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-10-29 04:45:34,416 - INFO - Avg. fwd time: 15.0931 / Avg. bwd time: 17.1737 / Avg. batch time: 345.3224 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-29 04:45:34,462 - INFO - Avg. fwd time: 15.1788 / Avg. bwd time: 5.5495 / Avg. batch time: 415.4170 (ms) / GPU bubble ratio: 60.08%
[rank0]:2025-10-29 04:46:50,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank2]:2025-10-29 04:46:51,784 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank3]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss:  0.1342  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank0]:2025-10-29 04:46:51,785 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,534  tflops: 491.33  mfu: 49.68%
[rank1]:2025-10-29 04:46:51,865 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0446_stage1_step2300.svg
[rank2]:2025-10-29 04:46:51,868 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0446_stage2_step2300.svg
[rank0]:2025-10-29 04:46:51,866 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0446_stage0_step2300.svg
[rank0]:2025-10-29 04:46:51,956 - INFO - Avg. fwd time: 15.1783 / Avg. bwd time: 5.4408 / Avg. batch time: 414.7748 (ms) / GPU bubble ratio: 60.23%
[rank3]:2025-10-29 04:46:51,975 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0446_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.11 ms, GPU Bubble Ratio: 67.22%, 23.55%, 32.77%, 23.35%
[rank3]:2025-10-29 04:46:52,038 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0446_stage3_step2300.svg
[rank2]:2025-10-29 04:46:52,311 - INFO - Avg. fwd time: 15.0912 / Avg. bwd time: 17.1537 / Avg. batch time: 345.0281 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-29 04:46:52,290 - INFO - Avg. fwd time: 16.7414 / Avg. bwd time: 20.0889 / Avg. batch time: 310.0988 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 04:46:52,335 - INFO - Avg. fwd time: 17.2674 / Avg. bwd time: 19.3107 / Avg. batch time: 388.0271 (ms) / GPU bubble ratio: 24.59%
[rank0]:2025-10-29 04:48:08,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 04:48:09,737 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank3]:2025-10-29 04:48:09,741 - INFO -  step: 2350  loss:  0.1571  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,509  tflops: 490.15  mfu: 49.56%
[rank0]:2025-10-29 04:48:09,737 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank2]:2025-10-29 04:48:09,736 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,509  tflops: 490.14  mfu: 49.56%
[rank0]:2025-10-29 04:48:09,830 - INFO - Avg. fwd time: 15.1778 / Avg. bwd time: 5.3192 / Avg. batch time: 414.0686 (ms) / GPU bubble ratio: 60.40%
[rank1]:2025-10-29 04:48:10,086 - INFO - Avg. fwd time: 17.2644 / Avg. bwd time: 19.2871 / Avg. batch time: 387.5672 (ms) / GPU bubble ratio: 24.55%
[rank3]:2025-10-29 04:48:10,040 - INFO - Avg. fwd time: 16.7381 / Avg. bwd time: 20.0609 / Avg. batch time: 309.8420 (ms) / GPU bubble ratio: 4.99%
[rank2]:2025-10-29 04:48:10,060 - INFO - Avg. fwd time: 15.0890 / Avg. bwd time: 17.1313 / Avg. batch time: 344.7133 (ms) / GPU bubble ratio: 25.22%
[rank0]:2025-10-29 04:49:25,927 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:49:27,498 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 64.90GiB(46.42%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank2]:2025-10-29 04:49:27,498 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,750  tflops: 454.75  mfu: 45.28%
[rank2]:2025-10-29 04:49:27,498 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.10GiB(53.00%)  tps: 10,535  tflops: 491.34  mfu: 49.68%
[rank1]:2025-10-29 04:49:27,499 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,750  tflops: 454.73  mfu: 45.28%
[rank1]:2025-10-29 04:49:27,499 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss:  0.1417  grad_norm:  0.0000  memory: 86.11GiB(61.59%)  tps: 10,535  tflops: 491.37  mfu: 49.68%
[rank3]:2025-10-29 04:49:27,500 - INFO -  final step: 2400  loss:  0.1417  grad_norm:  0.0000  tps: 9,754  tflops: 454.92  mfu: 45.29%
[rank0]:2025-10-29 04:49:27,499 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.54GiB(51.88%)  tps: 10,535  tflops: 491.35  mfu: 49.68%
[rank3]:2025-10-29 04:49:27,500 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 04:49:27,499 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,749  tflops: 454.68  mfu: 45.27%
[rank0]:2025-10-29 04:49:27,499 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 04:49:44,060 - INFO - validate step: 2400  loss: -1.0000  memory: 74.10GiB(53.00%)  tps: 24,734
[rank1]:2025-10-29 04:49:44,061 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 04:49:44,064 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 04:49:44,024 - INFO - validate step: 2400  loss: -1.0000  memory: 72.54GiB(51.88%)  tps: 24,787
[rank0]:2025-10-29 04:49:44,025 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 04:49:44,030 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 04:49:44,090 - INFO - validate step: 2400  loss: -1.0000  memory: 64.90GiB(46.42%)  tps: 24,687
[rank2]:2025-10-29 04:49:44,091 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 04:49:44,094 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 04:49:44,115 - INFO - validate step: 2400  loss:  0.2356  memory: 86.11GiB(61.59%)  tps: 24,655
[rank3]:2025-10-29 04:49:44,116 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 04:49:44,118 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 04:49:54,068 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 04:49:54,165 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank1/251029_0449_stage1_final2400.svg
[rank0]:2025-10-29 04:49:54,165 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank0/251029_0449_stage0_final2400.svg
[rank2]:2025-10-29 04:49:54,193 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank2/251029_0449_stage2_final2400.svg
[rank3]:2025-10-29 04:49:54,315 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0449_real_final2400_rank3.svg
[rank3]:> Batch Time: 371.93 ms, GPU Bubble Ratio: 67.22%, 23.53%, 32.76%, 23.36%
[rank0]:2025-10-29 04:49:54,406 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank0_stage0.svg
[rank0]:	> Counts Sum: 4610600, Total Sum: 5442880 (84.71%), Ratio(%) per element: [84.33, 84.01, 83.79, 84.33, 83.9, 83.79, 84.17, 84.22, 84.01, 84.28, 84.01, 84.17, 84.01, 84.12, 84.33, 84.17, 84.22, 84.33, 84.22, 84.28, 83.95, 84.54, 84.38, 84.22, 84.44, 84.6, 84.33, 84.49, 84.6, 84.38, 84.17, 84.44, 84.54, 84.49, 84.71, 84.44, 84.38, 84.71, 84.38, 84.71, 84.49, 84.76, 84.49, 84.6, 84.97, 84.81, 84.97, 85.08, 85.13, 84.76, 85.08, 84.71, 84.87, 84.71, 85.3, 85.13, 85.67, 85.4, 85.08, 84.97, 85.51, 85.51, 85.4, 85.35, 85.46, 85.56, 85.56, 85.56, 85.24, 85.89, 85.89, 86.05, 85.83]
[rank0]:2025-10-29 04:49:54,406 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-29 04:49:54,419 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank1_stage1.svg
[rank1]:	> Counts Sum: 569000, Total Sum: 6039360 (9.42%), Ratio(%) per element: [9.97, 9.12, 9.28, 9.81, 9.06, 9.28, 9.17, 9.33, 9.6, 8.42, 9.33, 9.06, 8.79, 9.49, 8.95, 8.31, 9.01, 8.95, 9.54, 9.81, 8.69, 9.97, 10.67, 9.38, 9.49, 9.76, 8.95, 8.63, 10.51, 9.92, 9.33, 9.97, 9.76, 9.65, 8.9, 9.71, 9.12, 9.76, 9.33, 9.28, 9.28, 9.22, 9.17, 8.95, 10.51, 9.92, 9.54, 10.35, 9.6, 8.74, 10.72, 9.71, 8.85, 9.76, 9.92, 8.42, 9.33, 8.53, 9.54, 9.44, 10.62, 8.42, 8.42, 10.4, 8.31, 9.87, 8.9, 9.06, 9.33, 10.46, 10.08, 10.03, 10.08, 9.54, 9.65, 9.17, 9.71, 8.47, 9.06, 8.63, 9.97]
[rank1]:2025-10-29 04:49:54,419 - INFO - Destroying the purge thread.
[rank2]:2025-10-29 04:49:54,513 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank2_stage2.svg
[rank2]:	> Counts Sum: 1103400, Total Sum: 5368320 (20.55%), Ratio(%) per element: [21.4, 21.29, 21.56, 21.08, 19.63, 20.65, 20.49, 19.68, 21.99, 20.43, 21.29, 21.29, 20.38, 21.72, 21.19, 21.35, 20.33, 19.79, 19.58, 20.65, 20.7, 19.84, 20.49, 21.35, 21.03, 20.38, 20.27, 20.81, 20.54, 19.52, 19.58, 19.36, 20.11, 20.54, 21.51, 21.35, 20.43, 21.4, 20.97, 20.22, 21.67, 21.03, 21.35, 19.25, 21.94, 20.27, 18.77, 20.06, 19.95, 20.01, 19.74, 19.74, 21.29, 22.58, 19.15, 21.72, 19.58, 21.72, 19.09, 20.81, 20.92, 21.62, 19.58, 20.65, 20.17, 20.06, 20.7, 19.79, 19.47, 20.17, 21.13, 19.36]
[rank2]:2025-10-29 04:49:54,514 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 04:49:54,536 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/pipeline_schedule/251029_0449_thry_final2400_rank3.svg
[rank3]:> Batch Time: 529.68 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-29 04:49:54,631 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/freeze_ratio_history/rank3/251029_0449_stage3_final2400.svg
[rank3]:2025-10-29 04:49:54,949 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1/frozen_params_histogram/251029_0449_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.39, 1.28, 1.66, 1.77, 1.82, 2.03, 1.5, 1.82, 1.12, 1.6, 1.66, 1.44, 1.23, 1.71, 1.6, 1.18, 1.77, 1.55, 1.6, 1.28, 1.6, 1.82, 1.66, 1.71, 1.07, 1.82, 1.44, 1.23, 1.77, 1.66, 1.71, 1.23, 1.5, 1.5, 1.5, 1.98, 1.66, 1.87, 1.5, 1.39, 1.28, 1.39, 1.44, 1.6, 1.87, 2.09, 1.77, 1.93, 1.71, 1.07, 1.44, 1.71, 1.77, 1.66, 1.82, 1.44, 1.18, 1.55, 1.6, 1.87, 1.5, 1.6, 1.77, 1.23, 1.77]
[rank3]:2025-10-29 04:49:54,950 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank0]:2025-10-29 04:49:56,406 - INFO - Training completed
[rank0]:2025-10-29 04:49:56,407 - INFO - Destroying the purge thread.
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.67974
[rank3]:wandb:               final/avg_loss 0.14175
[rank3]:wandb:             final/avg_mfu(%) 45.28634
[rank3]:wandb:             final/avg_tflops 454.92326
[rank3]:wandb:    final/avg_throughput(tps) 9753.89558
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.14175
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.14175
[rank3]:wandb: loss_metrics/global_max_loss 0.14175
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/i08zgsmr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_fullrand7_dm1/20251029-0337/wandb/run-20251029_033746-i08zgsmr/logs
[rank1]:2025-10-29 04:49:56,658 - INFO - Process group destroyed
[rank3]:2025-10-29 04:49:56,661 - INFO - Process group destroyed
[rank2]:2025-10-29 04:49:56,726 - INFO - Process group destroyed
[rank0]:2025-10-29 04:49:56,722 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.18', 'layers.21', 'layers.23', 'layers.22', 'layers.20', 'layers.24', 'layers.17'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'tok_embeddings', 'layers.6', 'layers.3', 'layers.5', 'layers.2', 'layers.0', 'layers.7', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.14', 'layers.16', 'layers.13', 'layers.12', 'layers.9', 'layers.11', 'layers.15', 'layers.10', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'norm', 'layers.26', 'output', 'layers.30', 'layers.31', 'layers.25', 'layers.29', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 04:50:06 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] 
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] *****************************************
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 04:50:13,168 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 04:50:13,198 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 04:50:13,332 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 04:50:13,468 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 04:50:14,193 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 04:50:14,195 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:50:14,200 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-29 04:50:14,206 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 04:50:14,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 04:50:14,459 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 04:50:14,461 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 04:50:14,470 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 04:50:14,472 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:50:16,176 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 04:50:16,470 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 04:50:17,964 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 04:50:19,529 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 04:50:19,536 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 04:50:19,602 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 04:50:19,602 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:50:19,588 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 04:50:19,661 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 04:50:19,661 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 04:50:19,798 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 04:50:19,849 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-10-29 04:50:19,932 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 04:50:19,932 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-29 04:50:19,873 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 04:50:19,874 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:50:19,969 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 04:50:19,969 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 04:50:20,197 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 04:50:20,197 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 7q6bt8ow
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1/20251029-0450/wandb/run-20251029_045020-7q6bt8ow
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7q6bt8ow
[rank3]:2025-10-29 04:50:21,592 - INFO - WandB logging enabled
[rank3]:2025-10-29 04:50:21,599 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 04:50:21,673 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 04:50:21,674 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 04:50:22,021 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-29 04:50:22,021 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 04:50:22,022 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 04:50:22,017 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 04:50:22,022 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 04:50:22,005 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 04:50:22,005 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 04:50:22,021 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 04:50:25,472 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 04:50:25,472 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 04:50:34,307 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 04:50:34,308 - INFO - Finished loading the checkpoint in 8.84 seconds.
[rank0]:2025-10-29 04:50:34,308 - INFO - Training starts at step 1
[rank2]:2025-10-29 04:50:38,791 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 44.28GiB(31.67%)  tps: 853  tflops: 39.77  mfu: 4.02%
[rank2]:2025-10-29 04:50:38,791 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 04:50:38,813 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 49.75GiB(35.58%)  tps: 864  tflops: 40.29  mfu: 4.07%
[rank0]:2025-10-29 04:50:38,813 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 04:50:38,793 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 49.69GiB(35.54%)  tps: 855  tflops: 39.89  mfu: 4.03%
[rank1]:2025-10-29 04:50:38,794 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 04:50:38,796 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.3625  memory: 58.03GiB(41.50%)  tps: 956  tflops: 44.56  mfu: 4.51%
[rank3]:2025-10-29 04:50:38,796 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,133 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,134 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,134 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,265 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,222 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,222 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:52:48,714 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:52:51,454 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 66.72GiB(47.72%)  tps: 6,053  tflops: 282.29  mfu: 28.54%
[rank2]:2025-10-29 04:52:51,447 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 57.29GiB(40.97%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank3]:2025-10-29 04:52:51,451 - INFO -  step: 50  loss:  3.3217  grad_norm: 16.0562  memory: 73.38GiB(52.48%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank1]:2025-10-29 04:52:51,449 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 64.32GiB(46.00%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank2]:2025-10-29 04:52:51,965 - INFO - Avg. fwd time: 13.4042 / Avg. bwd time: 36.4328 / Avg. batch time: 537.1174 (ms) / GPU bubble ratio: 25.77%
[rank3]:2025-10-29 04:52:51,914 - INFO - Avg. fwd time: 14.8182 / Avg. bwd time: 43.1296 / Avg. batch time: 484.1293 (ms) / GPU bubble ratio: 4.24%
[rank1]:2025-10-29 04:52:52,012 - INFO - Avg. fwd time: 15.2003 / Avg. bwd time: 40.9811 / Avg. batch time: 596.8257 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-10-29 04:52:52,045 - INFO - Avg. fwd time: 14.1636 / Avg. bwd time: 38.2459 / Avg. batch time: 652.3509 (ms) / GPU bubble ratio: 35.73%
[rank3]:2025-10-29 04:53:18,294 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 04:53:46,379 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 04:53:46,595 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 04:53:46,695 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:46,711 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:46,734 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,640 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,664 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,698 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,675 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,708 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,724 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,842 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,850 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,802 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,838 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,877 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,916 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,909 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,945 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,926 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,876 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,914 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,952 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,954 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,992 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,985 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:52,023 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:52,002 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:52,038 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:52,061 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:54:29,943 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 04:54:30,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_max_batch_time.svg
[rank3]:> Batch Time: 633.30 ms, GPU Bubble Ratio: 33.61%, 28.22%, 36.61%, 26.26%
[rank3]:2025-10-29 04:54:30,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_min_batch_time.svg
[rank3]:> Batch Time: 357.73 ms, GPU Bubble Ratio: 68.84%, 24.49%, 33.48%, 23.46%
[rank3]:2025-10-29 04:54:30,637 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.73 ms, GPU Bubble Ratio: 32.08%, 23.45%, 28.87%, 23.46%
[rank3]:2025-10-29 04:54:30,638 - INFO - 	> Batch Time: 357.73 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.44)
[rank0]:2025-10-29 04:54:50,499 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.19/0.58, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 04:54:52,147 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,787  tflops: 316.57  mfu: 32.01%
[rank2]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.85, [MB2] 0.28/0.85, [MB3] 0.28/0.85, [MB4] 0.30/0.90, [MB5] 0.31/0.93, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 04:54:52,146 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 6,787  tflops: 316.55  mfu: 32.01%
[rank1]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.89, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 04:54:52,147 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank3]:2025-10-29 04:54:57,171 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 04:54:57,175 - INFO -  step: 100  loss:  2.6930  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 6,516  tflops: 303.91  mfu: 30.73%
[rank2]:2025-10-29 04:54:57,254 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0454_stage2_step100.svg
[rank0]:2025-10-29 04:54:57,258 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0454_stage0_step100.svg
[rank1]:2025-10-29 04:54:57,258 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0454_stage1_step100.svg
[rank0]:2025-10-29 04:54:57,362 - INFO - Avg. fwd time: 14.6014 / Avg. bwd time: 27.5267 / Avg. batch time: 621.6899 (ms) / GPU bubble ratio: 45.79%
[rank3]:2025-10-29 04:54:57,355 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_real_step100_rank3.svg
[rank3]:> Batch Time: 631.99 ms, GPU Bubble Ratio: 33.56%, 28.26%, 36.46%, 26.24%
[rank3]:2025-10-29 04:54:57,414 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0454_stage3_step100.svg
[rank3]:2025-10-29 04:54:57,680 - INFO - Avg. fwd time: 15.5811 / Avg. bwd time: 36.4779 / Avg. batch time: 434.6551 (ms) / GPU bubble ratio: 4.18%
[rank2]:2025-10-29 04:54:57,702 - INFO - Avg. fwd time: 14.0765 / Avg. bwd time: 30.8030 / Avg. batch time: 524.0644 (ms) / GPU bubble ratio: 31.49%
[rank1]:2025-10-29 04:54:57,728 - INFO - Avg. fwd time: 16.0244 / Avg. bwd time: 34.7003 / Avg. batch time: 577.2652 (ms) / GPU bubble ratio: 29.70%
[rank0]:2025-10-29 04:57:03,802 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:57:05,850 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.85, [MB2] 0.57/0.85, [MB3] 0.57/0.85, [MB4] 0.60/0.90, [MB5] 0.62/0.93, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank2]:2025-10-29 04:57:05,851 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 64.67GiB(46.25%)  tps: 6,127  tflops: 285.76  mfu: 28.89%
[rank0]:2025-10-29 04:57:05,855 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.39/0.58, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 04:57:05,856 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 72.30GiB(51.72%)  tps: 6,127  tflops: 285.75  mfu: 28.89%
[rank1]:2025-10-29 04:57:05,847 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.59/0.89, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 04:57:05,848 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 72.72GiB(52.01%)  tps: 6,127  tflops: 285.77  mfu: 28.89%
[rank3]:2025-10-29 04:57:10,846 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 04:57:10,850 - INFO -  step: 150  loss:  2.5598  grad_norm:  0.2547  memory: 84.49GiB(60.43%)  tps: 6,128  tflops: 285.83  mfu: 28.90%
[rank3]:2025-10-29 04:57:11,226 - INFO - Avg. fwd time: 15.8546 / Avg. bwd time: 33.3823 / Avg. batch time: 411.0465 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-29 04:57:11,256 - INFO - Avg. fwd time: 14.1822 / Avg. bwd time: 29.3847 / Avg. batch time: 527.7838 (ms) / GPU bubble ratio: 33.96%
[rank1]:2025-10-29 04:57:11,285 - INFO - Avg. fwd time: 16.1824 / Avg. bwd time: 32.7534 / Avg. batch time: 581.3597 (ms) / GPU bubble ratio: 32.66%
[rank0]:2025-10-29 04:57:11,313 - INFO - Avg. fwd time: 14.7105 / Avg. bwd time: 27.3777 / Avg. batch time: 625.8791 (ms) / GPU bubble ratio: 46.20%
[rank0]:2025-10-29 04:59:02,318 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:59:04,082 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.58/0.58, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:59:04,082 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 73.16GiB(52.33%)  tps: 6,929  tflops: 323.17  mfu: 32.68%
[rank2]:2025-10-29 04:59:04,081 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.85/0.85, [MB2] 0.85/0.85, [MB3] 0.85/0.85, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:59:04,082 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 65.92GiB(47.15%)  tps: 6,929  tflops: 323.16  mfu: 32.68%
[rank0]:2025-10-29 04:59:04,082 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 04:59:04,082 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:59:04,083 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:59:04,083 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 73.05GiB(52.25%)  tps: 6,929  tflops: 323.15  mfu: 32.67%
[rank1]:2025-10-29 04:59:04,083 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 04:59:09,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:59:09,131 - INFO -  step: 200  loss:  2.5508  grad_norm:  0.1116  memory: 84.49GiB(60.43%)  tps: 6,926  tflops: 323.03  mfu: 32.66%
[rank3]:2025-10-29 04:59:09,131 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 04:59:26,684 - INFO - validate step: 200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,123
[rank1]:2025-10-29 04:59:26,720 - INFO - validate step: 200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,095
[rank3]:2025-10-29 04:59:26,775 - INFO - validate step: 200  loss:  1.0028  memory: 84.49GiB(60.43%)  tps: 23,216
[rank2]:2025-10-29 04:59:26,752 - INFO - validate step: 200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,069
[rank2]:2025-10-29 04:59:26,850 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0459_stage2_step200.svg
[rank0]:2025-10-29 04:59:26,850 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0459_stage0_step200.svg
[rank1]:2025-10-29 04:59:26,846 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0459_stage1_step200.svg
[rank3]:2025-10-29 04:59:26,955 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0459_real_step200_rank3.svg
[rank3]:> Batch Time: 500.57 ms, GPU Bubble Ratio: 30.54%, 26.14%, 35.82%, 29.74%
[rank3]:2025-10-29 04:59:27,018 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0459_stage3_step200.svg
[rank2]:2025-10-29 04:59:27,307 - INFO - Avg. fwd time: 14.3805 / Avg. bwd time: 27.3867 / Avg. batch time: 516.8649 (ms) / GPU bubble ratio: 35.35%
[rank3]:2025-10-29 04:59:27,284 - INFO - Avg. fwd time: 16.0922 / Avg. bwd time: 30.9449 / Avg. batch time: 393.0046 (ms) / GPU bubble ratio: 4.25%
[rank0]:2025-10-29 04:59:27,338 - INFO - Avg. fwd time: 14.9194 / Avg. bwd time: 25.4168 / Avg. batch time: 610.7261 (ms) / GPU bubble ratio: 47.16%
[rank1]:2025-10-29 04:59:27,337 - INFO - Avg. fwd time: 16.4202 / Avg. bwd time: 30.4780 / Avg. batch time: 568.2033 (ms) / GPU bubble ratio: 33.97%
[rank0]:2025-10-29 05:01:07,895 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.85/0.85, [MB2] 0.85/0.85, [MB3] 0.85/0.85, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:01:09,548 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,969  tflops: 371.68  mfu: 37.58%
[rank0]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.58/0.58, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:01:09,548 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,964  tflops: 371.44  mfu: 37.56%
[rank1]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:01:09,549 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,967  tflops: 371.57  mfu: 37.57%
[rank0]:2025-10-29 05:01:09,644 - INFO - Avg. fwd time: 15.1344 / Avg. bwd time: 20.3414 / Avg. batch time: 585.6757 (ms) / GPU bubble ratio: 51.54%
[rank3]:2025-10-29 05:01:14,556 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:01:14,560 - INFO -  step: 250  loss:  2.7088  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,600  tflops: 354.48  mfu: 35.84%
[rank3]:2025-10-29 05:01:14,825 - INFO - Avg. fwd time: 16.3631 / Avg. bwd time: 28.5054 / Avg. batch time: 375.3497 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-10-29 05:01:14,847 - INFO - Avg. fwd time: 14.6373 / Avg. bwd time: 25.0614 / Avg. batch time: 500.0059 (ms) / GPU bubble ratio: 36.48%
[rank1]:2025-10-29 05:01:14,873 - INFO - Avg. fwd time: 16.7162 / Avg. bwd time: 27.9629 / Avg. batch time: 548.3929 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 05:02:55,245 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:02:57,029 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank3_trend_line.svg
[rank0]:2025-10-29 05:02:57,072 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank0_trend_line.svg
[rank0]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:02:57,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:02:57,079 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,618  tflops: 355.32  mfu: 35.93%
[rank1]:2025-10-29 05:02:57,059 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank1_trend_line.svg
[rank1]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:02:57,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:02:57,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,618  tflops: 355.32  mfu: 35.93%
[rank2]:2025-10-29 05:02:57,044 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank2_trend_line.svg
[rank2]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.77/0.77, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:02:57,080 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.77/0.77, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:02:57,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,618  tflops: 355.31  mfu: 35.93%
[rank3]:2025-10-29 05:02:57,268 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0502_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.06 ms, GPU Bubble Ratio: 36.73%, 23.66%, 32.20%, 24.33%
[rank3]:2025-10-29 05:02:57,269 - INFO - 	> Batch Time: 362.06 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 05:02:57,269 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:03:02,269 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:03:02,273 - INFO -  step: 300  loss:  2.7718  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,606  tflops: 354.72  mfu: 35.87%
[rank0]:2025-10-29 05:03:02,345 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0502_stage0_step300.svg
[rank1]:2025-10-29 05:03:02,342 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0502_stage1_step300.svg
[rank2]:2025-10-29 05:03:02,346 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0502_stage2_step300.svg
[rank3]:2025-10-29 05:03:02,450 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0503_real_step300_rank3.svg
[rank3]:> Batch Time: 432.21 ms, GPU Bubble Ratio: 37.20%, 25.52%, 35.22%, 26.62%
[rank3]:2025-10-29 05:03:02,513 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0503_stage3_step300.svg
[rank3]:2025-10-29 05:03:02,843 - INFO - Avg. fwd time: 16.5328 / Avg. bwd time: 26.8987 / Avg. batch time: 363.6565 (ms) / GPU bubble ratio: 4.46%
[rank0]:2025-10-29 05:03:02,892 - INFO - Avg. fwd time: 15.2667 / Avg. bwd time: 16.7852 / Avg. batch time: 572.9063 (ms) / GPU bubble ratio: 55.24%
[rank1]:2025-10-29 05:03:02,887 - INFO - Avg. fwd time: 16.8963 / Avg. bwd time: 26.2815 / Avg. batch time: 539.2911 (ms) / GPU bubble ratio: 35.95%
[rank2]:2025-10-29 05:03:02,864 - INFO - Avg. fwd time: 14.8055 / Avg. bwd time: 23.5409 / Avg. batch time: 492.9767 (ms) / GPU bubble ratio: 37.77%
[rank0]:2025-10-29 05:04:43,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:04:44,836 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,602  tflops: 354.57  mfu: 35.85%
[rank2]:2025-10-29 05:04:44,836 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,602  tflops: 354.58  mfu: 35.85%
[rank1]:2025-10-29 05:04:44,837 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,602  tflops: 354.57  mfu: 35.85%
[rank0]:2025-10-29 05:04:44,935 - INFO - Avg. fwd time: 15.3488 / Avg. bwd time: 14.5979 / Avg. batch time: 564.0222 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-10-29 05:04:50,004 - INFO -  step: 350  loss:  2.6123  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,604  tflops: 354.67  mfu: 35.86%
[rank2]:2025-10-29 05:04:50,296 - INFO - Avg. fwd time: 14.9093 / Avg. bwd time: 22.6044 / Avg. batch time: 487.6229 (ms) / GPU bubble ratio: 38.45%
[rank3]:2025-10-29 05:04:50,274 - INFO - Avg. fwd time: 16.6401 / Avg. bwd time: 25.9169 / Avg. batch time: 356.5425 (ms) / GPU bubble ratio: 4.51%
[rank1]:2025-10-29 05:04:50,322 - INFO - Avg. fwd time: 17.0111 / Avg. bwd time: 25.2472 / Avg. batch time: 532.6644 (ms) / GPU bubble ratio: 36.53%
[rank0]:2025-10-29 05:06:29,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:06:31,397 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank3_trend_line.svg
[rank1]:2025-10-29 05:06:31,431 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank1_trend_line.svg
[rank1]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.68/0.68, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:06:31,434 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank0_trend_line.svg
[rank1]:2025-10-29 05:06:31,443 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank0]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:06:31,442 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank0]:2025-10-29 05:06:31,442 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:06:31,443 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 05:06:31,422 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank2_trend_line.svg
[rank2]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:06:31,443 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank2]:2025-10-29 05:06:31,443 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:06:31,630 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0506_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 361.69 ms, GPU Bubble Ratio: 51.69%, 23.68%, 32.09%, 24.32%
[rank3]:2025-10-29 05:06:31,630 - INFO - 	> Batch Time: 361.69 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 05:06:31,631 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:06:36,635 - INFO -  step: 400  loss:  3.8832  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,683  tflops: 358.32  mfu: 36.23%
[rank3]:2025-10-29 05:06:36,635 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:06:53,069 - INFO - validate step: 400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,940
[rank0]:2025-10-29 05:06:53,033 - INFO - validate step: 400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,971
[rank2]:2025-10-29 05:06:53,099 - INFO - validate step: 400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,914
[rank3]:2025-10-29 05:06:53,123 - INFO - validate step: 400  loss:  0.9816  memory: 84.49GiB(60.43%)  tps: 24,843
[rank0]:2025-10-29 05:06:53,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0506_stage0_step400.svg
[rank1]:2025-10-29 05:06:53,203 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0506_stage1_step400.svg
[rank2]:2025-10-29 05:06:53,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0506_stage2_step400.svg
[rank0]:2025-10-29 05:06:53,282 - INFO - Avg. fwd time: 15.4048 / Avg. bwd time: 12.6715 / Avg. batch time: 556.9494 (ms) / GPU bubble ratio: 59.67%
[rank3]:2025-10-29 05:06:53,302 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0506_real_step400_rank3.svg
[rank3]:> Batch Time: 381.23 ms, GPU Bubble Ratio: 66.99%, 24.24%, 32.87%, 23.00%
[rank3]:2025-10-29 05:06:53,370 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0506_stage3_step400.svg
[rank3]:2025-10-29 05:06:53,617 - INFO - Avg. fwd time: 16.7146 / Avg. bwd time: 25.0294 / Avg. batch time: 349.9312 (ms) / GPU bubble ratio: 4.57%
[rank1]:2025-10-29 05:06:53,663 - INFO - Avg. fwd time: 17.0950 / Avg. bwd time: 24.3254 / Avg. batch time: 527.5912 (ms) / GPU bubble ratio: 37.19%
[rank2]:2025-10-29 05:06:53,638 - INFO - Avg. fwd time: 14.9881 / Avg. bwd time: 21.7691 / Avg. batch time: 483.6872 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 05:08:28,736 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:08:30,273 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,428  tflops: 393.07  mfu: 39.74%
[rank0]:2025-10-29 05:08:30,272 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,425  tflops: 392.93  mfu: 39.73%
[rank2]:2025-10-29 05:08:30,272 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,430  tflops: 393.19  mfu: 39.76%
[rank3]:2025-10-29 05:08:35,268 - INFO -  step: 450  loss:  4.6453  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,020  tflops: 374.06  mfu: 37.82%
[rank2]:2025-10-29 05:08:35,593 - INFO - Avg. fwd time: 14.9950 / Avg. bwd time: 21.0847 / Avg. batch time: 479.3666 (ms) / GPU bubble ratio: 39.79%
[rank3]:2025-10-29 05:08:35,571 - INFO - Avg. fwd time: 16.6989 / Avg. bwd time: 24.2773 / Avg. batch time: 343.6937 (ms) / GPU bubble ratio: 4.62%
[rank0]:2025-10-29 05:08:35,622 - INFO - Avg. fwd time: 15.3948 / Avg. bwd time: 11.1944 / Avg. batch time: 550.1384 (ms) / GPU bubble ratio: 61.33%
[rank1]:2025-10-29 05:08:35,616 - INFO - Avg. fwd time: 17.1019 / Avg. bwd time: 23.5811 / Avg. batch time: 522.3509 (ms) / GPU bubble ratio: 37.69%
[rank0]:2025-10-29 05:10:10,565 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:10:12,076 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank2]:2025-10-29 05:10:12,076 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank1]:2025-10-29 05:10:12,077 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank3]:2025-10-29 05:10:17,077 - INFO -  step: 500  loss:  4.9675  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,047  tflops: 375.30  mfu: 37.95%
[rank0]:2025-10-29 05:10:17,151 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0510_stage0_step500.svg
[rank2]:2025-10-29 05:10:17,152 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0510_stage2_step500.svg
[rank1]:2025-10-29 05:10:17,149 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0510_stage1_step500.svg
[rank0]:2025-10-29 05:10:17,240 - INFO - Avg. fwd time: 15.3847 / Avg. bwd time: 10.1776 / Avg. batch time: 544.6012 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-10-29 05:10:17,263 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0510_real_step500_rank3.svg
[rank3]:> Batch Time: 378.57 ms, GPU Bubble Ratio: 67.02%, 24.18%, 33.02%, 23.14%
[rank3]:2025-10-29 05:10:17,326 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0510_stage3_step500.svg
[rank3]:2025-10-29 05:10:17,566 - INFO - Avg. fwd time: 16.6846 / Avg. bwd time: 23.7541 / Avg. batch time: 339.3274 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 05:10:17,587 - INFO - Avg. fwd time: 14.9992 / Avg. bwd time: 20.6121 / Avg. batch time: 475.5602 (ms) / GPU bubble ratio: 40.09%
[rank1]:2025-10-29 05:10:17,611 - INFO - Avg. fwd time: 17.1026 / Avg. bwd time: 23.0641 / Avg. batch time: 517.8970 (ms) / GPU bubble ratio: 37.95%
[rank0]:2025-10-29 05:11:52,652 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:11:54,176 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank2]:2025-10-29 05:11:54,175 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank0]:2025-10-29 05:11:54,175 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank0]:2025-10-29 05:11:54,261 - INFO - Avg. fwd time: 15.3758 / Avg. bwd time: 9.2024 / Avg. batch time: 537.8715 (ms) / GPU bubble ratio: 63.44%
[rank3]:2025-10-29 05:11:59,182 - INFO -  step: 550  loss:  4.7758  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,023  tflops: 374.21  mfu: 37.84%
[rank3]:2025-10-29 05:11:59,422 - INFO - Avg. fwd time: 16.6718 / Avg. bwd time: 23.2544 / Avg. batch time: 335.1642 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 05:11:59,443 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 20.1596 / Avg. batch time: 470.4947 (ms) / GPU bubble ratio: 40.21%
[rank1]:2025-10-29 05:11:59,467 - INFO - Avg. fwd time: 17.1015 / Avg. bwd time: 22.5668 / Avg. batch time: 512.2052 (ms) / GPU bubble ratio: 38.04%
[rank0]:2025-10-29 05:13:34,476 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:13:36,285 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank3_trend_line.svg
[rank1]:2025-10-29 05:13:36,316 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank1_trend_line.svg
[rank1]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:13:36,331 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank1]:2025-10-29 05:13:36,332 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 05:13:36,299 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank2_trend_line.svg
[rank2]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.74/0.74, [MB4] 0.78/0.78, [MB5] 0.85/0.85, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:13:36,332 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank2]:2025-10-29 05:13:36,332 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 05:13:36,323 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank0_trend_line.svg
[rank0]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 05:13:36,331 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,019  tflops: 374.02  mfu: 37.82%
[rank0]:2025-10-29 05:13:36,331 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:13:36,521 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0513_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.83 ms, GPU Bubble Ratio: 59.29%, 24.52%, 30.24%, 23.86%
[rank3]:2025-10-29 05:13:36,521 - INFO - 	> Batch Time: 355.83 ms (Average Freeze Ratio: 0.70)
[rank3]:2025-10-29 05:13:36,521 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:13:41,545 - INFO -  step: 600  loss:  4.6548  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,003  tflops: 373.27  mfu: 37.74%
[rank3]:2025-10-29 05:13:41,545 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 05:13:57,856 - INFO - validate step: 600  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,029
[rank2]:2025-10-29 05:13:57,923 - INFO - validate step: 600  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,971
[rank1]:2025-10-29 05:13:57,893 - INFO - validate step: 600  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,997
[rank3]:2025-10-29 05:13:57,947 - INFO - validate step: 600  loss:  1.0068  memory: 84.49GiB(60.43%)  tps: 24,974
[rank0]:2025-10-29 05:13:58,021 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0513_stage0_step600.svg
[rank2]:2025-10-29 05:13:58,020 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0513_stage2_step600.svg
[rank1]:2025-10-29 05:13:58,022 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0513_stage1_step600.svg
[rank3]:2025-10-29 05:13:58,132 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0513_real_step600_rank3.svg
[rank3]:> Batch Time: 376.58 ms, GPU Bubble Ratio: 67.04%, 24.15%, 32.98%, 23.20%
[rank3]:2025-10-29 05:13:58,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0513_stage3_step600.svg
[rank3]:2025-10-29 05:13:58,506 - INFO - Avg. fwd time: 16.6603 / Avg. bwd time: 22.8414 / Avg. batch time: 331.7157 (ms) / GPU bubble ratio: 4.73%
[rank0]:2025-10-29 05:13:58,559 - INFO - Avg. fwd time: 15.3674 / Avg. bwd time: 8.3979 / Avg. batch time: 534.3406 (ms) / GPU bubble ratio: 64.42%
[rank2]:2025-10-29 05:13:58,528 - INFO - Avg. fwd time: 15.0054 / Avg. bwd time: 19.7847 / Avg. batch time: 468.3353 (ms) / GPU bubble ratio: 40.57%
[rank1]:2025-10-29 05:13:58,552 - INFO - Avg. fwd time: 17.1002 / Avg. bwd time: 22.1557 / Avg. batch time: 509.5316 (ms) / GPU bubble ratio: 38.37%
[rank0]:2025-10-29 05:16:09,906 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:16:12,212 - INFO -  step: 650  loss: -4.0000  grad_norm:  7.2121  memory: 73.16GiB(52.33%)  tps: 6,097  tflops: 284.38  mfu: 28.75%
[rank1]:2025-10-29 05:16:12,187 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank2]:2025-10-29 05:16:12,186 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank3]:2025-10-29 05:16:17,207 - INFO -  step: 650  loss:  4.1732  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,883  tflops: 274.37  mfu: 27.74%
[rank2]:2025-10-29 05:16:17,471 - INFO - Avg. fwd time: 15.0057 / Avg. bwd time: 19.5121 / Avg. batch time: 467.3687 (ms) / GPU bubble ratio: 40.92%
[rank3]:2025-10-29 05:16:17,451 - INFO - Avg. fwd time: 16.6471 / Avg. bwd time: 22.5361 / Avg. batch time: 329.1287 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-10-29 05:16:17,531 - INFO - Avg. fwd time: 17.0904 / Avg. bwd time: 21.8443 / Avg. batch time: 512.4064 (ms) / GPU bubble ratio: 39.21%
[rank0]:2025-10-29 05:16:17,649 - INFO - Avg. fwd time: 15.2517 / Avg. bwd time: 10.4847 / Avg. batch time: 543.4905 (ms) / GPU bubble ratio: 62.12%
[rank0]:2025-10-29 05:18:28,838 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:18:31,152 - INFO -  step: 700  loss: -4.0000  grad_norm: 33.6212  memory: 73.16GiB(52.33%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank1]:2025-10-29 05:18:31,126 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank2]:2025-10-29 05:18:31,126 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank3]:2025-10-29 05:18:36,128 - INFO -  step: 700  loss:  3.9439  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,897  tflops: 275.04  mfu: 27.81%
[rank0]:2025-10-29 05:18:36,206 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0518_stage0_step700.svg
[rank1]:2025-10-29 05:18:36,207 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0518_stage1_step700.svg
[rank2]:2025-10-29 05:18:36,207 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0518_stage2_step700.svg
[rank3]:2025-10-29 05:18:36,313 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0518_real_step700_rank3.svg
[rank3]:> Batch Time: 374.19 ms, GPU Bubble Ratio: 67.13%, 24.08%, 32.89%, 23.23%
[rank3]:2025-10-29 05:18:36,379 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0518_stage3_step700.svg
[rank3]:2025-10-29 05:18:36,621 - INFO - Avg. fwd time: 16.6288 / Avg. bwd time: 22.2238 / Avg. batch time: 326.4425 (ms) / GPU bubble ratio: 4.79%
[rank1]:2025-10-29 05:18:36,701 - INFO - Avg. fwd time: 17.0778 / Avg. bwd time: 21.5289 / Avg. batch time: 515.7803 (ms) / GPU bubble ratio: 40.12%
[rank2]:2025-10-29 05:18:36,642 - INFO - Avg. fwd time: 15.0029 / Avg. bwd time: 19.2355 / Avg. batch time: 466.8967 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 05:18:36,821 - INFO - Avg. fwd time: 15.1317 / Avg. bwd time: 12.5759 / Avg. batch time: 553.1476 (ms) / GPU bubble ratio: 59.93%
[rank0]:2025-10-29 05:20:48,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:20:50,614 - INFO -  step: 750  loss: -4.0000  grad_norm: 16.3697  memory: 73.16GiB(52.33%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank1]:2025-10-29 05:20:50,588 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank2]:2025-10-29 05:20:50,588 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank3]:2025-10-29 05:20:55,617 - INFO -  step: 750  loss:  3.7923  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,873  tflops: 273.92  mfu: 27.70%
[rank3]:2025-10-29 05:20:55,928 - INFO - Avg. fwd time: 16.6127 / Avg. bwd time: 21.9561 / Avg. batch time: 324.1366 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 05:20:55,957 - INFO - Avg. fwd time: 14.9998 / Avg. bwd time: 18.9986 / Avg. batch time: 466.6563 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 05:20:56,037 - INFO - Avg. fwd time: 17.0643 / Avg. bwd time: 21.2574 / Avg. batch time: 518.8427 (ms) / GPU bubble ratio: 40.91%
[rank0]:2025-10-29 05:20:56,138 - INFO - Avg. fwd time: 15.0268 / Avg. bwd time: 14.3733 / Avg. batch time: 561.6126 (ms) / GPU bubble ratio: 58.12%
[rank0]:2025-10-29 05:23:07,192 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:23:09,815 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank3_trend_line.svg
[rank2]:2025-10-29 05:23:09,832 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank2_trend_line.svg
[rank1]:2025-10-29 05:23:09,826 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank1_trend_line.svg
[rank0]:2025-10-29 05:23:09,908 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank0_trend_line.svg
[rank0]:2025-10-29 05:23:09,914 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:23:09,916 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.2241  memory: 73.16GiB(52.33%)  tps: 5,881  tflops: 274.28  mfu: 27.73%
[rank0]:2025-10-29 05:23:09,917 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 05:23:09,915 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.71/0.71, [MB1] 0.71/0.71, [MB2] 0.71/0.71, [MB3] 0.71/0.71, [MB4] 0.75/0.75, [MB5] 0.83/0.83, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:23:09,918 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,880  tflops: 274.22  mfu: 27.73%
[rank1]:2025-10-29 05:23:09,914 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:23:09,919 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 05:23:09,917 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,880  tflops: 274.23  mfu: 27.73%
[rank1]:2025-10-29 05:23:09,918 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 05:23:10,105 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0523_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 354.33 ms, GPU Bubble Ratio: 35.28%, 24.58%, 30.27%, 23.95%
[rank3]:2025-10-29 05:23:10,105 - INFO - 	> Batch Time: 354.33 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 05:23:10,106 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:23:15,151 - INFO -  step: 800  loss:  3.7652  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,871  tflops: 273.83  mfu: 27.69%
[rank3]:2025-10-29 05:23:15,152 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 05:23:31,493 - INFO - validate step: 800  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,984
[rank2]:2025-10-29 05:23:31,553 - INFO - validate step: 800  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,933
[rank1]:2025-10-29 05:23:31,524 - INFO - validate step: 800  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,957
[rank3]:2025-10-29 05:23:31,577 - INFO - validate step: 800  loss:  0.9155  memory: 84.49GiB(60.43%)  tps: 24,939
[rank0]:2025-10-29 05:23:31,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0523_stage0_step800.svg
[rank2]:2025-10-29 05:23:31,661 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0523_stage2_step800.svg
[rank1]:2025-10-29 05:23:31,659 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0523_stage1_step800.svg
[rank3]:2025-10-29 05:23:31,764 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0523_real_step800_rank3.svg
[rank3]:> Batch Time: 371.94 ms, GPU Bubble Ratio: 67.20%, 23.96%, 32.75%, 23.30%
[rank3]:2025-10-29 05:23:31,832 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0523_stage3_step800.svg
[rank3]:2025-10-29 05:23:32,080 - INFO - Avg. fwd time: 16.5996 / Avg. bwd time: 21.7534 / Avg. batch time: 322.3837 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 05:23:32,103 - INFO - Avg. fwd time: 14.9967 / Avg. bwd time: 18.8190 / Avg. batch time: 465.8926 (ms) / GPU bubble ratio: 41.93%
[rank1]:2025-10-29 05:23:32,160 - INFO - Avg. fwd time: 17.0536 / Avg. bwd time: 21.0521 / Avg. batch time: 520.5569 (ms) / GPU bubble ratio: 41.44%
[rank0]:2025-10-29 05:23:32,276 - INFO - Avg. fwd time: 14.9466 / Avg. bwd time: 15.7229 / Avg. batch time: 567.3791 (ms) / GPU bubble ratio: 56.76%
[rank0]:2025-10-29 05:25:07,486 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:25:09,030 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,399  tflops: 391.73  mfu: 39.61%
[rank2]:2025-10-29 05:25:09,030 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,404  tflops: 391.97  mfu: 39.63%
[rank1]:2025-10-29 05:25:09,031 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank0]:2025-10-29 05:25:09,115 - INFO - Avg. fwd time: 14.9540 / Avg. bwd time: 14.9761 / Avg. batch time: 562.6968 (ms) / GPU bubble ratio: 57.45%
[rank3]:2025-10-29 05:25:13,991 - INFO -  step: 850  loss:  3.8260  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,999  tflops: 373.08  mfu: 37.72%
[rank3]:2025-10-29 05:25:14,229 - INFO - Avg. fwd time: 16.5932 / Avg. bwd time: 21.5561 / Avg. batch time: 320.7294 (ms) / GPU bubble ratio: 4.84%
[rank2]:2025-10-29 05:25:14,249 - INFO - Avg. fwd time: 14.9955 / Avg. bwd time: 18.6380 / Avg. batch time: 463.3525 (ms) / GPU bubble ratio: 41.93%
[rank1]:2025-10-29 05:25:14,273 - INFO - Avg. fwd time: 17.0523 / Avg. bwd time: 20.8562 / Avg. batch time: 517.2129 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 05:26:48,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:26:50,483 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank2]:2025-10-29 05:26:50,483 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank1]:2025-10-29 05:26:50,484 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank3]:2025-10-29 05:26:55,471 - INFO -  step: 900  loss:  3.8683  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,073  tflops: 376.51  mfu: 38.07%
[rank0]:2025-10-29 05:26:55,543 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0526_stage0_step900.svg
[rank2]:2025-10-29 05:26:55,543 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0526_stage2_step900.svg
[rank1]:2025-10-29 05:26:55,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0526_stage1_step900.svg
[rank3]:2025-10-29 05:26:55,653 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0526_real_step900_rank3.svg
[rank3]:> Batch Time: 370.61 ms, GPU Bubble Ratio: 67.13%, 23.88%, 32.67%, 23.33%
[rank3]:2025-10-29 05:26:55,713 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0526_stage3_step900.svg
[rank3]:2025-10-29 05:26:56,017 - INFO - Avg. fwd time: 16.5865 / Avg. bwd time: 21.3793 / Avg. batch time: 319.2394 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 05:26:56,040 - INFO - Avg. fwd time: 14.9936 / Avg. bwd time: 18.4765 / Avg. batch time: 462.2641 (ms) / GPU bubble ratio: 42.08%
[rank0]:2025-10-29 05:26:56,071 - INFO - Avg. fwd time: 14.9673 / Avg. bwd time: 14.1030 / Avg. batch time: 558.8200 (ms) / GPU bubble ratio: 58.38%
[rank1]:2025-10-29 05:26:56,065 - INFO - Avg. fwd time: 17.0480 / Avg. bwd time: 20.6807 / Avg. batch time: 515.0676 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:28:30,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:28:32,448 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank2]:2025-10-29 05:28:32,447 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank0]:2025-10-29 05:28:32,447 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank0]:2025-10-29 05:28:32,534 - INFO - Avg. fwd time: 14.9774 / Avg. bwd time: 13.4317 / Avg. batch time: 555.5093 (ms) / GPU bubble ratio: 59.09%
[rank3]:2025-10-29 05:28:37,508 - INFO -  step: 950  loss:  3.8264  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,029  tflops: 374.46  mfu: 37.86%
[rank3]:2025-10-29 05:28:37,751 - INFO - Avg. fwd time: 16.5824 / Avg. bwd time: 21.2446 / Avg. batch time: 318.1128 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 05:28:37,771 - INFO - Avg. fwd time: 14.9922 / Avg. bwd time: 18.3529 / Avg. batch time: 461.0981 (ms) / GPU bubble ratio: 42.15%
[rank1]:2025-10-29 05:28:37,796 - INFO - Avg. fwd time: 17.0451 / Avg. bwd time: 20.5457 / Avg. batch time: 513.0890 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 05:30:12,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:30:14,277 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank1]:2025-10-29 05:30:14,277 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 05:30:14,276 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank2]:2025-10-29 05:30:14,277 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 05:30:14,276 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank0]:2025-10-29 05:30:14,276 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 05:30:19,301 - INFO -  step: 1000  loss:  3.8363  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,048  tflops: 375.36  mfu: 37.95%
[rank3]:2025-10-29 05:30:19,301 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 05:30:35,637 - INFO - validate step: 1000  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,176
[rank1]:2025-10-29 05:30:35,674 - INFO - validate step: 1000  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,143
[rank2]:2025-10-29 05:30:35,707 - INFO - validate step: 1000  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,113
[rank3]:2025-10-29 05:30:35,729 - INFO - validate step: 1000  loss:  0.9211  memory: 84.49GiB(60.43%)  tps: 24,935
[rank1]:2025-10-29 05:30:35,807 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0530_stage1_step1000.svg
[rank2]:2025-10-29 05:30:35,805 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0530_stage2_step1000.svg
[rank0]:2025-10-29 05:30:35,807 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0530_stage0_step1000.svg
[rank0]:2025-10-29 05:30:35,895 - INFO - Avg. fwd time: 14.9870 / Avg. bwd time: 12.7252 / Avg. batch time: 552.4260 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-29 05:30:35,915 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0530_real_step1000_rank3.svg
[rank3]:> Batch Time: 369.64 ms, GPU Bubble Ratio: 67.07%, 23.88%, 32.64%, 23.32%
[rank3]:2025-10-29 05:30:35,978 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0530_stage3_step1000.svg
[rank2]:2025-10-29 05:30:36,242 - INFO - Avg. fwd time: 14.9898 / Avg. bwd time: 18.2213 / Avg. batch time: 460.2764 (ms) / GPU bubble ratio: 42.28%
[rank3]:2025-10-29 05:30:36,222 - INFO - Avg. fwd time: 16.5767 / Avg. bwd time: 21.1010 / Avg. batch time: 316.9003 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 05:30:36,267 - INFO - Avg. fwd time: 17.0401 / Avg. bwd time: 20.4013 / Avg. batch time: 511.4080 (ms) / GPU bubble ratio: 41.43%
[rank0]:2025-10-29 05:32:11,959 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:32:13,503 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,374  tflops: 390.56  mfu: 39.49%
[rank2]:2025-10-29 05:32:13,503 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,377  tflops: 390.69  mfu: 39.50%
[rank0]:2025-10-29 05:32:13,502 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,371  tflops: 390.41  mfu: 39.48%
[rank3]:2025-10-29 05:32:18,490 - INFO -  step: 1050  loss:  3.8104  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank3]:2025-10-29 05:32:18,803 - INFO - Avg. fwd time: 16.5726 / Avg. bwd time: 20.9736 / Avg. batch time: 315.8324 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 05:32:18,827 - INFO - Avg. fwd time: 14.9882 / Avg. bwd time: 18.1038 / Avg. batch time: 459.7187 (ms) / GPU bubble ratio: 42.41%
[rank1]:2025-10-29 05:32:18,853 - INFO - Avg. fwd time: 17.0373 / Avg. bwd time: 20.2733 / Avg. batch time: 510.0793 (ms) / GPU bubble ratio: 41.48%
[rank0]:2025-10-29 05:32:18,860 - INFO - Avg. fwd time: 14.9969 / Avg. bwd time: 12.0892 / Avg. batch time: 549.8369 (ms) / GPU bubble ratio: 60.59%
[rank0]:2025-10-29 05:33:53,761 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:33:55,300 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank1]:2025-10-29 05:33:55,301 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank0]:2025-10-29 05:33:55,300 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank3]:2025-10-29 05:34:00,223 - INFO -  step: 1100  loss:  3.8420  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,053  tflops: 375.58  mfu: 37.98%
[rank1]:2025-10-29 05:34:00,299 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0533_stage1_step1100.svg
[rank0]:2025-10-29 05:34:00,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0533_stage0_step1100.svg
[rank2]:2025-10-29 05:34:00,298 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0533_stage2_step1100.svg
[rank0]:2025-10-29 05:34:00,389 - INFO - Avg. fwd time: 15.0043 / Avg. bwd time: 11.5927 / Avg. batch time: 547.3473 (ms) / GPU bubble ratio: 61.13%
[rank3]:2025-10-29 05:34:00,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0534_real_step1100_rank3.svg
[rank3]:> Batch Time: 368.94 ms, GPU Bubble Ratio: 67.03%, 23.87%, 32.60%, 23.32%
[rank3]:2025-10-29 05:34:00,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0534_stage3_step1100.svg
[rank3]:2025-10-29 05:34:00,713 - INFO - Avg. fwd time: 16.5677 / Avg. bwd time: 20.8710 / Avg. batch time: 314.9593 (ms) / GPU bubble ratio: 4.91%
[rank1]:2025-10-29 05:34:00,759 - INFO - Avg. fwd time: 17.0345 / Avg. bwd time: 20.1733 / Avg. batch time: 508.5746 (ms) / GPU bubble ratio: 41.47%
[rank2]:2025-10-29 05:34:00,734 - INFO - Avg. fwd time: 14.9876 / Avg. bwd time: 18.0130 / Avg. batch time: 458.8139 (ms) / GPU bubble ratio: 42.46%
[rank0]:2025-10-29 05:35:35,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank1]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank2]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank0]:2025-10-29 05:35:36,776 - INFO - Avg. fwd time: 15.0118 / Avg. bwd time: 11.0626 / Avg. batch time: 543.8555 (ms) / GPU bubble ratio: 61.65%
[rank3]:2025-10-29 05:35:41,635 - INFO -  step: 1150  loss:  3.7717  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,078  tflops: 376.76  mfu: 38.10%
[rank2]:2025-10-29 05:35:41,903 - INFO - Avg. fwd time: 14.9868 / Avg. bwd time: 17.9156 / Avg. batch time: 457.0153 (ms) / GPU bubble ratio: 42.40%
[rank3]:2025-10-29 05:35:41,883 - INFO - Avg. fwd time: 16.5617 / Avg. bwd time: 20.7603 / Avg. batch time: 314.0125 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 05:35:41,928 - INFO - Avg. fwd time: 17.0315 / Avg. bwd time: 20.0659 / Avg. batch time: 506.1352 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 05:37:16,739 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank1]:2025-10-29 05:37:18,304 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank0]:2025-10-29 05:37:18,303 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank2]:2025-10-29 05:37:18,303 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 05:37:23,329 - INFO -  step: 1200  loss:  3.7816  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,056  tflops: 375.72  mfu: 37.99%
[rank3]:2025-10-29 05:37:23,329 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 05:37:39,691 - INFO - validate step: 1200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,151
[rank0]:2025-10-29 05:37:39,692 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 05:37:39,695 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 05:37:39,757 - INFO - validate step: 1200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,093
[rank2]:2025-10-29 05:37:39,757 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 05:37:39,729 - INFO - validate step: 1200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,118
[rank1]:2025-10-29 05:37:39,730 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 05:37:39,780 - INFO - validate step: 1200  loss:  0.9170  memory: 84.49GiB(60.43%)  tps: 24,899
[rank3]:2025-10-29 05:37:39,781 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 05:37:50,376 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.62 seconds.
[rank3]:2025-10-29 05:37:52,346 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.57 seconds.
[rank0]:2025-10-29 05:37:53,799 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 05:37:53,807 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.12 seconds.
[rank1]:2025-10-29 05:37:55,828 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.10 seconds.
[rank2]:2025-10-29 05:37:55,936 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0537_stage2_step1200.svg
[rank2]:2025-10-29 05:37:55,948 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 05:37:55,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0537_stage1_step1200.svg
[rank1]:2025-10-29 05:37:55,952 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 05:37:56,037 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0537_stage0_step1200.svg
[rank0]:2025-10-29 05:37:56,048 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 05:37:56,154 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0537_real_step1200_rank3.svg
[rank3]:> Batch Time: 368.35 ms, GPU Bubble Ratio: 67.00%, 23.86%, 32.57%, 23.31%
[rank3]:2025-10-29 05:37:56,230 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0537_stage3_step1200.svg
[rank3]:2025-10-29 05:37:56,245 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 05:37:57,438 - INFO - Avg. fwd time: 16.5588 / Avg. bwd time: 20.6637 / Avg. batch time: 313.3859 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 05:37:57,505 - INFO - Avg. fwd time: 15.0208 / Avg. bwd time: 10.5788 / Avg. batch time: 541.9934 (ms) / GPU bubble ratio: 62.21%
[rank2]:2025-10-29 05:37:57,466 - INFO - Avg. fwd time: 14.9867 / Avg. bwd time: 17.8279 / Avg. batch time: 456.6920 (ms) / GPU bubble ratio: 42.52%
[rank1]:2025-10-29 05:37:57,493 - INFO - Avg. fwd time: 17.0304 / Avg. bwd time: 19.9690 / Avg. batch time: 505.2260 (ms) / GPU bubble ratio: 41.41%
[rank0]:2025-10-29 05:39:39,301 - INFO - [GC] Peforming periodical GC collection 2.07 seconds
[rank0]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 6,755  tflops: 315.06  mfu: 31.86%
[rank2]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 6,759  tflops: 315.23  mfu: 31.87%
[rank1]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 6,757  tflops: 315.16  mfu: 31.87%
[rank0]:2025-10-29 05:39:41,061 - INFO - Avg. fwd time: 15.0510 / Avg. bwd time: 10.1967 / Avg. batch time: 540.4975 (ms) / GPU bubble ratio: 62.63%
[rank3]:2025-10-29 05:39:46,077 - INFO -  step: 1250  loss:  2.5470  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 6,486  tflops: 302.53  mfu: 30.59%
[rank3]:2025-10-29 05:39:46,345 - INFO - Avg. fwd time: 16.5869 / Avg. bwd time: 20.6155 / Avg. batch time: 313.2147 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:39:46,366 - INFO - Avg. fwd time: 15.0086 / Avg. bwd time: 17.7753 / Avg. batch time: 456.3691 (ms) / GPU bubble ratio: 42.53%
[rank1]:2025-10-29 05:39:46,391 - INFO - Avg. fwd time: 17.0550 / Avg. bwd time: 19.9102 / Avg. batch time: 504.4686 (ms) / GPU bubble ratio: 41.38%
[rank0]:2025-10-29 05:41:27,003 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank2]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank0]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank3]:2025-10-29 05:41:33,748 - INFO -  step: 1300  loss:  2.6334  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,608  tflops: 354.86  mfu: 35.88%
[rank2]:2025-10-29 05:41:33,829 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0541_stage2_step1300.svg
[rank1]:2025-10-29 05:41:33,827 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0541_stage1_step1300.svg
[rank0]:2025-10-29 05:41:33,829 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0541_stage0_step1300.svg
[rank3]:2025-10-29 05:41:33,933 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0541_real_step1300_rank3.svg
[rank3]:> Batch Time: 369.50 ms, GPU Bubble Ratio: 67.01%, 23.86%, 32.62%, 23.33%
[rank0]:2025-10-29 05:41:33,929 - INFO - Avg. fwd time: 15.0832 / Avg. bwd time: 9.7843 / Avg. batch time: 539.4374 (ms) / GPU bubble ratio: 63.12%
[rank3]:2025-10-29 05:41:33,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0541_stage3_step1300.svg
[rank3]:2025-10-29 05:41:34,269 - INFO - Avg. fwd time: 16.6177 / Avg. bwd time: 20.5644 / Avg. batch time: 313.0421 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:41:34,290 - INFO - Avg. fwd time: 15.0323 / Avg. bwd time: 17.7185 / Avg. batch time: 456.5780 (ms) / GPU bubble ratio: 42.62%
[rank1]:2025-10-29 05:41:34,316 - INFO - Avg. fwd time: 17.0818 / Avg. bwd time: 19.8462 / Avg. batch time: 504.2087 (ms) / GPU bubble ratio: 41.41%
[rank0]:2025-10-29 05:43:14,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:43:16,197 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank2]:2025-10-29 05:43:16,196 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank0]:2025-10-29 05:43:16,196 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank3]:2025-10-29 05:43:21,211 - INFO -  step: 1350  loss:  2.5469  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,623  tflops: 355.55  mfu: 35.95%
[rank3]:2025-10-29 05:43:21,550 - INFO - Avg. fwd time: 16.6451 / Avg. bwd time: 20.5164 / Avg. batch time: 312.8668 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:43:21,603 - INFO - Avg. fwd time: 17.1060 / Avg. bwd time: 19.7871 / Avg. batch time: 503.9248 (ms) / GPU bubble ratio: 41.43%
[rank2]:2025-10-29 05:43:21,575 - INFO - Avg. fwd time: 15.0532 / Avg. bwd time: 17.6651 / Avg. batch time: 456.7267 (ms) / GPU bubble ratio: 42.69%
[rank0]:2025-10-29 05:43:21,612 - INFO - Avg. fwd time: 15.1123 / Avg. bwd time: 9.4040 / Avg. batch time: 538.4160 (ms) / GPU bubble ratio: 63.57%
[rank0]:2025-10-29 05:45:02,175 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank1]:2025-10-29 05:45:03,825 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank2]:2025-10-29 05:45:03,824 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank0]:2025-10-29 05:45:03,824 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 05:45:08,889 - INFO -  step: 1400  loss:  2.4903  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,608  tflops: 354.84  mfu: 35.88%
[rank3]:2025-10-29 05:45:08,890 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 05:45:25,279 - INFO - validate step: 1400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,092
[rank2]:2025-10-29 05:45:25,309 - INFO - validate step: 1400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,065
[rank0]:2025-10-29 05:45:25,241 - INFO - validate step: 1400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,125
[rank3]:2025-10-29 05:45:25,333 - INFO - validate step: 1400  loss:  0.9176  memory: 84.49GiB(60.43%)  tps: 24,911
[rank0]:2025-10-29 05:45:25,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0545_stage0_step1400.svg
[rank1]:2025-10-29 05:45:25,416 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0545_stage1_step1400.svg
[rank2]:2025-10-29 05:45:25,416 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0545_stage2_step1400.svg
[rank0]:2025-10-29 05:45:25,516 - INFO - Avg. fwd time: 15.1352 / Avg. bwd time: 9.1008 / Avg. batch time: 537.3760 (ms) / GPU bubble ratio: 63.92%
[rank3]:2025-10-29 05:45:25,515 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0545_real_step1400_rank3.svg
[rank3]:> Batch Time: 370.61 ms, GPU Bubble Ratio: 67.01%, 23.90%, 32.67%, 23.32%
[rank3]:2025-10-29 05:45:25,582 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0545_stage3_step1400.svg
[rank3]:2025-10-29 05:45:25,853 - INFO - Avg. fwd time: 16.6673 / Avg. bwd time: 20.4788 / Avg. batch time: 312.7366 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:45:25,901 - INFO - Avg. fwd time: 17.1249 / Avg. bwd time: 19.7399 / Avg. batch time: 503.4737 (ms) / GPU bubble ratio: 41.42%
[rank2]:2025-10-29 05:45:25,873 - INFO - Avg. fwd time: 15.0698 / Avg. bwd time: 17.6224 / Avg. batch time: 456.6215 (ms) / GPU bubble ratio: 42.72%
[rank0]:2025-10-29 05:47:06,157 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank2]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,993  tflops: 372.78  mfu: 37.69%
[rank1]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,990  tflops: 372.67  mfu: 37.68%
[rank0]:2025-10-29 05:47:07,902 - INFO - Avg. fwd time: 15.1612 / Avg. bwd time: 8.7709 / Avg. batch time: 535.6342 (ms) / GPU bubble ratio: 64.26%
[rank3]:2025-10-29 05:47:12,820 - INFO -  step: 1450  loss:  2.5059  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,622  tflops: 355.47  mfu: 35.94%
[rank3]:2025-10-29 05:47:13,088 - INFO - Avg. fwd time: 16.6921 / Avg. bwd time: 20.4385 / Avg. batch time: 312.6041 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:47:13,134 - INFO - Avg. fwd time: 17.1476 / Avg. bwd time: 19.6897 / Avg. batch time: 502.3719 (ms) / GPU bubble ratio: 41.34%
[rank2]:2025-10-29 05:47:13,109 - INFO - Avg. fwd time: 15.0880 / Avg. bwd time: 17.5763 / Avg. batch time: 455.8925 (ms) / GPU bubble ratio: 42.68%
[rank0]:2025-10-29 05:48:53,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:48:54,862 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank1]:2025-10-29 05:48:54,863 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank0]:2025-10-29 05:48:54,862 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank3]:2025-10-29 05:48:59,897 - INFO -  step: 1500  loss:  2.5814  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,651  tflops: 356.83  mfu: 36.08%
[rank1]:2025-10-29 05:48:59,979 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0548_stage1_step1500.svg
[rank2]:2025-10-29 05:48:59,979 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0548_stage2_step1500.svg
[rank0]:2025-10-29 05:48:59,982 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0548_stage0_step1500.svg
[rank3]:2025-10-29 05:49:00,082 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0548_real_step1500_rank3.svg
[rank3]:> Batch Time: 371.64 ms, GPU Bubble Ratio: 67.00%, 23.94%, 32.71%, 23.30%
[rank3]:2025-10-29 05:49:00,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0548_stage3_step1500.svg
[rank3]:2025-10-29 05:49:00,484 - INFO - Avg. fwd time: 16.7133 / Avg. bwd time: 20.3986 / Avg. batch time: 312.4462 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:49:00,539 - INFO - Avg. fwd time: 17.1660 / Avg. bwd time: 19.6418 / Avg. batch time: 502.1413 (ms) / GPU bubble ratio: 41.36%
[rank2]:2025-10-29 05:49:00,511 - INFO - Avg. fwd time: 15.1047 / Avg. bwd time: 17.5331 / Avg. batch time: 456.0111 (ms) / GPU bubble ratio: 42.74%
[rank0]:2025-10-29 05:49:00,549 - INFO - Avg. fwd time: 15.1845 / Avg. bwd time: 8.4641 / Avg. batch time: 534.8094 (ms) / GPU bubble ratio: 64.62%
[rank0]:2025-10-29 05:50:40,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:50:42,460 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank1]:2025-10-29 05:50:42,461 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank0]:2025-10-29 05:50:42,460 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank0]:2025-10-29 05:50:42,561 - INFO - Avg. fwd time: 15.2033 / Avg. bwd time: 8.2177 / Avg. batch time: 533.9404 (ms) / GPU bubble ratio: 64.91%
[rank3]:2025-10-29 05:50:47,455 - INFO -  step: 1550  loss:  2.5133  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,617  tflops: 355.24  mfu: 35.92%
[rank3]:2025-10-29 05:50:47,725 - INFO - Avg. fwd time: 16.7315 / Avg. bwd time: 20.3675 / Avg. batch time: 312.3369 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:50:47,747 - INFO - Avg. fwd time: 15.1182 / Avg. bwd time: 17.4987 / Avg. batch time: 455.9017 (ms) / GPU bubble ratio: 42.77%
[rank1]:2025-10-29 05:50:47,772 - INFO - Avg. fwd time: 17.1817 / Avg. bwd time: 19.6034 / Avg. batch time: 501.7508 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 05:52:26,892 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:52:29,184 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank3_trend_line.svg
[rank2]:2025-10-29 05:52:29,198 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank2_trend_line.svg
[rank2]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.57/0.57, [MB1] 0.57/0.57, [MB2] 0.57/0.57, [MB3] 0.57/0.57, [MB4] 0.59/0.59, [MB5] 0.73/0.73, [MB6] 0.86/0.86, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:52:29,237 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,672  tflops: 357.83  mfu: 36.18%
[rank1]:2025-10-29 05:52:29,227 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank1_trend_line.svg
[rank1]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.92/0.92, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 0.94/0.94, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:52:29,239 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,672  tflops: 357.82  mfu: 36.18%
[rank2]:2025-10-29 05:52:29,237 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:52:29,239 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:52:29,225 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank0_trend_line.svg
[rank0]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:52:29,237 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,672  tflops: 357.83  mfu: 36.18%
[rank0]:2025-10-29 05:52:29,237 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 05:52:29,422 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0552_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 354.26 ms, GPU Bubble Ratio: 53.25%, 24.25%, 29.56%, 23.76%
[rank3]:2025-10-29 05:52:29,423 - INFO - 	> Batch Time: 354.26 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 05:52:29,423 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:52:34,416 - INFO -  step: 1600  loss:  3.7244  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,659  tflops: 357.22  mfu: 36.12%
[rank3]:2025-10-29 05:52:34,416 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:52:50,715 - INFO - validate step: 1600  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,072
[rank1]:2025-10-29 05:52:50,751 - INFO - validate step: 1600  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,041
[rank2]:2025-10-29 05:52:50,785 - INFO - validate step: 1600  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,010
[rank3]:2025-10-29 05:52:50,808 - INFO - validate step: 1600  loss:  0.9213  memory: 84.49GiB(60.43%)  tps: 24,990
[rank0]:2025-10-29 05:52:50,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0552_stage0_step1600.svg
[rank1]:2025-10-29 05:52:50,894 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0552_stage1_step1600.svg
[rank2]:2025-10-29 05:52:50,897 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0552_stage2_step1600.svg
[rank0]:2025-10-29 05:52:50,981 - INFO - Avg. fwd time: 15.2201 / Avg. bwd time: 7.9478 / Avg. batch time: 533.1168 (ms) / GPU bubble ratio: 65.23%
[rank3]:2025-10-29 05:52:51,000 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0552_real_step1600_rank3.svg
[rank3]:> Batch Time: 372.58 ms, GPU Bubble Ratio: 67.00%, 23.98%, 32.78%, 23.27%
[rank3]:2025-10-29 05:52:51,072 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0552_stage3_step1600.svg
[rank3]:2025-10-29 05:52:51,325 - INFO - Avg. fwd time: 16.7464 / Avg. bwd time: 20.3284 / Avg. batch time: 312.1352 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:52:51,371 - INFO - Avg. fwd time: 17.1942 / Avg. bwd time: 19.5583 / Avg. batch time: 501.4534 (ms) / GPU bubble ratio: 41.37%
[rank2]:2025-10-29 05:52:51,346 - INFO - Avg. fwd time: 15.1297 / Avg. bwd time: 17.4581 / Avg. batch time: 455.9163 (ms) / GPU bubble ratio: 42.82%
[rank0]:2025-10-29 05:54:27,038 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,375  tflops: 390.61  mfu: 39.50%
[rank2]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,378  tflops: 390.75  mfu: 39.51%
[rank0]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,372  tflops: 390.47  mfu: 39.48%
[rank3]:2025-10-29 05:54:33,547 - INFO -  step: 1650  loss:  3.8737  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,974  tflops: 371.90  mfu: 37.60%
[rank3]:2025-10-29 05:54:33,857 - INFO - Avg. fwd time: 16.7380 / Avg. bwd time: 20.2710 / Avg. batch time: 311.5971 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:54:33,884 - INFO - Avg. fwd time: 15.1245 / Avg. bwd time: 17.4079 / Avg. batch time: 455.7141 (ms) / GPU bubble ratio: 42.89%
[rank1]:2025-10-29 05:54:33,912 - INFO - Avg. fwd time: 17.1876 / Avg. bwd time: 19.5046 / Avg. batch time: 500.9432 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:54:33,923 - INFO - Avg. fwd time: 15.2192 / Avg. bwd time: 7.6951 / Avg. batch time: 532.1025 (ms) / GPU bubble ratio: 65.55%
[rank0]:2025-10-29 05:56:08,879 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:56:10,389 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,045  tflops: 375.23  mfu: 37.94%
[rank1]:2025-10-29 05:56:10,390 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,045  tflops: 375.23  mfu: 37.94%
[rank2]:2025-10-29 05:56:10,389 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,045  tflops: 375.24  mfu: 37.94%
[rank3]:2025-10-29 05:56:15,419 - INFO -  step: 1700  loss:  3.8973  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,042  tflops: 375.07  mfu: 37.92%
[rank0]:2025-10-29 05:56:15,508 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0556_stage0_step1700.svg
[rank1]:2025-10-29 05:56:15,506 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0556_stage1_step1700.svg
[rank2]:2025-10-29 05:56:15,506 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0556_stage2_step1700.svg
[rank0]:2025-10-29 05:56:15,599 - INFO - Avg. fwd time: 15.2179 / Avg. bwd time: 7.4909 / Avg. batch time: 530.9660 (ms) / GPU bubble ratio: 65.78%
[rank3]:2025-10-29 05:56:15,613 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0556_real_step1700_rank3.svg
[rank3]:> Batch Time: 371.75 ms, GPU Bubble Ratio: 66.99%, 23.94%, 32.72%, 23.29%
[rank3]:2025-10-29 05:56:15,683 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0556_stage3_step1700.svg
[rank3]:2025-10-29 05:56:15,925 - INFO - Avg. fwd time: 16.7300 / Avg. bwd time: 20.2227 / Avg. batch time: 311.1365 (ms) / GPU bubble ratio: 4.99%
[rank2]:2025-10-29 05:56:15,945 - INFO - Avg. fwd time: 15.1200 / Avg. bwd time: 17.3671 / Avg. batch time: 455.2356 (ms) / GPU bubble ratio: 42.91%
[rank1]:2025-10-29 05:56:15,970 - INFO - Avg. fwd time: 17.1816 / Avg. bwd time: 19.4607 / Avg. batch time: 500.2148 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:57:50,617 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank2]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank0]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank0]:2025-10-29 05:57:52,224 - INFO - Avg. fwd time: 15.2166 / Avg. bwd time: 7.2660 / Avg. batch time: 529.2171 (ms) / GPU bubble ratio: 66.01%
[rank3]:2025-10-29 05:57:57,143 - INFO -  step: 1750  loss:  3.8560  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,053  tflops: 375.61  mfu: 37.98%
[rank3]:2025-10-29 05:57:57,389 - INFO - Avg. fwd time: 16.7216 / Avg. bwd time: 20.1693 / Avg. batch time: 310.6312 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 05:57:57,433 - INFO - Avg. fwd time: 17.1755 / Avg. bwd time: 19.4125 / Avg. batch time: 498.9156 (ms) / GPU bubble ratio: 41.33%
[rank2]:2025-10-29 05:57:57,409 - INFO - Avg. fwd time: 15.1152 / Avg. bwd time: 17.3223 / Avg. batch time: 454.2099 (ms) / GPU bubble ratio: 42.87%
[rank0]:2025-10-29 05:59:32,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:59:33,698 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank1]:2025-10-29 05:59:33,698 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:59:33,697 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank2]:2025-10-29 05:59:33,697 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:59:33,697 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank0]:2025-10-29 05:59:33,697 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 05:59:38,729 - INFO -  step: 1800  loss:  3.8822  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,064  tflops: 376.12  mfu: 38.03%
[rank3]:2025-10-29 05:59:38,729 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:59:55,057 - INFO - validate step: 1800  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,177
[rank2]:2025-10-29 05:59:55,125 - INFO - validate step: 1800  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,116
[rank1]:2025-10-29 05:59:55,093 - INFO - validate step: 1800  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,145
[rank3]:2025-10-29 05:59:55,149 - INFO - validate step: 1800  loss:  0.9155  memory: 84.49GiB(60.43%)  tps: 24,948
[rank2]:2025-10-29 05:59:55,233 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0559_stage2_step1800.svg
[rank1]:2025-10-29 05:59:55,233 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0559_stage1_step1800.svg
[rank0]:2025-10-29 05:59:55,234 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0559_stage0_step1800.svg
[rank3]:2025-10-29 05:59:55,346 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0559_real_step1800_rank3.svg
[rank3]:> Batch Time: 371.03 ms, GPU Bubble Ratio: 66.98%, 23.90%, 32.67%, 23.32%
[rank3]:2025-10-29 05:59:55,415 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0559_stage3_step1800.svg
[rank3]:2025-10-29 05:59:55,726 - INFO - Avg. fwd time: 16.7132 / Avg. bwd time: 20.1184 / Avg. batch time: 310.1463 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 05:59:55,755 - INFO - Avg. fwd time: 15.1108 / Avg. bwd time: 17.2800 / Avg. batch time: 453.9372 (ms) / GPU bubble ratio: 42.92%
[rank0]:2025-10-29 05:59:55,793 - INFO - Avg. fwd time: 15.2153 / Avg. bwd time: 7.0542 / Avg. batch time: 528.2627 (ms) / GPU bubble ratio: 66.28%
[rank1]:2025-10-29 05:59:55,782 - INFO - Avg. fwd time: 17.1692 / Avg. bwd time: 19.3664 / Avg. batch time: 498.3837 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:01:31,102 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:01:32,630 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank1]:2025-10-29 06:01:32,631 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,399  tflops: 391.72  mfu: 39.61%
[rank0]:2025-10-29 06:01:32,630 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,396  tflops: 391.58  mfu: 39.59%
[rank0]:2025-10-29 06:01:32,721 - INFO - Avg. fwd time: 15.2144 / Avg. bwd time: 6.8823 / Avg. batch time: 527.3666 (ms) / GPU bubble ratio: 66.48%
[rank3]:2025-10-29 06:01:37,658 - INFO -  step: 1850  loss:  3.8895  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank3]:2025-10-29 06:01:37,909 - INFO - Avg. fwd time: 16.7074 / Avg. bwd time: 20.0792 / Avg. batch time: 309.7777 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 06:01:37,928 - INFO - Avg. fwd time: 15.1074 / Avg. bwd time: 17.2460 / Avg. batch time: 453.5944 (ms) / GPU bubble ratio: 42.94%
[rank1]:2025-10-29 06:01:37,954 - INFO - Avg. fwd time: 17.1653 / Avg. bwd time: 19.3304 / Avg. batch time: 497.8316 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:03:12,729 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:03:14,274 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank1]:2025-10-29 06:03:14,274 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank0]:2025-10-29 06:03:14,273 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank3]:2025-10-29 06:03:19,240 - INFO -  step: 1900  loss:  3.8145  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,065  tflops: 376.14  mfu: 38.03%
[rank2]:2025-10-29 06:03:19,326 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0603_stage2_step1900.svg
[rank1]:2025-10-29 06:03:19,325 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0603_stage1_step1900.svg
[rank0]:2025-10-29 06:03:19,326 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0603_stage0_step1900.svg
[rank0]:2025-10-29 06:03:19,416 - INFO - Avg. fwd time: 15.2132 / Avg. bwd time: 6.6920 / Avg. batch time: 526.4987 (ms) / GPU bubble ratio: 66.72%
[rank3]:2025-10-29 06:03:19,435 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0603_real_step1900_rank3.svg
[rank3]:> Batch Time: 370.41 ms, GPU Bubble Ratio: 66.97%, 23.87%, 32.64%, 23.32%
[rank3]:2025-10-29 06:03:19,505 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0603_stage3_step1900.svg
[rank3]:2025-10-29 06:03:19,753 - INFO - Avg. fwd time: 16.7008 / Avg. bwd time: 20.0357 / Avg. batch time: 309.3678 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 06:03:19,773 - INFO - Avg. fwd time: 15.1033 / Avg. bwd time: 17.2080 / Avg. batch time: 453.3435 (ms) / GPU bubble ratio: 42.98%
[rank1]:2025-10-29 06:03:19,797 - INFO - Avg. fwd time: 17.1596 / Avg. bwd time: 19.2888 / Avg. batch time: 497.3442 (ms) / GPU bubble ratio: 41.37%
[rank0]:2025-10-29 06:04:54,523 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:04:56,078 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank1]:2025-10-29 06:04:56,079 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank0]:2025-10-29 06:04:56,079 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.30  mfu: 37.95%
[rank3]:2025-10-29 06:05:01,172 - INFO -  step: 1950  loss:  3.7709  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,037  tflops: 374.85  mfu: 37.90%
[rank3]:2025-10-29 06:05:01,499 - INFO - Avg. fwd time: 16.6951 / Avg. bwd time: 19.9951 / Avg. batch time: 308.9894 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:05:01,526 - INFO - Avg. fwd time: 15.1001 / Avg. bwd time: 17.1730 / Avg. batch time: 453.1392 (ms) / GPU bubble ratio: 43.02%
[rank1]:2025-10-29 06:05:01,555 - INFO - Avg. fwd time: 17.1543 / Avg. bwd time: 19.2494 / Avg. batch time: 496.9171 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 06:05:01,567 - INFO - Avg. fwd time: 15.2125 / Avg. bwd time: 6.5119 / Avg. batch time: 525.7132 (ms) / GPU bubble ratio: 66.94%
[rank0]:2025-10-29 06:06:36,291 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank1]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank2]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank0]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 06:06:42,892 - INFO -  step: 2000  loss:  3.7715  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,054  tflops: 375.64  mfu: 37.98%
[rank3]:2025-10-29 06:06:42,892 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 06:06:59,213 - INFO - validate step: 2000  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,179
[rank0]:2025-10-29 06:06:59,177 - INFO - validate step: 2000  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,211
[rank3]:2025-10-29 06:06:59,271 - INFO - validate step: 2000  loss:  0.9219  memory: 84.49GiB(60.43%)  tps: 25,009
[rank2]:2025-10-29 06:06:59,249 - INFO - validate step: 2000  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,146
[rank1]:2025-10-29 06:06:59,359 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0606_stage1_step2000.svg
[rank2]:2025-10-29 06:06:59,360 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0606_stage2_step2000.svg
[rank0]:2025-10-29 06:06:59,363 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0606_stage0_step2000.svg
[rank0]:2025-10-29 06:06:59,452 - INFO - Avg. fwd time: 15.2113 / Avg. bwd time: 6.3651 / Avg. batch time: 524.8601 (ms) / GPU bubble ratio: 67.11%
[rank3]:2025-10-29 06:06:59,460 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0606_real_step2000_rank3.svg
[rank3]:> Batch Time: 369.93 ms, GPU Bubble Ratio: 66.96%, 23.86%, 32.60%, 23.31%
[rank3]:2025-10-29 06:06:59,531 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0606_stage3_step2000.svg
[rank3]:2025-10-29 06:06:59,786 - INFO - Avg. fwd time: 16.6897 / Avg. bwd time: 19.9605 / Avg. batch time: 308.6632 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:06:59,806 - INFO - Avg. fwd time: 15.0966 / Avg. bwd time: 17.1432 / Avg. batch time: 452.7635 (ms) / GPU bubble ratio: 43.03%
[rank1]:2025-10-29 06:06:59,831 - INFO - Avg. fwd time: 17.1492 / Avg. bwd time: 19.2164 / Avg. batch time: 496.3573 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 06:08:34,871 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 06:08:36,417 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,424  tflops: 392.92  mfu: 39.73%
[rank2]:2025-10-29 06:08:36,418 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,431  tflops: 393.21  mfu: 39.76%
[rank1]:2025-10-29 06:08:36,418 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,428  tflops: 393.06  mfu: 39.74%
[rank0]:2025-10-29 06:08:36,508 - INFO - Avg. fwd time: 15.2107 / Avg. bwd time: 6.2020 / Avg. batch time: 523.5695 (ms) / GPU bubble ratio: 67.28%
[rank3]:2025-10-29 06:08:41,431 - INFO -  step: 2050  loss:  3.8018  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank3]:2025-10-29 06:08:41,679 - INFO - Avg. fwd time: 16.6849 / Avg. bwd time: 19.9245 / Avg. batch time: 308.3285 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:08:41,698 - INFO - Avg. fwd time: 15.0936 / Avg. bwd time: 17.1111 / Avg. batch time: 451.9993 (ms) / GPU bubble ratio: 43.00%
[rank1]:2025-10-29 06:08:41,721 - INFO - Avg. fwd time: 17.1450 / Avg. bwd time: 19.1815 / Avg. batch time: 495.3927 (ms) / GPU bubble ratio: 41.34%
[rank0]:2025-10-29 06:10:16,430 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:10:17,948 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank1]:2025-10-29 06:10:17,949 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank0]:2025-10-29 06:10:17,948 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank3]:2025-10-29 06:10:22,985 - INFO -  step: 2100  loss:  3.8586  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,067  tflops: 376.24  mfu: 38.04%
[rank1]:2025-10-29 06:10:23,066 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0610_stage1_step2100.svg
[rank2]:2025-10-29 06:10:23,068 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0610_stage2_step2100.svg
[rank0]:2025-10-29 06:10:23,070 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0610_stage0_step2100.svg
[rank3]:2025-10-29 06:10:23,177 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0610_real_step2100_rank3.svg
[rank3]:> Batch Time: 369.53 ms, GPU Bubble Ratio: 66.95%, 23.84%, 32.59%, 23.31%
[rank3]:2025-10-29 06:10:23,240 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0610_stage3_step2100.svg
[rank3]:2025-10-29 06:10:23,548 - INFO - Avg. fwd time: 16.6797 / Avg. bwd time: 19.8893 / Avg. batch time: 307.9980 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:10:23,575 - INFO - Avg. fwd time: 15.0903 / Avg. bwd time: 17.0803 / Avg. batch time: 451.8297 (ms) / GPU bubble ratio: 43.04%
[rank0]:2025-10-29 06:10:23,614 - INFO - Avg. fwd time: 15.2099 / Avg. bwd time: 6.0471 / Avg. batch time: 522.8988 (ms) / GPU bubble ratio: 67.48%
[rank1]:2025-10-29 06:10:23,603 - INFO - Avg. fwd time: 17.1402 / Avg. bwd time: 19.1475 / Avg. batch time: 495.0309 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 06:11:58,325 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:11:59,854 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank1]:2025-10-29 06:11:59,855 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank0]:2025-10-29 06:11:59,854 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank0]:2025-10-29 06:11:59,948 - INFO - Avg. fwd time: 15.2091 / Avg. bwd time: 5.9203 / Avg. batch time: 522.1794 (ms) / GPU bubble ratio: 67.63%
[rank3]:2025-10-29 06:12:05,119 - INFO -  step: 2150  loss:  3.7977  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,021  tflops: 374.10  mfu: 37.83%
[rank3]:2025-10-29 06:12:05,370 - INFO - Avg. fwd time: 16.6759 / Avg. bwd time: 19.8609 / Avg. batch time: 307.7349 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:12:05,389 - INFO - Avg. fwd time: 15.0881 / Avg. bwd time: 17.0557 / Avg. batch time: 451.5228 (ms) / GPU bubble ratio: 43.05%
[rank1]:2025-10-29 06:12:05,414 - INFO - Avg. fwd time: 17.1363 / Avg. bwd time: 19.1194 / Avg. batch time: 494.5650 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:13:39,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:13:41,305 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,075  tflops: 376.61  mfu: 38.08%
[rank0]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 06:13:41,304 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,075  tflops: 376.61  mfu: 38.08%
[rank2]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:13:41,305 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,075  tflops: 376.62  mfu: 38.08%
[rank1]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 06:13:46,243 - INFO -  step: 2200  loss:  3.8610  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,101  tflops: 377.84  mfu: 38.20%
[rank3]:2025-10-29 06:13:46,243 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 06:14:02,600 - INFO - validate step: 2200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,235
[rank2]:2025-10-29 06:14:02,663 - INFO - validate step: 2200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,177
[rank1]:2025-10-29 06:14:02,636 - INFO - validate step: 2200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,202
[rank3]:2025-10-29 06:14:02,687 - INFO - validate step: 2200  loss:  0.9161  memory: 84.49GiB(60.43%)  tps: 24,910
[rank2]:2025-10-29 06:14:02,772 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0614_stage2_step2200.svg
[rank1]:2025-10-29 06:14:02,767 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0614_stage1_step2200.svg
[rank0]:2025-10-29 06:14:02,771 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0614_stage0_step2200.svg
[rank0]:2025-10-29 06:14:02,864 - INFO - Avg. fwd time: 15.2081 / Avg. bwd time: 5.7790 / Avg. batch time: 521.5312 (ms) / GPU bubble ratio: 67.81%
[rank3]:2025-10-29 06:14:02,877 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0614_real_step2200_rank3.svg
[rank3]:> Batch Time: 369.12 ms, GPU Bubble Ratio: 66.95%, 23.84%, 32.57%, 23.30%
[rank3]:2025-10-29 06:14:02,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0614_stage3_step2200.svg
[rank3]:2025-10-29 06:14:03,189 - INFO - Avg. fwd time: 16.6707 / Avg. bwd time: 19.8275 / Avg. batch time: 307.4185 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:14:03,209 - INFO - Avg. fwd time: 15.0851 / Avg. bwd time: 17.0273 / Avg. batch time: 451.3330 (ms) / GPU bubble ratio: 43.08%
[rank1]:2025-10-29 06:14:03,234 - INFO - Avg. fwd time: 17.1317 / Avg. bwd time: 19.0878 / Avg. batch time: 494.1992 (ms) / GPU bubble ratio: 41.37%
[rank0]:2025-10-29 06:15:38,045 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 06:15:39,585 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,447  tflops: 393.95  mfu: 39.83%
[rank1]:2025-10-29 06:15:39,586 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,450  tflops: 394.10  mfu: 39.85%
[rank2]:2025-10-29 06:15:39,585 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,452  tflops: 394.21  mfu: 39.86%
[rank3]:2025-10-29 06:15:44,574 - INFO -  step: 2250  loss:  3.8077  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,040  tflops: 375.01  mfu: 37.92%
[rank3]:2025-10-29 06:15:44,889 - INFO - Avg. fwd time: 16.6663 / Avg. bwd time: 19.7971 / Avg. batch time: 307.1345 (ms) / GPU bubble ratio: 5.02%
[rank1]:2025-10-29 06:15:44,951 - INFO - Avg. fwd time: 17.1279 / Avg. bwd time: 19.0588 / Avg. batch time: 493.8859 (ms) / GPU bubble ratio: 41.38%
[rank2]:2025-10-29 06:15:44,919 - INFO - Avg. fwd time: 15.0820 / Avg. bwd time: 17.0001 / Avg. batch time: 451.1848 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 06:15:44,966 - INFO - Avg. fwd time: 15.2075 / Avg. bwd time: 5.6442 / Avg. batch time: 520.9497 (ms) / GPU bubble ratio: 67.98%
[rank0]:2025-10-29 06:17:19,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank2]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank0]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank3]:2025-10-29 06:17:25,945 - INFO -  step: 2300  loss:  3.8312  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,081  tflops: 376.92  mfu: 38.11%
[rank1]:2025-10-29 06:17:26,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0617_stage1_step2300.svg
[rank2]:2025-10-29 06:17:26,026 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0617_stage2_step2300.svg
[rank0]:2025-10-29 06:17:26,029 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0617_stage0_step2300.svg
[rank3]:2025-10-29 06:17:26,134 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0617_real_step2300_rank3.svg
[rank3]:> Batch Time: 368.88 ms, GPU Bubble Ratio: 66.94%, 23.84%, 32.57%, 23.30%
[rank0]:2025-10-29 06:17:26,122 - INFO - Avg. fwd time: 15.2070 / Avg. bwd time: 5.5336 / Avg. batch time: 520.2799 (ms) / GPU bubble ratio: 68.11%
[rank3]:2025-10-29 06:17:26,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0617_stage3_step2300.svg
[rank3]:2025-10-29 06:17:26,447 - INFO - Avg. fwd time: 16.6627 / Avg. bwd time: 19.7720 / Avg. batch time: 306.8994 (ms) / GPU bubble ratio: 5.03%
[rank1]:2025-10-29 06:17:26,492 - INFO - Avg. fwd time: 17.1246 / Avg. bwd time: 19.0345 / Avg. batch time: 493.4363 (ms) / GPU bubble ratio: 41.38%
[rank2]:2025-10-29 06:17:26,466 - INFO - Avg. fwd time: 15.0798 / Avg. bwd time: 16.9782 / Avg. batch time: 450.8731 (ms) / GPU bubble ratio: 43.12%
[rank0]:2025-10-29 06:19:01,075 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,063  tflops: 376.04  mfu: 38.02%
[rank1]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,063  tflops: 376.05  mfu: 38.02%
[rank0]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,063  tflops: 376.05  mfu: 38.02%
[rank0]:2025-10-29 06:19:02,725 - INFO - Avg. fwd time: 15.2063 / Avg. bwd time: 5.4100 / Avg. batch time: 519.1964 (ms) / GPU bubble ratio: 68.23%
[rank3]:2025-10-29 06:19:07,570 - INFO -  step: 2350  loss:  3.7582  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,061  tflops: 375.97  mfu: 38.02%
[rank3]:2025-10-29 06:19:07,824 - INFO - Avg. fwd time: 16.6584 / Avg. bwd time: 19.7439 / Avg. batch time: 306.6349 (ms) / GPU bubble ratio: 5.03%
[rank2]:2025-10-29 06:19:07,846 - INFO - Avg. fwd time: 15.0773 / Avg. bwd time: 16.9538 / Avg. batch time: 450.1907 (ms) / GPU bubble ratio: 43.08%
[rank1]:2025-10-29 06:19:07,869 - INFO - Avg. fwd time: 17.1205 / Avg. bwd time: 19.0070 / Avg. batch time: 492.5991 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 06:20:42,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:20:44,114 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank1]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,739  tflops: 360.92  mfu: 35.60%
[rank2]:2025-10-29 06:20:44,113 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank2]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,739  tflops: 360.94  mfu: 35.60%
[rank1]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:20:44,113 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank0]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,738  tflops: 360.91  mfu: 35.60%
[rank0]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 06:20:49,048 - INFO -  step: 2400  loss:  3.7459  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,073  tflops: 376.52  mfu: 38.07%
[rank3]:2025-10-29 06:20:49,049 - INFO -  final step: 2400  loss:  3.7459  grad_norm:  0.0000  tps: 7,653  tflops: 356.92  mfu: 35.19%
[rank3]:2025-10-29 06:20:49,049 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:21:05,364 - INFO - validate step: 2400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,276
[rank0]:2025-10-29 06:21:05,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:21:05,369 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 06:21:05,399 - INFO - validate step: 2400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,244
[rank1]:2025-10-29 06:21:05,400 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:21:05,405 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 06:21:05,439 - INFO - validate step: 2400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,208
[rank2]:2025-10-29 06:21:05,439 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:21:05,444 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 06:21:05,462 - INFO - validate step: 2400  loss:  0.9204  memory: 84.49GiB(60.43%)  tps: 24,956
[rank3]:2025-10-29 06:21:05,463 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:21:05,465 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 06:21:15,828 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 06:21:15,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0621_stage2_final2400.svg
[rank0]:2025-10-29 06:21:15,958 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0621_stage0_final2400.svg
[rank3]:2025-10-29 06:21:16,034 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0621_real_final2400_rank3.svg
[rank3]:> Batch Time: 368.58 ms, GPU Bubble Ratio: 66.93%, 23.84%, 32.55%, 23.29%
[rank1]:2025-10-29 06:21:15,985 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0621_stage1_final2400.svg
[rank3]:2025-10-29 06:21:16,204 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0621_thry_final2400_rank3.svg
[rank3]:> Batch Time: 527.42 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 06:21:16,224 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank2_stage2.svg
[rank2]:	> Counts Sum: 1282680, Total Sum: 5368320 (23.89%), Ratio(%) per element: [23.98, 23.92, 24.51, 22.74, 23.01, 23.01, 23.49, 24.24, 23.39, 25.64, 23.71, 24.4, 22.74, 24.62, 25.26, 24.78, 24.08, 22.47, 24.94, 23.6, 22.69, 23.22, 22.15, 23.33, 25.37, 23.33, 23.39, 23.17, 23.39, 23.06, 24.35, 23.71, 23.76, 23.01, 23.65, 24.3, 25.26, 23.98, 23.65, 24.14, 23.76, 25.42, 23.92, 25.0, 21.83, 23.33, 24.62, 22.58, 23.81, 23.6, 23.76, 25.21, 25.59, 24.57, 22.69, 23.55, 24.19, 24.57, 24.08, 23.81, 23.49, 25.8, 23.06, 23.17, 23.01, 24.51, 24.08, 24.78, 24.62, 23.33, 24.08, 24.67]
[rank2]:2025-10-29 06:21:16,224 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:21:16,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0621_stage3_final2400.svg
[rank1]:2025-10-29 06:21:16,352 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank1_stage1.svg
[rank1]:	> Counts Sum: 309360, Total Sum: 6039360 (5.12%), Ratio(%) per element: [5.04, 5.84, 5.68, 4.56, 4.5, 4.88, 5.09, 4.56, 5.25, 4.56, 5.36, 4.56, 6.22, 5.41, 5.57, 5.31, 5.09, 4.56, 4.61, 5.04, 5.68, 5.2, 5.74, 5.95, 5.84, 4.72, 5.57, 5.36, 5.74, 5.36, 4.98, 5.52, 4.82, 5.09, 5.15, 4.23, 4.77, 5.15, 5.2, 4.88, 4.77, 4.23, 5.15, 4.77, 4.77, 4.56, 5.2, 4.29, 4.34, 5.52, 5.2, 4.98, 5.31, 4.88, 5.36, 5.09, 5.2, 5.79, 5.04, 5.36, 5.25, 5.52, 4.82, 5.2, 4.98, 4.77, 4.66, 4.39, 5.09, 5.41, 5.09, 4.82, 6.0, 5.47, 4.88, 6.27, 4.93, 4.82, 5.63, 5.04, 5.04]
[rank1]:2025-10-29 06:21:16,352 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 06:21:16,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank0_stage0.svg
[rank0]:	> Counts Sum: 4609240, Total Sum: 5442880 (84.68%), Ratio(%) per element: [84.6, 84.71, 84.49, 84.44, 84.87, 85.13, 84.65, 84.71, 84.97, 84.17, 84.38, 84.65, 84.81, 84.54, 84.65, 84.65, 84.76, 84.76, 84.87, 84.71, 84.97, 84.81, 84.54, 84.44, 84.76, 84.71, 84.49, 84.71, 84.6, 84.76, 84.38, 84.54, 84.49, 84.65, 84.87, 84.54, 84.92, 84.49, 84.76, 84.81, 84.6, 84.71, 84.65, 84.87, 84.49, 84.38, 85.13, 85.08, 84.38, 84.6, 84.81, 84.65, 84.54, 84.49, 84.38, 84.71, 84.97, 84.71, 84.49, 84.54, 84.97, 84.71, 84.6, 84.76, 84.76, 84.71, 84.38, 84.87, 84.81, 84.97, 84.87, 84.65, 84.54]
[rank0]:2025-10-29 06:21:16,331 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 06:21:16,491 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.39, 1.6, 1.93, 1.5, 1.6, 1.71, 1.55, 1.71, 1.5, 1.5, 1.44, 1.93, 1.6, 1.66, 1.77, 1.77, 1.6, 1.82, 1.55, 1.77, 1.71, 1.93, 1.6, 1.39, 1.18, 1.98, 1.87, 1.5, 1.87, 1.55, 1.28, 1.44, 1.6, 1.6, 1.39, 1.5, 1.93, 1.6, 1.66, 1.39, 1.55, 1.44, 1.55, 1.77, 1.28, 1.87, 1.6, 1.55, 1.44, 1.5, 1.55, 1.82, 1.34, 1.66, 1.93, 1.71, 1.23, 1.39, 1.55, 1.71, 1.71, 1.55, 1.44, 1.66, 0.0]
[rank3]:2025-10-29 06:21:16,492 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‚â–â–â–â–â–â–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–â–â–â–â–â–â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚â–‚
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‚â–â–â–â–â–â–ƒâ–ƒâ–„â–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–â–â–â–â–â–â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.14096
[rank3]:wandb:               final/avg_loss 3.74591
[rank3]:wandb:             final/avg_mfu(%) 35.18764
[rank3]:wandb:             final/avg_tflops 356.9203
[rank3]:wandb:    final/avg_throughput(tps) 7652.63869
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.74591
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.74591
[rank3]:wandb: loss_metrics/global_max_loss 3.74591
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7q6bt8ow
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyapf_dm1/20251029-0450/wandb/run-20251029_045020-7q6bt8ow/logs
[rank0]:2025-10-29 06:21:18,331 - INFO - Training completed
[rank0]:2025-10-29 06:21:18,331 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:21:18,528 - INFO - Process group destroyed
[rank1]:2025-10-29 06:21:18,536 - INFO - Process group destroyed
[rank2]:2025-10-29 06:21:18,555 - INFO - Process group destroyed
[rank0]:2025-10-29 06:21:19,001 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.19', 'layers.24', 'layers.22', 'layers.17', 'layers.18', 'layers.20', 'layers.23'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.14', 'layers.11', 'layers.10', 'layers.8', 'layers.16', 'layers.9', 'layers.12', 'layers.15'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.7', 'tok_embeddings', 'layers.6', 'layers.2', 'layers.4', 'layers.5', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.30', 'layers.27', 'layers.28', 'norm', 'layers.25', 'layers.26', 'layers.31', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 06:21:27 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] 
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] *****************************************
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 06:21:29.047000 1661219 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-29 06:21:35,212 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 06:21:35,220 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 06:21:35,322 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 06:21:35,447 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 06:21:36,082 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 06:21:36,085 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 06:21:36,082 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 06:21:36,093 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 06:21:36,205 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 06:21:36,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:21:36,296 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 06:21:36,298 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:21:36,304 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-29 06:21:38,067 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 06:21:38,341 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 06:21:40,044 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 06:21:41,355 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 06:21:41,517 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:21:41,662 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 06:21:41,603 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 06:21:41,652 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 06:21:41,674 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 06:21:41,674 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:21:41,598 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 06:21:41,598 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:21:41,737 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 06:21:41,737 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:21:41,809 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 06:21:41,810 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-29 06:21:41,964 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 06:21:41,964 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-29 06:21:41,883 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 06:21:41,883 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run l90qbnni
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1/20251029-0621/wandb/run-20251029_062142-l90qbnni
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/l90qbnni
[rank3]:2025-10-29 06:21:43,235 - INFO - WandB logging enabled
[rank3]:2025-10-29 06:21:43,237 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 06:21:43,310 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 06:21:43,311 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 06:21:43,549 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 06:21:43,549 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:43,577 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank0]:2025-10-29 06:21:43,577 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:43,578 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 06:21:43,562 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:21:47,302 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 06:21:47,302 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 06:21:55,669 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 06:21:55,669 - INFO - Finished loading the checkpoint in 8.37 seconds.
[rank0]:2025-10-29 06:21:55,669 - INFO - Training starts at step 1
[rank1]:2025-10-29 06:22:00,224 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 49.69GiB(35.54%)  tps: 885  tflops: 41.28  mfu: 4.17%
[rank1]:2025-10-29 06:22:00,224 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:22:00,226 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.2461  memory: 58.03GiB(41.50%)  tps: 967  tflops: 45.11  mfu: 4.56%
[rank3]:2025-10-29 06:22:00,227 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 06:22:00,242 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 49.75GiB(35.58%)  tps: 881  tflops: 41.10  mfu: 4.16%
[rank0]:2025-10-29 06:22:00,243 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 06:22:00,222 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.2461  memory: 44.28GiB(31.67%)  tps: 878  tflops: 40.96  mfu: 4.14%
[rank2]:2025-10-29 06:22:00,222 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:22:18,529 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,530 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,531 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,532 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,533 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:22:18,534 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,573 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,574 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:22:18,575 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,618 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,619 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,620 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,621 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:22:18,621 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,661 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,662 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:22:18,663 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:24:09,938 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:24:12,666 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 66.72GiB(47.72%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank3]:2025-10-29 06:24:12,664 - INFO -  step: 50  loss:  3.2102  grad_norm: 16.3765  memory: 73.38GiB(52.48%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank1]:2025-10-29 06:24:12,662 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 64.32GiB(46.00%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank2]:2025-10-29 06:24:12,660 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.3765  memory: 57.29GiB(40.97%)  tps: 6,062  tflops: 282.73  mfu: 28.59%
[rank3]:2025-10-29 06:24:13,130 - INFO - Avg. fwd time: 14.8205 / Avg. bwd time: 43.0823 / Avg. batch time: 483.0107 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-10-29 06:24:13,180 - INFO - Avg. fwd time: 13.3687 / Avg. bwd time: 36.3470 / Avg. batch time: 535.8820 (ms) / GPU bubble ratio: 25.78%
[rank0]:2025-10-29 06:24:13,260 - INFO - Avg. fwd time: 13.9947 / Avg. bwd time: 38.1530 / Avg. batch time: 650.9255 (ms) / GPU bubble ratio: 35.91%
[rank1]:2025-10-29 06:24:13,227 - INFO - Avg. fwd time: 15.2075 / Avg. bwd time: 41.0101 / Avg. batch time: 595.6529 (ms) / GPU bubble ratio: 24.50%
[rank3]:2025-10-29 06:24:39,463 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 06:25:06,550 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 06:25:06,765 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 06:25:06,869 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:06,885 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:06,900 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:06,885 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:06,905 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,895 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,929 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,878 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,911 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:06,944 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:06,963 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,006 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,046 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,113 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,054 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,092 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,131 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,043 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,081 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,121 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,083 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,121 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,161 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,151 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,191 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,230 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,171 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,209 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:07,159 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:25:07,199 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:25:07,268 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:25:07,246 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:25:40,137 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 06:25:40,441 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_max_batch_time.svg
[rank3]:> Batch Time: 633.92 ms, GPU Bubble Ratio: 33.81%, 28.09%, 36.76%, 26.21%
[rank3]:2025-10-29 06:25:40,627 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_min_batch_time.svg
[rank3]:> Batch Time: 358.61 ms, GPU Bubble Ratio: 69.05%, 24.37%, 33.78%, 23.42%
[rank3]:2025-10-29 06:25:40,843 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 358.61 ms, GPU Bubble Ratio: 32.20%, 23.40%, 29.14%, 23.42%
[rank3]:2025-10-29 06:25:40,843 - INFO - 	> Batch Time: 358.61 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 06:25:55,738 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:25:57,357 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:25:57,371 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.27/0.80, [MB3] 0.30/0.90, [MB4] 0.30/0.90, [MB5] 0.31/0.94, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:25:57,388 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 7,822  tflops: 364.83  mfu: 36.89%
[rank1]:2025-10-29 06:25:57,391 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.91, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 06:25:57,391 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 7,822  tflops: 364.83  mfu: 36.89%
[rank1]:2025-10-29 06:25:57,467 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0625_stage1_step100.svg
[rank3]:2025-10-29 06:25:57,389 - INFO -  step: 100  loss:  2.4224  grad_norm:  0.0000  memory: 86.23GiB(61.67%)  tps: 7,823  tflops: 364.84  mfu: 36.89%
[rank0]:2025-10-29 06:25:57,390 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.19/0.56, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 06:25:57,391 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 7,822  tflops: 364.84  mfu: 36.89%
[rank0]:2025-10-29 06:25:57,466 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0625_stage0_step100.svg
[rank2]:2025-10-29 06:25:57,468 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0625_stage2_step100.svg
[rank0]:2025-10-29 06:25:57,562 - INFO - Avg. fwd time: 14.4843 / Avg. bwd time: 27.4627 / Avg. batch time: 580.2664 (ms) / GPU bubble ratio: 42.17%
[rank3]:2025-10-29 06:25:57,576 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0625_real_step100_rank3.svg
[rank3]:> Batch Time: 631.54 ms, GPU Bubble Ratio: 33.67%, 28.13%, 36.59%, 26.22%
[rank3]:2025-10-29 06:25:57,637 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0625_stage3_step100.svg
[rank1]:2025-10-29 06:25:57,948 - INFO - Avg. fwd time: 16.0657 / Avg. bwd time: 34.7691 / Avg. batch time: 536.0298 (ms) / GPU bubble ratio: 24.13%
[rank3]:2025-10-29 06:25:57,900 - INFO - Avg. fwd time: 15.5750 / Avg. bwd time: 36.4882 / Avg. batch time: 434.2398 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-29 06:25:57,922 - INFO - Avg. fwd time: 13.9970 / Avg. bwd time: 30.7438 / Avg. batch time: 482.6923 (ms) / GPU bubble ratio: 25.85%
[rank0]:2025-10-29 06:27:45,532 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:27:47,524 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 06:27:47,527 - INFO -  step: 150  loss:  0.9625  grad_norm:  0.1740  memory: 86.40GiB(61.80%)  tps: 7,438  tflops: 346.91  mfu: 35.08%
[rank1]:2025-10-29 06:27:47,528 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.60/0.91, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 06:27:47,529 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 72.68GiB(51.98%)  tps: 7,438  tflops: 346.91  mfu: 35.08%
[rank0]:2025-10-29 06:27:47,529 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.37/0.56, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 06:27:47,530 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 73.11GiB(52.29%)  tps: 7,438  tflops: 346.90  mfu: 35.08%
[rank2]:2025-10-29 06:27:47,530 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.53/0.80, [MB3] 0.60/0.90, [MB4] 0.60/0.90, [MB5] 0.63/0.94, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank2]:2025-10-29 06:27:47,531 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1740  memory: 64.67GiB(46.25%)  tps: 7,438  tflops: 346.89  mfu: 35.08%
[rank3]:2025-10-29 06:27:47,935 - INFO - Avg. fwd time: 15.7845 / Avg. bwd time: 34.1165 / Avg. batch time: 416.1264 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-10-29 06:27:47,972 - INFO - Avg. fwd time: 14.1680 / Avg. bwd time: 28.9046 / Avg. batch time: 463.5968 (ms) / GPU bubble ratio: 25.67%
[rank1]:2025-10-29 06:27:48,002 - INFO - Avg. fwd time: 16.2536 / Avg. bwd time: 32.7068 / Avg. batch time: 516.1791 (ms) / GPU bubble ratio: 24.12%
[rank0]:2025-10-29 06:27:48,028 - INFO - Avg. fwd time: 14.6257 / Avg. bwd time: 26.9409 / Avg. batch time: 560.0947 (ms) / GPU bubble ratio: 40.63%
[rank0]:2025-10-29 06:29:19,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:29:21,524 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:29:21,524 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 73.75GiB(52.75%)  tps: 8,715  tflops: 406.49  mfu: 41.10%
[rank1]:2025-10-29 06:29:21,524 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 06:29:21,522 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:29:21,525 - INFO -  step: 200  loss:  0.9618  grad_norm:  0.0614  memory: 86.40GiB(61.80%)  tps: 8,715  tflops: 406.48  mfu: 41.10%
[rank3]:2025-10-29 06:29:21,525 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 06:29:21,523 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.56/0.56, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:29:21,523 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 75.31GiB(53.87%)  tps: 8,715  tflops: 406.49  mfu: 41.10%
[rank0]:2025-10-29 06:29:21,523 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:29:21,523 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.80/0.80, [MB3] 0.90/0.90, [MB4] 0.90/0.90, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:29:21,523 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.0614  memory: 65.98GiB(47.19%)  tps: 8,716  tflops: 406.50  mfu: 41.10%
[rank2]:2025-10-29 06:29:21,523 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 06:29:40,753 - INFO - validate step: 200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 21,301
[rank0]:2025-10-29 06:29:40,717 - INFO - validate step: 200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 21,341
[rank2]:2025-10-29 06:29:40,784 - INFO - validate step: 200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 21,266
[rank3]:2025-10-29 06:29:40,808 - INFO - validate step: 200  loss:  0.2552  memory: 86.40GiB(61.80%)  tps: 21,243
[rank2]:2025-10-29 06:29:40,881 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0629_stage2_step200.svg
[rank1]:2025-10-29 06:29:40,881 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0629_stage1_step200.svg
[rank0]:2025-10-29 06:29:40,880 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0629_stage0_step200.svg
[rank3]:2025-10-29 06:29:40,987 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0629_real_step200_rank3.svg
[rank3]:> Batch Time: 502.60 ms, GPU Bubble Ratio: 32.14%, 26.99%, 37.05%, 26.93%
[rank3]:2025-10-29 06:29:41,052 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0629_stage3_step200.svg
[rank3]:2025-10-29 06:29:41,323 - INFO - Avg. fwd time: 16.0497 / Avg. bwd time: 31.5070 / Avg. batch time: 396.9837 (ms) / GPU bubble ratio: 4.16%
[rank0]:2025-10-29 06:29:41,330 - INFO - Avg. fwd time: 14.8247 / Avg. bwd time: 24.8421 / Avg. batch time: 535.4069 (ms) / GPU bubble ratio: 40.73%
[rank2]:2025-10-29 06:29:41,346 - INFO - Avg. fwd time: 14.3800 / Avg. bwd time: 26.8829 / Avg. batch time: 441.9945 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-10-29 06:29:41,374 - INFO - Avg. fwd time: 16.5013 / Avg. bwd time: 30.4699 / Avg. batch time: 493.6064 (ms) / GPU bubble ratio: 23.87%
[rank0]:2025-10-29 06:31:02,130 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:31:03,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.80/0.80, [MB3] 0.90/0.90, [MB4] 0.90/0.90, [MB5] 0.94/0.94, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:31:03,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,870  tflops: 460.36  mfu: 46.55%
[rank3]:2025-10-29 06:31:03,748 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:31:03,781 - INFO -  step: 250  loss:  0.9555  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,873  tflops: 460.49  mfu: 46.56%
[rank1]:2025-10-29 06:31:03,782 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.91/0.91, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:31:03,783 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,866  tflops: 460.17  mfu: 46.53%
[rank0]:2025-10-29 06:31:03,782 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.56/0.56, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:31:03,783 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,862  tflops: 459.97  mfu: 46.51%
[rank0]:2025-10-29 06:31:03,877 - INFO - Avg. fwd time: 15.0394 / Avg. bwd time: 19.7803 / Avg. batch time: 506.3545 (ms) / GPU bubble ratio: 44.99%
[rank3]:2025-10-29 06:31:04,095 - INFO - Avg. fwd time: 16.3369 / Avg. bwd time: 28.9682 / Avg. batch time: 378.7055 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-10-29 06:31:04,117 - INFO - Avg. fwd time: 14.6224 / Avg. bwd time: 24.6746 / Avg. batch time: 421.1978 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-10-29 06:31:04,143 - INFO - Avg. fwd time: 16.8020 / Avg. bwd time: 27.9797 / Avg. batch time: 469.7729 (ms) / GPU bubble ratio: 23.74%
[rank0]:2025-10-29 06:32:24,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:32:26,679 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank3_trend_line.svg
[rank2]:2025-10-29 06:32:26,693 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank2_trend_line.svg
[rank2]:2025-10-29 06:32:26,716 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:32:26,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.76/0.76, [MB1] 0.76/0.76, [MB2] 0.76/0.76, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,877  tflops: 460.67  mfu: 46.58%
[rank1]:2025-10-29 06:32:26,711 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank1_trend_line.svg
[rank1]:2025-10-29 06:32:26,716 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:32:26,719 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,877  tflops: 460.69  mfu: 46.58%
[rank0]:2025-10-29 06:32:26,709 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0632_rank0_trend_line.svg
[rank0]:2025-10-29 06:32:26,717 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:32:26,718 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:32:26,719 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,878  tflops: 460.69  mfu: 46.58%
[rank3]:2025-10-29 06:32:26,911 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0632_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 359.77 ms, GPU Bubble Ratio: 38.09%, 24.83%, 31.12%, 24.41%
[rank3]:2025-10-29 06:32:26,912 - INFO - 	> Batch Time: 359.77 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 06:32:26,912 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:32:26,915 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:32:26,918 - INFO -  step: 300  loss:  0.8838  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,854  tflops: 459.58  mfu: 46.47%
[rank1]:2025-10-29 06:32:26,984 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0632_stage1_step300.svg
[rank0]:2025-10-29 06:32:26,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0632_stage0_step300.svg
[rank2]:2025-10-29 06:32:26,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0632_stage2_step300.svg
[rank3]:2025-10-29 06:32:27,094 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0632_real_step300_rank3.svg
[rank3]:> Batch Time: 429.54 ms, GPU Bubble Ratio: 41.54%, 25.21%, 34.90%, 26.25%
[rank3]:2025-10-29 06:32:27,157 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0632_stage3_step300.svg
[rank2]:2025-10-29 06:32:27,512 - INFO - Avg. fwd time: 14.7809 / Avg. bwd time: 23.2167 / Avg. batch time: 407.5339 (ms) / GPU bubble ratio: 25.41%
[rank3]:2025-10-29 06:32:27,490 - INFO - Avg. fwd time: 16.5222 / Avg. bwd time: 27.3029 / Avg. batch time: 366.6969 (ms) / GPU bubble ratio: 4.39%
[rank1]:2025-10-29 06:32:27,535 - INFO - Avg. fwd time: 16.9905 / Avg. bwd time: 26.3234 / Avg. batch time: 454.0536 (ms) / GPU bubble ratio: 23.68%
[rank0]:2025-10-29 06:32:27,540 - INFO - Avg. fwd time: 15.1757 / Avg. bwd time: 16.3222 / Avg. batch time: 487.0697 (ms) / GPU bubble ratio: 48.27%
[rank0]:2025-10-29 06:33:48,144 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:33:49,799 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,860  tflops: 459.89  mfu: 46.50%
[rank3]:2025-10-29 06:33:49,799 - INFO -  step: 350  loss:  0.9138  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,884  tflops: 461.00  mfu: 46.61%
[rank1]:2025-10-29 06:33:49,801 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,860  tflops: 459.88  mfu: 46.50%
[rank0]:2025-10-29 06:33:49,800 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,860  tflops: 459.88  mfu: 46.50%
[rank0]:2025-10-29 06:33:49,899 - INFO - Avg. fwd time: 15.2588 / Avg. bwd time: 14.1952 / Avg. batch time: 475.1393 (ms) / GPU bubble ratio: 50.41%
[rank3]:2025-10-29 06:33:50,119 - INFO - Avg. fwd time: 16.6375 / Avg. bwd time: 26.2793 / Avg. batch time: 359.3289 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-10-29 06:33:50,141 - INFO - Avg. fwd time: 14.8789 / Avg. bwd time: 22.3197 / Avg. batch time: 399.0651 (ms) / GPU bubble ratio: 25.43%
[rank1]:2025-10-29 06:33:50,167 - INFO - Avg. fwd time: 17.1088 / Avg. bwd time: 25.3039 / Avg. batch time: 444.3172 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-29 06:35:09,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:35:11,577 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank2_trend_line.svg
[rank1]:2025-10-29 06:35:11,601 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank1_trend_line.svg
[rank1]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.97/0.97, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:35:11,609 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,014  tflops: 467.05  mfu: 47.22%
[rank1]:2025-10-29 06:35:11,609 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 06:35:11,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank0_trend_line.svg
[rank0]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:35:11,608 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,014  tflops: 467.04  mfu: 47.22%
[rank0]:2025-10-29 06:35:11,608 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:35:11,567 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0635_rank3_trend_line.svg
[rank2]:2025-10-29 06:35:11,606 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.73/0.73, [MB2] 0.73/0.73, [MB3] 0.76/0.76, [MB4] 0.82/0.82, [MB5] 0.88/0.88, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:35:11,608 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,014  tflops: 467.03  mfu: 47.22%
[rank2]:2025-10-29 06:35:11,608 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 06:35:11,800 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0635_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 360.72 ms, GPU Bubble Ratio: 52.56%, 24.88%, 31.27%, 24.32%
[rank3]:2025-10-29 06:35:11,800 - INFO - 	> Batch Time: 360.72 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 06:35:11,800 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:35:11,807 - INFO -  step: 400  loss:  0.3258  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,990  tflops: 465.92  mfu: 47.11%
[rank3]:2025-10-29 06:35:11,807 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 06:35:28,301 - INFO - validate step: 400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,539
[rank0]:2025-10-29 06:35:28,264 - INFO - validate step: 400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,593
[rank2]:2025-10-29 06:35:28,332 - INFO - validate step: 400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,492
[rank0]:2025-10-29 06:35:28,433 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0635_stage0_step400.svg
[rank3]:2025-10-29 06:35:28,356 - INFO - validate step: 400  loss:  0.2526  memory: 86.40GiB(61.80%)  tps: 24,751
[rank2]:2025-10-29 06:35:28,436 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0635_stage2_step400.svg
[rank1]:2025-10-29 06:35:28,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0635_stage1_step400.svg
[rank0]:2025-10-29 06:35:28,517 - INFO - Avg. fwd time: 15.3154 / Avg. bwd time: 12.3220 / Avg. batch time: 464.2769 (ms) / GPU bubble ratio: 52.38%
[rank3]:2025-10-29 06:35:28,533 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0635_real_step400_rank3.svg
[rank3]:> Batch Time: 382.70 ms, GPU Bubble Ratio: 67.23%, 24.02%, 33.35%, 23.09%
[rank3]:2025-10-29 06:35:28,601 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0635_stage3_step400.svg
[rank2]:2025-10-29 06:35:28,869 - INFO - Avg. fwd time: 14.9517 / Avg. bwd time: 21.5254 / Avg. batch time: 391.2739 (ms) / GPU bubble ratio: 25.42%
[rank1]:2025-10-29 06:35:28,894 - INFO - Avg. fwd time: 17.1914 / Avg. bwd time: 24.3966 / Avg. batch time: 435.3980 (ms) / GPU bubble ratio: 23.59%
[rank3]:2025-10-29 06:35:28,847 - INFO - Avg. fwd time: 16.7172 / Avg. bwd time: 25.3603 / Avg. batch time: 352.5218 (ms) / GPU bubble ratio: 4.51%
[rank0]:2025-10-29 06:36:44,683 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:36:46,231 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,516  tflops: 490.48  mfu: 49.59%
[rank1]:2025-10-29 06:36:46,233 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,512  tflops: 490.27  mfu: 49.57%
[rank0]:2025-10-29 06:36:46,233 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,507  tflops: 490.04  mfu: 49.55%
[rank3]:2025-10-29 06:36:46,232 - INFO -  step: 450  loss:  0.3390  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,520  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:36:46,588 - INFO - Avg. fwd time: 16.7017 / Avg. bwd time: 24.5996 / Avg. batch time: 346.2260 (ms) / GPU bubble ratio: 4.57%
[rank2]:2025-10-29 06:36:46,610 - INFO - Avg. fwd time: 14.9526 / Avg. bwd time: 20.8909 / Avg. batch time: 384.2178 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-10-29 06:36:46,633 - INFO - Avg. fwd time: 17.1916 / Avg. bwd time: 23.6805 / Avg. batch time: 427.4556 (ms) / GPU bubble ratio: 23.51%
[rank0]:2025-10-29 06:36:46,639 - INFO - Avg. fwd time: 15.3015 / Avg. bwd time: 10.8857 / Avg. batch time: 454.8064 (ms) / GPU bubble ratio: 53.94%
[rank0]:2025-10-29 06:38:02,379 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:38:03,916 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank1]:2025-10-29 06:38:03,919 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank0]:2025-10-29 06:38:03,918 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,545  tflops: 491.83  mfu: 49.73%
[rank3]:2025-10-29 06:38:03,917 - INFO -  step: 500  loss:  0.3436  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,545  tflops: 491.84  mfu: 49.73%
[rank2]:2025-10-29 06:38:03,990 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0638_stage2_step500.svg
[rank1]:2025-10-29 06:38:03,988 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0638_stage1_step500.svg
[rank0]:2025-10-29 06:38:03,988 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0638_stage0_step500.svg
[rank0]:2025-10-29 06:38:04,073 - INFO - Avg. fwd time: 15.2894 / Avg. bwd time: 9.8969 / Avg. batch time: 448.2070 (ms) / GPU bubble ratio: 55.05%
[rank3]:2025-10-29 06:38:04,098 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0638_real_step500_rank3.svg
[rank3]:> Batch Time: 379.64 ms, GPU Bubble Ratio: 67.31%, 23.99%, 33.42%, 23.14%
[rank3]:2025-10-29 06:38:04,162 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0638_stage3_step500.svg
[rank2]:2025-10-29 06:38:04,425 - INFO - Avg. fwd time: 14.9520 / Avg. bwd time: 20.4537 / Avg. batch time: 379.2954 (ms) / GPU bubble ratio: 25.32%
[rank3]:2025-10-29 06:38:04,404 - INFO - Avg. fwd time: 16.6901 / Avg. bwd time: 24.0756 / Avg. batch time: 341.8821 (ms) / GPU bubble ratio: 4.61%
[rank1]:2025-10-29 06:38:04,451 - INFO - Avg. fwd time: 17.1902 / Avg. bwd time: 23.1853 / Avg. batch time: 421.9118 (ms) / GPU bubble ratio: 23.44%
[rank0]:2025-10-29 06:39:20,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:39:21,758 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank1]:2025-10-29 06:39:21,760 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank0]:2025-10-29 06:39:21,760 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,524  tflops: 490.84  mfu: 49.63%
[rank3]:2025-10-29 06:39:21,759 - INFO -  step: 550  loss:  0.3601  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,524  tflops: 490.85  mfu: 49.63%
[rank0]:2025-10-29 06:39:21,845 - INFO - Avg. fwd time: 15.2784 / Avg. bwd time: 8.9486 / Avg. batch time: 441.9459 (ms) / GPU bubble ratio: 56.14%
[rank2]:2025-10-29 06:39:22,070 - INFO - Avg. fwd time: 14.9520 / Avg. bwd time: 20.0350 / Avg. batch time: 374.6335 (ms) / GPU bubble ratio: 25.29%
[rank1]:2025-10-29 06:39:22,095 - INFO - Avg. fwd time: 17.1874 / Avg. bwd time: 22.7126 / Avg. batch time: 416.6619 (ms) / GPU bubble ratio: 23.39%
[rank3]:2025-10-29 06:39:22,049 - INFO - Avg. fwd time: 16.6788 / Avg. bwd time: 23.5731 / Avg. batch time: 337.7154 (ms) / GPU bubble ratio: 4.65%
[rank0]:2025-10-29 06:40:37,787 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:40:39,620 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank2_trend_line.svg
[rank2]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.70/0.70, [MB2] 0.70/0.70, [MB3] 0.75/0.75, [MB4] 0.81/0.81, [MB5] 0.88/0.88, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:40:39,649 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,517  tflops: 490.53  mfu: 49.60%
[rank2]:2025-10-29 06:40:39,649 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 06:40:39,640 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank1_trend_line.svg
[rank1]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.99/0.99, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:40:39,649 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,518  tflops: 490.55  mfu: 49.60%
[rank1]:2025-10-29 06:40:39,649 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 06:40:39,637 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank0_trend_line.svg
[rank0]:2025-10-29 06:40:39,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 06:40:39,648 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,518  tflops: 490.55  mfu: 49.60%
[rank0]:2025-10-29 06:40:39,648 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 06:40:39,607 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0640_rank3_trend_line.svg
[rank3]:2025-10-29 06:40:39,837 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0640_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.65 ms, GPU Bubble Ratio: 59.93%, 24.40%, 31.13%, 23.86%
[rank3]:2025-10-29 06:40:39,837 - INFO - 	> Batch Time: 356.65 ms (Average Freeze Ratio: 0.70)
[rank3]:2025-10-29 06:40:39,838 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:40:39,844 - INFO -  step: 600  loss:  0.3232  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,491  tflops: 489.32  mfu: 49.48%
[rank3]:2025-10-29 06:40:39,844 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 06:40:56,269 - INFO - validate step: 600  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,645
[rank0]:2025-10-29 06:40:56,197 - INFO - validate step: 600  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,751
[rank1]:2025-10-29 06:40:56,234 - INFO - validate step: 600  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,696
[rank3]:2025-10-29 06:40:56,291 - INFO - validate step: 600  loss:  0.2542  memory: 86.40GiB(61.80%)  tps: 24,905
[rank2]:2025-10-29 06:40:56,366 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0640_stage2_step600.svg
[rank0]:2025-10-29 06:40:56,362 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0640_stage0_step600.svg
[rank1]:2025-10-29 06:40:56,364 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0640_stage1_step600.svg
[rank3]:2025-10-29 06:40:56,469 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0640_real_step600_rank3.svg
[rank3]:> Batch Time: 377.35 ms, GPU Bubble Ratio: 67.37%, 23.94%, 33.36%, 23.15%
[rank3]:2025-10-29 06:40:56,533 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0640_stage3_step600.svg
[rank2]:2025-10-29 06:40:56,866 - INFO - Avg. fwd time: 14.9514 / Avg. bwd time: 19.6891 / Avg. batch time: 370.7399 (ms) / GPU bubble ratio: 25.25%
[rank3]:2025-10-29 06:40:56,843 - INFO - Avg. fwd time: 16.6667 / Avg. bwd time: 23.1555 / Avg. batch time: 334.2323 (ms) / GPU bubble ratio: 4.68%
[rank0]:2025-10-29 06:40:56,897 - INFO - Avg. fwd time: 15.2680 / Avg. bwd time: 8.1662 / Avg. batch time: 436.7299 (ms) / GPU bubble ratio: 57.07%
[rank1]:2025-10-29 06:40:56,890 - INFO - Avg. fwd time: 17.1836 / Avg. bwd time: 22.3193 / Avg. batch time: 412.2796 (ms) / GPU bubble ratio: 23.35%
[rank0]:2025-10-29 06:42:48,811 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:42:51,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,134  tflops: 332.74  mfu: 33.64%
[rank1]:2025-10-29 06:42:51,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,132  tflops: 332.64  mfu: 33.63%
[rank0]:2025-10-29 06:42:51,130 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.1068  memory: 75.31GiB(53.87%)  tps: 7,128  tflops: 332.43  mfu: 33.61%
[rank3]:2025-10-29 06:42:51,097 - INFO -  step: 650  loss:  0.2001  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,136  tflops: 332.81  mfu: 33.65%
[rank2]:2025-10-29 06:42:51,441 - INFO - Avg. fwd time: 14.9513 / Avg. bwd time: 19.4341 / Avg. batch time: 368.9703 (ms) / GPU bubble ratio: 25.45%
[rank3]:2025-10-29 06:42:51,420 - INFO - Avg. fwd time: 16.6540 / Avg. bwd time: 22.8444 / Avg. batch time: 331.6059 (ms) / GPU bubble ratio: 4.71%
[rank1]:2025-10-29 06:42:51,500 - INFO - Avg. fwd time: 17.1713 / Avg. bwd time: 22.0156 / Avg. batch time: 414.3573 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-10-29 06:42:51,621 - INFO - Avg. fwd time: 15.1572 / Avg. bwd time: 10.2788 / Avg. batch time: 445.1221 (ms) / GPU bubble ratio: 54.28%
[rank0]:2025-10-29 06:44:43,648 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:44:45,950 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 06:44:45,949 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank3]:2025-10-29 06:44:45,951 - INFO -  step: 700  loss:  0.2141  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank1]:2025-10-29 06:44:46,058 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0644_stage1_step700.svg
[rank0]:2025-10-29 06:44:45,983 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0904  memory: 75.31GiB(53.87%)  tps: 7,133  tflops: 332.67  mfu: 33.64%
[rank0]:2025-10-29 06:44:46,061 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0644_stage0_step700.svg
[rank2]:2025-10-29 06:44:46,060 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0644_stage2_step700.svg
[rank3]:2025-10-29 06:44:46,162 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0644_real_step700_rank3.svg
[rank3]:> Batch Time: 375.38 ms, GPU Bubble Ratio: 67.44%, 23.91%, 33.25%, 23.19%
[rank3]:2025-10-29 06:44:46,228 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0644_stage3_step700.svg
[rank3]:2025-10-29 06:44:46,473 - INFO - Avg. fwd time: 16.6373 / Avg. bwd time: 22.5296 / Avg. batch time: 328.9172 (ms) / GPU bubble ratio: 4.74%
[rank2]:2025-10-29 06:44:46,494 - INFO - Avg. fwd time: 14.9493 / Avg. bwd time: 19.1817 / Avg. batch time: 367.1727 (ms) / GPU bubble ratio: 25.63%
[rank1]:2025-10-29 06:44:46,552 - INFO - Avg. fwd time: 17.1566 / Avg. bwd time: 21.7136 / Avg. batch time: 416.4250 (ms) / GPU bubble ratio: 25.33%
[rank0]:2025-10-29 06:44:46,671 - INFO - Avg. fwd time: 15.0443 / Avg. bwd time: 12.4020 / Avg. batch time: 453.5324 (ms) / GPU bubble ratio: 51.59%
[rank0]:2025-10-29 06:46:38,663 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:46:40,971 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank0]:2025-10-29 06:46:41,004 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1127  memory: 75.31GiB(53.87%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank1]:2025-10-29 06:46:40,971 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank3]:2025-10-29 06:46:40,972 - INFO -  step: 750  loss:  0.2455  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,122  tflops: 332.18  mfu: 33.59%
[rank3]:2025-10-29 06:46:41,363 - INFO - Avg. fwd time: 16.6226 / Avg. bwd time: 22.2578 / Avg. batch time: 326.5929 (ms) / GPU bubble ratio: 4.76%
[rank2]:2025-10-29 06:46:41,392 - INFO - Avg. fwd time: 14.9485 / Avg. bwd time: 18.9684 / Avg. batch time: 365.6811 (ms) / GPU bubble ratio: 25.80%
[rank1]:2025-10-29 06:46:41,471 - INFO - Avg. fwd time: 17.1450 / Avg. bwd time: 21.4557 / Avg. batch time: 418.2561 (ms) / GPU bubble ratio: 26.17%
[rank0]:2025-10-29 06:46:41,570 - INFO - Avg. fwd time: 14.9485 / Avg. bwd time: 14.2302 / Avg. batch time: 460.8250 (ms) / GPU bubble ratio: 49.35%
[rank0]:2025-10-29 06:48:33,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:48:36,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank2_trend_line.svg
[rank1]:2025-10-29 06:48:36,106 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank1_trend_line.svg
[rank3]:2025-10-29 06:48:36,094 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank3_trend_line.svg
[rank2]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.66/0.66, [MB2] 0.66/0.66, [MB3] 0.71/0.71, [MB4] 0.78/0.78, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:48:36,191 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,110  tflops: 331.60  mfu: 33.53%
[rank2]:2025-10-29 06:48:36,191 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:48:36,182 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0648_rank0_trend_line.svg
[rank0]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:48:36,196 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1025  memory: 75.31GiB(53.87%)  tps: 7,112  tflops: 331.69  mfu: 33.54%
[rank0]:2025-10-29 06:48:36,196 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 06:48:36,188 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.98/0.98, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:48:36,191 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,110  tflops: 331.60  mfu: 33.53%
[rank1]:2025-10-29 06:48:36,191 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 06:48:36,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0648_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.61 ms, GPU Bubble Ratio: 35.88%, 24.37%, 30.88%, 23.92%
[rank3]:2025-10-29 06:48:36,379 - INFO - 	> Batch Time: 355.61 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 06:48:36,379 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:48:36,387 - INFO -  step: 800  loss:  0.2264  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,098  tflops: 331.05  mfu: 33.47%
[rank3]:2025-10-29 06:48:36,387 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 06:48:52,863 - INFO - validate step: 800  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,576
[rank2]:2025-10-29 06:48:52,911 - INFO - validate step: 800  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,499
[rank3]:2025-10-29 06:48:52,926 - INFO - validate step: 800  loss:  0.2512  memory: 86.40GiB(61.80%)  tps: 24,767
[rank1]:2025-10-29 06:48:52,896 - INFO - validate step: 800  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,521
[rank2]:2025-10-29 06:48:53,008 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0648_stage2_step800.svg
[rank0]:2025-10-29 06:48:53,002 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0648_stage0_step800.svg
[rank1]:2025-10-29 06:48:53,005 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0648_stage1_step800.svg
[rank3]:2025-10-29 06:48:53,103 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0648_real_step800_rank3.svg
[rank3]:> Batch Time: 373.25 ms, GPU Bubble Ratio: 67.46%, 23.71%, 33.07%, 23.33%
[rank3]:2025-10-29 06:48:53,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0648_stage3_step800.svg
[rank2]:2025-10-29 06:48:53,443 - INFO - Avg. fwd time: 14.9467 / Avg. bwd time: 18.8052 / Avg. batch time: 364.4976 (ms) / GPU bubble ratio: 25.92%
[rank3]:2025-10-29 06:48:53,421 - INFO - Avg. fwd time: 16.6097 / Avg. bwd time: 22.0515 / Avg. batch time: 324.8159 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 06:48:53,501 - INFO - Avg. fwd time: 17.1356 / Avg. bwd time: 21.2624 / Avg. batch time: 419.5739 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-10-29 06:48:53,617 - INFO - Avg. fwd time: 14.8757 / Avg. bwd time: 15.6047 / Avg. batch time: 466.2541 (ms) / GPU bubble ratio: 47.70%
[rank0]:2025-10-29 06:50:09,484 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:50:11,041 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,485  tflops: 489.03  mfu: 49.45%
[rank1]:2025-10-29 06:50:11,043 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,483  tflops: 488.92  mfu: 49.44%
[rank3]:2025-10-29 06:50:11,042 - INFO -  step: 850  loss:  0.2505  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,487  tflops: 489.12  mfu: 49.46%
[rank0]:2025-10-29 06:50:11,043 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,479  tflops: 488.72  mfu: 49.42%
[rank0]:2025-10-29 06:50:11,129 - INFO - Avg. fwd time: 14.8883 / Avg. bwd time: 14.8662 / Avg. batch time: 462.1396 (ms) / GPU bubble ratio: 48.49%
[rank3]:2025-10-29 06:50:11,332 - INFO - Avg. fwd time: 16.6063 / Avg. bwd time: 21.8501 / Avg. batch time: 323.1556 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 06:50:11,352 - INFO - Avg. fwd time: 14.9467 / Avg. bwd time: 18.6372 / Avg. batch time: 362.4753 (ms) / GPU bubble ratio: 25.88%
[rank1]:2025-10-29 06:50:11,378 - INFO - Avg. fwd time: 17.1428 / Avg. bwd time: 21.0793 / Avg. batch time: 416.7871 (ms) / GPU bubble ratio: 26.63%
[rank0]:2025-10-29 06:51:27,159 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:51:28,697 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank2]:2025-10-29 06:51:28,695 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank2]:2025-10-29 06:51:28,767 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0651_stage2_step900.svg
[rank1]:2025-10-29 06:51:28,698 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,549  tflops: 492.02  mfu: 49.75%
[rank1]:2025-10-29 06:51:28,767 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0651_stage1_step900.svg
[rank3]:2025-10-29 06:51:28,696 - INFO -  step: 900  loss:  0.2393  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,550  tflops: 492.03  mfu: 49.75%
[rank0]:2025-10-29 06:51:28,768 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0651_stage0_step900.svg
[rank3]:2025-10-29 06:51:28,877 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0651_real_step900_rank3.svg
[rank3]:> Batch Time: 372.25 ms, GPU Bubble Ratio: 67.36%, 23.55%, 32.98%, 23.41%
[rank3]:2025-10-29 06:51:28,938 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0651_stage3_step900.svg
[rank2]:2025-10-29 06:51:29,270 - INFO - Avg. fwd time: 14.9468 / Avg. bwd time: 18.4888 / Avg. batch time: 360.6095 (ms) / GPU bubble ratio: 25.82%
[rank1]:2025-10-29 06:51:29,295 - INFO - Avg. fwd time: 17.1464 / Avg. bwd time: 20.9172 / Avg. batch time: 413.8986 (ms) / GPU bubble ratio: 26.43%
[rank3]:2025-10-29 06:51:29,247 - INFO - Avg. fwd time: 16.6038 / Avg. bwd time: 21.6729 / Avg. batch time: 321.6992 (ms) / GPU bubble ratio: 4.81%
[rank0]:2025-10-29 06:51:29,301 - INFO - Avg. fwd time: 14.9041 / Avg. bwd time: 13.9994 / Avg. batch time: 457.5252 (ms) / GPU bubble ratio: 49.46%
[rank0]:2025-10-29 06:52:45,008 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:52:46,549 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank3]:2025-10-29 06:52:46,548 - INFO -  step: 950  loss:  0.2626  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,523  tflops: 490.79  mfu: 49.62%
[rank0]:2025-10-29 06:52:46,548 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank2]:2025-10-29 06:52:46,547 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,523  tflops: 490.78  mfu: 49.62%
[rank0]:2025-10-29 06:52:46,635 - INFO - Avg. fwd time: 14.9164 / Avg. bwd time: 13.3331 / Avg. batch time: 453.9530 (ms) / GPU bubble ratio: 50.22%
[rank3]:2025-10-29 06:52:46,838 - INFO - Avg. fwd time: 16.6027 / Avg. bwd time: 21.5374 / Avg. batch time: 320.5916 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 06:52:46,859 - INFO - Avg. fwd time: 14.9475 / Avg. bwd time: 18.3751 / Avg. batch time: 359.1573 (ms) / GPU bubble ratio: 25.78%
[rank1]:2025-10-29 06:52:46,884 - INFO - Avg. fwd time: 17.1487 / Avg. bwd time: 20.7921 / Avg. batch time: 411.6548 (ms) / GPU bubble ratio: 26.27%
[rank0]:2025-10-29 06:54:02,596 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:54:04,143 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank0]:2025-10-29 06:54:04,143 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 06:54:04,141 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank2]:2025-10-29 06:54:04,141 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 06:54:04,144 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,557  tflops: 492.40  mfu: 49.79%
[rank1]:2025-10-29 06:54:04,144 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 06:54:04,142 - INFO -  step: 1000  loss:  0.2373  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,558  tflops: 492.41  mfu: 49.79%
[rank3]:2025-10-29 06:54:04,142 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-29 06:54:20,639 - INFO - validate step: 1000  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,832
[rank0]:2025-10-29 06:54:20,603 - INFO - validate step: 1000  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,886
[rank2]:2025-10-29 06:54:20,672 - INFO - validate step: 1000  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,779
[rank3]:2025-10-29 06:54:20,695 - INFO - validate step: 1000  loss:  0.2504  memory: 86.40GiB(61.80%)  tps: 24,747
[rank2]:2025-10-29 06:54:20,772 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0654_stage2_step1000.svg
[rank1]:2025-10-29 06:54:20,770 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0654_stage1_step1000.svg
[rank0]:2025-10-29 06:54:20,770 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0654_stage0_step1000.svg
[rank0]:2025-10-29 06:54:20,857 - INFO - Avg. fwd time: 14.9276 / Avg. bwd time: 12.6317 / Avg. batch time: 450.1565 (ms) / GPU bubble ratio: 51.02%
[rank3]:2025-10-29 06:54:20,881 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0654_real_step1000_rank3.svg
[rank3]:> Batch Time: 371.79 ms, GPU Bubble Ratio: 67.33%, 23.50%, 32.96%, 23.42%
[rank3]:2025-10-29 06:54:20,945 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0654_stage3_step1000.svg
[rank2]:2025-10-29 06:54:21,211 - INFO - Avg. fwd time: 14.9471 / Avg. bwd time: 18.2554 / Avg. batch time: 357.5938 (ms) / GPU bubble ratio: 25.72%
[rank1]:2025-10-29 06:54:21,237 - INFO - Avg. fwd time: 17.1484 / Avg. bwd time: 20.6590 / Avg. batch time: 409.2568 (ms) / GPU bubble ratio: 26.10%
[rank3]:2025-10-29 06:54:21,191 - INFO - Avg. fwd time: 16.5994 / Avg. bwd time: 21.3927 / Avg. batch time: 319.3920 (ms) / GPU bubble ratio: 4.84%
[rank0]:2025-10-29 06:55:37,075 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:55:38,632 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,508  tflops: 490.09  mfu: 49.55%
[rank1]:2025-10-29 06:55:38,635 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,503  tflops: 489.87  mfu: 49.53%
[rank3]:2025-10-29 06:55:38,633 - INFO -  step: 1050  loss:  0.2424  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,511  tflops: 490.24  mfu: 49.57%
[rank0]:2025-10-29 06:55:38,634 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,498  tflops: 489.65  mfu: 49.51%
[rank3]:2025-10-29 06:55:38,995 - INFO - Avg. fwd time: 16.5971 / Avg. bwd time: 21.2640 / Avg. batch time: 318.3317 (ms) / GPU bubble ratio: 4.85%
[rank2]:2025-10-29 06:55:39,019 - INFO - Avg. fwd time: 14.9471 / Avg. bwd time: 18.1482 / Avg. batch time: 356.2402 (ms) / GPU bubble ratio: 25.68%
[rank1]:2025-10-29 06:55:39,045 - INFO - Avg. fwd time: 17.1505 / Avg. bwd time: 20.5409 / Avg. batch time: 407.1590 (ms) / GPU bubble ratio: 25.94%
[rank0]:2025-10-29 06:55:39,053 - INFO - Avg. fwd time: 14.9393 / Avg. bwd time: 12.0005 / Avg. batch time: 446.8016 (ms) / GPU bubble ratio: 51.76%
[rank0]:2025-10-29 06:56:54,785 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:56:56,346 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank3]:2025-10-29 06:56:56,345 - INFO -  step: 1100  loss:  0.2130  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,542  tflops: 491.67  mfu: 49.71%
[rank0]:2025-10-29 06:56:56,345 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank2]:2025-10-29 06:56:56,343 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,542  tflops: 491.66  mfu: 49.71%
[rank2]:2025-10-29 06:56:56,421 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0656_stage2_step1100.svg
[rank1]:2025-10-29 06:56:56,420 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0656_stage1_step1100.svg
[rank0]:2025-10-29 06:56:56,419 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0656_stage0_step1100.svg
[rank3]:2025-10-29 06:56:56,528 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0656_real_step1100_rank3.svg
[rank3]:> Batch Time: 371.55 ms, GPU Bubble Ratio: 67.33%, 23.48%, 32.95%, 23.43%
[rank3]:2025-10-29 06:56:56,591 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0656_stage3_step1100.svg
[rank0]:2025-10-29 06:56:56,503 - INFO - Avg. fwd time: 14.9480 / Avg. bwd time: 11.5075 / Avg. batch time: 444.1539 (ms) / GPU bubble ratio: 52.35%
[rank3]:2025-10-29 06:56:56,836 - INFO - Avg. fwd time: 16.5961 / Avg. bwd time: 21.1638 / Avg. batch time: 317.5109 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 06:56:56,856 - INFO - Avg. fwd time: 14.9475 / Avg. bwd time: 18.0641 / Avg. batch time: 355.1632 (ms) / GPU bubble ratio: 25.64%
[rank1]:2025-10-29 06:56:56,882 - INFO - Avg. fwd time: 17.1517 / Avg. bwd time: 20.4476 / Avg. batch time: 405.4940 (ms) / GPU bubble ratio: 25.82%
[rank0]:2025-10-29 06:58:12,656 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:58:14,221 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank3]:2025-10-29 06:58:14,219 - INFO -  step: 1150  loss:  0.2297  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,520  tflops: 490.64  mfu: 49.61%
[rank0]:2025-10-29 06:58:14,220 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank2]:2025-10-29 06:58:14,218 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,519  tflops: 490.63  mfu: 49.61%
[rank0]:2025-10-29 06:58:14,306 - INFO - Avg. fwd time: 14.9572 / Avg. bwd time: 10.9813 / Avg. batch time: 441.3514 (ms) / GPU bubble ratio: 52.98%
[rank3]:2025-10-29 06:58:14,516 - INFO - Avg. fwd time: 16.5947 / Avg. bwd time: 21.0568 / Avg. batch time: 316.6322 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 06:58:14,537 - INFO - Avg. fwd time: 14.9474 / Avg. bwd time: 17.9745 / Avg. batch time: 354.0378 (ms) / GPU bubble ratio: 25.61%
[rank1]:2025-10-29 06:58:14,562 - INFO - Avg. fwd time: 17.1521 / Avg. bwd time: 20.3477 / Avg. batch time: 403.7415 (ms) / GPU bubble ratio: 25.70%
[rank0]:2025-10-29 06:59:30,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:59:31,881 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,549  tflops: 491.98  mfu: 49.75%
[rank1]:2025-10-29 06:59:31,881 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 06:59:31,880 - INFO -  step: 1200  loss:  0.2156  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,549  tflops: 491.99  mfu: 49.75%
[rank3]:2025-10-29 06:59:31,880 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:59:31,880 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,549  tflops: 491.99  mfu: 49.75%
[rank0]:2025-10-29 06:59:31,881 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 06:59:31,879 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,549  tflops: 491.98  mfu: 49.75%
[rank2]:2025-10-29 06:59:31,879 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 06:59:48,413 - INFO - validate step: 1200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,777
[rank0]:2025-10-29 06:59:48,414 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:59:48,418 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 06:59:48,469 - INFO - validate step: 1200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,689
[rank2]:2025-10-29 06:59:48,470 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:59:48,450 - INFO - validate step: 1200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,722
[rank1]:2025-10-29 06:59:48,451 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:59:48,494 - INFO - validate step: 1200  loss:  0.2519  memory: 86.40GiB(61.80%)  tps: 24,655
[rank3]:2025-10-29 06:59:48,495 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:59:59,418 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.95 seconds.
[rank1]:2025-10-29 07:00:00,563 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.11 seconds.
[rank3]:2025-10-29 07:00:06,095 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.60 seconds.
[rank0]:2025-10-29 07:00:07,381 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 07:00:07,386 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.97 seconds.
[rank1]:2025-10-29 07:00:07,590 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0700_stage1_step1200.svg
[rank1]:2025-10-29 07:00:07,602 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 07:00:07,591 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0700_stage0_step1200.svg
[rank0]:2025-10-29 07:00:07,602 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 07:00:07,617 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0659_stage2_step1200.svg
[rank2]:2025-10-29 07:00:07,627 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 07:00:07,718 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0700_real_step1200_rank3.svg
[rank3]:> Batch Time: 371.24 ms, GPU Bubble Ratio: 67.32%, 23.45%, 32.91%, 23.41%
[rank3]:2025-10-29 07:00:07,785 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0700_stage3_step1200.svg
[rank3]:2025-10-29 07:00:07,794 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank2]:2025-10-29 07:00:08,894 - INFO - Avg. fwd time: 14.9482 / Avg. bwd time: 17.8929 / Avg. batch time: 353.1757 (ms) / GPU bubble ratio: 25.61%
[rank1]:2025-10-29 07:00:08,923 - INFO - Avg. fwd time: 17.1538 / Avg. bwd time: 20.2567 / Avg. batch time: 402.3088 (ms) / GPU bubble ratio: 25.61%
[rank3]:2025-10-29 07:00:08,869 - INFO - Avg. fwd time: 16.5939 / Avg. bwd time: 20.9592 / Avg. batch time: 315.9938 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:00:08,933 - INFO - Avg. fwd time: 14.9672 / Avg. bwd time: 10.5011 / Avg. batch time: 438.9675 (ms) / GPU bubble ratio: 53.59%
[rank0]:2025-10-29 07:01:31,893 - INFO - [GC] Peforming periodical GC collection 2.18 seconds
[rank0]:2025-10-29 07:01:33,550 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 7,792  tflops: 363.41  mfu: 36.75%
[rank2]:2025-10-29 07:01:33,547 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 7,796  tflops: 363.61  mfu: 36.77%
[rank1]:2025-10-29 07:01:33,550 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 7,795  tflops: 363.54  mfu: 36.76%
[rank3]:2025-10-29 07:01:33,548 - INFO -  step: 1250  loss:  0.9803  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank0]:2025-10-29 07:01:33,647 - INFO - Avg. fwd time: 14.9995 / Avg. bwd time: 10.1218 / Avg. batch time: 437.3876 (ms) / GPU bubble ratio: 54.05%
[rank3]:2025-10-29 07:01:33,867 - INFO - Avg. fwd time: 16.6219 / Avg. bwd time: 20.9030 / Avg. batch time: 315.7663 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:01:33,888 - INFO - Avg. fwd time: 14.9694 / Avg. bwd time: 17.8371 / Avg. batch time: 352.7767 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:01:33,914 - INFO - Avg. fwd time: 17.1790 / Avg. bwd time: 20.1926 / Avg. batch time: 401.4627 (ms) / GPU bubble ratio: 25.53%
[rank0]:2025-10-29 07:02:54,588 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:02:56,235 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,907  tflops: 462.09  mfu: 46.72%
[rank2]:2025-10-29 07:02:56,234 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,907  tflops: 462.08  mfu: 46.72%
[rank1]:2025-10-29 07:02:56,236 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,907  tflops: 462.08  mfu: 46.72%
[rank3]:2025-10-29 07:02:56,235 - INFO -  step: 1300  loss:  0.9598  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,908  tflops: 462.09  mfu: 46.72%
[rank0]:2025-10-29 07:02:56,314 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0702_stage0_step1300.svg
[rank2]:2025-10-29 07:02:56,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0702_stage2_step1300.svg
[rank1]:2025-10-29 07:02:56,316 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0702_stage1_step1300.svg
[rank0]:2025-10-29 07:02:56,412 - INFO - Avg. fwd time: 15.0325 / Avg. bwd time: 9.7124 / Avg. batch time: 435.6877 (ms) / GPU bubble ratio: 54.56%
[rank3]:2025-10-29 07:02:56,422 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0702_real_step1300_rank3.svg
[rank3]:> Batch Time: 372.13 ms, GPU Bubble Ratio: 67.29%, 23.50%, 32.98%, 23.42%
[rank3]:2025-10-29 07:02:56,488 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0702_stage3_step1300.svg
[rank3]:2025-10-29 07:02:56,759 - INFO - Avg. fwd time: 16.6525 / Avg. bwd time: 20.8436 / Avg. batch time: 315.5275 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:02:56,780 - INFO - Avg. fwd time: 14.9925 / Avg. bwd time: 17.7773 / Avg. batch time: 352.3536 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:02:56,806 - INFO - Avg. fwd time: 17.2086 / Avg. bwd time: 20.1249 / Avg. batch time: 400.5606 (ms) / GPU bubble ratio: 25.44%
[rank0]:2025-10-29 07:04:17,426 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:04:19,082 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank0]:2025-10-29 07:04:19,084 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,888  tflops: 461.17  mfu: 46.63%
[rank1]:2025-10-29 07:04:19,085 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank3]:2025-10-29 07:04:19,083 - INFO -  step: 1350  loss:  0.9639  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,888  tflops: 461.18  mfu: 46.63%
[rank2]:2025-10-29 07:04:19,493 - INFO - Avg. fwd time: 15.0137 / Avg. bwd time: 17.7223 / Avg. batch time: 351.9984 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:04:19,521 - INFO - Avg. fwd time: 17.2358 / Avg. bwd time: 20.0625 / Avg. batch time: 399.7654 (ms) / GPU bubble ratio: 25.36%
[rank3]:2025-10-29 07:04:19,468 - INFO - Avg. fwd time: 16.6811 / Avg. bwd time: 20.7898 / Avg. batch time: 315.3176 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:04:19,530 - INFO - Avg. fwd time: 15.0633 / Avg. bwd time: 9.3349 / Avg. batch time: 434.1572 (ms) / GPU bubble ratio: 55.04%
[rank0]:2025-10-29 07:05:40,210 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:05:41,864 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank2]:2025-10-29 07:05:41,864 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:05:41,866 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank0]:2025-10-29 07:05:41,866 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 07:05:41,866 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,896  tflops: 461.55  mfu: 46.67%
[rank1]:2025-10-29 07:05:41,866 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 07:05:41,865 - INFO -  step: 1400  loss:  0.9899  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,896  tflops: 461.56  mfu: 46.67%
[rank3]:2025-10-29 07:05:41,865 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 07:05:58,480 - INFO - validate step: 1400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,651
[rank0]:2025-10-29 07:05:58,413 - INFO - validate step: 1400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,754
[rank1]:2025-10-29 07:05:58,451 - INFO - validate step: 1400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,698
[rank3]:2025-10-29 07:05:58,504 - INFO - validate step: 1400  loss:  0.2497  memory: 86.40GiB(61.80%)  tps: 24,618
[rank0]:2025-10-29 07:05:58,586 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0705_stage0_step1400.svg
[rank1]:2025-10-29 07:05:58,589 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0705_stage1_step1400.svg
[rank2]:2025-10-29 07:05:58,591 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0705_stage2_step1400.svg
[rank0]:2025-10-29 07:05:58,686 - INFO - Avg. fwd time: 15.0873 / Avg. bwd time: 9.0340 / Avg. batch time: 432.9163 (ms) / GPU bubble ratio: 55.43%
[rank3]:2025-10-29 07:05:58,691 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0705_real_step1400_rank3.svg
[rank3]:> Batch Time: 373.02 ms, GPU Bubble Ratio: 67.27%, 23.55%, 33.03%, 23.40%
[rank3]:2025-10-29 07:05:58,759 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0705_stage3_step1400.svg
[rank2]:2025-10-29 07:05:59,054 - INFO - Avg. fwd time: 15.0308 / Avg. bwd time: 17.6788 / Avg. batch time: 351.6969 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:05:59,080 - INFO - Avg. fwd time: 17.2569 / Avg. bwd time: 20.0126 / Avg. batch time: 399.1117 (ms) / GPU bubble ratio: 25.29%
[rank3]:2025-10-29 07:05:59,033 - INFO - Avg. fwd time: 16.7041 / Avg. bwd time: 20.7469 / Avg. batch time: 315.1520 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:07:19,823 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:07:21,480 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,867  tflops: 460.18  mfu: 46.53%
[rank3]:2025-10-29 07:07:21,478 - INFO -  step: 1450  loss:  1.0070  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,873  tflops: 460.49  mfu: 46.56%
[rank0]:2025-10-29 07:07:21,479 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,862  tflops: 459.97  mfu: 46.51%
[rank2]:2025-10-29 07:07:21,477 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,870  tflops: 460.35  mfu: 46.55%
[rank0]:2025-10-29 07:07:21,578 - INFO - Avg. fwd time: 15.1145 / Avg. bwd time: 8.7065 / Avg. batch time: 431.5959 (ms) / GPU bubble ratio: 55.85%
[rank2]:2025-10-29 07:07:21,815 - INFO - Avg. fwd time: 15.0492 / Avg. bwd time: 17.6310 / Avg. batch time: 351.3940 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:07:21,841 - INFO - Avg. fwd time: 17.2811 / Avg. bwd time: 19.9599 / Avg. batch time: 398.4290 (ms) / GPU bubble ratio: 25.22%
[rank3]:2025-10-29 07:07:21,795 - INFO - Avg. fwd time: 16.7291 / Avg. bwd time: 20.7007 / Avg. batch time: 314.9757 (ms) / GPU bubble ratio: 4.93%
[rank0]:2025-10-29 07:08:42,532 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:08:44,172 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank3]:2025-10-29 07:08:44,173 - INFO -  step: 1500  loss:  0.8917  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,906  tflops: 462.04  mfu: 46.72%
[rank1]:2025-10-29 07:08:44,175 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank1]:2025-10-29 07:08:44,253 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0708_stage1_step1500.svg
[rank0]:2025-10-29 07:08:44,174 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,906  tflops: 462.03  mfu: 46.72%
[rank0]:2025-10-29 07:08:44,255 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0708_stage0_step1500.svg
[rank2]:2025-10-29 07:08:44,253 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0708_stage2_step1500.svg
[rank3]:2025-10-29 07:08:44,359 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0708_real_step1500_rank3.svg
[rank3]:> Batch Time: 374.12 ms, GPU Bubble Ratio: 67.27%, 23.64%, 33.12%, 23.37%
[rank3]:2025-10-29 07:08:44,427 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0708_stage3_step1500.svg
[rank2]:2025-10-29 07:08:44,790 - INFO - Avg. fwd time: 15.0660 / Avg. bwd time: 17.5867 / Avg. batch time: 351.1058 (ms) / GPU bubble ratio: 25.60%
[rank3]:2025-10-29 07:08:44,765 - INFO - Avg. fwd time: 16.7524 / Avg. bwd time: 20.6568 / Avg. batch time: 314.8044 (ms) / GPU bubble ratio: 4.93%
[rank1]:2025-10-29 07:08:44,818 - INFO - Avg. fwd time: 17.3027 / Avg. bwd time: 19.9098 / Avg. batch time: 397.7864 (ms) / GPU bubble ratio: 25.16%
[rank0]:2025-10-29 07:08:44,826 - INFO - Avg. fwd time: 15.1389 / Avg. bwd time: 8.4020 / Avg. batch time: 430.3603 (ms) / GPU bubble ratio: 56.24%
[rank0]:2025-10-29 07:10:05,416 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:10:07,069 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank1]:2025-10-29 07:10:07,072 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank3]:2025-10-29 07:10:07,071 - INFO -  step: 1550  loss:  0.9566  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,882  tflops: 460.91  mfu: 46.60%
[rank0]:2025-10-29 07:10:07,071 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,882  tflops: 460.90  mfu: 46.60%
[rank0]:2025-10-29 07:10:07,172 - INFO - Avg. fwd time: 15.1585 / Avg. bwd time: 8.1574 / Avg. batch time: 429.3521 (ms) / GPU bubble ratio: 56.56%
[rank3]:2025-10-29 07:10:07,390 - INFO - Avg. fwd time: 16.7711 / Avg. bwd time: 20.6220 / Avg. batch time: 314.6707 (ms) / GPU bubble ratio: 4.93%
[rank2]:2025-10-29 07:10:07,411 - INFO - Avg. fwd time: 15.0799 / Avg. bwd time: 17.5511 / Avg. batch time: 350.8604 (ms) / GPU bubble ratio: 25.60%
[rank1]:2025-10-29 07:10:07,438 - INFO - Avg. fwd time: 17.3202 / Avg. bwd time: 19.8697 / Avg. batch time: 397.2555 (ms) / GPU bubble ratio: 25.11%
[rank0]:2025-10-29 07:11:27,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:11:29,405 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank2_trend_line.svg
[rank2]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.45/0.45, [MB1] 0.45/0.45, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.59/0.59, [MB5] 0.73/0.73, [MB6] 0.86/0.86, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 9,946  tflops: 463.86  mfu: 46.90%
[rank2]:2025-10-29 07:11:29,439 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 07:11:29,427 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank1_trend_line.svg
[rank1]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.95/0.95, [MB2] 0.95/0.95, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 9,946  tflops: 463.88  mfu: 46.90%
[rank1]:2025-10-29 07:11:29,438 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:11:29,406 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank3_trend_line.svg
[rank0]:2025-10-29 07:11:29,428 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule_adjustment/251029_0711_rank0_trend_line.svg
[rank0]:2025-10-29 07:11:29,434 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:11:29,438 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 9,946  tflops: 463.87  mfu: 46.90%
[rank0]:2025-10-29 07:11:29,438 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:11:29,626 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0711_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.27 ms, GPU Bubble Ratio: 53.76%, 24.08%, 29.86%, 23.80%
[rank3]:2025-10-29 07:11:29,627 - INFO - 	> Batch Time: 356.27 ms (Average Freeze Ratio: 0.68)
[rank3]:2025-10-29 07:11:29,628 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:11:29,636 - INFO -  step: 1600  loss:  0.2251  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 9,922  tflops: 462.77  mfu: 46.79%
[rank3]:2025-10-29 07:11:29,636 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 07:11:45,993 - INFO - validate step: 1600  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,743
[rank0]:2025-10-29 07:11:45,955 - INFO - validate step: 1600  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,799
[rank2]:2025-10-29 07:11:46,021 - INFO - validate step: 1600  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,701
[rank3]:2025-10-29 07:11:46,044 - INFO - validate step: 1600  loss:  0.2525  memory: 86.40GiB(61.80%)  tps: 24,965
[rank0]:2025-10-29 07:11:46,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0711_stage0_step1600.svg
[rank2]:2025-10-29 07:11:46,131 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0711_stage2_step1600.svg
[rank1]:2025-10-29 07:11:46,128 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0711_stage1_step1600.svg
[rank0]:2025-10-29 07:11:46,210 - INFO - Avg. fwd time: 15.1759 / Avg. bwd time: 7.8894 / Avg. batch time: 428.1607 (ms) / GPU bubble ratio: 56.90%
[rank3]:2025-10-29 07:11:46,227 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0711_real_step1600_rank3.svg
[rank3]:> Batch Time: 375.00 ms, GPU Bubble Ratio: 67.26%, 23.69%, 33.18%, 23.33%
[rank3]:2025-10-29 07:11:46,297 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0711_stage3_step1600.svg
[rank2]:2025-10-29 07:11:46,568 - INFO - Avg. fwd time: 15.0913 / Avg. bwd time: 17.5106 / Avg. batch time: 350.5083 (ms) / GPU bubble ratio: 25.59%
[rank1]:2025-10-29 07:11:46,594 - INFO - Avg. fwd time: 17.3353 / Avg. bwd time: 19.8238 / Avg. batch time: 396.5891 (ms) / GPU bubble ratio: 25.04%
[rank3]:2025-10-29 07:11:46,547 - INFO - Avg. fwd time: 16.7860 / Avg. bwd time: 20.5799 / Avg. batch time: 314.4458 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:13:02,226 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:13:03,771 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,527  tflops: 491.00  mfu: 49.65%
[rank2]:2025-10-29 07:13:03,769 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,537  tflops: 491.43  mfu: 49.69%
[rank1]:2025-10-29 07:13:03,772 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,532  tflops: 491.23  mfu: 49.67%
[rank3]:2025-10-29 07:13:03,770 - INFO -  step: 1650  loss:  0.2240  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,540  tflops: 491.57  mfu: 49.70%
[rank3]:2025-10-29 07:13:04,129 - INFO - Avg. fwd time: 16.7781 / Avg. bwd time: 20.5225 / Avg. batch time: 313.9127 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:13:04,195 - INFO - Avg. fwd time: 15.1760 / Avg. bwd time: 7.6386 / Avg. batch time: 426.7134 (ms) / GPU bubble ratio: 57.23%
[rank2]:2025-10-29 07:13:04,156 - INFO - Avg. fwd time: 15.0872 / Avg. bwd time: 17.4659 / Avg. batch time: 349.8564 (ms) / GPU bubble ratio: 25.56%
[rank1]:2025-10-29 07:13:04,184 - INFO - Avg. fwd time: 17.3310 / Avg. bwd time: 19.7750 / Avg. batch time: 395.6444 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-10-29 07:14:19,751 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:14:21,282 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank1]:2025-10-29 07:14:21,285 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank3]:2025-10-29 07:14:21,283 - INFO -  step: 1700  loss:  0.2341  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,569  tflops: 492.93  mfu: 49.84%
[rank0]:2025-10-29 07:14:21,284 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,569  tflops: 492.92  mfu: 49.84%
[rank2]:2025-10-29 07:14:21,364 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0714_stage2_step1700.svg
[rank1]:2025-10-29 07:14:21,363 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0714_stage1_step1700.svg
[rank0]:2025-10-29 07:14:21,366 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0714_stage0_step1700.svg
[rank0]:2025-10-29 07:14:21,453 - INFO - Avg. fwd time: 15.1749 / Avg. bwd time: 7.4359 / Avg. batch time: 425.5130 (ms) / GPU bubble ratio: 57.49%
[rank3]:2025-10-29 07:14:21,466 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0714_real_step1700_rank3.svg
[rank3]:> Batch Time: 374.32 ms, GPU Bubble Ratio: 67.25%, 23.62%, 33.13%, 23.39%
[rank3]:2025-10-29 07:14:21,534 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0714_stage3_step1700.svg
[rank2]:2025-10-29 07:14:21,798 - INFO - Avg. fwd time: 15.0835 / Avg. bwd time: 17.4295 / Avg. batch time: 349.3039 (ms) / GPU bubble ratio: 25.54%
[rank1]:2025-10-29 07:14:21,823 - INFO - Avg. fwd time: 17.3267 / Avg. bwd time: 19.7354 / Avg. batch time: 394.8516 (ms) / GPU bubble ratio: 24.91%
[rank3]:2025-10-29 07:14:21,778 - INFO - Avg. fwd time: 16.7711 / Avg. bwd time: 20.4758 / Avg. batch time: 313.4741 (ms) / GPU bubble ratio: 4.94%
[rank0]:2025-10-29 07:15:37,376 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:15:38,912 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank2]:2025-10-29 07:15:38,911 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank1]:2025-10-29 07:15:38,913 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,553  tflops: 492.19  mfu: 49.77%
[rank3]:2025-10-29 07:15:38,911 - INFO -  step: 1750  loss:  0.2353  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,553  tflops: 492.20  mfu: 49.77%
[rank0]:2025-10-29 07:15:39,002 - INFO - Avg. fwd time: 15.1742 / Avg. bwd time: 7.2126 / Avg. batch time: 424.2070 (ms) / GPU bubble ratio: 57.78%
[rank2]:2025-10-29 07:15:39,228 - INFO - Avg. fwd time: 15.0795 / Avg. bwd time: 17.3896 / Avg. batch time: 348.7090 (ms) / GPU bubble ratio: 25.51%
[rank1]:2025-10-29 07:15:39,252 - INFO - Avg. fwd time: 17.3221 / Avg. bwd time: 19.6918 / Avg. batch time: 393.9944 (ms) / GPU bubble ratio: 24.84%
[rank3]:2025-10-29 07:15:39,205 - INFO - Avg. fwd time: 16.7634 / Avg. bwd time: 20.4238 / Avg. batch time: 312.9870 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 07:16:54,806 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:16:56,349 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,579  tflops: 493.41  mfu: 49.89%
[rank1]:2025-10-29 07:16:56,349 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 07:16:56,347 - INFO -  step: 1800  loss:  0.2129  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,579  tflops: 493.42  mfu: 49.89%
[rank3]:2025-10-29 07:16:56,347 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:16:56,348 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,579  tflops: 493.42  mfu: 49.89%
[rank0]:2025-10-29 07:16:56,348 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:16:56,346 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,579  tflops: 493.41  mfu: 49.89%
[rank2]:2025-10-29 07:16:56,346 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:17:12,888 - INFO - validate step: 1800  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,765
[rank2]:2025-10-29 07:17:12,953 - INFO - validate step: 1800  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,665
[rank1]:2025-10-29 07:17:12,923 - INFO - validate step: 1800  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,713
[rank1]:2025-10-29 07:17:13,062 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0717_stage1_step1800.svg
[rank3]:2025-10-29 07:17:12,976 - INFO - validate step: 1800  loss:  0.2505  memory: 86.40GiB(61.80%)  tps: 24,633
[rank0]:2025-10-29 07:17:13,071 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0717_stage0_step1800.svg
[rank2]:2025-10-29 07:17:13,065 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0717_stage2_step1800.svg
[rank3]:2025-10-29 07:17:13,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0717_real_step1800_rank3.svg
[rank3]:> Batch Time: 373.64 ms, GPU Bubble Ratio: 67.23%, 23.55%, 33.06%, 23.40%
[rank3]:2025-10-29 07:17:13,233 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0717_stage3_step1800.svg
[rank3]:2025-10-29 07:17:13,545 - INFO - Avg. fwd time: 16.7556 / Avg. bwd time: 20.3742 / Avg. batch time: 312.5181 (ms) / GPU bubble ratio: 4.95%
[rank0]:2025-10-29 07:17:13,616 - INFO - Avg. fwd time: 15.1731 / Avg. bwd time: 7.0024 / Avg. batch time: 422.9684 (ms) / GPU bubble ratio: 58.06%
[rank2]:2025-10-29 07:17:13,571 - INFO - Avg. fwd time: 15.0753 / Avg. bwd time: 17.3518 / Avg. batch time: 348.1382 (ms) / GPU bubble ratio: 25.48%
[rank1]:2025-10-29 07:17:13,600 - INFO - Avg. fwd time: 17.3171 / Avg. bwd time: 19.6507 / Avg. batch time: 393.1778 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-10-29 07:18:29,426 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:18:30,973 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,491  tflops: 489.31  mfu: 49.48%
[rank2]:2025-10-29 07:18:30,971 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,500  tflops: 489.73  mfu: 49.52%
[rank1]:2025-10-29 07:18:30,974 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,496  tflops: 489.53  mfu: 49.50%
[rank3]:2025-10-29 07:18:30,972 - INFO -  step: 1850  loss:  0.1981  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,503  tflops: 489.88  mfu: 49.53%
[rank0]:2025-10-29 07:18:31,064 - INFO - Avg. fwd time: 15.1734 / Avg. bwd time: 6.8317 / Avg. batch time: 421.9686 (ms) / GPU bubble ratio: 58.28%
[rank2]:2025-10-29 07:18:31,288 - INFO - Avg. fwd time: 15.0726 / Avg. bwd time: 17.3217 / Avg. batch time: 347.6779 (ms) / GPU bubble ratio: 25.46%
[rank1]:2025-10-29 07:18:31,314 - INFO - Avg. fwd time: 17.3147 / Avg. bwd time: 19.6182 / Avg. batch time: 392.5189 (ms) / GPU bubble ratio: 24.73%
[rank3]:2025-10-29 07:18:31,268 - INFO - Avg. fwd time: 16.7502 / Avg. bwd time: 20.3349 / Avg. batch time: 312.1529 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:19:46,971 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:19:48,528 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank2]:2025-10-29 07:19:48,526 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank1]:2025-10-29 07:19:48,528 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank3]:2025-10-29 07:19:48,527 - INFO -  step: 1900  loss:  0.2126  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,563  tflops: 492.66  mfu: 49.81%
[rank0]:2025-10-29 07:19:48,613 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0719_stage0_step1900.svg
[rank2]:2025-10-29 07:19:48,613 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0719_stage2_step1900.svg
[rank1]:2025-10-29 07:19:48,609 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0719_stage1_step1900.svg
[rank0]:2025-10-29 07:19:48,701 - INFO - Avg. fwd time: 15.1727 / Avg. bwd time: 6.6428 / Avg. batch time: 420.8446 (ms) / GPU bubble ratio: 58.53%
[rank3]:2025-10-29 07:19:48,713 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0719_real_step1900_rank3.svg
[rank3]:> Batch Time: 373.16 ms, GPU Bubble Ratio: 67.23%, 23.51%, 33.02%, 23.43%
[rank3]:2025-10-29 07:19:48,782 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0719_stage3_step1900.svg
[rank2]:2025-10-29 07:19:49,054 - INFO - Avg. fwd time: 15.0692 / Avg. bwd time: 17.2882 / Avg. batch time: 347.1585 (ms) / GPU bubble ratio: 25.44%
[rank1]:2025-10-29 07:19:49,079 - INFO - Avg. fwd time: 17.3104 / Avg. bwd time: 19.5809 / Avg. batch time: 391.7746 (ms) / GPU bubble ratio: 24.67%
[rank3]:2025-10-29 07:19:49,034 - INFO - Avg. fwd time: 16.7435 / Avg. bwd time: 20.2909 / Avg. batch time: 311.7400 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:21:04,715 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:21:06,281 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,536  tflops: 491.39  mfu: 49.69%
[rank1]:2025-10-29 07:21:06,282 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank2]:2025-10-29 07:21:06,279 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 07:21:06,280 - INFO -  step: 1950  loss:  0.2384  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,536  tflops: 491.40  mfu: 49.69%
[rank3]:2025-10-29 07:21:06,650 - INFO - Avg. fwd time: 16.7383 / Avg. bwd time: 20.2506 / Avg. batch time: 311.3684 (ms) / GPU bubble ratio: 4.96%
[rank0]:2025-10-29 07:21:06,719 - INFO - Avg. fwd time: 15.1723 / Avg. bwd time: 6.4641 / Avg. batch time: 419.8177 (ms) / GPU bubble ratio: 58.77%
[rank1]:2025-10-29 07:21:06,708 - INFO - Avg. fwd time: 17.3067 / Avg. bwd time: 19.5457 / Avg. batch time: 391.1060 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-10-29 07:21:06,678 - INFO - Avg. fwd time: 15.0662 / Avg. bwd time: 17.2563 / Avg. batch time: 346.7030 (ms) / GPU bubble ratio: 25.42%
[rank0]:2025-10-29 07:22:22,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:22:23,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank0]:2025-10-29 07:22:23,932 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 07:22:23,932 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank1]:2025-10-29 07:22:23,933 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 07:22:23,930 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank2]:2025-10-29 07:22:23,930 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 07:22:23,931 - INFO -  step: 2000  loss:  0.2230  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,550  tflops: 492.05  mfu: 49.75%
[rank3]:2025-10-29 07:22:23,931 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 07:22:40,488 - INFO - validate step: 2000  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,741
[rank1]:2025-10-29 07:22:40,526 - INFO - validate step: 2000  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,685
[rank2]:2025-10-29 07:22:40,551 - INFO - validate step: 2000  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,644
[rank3]:2025-10-29 07:22:40,575 - INFO - validate step: 2000  loss:  0.2515  memory: 86.40GiB(61.80%)  tps: 24,611
[rank0]:2025-10-29 07:22:40,664 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0722_stage0_step2000.svg
[rank1]:2025-10-29 07:22:40,666 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0722_stage1_step2000.svg
[rank2]:2025-10-29 07:22:40,667 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0722_stage2_step2000.svg
[rank0]:2025-10-29 07:22:40,753 - INFO - Avg. fwd time: 15.1715 / Avg. bwd time: 6.3184 / Avg. batch time: 418.9599 (ms) / GPU bubble ratio: 58.97%
[rank3]:2025-10-29 07:22:40,769 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0722_real_step2000_rank3.svg
[rank3]:> Batch Time: 372.80 ms, GPU Bubble Ratio: 67.23%, 23.48%, 32.99%, 23.43%
[rank3]:2025-10-29 07:22:40,842 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0722_stage3_step2000.svg
[rank2]:2025-10-29 07:22:41,116 - INFO - Avg. fwd time: 15.0634 / Avg. bwd time: 17.2301 / Avg. batch time: 346.3123 (ms) / GPU bubble ratio: 25.40%
[rank3]:2025-10-29 07:22:41,096 - INFO - Avg. fwd time: 16.7339 / Avg. bwd time: 20.2174 / Avg. batch time: 311.0612 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:22:41,143 - INFO - Avg. fwd time: 17.3032 / Avg. bwd time: 19.5168 / Avg. batch time: 390.5414 (ms) / GPU bubble ratio: 24.58%
[rank0]:2025-10-29 07:23:56,932 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:23:58,486 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,511  tflops: 490.25  mfu: 49.57%
[rank3]:2025-10-29 07:23:58,487 - INFO -  step: 2050  loss:  0.2648  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,515  tflops: 490.41  mfu: 49.59%
[rank0]:2025-10-29 07:23:58,488 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,503  tflops: 489.84  mfu: 49.53%
[rank0]:2025-10-29 07:23:58,578 - INFO - Avg. fwd time: 15.1716 / Avg. bwd time: 6.1565 / Avg. batch time: 418.0470 (ms) / GPU bubble ratio: 59.19%
[rank1]:2025-10-29 07:23:58,489 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,508  tflops: 490.08  mfu: 49.55%
[rank3]:2025-10-29 07:23:58,780 - INFO - Avg. fwd time: 16.7300 / Avg. bwd time: 20.1820 / Avg. batch time: 310.7404 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:23:58,827 - INFO - Avg. fwd time: 17.3007 / Avg. bwd time: 19.4854 / Avg. batch time: 389.9534 (ms) / GPU bubble ratio: 24.53%
[rank2]:2025-10-29 07:23:58,802 - INFO - Avg. fwd time: 15.0610 / Avg. bwd time: 17.2015 / Avg. batch time: 345.9169 (ms) / GPU bubble ratio: 25.39%
[rank0]:2025-10-29 07:25:14,552 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:25:16,089 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank0]:2025-10-29 07:25:16,088 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank2]:2025-10-29 07:25:16,086 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,557  tflops: 492.37  mfu: 49.78%
[rank3]:2025-10-29 07:25:16,088 - INFO -  step: 2100  loss:  0.2491  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,557  tflops: 492.37  mfu: 49.79%
[rank1]:2025-10-29 07:25:16,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0725_stage1_step2100.svg
[rank0]:2025-10-29 07:25:16,169 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0725_stage0_step2100.svg
[rank2]:2025-10-29 07:25:16,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0725_stage2_step2100.svg
[rank3]:2025-10-29 07:25:16,277 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0725_real_step2100_rank3.svg
[rank3]:> Batch Time: 372.53 ms, GPU Bubble Ratio: 67.23%, 23.46%, 32.98%, 23.43%
[rank3]:2025-10-29 07:25:16,341 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0725_stage3_step2100.svg
[rank3]:2025-10-29 07:25:16,651 - INFO - Avg. fwd time: 16.7257 / Avg. bwd time: 20.1479 / Avg. batch time: 310.4266 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:25:16,708 - INFO - Avg. fwd time: 17.2978 / Avg. bwd time: 19.4552 / Avg. batch time: 389.3845 (ms) / GPU bubble ratio: 24.49%
[rank0]:2025-10-29 07:25:16,719 - INFO - Avg. fwd time: 15.1712 / Avg. bwd time: 6.0027 / Avg. batch time: 417.1701 (ms) / GPU bubble ratio: 59.40%
[rank2]:2025-10-29 07:25:16,678 - INFO - Avg. fwd time: 15.0583 / Avg. bwd time: 17.1742 / Avg. batch time: 345.5319 (ms) / GPU bubble ratio: 25.37%
[rank0]:2025-10-29 07:26:32,366 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:26:33,910 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank0]:2025-10-29 07:26:33,912 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank3]:2025-10-29 07:26:33,912 - INFO -  step: 2150  loss:  0.2846  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,527  tflops: 490.96  mfu: 49.64%
[rank1]:2025-10-29 07:26:33,913 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,526  tflops: 490.95  mfu: 49.64%
[rank0]:2025-10-29 07:26:34,003 - INFO - Avg. fwd time: 15.1708 / Avg. bwd time: 5.8768 / Avg. batch time: 416.4421 (ms) / GPU bubble ratio: 59.57%
[rank3]:2025-10-29 07:26:34,205 - INFO - Avg. fwd time: 16.7227 / Avg. bwd time: 20.1202 / Avg. batch time: 310.1753 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:26:34,254 - INFO - Avg. fwd time: 17.2952 / Avg. bwd time: 19.4303 / Avg. batch time: 388.9094 (ms) / GPU bubble ratio: 24.45%
[rank2]:2025-10-29 07:26:34,226 - INFO - Avg. fwd time: 15.0562 / Avg. bwd time: 17.1519 / Avg. batch time: 345.2094 (ms) / GPU bubble ratio: 25.36%
[rank0]:2025-10-29 07:27:49,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:27:51,538 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank1]:2025-10-29 07:27:51,538 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 07:27:51,535 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank2]:2025-10-29 07:27:51,535 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 07:27:51,536 - INFO -  step: 2200  loss:  0.2276  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,554  tflops: 492.22  mfu: 49.77%
[rank3]:2025-10-29 07:27:51,536 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 07:27:51,537 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,553  tflops: 492.21  mfu: 49.77%
[rank0]:2025-10-29 07:27:51,537 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 07:28:08,077 - INFO - validate step: 2200  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,764
[rank1]:2025-10-29 07:28:08,117 - INFO - validate step: 2200  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,707
[rank2]:2025-10-29 07:28:08,135 - INFO - validate step: 2200  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,675
[rank3]:2025-10-29 07:28:08,159 - INFO - validate step: 2200  loss:  0.2514  memory: 86.40GiB(61.80%)  tps: 24,642
[rank1]:2025-10-29 07:28:08,242 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0728_stage1_step2200.svg
[rank2]:2025-10-29 07:28:08,244 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0728_stage2_step2200.svg
[rank0]:2025-10-29 07:28:08,241 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0728_stage0_step2200.svg
[rank3]:2025-10-29 07:28:08,349 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0728_real_step2200_rank3.svg
[rank3]:> Batch Time: 372.35 ms, GPU Bubble Ratio: 67.23%, 23.45%, 32.97%, 23.43%
[rank0]:2025-10-29 07:28:08,332 - INFO - Avg. fwd time: 15.1698 / Avg. bwd time: 5.7365 / Avg. batch time: 415.6211 (ms) / GPU bubble ratio: 59.76%
[rank3]:2025-10-29 07:28:08,412 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0728_stage3_step2200.svg
[rank2]:2025-10-29 07:28:08,682 - INFO - Avg. fwd time: 15.0535 / Avg. bwd time: 17.1268 / Avg. batch time: 344.8404 (ms) / GPU bubble ratio: 25.34%
[rank3]:2025-10-29 07:28:08,662 - INFO - Avg. fwd time: 16.7186 / Avg. bwd time: 20.0890 / Avg. batch time: 309.8865 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:28:08,708 - INFO - Avg. fwd time: 17.2915 / Avg. bwd time: 19.4022 / Avg. batch time: 388.3707 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-10-29 07:29:24,544 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:29:26,105 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,504  tflops: 489.92  mfu: 49.54%
[rank2]:2025-10-29 07:29:26,102 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,507  tflops: 490.05  mfu: 49.55%
[rank3]:2025-10-29 07:29:26,103 - INFO -  step: 2250  loss:  0.2498  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,510  tflops: 490.21  mfu: 49.57%
[rank0]:2025-10-29 07:29:26,103 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,499  tflops: 489.68  mfu: 49.51%
[rank1]:2025-10-29 07:29:26,526 - INFO - Avg. fwd time: 17.2890 / Avg. bwd time: 19.3766 / Avg. batch time: 387.8813 (ms) / GPU bubble ratio: 24.38%
[rank2]:2025-10-29 07:29:26,495 - INFO - Avg. fwd time: 15.0511 / Avg. bwd time: 17.1028 / Avg. batch time: 344.5080 (ms) / GPU bubble ratio: 25.33%
[rank3]:2025-10-29 07:29:26,466 - INFO - Avg. fwd time: 16.7150 / Avg. bwd time: 20.0594 / Avg. batch time: 309.6160 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 07:29:26,539 - INFO - Avg. fwd time: 15.1697 / Avg. bwd time: 5.6028 / Avg. batch time: 414.8645 (ms) / GPU bubble ratio: 59.94%
[rank0]:2025-10-29 07:30:42,254 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:30:43,811 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,542  tflops: 491.68  mfu: 49.71%
[rank3]:2025-10-29 07:30:43,812 - INFO -  step: 2300  loss:  0.2170  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,542  tflops: 491.69  mfu: 49.72%
[rank0]:2025-10-29 07:30:43,813 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,542  tflops: 491.68  mfu: 49.71%
[rank1]:2025-10-29 07:30:43,813 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,542  tflops: 491.68  mfu: 49.72%
[rank1]:2025-10-29 07:30:43,893 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0730_stage1_step2300.svg
[rank2]:2025-10-29 07:30:43,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0730_stage2_step2300.svg
[rank0]:2025-10-29 07:30:43,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0730_stage0_step2300.svg
[rank3]:2025-10-29 07:30:44,001 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0730_real_step2300_rank3.svg
[rank3]:> Batch Time: 372.21 ms, GPU Bubble Ratio: 67.24%, 23.43%, 32.97%, 23.44%
[rank0]:2025-10-29 07:30:43,983 - INFO - Avg. fwd time: 15.1694 / Avg. bwd time: 5.4930 / Avg. batch time: 414.2283 (ms) / GPU bubble ratio: 60.09%
[rank3]:2025-10-29 07:30:44,064 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0730_stage3_step2300.svg
[rank3]:2025-10-29 07:30:44,316 - INFO - Avg. fwd time: 16.7123 / Avg. bwd time: 20.0350 / Avg. batch time: 309.3946 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:30:44,364 - INFO - Avg. fwd time: 17.2867 / Avg. bwd time: 19.3552 / Avg. batch time: 387.4658 (ms) / GPU bubble ratio: 24.35%
[rank2]:2025-10-29 07:30:44,337 - INFO - Avg. fwd time: 15.0493 / Avg. bwd time: 17.0832 / Avg. batch time: 344.2233 (ms) / GPU bubble ratio: 25.32%
[rank0]:2025-10-29 07:32:00,081 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:32:01,649 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank2]:2025-10-29 07:32:01,646 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank3]:2025-10-29 07:32:01,647 - INFO -  step: 2350  loss:  0.2373  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,525  tflops: 490.89  mfu: 49.63%
[rank0]:2025-10-29 07:32:01,648 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,525  tflops: 490.88  mfu: 49.63%
[rank0]:2025-10-29 07:32:01,739 - INFO - Avg. fwd time: 15.1691 / Avg. bwd time: 5.3702 / Avg. batch time: 413.5230 (ms) / GPU bubble ratio: 60.26%
[rank2]:2025-10-29 07:32:01,972 - INFO - Avg. fwd time: 15.0471 / Avg. bwd time: 17.0613 / Avg. batch time: 343.9125 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-10-29 07:32:01,951 - INFO - Avg. fwd time: 16.7088 / Avg. bwd time: 20.0074 / Avg. batch time: 309.1411 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:32:01,998 - INFO - Avg. fwd time: 17.2839 / Avg. bwd time: 19.3310 / Avg. batch time: 387.0072 (ms) / GPU bubble ratio: 24.31%
[rank0]:2025-10-29 07:33:17,746 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:33:19,319 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.75GiB(52.75%)  tps: 10,547  tflops: 491.93  mfu: 49.74%
[rank1]:2025-10-29 07:33:19,319 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,761  tflops: 455.25  mfu: 45.34%
[rank1]:2025-10-29 07:33:19,319 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 07:33:19,317 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.98GiB(47.19%)  tps: 10,547  tflops: 491.92  mfu: 49.74%
[rank2]:2025-10-29 07:33:19,317 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,761  tflops: 455.27  mfu: 45.34%
[rank2]:2025-10-29 07:33:19,317 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 07:33:19,317 - INFO -  step: 2400  loss:  0.2224  grad_norm:  0.0000  memory: 86.40GiB(61.80%)  tps: 10,547  tflops: 491.93  mfu: 49.74%
[rank3]:2025-10-29 07:33:19,318 - INFO -  final step: 2400  loss:  0.2224  grad_norm:  0.0000  tps: 9,764  tflops: 455.40  mfu: 45.35%
[rank3]:2025-10-29 07:33:19,318 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 07:33:19,318 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 75.31GiB(53.87%)  tps: 10,547  tflops: 491.92  mfu: 49.74%
[rank0]:2025-10-29 07:33:19,318 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 9,760  tflops: 455.20  mfu: 45.33%
[rank0]:2025-10-29 07:33:19,319 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 07:33:35,791 - INFO - validate step: 2400  loss: -1.0000  memory: 75.31GiB(53.87%)  tps: 24,866
[rank0]:2025-10-29 07:33:35,792 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 07:33:35,828 - INFO - validate step: 2400  loss: -1.0000  memory: 73.75GiB(52.75%)  tps: 24,812
[rank1]:2025-10-29 07:33:35,829 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 07:33:35,832 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 07:33:35,862 - INFO - validate step: 2400  loss: -1.0000  memory: 65.98GiB(47.19%)  tps: 24,757
[rank2]:2025-10-29 07:33:35,863 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 07:33:35,866 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 07:33:35,797 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 07:33:35,885 - INFO - validate step: 2400  loss:  0.2502  memory: 86.40GiB(61.80%)  tps: 24,725
[rank3]:2025-10-29 07:33:35,886 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 07:33:35,891 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 07:33:45,994 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-29 07:33:46,083 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank0/251029_0733_stage0_final2400.svg
[rank1]:2025-10-29 07:33:46,085 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank1/251029_0733_stage1_final2400.svg
[rank2]:2025-10-29 07:33:46,086 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank2/251029_0733_stage2_final2400.svg
[rank3]:2025-10-29 07:33:46,195 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0733_real_final2400_rank3.svg
[rank3]:> Batch Time: 372.00 ms, GPU Bubble Ratio: 67.24%, 23.42%, 32.94%, 23.43%
[rank1]:2025-10-29 07:33:46,329 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank1_stage1.svg
[rank1]:	> Counts Sum: 190240, Total Sum: 6039360 (3.15%), Ratio(%) per element: [2.14, 2.25, 2.41, 2.36, 2.03, 2.03, 2.52, 2.52, 2.46, 3.11, 2.78, 3.54, 1.98, 2.95, 2.41, 3.0, 3.59, 2.89, 3.43, 3.96, 2.68, 3.54, 3.0, 3.16, 3.11, 3.59, 2.84, 3.64, 3.59, 2.89, 3.0, 3.8, 3.16, 3.64, 2.19, 2.95, 3.75, 3.27, 3.59, 3.48, 3.8, 3.11, 3.05, 3.32, 3.05, 3.7, 4.02, 3.48, 2.89, 3.05, 3.37, 3.8, 3.43, 3.43, 3.54, 3.05, 3.05, 3.11, 3.05, 3.11, 2.84, 3.21, 3.75, 3.32, 3.48, 3.0, 3.48, 3.37, 3.16, 3.48, 3.8, 2.89, 2.78, 3.8, 3.8, 3.27, 3.48, 3.16, 3.27, 2.52, 3.21]
[rank1]:2025-10-29 07:33:46,330 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 07:33:46,370 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/pipeline_schedule/251029_0733_thry_final2400_rank3.svg
[rank3]:> Batch Time: 529.31 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 07:33:46,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank2_stage2.svg
[rank2]:	> Counts Sum: 1416920, Total Sum: 5368320 (26.39%), Ratio(%) per element: [24.35, 24.83, 26.01, 22.31, 26.5, 24.03, 25.1, 24.89, 27.57, 27.14, 26.5, 25.91, 26.5, 26.93, 26.23, 25.53, 26.28, 26.12, 25.64, 26.71, 27.09, 24.83, 27.89, 26.55, 25.26, 25.85, 25.37, 26.44, 25.16, 26.12, 25.75, 28.11, 26.34, 26.23, 27.03, 27.14, 26.18, 26.07, 27.03, 26.18, 27.19, 27.46, 26.6, 28.21, 26.66, 27.25, 24.57, 27.62, 26.39, 27.57, 26.39, 26.55, 27.78, 26.98, 26.93, 27.41, 26.39, 24.94, 26.82, 27.03, 27.25, 28.0, 28.21, 27.25, 27.57, 26.07, 27.62, 24.89, 25.53, 26.5, 26.77, 25.91]
[rank2]:2025-10-29 07:33:46,331 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 07:33:46,321 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank0_stage0.svg
[rank0]:	> Counts Sum: 4610560, Total Sum: 5442880 (84.71%), Ratio(%) per element: [84.71, 84.38, 84.65, 84.49, 84.71, 84.6, 84.44, 84.92, 84.54, 84.6, 84.44, 84.81, 84.6, 84.6, 84.22, 84.6, 84.33, 84.33, 84.54, 84.54, 84.71, 84.33, 84.65, 84.6, 84.44, 84.38, 84.38, 84.33, 84.81, 84.76, 84.97, 84.76, 84.71, 84.71, 84.81, 84.65, 85.03, 85.03, 84.44, 84.54, 84.65, 85.08, 84.87, 84.76, 84.81, 84.44, 84.6, 84.87, 84.76, 84.97, 84.65, 84.81, 84.87, 84.76, 84.87, 84.71, 85.13, 84.71, 84.81, 84.87, 84.97, 84.97, 85.03, 84.6, 84.92, 84.71, 85.19, 84.81, 84.76, 84.76, 84.92, 84.76, 84.87]
[rank0]:2025-10-29 07:33:46,322 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 07:33:46,436 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/freeze_ratio_history/rank3/251029_0733_stage3_final2400.svg
[rank3]:2025-10-29 07:33:46,661 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1/frozen_params_histogram/251029_0733_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.34, 1.77, 1.44, 1.5, 1.34, 1.18, 1.39, 1.39, 1.93, 1.07, 1.66, 1.6, 1.39, 1.39, 1.39, 1.55, 0.91, 1.39, 1.55, 1.55, 1.55, 1.77, 1.23, 1.77, 1.44, 1.34, 1.23, 1.87, 1.98, 1.71, 1.6, 1.77, 1.77, 1.39, 2.09, 2.14, 1.39, 1.82, 1.5, 1.93, 1.71, 1.77, 1.71, 1.34, 1.87, 1.5, 1.87, 1.77, 1.34, 1.87, 1.6, 1.44, 1.23, 1.82, 1.5, 1.77, 1.5, 1.55, 1.6, 1.71, 1.98, 1.55, 1.55, 1.5, 1.66]
[rank3]:2025-10-29 07:33:46,662 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.67797
[rank3]:wandb:               final/avg_loss 0.22237
[rank3]:wandb:             final/avg_mfu(%) 45.3454
[rank3]:wandb:             final/avg_tflops 455.40338
[rank3]:wandb:    final/avg_throughput(tps) 9764.18967
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.22237
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.22237
[rank3]:wandb: loss_metrics/global_max_loss 0.22237
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/l90qbnni
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyauto_dm1/20251029-0621/wandb/run-20251029_062142-l90qbnni/logs
[rank0]:2025-10-29 07:33:48,322 - INFO - Training completed
[rank0]:2025-10-29 07:33:48,322 - INFO - Destroying the purge thread.
[rank1]:2025-10-29 07:33:48,734 - INFO - Process group destroyed
[rank3]:2025-10-29 07:33:48,735 - INFO - Process group destroyed
[rank2]:2025-10-29 07:33:48,771 - INFO - Process group destroyed
[rank0]:2025-10-29 07:33:48,826 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.23', 'layers.19', 'layers.17', 'layers.21', 'layers.20', 'layers.24', 'layers.22'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'layers.2', 'layers.6', 'layers.5', 'layers.7', 'tok_embeddings', 'layers.4', 'layers.3'}
[rank1]:Stage 1: Modules to keep: {'layers.14', 'layers.16', 'layers.11', 'layers.10', 'layers.12', 'layers.15', 'layers.13', 'layers.8', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'layers.27', 'layers.26', 'output', 'layers.30', 'layers.31', 'norm', 'layers.28', 'layers.29'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
âœ… All runs completed. Logs saved in /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b.
