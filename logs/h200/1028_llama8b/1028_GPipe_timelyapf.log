
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 04:50:06 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,6
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] 
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] *****************************************
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 04:50:07.317000 1587084 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 04:50:13,168 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 04:50:13,198 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 04:50:13,332 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 04:50:13,468 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 04:50:14,193 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 04:50:14,195 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:50:14,200 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-29 04:50:14,206 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 04:50:14,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-29 04:50:14,459 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 04:50:14,461 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 04:50:14,470 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 04:50:14,472 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 04:50:16,176 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 04:50:16,470 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 04:50:17,964 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-29 04:50:19,529 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 04:50:19,536 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-29 04:50:19,602 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 04:50:19,602 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:50:19,588 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 04:50:19,661 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 04:50:19,661 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 04:50:19,798 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 04:50:19,849 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-10-29 04:50:19,932 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 04:50:19,932 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-29 04:50:19,873 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 04:50:19,874 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 04:50:19,969 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 04:50:19,969 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 04:50:20,197 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 04:50:20,197 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 7q6bt8ow
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1/20251029-0450/wandb/run-20251029_045020-7q6bt8ow
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/7q6bt8ow
[rank3]:2025-10-29 04:50:21,592 - INFO - WandB logging enabled
[rank3]:2025-10-29 04:50:21,599 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 04:50:21,673 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 04:50:21,674 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 04:50:22,021 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-29 04:50:22,021 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 04:50:22,022 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 04:50:22,017 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-10-29 04:50:22,022 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 04:50:22,005 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 04:50:22,005 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 04:50:22,021 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 04:50:25,472 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 04:50:25,472 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-29 04:50:34,307 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-29 04:50:34,308 - INFO - Finished loading the checkpoint in 8.84 seconds.
[rank0]:2025-10-29 04:50:34,308 - INFO - Training starts at step 1
[rank2]:2025-10-29 04:50:38,791 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 44.28GiB(31.67%)  tps: 853  tflops: 39.77  mfu: 4.02%
[rank2]:2025-10-29 04:50:38,791 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 04:50:38,813 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 49.75GiB(35.58%)  tps: 864  tflops: 40.29  mfu: 4.07%
[rank0]:2025-10-29 04:50:38,813 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 04:50:38,793 - INFO -  step:  1  loss: -4.0000  grad_norm: 142.3625  memory: 49.69GiB(35.54%)  tps: 855  tflops: 39.89  mfu: 4.03%
[rank1]:2025-10-29 04:50:38,794 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 04:50:38,796 - INFO -  step:  1  loss:  8.6949  grad_norm: 142.3625  memory: 58.03GiB(41.50%)  tps: 956  tflops: 44.56  mfu: 4.51%
[rank3]:2025-10-29 04:50:38,796 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,177 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,178 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,179 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 04:50:57,180 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,133 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,134 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,134 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,135 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,136 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,137 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 04:50:57,138 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,265 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,266 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,267 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:50:57,268 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,222 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,222 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,223 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,224 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 04:50:57,225 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 04:52:48,714 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:52:51,454 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 66.72GiB(47.72%)  tps: 6,053  tflops: 282.29  mfu: 28.54%
[rank2]:2025-10-29 04:52:51,447 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 57.29GiB(40.97%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank3]:2025-10-29 04:52:51,451 - INFO -  step: 50  loss:  3.3217  grad_norm: 16.0562  memory: 73.38GiB(52.48%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank1]:2025-10-29 04:52:51,449 - INFO -  step: 50  loss: -4.0000  grad_norm: 16.0562  memory: 64.32GiB(46.00%)  tps: 6,052  tflops: 282.26  mfu: 28.54%
[rank2]:2025-10-29 04:52:51,965 - INFO - Avg. fwd time: 13.4042 / Avg. bwd time: 36.4328 / Avg. batch time: 537.1174 (ms) / GPU bubble ratio: 25.77%
[rank3]:2025-10-29 04:52:51,914 - INFO - Avg. fwd time: 14.8182 / Avg. bwd time: 43.1296 / Avg. batch time: 484.1293 (ms) / GPU bubble ratio: 4.24%
[rank1]:2025-10-29 04:52:52,012 - INFO - Avg. fwd time: 15.2003 / Avg. bwd time: 40.9811 / Avg. batch time: 596.8257 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-10-29 04:52:52,045 - INFO - Avg. fwd time: 14.1636 / Avg. bwd time: 38.2459 / Avg. batch time: 652.3509 (ms) / GPU bubble ratio: 35.73%
[rank3]:2025-10-29 04:53:18,294 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 04:53:46,379 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 04:53:46,595 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 04:53:46,695 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:46,711 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:46,734 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,640 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,664 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,698 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,732 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,675 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,708 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,724 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,759 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,842 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,850 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,802 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,838 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,877 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,916 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,909 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,945 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,887 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,926 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:51,964 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,876 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,914 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:53:51,952 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,954 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 04:53:51,992 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:51,985 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:52,023 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:52,002 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 04:53:52,038 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 04:53:52,061 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 04:54:29,943 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 04:54:30,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_max_batch_time.svg
[rank3]:> Batch Time: 633.30 ms, GPU Bubble Ratio: 33.61%, 28.22%, 36.61%, 26.26%
[rank3]:2025-10-29 04:54:30,430 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_min_batch_time.svg
[rank3]:> Batch Time: 357.73 ms, GPU Bubble Ratio: 68.84%, 24.49%, 33.48%, 23.46%
[rank3]:2025-10-29 04:54:30,637 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 357.73 ms, GPU Bubble Ratio: 32.08%, 23.45%, 28.87%, 23.46%
[rank3]:2025-10-29 04:54:30,638 - INFO - 	> Batch Time: 357.73 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.44)
[rank0]:2025-10-29 04:54:50,499 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.19/0.58, [MB3] 0.00/0.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 04:54:52,147 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,787  tflops: 316.57  mfu: 32.01%
[rank2]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.85, [MB2] 0.28/0.85, [MB3] 0.28/0.85, [MB4] 0.30/0.90, [MB5] 0.31/0.93, [MB6] 0.32/0.97, [MB7] 0.33/1.00
[rank2]:2025-10-29 04:54:52,146 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 6,787  tflops: 316.55  mfu: 32.01%
[rank1]:2025-10-29 04:54:52,146 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.89, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 04:54:52,147 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank3]:2025-10-29 04:54:57,171 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 04:54:57,175 - INFO -  step: 100  loss:  2.6930  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 6,516  tflops: 303.91  mfu: 30.73%
[rank2]:2025-10-29 04:54:57,254 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0454_stage2_step100.svg
[rank0]:2025-10-29 04:54:57,258 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0454_stage0_step100.svg
[rank1]:2025-10-29 04:54:57,258 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0454_stage1_step100.svg
[rank0]:2025-10-29 04:54:57,362 - INFO - Avg. fwd time: 14.6014 / Avg. bwd time: 27.5267 / Avg. batch time: 621.6899 (ms) / GPU bubble ratio: 45.79%
[rank3]:2025-10-29 04:54:57,355 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0454_real_step100_rank3.svg
[rank3]:> Batch Time: 631.99 ms, GPU Bubble Ratio: 33.56%, 28.26%, 36.46%, 26.24%
[rank3]:2025-10-29 04:54:57,414 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0454_stage3_step100.svg
[rank3]:2025-10-29 04:54:57,680 - INFO - Avg. fwd time: 15.5811 / Avg. bwd time: 36.4779 / Avg. batch time: 434.6551 (ms) / GPU bubble ratio: 4.18%
[rank2]:2025-10-29 04:54:57,702 - INFO - Avg. fwd time: 14.0765 / Avg. bwd time: 30.8030 / Avg. batch time: 524.0644 (ms) / GPU bubble ratio: 31.49%
[rank1]:2025-10-29 04:54:57,728 - INFO - Avg. fwd time: 16.0244 / Avg. bwd time: 34.7003 / Avg. batch time: 577.2652 (ms) / GPU bubble ratio: 29.70%
[rank0]:2025-10-29 04:57:03,802 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 04:57:05,850 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.85, [MB2] 0.57/0.85, [MB3] 0.57/0.85, [MB4] 0.60/0.90, [MB5] 0.62/0.93, [MB6] 0.65/0.97, [MB7] 0.67/1.00
[rank2]:2025-10-29 04:57:05,851 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 64.67GiB(46.25%)  tps: 6,127  tflops: 285.76  mfu: 28.89%
[rank0]:2025-10-29 04:57:05,855 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.39/0.58, [MB3] 0.00/0.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 04:57:05,856 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 72.30GiB(51.72%)  tps: 6,127  tflops: 285.75  mfu: 28.89%
[rank1]:2025-10-29 04:57:05,847 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.59/0.89, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 04:57:05,848 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.2547  memory: 72.72GiB(52.01%)  tps: 6,127  tflops: 285.77  mfu: 28.89%
[rank3]:2025-10-29 04:57:10,846 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 04:57:10,850 - INFO -  step: 150  loss:  2.5598  grad_norm:  0.2547  memory: 84.49GiB(60.43%)  tps: 6,128  tflops: 285.83  mfu: 28.90%
[rank3]:2025-10-29 04:57:11,226 - INFO - Avg. fwd time: 15.8546 / Avg. bwd time: 33.3823 / Avg. batch time: 411.0465 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-29 04:57:11,256 - INFO - Avg. fwd time: 14.1822 / Avg. bwd time: 29.3847 / Avg. batch time: 527.7838 (ms) / GPU bubble ratio: 33.96%
[rank1]:2025-10-29 04:57:11,285 - INFO - Avg. fwd time: 16.1824 / Avg. bwd time: 32.7534 / Avg. batch time: 581.3597 (ms) / GPU bubble ratio: 32.66%
[rank0]:2025-10-29 04:57:11,313 - INFO - Avg. fwd time: 14.7105 / Avg. bwd time: 27.3777 / Avg. batch time: 625.8791 (ms) / GPU bubble ratio: 46.20%
[rank0]:2025-10-29 04:59:02,318 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 04:59:04,082 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.58/0.58, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 04:59:04,082 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 73.16GiB(52.33%)  tps: 6,929  tflops: 323.17  mfu: 32.68%
[rank2]:2025-10-29 04:59:04,081 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.85/0.85, [MB2] 0.85/0.85, [MB3] 0.85/0.85, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 04:59:04,082 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 65.92GiB(47.15%)  tps: 6,929  tflops: 323.16  mfu: 32.68%
[rank0]:2025-10-29 04:59:04,082 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 04:59:04,082 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-29 04:59:04,083 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 04:59:04,083 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1116  memory: 73.05GiB(52.25%)  tps: 6,929  tflops: 323.15  mfu: 32.67%
[rank1]:2025-10-29 04:59:04,083 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 04:59:09,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 04:59:09,131 - INFO -  step: 200  loss:  2.5508  grad_norm:  0.1116  memory: 84.49GiB(60.43%)  tps: 6,926  tflops: 323.03  mfu: 32.66%
[rank3]:2025-10-29 04:59:09,131 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 04:59:26,684 - INFO - validate step: 200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,123
[rank1]:2025-10-29 04:59:26,720 - INFO - validate step: 200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,095
[rank3]:2025-10-29 04:59:26,775 - INFO - validate step: 200  loss:  1.0028  memory: 84.49GiB(60.43%)  tps: 23,216
[rank2]:2025-10-29 04:59:26,752 - INFO - validate step: 200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,069
[rank2]:2025-10-29 04:59:26,850 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0459_stage2_step200.svg
[rank0]:2025-10-29 04:59:26,850 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0459_stage0_step200.svg
[rank1]:2025-10-29 04:59:26,846 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0459_stage1_step200.svg
[rank3]:2025-10-29 04:59:26,955 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0459_real_step200_rank3.svg
[rank3]:> Batch Time: 500.57 ms, GPU Bubble Ratio: 30.54%, 26.14%, 35.82%, 29.74%
[rank3]:2025-10-29 04:59:27,018 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0459_stage3_step200.svg
[rank2]:2025-10-29 04:59:27,307 - INFO - Avg. fwd time: 14.3805 / Avg. bwd time: 27.3867 / Avg. batch time: 516.8649 (ms) / GPU bubble ratio: 35.35%
[rank3]:2025-10-29 04:59:27,284 - INFO - Avg. fwd time: 16.0922 / Avg. bwd time: 30.9449 / Avg. batch time: 393.0046 (ms) / GPU bubble ratio: 4.25%
[rank0]:2025-10-29 04:59:27,338 - INFO - Avg. fwd time: 14.9194 / Avg. bwd time: 25.4168 / Avg. batch time: 610.7261 (ms) / GPU bubble ratio: 47.16%
[rank1]:2025-10-29 04:59:27,337 - INFO - Avg. fwd time: 16.4202 / Avg. bwd time: 30.4780 / Avg. batch time: 568.2033 (ms) / GPU bubble ratio: 33.97%
[rank0]:2025-10-29 05:01:07,895 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.85/0.85, [MB2] 0.85/0.85, [MB3] 0.85/0.85, [MB4] 0.90/0.90, [MB5] 0.93/0.93, [MB6] 0.97/0.97, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:01:09,548 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,969  tflops: 371.68  mfu: 37.58%
[rank0]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.58/0.58, [MB3] 0.00/0.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:01:09,548 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,964  tflops: 371.44  mfu: 37.56%
[rank1]:2025-10-29 05:01:09,548 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.89/0.89, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:01:09,549 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,967  tflops: 371.57  mfu: 37.57%
[rank0]:2025-10-29 05:01:09,644 - INFO - Avg. fwd time: 15.1344 / Avg. bwd time: 20.3414 / Avg. batch time: 585.6757 (ms) / GPU bubble ratio: 51.54%
[rank3]:2025-10-29 05:01:14,556 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:01:14,560 - INFO -  step: 250  loss:  2.7088  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,600  tflops: 354.48  mfu: 35.84%
[rank3]:2025-10-29 05:01:14,825 - INFO - Avg. fwd time: 16.3631 / Avg. bwd time: 28.5054 / Avg. batch time: 375.3497 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-10-29 05:01:14,847 - INFO - Avg. fwd time: 14.6373 / Avg. bwd time: 25.0614 / Avg. batch time: 500.0059 (ms) / GPU bubble ratio: 36.48%
[rank1]:2025-10-29 05:01:14,873 - INFO - Avg. fwd time: 16.7162 / Avg. bwd time: 27.9629 / Avg. batch time: 548.3929 (ms) / GPU bubble ratio: 34.82%
[rank0]:2025-10-29 05:02:55,245 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:02:57,029 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank3_trend_line.svg
[rank0]:2025-10-29 05:02:57,072 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank0_trend_line.svg
[rank0]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:02:57,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:02:57,079 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,618  tflops: 355.32  mfu: 35.93%
[rank1]:2025-10-29 05:02:57,059 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank1_trend_line.svg
[rank1]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:02:57,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.94/0.94, [MB2] 0.94/0.94, [MB3] 0.98/0.98, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:02:57,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,618  tflops: 355.32  mfu: 35.93%
[rank2]:2025-10-29 05:02:57,044 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0502_rank2_trend_line.svg
[rank2]:2025-10-29 05:02:57,077 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.77/0.77, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:02:57,080 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.77/0.77, [MB4] 0.81/0.81, [MB5] 0.87/0.87, [MB6] 0.94/0.94, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:02:57,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,618  tflops: 355.31  mfu: 35.93%
[rank3]:2025-10-29 05:02:57,268 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0502_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.06 ms, GPU Bubble Ratio: 36.73%, 23.66%, 32.20%, 24.33%
[rank3]:2025-10-29 05:02:57,269 - INFO - 	> Batch Time: 362.06 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 05:02:57,269 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:03:02,269 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:03:02,273 - INFO -  step: 300  loss:  2.7718  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,606  tflops: 354.72  mfu: 35.87%
[rank0]:2025-10-29 05:03:02,345 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0502_stage0_step300.svg
[rank1]:2025-10-29 05:03:02,342 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0502_stage1_step300.svg
[rank2]:2025-10-29 05:03:02,346 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0502_stage2_step300.svg
[rank3]:2025-10-29 05:03:02,450 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0503_real_step300_rank3.svg
[rank3]:> Batch Time: 432.21 ms, GPU Bubble Ratio: 37.20%, 25.52%, 35.22%, 26.62%
[rank3]:2025-10-29 05:03:02,513 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0503_stage3_step300.svg
[rank3]:2025-10-29 05:03:02,843 - INFO - Avg. fwd time: 16.5328 / Avg. bwd time: 26.8987 / Avg. batch time: 363.6565 (ms) / GPU bubble ratio: 4.46%
[rank0]:2025-10-29 05:03:02,892 - INFO - Avg. fwd time: 15.2667 / Avg. bwd time: 16.7852 / Avg. batch time: 572.9063 (ms) / GPU bubble ratio: 55.24%
[rank1]:2025-10-29 05:03:02,887 - INFO - Avg. fwd time: 16.8963 / Avg. bwd time: 26.2815 / Avg. batch time: 539.2911 (ms) / GPU bubble ratio: 35.95%
[rank2]:2025-10-29 05:03:02,864 - INFO - Avg. fwd time: 14.8055 / Avg. bwd time: 23.5409 / Avg. batch time: 492.9767 (ms) / GPU bubble ratio: 37.77%
[rank0]:2025-10-29 05:04:43,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:04:44,836 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,602  tflops: 354.57  mfu: 35.85%
[rank2]:2025-10-29 05:04:44,836 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,602  tflops: 354.58  mfu: 35.85%
[rank1]:2025-10-29 05:04:44,837 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,602  tflops: 354.57  mfu: 35.85%
[rank0]:2025-10-29 05:04:44,935 - INFO - Avg. fwd time: 15.3488 / Avg. bwd time: 14.5979 / Avg. batch time: 564.0222 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-10-29 05:04:50,004 - INFO -  step: 350  loss:  2.6123  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,604  tflops: 354.67  mfu: 35.86%
[rank2]:2025-10-29 05:04:50,296 - INFO - Avg. fwd time: 14.9093 / Avg. bwd time: 22.6044 / Avg. batch time: 487.6229 (ms) / GPU bubble ratio: 38.45%
[rank3]:2025-10-29 05:04:50,274 - INFO - Avg. fwd time: 16.6401 / Avg. bwd time: 25.9169 / Avg. batch time: 356.5425 (ms) / GPU bubble ratio: 4.51%
[rank1]:2025-10-29 05:04:50,322 - INFO - Avg. fwd time: 17.0111 / Avg. bwd time: 25.2472 / Avg. batch time: 532.6644 (ms) / GPU bubble ratio: 36.53%
[rank0]:2025-10-29 05:06:29,636 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:06:31,397 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank3_trend_line.svg
[rank1]:2025-10-29 05:06:31,431 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank1_trend_line.svg
[rank1]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.68/0.68, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:06:31,434 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank0_trend_line.svg
[rank1]:2025-10-29 05:06:31,443 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank0]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:06:31,442 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank0]:2025-10-29 05:06:31,442 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:06:31,443 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 05:06:31,422 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0506_rank2_trend_line.svg
[rank2]:2025-10-29 05:06:31,440 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.75/0.75, [MB2] 0.75/0.75, [MB3] 0.75/0.75, [MB4] 0.79/0.79, [MB5] 0.86/0.86, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:06:31,443 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,684  tflops: 358.40  mfu: 36.24%
[rank2]:2025-10-29 05:06:31,443 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 05:06:31,630 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0506_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 361.69 ms, GPU Bubble Ratio: 51.69%, 23.68%, 32.09%, 24.32%
[rank3]:2025-10-29 05:06:31,630 - INFO - 	> Batch Time: 361.69 ms (Average Freeze Ratio: 0.73)
[rank3]:2025-10-29 05:06:31,631 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:06:36,635 - INFO -  step: 400  loss:  3.8832  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,683  tflops: 358.32  mfu: 36.23%
[rank3]:2025-10-29 05:06:36,635 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-29 05:06:53,069 - INFO - validate step: 400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,940
[rank0]:2025-10-29 05:06:53,033 - INFO - validate step: 400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,971
[rank2]:2025-10-29 05:06:53,099 - INFO - validate step: 400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,914
[rank3]:2025-10-29 05:06:53,123 - INFO - validate step: 400  loss:  0.9816  memory: 84.49GiB(60.43%)  tps: 24,843
[rank0]:2025-10-29 05:06:53,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0506_stage0_step400.svg
[rank1]:2025-10-29 05:06:53,203 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0506_stage1_step400.svg
[rank2]:2025-10-29 05:06:53,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0506_stage2_step400.svg
[rank0]:2025-10-29 05:06:53,282 - INFO - Avg. fwd time: 15.4048 / Avg. bwd time: 12.6715 / Avg. batch time: 556.9494 (ms) / GPU bubble ratio: 59.67%
[rank3]:2025-10-29 05:06:53,302 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0506_real_step400_rank3.svg
[rank3]:> Batch Time: 381.23 ms, GPU Bubble Ratio: 66.99%, 24.24%, 32.87%, 23.00%
[rank3]:2025-10-29 05:06:53,370 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0506_stage3_step400.svg
[rank3]:2025-10-29 05:06:53,617 - INFO - Avg. fwd time: 16.7146 / Avg. bwd time: 25.0294 / Avg. batch time: 349.9312 (ms) / GPU bubble ratio: 4.57%
[rank1]:2025-10-29 05:06:53,663 - INFO - Avg. fwd time: 17.0950 / Avg. bwd time: 24.3254 / Avg. batch time: 527.5912 (ms) / GPU bubble ratio: 37.19%
[rank2]:2025-10-29 05:06:53,638 - INFO - Avg. fwd time: 14.9881 / Avg. bwd time: 21.7691 / Avg. batch time: 483.6872 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-29 05:08:28,736 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:08:30,273 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,428  tflops: 393.07  mfu: 39.74%
[rank0]:2025-10-29 05:08:30,272 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,425  tflops: 392.93  mfu: 39.73%
[rank2]:2025-10-29 05:08:30,272 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,430  tflops: 393.19  mfu: 39.76%
[rank3]:2025-10-29 05:08:35,268 - INFO -  step: 450  loss:  4.6453  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,020  tflops: 374.06  mfu: 37.82%
[rank2]:2025-10-29 05:08:35,593 - INFO - Avg. fwd time: 14.9950 / Avg. bwd time: 21.0847 / Avg. batch time: 479.3666 (ms) / GPU bubble ratio: 39.79%
[rank3]:2025-10-29 05:08:35,571 - INFO - Avg. fwd time: 16.6989 / Avg. bwd time: 24.2773 / Avg. batch time: 343.6937 (ms) / GPU bubble ratio: 4.62%
[rank0]:2025-10-29 05:08:35,622 - INFO - Avg. fwd time: 15.3948 / Avg. bwd time: 11.1944 / Avg. batch time: 550.1384 (ms) / GPU bubble ratio: 61.33%
[rank1]:2025-10-29 05:08:35,616 - INFO - Avg. fwd time: 17.1019 / Avg. bwd time: 23.5811 / Avg. batch time: 522.3509 (ms) / GPU bubble ratio: 37.69%
[rank0]:2025-10-29 05:10:10,565 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:10:12,076 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank2]:2025-10-29 05:10:12,076 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank1]:2025-10-29 05:10:12,077 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank3]:2025-10-29 05:10:17,077 - INFO -  step: 500  loss:  4.9675  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,047  tflops: 375.30  mfu: 37.95%
[rank0]:2025-10-29 05:10:17,151 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0510_stage0_step500.svg
[rank2]:2025-10-29 05:10:17,152 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0510_stage2_step500.svg
[rank1]:2025-10-29 05:10:17,149 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0510_stage1_step500.svg
[rank0]:2025-10-29 05:10:17,240 - INFO - Avg. fwd time: 15.3847 / Avg. bwd time: 10.1776 / Avg. batch time: 544.6012 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-10-29 05:10:17,263 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0510_real_step500_rank3.svg
[rank3]:> Batch Time: 378.57 ms, GPU Bubble Ratio: 67.02%, 24.18%, 33.02%, 23.14%
[rank3]:2025-10-29 05:10:17,326 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0510_stage3_step500.svg
[rank3]:2025-10-29 05:10:17,566 - INFO - Avg. fwd time: 16.6846 / Avg. bwd time: 23.7541 / Avg. batch time: 339.3274 (ms) / GPU bubble ratio: 4.66%
[rank2]:2025-10-29 05:10:17,587 - INFO - Avg. fwd time: 14.9992 / Avg. bwd time: 20.6121 / Avg. batch time: 475.5602 (ms) / GPU bubble ratio: 40.09%
[rank1]:2025-10-29 05:10:17,611 - INFO - Avg. fwd time: 17.1026 / Avg. bwd time: 23.0641 / Avg. batch time: 517.8970 (ms) / GPU bubble ratio: 37.95%
[rank0]:2025-10-29 05:11:52,652 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:11:54,176 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank2]:2025-10-29 05:11:54,175 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank0]:2025-10-29 05:11:54,175 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,024  tflops: 374.22  mfu: 37.84%
[rank0]:2025-10-29 05:11:54,261 - INFO - Avg. fwd time: 15.3758 / Avg. bwd time: 9.2024 / Avg. batch time: 537.8715 (ms) / GPU bubble ratio: 63.44%
[rank3]:2025-10-29 05:11:59,182 - INFO -  step: 550  loss:  4.7758  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,023  tflops: 374.21  mfu: 37.84%
[rank3]:2025-10-29 05:11:59,422 - INFO - Avg. fwd time: 16.6718 / Avg. bwd time: 23.2544 / Avg. batch time: 335.1642 (ms) / GPU bubble ratio: 4.70%
[rank2]:2025-10-29 05:11:59,443 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 20.1596 / Avg. batch time: 470.4947 (ms) / GPU bubble ratio: 40.21%
[rank1]:2025-10-29 05:11:59,467 - INFO - Avg. fwd time: 17.1015 / Avg. bwd time: 22.5668 / Avg. batch time: 512.2052 (ms) / GPU bubble ratio: 38.04%
[rank0]:2025-10-29 05:13:34,476 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:13:36,285 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank3_trend_line.svg
[rank1]:2025-10-29 05:13:36,316 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank1_trend_line.svg
[rank1]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.97/0.97, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:13:36,331 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank1]:2025-10-29 05:13:36,332 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 05:13:36,299 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank2_trend_line.svg
[rank2]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.74/0.74, [MB4] 0.78/0.78, [MB5] 0.85/0.85, [MB6] 0.93/0.93, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:13:36,332 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank2]:2025-10-29 05:13:36,332 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 05:13:36,323 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0513_rank0_trend_line.svg
[rank0]:2025-10-29 05:13:36,328 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 05:13:36,331 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,019  tflops: 374.02  mfu: 37.82%
[rank0]:2025-10-29 05:13:36,331 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 05:13:36,521 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0513_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.83 ms, GPU Bubble Ratio: 59.29%, 24.52%, 30.24%, 23.86%
[rank3]:2025-10-29 05:13:36,521 - INFO - 	> Batch Time: 355.83 ms (Average Freeze Ratio: 0.70)
[rank3]:2025-10-29 05:13:36,521 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:13:41,545 - INFO -  step: 600  loss:  4.6548  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,003  tflops: 373.27  mfu: 37.74%
[rank3]:2025-10-29 05:13:41,545 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 05:13:57,856 - INFO - validate step: 600  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,029
[rank2]:2025-10-29 05:13:57,923 - INFO - validate step: 600  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,971
[rank1]:2025-10-29 05:13:57,893 - INFO - validate step: 600  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,997
[rank3]:2025-10-29 05:13:57,947 - INFO - validate step: 600  loss:  1.0068  memory: 84.49GiB(60.43%)  tps: 24,974
[rank0]:2025-10-29 05:13:58,021 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0513_stage0_step600.svg
[rank2]:2025-10-29 05:13:58,020 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0513_stage2_step600.svg
[rank1]:2025-10-29 05:13:58,022 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0513_stage1_step600.svg
[rank3]:2025-10-29 05:13:58,132 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0513_real_step600_rank3.svg
[rank3]:> Batch Time: 376.58 ms, GPU Bubble Ratio: 67.04%, 24.15%, 32.98%, 23.20%
[rank3]:2025-10-29 05:13:58,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0513_stage3_step600.svg
[rank3]:2025-10-29 05:13:58,506 - INFO - Avg. fwd time: 16.6603 / Avg. bwd time: 22.8414 / Avg. batch time: 331.7157 (ms) / GPU bubble ratio: 4.73%
[rank0]:2025-10-29 05:13:58,559 - INFO - Avg. fwd time: 15.3674 / Avg. bwd time: 8.3979 / Avg. batch time: 534.3406 (ms) / GPU bubble ratio: 64.42%
[rank2]:2025-10-29 05:13:58,528 - INFO - Avg. fwd time: 15.0054 / Avg. bwd time: 19.7847 / Avg. batch time: 468.3353 (ms) / GPU bubble ratio: 40.57%
[rank1]:2025-10-29 05:13:58,552 - INFO - Avg. fwd time: 17.1002 / Avg. bwd time: 22.1557 / Avg. batch time: 509.5316 (ms) / GPU bubble ratio: 38.37%
[rank0]:2025-10-29 05:16:09,906 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:16:12,212 - INFO -  step: 650  loss: -4.0000  grad_norm:  7.2121  memory: 73.16GiB(52.33%)  tps: 6,097  tflops: 284.38  mfu: 28.75%
[rank1]:2025-10-29 05:16:12,187 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 6,100  tflops: 284.51  mfu: 28.77%
[rank2]:2025-10-29 05:16:12,186 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 6,101  tflops: 284.57  mfu: 28.77%
[rank3]:2025-10-29 05:16:17,207 - INFO -  step: 650  loss:  4.1732  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,883  tflops: 274.37  mfu: 27.74%
[rank2]:2025-10-29 05:16:17,471 - INFO - Avg. fwd time: 15.0057 / Avg. bwd time: 19.5121 / Avg. batch time: 467.3687 (ms) / GPU bubble ratio: 40.92%
[rank3]:2025-10-29 05:16:17,451 - INFO - Avg. fwd time: 16.6471 / Avg. bwd time: 22.5361 / Avg. batch time: 329.1287 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-10-29 05:16:17,531 - INFO - Avg. fwd time: 17.0904 / Avg. bwd time: 21.8443 / Avg. batch time: 512.4064 (ms) / GPU bubble ratio: 39.21%
[rank0]:2025-10-29 05:16:17,649 - INFO - Avg. fwd time: 15.2517 / Avg. bwd time: 10.4847 / Avg. batch time: 543.4905 (ms) / GPU bubble ratio: 62.12%
[rank0]:2025-10-29 05:18:28,838 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:18:31,152 - INFO -  step: 700  loss: -4.0000  grad_norm: 33.6212  memory: 73.16GiB(52.33%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank1]:2025-10-29 05:18:31,126 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank2]:2025-10-29 05:18:31,126 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,896  tflops: 275.00  mfu: 27.81%
[rank3]:2025-10-29 05:18:36,128 - INFO -  step: 700  loss:  3.9439  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,897  tflops: 275.04  mfu: 27.81%
[rank0]:2025-10-29 05:18:36,206 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0518_stage0_step700.svg
[rank1]:2025-10-29 05:18:36,207 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0518_stage1_step700.svg
[rank2]:2025-10-29 05:18:36,207 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0518_stage2_step700.svg
[rank3]:2025-10-29 05:18:36,313 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0518_real_step700_rank3.svg
[rank3]:> Batch Time: 374.19 ms, GPU Bubble Ratio: 67.13%, 24.08%, 32.89%, 23.23%
[rank3]:2025-10-29 05:18:36,379 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0518_stage3_step700.svg
[rank3]:2025-10-29 05:18:36,621 - INFO - Avg. fwd time: 16.6288 / Avg. bwd time: 22.2238 / Avg. batch time: 326.4425 (ms) / GPU bubble ratio: 4.79%
[rank1]:2025-10-29 05:18:36,701 - INFO - Avg. fwd time: 17.0778 / Avg. bwd time: 21.5289 / Avg. batch time: 515.7803 (ms) / GPU bubble ratio: 40.12%
[rank2]:2025-10-29 05:18:36,642 - INFO - Avg. fwd time: 15.0029 / Avg. bwd time: 19.2355 / Avg. batch time: 466.8967 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 05:18:36,821 - INFO - Avg. fwd time: 15.1317 / Avg. bwd time: 12.5759 / Avg. batch time: 553.1476 (ms) / GPU bubble ratio: 59.93%
[rank0]:2025-10-29 05:20:48,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:20:50,614 - INFO -  step: 750  loss: -4.0000  grad_norm: 16.3697  memory: 73.16GiB(52.33%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank1]:2025-10-29 05:20:50,588 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank2]:2025-10-29 05:20:50,588 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,874  tflops: 273.96  mfu: 27.70%
[rank3]:2025-10-29 05:20:55,617 - INFO -  step: 750  loss:  3.7923  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,873  tflops: 273.92  mfu: 27.70%
[rank3]:2025-10-29 05:20:55,928 - INFO - Avg. fwd time: 16.6127 / Avg. bwd time: 21.9561 / Avg. batch time: 324.1366 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-29 05:20:55,957 - INFO - Avg. fwd time: 14.9998 / Avg. bwd time: 18.9986 / Avg. batch time: 466.6563 (ms) / GPU bubble ratio: 41.72%
[rank1]:2025-10-29 05:20:56,037 - INFO - Avg. fwd time: 17.0643 / Avg. bwd time: 21.2574 / Avg. batch time: 518.8427 (ms) / GPU bubble ratio: 40.91%
[rank0]:2025-10-29 05:20:56,138 - INFO - Avg. fwd time: 15.0268 / Avg. bwd time: 14.3733 / Avg. batch time: 561.6126 (ms) / GPU bubble ratio: 58.12%
[rank0]:2025-10-29 05:23:07,192 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:23:09,815 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank3_trend_line.svg
[rank2]:2025-10-29 05:23:09,832 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank2_trend_line.svg
[rank1]:2025-10-29 05:23:09,826 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank1_trend_line.svg
[rank0]:2025-10-29 05:23:09,908 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0523_rank0_trend_line.svg
[rank0]:2025-10-29 05:23:09,914 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:23:09,916 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.2241  memory: 73.16GiB(52.33%)  tps: 5,881  tflops: 274.28  mfu: 27.73%
[rank0]:2025-10-29 05:23:09,917 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 05:23:09,915 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.71/0.71, [MB1] 0.71/0.71, [MB2] 0.71/0.71, [MB3] 0.71/0.71, [MB4] 0.75/0.75, [MB5] 0.83/0.83, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:23:09,918 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 5,880  tflops: 274.22  mfu: 27.73%
[rank1]:2025-10-29 05:23:09,914 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.93/0.93, [MB1] 0.93/0.93, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:23:09,919 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-29 05:23:09,917 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 5,880  tflops: 274.23  mfu: 27.73%
[rank1]:2025-10-29 05:23:09,918 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 05:23:10,105 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0523_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 354.33 ms, GPU Bubble Ratio: 35.28%, 24.58%, 30.27%, 23.95%
[rank3]:2025-10-29 05:23:10,105 - INFO - 	> Batch Time: 354.33 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 05:23:10,106 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:23:15,151 - INFO -  step: 800  loss:  3.7652  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 5,871  tflops: 273.83  mfu: 27.69%
[rank3]:2025-10-29 05:23:15,152 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 05:23:31,493 - INFO - validate step: 800  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 18,984
[rank2]:2025-10-29 05:23:31,553 - INFO - validate step: 800  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 18,933
[rank1]:2025-10-29 05:23:31,524 - INFO - validate step: 800  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 18,957
[rank3]:2025-10-29 05:23:31,577 - INFO - validate step: 800  loss:  0.9155  memory: 84.49GiB(60.43%)  tps: 24,939
[rank0]:2025-10-29 05:23:31,658 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0523_stage0_step800.svg
[rank2]:2025-10-29 05:23:31,661 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0523_stage2_step800.svg
[rank1]:2025-10-29 05:23:31,659 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0523_stage1_step800.svg
[rank3]:2025-10-29 05:23:31,764 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0523_real_step800_rank3.svg
[rank3]:> Batch Time: 371.94 ms, GPU Bubble Ratio: 67.20%, 23.96%, 32.75%, 23.30%
[rank3]:2025-10-29 05:23:31,832 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0523_stage3_step800.svg
[rank3]:2025-10-29 05:23:32,080 - INFO - Avg. fwd time: 16.5996 / Avg. bwd time: 21.7534 / Avg. batch time: 322.3837 (ms) / GPU bubble ratio: 4.83%
[rank2]:2025-10-29 05:23:32,103 - INFO - Avg. fwd time: 14.9967 / Avg. bwd time: 18.8190 / Avg. batch time: 465.8926 (ms) / GPU bubble ratio: 41.93%
[rank1]:2025-10-29 05:23:32,160 - INFO - Avg. fwd time: 17.0536 / Avg. bwd time: 21.0521 / Avg. batch time: 520.5569 (ms) / GPU bubble ratio: 41.44%
[rank0]:2025-10-29 05:23:32,276 - INFO - Avg. fwd time: 14.9466 / Avg. bwd time: 15.7229 / Avg. batch time: 567.3791 (ms) / GPU bubble ratio: 56.76%
[rank0]:2025-10-29 05:25:07,486 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:25:09,030 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,399  tflops: 391.73  mfu: 39.61%
[rank2]:2025-10-29 05:25:09,030 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,404  tflops: 391.97  mfu: 39.63%
[rank1]:2025-10-29 05:25:09,031 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank0]:2025-10-29 05:25:09,115 - INFO - Avg. fwd time: 14.9540 / Avg. bwd time: 14.9761 / Avg. batch time: 562.6968 (ms) / GPU bubble ratio: 57.45%
[rank3]:2025-10-29 05:25:13,991 - INFO -  step: 850  loss:  3.8260  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,999  tflops: 373.08  mfu: 37.72%
[rank3]:2025-10-29 05:25:14,229 - INFO - Avg. fwd time: 16.5932 / Avg. bwd time: 21.5561 / Avg. batch time: 320.7294 (ms) / GPU bubble ratio: 4.84%
[rank2]:2025-10-29 05:25:14,249 - INFO - Avg. fwd time: 14.9955 / Avg. bwd time: 18.6380 / Avg. batch time: 463.3525 (ms) / GPU bubble ratio: 41.93%
[rank1]:2025-10-29 05:25:14,273 - INFO - Avg. fwd time: 17.0523 / Avg. bwd time: 20.8562 / Avg. batch time: 517.2129 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 05:26:48,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:26:50,483 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank2]:2025-10-29 05:26:50,483 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank1]:2025-10-29 05:26:50,484 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,075  tflops: 376.60  mfu: 38.08%
[rank3]:2025-10-29 05:26:55,471 - INFO -  step: 900  loss:  3.8683  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,073  tflops: 376.51  mfu: 38.07%
[rank0]:2025-10-29 05:26:55,543 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0526_stage0_step900.svg
[rank2]:2025-10-29 05:26:55,543 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0526_stage2_step900.svg
[rank1]:2025-10-29 05:26:55,547 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0526_stage1_step900.svg
[rank3]:2025-10-29 05:26:55,653 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0526_real_step900_rank3.svg
[rank3]:> Batch Time: 370.61 ms, GPU Bubble Ratio: 67.13%, 23.88%, 32.67%, 23.33%
[rank3]:2025-10-29 05:26:55,713 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0526_stage3_step900.svg
[rank3]:2025-10-29 05:26:56,017 - INFO - Avg. fwd time: 16.5865 / Avg. bwd time: 21.3793 / Avg. batch time: 319.2394 (ms) / GPU bubble ratio: 4.86%
[rank2]:2025-10-29 05:26:56,040 - INFO - Avg. fwd time: 14.9936 / Avg. bwd time: 18.4765 / Avg. batch time: 462.2641 (ms) / GPU bubble ratio: 42.08%
[rank0]:2025-10-29 05:26:56,071 - INFO - Avg. fwd time: 14.9673 / Avg. bwd time: 14.1030 / Avg. batch time: 558.8200 (ms) / GPU bubble ratio: 58.38%
[rank1]:2025-10-29 05:26:56,065 - INFO - Avg. fwd time: 17.0480 / Avg. bwd time: 20.6807 / Avg. batch time: 515.0676 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:28:30,921 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:28:32,448 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank2]:2025-10-29 05:28:32,447 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank0]:2025-10-29 05:28:32,447 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,034  tflops: 374.72  mfu: 37.89%
[rank0]:2025-10-29 05:28:32,534 - INFO - Avg. fwd time: 14.9774 / Avg. bwd time: 13.4317 / Avg. batch time: 555.5093 (ms) / GPU bubble ratio: 59.09%
[rank3]:2025-10-29 05:28:37,508 - INFO -  step: 950  loss:  3.8264  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,029  tflops: 374.46  mfu: 37.86%
[rank3]:2025-10-29 05:28:37,751 - INFO - Avg. fwd time: 16.5824 / Avg. bwd time: 21.2446 / Avg. batch time: 318.1128 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 05:28:37,771 - INFO - Avg. fwd time: 14.9922 / Avg. bwd time: 18.3529 / Avg. batch time: 461.0981 (ms) / GPU bubble ratio: 42.15%
[rank1]:2025-10-29 05:28:37,796 - INFO - Avg. fwd time: 17.0451 / Avg. bwd time: 20.5457 / Avg. batch time: 513.0890 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 05:30:12,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:30:14,277 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank1]:2025-10-29 05:30:14,277 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 05:30:14,276 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank2]:2025-10-29 05:30:14,277 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 05:30:14,276 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,045  tflops: 375.21  mfu: 37.94%
[rank0]:2025-10-29 05:30:14,276 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 05:30:19,301 - INFO -  step: 1000  loss:  3.8363  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,048  tflops: 375.36  mfu: 37.95%
[rank3]:2025-10-29 05:30:19,301 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 05:30:35,637 - INFO - validate step: 1000  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,176
[rank1]:2025-10-29 05:30:35,674 - INFO - validate step: 1000  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,143
[rank2]:2025-10-29 05:30:35,707 - INFO - validate step: 1000  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,113
[rank3]:2025-10-29 05:30:35,729 - INFO - validate step: 1000  loss:  0.9211  memory: 84.49GiB(60.43%)  tps: 24,935
[rank1]:2025-10-29 05:30:35,807 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0530_stage1_step1000.svg
[rank2]:2025-10-29 05:30:35,805 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0530_stage2_step1000.svg
[rank0]:2025-10-29 05:30:35,807 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0530_stage0_step1000.svg
[rank0]:2025-10-29 05:30:35,895 - INFO - Avg. fwd time: 14.9870 / Avg. bwd time: 12.7252 / Avg. batch time: 552.4260 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-29 05:30:35,915 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0530_real_step1000_rank3.svg
[rank3]:> Batch Time: 369.64 ms, GPU Bubble Ratio: 67.07%, 23.88%, 32.64%, 23.32%
[rank3]:2025-10-29 05:30:35,978 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0530_stage3_step1000.svg
[rank2]:2025-10-29 05:30:36,242 - INFO - Avg. fwd time: 14.9898 / Avg. bwd time: 18.2213 / Avg. batch time: 460.2764 (ms) / GPU bubble ratio: 42.28%
[rank3]:2025-10-29 05:30:36,222 - INFO - Avg. fwd time: 16.5767 / Avg. bwd time: 21.1010 / Avg. batch time: 316.9003 (ms) / GPU bubble ratio: 4.88%
[rank1]:2025-10-29 05:30:36,267 - INFO - Avg. fwd time: 17.0401 / Avg. bwd time: 20.4013 / Avg. batch time: 511.4080 (ms) / GPU bubble ratio: 41.43%
[rank0]:2025-10-29 05:32:11,959 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:32:13,503 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,374  tflops: 390.56  mfu: 39.49%
[rank2]:2025-10-29 05:32:13,503 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,377  tflops: 390.69  mfu: 39.50%
[rank0]:2025-10-29 05:32:13,502 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,371  tflops: 390.41  mfu: 39.48%
[rank3]:2025-10-29 05:32:18,490 - INFO -  step: 1050  loss:  3.8104  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank3]:2025-10-29 05:32:18,803 - INFO - Avg. fwd time: 16.5726 / Avg. bwd time: 20.9736 / Avg. batch time: 315.8324 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 05:32:18,827 - INFO - Avg. fwd time: 14.9882 / Avg. bwd time: 18.1038 / Avg. batch time: 459.7187 (ms) / GPU bubble ratio: 42.41%
[rank1]:2025-10-29 05:32:18,853 - INFO - Avg. fwd time: 17.0373 / Avg. bwd time: 20.2733 / Avg. batch time: 510.0793 (ms) / GPU bubble ratio: 41.48%
[rank0]:2025-10-29 05:32:18,860 - INFO - Avg. fwd time: 14.9969 / Avg. bwd time: 12.0892 / Avg. batch time: 549.8369 (ms) / GPU bubble ratio: 60.59%
[rank0]:2025-10-29 05:33:53,761 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:33:55,300 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank1]:2025-10-29 05:33:55,301 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank0]:2025-10-29 05:33:55,300 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.33  mfu: 37.95%
[rank3]:2025-10-29 05:34:00,223 - INFO -  step: 1100  loss:  3.8420  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,053  tflops: 375.58  mfu: 37.98%
[rank1]:2025-10-29 05:34:00,299 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0533_stage1_step1100.svg
[rank0]:2025-10-29 05:34:00,302 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0533_stage0_step1100.svg
[rank2]:2025-10-29 05:34:00,298 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0533_stage2_step1100.svg
[rank0]:2025-10-29 05:34:00,389 - INFO - Avg. fwd time: 15.0043 / Avg. bwd time: 11.5927 / Avg. batch time: 547.3473 (ms) / GPU bubble ratio: 61.13%
[rank3]:2025-10-29 05:34:00,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0534_real_step1100_rank3.svg
[rank3]:> Batch Time: 368.94 ms, GPU Bubble Ratio: 67.03%, 23.87%, 32.60%, 23.32%
[rank3]:2025-10-29 05:34:00,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0534_stage3_step1100.svg
[rank3]:2025-10-29 05:34:00,713 - INFO - Avg. fwd time: 16.5677 / Avg. bwd time: 20.8710 / Avg. batch time: 314.9593 (ms) / GPU bubble ratio: 4.91%
[rank1]:2025-10-29 05:34:00,759 - INFO - Avg. fwd time: 17.0345 / Avg. bwd time: 20.1733 / Avg. batch time: 508.5746 (ms) / GPU bubble ratio: 41.47%
[rank2]:2025-10-29 05:34:00,734 - INFO - Avg. fwd time: 14.9876 / Avg. bwd time: 18.0130 / Avg. batch time: 458.8139 (ms) / GPU bubble ratio: 42.46%
[rank0]:2025-10-29 05:35:35,138 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank1]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank2]:2025-10-29 05:35:36,690 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,080  tflops: 376.84  mfu: 38.10%
[rank0]:2025-10-29 05:35:36,776 - INFO - Avg. fwd time: 15.0118 / Avg. bwd time: 11.0626 / Avg. batch time: 543.8555 (ms) / GPU bubble ratio: 61.65%
[rank3]:2025-10-29 05:35:41,635 - INFO -  step: 1150  loss:  3.7717  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,078  tflops: 376.76  mfu: 38.10%
[rank2]:2025-10-29 05:35:41,903 - INFO - Avg. fwd time: 14.9868 / Avg. bwd time: 17.9156 / Avg. batch time: 457.0153 (ms) / GPU bubble ratio: 42.40%
[rank3]:2025-10-29 05:35:41,883 - INFO - Avg. fwd time: 16.5617 / Avg. bwd time: 20.7603 / Avg. batch time: 314.0125 (ms) / GPU bubble ratio: 4.92%
[rank1]:2025-10-29 05:35:41,928 - INFO - Avg. fwd time: 17.0315 / Avg. bwd time: 20.0659 / Avg. batch time: 506.1352 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 05:37:16,739 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank1]:2025-10-29 05:37:18,304 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank0]:2025-10-29 05:37:18,303 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 05:37:18,303 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,062  tflops: 376.01  mfu: 38.02%
[rank2]:2025-10-29 05:37:18,303 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 05:37:23,329 - INFO -  step: 1200  loss:  3.7816  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,056  tflops: 375.72  mfu: 37.99%
[rank3]:2025-10-29 05:37:23,329 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 05:37:39,691 - INFO - validate step: 1200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,151
[rank0]:2025-10-29 05:37:39,692 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 05:37:39,695 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-29 05:37:39,757 - INFO - validate step: 1200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,093
[rank2]:2025-10-29 05:37:39,757 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 05:37:39,729 - INFO - validate step: 1200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,118
[rank1]:2025-10-29 05:37:39,730 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 05:37:39,780 - INFO - validate step: 1200  loss:  0.9170  memory: 84.49GiB(60.43%)  tps: 24,899
[rank3]:2025-10-29 05:37:39,781 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 05:37:50,376 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.62 seconds.
[rank3]:2025-10-29 05:37:52,346 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.57 seconds.
[rank0]:2025-10-29 05:37:53,799 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 05:37:53,807 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.12 seconds.
[rank1]:2025-10-29 05:37:55,828 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.10 seconds.
[rank2]:2025-10-29 05:37:55,936 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0537_stage2_step1200.svg
[rank2]:2025-10-29 05:37:55,948 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 05:37:55,939 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0537_stage1_step1200.svg
[rank1]:2025-10-29 05:37:55,952 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 05:37:56,037 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0537_stage0_step1200.svg
[rank0]:2025-10-29 05:37:56,048 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 05:37:56,154 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0537_real_step1200_rank3.svg
[rank3]:> Batch Time: 368.35 ms, GPU Bubble Ratio: 67.00%, 23.86%, 32.57%, 23.31%
[rank3]:2025-10-29 05:37:56,230 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0537_stage3_step1200.svg
[rank3]:2025-10-29 05:37:56,245 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 05:37:57,438 - INFO - Avg. fwd time: 16.5588 / Avg. bwd time: 20.6637 / Avg. batch time: 313.3859 (ms) / GPU bubble ratio: 4.98%
[rank0]:2025-10-29 05:37:57,505 - INFO - Avg. fwd time: 15.0208 / Avg. bwd time: 10.5788 / Avg. batch time: 541.9934 (ms) / GPU bubble ratio: 62.21%
[rank2]:2025-10-29 05:37:57,466 - INFO - Avg. fwd time: 14.9867 / Avg. bwd time: 17.8279 / Avg. batch time: 456.6920 (ms) / GPU bubble ratio: 42.52%
[rank1]:2025-10-29 05:37:57,493 - INFO - Avg. fwd time: 17.0304 / Avg. bwd time: 19.9690 / Avg. batch time: 505.2260 (ms) / GPU bubble ratio: 41.41%
[rank0]:2025-10-29 05:39:39,301 - INFO - [GC] Peforming periodical GC collection 2.07 seconds
[rank0]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 6,755  tflops: 315.06  mfu: 31.86%
[rank2]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 6,759  tflops: 315.23  mfu: 31.87%
[rank1]:2025-10-29 05:39:40,962 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 6,757  tflops: 315.16  mfu: 31.87%
[rank0]:2025-10-29 05:39:41,061 - INFO - Avg. fwd time: 15.0510 / Avg. bwd time: 10.1967 / Avg. batch time: 540.4975 (ms) / GPU bubble ratio: 62.63%
[rank3]:2025-10-29 05:39:46,077 - INFO -  step: 1250  loss:  2.5470  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 6,486  tflops: 302.53  mfu: 30.59%
[rank3]:2025-10-29 05:39:46,345 - INFO - Avg. fwd time: 16.5869 / Avg. bwd time: 20.6155 / Avg. batch time: 313.2147 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:39:46,366 - INFO - Avg. fwd time: 15.0086 / Avg. bwd time: 17.7753 / Avg. batch time: 456.3691 (ms) / GPU bubble ratio: 42.53%
[rank1]:2025-10-29 05:39:46,391 - INFO - Avg. fwd time: 17.0550 / Avg. bwd time: 19.9102 / Avg. batch time: 504.4686 (ms) / GPU bubble ratio: 41.38%
[rank0]:2025-10-29 05:41:27,003 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank2]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank0]:2025-10-29 05:41:28,651 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,607  tflops: 354.80  mfu: 35.87%
[rank3]:2025-10-29 05:41:33,748 - INFO -  step: 1300  loss:  2.6334  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,608  tflops: 354.86  mfu: 35.88%
[rank2]:2025-10-29 05:41:33,829 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0541_stage2_step1300.svg
[rank1]:2025-10-29 05:41:33,827 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0541_stage1_step1300.svg
[rank0]:2025-10-29 05:41:33,829 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0541_stage0_step1300.svg
[rank3]:2025-10-29 05:41:33,933 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0541_real_step1300_rank3.svg
[rank3]:> Batch Time: 369.50 ms, GPU Bubble Ratio: 67.01%, 23.86%, 32.62%, 23.33%
[rank0]:2025-10-29 05:41:33,929 - INFO - Avg. fwd time: 15.0832 / Avg. bwd time: 9.7843 / Avg. batch time: 539.4374 (ms) / GPU bubble ratio: 63.12%
[rank3]:2025-10-29 05:41:33,998 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0541_stage3_step1300.svg
[rank3]:2025-10-29 05:41:34,269 - INFO - Avg. fwd time: 16.6177 / Avg. bwd time: 20.5644 / Avg. batch time: 313.0421 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:41:34,290 - INFO - Avg. fwd time: 15.0323 / Avg. bwd time: 17.7185 / Avg. batch time: 456.5780 (ms) / GPU bubble ratio: 42.62%
[rank1]:2025-10-29 05:41:34,316 - INFO - Avg. fwd time: 17.0818 / Avg. bwd time: 19.8462 / Avg. batch time: 504.2087 (ms) / GPU bubble ratio: 41.41%
[rank0]:2025-10-29 05:43:14,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:43:16,197 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank2]:2025-10-29 05:43:16,196 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank0]:2025-10-29 05:43:16,196 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,617  tflops: 355.27  mfu: 35.92%
[rank3]:2025-10-29 05:43:21,211 - INFO -  step: 1350  loss:  2.5469  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,623  tflops: 355.55  mfu: 35.95%
[rank3]:2025-10-29 05:43:21,550 - INFO - Avg. fwd time: 16.6451 / Avg. bwd time: 20.5164 / Avg. batch time: 312.8668 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:43:21,603 - INFO - Avg. fwd time: 17.1060 / Avg. bwd time: 19.7871 / Avg. batch time: 503.9248 (ms) / GPU bubble ratio: 41.43%
[rank2]:2025-10-29 05:43:21,575 - INFO - Avg. fwd time: 15.0532 / Avg. bwd time: 17.6651 / Avg. batch time: 456.7267 (ms) / GPU bubble ratio: 42.69%
[rank0]:2025-10-29 05:43:21,612 - INFO - Avg. fwd time: 15.1123 / Avg. bwd time: 9.4040 / Avg. batch time: 538.4160 (ms) / GPU bubble ratio: 63.57%
[rank0]:2025-10-29 05:45:02,175 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank1]:2025-10-29 05:45:03,825 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank2]:2025-10-29 05:45:03,824 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 05:45:03,824 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,611  tflops: 355.00  mfu: 35.89%
[rank0]:2025-10-29 05:45:03,824 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 05:45:08,889 - INFO -  step: 1400  loss:  2.4903  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,608  tflops: 354.84  mfu: 35.88%
[rank3]:2025-10-29 05:45:08,890 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-29 05:45:25,279 - INFO - validate step: 1400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,092
[rank2]:2025-10-29 05:45:25,309 - INFO - validate step: 1400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,065
[rank0]:2025-10-29 05:45:25,241 - INFO - validate step: 1400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,125
[rank3]:2025-10-29 05:45:25,333 - INFO - validate step: 1400  loss:  0.9176  memory: 84.49GiB(60.43%)  tps: 24,911
[rank0]:2025-10-29 05:45:25,415 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0545_stage0_step1400.svg
[rank1]:2025-10-29 05:45:25,416 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0545_stage1_step1400.svg
[rank2]:2025-10-29 05:45:25,416 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0545_stage2_step1400.svg
[rank0]:2025-10-29 05:45:25,516 - INFO - Avg. fwd time: 15.1352 / Avg. bwd time: 9.1008 / Avg. batch time: 537.3760 (ms) / GPU bubble ratio: 63.92%
[rank3]:2025-10-29 05:45:25,515 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0545_real_step1400_rank3.svg
[rank3]:> Batch Time: 370.61 ms, GPU Bubble Ratio: 67.01%, 23.90%, 32.67%, 23.32%
[rank3]:2025-10-29 05:45:25,582 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0545_stage3_step1400.svg
[rank3]:2025-10-29 05:45:25,853 - INFO - Avg. fwd time: 16.6673 / Avg. bwd time: 20.4788 / Avg. batch time: 312.7366 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:45:25,901 - INFO - Avg. fwd time: 17.1249 / Avg. bwd time: 19.7399 / Avg. batch time: 503.4737 (ms) / GPU bubble ratio: 41.42%
[rank2]:2025-10-29 05:45:25,873 - INFO - Avg. fwd time: 15.0698 / Avg. bwd time: 17.6224 / Avg. batch time: 456.6215 (ms) / GPU bubble ratio: 42.72%
[rank0]:2025-10-29 05:47:06,157 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank2]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,993  tflops: 372.78  mfu: 37.69%
[rank1]:2025-10-29 05:47:07,804 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,990  tflops: 372.67  mfu: 37.68%
[rank0]:2025-10-29 05:47:07,902 - INFO - Avg. fwd time: 15.1612 / Avg. bwd time: 8.7709 / Avg. batch time: 535.6342 (ms) / GPU bubble ratio: 64.26%
[rank3]:2025-10-29 05:47:12,820 - INFO -  step: 1450  loss:  2.5059  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,622  tflops: 355.47  mfu: 35.94%
[rank3]:2025-10-29 05:47:13,088 - INFO - Avg. fwd time: 16.6921 / Avg. bwd time: 20.4385 / Avg. batch time: 312.6041 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:47:13,134 - INFO - Avg. fwd time: 17.1476 / Avg. bwd time: 19.6897 / Avg. batch time: 502.3719 (ms) / GPU bubble ratio: 41.34%
[rank2]:2025-10-29 05:47:13,109 - INFO - Avg. fwd time: 15.0880 / Avg. bwd time: 17.5763 / Avg. batch time: 455.8925 (ms) / GPU bubble ratio: 42.68%
[rank0]:2025-10-29 05:48:53,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:48:54,862 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank1]:2025-10-29 05:48:54,863 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank0]:2025-10-29 05:48:54,862 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,652  tflops: 356.89  mfu: 36.09%
[rank3]:2025-10-29 05:48:59,897 - INFO -  step: 1500  loss:  2.5814  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,651  tflops: 356.83  mfu: 36.08%
[rank1]:2025-10-29 05:48:59,979 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0548_stage1_step1500.svg
[rank2]:2025-10-29 05:48:59,979 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0548_stage2_step1500.svg
[rank0]:2025-10-29 05:48:59,982 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0548_stage0_step1500.svg
[rank3]:2025-10-29 05:49:00,082 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0548_real_step1500_rank3.svg
[rank3]:> Batch Time: 371.64 ms, GPU Bubble Ratio: 67.00%, 23.94%, 32.71%, 23.30%
[rank3]:2025-10-29 05:49:00,149 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0548_stage3_step1500.svg
[rank3]:2025-10-29 05:49:00,484 - INFO - Avg. fwd time: 16.7133 / Avg. bwd time: 20.3986 / Avg. batch time: 312.4462 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:49:00,539 - INFO - Avg. fwd time: 17.1660 / Avg. bwd time: 19.6418 / Avg. batch time: 502.1413 (ms) / GPU bubble ratio: 41.36%
[rank2]:2025-10-29 05:49:00,511 - INFO - Avg. fwd time: 15.1047 / Avg. bwd time: 17.5331 / Avg. batch time: 456.0111 (ms) / GPU bubble ratio: 42.74%
[rank0]:2025-10-29 05:49:00,549 - INFO - Avg. fwd time: 15.1845 / Avg. bwd time: 8.4641 / Avg. batch time: 534.8094 (ms) / GPU bubble ratio: 64.62%
[rank0]:2025-10-29 05:50:40,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 05:50:42,460 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank1]:2025-10-29 05:50:42,461 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank0]:2025-10-29 05:50:42,460 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,614  tflops: 355.10  mfu: 35.90%
[rank0]:2025-10-29 05:50:42,561 - INFO - Avg. fwd time: 15.2033 / Avg. bwd time: 8.2177 / Avg. batch time: 533.9404 (ms) / GPU bubble ratio: 64.91%
[rank3]:2025-10-29 05:50:47,455 - INFO -  step: 1550  loss:  2.5133  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,617  tflops: 355.24  mfu: 35.92%
[rank3]:2025-10-29 05:50:47,725 - INFO - Avg. fwd time: 16.7315 / Avg. bwd time: 20.3675 / Avg. batch time: 312.3369 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:50:47,747 - INFO - Avg. fwd time: 15.1182 / Avg. bwd time: 17.4987 / Avg. batch time: 455.9017 (ms) / GPU bubble ratio: 42.77%
[rank1]:2025-10-29 05:50:47,772 - INFO - Avg. fwd time: 17.1817 / Avg. bwd time: 19.6034 / Avg. batch time: 501.7508 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 05:52:26,892 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 05:52:29,184 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank3_trend_line.svg
[rank2]:2025-10-29 05:52:29,198 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank2_trend_line.svg
[rank2]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.57/0.57, [MB1] 0.57/0.57, [MB2] 0.57/0.57, [MB3] 0.57/0.57, [MB4] 0.59/0.59, [MB5] 0.73/0.73, [MB6] 0.86/0.86, [MB7] 1.00/1.00
[rank2]:2025-10-29 05:52:29,237 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 7,672  tflops: 357.83  mfu: 36.18%
[rank1]:2025-10-29 05:52:29,227 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank1_trend_line.svg
[rank1]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.92/0.92, [MB1] 0.92/0.92, [MB2] 0.92/0.92, [MB3] 0.94/0.94, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 05:52:29,239 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 7,672  tflops: 357.82  mfu: 36.18%
[rank2]:2025-10-29 05:52:29,237 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-29 05:52:29,239 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:52:29,225 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0552_rank0_trend_line.svg
[rank0]:2025-10-29 05:52:29,233 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 05:52:29,237 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 7,672  tflops: 357.83  mfu: 36.18%
[rank0]:2025-10-29 05:52:29,237 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 05:52:29,422 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0552_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 354.26 ms, GPU Bubble Ratio: 53.25%, 24.25%, 29.56%, 23.76%
[rank3]:2025-10-29 05:52:29,423 - INFO - 	> Batch Time: 354.26 ms (Average Freeze Ratio: 0.69)
[rank3]:2025-10-29 05:52:29,423 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 05:52:34,416 - INFO -  step: 1600  loss:  3.7244  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,659  tflops: 357.22  mfu: 36.12%
[rank3]:2025-10-29 05:52:34,416 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 05:52:50,715 - INFO - validate step: 1600  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,072
[rank1]:2025-10-29 05:52:50,751 - INFO - validate step: 1600  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,041
[rank2]:2025-10-29 05:52:50,785 - INFO - validate step: 1600  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,010
[rank3]:2025-10-29 05:52:50,808 - INFO - validate step: 1600  loss:  0.9213  memory: 84.49GiB(60.43%)  tps: 24,990
[rank0]:2025-10-29 05:52:50,894 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0552_stage0_step1600.svg
[rank1]:2025-10-29 05:52:50,894 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0552_stage1_step1600.svg
[rank2]:2025-10-29 05:52:50,897 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0552_stage2_step1600.svg
[rank0]:2025-10-29 05:52:50,981 - INFO - Avg. fwd time: 15.2201 / Avg. bwd time: 7.9478 / Avg. batch time: 533.1168 (ms) / GPU bubble ratio: 65.23%
[rank3]:2025-10-29 05:52:51,000 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0552_real_step1600_rank3.svg
[rank3]:> Batch Time: 372.58 ms, GPU Bubble Ratio: 67.00%, 23.98%, 32.78%, 23.27%
[rank3]:2025-10-29 05:52:51,072 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0552_stage3_step1600.svg
[rank3]:2025-10-29 05:52:51,325 - INFO - Avg. fwd time: 16.7464 / Avg. bwd time: 20.3284 / Avg. batch time: 312.1352 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 05:52:51,371 - INFO - Avg. fwd time: 17.1942 / Avg. bwd time: 19.5583 / Avg. batch time: 501.4534 (ms) / GPU bubble ratio: 41.37%
[rank2]:2025-10-29 05:52:51,346 - INFO - Avg. fwd time: 15.1297 / Avg. bwd time: 17.4581 / Avg. batch time: 455.9163 (ms) / GPU bubble ratio: 42.82%
[rank0]:2025-10-29 05:54:27,038 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,375  tflops: 390.61  mfu: 39.50%
[rank2]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,378  tflops: 390.75  mfu: 39.51%
[rank0]:2025-10-29 05:54:28,566 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,372  tflops: 390.47  mfu: 39.48%
[rank3]:2025-10-29 05:54:33,547 - INFO -  step: 1650  loss:  3.8737  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,974  tflops: 371.90  mfu: 37.60%
[rank3]:2025-10-29 05:54:33,857 - INFO - Avg. fwd time: 16.7380 / Avg. bwd time: 20.2710 / Avg. batch time: 311.5971 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 05:54:33,884 - INFO - Avg. fwd time: 15.1245 / Avg. bwd time: 17.4079 / Avg. batch time: 455.7141 (ms) / GPU bubble ratio: 42.89%
[rank1]:2025-10-29 05:54:33,912 - INFO - Avg. fwd time: 17.1876 / Avg. bwd time: 19.5046 / Avg. batch time: 500.9432 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:54:33,923 - INFO - Avg. fwd time: 15.2192 / Avg. bwd time: 7.6951 / Avg. batch time: 532.1025 (ms) / GPU bubble ratio: 65.55%
[rank0]:2025-10-29 05:56:08,879 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 05:56:10,389 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,045  tflops: 375.23  mfu: 37.94%
[rank1]:2025-10-29 05:56:10,390 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,045  tflops: 375.23  mfu: 37.94%
[rank2]:2025-10-29 05:56:10,389 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,045  tflops: 375.24  mfu: 37.94%
[rank3]:2025-10-29 05:56:15,419 - INFO -  step: 1700  loss:  3.8973  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,042  tflops: 375.07  mfu: 37.92%
[rank0]:2025-10-29 05:56:15,508 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0556_stage0_step1700.svg
[rank1]:2025-10-29 05:56:15,506 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0556_stage1_step1700.svg
[rank2]:2025-10-29 05:56:15,506 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0556_stage2_step1700.svg
[rank0]:2025-10-29 05:56:15,599 - INFO - Avg. fwd time: 15.2179 / Avg. bwd time: 7.4909 / Avg. batch time: 530.9660 (ms) / GPU bubble ratio: 65.78%
[rank3]:2025-10-29 05:56:15,613 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0556_real_step1700_rank3.svg
[rank3]:> Batch Time: 371.75 ms, GPU Bubble Ratio: 66.99%, 23.94%, 32.72%, 23.29%
[rank3]:2025-10-29 05:56:15,683 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0556_stage3_step1700.svg
[rank3]:2025-10-29 05:56:15,925 - INFO - Avg. fwd time: 16.7300 / Avg. bwd time: 20.2227 / Avg. batch time: 311.1365 (ms) / GPU bubble ratio: 4.99%
[rank2]:2025-10-29 05:56:15,945 - INFO - Avg. fwd time: 15.1200 / Avg. bwd time: 17.3671 / Avg. batch time: 455.2356 (ms) / GPU bubble ratio: 42.91%
[rank1]:2025-10-29 05:56:15,970 - INFO - Avg. fwd time: 17.1816 / Avg. bwd time: 19.4607 / Avg. batch time: 500.2148 (ms) / GPU bubble ratio: 41.40%
[rank0]:2025-10-29 05:57:50,617 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank2]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank0]:2025-10-29 05:57:52,133 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank0]:2025-10-29 05:57:52,224 - INFO - Avg. fwd time: 15.2166 / Avg. bwd time: 7.2660 / Avg. batch time: 529.2171 (ms) / GPU bubble ratio: 66.01%
[rank3]:2025-10-29 05:57:57,143 - INFO -  step: 1750  loss:  3.8560  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,053  tflops: 375.61  mfu: 37.98%
[rank3]:2025-10-29 05:57:57,389 - INFO - Avg. fwd time: 16.7216 / Avg. bwd time: 20.1693 / Avg. batch time: 310.6312 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 05:57:57,433 - INFO - Avg. fwd time: 17.1755 / Avg. bwd time: 19.4125 / Avg. batch time: 498.9156 (ms) / GPU bubble ratio: 41.33%
[rank2]:2025-10-29 05:57:57,409 - INFO - Avg. fwd time: 15.1152 / Avg. bwd time: 17.3223 / Avg. batch time: 454.2099 (ms) / GPU bubble ratio: 42.87%
[rank0]:2025-10-29 05:59:32,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 05:59:33,698 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank1]:2025-10-29 05:59:33,698 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 05:59:33,697 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank2]:2025-10-29 05:59:33,697 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:59:33,697 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank0]:2025-10-29 05:59:33,697 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 05:59:38,729 - INFO -  step: 1800  loss:  3.8822  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,064  tflops: 376.12  mfu: 38.03%
[rank3]:2025-10-29 05:59:38,729 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 05:59:55,057 - INFO - validate step: 1800  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,177
[rank2]:2025-10-29 05:59:55,125 - INFO - validate step: 1800  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,116
[rank1]:2025-10-29 05:59:55,093 - INFO - validate step: 1800  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,145
[rank3]:2025-10-29 05:59:55,149 - INFO - validate step: 1800  loss:  0.9155  memory: 84.49GiB(60.43%)  tps: 24,948
[rank2]:2025-10-29 05:59:55,233 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0559_stage2_step1800.svg
[rank1]:2025-10-29 05:59:55,233 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0559_stage1_step1800.svg
[rank0]:2025-10-29 05:59:55,234 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0559_stage0_step1800.svg
[rank3]:2025-10-29 05:59:55,346 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0559_real_step1800_rank3.svg
[rank3]:> Batch Time: 371.03 ms, GPU Bubble Ratio: 66.98%, 23.90%, 32.67%, 23.32%
[rank3]:2025-10-29 05:59:55,415 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0559_stage3_step1800.svg
[rank3]:2025-10-29 05:59:55,726 - INFO - Avg. fwd time: 16.7132 / Avg. bwd time: 20.1184 / Avg. batch time: 310.1463 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 05:59:55,755 - INFO - Avg. fwd time: 15.1108 / Avg. bwd time: 17.2800 / Avg. batch time: 453.9372 (ms) / GPU bubble ratio: 42.92%
[rank0]:2025-10-29 05:59:55,793 - INFO - Avg. fwd time: 15.2153 / Avg. bwd time: 7.0542 / Avg. batch time: 528.2627 (ms) / GPU bubble ratio: 66.28%
[rank1]:2025-10-29 05:59:55,782 - INFO - Avg. fwd time: 17.1692 / Avg. bwd time: 19.3664 / Avg. batch time: 498.3837 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:01:31,102 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 06:01:32,630 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank1]:2025-10-29 06:01:32,631 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,399  tflops: 391.72  mfu: 39.61%
[rank0]:2025-10-29 06:01:32,630 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,396  tflops: 391.58  mfu: 39.59%
[rank0]:2025-10-29 06:01:32,721 - INFO - Avg. fwd time: 15.2144 / Avg. bwd time: 6.8823 / Avg. batch time: 527.3666 (ms) / GPU bubble ratio: 66.48%
[rank3]:2025-10-29 06:01:37,658 - INFO -  step: 1850  loss:  3.8895  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 7,992  tflops: 372.73  mfu: 37.69%
[rank3]:2025-10-29 06:01:37,909 - INFO - Avg. fwd time: 16.7074 / Avg. bwd time: 20.0792 / Avg. batch time: 309.7777 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 06:01:37,928 - INFO - Avg. fwd time: 15.1074 / Avg. bwd time: 17.2460 / Avg. batch time: 453.5944 (ms) / GPU bubble ratio: 42.94%
[rank1]:2025-10-29 06:01:37,954 - INFO - Avg. fwd time: 17.1653 / Avg. bwd time: 19.3304 / Avg. batch time: 497.8316 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:03:12,729 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:03:14,274 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank1]:2025-10-29 06:03:14,274 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank0]:2025-10-29 06:03:14,273 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,060  tflops: 375.90  mfu: 38.01%
[rank3]:2025-10-29 06:03:19,240 - INFO -  step: 1900  loss:  3.8145  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,065  tflops: 376.14  mfu: 38.03%
[rank2]:2025-10-29 06:03:19,326 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0603_stage2_step1900.svg
[rank1]:2025-10-29 06:03:19,325 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0603_stage1_step1900.svg
[rank0]:2025-10-29 06:03:19,326 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0603_stage0_step1900.svg
[rank0]:2025-10-29 06:03:19,416 - INFO - Avg. fwd time: 15.2132 / Avg. bwd time: 6.6920 / Avg. batch time: 526.4987 (ms) / GPU bubble ratio: 66.72%
[rank3]:2025-10-29 06:03:19,435 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0603_real_step1900_rank3.svg
[rank3]:> Batch Time: 370.41 ms, GPU Bubble Ratio: 66.97%, 23.87%, 32.64%, 23.32%
[rank3]:2025-10-29 06:03:19,505 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0603_stage3_step1900.svg
[rank3]:2025-10-29 06:03:19,753 - INFO - Avg. fwd time: 16.7008 / Avg. bwd time: 20.0357 / Avg. batch time: 309.3678 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 06:03:19,773 - INFO - Avg. fwd time: 15.1033 / Avg. bwd time: 17.2080 / Avg. batch time: 453.3435 (ms) / GPU bubble ratio: 42.98%
[rank1]:2025-10-29 06:03:19,797 - INFO - Avg. fwd time: 17.1596 / Avg. bwd time: 19.2888 / Avg. batch time: 497.3442 (ms) / GPU bubble ratio: 41.37%
[rank0]:2025-10-29 06:04:54,523 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:04:56,078 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank1]:2025-10-29 06:04:56,079 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,047  tflops: 375.31  mfu: 37.95%
[rank0]:2025-10-29 06:04:56,079 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,047  tflops: 375.30  mfu: 37.95%
[rank3]:2025-10-29 06:05:01,172 - INFO -  step: 1950  loss:  3.7709  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,037  tflops: 374.85  mfu: 37.90%
[rank3]:2025-10-29 06:05:01,499 - INFO - Avg. fwd time: 16.6951 / Avg. bwd time: 19.9951 / Avg. batch time: 308.9894 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:05:01,526 - INFO - Avg. fwd time: 15.1001 / Avg. bwd time: 17.1730 / Avg. batch time: 453.1392 (ms) / GPU bubble ratio: 43.02%
[rank1]:2025-10-29 06:05:01,555 - INFO - Avg. fwd time: 17.1543 / Avg. bwd time: 19.2494 / Avg. batch time: 496.9171 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 06:05:01,567 - INFO - Avg. fwd time: 15.2125 / Avg. bwd time: 6.5119 / Avg. batch time: 525.7132 (ms) / GPU bubble ratio: 66.94%
[rank0]:2025-10-29 06:06:36,291 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank1]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank2]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 06:06:37,856 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,049  tflops: 375.41  mfu: 37.96%
[rank0]:2025-10-29 06:06:37,856 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 06:06:42,892 - INFO -  step: 2000  loss:  3.7715  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,054  tflops: 375.64  mfu: 37.98%
[rank3]:2025-10-29 06:06:42,892 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 06:06:59,213 - INFO - validate step: 2000  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,179
[rank0]:2025-10-29 06:06:59,177 - INFO - validate step: 2000  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,211
[rank3]:2025-10-29 06:06:59,271 - INFO - validate step: 2000  loss:  0.9219  memory: 84.49GiB(60.43%)  tps: 25,009
[rank2]:2025-10-29 06:06:59,249 - INFO - validate step: 2000  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,146
[rank1]:2025-10-29 06:06:59,359 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0606_stage1_step2000.svg
[rank2]:2025-10-29 06:06:59,360 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0606_stage2_step2000.svg
[rank0]:2025-10-29 06:06:59,363 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0606_stage0_step2000.svg
[rank0]:2025-10-29 06:06:59,452 - INFO - Avg. fwd time: 15.2113 / Avg. bwd time: 6.3651 / Avg. batch time: 524.8601 (ms) / GPU bubble ratio: 67.11%
[rank3]:2025-10-29 06:06:59,460 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0606_real_step2000_rank3.svg
[rank3]:> Batch Time: 369.93 ms, GPU Bubble Ratio: 66.96%, 23.86%, 32.60%, 23.31%
[rank3]:2025-10-29 06:06:59,531 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0606_stage3_step2000.svg
[rank3]:2025-10-29 06:06:59,786 - INFO - Avg. fwd time: 16.6897 / Avg. bwd time: 19.9605 / Avg. batch time: 308.6632 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:06:59,806 - INFO - Avg. fwd time: 15.0966 / Avg. bwd time: 17.1432 / Avg. batch time: 452.7635 (ms) / GPU bubble ratio: 43.03%
[rank1]:2025-10-29 06:06:59,831 - INFO - Avg. fwd time: 17.1492 / Avg. bwd time: 19.2164 / Avg. batch time: 496.3573 (ms) / GPU bubble ratio: 41.39%
[rank0]:2025-10-29 06:08:34,871 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 06:08:36,417 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,424  tflops: 392.92  mfu: 39.73%
[rank2]:2025-10-29 06:08:36,418 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,431  tflops: 393.21  mfu: 39.76%
[rank1]:2025-10-29 06:08:36,418 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,428  tflops: 393.06  mfu: 39.74%
[rank0]:2025-10-29 06:08:36,508 - INFO - Avg. fwd time: 15.2107 / Avg. bwd time: 6.2020 / Avg. batch time: 523.5695 (ms) / GPU bubble ratio: 67.28%
[rank3]:2025-10-29 06:08:41,431 - INFO -  step: 2050  loss:  3.8018  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,019  tflops: 374.01  mfu: 37.82%
[rank3]:2025-10-29 06:08:41,679 - INFO - Avg. fwd time: 16.6849 / Avg. bwd time: 19.9245 / Avg. batch time: 308.3285 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 06:08:41,698 - INFO - Avg. fwd time: 15.0936 / Avg. bwd time: 17.1111 / Avg. batch time: 451.9993 (ms) / GPU bubble ratio: 43.00%
[rank1]:2025-10-29 06:08:41,721 - INFO - Avg. fwd time: 17.1450 / Avg. bwd time: 19.1815 / Avg. batch time: 495.3927 (ms) / GPU bubble ratio: 41.34%
[rank0]:2025-10-29 06:10:16,430 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:10:17,948 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank1]:2025-10-29 06:10:17,949 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank0]:2025-10-29 06:10:17,948 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,069  tflops: 376.32  mfu: 38.05%
[rank3]:2025-10-29 06:10:22,985 - INFO -  step: 2100  loss:  3.8586  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,067  tflops: 376.24  mfu: 38.04%
[rank1]:2025-10-29 06:10:23,066 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0610_stage1_step2100.svg
[rank2]:2025-10-29 06:10:23,068 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0610_stage2_step2100.svg
[rank0]:2025-10-29 06:10:23,070 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0610_stage0_step2100.svg
[rank3]:2025-10-29 06:10:23,177 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0610_real_step2100_rank3.svg
[rank3]:> Batch Time: 369.53 ms, GPU Bubble Ratio: 66.95%, 23.84%, 32.59%, 23.31%
[rank3]:2025-10-29 06:10:23,240 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0610_stage3_step2100.svg
[rank3]:2025-10-29 06:10:23,548 - INFO - Avg. fwd time: 16.6797 / Avg. bwd time: 19.8893 / Avg. batch time: 307.9980 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:10:23,575 - INFO - Avg. fwd time: 15.0903 / Avg. bwd time: 17.0803 / Avg. batch time: 451.8297 (ms) / GPU bubble ratio: 43.04%
[rank0]:2025-10-29 06:10:23,614 - INFO - Avg. fwd time: 15.2099 / Avg. bwd time: 6.0471 / Avg. batch time: 522.8988 (ms) / GPU bubble ratio: 67.48%
[rank1]:2025-10-29 06:10:23,603 - INFO - Avg. fwd time: 17.1402 / Avg. bwd time: 19.1475 / Avg. batch time: 495.0309 (ms) / GPU bubble ratio: 41.36%
[rank0]:2025-10-29 06:11:58,325 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:11:59,854 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank1]:2025-10-29 06:11:59,855 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank0]:2025-10-29 06:11:59,854 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,039  tflops: 374.93  mfu: 37.91%
[rank0]:2025-10-29 06:11:59,948 - INFO - Avg. fwd time: 15.2091 / Avg. bwd time: 5.9203 / Avg. batch time: 522.1794 (ms) / GPU bubble ratio: 67.63%
[rank3]:2025-10-29 06:12:05,119 - INFO -  step: 2150  loss:  3.7977  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,021  tflops: 374.10  mfu: 37.83%
[rank3]:2025-10-29 06:12:05,370 - INFO - Avg. fwd time: 16.6759 / Avg. bwd time: 19.8609 / Avg. batch time: 307.7349 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:12:05,389 - INFO - Avg. fwd time: 15.0881 / Avg. bwd time: 17.0557 / Avg. batch time: 451.5228 (ms) / GPU bubble ratio: 43.05%
[rank1]:2025-10-29 06:12:05,414 - INFO - Avg. fwd time: 17.1363 / Avg. bwd time: 19.1194 / Avg. batch time: 494.5650 (ms) / GPU bubble ratio: 41.35%
[rank0]:2025-10-29 06:13:39,780 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 06:13:41,305 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,075  tflops: 376.61  mfu: 38.08%
[rank0]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 06:13:41,304 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,075  tflops: 376.61  mfu: 38.08%
[rank2]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 06:13:41,305 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,075  tflops: 376.62  mfu: 38.08%
[rank1]:2025-10-29 06:13:41,305 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 06:13:46,243 - INFO -  step: 2200  loss:  3.8610  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,101  tflops: 377.84  mfu: 38.20%
[rank3]:2025-10-29 06:13:46,243 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 06:14:02,600 - INFO - validate step: 2200  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,235
[rank2]:2025-10-29 06:14:02,663 - INFO - validate step: 2200  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,177
[rank1]:2025-10-29 06:14:02,636 - INFO - validate step: 2200  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,202
[rank3]:2025-10-29 06:14:02,687 - INFO - validate step: 2200  loss:  0.9161  memory: 84.49GiB(60.43%)  tps: 24,910
[rank2]:2025-10-29 06:14:02,772 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0614_stage2_step2200.svg
[rank1]:2025-10-29 06:14:02,767 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0614_stage1_step2200.svg
[rank0]:2025-10-29 06:14:02,771 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0614_stage0_step2200.svg
[rank0]:2025-10-29 06:14:02,864 - INFO - Avg. fwd time: 15.2081 / Avg. bwd time: 5.7790 / Avg. batch time: 521.5312 (ms) / GPU bubble ratio: 67.81%
[rank3]:2025-10-29 06:14:02,877 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0614_real_step2200_rank3.svg
[rank3]:> Batch Time: 369.12 ms, GPU Bubble Ratio: 66.95%, 23.84%, 32.57%, 23.30%
[rank3]:2025-10-29 06:14:02,940 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0614_stage3_step2200.svg
[rank3]:2025-10-29 06:14:03,189 - INFO - Avg. fwd time: 16.6707 / Avg. bwd time: 19.8275 / Avg. batch time: 307.4185 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 06:14:03,209 - INFO - Avg. fwd time: 15.0851 / Avg. bwd time: 17.0273 / Avg. batch time: 451.3330 (ms) / GPU bubble ratio: 43.08%
[rank1]:2025-10-29 06:14:03,234 - INFO - Avg. fwd time: 17.1317 / Avg. bwd time: 19.0878 / Avg. batch time: 494.1992 (ms) / GPU bubble ratio: 41.37%
[rank0]:2025-10-29 06:15:38,045 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 06:15:39,585 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,447  tflops: 393.95  mfu: 39.83%
[rank1]:2025-10-29 06:15:39,586 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,450  tflops: 394.10  mfu: 39.85%
[rank2]:2025-10-29 06:15:39,585 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,452  tflops: 394.21  mfu: 39.86%
[rank3]:2025-10-29 06:15:44,574 - INFO -  step: 2250  loss:  3.8077  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,040  tflops: 375.01  mfu: 37.92%
[rank3]:2025-10-29 06:15:44,889 - INFO - Avg. fwd time: 16.6663 / Avg. bwd time: 19.7971 / Avg. batch time: 307.1345 (ms) / GPU bubble ratio: 5.02%
[rank1]:2025-10-29 06:15:44,951 - INFO - Avg. fwd time: 17.1279 / Avg. bwd time: 19.0588 / Avg. batch time: 493.8859 (ms) / GPU bubble ratio: 41.38%
[rank2]:2025-10-29 06:15:44,919 - INFO - Avg. fwd time: 15.0820 / Avg. bwd time: 17.0001 / Avg. batch time: 451.1848 (ms) / GPU bubble ratio: 43.11%
[rank0]:2025-10-29 06:15:44,966 - INFO - Avg. fwd time: 15.2075 / Avg. bwd time: 5.6442 / Avg. batch time: 520.9497 (ms) / GPU bubble ratio: 67.98%
[rank0]:2025-10-29 06:17:19,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank2]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank0]:2025-10-29 06:17:21,028 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,076  tflops: 376.64  mfu: 38.08%
[rank3]:2025-10-29 06:17:25,945 - INFO -  step: 2300  loss:  3.8312  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,081  tflops: 376.92  mfu: 38.11%
[rank1]:2025-10-29 06:17:26,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0617_stage1_step2300.svg
[rank2]:2025-10-29 06:17:26,026 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0617_stage2_step2300.svg
[rank0]:2025-10-29 06:17:26,029 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0617_stage0_step2300.svg
[rank3]:2025-10-29 06:17:26,134 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0617_real_step2300_rank3.svg
[rank3]:> Batch Time: 368.88 ms, GPU Bubble Ratio: 66.94%, 23.84%, 32.57%, 23.30%
[rank0]:2025-10-29 06:17:26,122 - INFO - Avg. fwd time: 15.2070 / Avg. bwd time: 5.5336 / Avg. batch time: 520.2799 (ms) / GPU bubble ratio: 68.11%
[rank3]:2025-10-29 06:17:26,197 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0617_stage3_step2300.svg
[rank3]:2025-10-29 06:17:26,447 - INFO - Avg. fwd time: 16.6627 / Avg. bwd time: 19.7720 / Avg. batch time: 306.8994 (ms) / GPU bubble ratio: 5.03%
[rank1]:2025-10-29 06:17:26,492 - INFO - Avg. fwd time: 17.1246 / Avg. bwd time: 19.0345 / Avg. batch time: 493.4363 (ms) / GPU bubble ratio: 41.38%
[rank2]:2025-10-29 06:17:26,466 - INFO - Avg. fwd time: 15.0798 / Avg. bwd time: 16.9782 / Avg. batch time: 450.8731 (ms) / GPU bubble ratio: 43.12%
[rank0]:2025-10-29 06:19:01,075 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,063  tflops: 376.04  mfu: 38.02%
[rank1]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,063  tflops: 376.05  mfu: 38.02%
[rank0]:2025-10-29 06:19:02,632 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,063  tflops: 376.05  mfu: 38.02%
[rank0]:2025-10-29 06:19:02,725 - INFO - Avg. fwd time: 15.2063 / Avg. bwd time: 5.4100 / Avg. batch time: 519.1964 (ms) / GPU bubble ratio: 68.23%
[rank3]:2025-10-29 06:19:07,570 - INFO -  step: 2350  loss:  3.7582  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,061  tflops: 375.97  mfu: 38.02%
[rank3]:2025-10-29 06:19:07,824 - INFO - Avg. fwd time: 16.6584 / Avg. bwd time: 19.7439 / Avg. batch time: 306.6349 (ms) / GPU bubble ratio: 5.03%
[rank2]:2025-10-29 06:19:07,846 - INFO - Avg. fwd time: 15.0773 / Avg. bwd time: 16.9538 / Avg. batch time: 450.1907 (ms) / GPU bubble ratio: 43.08%
[rank1]:2025-10-29 06:19:07,869 - INFO - Avg. fwd time: 17.1205 / Avg. bwd time: 19.0070 / Avg. batch time: 492.5991 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 06:20:42,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:20:44,114 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.05GiB(52.25%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank1]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,739  tflops: 360.92  mfu: 35.60%
[rank2]:2025-10-29 06:20:44,113 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.92GiB(47.15%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank2]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,739  tflops: 360.94  mfu: 35.60%
[rank1]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:20:44,113 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.16GiB(52.33%)  tps: 8,072  tflops: 376.50  mfu: 38.07%
[rank0]:2025-10-29 06:20:44,114 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,738  tflops: 360.91  mfu: 35.60%
[rank0]:2025-10-29 06:20:44,114 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 06:20:49,048 - INFO -  step: 2400  loss:  3.7459  grad_norm:  0.0000  memory: 84.49GiB(60.43%)  tps: 8,073  tflops: 376.52  mfu: 38.07%
[rank3]:2025-10-29 06:20:49,049 - INFO -  final step: 2400  loss:  3.7459  grad_norm:  0.0000  tps: 7,653  tflops: 356.92  mfu: 35.19%
[rank3]:2025-10-29 06:20:49,049 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 06:21:05,364 - INFO - validate step: 2400  loss: -1.0000  memory: 73.16GiB(52.33%)  tps: 19,276
[rank0]:2025-10-29 06:21:05,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 06:21:05,369 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-29 06:21:05,399 - INFO - validate step: 2400  loss: -1.0000  memory: 73.05GiB(52.25%)  tps: 19,244
[rank1]:2025-10-29 06:21:05,400 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 06:21:05,405 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-29 06:21:05,439 - INFO - validate step: 2400  loss: -1.0000  memory: 65.92GiB(47.15%)  tps: 19,208
[rank2]:2025-10-29 06:21:05,439 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 06:21:05,444 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-29 06:21:05,462 - INFO - validate step: 2400  loss:  0.9204  memory: 84.49GiB(60.43%)  tps: 24,956
[rank3]:2025-10-29 06:21:05,463 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 06:21:05,465 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-29 06:21:15,828 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-29 06:21:15,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0621_stage2_final2400.svg
[rank0]:2025-10-29 06:21:15,958 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0621_stage0_final2400.svg
[rank3]:2025-10-29 06:21:16,034 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0621_real_final2400_rank3.svg
[rank3]:> Batch Time: 368.58 ms, GPU Bubble Ratio: 66.93%, 23.84%, 32.55%, 23.29%
[rank1]:2025-10-29 06:21:15,985 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0621_stage1_final2400.svg
[rank3]:2025-10-29 06:21:16,204 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0621_thry_final2400_rank3.svg
[rank3]:> Batch Time: 527.42 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank2]:2025-10-29 06:21:16,224 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank2_stage2.svg
[rank2]:	> Counts Sum: 1282680, Total Sum: 5368320 (23.89%), Ratio(%) per element: [23.98, 23.92, 24.51, 22.74, 23.01, 23.01, 23.49, 24.24, 23.39, 25.64, 23.71, 24.4, 22.74, 24.62, 25.26, 24.78, 24.08, 22.47, 24.94, 23.6, 22.69, 23.22, 22.15, 23.33, 25.37, 23.33, 23.39, 23.17, 23.39, 23.06, 24.35, 23.71, 23.76, 23.01, 23.65, 24.3, 25.26, 23.98, 23.65, 24.14, 23.76, 25.42, 23.92, 25.0, 21.83, 23.33, 24.62, 22.58, 23.81, 23.6, 23.76, 25.21, 25.59, 24.57, 22.69, 23.55, 24.19, 24.57, 24.08, 23.81, 23.49, 25.8, 23.06, 23.17, 23.01, 24.51, 24.08, 24.78, 24.62, 23.33, 24.08, 24.67]
[rank2]:2025-10-29 06:21:16,224 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:21:16,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0621_stage3_final2400.svg
[rank1]:2025-10-29 06:21:16,352 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank1_stage1.svg
[rank1]:	> Counts Sum: 309360, Total Sum: 6039360 (5.12%), Ratio(%) per element: [5.04, 5.84, 5.68, 4.56, 4.5, 4.88, 5.09, 4.56, 5.25, 4.56, 5.36, 4.56, 6.22, 5.41, 5.57, 5.31, 5.09, 4.56, 4.61, 5.04, 5.68, 5.2, 5.74, 5.95, 5.84, 4.72, 5.57, 5.36, 5.74, 5.36, 4.98, 5.52, 4.82, 5.09, 5.15, 4.23, 4.77, 5.15, 5.2, 4.88, 4.77, 4.23, 5.15, 4.77, 4.77, 4.56, 5.2, 4.29, 4.34, 5.52, 5.2, 4.98, 5.31, 4.88, 5.36, 5.09, 5.2, 5.79, 5.04, 5.36, 5.25, 5.52, 4.82, 5.2, 4.98, 4.77, 4.66, 4.39, 5.09, 5.41, 5.09, 4.82, 6.0, 5.47, 4.88, 6.27, 4.93, 4.82, 5.63, 5.04, 5.04]
[rank1]:2025-10-29 06:21:16,352 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 06:21:16,331 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank0_stage0.svg
[rank0]:	> Counts Sum: 4609240, Total Sum: 5442880 (84.68%), Ratio(%) per element: [84.6, 84.71, 84.49, 84.44, 84.87, 85.13, 84.65, 84.71, 84.97, 84.17, 84.38, 84.65, 84.81, 84.54, 84.65, 84.65, 84.76, 84.76, 84.87, 84.71, 84.97, 84.81, 84.54, 84.44, 84.76, 84.71, 84.49, 84.71, 84.6, 84.76, 84.38, 84.54, 84.49, 84.65, 84.87, 84.54, 84.92, 84.49, 84.76, 84.81, 84.6, 84.71, 84.65, 84.87, 84.49, 84.38, 85.13, 85.08, 84.38, 84.6, 84.81, 84.65, 84.54, 84.49, 84.38, 84.71, 84.97, 84.71, 84.49, 84.54, 84.97, 84.71, 84.6, 84.76, 84.76, 84.71, 84.38, 84.87, 84.81, 84.97, 84.87, 84.65, 84.54]
[rank0]:2025-10-29 06:21:16,331 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 06:21:16,491 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0621_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.39, 1.6, 1.93, 1.5, 1.6, 1.71, 1.55, 1.71, 1.5, 1.5, 1.44, 1.93, 1.6, 1.66, 1.77, 1.77, 1.6, 1.82, 1.55, 1.77, 1.71, 1.93, 1.6, 1.39, 1.18, 1.98, 1.87, 1.5, 1.87, 1.55, 1.28, 1.44, 1.6, 1.6, 1.39, 1.5, 1.93, 1.6, 1.66, 1.39, 1.55, 1.44, 1.55, 1.77, 1.28, 1.87, 1.6, 1.55, 1.44, 1.5, 1.55, 1.82, 1.34, 1.66, 1.93, 1.71, 1.23, 1.39, 1.55, 1.71, 1.71, 1.55, 1.44, 1.66, 0.0]
[rank3]:2025-10-29 06:21:16,492 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‚â–â–â–â–â–â–ƒâ–ƒâ–„â–ƒâ–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–â–â–â–â–â–â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚â–‚
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‚â–â–â–â–â–â–ƒâ–ƒâ–„â–ƒâ–ƒâ–‚â–‚â–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–â–â–â–â–â–â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–ƒâ–‚
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.14096
[rank3]:wandb:               final/avg_loss 3.74591
[rank3]:wandb:             final/avg_mfu(%) 35.18764
[rank3]:wandb:             final/avg_tflops 356.9203
[rank3]:wandb:    final/avg_throughput(tps) 7652.63869
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 3.74591
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 3.74591
[rank3]:wandb: loss_metrics/global_max_loss 3.74591
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/7q6bt8ow
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyapf_dm1/20251029-0450/wandb/run-20251029_045020-7q6bt8ow/logs
[rank0]:2025-10-29 06:21:18,331 - INFO - Training completed
[rank0]:2025-10-29 06:21:18,331 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 06:21:18,528 - INFO - Process group destroyed
[rank1]:2025-10-29 06:21:18,536 - INFO - Process group destroyed
[rank2]:2025-10-29 06:21:18,555 - INFO - Process group destroyed
[rank0]:2025-10-29 06:21:19,001 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.19', 'layers.24', 'layers.22', 'layers.17', 'layers.18', 'layers.20', 'layers.23'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.14', 'layers.11', 'layers.10', 'layers.8', 'layers.16', 'layers.9', 'layers.12', 'layers.15'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.0', 'layers.7', 'tok_embeddings', 'layers.6', 'layers.2', 'layers.4', 'layers.5', 'layers.3'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.30', 'layers.27', 'layers.28', 'norm', 'layers.25', 'layers.26', 'layers.31', 'output'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Wed Oct 29 06:45:50 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 3,4,5,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/1028_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] 
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] *****************************************
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1029 06:45:51.528000 1685263 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-29 06:45:57,020 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-29 06:45:57,428 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-29 06:45:57,383 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-29 06:45:57,522 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-29 06:45:57,656 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-29 06:45:57,657 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:45:57,662 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-29 06:45:58,261 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-29 06:45:58,264 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-29 06:45:58,251 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-29 06:45:58,254 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-29 06:45:58,292 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-29 06:45:58,294 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-29 06:46:00,142 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-29 06:46:00,419 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-29 06:46:02,042 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-29 06:46:03,659 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-29 06:46:03,836 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:46:03,909 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-29 06:46:03,909 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 06:46:03,927 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-29 06:46:03,978 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-29 06:46:04,002 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-29 06:46:04,002 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-29 06:46:04,069 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-29 06:46:04,133 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-29 06:46:04,133 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 06:46:04,162 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-29 06:46:04,162 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-10-29 06:46:04,219 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-29 06:46:04,219 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-10-29 06:46:04,356 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-29 06:46:04,356 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run q8s4zzdk
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1/20251029-0646/wandb/run-20251029_064604-q8s4zzdk
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1028_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/q8s4zzdk
[rank3]:2025-10-29 06:46:05,710 - INFO - WandB logging enabled
[rank3]:2025-10-29 06:46:05,716 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-29 06:46:05,790 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-29 06:46:05,790 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-29 06:46:06,110 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-29 06:46:06,111 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-29 06:46:06,124 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:06,144 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank0]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:06,144 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-10-29 06:46:06,144 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-29 06:46:09,126 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 100)
[rank0]:2025-10-29 06:46:09,126 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank0]:2025-10-29 06:46:09,127 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400.
[rank1]:2025-10-29 06:46:09,487 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank2]:2025-10-29 06:46:09,692 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank3]:2025-10-29 06:46:09,887 - WARNING - checkpoint.initial_load_path is provided but the checkpoint.folder exists. Checkpointer will use the checkpoints from the checkpoint.folder /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1.
[rank0]:2025-10-29 06:46:18,461 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-29 06:46:18,461 - INFO - Finished loading the checkpoint in 9.33 seconds.
[rank0]:2025-10-29 06:46:18,461 - INFO - Training starts at step 1
[rank3]:2025-10-29 06:46:23,161 - INFO -  step:  1  loss:  2.5272  grad_norm: 19.5148  memory: 58.03GiB(41.50%)  tps: 942  tflops: 43.93  mfu: 4.44%
[rank3]:2025-10-29 06:46:23,161 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-29 06:46:23,158 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 49.69GiB(35.54%)  tps: 850  tflops: 39.65  mfu: 4.01%
[rank1]:2025-10-29 06:46:23,158 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-29 06:46:23,177 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 49.75GiB(35.58%)  tps: 853  tflops: 39.80  mfu: 4.02%
[rank0]:2025-10-29 06:46:23,177 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-29 06:46:23,156 - INFO -  step:  1  loss: -4.0000  grad_norm: 19.5148  memory: 44.28GiB(31.67%)  tps: 862  tflops: 40.18  mfu: 4.06%
[rank2]:2025-10-29 06:46:23,156 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-29 06:46:41,435 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,436 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,437 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,438 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,439 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-29 06:46:41,440 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,478 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,479 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,480 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-29 06:46:41,481 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,524 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,524 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,525 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,526 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,527 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-29 06:46:41,527 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,567 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,568 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:46:41,569 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-29 06:48:32,707 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:48:35,438 - INFO -  step: 50  loss:  1.7159  grad_norm: 15.3070  memory: 73.38GiB(52.48%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank1]:2025-10-29 06:48:35,435 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 64.32GiB(46.00%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank2]:2025-10-29 06:48:35,433 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 57.29GiB(40.97%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank0]:2025-10-29 06:48:35,440 - INFO -  step: 50  loss: -4.0000  grad_norm: 15.3070  memory: 66.72GiB(47.72%)  tps: 6,070  tflops: 283.10  mfu: 28.62%
[rank3]:2025-10-29 06:48:35,898 - INFO - Avg. fwd time: 14.7209 / Avg. bwd time: 42.9299 / Avg. batch time: 481.8718 (ms) / GPU bubble ratio: 4.29%
[rank1]:2025-10-29 06:48:35,995 - INFO - Avg. fwd time: 15.3898 / Avg. bwd time: 41.6207 / Avg. batch time: 595.3210 (ms) / GPU bubble ratio: 23.39%
[rank2]:2025-10-29 06:48:35,948 - INFO - Avg. fwd time: 13.2507 / Avg. bwd time: 36.3665 / Avg. batch time: 534.6699 (ms) / GPU bubble ratio: 25.76%
[rank0]:2025-10-29 06:48:36,028 - INFO - Avg. fwd time: 14.2287 / Avg. bwd time: 38.3977 / Avg. batch time: 651.0325 (ms) / GPU bubble ratio: 35.33%
[rank3]:2025-10-29 06:49:02,213 - INFO - [Step 60] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-29 06:49:30,251 - INFO - [Step 70] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-29 06:49:30,468 - INFO - [Step 70] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-29 06:49:30,571 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:30,587 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:30,611 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,745 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,813 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,831 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,781 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,770 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,803 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,838 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,865 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,907 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,942 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,946 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:35,979 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:36,017 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,955 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:35,991 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,029 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,014 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,051 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:35,981 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,019 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,056 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:49:36,053 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,067 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,104 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-29 06:49:36,142 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,088 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,127 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-29 06:49:36,093 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-29 06:49:36,165 - WARNING - Batch index 281 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-29 06:50:14,035 - INFO - [Step 90] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-29 06:50:14,339 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_max_batch_time.svg
[rank3]:> Batch Time: 634.46 ms, GPU Bubble Ratio: 33.16%, 27.09%, 36.92%, 26.64%
[rank3]:2025-10-29 06:50:14,520 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_min_batch_time.svg
[rank3]:> Batch Time: 362.15 ms, GPU Bubble Ratio: 68.84%, 24.11%, 34.71%, 23.68%
[rank3]:2025-10-29 06:50:14,737 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.15 ms, GPU Bubble Ratio: 31.86%, 23.05%, 29.57%, 23.68%
[rank3]:2025-10-29 06:50:14,738 - INFO - 	> Batch Time: 362.15 ms (Average Freeze Ratio: 0.86, Time Reduction Rate: 0.43)
[rank0]:2025-10-29 06:50:34,800 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:50:36,459 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.30/0.90, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-29 06:50:36,460 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 72.68GiB(51.98%)  tps: 6,769  tflops: 315.70  mfu: 31.92%
[rank2]:2025-10-29 06:50:36,458 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.83, [MB1] 0.27/0.82, [MB2] 0.26/0.78, [MB3] 0.30/0.89, [MB4] 0.30/0.89, [MB5] 0.31/0.92, [MB6] 0.32/0.96, [MB7] 0.33/1.00
[rank2]:2025-10-29 06:50:36,459 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 64.67GiB(46.25%)  tps: 6,769  tflops: 315.70  mfu: 31.92%
[rank0]:2025-10-29 06:50:36,459 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.33/1.00, [MB4] 0.18/0.54, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-29 06:50:36,460 - INFO -  step: 100  loss: -4.0000  grad_norm:  0.0000  memory: 66.72GiB(47.72%)  tps: 6,769  tflops: 315.71  mfu: 31.92%
[rank3]:2025-10-29 06:50:41,575 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-29 06:50:41,580 - INFO -  step: 100  loss:  1.1361  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 6,494  tflops: 302.90  mfu: 30.63%
[rank1]:2025-10-29 06:50:41,658 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0650_stage1_step100.svg
[rank0]:2025-10-29 06:50:41,664 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0650_stage0_step100.svg
[rank2]:2025-10-29 06:50:41,658 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0650_stage2_step100.svg
[rank3]:2025-10-29 06:50:41,765 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0650_real_step100_rank3.svg
[rank3]:> Batch Time: 632.17 ms, GPU Bubble Ratio: 33.23%, 27.20%, 36.77%, 26.58%
[rank0]:2025-10-29 06:50:41,767 - INFO - Avg. fwd time: 14.6887 / Avg. bwd time: 27.6591 / Avg. batch time: 621.9454 (ms) / GPU bubble ratio: 45.53%
[rank3]:2025-10-29 06:50:41,827 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0650_stage3_step100.svg
[rank3]:2025-10-29 06:50:42,097 - INFO - Avg. fwd time: 15.4773 / Avg. bwd time: 36.3774 / Avg. batch time: 432.7173 (ms) / GPU bubble ratio: 4.13%
[rank1]:2025-10-29 06:50:42,145 - INFO - Avg. fwd time: 16.2270 / Avg. bwd time: 35.2832 / Avg. batch time: 577.3002 (ms) / GPU bubble ratio: 28.62%
[rank2]:2025-10-29 06:50:42,119 - INFO - Avg. fwd time: 13.9083 / Avg. bwd time: 30.7610 / Avg. batch time: 523.1093 (ms) / GPU bubble ratio: 31.69%
[rank0]:2025-10-29 06:52:49,330 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:52:51,387 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.62/0.94, [MB1] 0.60/0.90, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-29 06:52:51,388 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 72.68GiB(51.98%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank0]:2025-10-29 06:52:51,386 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.36/0.54, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-29 06:52:51,386 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 73.18GiB(52.34%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank2]:2025-10-29 06:52:51,386 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.55/0.83, [MB1] 0.55/0.82, [MB2] 0.52/0.78, [MB3] 0.59/0.89, [MB4] 0.59/0.89, [MB5] 0.62/0.92, [MB6] 0.64/0.96, [MB7] 0.67/1.00
[rank2]:2025-10-29 06:52:51,386 - INFO -  step: 150  loss: -4.0000  grad_norm:  0.1799  memory: 64.67GiB(46.25%)  tps: 6,071  tflops: 283.17  mfu: 28.63%
[rank3]:2025-10-29 06:52:56,534 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-29 06:52:56,538 - INFO -  step: 150  loss:  1.1314  grad_norm:  0.1799  memory: 84.24GiB(60.25%)  tps: 6,070  tflops: 283.11  mfu: 28.63%
[rank1]:2025-10-29 06:52:56,975 - INFO - Avg. fwd time: 16.3954 / Avg. bwd time: 33.3781 / Avg. batch time: 583.6007 (ms) / GPU bubble ratio: 31.77%
[rank3]:2025-10-29 06:52:56,916 - INFO - Avg. fwd time: 15.7609 / Avg. bwd time: 33.4484 / Avg. batch time: 410.6262 (ms) / GPU bubble ratio: 4.13%
[rank0]:2025-10-29 06:52:57,003 - INFO - Avg. fwd time: 14.8414 / Avg. bwd time: 27.2767 / Avg. batch time: 628.1178 (ms) / GPU bubble ratio: 46.36%
[rank2]:2025-10-29 06:52:56,944 - INFO - Avg. fwd time: 14.0989 / Avg. bwd time: 28.8593 / Avg. batch time: 526.9112 (ms) / GPU bubble ratio: 34.78%
[rank0]:2025-10-29 06:54:49,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.90/0.90, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:54:51,500 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 72.72GiB(52.01%)  tps: 6,820  tflops: 318.10  mfu: 32.16%
[rank1]:2025-10-29 06:54:51,500 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.82/0.82, [MB2] 0.78/0.78, [MB3] 0.89/0.89, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:54:51,501 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 65.27GiB(46.69%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank2]:2025-10-29 06:54:51,501 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-29 06:54:51,500 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.54/0.54, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:54:51,501 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.1038  memory: 74.20GiB(53.07%)  tps: 6,820  tflops: 318.09  mfu: 32.16%
[rank0]:2025-10-29 06:54:51,501 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-29 06:54:56,684 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:54:56,688 - INFO -  step: 200  loss:  1.1825  grad_norm:  0.1038  memory: 84.24GiB(60.25%)  tps: 6,818  tflops: 318.00  mfu: 32.15%
[rank3]:2025-10-29 06:54:56,689 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-29 06:55:13,745 - INFO - validate step: 200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,414
[rank0]:2025-10-29 06:55:13,692 - INFO - validate step: 200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,458
[rank3]:2025-10-29 06:55:13,756 - INFO - validate step: 200  loss:  0.3711  memory: 84.24GiB(60.25%)  tps: 24,000
[rank1]:2025-10-29 06:55:13,729 - INFO - validate step: 200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,427
[rank2]:2025-10-29 06:55:13,832 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0655_stage2_step200.svg
[rank0]:2025-10-29 06:55:13,830 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0655_stage0_step200.svg
[rank1]:2025-10-29 06:55:13,830 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0655_stage1_step200.svg
[rank3]:2025-10-29 06:55:13,930 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0655_real_step200_rank3.svg
[rank3]:> Batch Time: 497.13 ms, GPU Bubble Ratio: 31.53%, 25.85%, 35.91%, 28.10%
[rank3]:2025-10-29 06:55:13,995 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0655_stage3_step200.svg
[rank0]:2025-10-29 06:55:14,249 - INFO - Avg. fwd time: 15.0404 / Avg. bwd time: 25.3181 / Avg. batch time: 614.6784 (ms) / GPU bubble ratio: 47.47%
[rank3]:2025-10-29 06:55:14,264 - INFO - Avg. fwd time: 15.9965 / Avg. bwd time: 31.0946 / Avg. batch time: 393.2789 (ms) / GPU bubble ratio: 4.21%
[rank1]:2025-10-29 06:55:14,313 - INFO - Avg. fwd time: 16.6239 / Avg. bwd time: 31.1401 / Avg. batch time: 572.1262 (ms) / GPU bubble ratio: 33.21%
[rank2]:2025-10-29 06:55:14,286 - INFO - Avg. fwd time: 14.3049 / Avg. bwd time: 26.9279 / Avg. batch time: 517.5220 (ms) / GPU bubble ratio: 36.26%
[rank0]:2025-10-29 06:56:56,132 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 06:56:57,781 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.90/0.90, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:56:57,781 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,873  tflops: 367.20  mfu: 37.13%
[rank0]:2025-10-29 06:56:57,780 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.54/0.54, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:56:57,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,870  tflops: 367.07  mfu: 37.12%
[rank2]:2025-10-29 06:56:57,780 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 0.82/0.82, [MB2] 0.78/0.78, [MB3] 0.89/0.89, [MB4] 0.89/0.89, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:56:57,780 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,874  tflops: 367.26  mfu: 37.13%
[rank0]:2025-10-29 06:56:57,878 - INFO - Avg. fwd time: 15.2460 / Avg. bwd time: 20.1338 / Avg. batch time: 590.0931 (ms) / GPU bubble ratio: 52.03%
[rank3]:2025-10-29 06:57:03,019 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:57:03,024 - INFO -  step: 250  loss:  1.2228  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,497  tflops: 349.68  mfu: 35.36%
[rank3]:2025-10-29 06:57:03,292 - INFO - Avg. fwd time: 16.2801 / Avg. bwd time: 28.6188 / Avg. batch time: 375.4646 (ms) / GPU bubble ratio: 4.33%
[rank2]:2025-10-29 06:57:03,313 - INFO - Avg. fwd time: 14.5586 / Avg. bwd time: 24.7040 / Avg. batch time: 501.8409 (ms) / GPU bubble ratio: 37.41%
[rank1]:2025-10-29 06:57:03,338 - INFO - Avg. fwd time: 16.9330 / Avg. bwd time: 28.5399 / Avg. batch time: 552.9145 (ms) / GPU bubble ratio: 34.21%
[rank0]:2025-10-29 06:58:44,431 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 06:58:46,217 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank3_trend_line.svg
[rank1]:2025-10-29 06:58:46,262 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank1_trend_line.svg
[rank1]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 06:58:46,270 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank2]:2025-10-29 06:58:46,241 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank2_trend_line.svg
[rank2]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,252 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0658_rank0_trend_line.svg
[rank2]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.74/0.74, [MB1] 0.74/0.74, [MB2] 0.74/0.74, [MB3] 0.79/0.79, [MB4] 0.84/0.84, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 06:58:46,271 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank0]:2025-10-29 06:58:46,268 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,270 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 06:58:46,270 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank3]:2025-10-29 06:58:46,455 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0658_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 363.44 ms, GPU Bubble Ratio: 37.35%, 24.57%, 32.02%, 24.73%
[rank3]:2025-10-29 06:58:46,456 - INFO - 	> Batch Time: 363.44 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 06:58:46,456 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:58:51,672 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 06:58:51,676 - INFO -  step: 300  loss:  1.1753  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,540  tflops: 351.66  mfu: 35.56%
[rank1]:2025-10-29 06:58:51,746 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0658_stage1_step300.svg
[rank0]:2025-10-29 06:58:51,744 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0658_stage0_step300.svg
[rank2]:2025-10-29 06:58:51,746 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0658_stage2_step300.svg
[rank3]:2025-10-29 06:58:51,849 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0658_real_step300_rank3.svg
[rank3]:> Batch Time: 435.12 ms, GPU Bubble Ratio: 36.80%, 25.58%, 34.73%, 27.07%
[rank3]:2025-10-29 06:58:51,912 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0658_stage3_step300.svg
[rank1]:2025-10-29 06:58:52,290 - INFO - Avg. fwd time: 17.1291 / Avg. bwd time: 26.8306 / Avg. batch time: 543.8897 (ms) / GPU bubble ratio: 35.34%
[rank3]:2025-10-29 06:58:52,245 - INFO - Avg. fwd time: 16.4636 / Avg. bwd time: 26.9825 / Avg. batch time: 363.6650 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-10-29 06:58:52,295 - INFO - Avg. fwd time: 15.3713 / Avg. bwd time: 16.6139 / Avg. batch time: 577.4203 (ms) / GPU bubble ratio: 55.69%
[rank2]:2025-10-29 06:58:52,266 - INFO - Avg. fwd time: 14.7226 / Avg. bwd time: 23.2367 / Avg. batch time: 495.1207 (ms) / GPU bubble ratio: 38.67%
[rank0]:2025-10-29 07:00:36,183 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:00:37,841 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,342  tflops: 342.45  mfu: 34.63%
[rank2]:2025-10-29 07:00:37,840 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,343  tflops: 342.46  mfu: 34.63%
[rank0]:2025-10-29 07:00:37,840 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,342  tflops: 342.45  mfu: 34.63%
[rank0]:2025-10-29 07:00:37,940 - INFO - Avg. fwd time: 15.4507 / Avg. bwd time: 14.4489 / Avg. batch time: 570.5860 (ms) / GPU bubble ratio: 58.08%
[rank3]:2025-10-29 07:00:44,249 - INFO -  step: 350  loss:  1.1710  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,277  tflops: 339.41  mfu: 34.32%
[rank3]:2025-10-29 07:00:44,522 - INFO - Avg. fwd time: 16.5804 / Avg. bwd time: 25.9805 / Avg. batch time: 356.4793 (ms) / GPU bubble ratio: 4.49%
[rank1]:2025-10-29 07:00:44,569 - INFO - Avg. fwd time: 17.2505 / Avg. bwd time: 25.7785 / Avg. batch time: 539.2973 (ms) / GPU bubble ratio: 36.17%
[rank2]:2025-10-29 07:00:44,544 - INFO - Avg. fwd time: 14.8255 / Avg. bwd time: 22.3366 / Avg. batch time: 491.9557 (ms) / GPU bubble ratio: 39.57%
[rank0]:2025-10-29 07:02:26,415 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:02:28,166 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank3_trend_line.svg
[rank0]:2025-10-29 07:02:28,199 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank0_trend_line.svg
[rank2]:2025-10-29 07:02:28,192 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank2_trend_line.svg
[rank1]:2025-10-29 07:02:28,211 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0702_rank1_trend_line.svg
[rank1]:2025-10-29 07:02:28,216 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:02:28,219 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank1]:2025-10-29 07:02:28,219 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 07:02:28,217 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:02:28,219 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank0]:2025-10-29 07:02:28,219 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-29 07:02:28,217 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.72/0.72, [MB1] 0.72/0.72, [MB2] 0.76/0.76, [MB3] 0.81/0.81, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:02:28,220 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,422  tflops: 346.15  mfu: 35.00%
[rank2]:2025-10-29 07:02:28,220 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-29 07:02:28,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0702_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 362.84 ms, GPU Bubble Ratio: 51.82%, 24.61%, 32.82%, 24.76%
[rank3]:2025-10-29 07:02:28,407 - INFO - 	> Batch Time: 362.84 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:02:28,407 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:02:33,695 - INFO -  step: 400  loss:  0.6926  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,485  tflops: 349.11  mfu: 35.30%
[rank3]:2025-10-29 07:02:33,695 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-29 07:02:50,166 - INFO - validate step: 400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,663
[rank2]:2025-10-29 07:02:50,219 - INFO - validate step: 400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,619
[rank3]:2025-10-29 07:02:50,230 - INFO - validate step: 400  loss:  0.3658  memory: 84.24GiB(60.25%)  tps: 24,772
[rank1]:2025-10-29 07:02:50,205 - INFO - validate step: 400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,631
[rank0]:2025-10-29 07:02:50,309 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0702_stage0_step400.svg
[rank2]:2025-10-29 07:02:50,311 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0702_stage2_step400.svg
[rank1]:2025-10-29 07:02:50,307 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0702_stage1_step400.svg
[rank0]:2025-10-29 07:02:50,394 - INFO - Avg. fwd time: 15.4985 / Avg. bwd time: 12.5422 / Avg. batch time: 565.0481 (ms) / GPU bubble ratio: 60.30%
[rank3]:2025-10-29 07:02:50,412 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0702_real_step400_rank3.svg
[rank3]:> Batch Time: 383.66 ms, GPU Bubble Ratio: 67.07%, 23.25%, 33.52%, 23.58%
[rank3]:2025-10-29 07:02:50,481 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0702_stage3_step400.svg
[rank3]:2025-10-29 07:02:50,726 - INFO - Avg. fwd time: 16.6579 / Avg. bwd time: 25.0731 / Avg. batch time: 349.7427 (ms) / GPU bubble ratio: 4.54%
[rank1]:2025-10-29 07:02:50,773 - INFO - Avg. fwd time: 17.3342 / Avg. bwd time: 24.8369 / Avg. batch time: 535.7492 (ms) / GPU bubble ratio: 37.03%
[rank2]:2025-10-29 07:02:50,747 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 21.5283 / Avg. batch time: 489.6826 (ms) / GPU bubble ratio: 40.49%
[rank0]:2025-10-29 07:04:27,150 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:04:28,687 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,315  tflops: 387.81  mfu: 39.21%
[rank2]:2025-10-29 07:04:28,687 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,319  tflops: 388.02  mfu: 39.23%
[rank1]:2025-10-29 07:04:28,688 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,318  tflops: 387.96  mfu: 39.23%
[rank3]:2025-10-29 07:04:34,041 - INFO -  step: 450  loss:  0.8578  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,891  tflops: 368.06  mfu: 37.22%
[rank3]:2025-10-29 07:04:34,348 - INFO - Avg. fwd time: 16.6340 / Avg. bwd time: 24.3009 / Avg. batch time: 343.2840 (ms) / GPU bubble ratio: 4.60%
[rank0]:2025-10-29 07:04:34,398 - INFO - Avg. fwd time: 15.4738 / Avg. bwd time: 11.0802 / Avg. batch time: 558.1618 (ms) / GPU bubble ratio: 61.94%
[rank2]:2025-10-29 07:04:34,369 - INFO - Avg. fwd time: 14.9010 / Avg. bwd time: 20.8613 / Avg. batch time: 485.4100 (ms) / GPU bubble ratio: 41.06%
[rank1]:2025-10-29 07:04:34,392 - INFO - Avg. fwd time: 17.3247 / Avg. bwd time: 24.0605 / Avg. batch time: 530.4294 (ms) / GPU bubble ratio: 37.58%
[rank0]:2025-10-29 07:06:10,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,948  tflops: 370.71  mfu: 37.48%
[rank0]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,948  tflops: 370.70  mfu: 37.48%
[rank2]:2025-10-29 07:06:11,755 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,948  tflops: 370.70  mfu: 37.48%
[rank3]:2025-10-29 07:06:17,019 - INFO -  step: 500  loss:  0.9205  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,955  tflops: 371.03  mfu: 37.52%
[rank0]:2025-10-29 07:06:17,094 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0706_stage0_step500.svg
[rank2]:2025-10-29 07:06:17,094 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0706_stage2_step500.svg
[rank1]:2025-10-29 07:06:17,092 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0706_stage1_step500.svg
[rank0]:2025-10-29 07:06:17,182 - INFO - Avg. fwd time: 15.4532 / Avg. bwd time: 10.0737 / Avg. batch time: 552.3181 (ms) / GPU bubble ratio: 63.03%
[rank3]:2025-10-29 07:06:17,206 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0706_real_step500_rank3.svg
[rank3]:> Batch Time: 379.31 ms, GPU Bubble Ratio: 67.08%, 23.20%, 33.59%, 23.67%
[rank3]:2025-10-29 07:06:17,269 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0706_stage3_step500.svg
[rank3]:2025-10-29 07:06:17,509 - INFO - Avg. fwd time: 16.6148 / Avg. bwd time: 23.7647 / Avg. batch time: 338.7783 (ms) / GPU bubble ratio: 4.65%
[rank1]:2025-10-29 07:06:17,554 - INFO - Avg. fwd time: 17.3146 / Avg. bwd time: 23.5232 / Avg. batch time: 525.6673 (ms) / GPU bubble ratio: 37.85%
[rank2]:2025-10-29 07:06:17,529 - INFO - Avg. fwd time: 14.9004 / Avg. bwd time: 20.3993 / Avg. batch time: 481.3703 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 07:07:53,464 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:07:54,990 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank1]:2025-10-29 07:07:54,991 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank0]:2025-10-29 07:07:54,991 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,935  tflops: 370.10  mfu: 37.42%
[rank0]:2025-10-29 07:07:55,079 - INFO - Avg. fwd time: 15.4341 / Avg. bwd time: 9.1085 / Avg. batch time: 545.2257 (ms) / GPU bubble ratio: 63.99%
[rank3]:2025-10-29 07:08:00,502 - INFO -  step: 550  loss:  0.8960  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,916  tflops: 369.22  mfu: 37.33%
[rank3]:2025-10-29 07:08:00,742 - INFO - Avg. fwd time: 16.5971 / Avg. bwd time: 23.2515 / Avg. batch time: 334.4713 (ms) / GPU bubble ratio: 4.69%
[rank2]:2025-10-29 07:08:00,762 - INFO - Avg. fwd time: 14.9007 / Avg. bwd time: 19.9576 / Avg. batch time: 476.0017 (ms) / GPU bubble ratio: 41.41%
[rank1]:2025-10-29 07:08:00,786 - INFO - Avg. fwd time: 17.3056 / Avg. bwd time: 23.0095 / Avg. batch time: 519.6088 (ms) / GPU bubble ratio: 37.93%
[rank0]:2025-10-29 07:09:36,614 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-29 07:09:38,416 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank3_trend_line.svg
[rank0]:2025-10-29 07:09:38,457 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank0_trend_line.svg
[rank0]:2025-10-29 07:09:38,462 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,917  tflops: 369.25  mfu: 37.34%
[rank0]:2025-10-29 07:09:38,465 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-29 07:09:38,450 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank2_trend_line.svg
[rank2]:2025-10-29 07:09:38,463 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.73/0.73, [MB1] 0.77/0.77, [MB2] 0.80/0.80, [MB3] 0.84/0.84, [MB4] 0.88/0.88, [MB5] 0.92/0.92, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,917  tflops: 369.24  mfu: 37.34%
[rank2]:2025-10-29 07:09:38,466 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-29 07:09:38,454 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0709_rank1_trend_line.svg
[rank1]:2025-10-29 07:09:38,462 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:09:38,465 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,917  tflops: 369.25  mfu: 37.34%
[rank1]:2025-10-29 07:09:38,465 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-29 07:09:38,648 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0709_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 356.93 ms, GPU Bubble Ratio: 59.16%, 24.02%, 33.50%, 24.39%
[rank3]:2025-10-29 07:09:38,648 - INFO - 	> Batch Time: 356.93 ms (Average Freeze Ratio: 0.72)
[rank3]:2025-10-29 07:09:38,649 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:09:43,775 - INFO -  step: 600  loss:  0.8387  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,933  tflops: 369.98  mfu: 37.41%
[rank3]:2025-10-29 07:09:43,775 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-29 07:10:00,235 - INFO - validate step: 600  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,815
[rank2]:2025-10-29 07:10:00,288 - INFO - validate step: 600  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,770
[rank3]:2025-10-29 07:10:00,300 - INFO - validate step: 600  loss:  0.3725  memory: 84.24GiB(60.25%)  tps: 24,789
[rank1]:2025-10-29 07:10:00,272 - INFO - validate step: 600  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,783
[rank0]:2025-10-29 07:10:00,374 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0710_stage0_step600.svg
[rank2]:2025-10-29 07:10:00,375 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0710_stage2_step600.svg
[rank1]:2025-10-29 07:10:00,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0710_stage1_step600.svg
[rank3]:2025-10-29 07:10:00,479 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0710_real_step600_rank3.svg
[rank3]:> Batch Time: 376.68 ms, GPU Bubble Ratio: 67.14%, 23.17%, 33.52%, 23.70%
[rank3]:2025-10-29 07:10:00,543 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0710_stage3_step600.svg
[rank2]:2025-10-29 07:10:00,873 - INFO - Avg. fwd time: 14.9009 / Avg. bwd time: 19.5934 / Avg. batch time: 473.7886 (ms) / GPU bubble ratio: 41.76%
[rank3]:2025-10-29 07:10:00,851 - INFO - Avg. fwd time: 16.5819 / Avg. bwd time: 22.8271 / Avg. batch time: 330.9063 (ms) / GPU bubble ratio: 4.72%
[rank1]:2025-10-29 07:10:00,897 - INFO - Avg. fwd time: 17.2964 / Avg. bwd time: 22.5825 / Avg. batch time: 516.8145 (ms) / GPU bubble ratio: 38.27%
[rank0]:2025-10-29 07:10:00,903 - INFO - Avg. fwd time: 15.4181 / Avg. bwd time: 8.3122 / Avg. batch time: 541.5777 (ms) / GPU bubble ratio: 64.95%
[rank0]:2025-10-29 07:12:12,963 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:12:15,250 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 6,069  tflops: 283.07  mfu: 28.62%
[rank0]:2025-10-29 07:12:15,277 - INFO -  step: 650  loss: -4.0000  grad_norm: 10.9795  memory: 74.20GiB(53.07%)  tps: 6,066  tflops: 282.93  mfu: 28.61%
[rank2]:2025-10-29 07:12:15,250 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 6,070  tflops: 283.10  mfu: 28.62%
[rank3]:2025-10-29 07:12:20,367 - INFO -  step: 650  loss:  0.7035  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,849  tflops: 272.78  mfu: 27.58%
[rank3]:2025-10-29 07:12:20,609 - INFO - Avg. fwd time: 16.5710 / Avg. bwd time: 22.5194 / Avg. batch time: 328.3219 (ms) / GPU bubble ratio: 4.75%
[rank2]:2025-10-29 07:12:20,630 - INFO - Avg. fwd time: 14.9015 / Avg. bwd time: 19.3293 / Avg. batch time: 472.5338 (ms) / GPU bubble ratio: 42.05%
[rank1]:2025-10-29 07:12:20,689 - INFO - Avg. fwd time: 17.2807 / Avg. bwd time: 22.2533 / Avg. batch time: 519.3359 (ms) / GPU bubble ratio: 39.10%
[rank0]:2025-10-29 07:12:20,808 - INFO - Avg. fwd time: 15.3060 / Avg. bwd time: 10.4231 / Avg. batch time: 550.4501 (ms) / GPU bubble ratio: 62.61%
[rank0]:2025-10-29 07:14:33,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:14:35,523 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank1]:2025-10-29 07:14:35,523 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank0]:2025-10-29 07:14:35,549 - INFO -  step: 700  loss: -4.0000  grad_norm: 51.0152  memory: 74.20GiB(53.07%)  tps: 5,840  tflops: 272.38  mfu: 27.54%
[rank3]:2025-10-29 07:14:40,615 - INFO -  step: 700  loss:  0.7788  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,841  tflops: 272.43  mfu: 27.55%
[rank0]:2025-10-29 07:14:40,692 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0714_stage0_step700.svg
[rank2]:2025-10-29 07:14:40,696 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0714_stage2_step700.svg
[rank1]:2025-10-29 07:14:40,693 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0714_stage1_step700.svg
[rank3]:2025-10-29 07:14:40,798 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0714_real_step700_rank3.svg
[rank3]:> Batch Time: 374.50 ms, GPU Bubble Ratio: 67.19%, 23.20%, 33.42%, 23.70%
[rank3]:2025-10-29 07:14:40,865 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0714_stage3_step700.svg
[rank2]:2025-10-29 07:14:41,129 - INFO - Avg. fwd time: 14.9008 / Avg. bwd time: 19.0636 / Avg. batch time: 471.9456 (ms) / GPU bubble ratio: 42.43%
[rank3]:2025-10-29 07:14:41,108 - INFO - Avg. fwd time: 16.5574 / Avg. bwd time: 22.2103 / Avg. batch time: 325.7030 (ms) / GPU bubble ratio: 4.78%
[rank1]:2025-10-29 07:14:41,188 - INFO - Avg. fwd time: 17.2600 / Avg. bwd time: 21.9185 / Avg. batch time: 522.5380 (ms) / GPU bubble ratio: 40.02%
[rank0]:2025-10-29 07:14:41,308 - INFO - Avg. fwd time: 15.1924 / Avg. bwd time: 12.5451 / Avg. batch time: 560.0415 (ms) / GPU bubble ratio: 60.38%
[rank0]:2025-10-29 07:16:53,408 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:16:55,719 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank1]:2025-10-29 07:16:55,719 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank0]:2025-10-29 07:16:55,745 - INFO -  step: 750  loss: -4.0000  grad_norm:  9.7250  memory: 74.20GiB(53.07%)  tps: 5,843  tflops: 272.53  mfu: 27.56%
[rank3]:2025-10-29 07:17:00,842 - INFO -  step: 750  loss:  0.7182  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,842  tflops: 272.47  mfu: 27.55%
[rank3]:2025-10-29 07:17:01,155 - INFO - Avg. fwd time: 16.5460 / Avg. bwd time: 21.9451 / Avg. batch time: 323.4585 (ms) / GPU bubble ratio: 4.80%
[rank2]:2025-10-29 07:17:01,184 - INFO - Avg. fwd time: 14.9003 / Avg. bwd time: 18.8351 / Avg. batch time: 471.4291 (ms) / GPU bubble ratio: 42.75%
[rank1]:2025-10-29 07:17:01,264 - INFO - Avg. fwd time: 17.2418 / Avg. bwd time: 21.6294 / Avg. batch time: 525.2817 (ms) / GPU bubble ratio: 40.80%
[rank0]:2025-10-29 07:17:01,363 - INFO - Avg. fwd time: 15.0936 / Avg. bwd time: 14.3686 / Avg. batch time: 568.2701 (ms) / GPU bubble ratio: 58.52%
[rank0]:2025-10-29 07:19:13,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:19:15,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank1_trend_line.svg
[rank3]:2025-10-29 07:19:15,983 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank3_trend_line.svg
[rank2]:2025-10-29 07:19:16,014 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank2_trend_line.svg
[rank1]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:19:16,092 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 5,836  tflops: 272.19  mfu: 27.52%
[rank1]:2025-10-29 07:19:16,092 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 07:19:16,083 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0719_rank0_trend_line.svg
[rank0]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:19:16,091 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.0141  memory: 74.20GiB(53.07%)  tps: 5,837  tflops: 272.24  mfu: 27.53%
[rank0]:2025-10-29 07:19:16,091 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-29 07:19:16,089 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.70/0.70, [MB1] 0.74/0.74, [MB2] 0.79/0.79, [MB3] 0.83/0.83, [MB4] 0.87/0.87, [MB5] 0.91/0.91, [MB6] 0.96/0.96, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:19:16,093 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 5,836  tflops: 272.19  mfu: 27.52%
[rank2]:2025-10-29 07:19:16,093 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-29 07:19:16,279 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0719_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.54 ms, GPU Bubble Ratio: 35.10%, 24.07%, 33.08%, 24.44%
[rank3]:2025-10-29 07:19:16,279 - INFO - 	> Batch Time: 355.54 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:19:16,279 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:19:21,406 - INFO -  step: 800  loss:  0.6972  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 5,828  tflops: 271.82  mfu: 27.48%
[rank3]:2025-10-29 07:19:21,407 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-29 07:19:37,791 - INFO - validate step: 800  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,876
[rank2]:2025-10-29 07:19:37,840 - INFO - validate step: 800  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,835
[rank1]:2025-10-29 07:19:37,823 - INFO - validate step: 800  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,849
[rank3]:2025-10-29 07:19:37,852 - INFO - validate step: 800  loss:  0.3536  memory: 84.24GiB(60.25%)  tps: 24,908
[rank0]:2025-10-29 07:19:37,934 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0719_stage0_step800.svg
[rank2]:2025-10-29 07:19:37,934 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0719_stage2_step800.svg
[rank1]:2025-10-29 07:19:37,929 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0719_stage1_step800.svg
[rank3]:2025-10-29 07:19:38,039 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0719_real_step800_rank3.svg
[rank3]:> Batch Time: 372.46 ms, GPU Bubble Ratio: 67.21%, 23.20%, 33.29%, 23.73%
[rank3]:2025-10-29 07:19:38,110 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0719_stage3_step800.svg
[rank2]:2025-10-29 07:19:38,379 - INFO - Avg. fwd time: 14.8991 / Avg. bwd time: 18.6623 / Avg. batch time: 470.5374 (ms) / GPU bubble ratio: 42.94%
[rank3]:2025-10-29 07:19:38,358 - INFO - Avg. fwd time: 16.5364 / Avg. bwd time: 21.7437 / Avg. batch time: 321.7467 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-10-29 07:19:38,438 - INFO - Avg. fwd time: 17.2268 / Avg. bwd time: 21.4108 / Avg. batch time: 526.8372 (ms) / GPU bubble ratio: 41.33%
[rank0]:2025-10-29 07:19:38,555 - INFO - Avg. fwd time: 15.0175 / Avg. bwd time: 15.7386 / Avg. batch time: 573.9442 (ms) / GPU bubble ratio: 57.13%
[rank0]:2025-10-29 07:21:14,448 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,344  tflops: 389.18  mfu: 39.35%
[rank0]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,342  tflops: 389.06  mfu: 39.34%
[rank2]:2025-10-29 07:21:15,997 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,346  tflops: 389.25  mfu: 39.36%
[rank0]:2025-10-29 07:21:16,084 - INFO - Avg. fwd time: 15.0250 / Avg. bwd time: 14.9924 / Avg. batch time: 569.0565 (ms) / GPU bubble ratio: 57.80%
[rank3]:2025-10-29 07:21:21,102 - INFO -  step: 850  loss:  0.7170  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,934  tflops: 370.06  mfu: 37.42%
[rank2]:2025-10-29 07:21:21,362 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 18.4879 / Avg. batch time: 467.8385 (ms) / GPU bubble ratio: 42.91%
[rank1]:2025-10-29 07:21:21,386 - INFO - Avg. fwd time: 17.2245 / Avg. bwd time: 21.2086 / Avg. batch time: 523.2969 (ms) / GPU bubble ratio: 41.24%
[rank3]:2025-10-29 07:21:21,342 - INFO - Avg. fwd time: 16.5302 / Avg. bwd time: 21.5414 / Avg. batch time: 320.0555 (ms) / GPU bubble ratio: 4.84%
[rank0]:2025-10-29 07:22:56,691 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank2]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank1]:2025-10-29 07:22:58,207 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,015  tflops: 373.82  mfu: 37.80%
[rank3]:2025-10-29 07:23:03,358 - INFO -  step: 900  loss:  0.7021  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,011  tflops: 373.66  mfu: 37.78%
[rank0]:2025-10-29 07:23:03,431 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0722_stage0_step900.svg
[rank2]:2025-10-29 07:23:03,431 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0722_stage2_step900.svg
[rank1]:2025-10-29 07:23:03,426 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0722_stage1_step900.svg
[rank3]:2025-10-29 07:23:03,541 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0723_real_step900_rank3.svg
[rank3]:> Batch Time: 371.28 ms, GPU Bubble Ratio: 67.12%, 23.18%, 33.21%, 23.78%
[rank3]:2025-10-29 07:23:03,602 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0723_stage3_step900.svg
[rank2]:2025-10-29 07:23:03,928 - INFO - Avg. fwd time: 14.8998 / Avg. bwd time: 18.3335 / Avg. batch time: 466.6112 (ms) / GPU bubble ratio: 43.02%
[rank1]:2025-10-29 07:23:03,953 - INFO - Avg. fwd time: 17.2232 / Avg. bwd time: 21.0313 / Avg. batch time: 520.9951 (ms) / GPU bubble ratio: 41.26%
[rank3]:2025-10-29 07:23:03,906 - INFO - Avg. fwd time: 16.5242 / Avg. bwd time: 21.3619 / Avg. batch time: 318.5521 (ms) / GPU bubble ratio: 4.85%
[rank0]:2025-10-29 07:23:03,959 - INFO - Avg. fwd time: 15.0381 / Avg. bwd time: 14.1183 / Avg. batch time: 565.0090 (ms) / GPU bubble ratio: 58.72%
[rank0]:2025-10-29 07:24:39,486 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank1]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank2]:2025-10-29 07:24:41,009 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank0]:2025-10-29 07:24:41,098 - INFO - Avg. fwd time: 15.0482 / Avg. bwd time: 13.4463 / Avg. batch time: 561.5692 (ms) / GPU bubble ratio: 59.41%
[rank3]:2025-10-29 07:24:46,162 - INFO -  step: 950  loss:  0.7228  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,969  tflops: 371.66  mfu: 37.58%
[rank1]:2025-10-29 07:24:46,447 - INFO - Avg. fwd time: 17.2230 / Avg. bwd time: 20.8959 / Avg. batch time: 518.8987 (ms) / GPU bubble ratio: 41.23%
[rank3]:2025-10-29 07:24:46,403 - INFO - Avg. fwd time: 16.5199 / Avg. bwd time: 21.2242 / Avg. batch time: 317.4005 (ms) / GPU bubble ratio: 4.87%
[rank2]:2025-10-29 07:24:46,423 - INFO - Avg. fwd time: 14.8999 / Avg. bwd time: 18.2151 / Avg. batch time: 465.3413 (ms) / GPU bubble ratio: 43.07%
[rank0]:2025-10-29 07:26:21,885 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:26:23,412 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank1]:2025-10-29 07:26:23,412 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-29 07:26:23,411 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank2]:2025-10-29 07:26:23,411 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 07:26:23,411 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,000  tflops: 373.11  mfu: 37.73%
[rank0]:2025-10-29 07:26:23,411 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-29 07:26:28,569 - INFO -  step: 1000  loss:  0.7074  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,000  tflops: 373.10  mfu: 37.72%
[rank3]:2025-10-29 07:26:28,569 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-29 07:26:44,963 - INFO - validate step: 1000  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,006
[rank1]:2025-10-29 07:26:44,999 - INFO - validate step: 1000  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,975
[rank3]:2025-10-29 07:26:45,025 - INFO - validate step: 1000  loss:  0.3541  memory: 84.24GiB(60.25%)  tps: 24,892
[rank2]:2025-10-29 07:26:45,015 - INFO - validate step: 1000  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,960
[rank0]:2025-10-29 07:26:45,103 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0726_stage0_step1000.svg
[rank1]:2025-10-29 07:26:45,097 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0726_stage1_step1000.svg
[rank2]:2025-10-29 07:26:45,101 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0726_stage2_step1000.svg
[rank0]:2025-10-29 07:26:45,193 - INFO - Avg. fwd time: 15.0574 / Avg. bwd time: 12.7390 / Avg. batch time: 558.3107 (ms) / GPU bubble ratio: 60.17%
[rank3]:2025-10-29 07:26:45,204 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0726_real_step1000_rank3.svg
[rank3]:> Batch Time: 370.54 ms, GPU Bubble Ratio: 67.06%, 23.15%, 33.18%, 23.79%
[rank3]:2025-10-29 07:26:45,266 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0726_stage3_step1000.svg
[rank1]:2025-10-29 07:26:45,555 - INFO - Avg. fwd time: 17.2210 / Avg. bwd time: 20.7522 / Avg. batch time: 517.0541 (ms) / GPU bubble ratio: 41.25%
[rank3]:2025-10-29 07:26:45,509 - INFO - Avg. fwd time: 16.5144 / Avg. bwd time: 21.0770 / Avg. batch time: 316.1617 (ms) / GPU bubble ratio: 4.88%
[rank2]:2025-10-29 07:26:45,530 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 18.0889 / Avg. batch time: 464.3673 (ms) / GPU bubble ratio: 43.17%
[rank0]:2025-10-29 07:28:21,315 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,373  tflops: 390.51  mfu: 39.49%
[rank0]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,368  tflops: 390.30  mfu: 39.46%
[rank1]:2025-10-29 07:28:22,855 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,371  tflops: 390.45  mfu: 39.48%
[rank3]:2025-10-29 07:28:27,993 - INFO -  step: 1050  loss:  0.7136  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,956  tflops: 371.07  mfu: 37.52%
[rank3]:2025-10-29 07:28:28,303 - INFO - Avg. fwd time: 16.5107 / Avg. bwd time: 20.9463 / Avg. batch time: 315.0721 (ms) / GPU bubble ratio: 4.89%
[rank2]:2025-10-29 07:28:28,327 - INFO - Avg. fwd time: 14.8992 / Avg. bwd time: 17.9759 / Avg. batch time: 463.5846 (ms) / GPU bubble ratio: 43.27%
[rank0]:2025-10-29 07:28:28,361 - INFO - Avg. fwd time: 15.0671 / Avg. bwd time: 12.1023 / Avg. batch time: 555.4776 (ms) / GPU bubble ratio: 60.87%
[rank1]:2025-10-29 07:28:28,353 - INFO - Avg. fwd time: 17.2214 / Avg. bwd time: 20.6241 / Avg. batch time: 515.4922 (ms) / GPU bubble ratio: 41.27%
[rank0]:2025-10-29 07:30:03,690 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank0]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank1]:2025-10-29 07:30:05,238 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank3]:2025-10-29 07:30:10,370 - INFO -  step: 1100  loss:  0.6967  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,002  tflops: 373.21  mfu: 37.74%
[rank2]:2025-10-29 07:30:10,449 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0730_stage2_step1100.svg
[rank0]:2025-10-29 07:30:10,448 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0730_stage0_step1100.svg
[rank1]:2025-10-29 07:30:10,443 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0730_stage1_step1100.svg
[rank0]:2025-10-29 07:30:10,536 - INFO - Avg. fwd time: 15.0743 / Avg. bwd time: 11.6052 / Avg. batch time: 552.8424 (ms) / GPU bubble ratio: 61.39%
[rank3]:2025-10-29 07:30:10,553 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0730_real_step1100_rank3.svg
[rank3]:> Batch Time: 369.96 ms, GPU Bubble Ratio: 67.03%, 23.11%, 33.16%, 23.81%
[rank3]:2025-10-29 07:30:10,616 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0730_stage3_step1100.svg
[rank1]:2025-10-29 07:30:10,905 - INFO - Avg. fwd time: 17.2210 / Avg. bwd time: 20.5241 / Avg. batch time: 513.8504 (ms) / GPU bubble ratio: 41.24%
[rank3]:2025-10-29 07:30:10,859 - INFO - Avg. fwd time: 16.5074 / Avg. bwd time: 20.8442 / Avg. batch time: 314.2177 (ms) / GPU bubble ratio: 4.90%
[rank2]:2025-10-29 07:30:10,880 - INFO - Avg. fwd time: 14.8994 / Avg. bwd time: 17.8883 / Avg. batch time: 462.5530 (ms) / GPU bubble ratio: 43.29%
[rank0]:2025-10-29 07:31:46,273 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank0]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank1]:2025-10-29 07:31:47,833 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,985  tflops: 372.41  mfu: 37.66%
[rank0]:2025-10-29 07:31:47,922 - INFO - Avg. fwd time: 15.0818 / Avg. bwd time: 11.0746 / Avg. batch time: 549.3111 (ms) / GPU bubble ratio: 61.91%
[rank3]:2025-10-29 07:31:53,004 - INFO -  step: 1150  loss:  0.7053  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,982  tflops: 372.28  mfu: 37.64%
[rank1]:2025-10-29 07:31:53,297 - INFO - Avg. fwd time: 17.2204 / Avg. bwd time: 20.4170 / Avg. batch time: 511.3800 (ms) / GPU bubble ratio: 41.12%
[rank3]:2025-10-29 07:31:53,252 - INFO - Avg. fwd time: 16.5035 / Avg. bwd time: 20.7344 / Avg. batch time: 313.2958 (ms) / GPU bubble ratio: 4.91%
[rank2]:2025-10-29 07:31:53,272 - INFO - Avg. fwd time: 14.8993 / Avg. bwd time: 17.7948 / Avg. batch time: 460.7326 (ms) / GPU bubble ratio: 43.23%
[rank0]:2025-10-29 07:33:28,749 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank2]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank0]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-29 07:33:30,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,993  tflops: 372.82  mfu: 37.70%
[rank1]:2025-10-29 07:33:30,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-29 07:33:35,464 - INFO -  step: 1200  loss:  0.6884  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,996  tflops: 372.91  mfu: 37.71%
[rank3]:2025-10-29 07:33:35,464 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-29 07:33:51,945 - INFO - validate step: 1200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 18,939
[rank2]:2025-10-29 07:33:51,945 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 07:33:51,892 - INFO - validate step: 1200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 18,985
[rank0]:2025-10-29 07:33:51,893 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 07:33:51,896 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-10-29 07:33:51,929 - INFO - validate step: 1200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 18,953
[rank1]:2025-10-29 07:33:51,930 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 07:33:51,957 - INFO - validate step: 1200  loss:  0.3527  memory: 84.24GiB(60.25%)  tps: 24,837
[rank3]:2025-10-29 07:33:51,958 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 07:34:06,725 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.78 seconds.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank0]:2025-10-29 07:34:07,172 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-29 07:34:07,178 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.28 seconds.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank1]:2025-10-29 07:34:08,952 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.02 seconds.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank3]:2025-10-29 07:34:09,087 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.13 seconds.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-1200, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank2]:2025-10-29 07:34:09,236 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0734_stage2_step1200.svg
[rank2]:2025-10-29 07:34:09,248 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank0]:2025-10-29 07:34:09,229 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0734_stage0_step1200.svg
[rank0]:2025-10-29 07:34:09,239 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 07:34:09,226 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0734_stage1_step1200.svg
[rank1]:2025-10-29 07:34:09,234 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank3]:2025-10-29 07:34:09,361 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0734_real_step1200_rank3.svg
[rank3]:> Batch Time: 369.50 ms, GPU Bubble Ratio: 67.01%, 23.07%, 33.12%, 23.81%
[rank3]:2025-10-29 07:34:09,432 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0734_stage3_step1200.svg
[rank3]:2025-10-29 07:34:09,444 - WARNING - Datasets ['medical', 'alpaca'] are being re-looped
[rank1]:2025-10-29 07:34:09,814 - INFO - Avg. fwd time: 17.2208 / Avg. bwd time: 20.3201 / Avg. batch time: 510.2425 (ms) / GPU bubble ratio: 41.14%
[rank3]:2025-10-29 07:34:09,762 - INFO - Avg. fwd time: 16.5013 / Avg. bwd time: 20.6368 / Avg. batch time: 312.4871 (ms) / GPU bubble ratio: 4.92%
[rank2]:2025-10-29 07:34:09,788 - INFO - Avg. fwd time: 14.8999 / Avg. bwd time: 17.7104 / Avg. batch time: 460.1908 (ms) / GPU bubble ratio: 43.31%
[rank0]:2025-10-29 07:34:09,823 - INFO - Avg. fwd time: 15.0894 / Avg. bwd time: 10.5903 / Avg. batch time: 547.2074 (ms) / GPU bubble ratio: 62.46%
[rank0]:2025-10-29 07:35:56,753 - INFO - [GC] Peforming periodical GC collection 2.38 seconds
[rank2]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 6,478  tflops: 302.12  mfu: 30.55%
[rank0]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 6,475  tflops: 301.99  mfu: 30.54%
[rank1]:2025-10-29 07:35:58,410 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 6,477  tflops: 302.08  mfu: 30.54%
[rank0]:2025-10-29 07:35:58,512 - INFO - Avg. fwd time: 15.1216 / Avg. bwd time: 10.2077 / Avg. batch time: 546.4894 (ms) / GPU bubble ratio: 62.92%
[rank3]:2025-10-29 07:36:04,158 - INFO -  step: 1250  loss:  1.1092  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank2]:2025-10-29 07:36:04,449 - INFO - Avg. fwd time: 14.9223 / Avg. bwd time: 17.6608 / Avg. batch time: 460.6531 (ms) / GPU bubble ratio: 43.41%
[rank1]:2025-10-29 07:36:04,475 - INFO - Avg. fwd time: 17.2508 / Avg. bwd time: 20.2630 / Avg. batch time: 510.2644 (ms) / GPU bubble ratio: 41.19%
[rank3]:2025-10-29 07:36:04,428 - INFO - Avg. fwd time: 16.5310 / Avg. bwd time: 20.5871 / Avg. batch time: 312.4604 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 07:37:43,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:37:45,141 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank0]:2025-10-29 07:37:45,141 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank1]:2025-10-29 07:37:45,142 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,675  tflops: 357.98  mfu: 36.20%
[rank3]:2025-10-29 07:37:49,717 - INFO -  step: 1300  loss:  1.1526  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,761  tflops: 361.96  mfu: 36.60%
[rank2]:2025-10-29 07:37:49,796 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0737_stage2_step1300.svg
[rank0]:2025-10-29 07:37:49,797 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0737_stage0_step1300.svg
[rank1]:2025-10-29 07:37:49,796 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0737_stage1_step1300.svg
[rank0]:2025-10-29 07:37:49,900 - INFO - Avg. fwd time: 15.1553 / Avg. bwd time: 9.7949 / Avg. batch time: 544.9941 (ms) / GPU bubble ratio: 63.38%
[rank3]:2025-10-29 07:37:49,900 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0737_real_step1300_rank3.svg
[rank3]:> Batch Time: 370.75 ms, GPU Bubble Ratio: 67.02%, 23.08%, 33.20%, 23.83%
[rank3]:2025-10-29 07:37:49,965 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0737_stage3_step1300.svg
[rank2]:2025-10-29 07:37:50,256 - INFO - Avg. fwd time: 14.9463 / Avg. bwd time: 17.6073 / Avg. batch time: 460.4389 (ms) / GPU bubble ratio: 43.44%
[rank3]:2025-10-29 07:37:50,236 - INFO - Avg. fwd time: 16.5641 / Avg. bwd time: 20.5344 / Avg. batch time: 312.2960 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:37:50,283 - INFO - Avg. fwd time: 17.2825 / Avg. bwd time: 20.2025 / Avg. batch time: 509.5730 (ms) / GPU bubble ratio: 41.15%
[rank0]:2025-10-29 07:39:29,107 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:39:30,763 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank2]:2025-10-29 07:39:30,762 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank1]:2025-10-29 07:39:30,763 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,756  tflops: 361.74  mfu: 36.58%
[rank3]:2025-10-29 07:39:35,372 - INFO -  step: 1350  loss:  1.1264  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,754  tflops: 361.63  mfu: 36.57%
[rank2]:2025-10-29 07:39:35,735 - INFO - Avg. fwd time: 14.9681 / Avg. bwd time: 17.5571 / Avg. batch time: 460.0435 (ms) / GPU bubble ratio: 43.44%
[rank1]:2025-10-29 07:39:35,763 - INFO - Avg. fwd time: 17.3123 / Avg. bwd time: 20.1474 / Avg. batch time: 508.7384 (ms) / GPU bubble ratio: 41.09%
[rank3]:2025-10-29 07:39:35,710 - INFO - Avg. fwd time: 16.5946 / Avg. bwd time: 20.4860 / Avg. batch time: 312.1454 (ms) / GPU bubble ratio: 4.97%
[rank0]:2025-10-29 07:39:35,772 - INFO - Avg. fwd time: 15.1860 / Avg. bwd time: 9.4142 / Avg. batch time: 543.4184 (ms) / GPU bubble ratio: 63.78%
[rank0]:2025-10-29 07:41:14,546 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank1]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank0]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-29 07:41:16,202 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,769  tflops: 362.37  mfu: 36.64%
[rank2]:2025-10-29 07:41:16,202 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-29 07:41:20,822 - INFO -  step: 1400  loss:  1.1698  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,769  tflops: 362.33  mfu: 36.64%
[rank3]:2025-10-29 07:41:20,823 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-29 07:41:37,316 - INFO - validate step: 1400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,400
[rank1]:2025-10-29 07:41:37,350 - INFO - validate step: 1400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,369
[rank2]:2025-10-29 07:41:37,366 - INFO - validate step: 1400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,354
[rank1]:2025-10-29 07:41:37,461 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0741_stage1_step1400.svg
[rank3]:2025-10-29 07:41:37,380 - INFO - validate step: 1400  loss:  0.3529  memory: 84.24GiB(60.25%)  tps: 24,740
[rank2]:2025-10-29 07:41:37,463 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0741_stage2_step1400.svg
[rank0]:2025-10-29 07:41:37,466 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0741_stage0_step1400.svg
[rank0]:2025-10-29 07:41:37,571 - INFO - Avg. fwd time: 15.2104 / Avg. bwd time: 9.1107 / Avg. batch time: 541.8839 (ms) / GPU bubble ratio: 64.09%
[rank3]:2025-10-29 07:41:37,569 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0741_real_step1400_rank3.svg
[rank3]:> Batch Time: 371.83 ms, GPU Bubble Ratio: 67.02%, 23.09%, 33.24%, 23.84%
[rank3]:2025-10-29 07:41:37,638 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0741_stage3_step1400.svg
[rank1]:2025-10-29 07:41:37,959 - INFO - Avg. fwd time: 17.3362 / Avg. bwd time: 20.1029 / Avg. batch time: 507.7958 (ms) / GPU bubble ratio: 41.02%
[rank3]:2025-10-29 07:41:37,911 - INFO - Avg. fwd time: 16.6184 / Avg. bwd time: 20.4471 / Avg. batch time: 312.0195 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:41:37,932 - INFO - Avg. fwd time: 14.9857 / Avg. bwd time: 17.5178 / Avg. batch time: 459.4527 (ms) / GPU bubble ratio: 43.40%
[rank0]:2025-10-29 07:43:17,416 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,055  tflops: 375.69  mfu: 37.99%
[rank0]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,051  tflops: 375.51  mfu: 37.97%
[rank1]:2025-10-29 07:43:19,066 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,054  tflops: 375.63  mfu: 37.98%
[rank0]:2025-10-29 07:43:19,168 - INFO - Avg. fwd time: 15.2375 / Avg. bwd time: 8.7804 / Avg. batch time: 539.8402 (ms) / GPU bubble ratio: 64.41%
[rank3]:2025-10-29 07:43:23,668 - INFO -  step: 1450  loss:  1.2087  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,708  tflops: 359.48  mfu: 36.35%
[rank3]:2025-10-29 07:43:23,940 - INFO - Avg. fwd time: 16.6448 / Avg. bwd time: 20.4057 / Avg. batch time: 311.8936 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:43:23,960 - INFO - Avg. fwd time: 15.0044 / Avg. bwd time: 17.4743 / Avg. batch time: 458.4306 (ms) / GPU bubble ratio: 43.32%
[rank1]:2025-10-29 07:43:23,986 - INFO - Avg. fwd time: 17.3632 / Avg. bwd time: 20.0559 / Avg. batch time: 506.3950 (ms) / GPU bubble ratio: 40.89%
[rank0]:2025-10-29 07:45:02,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:45:04,509 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank1]:2025-10-29 07:45:04,510 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank2]:2025-10-29 07:45:04,509 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,769  tflops: 362.35  mfu: 36.64%
[rank0]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0745_stage0_step1500.svg
[rank3]:2025-10-29 07:45:09,138 - INFO -  step: 1500  loss:  1.1331  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,767  tflops: 362.27  mfu: 36.63%
[rank1]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0745_stage1_step1500.svg
[rank2]:2025-10-29 07:45:09,221 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0745_stage2_step1500.svg
[rank3]:2025-10-29 07:45:09,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0745_real_step1500_rank3.svg
[rank3]:> Batch Time: 372.91 ms, GPU Bubble Ratio: 67.02%, 23.10%, 33.29%, 23.85%
[rank3]:2025-10-29 07:45:09,397 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0745_stage3_step1500.svg
[rank0]:2025-10-29 07:45:09,796 - INFO - Avg. fwd time: 15.2620 / Avg. bwd time: 8.4733 / Avg. batch time: 538.5996 (ms) / GPU bubble ratio: 64.75%
[rank3]:2025-10-29 07:45:09,734 - INFO - Avg. fwd time: 16.6684 / Avg. bwd time: 20.3657 / Avg. batch time: 311.7560 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:45:09,787 - INFO - Avg. fwd time: 17.3875 / Avg. bwd time: 20.0116 / Avg. batch time: 505.7525 (ms) / GPU bubble ratio: 40.84%
[rank2]:2025-10-29 07:45:09,759 - INFO - Avg. fwd time: 15.0217 / Avg. bwd time: 17.4337 / Avg. batch time: 458.1387 (ms) / GPU bubble ratio: 43.33%
[rank0]:2025-10-29 07:46:48,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:46:50,212 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank0]:2025-10-29 07:46:50,212 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank1]:2025-10-29 07:46:50,213 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,750  tflops: 361.46  mfu: 36.55%
[rank0]:2025-10-29 07:46:50,315 - INFO - Avg. fwd time: 15.2820 / Avg. bwd time: 8.2266 / Avg. batch time: 537.3716 (ms) / GPU bubble ratio: 65.00%
[rank3]:2025-10-29 07:46:54,824 - INFO -  step: 1550  loss:  1.1869  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,751  tflops: 361.53  mfu: 36.55%
[rank3]:2025-10-29 07:46:55,096 - INFO - Avg. fwd time: 16.6880 / Avg. bwd time: 20.3344 / Avg. batch time: 311.6573 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:46:55,116 - INFO - Avg. fwd time: 15.0360 / Avg. bwd time: 17.4019 / Avg. batch time: 457.6757 (ms) / GPU bubble ratio: 43.30%
[rank1]:2025-10-29 07:46:55,142 - INFO - Avg. fwd time: 17.4072 / Avg. bwd time: 19.9761 / Avg. batch time: 505.0054 (ms) / GPU bubble ratio: 40.78%
[rank0]:2025-10-29 07:48:32,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:48:35,101 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank2_trend_line.svg
[rank0]:2025-10-29 07:48:35,121 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank0_trend_line.svg
[rank0]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank0]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:48:35,089 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank3_trend_line.svg
[rank1]:2025-10-29 07:48:35,143 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251029_0748_rank1_trend_line.svg
[rank1]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank1]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-29 07:48:35,149 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.66/0.66, [MB1] 0.70/0.70, [MB2] 0.75/0.75, [MB3] 0.80/0.80, [MB4] 0.85/0.85, [MB5] 0.90/0.90, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-10-29 07:48:35,153 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 7,806  tflops: 364.09  mfu: 36.81%
[rank2]:2025-10-29 07:48:35,153 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-29 07:48:35,343 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0748_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 355.71 ms, GPU Bubble Ratio: 53.04%, 23.66%, 32.81%, 24.31%
[rank3]:2025-10-29 07:48:35,343 - INFO - 	> Batch Time: 355.71 ms (Average Freeze Ratio: 0.74)
[rank3]:2025-10-29 07:48:35,344 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-29 07:48:39,933 - INFO -  step: 1600  loss:  0.6898  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 7,794  tflops: 363.51  mfu: 36.76%
[rank3]:2025-10-29 07:48:39,934 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-29 07:48:56,382 - INFO - validate step: 1600  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,294
[rank2]:2025-10-29 07:48:56,435 - INFO - validate step: 1600  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,247
[rank3]:2025-10-29 07:48:56,449 - INFO - validate step: 1600  loss:  0.3538  memory: 84.24GiB(60.25%)  tps: 24,803
[rank1]:2025-10-29 07:48:56,419 - INFO - validate step: 1600  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,261
[rank2]:2025-10-29 07:48:56,536 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0748_stage2_step1600.svg
[rank0]:2025-10-29 07:48:56,534 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0748_stage0_step1600.svg
[rank1]:2025-10-29 07:48:56,535 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0748_stage1_step1600.svg
[rank0]:2025-10-29 07:48:56,624 - INFO - Avg. fwd time: 15.2996 / Avg. bwd time: 7.9564 / Avg. batch time: 536.1473 (ms) / GPU bubble ratio: 65.30%
[rank3]:2025-10-29 07:48:56,640 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0748_real_step1600_rank3.svg
[rank3]:> Batch Time: 373.78 ms, GPU Bubble Ratio: 67.01%, 23.12%, 33.34%, 23.81%
[rank3]:2025-10-29 07:48:56,710 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0748_stage3_step1600.svg
[rank3]:2025-10-29 07:48:56,960 - INFO - Avg. fwd time: 16.7039 / Avg. bwd time: 20.2947 / Avg. batch time: 311.4613 (ms) / GPU bubble ratio: 4.97%
[rank1]:2025-10-29 07:48:57,006 - INFO - Avg. fwd time: 17.4234 / Avg. bwd time: 19.9333 / Avg. batch time: 504.3112 (ms) / GPU bubble ratio: 40.74%
[rank2]:2025-10-29 07:48:56,980 - INFO - Avg. fwd time: 15.0472 / Avg. bwd time: 17.3631 / Avg. batch time: 457.2977 (ms) / GPU bubble ratio: 43.30%
[rank0]:2025-10-29 07:50:30,813 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,536  tflops: 398.11  mfu: 40.25%
[rank1]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,539  tflops: 398.26  mfu: 40.27%
[rank2]:2025-10-29 07:50:32,355 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,541  tflops: 398.33  mfu: 40.28%
[rank3]:2025-10-29 07:50:36,945 - INFO -  step: 1650  loss:  0.6963  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,152  tflops: 380.20  mfu: 38.44%
[rank3]:2025-10-29 07:50:37,257 - INFO - Avg. fwd time: 16.6958 / Avg. bwd time: 20.2375 / Avg. batch time: 310.9290 (ms) / GPU bubble ratio: 4.97%
[rank2]:2025-10-29 07:50:37,283 - INFO - Avg. fwd time: 15.0427 / Avg. bwd time: 17.3151 / Avg. batch time: 456.6701 (ms) / GPU bubble ratio: 43.32%
[rank0]:2025-10-29 07:50:37,322 - INFO - Avg. fwd time: 15.2983 / Avg. bwd time: 7.7034 / Avg. batch time: 534.6982 (ms) / GPU bubble ratio: 65.59%
[rank1]:2025-10-29 07:50:37,311 - INFO - Avg. fwd time: 17.4179 / Avg. bwd time: 19.8787 / Avg. batch time: 503.3706 (ms) / GPU bubble ratio: 40.72%
[rank0]:2025-10-29 07:52:10,549 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:52:12,065 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank2]:2025-10-29 07:52:12,064 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank0]:2025-10-29 07:52:12,064 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,216  tflops: 383.19  mfu: 38.75%
[rank3]:2025-10-29 07:52:16,639 - INFO -  step: 1700  loss:  0.7020  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,217  tflops: 383.26  mfu: 38.75%
[rank0]:2025-10-29 07:52:16,724 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0752_stage0_step1700.svg
[rank1]:2025-10-29 07:52:16,723 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0752_stage1_step1700.svg
[rank2]:2025-10-29 07:52:16,725 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0752_stage2_step1700.svg
[rank0]:2025-10-29 07:52:16,816 - INFO - Avg. fwd time: 15.2962 / Avg. bwd time: 7.4990 / Avg. batch time: 533.2356 (ms) / GPU bubble ratio: 65.80%
[rank3]:2025-10-29 07:52:16,827 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0752_real_step1700_rank3.svg
[rank3]:> Batch Time: 373.11 ms, GPU Bubble Ratio: 67.00%, 23.09%, 33.31%, 23.84%
[rank3]:2025-10-29 07:52:16,896 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0752_stage3_step1700.svg
[rank3]:2025-10-29 07:52:17,140 - INFO - Avg. fwd time: 16.6886 / Avg. bwd time: 20.1902 / Avg. batch time: 310.4843 (ms) / GPU bubble ratio: 4.98%
[rank2]:2025-10-29 07:52:17,158 - INFO - Avg. fwd time: 15.0388 / Avg. bwd time: 17.2758 / Avg. batch time: 455.8732 (ms) / GPU bubble ratio: 43.29%
[rank1]:2025-10-29 07:52:17,183 - INFO - Avg. fwd time: 17.4124 / Avg. bwd time: 19.8339 / Avg. batch time: 502.3201 (ms) / GPU bubble ratio: 40.68%
[rank0]:2025-10-29 07:53:50,368 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 07:53:51,886 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank1]:2025-10-29 07:53:51,887 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank2]:2025-10-29 07:53:51,886 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,207  tflops: 382.76  mfu: 38.70%
[rank0]:2025-10-29 07:53:51,979 - INFO - Avg. fwd time: 15.2942 / Avg. bwd time: 7.2739 / Avg. batch time: 531.2052 (ms) / GPU bubble ratio: 66.01%
[rank3]:2025-10-29 07:53:56,458 - INFO -  step: 1750  loss:  0.7026  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,207  tflops: 382.78  mfu: 38.70%
[rank3]:2025-10-29 07:53:56,707 - INFO - Avg. fwd time: 16.6810 / Avg. bwd time: 20.1385 / Avg. batch time: 309.9998 (ms) / GPU bubble ratio: 4.98%
[rank1]:2025-10-29 07:53:56,751 - INFO - Avg. fwd time: 17.4066 / Avg. bwd time: 19.7843 / Avg. batch time: 500.7436 (ms) / GPU bubble ratio: 40.58%
[rank2]:2025-10-29 07:53:56,726 - INFO - Avg. fwd time: 15.0345 / Avg. bwd time: 17.2324 / Avg. batch time: 454.5793 (ms) / GPU bubble ratio: 43.21%
[rank0]:2025-10-29 07:55:29,872 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 07:55:31,399 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank1]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:55:31,398 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank2]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-29 07:55:31,399 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,232  tflops: 383.95  mfu: 38.82%
[rank0]:2025-10-29 07:55:31,399 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-29 07:55:35,964 - INFO -  step: 1800  loss:  0.6912  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,233  tflops: 383.98  mfu: 38.83%
[rank3]:2025-10-29 07:55:35,965 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-29 07:55:52,582 - INFO - validate step: 1800  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,336
[rank0]:2025-10-29 07:55:52,530 - INFO - validate step: 1800  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,384
[rank3]:2025-10-29 07:55:52,594 - INFO - validate step: 1800  loss:  0.3519  memory: 84.24GiB(60.25%)  tps: 24,633
[rank1]:2025-10-29 07:55:52,566 - INFO - validate step: 1800  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,351
[rank2]:2025-10-29 07:55:52,679 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0755_stage2_step1800.svg
[rank0]:2025-10-29 07:55:52,680 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0755_stage0_step1800.svg
[rank1]:2025-10-29 07:55:52,683 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0755_stage1_step1800.svg
[rank3]:2025-10-29 07:55:52,780 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0755_real_step1800_rank3.svg
[rank3]:> Batch Time: 372.56 ms, GPU Bubble Ratio: 67.00%, 23.08%, 33.27%, 23.85%
[rank3]:2025-10-29 07:55:52,848 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0755_stage3_step1800.svg
[rank2]:2025-10-29 07:55:53,185 - INFO - Avg. fwd time: 15.0302 / Avg. bwd time: 17.1914 / Avg. batch time: 453.9659 (ms) / GPU bubble ratio: 43.22%
[rank3]:2025-10-29 07:55:53,160 - INFO - Avg. fwd time: 16.6734 / Avg. bwd time: 20.0891 / Avg. batch time: 309.5351 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:55:53,214 - INFO - Avg. fwd time: 17.4004 / Avg. bwd time: 19.7372 / Avg. batch time: 499.8636 (ms) / GPU bubble ratio: 40.56%
[rank0]:2025-10-29 07:55:53,226 - INFO - Avg. fwd time: 15.2921 / Avg. bwd time: 7.0618 / Avg. batch time: 529.8987 (ms) / GPU bubble ratio: 66.25%
[rank0]:2025-10-29 07:57:26,432 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 07:57:27,967 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,584  tflops: 400.35  mfu: 40.48%
[rank1]:2025-10-29 07:57:27,967 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,587  tflops: 400.50  mfu: 40.50%
[rank2]:2025-10-29 07:57:27,966 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,588  tflops: 400.57  mfu: 40.50%
[rank0]:2025-10-29 07:57:28,059 - INFO - Avg. fwd time: 15.2912 / Avg. bwd time: 6.8897 / Avg. batch time: 528.6743 (ms) / GPU bubble ratio: 66.44%
[rank3]:2025-10-29 07:57:32,551 - INFO -  step: 1850  loss:  0.6855  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,196  tflops: 382.25  mfu: 38.65%
[rank2]:2025-10-29 07:57:32,819 - INFO - Avg. fwd time: 15.0273 / Avg. bwd time: 17.1590 / Avg. batch time: 453.2997 (ms) / GPU bubble ratio: 43.20%
[rank3]:2025-10-29 07:57:32,799 - INFO - Avg. fwd time: 16.6681 / Avg. bwd time: 20.0502 / Avg. batch time: 309.1748 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:57:32,844 - INFO - Avg. fwd time: 17.3968 / Avg. bwd time: 19.7006 / Avg. batch time: 498.9856 (ms) / GPU bubble ratio: 40.52%
[rank0]:2025-10-29 07:59:06,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 07:59:07,628 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,220  tflops: 383.37  mfu: 38.76%
[rank0]:2025-10-29 07:59:07,628 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,220  tflops: 383.38  mfu: 38.76%
[rank1]:2025-10-29 07:59:07,629 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,220  tflops: 383.38  mfu: 38.76%
[rank3]:2025-10-29 07:59:12,228 - INFO -  step: 1900  loss:  0.6965  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,219  tflops: 383.32  mfu: 38.76%
[rank2]:2025-10-29 07:59:12,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0759_stage2_step1900.svg
[rank0]:2025-10-29 07:59:12,314 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0759_stage0_step1900.svg
[rank1]:2025-10-29 07:59:12,313 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0759_stage1_step1900.svg
[rank0]:2025-10-29 07:59:12,406 - INFO - Avg. fwd time: 15.2896 / Avg. bwd time: 6.6992 / Avg. batch time: 527.5027 (ms) / GPU bubble ratio: 66.65%
[rank3]:2025-10-29 07:59:12,413 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0759_real_step1900_rank3.svg
[rank3]:> Batch Time: 372.01 ms, GPU Bubble Ratio: 67.00%, 23.05%, 33.25%, 23.84%
[rank3]:2025-10-29 07:59:12,483 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0759_stage3_step1900.svg
[rank3]:2025-10-29 07:59:12,734 - INFO - Avg. fwd time: 16.6613 / Avg. bwd time: 20.0062 / Avg. batch time: 308.7603 (ms) / GPU bubble ratio: 4.99%
[rank1]:2025-10-29 07:59:12,779 - INFO - Avg. fwd time: 17.3918 / Avg. bwd time: 19.6588 / Avg. batch time: 498.1979 (ms) / GPU bubble ratio: 40.50%
[rank2]:2025-10-29 07:59:12,753 - INFO - Avg. fwd time: 15.0235 / Avg. bwd time: 17.1221 / Avg. batch time: 452.7498 (ms) / GPU bubble ratio: 43.20%
[rank0]:2025-10-29 08:00:46,077 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:00:47,639 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank2]:2025-10-29 08:00:47,638 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank0]:2025-10-29 08:00:47,638 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,191  tflops: 382.04  mfu: 38.63%
[rank3]:2025-10-29 08:00:52,226 - INFO -  step: 1950  loss:  0.7139  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.09  mfu: 38.63%
[rank3]:2025-10-29 08:00:52,545 - INFO - Avg. fwd time: 16.6552 / Avg. bwd time: 19.9651 / Avg. batch time: 308.3756 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 08:00:52,573 - INFO - Avg. fwd time: 15.0201 / Avg. bwd time: 17.0877 / Avg. batch time: 452.2737 (ms) / GPU bubble ratio: 43.21%
[rank0]:2025-10-29 08:00:52,614 - INFO - Avg. fwd time: 15.2883 / Avg. bwd time: 6.5190 / Avg. batch time: 526.4399 (ms) / GPU bubble ratio: 66.86%
[rank1]:2025-10-29 08:00:52,602 - INFO - Avg. fwd time: 17.3869 / Avg. bwd time: 19.6195 / Avg. batch time: 497.4975 (ms) / GPU bubble ratio: 40.49%
[rank0]:2025-10-29 08:02:25,701 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank2]:2025-10-29 08:02:27,270 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank0]:2025-10-29 08:02:27,270 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-29 08:02:27,270 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,222  tflops: 383.49  mfu: 38.78%
[rank1]:2025-10-29 08:02:27,271 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-29 08:02:31,872 - INFO -  step: 2000  loss:  0.6918  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,221  tflops: 383.44  mfu: 38.77%
[rank3]:2025-10-29 08:02:31,872 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-29 08:02:48,330 - INFO - validate step: 2000  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,450
[rank2]:2025-10-29 08:02:48,383 - INFO - validate step: 2000  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,401
[rank3]:2025-10-29 08:02:48,394 - INFO - validate step: 2000  loss:  0.3541  memory: 84.24GiB(60.25%)  tps: 24,792
[rank1]:2025-10-29 08:02:48,367 - INFO - validate step: 2000  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,416
[rank2]:2025-10-29 08:02:48,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0802_stage2_step2000.svg
[rank0]:2025-10-29 08:02:48,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0802_stage0_step2000.svg
[rank1]:2025-10-29 08:02:48,481 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0802_stage1_step2000.svg
[rank0]:2025-10-29 08:02:48,575 - INFO - Avg. fwd time: 15.2866 / Avg. bwd time: 6.3720 / Avg. batch time: 525.3640 (ms) / GPU bubble ratio: 67.02%
[rank3]:2025-10-29 08:02:48,578 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0802_real_step2000_rank3.svg
[rank3]:> Batch Time: 371.60 ms, GPU Bubble Ratio: 67.00%, 23.03%, 33.24%, 23.85%
[rank3]:2025-10-29 08:02:48,651 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0802_stage3_step2000.svg
[rank2]:2025-10-29 08:02:48,924 - INFO - Avg. fwd time: 15.0170 / Avg. bwd time: 17.0589 / Avg. batch time: 451.6800 (ms) / GPU bubble ratio: 43.19%
[rank3]:2025-10-29 08:02:48,904 - INFO - Avg. fwd time: 16.6498 / Avg. bwd time: 19.9306 / Avg. batch time: 308.0497 (ms) / GPU bubble ratio: 5.00%
[rank1]:2025-10-29 08:02:48,950 - INFO - Avg. fwd time: 17.3825 / Avg. bwd time: 19.5866 / Avg. batch time: 496.7183 (ms) / GPU bubble ratio: 40.46%
[rank0]:2025-10-29 08:04:22,351 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:04:23,901 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,572  tflops: 399.78  mfu: 40.42%
[rank2]:2025-10-29 08:04:23,900 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,576  tflops: 400.01  mfu: 40.45%
[rank1]:2025-10-29 08:04:23,901 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,575  tflops: 399.94  mfu: 40.44%
[rank0]:2025-10-29 08:04:23,993 - INFO - Avg. fwd time: 15.2858 / Avg. bwd time: 6.2087 / Avg. batch time: 523.8529 (ms) / GPU bubble ratio: 67.17%
[rank3]:2025-10-29 08:04:28,393 - INFO -  step: 2050  loss:  0.7268  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.09  mfu: 38.63%
[rank3]:2025-10-29 08:04:28,638 - INFO - Avg. fwd time: 16.6447 / Avg. bwd time: 19.8942 / Avg. batch time: 307.7113 (ms) / GPU bubble ratio: 5.00%
[rank2]:2025-10-29 08:04:28,658 - INFO - Avg. fwd time: 15.0142 / Avg. bwd time: 17.0282 / Avg. batch time: 450.6982 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:04:28,682 - INFO - Avg. fwd time: 17.3793 / Avg. bwd time: 19.5520 / Avg. batch time: 495.5350 (ms) / GPU bubble ratio: 40.38%
[rank0]:2025-10-29 08:06:01,880 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:06:03,400 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank0]:2025-10-29 08:06:03,399 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank2]:2025-10-29 08:06:03,400 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,233  tflops: 384.00  mfu: 38.83%
[rank3]:2025-10-29 08:06:07,971 - INFO -  step: 2100  loss:  0.7099  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,227  tflops: 383.70  mfu: 38.80%
[rank0]:2025-10-29 08:06:08,052 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0806_stage0_step2100.svg
[rank2]:2025-10-29 08:06:08,051 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0806_stage2_step2100.svg
[rank1]:2025-10-29 08:06:08,053 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0806_stage1_step2100.svg
[rank3]:2025-10-29 08:06:08,157 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0806_real_step2100_rank3.svg
[rank3]:> Batch Time: 371.28 ms, GPU Bubble Ratio: 67.00%, 23.01%, 33.22%, 23.85%
[rank3]:2025-10-29 08:06:08,220 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0806_stage3_step2100.svg
[rank3]:2025-10-29 08:06:08,528 - INFO - Avg. fwd time: 16.6394 / Avg. bwd time: 19.8583 / Avg. batch time: 307.3752 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:06:08,555 - INFO - Avg. fwd time: 15.0112 / Avg. bwd time: 16.9983 / Avg. batch time: 450.2723 (ms) / GPU bubble ratio: 43.13%
[rank1]:2025-10-29 08:06:08,585 - INFO - Avg. fwd time: 17.3752 / Avg. bwd time: 19.5179 / Avg. batch time: 494.9167 (ms) / GPU bubble ratio: 40.36%
[rank0]:2025-10-29 08:06:08,596 - INFO - Avg. fwd time: 15.2847 / Avg. bwd time: 6.0536 / Avg. batch time: 522.9241 (ms) / GPU bubble ratio: 67.36%
[rank0]:2025-10-29 08:07:41,704 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:07:43,232 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank2]:2025-10-29 08:07:43,232 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank1]:2025-10-29 08:07:43,233 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,206  tflops: 382.72  mfu: 38.70%
[rank0]:2025-10-29 08:07:43,327 - INFO - Avg. fwd time: 15.2837 / Avg. bwd time: 5.9267 / Avg. batch time: 522.0114 (ms) / GPU bubble ratio: 67.49%
[rank3]:2025-10-29 08:07:47,828 - INFO -  step: 2150  loss:  0.7396  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,204  tflops: 382.63  mfu: 38.69%
[rank3]:2025-10-29 08:07:48,077 - INFO - Avg. fwd time: 16.6351 / Avg. bwd time: 19.8296 / Avg. batch time: 307.1060 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:07:48,096 - INFO - Avg. fwd time: 15.0088 / Avg. bwd time: 16.9741 / Avg. batch time: 449.7761 (ms) / GPU bubble ratio: 43.11%
[rank1]:2025-10-29 08:07:48,121 - INFO - Avg. fwd time: 17.3719 / Avg. bwd time: 19.4901 / Avg. batch time: 494.2598 (ms) / GPU bubble ratio: 40.34%
[rank0]:2025-10-29 08:09:21,172 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank0]:2025-10-29 08:09:22,698 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank2]:2025-10-29 08:09:22,698 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-29 08:09:22,698 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,236  tflops: 384.13  mfu: 38.84%
[rank1]:2025-10-29 08:09:22,699 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-29 08:09:27,334 - INFO -  step: 2200  loss:  0.7021  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,233  tflops: 383.98  mfu: 38.83%
[rank3]:2025-10-29 08:09:27,335 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-29 08:09:43,798 - INFO - validate step: 2200  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,413
[rank3]:2025-10-29 08:09:43,862 - INFO - validate step: 2200  loss:  0.3521  memory: 84.24GiB(60.25%)  tps: 24,785
[rank2]:2025-10-29 08:09:43,851 - INFO - validate step: 2200  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,364
[rank1]:2025-10-29 08:09:43,834 - INFO - validate step: 2200  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,380
[rank0]:2025-10-29 08:09:43,947 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0809_stage0_step2200.svg
[rank2]:2025-10-29 08:09:43,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0809_stage2_step2200.svg
[rank1]:2025-10-29 08:09:43,945 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0809_stage1_step2200.svg
[rank0]:2025-10-29 08:09:44,042 - INFO - Avg. fwd time: 15.2819 / Avg. bwd time: 5.7852 / Avg. batch time: 521.1466 (ms) / GPU bubble ratio: 67.66%
[rank3]:2025-10-29 08:09:44,054 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0809_real_step2200_rank3.svg
[rank3]:> Batch Time: 370.90 ms, GPU Bubble Ratio: 66.99%, 23.00%, 33.21%, 23.85%
[rank3]:2025-10-29 08:09:44,119 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0809_stage3_step2200.svg
[rank3]:2025-10-29 08:09:44,367 - INFO - Avg. fwd time: 16.6300 / Avg. bwd time: 19.7964 / Avg. batch time: 306.7933 (ms) / GPU bubble ratio: 5.01%
[rank2]:2025-10-29 08:09:44,387 - INFO - Avg. fwd time: 15.0058 / Avg. bwd time: 16.9464 / Avg. batch time: 449.3734 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:09:44,410 - INFO - Avg. fwd time: 17.3677 / Avg. bwd time: 19.4588 / Avg. batch time: 493.6807 (ms) / GPU bubble ratio: 40.32%
[rank0]:2025-10-29 08:11:17,766 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-29 08:11:19,305 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,577  tflops: 400.05  mfu: 40.45%
[rank2]:2025-10-29 08:11:19,305 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,582  tflops: 400.27  mfu: 40.47%
[rank1]:2025-10-29 08:11:19,306 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,581  tflops: 400.20  mfu: 40.47%
[rank3]:2025-10-29 08:11:23,867 - INFO -  step: 2250  loss:  0.7197  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,192  tflops: 382.06  mfu: 38.63%
[rank3]:2025-10-29 08:11:24,184 - INFO - Avg. fwd time: 16.6254 / Avg. bwd time: 19.7653 / Avg. batch time: 306.5025 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 08:11:24,214 - INFO - Avg. fwd time: 15.0032 / Avg. bwd time: 16.9205 / Avg. batch time: 449.0257 (ms) / GPU bubble ratio: 43.12%
[rank1]:2025-10-29 08:11:24,245 - INFO - Avg. fwd time: 17.3645 / Avg. bwd time: 19.4295 / Avg. batch time: 493.1663 (ms) / GPU bubble ratio: 40.31%
[rank0]:2025-10-29 08:11:24,259 - INFO - Avg. fwd time: 15.2811 / Avg. bwd time: 5.6503 / Avg. batch time: 520.3621 (ms) / GPU bubble ratio: 67.82%
[rank0]:2025-10-29 08:12:57,673 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:12:59,219 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank1]:2025-10-29 08:12:59,220 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank2]:2025-10-29 08:12:59,219 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,199  tflops: 382.41  mfu: 38.67%
[rank3]:2025-10-29 08:13:03,812 - INFO -  step: 2300  loss:  0.6980  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,197  tflops: 382.29  mfu: 38.65%
[rank0]:2025-10-29 08:13:03,898 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0812_stage0_step2300.svg
[rank1]:2025-10-29 08:13:03,897 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0812_stage1_step2300.svg
[rank2]:2025-10-29 08:13:03,898 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0812_stage2_step2300.svg
[rank3]:2025-10-29 08:13:04,005 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0813_real_step2300_rank3.svg
[rank3]:> Batch Time: 370.65 ms, GPU Bubble Ratio: 66.99%, 22.99%, 33.20%, 23.85%
[rank0]:2025-10-29 08:13:03,991 - INFO - Avg. fwd time: 15.2801 / Avg. bwd time: 5.5396 / Avg. batch time: 519.5830 (ms) / GPU bubble ratio: 67.94%
[rank3]:2025-10-29 08:13:04,070 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0813_stage3_step2300.svg
[rank3]:2025-10-29 08:13:04,320 - INFO - Avg. fwd time: 16.6218 / Avg. bwd time: 19.7400 / Avg. batch time: 306.2664 (ms) / GPU bubble ratio: 5.02%
[rank2]:2025-10-29 08:13:04,339 - INFO - Avg. fwd time: 15.0014 / Avg. bwd time: 16.8995 / Avg. batch time: 448.6079 (ms) / GPU bubble ratio: 43.11%
[rank1]:2025-10-29 08:13:04,365 - INFO - Avg. fwd time: 17.3616 / Avg. bwd time: 19.4052 / Avg. batch time: 492.6098 (ms) / GPU bubble ratio: 40.29%
[rank0]:2025-10-29 08:14:37,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-29 08:14:39,201 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank1]:2025-10-29 08:14:39,200 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank2]:2025-10-29 08:14:39,200 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,194  tflops: 382.15  mfu: 38.64%
[rank0]:2025-10-29 08:14:39,296 - INFO - Avg. fwd time: 15.2790 / Avg. bwd time: 5.4158 / Avg. batch time: 518.3767 (ms) / GPU bubble ratio: 68.06%
[rank3]:2025-10-29 08:14:43,792 - INFO -  step: 2350  loss:  0.7101  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,194  tflops: 382.16  mfu: 38.64%
[rank3]:2025-10-29 08:14:44,047 - INFO - Avg. fwd time: 16.6176 / Avg. bwd time: 19.7116 / Avg. batch time: 306.0014 (ms) / GPU bubble ratio: 5.02%
[rank1]:2025-10-29 08:14:44,092 - INFO - Avg. fwd time: 17.3583 / Avg. bwd time: 19.3779 / Avg. batch time: 491.6525 (ms) / GPU bubble ratio: 40.22%
[rank2]:2025-10-29 08:14:44,067 - INFO - Avg. fwd time: 14.9991 / Avg. bwd time: 16.8758 / Avg. batch time: 447.8077 (ms) / GPU bubble ratio: 43.06%
[rank0]:2025-10-29 08:16:17,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-29 08:16:18,844 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.72GiB(52.01%)  tps: 8,221  tflops: 383.44  mfu: 38.77%
[rank1]:2025-10-29 08:16:18,844 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,752  tflops: 361.55  mfu: 35.71%
[rank1]:2025-10-29 08:16:18,844 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-29 08:16:18,843 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.20GiB(53.07%)  tps: 8,221  tflops: 383.45  mfu: 38.77%
[rank0]:2025-10-29 08:16:18,843 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,751  tflops: 361.53  mfu: 35.71%
[rank0]:2025-10-29 08:16:18,843 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-29 08:16:18,843 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 65.27GiB(46.69%)  tps: 8,221  tflops: 383.45  mfu: 38.77%
[rank2]:2025-10-29 08:16:18,844 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 7,753  tflops: 361.58  mfu: 35.72%
[rank2]:2025-10-29 08:16:18,844 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-29 08:16:23,429 - INFO -  step: 2400  loss:  0.6894  grad_norm:  0.0000  memory: 84.24GiB(60.25%)  tps: 8,222  tflops: 383.48  mfu: 38.77%
[rank3]:2025-10-29 08:16:23,429 - INFO -  final step: 2400  loss:  0.6894  grad_norm:  0.0000  tps: 7,667  tflops: 357.61  mfu: 35.31%
[rank3]:2025-10-29 08:16:23,429 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-29 08:16:39,903 - INFO - validate step: 2400  loss: -1.0000  memory: 72.72GiB(52.01%)  tps: 19,451
[rank1]:2025-10-29 08:16:39,904 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-29 08:16:39,909 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank1]:  warnings.warn(
[rank0]:2025-10-29 08:16:39,865 - INFO - validate step: 2400  loss: -1.0000  memory: 74.20GiB(53.07%)  tps: 19,485
[rank0]:2025-10-29 08:16:39,866 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-29 08:16:39,869 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank0]:  warnings.warn(
[rank2]:2025-10-29 08:16:39,920 - INFO - validate step: 2400  loss: -1.0000  memory: 65.27GiB(46.69%)  tps: 19,434
[rank2]:2025-10-29 08:16:39,921 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-29 08:16:39,924 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank2]:  warnings.warn(
[rank3]:2025-10-29 08:16:39,927 - INFO - validate step: 2400  loss:  0.3534  memory: 84.24GiB(60.25%)  tps: 24,829
[rank3]:2025-10-29 08:16:39,928 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-29 08:16:39,930 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/checkpoint/filesystem.py:660: UserWarning: Detected an existing checkpoint in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1/step-2400, overwriting since self.overwrite=True. Past version 2.5 of PyTorch, `overwrite` will default to False. Set this variable to True to maintain this functionality or False to raise when an existing checkpoint is found.
[rank3]:  warnings.warn(
[rank0]:2025-10-29 08:16:50,898 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-29 08:16:50,991 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251029_0816_stage1_final2400.svg
[rank0]:2025-10-29 08:16:51,001 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251029_0816_stage0_final2400.svg
[rank2]:2025-10-29 08:16:50,994 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251029_0816_stage2_final2400.svg
[rank3]:2025-10-29 08:16:51,107 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0816_real_final2400_rank3.svg
[rank3]:> Batch Time: 370.43 ms, GPU Bubble Ratio: 66.98%, 22.98%, 33.19%, 23.86%
[rank2]:2025-10-29 08:16:51,246 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank2_stage2.svg
[rank2]:	> Counts Sum: 892480, Total Sum: 5368320 (16.62%), Ratio(%) per element: [16.84, 15.66, 18.07, 17.0, 15.98, 16.41, 17.27, 17.27, 15.93, 16.46, 16.3, 15.12, 15.93, 17.75, 17.75, 16.36, 16.36, 14.59, 16.63, 15.77, 16.79, 16.57, 17.16, 17.22, 15.55, 15.93, 16.79, 16.73, 17.75, 17.22, 17.0, 17.22, 17.38, 17.22, 15.98, 17.43, 17.65, 16.36, 16.73, 15.23, 17.48, 15.66, 16.41, 17.38, 16.25, 17.65, 16.63, 15.98, 16.41, 15.87, 15.82, 16.3, 16.09, 16.41, 17.43, 17.91, 16.09, 16.68, 16.52, 16.95, 17.11, 16.09, 15.98, 16.04, 17.7, 18.18, 15.23, 16.41, 16.63, 16.46, 16.09, 17.43]
[rank2]:2025-10-29 08:16:51,246 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 08:16:51,290 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/pipeline_schedule/251029_0816_thry_final2400_rank3.svg
[rank3]:> Batch Time: 528.42 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-10-29 08:16:51,240 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank1_stage1.svg
[rank1]:	> Counts Sum: 108960, Total Sum: 6039360 (1.80%), Ratio(%) per element: [1.6, 1.98, 1.87, 2.03, 1.6, 1.66, 2.09, 1.71, 2.09, 1.77, 1.98, 1.39, 2.03, 1.77, 1.34, 2.03, 1.82, 1.82, 1.82, 1.6, 1.5, 1.66, 2.46, 1.77, 1.77, 1.5, 1.93, 2.25, 2.03, 2.3, 1.71, 1.6, 1.87, 1.44, 2.3, 2.03, 1.39, 1.82, 1.82, 1.77, 1.87, 2.03, 1.82, 1.93, 1.71, 1.82, 2.14, 1.71, 1.66, 1.5, 2.14, 1.87, 1.66, 1.66, 1.93, 1.98, 1.39, 1.44, 2.14, 2.03, 2.14, 1.66, 2.14, 1.5, 1.77, 1.77, 1.77, 1.93, 1.82, 1.55, 1.44, 1.93, 1.93, 1.87, 2.09, 1.77, 1.44, 1.66, 1.82, 2.03, 0.37]
[rank1]:2025-10-29 08:16:51,241 - INFO - Destroying the purge thread.
[rank0]:2025-10-29 08:16:51,308 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank0_stage0.svg
[rank0]:	> Counts Sum: 4611840, Total Sum: 5442880 (84.73%), Ratio(%) per element: [85.03, 84.44, 84.71, 84.6, 84.97, 84.44, 84.49, 84.81, 84.44, 84.97, 84.81, 84.65, 84.49, 84.6, 85.08, 84.71, 84.81, 85.24, 84.92, 85.08, 84.38, 84.87, 84.49, 84.65, 84.81, 84.65, 84.65, 84.6, 85.3, 84.49, 84.33, 84.76, 84.81, 84.44, 84.38, 84.6, 84.76, 84.76, 84.6, 84.71, 84.49, 84.6, 84.6, 84.76, 84.76, 84.92, 84.71, 84.71, 84.97, 84.76, 84.71, 84.92, 84.65, 84.87, 84.76, 84.71, 85.03, 84.81, 84.6, 84.92, 84.97, 84.92, 84.6, 84.44, 84.65, 85.13, 84.65, 84.54, 85.03, 84.6, 84.97, 84.6, 84.38]
[rank0]:2025-10-29 08:16:51,308 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-29 08:16:51,372 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251029_0816_stage3_final2400.svg
[rank3]:2025-10-29 08:16:51,616 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1/frozen_params_histogram/251029_0816_rank3_stage3.svg
[rank3]:	> Counts Sum: 76800, Total Sum: 4846400 (1.58%), Ratio(%) per element: [1.5, 1.55, 1.6, 1.5, 1.66, 1.44, 1.87, 1.5, 1.98, 1.77, 1.87, 1.82, 1.28, 1.34, 1.82, 1.66, 1.71, 1.5, 1.5, 1.66, 1.12, 1.77, 1.71, 1.82, 1.6, 1.28, 1.93, 1.39, 1.6, 1.82, 1.44, 1.93, 1.66, 1.77, 1.82, 1.66, 1.98, 1.44, 1.5, 1.28, 1.93, 1.6, 1.87, 1.5, 1.82, 1.55, 1.82, 1.39, 1.93, 1.28, 1.87, 1.66, 1.6, 1.55, 1.71, 1.55, 1.6, 1.77, 1.34, 1.23, 1.44, 0.91, 1.28, 1.44, 0.0]
[rank3]:2025-10-29 08:16:51,617 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–…â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–…â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.13685
[rank3]:wandb:               final/avg_loss 0.6894
[rank3]:wandb:             final/avg_mfu(%) 35.31101
[rank3]:wandb:             final/avg_tflops 357.60658
[rank3]:wandb:    final/avg_throughput(tps) 7667.35305
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.6894
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.6894
[rank3]:wandb: loss_metrics/global_max_loss 0.6894
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1028_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/q8s4zzdk
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1028_GPipe_timelyapf_dm1/20251029-0646/wandb/run-20251029_064604-q8s4zzdk/logs
[rank0]:2025-10-29 08:16:53,308 - INFO - Training completed
[rank0]:2025-10-29 08:16:53,308 - INFO - Destroying the purge thread.
[rank3]:2025-10-29 08:16:53,561 - INFO - Process group destroyed
[rank1]:2025-10-29 08:16:53,554 - INFO - Process group destroyed
[rank2]:2025-10-29 08:16:53,586 - INFO - Process group destroyed
[rank0]:2025-10-29 08:16:53,689 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.10', 'layers.13', 'layers.15', 'layers.9', 'layers.12', 'layers.16', 'layers.8', 'layers.14'}
[rank0]:Stage 0: Modules to keep: {'layers.4', 'layers.7', 'layers.6', 'layers.3', 'tok_embeddings', 'layers.5', 'layers.2', 'layers.1', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.20', 'layers.17', 'layers.22', 'layers.24', 'layers.19', 'layers.18', 'layers.21', 'layers.23'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.31', 'layers.26', 'output', 'layers.25', 'layers.30', 'layers.27', 'layers.28', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1028_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1028_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1028_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1028_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1028_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1028_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1028_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 1e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 100
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1028_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1028_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
