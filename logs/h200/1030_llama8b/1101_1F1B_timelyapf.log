
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 15:10:47 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 15:10:48.970000 781403 site-packages/torch/distributed/run.py:811] 
W1102 15:10:48.970000 781403 site-packages/torch/distributed/run.py:811] *****************************************
W1102 15:10:48.970000 781403 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 15:10:48.970000 781403 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-02 15:10:55,929 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 15:10:56,031 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 15:10:56,028 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 15:10:56,011 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 15:10:56,826 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 15:10:56,828 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 15:10:57,057 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 15:10:57,059 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 15:10:57,064 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-02 15:10:57,111 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 15:10:57,114 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-02 15:10:57,114 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 15:10:57,116 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 15:10:58,890 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 15:10:59,164 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank2]:2025-11-02 15:11:01,304 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-02 15:11:01,381 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 15:11:01,381 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 15:11:01,329 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 15:11:01,408 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 15:11:01,408 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 15:11:01,602 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 15:11:01,603 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-11-02 15:11:01,629 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 15:11:01,630 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run o1pqxtgx
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyapf_h200/20251102-1511/wandb/run-20251102_151103-o1pqxtgx
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/o1pqxtgx
[rank3]:2025-11-02 15:11:04,299 - INFO - WandB logging enabled
[rank3]:2025-11-02 15:11:04,300 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 15:11:04,377 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 15:11:04,377 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-02 15:11:04,592 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 15:11:04,592 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:Using the latest cached version of the dataset since teknium/OpenHermes-2.5 couldn't be found on the Hugging Face Hub
[rank0]:2025-11-02 15:11:09,846 - WARNING - Using the latest cached version of the dataset since teknium/OpenHermes-2.5 couldn't be found on the Hugging Face Hub
[rank0]:Found the latest cached dataset configuration 'default' at /opt/dlami/nvme/DMLAB/shcho/.cache/huggingface/datasets/teknium___open_hermes-2.5/default/0.0.0/b82037821055c377bed0d495e72e46de3bc72e84 (last modified on Sun Nov  2 01:39:44 2025).
[rank0]:2025-11-02 15:11:09,847 - WARNING - Found the latest cached dataset configuration 'default' at /opt/dlami/nvme/DMLAB/shcho/.cache/huggingface/datasets/teknium___open_hermes-2.5/default/0.0.0/b82037821055c377bed0d495e72e46de3bc72e84 (last modified on Sun Nov  2 01:39:44 2025).
[rank0]:2025-11-02 15:11:09,925 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-02 15:11:10,181 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 15:11:10,231 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-02 15:11:10,255 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 15:11:10,256 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 15:11:10,481 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 15:11:10,498 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-02 15:11:10,480 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 15:11:10,467 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 15:11:10,468 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank0]:2025-11-02 15:11:10,480 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyapf_h200
[rank0]:2025-11-02 15:11:10,480 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 15:11:10,480 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-11-02 15:11:14,461 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 15:11:14,461 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 15:11:23,549 - INFO - [GC] GC collection for checkpoint loading. 0.02 seconds
[rank0]:2025-11-02 15:11:23,549 - INFO - Finished loading the checkpoint in 9.09 seconds.
[rank0]:2025-11-02 15:11:23,549 - INFO - Training starts at step 1
[rank1]:2025-11-02 15:11:27,431 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 629  tflops: 29.34  mfu: 2.97%
[rank1]:2025-11-02 15:11:27,431 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 15:11:27,442 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 628  tflops: 29.30  mfu: 2.96%
[rank2]:2025-11-02 15:11:27,442 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 15:11:27,473 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 709  tflops: 33.05  mfu: 3.34%
[rank3]:2025-11-02 15:11:27,474 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 15:11:27,450 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 951  tflops: 44.38  mfu: 4.49%
[rank0]:2025-11-02 15:11:27,450 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 15:13:34,149 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:13:36,588 - INFO - Avg. fwd time: 14.6941 / Avg. bwd time: 42.2237 / Avg. batch time: 473.6188 (ms) / GPU bubble ratio: 3.86%
[rank1]:2025-11-02 15:13:36,664 - INFO - Avg. fwd time: 15.1504 / Avg. bwd time: 41.0048 / Avg. batch time: 585.2837 (ms) / GPU bubble ratio: 23.24%
[rank2]:2025-11-02 15:13:36,618 - INFO - Avg. fwd time: 13.1557 / Avg. bwd time: 36.1168 / Avg. batch time: 526.1515 (ms) / GPU bubble ratio: 25.08%
[rank0]:2025-11-02 15:13:36,696 - INFO - Avg. fwd time: 13.3864 / Avg. bwd time: 37.9785 / Avg. batch time: 640.4136 (ms) / GPU bubble ratio: 35.84%
[rank0]:2025-11-02 15:13:36,822 - INFO -  step: 50  loss: -4.0000  grad_norm: 7294.0703  memory: 54.93GiB(39.29%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank3]:2025-11-02 15:13:36,820 - INFO -  step: 50  loss: 12.7749  grad_norm: 7294.0703  memory: 46.16GiB(33.01%)  tps: 6,207  tflops: 289.48  mfu: 29.27%
[rank1]:2025-11-02 15:13:36,818 - INFO -  step: 50  loss: -4.0000  grad_norm: 7294.0703  memory: 47.26GiB(33.80%)  tps: 6,205  tflops: 289.39  mfu: 29.26%
[rank2]:2025-11-02 15:13:36,816 - INFO -  step: 50  loss: -4.0000  grad_norm: 7294.0703  memory: 38.72GiB(27.69%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank0]:2025-11-02 15:15:46,158 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:15:48,587 - INFO - Avg. fwd time: 14.7353 / Avg. bwd time: 42.3498 / Avg. batch time: 473.4760 (ms) / GPU bubble ratio: 3.55%
[rank2]:2025-11-02 15:15:48,616 - INFO - Avg. fwd time: 13.1623 / Avg. bwd time: 36.1603 / Avg. batch time: 525.7610 (ms) / GPU bubble ratio: 24.95%
[rank1]:2025-11-02 15:15:48,661 - INFO - Avg. fwd time: 15.0639 / Avg. bwd time: 41.0870 / Avg. batch time: 584.6275 (ms) / GPU bubble ratio: 23.16%
[rank0]:2025-11-02 15:15:48,694 - INFO - Avg. fwd time: 13.2743 / Avg. bwd time: 38.0326 / Avg. batch time: 639.4055 (ms) / GPU bubble ratio: 35.81%
[rank2]:2025-11-02 15:15:48,814 - INFO -  step: 100  loss: -4.0000  grad_norm: 83.2810  memory: 38.72GiB(27.69%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank2]:2025-11-02 15:15:48,814 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 15:15:48,816 - INFO -  step: 100  loss: -4.0000  grad_norm: 83.2810  memory: 47.26GiB(33.80%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank1]:2025-11-02 15:15:48,816 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 15:15:48,820 - INFO -  step: 100  loss: -4.0000  grad_norm: 83.2810  memory: 54.93GiB(39.29%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank0]:2025-11-02 15:15:48,820 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 15:15:48,818 - INFO -  step: 100  loss:  4.2308  grad_norm: 83.2810  memory: 46.16GiB(33.01%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank3]:2025-11-02 15:15:48,818 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 15:17:57,975 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:18:00,498 - INFO - Avg. fwd time: 14.7200 / Avg. bwd time: 42.3599 / Avg. batch time: 472.9866 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-11-02 15:18:00,585 - INFO - Avg. fwd time: 15.0176 / Avg. bwd time: 41.1151 / Avg. batch time: 583.9575 (ms) / GPU bubble ratio: 23.10%
[rank2]:2025-11-02 15:18:00,540 - INFO - Avg. fwd time: 13.1430 / Avg. bwd time: 36.1921 / Avg. batch time: 525.1912 (ms) / GPU bubble ratio: 24.85%
[rank0]:2025-11-02 15:18:00,627 - INFO - Avg. fwd time: 13.2384 / Avg. bwd time: 38.0551 / Avg. batch time: 638.6392 (ms) / GPU bubble ratio: 35.75%
[rank0]:2025-11-02 15:18:00,662 - INFO -  step: 150  loss: -4.0000  grad_norm: 23.8232  memory: 54.93GiB(39.29%)  tps: 6,214  tflops: 289.80  mfu: 29.30%
[rank3]:2025-11-02 15:18:00,661 - INFO -  step: 150  loss:  1.1507  grad_norm: 23.8232  memory: 46.16GiB(33.01%)  tps: 6,214  tflops: 289.80  mfu: 29.30%
[rank1]:2025-11-02 15:18:00,658 - INFO -  step: 150  loss: -4.0000  grad_norm: 23.8232  memory: 47.26GiB(33.80%)  tps: 6,214  tflops: 289.80  mfu: 29.30%
[rank2]:2025-11-02 15:18:00,656 - INFO -  step: 150  loss: -4.0000  grad_norm: 23.8232  memory: 38.72GiB(27.69%)  tps: 6,213  tflops: 289.80  mfu: 29.30%
[rank0]:2025-11-02 15:20:09,741 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:20:12,160 - INFO - Avg. fwd time: 14.7104 / Avg. bwd time: 42.3609 / Avg. batch time: 472.7273 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-11-02 15:20:12,190 - INFO - Avg. fwd time: 13.1326 / Avg. bwd time: 36.2063 / Avg. batch time: 524.8940 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-11-02 15:20:12,268 - INFO - Avg. fwd time: 13.2228 / Avg. bwd time: 38.0633 / Avg. batch time: 638.2373 (ms) / GPU bubble ratio: 35.72%
[rank1]:2025-11-02 15:20:12,235 - INFO - Avg. fwd time: 14.9960 / Avg. bwd time: 41.1276 / Avg. batch time: 583.6069 (ms) / GPU bubble ratio: 23.07%
[rank3]:2025-11-02 15:20:12,390 - INFO -  step: 200  loss:  0.3473  grad_norm:  0.5461  memory: 46.16GiB(33.01%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank3]:2025-11-02 15:20:12,390 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 15:20:12,388 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5461  memory: 47.26GiB(33.80%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank1]:2025-11-02 15:20:12,388 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 15:20:12,386 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5461  memory: 38.72GiB(27.69%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank2]:2025-11-02 15:20:12,386 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 15:20:12,392 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5461  memory: 54.93GiB(39.29%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank0]:2025-11-02 15:20:12,392 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 15:20:28,855 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,882
[rank0]:2025-11-02 15:20:28,855 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 15:20:28,914 - INFO - validate step: 200  loss:  0.2309  memory: 46.16GiB(33.01%)  tps: 24,790
[rank3]:2025-11-02 15:20:28,914 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 15:20:28,886 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,828
[rank1]:2025-11-02 15:20:28,887 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 15:20:28,899 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,805
[rank2]:2025-11-02 15:20:28,899 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 15:22:38,195 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:22:40,613 - INFO - Avg. fwd time: 14.7104 / Avg. bwd time: 42.3714 / Avg. batch time: 472.6764 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-11-02 15:22:40,642 - INFO - Avg. fwd time: 13.1288 / Avg. bwd time: 36.2131 / Avg. batch time: 524.8210 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-11-02 15:22:40,688 - INFO - Avg. fwd time: 14.9872 / Avg. bwd time: 41.1366 / Avg. batch time: 583.5043 (ms) / GPU bubble ratio: 23.05%
[rank0]:2025-11-02 15:22:40,720 - INFO - Avg. fwd time: 13.2208 / Avg. bwd time: 38.0752 / Avg. batch time: 638.1336 (ms) / GPU bubble ratio: 35.69%
[rank3]:2025-11-02 15:22:40,842 - INFO -  step: 250  loss:  0.2343  grad_norm:  0.2668  memory: 46.16GiB(33.01%)  tps: 6,210  tflops: 289.61  mfu: 29.28%
[rank1]:2025-11-02 15:22:40,840 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2668  memory: 47.26GiB(33.80%)  tps: 6,208  tflops: 289.55  mfu: 29.28%
[rank2]:2025-11-02 15:22:40,837 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2668  memory: 38.72GiB(27.69%)  tps: 6,209  tflops: 289.59  mfu: 29.28%
[rank0]:2025-11-02 15:22:40,844 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2668  memory: 54.93GiB(39.29%)  tps: 6,207  tflops: 289.48  mfu: 29.27%
[rank0]:2025-11-02 15:24:50,042 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:24:52,553 - INFO - Avg. fwd time: 14.7055 / Avg. bwd time: 42.3716 / Avg. batch time: 472.5513 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-11-02 15:24:52,594 - INFO - Avg. fwd time: 13.1266 / Avg. bwd time: 36.2142 / Avg. batch time: 524.6846 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 15:24:52,640 - INFO - Avg. fwd time: 14.9816 / Avg. bwd time: 41.1428 / Avg. batch time: 583.3521 (ms) / GPU bubble ratio: 23.03%
[rank0]:2025-11-02 15:24:52,683 - INFO - Avg. fwd time: 13.2178 / Avg. bwd time: 38.0803 / Avg. batch time: 637.9668 (ms) / GPU bubble ratio: 35.67%
[rank0]:2025-11-02 15:24:52,718 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 54.93GiB(39.29%)  tps: 6,212  tflops: 289.73  mfu: 29.30%
[rank0]:2025-11-02 15:24:52,718 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 15:24:52,711 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 38.72GiB(27.69%)  tps: 6,212  tflops: 289.73  mfu: 29.30%
[rank2]:2025-11-02 15:24:52,712 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 15:24:52,716 - INFO -  step: 300  loss:  0.2721  grad_norm:  0.3184  memory: 46.16GiB(33.01%)  tps: 6,212  tflops: 289.73  mfu: 29.30%
[rank3]:2025-11-02 15:24:52,716 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 15:24:52,714 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 47.26GiB(33.80%)  tps: 6,212  tflops: 289.73  mfu: 29.30%
[rank1]:2025-11-02 15:24:52,714 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 15:27:02,290 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:27:04,760 - INFO - Avg. fwd time: 13.1348 / Avg. bwd time: 36.2237 / Avg. batch time: 524.7715 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-02 15:27:04,731 - INFO - Avg. fwd time: 14.7111 / Avg. bwd time: 42.3832 / Avg. batch time: 472.6358 (ms) / GPU bubble ratio: 3.36%
[rank0]:2025-11-02 15:27:04,838 - INFO - Avg. fwd time: 13.2220 / Avg. bwd time: 38.0946 / Avg. batch time: 638.0555 (ms) / GPU bubble ratio: 35.66%
[rank1]:2025-11-02 15:27:04,806 - INFO - Avg. fwd time: 14.9852 / Avg. bwd time: 41.1571 / Avg. batch time: 583.4389 (ms) / GPU bubble ratio: 23.02%
[rank1]:2025-11-02 15:27:04,958 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 47.26GiB(33.80%)  tps: 6,195  tflops: 288.92  mfu: 29.21%
[rank2]:2025-11-02 15:27:04,956 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 38.72GiB(27.69%)  tps: 6,195  tflops: 288.92  mfu: 29.21%
[rank3]:2025-11-02 15:27:04,960 - INFO -  step: 350  loss:  0.3344  grad_norm:  0.3598  memory: 46.16GiB(33.01%)  tps: 6,195  tflops: 288.92  mfu: 29.21%
[rank0]:2025-11-02 15:27:04,962 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 54.93GiB(39.29%)  tps: 6,195  tflops: 288.92  mfu: 29.21%
[rank0]:2025-11-02 15:29:14,487 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:29:16,926 - INFO - Avg. fwd time: 14.7159 / Avg. bwd time: 42.3952 / Avg. batch time: 472.7236 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-11-02 15:29:16,956 - INFO - Avg. fwd time: 13.1401 / Avg. bwd time: 36.2290 / Avg. batch time: 524.8592 (ms) / GPU bubble ratio: 24.75%
[rank0]:2025-11-02 15:29:17,034 - INFO - Avg. fwd time: 13.2231 / Avg. bwd time: 38.1048 / Avg. batch time: 638.1438 (ms) / GPU bubble ratio: 35.65%
[rank1]:2025-11-02 15:29:17,002 - INFO - Avg. fwd time: 14.9859 / Avg. bwd time: 41.1652 / Avg. batch time: 583.5251 (ms) / GPU bubble ratio: 23.02%
[rank3]:2025-11-02 15:29:17,156 - INFO -  step: 400  loss:  0.2766  grad_norm:  0.3061  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank3]:2025-11-02 15:29:17,156 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 15:29:17,154 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3061  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank1]:2025-11-02 15:29:17,154 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 15:29:17,151 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3061  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank2]:2025-11-02 15:29:17,151 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 15:29:17,158 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3061  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank0]:2025-11-02 15:29:17,158 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 15:29:32,135 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,350
[rank0]:2025-11-02 15:29:32,136 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 15:29:32,192 - INFO - validate step: 400  loss:  0.2381  memory: 46.16GiB(33.01%)  tps: 27,243
[rank3]:2025-11-02 15:29:32,193 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 15:29:32,165 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,288
[rank1]:2025-11-02 15:29:32,166 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 15:29:32,178 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,259
[rank2]:2025-11-02 15:29:32,179 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 15:31:41,714 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 15:31:44,273 - INFO - Avg. fwd time: 13.1438 / Avg. bwd time: 36.2340 / Avg. batch time: 524.9226 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-02 15:31:44,231 - INFO - Avg. fwd time: 14.7196 / Avg. bwd time: 42.4038 / Avg. batch time: 472.7861 (ms) / GPU bubble ratio: 3.34%
[rank0]:2025-11-02 15:31:44,364 - INFO - Avg. fwd time: 13.2259 / Avg. bwd time: 38.1202 / Avg. batch time: 638.2270 (ms) / GPU bubble ratio: 35.64%
[rank2]:2025-11-02 15:31:44,393 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.4190  memory: 38.72GiB(27.69%)  tps: 6,196  tflops: 288.98  mfu: 29.22%
[rank1]:2025-11-02 15:31:44,320 - INFO - Avg. fwd time: 14.9865 / Avg. bwd time: 41.1730 / Avg. batch time: 583.5907 (ms) / GPU bubble ratio: 23.02%
[rank1]:2025-11-02 15:31:44,395 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.4190  memory: 47.26GiB(33.80%)  tps: 6,195  tflops: 288.95  mfu: 29.22%
[rank3]:2025-11-02 15:31:44,397 - INFO -  step: 450  loss:  0.3036  grad_norm:  0.4190  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank0]:2025-11-02 15:31:44,399 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.4190  memory: 54.93GiB(39.29%)  tps: 6,194  tflops: 288.87  mfu: 29.21%
[rank3]:2025-11-02 15:32:10,635 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-02 15:32:38,213 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 15:32:38,425 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-02 15:32:38,481 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:38,506 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:38,462 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:38,490 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:38,476 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:38,505 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,446 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,469 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,488 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,517 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,525 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,591 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,567 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,620 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,565 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,617 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,560 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,601 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,655 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,644 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,699 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,700 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,700 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 15:32:43,701 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,664 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,702 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,733 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,670 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:43,725 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,709 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 15:32:43,742 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 15:32:43,763 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 15:32:59,535 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-02 15:32:59,785 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1532_max_batch_time.svg
[rank3]:> Batch Time: 623.53 ms, GPU Bubble Ratio: 33.67%, 27.74%, 36.38%, 26.24%
[rank3]:2025-11-02 15:32:59,971 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1532_min_batch_time.svg
[rank3]:> Batch Time: 352.75 ms, GPU Bubble Ratio: 69.92%, 24.12%, 33.30%, 23.34%
[rank3]:2025-11-02 15:33:00,186 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1532_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.13 ms, GPU Bubble Ratio: 28.25%, 21.55%, 25.73%, 22.18%
[rank3]:2025-11-02 15:33:00,186 - INFO - 	> Batch Time: 371.13 ms (Average Freeze Ratio: 0.75, Time Reduction Rate: 0.40)
[rank0]:2025-11-02 15:33:48,335 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:33:50,444 - INFO - Avg. fwd time: 13.2365 / Avg. bwd time: 35.4295 / Avg. batch time: 525.1558 (ms) / GPU bubble ratio: 25.86%
[rank1]:2025-11-02 15:33:50,483 - INFO - Avg. fwd time: 15.0936 / Avg. bwd time: 40.1810 / Avg. batch time: 582.8018 (ms) / GPU bubble ratio: 24.13%
[rank3]:2025-11-02 15:33:50,421 - INFO - Avg. fwd time: 14.8331 / Avg. bwd time: 41.3746 / Avg. batch time: 465.5052 (ms) / GPU bubble ratio: 3.40%
[rank0]:2025-11-02 15:33:50,516 - INFO - Avg. fwd time: 13.3076 / Avg. bwd time: 36.8084 / Avg. batch time: 636.3537 (ms) / GPU bubble ratio: 37.00%
[rank0]:2025-11-02 15:33:50,627 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.48, [MB1] 0.16/0.47, [MB2] 0.15/0.46, [MB3] 0.15/0.46, [MB4] 0.00/0.00, [MB5] 0.15/0.44, [MB6] 0.18/0.53, [MB7] 0.33/1.00
[rank0]:2025-11-02 15:33:50,627 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2618  memory: 55.40GiB(39.63%)  tps: 6,490  tflops: 302.69  mfu: 30.61%
[rank2]:2025-11-02 15:33:50,620 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.26/0.78, [MB1] 0.26/0.78, [MB2] 0.27/0.80, [MB3] 0.27/0.81, [MB4] 0.27/0.80, [MB5] 0.27/0.80, [MB6] 0.08/0.23, [MB7] 0.33/1.00
[rank2]:2025-11-02 15:33:50,621 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2618  memory: 39.07GiB(27.95%)  tps: 6,490  tflops: 302.69  mfu: 30.61%
[rank1]:2025-11-02 15:33:50,622 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.98, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-02 15:33:50,622 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2618  memory: 47.55GiB(34.01%)  tps: 6,490  tflops: 302.69  mfu: 30.61%
[rank3]:2025-11-02 15:33:55,539 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-02 15:33:55,544 - INFO -  step: 500  loss:  0.3009  grad_norm:  0.2618  memory: 46.16GiB(33.01%)  tps: 6,247  tflops: 291.34  mfu: 29.46%
[rank0]:2025-11-02 15:33:55,626 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1533_stage0_step500.svg
[rank1]:2025-11-02 15:33:55,626 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1533_stage1_step500.svg
[rank2]:2025-11-02 15:33:55,627 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1533_stage2_step500.svg
[rank3]:2025-11-02 15:33:55,718 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1533_real_step500_rank3.svg
[rank3]:> Batch Time: 407.71 ms, GPU Bubble Ratio: 45.63%, 30.11%, 33.50%, 26.86%
[rank3]:2025-11-02 15:33:55,783 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1533_stage3_step500.svg
[rank0]:2025-11-02 15:35:58,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:36:00,734 - INFO - Avg. fwd time: 14.9598 / Avg. bwd time: 40.1333 / Avg. batch time: 456.7520 (ms) / GPU bubble ratio: 3.50%
[rank2]:2025-11-02 15:36:00,759 - INFO - Avg. fwd time: 13.3229 / Avg. bwd time: 34.6912 / Avg. batch time: 523.6801 (ms) / GPU bubble ratio: 26.65%
[rank1]:2025-11-02 15:36:00,774 - INFO - Avg. fwd time: 15.2107 / Avg. bwd time: 39.1810 / Avg. batch time: 580.2768 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-11-02 15:36:00,805 - INFO - Avg. fwd time: 13.3770 / Avg. bwd time: 36.1611 / Avg. batch time: 633.3758 (ms) / GPU bubble ratio: 37.43%
[rank2]:2025-11-02 15:36:00,914 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.52/0.78, [MB1] 0.52/0.78, [MB2] 0.54/0.80, [MB3] 0.54/0.81, [MB4] 0.53/0.80, [MB5] 0.53/0.80, [MB6] 0.15/0.23, [MB7] 0.67/1.00
[rank2]:2025-11-02 15:36:00,914 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0933  memory: 39.25GiB(28.07%)  tps: 6,287  tflops: 293.24  mfu: 29.65%
[rank1]:2025-11-02 15:36:00,916 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.65/0.98, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-02 15:36:00,916 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0933  memory: 48.76GiB(34.88%)  tps: 6,287  tflops: 293.24  mfu: 29.65%
[rank0]:2025-11-02 15:36:00,921 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.48, [MB1] 0.31/0.47, [MB2] 0.31/0.46, [MB3] 0.31/0.46, [MB4] 0.00/0.00, [MB5] 0.29/0.44, [MB6] 0.35/0.53, [MB7] 0.67/1.00
[rank0]:2025-11-02 15:36:00,921 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0933  memory: 57.32GiB(41.00%)  tps: 6,287  tflops: 293.24  mfu: 29.65%
[rank3]:2025-11-02 15:36:05,749 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-02 15:36:05,755 - INFO -  step: 550  loss:  0.1641  grad_norm:  0.0933  memory: 46.16GiB(33.01%)  tps: 6,291  tflops: 293.44  mfu: 29.67%
[rank0]:2025-11-02 15:37:58,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 15:38:00,329 - INFO - Avg. fwd time: 15.3824 / Avg. bwd time: 37.7029 / Avg. batch time: 575.6603 (ms) / GPU bubble ratio: 26.23%
[rank3]:2025-11-02 15:38:00,277 - INFO - Avg. fwd time: 15.1333 / Avg. bwd time: 38.6387 / Avg. batch time: 446.1798 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-11-02 15:38:00,304 - INFO - Avg. fwd time: 13.4607 / Avg. bwd time: 33.5816 / Avg. batch time: 520.5808 (ms) / GPU bubble ratio: 27.71%
[rank0]:2025-11-02 15:38:00,362 - INFO - Avg. fwd time: 13.4929 / Avg. bwd time: 35.0902 / Avg. batch time: 627.8891 (ms) / GPU bubble ratio: 38.10%
[rank0]:2025-11-02 15:38:00,392 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.47/0.47, [MB2] 0.46/0.46, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.44/0.44, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-11-02 15:38:00,393 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1778  memory: 57.32GiB(41.00%)  tps: 6,857  tflops: 319.81  mfu: 32.34%
[rank0]:2025-11-02 15:38:00,393 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 15:38:00,371 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.98/0.98, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 15:38:00,372 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1778  memory: 48.76GiB(34.88%)  tps: 6,858  tflops: 319.85  mfu: 32.34%
[rank1]:2025-11-02 15:38:00,372 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 15:38:00,377 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.78/0.78, [MB1] 0.78/0.78, [MB2] 0.80/0.80, [MB3] 0.81/0.81, [MB4] 0.80/0.80, [MB5] 0.80/0.80, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:38:00,377 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1778  memory: 39.25GiB(28.07%)  tps: 6,857  tflops: 319.83  mfu: 32.34%
[rank2]:2025-11-02 15:38:00,378 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 15:38:05,229 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 15:38:05,234 - INFO -  step: 600  loss:  0.4359  grad_norm:  0.1778  memory: 46.16GiB(33.01%)  tps: 6,857  tflops: 319.79  mfu: 32.33%
[rank3]:2025-11-02 15:38:05,234 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 15:38:21,606 - INFO - validate step: 600  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,309
[rank1]:2025-11-02 15:38:21,639 - INFO - validate step: 600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 19,260
[rank2]:2025-11-02 15:38:21,655 - INFO - validate step: 600  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 19,251
[rank2]:2025-11-02 15:38:21,742 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1538_stage2_step600.svg
[rank1]:2025-11-02 15:38:21,740 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1538_stage1_step600.svg
[rank3]:2025-11-02 15:38:21,669 - INFO - validate step: 600  loss:  0.2513  memory: 46.16GiB(33.01%)  tps: 24,924
[rank0]:2025-11-02 15:38:21,740 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1538_stage0_step600.svg
[rank3]:2025-11-02 15:38:21,843 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1538_real_step600_rank3.svg
[rank3]:> Batch Time: 423.21 ms, GPU Bubble Ratio: 32.55%, 30.00%, 33.53%, 26.99%
[rank3]:2025-11-02 15:38:21,907 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1538_stage3_step600.svg
[rank0]:2025-11-02 15:40:10,221 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:40:11,874 - INFO - Avg. fwd time: 15.2987 / Avg. bwd time: 37.3683 / Avg. batch time: 437.3086 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-11-02 15:40:11,889 - INFO - Avg. fwd time: 13.5973 / Avg. bwd time: 32.5639 / Avg. batch time: 516.5615 (ms) / GPU bubble ratio: 28.51%
[rank1]:2025-11-02 15:40:11,893 - INFO - Avg. fwd time: 15.5393 / Avg. bwd time: 36.3730 / Avg. batch time: 570.3181 (ms) / GPU bubble ratio: 27.18%
[rank0]:2025-11-02 15:40:11,923 - INFO - Avg. fwd time: 13.6123 / Avg. bwd time: 33.5501 / Avg. batch time: 621.7374 (ms) / GPU bubble ratio: 39.32%
[rank2]:2025-11-02 15:40:12,018 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.78/0.78, [MB1] 0.78/0.78, [MB2] 0.80/0.80, [MB3] 0.81/0.81, [MB4] 0.80/0.80, [MB5] 0.80/0.80, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:40:12,018 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0729  memory: 39.25GiB(28.07%)  tps: 7,423  tflops: 346.20  mfu: 35.01%
[rank1]:2025-11-02 15:40:12,012 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.98/0.98, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 15:40:12,013 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 7,422  tflops: 346.17  mfu: 35.00%
[rank0]:2025-11-02 15:40:12,028 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.47/0.47, [MB2] 0.46/0.46, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.44/0.44, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-11-02 15:40:12,029 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0729  memory: 57.32GiB(41.00%)  tps: 7,419  tflops: 346.01  mfu: 34.99%
[rank3]:2025-11-02 15:40:16,914 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 15:40:16,918 - INFO -  step: 650  loss:  0.2711  grad_norm:  0.0000  memory: 46.16GiB(33.01%)  tps: 7,108  tflops: 331.53  mfu: 33.52%
[rank0]:2025-11-02 15:42:04,833 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:42:06,519 - INFO - Avg. fwd time: 13.7306 / Avg. bwd time: 31.5237 / Avg. batch time: 512.8448 (ms) / GPU bubble ratio: 29.41%
[rank1]:2025-11-02 15:42:06,524 - INFO - Avg. fwd time: 15.6948 / Avg. bwd time: 35.0350 / Avg. batch time: 565.2725 (ms) / GPU bubble ratio: 28.20%
[rank3]:2025-11-02 15:42:06,505 - INFO - Avg. fwd time: 15.4616 / Avg. bwd time: 36.0924 / Avg. batch time: 428.3727 (ms) / GPU bubble ratio: 3.72%
[rank0]:2025-11-02 15:42:06,555 - INFO - Avg. fwd time: 13.7271 / Avg. bwd time: 32.0087 / Avg. batch time: 615.9100 (ms) / GPU bubble ratio: 40.59%
[rank2]:2025-11-02 15:42:06,792 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1542_rank2_trend_line.svg
[rank2]:2025-11-02 15:42:06,829 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.52/0.52, [MB2] 0.53/0.53, [MB3] 0.55/0.55, [MB4] 0.38/0.38, [MB5] 0.29/0.29, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:42:06,831 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.52/0.52, [MB2] 0.53/0.53, [MB3] 0.55/0.55, [MB4] 0.38/0.38, [MB5] 0.29/0.29, [MB6] 0.47/0.47, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:42:06,832 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0705  memory: 39.25GiB(28.07%)  tps: 7,135  tflops: 332.78  mfu: 33.65%
[rank1]:2025-11-02 15:42:06,797 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1542_rank1_trend_line.svg
[rank1]:2025-11-02 15:42:06,829 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.21/0.21, [MB1] 0.86/0.86, [MB2] 0.89/0.89, [MB3] 0.63/0.63, [MB4] 0.51/0.51, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 15:42:06,831 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.21/0.21, [MB1] 0.86/0.86, [MB2] 0.89/0.89, [MB3] 0.63/0.63, [MB4] 0.51/0.51, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 15:42:06,831 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 7,135  tflops: 332.77  mfu: 33.65%
[rank3]:2025-11-02 15:42:06,790 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1542_rank3_trend_line.svg
[rank0]:2025-11-02 15:42:06,823 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1542_rank0_trend_line.svg
[rank0]:2025-11-02 15:42:06,829 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.23/0.23, [MB1] 0.23/0.23, [MB2] 0.07/0.07, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.42/0.42, [MB7] 1.00/1.00
[rank0]:2025-11-02 15:42:06,831 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.23/0.23, [MB1] 0.23/0.23, [MB2] 0.07/0.07, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.42/0.42, [MB7] 1.00/1.00
[rank0]:2025-11-02 15:42:06,832 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0705  memory: 57.32GiB(41.00%)  tps: 7,136  tflops: 332.81  mfu: 33.65%
[rank3]:2025-11-02 15:42:07,024 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1542_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 389.65 ms, GPU Bubble Ratio: 26.72%, 19.40%, 27.43%, 24.42%
[rank3]:2025-11-02 15:42:07,024 - INFO - 	> Batch Time: 389.65 ms (Average Freeze Ratio: 0.56)
[rank3]:2025-11-02 15:42:07,024 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.70/0.70, [MB6] 0.50/0.50, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:42:11,944 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1542_stage2_step700.svg
[rank1]:2025-11-02 15:42:11,946 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1542_stage1_step700.svg
[rank3]:2025-11-02 15:42:11,869 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.70/0.70, [MB6] 0.50/0.50, [MB7] 1.00/1.00
[rank3]:2025-11-02 15:42:11,874 - INFO -  step: 700  loss:  0.3759  grad_norm:  0.0000  memory: 46.16GiB(33.01%)  tps: 7,126  tflops: 332.37  mfu: 33.61%
[rank0]:2025-11-02 15:42:11,943 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1542_stage0_step700.svg
[rank3]:2025-11-02 15:42:12,044 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1542_real_step700_rank3.svg
[rank3]:> Batch Time: 413.54 ms, GPU Bubble Ratio: 45.61%, 29.75%, 33.95%, 26.79%
[rank3]:2025-11-02 15:42:12,111 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1542_stage3_step700.svg
[rank0]:2025-11-02 15:44:07,100 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:44:08,949 - INFO - Avg. fwd time: 15.5877 / Avg. bwd time: 34.9835 / Avg. batch time: 421.3591 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-11-02 15:44:09,017 - INFO - Avg. fwd time: 15.8044 / Avg. bwd time: 34.1949 / Avg. batch time: 561.1893 (ms) / GPU bubble ratio: 28.72%
[rank2]:2025-11-02 15:44:08,984 - INFO - Avg. fwd time: 13.8160 / Avg. bwd time: 30.8523 / Avg. batch time: 509.3483 (ms) / GPU bubble ratio: 29.84%
[rank0]:2025-11-02 15:44:09,055 - INFO - Avg. fwd time: 13.7965 / Avg. bwd time: 30.9005 / Avg. batch time: 611.6465 (ms) / GPU bubble ratio: 41.54%
[rank0]:2025-11-02 15:44:09,091 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1355  memory: 57.32GiB(41.00%)  tps: 6,701  tflops: 312.51  mfu: 31.60%
[rank1]:2025-11-02 15:44:09,074 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1355  memory: 48.76GiB(34.88%)  tps: 6,701  tflops: 312.56  mfu: 31.60%
[rank2]:2025-11-02 15:44:09,081 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1355  memory: 39.25GiB(28.07%)  tps: 6,701  tflops: 312.54  mfu: 31.60%
[rank3]:2025-11-02 15:44:13,943 - INFO -  step: 750  loss:  0.1598  grad_norm:  0.1355  memory: 46.16GiB(33.01%)  tps: 6,711  tflops: 313.01  mfu: 31.65%
[rank0]:2025-11-02 15:46:07,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:46:09,775 - INFO - Avg. fwd time: 15.6716 / Avg. bwd time: 34.1384 / Avg. batch time: 415.8941 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-11-02 15:46:09,798 - INFO - Avg. fwd time: 13.8691 / Avg. bwd time: 30.3643 / Avg. batch time: 508.9246 (ms) / GPU bubble ratio: 30.47%
[rank1]:2025-11-02 15:46:09,808 - INFO - Avg. fwd time: 15.8752 / Avg. bwd time: 33.5650 / Avg. batch time: 560.3762 (ms) / GPU bubble ratio: 29.42%
[rank0]:2025-11-02 15:46:09,847 - INFO - Avg. fwd time: 13.8400 / Avg. bwd time: 30.0829 / Avg. batch time: 610.7037 (ms) / GPU bubble ratio: 42.46%
[rank2]:2025-11-02 15:46:10,137 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1546_rank2_trend_line.svg
[rank1]:2025-11-02 15:46:10,138 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1546_rank1_trend_line.svg
[rank3]:2025-11-02 15:46:10,124 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1546_rank3_trend_line.svg
[rank0]:2025-11-02 15:46:10,170 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1546_rank0_trend_line.svg
[rank0]:2025-11-02 15:46:10,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 15:46:10,178 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1377  memory: 57.32GiB(41.00%)  tps: 6,765  tflops: 315.54  mfu: 31.90%
[rank0]:2025-11-02 15:46:10,178 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 15:46:10,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.57/0.57, [MB2] 0.56/0.56, [MB3] 0.55/0.55, [MB4] 0.57/0.57, [MB5] 0.11/0.11, [MB6] 0.16/0.16, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:46:10,179 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1377  memory: 39.25GiB(28.07%)  tps: 6,765  tflops: 315.51  mfu: 31.90%
[rank2]:2025-11-02 15:46:10,179 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 15:46:10,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.31/0.31, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.22/0.22, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 15:46:10,179 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1377  memory: 48.76GiB(34.88%)  tps: 6,764  tflops: 315.49  mfu: 31.90%
[rank1]:2025-11-02 15:46:10,179 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 15:46:10,369 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1546_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 394.97 ms, GPU Bubble Ratio: 34.66%, 22.74%, 27.87%, 26.70%
[rank3]:2025-11-02 15:46:10,369 - INFO - 	> Batch Time: 394.97 ms (Average Freeze Ratio: 0.51)
[rank3]:2025-11-02 15:46:10,369 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.98/0.98, [MB4] 0.93/0.93, [MB5] 0.99/0.99, [MB6] 0.30/0.30, [MB7] 1.00/1.00
[rank3]:2025-11-02 15:46:15,233 - INFO -  step: 800  loss:  0.3015  grad_norm:  0.1377  memory: 46.16GiB(33.01%)  tps: 6,754  tflops: 315.01  mfu: 31.85%
[rank3]:2025-11-02 15:46:15,233 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 15:46:31,844 - INFO - validate step: 800  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,906
[rank2]:2025-11-02 15:46:31,893 - INFO - validate step: 800  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,863
[rank1]:2025-11-02 15:46:31,878 - INFO - validate step: 800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,877
[rank3]:2025-11-02 15:46:31,903 - INFO - validate step: 800  loss:  0.2503  memory: 46.16GiB(33.01%)  tps: 24,572
[rank0]:2025-11-02 15:46:31,978 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1546_stage0_step800.svg
[rank2]:2025-11-02 15:46:31,981 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1546_stage2_step800.svg
[rank1]:2025-11-02 15:46:31,982 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1546_stage1_step800.svg
[rank3]:2025-11-02 15:46:32,075 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1546_real_step800_rank3.svg
[rank3]:> Batch Time: 444.94 ms, GPU Bubble Ratio: 44.77%, 27.97%, 33.98%, 33.47%
[rank3]:2025-11-02 15:46:32,144 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1546_stage3_step800.svg
[rank0]:2025-11-02 15:48:35,270 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:48:37,175 - INFO - Avg. fwd time: 15.7618 / Avg. bwd time: 33.2678 / Avg. batch time: 412.0942 (ms) / GPU bubble ratio: 4.82%
[rank1]:2025-11-02 15:48:37,212 - INFO - Avg. fwd time: 15.9590 / Avg. bwd time: 32.8243 / Avg. batch time: 559.1843 (ms) / GPU bubble ratio: 30.21%
[rank2]:2025-11-02 15:48:37,207 - INFO - Avg. fwd time: 13.9305 / Avg. bwd time: 29.8352 / Avg. batch time: 507.9050 (ms) / GPU bubble ratio: 31.06%
[rank0]:2025-11-02 15:48:37,270 - INFO - Avg. fwd time: 13.8254 / Avg. bwd time: 30.4868 / Avg. batch time: 609.7646 (ms) / GPU bubble ratio: 41.86%
[rank1]:2025-11-02 15:48:37,369 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,528  tflops: 304.47  mfu: 30.79%
[rank2]:2025-11-02 15:48:37,379 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2158  memory: 39.25GiB(28.07%)  tps: 6,528  tflops: 304.48  mfu: 30.79%
[rank0]:2025-11-02 15:48:37,395 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2158  memory: 57.32GiB(41.00%)  tps: 6,525  tflops: 304.32  mfu: 30.77%
[rank3]:2025-11-02 15:48:42,265 - INFO -  step: 850  loss:  0.1165  grad_norm:  0.2158  memory: 46.16GiB(33.01%)  tps: 6,284  tflops: 293.09  mfu: 29.64%
[rank0]:2025-11-02 15:50:43,885 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:50:45,883 - INFO - Avg. fwd time: 15.8260 / Avg. bwd time: 32.4824 / Avg. batch time: 408.6781 (ms) / GPU bubble ratio: 5.43%
[rank2]:2025-11-02 15:50:45,921 - INFO - Avg. fwd time: 13.9742 / Avg. bwd time: 29.3515 / Avg. batch time: 508.2527 (ms) / GPU bubble ratio: 31.80%
[rank1]:2025-11-02 15:50:45,960 - INFO - Avg. fwd time: 16.0203 / Avg. bwd time: 32.1561 / Avg. batch time: 559.4086 (ms) / GPU bubble ratio: 31.10%
[rank0]:2025-11-02 15:50:46,005 - INFO - Avg. fwd time: 13.7973 / Avg. bwd time: 30.9673 / Avg. batch time: 610.2381 (ms) / GPU bubble ratio: 41.32%
[rank0]:2025-11-02 15:50:46,041 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2537  memory: 57.32GiB(41.00%)  tps: 6,368  tflops: 297.00  mfu: 30.03%
[rank2]:2025-11-02 15:50:46,029 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2537  memory: 39.25GiB(28.07%)  tps: 6,368  tflops: 296.99  mfu: 30.03%
[rank1]:2025-11-02 15:50:46,015 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,368  tflops: 297.00  mfu: 30.03%
[rank3]:2025-11-02 15:50:51,002 - INFO -  step: 900  loss:  0.1841  grad_norm:  0.2537  memory: 46.16GiB(33.01%)  tps: 6,363  tflops: 296.79  mfu: 30.01%
[rank1]:2025-11-02 15:50:51,072 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1550_stage1_step900.svg
[rank2]:2025-11-02 15:50:51,070 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1550_stage2_step900.svg
[rank0]:2025-11-02 15:50:51,067 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1550_stage0_step900.svg
[rank3]:2025-11-02 15:50:51,179 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1550_real_step900_rank3.svg
[rank3]:> Batch Time: 497.75 ms, GPU Bubble Ratio: 15.93%, 38.40%, 41.26%, 41.02%
[rank3]:2025-11-02 15:50:51,241 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1550_stage3_step900.svg
[rank0]:2025-11-02 15:52:53,540 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:52:55,494 - INFO - Avg. fwd time: 14.0111 / Avg. bwd time: 28.9859 / Avg. batch time: 508.2356 (ms) / GPU bubble ratio: 32.32%
[rank1]:2025-11-02 15:52:55,499 - INFO - Avg. fwd time: 16.0725 / Avg. bwd time: 31.6420 / Avg. batch time: 559.2870 (ms) / GPU bubble ratio: 31.75%
[rank3]:2025-11-02 15:52:55,461 - INFO - Avg. fwd time: 15.8835 / Avg. bwd time: 31.8814 / Avg. batch time: 406.1103 (ms) / GPU bubble ratio: 5.91%
[rank0]:2025-11-02 15:52:55,557 - INFO - Avg. fwd time: 13.7794 / Avg. bwd time: 31.3384 / Avg. batch time: 610.3117 (ms) / GPU bubble ratio: 40.86%
[rank2]:2025-11-02 15:52:55,665 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.4908  memory: 39.25GiB(28.07%)  tps: 6,319  tflops: 294.73  mfu: 29.80%
[rank1]:2025-11-02 15:52:55,654 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank0]:2025-11-02 15:52:55,680 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.4908  memory: 57.32GiB(41.00%)  tps: 6,319  tflops: 294.72  mfu: 29.80%
[rank3]:2025-11-02 15:53:00,541 - INFO -  step: 950  loss:  0.2707  grad_norm:  0.0000  memory: 46.16GiB(33.01%)  tps: 6,324  tflops: 294.95  mfu: 29.82%
[rank0]:2025-11-02 15:55:03,579 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:55:05,484 - INFO - Avg. fwd time: 15.9478 / Avg. bwd time: 31.2562 / Avg. batch time: 403.4736 (ms) / GPU bubble ratio: 6.40%
[rank1]:2025-11-02 15:55:05,521 - INFO - Avg. fwd time: 16.1308 / Avg. bwd time: 31.1013 / Avg. batch time: 559.6660 (ms) / GPU bubble ratio: 32.49%
[rank2]:2025-11-02 15:55:05,517 - INFO - Avg. fwd time: 14.0544 / Avg. bwd time: 28.5988 / Avg. batch time: 508.7422 (ms) / GPU bubble ratio: 32.93%
[rank0]:2025-11-02 15:55:05,580 - INFO - Avg. fwd time: 13.7629 / Avg. bwd time: 31.7320 / Avg. batch time: 610.9001 (ms) / GPU bubble ratio: 40.42%
[rank2]:2025-11-02 15:55:05,931 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1555_rank2_trend_line.svg
[rank2]:2025-11-02 15:55:05,993 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.67/0.67, [MB2] 0.36/0.36, [MB3] 0.23/0.23, [MB4] 0.26/0.26, [MB5] 0.26/0.26, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 15:55:05,996 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1560  memory: 39.25GiB(28.07%)  tps: 6,286  tflops: 293.16  mfu: 29.64%
[rank2]:2025-11-02 15:55:05,996 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 15:55:05,945 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1555_rank1_trend_line.svg
[rank1]:2025-11-02 15:55:05,992 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 15:55:05,994 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,285  tflops: 293.14  mfu: 29.64%
[rank1]:2025-11-02 15:55:05,994 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 15:55:05,928 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1555_rank3_trend_line.svg
[rank0]:2025-11-02 15:55:05,985 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1555_rank0_trend_line.svg
[rank0]:2025-11-02 15:55:05,991 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.33/0.33, [MB2] 0.33/0.33, [MB3] 0.33/0.33, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.09/0.09, [MB7] 1.00/1.00
[rank0]:2025-11-02 15:55:05,994 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1560  memory: 57.32GiB(41.00%)  tps: 6,286  tflops: 293.20  mfu: 29.65%
[rank0]:2025-11-02 15:55:05,994 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 15:55:06,185 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1555_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 388.98 ms, GPU Bubble Ratio: 22.13%, 23.76%, 26.33%, 25.59%
[rank3]:2025-11-02 15:55:06,185 - INFO - 	> Batch Time: 388.98 ms (Average Freeze Ratio: 0.40)
[rank3]:2025-11-02 15:55:06,186 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.77/0.77, [MB4] 0.57/0.57, [MB5] 0.64/0.64, [MB6] 0.60/0.60, [MB7] 1.00/1.00
[rank3]:2025-11-02 15:55:11,187 - INFO -  step: 1000  loss:  0.1550  grad_norm:  0.1560  memory: 46.16GiB(33.01%)  tps: 6,271  tflops: 292.46  mfu: 29.57%
[rank3]:2025-11-02 15:55:11,187 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 15:55:27,611 - INFO - validate step: 1000  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,949
[rank1]:2025-11-02 15:55:27,644 - INFO - validate step: 1000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,919
[rank2]:2025-11-02 15:55:27,662 - INFO - validate step: 1000  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,905
[rank3]:2025-11-02 15:55:27,674 - INFO - validate step: 1000  loss:  0.2521  memory: 46.16GiB(33.01%)  tps: 24,845
[rank0]:2025-11-02 15:55:27,742 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1555_stage0_step1000.svg
[rank1]:2025-11-02 15:55:27,746 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1555_stage1_step1000.svg
[rank2]:2025-11-02 15:55:27,745 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1555_stage2_step1000.svg
[rank3]:2025-11-02 15:55:27,849 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1555_real_step1000_rank3.svg
[rank3]:> Batch Time: 498.78 ms, GPU Bubble Ratio: 16.04%, 38.15%, 41.86%, 40.52%
[rank3]:2025-11-02 15:55:27,912 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1555_stage3_step1000.svg
[rank0]:2025-11-02 15:57:37,948 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:57:40,135 - INFO - Avg. fwd time: 15.9901 / Avg. bwd time: 30.7339 / Avg. batch time: 402.8552 (ms) / GPU bubble ratio: 7.21%
[rank1]:2025-11-02 15:57:40,221 - INFO - Avg. fwd time: 16.0865 / Avg. bwd time: 31.5819 / Avg. batch time: 561.2677 (ms) / GPU bubble ratio: 32.06%
[rank2]:2025-11-02 15:57:40,171 - INFO - Avg. fwd time: 14.0788 / Avg. bwd time: 28.3408 / Avg. batch time: 509.6934 (ms) / GPU bubble ratio: 33.42%
[rank0]:2025-11-02 15:57:40,254 - INFO - Avg. fwd time: 13.8113 / Avg. bwd time: 30.9355 / Avg. batch time: 612.0912 (ms) / GPU bubble ratio: 41.52%
[rank0]:2025-11-02 15:57:40,289 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.3648  memory: 57.32GiB(41.00%)  tps: 6,174  tflops: 287.97  mfu: 29.12%
[rank1]:2025-11-02 15:57:40,286 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.3648  memory: 48.76GiB(34.88%)  tps: 6,176  tflops: 288.05  mfu: 29.13%
[rank2]:2025-11-02 15:57:40,282 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.3648  memory: 39.25GiB(28.07%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank3]:2025-11-02 15:57:45,171 - INFO -  step: 1050  loss:  0.2736  grad_norm:  0.3648  memory: 46.16GiB(33.01%)  tps: 5,958  tflops: 277.88  mfu: 28.10%
[rank0]:2025-11-02 15:59:57,048 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:59:59,155 - INFO - Avg. fwd time: 14.1085 / Avg. bwd time: 28.1441 / Avg. batch time: 512.4356 (ms) / GPU bubble ratio: 34.04%
[rank3]:2025-11-02 15:59:59,112 - INFO - Avg. fwd time: 16.0384 / Avg. bwd time: 30.3462 / Avg. batch time: 402.6704 (ms) / GPU bubble ratio: 7.85%
[rank0]:2025-11-02 15:59:59,209 - INFO - Avg. fwd time: 13.8628 / Avg. bwd time: 30.2614 / Avg. batch time: 615.0218 (ms) / GPU bubble ratio: 42.60%
[rank1]:2025-11-02 15:59:59,206 - INFO - Avg. fwd time: 16.0583 / Avg. bwd time: 32.0137 / Avg. batch time: 564.5049 (ms) / GPU bubble ratio: 31.87%
[rank1]:2025-11-02 15:59:59,327 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1786  memory: 48.76GiB(34.88%)  tps: 5,892  tflops: 274.79  mfu: 27.79%
[rank2]:2025-11-02 15:59:59,321 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1786  memory: 39.25GiB(28.07%)  tps: 5,892  tflops: 274.80  mfu: 27.79%
[rank0]:2025-11-02 15:59:59,331 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1786  memory: 57.32GiB(41.00%)  tps: 5,892  tflops: 274.79  mfu: 27.79%
[rank3]:2025-11-02 16:00:04,247 - INFO -  step: 1100  loss:  0.2586  grad_norm:  0.1786  memory: 46.16GiB(33.01%)  tps: 5,890  tflops: 274.73  mfu: 27.78%
[rank2]:2025-11-02 16:00:04,316 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1559_stage2_step1100.svg
[rank1]:2025-11-02 16:00:04,320 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1559_stage1_step1100.svg
[rank0]:2025-11-02 16:00:04,316 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1559_stage0_step1100.svg
[rank3]:2025-11-02 16:00:04,426 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1600_real_step1100_rank3.svg
[rank3]:> Batch Time: 544.09 ms, GPU Bubble Ratio: 56.47%, 15.11%, 43.90%, 43.72%
[rank3]:2025-11-02 16:00:04,490 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1600_stage3_step1100.svg
[rank0]:2025-11-02 16:02:14,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:02:16,682 - INFO - Avg. fwd time: 16.0774 / Avg. bwd time: 29.9274 / Avg. batch time: 402.3263 (ms) / GPU bubble ratio: 8.52%
[rank1]:2025-11-02 16:02:16,777 - INFO - Avg. fwd time: 16.0190 / Avg. bwd time: 32.4625 / Avg. batch time: 565.8550 (ms) / GPU bubble ratio: 31.46%
[rank2]:2025-11-02 16:02:16,726 - INFO - Avg. fwd time: 14.1306 / Avg. bwd time: 27.9341 / Avg. batch time: 513.2786 (ms) / GPU bubble ratio: 34.44%
[rank0]:2025-11-02 16:02:16,780 - INFO - Avg. fwd time: 13.9087 / Avg. bwd time: 29.5319 / Avg. batch time: 615.9941 (ms) / GPU bubble ratio: 43.58%
[rank0]:2025-11-02 16:02:16,903 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2859  memory: 57.32GiB(41.00%)  tps: 5,955  tflops: 277.73  mfu: 28.08%
[rank1]:2025-11-02 16:02:16,899 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2859  memory: 48.76GiB(34.88%)  tps: 5,955  tflops: 277.73  mfu: 28.08%
[rank2]:2025-11-02 16:02:16,896 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.2859  memory: 39.25GiB(28.07%)  tps: 5,955  tflops: 277.72  mfu: 28.08%
[rank3]:2025-11-02 16:02:21,776 - INFO -  step: 1150  loss:  0.2593  grad_norm:  0.2859  memory: 46.16GiB(33.01%)  tps: 5,957  tflops: 277.82  mfu: 28.09%
[rank0]:2025-11-02 16:04:32,182 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:04:34,391 - INFO - Avg. fwd time: 14.1513 / Avg. bwd time: 27.7356 / Avg. batch time: 515.0648 (ms) / GPU bubble ratio: 34.94%
[rank3]:2025-11-02 16:04:34,354 - INFO - Avg. fwd time: 16.1114 / Avg. bwd time: 29.5522 / Avg. batch time: 402.0327 (ms) / GPU bubble ratio: 9.13%
[rank1]:2025-11-02 16:04:34,440 - INFO - Avg. fwd time: 15.9833 / Avg. bwd time: 32.8728 / Avg. batch time: 568.0871 (ms) / GPU bubble ratio: 31.20%
[rank0]:2025-11-02 16:04:34,475 - INFO - Avg. fwd time: 13.9485 / Avg. bwd time: 28.8879 / Avg. batch time: 617.9062 (ms) / GPU bubble ratio: 44.54%
[rank3]:2025-11-02 16:04:34,812 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1604_rank3_trend_line.svg
[rank1]:2025-11-02 16:04:34,860 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1604_rank1_trend_line.svg
[rank1]:2025-11-02 16:04:34,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.93/0.93, [MB5] 0.00/0.00, [MB6] 0.43/0.43, [MB7] 1.00/1.00
[rank1]:2025-11-02 16:04:34,900 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1861  memory: 48.76GiB(34.88%)  tps: 5,936  tflops: 276.87  mfu: 27.99%
[rank2]:2025-11-02 16:04:34,819 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1604_rank2_trend_line.svg
[rank2]:2025-11-02 16:04:34,897 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.64/0.64, [MB1] 0.54/0.54, [MB2] 0.51/0.51, [MB3] 0.50/0.50, [MB4] 0.53/0.53, [MB5] 0.41/0.41, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 16:04:34,900 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1861  memory: 39.25GiB(28.07%)  tps: 5,936  tflops: 276.86  mfu: 27.99%
[rank1]:2025-11-02 16:04:34,900 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 16:04:34,900 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 16:04:34,890 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1604_rank0_trend_line.svg
[rank0]:2025-11-02 16:04:34,896 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.28/0.28, [MB1] 0.27/0.27, [MB2] 0.26/0.26, [MB3] 0.22/0.22, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank0]:2025-11-02 16:04:34,899 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1861  memory: 57.32GiB(41.00%)  tps: 5,936  tflops: 276.87  mfu: 28.00%
[rank0]:2025-11-02 16:04:34,900 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 16:04:35,090 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1604_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 381.86 ms, GPU Bubble Ratio: 26.11%, 19.87%, 24.91%, 25.22%
[rank3]:2025-11-02 16:04:35,090 - INFO - 	> Batch Time: 381.86 ms (Average Freeze Ratio: 0.63)
[rank3]:2025-11-02 16:04:35,091 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.92/0.92, [MB3] 0.88/0.88, [MB4] 0.82/0.82, [MB5] 0.89/0.89, [MB6] 0.69/0.69, [MB7] 1.00/1.00
[rank3]:2025-11-02 16:04:39,999 - INFO -  step: 1200  loss:  0.2943  grad_norm:  0.1861  memory: 46.16GiB(33.01%)  tps: 5,927  tflops: 276.42  mfu: 27.95%
[rank3]:2025-11-02 16:04:40,000 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 16:04:56,311 - INFO - validate step: 1200  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,130
[rank0]:2025-11-02 16:04:56,311 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:04:56,316 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 16:04:56,347 - INFO - validate step: 1200  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 19,099
[rank1]:2025-11-02 16:04:56,348 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 16:04:56,384 - INFO - validate step: 1200  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 19,066
[rank2]:2025-11-02 16:04:56,385 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 16:04:56,406 - INFO - validate step: 1200  loss:  0.2544  memory: 46.16GiB(33.01%)  tps: 24,967
[rank3]:2025-11-02 16:04:56,408 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 16:05:09,119 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.71 seconds.
[rank2]:2025-11-02 16:05:10,744 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.36 seconds.
[rank1]:2025-11-02 16:05:11,821 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.47 seconds.
[rank0]:2025-11-02 16:05:15,495 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 16:05:15,500 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.19 seconds.
[rank2]:2025-11-02 16:05:15,593 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1605_stage2_step1200.svg
[rank1]:2025-11-02 16:05:15,596 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1605_stage1_step1200.svg
[rank0]:2025-11-02 16:05:15,670 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1605_stage0_step1200.svg
[rank3]:2025-11-02 16:05:15,782 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1605_real_step1200_rank3.svg
[rank3]:> Batch Time: 540.67 ms, GPU Bubble Ratio: 56.47%, 15.41%, 43.55%, 43.02%
[rank3]:2025-11-02 16:05:15,848 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1605_stage3_step1200.svg
[rank0]:2025-11-02 16:07:09,695 - INFO - [GC] Peforming periodical GC collection 2.64 seconds
[rank1]:2025-11-02 16:07:11,408 - INFO - Avg. fwd time: 16.0334 / Avg. bwd time: 32.3544 / Avg. batch time: 566.0268 (ms) / GPU bubble ratio: 31.61%
[rank2]:2025-11-02 16:07:11,408 - INFO - Avg. fwd time: 14.1764 / Avg. bwd time: 27.5476 / Avg. batch time: 513.5893 (ms) / GPU bubble ratio: 35.01%
[rank3]:2025-11-02 16:07:11,384 - INFO - Avg. fwd time: 16.1491 / Avg. bwd time: 29.2258 / Avg. batch time: 399.0090 (ms) / GPU bubble ratio: 9.02%
[rank0]:2025-11-02 16:07:11,448 - INFO - Avg. fwd time: 13.9794 / Avg. bwd time: 28.3975 / Avg. batch time: 615.6624 (ms) / GPU bubble ratio: 44.93%
[rank1]:2025-11-02 16:07:11,537 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,060  tflops: 282.62  mfu: 28.58%
[rank0]:2025-11-02 16:07:11,564 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1678  memory: 57.32GiB(41.00%)  tps: 6,057  tflops: 282.49  mfu: 28.56%
[rank2]:2025-11-02 16:07:11,554 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1678  memory: 39.25GiB(28.07%)  tps: 6,061  tflops: 282.67  mfu: 28.58%
[rank3]:2025-11-02 16:07:16,795 - INFO -  step: 1250  loss:  0.3135  grad_norm:  0.1678  memory: 46.16GiB(33.01%)  tps: 5,835  tflops: 272.16  mfu: 27.52%
[rank0]:2025-11-02 16:09:07,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 16:09:09,600 - INFO - Avg. fwd time: 16.0902 / Avg. bwd time: 31.7941 / Avg. batch time: 564.0904 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:09:09,601 - INFO - Avg. fwd time: 14.2047 / Avg. bwd time: 27.3558 / Avg. batch time: 512.2824 (ms) / GPU bubble ratio: 35.10%
[rank3]:2025-11-02 16:09:09,579 - INFO - Avg. fwd time: 16.1911 / Avg. bwd time: 28.8621 / Avg. batch time: 395.6740 (ms) / GPU bubble ratio: 8.91%
[rank0]:2025-11-02 16:09:09,640 - INFO - Avg. fwd time: 14.0136 / Avg. bwd time: 27.8643 / Avg. batch time: 613.5216 (ms) / GPU bubble ratio: 45.39%
[rank1]:2025-11-02 16:09:09,729 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,931  tflops: 323.27  mfu: 32.69%
[rank0]:2025-11-02 16:09:09,755 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0635  memory: 57.32GiB(41.00%)  tps: 6,931  tflops: 323.27  mfu: 32.69%
[rank2]:2025-11-02 16:09:09,741 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0635  memory: 39.25GiB(28.07%)  tps: 6,931  tflops: 323.28  mfu: 32.69%
[rank3]:2025-11-02 16:09:14,908 - INFO -  step: 1300  loss:  0.1896  grad_norm:  0.0635  memory: 46.16GiB(33.01%)  tps: 6,936  tflops: 323.49  mfu: 32.71%
[rank2]:2025-11-02 16:09:14,983 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1609_stage2_step1300.svg
[rank1]:2025-11-02 16:09:14,982 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1609_stage1_step1300.svg
[rank0]:2025-11-02 16:09:14,983 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1609_stage0_step1300.svg
[rank3]:2025-11-02 16:09:15,083 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1609_real_step1300_rank3.svg
[rank3]:> Batch Time: 420.78 ms, GPU Bubble Ratio: 43.72%, 32.25%, 29.23%, 29.42%
[rank3]:2025-11-02 16:09:15,150 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1609_stage3_step1300.svg
[rank0]:2025-11-02 16:11:06,080 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:11:07,843 - INFO - Avg. fwd time: 16.2345 / Avg. bwd time: 28.5360 / Avg. batch time: 392.6730 (ms) / GPU bubble ratio: 8.79%
[rank2]:2025-11-02 16:11:07,878 - INFO - Avg. fwd time: 14.2343 / Avg. bwd time: 27.1683 / Avg. batch time: 509.9844 (ms) / GPU bubble ratio: 35.05%
[rank1]:2025-11-02 16:11:07,907 - INFO - Avg. fwd time: 16.1464 / Avg. bwd time: 31.2821 / Avg. batch time: 561.2263 (ms) / GPU bubble ratio: 32.39%
[rank0]:2025-11-02 16:11:07,944 - INFO - Avg. fwd time: 14.0471 / Avg. bwd time: 27.3728 / Avg. batch time: 610.4819 (ms) / GPU bubble ratio: 45.72%
[rank2]:2025-11-02 16:11:07,968 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1048  memory: 39.25GiB(28.07%)  tps: 6,929  tflops: 323.17  mfu: 32.68%
[rank1]:2025-11-02 16:11:07,954 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,929  tflops: 323.18  mfu: 32.68%
[rank0]:2025-11-02 16:11:07,979 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1048  memory: 57.32GiB(41.00%)  tps: 6,929  tflops: 323.18  mfu: 32.68%
[rank3]:2025-11-02 16:11:12,576 - INFO -  step: 1350  loss:  0.1280  grad_norm:  0.1048  memory: 46.16GiB(33.01%)  tps: 6,962  tflops: 324.71  mfu: 32.83%
[rank0]:2025-11-02 16:13:02,651 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:13:04,377 - INFO - Avg. fwd time: 16.2639 / Avg. bwd time: 28.2608 / Avg. batch time: 390.1492 (ms) / GPU bubble ratio: 8.70%
[rank2]:2025-11-02 16:13:04,401 - INFO - Avg. fwd time: 14.2548 / Avg. bwd time: 27.0263 / Avg. batch time: 509.4008 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-11-02 16:13:04,400 - INFO - Avg. fwd time: 16.1862 / Avg. bwd time: 30.8709 / Avg. batch time: 560.1911 (ms) / GPU bubble ratio: 32.80%
[rank0]:2025-11-02 16:13:04,440 - INFO - Avg. fwd time: 14.0702 / Avg. bwd time: 26.9775 / Avg. batch time: 609.2895 (ms) / GPU bubble ratio: 46.10%
[rank1]:2025-11-02 16:13:04,530 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 7,027  tflops: 327.75  mfu: 33.14%
[rank1]:2025-11-02 16:13:04,530 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 16:13:04,556 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1082  memory: 57.32GiB(41.00%)  tps: 7,027  tflops: 327.75  mfu: 33.14%
[rank0]:2025-11-02 16:13:04,556 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 16:13:04,546 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1082  memory: 39.25GiB(28.07%)  tps: 7,027  tflops: 327.75  mfu: 33.14%
[rank2]:2025-11-02 16:13:04,546 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 16:13:09,651 - INFO -  step: 1400  loss:  0.4020  grad_norm:  0.1082  memory: 46.16GiB(33.01%)  tps: 6,997  tflops: 326.36  mfu: 33.00%
[rank3]:2025-11-02 16:13:09,651 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 16:13:26,166 - INFO - validate step: 1400  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,954
[rank3]:2025-11-02 16:13:26,231 - INFO - validate step: 1400  loss:  0.2509  memory: 46.16GiB(33.01%)  tps: 24,707
[rank1]:2025-11-02 16:13:26,199 - INFO - validate step: 1400  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,903
[rank2]:2025-11-02 16:13:26,218 - INFO - validate step: 1400  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,900
[rank1]:2025-11-02 16:13:26,308 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1613_stage1_step1400.svg
[rank2]:2025-11-02 16:13:26,306 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1613_stage2_step1400.svg
[rank0]:2025-11-02 16:13:26,306 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1613_stage0_step1400.svg
[rank3]:2025-11-02 16:13:26,402 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1613_real_step1400_rank3.svg
[rank3]:> Batch Time: 426.62 ms, GPU Bubble Ratio: 43.71%, 32.52%, 28.94%, 29.75%
[rank3]:2025-11-02 16:13:26,469 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1613_stage3_step1400.svg
[rank0]:2025-11-02 16:15:19,190 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:15:20,882 - INFO - Avg. fwd time: 16.3068 / Avg. bwd time: 27.9782 / Avg. batch time: 387.6270 (ms) / GPU bubble ratio: 8.60%
[rank1]:2025-11-02 16:15:20,905 - INFO - Avg. fwd time: 16.2385 / Avg. bwd time: 30.4291 / Avg. batch time: 557.9671 (ms) / GPU bubble ratio: 33.09%
[rank2]:2025-11-02 16:15:20,907 - INFO - Avg. fwd time: 14.2841 / Avg. bwd time: 26.8790 / Avg. batch time: 507.6610 (ms) / GPU bubble ratio: 35.13%
[rank0]:2025-11-02 16:15:20,945 - INFO - Avg. fwd time: 14.1021 / Avg. bwd time: 26.5549 / Avg. batch time: 606.9220 (ms) / GPU bubble ratio: 46.41%
[rank1]:2025-11-02 16:15:21,038 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 7,134  tflops: 332.71  mfu: 33.64%
[rank2]:2025-11-02 16:15:21,054 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0968  memory: 39.25GiB(28.07%)  tps: 7,134  tflops: 332.71  mfu: 33.64%
[rank0]:2025-11-02 16:15:21,063 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0968  memory: 57.32GiB(41.00%)  tps: 7,130  tflops: 332.54  mfu: 33.62%
[rank3]:2025-11-02 16:15:26,211 - INFO -  step: 1450  loss:  0.2212  grad_norm:  0.0968  memory: 46.16GiB(33.01%)  tps: 6,828  tflops: 318.46  mfu: 32.20%
[rank0]:2025-11-02 16:17:18,656 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:17:20,478 - INFO - Avg. fwd time: 16.3493 / Avg. bwd time: 27.7143 / Avg. batch time: 385.2820 (ms) / GPU bubble ratio: 8.51%
[rank1]:2025-11-02 16:17:20,543 - INFO - Avg. fwd time: 16.2886 / Avg. bwd time: 30.0186 / Avg. batch time: 556.6550 (ms) / GPU bubble ratio: 33.45%
[rank2]:2025-11-02 16:17:20,513 - INFO - Avg. fwd time: 14.3128 / Avg. bwd time: 26.7412 / Avg. batch time: 506.8019 (ms) / GPU bubble ratio: 35.20%
[rank0]:2025-11-02 16:17:20,580 - INFO - Avg. fwd time: 14.1340 / Avg. bwd time: 26.1569 / Avg. batch time: 605.4694 (ms) / GPU bubble ratio: 46.76%
[rank1]:2025-11-02 16:17:20,591 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,852  tflops: 319.59  mfu: 32.31%
[rank2]:2025-11-02 16:17:20,604 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1041  memory: 39.25GiB(28.07%)  tps: 6,852  tflops: 319.60  mfu: 32.32%
[rank0]:2025-11-02 16:17:20,617 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1041  memory: 57.32GiB(41.00%)  tps: 6,852  tflops: 319.59  mfu: 32.31%
[rank3]:2025-11-02 16:17:25,692 - INFO -  step: 1500  loss:  0.2791  grad_norm:  0.1041  memory: 46.16GiB(33.01%)  tps: 6,856  tflops: 319.79  mfu: 32.33%
[rank0]:2025-11-02 16:17:25,765 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1617_stage0_step1500.svg
[rank2]:2025-11-02 16:17:25,770 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1617_stage2_step1500.svg
[rank1]:2025-11-02 16:17:25,770 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1617_stage1_step1500.svg
[rank3]:2025-11-02 16:17:25,862 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1617_real_step1500_rank3.svg
[rank3]:> Batch Time: 432.03 ms, GPU Bubble Ratio: 43.61%, 32.56%, 29.20%, 29.39%
[rank3]:2025-11-02 16:17:25,929 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1617_stage3_step1500.svg
[rank0]:2025-11-02 16:19:18,209 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 16:19:19,959 - INFO - Avg. fwd time: 16.3294 / Avg. bwd time: 29.6886 / Avg. batch time: 555.3445 (ms) / GPU bubble ratio: 33.71%
[rank2]:2025-11-02 16:19:19,960 - INFO - Avg. fwd time: 14.3366 / Avg. bwd time: 26.6190 / Avg. batch time: 505.8580 (ms) / GPU bubble ratio: 35.23%
[rank3]:2025-11-02 16:19:19,935 - INFO - Avg. fwd time: 16.3837 / Avg. bwd time: 27.5053 / Avg. batch time: 383.4019 (ms) / GPU bubble ratio: 8.42%
[rank0]:2025-11-02 16:19:19,998 - INFO - Avg. fwd time: 14.1597 / Avg. bwd time: 25.8444 / Avg. batch time: 604.0554 (ms) / GPU bubble ratio: 47.02%
[rank2]:2025-11-02 16:19:20,103 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1807  memory: 39.25GiB(28.07%)  tps: 6,855  tflops: 319.73  mfu: 32.33%
[rank1]:2025-11-02 16:19:20,089 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,855  tflops: 319.74  mfu: 32.33%
[rank0]:2025-11-02 16:19:20,115 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1807  memory: 57.32GiB(41.00%)  tps: 6,855  tflops: 319.73  mfu: 32.33%
[rank3]:2025-11-02 16:19:25,214 - INFO -  step: 1550  loss:  0.3289  grad_norm:  0.1807  memory: 46.16GiB(33.01%)  tps: 6,854  tflops: 319.68  mfu: 32.32%
[rank0]:2025-11-02 16:21:16,864 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:21:18,594 - INFO - Avg. fwd time: 16.4156 / Avg. bwd time: 27.2689 / Avg. batch time: 381.2599 (ms) / GPU bubble ratio: 8.34%
[rank1]:2025-11-02 16:21:18,616 - INFO - Avg. fwd time: 16.3695 / Avg. bwd time: 29.3248 / Avg. batch time: 554.1113 (ms) / GPU bubble ratio: 34.03%
[rank2]:2025-11-02 16:21:18,617 - INFO - Avg. fwd time: 14.3583 / Avg. bwd time: 26.4879 / Avg. batch time: 505.0284 (ms) / GPU bubble ratio: 35.30%
[rank0]:2025-11-02 16:21:18,657 - INFO - Avg. fwd time: 14.1840 / Avg. bwd time: 25.4960 / Avg. batch time: 602.6769 (ms) / GPU bubble ratio: 47.33%
[rank3]:2025-11-02 16:21:19,203 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1621_rank3_trend_line.svg
[rank2]:2025-11-02 16:21:19,280 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1621_rank2_trend_line.svg
[rank2]:2025-11-02 16:21:19,337 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.69/0.69, [MB1] 0.64/0.64, [MB2] 0.65/0.65, [MB3] 0.51/0.51, [MB4] 0.42/0.42, [MB5] 0.41/0.41, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 16:21:19,298 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1621_rank1_trend_line.svg
[rank1]:2025-11-02 16:21:19,337 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.95/0.95, [MB1] 0.97/0.97, [MB2] 0.90/0.90, [MB3] 0.83/0.83, [MB4] 0.82/0.82, [MB5] 0.00/0.00, [MB6] 0.21/0.21, [MB7] 1.00/1.00
[rank1]:2025-11-02 16:21:19,341 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 6,870  tflops: 320.39  mfu: 32.40%
[rank1]:2025-11-02 16:21:19,341 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 16:21:19,340 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1636  memory: 39.25GiB(28.07%)  tps: 6,870  tflops: 320.43  mfu: 32.40%
[rank2]:2025-11-02 16:21:19,340 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 16:21:19,330 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule_adjustment/251102_1621_rank0_trend_line.svg
[rank0]:2025-11-02 16:21:19,337 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.16/0.16, [MB1] 0.08/0.08, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.34/0.34, [MB7] 1.00/1.00
[rank0]:2025-11-02 16:21:19,340 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1636  memory: 57.32GiB(41.00%)  tps: 6,871  tflops: 320.47  mfu: 32.40%
[rank0]:2025-11-02 16:21:19,341 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 16:21:19,534 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1621_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 382.91 ms, GPU Bubble Ratio: 28.15%, 21.01%, 25.40%, 25.79%
[rank3]:2025-11-02 16:21:19,534 - INFO - 	> Batch Time: 382.91 ms (Average Freeze Ratio: 0.59)
[rank3]:2025-11-02 16:21:19,535 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.80/0.80, [MB5] 0.72/0.72, [MB6] 0.68/0.68, [MB7] 1.00/1.00
[rank3]:2025-11-02 16:21:24,754 - INFO -  step: 1600  loss:  0.4502  grad_norm:  0.1636  memory: 46.16GiB(33.01%)  tps: 6,853  tflops: 319.63  mfu: 32.32%
[rank3]:2025-11-02 16:21:24,754 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 16:21:41,287 - INFO - validate step: 1600  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,664
[rank1]:2025-11-02 16:21:41,269 - INFO - validate step: 1600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,679
[rank0]:2025-11-02 16:21:41,237 - INFO - validate step: 1600  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,707
[rank3]:2025-11-02 16:21:41,296 - INFO - validate step: 1600  loss:  0.2542  memory: 46.16GiB(33.01%)  tps: 24,762
[rank2]:2025-11-02 16:21:41,376 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1621_stage2_step1600.svg
[rank1]:2025-11-02 16:21:41,377 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1621_stage1_step1600.svg
[rank0]:2025-11-02 16:21:41,375 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1621_stage0_step1600.svg
[rank3]:2025-11-02 16:21:41,468 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1621_real_step1600_rank3.svg
[rank3]:> Batch Time: 430.66 ms, GPU Bubble Ratio: 43.89%, 32.41%, 29.41%, 29.81%
[rank3]:2025-11-02 16:21:41,538 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1621_stage3_step1600.svg
[rank0]:2025-11-02 16:23:34,257 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:23:36,078 - INFO - Avg. fwd time: 16.4486 / Avg. bwd time: 27.0525 / Avg. batch time: 379.2966 (ms) / GPU bubble ratio: 8.25%
[rank2]:2025-11-02 16:23:36,115 - INFO - Avg. fwd time: 14.3817 / Avg. bwd time: 26.3638 / Avg. batch time: 503.4355 (ms) / GPU bubble ratio: 35.25%
[rank1]:2025-11-02 16:23:36,149 - INFO - Avg. fwd time: 16.4101 / Avg. bwd time: 29.0183 / Avg. batch time: 552.2000 (ms) / GPU bubble ratio: 34.19%
[rank0]:2025-11-02 16:23:36,191 - INFO - Avg. fwd time: 14.2020 / Avg. bwd time: 25.2294 / Avg. batch time: 600.7653 (ms) / GPU bubble ratio: 47.49%
[rank2]:2025-11-02 16:23:36,217 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1834  memory: 39.25GiB(28.07%)  tps: 7,128  tflops: 332.44  mfu: 33.61%
[rank1]:2025-11-02 16:23:36,207 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1834  memory: 48.76GiB(34.88%)  tps: 7,127  tflops: 332.42  mfu: 33.61%
[rank0]:2025-11-02 16:23:36,228 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1834  memory: 57.32GiB(41.00%)  tps: 7,124  tflops: 332.27  mfu: 33.60%
[rank3]:2025-11-02 16:23:41,209 - INFO -  step: 1650  loss:  0.4403  grad_norm:  0.1834  memory: 46.16GiB(33.01%)  tps: 6,832  tflops: 318.63  mfu: 32.22%
[rank0]:2025-11-02 16:25:33,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:25:35,607 - INFO - Avg. fwd time: 16.4756 / Avg. bwd time: 26.8729 / Avg. batch time: 377.6706 (ms) / GPU bubble ratio: 8.18%
[rank1]:2025-11-02 16:25:35,633 - INFO - Avg. fwd time: 16.4422 / Avg. bwd time: 28.7749 / Avg. batch time: 551.7473 (ms) / GPU bubble ratio: 34.44%
[rank2]:2025-11-02 16:25:35,630 - INFO - Avg. fwd time: 14.4014 / Avg. bwd time: 26.2550 / Avg. batch time: 503.2370 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-11-02 16:25:35,694 - INFO - Avg. fwd time: 14.2159 / Avg. bwd time: 25.0170 / Avg. batch time: 600.3246 (ms) / GPU bubble ratio: 47.72%
[rank2]:2025-11-02 16:25:35,780 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2167  memory: 39.25GiB(28.07%)  tps: 6,852  tflops: 319.56  mfu: 32.31%
[rank1]:2025-11-02 16:25:35,766 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2167  memory: 48.76GiB(34.88%)  tps: 6,852  tflops: 319.57  mfu: 32.31%
[rank0]:2025-11-02 16:25:35,791 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2167  memory: 57.32GiB(41.00%)  tps: 6,852  tflops: 319.56  mfu: 32.31%
[rank3]:2025-11-02 16:25:40,806 - INFO -  step: 1700  loss:  0.4400  grad_norm:  0.2167  memory: 46.16GiB(33.01%)  tps: 6,850  tflops: 319.48  mfu: 32.30%
[rank2]:2025-11-02 16:25:40,884 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1625_stage2_step1700.svg
[rank1]:2025-11-02 16:25:40,886 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1625_stage1_step1700.svg
[rank0]:2025-11-02 16:25:40,883 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1625_stage0_step1700.svg
[rank3]:2025-11-02 16:25:40,978 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1625_real_step1700_rank3.svg
[rank3]:> Batch Time: 433.71 ms, GPU Bubble Ratio: 40.85%, 30.80%, 29.83%, 30.31%
[rank3]:2025-11-02 16:25:41,046 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1625_stage3_step1700.svg
[rank0]:2025-11-02 16:27:33,619 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:27:35,395 - INFO - Avg. fwd time: 14.4212 / Avg. bwd time: 26.1459 / Avg. batch time: 501.7555 (ms) / GPU bubble ratio: 35.32%
[rank3]:2025-11-02 16:27:35,371 - INFO - Avg. fwd time: 16.5046 / Avg. bwd time: 26.6771 / Avg. batch time: 375.8884 (ms) / GPU bubble ratio: 8.10%
[rank1]:2025-11-02 16:27:35,399 - INFO - Avg. fwd time: 16.4777 / Avg. bwd time: 28.5060 / Avg. batch time: 549.9748 (ms) / GPU bubble ratio: 34.57%
[rank0]:2025-11-02 16:27:35,457 - INFO - Avg. fwd time: 14.2315 / Avg. bwd time: 24.7850 / Avg. batch time: 598.5694 (ms) / GPU bubble ratio: 47.85%
[rank2]:2025-11-02 16:27:35,547 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1937  memory: 39.25GiB(28.07%)  tps: 6,840  tflops: 319.02  mfu: 32.26%
[rank1]:2025-11-02 16:27:35,536 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1937  memory: 48.76GiB(34.88%)  tps: 6,840  tflops: 319.01  mfu: 32.26%
[rank0]:2025-11-02 16:27:35,556 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1937  memory: 57.32GiB(41.00%)  tps: 6,840  tflops: 319.02  mfu: 32.26%
[rank3]:2025-11-02 16:27:40,485 - INFO -  step: 1750  loss:  0.4424  grad_norm:  0.1937  memory: 46.16GiB(33.01%)  tps: 6,845  tflops: 319.26  mfu: 32.28%
[rank0]:2025-11-02 16:29:30,974 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:29:32,698 - INFO - Avg. fwd time: 16.5210 / Avg. bwd time: 26.4899 / Avg. batch time: 374.0961 (ms) / GPU bubble ratio: 8.02%
[rank1]:2025-11-02 16:29:32,772 - INFO - Avg. fwd time: 16.5029 / Avg. bwd time: 28.2456 / Avg. batch time: 548.8082 (ms) / GPU bubble ratio: 34.77%
[rank2]:2025-11-02 16:29:32,740 - INFO - Avg. fwd time: 14.4347 / Avg. bwd time: 26.0218 / Avg. batch time: 500.8678 (ms) / GPU bubble ratio: 35.38%
[rank1]:2025-11-02 16:29:32,827 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1165  memory: 48.76GiB(34.88%)  tps: 6,984  tflops: 325.75  mfu: 32.94%
[rank1]:2025-11-02 16:29:32,828 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 16:29:32,837 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1165  memory: 39.25GiB(28.07%)  tps: 6,984  tflops: 325.75  mfu: 32.94%
[rank2]:2025-11-02 16:29:32,837 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 16:29:32,813 - INFO - Avg. fwd time: 14.2399 / Avg. bwd time: 24.5614 / Avg. batch time: 597.4097 (ms) / GPU bubble ratio: 48.04%
[rank0]:2025-11-02 16:29:32,850 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1165  memory: 57.32GiB(41.00%)  tps: 6,984  tflops: 325.74  mfu: 32.94%
[rank0]:2025-11-02 16:29:32,850 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 16:29:37,815 - INFO -  step: 1800  loss:  0.0673  grad_norm:  0.1165  memory: 46.16GiB(33.01%)  tps: 6,982  tflops: 325.65  mfu: 32.93%
[rank3]:2025-11-02 16:29:37,815 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 16:29:54,376 - INFO - validate step: 1800  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 19,017
[rank1]:2025-11-02 16:29:54,359 - INFO - validate step: 1800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 19,024
[rank0]:2025-11-02 16:29:54,326 - INFO - validate step: 1800  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,073
[rank3]:2025-11-02 16:29:54,388 - INFO - validate step: 1800  loss:  0.2492  memory: 46.16GiB(33.01%)  tps: 24,715
[rank1]:2025-11-02 16:29:54,464 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1629_stage1_step1800.svg
[rank2]:2025-11-02 16:29:54,466 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1629_stage2_step1800.svg
[rank0]:2025-11-02 16:29:54,464 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1629_stage0_step1800.svg
[rank3]:2025-11-02 16:29:54,561 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1629_real_step1800_rank3.svg
[rank3]:> Batch Time: 418.50 ms, GPU Bubble Ratio: 39.72%, 30.70%, 31.14%, 30.29%
[rank3]:2025-11-02 16:29:54,629 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1629_stage3_step1800.svg
[rank0]:2025-11-02 16:31:45,016 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:31:46,687 - INFO - Avg. fwd time: 16.5332 / Avg. bwd time: 26.3352 / Avg. batch time: 372.6023 (ms) / GPU bubble ratio: 7.96%
[rank2]:2025-11-02 16:31:46,709 - INFO - Avg. fwd time: 14.4444 / Avg. bwd time: 25.9223 / Avg. batch time: 499.9789 (ms) / GPU bubble ratio: 35.41%
[rank1]:2025-11-02 16:31:46,712 - INFO - Avg. fwd time: 16.5227 / Avg. bwd time: 28.0374 / Avg. batch time: 547.6979 (ms) / GPU bubble ratio: 34.91%
[rank0]:2025-11-02 16:31:46,767 - INFO - Avg. fwd time: 14.2455 / Avg. bwd time: 24.3848 / Avg. batch time: 596.2979 (ms) / GPU bubble ratio: 48.17%
[rank2]:2025-11-02 16:31:46,855 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1947  memory: 39.25GiB(28.07%)  tps: 7,283  tflops: 339.69  mfu: 34.35%
[rank1]:2025-11-02 16:31:46,846 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1947  memory: 48.76GiB(34.88%)  tps: 7,283  tflops: 339.66  mfu: 34.34%
[rank0]:2025-11-02 16:31:46,868 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1947  memory: 57.32GiB(41.00%)  tps: 7,279  tflops: 339.50  mfu: 34.33%
[rank3]:2025-11-02 16:31:51,871 - INFO -  step: 1850  loss:  0.3768  grad_norm:  0.1947  memory: 46.16GiB(33.01%)  tps: 6,973  tflops: 325.23  mfu: 32.88%
[rank0]:2025-11-02 16:33:42,019 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:33:43,689 - INFO - Avg. fwd time: 16.5441 / Avg. bwd time: 26.1587 / Avg. batch time: 370.8914 (ms) / GPU bubble ratio: 7.89%
[rank2]:2025-11-02 16:33:43,711 - INFO - Avg. fwd time: 14.4521 / Avg. bwd time: 25.8133 / Avg. batch time: 499.1974 (ms) / GPU bubble ratio: 35.47%
[rank1]:2025-11-02 16:33:43,715 - INFO - Avg. fwd time: 16.5415 / Avg. bwd time: 27.8048 / Avg. batch time: 546.6676 (ms) / GPU bubble ratio: 35.10%
[rank0]:2025-11-02 16:33:43,776 - INFO - Avg. fwd time: 14.2501 / Avg. bwd time: 24.1855 / Avg. batch time: 595.2629 (ms) / GPU bubble ratio: 48.34%
[rank2]:2025-11-02 16:33:43,860 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0701  memory: 39.25GiB(28.07%)  tps: 7,001  tflops: 326.55  mfu: 33.02%
[rank1]:2025-11-02 16:33:43,852 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0701  memory: 48.76GiB(34.88%)  tps: 7,001  tflops: 326.54  mfu: 33.02%
[rank0]:2025-11-02 16:33:43,872 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0701  memory: 57.32GiB(41.00%)  tps: 7,001  tflops: 326.55  mfu: 33.02%
[rank3]:2025-11-02 16:33:48,885 - INFO -  step: 1900  loss:  0.1995  grad_norm:  0.0701  memory: 46.16GiB(33.01%)  tps: 7,001  tflops: 326.53  mfu: 33.02%
[rank2]:2025-11-02 16:33:48,960 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1633_stage2_step1900.svg
[rank1]:2025-11-02 16:33:48,961 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1633_stage1_step1900.svg
[rank0]:2025-11-02 16:33:48,961 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1633_stage0_step1900.svg
[rank3]:2025-11-02 16:33:49,055 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1633_real_step1900_rank3.svg
[rank3]:> Batch Time: 419.91 ms, GPU Bubble Ratio: 40.14%, 29.57%, 30.56%, 30.32%
[rank3]:2025-11-02 16:33:49,123 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1633_stage3_step1900.svg
[rank0]:2025-11-02 16:35:38,800 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:35:40,584 - INFO - Avg. fwd time: 14.4589 / Avg. bwd time: 25.7076 / Avg. batch time: 497.8170 (ms) / GPU bubble ratio: 35.45%
[rank3]:2025-11-02 16:35:40,548 - INFO - Avg. fwd time: 16.5531 / Avg. bwd time: 25.9927 / Avg. batch time: 369.2715 (ms) / GPU bubble ratio: 7.83%
[rank2]:2025-11-02 16:35:40,686 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0675  memory: 39.25GiB(28.07%)  tps: 7,012  tflops: 327.05  mfu: 33.07%
[rank1]:2025-11-02 16:35:40,616 - INFO - Avg. fwd time: 16.5581 / Avg. bwd time: 27.5824 / Avg. batch time: 545.0502 (ms) / GPU bubble ratio: 35.21%
[rank1]:2025-11-02 16:35:40,675 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0675  memory: 48.76GiB(34.88%)  tps: 7,012  tflops: 327.05  mfu: 33.07%
[rank0]:2025-11-02 16:35:40,660 - INFO - Avg. fwd time: 14.2525 / Avg. bwd time: 23.9971 / Avg. batch time: 593.6462 (ms) / GPU bubble ratio: 48.45%
[rank0]:2025-11-02 16:35:40,696 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0675  memory: 57.32GiB(41.00%)  tps: 7,012  tflops: 327.05  mfu: 33.07%
[rank3]:2025-11-02 16:35:45,750 - INFO -  step: 1950  loss:  0.1644  grad_norm:  0.0675  memory: 46.16GiB(33.01%)  tps: 7,010  tflops: 326.95  mfu: 33.06%
[rank0]:2025-11-02 16:37:35,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:37:36,878 - INFO - Avg. fwd time: 14.4644 / Avg. bwd time: 25.6256 / Avg. batch time: 497.6205 (ms) / GPU bubble ratio: 35.55%
[rank1]:2025-11-02 16:37:36,881 - INFO - Avg. fwd time: 16.5712 / Avg. bwd time: 27.3999 / Avg. batch time: 544.6517 (ms) / GPU bubble ratio: 35.41%
[rank3]:2025-11-02 16:37:36,855 - INFO - Avg. fwd time: 16.5604 / Avg. bwd time: 25.8504 / Avg. batch time: 367.9102 (ms) / GPU bubble ratio: 7.78%
[rank0]:2025-11-02 16:37:36,941 - INFO - Avg. fwd time: 14.2548 / Avg. bwd time: 23.8448 / Avg. batch time: 593.2565 (ms) / GPU bubble ratio: 48.62%
[rank2]:2025-11-02 16:37:37,027 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0516  memory: 39.25GiB(28.07%)  tps: 7,041  tflops: 328.41  mfu: 33.21%
[rank2]:2025-11-02 16:37:37,027 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 16:37:37,016 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0516  memory: 48.76GiB(34.88%)  tps: 7,041  tflops: 328.41  mfu: 33.21%
[rank1]:2025-11-02 16:37:37,016 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 16:37:37,037 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0516  memory: 57.32GiB(41.00%)  tps: 7,041  tflops: 328.41  mfu: 33.21%
[rank0]:2025-11-02 16:37:37,037 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 16:37:42,110 - INFO -  step: 2000  loss:  0.2001  grad_norm:  0.0516  memory: 46.16GiB(33.01%)  tps: 7,040  tflops: 328.36  mfu: 33.20%
[rank3]:2025-11-02 16:37:42,110 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 16:37:58,622 - INFO - validate step: 2000  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,976
[rank2]:2025-11-02 16:37:58,673 - INFO - validate step: 2000  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,923
[rank1]:2025-11-02 16:37:58,656 - INFO - validate step: 2000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,928
[rank3]:2025-11-02 16:37:58,685 - INFO - validate step: 2000  loss:  0.2412  memory: 46.16GiB(33.01%)  tps: 24,713
[rank2]:2025-11-02 16:37:58,766 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1637_stage2_step2000.svg
[rank1]:2025-11-02 16:37:58,764 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1637_stage1_step2000.svg
[rank0]:2025-11-02 16:37:58,763 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1637_stage0_step2000.svg
[rank3]:2025-11-02 16:37:58,856 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1637_real_step2000_rank3.svg
[rank3]:> Batch Time: 420.71 ms, GPU Bubble Ratio: 39.69%, 30.58%, 30.43%, 30.89%
[rank3]:2025-11-02 16:37:58,926 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1637_stage3_step2000.svg
[rank0]:2025-11-02 16:39:49,037 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:39:50,714 - INFO - Avg. fwd time: 16.5683 / Avg. bwd time: 25.7032 / Avg. batch time: 366.4662 (ms) / GPU bubble ratio: 7.72%
[rank2]:2025-11-02 16:39:50,737 - INFO - Avg. fwd time: 14.4704 / Avg. bwd time: 25.5389 / Avg. batch time: 496.3840 (ms) / GPU bubble ratio: 35.52%
[rank1]:2025-11-02 16:39:50,740 - INFO - Avg. fwd time: 16.5856 / Avg. bwd time: 27.1994 / Avg. batch time: 543.1964 (ms) / GPU bubble ratio: 35.52%
[rank0]:2025-11-02 16:39:50,801 - INFO - Avg. fwd time: 14.2578 / Avg. bwd time: 23.6759 / Avg. batch time: 591.8009 (ms) / GPU bubble ratio: 48.72%
[rank2]:2025-11-02 16:39:50,885 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0770  memory: 39.25GiB(28.07%)  tps: 7,300  tflops: 340.49  mfu: 34.43%
[rank1]:2025-11-02 16:39:50,875 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0770  memory: 48.76GiB(34.88%)  tps: 7,300  tflops: 340.47  mfu: 34.43%
[rank0]:2025-11-02 16:39:50,896 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0770  memory: 57.32GiB(41.00%)  tps: 7,296  tflops: 340.31  mfu: 34.41%
[rank3]:2025-11-02 16:39:55,935 - INFO -  step: 2050  loss:  0.2205  grad_norm:  0.0770  memory: 46.16GiB(33.01%)  tps: 6,987  tflops: 325.87  mfu: 32.95%
[rank0]:2025-11-02 16:41:45,467 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:41:47,209 - INFO - Avg. fwd time: 16.5759 / Avg. bwd time: 25.5607 / Avg. batch time: 365.0753 (ms) / GPU bubble ratio: 7.66%
[rank2]:2025-11-02 16:41:47,246 - INFO - Avg. fwd time: 14.4755 / Avg. bwd time: 25.4551 / Avg. batch time: 495.7384 (ms) / GPU bubble ratio: 35.56%
[rank1]:2025-11-02 16:41:47,279 - INFO - Avg. fwd time: 16.5998 / Avg. bwd time: 27.0060 / Avg. batch time: 542.3434 (ms) / GPU bubble ratio: 35.68%
[rank0]:2025-11-02 16:41:47,323 - INFO - Avg. fwd time: 14.2605 / Avg. bwd time: 23.5125 / Avg. batch time: 590.9425 (ms) / GPU bubble ratio: 48.86%
[rank2]:2025-11-02 16:41:47,349 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0660  memory: 39.25GiB(28.07%)  tps: 7,034  tflops: 328.07  mfu: 33.17%
[rank1]:2025-11-02 16:41:47,338 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0660  memory: 48.76GiB(34.88%)  tps: 7,034  tflops: 328.07  mfu: 33.17%
[rank0]:2025-11-02 16:41:47,360 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0660  memory: 57.32GiB(41.00%)  tps: 7,034  tflops: 328.07  mfu: 33.17%
[rank3]:2025-11-02 16:41:52,354 - INFO -  step: 2100  loss:  0.2265  grad_norm:  0.0660  memory: 46.16GiB(33.01%)  tps: 7,037  tflops: 328.20  mfu: 33.18%
[rank0]:2025-11-02 16:41:52,424 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1641_stage0_step2100.svg
[rank2]:2025-11-02 16:41:52,428 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1641_stage2_step2100.svg
[rank1]:2025-11-02 16:41:52,427 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1641_stage1_step2100.svg
[rank3]:2025-11-02 16:41:52,526 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1641_real_step2100_rank3.svg
[rank3]:> Batch Time: 421.70 ms, GPU Bubble Ratio: 39.70%, 30.20%, 30.16%, 29.83%
[rank3]:2025-11-02 16:41:52,589 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1641_stage3_step2100.svg
[rank0]:2025-11-02 16:43:41,674 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:43:43,349 - INFO - Avg. fwd time: 14.4800 / Avg. bwd time: 25.3791 / Avg. batch time: 495.0189 (ms) / GPU bubble ratio: 35.58%
[rank1]:2025-11-02 16:43:43,351 - INFO - Avg. fwd time: 16.6109 / Avg. bwd time: 26.8477 / Avg. batch time: 541.4468 (ms) / GPU bubble ratio: 35.79%
[rank3]:2025-11-02 16:43:43,326 - INFO - Avg. fwd time: 16.5820 / Avg. bwd time: 25.4436 / Avg. batch time: 363.9333 (ms) / GPU bubble ratio: 7.62%
[rank0]:2025-11-02 16:43:43,407 - INFO - Avg. fwd time: 14.2625 / Avg. bwd time: 23.3809 / Avg. batch time: 590.0391 (ms) / GPU bubble ratio: 48.96%
[rank1]:2025-11-02 16:43:43,481 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0784  memory: 48.76GiB(34.88%)  tps: 7,053  tflops: 328.97  mfu: 33.26%
[rank0]:2025-11-02 16:43:43,503 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0784  memory: 57.32GiB(41.00%)  tps: 7,053  tflops: 328.97  mfu: 33.26%
[rank2]:2025-11-02 16:43:43,492 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0784  memory: 39.25GiB(28.07%)  tps: 7,053  tflops: 328.97  mfu: 33.26%
[rank3]:2025-11-02 16:43:48,443 - INFO -  step: 2150  loss:  0.1842  grad_norm:  0.0784  memory: 46.16GiB(33.01%)  tps: 7,057  tflops: 329.13  mfu: 33.28%
[rank0]:2025-11-02 16:45:37,781 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:45:39,463 - INFO - Avg. fwd time: 14.4846 / Avg. bwd time: 25.2999 / Avg. batch time: 494.3893 (ms) / GPU bubble ratio: 35.62%
[rank1]:2025-11-02 16:45:39,465 - INFO - Avg. fwd time: 16.6232 / Avg. bwd time: 26.6706 / Avg. batch time: 540.6219 (ms) / GPU bubble ratio: 35.93%
[rank3]:2025-11-02 16:45:39,439 - INFO - Avg. fwd time: 16.5888 / Avg. bwd time: 25.3124 / Avg. batch time: 362.6503 (ms) / GPU bubble ratio: 7.57%
[rank0]:2025-11-02 16:45:39,521 - INFO - Avg. fwd time: 14.2646 / Avg. bwd time: 23.2331 / Avg. batch time: 589.2096 (ms) / GPU bubble ratio: 49.09%
[rank0]:2025-11-02 16:45:39,617 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0538  memory: 57.32GiB(41.00%)  tps: 7,055  tflops: 329.05  mfu: 33.27%
[rank0]:2025-11-02 16:45:39,618 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 16:45:39,607 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0538  memory: 39.25GiB(28.07%)  tps: 7,055  tflops: 329.05  mfu: 33.27%
[rank2]:2025-11-02 16:45:39,607 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 16:45:39,595 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0538  memory: 48.76GiB(34.88%)  tps: 7,055  tflops: 329.05  mfu: 33.27%
[rank1]:2025-11-02 16:45:39,595 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 16:45:44,631 - INFO -  step: 2200  loss:  0.1794  grad_norm:  0.0538  memory: 46.16GiB(33.01%)  tps: 7,051  tflops: 328.85  mfu: 33.25%
[rank3]:2025-11-02 16:45:44,631 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 16:46:01,206 - INFO - validate step: 2200  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,954
[rank0]:2025-11-02 16:46:01,173 - INFO - validate step: 2200  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,003
[rank2]:2025-11-02 16:46:01,224 - INFO - validate step: 2200  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,948
[rank1]:2025-11-02 16:46:01,305 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1646_stage1_step2200.svg
[rank3]:2025-11-02 16:46:01,235 - INFO - validate step: 2200  loss:  0.2408  memory: 46.16GiB(33.01%)  tps: 24,670
[rank0]:2025-11-02 16:46:01,304 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1646_stage0_step2200.svg
[rank2]:2025-11-02 16:46:01,304 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1646_stage2_step2200.svg
[rank3]:2025-11-02 16:46:01,404 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1646_real_step2200_rank3.svg
[rank3]:> Batch Time: 421.45 ms, GPU Bubble Ratio: 40.29%, 30.79%, 30.09%, 30.07%
[rank3]:2025-11-02 16:46:01,466 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1646_stage3_step2200.svg
[rank0]:2025-11-02 16:47:50,489 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 16:47:52,277 - INFO - Avg. fwd time: 14.4902 / Avg. bwd time: 25.2190 / Avg. batch time: 493.2308 (ms) / GPU bubble ratio: 35.59%
[rank3]:2025-11-02 16:47:52,239 - INFO - Avg. fwd time: 16.5952 / Avg. bwd time: 25.1857 / Avg. batch time: 361.4150 (ms) / GPU bubble ratio: 7.52%
[rank2]:2025-11-02 16:47:52,384 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1137  memory: 39.25GiB(28.07%)  tps: 7,370  tflops: 343.72  mfu: 34.75%
[rank1]:2025-11-02 16:47:52,315 - INFO - Avg. fwd time: 16.6355 / Avg. bwd time: 26.5020 / Avg. batch time: 539.2797 (ms) / GPU bubble ratio: 36.01%
[rank1]:2025-11-02 16:47:52,376 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1137  memory: 48.76GiB(34.88%)  tps: 7,369  tflops: 343.69  mfu: 34.75%
[rank0]:2025-11-02 16:47:52,361 - INFO - Avg. fwd time: 14.2669 / Avg. bwd time: 23.0902 / Avg. batch time: 587.8629 (ms) / GPU bubble ratio: 49.16%
[rank0]:2025-11-02 16:47:52,397 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1137  memory: 57.32GiB(41.00%)  tps: 7,365  tflops: 343.52  mfu: 34.73%
[rank3]:2025-11-02 16:47:57,362 - INFO -  step: 2250  loss:  0.2242  grad_norm:  0.1137  memory: 46.16GiB(33.01%)  tps: 7,054  tflops: 329.02  mfu: 33.27%
[rank0]:2025-11-02 16:49:46,549 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:49:48,212 - INFO - Avg. fwd time: 16.6005 / Avg. bwd time: 25.0835 / Avg. batch time: 360.4135 (ms) / GPU bubble ratio: 7.48%
[rank2]:2025-11-02 16:49:48,234 - INFO - Avg. fwd time: 14.4943 / Avg. bwd time: 25.1532 / Avg. batch time: 493.1411 (ms) / GPU bubble ratio: 35.68%
[rank1]:2025-11-02 16:49:48,236 - INFO - Avg. fwd time: 16.6459 / Avg. bwd time: 26.3624 / Avg. batch time: 539.0288 (ms) / GPU bubble ratio: 36.17%
[rank0]:2025-11-02 16:49:48,294 - INFO - Avg. fwd time: 14.2686 / Avg. bwd time: 22.9738 / Avg. batch time: 587.6153 (ms) / GPU bubble ratio: 49.30%
[rank2]:2025-11-02 16:49:48,377 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0932  memory: 39.25GiB(28.07%)  tps: 7,062  tflops: 329.40  mfu: 33.31%
[rank1]:2025-11-02 16:49:48,368 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0932  memory: 48.76GiB(34.88%)  tps: 7,063  tflops: 329.40  mfu: 33.31%
[rank0]:2025-11-02 16:49:48,390 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0932  memory: 57.32GiB(41.00%)  tps: 7,063  tflops: 329.40  mfu: 33.31%
[rank1]:2025-11-02 16:49:53,702 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1649_stage1_step2300.svg
[rank0]:2025-11-02 16:49:53,699 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1649_stage0_step2300.svg
[rank3]:2025-11-02 16:49:53,630 - INFO -  step: 2300  loss:  0.1961  grad_norm:  0.0932  memory: 46.16GiB(33.01%)  tps: 7,046  tflops: 328.62  mfu: 33.23%
[rank2]:2025-11-02 16:49:53,700 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1649_stage2_step2300.svg
[rank3]:2025-11-02 16:49:53,798 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1649_real_step2300_rank3.svg
[rank3]:> Batch Time: 421.77 ms, GPU Bubble Ratio: 39.72%, 31.03%, 30.99%, 30.03%
[rank3]:2025-11-02 16:49:53,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1649_stage3_step2300.svg
[rank0]:2025-11-02 16:51:42,953 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:51:44,655 - INFO - Avg. fwd time: 14.4992 / Avg. bwd time: 25.0809 / Avg. batch time: 492.0486 (ms) / GPU bubble ratio: 35.65%
[rank1]:2025-11-02 16:51:44,657 - INFO - Avg. fwd time: 16.6568 / Avg. bwd time: 26.2098 / Avg. batch time: 537.7710 (ms) / GPU bubble ratio: 36.23%
[rank3]:2025-11-02 16:51:44,631 - INFO - Avg. fwd time: 16.6064 / Avg. bwd time: 24.9644 / Avg. batch time: 359.2590 (ms) / GPU bubble ratio: 7.43%
[rank1]:2025-11-02 16:51:44,790 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0528  memory: 48.76GiB(34.88%)  tps: 7,036  tflops: 328.18  mfu: 33.18%
[rank0]:2025-11-02 16:51:44,714 - INFO - Avg. fwd time: 14.2709 / Avg. bwd time: 22.8445 / Avg. batch time: 586.3573 (ms) / GPU bubble ratio: 49.36%
[rank2]:2025-11-02 16:51:44,798 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0528  memory: 39.25GiB(28.07%)  tps: 7,037  tflops: 328.19  mfu: 33.18%
[rank0]:2025-11-02 16:51:44,811 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0528  memory: 57.32GiB(41.00%)  tps: 7,037  tflops: 328.18  mfu: 33.18%
[rank3]:2025-11-02 16:51:49,800 - INFO -  step: 2350  loss:  0.1828  grad_norm:  0.0528  memory: 46.16GiB(33.01%)  tps: 7,052  tflops: 328.90  mfu: 33.26%
[rank0]:2025-11-02 16:53:38,958 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:53:40,768 - INFO - Avg. fwd time: 14.5038 / Avg. bwd time: 25.0131 / Avg. batch time: 491.5366 (ms) / GPU bubble ratio: 35.68%
[rank3]:2025-11-02 16:53:40,726 - INFO - Avg. fwd time: 16.6122 / Avg. bwd time: 24.8534 / Avg. batch time: 358.1788 (ms) / GPU bubble ratio: 7.39%
[rank1]:2025-11-02 16:53:40,802 - INFO - Avg. fwd time: 16.6679 / Avg. bwd time: 26.0628 / Avg. batch time: 537.1015 (ms) / GPU bubble ratio: 36.35%
[rank1]:2025-11-02 16:53:40,862 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0531  memory: 48.76GiB(34.88%)  tps: 7,058  tflops: 329.17  mfu: 33.28%
[rank1]:2025-11-02 16:53:40,863 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 16:53:40,847 - INFO - Avg. fwd time: 14.2732 / Avg. bwd time: 22.7204 / Avg. batch time: 585.6833 (ms) / GPU bubble ratio: 49.47%
[rank0]:2025-11-02 16:53:40,884 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0531  memory: 57.32GiB(41.00%)  tps: 7,058  tflops: 329.17  mfu: 33.28%
[rank0]:2025-11-02 16:53:40,884 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 16:53:40,874 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0531  memory: 39.25GiB(28.07%)  tps: 7,057  tflops: 329.16  mfu: 33.28%
[rank2]:2025-11-02 16:53:40,874 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 16:53:45,858 - INFO -  step: 2400  loss:  0.1888  grad_norm:  0.0531  memory: 46.16GiB(33.01%)  tps: 7,059  tflops: 329.22  mfu: 33.29%
[rank3]:2025-11-02 16:53:45,858 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 16:54:02,483 - INFO - validate step: 2400  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,956
[rank2]:2025-11-02 16:54:02,484 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 16:54:02,465 - INFO - validate step: 2400  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,961
[rank1]:2025-11-02 16:54:02,466 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:54:02,431 - INFO - validate step: 2400  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,009
[rank0]:2025-11-02 16:54:02,432 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:54:02,440 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-02 16:54:02,493 - INFO - validate step: 2400  loss:  0.2394  memory: 46.16GiB(33.01%)  tps: 24,624
[rank3]:2025-11-02 16:54:02,494 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 16:54:15,470 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.98 seconds.
[rank2]:2025-11-02 16:54:17,276 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.79 seconds.
[rank1]:2025-11-02 16:54:18,484 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.02 seconds.
[rank0]:2025-11-02 16:54:21,761 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 16:54:21,765 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.33 seconds.
[rank2]:2025-11-02 16:54:21,847 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1654_stage2_step2400.svg
[rank1]:2025-11-02 16:54:21,849 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1654_stage1_step2400.svg
[rank0]:2025-11-02 16:54:21,883 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1654_stage0_step2400.svg
[rank3]:2025-11-02 16:54:22,048 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1654_real_step2400_rank3.svg
[rank3]:> Batch Time: 423.41 ms, GPU Bubble Ratio: 40.44%, 31.24%, 29.53%, 30.34%
[rank3]:2025-11-02 16:54:22,137 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1654_stage3_step2400.svg
[rank0]:2025-11-02 16:56:14,952 - INFO - [GC] Peforming periodical GC collection 2.66 seconds
[rank3]:2025-11-02 16:56:16,623 - INFO - Avg. fwd time: 16.6170 / Avg. bwd time: 24.7614 / Avg. batch time: 357.2848 (ms) / GPU bubble ratio: 7.35%
[rank2]:2025-11-02 16:56:16,643 - INFO - Avg. fwd time: 14.5074 / Avg. bwd time: 24.9544 / Avg. batch time: 491.0664 (ms) / GPU bubble ratio: 35.71%
[rank1]:2025-11-02 16:56:16,646 - INFO - Avg. fwd time: 16.6767 / Avg. bwd time: 25.9411 / Avg. batch time: 536.4974 (ms) / GPU bubble ratio: 36.45%
[rank0]:2025-11-02 16:56:16,707 - INFO - Avg. fwd time: 14.2762 / Avg. bwd time: 22.6180 / Avg. batch time: 585.0828 (ms) / GPU bubble ratio: 49.55%
[rank1]:2025-11-02 16:56:16,780 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0936  memory: 48.76GiB(34.88%)  tps: 6,099  tflops: 284.46  mfu: 28.76%
[rank0]:2025-11-02 16:56:16,801 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0936  memory: 57.32GiB(41.00%)  tps: 6,097  tflops: 284.35  mfu: 28.75%
[rank2]:2025-11-02 16:56:16,791 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0936  memory: 39.25GiB(28.07%)  tps: 6,099  tflops: 284.48  mfu: 28.76%
[rank3]:2025-11-02 16:56:21,833 - INFO -  step: 2450  loss:  0.2328  grad_norm:  0.0936  memory: 46.16GiB(33.01%)  tps: 5,879  tflops: 274.21  mfu: 27.73%
[rank0]:2025-11-02 16:58:10,936 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:58:12,602 - INFO - Avg. fwd time: 16.6227 / Avg. bwd time: 24.6613 / Avg. batch time: 356.3244 (ms) / GPU bubble ratio: 7.31%
[rank2]:2025-11-02 16:58:12,624 - INFO - Avg. fwd time: 14.5114 / Avg. bwd time: 24.8984 / Avg. batch time: 490.6095 (ms) / GPU bubble ratio: 35.74%
[rank1]:2025-11-02 16:58:12,626 - INFO - Avg. fwd time: 16.6871 / Avg. bwd time: 25.8035 / Avg. batch time: 535.8850 (ms) / GPU bubble ratio: 36.57%
[rank0]:2025-11-02 16:58:12,683 - INFO - Avg. fwd time: 14.2789 / Avg. bwd time: 22.5013 / Avg. batch time: 584.4664 (ms) / GPU bubble ratio: 49.66%
[rank2]:2025-11-02 16:58:12,766 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0870  memory: 39.25GiB(28.07%)  tps: 7,064  tflops: 329.45  mfu: 33.31%
[rank1]:2025-11-02 16:58:12,755 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0870  memory: 48.76GiB(34.88%)  tps: 7,064  tflops: 329.45  mfu: 33.31%
[rank0]:2025-11-02 16:58:12,779 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0870  memory: 57.32GiB(41.00%)  tps: 7,063  tflops: 329.44  mfu: 33.31%
[rank3]:2025-11-02 16:58:17,712 - INFO -  step: 2500  loss:  0.2135  grad_norm:  0.0870  memory: 46.16GiB(33.01%)  tps: 7,070  tflops: 329.73  mfu: 33.34%
[rank1]:2025-11-02 16:58:17,787 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1658_stage1_step2500.svg
[rank0]:2025-11-02 16:58:17,783 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1658_stage0_step2500.svg
[rank2]:2025-11-02 16:58:17,786 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1658_stage2_step2500.svg
[rank3]:2025-11-02 16:58:17,882 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1658_real_step2500_rank3.svg
[rank3]:> Batch Time: 421.73 ms, GPU Bubble Ratio: 40.04%, 30.98%, 30.42%, 30.04%
[rank3]:2025-11-02 16:58:17,948 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1658_stage3_step2500.svg
[rank0]:2025-11-02 17:00:08,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:00:10,389 - INFO - Avg. fwd time: 16.6323 / Avg. bwd time: 24.5703 / Avg. batch time: 355.4574 (ms) / GPU bubble ratio: 7.27%
[rank2]:2025-11-02 17:00:10,430 - INFO - Avg. fwd time: 14.5187 / Avg. bwd time: 24.8406 / Avg. batch time: 489.7443 (ms) / GPU bubble ratio: 35.71%
[rank1]:2025-11-02 17:00:10,467 - INFO - Avg. fwd time: 16.7008 / Avg. bwd time: 25.6744 / Avg. batch time: 534.8822 (ms) / GPU bubble ratio: 36.62%
[rank0]:2025-11-02 17:00:10,513 - INFO - Avg. fwd time: 14.2841 / Avg. bwd time: 22.3911 / Avg. batch time: 583.4641 (ms) / GPU bubble ratio: 49.71%
[rank2]:2025-11-02 17:00:10,540 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1634  memory: 39.25GiB(28.07%)  tps: 6,956  tflops: 324.42  mfu: 32.80%
[rank1]:2025-11-02 17:00:10,531 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1634  memory: 48.76GiB(34.88%)  tps: 6,956  tflops: 324.41  mfu: 32.80%
[rank0]:2025-11-02 17:00:10,550 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1634  memory: 57.32GiB(41.00%)  tps: 6,956  tflops: 324.42  mfu: 32.80%
[rank3]:2025-11-02 17:00:15,506 - INFO -  step: 2550  loss:  0.4647  grad_norm:  0.1634  memory: 46.16GiB(33.01%)  tps: 6,955  tflops: 324.37  mfu: 32.80%
[rank0]:2025-11-02 17:02:06,355 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:02:08,092 - INFO - Avg. fwd time: 16.7133 / Avg. bwd time: 25.5679 / Avg. batch time: 534.7973 (ms) / GPU bubble ratio: 36.75%
[rank3]:2025-11-02 17:02:08,067 - INFO - Avg. fwd time: 16.6420 / Avg. bwd time: 24.4950 / Avg. batch time: 354.7585 (ms) / GPU bubble ratio: 7.23%
[rank2]:2025-11-02 17:02:08,089 - INFO - Avg. fwd time: 14.5257 / Avg. bwd time: 24.7934 / Avg. batch time: 489.7708 (ms) / GPU bubble ratio: 35.78%
[rank0]:2025-11-02 17:02:08,154 - INFO - Avg. fwd time: 14.2890 / Avg. bwd time: 22.3021 / Avg. batch time: 583.3774 (ms) / GPU bubble ratio: 49.82%
[rank2]:2025-11-02 17:02:08,237 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1232  memory: 39.25GiB(28.07%)  tps: 6,960  tflops: 324.63  mfu: 32.82%
[rank2]:2025-11-02 17:02:08,237 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 17:02:08,248 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1232  memory: 57.32GiB(41.00%)  tps: 6,960  tflops: 324.63  mfu: 32.82%
[rank0]:2025-11-02 17:02:08,248 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 17:02:08,227 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1232  memory: 48.76GiB(34.88%)  tps: 6,960  tflops: 324.63  mfu: 32.82%
[rank1]:2025-11-02 17:02:08,227 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-02 17:02:13,071 - INFO -  step: 2600  loss:  0.3957  grad_norm:  0.1232  memory: 46.16GiB(33.01%)  tps: 6,968  tflops: 325.00  mfu: 32.86%
[rank3]:2025-11-02 17:02:13,072 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 17:02:29,618 - INFO - validate step: 2600  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,167
[rank2]:2025-11-02 17:02:29,668 - INFO - validate step: 2600  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 19,112
[rank1]:2025-11-02 17:02:29,651 - INFO - validate step: 2600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 19,119
[rank3]:2025-11-02 17:02:29,679 - INFO - validate step: 2600  loss:  0.2423  memory: 46.16GiB(33.01%)  tps: 24,665
[rank2]:2025-11-02 17:02:29,752 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1702_stage2_step2600.svg
[rank0]:2025-11-02 17:02:29,755 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1702_stage0_step2600.svg
[rank1]:2025-11-02 17:02:29,755 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1702_stage1_step2600.svg
[rank3]:2025-11-02 17:02:29,855 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1702_real_step2600_rank3.svg
[rank3]:> Batch Time: 429.09 ms, GPU Bubble Ratio: 40.40%, 31.17%, 31.11%, 30.00%
[rank3]:2025-11-02 17:02:29,922 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1702_stage3_step2600.svg
[rank0]:2025-11-02 17:04:20,674 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 17:04:22,393 - INFO - Avg. fwd time: 14.5333 / Avg. bwd time: 24.7417 / Avg. batch time: 488.9513 (ms) / GPU bubble ratio: 35.74%
[rank1]:2025-11-02 17:04:22,397 - INFO - Avg. fwd time: 16.7271 / Avg. bwd time: 25.4511 / Avg. batch time: 533.8572 (ms) / GPU bubble ratio: 36.79%
[rank3]:2025-11-02 17:04:22,370 - INFO - Avg. fwd time: 16.6525 / Avg. bwd time: 24.4117 / Avg. batch time: 353.9797 (ms) / GPU bubble ratio: 7.19%
[rank0]:2025-11-02 17:04:22,453 - INFO - Avg. fwd time: 14.2942 / Avg. bwd time: 22.2014 / Avg. batch time: 582.4362 (ms) / GPU bubble ratio: 49.87%
[rank1]:2025-11-02 17:04:22,528 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0896  memory: 48.76GiB(34.88%)  tps: 7,257  tflops: 338.49  mfu: 34.23%
[rank2]:2025-11-02 17:04:22,537 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0896  memory: 39.25GiB(28.07%)  tps: 7,258  tflops: 338.51  mfu: 34.23%
[rank0]:2025-11-02 17:04:22,548 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0896  memory: 57.32GiB(41.00%)  tps: 7,254  tflops: 338.33  mfu: 34.21%
[rank3]:2025-11-02 17:04:27,437 - INFO -  step: 2650  loss:  0.3167  grad_norm:  0.0896  memory: 46.16GiB(33.01%)  tps: 6,957  tflops: 324.47  mfu: 32.81%
[rank0]:2025-11-02 17:06:18,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:06:19,808 - INFO - Avg. fwd time: 16.6628 / Avg. bwd time: 24.3275 / Avg. batch time: 353.1981 (ms) / GPU bubble ratio: 7.16%
[rank2]:2025-11-02 17:06:19,848 - INFO - Avg. fwd time: 14.5406 / Avg. bwd time: 24.6880 / Avg. batch time: 488.5761 (ms) / GPU bubble ratio: 35.77%
[rank1]:2025-11-02 17:06:19,887 - INFO - Avg. fwd time: 16.7401 / Avg. bwd time: 25.3386 / Avg. batch time: 533.3728 (ms) / GPU bubble ratio: 36.89%
[rank2]:2025-11-02 17:06:19,957 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1084  memory: 39.25GiB(28.07%)  tps: 6,977  tflops: 325.39  mfu: 32.90%
[rank0]:2025-11-02 17:06:19,933 - INFO - Avg. fwd time: 14.2996 / Avg. bwd time: 22.1033 / Avg. batch time: 581.9524 (ms) / GPU bubble ratio: 49.96%
[rank0]:2025-11-02 17:06:19,970 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1084  memory: 57.32GiB(41.00%)  tps: 6,977  tflops: 325.39  mfu: 32.90%
[rank1]:2025-11-02 17:06:19,950 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1084  memory: 48.76GiB(34.88%)  tps: 6,977  tflops: 325.39  mfu: 32.90%
[rank3]:2025-11-02 17:06:24,794 - INFO -  step: 2700  loss:  0.3479  grad_norm:  0.1084  memory: 46.16GiB(33.01%)  tps: 6,981  tflops: 325.58  mfu: 32.92%
[rank2]:2025-11-02 17:06:24,869 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1706_stage2_step2700.svg
[rank0]:2025-11-02 17:06:24,867 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1706_stage0_step2700.svg
[rank1]:2025-11-02 17:06:24,870 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1706_stage1_step2700.svg
[rank3]:2025-11-02 17:06:24,973 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1706_real_step2700_rank3.svg
[rank3]:> Batch Time: 426.61 ms, GPU Bubble Ratio: 39.69%, 30.54%, 31.06%, 29.95%
[rank3]:2025-11-02 17:06:25,040 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1706_stage3_step2700.svg
[rank0]:2025-11-02 17:08:15,512 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:08:17,229 - INFO - Avg. fwd time: 16.6713 / Avg. bwd time: 24.2599 / Avg. batch time: 352.5654 (ms) / GPU bubble ratio: 7.12%
[rank2]:2025-11-02 17:08:17,251 - INFO - Avg. fwd time: 14.5464 / Avg. bwd time: 24.6441 / Avg. batch time: 488.1520 (ms) / GPU bubble ratio: 35.77%
[rank0]:2025-11-02 17:08:17,311 - INFO - Avg. fwd time: 14.3039 / Avg. bwd time: 22.0256 / Avg. batch time: 581.4285 (ms) / GPU bubble ratio: 50.01%
[rank1]:2025-11-02 17:08:17,252 - INFO - Avg. fwd time: 16.7509 / Avg. bwd time: 25.2453 / Avg. batch time: 532.8463 (ms) / GPU bubble ratio: 36.95%
[rank2]:2025-11-02 17:08:17,394 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0652  memory: 39.25GiB(28.07%)  tps: 6,976  tflops: 325.35  mfu: 32.90%
[rank0]:2025-11-02 17:08:17,407 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0652  memory: 57.32GiB(41.00%)  tps: 6,976  tflops: 325.35  mfu: 32.90%
[rank1]:2025-11-02 17:08:17,387 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0652  memory: 48.76GiB(34.88%)  tps: 6,976  tflops: 325.35  mfu: 32.90%
[rank3]:2025-11-02 17:08:22,224 - INFO -  step: 2750  loss:  0.2897  grad_norm:  0.0652  memory: 46.16GiB(33.01%)  tps: 6,976  tflops: 325.37  mfu: 32.90%
[rank0]:2025-11-02 17:10:12,765 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:10:14,505 - INFO - Avg. fwd time: 16.7635 / Avg. bwd time: 25.1422 / Avg. batch time: 532.3884 (ms) / GPU bubble ratio: 37.03%
[rank3]:2025-11-02 17:10:14,477 - INFO - Avg. fwd time: 16.6810 / Avg. bwd time: 24.1838 / Avg. batch time: 351.8565 (ms) / GPU bubble ratio: 7.09%
[rank2]:2025-11-02 17:10:14,502 - INFO - Avg. fwd time: 14.5530 / Avg. bwd time: 24.5972 / Avg. batch time: 487.8050 (ms) / GPU bubble ratio: 35.79%
[rank0]:2025-11-02 17:10:14,563 - INFO - Avg. fwd time: 14.3087 / Avg. bwd time: 21.9375 / Avg. batch time: 580.9709 (ms) / GPU bubble ratio: 50.09%
[rank1]:2025-11-02 17:10:14,636 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1087  memory: 48.76GiB(34.88%)  tps: 6,987  tflops: 325.87  mfu: 32.95%
[rank1]:2025-11-02 17:10:14,636 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 17:10:14,644 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1087  memory: 39.25GiB(28.07%)  tps: 6,987  tflops: 325.86  mfu: 32.95%
[rank2]:2025-11-02 17:10:14,645 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 17:10:14,656 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1087  memory: 57.32GiB(41.00%)  tps: 6,987  tflops: 325.87  mfu: 32.95%
[rank0]:2025-11-02 17:10:14,656 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-02 17:10:19,461 - INFO -  step: 2800  loss:  0.2897  grad_norm:  0.1087  memory: 46.16GiB(33.01%)  tps: 6,988  tflops: 325.91  mfu: 32.95%
[rank3]:2025-11-02 17:10:19,461 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 17:10:36,276 - INFO - validate step: 2800  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 18,945
[rank1]:2025-11-02 17:10:36,310 - INFO - validate step: 2800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 18,899
[rank3]:2025-11-02 17:10:36,338 - INFO - validate step: 2800  loss:  0.2410  memory: 46.16GiB(33.01%)  tps: 24,271
[rank2]:2025-11-02 17:10:36,327 - INFO - validate step: 2800  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 18,891
[rank2]:2025-11-02 17:10:36,413 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1710_stage2_step2800.svg
[rank0]:2025-11-02 17:10:36,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1710_stage0_step2800.svg
[rank1]:2025-11-02 17:10:36,413 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1710_stage1_step2800.svg
[rank3]:2025-11-02 17:10:36,512 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1710_real_step2800_rank3.svg
[rank3]:> Batch Time: 426.46 ms, GPU Bubble Ratio: 40.15%, 30.32%, 30.26%, 29.99%
[rank3]:2025-11-02 17:10:36,578 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1710_stage3_step2800.svg
[rank0]:2025-11-02 17:12:27,958 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 17:12:29,749 - INFO - Avg. fwd time: 16.6910 / Avg. bwd time: 24.1084 / Avg. batch time: 351.1653 (ms) / GPU bubble ratio: 7.05%
[rank2]:2025-11-02 17:12:29,792 - INFO - Avg. fwd time: 14.5594 / Avg. bwd time: 24.5588 / Avg. batch time: 487.1401 (ms) / GPU bubble ratio: 35.76%
[rank1]:2025-11-02 17:12:29,831 - INFO - Avg. fwd time: 16.7756 / Avg. bwd time: 25.0425 / Avg. batch time: 531.6197 (ms) / GPU bubble ratio: 37.07%
[rank2]:2025-11-02 17:12:29,906 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1311  memory: 39.25GiB(28.07%)  tps: 7,213  tflops: 336.40  mfu: 34.01%
[rank0]:2025-11-02 17:12:29,879 - INFO - Avg. fwd time: 14.3136 / Avg. bwd time: 21.8505 / Avg. batch time: 580.2021 (ms) / GPU bubble ratio: 50.14%
[rank0]:2025-11-02 17:12:29,916 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1311  memory: 57.32GiB(41.00%)  tps: 7,209  tflops: 336.22  mfu: 34.00%
[rank1]:2025-11-02 17:12:29,897 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1311  memory: 48.76GiB(34.88%)  tps: 7,212  tflops: 336.38  mfu: 34.01%
[rank3]:2025-11-02 17:12:34,716 - INFO -  step: 2850  loss:  0.4002  grad_norm:  0.1311  memory: 46.16GiB(33.01%)  tps: 6,920  tflops: 322.77  mfu: 32.64%
[rank0]:2025-11-02 17:14:25,405 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:14:27,138 - INFO - Avg. fwd time: 16.7855 / Avg. bwd time: 24.9572 / Avg. batch time: 531.5728 (ms) / GPU bubble ratio: 37.18%
[rank3]:2025-11-02 17:14:27,115 - INFO - Avg. fwd time: 16.6988 / Avg. bwd time: 24.0469 / Avg. batch time: 350.5986 (ms) / GPU bubble ratio: 7.03%
[rank2]:2025-11-02 17:14:27,138 - INFO - Avg. fwd time: 14.5644 / Avg. bwd time: 24.5233 / Avg. batch time: 487.1762 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 17:14:27,198 - INFO - Avg. fwd time: 14.3173 / Avg. bwd time: 21.7799 / Avg. batch time: 580.1535 (ms) / GPU bubble ratio: 50.22%
[rank2]:2025-11-02 17:14:27,279 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0827  memory: 39.25GiB(28.07%)  tps: 6,979  tflops: 325.52  mfu: 32.91%
[rank0]:2025-11-02 17:14:27,290 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0827  memory: 57.32GiB(41.00%)  tps: 6,979  tflops: 325.52  mfu: 32.91%
[rank1]:2025-11-02 17:14:27,269 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0827  memory: 48.76GiB(34.88%)  tps: 6,980  tflops: 325.53  mfu: 32.91%
[rank3]:2025-11-02 17:14:32,075 - INFO -  step: 2900  loss:  0.3809  grad_norm:  0.0827  memory: 46.16GiB(33.01%)  tps: 6,980  tflops: 325.57  mfu: 32.92%
[rank1]:2025-11-02 17:14:32,152 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1714_stage1_step2900.svg
[rank2]:2025-11-02 17:14:32,153 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1714_stage2_step2900.svg
[rank0]:2025-11-02 17:14:32,150 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1714_stage0_step2900.svg
[rank3]:2025-11-02 17:14:32,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1714_real_step2900_rank3.svg
[rank3]:> Batch Time: 428.45 ms, GPU Bubble Ratio: 40.93%, 30.90%, 30.96%, 30.27%
[rank3]:2025-11-02 17:14:32,314 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1714_stage3_step2900.svg
[rank0]:2025-11-02 17:16:22,952 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:16:24,672 - INFO - Avg. fwd time: 16.7080 / Avg. bwd time: 23.9784 / Avg. batch time: 349.9628 (ms) / GPU bubble ratio: 6.99%
[rank1]:2025-11-02 17:16:24,695 - INFO - Avg. fwd time: 16.7971 / Avg. bwd time: 24.8635 / Avg. batch time: 530.7731 (ms) / GPU bubble ratio: 37.21%
[rank2]:2025-11-02 17:16:24,695 - INFO - Avg. fwd time: 14.5710 / Avg. bwd time: 24.4774 / Avg. batch time: 486.4810 (ms) / GPU bubble ratio: 35.79%
[rank0]:2025-11-02 17:16:24,757 - INFO - Avg. fwd time: 14.3220 / Avg. bwd time: 21.6980 / Avg. batch time: 579.3530 (ms) / GPU bubble ratio: 50.26%
[rank1]:2025-11-02 17:16:24,830 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2093  memory: 48.76GiB(34.88%)  tps: 6,968  tflops: 325.00  mfu: 32.86%
[rank2]:2025-11-02 17:16:24,838 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2093  memory: 39.25GiB(28.07%)  tps: 6,968  tflops: 325.01  mfu: 32.86%
[rank0]:2025-11-02 17:16:24,851 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2093  memory: 57.32GiB(41.00%)  tps: 6,968  tflops: 325.00  mfu: 32.86%
[rank3]:2025-11-02 17:16:29,650 - INFO -  step: 2950  loss:  0.4323  grad_norm:  0.2093  memory: 46.16GiB(33.01%)  tps: 6,968  tflops: 324.97  mfu: 32.86%
[rank0]:2025-11-02 17:18:19,963 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:18:21,741 - INFO - Avg. fwd time: 16.7163 / Avg. bwd time: 23.9116 / Avg. batch time: 349.3434 (ms) / GPU bubble ratio: 6.96%
[rank2]:2025-11-02 17:18:21,785 - INFO - Avg. fwd time: 14.5768 / Avg. bwd time: 24.4399 / Avg. batch time: 486.1714 (ms) / GPU bubble ratio: 35.80%
[rank1]:2025-11-02 17:18:21,822 - INFO - Avg. fwd time: 16.8078 / Avg. bwd time: 24.7724 / Avg. batch time: 530.3679 (ms) / GPU bubble ratio: 37.28%
[rank0]:2025-11-02 17:18:21,870 - INFO - Avg. fwd time: 14.3266 / Avg. bwd time: 21.6176 / Avg. batch time: 578.9486 (ms) / GPU bubble ratio: 50.33%
[rank1]:2025-11-02 17:18:21,886 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1192  memory: 48.76GiB(34.88%)  tps: 6,998  tflops: 326.40  mfu: 33.00%
[rank1]:2025-11-02 17:18:21,886 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1192  tps: 6,799  tflops: 317.10  mfu: 31.29%
[rank1]:2025-11-02 17:18:21,886 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-02 17:18:21,897 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1192  memory: 39.25GiB(28.07%)  tps: 6,998  tflops: 326.40  mfu: 33.00%
[rank2]:2025-11-02 17:18:21,897 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1192  tps: 6,799  tflops: 317.11  mfu: 31.30%
[rank2]:2025-11-02 17:18:21,897 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 17:18:21,907 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1192  memory: 57.32GiB(41.00%)  tps: 6,998  tflops: 326.40  mfu: 33.00%
[rank0]:2025-11-02 17:18:21,907 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1192  tps: 6,807  tflops: 317.46  mfu: 31.32%
[rank0]:2025-11-02 17:18:21,907 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 17:18:26,738 - INFO -  step: 3000  loss:  0.3502  grad_norm:  0.1192  memory: 46.16GiB(33.01%)  tps: 6,997  tflops: 326.32  mfu: 33.00%
[rank3]:2025-11-02 17:18:26,738 - INFO -  final step: 3000  loss:  0.3502  grad_norm:  0.1192  tps: 6,742  tflops: 314.46  mfu: 31.02%
[rank3]:2025-11-02 17:18:26,739 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-02 17:18:43,259 - INFO - validate step: 3000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 19,165
[rank1]:2025-11-02 17:18:43,260 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 17:18:43,263 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 17:18:43,276 - INFO - validate step: 3000  loss: -1.0000  memory: 39.25GiB(28.07%)  tps: 19,159
[rank2]:2025-11-02 17:18:43,276 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 17:18:43,281 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 17:18:43,287 - INFO - validate step: 3000  loss:  0.2427  memory: 46.16GiB(33.01%)  tps: 24,753
[rank3]:2025-11-02 17:18:43,288 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 17:18:43,291 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 17:18:43,226 - INFO - validate step: 3000  loss: -1.0000  memory: 57.32GiB(41.00%)  tps: 19,214
[rank0]:2025-11-02 17:18:43,226 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 17:18:43,230 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 17:18:53,510 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 17:18:53,602 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251102_1718_stage2_final3000.svg
[rank0]:2025-11-02 17:18:53,603 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251102_1718_stage0_final3000.svg
[rank1]:2025-11-02 17:18:53,607 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251102_1718_stage1_final3000.svg
[rank3]:2025-11-02 17:18:53,697 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1718_real_final3000_rank3.svg
[rank3]:> Batch Time: 427.13 ms, GPU Bubble Ratio: 40.41%, 30.80%, 30.22%, 30.12%
[rank1]:2025-11-02 17:18:53,854 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251102_1718_rank1_stage1.svg
[rank1]:	> Counts Sum: 2308000, Total Sum: 6557760 (35.19%), Ratio(%) per element: [34.63, 35.91, 36.11, 36.36, 34.68, 34.33, 35.27, 35.96, 35.67, 35.37, 35.17, 36.31, 35.02, 33.99, 35.82, 34.04, 35.62, 35.37, 35.57, 35.22, 35.67, 34.09, 35.02, 35.17, 34.63, 35.17, 35.37, 35.17, 35.07, 34.93, 35.32, 34.78, 35.77, 35.57, 35.42, 35.12, 35.22, 34.48, 35.47, 35.02, 35.42, 35.72, 34.98, 35.47, 34.88, 34.33, 34.48, 35.62, 35.37, 35.22, 35.86, 35.82, 35.02, 33.84, 36.16, 35.32, 34.28, 35.42, 34.78, 35.57, 35.22, 35.42, 34.14, 35.57, 34.78, 34.78, 34.98, 35.91, 35.86, 35.12, 34.78, 34.88, 35.22, 34.73, 35.47, 35.62, 35.57, 34.83, 35.02, 35.02, 35.02]
[rank1]:2025-11-02 17:18:53,854 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 17:18:53,837 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251102_1718_rank2_stage2.svg
[rank2]:	> Counts Sum: 2671640, Total Sum: 5829120 (45.83%), Ratio(%) per element: [46.68, 46.88, 45.2, 45.6, 46.93, 45.55, 47.77, 48.71, 44.91, 45.25, 46.04, 46.19, 44.96, 44.46, 46.29, 44.46, 46.09, 45.84, 45.75, 44.07, 46.83, 45.94, 47.08, 44.21, 46.14, 45.25, 45.7, 45.15, 46.09, 43.92, 45.35, 44.56, 45.84, 44.91, 46.39, 47.77, 47.18, 45.35, 45.7, 46.64, 46.09, 44.91, 44.71, 46.73, 46.09, 46.64, 44.02, 45.84, 46.64, 45.05, 46.44, 46.09, 45.94, 43.72, 44.61, 45.15, 46.59, 46.93, 45.0, 47.77, 46.73, 45.4, 45.84, 45.84, 46.59, 44.96, 48.02, 46.24, 45.3, 46.64, 44.76, 44.66]
[rank2]:2025-11-02 17:18:53,837 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 17:18:53,865 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251102_1718_thry_final3000_rank3.svg
[rank3]:> Batch Time: 524.50 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank0]:2025-11-02 17:18:53,841 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251102_1718_rank0_stage0.svg
[rank0]:	> Counts Sum: 4560680, Total Sum: 5910080 (77.17%), Ratio(%) per element: [76.97, 78.21, 75.93, 77.76, 76.38, 77.27, 76.63, 77.56, 76.43, 76.82, 77.86, 76.38, 77.32, 75.98, 77.42, 77.71, 77.81, 77.96, 77.51, 77.07, 77.66, 76.43, 77.66, 77.42, 77.91, 76.58, 77.12, 77.76, 76.08, 78.7, 77.12, 76.82, 77.56, 77.07, 78.11, 76.97, 77.81, 77.96, 77.37, 76.97, 76.23, 77.42, 77.51, 76.87, 77.51, 77.12, 76.43, 76.28, 77.66, 78.5, 78.26, 77.91, 76.58, 76.23, 76.43, 77.42, 76.72, 77.66, 76.48, 77.86, 76.77, 75.74, 76.67, 76.77, 76.77, 76.87, 76.58, 78.31, 77.32, 76.87, 76.43, 77.42, 77.22]
[rank0]:2025-11-02 17:18:53,841 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-02 17:18:53,932 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251102_1718_stage3_final3000.svg
[rank3]:2025-11-02 17:18:54,149 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251102_1718_rank3_stage3.svg
[rank3]:	> Counts Sum: 638880, Total Sum: 5262400 (12.14%), Ratio(%) per element: [12.64, 12.4, 12.0, 12.5, 12.59, 12.54, 11.66, 13.83, 11.8, 12.3, 12.54, 12.84, 11.36, 11.8, 11.56, 11.61, 11.31, 13.93, 13.43, 13.58, 12.5, 12.69, 11.75, 12.2, 12.74, 12.25, 12.64, 13.78, 12.25, 11.66, 12.3, 11.8, 11.8, 12.35, 11.9, 11.9, 11.7, 12.4, 13.09, 13.09, 12.45, 11.41, 13.14, 12.89, 12.0, 12.54, 12.84, 12.45, 11.36, 11.9, 12.25, 11.9, 11.7, 11.8, 11.56, 12.64, 12.1, 12.0, 13.48, 12.64, 11.01, 11.7, 12.84, 13.19, 0.0]
[rank3]:2025-11-02 17:18:54,150 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.43006
[rank3]:wandb:               final/avg_loss 0.35016
[rank3]:wandb:             final/avg_mfu(%) 31.0219
[rank3]:wandb:             final/avg_tflops 314.45768
[rank3]:wandb:    final/avg_throughput(tps) 6742.20827
[rank3]:wandb:              final/grad_norm 0.11922
[rank3]:wandb:               final/max_loss 0.35016
[rank3]:wandb:                    grad_norm 0.11922
[rank3]:wandb: loss_metrics/global_avg_loss 0.35016
[rank3]:wandb: loss_metrics/global_max_loss 0.35016
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/o1pqxtgx
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_timelyapf_h200/20251102-1511/wandb/run-20251102_151103-o1pqxtgx/logs
[rank0]:2025-11-02 17:18:55,842 - INFO - Training completed
[rank0]:2025-11-02 17:18:55,842 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 17:18:56,045 - INFO - Process group destroyed
[rank2]:2025-11-02 17:18:56,064 - INFO - Process group destroyed
[rank3]:2025-11-02 17:18:56,041 - INFO - Process group destroyed
[rank0]:2025-11-02 17:18:56,305 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.23', 'layers.24', 'layers.21', 'layers.18', 'layers.20', 'layers.17', 'layers.22'}
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.13', 'layers.15', 'layers.8', 'layers.12', 'layers.10', 'layers.9', 'layers.16', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.26', 'layers.27', 'norm', 'layers.30', 'layers.28', 'output', 'layers.29', 'layers.25', 'layers.31'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyapf_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.1', 'layers.7', 'layers.0', 'layers.4', 'tok_embeddings', 'layers.2', 'layers.3', 'layers.5'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Nov  4 08:36:56 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1104 08:36:57.917000 2496890 site-packages/torch/distributed/run.py:811] 
W1104 08:36:57.917000 2496890 site-packages/torch/distributed/run.py:811] *****************************************
W1104 08:36:57.917000 2496890 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1104 08:36:57.917000 2496890 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-11-04 08:37:05,341 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-04 08:37:05,341 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-04 08:37:05,320 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-04 08:37:05,333 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-04 08:37:06,309 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 08:37:06,311 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 08:37:06,317 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-04 08:37:06,309 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 08:37:06,313 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-04 08:37:06,309 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 08:37:06,311 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-04 08:37:06,309 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 08:37:06,312 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 08:37:08,110 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 08:37:08,414 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-04 08:37:10,505 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 08:37:10,775 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-04 08:37:10,765 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-04 08:37:10,771 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-04 08:37:10,863 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-11-04 08:37:10,876 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-04 08:37:10,876 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 08:37:10,884 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-04 08:37:10,884 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-04 08:37:10,887 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-04 08:37:10,887 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-11-04 08:37:11,178 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-04 08:37:11,178 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-04 08:37:11,212 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-04 08:37:11,212 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-11-04 08:37:11,205 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-04 08:37:11,206 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 9suer7ce
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyapf_h200/20251104-0837/wandb/run-20251104_083711-9suer7ce
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/9suer7ce
[rank3]:2025-11-04 08:37:12,663 - INFO - WandB logging enabled
[rank3]:2025-11-04 08:37:12,664 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-04 08:37:12,741 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-04 08:37:12,741 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-04 08:37:12,982 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyapf_h200
[rank0]:2025-11-04 08:37:12,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 08:37:12,982 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-04 08:37:12,980 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-04 08:37:12,976 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-04 08:37:12,962 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-04 08:37:12,963 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-04 08:37:12,982 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 08:37:15,919 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-04 08:37:15,919 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-04 08:37:26,202 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-04 08:37:26,202 - INFO - Finished loading the checkpoint in 10.28 seconds.
[rank0]:2025-11-04 08:37:26,202 - INFO - Training starts at step 1
[rank0]:2025-11-04 08:37:30,184 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 848  tflops: 39.55  mfu: 4.00%
[rank0]:2025-11-04 08:37:30,185 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-04 08:37:30,185 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 847  tflops: 39.52  mfu: 4.00%
[rank2]:2025-11-04 08:37:30,186 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 08:37:30,165 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 849  tflops: 39.58  mfu: 4.00%
[rank1]:2025-11-04 08:37:30,165 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-04 08:37:30,217 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 936  tflops: 43.66  mfu: 4.41%
[rank3]:2025-11-04 08:37:30,217 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 08:39:37,034 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:39:39,466 - INFO - Avg. fwd time: 14.6779 / Avg. bwd time: 42.2174 / Avg. batch time: 472.8370 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-11-04 08:39:39,496 - INFO - Avg. fwd time: 13.1655 / Avg. bwd time: 36.1087 / Avg. batch time: 525.5167 (ms) / GPU bubble ratio: 24.99%
[rank0]:2025-11-04 08:39:39,573 - INFO - Avg. fwd time: 13.2776 / Avg. bwd time: 37.6782 / Avg. batch time: 639.8679 (ms) / GPU bubble ratio: 36.29%
[rank1]:2025-11-04 08:39:39,541 - INFO - Avg. fwd time: 15.1795 / Avg. bwd time: 40.9750 / Avg. batch time: 584.8562 (ms) / GPU bubble ratio: 23.19%
[rank0]:2025-11-04 08:39:39,699 - INFO -  step: 50  loss: -4.0000  grad_norm: 7306.3125  memory: 54.93GiB(39.29%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank3]:2025-11-04 08:39:39,697 - INFO -  step: 50  loss: 12.7708  grad_norm: 7306.3125  memory: 46.16GiB(33.01%)  tps: 6,200  tflops: 289.19  mfu: 29.24%
[rank2]:2025-11-04 08:39:39,692 - INFO -  step: 50  loss: -4.0000  grad_norm: 7306.3125  memory: 38.72GiB(27.69%)  tps: 6,199  tflops: 289.12  mfu: 29.23%
[rank1]:2025-11-04 08:39:39,695 - INFO -  step: 50  loss: -4.0000  grad_norm: 7306.3125  memory: 47.26GiB(33.80%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank0]:2025-11-04 08:41:49,151 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:41:51,622 - INFO - Avg. fwd time: 13.1926 / Avg. bwd time: 36.2269 / Avg. batch time: 525.1405 (ms) / GPU bubble ratio: 24.71%
[rank3]:2025-11-04 08:41:51,592 - INFO - Avg. fwd time: 14.7075 / Avg. bwd time: 42.3147 / Avg. batch time: 472.6931 (ms) / GPU bubble ratio: 3.49%
[rank1]:2025-11-04 08:41:51,668 - INFO - Avg. fwd time: 15.0610 / Avg. bwd time: 41.0489 / Avg. batch time: 584.1319 (ms) / GPU bubble ratio: 23.15%
[rank0]:2025-11-04 08:41:51,700 - INFO - Avg. fwd time: 13.1594 / Avg. bwd time: 37.7093 / Avg. batch time: 638.7551 (ms) / GPU bubble ratio: 36.29%
[rank1]:2025-11-04 08:41:51,821 - INFO -  step: 100  loss: -4.0000  grad_norm: 58.3939  memory: 47.26GiB(33.80%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank1]:2025-11-04 08:41:51,821 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:41:51,825 - INFO -  step: 100  loss: -4.0000  grad_norm: 58.3939  memory: 54.93GiB(39.29%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank0]:2025-11-04 08:41:51,825 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 08:41:51,818 - INFO -  step: 100  loss: -4.0000  grad_norm: 58.3939  memory: 38.72GiB(27.69%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank2]:2025-11-04 08:41:51,818 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 08:41:51,823 - INFO -  step: 100  loss:  4.1231  grad_norm: 58.3939  memory: 46.16GiB(33.01%)  tps: 6,200  tflops: 289.18  mfu: 29.24%
[rank3]:2025-11-04 08:41:51,824 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:44:01,250 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:44:03,818 - INFO - Avg. fwd time: 13.1800 / Avg. bwd time: 36.2928 / Avg. batch time: 524.8015 (ms) / GPU bubble ratio: 24.58%
[rank3]:2025-11-04 08:44:03,776 - INFO - Avg. fwd time: 14.7032 / Avg. bwd time: 42.3298 / Avg. batch time: 472.4307 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-11-04 08:44:03,937 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.0974  memory: 38.72GiB(27.69%)  tps: 6,200  tflops: 289.19  mfu: 29.24%
[rank0]:2025-11-04 08:44:03,908 - INFO - Avg. fwd time: 13.1226 / Avg. bwd time: 37.7276 / Avg. batch time: 638.2143 (ms) / GPU bubble ratio: 36.26%
[rank0]:2025-11-04 08:44:03,944 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.0974  memory: 54.93GiB(39.29%)  tps: 6,200  tflops: 289.19  mfu: 29.24%
[rank1]:2025-11-04 08:44:03,865 - INFO - Avg. fwd time: 15.0123 / Avg. bwd time: 41.0980 / Avg. batch time: 583.6779 (ms) / GPU bubble ratio: 23.09%
[rank1]:2025-11-04 08:44:03,940 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.0974  memory: 47.26GiB(33.80%)  tps: 6,200  tflops: 289.19  mfu: 29.24%
[rank3]:2025-11-04 08:44:03,942 - INFO -  step: 150  loss:  1.1014  grad_norm: 16.0974  memory: 46.16GiB(33.01%)  tps: 6,201  tflops: 289.20  mfu: 29.24%
[rank0]:2025-11-04 08:46:13,278 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:46:15,737 - INFO - Avg. fwd time: 13.1748 / Avg. bwd time: 36.3266 / Avg. batch time: 524.6417 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-11-04 08:46:15,707 - INFO - Avg. fwd time: 14.6986 / Avg. bwd time: 42.3377 / Avg. batch time: 472.3079 (ms) / GPU bubble ratio: 3.39%
[rank1]:2025-11-04 08:46:15,783 - INFO - Avg. fwd time: 14.9878 / Avg. bwd time: 41.1170 / Avg. batch time: 583.4641 (ms) / GPU bubble ratio: 23.07%
[rank0]:2025-11-04 08:46:15,815 - INFO - Avg. fwd time: 13.1067 / Avg. bwd time: 37.7339 / Avg. batch time: 637.9454 (ms) / GPU bubble ratio: 36.24%
[rank2]:2025-11-04 08:46:15,934 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5005  memory: 38.72GiB(27.69%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank2]:2025-11-04 08:46:15,934 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 08:46:15,941 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5005  memory: 54.93GiB(39.29%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank0]:2025-11-04 08:46:15,941 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 08:46:15,939 - INFO -  step: 200  loss:  0.3462  grad_norm:  0.5005  memory: 46.16GiB(33.01%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank3]:2025-11-04 08:46:15,939 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 08:46:15,937 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.5005  memory: 47.26GiB(33.80%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank1]:2025-11-04 08:46:15,937 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-04 08:46:49,097 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 12,351
[rank2]:2025-11-04 08:46:49,098 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:46:49,055 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 12,369
[rank0]:2025-11-04 08:46:49,056 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 08:46:49,085 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 12,357
[rank1]:2025-11-04 08:46:49,086 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 08:46:49,112 - INFO - validate step: 200  loss:  0.2310  memory: 46.16GiB(33.01%)  tps: 12,348
[rank3]:2025-11-04 08:46:49,113 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:48:58,499 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 08:49:00,922 - INFO - Avg. fwd time: 14.6966 / Avg. bwd time: 42.3411 / Avg. batch time: 472.2128 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-11-04 08:49:00,951 - INFO - Avg. fwd time: 13.1741 / Avg. bwd time: 36.3385 / Avg. batch time: 524.5164 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-11-04 08:49:00,997 - INFO - Avg. fwd time: 14.9827 / Avg. bwd time: 41.1332 / Avg. batch time: 583.3205 (ms) / GPU bubble ratio: 23.04%
[rank0]:2025-11-04 08:49:01,029 - INFO - Avg. fwd time: 13.1047 / Avg. bwd time: 37.7486 / Avg. batch time: 637.7976 (ms) / GPU bubble ratio: 36.21%
[rank1]:2025-11-04 08:49:01,148 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2524  memory: 47.26GiB(33.80%)  tps: 6,203  tflops: 289.31  mfu: 29.25%
[rank3]:2025-11-04 08:49:01,150 - INFO -  step: 250  loss:  0.2341  grad_norm:  0.2524  memory: 46.16GiB(33.01%)  tps: 6,204  tflops: 289.37  mfu: 29.26%
[rank2]:2025-11-04 08:49:01,146 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2524  memory: 38.72GiB(27.69%)  tps: 6,204  tflops: 289.35  mfu: 29.26%
[rank0]:2025-11-04 08:49:01,152 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2524  memory: 54.93GiB(39.29%)  tps: 6,202  tflops: 289.24  mfu: 29.25%
[rank0]:2025-11-04 08:51:10,655 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:51:13,173 - INFO - Avg. fwd time: 14.6968 / Avg. bwd time: 42.3483 / Avg. batch time: 472.2035 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-11-04 08:51:13,215 - INFO - Avg. fwd time: 13.1747 / Avg. bwd time: 36.3493 / Avg. batch time: 524.5049 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-11-04 08:51:13,263 - INFO - Avg. fwd time: 14.9751 / Avg. bwd time: 41.1406 / Avg. batch time: 583.2938 (ms) / GPU bubble ratio: 23.04%
[rank0]:2025-11-04 08:51:13,307 - INFO - Avg. fwd time: 13.0985 / Avg. bwd time: 37.7566 / Avg. batch time: 637.7519 (ms) / GPU bubble ratio: 36.21%
[rank2]:2025-11-04 08:51:13,336 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9805  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.04  mfu: 29.23%
[rank2]:2025-11-04 08:51:13,336 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 08:51:13,338 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9805  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.04  mfu: 29.23%
[rank1]:2025-11-04 08:51:13,338 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:51:13,342 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.9805  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.04  mfu: 29.23%
[rank0]:2025-11-04 08:51:13,342 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 08:51:13,340 - INFO -  step: 300  loss:  0.2699  grad_norm:  0.9805  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.04  mfu: 29.23%
[rank3]:2025-11-04 08:51:13,341 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:53:23,125 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:53:25,572 - INFO - Avg. fwd time: 14.7017 / Avg. bwd time: 42.3590 / Avg. batch time: 472.2870 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-11-04 08:53:25,602 - INFO - Avg. fwd time: 13.1862 / Avg. bwd time: 36.3650 / Avg. batch time: 524.5929 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-04 08:53:25,649 - INFO - Avg. fwd time: 14.9842 / Avg. bwd time: 41.1578 / Avg. batch time: 583.3915 (ms) / GPU bubble ratio: 23.01%
[rank0]:2025-11-04 08:53:25,681 - INFO - Avg. fwd time: 13.1022 / Avg. bwd time: 37.7699 / Avg. batch time: 637.8491 (ms) / GPU bubble ratio: 36.20%
[rank0]:2025-11-04 08:53:25,804 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3724  memory: 54.93GiB(39.29%)  tps: 6,184  tflops: 288.44  mfu: 29.16%
[rank3]:2025-11-04 08:53:25,803 - INFO -  step: 350  loss:  0.3348  grad_norm:  0.3724  memory: 46.16GiB(33.01%)  tps: 6,184  tflops: 288.45  mfu: 29.17%
[rank2]:2025-11-04 08:53:25,798 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3724  memory: 38.72GiB(27.69%)  tps: 6,184  tflops: 288.44  mfu: 29.17%
[rank1]:2025-11-04 08:53:25,800 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3724  memory: 47.26GiB(33.80%)  tps: 6,184  tflops: 288.44  mfu: 29.17%
[rank0]:2025-11-04 08:55:35,555 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:55:38,005 - INFO - Avg. fwd time: 14.7076 / Avg. bwd time: 42.3735 / Avg. batch time: 472.4150 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-11-04 08:55:38,035 - INFO - Avg. fwd time: 13.1926 / Avg. bwd time: 36.3732 / Avg. batch time: 524.7241 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-04 08:55:38,081 - INFO - Avg. fwd time: 14.9859 / Avg. bwd time: 41.1664 / Avg. batch time: 583.5230 (ms) / GPU bubble ratio: 23.02%
[rank0]:2025-11-04 08:55:38,114 - INFO - Avg. fwd time: 13.1063 / Avg. bwd time: 37.7800 / Avg. batch time: 637.9769 (ms) / GPU bubble ratio: 36.19%
[rank0]:2025-11-04 08:55:38,238 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3124  memory: 54.93GiB(39.29%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank0]:2025-11-04 08:55:38,238 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 08:55:38,236 - INFO -  step: 400  loss:  0.2732  grad_norm:  0.3124  memory: 46.16GiB(33.01%)  tps: 6,186  tflops: 288.51  mfu: 29.17%
[rank3]:2025-11-04 08:55:38,237 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 08:55:38,231 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3124  memory: 38.72GiB(27.69%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank2]:2025-11-04 08:55:38,231 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 08:55:38,234 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3124  memory: 47.26GiB(33.80%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank1]:2025-11-04 08:55:38,234 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 08:55:53,223 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,335
[rank0]:2025-11-04 08:55:53,223 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 08:55:53,267 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,242
[rank2]:2025-11-04 08:55:53,268 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 08:55:53,255 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,269
[rank1]:2025-11-04 08:55:53,256 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 08:55:53,281 - INFO - validate step: 400  loss:  0.2369  memory: 46.16GiB(33.01%)  tps: 27,228
[rank3]:2025-11-04 08:55:53,282 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 08:58:03,045 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 08:58:05,568 - INFO - Avg. fwd time: 14.7131 / Avg. bwd time: 42.3879 / Avg. batch time: 472.5468 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-11-04 08:58:05,612 - INFO - Avg. fwd time: 13.1992 / Avg. bwd time: 36.3840 / Avg. batch time: 524.8614 (ms) / GPU bubble ratio: 24.42%
[rank1]:2025-11-04 08:58:05,661 - INFO - Avg. fwd time: 14.9838 / Avg. bwd time: 41.1690 / Avg. batch time: 583.6595 (ms) / GPU bubble ratio: 23.03%
[rank1]:2025-11-04 08:58:05,738 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3052  memory: 47.26GiB(33.80%)  tps: 6,183  tflops: 288.40  mfu: 29.16%
[rank3]:2025-11-04 08:58:05,740 - INFO -  step: 450  loss:  0.3038  grad_norm:  0.3052  memory: 46.16GiB(33.01%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank0]:2025-11-04 08:58:05,706 - INFO - Avg. fwd time: 13.1055 / Avg. bwd time: 37.7822 / Avg. batch time: 638.1125 (ms) / GPU bubble ratio: 36.20%
[rank0]:2025-11-04 08:58:05,742 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3052  memory: 54.93GiB(39.29%)  tps: 6,182  tflops: 288.32  mfu: 29.15%
[rank2]:2025-11-04 08:58:05,735 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3052  memory: 38.72GiB(27.69%)  tps: 6,184  tflops: 288.43  mfu: 29.16%
[rank3]:2025-11-04 08:58:32,015 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-04 08:59:03,028 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-04 08:59:03,252 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-04 08:59:19,076 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:21,146 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:23,620 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:23,627 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:23,633 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:23,645 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,119 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,146 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,166 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,191 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,237 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,198 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,233 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,274 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,240 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,294 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,290 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,264 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,317 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,327 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,380 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,337 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,373 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,404 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,344 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:25,396 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,371 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,372 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,372 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 08:59:25,373 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 08:59:25,412 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 08:59:25,433 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 08:59:41,104 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-04 08:59:41,316 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0859_max_batch_time.svg
[rank3]:> Batch Time: 620.72 ms, GPU Bubble Ratio: 34.37%, 27.65%, 35.91%, 26.27%
[rank3]:2025-11-04 08:59:41,460 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0859_min_batch_time.svg
[rank3]:> Batch Time: 348.71 ms, GPU Bubble Ratio: 70.06%, 23.88%, 32.60%, 23.55%
[rank3]:2025-11-04 08:59:41,630 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0859_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 367.52 ms, GPU Bubble Ratio: 28.43%, 21.41%, 25.82%, 22.34%
[rank3]:2025-11-04 08:59:41,630 - INFO - 	> Batch Time: 367.52 ms (Average Freeze Ratio: 0.75, Time Reduction Rate: 0.41)
[rank0]:2025-11-04 09:00:38,214 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 09:00:40,456 - INFO - Avg. fwd time: 13.2829 / Avg. bwd time: 35.5590 / Avg. batch time: 518.0395 (ms) / GPU bubble ratio: 24.57%
[rank3]:2025-11-04 09:00:40,443 - INFO - Avg. fwd time: 14.8122 / Avg. bwd time: 41.4200 / Avg. batch time: 465.6134 (ms) / GPU bubble ratio: 3.38%
[rank1]:2025-11-04 09:00:40,505 - INFO - Avg. fwd time: 15.0793 / Avg. bwd time: 40.1678 / Avg. batch time: 575.8162 (ms) / GPU bubble ratio: 23.24%
[rank0]:2025-11-04 09:00:40,536 - INFO - Avg. fwd time: 13.1820 / Avg. bwd time: 36.4487 / Avg. batch time: 629.1482 (ms) / GPU bubble ratio: 36.89%
[rank2]:2025-11-04 09:00:55,467 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.81, [MB1] 0.27/0.80, [MB2] 0.27/0.82, [MB3] 0.27/0.82, [MB4] 0.27/0.82, [MB5] 0.27/0.81, [MB6] 0.09/0.27, [MB7] 0.33/1.00
[rank2]:2025-11-04 09:00:55,468 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2021  memory: 38.72GiB(27.69%)  tps: 4,826  tflops: 225.11  mfu: 22.76%
[rank1]:2025-11-04 09:00:59,990 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.99, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-04 09:00:59,991 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2021  memory: 47.39GiB(33.90%)  tps: 4,701  tflops: 219.27  mfu: 22.17%
[rank0]:2025-11-04 09:01:01,016 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.47, [MB1] 0.15/0.46, [MB2] 0.15/0.45, [MB3] 0.15/0.46, [MB4] 0.00/0.00, [MB5] 0.15/0.45, [MB6] 0.17/0.52, [MB7] 0.33/1.00
[rank0]:2025-11-04 09:01:01,017 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2021  memory: 55.15GiB(39.44%)  tps: 4,674  tflops: 217.99  mfu: 22.04%
[rank3]:2025-11-04 09:01:05,407 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-04 09:01:05,417 - INFO -  step: 500  loss:  0.3009  grad_norm:  0.2021  memory: 46.55GiB(33.29%)  tps: 4,559  tflops: 212.65  mfu: 21.50%
[rank2]:2025-11-04 09:01:05,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0900_stage2_step500.svg
[rank1]:2025-11-04 09:01:05,482 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0900_stage1_step500.svg
[rank0]:2025-11-04 09:01:05,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0901_stage0_step500.svg
[rank3]:2025-11-04 09:01:05,567 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0901_real_step500_rank3.svg
[rank3]:> Batch Time: 429.06 ms, GPU Bubble Ratio: 48.44%, 33.84%, 37.88%, 29.91%
[rank3]:2025-11-04 09:01:05,612 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0901_stage3_step500.svg
[rank0]:2025-11-04 09:04:11,451 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:04:13,273 - INFO - Avg. fwd time: 14.9290 / Avg. bwd time: 40.2318 / Avg. batch time: 457.0155 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-11-04 09:04:13,293 - INFO - Avg. fwd time: 13.3689 / Avg. bwd time: 34.6234 / Avg. batch time: 510.1154 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-04 09:04:13,306 - INFO - Avg. fwd time: 15.1955 / Avg. bwd time: 38.9719 / Avg. batch time: 566.6772 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-11-04 09:04:13,336 - INFO - Avg. fwd time: 13.2559 / Avg. bwd time: 35.6741 / Avg. batch time: 619.3681 (ms) / GPU bubble ratio: 36.80%
[rank1]:2025-11-04 09:04:18,551 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.66/0.99, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-04 09:04:18,552 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0863  memory: 48.19GiB(34.47%)  tps: 4,126  tflops: 192.42  mfu: 19.46%
[rank2]:2025-11-04 09:04:22,173 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.54/0.81, [MB1] 0.54/0.80, [MB2] 0.55/0.82, [MB3] 0.54/0.82, [MB4] 0.54/0.82, [MB5] 0.54/0.81, [MB6] 0.18/0.27, [MB7] 0.67/1.00
[rank2]:2025-11-04 09:04:22,174 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0863  memory: 38.93GiB(27.85%)  tps: 3,963  tflops: 184.84  mfu: 18.69%
[rank3]:2025-11-04 09:04:27,963 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-04 09:04:27,974 - INFO -  step: 550  loss:  0.1631  grad_norm:  0.0863  memory: 47.41GiB(33.91%)  tps: 4,044  tflops: 188.63  mfu: 19.07%
[rank0]:2025-11-04 09:04:32,780 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.47, [MB1] 0.30/0.46, [MB2] 0.30/0.45, [MB3] 0.31/0.46, [MB4] 0.00/0.00, [MB5] 0.30/0.45, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank0]:2025-11-04 09:04:32,781 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0863  memory: 57.28GiB(40.97%)  tps: 3,868  tflops: 180.43  mfu: 18.24%
[rank0]:2025-11-04 09:07:05,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:07:07,265 - INFO - Avg. fwd time: 15.1032 / Avg. bwd time: 38.7097 / Avg. batch time: 446.2126 (ms) / GPU bubble ratio: 3.52%
[rank1]:2025-11-04 09:07:07,321 - INFO - Avg. fwd time: 15.3632 / Avg. bwd time: 37.4505 / Avg. batch time: 552.8573 (ms) / GPU bubble ratio: 23.58%
[rank2]:2025-11-04 09:07:07,293 - INFO - Avg. fwd time: 13.5071 / Avg. bwd time: 33.3702 / Avg. batch time: 497.8498 (ms) / GPU bubble ratio: 24.67%
[rank0]:2025-11-04 09:07:07,353 - INFO - Avg. fwd time: 13.3936 / Avg. bwd time: 34.4068 / Avg. batch time: 604.5199 (ms) / GPU bubble ratio: 36.74%
[rank1]:2025-11-04 09:07:08,749 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.99/0.99, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 09:07:08,749 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0991  memory: 48.19GiB(34.47%)  tps: 4,813  tflops: 224.49  mfu: 22.70%
[rank1]:2025-11-04 09:07:08,749 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 09:07:10,077 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 09:07:10,087 - INFO -  step: 600  loss:  0.4330  grad_norm:  0.0991  memory: 47.41GiB(33.91%)  tps: 5,053  tflops: 235.69  mfu: 23.83%
[rank3]:2025-11-04 09:07:10,087 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-04 09:07:13,447 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.82/0.82, [MB4] 0.82/0.82, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-04 09:07:13,447 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0991  memory: 38.93GiB(27.85%)  tps: 4,783  tflops: 223.08  mfu: 22.56%
[rank2]:2025-11-04 09:07:13,447 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 09:07:22,517 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 09:07:22,517 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0991  memory: 57.28GiB(40.97%)  tps: 4,826  tflops: 225.10  mfu: 22.76%
[rank0]:2025-11-04 09:07:22,517 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 09:07:38,871 - INFO - validate step: 600  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 25,048
[rank1]:2025-11-04 09:07:38,899 - INFO - validate step: 600  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 13,586
[rank1]:2025-11-04 09:07:38,983 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0907_stage1_step600.svg
[rank2]:2025-11-04 09:07:38,916 - INFO - validate step: 600  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 16,083
[rank2]:2025-11-04 09:07:38,984 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0907_stage2_step600.svg
[rank3]:2025-11-04 09:07:38,931 - INFO - validate step: 600  loss:  0.2479  memory: 47.41GiB(33.91%)  tps: 14,201
[rank0]:2025-11-04 09:07:38,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0907_stage0_step600.svg
[rank3]:2025-11-04 09:07:39,072 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0907_real_step600_rank3.svg
[rank3]:> Batch Time: 436.86 ms, GPU Bubble Ratio: 35.23%, 32.18%, 36.42%, 29.57%
[rank3]:2025-11-04 09:07:39,115 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0907_stage3_step600.svg
[rank0]:2025-11-04 09:10:07,796 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 09:10:09,454 - INFO - Avg. fwd time: 15.2657 / Avg. bwd time: 37.4662 / Avg. batch time: 437.5529 (ms) / GPU bubble ratio: 3.59%
[rank0]:2025-11-04 09:10:09,501 - INFO - Avg. fwd time: 13.5171 / Avg. bwd time: 32.8343 / Avg. batch time: 592.4723 (ms) / GPU bubble ratio: 37.41%
[rank1]:2025-11-04 09:10:09,473 - INFO - Avg. fwd time: 15.5138 / Avg. bwd time: 36.1295 / Avg. batch time: 541.6971 (ms) / GPU bubble ratio: 23.73%
[rank2]:2025-11-04 09:10:09,468 - INFO - Avg. fwd time: 13.6348 / Avg. bwd time: 32.3337 / Avg. batch time: 488.0066 (ms) / GPU bubble ratio: 24.64%
[rank3]:2025-11-04 09:10:09,528 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 09:10:09,562 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.99/0.99, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 09:10:09,587 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,436  tflops: 253.55  mfu: 25.64%
[rank3]:2025-11-04 09:10:09,589 - INFO -  step: 650  loss:  0.2705  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,438  tflops: 253.61  mfu: 25.64%
[rank2]:2025-11-04 09:10:14,331 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.82/0.82, [MB4] 0.82/0.82, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-04 09:10:14,332 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0807  memory: 38.93GiB(27.85%)  tps: 5,271  tflops: 245.84  mfu: 24.86%
[rank0]:2025-11-04 09:10:18,272 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 09:10:18,273 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0807  memory: 57.28GiB(40.97%)  tps: 5,139  tflops: 239.69  mfu: 24.24%
[rank0]:2025-11-04 09:12:23,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 09:12:25,559 - INFO - Avg. fwd time: 13.7620 / Avg. bwd time: 31.2793 / Avg. batch time: 478.0071 (ms) / GPU bubble ratio: 24.62%
[rank3]:2025-11-04 09:12:25,544 - INFO - Avg. fwd time: 15.4279 / Avg. bwd time: 36.2044 / Avg. batch time: 428.7442 (ms) / GPU bubble ratio: 3.66%
[rank0]:2025-11-04 09:12:25,592 - INFO - Avg. fwd time: 13.6345 / Avg. bwd time: 31.2528 / Avg. batch time: 580.2588 (ms) / GPU bubble ratio: 38.11%
[rank1]:2025-11-04 09:12:25,564 - INFO - Avg. fwd time: 15.6634 / Avg. bwd time: 34.8026 / Avg. batch time: 530.3740 (ms) / GPU bubble ratio: 23.88%
[rank1]:2025-11-04 09:12:25,654 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.99/0.99, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 09:12:25,617 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 09:12:25,678 - INFO -  step: 700  loss:  0.3709  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,020  tflops: 280.76  mfu: 28.39%
[rank1]:2025-11-04 09:12:25,677 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,020  tflops: 280.75  mfu: 28.39%
[rank2]:2025-11-04 09:12:30,296 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.82/0.82, [MB4] 0.82/0.82, [MB5] 0.81/0.81, [MB6] 0.27/0.27, [MB7] 1.00/1.00
[rank2]:2025-11-04 09:12:30,297 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1058  memory: 38.93GiB(27.85%)  tps: 6,025  tflops: 281.01  mfu: 28.41%
[rank0]:2025-11-04 09:12:33,639 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 09:12:33,640 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.1058  memory: 57.28GiB(40.97%)  tps: 6,052  tflops: 282.25  mfu: 28.54%
[rank0]:2025-11-04 09:12:33,696 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0912_stage0_step700.svg
[rank1]:2025-11-04 09:12:33,692 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0912_stage1_step700.svg
[rank2]:2025-11-04 09:12:33,692 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0912_stage2_step700.svg
[rank3]:2025-11-04 09:12:33,782 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0912_real_step700_rank3.svg
[rank3]:> Batch Time: 432.09 ms, GPU Bubble Ratio: 50.60%, 33.26%, 37.54%, 28.99%
[rank3]:2025-11-04 09:12:33,828 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0912_stage3_step700.svg
[rank0]:2025-11-04 09:14:43,292 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:14:45,010 - INFO - Avg. fwd time: 15.5635 / Avg. bwd time: 35.1272 / Avg. batch time: 421.2006 (ms) / GPU bubble ratio: 3.72%
[rank1]:2025-11-04 09:14:45,063 - INFO - Avg. fwd time: 15.7882 / Avg. bwd time: 33.6571 / Avg. batch time: 520.7049 (ms) / GPU bubble ratio: 24.03%
[rank2]:2025-11-04 09:14:45,037 - INFO - Avg. fwd time: 13.8690 / Avg. bwd time: 30.3780 / Avg. batch time: 469.4821 (ms) / GPU bubble ratio: 24.60%
[rank3]:2025-11-04 09:14:45,101 - INFO -  step: 750  loss:  0.1469  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,876  tflops: 274.05  mfu: 27.71%
[rank0]:2025-11-04 09:14:45,095 - INFO - Avg. fwd time: 13.7314 / Avg. bwd time: 29.9139 / Avg. batch time: 569.8313 (ms) / GPU bubble ratio: 38.73%
[rank1]:2025-11-04 09:14:45,099 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,876  tflops: 274.04  mfu: 27.71%
[rank2]:2025-11-04 09:14:47,206 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0797  memory: 38.93GiB(27.85%)  tps: 5,984  tflops: 279.07  mfu: 28.22%
[rank0]:2025-11-04 09:14:55,549 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0797  memory: 57.28GiB(40.97%)  tps: 5,773  tflops: 269.24  mfu: 27.22%
[rank0]:2025-11-04 09:17:02,548 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:17:04,229 - INFO - Avg. fwd time: 15.6538 / Avg. bwd time: 34.3015 / Avg. batch time: 415.3069 (ms) / GPU bubble ratio: 3.77%
[rank1]:2025-11-04 09:17:04,249 - INFO - Avg. fwd time: 15.8730 / Avg. bwd time: 32.7892 / Avg. batch time: 513.1880 (ms) / GPU bubble ratio: 24.14%
[rank2]:2025-11-04 09:17:04,244 - INFO - Avg. fwd time: 13.9409 / Avg. bwd time: 29.6971 / Avg. batch time: 462.8381 (ms) / GPU bubble ratio: 24.57%
[rank0]:2025-11-04 09:17:04,277 - INFO - Avg. fwd time: 13.7919 / Avg. bwd time: 28.9239 / Avg. batch time: 561.7477 (ms) / GPU bubble ratio: 39.17%
[rank1]:2025-11-04 09:17:04,360 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,882  tflops: 274.36  mfu: 27.74%
[rank1]:2025-11-04 09:17:04,360 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 09:17:04,362 - INFO -  step: 800  loss:  0.2779  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,883  tflops: 274.36  mfu: 27.74%
[rank3]:2025-11-04 09:17:04,363 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-04 09:17:09,560 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0908  memory: 38.93GiB(27.85%)  tps: 5,755  tflops: 268.40  mfu: 27.14%
[rank2]:2025-11-04 09:17:09,560 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 09:17:10,709 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0908  memory: 57.28GiB(40.97%)  tps: 6,061  tflops: 282.68  mfu: 28.58%
[rank0]:2025-11-04 09:17:10,709 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 09:17:27,176 - INFO - validate step: 800  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,876
[rank1]:2025-11-04 09:17:27,210 - INFO - validate step: 800  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 17,926
[rank2]:2025-11-04 09:17:27,230 - INFO - validate step: 800  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 23,181
[rank3]:2025-11-04 09:17:27,253 - INFO - validate step: 800  loss:  0.2483  memory: 47.41GiB(33.91%)  tps: 17,895
[rank1]:2025-11-04 09:17:27,307 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0917_stage1_step800.svg
[rank2]:2025-11-04 09:17:27,306 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0917_stage2_step800.svg
[rank0]:2025-11-04 09:17:27,307 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0917_stage0_step800.svg
[rank3]:2025-11-04 09:17:27,395 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0917_real_step800_rank3.svg
[rank3]:> Batch Time: 427.30 ms, GPU Bubble Ratio: 48.29%, 33.50%, 37.22%, 29.60%
[rank3]:2025-11-04 09:17:27,442 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0917_stage3_step800.svg
[rank0]:2025-11-04 09:19:35,561 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 09:19:37,184 - INFO - Avg. fwd time: 15.7530 / Avg. bwd time: 33.4452 / Avg. batch time: 409.2406 (ms) / GPU bubble ratio: 3.83%
[rank1]:2025-11-04 09:19:37,203 - INFO - Avg. fwd time: 15.9668 / Avg. bwd time: 31.8980 / Avg. batch time: 505.4062 (ms) / GPU bubble ratio: 24.24%
[rank2]:2025-11-04 09:19:37,198 - INFO - Avg. fwd time: 14.0219 / Avg. bwd time: 28.9914 / Avg. batch time: 455.9510 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-11-04 09:19:37,233 - INFO - Avg. fwd time: 13.8583 / Avg. bwd time: 27.8925 / Avg. batch time: 553.3906 (ms) / GPU bubble ratio: 39.64%
[rank1]:2025-11-04 09:19:37,316 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank3]:2025-11-04 09:19:37,318 - INFO -  step: 850  loss:  0.1198  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,299  tflops: 293.76  mfu: 29.70%
[rank2]:2025-11-04 09:19:40,866 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0869  memory: 38.93GiB(27.85%)  tps: 6,130  tflops: 285.91  mfu: 28.91%
[rank0]:2025-11-04 09:19:51,644 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0869  memory: 57.28GiB(40.97%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank0]:2025-11-04 09:21:56,602 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 09:21:58,348 - INFO - Avg. fwd time: 14.0835 / Avg. bwd time: 28.3666 / Avg. batch time: 449.7283 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-11-04 09:21:58,318 - INFO - Avg. fwd time: 15.8274 / Avg. bwd time: 32.6839 / Avg. batch time: 403.7332 (ms) / GPU bubble ratio: 3.87%
[rank0]:2025-11-04 09:21:58,405 - INFO - Avg. fwd time: 13.9086 / Avg. bwd time: 26.9847 / Avg. batch time: 545.8538 (ms) / GPU bubble ratio: 40.07%
[rank1]:2025-11-04 09:21:58,375 - INFO - Avg. fwd time: 16.0402 / Avg. bwd time: 31.1046 / Avg. batch time: 498.3834 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-11-04 09:21:58,409 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank3]:2025-11-04 09:21:58,411 - INFO -  step: 900  loss:  0.1856  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank2]:2025-11-04 09:22:02,247 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0545  memory: 38.93GiB(27.85%)  tps: 5,794  tflops: 270.25  mfu: 27.33%
[rank0]:2025-11-04 09:22:05,106 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0545  memory: 57.28GiB(40.97%)  tps: 6,138  tflops: 286.28  mfu: 28.95%
[rank2]:2025-11-04 09:22:05,154 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0922_stage2_step900.svg
[rank1]:2025-11-04 09:22:05,154 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0921_stage1_step900.svg
[rank0]:2025-11-04 09:22:05,155 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0922_stage0_step900.svg
[rank3]:2025-11-04 09:22:05,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0921_real_step900_rank3.svg
[rank3]:> Batch Time: 425.64 ms, GPU Bubble Ratio: 49.79%, 33.02%, 37.09%, 29.22%
[rank3]:2025-11-04 09:22:05,289 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0921_stage3_step900.svg
[rank0]:2025-11-04 09:24:12,622 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:24:14,285 - INFO - Avg. fwd time: 15.8931 / Avg. bwd time: 32.1089 / Avg. batch time: 399.6524 (ms) / GPU bubble ratio: 3.91%
[rank0]:2025-11-04 09:24:14,334 - INFO - Avg. fwd time: 13.9540 / Avg. bwd time: 26.2816 / Avg. batch time: 540.2351 (ms) / GPU bubble ratio: 40.42%
[rank2]:2025-11-04 09:24:14,299 - INFO - Avg. fwd time: 14.1366 / Avg. bwd time: 27.8901 / Avg. batch time: 445.1157 (ms) / GPU bubble ratio: 24.47%
[rank1]:2025-11-04 09:24:14,304 - INFO - Avg. fwd time: 16.1031 / Avg. bwd time: 30.4984 / Avg. batch time: 493.1618 (ms) / GPU bubble ratio: 24.40%
[rank3]:2025-11-04 09:24:14,421 - INFO -  step: 950  loss:  0.2590  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,023  tflops: 280.92  mfu: 28.40%
[rank1]:2025-11-04 09:24:14,419 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,023  tflops: 280.92  mfu: 28.40%
[rank2]:2025-11-04 09:24:19,160 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.3206  memory: 38.93GiB(27.85%)  tps: 5,983  tflops: 279.07  mfu: 28.22%
[rank0]:2025-11-04 09:24:27,719 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.3206  memory: 57.28GiB(40.97%)  tps: 5,744  tflops: 267.91  mfu: 27.09%
[rank0]:2025-11-04 09:26:35,405 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:26:37,016 - INFO - Avg. fwd time: 15.9668 / Avg. bwd time: 31.5090 / Avg. batch time: 395.4361 (ms) / GPU bubble ratio: 3.95%
[rank0]:2025-11-04 09:26:37,062 - INFO - Avg. fwd time: 14.0034 / Avg. bwd time: 25.5497 / Avg. batch time: 534.3796 (ms) / GPU bubble ratio: 40.79%
[rank2]:2025-11-04 09:26:37,029 - INFO - Avg. fwd time: 14.1956 / Avg. bwd time: 27.3926 / Avg. batch time: 440.3012 (ms) / GPU bubble ratio: 24.44%
[rank1]:2025-11-04 09:26:37,034 - INFO - Avg. fwd time: 16.1725 / Avg. bwd time: 29.8623 / Avg. batch time: 487.7118 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-11-04 09:26:37,145 - INFO -  step: 1000  loss:  0.1629  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,740  tflops: 267.71  mfu: 27.07%
[rank3]:2025-11-04 09:26:37,145 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 09:26:37,143 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,740  tflops: 267.70  mfu: 27.07%
[rank1]:2025-11-04 09:26:37,143 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-04 09:26:40,205 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0360  memory: 38.93GiB(27.85%)  tps: 5,808  tflops: 270.89  mfu: 27.39%
[rank2]:2025-11-04 09:26:40,205 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 09:26:44,009 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0360  memory: 57.28GiB(40.97%)  tps: 6,011  tflops: 280.34  mfu: 28.35%
[rank0]:2025-11-04 09:26:44,009 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 09:27:00,449 - INFO - validate step: 1000  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 17,575
[rank0]:2025-11-04 09:27:00,414 - INFO - validate step: 1000  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,968
[rank2]:2025-11-04 09:27:00,465 - INFO - validate step: 1000  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 20,218
[rank1]:2025-11-04 09:27:00,536 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0927_stage1_step1000.svg
[rank3]:2025-11-04 09:27:00,485 - INFO - validate step: 1000  loss:  0.2457  memory: 47.41GiB(33.91%)  tps: 17,550
[rank0]:2025-11-04 09:27:00,537 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0927_stage0_step1000.svg
[rank2]:2025-11-04 09:27:00,535 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0927_stage2_step1000.svg
[rank3]:2025-11-04 09:27:00,626 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0927_real_step1000_rank3.svg
[rank3]:> Batch Time: 424.06 ms, GPU Bubble Ratio: 49.63%, 32.55%, 36.89%, 29.45%
[rank3]:2025-11-04 09:27:00,670 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0927_stage3_step1000.svg
[rank0]:2025-11-04 09:29:09,507 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 09:29:11,280 - INFO - Avg. fwd time: 16.0266 / Avg. bwd time: 30.9529 / Avg. batch time: 391.4589 (ms) / GPU bubble ratio: 3.99%
[rank2]:2025-11-04 09:29:11,308 - INFO - Avg. fwd time: 14.2443 / Avg. bwd time: 26.9421 / Avg. batch time: 435.8101 (ms) / GPU bubble ratio: 24.40%
[rank1]:2025-11-04 09:29:11,336 - INFO - Avg. fwd time: 16.2289 / Avg. bwd time: 29.2869 / Avg. batch time: 482.6417 (ms) / GPU bubble ratio: 24.56%
[rank3]:2025-11-04 09:29:11,376 - INFO -  step: 1050  loss:  0.2490  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,259  tflops: 291.91  mfu: 29.52%
[rank0]:2025-11-04 09:29:11,369 - INFO - Avg. fwd time: 14.0440 / Avg. bwd time: 24.8947 / Avg. batch time: 528.9373 (ms) / GPU bubble ratio: 41.11%
[rank1]:2025-11-04 09:29:11,375 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,257  tflops: 291.83  mfu: 29.51%
[rank2]:2025-11-04 09:29:15,370 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1885  memory: 38.93GiB(27.85%)  tps: 6,072  tflops: 283.22  mfu: 28.64%
[rank0]:2025-11-04 09:29:24,238 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1885  memory: 57.28GiB(40.97%)  tps: 5,696  tflops: 265.66  mfu: 26.86%
[rank0]:2025-11-04 09:31:33,735 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 09:31:35,403 - INFO - Avg. fwd time: 16.2875 / Avg. bwd time: 28.8466 / Avg. batch time: 479.0698 (ms) / GPU bubble ratio: 24.63%
[rank3]:2025-11-04 09:31:35,384 - INFO - Avg. fwd time: 16.0902 / Avg. bwd time: 30.5452 / Avg. batch time: 388.7036 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-11-04 09:31:35,399 - INFO - Avg. fwd time: 14.2935 / Avg. bwd time: 26.5959 / Avg. batch time: 432.6707 (ms) / GPU bubble ratio: 24.40%
[rank0]:2025-11-04 09:31:35,431 - INFO - Avg. fwd time: 14.0863 / Avg. bwd time: 24.3797 / Avg. batch time: 525.0880 (ms) / GPU bubble ratio: 41.39%
[rank1]:2025-11-04 09:31:35,513 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,683  tflops: 265.08  mfu: 26.80%
[rank3]:2025-11-04 09:31:35,515 - INFO -  step: 1100  loss:  0.2327  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,683  tflops: 265.08  mfu: 26.80%
[rank2]:2025-11-04 09:31:40,006 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0599  memory: 38.93GiB(27.85%)  tps: 5,664  tflops: 264.16  mfu: 26.71%
[rank1]:2025-11-04 09:31:42,506 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0931_stage1_step1100.svg
[rank0]:2025-11-04 09:31:42,458 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0599  memory: 57.28GiB(40.97%)  tps: 5,927  tflops: 276.43  mfu: 27.95%
[rank0]:2025-11-04 09:31:42,508 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0931_stage0_step1100.svg
[rank2]:2025-11-04 09:31:42,508 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0931_stage2_step1100.svg
[rank3]:2025-11-04 09:31:42,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0931_real_step1100_rank3.svg
[rank3]:> Batch Time: 435.84 ms, GPU Bubble Ratio: 48.93%, 33.33%, 37.74%, 29.13%
[rank3]:2025-11-04 09:31:42,643 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0931_stage3_step1100.svg
[rank0]:2025-11-04 09:33:50,342 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:33:51,993 - INFO - Avg. fwd time: 16.1460 / Avg. bwd time: 30.0874 / Avg. batch time: 385.4831 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-11-04 09:33:52,011 - INFO - Avg. fwd time: 16.3414 / Avg. bwd time: 28.3723 / Avg. batch time: 474.9728 (ms) / GPU bubble ratio: 24.69%
[rank0]:2025-11-04 09:33:52,040 - INFO - Avg. fwd time: 14.1247 / Avg. bwd time: 23.8288 / Avg. batch time: 520.6881 (ms) / GPU bubble ratio: 41.69%
[rank2]:2025-11-04 09:33:52,006 - INFO - Avg. fwd time: 14.3382 / Avg. bwd time: 26.2227 / Avg. batch time: 429.0485 (ms) / GPU bubble ratio: 24.37%
[rank3]:2025-11-04 09:33:52,125 - INFO -  step: 1150  loss:  0.2262  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,997  tflops: 279.69  mfu: 28.28%
[rank1]:2025-11-04 09:33:52,124 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,997  tflops: 279.68  mfu: 28.28%
[rank2]:2025-11-04 09:33:54,969 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1318  memory: 38.93GiB(27.85%)  tps: 6,070  tflops: 283.10  mfu: 28.62%
[rank0]:2025-11-04 09:34:05,047 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1318  memory: 57.28GiB(40.97%)  tps: 5,745  tflops: 267.96  mfu: 27.09%
[rank0]:2025-11-04 09:36:12,837 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 09:36:14,610 - INFO - Avg. fwd time: 14.3786 / Avg. bwd time: 25.8852 / Avg. batch time: 425.7446 (ms) / GPU bubble ratio: 24.34%
[rank3]:2025-11-04 09:36:14,580 - INFO - Avg. fwd time: 16.1959 / Avg. bwd time: 29.6744 / Avg. batch time: 382.5735 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-11-04 09:36:14,638 - INFO - Avg. fwd time: 16.3900 / Avg. bwd time: 27.9381 / Avg. batch time: 471.2368 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-04 09:36:14,677 - INFO -  step: 1200  loss:  0.2859  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,747  tflops: 268.03  mfu: 27.10%
[rank3]:2025-11-04 09:36:14,677 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 09:36:14,675 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,747  tflops: 268.03  mfu: 27.10%
[rank1]:2025-11-04 09:36:14,675 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 09:36:14,671 - INFO - Avg. fwd time: 14.1594 / Avg. bwd time: 23.3249 / Avg. batch time: 516.6678 (ms) / GPU bubble ratio: 41.96%
[rank2]:2025-11-04 09:36:17,215 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0503  memory: 38.93GiB(27.85%)  tps: 5,759  tflops: 268.60  mfu: 27.16%
[rank2]:2025-11-04 09:36:17,215 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 09:36:22,314 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0503  memory: 57.28GiB(40.97%)  tps: 5,968  tflops: 278.35  mfu: 28.14%
[rank0]:2025-11-04 09:36:22,314 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 09:36:38,884 - INFO - validate step: 1200  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,719
[rank0]:2025-11-04 09:36:38,885 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 09:36:38,889 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-04 09:36:38,949 - INFO - validate step: 1200  loss:  0.2480  memory: 47.41GiB(33.91%)  tps: 16,877
[rank3]:2025-11-04 09:36:38,950 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 09:36:38,920 - INFO - validate step: 1200  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,895
[rank1]:2025-11-04 09:36:38,921 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 09:36:38,936 - INFO - validate step: 1200  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 18,858
[rank2]:2025-11-04 09:36:38,937 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 09:36:50,311 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.37 seconds.
[rank1]:2025-11-04 09:36:51,890 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.97 seconds.
[rank3]:2025-11-04 09:36:52,975 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.02 seconds.
[rank0]:2025-11-04 09:36:53,788 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 09:36:53,794 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.91 seconds.
[rank1]:2025-11-04 09:36:53,854 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0936_stage1_step1200.svg
[rank2]:2025-11-04 09:36:53,853 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0936_stage2_step1200.svg
[rank0]:2025-11-04 09:36:53,913 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0936_stage0_step1200.svg
[rank3]:2025-11-04 09:36:54,037 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0936_real_step1200_rank3.svg
[rank3]:> Batch Time: 428.75 ms, GPU Bubble Ratio: 49.93%, 32.91%, 36.87%, 29.12%
[rank3]:2025-11-04 09:36:54,097 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0936_stage3_step1200.svg
[rank0]:2025-11-04 09:39:16,127 - INFO - [GC] Peforming periodical GC collection 2.17 seconds
[rank2]:2025-11-04 09:39:17,784 - INFO - Avg. fwd time: 14.4076 / Avg. bwd time: 25.6202 / Avg. batch time: 423.2438 (ms) / GPU bubble ratio: 24.34%
[rank3]:2025-11-04 09:39:17,771 - INFO - Avg. fwd time: 16.2332 / Avg. bwd time: 29.3614 / Avg. batch time: 380.3640 (ms) / GPU bubble ratio: 4.10%
[rank0]:2025-11-04 09:39:17,818 - INFO - Avg. fwd time: 14.1863 / Avg. bwd time: 22.9276 / Avg. batch time: 513.5967 (ms) / GPU bubble ratio: 42.19%
[rank1]:2025-11-04 09:39:17,789 - INFO - Avg. fwd time: 16.4252 / Avg. bwd time: 27.5937 / Avg. batch time: 468.3893 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-11-04 09:39:17,901 - INFO -  step: 1250  loss:  0.2746  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,154  tflops: 240.37  mfu: 24.30%
[rank1]:2025-11-04 09:39:17,900 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,153  tflops: 240.33  mfu: 24.30%
[rank2]:2025-11-04 09:39:21,444 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1294  memory: 38.93GiB(27.85%)  tps: 5,041  tflops: 235.11  mfu: 23.77%
[rank0]:2025-11-04 09:39:30,851 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1294  memory: 57.28GiB(40.97%)  tps: 4,764  tflops: 222.18  mfu: 22.47%
[rank0]:2025-11-04 09:41:41,005 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:41:42,647 - INFO - Avg. fwd time: 16.2760 / Avg. bwd time: 29.0120 / Avg. batch time: 377.9070 (ms) / GPU bubble ratio: 4.13%
[rank1]:2025-11-04 09:41:42,666 - INFO - Avg. fwd time: 16.4658 / Avg. bwd time: 27.2231 / Avg. batch time: 465.2209 (ms) / GPU bubble ratio: 24.87%
[rank2]:2025-11-04 09:41:42,661 - INFO - Avg. fwd time: 14.4420 / Avg. bwd time: 25.3291 / Avg. batch time: 420.4459 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-11-04 09:41:42,694 - INFO - Avg. fwd time: 14.2153 / Avg. bwd time: 22.5001 / Avg. batch time: 510.1909 (ms) / GPU bubble ratio: 42.43%
[rank3]:2025-11-04 09:41:42,777 - INFO -  step: 1300  loss:  0.1879  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,655  tflops: 263.73  mfu: 26.67%
[rank1]:2025-11-04 09:41:42,776 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,655  tflops: 263.73  mfu: 26.67%
[rank2]:2025-11-04 09:41:45,405 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0364  memory: 38.93GiB(27.85%)  tps: 5,690  tflops: 265.40  mfu: 26.84%
[rank0]:2025-11-04 09:41:50,841 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0364  memory: 57.28GiB(40.97%)  tps: 5,852  tflops: 272.93  mfu: 27.60%
[rank2]:2025-11-04 09:41:50,895 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0941_stage2_step1300.svg
[rank0]:2025-11-04 09:41:50,895 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0941_stage0_step1300.svg
[rank1]:2025-11-04 09:41:50,894 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0941_stage1_step1300.svg
[rank3]:2025-11-04 09:41:50,985 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0941_real_step1300_rank3.svg
[rank3]:> Batch Time: 426.75 ms, GPU Bubble Ratio: 49.71%, 33.39%, 37.82%, 29.24%
[rank3]:2025-11-04 09:41:51,031 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0941_stage3_step1300.svg
[rank0]:2025-11-04 09:44:02,009 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:44:03,730 - INFO - Avg. fwd time: 16.3204 / Avg. bwd time: 28.6869 / Avg. batch time: 375.6592 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-11-04 09:44:03,761 - INFO - Avg. fwd time: 14.4764 / Avg. bwd time: 25.0604 / Avg. batch time: 417.9151 (ms) / GPU bubble ratio: 24.32%
[rank1]:2025-11-04 09:44:03,790 - INFO - Avg. fwd time: 16.5067 / Avg. bwd time: 26.8825 / Avg. batch time: 462.3560 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-11-04 09:44:03,823 - INFO - Avg. fwd time: 14.2444 / Avg. bwd time: 22.1143 / Avg. batch time: 507.1024 (ms) / GPU bubble ratio: 42.64%
[rank3]:2025-11-04 09:44:03,831 - INFO -  step: 1350  loss:  0.1301  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,808  tflops: 270.88  mfu: 27.39%
[rank1]:2025-11-04 09:44:03,829 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,808  tflops: 270.87  mfu: 27.39%
[rank2]:2025-11-04 09:44:08,531 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1228  memory: 38.93GiB(27.85%)  tps: 5,724  tflops: 266.95  mfu: 26.99%
[rank0]:2025-11-04 09:44:17,589 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1228  memory: 57.28GiB(40.97%)  tps: 5,582  tflops: 260.36  mfu: 26.33%
[rank0]:2025-11-04 09:46:27,577 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:46:29,265 - INFO - Avg. fwd time: 16.3492 / Avg. bwd time: 28.4263 / Avg. batch time: 373.8005 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-11-04 09:46:29,277 - INFO - Avg. fwd time: 14.4997 / Avg. bwd time: 24.8419 / Avg. batch time: 415.8005 (ms) / GPU bubble ratio: 24.31%
[rank1]:2025-11-04 09:46:29,282 - INFO - Avg. fwd time: 16.5336 / Avg. bwd time: 26.6085 / Avg. batch time: 459.9648 (ms) / GPU bubble ratio: 24.96%
[rank3]:2025-11-04 09:46:29,395 - INFO -  step: 1400  loss:  0.3784  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,628  tflops: 262.48  mfu: 26.54%
[rank3]:2025-11-04 09:46:29,396 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 09:46:29,310 - INFO - Avg. fwd time: 14.2636 / Avg. bwd time: 21.8004 / Avg. batch time: 504.5344 (ms) / GPU bubble ratio: 42.82%
[rank1]:2025-11-04 09:46:29,393 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,628  tflops: 262.48  mfu: 26.54%
[rank1]:2025-11-04 09:46:29,394 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-04 09:46:32,812 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0708  memory: 38.93GiB(27.85%)  tps: 5,678  tflops: 264.81  mfu: 26.78%
[rank2]:2025-11-04 09:46:32,812 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 09:46:36,983 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0708  memory: 57.28GiB(40.97%)  tps: 5,877  tflops: 274.10  mfu: 27.71%
[rank0]:2025-11-04 09:46:36,983 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 09:46:53,533 - INFO - validate step: 1400  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,749
[rank3]:2025-11-04 09:46:53,595 - INFO - validate step: 1400  loss:  0.2464  memory: 47.41GiB(33.91%)  tps: 16,927
[rank2]:2025-11-04 09:46:53,585 - INFO - validate step: 1400  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 19,718
[rank1]:2025-11-04 09:46:53,569 - INFO - validate step: 1400  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,943
[rank0]:2025-11-04 09:46:53,649 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0946_stage0_step1400.svg
[rank2]:2025-11-04 09:46:53,648 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0946_stage2_step1400.svg
[rank1]:2025-11-04 09:46:53,649 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0946_stage1_step1400.svg
[rank3]:2025-11-04 09:46:53,735 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0946_real_step1400_rank3.svg
[rank3]:> Batch Time: 431.39 ms, GPU Bubble Ratio: 49.20%, 33.49%, 37.67%, 29.16%
[rank3]:2025-11-04 09:46:53,782 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0946_stage3_step1400.svg
[rank0]:2025-11-04 09:49:07,805 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 09:49:09,456 - INFO - Avg. fwd time: 16.3918 / Avg. bwd time: 28.1491 / Avg. batch time: 371.9228 (ms) / GPU bubble ratio: 4.19%
[rank0]:2025-11-04 09:49:09,504 - INFO - Avg. fwd time: 14.2923 / Avg. bwd time: 21.4572 / Avg. batch time: 501.9388 (ms) / GPU bubble ratio: 43.02%
[rank2]:2025-11-04 09:49:09,470 - INFO - Avg. fwd time: 14.5331 / Avg. bwd time: 24.6181 / Avg. batch time: 413.6842 (ms) / GPU bubble ratio: 24.29%
[rank1]:2025-11-04 09:49:09,476 - INFO - Avg. fwd time: 16.5729 / Avg. bwd time: 26.3164 / Avg. batch time: 457.5607 (ms) / GPU bubble ratio: 25.01%
[rank3]:2025-11-04 09:49:09,589 - INFO -  step: 1450  loss:  0.1895  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,024  tflops: 280.96  mfu: 28.41%
[rank1]:2025-11-04 09:49:09,588 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,023  tflops: 280.90  mfu: 28.40%
[rank2]:2025-11-04 09:49:14,514 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0824  memory: 38.93GiB(27.85%)  tps: 5,813  tflops: 271.11  mfu: 27.41%
[rank0]:2025-11-04 09:49:23,922 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0824  memory: 57.28GiB(40.97%)  tps: 5,447  tflops: 254.06  mfu: 25.69%
[rank0]:2025-11-04 09:51:37,221 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:51:39,004 - INFO - Avg. fwd time: 16.4334 / Avg. bwd time: 27.8975 / Avg. batch time: 370.2418 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-11-04 09:51:39,034 - INFO - Avg. fwd time: 14.5647 / Avg. bwd time: 24.4063 / Avg. batch time: 411.7669 (ms) / GPU bubble ratio: 24.29%
[rank1]:2025-11-04 09:51:39,064 - INFO - Avg. fwd time: 16.6108 / Avg. bwd time: 26.0450 / Avg. batch time: 455.3796 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-11-04 09:51:39,101 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,479  tflops: 255.55  mfu: 25.84%
[rank0]:2025-11-04 09:51:39,097 - INFO - Avg. fwd time: 14.3199 / Avg. bwd time: 21.1352 / Avg. batch time: 499.5812 (ms) / GPU bubble ratio: 43.22%
[rank3]:2025-11-04 09:51:39,103 - INFO -  step: 1500  loss:  0.2718  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,479  tflops: 255.55  mfu: 25.84%
[rank2]:2025-11-04 09:51:42,826 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0630  memory: 38.93GiB(27.85%)  tps: 5,523  tflops: 257.62  mfu: 26.05%
[rank0]:2025-11-04 09:51:46,544 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0630  memory: 57.28GiB(40.97%)  tps: 5,744  tflops: 267.90  mfu: 27.09%
[rank1]:2025-11-04 09:51:46,598 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0951_stage1_step1500.svg
[rank2]:2025-11-04 09:51:46,597 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0951_stage2_step1500.svg
[rank0]:2025-11-04 09:51:46,598 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0951_stage0_step1500.svg
[rank3]:2025-11-04 09:51:46,683 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0951_real_step1500_rank3.svg
[rank3]:> Batch Time: 434.06 ms, GPU Bubble Ratio: 50.73%, 33.13%, 37.89%, 28.72%
[rank3]:2025-11-04 09:51:46,730 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0951_stage3_step1500.svg
[rank0]:2025-11-04 09:53:59,700 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:54:01,395 - INFO - Avg. fwd time: 16.4672 / Avg. bwd time: 27.6952 / Avg. batch time: 368.8943 (ms) / GPU bubble ratio: 4.23%
[rank1]:2025-11-04 09:54:01,413 - INFO - Avg. fwd time: 16.6415 / Avg. bwd time: 25.8277 / Avg. batch time: 453.6481 (ms) / GPU bubble ratio: 25.11%
[rank2]:2025-11-04 09:54:01,409 - INFO - Avg. fwd time: 14.5901 / Avg. bwd time: 24.2387 / Avg. batch time: 410.2487 (ms) / GPU bubble ratio: 24.28%
[rank0]:2025-11-04 09:54:01,443 - INFO - Avg. fwd time: 14.3422 / Avg. bwd time: 20.8841 / Avg. batch time: 497.7034 (ms) / GPU bubble ratio: 43.38%
[rank1]:2025-11-04 09:54:01,527 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,752  tflops: 268.26  mfu: 27.12%
[rank3]:2025-11-04 09:54:01,528 - INFO -  step: 1550  loss:  0.2906  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,752  tflops: 268.27  mfu: 27.13%
[rank2]:2025-11-04 09:54:05,229 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1674  memory: 38.93GiB(27.85%)  tps: 5,753  tflops: 268.31  mfu: 27.13%
[rank0]:2025-11-04 09:54:15,638 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1674  memory: 57.28GiB(40.97%)  tps: 5,495  tflops: 256.27  mfu: 25.91%
[rank0]:2025-11-04 09:56:27,989 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 09:56:29,669 - INFO - Avg. fwd time: 16.4986 / Avg. bwd time: 27.4620 / Avg. batch time: 367.2781 (ms) / GPU bubble ratio: 4.25%
[rank0]:2025-11-04 09:56:29,717 - INFO - Avg. fwd time: 14.3626 / Avg. bwd time: 20.6064 / Avg. batch time: 495.4807 (ms) / GPU bubble ratio: 43.54%
[rank2]:2025-11-04 09:56:29,684 - INFO - Avg. fwd time: 14.6144 / Avg. bwd time: 24.0514 / Avg. batch time: 408.4249 (ms) / GPU bubble ratio: 24.26%
[rank1]:2025-11-04 09:56:29,688 - INFO - Avg. fwd time: 16.6702 / Avg. bwd time: 25.5872 / Avg. batch time: 451.5848 (ms) / GPU bubble ratio: 25.14%
[rank3]:2025-11-04 09:56:29,800 - INFO -  step: 1600  loss:  0.4301  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,525  tflops: 257.69  mfu: 26.06%
[rank3]:2025-11-04 09:56:29,800 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 09:56:29,799 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,525  tflops: 257.69  mfu: 26.06%
[rank1]:2025-11-04 09:56:29,799 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 09:56:34,588 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0944  memory: 38.93GiB(27.85%)  tps: 5,485  tflops: 255.81  mfu: 25.87%
[rank2]:2025-11-04 09:56:34,588 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 09:56:37,818 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0944  memory: 57.28GiB(40.97%)  tps: 5,762  tflops: 268.73  mfu: 27.17%
[rank0]:2025-11-04 09:56:37,819 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 09:56:54,300 - INFO - validate step: 1600  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,853
[rank2]:2025-11-04 09:56:54,350 - INFO - validate step: 1600  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 20,727
[rank1]:2025-11-04 09:56:54,335 - INFO - validate step: 1600  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,694
[rank3]:2025-11-04 09:56:54,361 - INFO - validate step: 1600  loss:  0.2487  memory: 47.41GiB(33.91%)  tps: 16,677
[rank0]:2025-11-04 09:56:54,424 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_0956_stage0_step1600.svg
[rank2]:2025-11-04 09:56:54,416 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_0956_stage2_step1600.svg
[rank1]:2025-11-04 09:56:54,417 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_0956_stage1_step1600.svg
[rank3]:2025-11-04 09:56:54,500 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_0956_real_step1600_rank3.svg
[rank3]:> Batch Time: 429.88 ms, GPU Bubble Ratio: 49.42%, 32.71%, 36.80%, 29.59%
[rank3]:2025-11-04 09:56:54,548 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_0956_stage3_step1600.svg
[rank0]:2025-11-04 09:59:09,198 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 09:59:10,969 - INFO - Avg. fwd time: 16.5310 / Avg. bwd time: 27.2501 / Avg. batch time: 365.8402 (ms) / GPU bubble ratio: 4.26%
[rank2]:2025-11-04 09:59:11,004 - INFO - Avg. fwd time: 14.6391 / Avg. bwd time: 23.8747 / Avg. batch time: 406.8053 (ms) / GPU bubble ratio: 24.26%
[rank0]:2025-11-04 09:59:11,072 - INFO - Avg. fwd time: 14.3835 / Avg. bwd time: 20.3498 / Avg. batch time: 493.5060 (ms) / GPU bubble ratio: 43.70%
[rank3]:2025-11-04 09:59:11,080 - INFO -  step: 1650  loss:  0.4236  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,992  tflops: 279.47  mfu: 28.26%
[rank1]:2025-11-04 09:59:11,036 - INFO - Avg. fwd time: 16.6988 / Avg. bwd time: 25.3623 / Avg. batch time: 449.7444 (ms) / GPU bubble ratio: 25.18%
[rank1]:2025-11-04 09:59:11,078 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,991  tflops: 279.41  mfu: 28.25%
[rank2]:2025-11-04 09:59:14,542 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1593  memory: 38.93GiB(27.85%)  tps: 5,843  tflops: 272.54  mfu: 27.56%
[rank0]:2025-11-04 09:59:25,828 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.1593  memory: 57.28GiB(40.97%)  tps: 5,406  tflops: 252.15  mfu: 25.50%
[rank0]:2025-11-04 10:01:38,949 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:01:40,650 - INFO - Avg. fwd time: 16.5565 / Avg. bwd time: 27.0783 / Avg. batch time: 364.6694 (ms) / GPU bubble ratio: 4.28%
[rank0]:2025-11-04 10:01:40,696 - INFO - Avg. fwd time: 14.3999 / Avg. bwd time: 20.1393 / Avg. batch time: 491.8701 (ms) / GPU bubble ratio: 43.82%
[rank1]:2025-11-04 10:01:40,666 - INFO - Avg. fwd time: 16.7217 / Avg. bwd time: 25.1808 / Avg. batch time: 448.2239 (ms) / GPU bubble ratio: 25.21%
[rank2]:2025-11-04 10:01:40,662 - INFO - Avg. fwd time: 14.6588 / Avg. bwd time: 23.7306 / Avg. batch time: 405.4645 (ms) / GPU bubble ratio: 24.26%
[rank3]:2025-11-04 10:01:40,779 - INFO -  step: 1700  loss:  0.4147  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,472  tflops: 255.23  mfu: 25.81%
[rank1]:2025-11-04 10:01:40,777 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,472  tflops: 255.23  mfu: 25.81%
[rank2]:2025-11-04 10:01:43,403 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0778  memory: 38.93GiB(27.85%)  tps: 5,503  tflops: 256.67  mfu: 25.95%
[rank0]:2025-11-04 10:01:48,916 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0778  memory: 57.28GiB(40.97%)  tps: 5,725  tflops: 267.02  mfu: 27.00%
[rank0]:2025-11-04 10:01:48,971 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1001_stage0_step1700.svg
[rank1]:2025-11-04 10:01:48,971 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1001_stage1_step1700.svg
[rank2]:2025-11-04 10:01:48,970 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1001_stage2_step1700.svg
[rank3]:2025-11-04 10:01:49,063 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1001_real_step1700_rank3.svg
[rank3]:> Batch Time: 430.66 ms, GPU Bubble Ratio: 48.51%, 32.98%, 37.24%, 29.57%
[rank3]:2025-11-04 10:01:49,111 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1001_stage3_step1700.svg
[rank0]:2025-11-04 10:04:02,854 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 10:04:04,579 - INFO - Avg. fwd time: 16.7463 / Avg. bwd time: 24.9800 / Avg. batch time: 446.5767 (ms) / GPU bubble ratio: 25.25%
[rank2]:2025-11-04 10:04:04,574 - INFO - Avg. fwd time: 14.6796 / Avg. bwd time: 23.5794 / Avg. batch time: 404.0159 (ms) / GPU bubble ratio: 24.24%
[rank0]:2025-11-04 10:04:04,608 - INFO - Avg. fwd time: 14.4176 / Avg. bwd time: 19.9043 / Avg. batch time: 490.0969 (ms) / GPU bubble ratio: 43.98%
[rank3]:2025-11-04 10:04:04,562 - INFO - Avg. fwd time: 16.5842 / Avg. bwd time: 26.8897 / Avg. batch time: 363.3812 (ms) / GPU bubble ratio: 4.29%
[rank3]:2025-11-04 10:04:04,693 - INFO -  step: 1750  loss:  0.4319  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,692  tflops: 265.49  mfu: 26.84%
[rank1]:2025-11-04 10:04:04,691 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,692  tflops: 265.49  mfu: 26.84%
[rank2]:2025-11-04 10:04:09,617 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1697  memory: 38.93GiB(27.85%)  tps: 5,603  tflops: 261.31  mfu: 26.42%
[rank0]:2025-11-04 10:04:17,601 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1697  memory: 57.28GiB(40.97%)  tps: 5,510  tflops: 256.97  mfu: 25.98%
[rank0]:2025-11-04 10:06:29,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:06:30,693 - INFO - Avg. fwd time: 16.5999 / Avg. bwd time: 26.7058 / Avg. batch time: 362.0322 (ms) / GPU bubble ratio: 4.31%
[rank2]:2025-11-04 10:06:30,726 - INFO - Avg. fwd time: 14.6925 / Avg. bwd time: 23.4287 / Avg. batch time: 402.4870 (ms) / GPU bubble ratio: 24.23%
[rank1]:2025-11-04 10:06:30,757 - INFO - Avg. fwd time: 16.7610 / Avg. bwd time: 24.7855 / Avg. batch time: 444.8506 (ms) / GPU bubble ratio: 25.28%
[rank1]:2025-11-04 10:06:30,797 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,607  tflops: 261.51  mfu: 26.44%
[rank1]:2025-11-04 10:06:30,797 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 10:06:30,793 - INFO - Avg. fwd time: 14.4284 / Avg. bwd time: 19.6812 / Avg. batch time: 488.2509 (ms) / GPU bubble ratio: 44.11%
[rank3]:2025-11-04 10:06:30,798 - INFO -  step: 1800  loss:  0.0690  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,607  tflops: 261.51  mfu: 26.44%
[rank3]:2025-11-04 10:06:30,798 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-04 10:06:35,692 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0249  memory: 38.93GiB(27.85%)  tps: 5,608  tflops: 261.56  mfu: 26.45%
[rank2]:2025-11-04 10:06:35,692 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 10:06:38,701 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0249  memory: 57.28GiB(40.97%)  tps: 5,806  tflops: 270.78  mfu: 27.38%
[rank0]:2025-11-04 10:06:38,701 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 10:06:55,228 - INFO - validate step: 1800  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,784
[rank3]:2025-11-04 10:06:55,294 - INFO - validate step: 1800  loss:  0.2451  memory: 47.41GiB(33.91%)  tps: 16,722
[rank2]:2025-11-04 10:06:55,279 - INFO - validate step: 1800  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 20,912
[rank1]:2025-11-04 10:06:55,262 - INFO - validate step: 1800  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,742
[rank0]:2025-11-04 10:06:55,348 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1006_stage0_step1800.svg
[rank2]:2025-11-04 10:06:55,348 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1006_stage2_step1800.svg
[rank1]:2025-11-04 10:06:55,349 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1006_stage1_step1800.svg
[rank3]:2025-11-04 10:06:55,437 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1006_real_step1800_rank3.svg
[rank3]:> Batch Time: 417.23 ms, GPU Bubble Ratio: 49.18%, 32.90%, 36.72%, 29.34%
[rank3]:2025-11-04 10:06:55,485 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1006_stage3_step1800.svg
[rank0]:2025-11-04 10:09:08,335 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 10:09:09,964 - INFO - Avg. fwd time: 16.6116 / Avg. bwd time: 26.5565 / Avg. batch time: 360.9291 (ms) / GPU bubble ratio: 4.32%
[rank0]:2025-11-04 10:09:10,009 - INFO - Avg. fwd time: 14.4357 / Avg. bwd time: 19.5045 / Avg. batch time: 486.7340 (ms) / GPU bubble ratio: 44.22%
[rank2]:2025-11-04 10:09:09,975 - INFO - Avg. fwd time: 14.7023 / Avg. bwd time: 23.3018 / Avg. batch time: 401.2362 (ms) / GPU bubble ratio: 24.23%
[rank1]:2025-11-04 10:09:09,980 - INFO - Avg. fwd time: 16.7719 / Avg. bwd time: 24.6261 / Avg. batch time: 443.4362 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-11-04 10:09:10,092 - INFO -  step: 1850  loss:  0.3751  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,077  tflops: 283.45  mfu: 28.66%
[rank1]:2025-11-04 10:09:10,090 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,076  tflops: 283.38  mfu: 28.65%
[rank2]:2025-11-04 10:09:13,728 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1143  memory: 38.93GiB(27.85%)  tps: 5,917  tflops: 275.97  mfu: 27.90%
[rank0]:2025-11-04 10:09:23,720 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1143  memory: 57.28GiB(40.97%)  tps: 5,517  tflops: 257.31  mfu: 26.02%
[rank0]:2025-11-04 10:11:32,976 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 10:11:34,607 - INFO - Avg. fwd time: 16.7815 / Avg. bwd time: 24.4488 / Avg. batch time: 441.7932 (ms) / GPU bubble ratio: 25.34%
[rank3]:2025-11-04 10:11:34,590 - INFO - Avg. fwd time: 16.6218 / Avg. bwd time: 26.3845 / Avg. batch time: 359.6303 (ms) / GPU bubble ratio: 4.33%
[rank0]:2025-11-04 10:11:34,636 - INFO - Avg. fwd time: 14.4422 / Avg. bwd time: 19.3027 / Avg. batch time: 484.9639 (ms) / GPU bubble ratio: 44.33%
[rank2]:2025-11-04 10:11:34,603 - INFO - Avg. fwd time: 14.7111 / Avg. bwd time: 23.1636 / Avg. batch time: 399.7772 (ms) / GPU bubble ratio: 24.21%
[rank1]:2025-11-04 10:11:34,714 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,664  tflops: 264.19  mfu: 26.71%
[rank3]:2025-11-04 10:11:34,715 - INFO -  step: 1900  loss:  0.2065  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,664  tflops: 264.19  mfu: 26.71%
[rank2]:2025-11-04 10:11:39,172 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0263  memory: 38.93GiB(27.85%)  tps: 5,632  tflops: 262.70  mfu: 26.56%
[rank0]:2025-11-04 10:11:42,870 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0263  memory: 57.28GiB(40.97%)  tps: 5,887  tflops: 274.58  mfu: 27.76%
[rank1]:2025-11-04 10:11:42,925 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1011_stage1_step1900.svg
[rank0]:2025-11-04 10:11:42,925 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1011_stage0_step1900.svg
[rank2]:2025-11-04 10:11:42,925 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1011_stage2_step1900.svg
[rank3]:2025-11-04 10:11:43,011 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1011_real_step1900_rank3.svg
[rank3]:> Batch Time: 420.38 ms, GPU Bubble Ratio: 49.58%, 32.90%, 37.17%, 29.25%
[rank3]:2025-11-04 10:11:43,057 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1011_stage3_step1900.svg
[rank0]:2025-11-04 10:13:52,069 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:13:53,766 - INFO - Avg. fwd time: 16.6299 / Avg. bwd time: 26.2228 / Avg. batch time: 358.3973 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-11-04 10:13:53,801 - INFO - Avg. fwd time: 14.7184 / Avg. bwd time: 23.0262 / Avg. batch time: 398.3910 (ms) / GPU bubble ratio: 24.21%
[rank1]:2025-11-04 10:13:53,833 - INFO - Avg. fwd time: 16.7893 / Avg. bwd time: 24.2794 / Avg. batch time: 440.2325 (ms) / GPU bubble ratio: 25.37%
[rank0]:2025-11-04 10:13:53,870 - INFO - Avg. fwd time: 14.4478 / Avg. bwd time: 19.1109 / Avg. batch time: 483.2821 (ms) / GPU bubble ratio: 44.45%
[rank3]:2025-11-04 10:13:53,877 - INFO -  step: 1950  loss:  0.1675  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,887  tflops: 274.56  mfu: 27.76%
[rank1]:2025-11-04 10:13:53,876 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,887  tflops: 274.56  mfu: 27.76%
[rank2]:2025-11-04 10:13:58,999 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0452  memory: 38.93GiB(27.85%)  tps: 5,859  tflops: 273.25  mfu: 27.63%
[rank0]:2025-11-04 10:14:07,343 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0452  memory: 57.28GiB(40.97%)  tps: 5,670  tflops: 264.46  mfu: 26.74%
[rank0]:2025-11-04 10:16:15,360 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:16:16,987 - INFO - Avg. fwd time: 16.6362 / Avg. bwd time: 26.0866 / Avg. batch time: 357.3548 (ms) / GPU bubble ratio: 4.36%
[rank1]:2025-11-04 10:16:17,002 - INFO - Avg. fwd time: 16.7958 / Avg. bwd time: 24.1416 / Avg. batch time: 438.9068 (ms) / GPU bubble ratio: 25.38%
[rank2]:2025-11-04 10:16:16,998 - INFO - Avg. fwd time: 14.7245 / Avg. bwd time: 22.9165 / Avg. batch time: 397.2086 (ms) / GPU bubble ratio: 24.19%
[rank3]:2025-11-04 10:16:17,111 - INFO -  step: 2000  loss:  0.2023  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,719  tflops: 266.75  mfu: 26.97%
[rank3]:2025-11-04 10:16:17,111 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 10:16:17,030 - INFO - Avg. fwd time: 14.4521 / Avg. bwd time: 18.9539 / Avg. batch time: 481.8581 (ms) / GPU bubble ratio: 44.54%
[rank1]:2025-11-04 10:16:17,109 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,719  tflops: 266.75  mfu: 26.97%
[rank1]:2025-11-04 10:16:17,109 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-04 10:16:21,736 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0249  memory: 38.93GiB(27.85%)  tps: 5,739  tflops: 267.68  mfu: 27.07%
[rank2]:2025-11-04 10:16:21,736 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 10:16:25,237 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0249  memory: 57.28GiB(40.97%)  tps: 5,941  tflops: 277.08  mfu: 28.02%
[rank0]:2025-11-04 10:16:25,238 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 10:16:41,675 - INFO - validate step: 2000  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,920
[rank1]:2025-11-04 10:16:41,709 - INFO - validate step: 2000  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,650
[rank2]:2025-11-04 10:16:41,725 - INFO - validate step: 2000  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 20,491
[rank3]:2025-11-04 10:16:41,740 - INFO - validate step: 2000  loss:  0.2406  memory: 47.41GiB(33.91%)  tps: 16,632
[rank0]:2025-11-04 10:16:41,796 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1016_stage0_step2000.svg
[rank1]:2025-11-04 10:16:41,798 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1016_stage1_step2000.svg
[rank2]:2025-11-04 10:16:41,795 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1016_stage2_step2000.svg
[rank3]:2025-11-04 10:16:41,880 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1016_real_step2000_rank3.svg
[rank3]:> Batch Time: 421.64 ms, GPU Bubble Ratio: 49.22%, 33.20%, 37.05%, 29.33%
[rank3]:2025-11-04 10:16:41,928 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1016_stage3_step2000.svg
[rank0]:2025-11-04 10:18:52,704 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 10:18:54,321 - INFO - Avg. fwd time: 16.6436 / Avg. bwd time: 25.9404 / Avg. batch time: 356.2407 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-11-04 10:18:54,335 - INFO - Avg. fwd time: 14.7315 / Avg. bwd time: 22.7967 / Avg. batch time: 395.9558 (ms) / GPU bubble ratio: 24.18%
[rank1]:2025-11-04 10:18:54,340 - INFO - Avg. fwd time: 16.8034 / Avg. bwd time: 23.9883 / Avg. batch time: 437.4953 (ms) / GPU bubble ratio: 25.41%
[rank0]:2025-11-04 10:18:54,367 - INFO - Avg. fwd time: 14.4570 / Avg. bwd time: 18.7789 / Avg. batch time: 480.3347 (ms) / GPU bubble ratio: 44.65%
[rank1]:2025-11-04 10:18:54,443 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,172  tflops: 287.85  mfu: 29.11%
[rank3]:2025-11-04 10:18:54,445 - INFO -  step: 2050  loss:  0.2247  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,173  tflops: 287.92  mfu: 29.11%
[rank2]:2025-11-04 10:18:58,951 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0808  memory: 38.93GiB(27.85%)  tps: 5,970  tflops: 278.43  mfu: 28.15%
[rank0]:2025-11-04 10:19:08,721 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0808  memory: 57.28GiB(40.97%)  tps: 5,571  tflops: 259.83  mfu: 26.27%
[rank0]:2025-11-04 10:21:16,536 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:21:18,202 - INFO - Avg. fwd time: 16.6504 / Avg. bwd time: 25.8006 / Avg. batch time: 355.1736 (ms) / GPU bubble ratio: 4.38%
[rank1]:2025-11-04 10:21:18,271 - INFO - Avg. fwd time: 16.8105 / Avg. bwd time: 23.8435 / Avg. batch time: 436.1425 (ms) / GPU bubble ratio: 25.43%
[rank1]:2025-11-04 10:21:18,312 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,694  tflops: 265.57  mfu: 26.85%
[rank2]:2025-11-04 10:21:18,238 - INFO - Avg. fwd time: 14.7378 / Avg. bwd time: 22.6822 / Avg. batch time: 394.7518 (ms) / GPU bubble ratio: 24.16%
[rank0]:2025-11-04 10:21:18,308 - INFO - Avg. fwd time: 14.4616 / Avg. bwd time: 18.6139 / Avg. batch time: 478.8723 (ms) / GPU bubble ratio: 44.74%
[rank3]:2025-11-04 10:21:18,313 - INFO -  step: 2100  loss:  0.2292  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,694  tflops: 265.58  mfu: 26.85%
[rank2]:2025-11-04 10:21:23,060 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0320  memory: 38.93GiB(27.85%)  tps: 5,685  tflops: 265.13  mfu: 26.81%
[rank0]:2025-11-04 10:21:26,427 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0320  memory: 57.28GiB(40.97%)  tps: 5,949  tflops: 277.46  mfu: 28.05%
[rank1]:2025-11-04 10:21:26,476 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1021_stage1_step2100.svg
[rank2]:2025-11-04 10:21:26,477 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1021_stage2_step2100.svg
[rank3]:2025-11-04 10:21:26,564 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1021_real_step2100_rank3.svg
[rank3]:> Batch Time: 419.09 ms, GPU Bubble Ratio: 49.16%, 32.47%, 36.79%, 29.54%
[rank0]:2025-11-04 10:21:26,480 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1021_stage0_step2100.svg
[rank3]:2025-11-04 10:21:26,607 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1021_stage3_step2100.svg
[rank0]:2025-11-04 10:23:34,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 10:23:36,120 - INFO - Avg. fwd time: 14.7428 / Avg. bwd time: 22.5879 / Avg. batch time: 393.7736 (ms) / GPU bubble ratio: 24.16%
[rank1]:2025-11-04 10:23:36,124 - INFO - Avg. fwd time: 16.8166 / Avg. bwd time: 23.7247 / Avg. batch time: 435.0413 (ms) / GPU bubble ratio: 25.45%
[rank3]:2025-11-04 10:23:36,106 - INFO - Avg. fwd time: 16.6565 / Avg. bwd time: 25.6855 / Avg. batch time: 354.2981 (ms) / GPU bubble ratio: 4.39%
[rank0]:2025-11-04 10:23:36,152 - INFO - Avg. fwd time: 14.4657 / Avg. bwd time: 18.4802 / Avg. batch time: 477.6816 (ms) / GPU bubble ratio: 44.82%
[rank1]:2025-11-04 10:23:36,231 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank3]:2025-11-04 10:23:36,233 - INFO -  step: 2150  loss:  0.1856  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,940  tflops: 277.03  mfu: 28.01%
[rank2]:2025-11-04 10:23:40,850 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0640  memory: 38.93GiB(27.85%)  tps: 5,945  tflops: 277.29  mfu: 28.04%
[rank0]:2025-11-04 10:23:50,754 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0640  memory: 57.28GiB(40.97%)  tps: 5,676  tflops: 264.73  mfu: 26.77%
[rank0]:2025-11-04 10:25:59,337 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 10:26:00,959 - INFO - Avg. fwd time: 14.7486 / Avg. bwd time: 22.4830 / Avg. batch time: 392.6394 (ms) / GPU bubble ratio: 24.14%
[rank1]:2025-11-04 10:26:00,963 - INFO - Avg. fwd time: 16.8231 / Avg. bwd time: 23.5928 / Avg. batch time: 433.7695 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-11-04 10:26:00,944 - INFO - Avg. fwd time: 16.6626 / Avg. bwd time: 25.5531 / Avg. batch time: 353.2855 (ms) / GPU bubble ratio: 4.40%
[rank0]:2025-11-04 10:26:00,991 - INFO - Avg. fwd time: 14.4697 / Avg. bwd time: 18.3294 / Avg. batch time: 476.3169 (ms) / GPU bubble ratio: 44.91%
[rank1]:2025-11-04 10:26:01,067 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,656  tflops: 263.80  mfu: 26.67%
[rank1]:2025-11-04 10:26:01,067 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 10:26:01,068 - INFO -  step: 2200  loss:  0.1814  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,656  tflops: 263.80  mfu: 26.67%
[rank3]:2025-11-04 10:26:01,068 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-04 10:26:06,080 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0245  memory: 38.93GiB(27.85%)  tps: 5,641  tflops: 263.09  mfu: 26.60%
[rank2]:2025-11-04 10:26:06,080 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 10:26:08,805 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0245  memory: 57.28GiB(40.97%)  tps: 5,934  tflops: 276.76  mfu: 27.98%
[rank0]:2025-11-04 10:26:08,806 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 10:26:25,322 - INFO - validate step: 2200  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,801
[rank2]:2025-11-04 10:26:25,373 - INFO - validate step: 2200  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 21,231
[rank1]:2025-11-04 10:26:25,356 - INFO - validate step: 2200  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,863
[rank3]:2025-11-04 10:26:25,382 - INFO - validate step: 2200  loss:  0.2399  memory: 47.41GiB(33.91%)  tps: 16,847
[rank0]:2025-11-04 10:26:25,441 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1026_stage0_step2200.svg
[rank2]:2025-11-04 10:26:25,432 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1026_stage2_step2200.svg
[rank1]:2025-11-04 10:26:25,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1026_stage1_step2200.svg
[rank3]:2025-11-04 10:26:25,527 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1026_real_step2200_rank3.svg
[rank3]:> Batch Time: 421.83 ms, GPU Bubble Ratio: 49.48%, 32.79%, 36.59%, 29.18%
[rank3]:2025-11-04 10:26:25,571 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1026_stage3_step2200.svg
[rank0]:2025-11-04 10:28:37,057 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 10:28:38,740 - INFO - Avg. fwd time: 16.6685 / Avg. bwd time: 25.4308 / Avg. batch time: 352.3511 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-11-04 10:28:38,776 - INFO - Avg. fwd time: 14.7545 / Avg. bwd time: 22.3842 / Avg. batch time: 391.6014 (ms) / GPU bubble ratio: 24.13%
[rank3]:2025-11-04 10:28:38,857 - INFO -  step: 2250  loss:  0.2278  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,138  tflops: 286.26  mfu: 28.94%
[rank0]:2025-11-04 10:28:38,850 - INFO - Avg. fwd time: 14.4737 / Avg. bwd time: 18.1893 / Avg. batch time: 475.0645 (ms) / GPU bubble ratio: 45.00%
[rank1]:2025-11-04 10:28:38,810 - INFO - Avg. fwd time: 16.8291 / Avg. bwd time: 23.4669 / Avg. batch time: 432.6011 (ms) / GPU bubble ratio: 25.48%
[rank1]:2025-11-04 10:28:38,855 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,136  tflops: 286.20  mfu: 28.94%
[rank2]:2025-11-04 10:28:42,285 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0859  memory: 38.93GiB(27.85%)  tps: 5,983  tflops: 279.07  mfu: 28.22%
[rank0]:2025-11-04 10:28:53,218 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0859  memory: 57.28GiB(40.97%)  tps: 5,539  tflops: 258.34  mfu: 26.12%
[rank0]:2025-11-04 10:31:02,692 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 10:31:04,319 - INFO - Avg. fwd time: 16.8342 / Avg. bwd time: 23.3637 / Avg. batch time: 431.6363 (ms) / GPU bubble ratio: 25.50%
[rank2]:2025-11-04 10:31:04,314 - INFO - Avg. fwd time: 14.7588 / Avg. bwd time: 22.3054 / Avg. batch time: 390.7439 (ms) / GPU bubble ratio: 24.12%
[rank3]:2025-11-04 10:31:04,300 - INFO - Avg. fwd time: 16.6737 / Avg. bwd time: 25.3305 / Avg. batch time: 351.5873 (ms) / GPU bubble ratio: 4.42%
[rank0]:2025-11-04 10:31:04,349 - INFO - Avg. fwd time: 14.4771 / Avg. bwd time: 18.0724 / Avg. batch time: 474.0239 (ms) / GPU bubble ratio: 45.07%
[rank1]:2025-11-04 10:31:04,420 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,628  tflops: 262.48  mfu: 26.54%
[rank3]:2025-11-04 10:31:04,424 - INFO -  step: 2300  loss:  0.1983  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,628  tflops: 262.48  mfu: 26.54%
[rank2]:2025-11-04 10:31:09,477 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0385  memory: 38.93GiB(27.85%)  tps: 5,566  tflops: 259.58  mfu: 26.25%
[rank0]:2025-11-04 10:31:12,442 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0385  memory: 57.28GiB(40.97%)  tps: 5,884  tflops: 274.43  mfu: 27.75%
[rank0]:2025-11-04 10:31:12,495 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1031_stage0_step2300.svg
[rank1]:2025-11-04 10:31:12,492 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1031_stage1_step2300.svg
[rank2]:2025-11-04 10:31:12,495 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1031_stage2_step2300.svg
[rank3]:2025-11-04 10:31:12,587 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1031_real_step2300_rank3.svg
[rank3]:> Batch Time: 423.88 ms, GPU Bubble Ratio: 49.55%, 33.36%, 36.47%, 29.45%
[rank3]:2025-11-04 10:31:12,632 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1031_stage3_step2300.svg
[rank0]:2025-11-04 10:33:22,438 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 10:33:24,082 - INFO - Avg. fwd time: 14.7637 / Avg. bwd time: 22.2153 / Avg. batch time: 389.7787 (ms) / GPU bubble ratio: 24.10%
[rank3]:2025-11-04 10:33:24,068 - INFO - Avg. fwd time: 16.6796 / Avg. bwd time: 25.2176 / Avg. batch time: 350.7294 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-11-04 10:33:24,115 - INFO - Avg. fwd time: 14.4808 / Avg. bwd time: 17.9454 / Avg. batch time: 472.8579 (ms) / GPU bubble ratio: 45.14%
[rank1]:2025-11-04 10:33:24,086 - INFO - Avg. fwd time: 16.8402 / Avg. bwd time: 23.2482 / Avg. batch time: 430.5514 (ms) / GPU bubble ratio: 25.51%
[rank3]:2025-11-04 10:33:24,192 - INFO -  step: 2350  loss:  0.1850  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,861  tflops: 273.37  mfu: 27.64%
[rank1]:2025-11-04 10:33:24,191 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,861  tflops: 273.36  mfu: 27.64%
[rank2]:2025-11-04 10:33:27,900 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0481  memory: 38.93GiB(27.85%)  tps: 5,918  tflops: 276.02  mfu: 27.91%
[rank0]:2025-11-04 10:33:37,918 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0481  memory: 57.28GiB(40.97%)  tps: 5,631  tflops: 262.64  mfu: 26.56%
[rank0]:2025-11-04 10:35:46,958 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 10:35:48,691 - INFO - Avg. fwd time: 14.7685 / Avg. bwd time: 22.1268 / Avg. batch time: 388.8349 (ms) / GPU bubble ratio: 24.09%
[rank3]:2025-11-04 10:35:48,655 - INFO - Avg. fwd time: 16.6854 / Avg. bwd time: 25.1081 / Avg. batch time: 349.8969 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-11-04 10:35:48,727 - INFO - Avg. fwd time: 16.8459 / Avg. bwd time: 23.1374 / Avg. batch time: 429.4940 (ms) / GPU bubble ratio: 25.52%
[rank1]:2025-11-04 10:35:48,770 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,666  tflops: 264.27  mfu: 26.72%
[rank1]:2025-11-04 10:35:48,771 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 10:35:48,767 - INFO - Avg. fwd time: 14.4842 / Avg. bwd time: 17.8206 / Avg. batch time: 471.7176 (ms) / GPU bubble ratio: 45.21%
[rank3]:2025-11-04 10:35:48,773 - INFO -  step: 2400  loss:  0.1915  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,666  tflops: 264.27  mfu: 26.72%
[rank3]:2025-11-04 10:35:48,774 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 10:35:52,212 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0230  memory: 38.93GiB(27.85%)  tps: 5,677  tflops: 264.76  mfu: 26.77%
[rank2]:2025-11-04 10:35:52,212 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 10:35:56,638 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0230  memory: 57.28GiB(40.97%)  tps: 5,905  tflops: 275.43  mfu: 27.85%
[rank0]:2025-11-04 10:35:56,638 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 10:36:13,182 - INFO - validate step: 2400  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,760
[rank0]:2025-11-04 10:36:13,183 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 10:36:13,190 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-04 10:36:13,233 - INFO - validate step: 2400  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 19,485
[rank2]:2025-11-04 10:36:13,234 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 10:36:13,248 - INFO - validate step: 2400  loss:  0.2383  memory: 47.41GiB(33.91%)  tps: 16,736
[rank3]:2025-11-04 10:36:13,250 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 10:36:13,218 - INFO - validate step: 2400  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,755
[rank1]:2025-11-04 10:36:13,219 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 10:36:23,528 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.29 seconds.
[rank1]:2025-11-04 10:36:25,299 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.08 seconds.
[rank3]:2025-11-04 10:36:25,634 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.38 seconds.
[rank0]:2025-11-04 10:36:27,608 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 10:36:27,620 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.44 seconds.
[rank1]:2025-11-04 10:36:27,760 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1036_stage1_step2400.svg
[rank0]:2025-11-04 10:36:27,760 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1036_stage0_step2400.svg
[rank2]:2025-11-04 10:36:27,761 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1036_stage2_step2400.svg
[rank3]:2025-11-04 10:36:27,893 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1036_real_step2400_rank3.svg
[rank3]:> Batch Time: 420.59 ms, GPU Bubble Ratio: 49.38%, 32.96%, 37.10%, 29.31%
[rank3]:2025-11-04 10:36:27,976 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1036_stage3_step2400.svg
[rank0]:2025-11-04 10:38:44,868 - INFO - [GC] Peforming periodical GC collection 2.03 seconds
[rank3]:2025-11-04 10:38:46,493 - INFO - Avg. fwd time: 16.6901 / Avg. bwd time: 25.0187 / Avg. batch time: 349.2172 (ms) / GPU bubble ratio: 4.45%
[rank0]:2025-11-04 10:38:46,536 - INFO - Avg. fwd time: 14.4878 / Avg. bwd time: 17.7209 / Avg. batch time: 470.8064 (ms) / GPU bubble ratio: 45.27%
[rank1]:2025-11-04 10:38:46,509 - INFO - Avg. fwd time: 16.8506 / Avg. bwd time: 23.0473 / Avg. batch time: 428.6390 (ms) / GPU bubble ratio: 25.54%
[rank2]:2025-11-04 10:38:46,503 - INFO - Avg. fwd time: 14.7724 / Avg. bwd time: 22.0529 / Avg. batch time: 388.0746 (ms) / GPU bubble ratio: 24.09%
[rank1]:2025-11-04 10:38:46,612 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,341  tflops: 249.08  mfu: 25.19%
[rank3]:2025-11-04 10:38:46,613 - INFO -  step: 2450  loss:  0.2356  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,342  tflops: 249.13  mfu: 25.19%
[rank2]:2025-11-04 10:38:50,167 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0740  memory: 38.93GiB(27.85%)  tps: 5,220  tflops: 243.46  mfu: 24.62%
[rank0]:2025-11-04 10:39:00,240 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0740  memory: 57.28GiB(40.97%)  tps: 4,904  tflops: 228.71  mfu: 23.13%
[rank0]:2025-11-04 10:41:08,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 10:41:10,263 - INFO - Avg. fwd time: 16.8562 / Avg. bwd time: 22.9453 / Avg. batch time: 427.6911 (ms) / GPU bubble ratio: 25.55%
[rank2]:2025-11-04 10:41:10,256 - INFO - Avg. fwd time: 14.7771 / Avg. bwd time: 21.9727 / Avg. batch time: 387.2324 (ms) / GPU bubble ratio: 24.08%
[rank3]:2025-11-04 10:41:10,241 - INFO - Avg. fwd time: 16.6957 / Avg. bwd time: 24.9207 / Avg. batch time: 348.4756 (ms) / GPU bubble ratio: 4.46%
[rank0]:2025-11-04 10:41:10,289 - INFO - Avg. fwd time: 14.4913 / Avg. bwd time: 17.6067 / Avg. batch time: 469.7804 (ms) / GPU bubble ratio: 45.34%
[rank1]:2025-11-04 10:41:10,364 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank3]:2025-11-04 10:41:10,366 - INFO -  step: 2500  loss:  0.2160  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank2]:2025-11-04 10:41:15,979 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0342  memory: 38.93GiB(27.85%)  tps: 5,618  tflops: 262.04  mfu: 26.49%
[rank0]:2025-11-04 10:41:18,394 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0342  memory: 57.28GiB(40.97%)  tps: 5,930  tflops: 276.56  mfu: 27.96%
[rank0]:2025-11-04 10:41:18,448 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1041_stage0_step2500.svg
[rank1]:2025-11-04 10:41:18,449 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1041_stage1_step2500.svg
[rank2]:2025-11-04 10:41:18,447 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1041_stage2_step2500.svg
[rank3]:2025-11-04 10:41:18,536 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1041_real_step2500_rank3.svg
[rank3]:> Batch Time: 421.84 ms, GPU Bubble Ratio: 49.94%, 33.06%, 36.90%, 29.18%
[rank3]:2025-11-04 10:41:18,582 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1041_stage3_step2500.svg
[rank0]:2025-11-04 10:43:28,256 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:43:30,016 - INFO - Avg. fwd time: 16.7057 / Avg. bwd time: 24.8325 / Avg. batch time: 347.8495 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-11-04 10:43:30,052 - INFO - Avg. fwd time: 14.7850 / Avg. bwd time: 21.8993 / Avg. batch time: 386.5275 (ms) / GPU bubble ratio: 24.07%
[rank1]:2025-11-04 10:43:30,089 - INFO - Avg. fwd time: 16.8651 / Avg. bwd time: 22.8506 / Avg. batch time: 426.8923 (ms) / GPU bubble ratio: 25.57%
[rank1]:2025-11-04 10:43:30,135 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,861  tflops: 273.36  mfu: 27.64%
[rank3]:2025-11-04 10:43:30,137 - INFO -  step: 2550  loss:  0.4626  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,861  tflops: 273.36  mfu: 27.64%
[rank0]:2025-11-04 10:43:30,129 - INFO - Avg. fwd time: 14.4974 / Avg. bwd time: 17.4999 / Avg. batch time: 468.9235 (ms) / GPU bubble ratio: 45.41%
[rank2]:2025-11-04 10:43:34,392 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1399  memory: 38.93GiB(27.85%)  tps: 5,919  tflops: 276.04  mfu: 27.91%
[rank0]:2025-11-04 10:43:43,714 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1399  memory: 57.28GiB(40.97%)  tps: 5,637  tflops: 262.92  mfu: 26.58%
[rank0]:2025-11-04 10:45:54,383 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:45:56,020 - INFO - Avg. fwd time: 16.7155 / Avg. bwd time: 24.7572 / Avg. batch time: 347.3244 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-11-04 10:45:56,035 - INFO - Avg. fwd time: 14.7926 / Avg. bwd time: 21.8380 / Avg. batch time: 385.9267 (ms) / GPU bubble ratio: 24.07%
[rank1]:2025-11-04 10:45:56,042 - INFO - Avg. fwd time: 16.8738 / Avg. bwd time: 22.7728 / Avg. batch time: 426.2139 (ms) / GPU bubble ratio: 25.58%
[rank0]:2025-11-04 10:45:56,069 - INFO - Avg. fwd time: 14.5037 / Avg. bwd time: 17.4090 / Avg. batch time: 468.1961 (ms) / GPU bubble ratio: 45.47%
[rank3]:2025-11-04 10:45:56,143 - INFO -  step: 2600  loss:  0.4020  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,611  tflops: 261.69  mfu: 26.46%
[rank3]:2025-11-04 10:45:56,143 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-04 10:45:56,141 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,611  tflops: 261.69  mfu: 26.46%
[rank1]:2025-11-04 10:45:56,141 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-04 10:46:00,514 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0578  memory: 38.93GiB(27.85%)  tps: 5,606  tflops: 261.48  mfu: 26.44%
[rank2]:2025-11-04 10:46:00,515 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 10:46:04,356 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0578  memory: 57.28GiB(40.97%)  tps: 5,825  tflops: 271.67  mfu: 27.47%
[rank0]:2025-11-04 10:46:04,357 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-04 10:46:20,902 - INFO - validate step: 2600  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,542
[rank0]:2025-11-04 10:46:20,869 - INFO - validate step: 2600  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,806
[rank3]:2025-11-04 10:46:20,944 - INFO - validate step: 2600  loss:  0.2406  memory: 47.41GiB(33.91%)  tps: 16,516
[rank2]:2025-11-04 10:46:20,922 - INFO - validate step: 2600  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 20,072
[rank2]:2025-11-04 10:46:20,996 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1046_stage2_step2600.svg
[rank1]:2025-11-04 10:46:20,999 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1046_stage1_step2600.svg
[rank0]:2025-11-04 10:46:21,007 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1046_stage0_step2600.svg
[rank3]:2025-11-04 10:46:21,089 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1046_real_step2600_rank3.svg
[rank3]:> Batch Time: 425.33 ms, GPU Bubble Ratio: 48.57%, 32.79%, 37.15%, 29.41%
[rank3]:2025-11-04 10:46:21,137 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1046_stage3_step2600.svg
[rank0]:2025-11-04 10:48:32,800 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 10:48:34,461 - INFO - Avg. fwd time: 16.7260 / Avg. bwd time: 24.6716 / Avg. batch time: 346.7227 (ms) / GPU bubble ratio: 4.48%
[rank1]:2025-11-04 10:48:34,480 - INFO - Avg. fwd time: 16.8836 / Avg. bwd time: 22.6860 / Avg. batch time: 425.4425 (ms) / GPU bubble ratio: 25.59%
[rank2]:2025-11-04 10:48:34,473 - INFO - Avg. fwd time: 14.8012 / Avg. bwd time: 21.7697 / Avg. batch time: 385.2431 (ms) / GPU bubble ratio: 24.06%
[rank0]:2025-11-04 10:48:34,508 - INFO - Avg. fwd time: 14.5110 / Avg. bwd time: 17.3067 / Avg. batch time: 467.3703 (ms) / GPU bubble ratio: 45.54%
[rank3]:2025-11-04 10:48:34,586 - INFO -  step: 2650  loss:  0.3227  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,130  tflops: 285.90  mfu: 28.91%
[rank1]:2025-11-04 10:48:34,585 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,128  tflops: 285.81  mfu: 28.90%
[rank2]:2025-11-04 10:48:38,381 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0567  memory: 38.93GiB(27.85%)  tps: 5,960  tflops: 277.96  mfu: 28.10%
[rank0]:2025-11-04 10:48:48,693 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0567  memory: 57.28GiB(40.97%)  tps: 5,542  tflops: 258.47  mfu: 26.13%
[rank0]:2025-11-04 10:50:59,094 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:51:00,828 - INFO - Avg. fwd time: 16.7362 / Avg. bwd time: 24.5942 / Avg. batch time: 346.1845 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-11-04 10:51:00,864 - INFO - Avg. fwd time: 14.8092 / Avg. bwd time: 21.7018 / Avg. batch time: 384.6342 (ms) / GPU bubble ratio: 24.06%
[rank0]:2025-11-04 10:51:00,938 - INFO - Avg. fwd time: 14.5175 / Avg. bwd time: 17.2073 / Avg. batch time: 466.6249 (ms) / GPU bubble ratio: 45.61%
[rank1]:2025-11-04 10:51:00,898 - INFO - Avg. fwd time: 16.8929 / Avg. bwd time: 22.6022 / Avg. batch time: 424.7515 (ms) / GPU bubble ratio: 25.61%
[rank1]:2025-11-04 10:51:00,942 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,597  tflops: 261.06  mfu: 26.40%
[rank3]:2025-11-04 10:51:00,943 - INFO -  step: 2700  loss:  0.3561  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,597  tflops: 261.06  mfu: 26.40%
[rank2]:2025-11-04 10:51:04,514 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0471  memory: 38.93GiB(27.85%)  tps: 5,606  tflops: 261.46  mfu: 26.44%
[rank2]:2025-11-04 10:51:07,559 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1051_stage2_step2700.svg
[rank0]:2025-11-04 10:51:07,504 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0471  memory: 57.28GiB(40.97%)  tps: 5,902  tflops: 275.25  mfu: 27.83%
[rank0]:2025-11-04 10:51:07,559 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1051_stage0_step2700.svg
[rank1]:2025-11-04 10:51:07,561 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1051_stage1_step2700.svg
[rank3]:2025-11-04 10:51:07,648 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1051_real_step2700_rank3.svg
[rank3]:> Batch Time: 426.11 ms, GPU Bubble Ratio: 50.40%, 32.98%, 37.83%, 28.91%
[rank3]:2025-11-04 10:51:07,693 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1051_stage3_step2700.svg
[rank0]:2025-11-04 10:53:19,461 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 10:53:21,133 - INFO - Avg. fwd time: 16.7447 / Avg. bwd time: 24.5292 / Avg. batch time: 345.7315 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-11-04 10:53:21,148 - INFO - Avg. fwd time: 14.8158 / Avg. bwd time: 21.6483 / Avg. batch time: 384.1234 (ms) / GPU bubble ratio: 24.06%
[rank0]:2025-11-04 10:53:21,181 - INFO - Avg. fwd time: 14.5231 / Avg. bwd time: 17.1275 / Avg. batch time: 466.0015 (ms) / GPU bubble ratio: 45.66%
[rank1]:2025-11-04 10:53:21,153 - INFO - Avg. fwd time: 16.9006 / Avg. bwd time: 22.5328 / Avg. batch time: 424.1716 (ms) / GPU bubble ratio: 25.63%
[rank1]:2025-11-04 10:53:21,258 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,838  tflops: 272.30  mfu: 27.53%
[rank3]:2025-11-04 10:53:21,260 - INFO -  step: 2750  loss:  0.2975  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,838  tflops: 272.30  mfu: 27.53%
[rank2]:2025-11-04 10:53:24,426 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0640  memory: 38.93GiB(27.85%)  tps: 5,855  tflops: 273.08  mfu: 27.61%
[rank0]:2025-11-04 10:53:36,102 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0640  memory: 57.28GiB(40.97%)  tps: 5,513  tflops: 257.12  mfu: 26.00%
[rank0]:2025-11-04 10:55:47,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 10:55:49,513 - INFO - Avg. fwd time: 14.8235 / Avg. bwd time: 21.5855 / Avg. batch time: 383.5444 (ms) / GPU bubble ratio: 24.06%
[rank1]:2025-11-04 10:55:49,520 - INFO - Avg. fwd time: 16.9094 / Avg. bwd time: 22.4549 / Avg. batch time: 423.5146 (ms) / GPU bubble ratio: 25.64%
[rank3]:2025-11-04 10:55:49,497 - INFO - Avg. fwd time: 16.7542 / Avg. bwd time: 24.4558 / Avg. batch time: 345.2193 (ms) / GPU bubble ratio: 4.50%
[rank0]:2025-11-04 10:55:49,546 - INFO - Avg. fwd time: 14.5294 / Avg. bwd time: 17.0358 / Avg. batch time: 465.2883 (ms) / GPU bubble ratio: 45.73%
[rank1]:2025-11-04 10:55:49,618 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,522  tflops: 257.53  mfu: 26.04%
[rank1]:2025-11-04 10:55:49,619 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-04 10:55:49,620 - INFO -  step: 2800  loss:  0.2937  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,522  tflops: 257.54  mfu: 26.04%
[rank3]:2025-11-04 10:55:49,620 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-04 10:55:55,980 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0490  memory: 38.93GiB(27.85%)  tps: 5,405  tflops: 252.11  mfu: 25.49%
[rank2]:2025-11-04 10:55:55,980 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 10:55:56,789 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0490  memory: 57.28GiB(40.97%)  tps: 5,823  tflops: 271.58  mfu: 27.46%
[rank0]:2025-11-04 10:55:56,789 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 10:56:13,311 - INFO - validate step: 2800  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,792
[rank1]:2025-11-04 10:56:13,345 - INFO - validate step: 2800  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 17,263
[rank3]:2025-11-04 10:56:13,383 - INFO - validate step: 2800  loss:  0.2396  memory: 47.41GiB(33.91%)  tps: 17,238
[rank0]:2025-11-04 10:56:13,436 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1056_stage0_step2800.svg
[rank2]:2025-11-04 10:56:13,363 - INFO - validate step: 2800  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 23,564
[rank2]:2025-11-04 10:56:13,435 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1056_stage2_step2800.svg
[rank1]:2025-11-04 10:56:13,436 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1056_stage1_step2800.svg
[rank3]:2025-11-04 10:56:13,524 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1056_real_step2800_rank3.svg
[rank3]:> Batch Time: 427.45 ms, GPU Bubble Ratio: 50.29%, 33.15%, 36.95%, 29.12%
[rank3]:2025-11-04 10:56:13,570 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1056_stage3_step2800.svg
[rank0]:2025-11-04 10:58:26,037 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 10:58:27,788 - INFO - Avg. fwd time: 16.7637 / Avg. bwd time: 24.3833 / Avg. batch time: 344.7149 (ms) / GPU bubble ratio: 4.51%
[rank2]:2025-11-04 10:58:27,827 - INFO - Avg. fwd time: 14.8309 / Avg. bwd time: 21.5276 / Avg. batch time: 382.9765 (ms) / GPU bubble ratio: 24.05%
[rank1]:2025-11-04 10:58:27,866 - INFO - Avg. fwd time: 16.9187 / Avg. bwd time: 22.3800 / Avg. batch time: 422.8737 (ms) / GPU bubble ratio: 25.65%
[rank0]:2025-11-04 10:58:27,909 - INFO - Avg. fwd time: 14.5359 / Avg. bwd time: 16.9502 / Avg. batch time: 464.5966 (ms) / GPU bubble ratio: 45.78%
[rank1]:2025-11-04 10:58:27,915 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 6,088  tflops: 283.93  mfu: 28.71%
[rank3]:2025-11-04 10:58:27,917 - INFO -  step: 2850  loss:  0.4095  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 6,089  tflops: 284.00  mfu: 28.72%
[rank2]:2025-11-04 10:58:34,743 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1213  memory: 38.93GiB(27.85%)  tps: 5,794  tflops: 270.25  mfu: 27.33%
[rank0]:2025-11-04 10:58:41,185 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1213  memory: 57.28GiB(40.97%)  tps: 5,540  tflops: 258.38  mfu: 26.13%
[rank0]:2025-11-04 11:00:52,247 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:00:53,904 - INFO - Avg. fwd time: 16.7713 / Avg. bwd time: 24.3255 / Avg. batch time: 344.3125 (ms) / GPU bubble ratio: 4.51%
[rank0]:2025-11-04 11:00:53,953 - INFO - Avg. fwd time: 14.5406 / Avg. bwd time: 16.8790 / Avg. batch time: 464.0366 (ms) / GPU bubble ratio: 45.83%
[rank2]:2025-11-04 11:00:53,918 - INFO - Avg. fwd time: 14.8368 / Avg. bwd time: 21.4772 / Avg. batch time: 382.5192 (ms) / GPU bubble ratio: 24.05%
[rank1]:2025-11-04 11:00:53,923 - INFO - Avg. fwd time: 16.9258 / Avg. bwd time: 22.3179 / Avg. batch time: 422.3543 (ms) / GPU bubble ratio: 25.67%
[rank3]:2025-11-04 11:00:54,026 - INFO -  step: 2900  loss:  0.3911  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,607  tflops: 261.50  mfu: 26.44%
[rank1]:2025-11-04 11:00:54,025 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,607  tflops: 261.50  mfu: 26.44%
[rank2]:2025-11-04 11:00:59,659 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0462  memory: 38.93GiB(27.85%)  tps: 5,653  tflops: 263.65  mfu: 26.66%
[rank0]:2025-11-04 11:01:02,262 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0462  memory: 57.28GiB(40.97%)  tps: 5,807  tflops: 270.83  mfu: 27.38%
[rank0]:2025-11-04 11:01:02,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1101_stage0_step2900.svg
[rank2]:2025-11-04 11:01:02,318 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1100_stage2_step2900.svg
[rank1]:2025-11-04 11:01:02,319 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1100_stage1_step2900.svg
[rank3]:2025-11-04 11:01:02,403 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1100_real_step2900_rank3.svg
[rank3]:> Batch Time: 428.22 ms, GPU Bubble Ratio: 48.77%, 33.36%, 37.62%, 29.18%
[rank3]:2025-11-04 11:01:02,450 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1100_stage3_step2900.svg
[rank0]:2025-11-04 11:03:13,770 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:03:15,464 - INFO - Avg. fwd time: 14.8438 / Avg. bwd time: 21.4225 / Avg. batch time: 382.0011 (ms) / GPU bubble ratio: 24.05%
[rank1]:2025-11-04 11:03:15,466 - INFO - Avg. fwd time: 16.9341 / Avg. bwd time: 22.2480 / Avg. batch time: 421.7658 (ms) / GPU bubble ratio: 25.68%
[rank3]:2025-11-04 11:03:15,450 - INFO - Avg. fwd time: 16.7804 / Avg. bwd time: 24.2599 / Avg. batch time: 343.8599 (ms) / GPU bubble ratio: 4.52%
[rank0]:2025-11-04 11:03:15,498 - INFO - Avg. fwd time: 14.5463 / Avg. bwd time: 16.7993 / Avg. batch time: 463.4044 (ms) / GPU bubble ratio: 45.89%
[rank1]:2025-11-04 11:03:15,572 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,787  tflops: 269.93  mfu: 27.29%
[rank3]:2025-11-04 11:03:15,573 - INFO -  step: 2950  loss:  0.4370  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,788  tflops: 269.93  mfu: 27.29%
[rank2]:2025-11-04 11:03:18,879 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1546  memory: 38.93GiB(27.85%)  tps: 5,884  tflops: 274.44  mfu: 27.75%
[rank0]:2025-11-04 11:03:30,089 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1546  memory: 57.28GiB(40.97%)  tps: 5,542  tflops: 258.46  mfu: 26.13%
[rank0]:2025-11-04 11:05:41,670 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:05:43,436 - INFO - Avg. fwd time: 14.8505 / Avg. bwd time: 21.3673 / Avg. batch time: 381.5087 (ms) / GPU bubble ratio: 24.05%
[rank3]:2025-11-04 11:05:43,396 - INFO - Avg. fwd time: 16.7889 / Avg. bwd time: 24.1974 / Avg. batch time: 343.4275 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-11-04 11:05:43,475 - INFO - Avg. fwd time: 16.9420 / Avg. bwd time: 22.1801 / Avg. batch time: 421.2076 (ms) / GPU bubble ratio: 25.70%
[rank1]:2025-11-04 11:05:43,524 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 48.19GiB(34.47%)  tps: 5,537  tflops: 258.24  mfu: 26.11%
[rank1]:2025-11-04 11:05:43,524 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 5,832  tflops: 271.99  mfu: 26.87%
[rank1]:2025-11-04 11:05:43,524 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-04 11:05:43,525 - INFO -  step: 3000  loss:  0.3576  grad_norm:  0.0000  memory: 47.41GiB(33.91%)  tps: 5,537  tflops: 258.25  mfu: 26.11%
[rank3]:2025-11-04 11:05:43,526 - INFO -  final step: 3000  loss:  0.3576  grad_norm:  0.0000  tps: 5,832  tflops: 272.02  mfu: 26.88%
[rank3]:2025-11-04 11:05:43,526 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 11:05:43,519 - INFO - Avg. fwd time: 14.5517 / Avg. bwd time: 16.7197 / Avg. batch time: 462.8010 (ms) / GPU bubble ratio: 45.94%
[rank2]:2025-11-04 11:05:47,068 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0570  memory: 38.93GiB(27.85%)  tps: 5,528  tflops: 257.83  mfu: 26.07%
[rank2]:2025-11-04 11:05:47,068 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0570  tps: 5,794  tflops: 270.23  mfu: 26.70%
[rank2]:2025-11-04 11:05:47,068 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 11:05:51,455 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0570  memory: 57.28GiB(40.97%)  tps: 5,795  tflops: 270.28  mfu: 27.33%
[rank0]:2025-11-04 11:05:51,455 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0570  tps: 5,761  tflops: 268.68  mfu: 26.57%
[rank0]:2025-11-04 11:05:51,455 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 11:06:08,013 - INFO - validate step: 3000  loss: -1.0000  memory: 57.28GiB(40.97%)  tps: 24,738
[rank0]:2025-11-04 11:06:08,014 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 11:06:08,019 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-04 11:06:08,050 - INFO - validate step: 3000  loss: -1.0000  memory: 48.19GiB(34.47%)  tps: 16,700
[rank1]:2025-11-04 11:06:08,052 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 11:06:08,054 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-04 11:06:08,077 - INFO - validate step: 3000  loss:  0.2415  memory: 47.41GiB(33.91%)  tps: 16,684
[rank3]:2025-11-04 11:06:08,078 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 11:06:08,081 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-04 11:06:08,063 - INFO - validate step: 3000  loss: -1.0000  memory: 38.93GiB(27.85%)  tps: 19,510
[rank2]:2025-11-04 11:06:08,064 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 11:06:08,067 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 11:06:17,819 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-04 11:06:17,923 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank1/251104_1106_stage1_final3000.svg
[rank3]:2025-11-04 11:06:18,001 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1106_real_final3000_rank3.svg
[rank3]:> Batch Time: 429.05 ms, GPU Bubble Ratio: 49.27%, 33.49%, 37.25%, 29.41%
[rank2]:2025-11-04 11:06:17,913 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank2/251104_1106_stage2_final3000.svg
[rank0]:2025-11-04 11:06:17,938 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank0/251104_1106_stage0_final3000.svg
[rank2]:2025-11-04 11:06:18,094 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251104_1106_rank2_stage2.svg
[rank2]:	> Counts Sum: 1409000, Total Sum: 5829120 (24.17%), Ratio(%) per element: [22.03, 22.48, 23.32, 21.98, 22.48, 24.11, 21.73, 31.96, 31.17, 21.68, 23.86, 23.07, 22.13, 22.92, 22.18, 22.92, 30.68, 29.74, 21.19, 22.03, 22.43, 21.29, 21.54, 22.48, 23.81, 30.92, 30.38, 22.82, 22.48, 21.49, 22.52, 22.62, 22.23, 22.33, 29.34, 32.85, 23.02, 21.88, 21.68, 21.88, 21.93, 22.57, 22.82, 29.84, 29.64, 22.43, 22.38, 21.39, 22.62, 22.67, 22.18, 22.72, 29.94, 30.18, 21.88, 21.73, 21.98, 21.29, 21.49, 22.72, 22.52, 28.4, 30.83, 21.98, 22.38, 21.59, 22.48, 23.02, 23.07, 22.97, 31.12, 31.62]
[rank2]:2025-11-04 11:06:18,094 - INFO - Destroying the purge thread.
[rank1]:2025-11-04 11:06:18,202 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251104_1106_rank1_stage1.svg
[rank1]:	> Counts Sum: 926080, Total Sum: 6557760 (14.12%), Ratio(%) per element: [13.63, 13.83, 13.63, 13.58, 13.73, 13.88, 13.63, 15.41, 15.11, 14.17, 13.63, 14.03, 13.98, 13.83, 13.88, 14.03, 15.01, 15.11, 13.88, 13.63, 13.73, 14.03, 13.78, 13.88, 13.73, 15.16, 15.11, 14.13, 13.48, 13.48, 13.93, 13.78, 13.58, 13.83, 15.31, 15.41, 13.73, 13.63, 13.53, 13.48, 13.53, 13.78, 13.83, 15.31, 15.36, 13.63, 13.73, 13.88, 13.83, 13.88, 14.22, 13.73, 15.16, 15.36, 13.78, 13.63, 13.93, 14.03, 13.83, 13.63, 14.08, 15.26, 15.56, 13.53, 13.93, 13.48, 13.93, 13.78, 13.83, 14.17, 15.26, 15.26, 13.48, 13.93, 13.73, 13.53, 13.83, 14.03, 13.73, 15.26, 15.46]
[rank1]:2025-11-04 11:06:18,203 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 11:06:18,139 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/pipeline_schedule/251104_1106_thry_final3000_rank3.svg
[rank3]:> Batch Time: 530.14 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-04 11:06:18,186 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/freeze_ratio_history/rank3/251104_1106_stage3_final3000.svg
[rank0]:2025-11-04 11:06:18,156 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251104_1106_rank0_stage0.svg
[rank0]:	> Counts Sum: 3123760, Total Sum: 5910080 (52.85%), Ratio(%) per element: [45.65, 44.56, 45.5, 46.64, 45.65, 46.29, 45.84, 46.39, 79.0, 46.88, 46.54, 46.24, 45.99, 46.14, 45.89, 45.94, 46.39, 77.27, 73.02, 46.98, 46.29, 47.43, 46.29, 46.54, 45.5, 46.29, 79.05, 79.44, 47.08, 46.19, 46.54, 45.45, 46.44, 46.59, 45.55, 79.49, 78.9, 45.94, 46.59, 46.24, 46.49, 45.94, 46.83, 46.24, 79.39, 78.7, 45.7, 45.94, 46.29, 46.19, 46.54, 46.93, 46.04, 78.7, 78.8, 46.49, 45.84, 47.38, 46.09, 45.89, 45.8, 45.84, 78.95, 79.24, 47.18, 46.39, 46.19, 45.05, 46.54, 46.14, 46.88, 77.96, 78.85]
[rank0]:2025-11-04 11:06:18,156 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 11:06:18,358 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200/frozen_params_histogram/251104_1106_rank3_stage3.svg
[rank3]:	> Counts Sum: 606880, Total Sum: 5262400 (11.53%), Ratio(%) per element: [11.01, 11.31, 11.01, 10.27, 11.75, 11.06, 10.62, 12.94, 12.59, 11.36, 11.7, 11.41, 11.36, 10.77, 10.91, 11.66, 13.14, 12.3, 10.96, 10.72, 10.91, 10.52, 11.16, 11.95, 11.21, 13.24, 12.64, 11.85, 10.96, 10.67, 11.16, 11.21, 12.0, 10.77, 12.74, 12.4, 11.36, 11.11, 10.22, 10.86, 11.11, 11.01, 10.77, 12.94, 12.89, 10.96, 11.36, 11.75, 11.31, 11.61, 11.16, 11.26, 12.94, 12.64, 11.36, 10.96, 10.67, 10.96, 11.41, 11.01, 11.01, 13.09, 12.84, 13.24, 11.21]
[rank3]:2025-11-04 11:06:18,358 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 60-60, summary, console lines 435-442
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.80914
[rank3]:wandb:               final/avg_loss 0.35764
[rank3]:wandb:             final/avg_mfu(%) 26.87579
[rank3]:wandb:             final/avg_tflops 272.02354
[rank3]:wandb:    final/avg_throughput(tps) 5832.38866
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.35764
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.35764
[rank3]:wandb: loss_metrics/global_max_loss 0.35764
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/9suer7ce
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_timelyapf_h200/20251104-0837/wandb/run-20251104_083711-9suer7ce/logs
[rank0]:2025-11-04 11:06:20,156 - INFO - Training completed
[rank0]:2025-11-04 11:06:20,157 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 11:06:20,373 - INFO - Process group destroyed
[rank1]:2025-11-04 11:06:20,395 - INFO - Process group destroyed
[rank2]:2025-11-04 11:06:20,406 - INFO - Process group destroyed
[rank0]:2025-11-04 11:06:20,550 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.20', 'layers.17', 'layers.22', 'layers.21', 'layers.18', 'layers.19', 'layers.23'}
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.13', 'layers.16', 'layers.15', 'layers.12', 'layers.9', 'layers.14', 'layers.8', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.1', 'tok_embeddings', 'layers.6', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.26', 'layers.30', 'layers.29', 'layers.28', 'layers.25', 'layers.31', 'layers.27'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyapf_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
