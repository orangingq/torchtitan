
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 13:23:11 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 13:23:12.930000 757538 site-packages/torch/distributed/run.py:811] 
W1102 13:23:12.930000 757538 site-packages/torch/distributed/run.py:811] *****************************************
W1102 13:23:12.930000 757538 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 13:23:12.930000 757538 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-02 13:23:20,199 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 13:23:20,318 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 13:23:20,288 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 13:23:20,440 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 13:23:21,183 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 13:23:21,185 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 13:23:21,383 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 13:23:21,385 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 13:23:21,377 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 13:23:21,379 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 13:23:21,384 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-02 13:23:21,348 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 13:23:21,351 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 13:23:23,217 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 13:23:23,509 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-02 13:23:25,316 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-02 13:23:25,577 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 13:23:25,643 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-11-02 13:23:25,565 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 13:23:25,667 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 13:23:25,667 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 13:23:25,655 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 13:23:25,655 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-02 13:23:25,933 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 13:23:25,934 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-11-02 13:23:25,907 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 13:23:25,907 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 13:23:26,084 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 13:23:26,155 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 13:23:26,155 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 13:23:26,356 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 13:23:26,357 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ulcmlivj
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_fullrand7_h200/20251102-1323/wandb/run-20251102_132326-ulcmlivj
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_fullrand7_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ulcmlivj
[rank3]:2025-11-02 13:23:27,626 - INFO - WandB logging enabled
[rank3]:2025-11-02 13:23:27,635 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 13:23:27,707 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 13:23:27,708 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-02 13:23:27,919 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 13:23:27,920 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 13:23:27,931 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 13:23:27,931 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_fullrand7_h200
[rank0]:2025-11-02 13:23:27,931 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 13:23:27,932 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-02 13:23:27,931 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 13:23:27,948 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 13:23:31,944 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 13:23:31,944 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 13:23:40,862 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-02 13:23:40,862 - INFO - Finished loading the checkpoint in 8.92 seconds.
[rank0]:2025-11-02 13:23:40,862 - INFO - Training starts at step 1
[rank0]:2025-11-02 13:23:44,792 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 856  tflops: 39.90  mfu: 4.03%
[rank0]:2025-11-02 13:23:44,792 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 13:23:44,820 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 956  tflops: 44.59  mfu: 4.51%
[rank3]:2025-11-02 13:23:44,820 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 13:23:44,773 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 879  tflops: 40.99  mfu: 4.14%
[rank1]:2025-11-02 13:23:44,773 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 13:23:44,783 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 855  tflops: 39.90  mfu: 4.03%
[rank2]:2025-11-02 13:23:44,783 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 13:25:51,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:25:53,990 - INFO - Avg. fwd time: 14.6998 / Avg. bwd time: 42.2313 / Avg. batch time: 473.2912 (ms) / GPU bubble ratio: 3.77%
[rank1]:2025-11-02 13:25:54,065 - INFO - Avg. fwd time: 15.1549 / Avg. bwd time: 41.1471 / Avg. batch time: 585.0088 (ms) / GPU bubble ratio: 23.01%
[rank2]:2025-11-02 13:25:54,020 - INFO - Avg. fwd time: 13.1161 / Avg. bwd time: 36.0001 / Avg. batch time: 525.7646 (ms) / GPU bubble ratio: 25.27%
[rank0]:2025-11-02 13:25:54,098 - INFO - Avg. fwd time: 13.3183 / Avg. bwd time: 37.9323 / Avg. batch time: 640.1404 (ms) / GPU bubble ratio: 35.95%
[rank3]:2025-11-02 13:25:54,221 - INFO -  step: 50  loss: 12.7701  grad_norm: 7266.1904  memory: 46.16GiB(33.01%)  tps: 6,204  tflops: 289.36  mfu: 29.26%
[rank0]:2025-11-02 13:25:54,223 - INFO -  step: 50  loss: -4.0000  grad_norm: 7266.1904  memory: 54.93GiB(39.29%)  tps: 6,203  tflops: 289.29  mfu: 29.25%
[rank1]:2025-11-02 13:25:54,219 - INFO -  step: 50  loss: -4.0000  grad_norm: 7266.1904  memory: 47.26GiB(33.80%)  tps: 6,202  tflops: 289.26  mfu: 29.25%
[rank2]:2025-11-02 13:25:54,217 - INFO -  step: 50  loss: -4.0000  grad_norm: 7266.1904  memory: 38.72GiB(27.69%)  tps: 6,203  tflops: 289.29  mfu: 29.25%
[rank0]:2025-11-02 13:28:03,525 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:28:05,950 - INFO - Avg. fwd time: 14.7383 / Avg. bwd time: 42.3492 / Avg. batch time: 473.2937 (ms) / GPU bubble ratio: 3.51%
[rank2]:2025-11-02 13:28:05,979 - INFO - Avg. fwd time: 13.1122 / Avg. bwd time: 36.0501 / Avg. batch time: 525.4860 (ms) / GPU bubble ratio: 25.16%
[rank0]:2025-11-02 13:28:06,057 - INFO - Avg. fwd time: 13.2374 / Avg. bwd time: 37.9901 / Avg. batch time: 639.1847 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 13:28:06,025 - INFO - Avg. fwd time: 15.0844 / Avg. bwd time: 41.1899 / Avg. batch time: 584.4233 (ms) / GPU bubble ratio: 22.97%
[rank2]:2025-11-02 13:28:06,177 - INFO -  step: 100  loss: -4.0000  grad_norm: 69.7703  memory: 38.72GiB(27.69%)  tps: 6,208  tflops: 289.54  mfu: 29.28%
[rank2]:2025-11-02 13:28:06,177 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:28:06,183 - INFO -  step: 100  loss: -4.0000  grad_norm: 69.7703  memory: 54.93GiB(39.29%)  tps: 6,208  tflops: 289.54  mfu: 29.28%
[rank0]:2025-11-02 13:28:06,184 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 13:28:06,179 - INFO -  step: 100  loss: -4.0000  grad_norm: 69.7703  memory: 47.26GiB(33.80%)  tps: 6,208  tflops: 289.54  mfu: 29.28%
[rank1]:2025-11-02 13:28:06,179 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 13:28:06,181 - INFO -  step: 100  loss:  4.4186  grad_norm: 69.7703  memory: 46.16GiB(33.01%)  tps: 6,208  tflops: 289.54  mfu: 29.28%
[rank3]:2025-11-02 13:28:06,182 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:30:15,415 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:30:17,937 - INFO - Avg. fwd time: 14.7301 / Avg. bwd time: 42.3703 / Avg. batch time: 473.0215 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-11-02 13:30:17,978 - INFO - Avg. fwd time: 13.0868 / Avg. bwd time: 36.0770 / Avg. batch time: 525.1184 (ms) / GPU bubble ratio: 25.10%
[rank0]:2025-11-02 13:30:18,067 - INFO - Avg. fwd time: 13.2134 / Avg. bwd time: 38.0215 / Avg. batch time: 638.6306 (ms) / GPU bubble ratio: 35.82%
[rank1]:2025-11-02 13:30:18,024 - INFO - Avg. fwd time: 15.0425 / Avg. bwd time: 41.2020 / Avg. batch time: 583.9566 (ms) / GPU bubble ratio: 22.95%
[rank2]:2025-11-02 13:30:18,095 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.9683  memory: 38.72GiB(27.69%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank0]:2025-11-02 13:30:18,102 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.9683  memory: 54.93GiB(39.29%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank3]:2025-11-02 13:30:18,100 - INFO -  step: 150  loss:  1.2527  grad_norm: 19.9683  memory: 46.16GiB(33.01%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank1]:2025-11-02 13:30:18,098 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.9683  memory: 47.26GiB(33.80%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank0]:2025-11-02 13:32:27,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:32:29,589 - INFO - Avg. fwd time: 14.7168 / Avg. bwd time: 42.3691 / Avg. batch time: 472.7433 (ms) / GPU bubble ratio: 3.40%
[rank1]:2025-11-02 13:32:29,664 - INFO - Avg. fwd time: 15.0229 / Avg. bwd time: 41.2105 / Avg. batch time: 583.5721 (ms) / GPU bubble ratio: 22.91%
[rank2]:2025-11-02 13:32:29,618 - INFO - Avg. fwd time: 13.0749 / Avg. bwd time: 36.0929 / Avg. batch time: 524.7908 (ms) / GPU bubble ratio: 25.05%
[rank0]:2025-11-02 13:32:29,696 - INFO - Avg. fwd time: 13.1986 / Avg. bwd time: 38.0256 / Avg. batch time: 638.1806 (ms) / GPU bubble ratio: 35.79%
[rank2]:2025-11-02 13:32:29,815 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4879  memory: 38.72GiB(27.69%)  tps: 6,219  tflops: 290.07  mfu: 29.33%
[rank2]:2025-11-02 13:32:29,815 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 13:32:29,822 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4879  memory: 54.93GiB(39.29%)  tps: 6,219  tflops: 290.07  mfu: 29.33%
[rank0]:2025-11-02 13:32:29,822 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 13:32:29,820 - INFO -  step: 200  loss:  0.3472  grad_norm:  0.4879  memory: 46.16GiB(33.01%)  tps: 6,219  tflops: 290.07  mfu: 29.33%
[rank3]:2025-11-02 13:32:29,820 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 13:32:29,818 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4879  memory: 47.26GiB(33.80%)  tps: 6,219  tflops: 290.07  mfu: 29.33%
[rank1]:2025-11-02 13:32:29,818 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 13:32:46,572 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,454
[rank0]:2025-11-02 13:32:46,573 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 13:32:46,602 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,404
[rank1]:2025-11-02 13:32:46,603 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 13:32:46,615 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,382
[rank2]:2025-11-02 13:32:46,616 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 13:32:46,632 - INFO - validate step: 200  loss:  0.2306  memory: 46.16GiB(33.01%)  tps: 24,365
[rank3]:2025-11-02 13:32:46,633 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:34:56,042 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 13:34:58,459 - INFO - Avg. fwd time: 14.7153 / Avg. bwd time: 42.3781 / Avg. batch time: 472.6887 (ms) / GPU bubble ratio: 3.37%
[rank2]:2025-11-02 13:34:58,489 - INFO - Avg. fwd time: 13.0794 / Avg. bwd time: 36.1091 / Avg. batch time: 524.7134 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-11-02 13:34:58,567 - INFO - Avg. fwd time: 13.2028 / Avg. bwd time: 38.0447 / Avg. batch time: 638.1033 (ms) / GPU bubble ratio: 35.75%
[rank1]:2025-11-02 13:34:58,535 - INFO - Avg. fwd time: 15.0251 / Avg. bwd time: 41.2290 / Avg. batch time: 583.4771 (ms) / GPU bubble ratio: 22.87%
[rank0]:2025-11-02 13:34:58,690 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2461  memory: 54.93GiB(39.29%)  tps: 6,201  tflops: 289.19  mfu: 29.24%
[rank3]:2025-11-02 13:34:58,688 - INFO -  step: 250  loss:  0.2335  grad_norm:  0.2461  memory: 46.16GiB(33.01%)  tps: 6,203  tflops: 289.33  mfu: 29.25%
[rank1]:2025-11-02 13:34:58,687 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2461  memory: 47.26GiB(33.80%)  tps: 6,202  tflops: 289.27  mfu: 29.25%
[rank2]:2025-11-02 13:34:58,684 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2461  memory: 38.72GiB(27.69%)  tps: 6,203  tflops: 289.30  mfu: 29.25%
[rank0]:2025-11-02 13:37:08,068 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:37:10,584 - INFO - Avg. fwd time: 14.7113 / Avg. bwd time: 42.3791 / Avg. batch time: 472.5906 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-11-02 13:37:10,626 - INFO - Avg. fwd time: 13.0791 / Avg. bwd time: 36.1163 / Avg. batch time: 524.6063 (ms) / GPU bubble ratio: 24.98%
[rank1]:2025-11-02 13:37:10,672 - INFO - Avg. fwd time: 15.0224 / Avg. bwd time: 41.2346 / Avg. batch time: 583.3543 (ms) / GPU bubble ratio: 22.85%
[rank2]:2025-11-02 13:37:10,744 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2985  memory: 38.72GiB(27.69%)  tps: 6,203  tflops: 289.32  mfu: 29.25%
[rank2]:2025-11-02 13:37:10,744 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:37:10,715 - INFO - Avg. fwd time: 13.2009 / Avg. bwd time: 38.0502 / Avg. batch time: 637.9702 (ms) / GPU bubble ratio: 35.73%
[rank0]:2025-11-02 13:37:10,751 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2985  memory: 54.93GiB(39.29%)  tps: 6,203  tflops: 289.32  mfu: 29.25%
[rank0]:2025-11-02 13:37:10,751 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 13:37:10,748 - INFO -  step: 300  loss:  0.2695  grad_norm:  0.2985  memory: 46.16GiB(33.01%)  tps: 6,203  tflops: 289.32  mfu: 29.25%
[rank3]:2025-11-02 13:37:10,749 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 13:37:10,747 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2985  memory: 47.26GiB(33.80%)  tps: 6,203  tflops: 289.32  mfu: 29.25%
[rank1]:2025-11-02 13:37:10,747 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:39:20,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:39:22,918 - INFO - Avg. fwd time: 14.7184 / Avg. bwd time: 42.3926 / Avg. batch time: 472.7101 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-11-02 13:39:22,948 - INFO - Avg. fwd time: 13.0861 / Avg. bwd time: 36.1275 / Avg. batch time: 524.7269 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-11-02 13:39:22,995 - INFO - Avg. fwd time: 15.0222 / Avg. bwd time: 41.2433 / Avg. batch time: 583.4676 (ms) / GPU bubble ratio: 22.85%
[rank0]:2025-11-02 13:39:23,027 - INFO - Avg. fwd time: 13.2003 / Avg. bwd time: 38.0567 / Avg. batch time: 638.0806 (ms) / GPU bubble ratio: 35.74%
[rank2]:2025-11-02 13:39:23,143 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3686  memory: 38.72GiB(27.69%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank0]:2025-11-02 13:39:23,149 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3686  memory: 54.93GiB(39.29%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank3]:2025-11-02 13:39:23,148 - INFO -  step: 350  loss:  0.3354  grad_norm:  0.3686  memory: 46.16GiB(33.01%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank1]:2025-11-02 13:39:23,145 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3686  memory: 47.26GiB(33.80%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank0]:2025-11-02 13:41:32,679 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:41:35,120 - INFO - Avg. fwd time: 14.7185 / Avg. bwd time: 42.3985 / Avg. batch time: 472.7189 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-11-02 13:41:35,150 - INFO - Avg. fwd time: 13.0878 / Avg. bwd time: 36.1289 / Avg. batch time: 524.7311 (ms) / GPU bubble ratio: 24.96%
[rank1]:2025-11-02 13:41:35,196 - INFO - Avg. fwd time: 15.0173 / Avg. bwd time: 41.2385 / Avg. batch time: 583.4587 (ms) / GPU bubble ratio: 22.87%
[rank0]:2025-11-02 13:41:35,229 - INFO - Avg. fwd time: 13.1983 / Avg. bwd time: 38.0559 / Avg. batch time: 638.0584 (ms) / GPU bubble ratio: 35.74%
[rank1]:2025-11-02 13:41:35,347 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3101  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank1]:2025-11-02 13:41:35,347 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 13:41:35,345 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3101  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank2]:2025-11-02 13:41:35,345 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 13:41:35,351 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3101  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank0]:2025-11-02 13:41:35,351 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 13:41:35,349 - INFO -  step: 400  loss:  0.2730  grad_norm:  0.3101  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank3]:2025-11-02 13:41:35,349 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 13:41:50,473 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,079
[rank1]:2025-11-02 13:41:50,474 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 13:41:50,487 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,051
[rank2]:2025-11-02 13:41:50,488 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 13:41:50,504 - INFO - validate step: 400  loss:  0.2350  memory: 46.16GiB(33.01%)  tps: 27,029
[rank3]:2025-11-02 13:41:50,505 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:41:50,445 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,137
[rank0]:2025-11-02 13:41:50,446 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 13:44:00,037 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 13:44:02,597 - INFO - Avg. fwd time: 13.0950 / Avg. bwd time: 36.1360 / Avg. batch time: 524.8321 (ms) / GPU bubble ratio: 24.96%
[rank3]:2025-11-02 13:44:02,555 - INFO - Avg. fwd time: 14.7229 / Avg. bwd time: 42.4098 / Avg. batch time: 472.8150 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-02 13:44:02,643 - INFO - Avg. fwd time: 15.0227 / Avg. bwd time: 41.2468 / Avg. batch time: 583.5646 (ms) / GPU bubble ratio: 22.86%
[rank2]:2025-11-02 13:44:02,716 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3057  memory: 38.72GiB(27.69%)  tps: 6,195  tflops: 288.95  mfu: 29.22%
[rank0]:2025-11-02 13:44:02,688 - INFO - Avg. fwd time: 13.2031 / Avg. bwd time: 38.0663 / Avg. batch time: 638.1698 (ms) / GPU bubble ratio: 35.73%
[rank0]:2025-11-02 13:44:02,723 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3057  memory: 54.93GiB(39.29%)  tps: 6,193  tflops: 288.84  mfu: 29.21%
[rank3]:2025-11-02 13:44:02,721 - INFO -  step: 450  loss:  0.3024  grad_norm:  0.3057  memory: 46.16GiB(33.01%)  tps: 6,196  tflops: 288.98  mfu: 29.22%
[rank1]:2025-11-02 13:44:02,719 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3057  memory: 47.26GiB(33.80%)  tps: 6,195  tflops: 288.92  mfu: 29.21%
[rank3]:2025-11-02 13:44:28,940 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-02 13:44:55,431 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 13:44:55,643 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-02 13:44:55,670 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,692 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,721 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,678 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,706 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,697 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,722 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,694 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,748 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,795 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,831 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,862 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,788 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,835 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,837 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,892 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,872 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,926 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,915 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,971 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,972 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,972 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 13:44:55,973 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,889 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,942 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,936 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:55,975 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:56,005 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:55,981 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 13:44:56,013 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:44:55,997 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 13:44:56,034 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 13:45:11,817 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-02 13:45:12,089 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1345_max_batch_time.svg
[rank3]:> Batch Time: 623.81 ms, GPU Bubble Ratio: 33.81%, 27.37%, 36.54%, 26.23%
[rank3]:2025-11-02 13:45:12,273 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1345_min_batch_time.svg
[rank3]:> Batch Time: 353.49 ms, GPU Bubble Ratio: 69.98%, 23.99%, 33.63%, 23.29%
[rank3]:2025-11-02 13:45:12,483 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1345_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.98 ms, GPU Bubble Ratio: 28.30%, 21.26%, 25.66%, 22.13%
[rank3]:2025-11-02 13:45:12,483 - INFO - 	> Batch Time: 371.98 ms (Average Freeze Ratio: 0.75, Time Reduction Rate: 0.40)
[rank0]:2025-11-02 13:45:52,077 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:45:54,304 - INFO - Avg. fwd time: 14.8319 / Avg. bwd time: 41.4513 / Avg. batch time: 466.0377 (ms) / GPU bubble ratio: 3.38%
[rank3]:2025-11-02 13:45:54,327 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-02 13:45:54,365 - INFO - Avg. fwd time: 15.1285 / Avg. bwd time: 40.2520 / Avg. batch time: 575.2544 (ms) / GPU bubble ratio: 22.98%
[rank2]:2025-11-02 13:45:54,318 - INFO - Avg. fwd time: 13.1878 / Avg. bwd time: 35.3396 / Avg. batch time: 517.5254 (ms) / GPU bubble ratio: 24.99%
[rank2]:2025-11-02 13:45:54,410 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.26/0.79, [MB1] 0.26/0.77, [MB2] 0.26/0.77, [MB3] 0.26/0.78, [MB4] 0.26/0.78, [MB5] 0.26/0.79, [MB6] 0.08/0.23, [MB7] 0.33/1.00
[rank0]:2025-11-02 13:45:54,397 - INFO - Avg. fwd time: 13.2846 / Avg. bwd time: 36.7368 / Avg. batch time: 628.7253 (ms) / GPU bubble ratio: 36.35%
[rank1]:2025-11-02 13:45:54,444 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.98, [MB1] 0.33/0.98, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-11-02 13:45:54,498 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2251  memory: 39.29GiB(28.10%)  tps: 7,329  tflops: 341.81  mfu: 34.56%
[rank3]:2025-11-02 13:45:54,503 - INFO -  step: 500  loss:  0.2997  grad_norm:  0.2251  memory: 47.29GiB(33.82%)  tps: 7,329  tflops: 341.81  mfu: 34.56%
[rank0]:2025-11-02 13:45:54,478 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.15/0.46, [MB1] 0.15/0.46, [MB2] 0.15/0.46, [MB3] 0.15/0.46, [MB4] 0.00/0.00, [MB5] 0.15/0.45, [MB6] 0.18/0.53, [MB7] 0.33/1.00
[rank0]:2025-11-02 13:45:54,505 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2251  memory: 55.29GiB(39.54%)  tps: 7,329  tflops: 341.81  mfu: 34.56%
[rank1]:2025-11-02 13:45:54,501 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2251  memory: 47.72GiB(34.14%)  tps: 7,329  tflops: 341.81  mfu: 34.56%
[rank2]:2025-11-02 13:45:54,584 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1345_stage2_step500.svg
[rank0]:2025-11-02 13:45:54,585 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1345_stage0_step500.svg
[rank1]:2025-11-02 13:45:54,584 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1345_stage1_step500.svg
[rank3]:2025-11-02 13:45:54,672 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1345_real_step500_rank3.svg
[rank3]:> Batch Time: 413.59 ms, GPU Bubble Ratio: 47.30%, 30.86%, 33.59%, 26.96%
[rank3]:2025-11-02 13:45:54,735 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1345_stage3_step500.svg
[rank0]:2025-11-02 13:47:42,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 13:47:44,760 - INFO - Avg. fwd time: 13.2651 / Avg. bwd time: 34.6331 / Avg. batch time: 510.4697 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-11-02 13:47:44,737 - INFO - Avg. fwd time: 14.9284 / Avg. bwd time: 40.5607 / Avg. batch time: 459.6615 (ms) / GPU bubble ratio: 3.43%
[rank3]:2025-11-02 13:47:44,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-02 13:47:44,806 - INFO - Avg. fwd time: 13.3517 / Avg. bwd time: 36.0391 / Avg. batch time: 619.9680 (ms) / GPU bubble ratio: 36.27%
[rank1]:2025-11-02 13:47:44,774 - INFO - Avg. fwd time: 15.2330 / Avg. bwd time: 39.2205 / Avg. batch time: 567.1341 (ms) / GPU bubble ratio: 23.19%
[rank2]:2025-11-02 13:47:44,851 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.53/0.79, [MB1] 0.52/0.77, [MB2] 0.52/0.77, [MB3] 0.52/0.78, [MB4] 0.52/0.78, [MB5] 0.53/0.79, [MB6] 0.15/0.23, [MB7] 0.67/1.00
[rank0]:2025-11-02 13:47:44,906 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.46, [MB1] 0.31/0.46, [MB2] 0.31/0.46, [MB3] 0.31/0.46, [MB4] 0.00/0.00, [MB5] 0.30/0.45, [MB6] 0.35/0.53, [MB7] 0.67/1.00
[rank1]:2025-11-02 13:47:44,875 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.65/0.98, [MB1] 0.66/0.98, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-02 13:47:44,922 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1042  memory: 48.76GiB(34.88%)  tps: 7,419  tflops: 346.02  mfu: 34.99%
[rank2]:2025-11-02 13:47:44,925 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1042  memory: 39.29GiB(28.10%)  tps: 7,418  tflops: 346.00  mfu: 34.98%
[rank3]:2025-11-02 13:47:44,926 - INFO -  step: 550  loss:  0.1649  grad_norm:  0.1042  memory: 47.76GiB(34.16%)  tps: 7,419  tflops: 346.02  mfu: 34.99%
[rank0]:2025-11-02 13:47:44,925 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1042  memory: 57.26GiB(40.95%)  tps: 7,419  tflops: 346.02  mfu: 34.99%
[rank0]:2025-11-02 13:49:20,876 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:49:22,674 - INFO - Avg. fwd time: 15.0972 / Avg. bwd time: 39.1915 / Avg. batch time: 450.0406 (ms) / GPU bubble ratio: 3.50%
[rank3]:2025-11-02 13:49:22,679 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 13:49:22,726 - INFO - Avg. fwd time: 15.4005 / Avg. bwd time: 37.7445 / Avg. batch time: 554.8890 (ms) / GPU bubble ratio: 23.38%
[rank1]:2025-11-02 13:49:22,729 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.98/0.98, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:49:22,701 - INFO - Avg. fwd time: 13.4048 / Avg. bwd time: 33.5362 / Avg. batch time: 499.7384 (ms) / GPU bubble ratio: 24.86%
[rank2]:2025-11-02 13:49:22,705 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.79/0.79, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.78/0.78, [MB4] 0.78/0.78, [MB5] 0.79/0.79, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:49:22,771 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1965  memory: 39.29GiB(28.10%)  tps: 8,372  tflops: 390.49  mfu: 39.48%
[rank2]:2025-11-02 13:49:22,771 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 13:49:22,757 - INFO - Avg. fwd time: 13.4683 / Avg. bwd time: 34.7652 / Avg. batch time: 606.8172 (ms) / GPU bubble ratio: 36.41%
[rank0]:2025-11-02 13:49:22,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.46/0.46, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-11-02 13:49:22,778 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1965  memory: 57.26GiB(40.95%)  tps: 8,372  tflops: 390.46  mfu: 39.48%
[rank0]:2025-11-02 13:49:22,778 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 13:49:22,765 - INFO -  step: 600  loss:  0.4304  grad_norm:  0.1965  memory: 47.76GiB(34.16%)  tps: 8,373  tflops: 390.52  mfu: 39.49%
[rank3]:2025-11-02 13:49:22,766 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 13:49:22,763 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1965  memory: 48.76GiB(34.88%)  tps: 8,373  tflops: 390.51  mfu: 39.49%
[rank1]:2025-11-02 13:49:22,763 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 13:49:39,201 - INFO - validate step: 600  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,941
[rank1]:2025-11-02 13:49:39,235 - INFO - validate step: 600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,866
[rank2]:2025-11-02 13:49:39,252 - INFO - validate step: 600  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,853
[rank3]:2025-11-02 13:49:39,263 - INFO - validate step: 600  loss:  0.2484  memory: 47.76GiB(34.16%)  tps: 24,829
[rank1]:2025-11-02 13:49:39,338 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1349_stage1_step600.svg
[rank2]:2025-11-02 13:49:39,338 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1349_stage2_step600.svg
[rank0]:2025-11-02 13:49:39,335 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1349_stage0_step600.svg
[rank3]:2025-11-02 13:49:39,439 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1349_real_step600_rank3.svg
[rank3]:> Batch Time: 428.78 ms, GPU Bubble Ratio: 39.72%, 30.51%, 33.69%, 26.61%
[rank3]:2025-11-02 13:49:39,504 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1349_stage3_step600.svg
[rank0]:2025-11-02 13:51:09,062 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 13:51:10,753 - INFO - Avg. fwd time: 13.5433 / Avg. bwd time: 32.5391 / Avg. batch time: 489.9741 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-11-02 13:51:10,738 - INFO - Avg. fwd time: 15.2678 / Avg. bwd time: 37.9202 / Avg. batch time: 441.2235 (ms) / GPU bubble ratio: 3.56%
[rank1]:2025-11-02 13:51:10,758 - INFO - Avg. fwd time: 15.5556 / Avg. bwd time: 36.4119 / Avg. batch time: 543.7993 (ms) / GPU bubble ratio: 23.55%
[rank2]:2025-11-02 13:51:10,829 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.79/0.79, [MB1] 0.77/0.77, [MB2] 0.77/0.77, [MB3] 0.78/0.78, [MB4] 0.78/0.78, [MB5] 0.79/0.79, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:51:10,880 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0531  memory: 39.29GiB(28.10%)  tps: 8,941  tflops: 416.99  mfu: 42.16%
[rank0]:2025-11-02 13:51:10,789 - INFO - Avg. fwd time: 13.5880 / Avg. bwd time: 33.2337 / Avg. batch time: 594.9603 (ms) / GPU bubble ratio: 37.04%
[rank0]:2025-11-02 13:51:10,876 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.46/0.46, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.45/0.45, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank3]:2025-11-02 13:51:10,810 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 13:51:10,877 - INFO -  step: 650  loss:  0.2681  grad_norm:  0.0000  memory: 47.76GiB(34.16%)  tps: 8,942  tflops: 417.06  mfu: 42.17%
[rank1]:2025-11-02 13:51:10,846 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.98/0.98, [MB1] 0.98/0.98, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 13:51:10,876 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,939  tflops: 416.93  mfu: 42.16%
[rank0]:2025-11-02 13:51:10,893 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0531  memory: 57.26GiB(40.95%)  tps: 8,934  tflops: 416.70  mfu: 42.13%
[rank0]:2025-11-02 13:52:40,427 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:52:42,125 - INFO - Avg. fwd time: 15.4363 / Avg. bwd time: 36.6342 / Avg. batch time: 432.2717 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-11-02 13:52:42,139 - INFO - Avg. fwd time: 13.6801 / Avg. bwd time: 31.5375 / Avg. batch time: 480.0142 (ms) / GPU bubble ratio: 24.64%
[rank1]:2025-11-02 13:52:42,144 - INFO - Avg. fwd time: 15.7100 / Avg. bwd time: 35.0754 / Avg. batch time: 532.5111 (ms) / GPU bubble ratio: 23.70%
[rank0]:2025-11-02 13:52:42,172 - INFO - Avg. fwd time: 13.7068 / Avg. bwd time: 31.7061 / Avg. batch time: 582.9077 (ms) / GPU bubble ratio: 37.67%
[rank1]:2025-11-02 13:52:42,414 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1352_rank1_trend_line.svg
[rank3]:2025-11-02 13:52:42,412 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1352_rank3_trend_line.svg
[rank0]:2025-11-02 13:52:42,445 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1352_rank0_trend_line.svg
[rank0]:2025-11-02 13:52:42,451 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank0]:2025-11-02 13:52:42,452 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.36/0.36, [MB7] 1.00/1.00
[rank0]:2025-11-02 13:52:42,453 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0746  memory: 57.26GiB(40.95%)  tps: 8,947  tflops: 417.30  mfu: 42.19%
[rank2]:2025-11-02 13:52:42,414 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1352_rank2_trend_line.svg
[rank2]:2025-11-02 13:52:42,451 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.47/0.47, [MB2] 0.36/0.36, [MB3] 0.37/0.37, [MB4] 0.39/0.39, [MB5] 0.13/0.13, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:52:42,453 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.47/0.47, [MB2] 0.36/0.36, [MB3] 0.37/0.37, [MB4] 0.39/0.39, [MB5] 0.13/0.13, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:52:42,453 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0746  memory: 39.29GiB(28.10%)  tps: 8,946  tflops: 417.24  mfu: 42.19%
[rank1]:2025-11-02 13:52:42,451 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.06/0.06, [MB1] 0.63/0.63, [MB2] 0.66/0.66, [MB3] 0.67/0.67, [MB4] 0.33/0.33, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 13:52:42,452 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.06/0.06, [MB1] 0.63/0.63, [MB2] 0.66/0.66, [MB3] 0.67/0.67, [MB4] 0.33/0.33, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 13:52:42,453 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,945  tflops: 417.22  mfu: 42.19%
[rank3]:2025-11-02 13:52:42,645 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1352_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 399.22 ms, GPU Bubble Ratio: 28.44%, 19.51%, 26.91%, 23.90%
[rank3]:2025-11-02 13:52:42,645 - INFO - 	> Batch Time: 399.22 ms (Average Freeze Ratio: 0.50)
[rank3]:2025-11-02 13:52:42,646 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.85/0.85, [MB4] 0.87/0.87, [MB5] 0.90/0.90, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank3]:2025-11-02 13:52:42,647 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.85/0.85, [MB4] 0.87/0.87, [MB5] 0.90/0.90, [MB6] 0.57/0.57, [MB7] 1.00/1.00
[rank3]:2025-11-02 13:52:42,650 - INFO -  step: 700  loss:  0.3830  grad_norm:  0.0000  memory: 47.76GiB(34.16%)  tps: 8,926  tflops: 416.33  mfu: 42.10%
[rank0]:2025-11-02 13:52:42,718 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1352_stage0_step700.svg
[rank2]:2025-11-02 13:52:42,720 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1352_stage2_step700.svg
[rank1]:2025-11-02 13:52:42,719 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1352_stage1_step700.svg
[rank3]:2025-11-02 13:52:42,818 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1352_real_step700_rank3.svg
[rank3]:> Batch Time: 420.30 ms, GPU Bubble Ratio: 46.87%, 30.92%, 34.27%, 26.53%
[rank3]:2025-11-02 13:52:42,885 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1352_stage3_step700.svg
[rank0]:2025-11-02 13:54:20,924 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:54:22,800 - INFO - Avg. fwd time: 15.5684 / Avg. bwd time: 35.5011 / Avg. batch time: 425.3824 (ms) / GPU bubble ratio: 3.96%
[rank2]:2025-11-02 13:54:22,837 - INFO - Avg. fwd time: 13.7612 / Avg. bwd time: 30.9638 / Avg. batch time: 472.9865 (ms) / GPU bubble ratio: 24.35%
[rank1]:2025-11-02 13:54:22,872 - INFO - Avg. fwd time: 15.8069 / Avg. bwd time: 34.3539 / Avg. batch time: 525.0935 (ms) / GPU bubble ratio: 23.58%
[rank0]:2025-11-02 13:54:22,910 - INFO - Avg. fwd time: 13.7679 / Avg. bwd time: 30.7221 / Avg. batch time: 575.3379 (ms) / GPU bubble ratio: 38.14%
[rank3]:2025-11-02 13:54:22,920 - INFO -  step: 750  loss:  0.1604  grad_norm:  0.1708  memory: 47.76GiB(34.16%)  tps: 8,170  tflops: 381.05  mfu: 38.53%
[rank2]:2025-11-02 13:54:22,934 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1708  memory: 39.29GiB(28.10%)  tps: 8,153  tflops: 380.25  mfu: 38.45%
[rank1]:2025-11-02 13:54:22,932 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1708  memory: 48.76GiB(34.88%)  tps: 8,153  tflops: 380.25  mfu: 38.45%
[rank0]:2025-11-02 13:54:22,946 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1708  memory: 57.26GiB(40.95%)  tps: 8,152  tflops: 380.20  mfu: 38.44%
[rank0]:2025-11-02 13:55:59,499 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:56:01,338 - INFO - Avg. fwd time: 15.6561 / Avg. bwd time: 34.6488 / Avg. batch time: 419.9694 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-11-02 13:56:01,367 - INFO - Avg. fwd time: 13.8121 / Avg. bwd time: 30.5414 / Avg. batch time: 467.4548 (ms) / GPU bubble ratio: 24.09%
[rank1]:2025-11-02 13:56:01,381 - INFO - Avg. fwd time: 15.8724 / Avg. bwd time: 33.8029 / Avg. batch time: 519.2650 (ms) / GPU bubble ratio: 23.47%
[rank0]:2025-11-02 13:56:01,426 - INFO - Avg. fwd time: 13.8056 / Avg. bwd time: 29.9961 / Avg. batch time: 569.4036 (ms) / GPU bubble ratio: 38.46%
[rank3]:2025-11-02 13:56:01,696 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1356_rank3_trend_line.svg
[rank2]:2025-11-02 13:56:01,714 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1356_rank2_trend_line.svg
[rank1]:2025-11-02 13:56:01,705 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1356_rank1_trend_line.svg
[rank1]:2025-11-02 13:56:01,742 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.27/0.27, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.56/0.56, [MB4] 0.15/0.15, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 13:56:01,744 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1824  memory: 48.76GiB(34.88%)  tps: 8,291  tflops: 386.67  mfu: 39.10%
[rank1]:2025-11-02 13:56:01,744 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 13:56:01,736 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1356_rank0_trend_line.svg
[rank0]:2025-11-02 13:56:01,742 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 13:56:01,743 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1824  memory: 57.26GiB(40.95%)  tps: 8,292  tflops: 386.73  mfu: 39.10%
[rank0]:2025-11-02 13:56:01,743 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 13:56:01,743 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.54/0.54, [MB2] 0.52/0.52, [MB3] 0.51/0.51, [MB4] 0.26/0.26, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 13:56:01,744 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1824  memory: 39.29GiB(28.10%)  tps: 8,291  tflops: 386.68  mfu: 39.10%
[rank2]:2025-11-02 13:56:01,744 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 13:56:01,925 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1356_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 402.48 ms, GPU Bubble Ratio: 37.95%, 22.61%, 27.16%, 26.27%
[rank3]:2025-11-02 13:56:01,925 - INFO - 	> Batch Time: 402.48 ms (Average Freeze Ratio: 0.47)
[rank3]:2025-11-02 13:56:01,926 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.98/0.98, [MB4] 0.96/0.96, [MB5] 0.75/0.75, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank3]:2025-11-02 13:56:01,930 - INFO -  step: 800  loss:  0.3173  grad_norm:  0.1824  memory: 47.76GiB(34.16%)  tps: 8,274  tflops: 385.90  mfu: 39.02%
[rank3]:2025-11-02 13:56:01,931 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 13:56:18,703 - INFO - validate step: 800  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,152
[rank1]:2025-11-02 13:56:18,740 - INFO - validate step: 800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,100
[rank3]:2025-11-02 13:56:18,762 - INFO - validate step: 800  loss:  0.2513  memory: 47.76GiB(34.16%)  tps: 24,337
[rank2]:2025-11-02 13:56:18,753 - INFO - validate step: 800  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,082
[rank2]:2025-11-02 13:56:18,839 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1356_stage2_step800.svg
[rank1]:2025-11-02 13:56:18,838 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1356_stage1_step800.svg
[rank0]:2025-11-02 13:56:18,838 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1356_stage0_step800.svg
[rank3]:2025-11-02 13:56:18,933 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1356_real_step800_rank3.svg
[rank3]:> Batch Time: 457.44 ms, GPU Bubble Ratio: 43.30%, 27.12%, 33.63%, 34.81%
[rank3]:2025-11-02 13:56:19,001 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1356_stage3_step800.svg
[rank0]:2025-11-02 13:58:02,642 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 13:58:04,581 - INFO - Avg. fwd time: 15.9481 / Avg. bwd time: 33.1441 / Avg. batch time: 514.9593 (ms) / GPU bubble ratio: 23.73%
[rank3]:2025-11-02 13:58:04,535 - INFO - Avg. fwd time: 15.7478 / Avg. bwd time: 33.7662 / Avg. batch time: 415.7547 (ms) / GPU bubble ratio: 4.72%
[rank2]:2025-11-02 13:58:04,574 - INFO - Avg. fwd time: 13.8676 / Avg. bwd time: 30.0851 / Avg. batch time: 463.2564 (ms) / GPU bubble ratio: 24.10%
[rank0]:2025-11-02 13:58:04,642 - INFO - Avg. fwd time: 13.7932 / Avg. bwd time: 30.4101 / Avg. batch time: 565.3606 (ms) / GPU bubble ratio: 37.45%
[rank1]:2025-11-02 13:58:04,736 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2145  memory: 48.76GiB(34.88%)  tps: 7,729  tflops: 360.46  mfu: 36.45%
[rank0]:2025-11-02 13:58:04,753 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2145  memory: 57.26GiB(40.95%)  tps: 7,725  tflops: 360.28  mfu: 36.43%
[rank3]:2025-11-02 13:58:04,728 - INFO -  step: 850  loss:  0.1175  grad_norm:  0.2145  memory: 47.76GiB(34.16%)  tps: 7,731  tflops: 360.57  mfu: 36.46%
[rank2]:2025-11-02 13:58:04,744 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2145  memory: 39.29GiB(28.10%)  tps: 7,729  tflops: 360.48  mfu: 36.45%
[rank0]:2025-11-02 13:59:47,711 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 13:59:49,724 - INFO - Avg. fwd time: 15.8132 / Avg. bwd time: 32.9935 / Avg. batch time: 412.1331 (ms) / GPU bubble ratio: 5.26%
[rank2]:2025-11-02 13:59:49,762 - INFO - Avg. fwd time: 13.9084 / Avg. bwd time: 29.6610 / Avg. batch time: 459.6053 (ms) / GPU bubble ratio: 24.16%
[rank1]:2025-11-02 13:59:49,803 - INFO - Avg. fwd time: 16.0075 / Avg. bwd time: 32.5562 / Avg. batch time: 511.2269 (ms) / GPU bubble ratio: 24.00%
[rank1]:2025-11-02 13:59:49,867 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2386  memory: 48.76GiB(34.88%)  tps: 7,792  tflops: 363.43  mfu: 36.75%
[rank3]:2025-11-02 13:59:49,859 - INFO -  step: 900  loss:  0.1932  grad_norm:  0.2386  memory: 47.76GiB(34.16%)  tps: 7,792  tflops: 363.43  mfu: 36.75%
[rank0]:2025-11-02 13:59:49,849 - INFO - Avg. fwd time: 13.7718 / Avg. bwd time: 30.8963 / Avg. batch time: 561.8947 (ms) / GPU bubble ratio: 36.40%
[rank0]:2025-11-02 13:59:49,884 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2386  memory: 57.26GiB(40.95%)  tps: 7,792  tflops: 363.43  mfu: 36.75%
[rank2]:2025-11-02 13:59:49,875 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2386  memory: 39.29GiB(28.10%)  tps: 7,792  tflops: 363.43  mfu: 36.75%
[rank1]:2025-11-02 13:59:49,950 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1359_stage1_step900.svg
[rank0]:2025-11-02 13:59:49,950 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1359_stage0_step900.svg
[rank2]:2025-11-02 13:59:49,950 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1359_stage2_step900.svg
[rank3]:2025-11-02 13:59:50,057 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1359_real_step900_rank3.svg
[rank3]:> Batch Time: 501.95 ms, GPU Bubble Ratio: 16.37%, 35.84%, 40.38%, 40.82%
[rank3]:2025-11-02 13:59:50,118 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1359_stage3_step900.svg
[rank0]:2025-11-02 14:01:33,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:01:35,459 - INFO - Avg. fwd time: 15.8713 / Avg. bwd time: 32.3863 / Avg. batch time: 409.3444 (ms) / GPU bubble ratio: 5.69%
[rank2]:2025-11-02 14:01:35,498 - INFO - Avg. fwd time: 13.9416 / Avg. bwd time: 29.3659 / Avg. batch time: 456.8362 (ms) / GPU bubble ratio: 24.16%
[rank1]:2025-11-02 14:01:35,505 - INFO - Avg. fwd time: 16.0575 / Avg. bwd time: 32.1022 / Avg. batch time: 508.4017 (ms) / GPU bubble ratio: 24.22%
[rank0]:2025-11-02 14:01:35,566 - INFO - Avg. fwd time: 13.7596 / Avg. bwd time: 31.2742 / Avg. batch time: 559.2777 (ms) / GPU bubble ratio: 35.58%
[rank3]:2025-11-02 14:01:35,655 - INFO -  step: 950  loss:  0.2848  grad_norm:  0.4829  memory: 47.76GiB(34.16%)  tps: 7,743  tflops: 361.15  mfu: 36.52%
[rank0]:2025-11-02 14:01:35,679 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.4829  memory: 57.26GiB(40.95%)  tps: 7,743  tflops: 361.15  mfu: 36.52%
[rank2]:2025-11-02 14:01:35,670 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.4829  memory: 39.29GiB(28.10%)  tps: 7,743  tflops: 361.15  mfu: 36.52%
[rank1]:2025-11-02 14:01:35,661 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.4829  memory: 48.76GiB(34.88%)  tps: 7,743  tflops: 361.15  mfu: 36.52%
[rank0]:2025-11-02 14:03:19,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:03:21,305 - INFO - Avg. fwd time: 15.9366 / Avg. bwd time: 31.7458 / Avg. batch time: 406.4458 (ms) / GPU bubble ratio: 6.15%
[rank2]:2025-11-02 14:03:21,344 - INFO - Avg. fwd time: 13.9813 / Avg. bwd time: 29.0419 / Avg. batch time: 453.9265 (ms) / GPU bubble ratio: 24.18%
[rank1]:2025-11-02 14:03:21,351 - INFO - Avg. fwd time: 16.1144 / Avg. bwd time: 31.6158 / Avg. batch time: 505.4111 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-11-02 14:03:21,410 - INFO - Avg. fwd time: 13.7493 / Avg. bwd time: 31.6756 / Avg. batch time: 556.5142 (ms) / GPU bubble ratio: 34.70%
[rank3]:2025-11-02 14:03:21,749 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1403_rank3_trend_line.svg
[rank2]:2025-11-02 14:03:21,766 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1403_rank2_trend_line.svg
[rank1]:2025-11-02 14:03:21,768 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1403_rank1_trend_line.svg
[rank1]:2025-11-02 14:03:21,815 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 14:03:21,817 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1474  memory: 48.76GiB(34.88%)  tps: 7,717  tflops: 359.92  mfu: 36.39%
[rank1]:2025-11-02 14:03:21,817 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 14:03:21,809 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1403_rank0_trend_line.svg
[rank0]:2025-11-02 14:03:21,815 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.34/0.34, [MB1] 0.32/0.32, [MB2] 0.31/0.31, [MB3] 0.32/0.32, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.21/0.21, [MB7] 1.00/1.00
[rank0]:2025-11-02 14:03:21,817 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1474  memory: 57.26GiB(40.95%)  tps: 7,718  tflops: 359.98  mfu: 36.40%
[rank0]:2025-11-02 14:03:21,817 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 14:03:21,815 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.69/0.69, [MB2] 0.38/0.38, [MB3] 0.30/0.30, [MB4] 0.32/0.32, [MB5] 0.31/0.31, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 14:03:21,817 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.1474  memory: 39.29GiB(28.10%)  tps: 7,718  tflops: 359.95  mfu: 36.40%
[rank2]:2025-11-02 14:03:21,817 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 14:03:22,003 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1403_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 394.05 ms, GPU Bubble Ratio: 23.38%, 23.10%, 26.39%, 26.05%
[rank3]:2025-11-02 14:03:22,004 - INFO - 	> Batch Time: 394.05 ms (Average Freeze Ratio: 0.61)
[rank3]:2025-11-02 14:03:22,004 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.82/0.82, [MB4] 0.77/0.77, [MB5] 0.79/0.79, [MB6] 0.78/0.78, [MB7] 1.00/1.00
[rank3]:2025-11-02 14:03:22,009 - INFO -  step: 1000  loss:  0.1590  grad_norm:  0.1474  memory: 47.76GiB(34.16%)  tps: 7,703  tflops: 359.25  mfu: 36.32%
[rank3]:2025-11-02 14:03:22,009 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 14:03:38,556 - INFO - validate step: 1000  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,470
[rank1]:2025-11-02 14:03:38,590 - INFO - validate step: 1000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,420
[rank3]:2025-11-02 14:03:38,619 - INFO - validate step: 1000  loss:  0.2546  memory: 47.76GiB(34.16%)  tps: 24,661
[rank0]:2025-11-02 14:03:38,687 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1403_stage0_step1000.svg
[rank2]:2025-11-02 14:03:38,608 - INFO - validate step: 1000  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,394
[rank2]:2025-11-02 14:03:38,691 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1403_stage2_step1000.svg
[rank1]:2025-11-02 14:03:38,688 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1403_stage1_step1000.svg
[rank3]:2025-11-02 14:03:38,797 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1403_real_step1000_rank3.svg
[rank3]:> Batch Time: 500.11 ms, GPU Bubble Ratio: 15.77%, 35.97%, 39.38%, 40.81%
[rank3]:2025-11-02 14:03:38,860 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1403_stage3_step1000.svg
[rank0]:2025-11-02 14:05:09,178 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:05:11,015 - INFO - Avg. fwd time: 15.9955 / Avg. bwd time: 31.1868 / Avg. batch time: 402.2027 (ms) / GPU bubble ratio: 6.15%
[rank2]:2025-11-02 14:05:11,051 - INFO - Avg. fwd time: 14.0193 / Avg. bwd time: 28.7413 / Avg. batch time: 449.4958 (ms) / GPU bubble ratio: 23.90%
[rank1]:2025-11-02 14:05:11,077 - INFO - Avg. fwd time: 16.1776 / Avg. bwd time: 30.9636 / Avg. batch time: 500.2312 (ms) / GPU bubble ratio: 24.61%
[rank1]:2025-11-02 14:05:11,121 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,853  tflops: 412.92  mfu: 41.75%
[rank0]:2025-11-02 14:05:11,113 - INFO - Avg. fwd time: 13.8000 / Avg. bwd time: 30.8815 / Avg. batch time: 550.9369 (ms) / GPU bubble ratio: 35.12%
[rank0]:2025-11-02 14:05:11,146 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1962  memory: 57.26GiB(40.95%)  tps: 8,848  tflops: 412.66  mfu: 41.72%
[rank3]:2025-11-02 14:05:11,123 - INFO -  step: 1050  loss:  0.2740  grad_norm:  0.1962  memory: 47.76GiB(34.16%)  tps: 8,856  tflops: 413.04  mfu: 41.76%
[rank2]:2025-11-02 14:05:11,138 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1962  memory: 39.29GiB(28.10%)  tps: 8,853  tflops: 412.92  mfu: 41.75%
[rank0]:2025-11-02 14:06:43,990 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:06:45,697 - INFO - Avg. fwd time: 16.0584 / Avg. bwd time: 30.7641 / Avg. batch time: 399.0773 (ms) / GPU bubble ratio: 6.14%
[rank2]:2025-11-02 14:06:45,729 - INFO - Avg. fwd time: 14.0605 / Avg. bwd time: 28.5163 / Avg. batch time: 446.2262 (ms) / GPU bubble ratio: 23.67%
[rank1]:2025-11-02 14:06:45,724 - INFO - Avg. fwd time: 16.2410 / Avg. bwd time: 30.4539 / Avg. batch time: 496.3640 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 14:06:45,760 - INFO - Avg. fwd time: 13.8516 / Avg. bwd time: 30.2092 / Avg. batch time: 546.7686 (ms) / GPU bubble ratio: 35.53%
[rank1]:2025-11-02 14:06:45,853 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,648  tflops: 403.32  mfu: 40.78%
[rank0]:2025-11-02 14:06:45,872 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1016  memory: 57.26GiB(40.95%)  tps: 8,648  tflops: 403.35  mfu: 40.78%
[rank3]:2025-11-02 14:06:45,858 - INFO -  step: 1100  loss:  0.2419  grad_norm:  0.1016  memory: 47.76GiB(34.16%)  tps: 8,647  tflops: 403.32  mfu: 40.78%
[rank2]:2025-11-02 14:06:45,872 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.1016  memory: 39.29GiB(28.10%)  tps: 8,647  tflops: 403.32  mfu: 40.78%
[rank2]:2025-11-02 14:06:45,941 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1406_stage2_step1100.svg
[rank1]:2025-11-02 14:06:45,940 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1406_stage1_step1100.svg
[rank0]:2025-11-02 14:06:45,939 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1406_stage0_step1100.svg
[rank3]:2025-11-02 14:06:46,045 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1406_real_step1100_rank3.svg
[rank3]:> Batch Time: 438.72 ms, GPU Bubble Ratio: 46.22%, 33.76%, 29.95%, 29.28%
[rank3]:2025-11-02 14:06:46,109 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1406_stage3_step1100.svg
[rank0]:2025-11-02 14:08:17,839 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 14:08:19,597 - INFO - Avg. fwd time: 16.2977 / Avg. bwd time: 29.9024 / Avg. batch time: 492.1344 (ms) / GPU bubble ratio: 24.90%
[rank3]:2025-11-02 14:08:19,572 - INFO - Avg. fwd time: 16.1120 / Avg. bwd time: 30.3211 / Avg. batch time: 395.6626 (ms) / GPU bubble ratio: 6.12%
[rank2]:2025-11-02 14:08:19,601 - INFO - Avg. fwd time: 14.0950 / Avg. bwd time: 28.2695 / Avg. batch time: 442.6497 (ms) / GPU bubble ratio: 23.43%
[rank0]:2025-11-02 14:08:19,633 - INFO - Avg. fwd time: 13.8988 / Avg. bwd time: 29.4934 / Avg. batch time: 542.1874 (ms) / GPU bubble ratio: 35.97%
[rank2]:2025-11-02 14:08:19,741 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1309  memory: 39.29GiB(28.10%)  tps: 8,727  tflops: 407.03  mfu: 41.16%
[rank1]:2025-11-02 14:08:19,723 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,727  tflops: 407.03  mfu: 41.16%
[rank0]:2025-11-02 14:08:19,750 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.1309  memory: 57.26GiB(40.95%)  tps: 8,726  tflops: 407.00  mfu: 41.15%
[rank3]:2025-11-02 14:08:19,733 - INFO -  step: 1150  loss:  0.2472  grad_norm:  0.1309  memory: 47.76GiB(34.16%)  tps: 8,727  tflops: 407.01  mfu: 41.15%
[rank0]:2025-11-02 14:09:51,176 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:09:53,035 - INFO - Avg. fwd time: 14.1253 / Avg. bwd time: 28.0513 / Avg. batch time: 439.3381 (ms) / GPU bubble ratio: 23.20%
[rank1]:2025-11-02 14:09:53,062 - INFO - Avg. fwd time: 16.3497 / Avg. bwd time: 29.3988 / Avg. batch time: 488.2289 (ms) / GPU bubble ratio: 25.04%
[rank3]:2025-11-02 14:09:52,999 - INFO - Avg. fwd time: 16.1603 / Avg. bwd time: 29.9134 / Avg. batch time: 392.5332 (ms) / GPU bubble ratio: 6.10%
[rank0]:2025-11-02 14:09:53,097 - INFO - Avg. fwd time: 13.9412 / Avg. bwd time: 28.8350 / Avg. batch time: 537.9593 (ms) / GPU bubble ratio: 36.39%
[rank1]:2025-11-02 14:09:53,467 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1409_rank1_trend_line.svg
[rank3]:2025-11-02 14:09:53,436 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1409_rank3_trend_line.svg
[rank2]:2025-11-02 14:09:53,462 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1409_rank2_trend_line.svg
[rank2]:2025-11-02 14:09:53,517 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.65/0.65, [MB2] 0.51/0.51, [MB3] 0.49/0.49, [MB4] 0.32/0.32, [MB5] 0.20/0.20, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 14:09:53,519 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0950  memory: 39.29GiB(28.10%)  tps: 8,736  tflops: 407.43  mfu: 41.20%
[rank2]:2025-11-02 14:09:53,519 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 14:09:53,517 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.37/0.37, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.36/0.36, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 14:09:53,519 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,734  tflops: 407.35  mfu: 41.19%
[rank1]:2025-11-02 14:09:53,519 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 14:09:53,510 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1409_rank0_trend_line.svg
[rank0]:2025-11-02 14:09:53,517 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.25/0.25, [MB1] 0.23/0.23, [MB2] 0.15/0.15, [MB3] 0.10/0.10, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.10/0.10, [MB7] 1.00/1.00
[rank0]:2025-11-02 14:09:53,519 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0950  memory: 57.26GiB(40.95%)  tps: 8,736  tflops: 407.47  mfu: 41.20%
[rank0]:2025-11-02 14:09:53,519 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 14:09:53,712 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1409_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 388.14 ms, GPU Bubble Ratio: 24.92%, 23.19%, 25.55%, 25.49%
[rank3]:2025-11-02 14:09:53,713 - INFO - 	> Batch Time: 388.14 ms (Average Freeze Ratio: 0.53)
[rank3]:2025-11-02 14:09:53,713 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.89/0.89, [MB4] 0.87/0.87, [MB5] 0.76/0.76, [MB6] 0.67/0.67, [MB7] 1.00/1.00
[rank3]:2025-11-02 14:09:53,720 - INFO -  step: 1200  loss:  0.2905  grad_norm:  0.0950  memory: 47.76GiB(34.16%)  tps: 8,716  tflops: 406.53  mfu: 41.11%
[rank3]:2025-11-02 14:09:53,720 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 14:10:10,165 - INFO - validate step: 1200  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,606
[rank0]:2025-11-02 14:10:10,166 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 14:10:10,171 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 14:10:10,216 - INFO - validate step: 1200  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,531
[rank2]:2025-11-02 14:10:10,217 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 14:10:10,197 - INFO - validate step: 1200  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,560
[rank1]:2025-11-02 14:10:10,197 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 14:10:10,228 - INFO - validate step: 1200  loss:  0.2540  memory: 47.76GiB(34.16%)  tps: 24,813
[rank3]:2025-11-02 14:10:10,229 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 14:10:21,137 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.92 seconds.
[rank1]:2025-11-02 14:10:26,030 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.83 seconds.
[rank3]:2025-11-02 14:10:26,950 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.72 seconds.
[rank0]:2025-11-02 14:10:28,837 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 14:10:28,842 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.68 seconds.
[rank2]:2025-11-02 14:10:28,925 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1410_stage2_step1200.svg
[rank1]:2025-11-02 14:10:28,919 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1410_stage1_step1200.svg
[rank0]:2025-11-02 14:10:28,958 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1410_stage0_step1200.svg
[rank3]:2025-11-02 14:10:29,100 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1410_real_step1200_rank3.svg
[rank3]:> Batch Time: 432.96 ms, GPU Bubble Ratio: 45.62%, 33.58%, 30.20%, 28.65%
[rank3]:2025-11-02 14:10:29,182 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1410_stage3_step1200.svg
[rank0]:2025-11-02 14:12:08,230 - INFO - [GC] Peforming periodical GC collection 2.64 seconds
[rank3]:2025-11-02 14:12:10,061 - INFO - Avg. fwd time: 16.1955 / Avg. bwd time: 29.5974 / Avg. batch time: 390.1346 (ms) / GPU bubble ratio: 6.10%
[rank2]:2025-11-02 14:12:10,086 - INFO - Avg. fwd time: 14.1486 / Avg. bwd time: 27.8540 / Avg. batch time: 436.8796 (ms) / GPU bubble ratio: 23.09%
[rank1]:2025-11-02 14:12:10,129 - INFO - Avg. fwd time: 16.3747 / Avg. bwd time: 29.2044 / Avg. batch time: 485.9230 (ms) / GPU bubble ratio: 24.96%
[rank0]:2025-11-02 14:12:10,128 - INFO - Avg. fwd time: 13.9706 / Avg. bwd time: 28.3745 / Avg. batch time: 535.5517 (ms) / GPU bubble ratio: 36.75%
[rank2]:2025-11-02 14:12:10,247 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1957  memory: 39.29GiB(28.10%)  tps: 6,825  tflops: 318.32  mfu: 32.19%
[rank1]:2025-11-02 14:12:10,247 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1957  memory: 48.76GiB(34.88%)  tps: 6,824  tflops: 318.27  mfu: 32.18%
[rank0]:2025-11-02 14:12:10,258 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1957  memory: 57.26GiB(40.95%)  tps: 6,821  tflops: 318.15  mfu: 32.17%
[rank3]:2025-11-02 14:12:10,233 - INFO -  step: 1250  loss:  0.3091  grad_norm:  0.1957  memory: 47.76GiB(34.16%)  tps: 6,826  tflops: 318.39  mfu: 32.19%
[rank0]:2025-11-02 14:13:45,568 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:13:47,349 - INFO - Avg. fwd time: 14.1751 / Avg. bwd time: 27.6482 / Avg. batch time: 433.9435 (ms) / GPU bubble ratio: 22.90%
[rank3]:2025-11-02 14:13:47,325 - INFO - Avg. fwd time: 16.2360 / Avg. bwd time: 29.2168 / Avg. batch time: 387.3003 (ms) / GPU bubble ratio: 6.11%
[rank1]:2025-11-02 14:13:47,392 - INFO - Avg. fwd time: 16.4032 / Avg. bwd time: 28.9997 / Avg. batch time: 483.1566 (ms) / GPU bubble ratio: 24.82%
[rank0]:2025-11-02 14:13:47,391 - INFO - Avg. fwd time: 13.9999 / Avg. bwd time: 27.8831 / Avg. batch time: 532.6617 (ms) / GPU bubble ratio: 37.10%
[rank2]:2025-11-02 14:13:47,512 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0516  memory: 39.29GiB(28.10%)  tps: 8,422  tflops: 392.82  mfu: 39.72%
[rank1]:2025-11-02 14:13:47,510 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0516  memory: 48.76GiB(34.88%)  tps: 8,422  tflops: 392.83  mfu: 39.72%
[rank0]:2025-11-02 14:13:47,520 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0516  memory: 57.26GiB(40.95%)  tps: 8,423  tflops: 392.83  mfu: 39.72%
[rank3]:2025-11-02 14:13:47,497 - INFO -  step: 1300  loss:  0.1924  grad_norm:  0.0516  memory: 47.76GiB(34.16%)  tps: 8,423  tflops: 392.83  mfu: 39.72%
[rank2]:2025-11-02 14:13:47,593 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1413_stage2_step1300.svg
[rank1]:2025-11-02 14:13:47,592 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1413_stage1_step1300.svg
[rank0]:2025-11-02 14:13:47,595 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1413_stage0_step1300.svg
[rank3]:2025-11-02 14:13:47,690 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1413_real_step1300_rank3.svg
[rank3]:> Batch Time: 445.07 ms, GPU Bubble Ratio: 44.35%, 26.51%, 33.48%, 33.63%
[rank3]:2025-11-02 14:13:47,757 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1413_stage3_step1300.svg
[rank0]:2025-11-02 14:15:23,911 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:15:25,754 - INFO - Avg. fwd time: 16.2803 / Avg. bwd time: 28.8788 / Avg. batch time: 384.7696 (ms) / GPU bubble ratio: 6.11%
[rank2]:2025-11-02 14:15:25,791 - INFO - Avg. fwd time: 14.2053 / Avg. bwd time: 27.4518 / Avg. batch time: 431.3428 (ms) / GPU bubble ratio: 22.74%
[rank1]:2025-11-02 14:15:25,839 - INFO - Avg. fwd time: 16.4362 / Avg. bwd time: 28.8085 / Avg. batch time: 480.7274 (ms) / GPU bubble ratio: 24.71%
[rank2]:2025-11-02 14:15:25,902 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0948  memory: 39.29GiB(28.10%)  tps: 8,326  tflops: 388.33  mfu: 39.26%
[rank1]:2025-11-02 14:15:25,901 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0948  memory: 48.76GiB(34.88%)  tps: 8,326  tflops: 388.33  mfu: 39.26%
[rank0]:2025-11-02 14:15:25,879 - INFO - Avg. fwd time: 14.0306 / Avg. bwd time: 27.4286 / Avg. batch time: 530.1203 (ms) / GPU bubble ratio: 37.43%
[rank0]:2025-11-02 14:15:25,914 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0948  memory: 57.26GiB(40.95%)  tps: 8,326  tflops: 388.31  mfu: 39.26%
[rank3]:2025-11-02 14:15:25,891 - INFO -  step: 1350  loss:  0.1294  grad_norm:  0.0948  memory: 47.76GiB(34.16%)  tps: 8,326  tflops: 388.32  mfu: 39.26%
[rank0]:2025-11-02 14:17:02,013 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:17:03,830 - INFO - Avg. fwd time: 16.3085 / Avg. bwd time: 28.6261 / Avg. batch time: 382.8161 (ms) / GPU bubble ratio: 6.10%
[rank1]:2025-11-02 14:17:03,904 - INFO - Avg. fwd time: 16.4568 / Avg. bwd time: 28.6589 / Avg. batch time: 478.8218 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-11-02 14:17:03,857 - INFO - Avg. fwd time: 14.2257 / Avg. bwd time: 27.2878 / Avg. batch time: 429.3130 (ms) / GPU bubble ratio: 22.64%
[rank0]:2025-11-02 14:17:03,898 - INFO - Avg. fwd time: 14.0511 / Avg. bwd time: 27.0591 / Avg. batch time: 528.1160 (ms) / GPU bubble ratio: 37.73%
[rank1]:2025-11-02 14:17:04,024 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1757  memory: 48.76GiB(34.88%)  tps: 8,349  tflops: 389.39  mfu: 39.37%
[rank1]:2025-11-02 14:17:04,024 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 14:17:04,026 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1757  memory: 39.29GiB(28.10%)  tps: 8,349  tflops: 389.38  mfu: 39.37%
[rank2]:2025-11-02 14:17:04,026 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 14:17:04,013 - INFO -  step: 1400  loss:  0.4111  grad_norm:  0.1757  memory: 47.76GiB(34.16%)  tps: 8,349  tflops: 389.39  mfu: 39.37%
[rank3]:2025-11-02 14:17:04,013 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 14:17:04,036 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1757  memory: 57.26GiB(40.95%)  tps: 8,349  tflops: 389.39  mfu: 39.37%
[rank0]:2025-11-02 14:17:04,036 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 14:17:20,912 - INFO - validate step: 1400  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,254
[rank0]:2025-11-02 14:17:20,877 - INFO - validate step: 1400  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,321
[rank3]:2025-11-02 14:17:20,938 - INFO - validate step: 1400  loss:  0.2543  memory: 47.76GiB(34.16%)  tps: 24,202
[rank2]:2025-11-02 14:17:20,928 - INFO - validate step: 1400  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,234
[rank1]:2025-11-02 14:17:21,024 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1417_stage1_step1400.svg
[rank0]:2025-11-02 14:17:21,015 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1417_stage0_step1400.svg
[rank2]:2025-11-02 14:17:21,013 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1417_stage2_step1400.svg
[rank3]:2025-11-02 14:17:21,107 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1417_real_step1400_rank3.svg
[rank3]:> Batch Time: 458.46 ms, GPU Bubble Ratio: 47.14%, 28.01%, 35.24%, 32.57%
[rank3]:2025-11-02 14:17:21,174 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1417_stage3_step1400.svg
[rank0]:2025-11-02 14:18:58,918 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:19:00,697 - INFO - Avg. fwd time: 16.3497 / Avg. bwd time: 28.3590 / Avg. batch time: 380.8207 (ms) / GPU bubble ratio: 6.08%
[rank2]:2025-11-02 14:19:00,725 - INFO - Avg. fwd time: 14.2546 / Avg. bwd time: 27.1246 / Avg. batch time: 427.2910 (ms) / GPU bubble ratio: 22.53%
[rank1]:2025-11-02 14:19:00,769 - INFO - Avg. fwd time: 16.4883 / Avg. bwd time: 28.4957 / Avg. batch time: 476.9475 (ms) / GPU bubble ratio: 24.55%
[rank0]:2025-11-02 14:19:00,765 - INFO - Avg. fwd time: 14.0807 / Avg. bwd time: 26.6700 / Avg. batch time: 526.1462 (ms) / GPU bubble ratio: 38.04%
[rank1]:2025-11-02 14:19:00,887 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1220  memory: 48.76GiB(34.88%)  tps: 8,194  tflops: 382.18  mfu: 38.64%
[rank0]:2025-11-02 14:19:00,898 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1220  memory: 57.26GiB(40.95%)  tps: 8,190  tflops: 382.00  mfu: 38.62%
[rank3]:2025-11-02 14:19:00,875 - INFO -  step: 1450  loss:  0.2269  grad_norm:  0.1220  memory: 47.76GiB(34.16%)  tps: 8,197  tflops: 382.32  mfu: 38.66%
[rank2]:2025-11-02 14:19:00,889 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1220  memory: 39.29GiB(28.10%)  tps: 8,195  tflops: 382.23  mfu: 38.65%
[rank0]:2025-11-02 14:20:39,139 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:20:41,084 - INFO - Avg. fwd time: 16.3898 / Avg. bwd time: 28.1142 / Avg. batch time: 379.0302 (ms) / GPU bubble ratio: 6.07%
[rank2]:2025-11-02 14:20:41,122 - INFO - Avg. fwd time: 14.2834 / Avg. bwd time: 26.9698 / Avg. batch time: 425.4375 (ms) / GPU bubble ratio: 22.43%
[rank1]:2025-11-02 14:20:41,167 - INFO - Avg. fwd time: 16.5189 / Avg. bwd time: 28.3450 / Avg. batch time: 475.2348 (ms) / GPU bubble ratio: 24.48%
[rank0]:2025-11-02 14:20:41,209 - INFO - Avg. fwd time: 14.1094 / Avg. bwd time: 26.2997 / Avg. batch time: 524.3625 (ms) / GPU bubble ratio: 38.35%
[rank1]:2025-11-02 14:20:41,233 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1388  memory: 48.76GiB(34.88%)  tps: 8,164  tflops: 380.76  mfu: 38.50%
[rank0]:2025-11-02 14:20:41,244 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1388  memory: 57.26GiB(40.95%)  tps: 8,164  tflops: 380.76  mfu: 38.50%
[rank3]:2025-11-02 14:20:41,227 - INFO -  step: 1500  loss:  0.2929  grad_norm:  0.1388  memory: 47.76GiB(34.16%)  tps: 8,163  tflops: 380.74  mfu: 38.50%
[rank2]:2025-11-02 14:20:41,234 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1388  memory: 39.29GiB(28.10%)  tps: 8,164  tflops: 380.76  mfu: 38.50%
[rank2]:2025-11-02 14:20:41,315 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1420_stage2_step1500.svg
[rank1]:2025-11-02 14:20:41,317 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1420_stage1_step1500.svg
[rank0]:2025-11-02 14:20:41,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1420_stage0_step1500.svg
[rank3]:2025-11-02 14:20:41,412 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1420_real_step1500_rank3.svg
[rank3]:> Batch Time: 468.98 ms, GPU Bubble Ratio: 46.29%, 28.57%, 35.92%, 32.63%
[rank3]:2025-11-02 14:20:41,480 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1420_stage3_step1500.svg
[rank0]:2025-11-02 14:22:18,937 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:22:20,733 - INFO - Avg. fwd time: 16.4235 / Avg. bwd time: 27.9049 / Avg. batch time: 377.5316 (ms) / GPU bubble ratio: 6.07%
[rank2]:2025-11-02 14:22:20,761 - INFO - Avg. fwd time: 14.3066 / Avg. bwd time: 26.8479 / Avg. batch time: 423.9053 (ms) / GPU bubble ratio: 22.33%
[rank1]:2025-11-02 14:22:20,804 - INFO - Avg. fwd time: 16.5434 / Avg. bwd time: 28.2293 / Avg. batch time: 473.8172 (ms) / GPU bubble ratio: 24.41%
[rank0]:2025-11-02 14:22:20,800 - INFO - Avg. fwd time: 14.1336 / Avg. bwd time: 26.0001 / Avg. batch time: 522.8785 (ms) / GPU bubble ratio: 38.60%
[rank1]:2025-11-02 14:22:20,921 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1662  memory: 48.76GiB(34.88%)  tps: 8,218  tflops: 383.27  mfu: 38.75%
[rank0]:2025-11-02 14:22:20,925 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1662  memory: 57.26GiB(40.95%)  tps: 8,218  tflops: 383.30  mfu: 38.76%
[rank3]:2025-11-02 14:22:20,908 - INFO -  step: 1550  loss:  0.3324  grad_norm:  0.1662  memory: 47.76GiB(34.16%)  tps: 8,218  tflops: 383.31  mfu: 38.76%
[rank2]:2025-11-02 14:22:20,923 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1662  memory: 39.29GiB(28.10%)  tps: 8,218  tflops: 383.27  mfu: 38.75%
[rank0]:2025-11-02 14:23:57,520 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:23:59,331 - INFO - Avg. fwd time: 16.4549 / Avg. bwd time: 27.6669 / Avg. batch time: 375.7482 (ms) / GPU bubble ratio: 6.06%
[rank2]:2025-11-02 14:23:59,355 - INFO - Avg. fwd time: 14.3274 / Avg. bwd time: 26.7115 / Avg. batch time: 422.0684 (ms) / GPU bubble ratio: 22.21%
[rank1]:2025-11-02 14:23:59,396 - INFO - Avg. fwd time: 16.5662 / Avg. bwd time: 28.0972 / Avg. batch time: 472.0979 (ms) / GPU bubble ratio: 24.32%
[rank0]:2025-11-02 14:23:59,396 - INFO - Avg. fwd time: 14.1547 / Avg. bwd time: 25.6727 / Avg. batch time: 521.0710 (ms) / GPU bubble ratio: 38.85%
[rank3]:2025-11-02 14:23:59,956 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1423_rank3_trend_line.svg
[rank1]:2025-11-02 14:24:00,050 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1423_rank1_trend_line.svg
[rank2]:2025-11-02 14:24:00,019 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1423_rank2_trend_line.svg
[rank1]:2025-11-02 14:24:00,099 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 14:24:00,101 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2528  memory: 48.76GiB(34.88%)  tps: 8,260  tflops: 385.24  mfu: 38.95%
[rank1]:2025-11-02 14:24:00,101 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 14:24:00,090 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule_adjustment/251102_1423_rank0_trend_line.svg
[rank0]:2025-11-02 14:24:00,097 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 14:24:00,100 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2528  memory: 57.26GiB(40.95%)  tps: 8,260  tflops: 385.26  mfu: 38.95%
[rank0]:2025-11-02 14:24:00,100 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 14:24:00,097 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.69/0.69, [MB2] 0.40/0.40, [MB3] 0.35/0.35, [MB4] 0.36/0.36, [MB5] 0.35/0.35, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 14:24:00,099 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2528  memory: 39.29GiB(28.10%)  tps: 8,260  tflops: 385.25  mfu: 38.95%
[rank2]:2025-11-02 14:24:00,099 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 14:24:00,289 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1423_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 392.61 ms, GPU Bubble Ratio: 29.16%, 23.65%, 26.56%, 26.46%
[rank3]:2025-11-02 14:24:00,289 - INFO - 	> Batch Time: 392.61 ms (Average Freeze Ratio: 0.57)
[rank3]:2025-11-02 14:24:00,290 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.80/0.80, [MB4] 0.77/0.77, [MB5] 0.79/0.79, [MB6] 0.78/0.78, [MB7] 1.00/1.00
[rank3]:2025-11-02 14:24:00,298 - INFO -  step: 1600  loss:  0.4835  grad_norm:  0.2528  memory: 47.76GiB(34.16%)  tps: 8,242  tflops: 384.43  mfu: 38.87%
[rank3]:2025-11-02 14:24:00,299 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 14:24:16,974 - INFO - validate step: 1600  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,274
[rank1]:2025-11-02 14:24:17,009 - INFO - validate step: 1600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,226
[rank3]:2025-11-02 14:24:17,032 - INFO - validate step: 1600  loss:  0.2557  memory: 47.76GiB(34.16%)  tps: 24,479
[rank2]:2025-11-02 14:24:17,025 - INFO - validate step: 1600  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,200
[rank1]:2025-11-02 14:24:17,110 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1424_stage1_step1600.svg
[rank0]:2025-11-02 14:24:17,108 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1424_stage0_step1600.svg
[rank2]:2025-11-02 14:24:17,107 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1424_stage2_step1600.svg
[rank3]:2025-11-02 14:24:17,201 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1424_real_step1600_rank3.svg
[rank3]:> Batch Time: 453.84 ms, GPU Bubble Ratio: 45.57%, 27.22%, 33.39%, 33.13%
[rank3]:2025-11-02 14:24:17,270 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1424_stage3_step1600.svg
[rank0]:2025-11-02 14:25:51,771 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:25:53,617 - INFO - Avg. fwd time: 16.4858 / Avg. bwd time: 27.4662 / Avg. batch time: 374.2143 (ms) / GPU bubble ratio: 6.04%
[rank2]:2025-11-02 14:25:53,655 - INFO - Avg. fwd time: 14.3492 / Avg. bwd time: 26.5915 / Avg. batch time: 420.4520 (ms) / GPU bubble ratio: 22.10%
[rank1]:2025-11-02 14:25:53,684 - INFO - Avg. fwd time: 16.6010 / Avg. bwd time: 27.8009 / Avg. batch time: 470.0666 (ms) / GPU bubble ratio: 24.43%
[rank1]:2025-11-02 14:25:53,736 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,469  tflops: 395.01  mfu: 39.94%
[rank0]:2025-11-02 14:25:53,728 - INFO - Avg. fwd time: 14.1717 / Avg. bwd time: 25.4331 / Avg. batch time: 519.0473 (ms) / GPU bubble ratio: 38.96%
[rank3]:2025-11-02 14:25:53,741 - INFO -  step: 1650  loss:  0.4481  grad_norm:  0.2310  memory: 47.76GiB(34.16%)  tps: 8,471  tflops: 395.09  mfu: 39.95%
[rank2]:2025-11-02 14:25:53,753 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.2310  memory: 39.29GiB(28.10%)  tps: 8,469  tflops: 395.00  mfu: 39.94%
[rank0]:2025-11-02 14:25:53,763 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.2310  memory: 57.26GiB(40.95%)  tps: 8,464  tflops: 394.75  mfu: 39.91%
[rank0]:2025-11-02 14:27:28,172 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:27:29,938 - INFO - Avg. fwd time: 16.5110 / Avg. bwd time: 27.3020 / Avg. batch time: 372.9553 (ms) / GPU bubble ratio: 6.02%
[rank1]:2025-11-02 14:27:29,962 - INFO - Avg. fwd time: 16.6294 / Avg. bwd time: 27.5551 / Avg. batch time: 468.3547 (ms) / GPU bubble ratio: 24.53%
[rank0]:2025-11-02 14:27:30,028 - INFO - Avg. fwd time: 14.1850 / Avg. bwd time: 25.2429 / Avg. batch time: 517.3374 (ms) / GPU bubble ratio: 39.03%
[rank2]:2025-11-02 14:27:29,967 - INFO - Avg. fwd time: 14.3670 / Avg. bwd time: 26.4960 / Avg. batch time: 419.0983 (ms) / GPU bubble ratio: 22.00%
[rank1]:2025-11-02 14:27:30,099 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,501  tflops: 396.50  mfu: 40.09%
[rank0]:2025-11-02 14:27:30,127 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2206  memory: 57.26GiB(40.95%)  tps: 8,501  tflops: 396.49  mfu: 40.09%
[rank3]:2025-11-02 14:27:30,108 - INFO -  step: 1700  loss:  0.4475  grad_norm:  0.2206  memory: 47.76GiB(34.16%)  tps: 8,501  tflops: 396.48  mfu: 40.09%
[rank2]:2025-11-02 14:27:30,116 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2206  memory: 39.29GiB(28.10%)  tps: 8,501  tflops: 396.50  mfu: 40.09%
[rank1]:2025-11-02 14:27:30,199 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1427_stage1_step1700.svg
[rank0]:2025-11-02 14:27:30,200 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1427_stage0_step1700.svg
[rank2]:2025-11-02 14:27:30,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1427_stage2_step1700.svg
[rank3]:2025-11-02 14:27:30,293 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1427_real_step1700_rank3.svg
[rank3]:> Batch Time: 439.56 ms, GPU Bubble Ratio: 39.75%, 34.11%, 30.57%, 30.66%
[rank3]:2025-11-02 14:27:30,360 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1427_stage3_step1700.svg
[rank0]:2025-11-02 14:29:04,658 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 14:29:06,469 - INFO - Avg. fwd time: 16.6601 / Avg. bwd time: 27.2836 / Avg. batch time: 466.4929 (ms) / GPU bubble ratio: 24.64%
[rank3]:2025-11-02 14:29:06,441 - INFO - Avg. fwd time: 16.5381 / Avg. bwd time: 27.1252 / Avg. batch time: 371.5913 (ms) / GPU bubble ratio: 6.00%
[rank2]:2025-11-02 14:29:06,471 - INFO - Avg. fwd time: 14.3862 / Avg. bwd time: 26.3861 / Avg. batch time: 417.6313 (ms) / GPU bubble ratio: 21.90%
[rank1]:2025-11-02 14:29:06,600 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,489  tflops: 395.93  mfu: 40.03%
[rank0]:2025-11-02 14:29:06,532 - INFO - Avg. fwd time: 14.1994 / Avg. bwd time: 25.0328 / Avg. batch time: 515.4888 (ms) / GPU bubble ratio: 39.11%
[rank3]:2025-11-02 14:29:06,604 - INFO -  step: 1750  loss:  0.4460  grad_norm:  0.2428  memory: 47.76GiB(34.16%)  tps: 8,490  tflops: 395.96  mfu: 40.04%
[rank2]:2025-11-02 14:29:06,618 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.2428  memory: 39.29GiB(28.10%)  tps: 8,489  tflops: 395.92  mfu: 40.03%
[rank0]:2025-11-02 14:29:06,628 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.2428  memory: 57.26GiB(40.95%)  tps: 8,489  tflops: 395.93  mfu: 40.03%
[rank0]:2025-11-02 14:30:38,880 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:30:40,655 - INFO - Avg. fwd time: 16.5543 / Avg. bwd time: 26.9431 / Avg. batch time: 370.1420 (ms) / GPU bubble ratio: 5.99%
[rank2]:2025-11-02 14:30:40,692 - INFO - Avg. fwd time: 14.3973 / Avg. bwd time: 26.2820 / Avg. batch time: 416.0822 (ms) / GPU bubble ratio: 21.79%
[rank1]:2025-11-02 14:30:40,721 - INFO - Avg. fwd time: 16.6808 / Avg. bwd time: 27.0228 / Avg. batch time: 464.5624 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-02 14:30:40,772 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,699  tflops: 405.72  mfu: 41.02%
[rank1]:2025-11-02 14:30:40,773 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 14:30:40,764 - INFO - Avg. fwd time: 14.2067 / Avg. bwd time: 24.8331 / Avg. batch time: 513.5590 (ms) / GPU bubble ratio: 39.19%
[rank3]:2025-11-02 14:30:40,782 - INFO -  step: 1800  loss:  0.0682  grad_norm:  0.0592  memory: 47.76GiB(34.16%)  tps: 8,699  tflops: 405.70  mfu: 41.02%
[rank3]:2025-11-02 14:30:40,782 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 14:30:40,790 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0592  memory: 39.29GiB(28.10%)  tps: 8,699  tflops: 405.72  mfu: 41.02%
[rank2]:2025-11-02 14:30:40,790 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 14:30:40,799 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0592  memory: 57.26GiB(40.95%)  tps: 8,699  tflops: 405.72  mfu: 41.02%
[rank0]:2025-11-02 14:30:40,799 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 14:30:57,451 - INFO - validate step: 1800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,559
[rank0]:2025-11-02 14:30:57,419 - INFO - validate step: 1800  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,646
[rank3]:2025-11-02 14:30:57,490 - INFO - validate step: 1800  loss:  0.2503  memory: 47.76GiB(34.16%)  tps: 24,516
[rank2]:2025-11-02 14:30:57,470 - INFO - validate step: 1800  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,558
[rank1]:2025-11-02 14:30:57,567 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1430_stage1_step1800.svg
[rank0]:2025-11-02 14:30:57,566 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1430_stage0_step1800.svg
[rank2]:2025-11-02 14:30:57,567 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1430_stage2_step1800.svg
[rank3]:2025-11-02 14:30:57,657 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1430_real_step1800_rank3.svg
[rank3]:> Batch Time: 431.33 ms, GPU Bubble Ratio: 39.83%, 34.87%, 30.59%, 29.24%
[rank3]:2025-11-02 14:30:57,724 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1430_stage3_step1800.svg
[rank0]:2025-11-02 14:32:29,756 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 14:32:31,478 - INFO - Avg. fwd time: 16.6972 / Avg. bwd time: 26.8104 / Avg. batch time: 462.9839 (ms) / GPU bubble ratio: 24.82%
[rank3]:2025-11-02 14:32:31,452 - INFO - Avg. fwd time: 16.5670 / Avg. bwd time: 26.7960 / Avg. batch time: 368.9446 (ms) / GPU bubble ratio: 5.97%
[rank2]:2025-11-02 14:32:31,482 - INFO - Avg. fwd time: 14.4055 / Avg. bwd time: 26.1962 / Avg. batch time: 414.8150 (ms) / GPU bubble ratio: 21.70%
[rank0]:2025-11-02 14:32:31,540 - INFO - Avg. fwd time: 14.2120 / Avg. bwd time: 24.6712 / Avg. batch time: 512.0024 (ms) / GPU bubble ratio: 39.25%
[rank1]:2025-11-02 14:32:31,610 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,700  tflops: 405.78  mfu: 41.03%
[rank0]:2025-11-02 14:32:31,637 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2115  memory: 57.26GiB(40.95%)  tps: 8,695  tflops: 405.52  mfu: 41.00%
[rank3]:2025-11-02 14:32:31,614 - INFO -  step: 1850  loss:  0.3792  grad_norm:  0.2115  memory: 47.76GiB(34.16%)  tps: 8,704  tflops: 405.93  mfu: 41.04%
[rank2]:2025-11-02 14:32:31,626 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2115  memory: 39.29GiB(28.10%)  tps: 8,700  tflops: 405.79  mfu: 41.03%
[rank0]:2025-11-02 14:34:03,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:34:04,832 - INFO - Avg. fwd time: 16.5781 / Avg. bwd time: 26.6292 / Avg. batch time: 367.5914 (ms) / GPU bubble ratio: 5.97%
[rank2]:2025-11-02 14:34:04,860 - INFO - Avg. fwd time: 14.4130 / Avg. bwd time: 26.0982 / Avg. batch time: 413.3480 (ms) / GPU bubble ratio: 21.59%
[rank0]:2025-11-02 14:34:04,916 - INFO - Avg. fwd time: 14.2161 / Avg. bwd time: 24.4915 / Avg. batch time: 510.2008 (ms) / GPU bubble ratio: 39.31%
[rank1]:2025-11-02 14:34:04,856 - INFO - Avg. fwd time: 16.7128 / Avg. bwd time: 26.5741 / Avg. batch time: 461.1687 (ms) / GPU bubble ratio: 24.91%
[rank0]:2025-11-02 14:34:05,013 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0694  memory: 57.26GiB(40.95%)  tps: 8,773  tflops: 409.18  mfu: 41.37%
[rank1]:2025-11-02 14:34:04,986 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,773  tflops: 409.18  mfu: 41.37%
[rank3]:2025-11-02 14:34:04,990 - INFO -  step: 1900  loss:  0.2021  grad_norm:  0.0694  memory: 47.76GiB(34.16%)  tps: 8,773  tflops: 409.19  mfu: 41.37%
[rank2]:2025-11-02 14:34:05,000 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0694  memory: 39.29GiB(28.10%)  tps: 8,773  tflops: 409.19  mfu: 41.37%
[rank0]:2025-11-02 14:34:05,089 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1434_stage0_step1900.svg
[rank1]:2025-11-02 14:34:05,088 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1434_stage1_step1900.svg
[rank2]:2025-11-02 14:34:05,089 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1434_stage2_step1900.svg
[rank3]:2025-11-02 14:34:05,178 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1434_real_step1900_rank3.svg
[rank3]:> Batch Time: 430.47 ms, GPU Bubble Ratio: 39.31%, 34.17%, 31.23%, 30.18%
[rank3]:2025-11-02 14:34:05,246 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1434_stage3_step1900.svg
[rank0]:2025-11-02 14:35:36,110 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:35:37,888 - INFO - Avg. fwd time: 16.5857 / Avg. bwd time: 26.4699 / Avg. batch time: 366.2652 (ms) / GPU bubble ratio: 5.96%
[rank2]:2025-11-02 14:35:37,925 - INFO - Avg. fwd time: 14.4197 / Avg. bwd time: 26.0004 / Avg. batch time: 411.9059 (ms) / GPU bubble ratio: 21.50%
[rank0]:2025-11-02 14:35:37,998 - INFO - Avg. fwd time: 14.2195 / Avg. bwd time: 24.3214 / Avg. batch time: 508.4632 (ms) / GPU bubble ratio: 39.36%
[rank3]:2025-11-02 14:35:38,011 - INFO -  step: 1950  loss:  0.1662  grad_norm:  0.0782  memory: 47.76GiB(34.16%)  tps: 8,807  tflops: 410.75  mfu: 41.53%
[rank1]:2025-11-02 14:35:37,954 - INFO - Avg. fwd time: 16.7271 / Avg. bwd time: 26.3499 / Avg. batch time: 459.3971 (ms) / GPU bubble ratio: 24.99%
[rank1]:2025-11-02 14:35:38,006 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,807  tflops: 410.74  mfu: 41.53%
[rank2]:2025-11-02 14:35:38,024 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0782  memory: 39.29GiB(28.10%)  tps: 8,806  tflops: 410.73  mfu: 41.53%
[rank0]:2025-11-02 14:35:38,033 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0782  memory: 57.26GiB(40.95%)  tps: 8,807  tflops: 410.75  mfu: 41.53%
[rank0]:2025-11-02 14:37:08,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:37:10,472 - INFO - Avg. fwd time: 16.5930 / Avg. bwd time: 26.3306 / Avg. batch time: 365.1451 (ms) / GPU bubble ratio: 5.96%
[rank1]:2025-11-02 14:37:10,497 - INFO - Avg. fwd time: 16.7385 / Avg. bwd time: 26.1671 / Avg. batch time: 457.9349 (ms) / GPU bubble ratio: 25.05%
[rank2]:2025-11-02 14:37:10,503 - INFO - Avg. fwd time: 14.4247 / Avg. bwd time: 25.9268 / Avg. batch time: 410.7133 (ms) / GPU bubble ratio: 21.40%
[rank0]:2025-11-02 14:37:10,560 - INFO - Avg. fwd time: 14.2219 / Avg. bwd time: 24.1826 / Avg. batch time: 507.0106 (ms) / GPU bubble ratio: 39.40%
[rank0]:2025-11-02 14:37:10,656 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0531  memory: 57.26GiB(40.95%)  tps: 8,844  tflops: 412.51  mfu: 41.71%
[rank0]:2025-11-02 14:37:10,656 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 14:37:10,630 - INFO -  step: 2000  loss:  0.2022  grad_norm:  0.0531  memory: 47.76GiB(34.16%)  tps: 8,845  tflops: 412.53  mfu: 41.71%
[rank3]:2025-11-02 14:37:10,631 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 14:37:10,629 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,845  tflops: 412.51  mfu: 41.71%
[rank1]:2025-11-02 14:37:10,629 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 14:37:10,647 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0531  memory: 39.29GiB(28.10%)  tps: 8,844  tflops: 412.51  mfu: 41.71%
[rank2]:2025-11-02 14:37:10,647 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 14:37:27,206 - INFO - validate step: 2000  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,749
[rank3]:2025-11-02 14:37:27,271 - INFO - validate step: 2000  loss:  0.2428  memory: 47.76GiB(34.16%)  tps: 24,617
[rank1]:2025-11-02 14:37:27,237 - INFO - validate step: 2000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,662
[rank2]:2025-11-02 14:37:27,256 - INFO - validate step: 2000  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,662
[rank0]:2025-11-02 14:37:27,351 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1437_stage0_step2000.svg
[rank1]:2025-11-02 14:37:27,351 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1437_stage1_step2000.svg
[rank2]:2025-11-02 14:37:27,350 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1437_stage2_step2000.svg
[rank3]:2025-11-02 14:37:27,441 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1437_real_step2000_rank3.svg
[rank3]:> Batch Time: 428.95 ms, GPU Bubble Ratio: 39.09%, 33.99%, 30.62%, 31.10%
[rank3]:2025-11-02 14:37:27,511 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1437_stage3_step2000.svg
[rank0]:2025-11-02 14:38:58,596 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 14:39:00,388 - INFO - Avg. fwd time: 14.2248 / Avg. bwd time: 24.0279 / Avg. batch time: 505.4516 (ms) / GPU bubble ratio: 39.46%
[rank3]:2025-11-02 14:39:00,302 - INFO - Avg. fwd time: 16.6012 / Avg. bwd time: 26.1911 / Avg. batch time: 363.9600 (ms) / GPU bubble ratio: 5.94%
[rank1]:2025-11-02 14:39:00,325 - INFO - Avg. fwd time: 16.7519 / Avg. bwd time: 25.9642 / Avg. batch time: 456.3801 (ms) / GPU bubble ratio: 25.12%
[rank2]:2025-11-02 14:39:00,328 - INFO - Avg. fwd time: 14.4305 / Avg. bwd time: 25.8396 / Avg. batch time: 409.4572 (ms) / GPU bubble ratio: 21.32%
[rank0]:2025-11-02 14:39:00,481 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0922  memory: 57.26GiB(40.95%)  tps: 8,783  tflops: 409.63  mfu: 41.42%
[rank3]:2025-11-02 14:39:00,458 - INFO -  step: 2050  loss:  0.2217  grad_norm:  0.0922  memory: 47.76GiB(34.16%)  tps: 8,791  tflops: 410.02  mfu: 41.46%
[rank1]:2025-11-02 14:39:00,454 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,788  tflops: 409.88  mfu: 41.44%
[rank2]:2025-11-02 14:39:00,471 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0922  memory: 39.29GiB(28.10%)  tps: 8,788  tflops: 409.89  mfu: 41.44%
[rank0]:2025-11-02 14:40:31,296 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:40:33,076 - INFO - Avg. fwd time: 16.6087 / Avg. bwd time: 26.0552 / Avg. batch time: 362.8222 (ms) / GPU bubble ratio: 5.93%
[rank1]:2025-11-02 14:40:33,144 - INFO - Avg. fwd time: 16.7640 / Avg. bwd time: 25.7713 / Avg. batch time: 454.8685 (ms) / GPU bubble ratio: 25.19%
[rank2]:2025-11-02 14:40:33,113 - INFO - Avg. fwd time: 14.4360 / Avg. bwd time: 25.7600 / Avg. batch time: 408.2288 (ms) / GPU bubble ratio: 21.23%
[rank3]:2025-11-02 14:40:33,201 - INFO -  step: 2100  loss:  0.2272  grad_norm:  0.0713  memory: 47.76GiB(34.16%)  tps: 8,833  tflops: 411.98  mfu: 41.66%
[rank0]:2025-11-02 14:40:33,188 - INFO - Avg. fwd time: 14.2276 / Avg. bwd time: 23.8813 / Avg. batch time: 503.9387 (ms) / GPU bubble ratio: 39.50%
[rank0]:2025-11-02 14:40:33,223 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0713  memory: 57.26GiB(40.95%)  tps: 8,833  tflops: 411.98  mfu: 41.66%
[rank1]:2025-11-02 14:40:33,197 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,833  tflops: 411.98  mfu: 41.66%
[rank2]:2025-11-02 14:40:33,211 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0713  memory: 39.29GiB(28.10%)  tps: 8,833  tflops: 411.99  mfu: 41.66%
[rank2]:2025-11-02 14:40:33,293 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1440_stage2_step2100.svg
[rank0]:2025-11-02 14:40:33,290 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1440_stage0_step2100.svg
[rank1]:2025-11-02 14:40:33,294 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1440_stage1_step2100.svg
[rank3]:2025-11-02 14:40:33,392 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1440_real_step2100_rank3.svg
[rank3]:> Batch Time: 432.34 ms, GPU Bubble Ratio: 39.50%, 34.25%, 30.90%, 29.57%
[rank3]:2025-11-02 14:40:33,455 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1440_stage3_step2100.svg
[rank0]:2025-11-02 14:42:04,044 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:42:05,720 - INFO - Avg. fwd time: 16.6153 / Avg. bwd time: 25.9360 / Avg. batch time: 361.8434 (ms) / GPU bubble ratio: 5.92%
[rank1]:2025-11-02 14:42:05,743 - INFO - Avg. fwd time: 16.7736 / Avg. bwd time: 25.6131 / Avg. batch time: 453.5969 (ms) / GPU bubble ratio: 25.24%
[rank2]:2025-11-02 14:42:05,747 - INFO - Avg. fwd time: 14.4404 / Avg. bwd time: 25.6953 / Avg. batch time: 407.1901 (ms) / GPU bubble ratio: 21.15%
[rank0]:2025-11-02 14:42:05,805 - INFO - Avg. fwd time: 14.2297 / Avg. bwd time: 23.7609 / Avg. batch time: 502.6930 (ms) / GPU bubble ratio: 39.54%
[rank3]:2025-11-02 14:42:05,877 - INFO -  step: 2150  loss:  0.1848  grad_norm:  0.0817  memory: 47.76GiB(34.16%)  tps: 8,840  tflops: 412.28  mfu: 41.69%
[rank1]:2025-11-02 14:42:05,872 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,839  tflops: 412.27  mfu: 41.69%
[rank0]:2025-11-02 14:42:05,900 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0817  memory: 57.26GiB(40.95%)  tps: 8,839  tflops: 412.27  mfu: 41.69%
[rank2]:2025-11-02 14:42:05,889 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0817  memory: 39.29GiB(28.10%)  tps: 8,839  tflops: 412.27  mfu: 41.69%
[rank0]:2025-11-02 14:43:36,335 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:43:38,013 - INFO - Avg. fwd time: 16.6223 / Avg. bwd time: 25.7956 / Avg. batch time: 360.7185 (ms) / GPU bubble ratio: 5.93%
[rank2]:2025-11-02 14:43:38,040 - INFO - Avg. fwd time: 14.4453 / Avg. bwd time: 25.6236 / Avg. batch time: 405.9849 (ms) / GPU bubble ratio: 21.04%
[rank1]:2025-11-02 14:43:38,036 - INFO - Avg. fwd time: 16.7843 / Avg. bwd time: 25.4371 / Avg. batch time: 452.1323 (ms) / GPU bubble ratio: 25.29%
[rank0]:2025-11-02 14:43:38,097 - INFO - Avg. fwd time: 14.2318 / Avg. bwd time: 23.6274 / Avg. batch time: 501.2534 (ms) / GPU bubble ratio: 39.58%
[rank3]:2025-11-02 14:43:38,165 - INFO -  step: 2200  loss:  0.1804  grad_norm:  0.0569  memory: 47.76GiB(34.16%)  tps: 8,877  tflops: 414.01  mfu: 41.86%
[rank3]:2025-11-02 14:43:38,166 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 14:43:38,163 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,876  tflops: 413.99  mfu: 41.86%
[rank1]:2025-11-02 14:43:38,163 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 14:43:38,190 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0569  memory: 57.26GiB(40.95%)  tps: 8,876  tflops: 413.99  mfu: 41.86%
[rank0]:2025-11-02 14:43:38,190 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 14:43:38,180 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0569  memory: 39.29GiB(28.10%)  tps: 8,876  tflops: 413.99  mfu: 41.86%
[rank2]:2025-11-02 14:43:38,180 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 14:43:54,816 - INFO - validate step: 2200  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,597
[rank0]:2025-11-02 14:43:54,784 - INFO - validate step: 2200  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,684
[rank2]:2025-11-02 14:43:54,835 - INFO - validate step: 2200  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,593
[rank3]:2025-11-02 14:43:54,855 - INFO - validate step: 2200  loss:  0.2421  memory: 47.76GiB(34.16%)  tps: 24,544
[rank1]:2025-11-02 14:43:54,925 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1443_stage1_step2200.svg
[rank0]:2025-11-02 14:43:54,924 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1443_stage0_step2200.svg
[rank2]:2025-11-02 14:43:54,924 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1443_stage2_step2200.svg
[rank3]:2025-11-02 14:43:55,025 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1443_real_step2200_rank3.svg
[rank3]:> Batch Time: 431.52 ms, GPU Bubble Ratio: 39.26%, 34.13%, 30.67%, 31.23%
[rank3]:2025-11-02 14:43:55,087 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1443_stage3_step2200.svg
[rank0]:2025-11-02 14:45:25,937 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:45:27,702 - INFO - Avg. fwd time: 16.6281 / Avg. bwd time: 25.6777 / Avg. batch time: 359.7129 (ms) / GPU bubble ratio: 5.91%
[rank2]:2025-11-02 14:45:27,740 - INFO - Avg. fwd time: 14.4504 / Avg. bwd time: 25.5500 / Avg. batch time: 404.9030 (ms) / GPU bubble ratio: 20.97%
[rank1]:2025-11-02 14:45:27,771 - INFO - Avg. fwd time: 16.7944 / Avg. bwd time: 25.2693 / Avg. batch time: 450.8040 (ms) / GPU bubble ratio: 25.35%
[rank1]:2025-11-02 14:45:27,824 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,808  tflops: 410.80  mfu: 41.54%
[rank0]:2025-11-02 14:45:27,816 - INFO - Avg. fwd time: 14.2337 / Avg. bwd time: 23.4999 / Avg. batch time: 499.9412 (ms) / GPU bubble ratio: 39.62%
[rank2]:2025-11-02 14:45:27,842 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1019  memory: 39.29GiB(28.10%)  tps: 8,808  tflops: 410.80  mfu: 41.54%
[rank3]:2025-11-02 14:45:27,827 - INFO -  step: 2250  loss:  0.2257  grad_norm:  0.1019  memory: 47.76GiB(34.16%)  tps: 8,811  tflops: 410.96  mfu: 41.55%
[rank0]:2025-11-02 14:45:27,851 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1019  memory: 57.26GiB(40.95%)  tps: 8,802  tflops: 410.54  mfu: 41.51%
[rank0]:2025-11-02 14:46:58,812 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:47:00,525 - INFO - Avg. fwd time: 14.4540 / Avg. bwd time: 25.4925 / Avg. batch time: 404.0543 (ms) / GPU bubble ratio: 20.91%
[rank3]:2025-11-02 14:47:00,497 - INFO - Avg. fwd time: 16.6329 / Avg. bwd time: 25.5836 / Avg. batch time: 358.9170 (ms) / GPU bubble ratio: 5.90%
[rank1]:2025-11-02 14:47:00,520 - INFO - Avg. fwd time: 16.8028 / Avg. bwd time: 25.1314 / Avg. batch time: 449.7525 (ms) / GPU bubble ratio: 25.41%
[rank0]:2025-11-02 14:47:00,581 - INFO - Avg. fwd time: 14.2351 / Avg. bwd time: 23.3951 / Avg. batch time: 498.8790 (ms) / GPU bubble ratio: 39.66%
[rank3]:2025-11-02 14:47:00,650 - INFO -  step: 2300  loss:  0.1966  grad_norm:  0.0983  memory: 47.76GiB(34.16%)  tps: 8,826  tflops: 411.63  mfu: 41.62%
[rank1]:2025-11-02 14:47:00,648 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,825  tflops: 411.62  mfu: 41.62%
[rank0]:2025-11-02 14:47:00,675 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0983  memory: 57.26GiB(40.95%)  tps: 8,825  tflops: 411.62  mfu: 41.62%
[rank2]:2025-11-02 14:47:00,662 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0983  memory: 39.29GiB(28.10%)  tps: 8,826  tflops: 411.63  mfu: 41.62%
[rank1]:2025-11-02 14:47:00,744 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1447_stage1_step2300.svg
[rank0]:2025-11-02 14:47:00,742 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1447_stage0_step2300.svg
[rank2]:2025-11-02 14:47:00,745 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1447_stage2_step2300.svg
[rank3]:2025-11-02 14:47:00,842 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1447_real_step2300_rank3.svg
[rank3]:> Batch Time: 424.26 ms, GPU Bubble Ratio: 38.30%, 33.07%, 30.74%, 30.49%
[rank3]:2025-11-02 14:47:00,904 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1447_stage3_step2300.svg
[rank0]:2025-11-02 14:48:31,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:48:33,512 - INFO - Avg. fwd time: 14.4580 / Avg. bwd time: 25.4278 / Avg. batch time: 403.0491 (ms) / GPU bubble ratio: 20.83%
[rank3]:2025-11-02 14:48:33,485 - INFO - Avg. fwd time: 16.6390 / Avg. bwd time: 25.4693 / Avg. batch time: 357.9703 (ms) / GPU bubble ratio: 5.90%
[rank1]:2025-11-02 14:48:33,508 - INFO - Avg. fwd time: 16.8125 / Avg. bwd time: 24.9774 / Avg. batch time: 448.5204 (ms) / GPU bubble ratio: 25.46%
[rank0]:2025-11-02 14:48:33,571 - INFO - Avg. fwd time: 14.2371 / Avg. bwd time: 23.2781 / Avg. batch time: 497.6763 (ms) / GPU bubble ratio: 39.70%
[rank3]:2025-11-02 14:48:33,642 - INFO -  step: 2350  loss:  0.1836  grad_norm:  0.0550  memory: 47.76GiB(34.16%)  tps: 8,810  tflops: 410.88  mfu: 41.54%
[rank1]:2025-11-02 14:48:33,637 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,810  tflops: 410.88  mfu: 41.55%
[rank0]:2025-11-02 14:48:33,664 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0550  memory: 57.26GiB(40.95%)  tps: 8,810  tflops: 410.88  mfu: 41.55%
[rank2]:2025-11-02 14:48:33,655 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0550  memory: 39.29GiB(28.10%)  tps: 8,809  tflops: 410.87  mfu: 41.54%
[rank0]:2025-11-02 14:50:04,525 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:50:06,312 - INFO - Avg. fwd time: 16.6452 / Avg. bwd time: 25.3654 / Avg. batch time: 357.1012 (ms) / GPU bubble ratio: 5.89%
[rank2]:2025-11-02 14:50:06,353 - INFO - Avg. fwd time: 14.4618 / Avg. bwd time: 25.3682 / Avg. batch time: 402.1144 (ms) / GPU bubble ratio: 20.76%
[rank3]:2025-11-02 14:50:06,440 - INFO -  step: 2400  loss:  0.1907  grad_norm:  0.0604  memory: 47.76GiB(34.16%)  tps: 8,828  tflops: 411.74  mfu: 41.63%
[rank3]:2025-11-02 14:50:06,440 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 14:50:06,383 - INFO - Avg. fwd time: 16.8217 / Avg. bwd time: 24.8300 / Avg. batch time: 447.3698 (ms) / GPU bubble ratio: 25.52%
[rank1]:2025-11-02 14:50:06,436 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,828  tflops: 411.72  mfu: 41.63%
[rank1]:2025-11-02 14:50:06,436 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 14:50:06,428 - INFO - Avg. fwd time: 14.2389 / Avg. bwd time: 23.1660 / Avg. batch time: 496.5313 (ms) / GPU bubble ratio: 39.73%
[rank0]:2025-11-02 14:50:06,463 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0604  memory: 57.26GiB(40.95%)  tps: 8,828  tflops: 411.73  mfu: 41.63%
[rank0]:2025-11-02 14:50:06,463 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 14:50:06,452 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0604  memory: 39.29GiB(28.10%)  tps: 8,828  tflops: 411.74  mfu: 41.63%
[rank2]:2025-11-02 14:50:06,452 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 14:50:23,063 - INFO - validate step: 2400  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,675
[rank0]:2025-11-02 14:50:23,064 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 14:50:23,073 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 14:50:23,115 - INFO - validate step: 2400  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,582
[rank2]:2025-11-02 14:50:23,116 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 14:50:23,126 - INFO - validate step: 2400  loss:  0.2408  memory: 47.76GiB(34.16%)  tps: 24,548
[rank3]:2025-11-02 14:50:23,127 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 14:50:23,096 - INFO - validate step: 2400  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,587
[rank1]:2025-11-02 14:50:23,097 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 14:50:33,820 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.70 seconds.
[rank1]:2025-11-02 14:50:38,402 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.30 seconds.
[rank3]:2025-11-02 14:50:39,629 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.50 seconds.
[rank0]:2025-11-02 14:50:41,400 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 14:50:41,490 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1450_stage1_step2400.svg
[rank0]:2025-11-02 14:50:41,404 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.34 seconds.
[rank2]:2025-11-02 14:50:41,491 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1450_stage2_step2400.svg
[rank0]:2025-11-02 14:50:41,535 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1450_stage0_step2400.svg
[rank3]:2025-11-02 14:50:41,670 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1450_real_step2400_rank3.svg
[rank3]:> Batch Time: 429.73 ms, GPU Bubble Ratio: 39.21%, 34.07%, 30.03%, 30.76%
[rank3]:2025-11-02 14:50:41,769 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1450_stage3_step2400.svg
[rank0]:2025-11-02 14:52:14,937 - INFO - [GC] Peforming periodical GC collection 2.43 seconds
[rank3]:2025-11-02 14:52:16,627 - INFO - Avg. fwd time: 16.6493 / Avg. bwd time: 25.2727 / Avg. batch time: 356.3323 (ms) / GPU bubble ratio: 5.88%
[rank1]:2025-11-02 14:52:16,650 - INFO - Avg. fwd time: 16.8288 / Avg. bwd time: 24.7087 / Avg. batch time: 446.3877 (ms) / GPU bubble ratio: 25.56%
[rank2]:2025-11-02 14:52:16,653 - INFO - Avg. fwd time: 14.4644 / Avg. bwd time: 25.3194 / Avg. batch time: 401.3115 (ms) / GPU bubble ratio: 20.69%
[rank0]:2025-11-02 14:52:16,711 - INFO - Avg. fwd time: 14.2410 / Avg. bwd time: 23.0736 / Avg. batch time: 495.5739 (ms) / GPU bubble ratio: 39.76%
[rank1]:2025-11-02 14:52:16,776 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 7,206  tflops: 336.10  mfu: 33.98%
[rank2]:2025-11-02 14:52:16,794 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1002  memory: 39.29GiB(28.10%)  tps: 7,206  tflops: 336.10  mfu: 33.98%
[rank3]:2025-11-02 14:52:16,780 - INFO -  step: 2450  loss:  0.2330  grad_norm:  0.1002  memory: 47.76GiB(34.16%)  tps: 7,208  tflops: 336.18  mfu: 33.99%
[rank0]:2025-11-02 14:52:16,803 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1002  memory: 57.26GiB(40.95%)  tps: 7,202  tflops: 335.92  mfu: 33.97%
[rank0]:2025-11-02 14:53:47,573 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:53:49,292 - INFO - Avg. fwd time: 14.4682 / Avg. bwd time: 25.2593 / Avg. batch time: 400.4244 (ms) / GPU bubble ratio: 20.63%
[rank3]:2025-11-02 14:53:49,265 - INFO - Avg. fwd time: 16.6549 / Avg. bwd time: 25.1751 / Avg. batch time: 355.5120 (ms) / GPU bubble ratio: 5.87%
[rank0]:2025-11-02 14:53:49,350 - INFO - Avg. fwd time: 14.2428 / Avg. bwd time: 22.9700 / Avg. batch time: 494.5060 (ms) / GPU bubble ratio: 39.80%
[rank1]:2025-11-02 14:53:49,289 - INFO - Avg. fwd time: 16.8373 / Avg. bwd time: 24.5728 / Avg. batch time: 445.3003 (ms) / GPU bubble ratio: 25.61%
[rank3]:2025-11-02 14:53:49,419 - INFO -  step: 2500  loss:  0.2144  grad_norm:  0.0873  memory: 47.76GiB(34.16%)  tps: 8,843  tflops: 412.44  mfu: 41.70%
[rank0]:2025-11-02 14:53:49,443 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0873  memory: 57.26GiB(40.95%)  tps: 8,843  tflops: 412.43  mfu: 41.70%
[rank1]:2025-11-02 14:53:49,416 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,843  tflops: 412.43  mfu: 41.70%
[rank2]:2025-11-02 14:53:49,433 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0873  memory: 39.29GiB(28.10%)  tps: 8,843  tflops: 412.44  mfu: 41.70%
[rank0]:2025-11-02 14:53:49,513 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1453_stage0_step2500.svg
[rank1]:2025-11-02 14:53:49,519 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1453_stage1_step2500.svg
[rank2]:2025-11-02 14:53:49,517 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1453_stage2_step2500.svg
[rank3]:2025-11-02 14:53:49,618 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1453_real_step2500_rank3.svg
[rank3]:> Batch Time: 430.78 ms, GPU Bubble Ratio: 39.26%, 34.07%, 31.02%, 31.08%
[rank3]:2025-11-02 14:53:49,686 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1453_stage3_step2500.svg
[rank0]:2025-11-02 14:55:21,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:55:23,683 - INFO - Avg. fwd time: 14.4754 / Avg. bwd time: 25.2064 / Avg. batch time: 399.6523 (ms) / GPU bubble ratio: 20.57%
[rank3]:2025-11-02 14:55:23,642 - INFO - Avg. fwd time: 16.6643 / Avg. bwd time: 25.0859 / Avg. batch time: 354.7927 (ms) / GPU bubble ratio: 5.86%
[rank1]:2025-11-02 14:55:23,716 - INFO - Avg. fwd time: 16.8486 / Avg. bwd time: 24.4448 / Avg. batch time: 444.3420 (ms) / GPU bubble ratio: 25.65%
[rank2]:2025-11-02 14:55:23,787 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1767  memory: 39.29GiB(28.10%)  tps: 8,682  tflops: 404.94  mfu: 40.94%
[rank3]:2025-11-02 14:55:23,781 - INFO -  step: 2550  loss:  0.4692  grad_norm:  0.1767  memory: 47.76GiB(34.16%)  tps: 8,682  tflops: 404.91  mfu: 40.94%
[rank0]:2025-11-02 14:55:23,762 - INFO - Avg. fwd time: 14.2466 / Avg. bwd time: 22.8709 / Avg. batch time: 493.5571 (ms) / GPU bubble ratio: 39.84%
[rank0]:2025-11-02 14:55:23,797 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1767  memory: 57.26GiB(40.95%)  tps: 8,682  tflops: 404.94  mfu: 40.94%
[rank1]:2025-11-02 14:55:23,770 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,682  tflops: 404.94  mfu: 40.94%
[rank0]:2025-11-02 14:56:56,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:56:58,033 - INFO - Avg. fwd time: 14.4824 / Avg. bwd time: 25.1626 / Avg. batch time: 399.0117 (ms) / GPU bubble ratio: 20.51%
[rank3]:2025-11-02 14:56:58,008 - INFO - Avg. fwd time: 16.6742 / Avg. bwd time: 25.0113 / Avg. batch time: 354.2089 (ms) / GPU bubble ratio: 5.85%
[rank0]:2025-11-02 14:56:58,098 - INFO - Avg. fwd time: 14.2507 / Avg. bwd time: 22.7894 / Avg. batch time: 492.7778 (ms) / GPU bubble ratio: 39.87%
[rank1]:2025-11-02 14:56:58,030 - INFO - Avg. fwd time: 16.8595 / Avg. bwd time: 24.3401 / Avg. batch time: 443.5485 (ms) / GPU bubble ratio: 25.69%
[rank3]:2025-11-02 14:56:58,169 - INFO -  step: 2600  loss:  0.3998  grad_norm:  0.1349  memory: 47.76GiB(34.16%)  tps: 8,679  tflops: 404.80  mfu: 40.93%
[rank3]:2025-11-02 14:56:58,170 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 14:56:58,188 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1349  memory: 57.26GiB(40.95%)  tps: 8,679  tflops: 404.78  mfu: 40.93%
[rank0]:2025-11-02 14:56:58,189 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 14:56:58,161 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,679  tflops: 404.78  mfu: 40.93%
[rank1]:2025-11-02 14:56:58,161 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 14:56:58,178 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1349  memory: 39.29GiB(28.10%)  tps: 8,679  tflops: 404.78  mfu: 40.93%
[rank2]:2025-11-02 14:56:58,178 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 14:57:14,777 - INFO - validate step: 2600  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,692
[rank1]:2025-11-02 14:57:14,809 - INFO - validate step: 2600  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,604
[rank2]:2025-11-02 14:57:14,828 - INFO - validate step: 2600  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,602
[rank3]:2025-11-02 14:57:14,841 - INFO - validate step: 2600  loss:  0.2433  memory: 47.76GiB(34.16%)  tps: 24,569
[rank1]:2025-11-02 14:57:14,916 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1457_stage1_step2600.svg
[rank2]:2025-11-02 14:57:14,917 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1457_stage2_step2600.svg
[rank0]:2025-11-02 14:57:14,915 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1457_stage0_step2600.svg
[rank3]:2025-11-02 14:57:15,012 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1457_real_step2600_rank3.svg
[rank3]:> Batch Time: 432.39 ms, GPU Bubble Ratio: 39.17%, 33.51%, 30.99%, 30.30%
[rank3]:2025-11-02 14:57:15,077 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1457_stage3_step2600.svg
[rank0]:2025-11-02 14:58:47,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:58:49,471 - INFO - Avg. fwd time: 16.6850 / Avg. bwd time: 24.9301 / Avg. batch time: 353.5782 (ms) / GPU bubble ratio: 5.84%
[rank1]:2025-11-02 14:58:49,493 - INFO - Avg. fwd time: 16.8716 / Avg. bwd time: 24.2223 / Avg. batch time: 442.7177 (ms) / GPU bubble ratio: 25.74%
[rank2]:2025-11-02 14:58:49,497 - INFO - Avg. fwd time: 14.4895 / Avg. bwd time: 25.1169 / Avg. batch time: 398.3536 (ms) / GPU bubble ratio: 20.46%
[rank0]:2025-11-02 14:58:49,558 - INFO - Avg. fwd time: 14.2556 / Avg. bwd time: 22.6986 / Avg. batch time: 491.9405 (ms) / GPU bubble ratio: 39.90%
[rank2]:2025-11-02 14:58:49,638 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0941  memory: 39.29GiB(28.10%)  tps: 8,640  tflops: 402.99  mfu: 40.75%
[rank3]:2025-11-02 14:58:49,625 - INFO -  step: 2650  loss:  0.3210  grad_norm:  0.0941  memory: 47.76GiB(34.16%)  tps: 8,643  tflops: 403.11  mfu: 40.76%
[rank0]:2025-11-02 14:58:49,649 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0941  memory: 57.26GiB(40.95%)  tps: 8,635  tflops: 402.73  mfu: 40.72%
[rank1]:2025-11-02 14:58:49,622 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,640  tflops: 402.98  mfu: 40.75%
[rank0]:2025-11-02 15:00:22,397 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:00:24,218 - INFO - Avg. fwd time: 16.6958 / Avg. bwd time: 24.8500 / Avg. batch time: 352.9623 (ms) / GPU bubble ratio: 5.84%
[rank2]:2025-11-02 15:00:24,259 - INFO - Avg. fwd time: 14.4963 / Avg. bwd time: 25.0716 / Avg. batch time: 397.6878 (ms) / GPU bubble ratio: 20.40%
[rank3]:2025-11-02 15:00:24,352 - INFO -  step: 2700  loss:  0.3518  grad_norm:  0.1093  memory: 47.76GiB(34.16%)  tps: 8,648  tflops: 403.35  mfu: 40.78%
[rank0]:2025-11-02 15:00:24,341 - INFO - Avg. fwd time: 14.2606 / Avg. bwd time: 22.6116 / Avg. batch time: 491.1276 (ms) / GPU bubble ratio: 39.94%
[rank1]:2025-11-02 15:00:24,292 - INFO - Avg. fwd time: 16.8832 / Avg. bwd time: 24.1090 / Avg. batch time: 441.8878 (ms) / GPU bubble ratio: 25.79%
[rank1]:2025-11-02 15:00:24,349 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,648  tflops: 403.35  mfu: 40.78%
[rank2]:2025-11-02 15:00:24,366 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1093  memory: 39.29GiB(28.10%)  tps: 8,648  tflops: 403.34  mfu: 40.78%
[rank2]:2025-11-02 15:00:24,448 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1500_stage2_step2700.svg
[rank0]:2025-11-02 15:00:24,376 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1093  memory: 57.26GiB(40.95%)  tps: 8,648  tflops: 403.35  mfu: 40.78%
[rank0]:2025-11-02 15:00:24,448 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1500_stage0_step2700.svg
[rank1]:2025-11-02 15:00:24,448 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1500_stage1_step2700.svg
[rank3]:2025-11-02 15:00:24,544 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1500_real_step2700_rank3.svg
[rank3]:> Batch Time: 437.63 ms, GPU Bubble Ratio: 39.82%, 34.38%, 30.98%, 30.69%
[rank3]:2025-11-02 15:00:24,609 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1500_stage3_step2700.svg
[rank0]:2025-11-02 15:01:57,134 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:01:58,856 - INFO - Avg. fwd time: 16.7038 / Avg. bwd time: 24.7870 / Avg. batch time: 352.4688 (ms) / GPU bubble ratio: 5.83%
[rank2]:2025-11-02 15:01:58,881 - INFO - Avg. fwd time: 14.5019 / Avg. bwd time: 25.0344 / Avg. batch time: 397.1540 (ms) / GPU bubble ratio: 20.36%
[rank1]:2025-11-02 15:01:58,877 - INFO - Avg. fwd time: 16.8927 / Avg. bwd time: 24.0154 / Avg. batch time: 441.2172 (ms) / GPU bubble ratio: 25.83%
[rank0]:2025-11-02 15:01:58,942 - INFO - Avg. fwd time: 14.2646 / Avg. bwd time: 22.5396 / Avg. batch time: 490.4619 (ms) / GPU bubble ratio: 39.97%
[rank0]:2025-11-02 15:01:59,032 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0925  memory: 57.26GiB(40.95%)  tps: 8,655  tflops: 403.65  mfu: 40.81%
[rank3]:2025-11-02 15:01:59,007 - INFO -  step: 2750  loss:  0.2931  grad_norm:  0.0925  memory: 47.76GiB(34.16%)  tps: 8,655  tflops: 403.66  mfu: 40.81%
[rank2]:2025-11-02 15:01:59,021 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0925  memory: 39.29GiB(28.10%)  tps: 8,655  tflops: 403.65  mfu: 40.81%
[rank1]:2025-11-02 15:01:59,005 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,655  tflops: 403.65  mfu: 40.81%
[rank0]:2025-11-02 15:03:31,871 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 15:03:33,645 - INFO - Avg. fwd time: 16.9033 / Avg. bwd time: 23.9097 / Avg. batch time: 440.4575 (ms) / GPU bubble ratio: 25.87%
[rank3]:2025-11-02 15:03:33,623 - INFO - Avg. fwd time: 16.7133 / Avg. bwd time: 24.7118 / Avg. batch time: 351.9119 (ms) / GPU bubble ratio: 5.83%
[rank2]:2025-11-02 15:03:33,649 - INFO - Avg. fwd time: 14.5083 / Avg. bwd time: 24.9943 / Avg. batch time: 396.5487 (ms) / GPU bubble ratio: 20.31%
[rank3]:2025-11-02 15:03:33,777 - INFO -  step: 2800  loss:  0.2925  grad_norm:  0.0921  memory: 47.76GiB(34.16%)  tps: 8,644  tflops: 403.17  mfu: 40.76%
[rank3]:2025-11-02 15:03:33,777 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 15:03:33,708 - INFO - Avg. fwd time: 14.2689 / Avg. bwd time: 22.4584 / Avg. batch time: 489.7027 (ms) / GPU bubble ratio: 40.00%
[rank0]:2025-11-02 15:03:33,802 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0921  memory: 57.26GiB(40.95%)  tps: 8,644  tflops: 403.16  mfu: 40.76%
[rank0]:2025-11-02 15:03:33,802 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 15:03:33,791 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0921  memory: 39.29GiB(28.10%)  tps: 8,644  tflops: 403.16  mfu: 40.76%
[rank2]:2025-11-02 15:03:33,791 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 15:03:33,775 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,644  tflops: 403.16  mfu: 40.76%
[rank1]:2025-11-02 15:03:33,775 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 15:03:50,458 - INFO - validate step: 2800  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 24,593
[rank2]:2025-11-02 15:03:50,509 - INFO - validate step: 2800  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 24,502
[rank1]:2025-11-02 15:03:50,490 - INFO - validate step: 2800  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 24,505
[rank3]:2025-11-02 15:03:50,522 - INFO - validate step: 2800  loss:  0.2420  memory: 47.76GiB(34.16%)  tps: 24,462
[rank0]:2025-11-02 15:03:50,595 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1503_stage0_step2800.svg
[rank2]:2025-11-02 15:03:50,597 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1503_stage2_step2800.svg
[rank1]:2025-11-02 15:03:50,598 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1503_stage1_step2800.svg
[rank3]:2025-11-02 15:03:50,697 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1503_real_step2800_rank3.svg
[rank3]:> Batch Time: 439.40 ms, GPU Bubble Ratio: 40.16%, 34.84%, 31.27%, 29.74%
[rank3]:2025-11-02 15:03:50,763 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1503_stage3_step2800.svg
[rank0]:2025-11-02 15:05:23,228 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:05:25,040 - INFO - Avg. fwd time: 16.7227 / Avg. bwd time: 24.6386 / Avg. batch time: 351.3442 (ms) / GPU bubble ratio: 5.82%
[rank2]:2025-11-02 15:05:25,081 - INFO - Avg. fwd time: 14.5146 / Avg. bwd time: 24.9582 / Avg. batch time: 395.9535 (ms) / GPU bubble ratio: 20.25%
[rank1]:2025-11-02 15:05:25,115 - INFO - Avg. fwd time: 16.9140 / Avg. bwd time: 23.8083 / Avg. batch time: 439.7153 (ms) / GPU bubble ratio: 25.91%
[rank3]:2025-11-02 15:05:25,174 - INFO -  step: 2850  loss:  0.4032  grad_norm:  0.1408  memory: 47.76GiB(34.16%)  tps: 8,655  tflops: 403.67  mfu: 40.82%
[rank0]:2025-11-02 15:05:25,163 - INFO - Avg. fwd time: 14.2731 / Avg. bwd time: 22.3797 / Avg. batch time: 488.9724 (ms) / GPU bubble ratio: 40.03%
[rank2]:2025-11-02 15:05:25,188 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1408  memory: 39.29GiB(28.10%)  tps: 8,652  tflops: 403.55  mfu: 40.80%
[rank1]:2025-11-02 15:05:25,172 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,652  tflops: 403.54  mfu: 40.80%
[rank0]:2025-11-02 15:05:25,198 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1408  memory: 57.26GiB(40.95%)  tps: 8,647  tflops: 403.29  mfu: 40.78%
[rank0]:2025-11-02 15:06:57,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 15:06:59,630 - INFO - Avg. fwd time: 16.9225 / Avg. bwd time: 23.7242 / Avg. batch time: 439.1135 (ms) / GPU bubble ratio: 25.95%
[rank3]:2025-11-02 15:06:59,607 - INFO - Avg. fwd time: 16.7303 / Avg. bwd time: 24.5820 / Avg. batch time: 350.8901 (ms) / GPU bubble ratio: 5.81%
[rank2]:2025-11-02 15:06:59,632 - INFO - Avg. fwd time: 14.5193 / Avg. bwd time: 24.9252 / Avg. batch time: 395.4747 (ms) / GPU bubble ratio: 20.21%
[rank3]:2025-11-02 15:06:59,759 - INFO -  step: 2900  loss:  0.3837  grad_norm:  0.1062  memory: 47.76GiB(34.16%)  tps: 8,661  tflops: 403.95  mfu: 40.84%
[rank0]:2025-11-02 15:06:59,692 - INFO - Avg. fwd time: 14.2763 / Avg. bwd time: 22.3145 / Avg. batch time: 488.3618 (ms) / GPU bubble ratio: 40.06%
[rank2]:2025-11-02 15:06:59,770 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1062  memory: 39.29GiB(28.10%)  tps: 8,661  tflops: 403.96  mfu: 40.85%
[rank1]:2025-11-02 15:06:59,755 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,661  tflops: 403.96  mfu: 40.85%
[rank0]:2025-11-02 15:06:59,782 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1062  memory: 57.26GiB(40.95%)  tps: 8,661  tflops: 403.95  mfu: 40.84%
[rank0]:2025-11-02 15:06:59,855 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1506_stage0_step2900.svg
[rank2]:2025-11-02 15:06:59,857 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1506_stage2_step2900.svg
[rank1]:2025-11-02 15:06:59,858 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1506_stage1_step2900.svg
[rank3]:2025-11-02 15:06:59,949 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1506_real_step2900_rank3.svg
[rank3]:> Batch Time: 433.62 ms, GPU Bubble Ratio: 39.39%, 33.87%, 30.88%, 29.25%
[rank3]:2025-11-02 15:07:00,016 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1506_stage3_step2900.svg
[rank0]:2025-11-02 15:08:33,014 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:08:34,778 - INFO - Avg. fwd time: 14.5250 / Avg. bwd time: 24.8875 / Avg. batch time: 394.9754 (ms) / GPU bubble ratio: 20.17%
[rank1]:2025-11-02 15:08:34,776 - INFO - Avg. fwd time: 16.9325 / Avg. bwd time: 23.6293 / Avg. batch time: 438.4752 (ms) / GPU bubble ratio: 25.99%
[rank3]:2025-11-02 15:08:34,747 - INFO - Avg. fwd time: 16.7388 / Avg. bwd time: 24.5208 / Avg. batch time: 350.4197 (ms) / GPU bubble ratio: 5.81%
[rank0]:2025-11-02 15:08:34,836 - INFO - Avg. fwd time: 14.2806 / Avg. bwd time: 22.2414 / Avg. batch time: 487.7181 (ms) / GPU bubble ratio: 40.09%
[rank1]:2025-11-02 15:08:34,900 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,610  tflops: 401.57  mfu: 40.60%
[rank3]:2025-11-02 15:08:34,902 - INFO -  step: 2950  loss:  0.4358  grad_norm:  0.2107  memory: 47.76GiB(34.16%)  tps: 8,610  tflops: 401.59  mfu: 40.61%
[rank0]:2025-11-02 15:08:34,927 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2107  memory: 57.26GiB(40.95%)  tps: 8,610  tflops: 401.57  mfu: 40.60%
[rank2]:2025-11-02 15:08:34,918 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2107  memory: 39.29GiB(28.10%)  tps: 8,610  tflops: 401.56  mfu: 40.60%
[rank0]:2025-11-02 15:10:07,527 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:10:09,338 - INFO - Avg. fwd time: 16.7473 / Avg. bwd time: 24.4531 / Avg. batch time: 349.9090 (ms) / GPU bubble ratio: 5.80%
[rank2]:2025-11-02 15:10:09,379 - INFO - Avg. fwd time: 14.5309 / Avg. bwd time: 24.8525 / Avg. batch time: 394.4252 (ms) / GPU bubble ratio: 20.12%
[rank1]:2025-11-02 15:10:09,413 - INFO - Avg. fwd time: 16.9420 / Avg. bwd time: 23.5380 / Avg. batch time: 437.7926 (ms) / GPU bubble ratio: 26.03%
[rank1]:2025-11-02 15:10:09,470 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 48.76GiB(34.88%)  tps: 8,662  tflops: 404.02  mfu: 40.85%
[rank1]:2025-11-02 15:10:09,470 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 8,098  tflops: 377.70  mfu: 37.67%
[rank1]:2025-11-02 15:10:09,470 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 15:10:09,473 - INFO -  step: 3000  loss:  0.3520  grad_norm:  0.1394  memory: 47.76GiB(34.16%)  tps: 8,662  tflops: 404.01  mfu: 40.85%
[rank3]:2025-11-02 15:10:09,474 - INFO -  final step: 3000  loss:  0.3520  grad_norm:  0.1394  tps: 8,100  tflops: 377.77  mfu: 37.68%
[rank3]:2025-11-02 15:10:09,474 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 15:10:09,461 - INFO - Avg. fwd time: 14.2844 / Avg. bwd time: 22.1711 / Avg. batch time: 487.0511 (ms) / GPU bubble ratio: 40.12%
[rank0]:2025-11-02 15:10:09,496 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1394  memory: 57.26GiB(40.95%)  tps: 8,662  tflops: 404.02  mfu: 40.85%
[rank0]:2025-11-02 15:10:09,497 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1394  tps: 8,097  tflops: 377.63  mfu: 37.67%
[rank0]:2025-11-02 15:10:09,497 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-02 15:10:09,489 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1394  memory: 39.29GiB(28.10%)  tps: 8,662  tflops: 404.01  mfu: 40.85%
[rank2]:2025-11-02 15:10:09,489 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1394  tps: 8,098  tflops: 377.67  mfu: 37.67%
[rank2]:2025-11-02 15:10:09,489 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-02 15:10:27,076 - INFO - validate step: 3000  loss: -1.0000  memory: 48.76GiB(34.88%)  tps: 23,265
[rank1]:2025-11-02 15:10:27,077 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 15:10:27,080 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 15:10:27,105 - INFO - validate step: 3000  loss:  0.2438  memory: 47.76GiB(34.16%)  tps: 23,232
[rank3]:2025-11-02 15:10:27,106 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 15:10:27,110 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 15:10:27,043 - INFO - validate step: 3000  loss: -1.0000  memory: 57.26GiB(40.95%)  tps: 23,344
[rank0]:2025-11-02 15:10:27,043 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 15:10:27,049 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 15:10:27,094 - INFO - validate step: 3000  loss: -1.0000  memory: 39.29GiB(28.10%)  tps: 23,266
[rank2]:2025-11-02 15:10:27,095 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 15:10:27,098 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 15:10:36,917 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-02 15:10:37,014 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251102_1510_stage1_final3000.svg
[rank0]:2025-11-02 15:10:37,010 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251102_1510_stage0_final3000.svg
[rank2]:2025-11-02 15:10:37,016 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251102_1510_stage2_final3000.svg
[rank3]:2025-11-02 15:10:37,111 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1510_real_final3000_rank3.svg
[rank3]:> Batch Time: 432.93 ms, GPU Bubble Ratio: 39.37%, 33.84%, 30.31%, 30.16%
[rank2]:2025-11-02 15:10:37,261 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251102_1510_rank2_stage2.svg
[rank2]:	> Counts Sum: 2781600, Total Sum: 5829120 (47.72%), Ratio(%) per element: [46.09, 46.29, 48.02, 47.33, 47.82, 46.73, 46.14, 49.55, 46.39, 48.76, 47.92, 47.13, 48.86, 47.28, 49.55, 48.12, 46.73, 47.67, 46.24, 49.06, 47.23, 47.33, 47.57, 47.77, 47.52, 48.76, 47.33, 48.22, 47.38, 48.32, 46.59, 47.62, 49.06, 47.48, 49.45, 48.07, 48.81, 48.27, 45.3, 48.22, 48.51, 47.67, 47.28, 46.19, 47.77, 47.97, 46.49, 47.38, 47.23, 47.43, 47.87, 47.82, 46.24, 45.84, 49.2, 47.38, 49.16, 48.56, 46.54, 48.86, 47.82, 48.96, 47.33, 48.22, 47.97, 47.77, 47.33, 49.9, 47.82, 47.18, 48.17, 47.62]
[rank2]:2025-11-02 15:10:37,261 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 15:10:37,262 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251102_1510_rank1_stage1.svg
[rank1]:	> Counts Sum: 2174400, Total Sum: 6557760 (33.16%), Ratio(%) per element: [32.7, 33.54, 33.05, 33.54, 34.28, 32.31, 32.46, 34.14, 33.69, 33.1, 33.1, 33.89, 33.25, 32.8, 33.15, 33.05, 33.2, 33.64, 32.9, 33.15, 33.2, 33.34, 32.8, 33.2, 33.25, 33.34, 33.05, 33.54, 32.9, 33.0, 32.75, 33.2, 33.59, 32.6, 33.2, 33.44, 32.65, 32.65, 32.5, 33.44, 33.49, 33.1, 33.0, 33.05, 32.65, 33.39, 33.15, 33.15, 33.74, 32.8, 33.49, 33.34, 33.99, 32.85, 34.09, 32.75, 33.3, 33.34, 33.2, 32.46, 32.26, 33.54, 33.49, 32.75, 33.34, 33.49, 33.3, 32.85, 33.05, 33.69, 33.15, 32.7, 32.8, 33.2, 32.95, 33.1, 33.3, 32.8, 33.1, 33.1, 32.5]
[rank1]:2025-11-02 15:10:37,262 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 15:10:37,285 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251102_1510_thry_final3000_rank3.svg
[rank3]:> Batch Time: 524.62 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank0]:2025-11-02 15:10:37,247 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251102_1510_rank0_stage0.svg
[rank0]:	> Counts Sum: 4884880, Total Sum: 5910080 (82.65%), Ratio(%) per element: [79.19, 79.19, 78.6, 79.15, 79.05, 79.69, 79.29, 79.1, 80.03, 79.54, 79.59, 79.99, 80.73, 80.58, 80.97, 79.74, 80.68, 80.08, 80.53, 80.63, 80.38, 80.97, 81.71, 80.48, 80.73, 81.52, 81.71, 81.27, 81.12, 81.12, 81.07, 81.32, 82.55, 82.41, 81.96, 81.37, 82.21, 82.31, 82.21, 82.7, 82.9, 83.99, 83.49, 83.3, 83.49, 84.38, 83.74, 83.64, 83.54, 84.18, 83.64, 83.74, 84.09, 84.23, 84.83, 84.93, 84.04, 85.37, 86.06, 85.07, 85.57, 86.06, 85.42, 86.21, 86.41, 85.67, 86.61, 86.26, 86.41, 86.66, 87.1, 87.3, 87.54]
[rank0]:2025-11-02 15:10:37,247 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-02 15:10:37,353 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251102_1510_stage3_final3000.svg
[rank3]:2025-11-02 15:10:37,579 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251102_1510_rank3_stage3.svg
[rank3]:	> Counts Sum: 634480, Total Sum: 5262400 (12.06%), Ratio(%) per element: [11.85, 12.05, 11.66, 12.64, 12.89, 11.75, 12.4, 12.64, 10.47, 11.7, 11.9, 12.2, 12.64, 11.85, 12.05, 11.85, 11.16, 12.79, 11.31, 11.8, 11.9, 12.54, 12.25, 11.85, 10.22, 12.05, 11.21, 12.3, 12.84, 12.0, 10.96, 12.4, 12.99, 11.85, 12.3, 10.72, 12.1, 11.66, 13.04, 12.3, 11.75, 11.61, 13.04, 12.4, 12.89, 11.66, 13.19, 12.94, 11.16, 12.05, 12.4, 11.51, 11.95, 12.4, 12.1, 12.4, 11.75, 12.25, 11.41, 11.66, 11.66, 12.2, 13.14, 12.35, 12.45]
[rank3]:2025-11-02 15:10:37,580 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 60-60, summary, console lines 460-467
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.02278
[rank3]:wandb:               final/avg_loss 0.35195
[rank3]:wandb:             final/avg_mfu(%) 37.67862
[rank3]:wandb:             final/avg_tflops 377.77321
[rank3]:wandb:    final/avg_throughput(tps) 8099.74078
[rank3]:wandb:              final/grad_norm 0.1394
[rank3]:wandb:               final/max_loss 0.35195
[rank3]:wandb:                    grad_norm 0.1394
[rank3]:wandb: loss_metrics/global_avg_loss 0.35195
[rank3]:wandb: loss_metrics/global_max_loss 0.35195
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_fullrand7_h200 at: https://wandb.ai/orangingq/torchtitan/runs/ulcmlivj
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_fullrand7_h200/20251102-1323/wandb/run-20251102_132326-ulcmlivj/logs
[rank0]:2025-11-02 15:10:39,247 - INFO - Training completed
[rank0]:2025-11-02 15:10:39,248 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 15:10:39,465 - INFO - Process group destroyed
[rank1]:2025-11-02 15:10:39,454 - INFO - Process group destroyed
[rank3]:2025-11-02 15:10:39,456 - INFO - Process group destroyed
[rank0]:2025-11-02 15:10:39,557 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.3', 'tok_embeddings', 'layers.6', 'layers.4', 'layers.2', 'layers.1', 'layers.5', 'layers.7', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.23', 'layers.17', 'layers.20', 'layers.24', 'layers.18', 'layers.19', 'layers.22', 'layers.21'}
[rank1]:Stage 1: Modules to keep: {'layers.12', 'layers.14', 'layers.15', 'layers.13', 'layers.9', 'layers.16', 'layers.8', 'layers.10', 'layers.11'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'layers.29', 'layers.26', 'layers.31', 'norm', 'layers.28', 'layers.27', 'layers.30', 'output'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_fullrand7_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_fullrand7_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_fullrand7_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_fullrand7_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_fullrand7_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_fullrand7_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_fullrand7_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Nov  4 06:48:14 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1104 06:48:15.587000 2371566 site-packages/torch/distributed/run.py:811] 
W1104 06:48:15.587000 2371566 site-packages/torch/distributed/run.py:811] *****************************************
W1104 06:48:15.587000 2371566 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1104 06:48:15.587000 2371566 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-04 06:48:22,881 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-04 06:48:22,917 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-04 06:48:22,966 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-04 06:48:22,988 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-04 06:48:23,746 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 06:48:23,748 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 06:48:23,801 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 06:48:23,804 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 06:48:23,810 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-04 06:48:23,812 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 06:48:23,814 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-04 06:48:23,797 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 06:48:23,800 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 06:48:25,510 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 06:48:25,811 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank1]:2025-11-04 06:48:27,860 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-04 06:48:27,933 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-04 06:48:27,933 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-04 06:48:27,960 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-04 06:48:28,034 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-04 06:48:28,035 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 06:48:28,149 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-04 06:48:28,149 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-04 06:48:28,243 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-04 06:48:28,243 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run cpda05ep
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_fullrand7_h200/20251104-0648/wandb/run-20251104_064830-cpda05ep
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_fullrand7_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/cpda05ep
[rank3]:2025-11-04 06:48:31,717 - INFO - WandB logging enabled
[rank3]:2025-11-04 06:48:31,721 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-04 06:48:31,799 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-04 06:48:31,799 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-04 06:48:32,014 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-04 06:48:32,015 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank0]:2025-11-04 06:48:46,857 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 06:48:47,133 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-04 06:48:47,184 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-04 06:48:47,211 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-04 06:48:47,212 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-11-04 06:48:47,465 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-04 06:48:47,459 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-04 06:48:47,466 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 06:48:47,446 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-04 06:48:47,446 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank0]:2025-11-04 06:48:47,465 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_fullrand7_h200
[rank0]:2025-11-04 06:48:47,465 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 06:48:47,465 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-11-04 06:48:51,141 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-04 06:48:51,142 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-04 06:49:00,200 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-04 06:49:00,200 - INFO - Finished loading the checkpoint in 9.06 seconds.
[rank0]:2025-11-04 06:49:00,200 - INFO - Training starts at step 1
[rank0]:2025-11-04 06:49:04,129 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 967  tflops: 45.09  mfu: 4.56%
[rank0]:2025-11-04 06:49:04,129 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-04 06:49:04,120 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 454  tflops: 21.16  mfu: 2.14%
[rank2]:2025-11-04 06:49:04,120 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 06:49:04,110 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 453  tflops: 21.11  mfu: 2.13%
[rank1]:2025-11-04 06:49:04,110 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-04 06:49:04,153 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 506  tflops: 23.60  mfu: 2.39%
[rank3]:2025-11-04 06:49:04,153 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 06:51:10,791 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 06:51:13,226 - INFO - Avg. fwd time: 14.6611 / Avg. bwd time: 42.1290 / Avg. batch time: 471.4450 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-11-04 06:51:13,256 - INFO - Avg. fwd time: 13.1760 / Avg. bwd time: 36.0829 / Avg. batch time: 524.0968 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-11-04 06:51:13,301 - INFO - Avg. fwd time: 15.0101 / Avg. bwd time: 40.9110 / Avg. batch time: 583.1941 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-11-04 06:51:13,333 - INFO - Avg. fwd time: 13.2540 / Avg. bwd time: 37.7637 / Avg. batch time: 638.3190 (ms) / GPU bubble ratio: 36.06%
[rank2]:2025-11-04 06:51:13,451 - INFO -  step: 50  loss: -4.0000  grad_norm: 7322.1143  memory: 38.72GiB(27.69%)  tps: 6,207  tflops: 289.52  mfu: 29.27%
[rank3]:2025-11-04 06:51:13,456 - INFO -  step: 50  loss: 12.7730  grad_norm: 7322.1143  memory: 46.16GiB(33.01%)  tps: 6,209  tflops: 289.58  mfu: 29.28%
[rank0]:2025-11-04 06:51:13,458 - INFO -  step: 50  loss: -4.0000  grad_norm: 7322.1143  memory: 54.93GiB(39.29%)  tps: 6,208  tflops: 289.52  mfu: 29.27%
[rank1]:2025-11-04 06:51:13,454 - INFO -  step: 50  loss: -4.0000  grad_norm: 7322.1143  memory: 47.26GiB(33.80%)  tps: 6,207  tflops: 289.49  mfu: 29.27%
[rank0]:2025-11-04 06:53:22,814 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 06:53:25,269 - INFO - Avg. fwd time: 13.2153 / Avg. bwd time: 36.2353 / Avg. batch time: 524.5194 (ms) / GPU bubble ratio: 24.58%
[rank3]:2025-11-04 06:53:25,239 - INFO - Avg. fwd time: 14.7052 / Avg. bwd time: 42.2695 / Avg. batch time: 472.0602 (ms) / GPU bubble ratio: 3.44%
[rank0]:2025-11-04 06:53:25,347 - INFO - Avg. fwd time: 13.2027 / Avg. bwd time: 37.8692 / Avg. batch time: 638.1316 (ms) / GPU bubble ratio: 35.97%
[rank1]:2025-11-04 06:53:25,315 - INFO - Avg. fwd time: 14.9611 / Avg. bwd time: 40.9873 / Avg. batch time: 583.3343 (ms) / GPU bubble ratio: 23.27%
[rank3]:2025-11-04 06:53:25,471 - INFO -  step: 100  loss:  4.2807  grad_norm: 79.7850  memory: 46.16GiB(33.01%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank3]:2025-11-04 06:53:25,471 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 06:53:25,466 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.7850  memory: 38.72GiB(27.69%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank2]:2025-11-04 06:53:25,466 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 06:53:25,473 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.7850  memory: 54.93GiB(39.29%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank0]:2025-11-04 06:53:25,473 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 06:53:25,469 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.7850  memory: 47.26GiB(33.80%)  tps: 6,205  tflops: 289.42  mfu: 29.26%
[rank1]:2025-11-04 06:53:25,469 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 06:55:34,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 06:55:37,434 - INFO - Avg. fwd time: 14.6991 / Avg. bwd time: 42.2979 / Avg. batch time: 471.9777 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-11-04 06:55:37,477 - INFO - Avg. fwd time: 13.2143 / Avg. bwd time: 36.3139 / Avg. batch time: 524.3881 (ms) / GPU bubble ratio: 24.44%
[rank3]:2025-11-04 06:55:37,600 - INFO -  step: 150  loss:  1.1943  grad_norm: 16.5047  memory: 46.16GiB(33.01%)  tps: 6,200  tflops: 289.17  mfu: 29.24%
[rank2]:2025-11-04 06:55:37,596 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.5047  memory: 38.72GiB(27.69%)  tps: 6,200  tflops: 289.17  mfu: 29.24%
[rank0]:2025-11-04 06:55:37,567 - INFO - Avg. fwd time: 13.1909 / Avg. bwd time: 37.9132 / Avg. batch time: 637.8502 (ms) / GPU bubble ratio: 35.90%
[rank0]:2025-11-04 06:55:37,602 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.5047  memory: 54.93GiB(39.29%)  tps: 6,200  tflops: 289.17  mfu: 29.24%
[rank1]:2025-11-04 06:55:37,523 - INFO - Avg. fwd time: 14.9281 / Avg. bwd time: 41.0180 / Avg. batch time: 583.1081 (ms) / GPU bubble ratio: 23.24%
[rank1]:2025-11-04 06:55:37,598 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.5047  memory: 47.26GiB(33.80%)  tps: 6,200  tflops: 289.17  mfu: 29.24%
[rank0]:2025-11-04 06:57:46,809 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 06:57:49,265 - INFO - Avg. fwd time: 13.2104 / Avg. bwd time: 36.3476 / Avg. batch time: 524.2005 (ms) / GPU bubble ratio: 24.37%
[rank3]:2025-11-04 06:57:49,235 - INFO - Avg. fwd time: 14.6914 / Avg. bwd time: 42.3002 / Avg. batch time: 471.8232 (ms) / GPU bubble ratio: 3.37%
[rank1]:2025-11-04 06:57:49,311 - INFO - Avg. fwd time: 14.9095 / Avg. bwd time: 41.0248 / Avg. batch time: 582.8637 (ms) / GPU bubble ratio: 23.23%
[rank0]:2025-11-04 06:57:49,343 - INFO - Avg. fwd time: 13.1829 / Avg. bwd time: 37.9219 / Avg. batch time: 637.5572 (ms) / GPU bubble ratio: 35.87%
[rank2]:2025-11-04 06:57:49,461 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4598  memory: 38.72GiB(27.69%)  tps: 6,212  tflops: 289.75  mfu: 29.30%
[rank2]:2025-11-04 06:57:49,461 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 06:57:49,465 - INFO -  step: 200  loss:  0.3479  grad_norm:  0.4598  memory: 46.16GiB(33.01%)  tps: 6,212  tflops: 289.75  mfu: 29.30%
[rank3]:2025-11-04 06:57:49,465 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 06:57:49,463 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4598  memory: 47.26GiB(33.80%)  tps: 6,212  tflops: 289.75  mfu: 29.30%
[rank1]:2025-11-04 06:57:49,463 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 06:57:49,467 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4598  memory: 54.93GiB(39.29%)  tps: 6,212  tflops: 289.75  mfu: 29.30%
[rank0]:2025-11-04 06:57:49,467 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 06:58:06,131 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,575
[rank1]:2025-11-04 06:58:06,132 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 06:58:06,101 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,625
[rank0]:2025-11-04 06:58:06,103 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 06:58:06,159 - INFO - validate step: 200  loss:  0.2309  memory: 46.16GiB(33.01%)  tps: 24,538
[rank3]:2025-11-04 06:58:06,161 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 06:58:06,144 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,552
[rank2]:2025-11-04 06:58:06,145 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 07:00:15,879 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 07:00:18,325 - INFO - Avg. fwd time: 13.2199 / Avg. bwd time: 36.3769 / Avg. batch time: 524.2346 (ms) / GPU bubble ratio: 24.31%
[rank3]:2025-11-04 07:00:18,296 - INFO - Avg. fwd time: 14.6926 / Avg. bwd time: 42.3121 / Avg. batch time: 471.8492 (ms) / GPU bubble ratio: 3.35%
[rank0]:2025-11-04 07:00:18,404 - INFO - Avg. fwd time: 13.1874 / Avg. bwd time: 37.9328 / Avg. batch time: 637.6006 (ms) / GPU bubble ratio: 35.86%
[rank1]:2025-11-04 07:00:18,371 - INFO - Avg. fwd time: 14.9176 / Avg. bwd time: 41.0489 / Avg. batch time: 582.8826 (ms) / GPU bubble ratio: 23.19%
[rank2]:2025-11-04 07:00:18,520 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2727  memory: 38.72GiB(27.69%)  tps: 6,188  tflops: 288.63  mfu: 29.18%
[rank3]:2025-11-04 07:00:18,525 - INFO -  step: 250  loss:  0.2335  grad_norm:  0.2727  memory: 46.16GiB(33.01%)  tps: 6,189  tflops: 288.66  mfu: 29.19%
[rank0]:2025-11-04 07:00:18,527 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2727  memory: 54.93GiB(39.29%)  tps: 6,186  tflops: 288.52  mfu: 29.17%
[rank1]:2025-11-04 07:00:18,522 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2727  memory: 47.26GiB(33.80%)  tps: 6,188  tflops: 288.60  mfu: 29.18%
[rank0]:2025-11-04 07:02:28,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:02:30,730 - INFO - Avg. fwd time: 13.2247 / Avg. bwd time: 36.3934 / Avg. batch time: 524.2690 (ms) / GPU bubble ratio: 24.29%
[rank3]:2025-11-04 07:02:30,687 - INFO - Avg. fwd time: 14.6933 / Avg. bwd time: 42.3213 / Avg. batch time: 471.8766 (ms) / GPU bubble ratio: 3.34%
[rank0]:2025-11-04 07:02:30,822 - INFO - Avg. fwd time: 13.1863 / Avg. bwd time: 37.9354 / Avg. batch time: 637.6273 (ms) / GPU bubble ratio: 35.86%
[rank0]:2025-11-04 07:02:30,858 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3054  memory: 54.93GiB(39.29%)  tps: 6,191  tflops: 288.73  mfu: 29.19%
[rank0]:2025-11-04 07:02:30,858 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 07:02:30,778 - INFO - Avg. fwd time: 14.9231 / Avg. bwd time: 41.0655 / Avg. batch time: 582.9153 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-11-04 07:02:30,854 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3054  memory: 47.26GiB(33.80%)  tps: 6,191  tflops: 288.73  mfu: 29.19%
[rank1]:2025-11-04 07:02:30,854 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 07:02:30,851 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3054  memory: 38.72GiB(27.69%)  tps: 6,191  tflops: 288.73  mfu: 29.19%
[rank2]:2025-11-04 07:02:30,852 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 07:02:30,856 - INFO -  step: 300  loss:  0.2716  grad_norm:  0.3054  memory: 46.16GiB(33.01%)  tps: 6,191  tflops: 288.73  mfu: 29.19%
[rank3]:2025-11-04 07:02:30,857 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 07:04:40,643 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:04:43,118 - INFO - Avg. fwd time: 13.2345 / Avg. bwd time: 36.4078 / Avg. batch time: 524.4033 (ms) / GPU bubble ratio: 24.27%
[rank3]:2025-11-04 07:04:43,088 - INFO - Avg. fwd time: 14.7009 / Avg. bwd time: 42.3333 / Avg. batch time: 472.0032 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-04 07:04:43,163 - INFO - Avg. fwd time: 14.9278 / Avg. bwd time: 41.0773 / Avg. batch time: 583.0406 (ms) / GPU bubble ratio: 23.15%
[rank0]:2025-11-04 07:04:43,195 - INFO - Avg. fwd time: 13.1837 / Avg. bwd time: 37.9353 / Avg. batch time: 637.7421 (ms) / GPU bubble ratio: 35.88%
[rank2]:2025-11-04 07:04:43,312 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3621  memory: 38.72GiB(27.69%)  tps: 6,184  tflops: 288.45  mfu: 29.17%
[rank3]:2025-11-04 07:04:43,317 - INFO -  step: 350  loss:  0.3340  grad_norm:  0.3621  memory: 46.16GiB(33.01%)  tps: 6,185  tflops: 288.45  mfu: 29.17%
[rank1]:2025-11-04 07:04:43,315 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3621  memory: 47.26GiB(33.80%)  tps: 6,184  tflops: 288.45  mfu: 29.17%
[rank0]:2025-11-04 07:04:43,319 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3621  memory: 54.93GiB(39.29%)  tps: 6,184  tflops: 288.45  mfu: 29.17%
[rank0]:2025-11-04 07:06:53,095 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:06:55,538 - INFO - Avg. fwd time: 14.7055 / Avg. bwd time: 42.3446 / Avg. batch time: 472.1041 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-11-04 07:06:55,568 - INFO - Avg. fwd time: 13.2386 / Avg. bwd time: 36.4143 / Avg. batch time: 524.5056 (ms) / GPU bubble ratio: 24.27%
[rank0]:2025-11-04 07:06:55,647 - INFO - Avg. fwd time: 13.1777 / Avg. bwd time: 37.9275 / Avg. batch time: 637.8095 (ms) / GPU bubble ratio: 35.90%
[rank1]:2025-11-04 07:06:55,614 - INFO - Avg. fwd time: 14.9257 / Avg. bwd time: 41.0782 / Avg. batch time: 583.1292 (ms) / GPU bubble ratio: 23.17%
[rank0]:2025-11-04 07:06:55,770 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3212  memory: 54.93GiB(39.29%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank0]:2025-11-04 07:06:55,770 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 07:06:55,766 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3212  memory: 47.26GiB(33.80%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank1]:2025-11-04 07:06:55,766 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 07:06:55,763 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3212  memory: 38.72GiB(27.69%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank2]:2025-11-04 07:06:55,763 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 07:06:55,768 - INFO -  step: 400  loss:  0.2729  grad_norm:  0.3212  memory: 46.16GiB(33.01%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank3]:2025-11-04 07:06:55,769 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 07:07:10,635 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,555
[rank0]:2025-11-04 07:07:10,636 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 07:07:10,665 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,491
[rank1]:2025-11-04 07:07:10,666 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 07:07:10,678 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,463
[rank2]:2025-11-04 07:07:10,679 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 07:07:10,692 - INFO - validate step: 400  loss:  0.2403  memory: 46.16GiB(33.01%)  tps: 27,447
[rank3]:2025-11-04 07:07:10,693 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 07:09:20,320 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:09:22,876 - INFO - Avg. fwd time: 13.2417 / Avg. bwd time: 36.4223 / Avg. batch time: 524.5890 (ms) / GPU bubble ratio: 24.26%
[rank3]:2025-11-04 07:09:22,833 - INFO - Avg. fwd time: 14.7088 / Avg. bwd time: 42.3543 / Avg. batch time: 472.1870 (ms) / GPU bubble ratio: 3.32%
[rank0]:2025-11-04 07:09:22,969 - INFO - Avg. fwd time: 13.1734 / Avg. bwd time: 37.9246 / Avg. batch time: 637.8774 (ms) / GPU bubble ratio: 35.91%
[rank0]:2025-11-04 07:09:23,005 - INFO -  step: 450  loss: -4.0000  grad_norm: 3205.9863  memory: 54.93GiB(39.29%)  tps: 6,189  tflops: 288.64  mfu: 29.19%
[rank1]:2025-11-04 07:09:22,924 - INFO - Avg. fwd time: 14.9255 / Avg. bwd time: 41.0788 / Avg. batch time: 583.2047 (ms) / GPU bubble ratio: 23.18%
[rank1]:2025-11-04 07:09:23,001 - INFO -  step: 450  loss: -4.0000  grad_norm: 3205.9863  memory: 47.26GiB(33.80%)  tps: 6,190  tflops: 288.72  mfu: 29.19%
[rank3]:2025-11-04 07:09:23,003 - INFO -  step: 450  loss:  3.0951  grad_norm: 3205.9863  memory: 46.16GiB(33.01%)  tps: 6,192  tflops: 288.78  mfu: 29.20%
[rank2]:2025-11-04 07:09:22,998 - INFO -  step: 450  loss: -4.0000  grad_norm: 3205.9863  memory: 38.72GiB(27.69%)  tps: 6,191  tflops: 288.75  mfu: 29.20%
[rank3]:2025-11-04 07:09:49,252 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-04 07:10:15,749 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-04 07:10:16,012 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:15,975 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-04 07:10:16,004 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,036 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,026 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,058 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,042 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,027 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,085 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,064 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,131 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,167 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,208 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,125 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,171 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,198 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,251 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,174 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,227 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,261 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,315 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,224 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,277 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,306 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,306 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,307 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 07:10:16,308 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,271 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,309 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,340 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 07:10:16,348 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:16,331 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 07:10:16,368 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 07:10:32,173 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-04 07:10:32,383 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0710_max_batch_time.svg
[rank3]:> Batch Time: 622.08 ms, GPU Bubble Ratio: 34.10%, 27.79%, 35.91%, 26.29%
[rank3]:2025-11-04 07:10:32,526 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0710_min_batch_time.svg
[rank3]:> Batch Time: 351.47 ms, GPU Bubble Ratio: 70.04%, 24.24%, 32.67%, 23.47%
[rank3]:2025-11-04 07:10:32,693 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0710_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 370.22 ms, GPU Bubble Ratio: 23.68%, 16.44%, 21.20%, 22.28%
[rank3]:2025-11-04 07:10:32,694 - INFO - 	> Batch Time: 370.22 ms (Average Freeze Ratio: 0.69, Time Reduction Rate: 0.40)
[rank0]:2025-11-04 07:11:14,051 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:11:16,329 - INFO - Avg. fwd time: 13.3296 / Avg. bwd time: 35.6362 / Avg. batch time: 517.3960 (ms) / GPU bubble ratio: 24.29%
[rank3]:2025-11-04 07:11:16,302 - INFO - Avg. fwd time: 14.8137 / Avg. bwd time: 41.3893 / Avg. batch time: 465.3293 (ms) / GPU bubble ratio: 3.38%
[rank3]:2025-11-04 07:11:16,326 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.07/0.20, [MB7] 0.33/1.00
[rank0]:2025-11-04 07:11:16,397 - INFO - Avg. fwd time: 13.2474 / Avg. bwd time: 36.6140 / Avg. batch time: 629.0588 (ms) / GPU bubble ratio: 36.59%
[rank1]:2025-11-04 07:11:16,367 - INFO - Avg. fwd time: 15.0295 / Avg. bwd time: 40.1184 / Avg. batch time: 575.3299 (ms) / GPU bubble ratio: 23.32%
[rank2]:2025-11-04 07:11:16,422 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.81, [MB1] 0.27/0.80, [MB2] 0.27/0.82, [MB3] 0.27/0.81, [MB4] 0.27/0.81, [MB5] 0.00/0.00, [MB6] 0.08/0.23, [MB7] 0.33/1.00
[rank0]:2025-11-04 07:11:16,498 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.47, [MB1] 0.15/0.46, [MB2] 0.15/0.46, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.14/0.43, [MB6] 0.17/0.52, [MB7] 0.33/1.00
[rank1]:2025-11-04 07:11:16,462 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.97, [MB1] 0.33/0.99, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.05/0.16, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank2]:2025-11-04 07:11:16,519 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2517  memory: 38.72GiB(27.69%)  tps: 7,216  tflops: 336.57  mfu: 34.03%
[rank3]:2025-11-04 07:11:16,523 - INFO -  step: 500  loss:  0.3049  grad_norm:  0.2517  memory: 47.00GiB(33.62%)  tps: 7,216  tflops: 336.58  mfu: 34.03%
[rank0]:2025-11-04 07:11:16,525 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2517  memory: 54.99GiB(39.33%)  tps: 7,216  tflops: 336.57  mfu: 34.03%
[rank1]:2025-11-04 07:11:16,521 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2517  memory: 47.90GiB(34.26%)  tps: 7,216  tflops: 336.57  mfu: 34.03%
[rank1]:2025-11-04 07:11:16,585 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0711_stage1_step500.svg
[rank2]:2025-11-04 07:11:16,585 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0711_stage2_step500.svg
[rank3]:2025-11-04 07:11:16,658 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0711_real_step500_rank3.svg
[rank3]:> Batch Time: 465.03 ms, GPU Bubble Ratio: 51.39%, 35.84%, 39.73%, 34.96%
[rank0]:2025-11-04 07:11:16,602 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0711_stage0_step500.svg
[rank3]:2025-11-04 07:11:16,701 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0711_stage3_step500.svg
[rank0]:2025-11-04 07:13:07,978 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:13:09,957 - INFO - Avg. fwd time: 14.9146 / Avg. bwd time: 40.4427 / Avg. batch time: 458.5458 (ms) / GPU bubble ratio: 3.42%
[rank1]:2025-11-04 07:13:09,985 - INFO - Avg. fwd time: 15.1239 / Avg. bwd time: 39.2367 / Avg. batch time: 568.0480 (ms) / GPU bubble ratio: 23.44%
[rank2]:2025-11-04 07:13:09,969 - INFO - Avg. fwd time: 13.3991 / Avg. bwd time: 35.0136 / Avg. batch time: 510.4540 (ms) / GPU bubble ratio: 24.13%
[rank2]:2025-11-04 07:13:10,065 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.54/0.81, [MB1] 0.53/0.80, [MB2] 0.54/0.82, [MB3] 0.54/0.81, [MB4] 0.54/0.81, [MB5] 0.00/0.00, [MB6] 0.15/0.23, [MB7] 0.67/1.00
[rank3]:2025-11-04 07:13:09,972 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.13/0.20, [MB7] 0.67/1.00
[rank0]:2025-11-04 07:13:10,017 - INFO - Avg. fwd time: 13.3024 / Avg. bwd time: 36.0466 / Avg. batch time: 621.5956 (ms) / GPU bubble ratio: 36.49%
[rank1]:2025-11-04 07:13:10,101 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.65/0.97, [MB1] 0.66/0.99, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.11/0.16, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2025-11-04 07:13:10,153 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1052  memory: 39.30GiB(28.11%)  tps: 7,209  tflops: 336.23  mfu: 34.00%
[rank3]:2025-11-04 07:13:10,155 - INFO -  step: 550  loss:  0.1655  grad_norm:  0.1052  memory: 47.72GiB(34.13%)  tps: 7,209  tflops: 336.25  mfu: 34.00%
[rank0]:2025-11-04 07:13:10,136 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.47, [MB1] 0.31/0.46, [MB2] 0.31/0.46, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.29/0.43, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank0]:2025-11-04 07:13:10,153 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1052  memory: 56.91GiB(40.70%)  tps: 7,210  tflops: 336.25  mfu: 34.00%
[rank1]:2025-11-04 07:13:10,156 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1052  memory: 48.98GiB(35.03%)  tps: 7,209  tflops: 336.23  mfu: 34.00%
[rank0]:2025-11-04 07:14:51,299 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:14:53,225 - INFO - Avg. fwd time: 13.5254 / Avg. bwd time: 33.9827 / Avg. batch time: 500.2360 (ms) / GPU bubble ratio: 24.02%
[rank2]:2025-11-04 07:14:53,229 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.81/0.81, [MB4] 0.81/0.81, [MB5] 0.00/0.00, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank3]:2025-11-04 07:14:53,186 - INFO - Avg. fwd time: 15.0802 / Avg. bwd time: 39.0401 / Avg. batch time: 448.6347 (ms) / GPU bubble ratio: 3.49%
[rank3]:2025-11-04 07:14:53,192 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank1]:2025-11-04 07:14:53,266 - INFO - Avg. fwd time: 15.2824 / Avg. bwd time: 37.9287 / Avg. batch time: 557.3330 (ms) / GPU bubble ratio: 23.62%
[rank1]:2025-11-04 07:14:53,269 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.97/0.97, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.16/0.16, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2025-11-04 07:14:53,320 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1105  memory: 39.30GiB(28.11%)  tps: 7,941  tflops: 370.35  mfu: 37.45%
[rank2]:2025-11-04 07:14:53,321 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 07:14:53,316 - INFO -  step: 600  loss:  0.4348  grad_norm:  0.1105  memory: 47.72GiB(34.13%)  tps: 7,941  tflops: 370.38  mfu: 37.45%
[rank3]:2025-11-04 07:14:53,316 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 07:14:53,305 - INFO - Avg. fwd time: 13.4078 / Avg. bwd time: 34.8280 / Avg. batch time: 610.4924 (ms) / GPU bubble ratio: 36.79%
[rank0]:2025-11-04 07:14:53,312 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 07:14:53,329 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1105  memory: 56.91GiB(40.70%)  tps: 7,940  tflops: 370.31  mfu: 37.44%
[rank0]:2025-11-04 07:14:53,329 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 07:14:53,316 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1105  memory: 48.98GiB(35.03%)  tps: 7,941  tflops: 370.37  mfu: 37.45%
[rank1]:2025-11-04 07:14:53,316 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 07:15:09,709 - INFO - validate step: 600  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 25,007
[rank1]:2025-11-04 07:15:09,742 - INFO - validate step: 600  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,937
[rank2]:2025-11-04 07:15:09,763 - INFO - validate step: 600  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,911
[rank2]:2025-11-04 07:15:09,836 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0715_stage2_step600.svg
[rank3]:2025-11-04 07:15:09,785 - INFO - validate step: 600  loss:  0.2502  memory: 47.72GiB(34.13%)  tps: 24,872
[rank0]:2025-11-04 07:15:09,837 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0715_stage0_step600.svg
[rank1]:2025-11-04 07:15:09,837 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0715_stage1_step600.svg
[rank3]:2025-11-04 07:15:09,925 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0715_real_step600_rank3.svg
[rank3]:> Batch Time: 473.33 ms, GPU Bubble Ratio: 41.45%, 33.47%, 38.51%, 34.61%
[rank3]:2025-11-04 07:15:09,968 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0715_stage3_step600.svg
[rank0]:2025-11-04 07:16:45,957 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 07:16:47,711 - INFO - Avg. fwd time: 15.2476 / Avg. bwd time: 37.7650 / Avg. batch time: 439.7653 (ms) / GPU bubble ratio: 3.56%
[rank2]:2025-11-04 07:16:47,726 - INFO - Avg. fwd time: 13.6554 / Avg. bwd time: 33.0374 / Avg. batch time: 491.1228 (ms) / GPU bubble ratio: 23.94%
[rank1]:2025-11-04 07:16:47,734 - INFO - Avg. fwd time: 15.4432 / Avg. bwd time: 36.7006 / Avg. batch time: 547.7272 (ms) / GPU bubble ratio: 23.84%
[rank3]:2025-11-04 07:16:47,787 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank2]:2025-11-04 07:16:47,819 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.81/0.81, [MB4] 0.81/0.81, [MB5] 0.00/0.00, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank0]:2025-11-04 07:16:47,759 - INFO - Avg. fwd time: 13.5176 / Avg. bwd time: 33.3436 / Avg. batch time: 600.5342 (ms) / GPU bubble ratio: 37.57%
[rank1]:2025-11-04 07:16:47,850 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.97/0.97, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.16/0.16, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 07:16:47,887 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,347  tflops: 389.30  mfu: 39.36%
[rank3]:2025-11-04 07:16:47,888 - INFO -  step: 650  loss:  0.2749  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,351  tflops: 389.47  mfu: 39.38%
[rank2]:2025-11-04 07:16:47,893 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0779  memory: 39.30GiB(28.11%)  tps: 8,348  tflops: 389.36  mfu: 39.37%
[rank0]:2025-11-04 07:16:47,887 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 07:16:47,909 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0779  memory: 56.91GiB(40.70%)  tps: 8,342  tflops: 389.08  mfu: 39.34%
[rank0]:2025-11-04 07:18:23,997 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:18:25,787 - INFO - Avg. fwd time: 15.4121 / Avg. bwd time: 36.4752 / Avg. batch time: 430.7535 (ms) / GPU bubble ratio: 3.63%
[rank2]:2025-11-04 07:18:25,800 - INFO - Avg. fwd time: 13.7831 / Avg. bwd time: 32.0860 / Avg. batch time: 481.8267 (ms) / GPU bubble ratio: 23.84%
[rank1]:2025-11-04 07:18:25,808 - INFO - Avg. fwd time: 15.6021 / Avg. bwd time: 35.4700 / Avg. batch time: 537.9444 (ms) / GPU bubble ratio: 24.05%
[rank3]:2025-11-04 07:18:25,868 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank2]:2025-11-04 07:18:25,900 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.81/0.81, [MB4] 0.81/0.81, [MB5] 0.00/0.00, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank0]:2025-11-04 07:18:25,833 - INFO - Avg. fwd time: 13.6262 / Avg. bwd time: 31.8532 / Avg. batch time: 590.3979 (ms) / GPU bubble ratio: 38.37%
[rank1]:2025-11-04 07:18:25,930 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.97/0.97, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.16/0.16, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 07:18:25,965 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,353  tflops: 389.56  mfu: 39.39%
[rank3]:2025-11-04 07:18:25,966 - INFO -  step: 700  loss:  0.3778  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,353  tflops: 389.57  mfu: 39.39%
[rank2]:2025-11-04 07:18:25,972 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0955  memory: 39.30GiB(28.11%)  tps: 8,353  tflops: 389.56  mfu: 39.39%
[rank0]:2025-11-04 07:18:25,966 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 07:18:25,979 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0955  memory: 56.91GiB(40.70%)  tps: 8,353  tflops: 389.60  mfu: 39.39%
[rank1]:2025-11-04 07:18:26,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0718_stage1_step700.svg
[rank2]:2025-11-04 07:18:26,030 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0718_stage2_step700.svg
[rank0]:2025-11-04 07:18:26,031 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0718_stage0_step700.svg
[rank3]:2025-11-04 07:18:26,116 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0718_real_step700_rank3.svg
[rank3]:> Batch Time: 469.23 ms, GPU Bubble Ratio: 51.95%, 35.34%, 39.04%, 34.43%
[rank3]:2025-11-04 07:18:26,161 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0718_stage3_step700.svg
[rank0]:2025-11-04 07:20:01,782 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:20:03,595 - INFO - Avg. fwd time: 15.5499 / Avg. bwd time: 35.3748 / Avg. batch time: 423.0434 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-11-04 07:20:03,635 - INFO - Avg. fwd time: 13.8890 / Avg. bwd time: 31.2728 / Avg. batch time: 473.8964 (ms) / GPU bubble ratio: 23.76%
[rank1]:2025-11-04 07:20:03,676 - INFO - Avg. fwd time: 15.7352 / Avg. bwd time: 34.4077 / Avg. batch time: 529.6019 (ms) / GPU bubble ratio: 24.26%
[rank1]:2025-11-04 07:20:03,720 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0579  memory: 48.98GiB(35.03%)  tps: 8,380  tflops: 390.85  mfu: 39.52%
[rank3]:2025-11-04 07:20:03,721 - INFO -  step: 750  loss:  0.1451  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,380  tflops: 390.86  mfu: 39.52%
[rank2]:2025-11-04 07:20:03,727 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0579  memory: 39.30GiB(28.11%)  tps: 8,380  tflops: 390.85  mfu: 39.52%
[rank0]:2025-11-04 07:20:03,715 - INFO - Avg. fwd time: 13.7144 / Avg. bwd time: 30.5668 / Avg. batch time: 581.7455 (ms) / GPU bubble ratio: 39.11%
[rank0]:2025-11-04 07:20:03,732 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0579  memory: 56.91GiB(40.70%)  tps: 8,380  tflops: 390.86  mfu: 39.52%
[rank0]:2025-11-04 07:21:38,321 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 07:21:40,136 - INFO - Avg. fwd time: 15.8263 / Avg. bwd time: 33.6097 / Avg. batch time: 523.1155 (ms) / GPU bubble ratio: 24.40%
[rank2]:2025-11-04 07:21:40,128 - INFO - Avg. fwd time: 13.9629 / Avg. bwd time: 30.6427 / Avg. batch time: 467.6973 (ms) / GPU bubble ratio: 23.70%
[rank3]:2025-11-04 07:21:40,115 - INFO - Avg. fwd time: 15.6419 / Avg. bwd time: 34.5341 / Avg. batch time: 417.0454 (ms) / GPU bubble ratio: 3.75%
[rank0]:2025-11-04 07:21:40,164 - INFO - Avg. fwd time: 13.7733 / Avg. bwd time: 29.6092 / Avg. batch time: 575.0145 (ms) / GPU bubble ratio: 39.64%
[rank1]:2025-11-04 07:21:40,294 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0857  memory: 48.98GiB(35.03%)  tps: 8,483  tflops: 395.63  mfu: 40.00%
[rank1]:2025-11-04 07:21:40,294 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-04 07:21:40,300 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0857  memory: 39.30GiB(28.11%)  tps: 8,483  tflops: 395.63  mfu: 40.00%
[rank2]:2025-11-04 07:21:40,301 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 07:21:40,295 - INFO -  step: 800  loss:  0.2905  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,483  tflops: 395.64  mfu: 40.00%
[rank3]:2025-11-04 07:21:40,295 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 07:21:40,309 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0857  memory: 56.91GiB(40.70%)  tps: 8,482  tflops: 395.62  mfu: 40.00%
[rank0]:2025-11-04 07:21:40,309 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-04 07:21:56,817 - INFO - validate step: 800  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,791
[rank2]:2025-11-04 07:21:56,833 - INFO - validate step: 800  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,776
[rank0]:2025-11-04 07:21:56,783 - INFO - validate step: 800  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,863
[rank3]:2025-11-04 07:21:56,847 - INFO - validate step: 800  loss:  0.2497  memory: 47.72GiB(34.13%)  tps: 24,748
[rank1]:2025-11-04 07:21:56,901 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0721_stage1_step800.svg
[rank2]:2025-11-04 07:21:56,901 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0721_stage2_step800.svg
[rank0]:2025-11-04 07:21:56,902 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0721_stage0_step800.svg
[rank3]:2025-11-04 07:21:56,986 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0721_real_step800_rank3.svg
[rank3]:> Batch Time: 460.86 ms, GPU Bubble Ratio: 50.94%, 34.86%, 38.73%, 35.21%
[rank3]:2025-11-04 07:21:57,032 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0721_stage3_step800.svg
[rank0]:2025-11-04 07:23:31,807 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 07:23:33,527 - INFO - Avg. fwd time: 15.7439 / Avg. bwd time: 33.6711 / Avg. batch time: 410.9494 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-11-04 07:23:33,540 - INFO - Avg. fwd time: 14.0422 / Avg. bwd time: 30.0051 / Avg. batch time: 461.4253 (ms) / GPU bubble ratio: 23.63%
[rank1]:2025-11-04 07:23:33,549 - INFO - Avg. fwd time: 15.9258 / Avg. bwd time: 32.7837 / Avg. batch time: 516.5206 (ms) / GPU bubble ratio: 24.56%
[rank0]:2025-11-04 07:23:33,573 - INFO - Avg. fwd time: 13.8408 / Avg. bwd time: 28.6013 / Avg. batch time: 568.1776 (ms) / GPU bubble ratio: 40.24%
[rank1]:2025-11-04 07:23:33,702 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0759  memory: 48.98GiB(35.03%)  tps: 8,455  tflops: 394.36  mfu: 39.87%
[rank3]:2025-11-04 07:23:33,703 - INFO -  step: 850  loss:  0.1204  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,458  tflops: 394.49  mfu: 39.89%
[rank2]:2025-11-04 07:23:33,708 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0759  memory: 39.30GiB(28.11%)  tps: 8,456  tflops: 394.41  mfu: 39.88%
[rank0]:2025-11-04 07:23:33,716 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0759  memory: 56.91GiB(40.70%)  tps: 8,451  tflops: 394.17  mfu: 39.86%
[rank0]:2025-11-04 07:25:06,846 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:25:08,662 - INFO - Avg. fwd time: 15.8220 / Avg. bwd time: 32.8897 / Avg. batch time: 405.3139 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-11-04 07:25:08,702 - INFO - Avg. fwd time: 14.1042 / Avg. bwd time: 29.4421 / Avg. batch time: 455.6003 (ms) / GPU bubble ratio: 23.54%
[rank1]:2025-11-04 07:25:08,744 - INFO - Avg. fwd time: 16.0033 / Avg. bwd time: 32.0515 / Avg. batch time: 510.4156 (ms) / GPU bubble ratio: 24.68%
[rank1]:2025-11-04 07:25:08,789 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0687  memory: 48.98GiB(35.03%)  tps: 8,615  tflops: 401.82  mfu: 40.63%
[rank0]:2025-11-04 07:25:08,783 - INFO - Avg. fwd time: 13.8908 / Avg. bwd time: 27.7168 / Avg. batch time: 561.8448 (ms) / GPU bubble ratio: 40.76%
[rank0]:2025-11-04 07:25:08,802 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0687  memory: 56.91GiB(40.70%)  tps: 8,615  tflops: 401.82  mfu: 40.63%
[rank3]:2025-11-04 07:25:08,790 - INFO -  step: 900  loss:  0.1866  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,615  tflops: 401.82  mfu: 40.63%
[rank2]:2025-11-04 07:25:08,798 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0687  memory: 39.30GiB(28.11%)  tps: 8,615  tflops: 401.81  mfu: 40.63%
[rank1]:2025-11-04 07:25:08,850 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0725_stage1_step900.svg
[rank0]:2025-11-04 07:25:08,850 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0725_stage0_step900.svg
[rank2]:2025-11-04 07:25:08,850 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0725_stage2_step900.svg
[rank3]:2025-11-04 07:25:08,938 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0725_real_step900_rank3.svg
[rank3]:> Batch Time: 459.88 ms, GPU Bubble Ratio: 50.58%, 34.55%, 37.54%, 35.12%
[rank3]:2025-11-04 07:25:08,978 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0725_stage3_step900.svg
[rank0]:2025-11-04 07:26:43,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 07:26:45,045 - INFO - Avg. fwd time: 16.0681 / Avg. bwd time: 31.4865 / Avg. batch time: 505.9270 (ms) / GPU bubble ratio: 24.80%
[rank3]:2025-11-04 07:26:45,025 - INFO - Avg. fwd time: 15.8891 / Avg. bwd time: 32.3064 / Avg. batch time: 401.1785 (ms) / GPU bubble ratio: 3.89%
[rank0]:2025-11-04 07:26:45,071 - INFO - Avg. fwd time: 13.9351 / Avg. bwd time: 27.0370 / Avg. batch time: 557.1896 (ms) / GPU bubble ratio: 41.17%
[rank2]:2025-11-04 07:26:45,036 - INFO - Avg. fwd time: 14.1564 / Avg. bwd time: 29.0081 / Avg. batch time: 451.3449 (ms) / GPU bubble ratio: 23.49%
[rank3]:2025-11-04 07:26:45,201 - INFO -  step: 950  loss:  0.2642  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,497  tflops: 396.31  mfu: 40.07%
[rank2]:2025-11-04 07:26:45,203 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0687  memory: 39.30GiB(28.11%)  tps: 8,497  tflops: 396.32  mfu: 40.07%
[rank1]:2025-11-04 07:26:45,200 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0687  memory: 48.98GiB(35.03%)  tps: 8,497  tflops: 396.30  mfu: 40.07%
[rank0]:2025-11-04 07:26:45,214 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0687  memory: 56.91GiB(40.70%)  tps: 8,497  tflops: 396.30  mfu: 40.07%
[rank0]:2025-11-04 07:28:20,250 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 07:28:22,015 - INFO - Avg. fwd time: 16.1405 / Avg. bwd time: 30.8985 / Avg. batch time: 501.2718 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-11-04 07:28:21,993 - INFO - Avg. fwd time: 15.9640 / Avg. bwd time: 31.6978 / Avg. batch time: 396.9036 (ms) / GPU bubble ratio: 3.93%
[rank0]:2025-11-04 07:28:22,042 - INFO - Avg. fwd time: 13.9829 / Avg. bwd time: 26.3298 / Avg. batch time: 552.3653 (ms) / GPU bubble ratio: 41.61%
[rank2]:2025-11-04 07:28:22,007 - INFO - Avg. fwd time: 14.2143 / Avg. bwd time: 28.5552 / Avg. batch time: 446.9264 (ms) / GPU bubble ratio: 23.44%
[rank3]:2025-11-04 07:28:22,172 - INFO -  step: 1000  loss:  0.1585  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,448  tflops: 394.02  mfu: 39.84%
[rank3]:2025-11-04 07:28:22,172 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 07:28:22,187 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0368  memory: 56.91GiB(40.70%)  tps: 8,448  tflops: 394.00  mfu: 39.84%
[rank0]:2025-11-04 07:28:22,187 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-04 07:28:22,177 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0368  memory: 39.30GiB(28.11%)  tps: 8,448  tflops: 394.00  mfu: 39.84%
[rank2]:2025-11-04 07:28:22,177 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 07:28:22,172 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0368  memory: 48.98GiB(35.03%)  tps: 8,448  tflops: 394.01  mfu: 39.84%
[rank1]:2025-11-04 07:28:22,172 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 07:28:38,999 - INFO - validate step: 1000  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,365
[rank1]:2025-11-04 07:28:39,034 - INFO - validate step: 1000  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,292
[rank3]:2025-11-04 07:28:39,062 - INFO - validate step: 1000  loss:  0.2485  memory: 47.72GiB(34.13%)  tps: 24,252
[rank2]:2025-11-04 07:28:39,048 - INFO - validate step: 1000  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,279
[rank2]:2025-11-04 07:28:39,111 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0728_stage2_step1000.svg
[rank1]:2025-11-04 07:28:39,115 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0728_stage1_step1000.svg
[rank3]:2025-11-04 07:28:39,197 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0728_real_step1000_rank3.svg
[rank3]:> Batch Time: 466.14 ms, GPU Bubble Ratio: 51.02%, 35.24%, 38.68%, 34.76%
[rank0]:2025-11-04 07:28:39,113 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0728_stage0_step1000.svg
[rank3]:2025-11-04 07:28:39,239 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0728_stage3_step1000.svg
[rank0]:2025-11-04 07:30:13,342 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 07:30:15,214 - INFO - Avg. fwd time: 16.0261 / Avg. bwd time: 31.1387 / Avg. batch time: 392.9216 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-11-04 07:30:15,256 - INFO - Avg. fwd time: 14.2632 / Avg. bwd time: 28.1471 / Avg. batch time: 442.8314 (ms) / GPU bubble ratio: 23.38%
[rank1]:2025-11-04 07:30:15,298 - INFO - Avg. fwd time: 16.1999 / Avg. bwd time: 30.3650 / Avg. batch time: 496.9696 (ms) / GPU bubble ratio: 25.04%
[rank1]:2025-11-04 07:30:15,346 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1297  memory: 48.98GiB(35.03%)  tps: 8,506  tflops: 396.71  mfu: 40.11%
[rank3]:2025-11-04 07:30:15,347 - INFO -  step: 1050  loss:  0.2546  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,508  tflops: 396.83  mfu: 40.12%
[rank0]:2025-11-04 07:30:15,339 - INFO - Avg. fwd time: 14.0222 / Avg. bwd time: 25.6896 / Avg. batch time: 547.9023 (ms) / GPU bubble ratio: 42.02%
[rank0]:2025-11-04 07:30:15,366 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1297  memory: 56.91GiB(40.70%)  tps: 8,501  tflops: 396.48  mfu: 40.09%
[rank2]:2025-11-04 07:30:15,354 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1297  memory: 39.30GiB(28.11%)  tps: 8,506  tflops: 396.73  mfu: 40.11%
[rank0]:2025-11-04 07:31:52,150 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 07:31:53,934 - INFO - Avg. fwd time: 16.2604 / Avg. bwd time: 29.9584 / Avg. batch time: 493.8645 (ms) / GPU bubble ratio: 25.13%
[rank3]:2025-11-04 07:31:53,911 - INFO - Avg. fwd time: 16.0905 / Avg. bwd time: 30.7137 / Avg. batch time: 390.0365 (ms) / GPU bubble ratio: 4.00%
[rank0]:2025-11-04 07:31:53,960 - INFO - Avg. fwd time: 14.0636 / Avg. bwd time: 25.1970 / Avg. batch time: 544.6882 (ms) / GPU bubble ratio: 42.34%
[rank2]:2025-11-04 07:31:53,926 - INFO - Avg. fwd time: 14.3113 / Avg. bwd time: 27.8363 / Avg. batch time: 439.8579 (ms) / GPU bubble ratio: 23.34%
[rank1]:2025-11-04 07:31:54,088 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0559  memory: 48.98GiB(35.03%)  tps: 8,296  tflops: 386.95  mfu: 39.12%
[rank3]:2025-11-04 07:31:54,089 - INFO -  step: 1100  loss:  0.2345  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,296  tflops: 386.95  mfu: 39.13%
[rank0]:2025-11-04 07:31:54,102 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0559  memory: 56.91GiB(40.70%)  tps: 8,297  tflops: 386.97  mfu: 39.13%
[rank0]:2025-11-04 07:31:54,152 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0731_stage0_step1100.svg
[rank2]:2025-11-04 07:31:54,096 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0559  memory: 39.30GiB(28.11%)  tps: 8,296  tflops: 386.95  mfu: 39.12%
[rank2]:2025-11-04 07:31:54,149 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0731_stage2_step1100.svg
[rank1]:2025-11-04 07:31:54,150 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0731_stage1_step1100.svg
[rank3]:2025-11-04 07:31:54,236 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0731_real_step1100_rank3.svg
[rank3]:> Batch Time: 472.00 ms, GPU Bubble Ratio: 51.39%, 35.34%, 38.73%, 34.34%
[rank3]:2025-11-04 07:31:54,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0731_stage3_step1100.svg
[rank0]:2025-11-04 07:33:29,165 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:33:30,923 - INFO - Avg. fwd time: 16.1464 / Avg. bwd time: 30.2474 / Avg. batch time: 386.7491 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-11-04 07:33:30,937 - INFO - Avg. fwd time: 14.3542 / Avg. bwd time: 27.4915 / Avg. batch time: 436.4759 (ms) / GPU bubble ratio: 23.30%
[rank1]:2025-11-04 07:33:30,946 - INFO - Avg. fwd time: 16.3146 / Avg. bwd time: 29.5157 / Avg. batch time: 490.3074 (ms) / GPU bubble ratio: 25.22%
[rank0]:2025-11-04 07:33:30,971 - INFO - Avg. fwd time: 14.0994 / Avg. bwd time: 24.6669 / Avg. batch time: 540.9992 (ms) / GPU bubble ratio: 42.67%
[rank1]:2025-11-04 07:33:31,100 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0883  memory: 48.98GiB(35.03%)  tps: 8,444  tflops: 393.85  mfu: 39.82%
[rank3]:2025-11-04 07:33:31,100 - INFO -  step: 1150  loss:  0.2301  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,445  tflops: 393.85  mfu: 39.82%
[rank0]:2025-11-04 07:33:31,121 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0883  memory: 56.91GiB(40.70%)  tps: 8,444  tflops: 393.82  mfu: 39.82%
[rank2]:2025-11-04 07:33:31,105 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0883  memory: 39.30GiB(28.11%)  tps: 8,445  tflops: 393.86  mfu: 39.82%
[rank0]:2025-11-04 07:35:05,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:35:07,784 - INFO - Avg. fwd time: 16.1968 / Avg. bwd time: 29.8242 / Avg. batch time: 383.7623 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-04 07:35:07,825 - INFO - Avg. fwd time: 14.3937 / Avg. bwd time: 27.1766 / Avg. batch time: 433.3880 (ms) / GPU bubble ratio: 23.26%
[rank1]:2025-11-04 07:35:07,867 - INFO - Avg. fwd time: 16.3635 / Avg. bwd time: 29.1114 / Avg. batch time: 487.0662 (ms) / GPU bubble ratio: 25.31%
[rank3]:2025-11-04 07:35:07,916 - INFO -  step: 1200  loss:  0.2861  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,462  tflops: 394.65  mfu: 39.90%
[rank3]:2025-11-04 07:35:07,916 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 07:35:07,908 - INFO - Avg. fwd time: 14.1311 / Avg. bwd time: 24.1824 / Avg. batch time: 537.6387 (ms) / GPU bubble ratio: 42.99%
[rank2]:2025-11-04 07:35:07,921 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0535  memory: 39.30GiB(28.11%)  tps: 8,461  tflops: 394.64  mfu: 39.90%
[rank2]:2025-11-04 07:35:07,921 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 07:35:07,915 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0535  memory: 48.98GiB(35.03%)  tps: 8,462  tflops: 394.65  mfu: 39.90%
[rank1]:2025-11-04 07:35:07,915 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 07:35:07,935 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0535  memory: 56.91GiB(40.70%)  tps: 8,462  tflops: 394.65  mfu: 39.90%
[rank0]:2025-11-04 07:35:07,935 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 07:35:24,407 - INFO - validate step: 1200  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,868
[rank0]:2025-11-04 07:35:24,408 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 07:35:24,412 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-04 07:35:24,439 - INFO - validate step: 1200  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,788
[rank1]:2025-11-04 07:35:24,440 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 07:35:24,472 - INFO - validate step: 1200  loss:  0.2505  memory: 47.72GiB(34.13%)  tps: 24,742
[rank3]:2025-11-04 07:35:24,473 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 07:35:24,456 - INFO - validate step: 1200  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,773
[rank2]:2025-11-04 07:35:24,457 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 07:35:38,312 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.86 seconds.
[rank0]:2025-11-04 07:35:39,025 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 07:35:39,032 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.62 seconds.
[rank3]:2025-11-04 07:35:40,335 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.86 seconds.
[rank1]:2025-11-04 07:35:41,067 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.63 seconds.
[rank1]:2025-11-04 07:35:41,130 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0735_stage1_step1200.svg
[rank2]:2025-11-04 07:35:41,134 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0735_stage2_step1200.svg
[rank0]:2025-11-04 07:35:41,206 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0735_stage0_step1200.svg
[rank3]:2025-11-04 07:35:41,291 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0735_real_step1200_rank3.svg
[rank3]:> Batch Time: 464.16 ms, GPU Bubble Ratio: 50.45%, 35.02%, 38.41%, 34.30%
[rank3]:2025-11-04 07:35:41,374 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0735_stage3_step1200.svg
[rank0]:2025-11-04 07:37:18,247 - INFO - [GC] Peforming periodical GC collection 2.28 seconds
[rank1]:2025-11-04 07:37:20,010 - INFO - Avg. fwd time: 16.3998 / Avg. bwd time: 28.7883 / Avg. batch time: 484.5364 (ms) / GPU bubble ratio: 25.39%
[rank3]:2025-11-04 07:37:19,987 - INFO - Avg. fwd time: 16.2344 / Avg. bwd time: 29.4972 / Avg. batch time: 381.4436 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-11-04 07:37:20,003 - INFO - Avg. fwd time: 14.4206 / Avg. bwd time: 26.9278 / Avg. batch time: 430.9988 (ms) / GPU bubble ratio: 23.25%
[rank0]:2025-11-04 07:37:20,035 - INFO - Avg. fwd time: 14.1563 / Avg. bwd time: 23.7963 / Avg. batch time: 535.0192 (ms) / GPU bubble ratio: 43.25%
[rank1]:2025-11-04 07:37:20,157 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0675  memory: 48.98GiB(35.03%)  tps: 7,079  tflops: 330.18  mfu: 33.39%
[rank0]:2025-11-04 07:37:20,170 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0675  memory: 56.91GiB(40.70%)  tps: 7,077  tflops: 330.05  mfu: 33.37%
[rank3]:2025-11-04 07:37:20,159 - INFO -  step: 1250  loss:  0.2788  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 7,081  tflops: 330.27  mfu: 33.39%
[rank2]:2025-11-04 07:37:20,165 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0675  memory: 39.30GiB(28.11%)  tps: 7,080  tflops: 330.21  mfu: 33.39%
[rank0]:2025-11-04 07:38:55,001 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 07:38:56,793 - INFO - Avg. fwd time: 14.1833 / Avg. bwd time: 23.3827 / Avg. batch time: 532.1374 (ms) / GPU bubble ratio: 43.52%
[rank3]:2025-11-04 07:38:56,745 - INFO - Avg. fwd time: 16.2763 / Avg. bwd time: 29.1378 / Avg. batch time: 378.9002 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-11-04 07:38:56,766 - INFO - Avg. fwd time: 16.4406 / Avg. bwd time: 28.4414 / Avg. batch time: 481.7554 (ms) / GPU bubble ratio: 25.47%
[rank2]:2025-11-04 07:38:56,759 - INFO - Avg. fwd time: 14.4529 / Avg. bwd time: 26.6558 / Avg. batch time: 428.3655 (ms) / GPU bubble ratio: 23.23%
[rank2]:2025-11-04 07:38:56,926 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0393  memory: 39.30GiB(28.11%)  tps: 8,466  tflops: 394.87  mfu: 39.93%
[rank3]:2025-11-04 07:38:56,921 - INFO -  step: 1300  loss:  0.1835  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,466  tflops: 394.87  mfu: 39.93%
[rank0]:2025-11-04 07:38:56,934 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0393  memory: 56.91GiB(40.70%)  tps: 8,466  tflops: 394.86  mfu: 39.92%
[rank0]:2025-11-04 07:38:56,985 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0738_stage0_step1300.svg
[rank1]:2025-11-04 07:38:56,920 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0393  memory: 48.98GiB(35.03%)  tps: 8,466  tflops: 394.86  mfu: 39.93%
[rank1]:2025-11-04 07:38:56,982 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0738_stage1_step1300.svg
[rank2]:2025-11-04 07:38:56,985 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0738_stage2_step1300.svg
[rank3]:2025-11-04 07:38:57,069 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0738_real_step1300_rank3.svg
[rank3]:> Batch Time: 460.56 ms, GPU Bubble Ratio: 50.71%, 35.15%, 38.53%, 34.48%
[rank3]:2025-11-04 07:38:57,112 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0738_stage3_step1300.svg
[rank0]:2025-11-04 07:40:33,134 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:40:34,968 - INFO - Avg. fwd time: 16.3209 / Avg. bwd time: 28.8170 / Avg. batch time: 376.6885 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-11-04 07:40:35,011 - INFO - Avg. fwd time: 14.4857 / Avg. bwd time: 26.4241 / Avg. batch time: 426.0967 (ms) / GPU bubble ratio: 23.19%
[rank1]:2025-11-04 07:40:35,055 - INFO - Avg. fwd time: 16.4830 / Avg. bwd time: 28.1246 / Avg. batch time: 479.3636 (ms) / GPU bubble ratio: 25.56%
[rank2]:2025-11-04 07:40:35,111 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0607  memory: 39.30GiB(28.11%)  tps: 8,344  tflops: 389.14  mfu: 39.35%
[rank3]:2025-11-04 07:40:35,104 - INFO -  step: 1350  loss:  0.1249  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,344  tflops: 389.15  mfu: 39.35%
[rank1]:2025-11-04 07:40:35,103 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0607  memory: 48.98GiB(35.03%)  tps: 8,344  tflops: 389.15  mfu: 39.35%
[rank0]:2025-11-04 07:40:35,097 - INFO - Avg. fwd time: 14.2118 / Avg. bwd time: 23.0049 / Avg. batch time: 529.6618 (ms) / GPU bubble ratio: 43.79%
[rank0]:2025-11-04 07:40:35,118 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0607  memory: 56.91GiB(40.70%)  tps: 8,344  tflops: 389.14  mfu: 39.35%
[rank0]:2025-11-04 07:42:09,693 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:42:11,492 - INFO - Avg. fwd time: 14.5082 / Avg. bwd time: 26.2326 / Avg. batch time: 424.1135 (ms) / GPU bubble ratio: 23.15%
[rank3]:2025-11-04 07:42:11,477 - INFO - Avg. fwd time: 16.3500 / Avg. bwd time: 28.5486 / Avg. batch time: 374.7722 (ms) / GPU bubble ratio: 4.16%
[rank0]:2025-11-04 07:42:11,526 - INFO - Avg. fwd time: 14.2299 / Avg. bwd time: 22.7098 / Avg. batch time: 527.5054 (ms) / GPU bubble ratio: 43.98%
[rank1]:2025-11-04 07:42:11,499 - INFO - Avg. fwd time: 16.5123 / Avg. bwd time: 27.8725 / Avg. batch time: 477.2841 (ms) / GPU bubble ratio: 25.60%
[rank3]:2025-11-04 07:42:11,655 - INFO -  step: 1400  loss:  0.3808  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,485  tflops: 395.73  mfu: 40.01%
[rank3]:2025-11-04 07:42:11,655 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 07:42:11,669 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1015  memory: 56.91GiB(40.70%)  tps: 8,485  tflops: 395.73  mfu: 40.01%
[rank0]:2025-11-04 07:42:11,669 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 07:42:11,654 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1015  memory: 48.98GiB(35.03%)  tps: 8,485  tflops: 395.72  mfu: 40.01%
[rank1]:2025-11-04 07:42:11,654 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-04 07:42:11,661 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1015  memory: 39.30GiB(28.11%)  tps: 8,485  tflops: 395.73  mfu: 40.01%
[rank2]:2025-11-04 07:42:11,662 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-04 07:42:28,270 - INFO - validate step: 1400  loss:  0.2483  memory: 47.72GiB(34.13%)  tps: 24,653
[rank0]:2025-11-04 07:42:28,207 - INFO - validate step: 1400  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,768
[rank1]:2025-11-04 07:42:28,240 - INFO - validate step: 1400  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,697
[rank2]:2025-11-04 07:42:28,256 - INFO - validate step: 1400  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,684
[rank0]:2025-11-04 07:42:28,325 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0742_stage0_step1400.svg
[rank1]:2025-11-04 07:42:28,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0742_stage1_step1400.svg
[rank2]:2025-11-04 07:42:28,323 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0742_stage2_step1400.svg
[rank3]:2025-11-04 07:42:28,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0742_real_step1400_rank3.svg
[rank3]:> Batch Time: 464.22 ms, GPU Bubble Ratio: 50.48%, 34.82%, 38.62%, 34.66%
[rank3]:2025-11-04 07:42:28,451 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0742_stage3_step1400.svg
[rank0]:2025-11-04 07:44:05,361 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 07:44:07,115 - INFO - Avg. fwd time: 16.3938 / Avg. bwd time: 28.2756 / Avg. batch time: 372.9381 (ms) / GPU bubble ratio: 4.18%
[rank0]:2025-11-04 07:44:07,159 - INFO - Avg. fwd time: 14.2568 / Avg. bwd time: 22.3838 / Avg. batch time: 525.4583 (ms) / GPU bubble ratio: 44.22%
[rank1]:2025-11-04 07:44:07,136 - INFO - Avg. fwd time: 16.5528 / Avg. bwd time: 27.6045 / Avg. batch time: 475.3112 (ms) / GPU bubble ratio: 25.68%
[rank2]:2025-11-04 07:44:07,128 - INFO - Avg. fwd time: 14.5408 / Avg. bwd time: 26.0242 / Avg. batch time: 422.2333 (ms) / GPU bubble ratio: 23.14%
[rank3]:2025-11-04 07:44:07,291 - INFO -  step: 1450  loss:  0.1971  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,273  tflops: 385.86  mfu: 39.02%
[rank0]:2025-11-04 07:44:07,304 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0578  memory: 56.91GiB(40.70%)  tps: 8,267  tflops: 385.56  mfu: 38.98%
[rank1]:2025-11-04 07:44:07,290 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0578  memory: 48.98GiB(35.03%)  tps: 8,271  tflops: 385.74  mfu: 39.00%
[rank2]:2025-11-04 07:44:07,296 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0578  memory: 39.30GiB(28.11%)  tps: 8,271  tflops: 385.78  mfu: 39.01%
[rank0]:2025-11-04 07:45:44,582 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:45:46,479 - INFO - Avg. fwd time: 16.4381 / Avg. bwd time: 28.0213 / Avg. batch time: 371.2579 (ms) / GPU bubble ratio: 4.20%
[rank2]:2025-11-04 07:45:46,523 - INFO - Avg. fwd time: 14.5729 / Avg. bwd time: 25.8312 / Avg. batch time: 420.5006 (ms) / GPU bubble ratio: 23.13%
[rank1]:2025-11-04 07:45:46,567 - INFO - Avg. fwd time: 16.5920 / Avg. bwd time: 27.3544 / Avg. batch time: 473.4875 (ms) / GPU bubble ratio: 25.75%
[rank1]:2025-11-04 07:45:46,615 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0572  memory: 48.98GiB(35.03%)  tps: 8,248  tflops: 384.67  mfu: 38.90%
[rank0]:2025-11-04 07:45:46,610 - INFO - Avg. fwd time: 14.2831 / Avg. bwd time: 22.0799 / Avg. batch time: 523.5680 (ms) / GPU bubble ratio: 44.44%
[rank0]:2025-11-04 07:45:46,629 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0572  memory: 56.91GiB(40.70%)  tps: 8,248  tflops: 384.68  mfu: 38.90%
[rank3]:2025-11-04 07:45:46,616 - INFO -  step: 1500  loss:  0.2686  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,248  tflops: 384.68  mfu: 38.90%
[rank2]:2025-11-04 07:45:46,621 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0572  memory: 39.30GiB(28.11%)  tps: 8,248  tflops: 384.67  mfu: 38.90%
[rank2]:2025-11-04 07:45:46,680 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0745_stage2_step1500.svg
[rank1]:2025-11-04 07:45:46,680 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0745_stage1_step1500.svg
[rank0]:2025-11-04 07:45:46,682 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0745_stage0_step1500.svg
[rank3]:2025-11-04 07:45:46,764 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0745_real_step1500_rank3.svg
[rank3]:> Batch Time: 472.78 ms, GPU Bubble Ratio: 51.97%, 35.20%, 39.42%, 34.47%
[rank3]:2025-11-04 07:45:46,809 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0745_stage3_step1500.svg
[rank0]:2025-11-04 07:47:23,712 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:47:25,511 - INFO - Avg. fwd time: 16.4726 / Avg. bwd time: 27.8193 / Avg. batch time: 369.9179 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-11-04 07:47:25,526 - INFO - Avg. fwd time: 14.5979 / Avg. bwd time: 25.6767 / Avg. batch time: 419.1288 (ms) / GPU bubble ratio: 23.13%
[rank1]:2025-11-04 07:47:25,532 - INFO - Avg. fwd time: 16.6234 / Avg. bwd time: 27.1548 / Avg. batch time: 472.0530 (ms) / GPU bubble ratio: 25.81%
[rank0]:2025-11-04 07:47:25,559 - INFO - Avg. fwd time: 14.3045 / Avg. bwd time: 21.8311 / Avg. batch time: 522.0749 (ms) / GPU bubble ratio: 44.63%
[rank1]:2025-11-04 07:47:25,692 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0817  memory: 48.98GiB(35.03%)  tps: 8,268  tflops: 385.64  mfu: 38.99%
[rank0]:2025-11-04 07:47:25,712 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0817  memory: 56.91GiB(40.70%)  tps: 8,268  tflops: 385.61  mfu: 38.99%
[rank3]:2025-11-04 07:47:25,693 - INFO -  step: 1550  loss:  0.2990  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,268  tflops: 385.64  mfu: 38.99%
[rank2]:2025-11-04 07:47:25,698 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0817  memory: 39.30GiB(28.11%)  tps: 8,268  tflops: 385.64  mfu: 38.99%
[rank0]:2025-11-04 07:49:01,743 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:49:03,574 - INFO - Avg. fwd time: 14.6215 / Avg. bwd time: 25.5028 / Avg. batch time: 417.4870 (ms) / GPU bubble ratio: 23.11%
[rank1]:2025-11-04 07:49:03,582 - INFO - Avg. fwd time: 16.6533 / Avg. bwd time: 26.9317 / Avg. batch time: 470.3321 (ms) / GPU bubble ratio: 25.87%
[rank0]:2025-11-04 07:49:03,605 - INFO - Avg. fwd time: 14.3237 / Avg. bwd time: 21.5613 / Avg. batch time: 520.2877 (ms) / GPU bubble ratio: 44.82%
[rank3]:2025-11-04 07:49:03,558 - INFO - Avg. fwd time: 16.5046 / Avg. bwd time: 27.5892 / Avg. batch time: 368.3320 (ms) / GPU bubble ratio: 4.23%
[rank3]:2025-11-04 07:49:03,735 - INFO -  step: 1600  loss:  0.4220  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,356  tflops: 389.71  mfu: 39.40%
[rank3]:2025-11-04 07:49:03,735 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 07:49:03,742 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1577  memory: 39.30GiB(28.11%)  tps: 8,355  tflops: 389.70  mfu: 39.40%
[rank2]:2025-11-04 07:49:03,742 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 07:49:03,734 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1577  memory: 48.98GiB(35.03%)  tps: 8,356  tflops: 389.71  mfu: 39.40%
[rank1]:2025-11-04 07:49:03,734 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 07:49:03,747 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1577  memory: 56.91GiB(40.70%)  tps: 8,356  tflops: 389.73  mfu: 39.41%
[rank0]:2025-11-04 07:49:03,747 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 07:49:20,187 - INFO - validate step: 1600  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,916
[rank2]:2025-11-04 07:49:20,237 - INFO - validate step: 1600  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,833
[rank1]:2025-11-04 07:49:20,220 - INFO - validate step: 1600  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,846
[rank0]:2025-11-04 07:49:20,314 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0749_stage0_step1600.svg
[rank3]:2025-11-04 07:49:20,258 - INFO - validate step: 1600  loss:  0.2512  memory: 47.72GiB(34.13%)  tps: 24,792
[rank2]:2025-11-04 07:49:20,312 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0749_stage2_step1600.svg
[rank1]:2025-11-04 07:49:20,314 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0749_stage1_step1600.svg
[rank3]:2025-11-04 07:49:20,397 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0749_real_step1600_rank3.svg
[rank3]:> Batch Time: 471.28 ms, GPU Bubble Ratio: 51.99%, 35.46%, 39.03%, 34.37%
[rank3]:2025-11-04 07:49:20,444 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0749_stage3_step1600.svg
[rank0]:2025-11-04 07:50:57,411 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 07:50:59,307 - INFO - Avg. fwd time: 16.5373 / Avg. bwd time: 27.3797 / Avg. batch time: 366.9168 (ms) / GPU bubble ratio: 4.25%
[rank2]:2025-11-04 07:50:59,352 - INFO - Avg. fwd time: 14.6458 / Avg. bwd time: 25.3425 / Avg. batch time: 416.0380 (ms) / GPU bubble ratio: 23.11%
[rank2]:2025-11-04 07:50:59,453 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0741  memory: 39.30GiB(28.11%)  tps: 8,257  tflops: 385.10  mfu: 38.94%
[rank1]:2025-11-04 07:50:59,397 - INFO - Avg. fwd time: 16.6835 / Avg. bwd time: 26.7244 / Avg. batch time: 468.8130 (ms) / GPU bubble ratio: 25.93%
[rank1]:2025-11-04 07:50:59,447 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,256  tflops: 385.05  mfu: 38.93%
[rank0]:2025-11-04 07:50:59,442 - INFO - Avg. fwd time: 14.3435 / Avg. bwd time: 21.3160 / Avg. batch time: 518.7105 (ms) / GPU bubble ratio: 45.00%
[rank0]:2025-11-04 07:50:59,461 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0741  memory: 56.91GiB(40.70%)  tps: 8,252  tflops: 384.87  mfu: 38.92%
[rank3]:2025-11-04 07:50:59,448 - INFO -  step: 1650  loss:  0.4213  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,259  tflops: 385.20  mfu: 38.95%
[rank0]:2025-11-04 07:52:36,331 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 07:52:38,152 - INFO - Avg. fwd time: 14.6653 / Avg. bwd time: 25.2123 / Avg. batch time: 414.8335 (ms) / GPU bubble ratio: 23.10%
[rank1]:2025-11-04 07:52:38,159 - INFO - Avg. fwd time: 16.7083 / Avg. bwd time: 26.5559 / Avg. batch time: 467.5478 (ms) / GPU bubble ratio: 25.97%
[rank0]:2025-11-04 07:52:38,185 - INFO - Avg. fwd time: 14.3608 / Avg. bwd time: 21.1118 / Avg. batch time: 517.3977 (ms) / GPU bubble ratio: 45.15%
[rank3]:2025-11-04 07:52:38,138 - INFO - Avg. fwd time: 16.5640 / Avg. bwd time: 27.2074 / Avg. batch time: 365.7517 (ms) / GPU bubble ratio: 4.26%
[rank3]:2025-11-04 07:52:38,316 - INFO -  step: 1700  loss:  0.4176  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,286  tflops: 386.46  mfu: 39.08%
[rank2]:2025-11-04 07:52:38,322 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1127  memory: 39.30GiB(28.11%)  tps: 8,286  tflops: 386.45  mfu: 39.07%
[rank1]:2025-11-04 07:52:38,315 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1127  memory: 48.98GiB(35.03%)  tps: 8,286  tflops: 386.45  mfu: 39.08%
[rank0]:2025-11-04 07:52:38,337 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.1127  memory: 56.91GiB(40.70%)  tps: 8,285  tflops: 386.42  mfu: 39.07%
[rank0]:2025-11-04 07:52:38,391 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0752_stage0_step1700.svg
[rank2]:2025-11-04 07:52:38,390 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0752_stage2_step1700.svg
[rank1]:2025-11-04 07:52:38,388 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0752_stage1_step1700.svg
[rank3]:2025-11-04 07:52:38,475 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0752_real_step1700_rank3.svg
[rank3]:> Batch Time: 469.55 ms, GPU Bubble Ratio: 51.08%, 35.12%, 38.93%, 34.61%
[rank3]:2025-11-04 07:52:38,521 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0752_stage3_step1700.svg
[rank0]:2025-11-04 07:54:14,961 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:54:16,768 - INFO - Avg. fwd time: 16.5924 / Avg. bwd time: 27.0183 / Avg. batch time: 364.4655 (ms) / GPU bubble ratio: 4.27%
[rank1]:2025-11-04 07:54:16,788 - INFO - Avg. fwd time: 16.7347 / Avg. bwd time: 26.3699 / Avg. batch time: 466.1495 (ms) / GPU bubble ratio: 26.02%
[rank2]:2025-11-04 07:54:16,781 - INFO - Avg. fwd time: 14.6863 / Avg. bwd time: 25.0729 / Avg. batch time: 413.5155 (ms) / GPU bubble ratio: 23.08%
[rank0]:2025-11-04 07:54:16,815 - INFO - Avg. fwd time: 14.3803 / Avg. bwd time: 20.8887 / Avg. batch time: 515.9523 (ms) / GPU bubble ratio: 45.31%
[rank1]:2025-11-04 07:54:16,943 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0785  memory: 48.98GiB(35.03%)  tps: 8,306  tflops: 387.39  mfu: 39.17%
[rank0]:2025-11-04 07:54:16,958 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0785  memory: 56.91GiB(40.70%)  tps: 8,307  tflops: 387.42  mfu: 39.17%
[rank3]:2025-11-04 07:54:16,944 - INFO -  step: 1750  loss:  0.4329  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,306  tflops: 387.40  mfu: 39.17%
[rank2]:2025-11-04 07:54:16,948 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0785  memory: 39.30GiB(28.11%)  tps: 8,306  tflops: 387.40  mfu: 39.17%
[rank0]:2025-11-04 07:55:51,528 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 07:55:53,315 - INFO - Avg. fwd time: 16.6092 / Avg. bwd time: 26.8293 / Avg. batch time: 363.1073 (ms) / GPU bubble ratio: 4.30%
[rank1]:2025-11-04 07:55:53,409 - INFO - Avg. fwd time: 16.7517 / Avg. bwd time: 26.1925 / Avg. batch time: 464.6572 (ms) / GPU bubble ratio: 26.06%
[rank2]:2025-11-04 07:55:53,364 - INFO - Avg. fwd time: 14.6995 / Avg. bwd time: 24.9371 / Avg. batch time: 412.1065 (ms) / GPU bubble ratio: 23.06%
[rank0]:2025-11-04 07:55:53,453 - INFO - Avg. fwd time: 14.3915 / Avg. bwd time: 20.6819 / Avg. batch time: 514.4079 (ms) / GPU bubble ratio: 45.45%
[rank0]:2025-11-04 07:55:53,480 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0415  memory: 56.91GiB(40.70%)  tps: 8,487  tflops: 395.84  mfu: 40.02%
[rank0]:2025-11-04 07:55:53,480 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-04 07:55:53,460 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0415  memory: 48.98GiB(35.03%)  tps: 8,488  tflops: 395.87  mfu: 40.03%
[rank1]:2025-11-04 07:55:53,461 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-04 07:55:53,465 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0415  memory: 39.30GiB(28.11%)  tps: 8,488  tflops: 395.87  mfu: 40.03%
[rank2]:2025-11-04 07:55:53,465 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-04 07:55:53,467 - INFO -  step: 1800  loss:  0.0641  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,488  tflops: 395.87  mfu: 40.03%
[rank3]:2025-11-04 07:55:53,467 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-04 07:56:10,048 - INFO - validate step: 1800  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,695
[rank2]:2025-11-04 07:56:10,072 - INFO - validate step: 1800  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,664
[rank0]:2025-11-04 07:56:10,016 - INFO - validate step: 1800  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,771
[rank1]:2025-11-04 07:56:10,148 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0756_stage1_step1800.svg
[rank2]:2025-11-04 07:56:10,154 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0756_stage2_step1800.svg
[rank3]:2025-11-04 07:56:10,094 - INFO - validate step: 1800  loss:  0.2469  memory: 47.72GiB(34.13%)  tps: 24,637
[rank0]:2025-11-04 07:56:10,150 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0756_stage0_step1800.svg
[rank3]:2025-11-04 07:56:10,241 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0756_real_step1800_rank3.svg
[rank3]:> Batch Time: 454.30 ms, GPU Bubble Ratio: 50.31%, 34.97%, 38.50%, 34.49%
[rank3]:2025-11-04 07:56:10,288 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0756_stage3_step1800.svg
[rank0]:2025-11-04 07:57:44,367 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 07:57:46,111 - INFO - Avg. fwd time: 16.7648 / Avg. bwd time: 26.0454 / Avg. batch time: 463.4546 (ms) / GPU bubble ratio: 26.10%
[rank3]:2025-11-04 07:57:46,091 - INFO - Avg. fwd time: 16.6218 / Avg. bwd time: 26.6776 / Avg. batch time: 361.9914 (ms) / GPU bubble ratio: 4.31%
[rank2]:2025-11-04 07:57:46,109 - INFO - Avg. fwd time: 14.7098 / Avg. bwd time: 24.8272 / Avg. batch time: 410.9596 (ms) / GPU bubble ratio: 23.03%
[rank0]:2025-11-04 07:57:46,137 - INFO - Avg. fwd time: 14.3986 / Avg. bwd time: 20.5100 / Avg. batch time: 513.1569 (ms) / GPU bubble ratio: 45.58%
[rank3]:2025-11-04 07:57:46,260 - INFO -  step: 1850  loss:  0.3746  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,519  tflops: 397.32  mfu: 40.17%
[rank0]:2025-11-04 07:57:46,279 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1044  memory: 56.91GiB(40.70%)  tps: 8,510  tflops: 396.91  mfu: 40.13%
[rank1]:2025-11-04 07:57:46,258 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1044  memory: 48.98GiB(35.03%)  tps: 8,515  tflops: 397.13  mfu: 40.15%
[rank2]:2025-11-04 07:57:46,267 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1044  memory: 39.30GiB(28.11%)  tps: 8,516  tflops: 397.19  mfu: 40.16%
[rank0]:2025-11-04 07:59:19,864 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 07:59:21,606 - INFO - Avg. fwd time: 16.7761 / Avg. bwd time: 25.8830 / Avg. batch time: 462.0295 (ms) / GPU bubble ratio: 26.14%
[rank2]:2025-11-04 07:59:21,599 - INFO - Avg. fwd time: 14.7189 / Avg. bwd time: 24.7000 / Avg. batch time: 409.5984 (ms) / GPU bubble ratio: 23.01%
[rank3]:2025-11-04 07:59:21,586 - INFO - Avg. fwd time: 16.6331 / Avg. bwd time: 26.5032 / Avg. batch time: 360.6825 (ms) / GPU bubble ratio: 4.32%
[rank0]:2025-11-04 07:59:21,633 - INFO - Avg. fwd time: 14.4054 / Avg. bwd time: 20.3201 / Avg. batch time: 511.6798 (ms) / GPU bubble ratio: 45.71%
[rank1]:2025-11-04 07:59:21,757 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0345  memory: 48.98GiB(35.03%)  tps: 8,578  tflops: 400.09  mfu: 40.45%
[rank2]:2025-11-04 07:59:21,762 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0345  memory: 39.30GiB(28.11%)  tps: 8,578  tflops: 400.10  mfu: 40.46%
[rank2]:2025-11-04 07:59:21,826 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0759_stage2_step1900.svg
[rank3]:2025-11-04 07:59:21,758 - INFO -  step: 1900  loss:  0.2032  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,578  tflops: 400.10  mfu: 40.45%
[rank0]:2025-11-04 07:59:21,771 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0345  memory: 56.91GiB(40.70%)  tps: 8,579  tflops: 400.12  mfu: 40.46%
[rank0]:2025-11-04 07:59:21,823 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0759_stage0_step1900.svg
[rank1]:2025-11-04 07:59:21,822 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0759_stage1_step1900.svg
[rank3]:2025-11-04 07:59:21,907 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0759_real_step1900_rank3.svg
[rank3]:> Batch Time: 456.83 ms, GPU Bubble Ratio: 50.52%, 34.76%, 38.75%, 34.65%
[rank3]:2025-11-04 07:59:21,953 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0759_stage3_step1900.svg
[rank0]:2025-11-04 08:00:54,877 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:00:56,679 - INFO - Avg. fwd time: 16.6422 / Avg. bwd time: 26.3366 / Avg. batch time: 359.4189 (ms) / GPU bubble ratio: 4.34%
[rank1]:2025-11-04 08:00:56,771 - INFO - Avg. fwd time: 16.7861 / Avg. bwd time: 25.7292 / Avg. batch time: 460.6664 (ms) / GPU bubble ratio: 26.17%
[rank2]:2025-11-04 08:00:56,725 - INFO - Avg. fwd time: 14.7266 / Avg. bwd time: 24.5816 / Avg. batch time: 408.2949 (ms) / GPU bubble ratio: 22.98%
[rank3]:2025-11-04 08:00:56,825 - INFO -  step: 1950  loss:  0.1661  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,617  tflops: 401.91  mfu: 40.64%
[rank0]:2025-11-04 08:00:56,816 - INFO - Avg. fwd time: 14.4096 / Avg. bwd time: 20.1432 / Avg. batch time: 510.2618 (ms) / GPU bubble ratio: 45.83%
[rank0]:2025-11-04 08:00:56,845 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0516  memory: 56.91GiB(40.70%)  tps: 8,616  tflops: 401.87  mfu: 40.63%
[rank1]:2025-11-04 08:00:56,823 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,617  tflops: 401.90  mfu: 40.64%
[rank2]:2025-11-04 08:00:56,831 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0516  memory: 39.30GiB(28.11%)  tps: 8,617  tflops: 401.89  mfu: 40.64%
[rank0]:2025-11-04 08:02:29,190 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:02:30,953 - INFO - Avg. fwd time: 16.7940 / Avg. bwd time: 25.5991 / Avg. batch time: 459.4928 (ms) / GPU bubble ratio: 26.19%
[rank2]:2025-11-04 08:02:30,946 - INFO - Avg. fwd time: 14.7325 / Avg. bwd time: 24.4853 / Avg. batch time: 407.1977 (ms) / GPU bubble ratio: 22.95%
[rank3]:2025-11-04 08:02:30,930 - INFO - Avg. fwd time: 16.6493 / Avg. bwd time: 26.1981 / Avg. batch time: 358.3639 (ms) / GPU bubble ratio: 4.35%
[rank0]:2025-11-04 08:02:30,977 - INFO - Avg. fwd time: 14.4136 / Avg. bwd time: 19.9917 / Avg. batch time: 509.0412 (ms) / GPU bubble ratio: 45.93%
[rank3]:2025-11-04 08:02:31,106 - INFO -  step: 2000  loss:  0.2015  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,689  tflops: 405.26  mfu: 40.98%
[rank3]:2025-11-04 08:02:31,106 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 08:02:31,119 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0479  memory: 56.91GiB(40.70%)  tps: 8,690  tflops: 405.28  mfu: 40.98%
[rank0]:2025-11-04 08:02:31,119 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-04 08:02:31,104 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0479  memory: 48.98GiB(35.03%)  tps: 8,689  tflops: 405.25  mfu: 40.98%
[rank1]:2025-11-04 08:02:31,105 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-04 08:02:31,112 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0479  memory: 39.30GiB(28.11%)  tps: 8,689  tflops: 405.25  mfu: 40.98%
[rank2]:2025-11-04 08:02:31,112 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 08:02:47,613 - INFO - validate step: 2000  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,835
[rank1]:2025-11-04 08:02:47,646 - INFO - validate step: 2000  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,763
[rank2]:2025-11-04 08:02:47,662 - INFO - validate step: 2000  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,749
[rank3]:2025-11-04 08:02:47,678 - INFO - validate step: 2000  loss:  0.2413  memory: 47.72GiB(34.13%)  tps: 24,718
[rank1]:2025-11-04 08:02:47,733 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0802_stage1_step2000.svg
[rank2]:2025-11-04 08:02:47,732 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0802_stage2_step2000.svg
[rank3]:2025-11-04 08:02:47,814 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0802_real_step2000_rank3.svg
[rank3]:> Batch Time: 458.31 ms, GPU Bubble Ratio: 51.28%, 35.38%, 38.36%, 34.66%
[rank0]:2025-11-04 08:02:47,733 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0802_stage0_step2000.svg
[rank3]:2025-11-04 08:02:47,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0802_stage3_step2000.svg
[rank0]:2025-11-04 08:04:21,899 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 08:04:23,652 - INFO - Avg. fwd time: 16.8037 / Avg. bwd time: 25.4576 / Avg. batch time: 458.3689 (ms) / GPU bubble ratio: 26.24%
[rank2]:2025-11-04 08:04:23,643 - INFO - Avg. fwd time: 14.7411 / Avg. bwd time: 24.3772 / Avg. batch time: 406.1444 (ms) / GPU bubble ratio: 22.95%
[rank3]:2025-11-04 08:04:23,630 - INFO - Avg. fwd time: 16.6622 / Avg. bwd time: 26.0547 / Avg. batch time: 357.3458 (ms) / GPU bubble ratio: 4.37%
[rank0]:2025-11-04 08:04:23,678 - INFO - Avg. fwd time: 14.4248 / Avg. bwd time: 19.8291 / Avg. batch time: 507.8886 (ms) / GPU bubble ratio: 46.05%
[rank3]:2025-11-04 08:04:23,804 - INFO -  step: 2050  loss:  0.2226  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,522  tflops: 397.48  mfu: 40.19%
[rank1]:2025-11-04 08:04:23,803 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0644  memory: 48.98GiB(35.03%)  tps: 8,519  tflops: 397.35  mfu: 40.18%
[rank2]:2025-11-04 08:04:23,809 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0644  memory: 39.30GiB(28.11%)  tps: 8,520  tflops: 397.39  mfu: 40.18%
[rank0]:2025-11-04 08:04:23,824 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0644  memory: 56.91GiB(40.70%)  tps: 8,515  tflops: 397.12  mfu: 40.15%
[rank0]:2025-11-04 08:05:56,683 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:05:58,546 - INFO - Avg. fwd time: 14.7481 / Avg. bwd time: 24.2720 / Avg. batch time: 405.0192 (ms) / GPU bubble ratio: 22.93%
[rank3]:2025-11-04 08:05:58,499 - INFO - Avg. fwd time: 16.6699 / Avg. bwd time: 25.9122 / Avg. batch time: 356.2634 (ms) / GPU bubble ratio: 4.38%
[rank1]:2025-11-04 08:05:58,592 - INFO - Avg. fwd time: 16.8122 / Avg. bwd time: 25.3231 / Avg. batch time: 457.1716 (ms) / GPU bubble ratio: 26.27%
[rank2]:2025-11-04 08:05:58,652 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0331  memory: 39.30GiB(28.11%)  tps: 8,638  tflops: 402.85  mfu: 40.73%
[rank3]:2025-11-04 08:05:58,647 - INFO -  step: 2100  loss:  0.2278  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,638  tflops: 402.86  mfu: 40.73%
[rank0]:2025-11-04 08:05:58,638 - INFO - Avg. fwd time: 14.4306 / Avg. bwd time: 19.6683 / Avg. batch time: 506.6510 (ms) / GPU bubble ratio: 46.16%
[rank0]:2025-11-04 08:05:58,667 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0331  memory: 56.91GiB(40.70%)  tps: 8,637  tflops: 402.85  mfu: 40.73%
[rank1]:2025-11-04 08:05:58,646 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0331  memory: 48.98GiB(35.03%)  tps: 8,637  tflops: 402.85  mfu: 40.73%
[rank1]:2025-11-04 08:05:58,721 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0805_stage1_step2100.svg
[rank2]:2025-11-04 08:05:58,722 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0805_stage2_step2100.svg
[rank0]:2025-11-04 08:05:58,727 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0805_stage0_step2100.svg
[rank3]:2025-11-04 08:05:58,806 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0805_real_step2100_rank3.svg
[rank3]:> Batch Time: 459.58 ms, GPU Bubble Ratio: 50.45%, 35.13%, 38.97%, 34.63%
[rank3]:2025-11-04 08:05:58,850 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0805_stage3_step2100.svg
[rank0]:2025-11-04 08:07:31,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:07:33,662 - INFO - Avg. fwd time: 14.7538 / Avg. bwd time: 24.1867 / Avg. batch time: 404.1219 (ms) / GPU bubble ratio: 22.91%
[rank3]:2025-11-04 08:07:33,646 - INFO - Avg. fwd time: 16.6764 / Avg. bwd time: 25.7953 / Avg. batch time: 355.3928 (ms) / GPU bubble ratio: 4.39%
[rank0]:2025-11-04 08:07:33,694 - INFO - Avg. fwd time: 14.4346 / Avg. bwd time: 19.5379 / Avg. batch time: 505.6762 (ms) / GPU bubble ratio: 46.25%
[rank1]:2025-11-04 08:07:33,669 - INFO - Avg. fwd time: 16.8209 / Avg. bwd time: 25.2145 / Avg. batch time: 456.2307 (ms) / GPU bubble ratio: 26.29%
[rank1]:2025-11-04 08:07:33,816 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0309  memory: 48.98GiB(35.03%)  tps: 8,608  tflops: 401.47  mfu: 40.59%
[rank2]:2025-11-04 08:07:33,823 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0309  memory: 39.30GiB(28.11%)  tps: 8,608  tflops: 401.46  mfu: 40.59%
[rank3]:2025-11-04 08:07:33,817 - INFO -  step: 2150  loss:  0.1851  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,608  tflops: 401.47  mfu: 40.59%
[rank0]:2025-11-04 08:07:33,831 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0309  memory: 56.91GiB(40.70%)  tps: 8,608  tflops: 401.50  mfu: 40.60%
[rank0]:2025-11-04 08:09:06,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 08:09:08,640 - INFO - Avg. fwd time: 14.7600 / Avg. bwd time: 24.0888 / Avg. batch time: 403.0890 (ms) / GPU bubble ratio: 22.90%
[rank3]:2025-11-04 08:09:08,628 - INFO - Avg. fwd time: 16.6833 / Avg. bwd time: 25.6649 / Avg. batch time: 354.4006 (ms) / GPU bubble ratio: 4.41%
[rank0]:2025-11-04 08:09:08,671 - INFO - Avg. fwd time: 14.4382 / Avg. bwd time: 19.3964 / Avg. batch time: 504.5502 (ms) / GPU bubble ratio: 46.35%
[rank1]:2025-11-04 08:09:08,649 - INFO - Avg. fwd time: 16.8281 / Avg. bwd time: 25.0929 / Avg. batch time: 455.1464 (ms) / GPU bubble ratio: 26.32%
[rank1]:2025-11-04 08:09:08,796 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0325  memory: 48.98GiB(35.03%)  tps: 8,625  tflops: 402.27  mfu: 40.67%
[rank1]:2025-11-04 08:09:08,796 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-04 08:09:08,804 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0325  memory: 39.30GiB(28.11%)  tps: 8,625  tflops: 402.27  mfu: 40.67%
[rank2]:2025-11-04 08:09:08,804 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 08:09:08,798 - INFO -  step: 2200  loss:  0.1812  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,625  tflops: 402.28  mfu: 40.68%
[rank3]:2025-11-04 08:09:08,798 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 08:09:08,810 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0325  memory: 56.91GiB(40.70%)  tps: 8,625  tflops: 402.28  mfu: 40.68%
[rank0]:2025-11-04 08:09:08,810 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 08:09:25,534 - INFO - validate step: 2200  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,491
[rank1]:2025-11-04 08:09:25,570 - INFO - validate step: 2200  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,419
[rank2]:2025-11-04 08:09:25,587 - INFO - validate step: 2200  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,406
[rank2]:2025-11-04 08:09:25,643 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0809_stage2_step2200.svg
[rank3]:2025-11-04 08:09:25,594 - INFO - validate step: 2200  loss:  0.2409  memory: 47.72GiB(34.13%)  tps: 24,389
[rank0]:2025-11-04 08:09:25,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0809_stage0_step2200.svg
[rank1]:2025-11-04 08:09:25,644 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0809_stage1_step2200.svg
[rank3]:2025-11-04 08:09:25,735 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0809_real_step2200_rank3.svg
[rank3]:> Batch Time: 460.50 ms, GPU Bubble Ratio: 51.40%, 35.20%, 38.87%, 34.71%
[rank3]:2025-11-04 08:09:25,778 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0809_stage3_step2200.svg
[rank0]:2025-11-04 08:10:58,863 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 08:11:00,665 - INFO - Avg. fwd time: 16.6900 / Avg. bwd time: 25.5407 / Avg. batch time: 353.4566 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-11-04 08:11:00,711 - INFO - Avg. fwd time: 14.7665 / Avg. bwd time: 23.9944 / Avg. batch time: 402.1167 (ms) / GPU bubble ratio: 22.89%
[rank1]:2025-11-04 08:11:00,760 - INFO - Avg. fwd time: 16.8350 / Avg. bwd time: 24.9763 / Avg. batch time: 454.1197 (ms) / GPU bubble ratio: 26.34%
[rank1]:2025-11-04 08:11:00,813 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0835  memory: 48.98GiB(35.03%)  tps: 8,601  tflops: 401.16  mfu: 40.56%
[rank2]:2025-11-04 08:11:00,821 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0835  memory: 39.30GiB(28.11%)  tps: 8,602  tflops: 401.20  mfu: 40.57%
[rank3]:2025-11-04 08:11:00,814 - INFO -  step: 2250  loss:  0.2269  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,603  tflops: 401.26  mfu: 40.57%
[rank0]:2025-11-04 08:11:00,807 - INFO - Avg. fwd time: 14.4416 / Avg. bwd time: 19.2625 / Avg. batch time: 503.4843 (ms) / GPU bubble ratio: 46.45%
[rank0]:2025-11-04 08:11:00,830 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0835  memory: 56.91GiB(40.70%)  tps: 8,596  tflops: 400.94  mfu: 40.54%
[rank0]:2025-11-04 08:12:34,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:12:35,971 - INFO - Avg. fwd time: 16.8408 / Avg. bwd time: 24.8817 / Avg. batch time: 453.3013 (ms) / GPU bubble ratio: 26.37%
[rank2]:2025-11-04 08:12:35,963 - INFO - Avg. fwd time: 14.7712 / Avg. bwd time: 23.9226 / Avg. batch time: 401.3321 (ms) / GPU bubble ratio: 22.87%
[rank3]:2025-11-04 08:12:35,946 - INFO - Avg. fwd time: 16.6957 / Avg. bwd time: 25.4414 / Avg. batch time: 352.7033 (ms) / GPU bubble ratio: 4.42%
[rank0]:2025-11-04 08:12:35,993 - INFO - Avg. fwd time: 14.4446 / Avg. bwd time: 19.1503 / Avg. batch time: 502.6322 (ms) / GPU bubble ratio: 46.53%
[rank2]:2025-11-04 08:12:36,128 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0407  memory: 39.30GiB(28.11%)  tps: 8,595  tflops: 400.89  mfu: 40.53%
[rank3]:2025-11-04 08:12:36,120 - INFO -  step: 2300  loss:  0.1977  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,596  tflops: 400.90  mfu: 40.54%
[rank0]:2025-11-04 08:12:36,134 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0407  memory: 56.91GiB(40.70%)  tps: 8,596  tflops: 400.91  mfu: 40.54%
[rank1]:2025-11-04 08:12:36,119 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0407  memory: 48.98GiB(35.03%)  tps: 8,596  tflops: 400.90  mfu: 40.54%
[rank1]:2025-11-04 08:12:36,183 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0812_stage1_step2300.svg
[rank2]:2025-11-04 08:12:36,182 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0812_stage2_step2300.svg
[rank0]:2025-11-04 08:12:36,184 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0812_stage0_step2300.svg
[rank3]:2025-11-04 08:12:36,267 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0812_real_step2300_rank3.svg
[rank3]:> Batch Time: 460.25 ms, GPU Bubble Ratio: 50.90%, 35.31%, 38.59%, 34.78%
[rank3]:2025-11-04 08:12:36,309 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0812_stage3_step2300.svg
[rank0]:2025-11-04 08:14:09,395 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:14:11,154 - INFO - Avg. fwd time: 16.8475 / Avg. bwd time: 24.7744 / Avg. batch time: 452.3950 (ms) / GPU bubble ratio: 26.40%
[rank2]:2025-11-04 08:14:11,147 - INFO - Avg. fwd time: 14.7763 / Avg. bwd time: 23.8400 / Avg. batch time: 400.4751 (ms) / GPU bubble ratio: 22.86%
[rank3]:2025-11-04 08:14:11,130 - INFO - Avg. fwd time: 16.7017 / Avg. bwd time: 25.3320 / Avg. batch time: 351.8733 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-11-04 08:14:11,178 - INFO - Avg. fwd time: 14.4485 / Avg. bwd time: 19.0224 / Avg. batch time: 501.6912 (ms) / GPU bubble ratio: 46.63%
[rank2]:2025-11-04 08:14:11,308 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0312  memory: 39.30GiB(28.11%)  tps: 8,607  tflops: 401.43  mfu: 40.59%
[rank3]:2025-11-04 08:14:11,303 - INFO -  step: 2350  loss:  0.1841  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,607  tflops: 401.42  mfu: 40.59%
[rank0]:2025-11-04 08:14:11,317 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0312  memory: 56.91GiB(40.70%)  tps: 8,607  tflops: 401.41  mfu: 40.59%
[rank1]:2025-11-04 08:14:11,301 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,607  tflops: 401.41  mfu: 40.59%
[rank0]:2025-11-04 08:15:44,020 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:15:45,854 - INFO - Avg. fwd time: 16.7075 / Avg. bwd time: 25.2215 / Avg. batch time: 351.0321 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-11-04 08:15:45,952 - INFO - Avg. fwd time: 16.8539 / Avg. bwd time: 24.6713 / Avg. batch time: 451.4718 (ms) / GPU bubble ratio: 26.42%
[rank2]:2025-11-04 08:15:45,903 - INFO - Avg. fwd time: 14.7815 / Avg. bwd time: 23.7640 / Avg. batch time: 399.6014 (ms) / GPU bubble ratio: 22.83%
[rank0]:2025-11-04 08:15:46,000 - INFO - Avg. fwd time: 14.4530 / Avg. bwd time: 18.9024 / Avg. batch time: 500.7393 (ms) / GPU bubble ratio: 46.71%
[rank0]:2025-11-04 08:15:46,021 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0374  memory: 56.91GiB(40.70%)  tps: 8,650  tflops: 403.44  mfu: 40.79%
[rank0]:2025-11-04 08:15:46,021 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-04 08:15:46,006 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0374  memory: 48.98GiB(35.03%)  tps: 8,650  tflops: 403.44  mfu: 40.79%
[rank1]:2025-11-04 08:15:46,006 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-04 08:15:46,007 - INFO -  step: 2400  loss:  0.1910  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,650  tflops: 403.45  mfu: 40.79%
[rank3]:2025-11-04 08:15:46,007 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 08:15:46,013 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0374  memory: 39.30GiB(28.11%)  tps: 8,650  tflops: 403.44  mfu: 40.79%
[rank2]:2025-11-04 08:15:46,013 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 08:16:02,707 - INFO - validate step: 2400  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,547
[rank0]:2025-11-04 08:16:02,708 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 08:16:02,715 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-04 08:16:02,743 - INFO - validate step: 2400  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,473
[rank1]:2025-11-04 08:16:02,744 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 08:16:02,774 - INFO - validate step: 2400  loss:  0.2395  memory: 47.72GiB(34.13%)  tps: 24,430
[rank3]:2025-11-04 08:16:02,775 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 08:16:02,758 - INFO - validate step: 2400  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,462
[rank2]:2025-11-04 08:16:02,758 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 08:16:14,747 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.99 seconds.
[rank3]:2025-11-04 08:16:15,952 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.18 seconds.
[rank1]:2025-11-04 08:16:16,455 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.71 seconds.
[rank0]:2025-11-04 08:16:20,236 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 08:16:20,241 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.53 seconds.
[rank1]:2025-11-04 08:16:20,299 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0816_stage1_step2400.svg
[rank2]:2025-11-04 08:16:20,300 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0816_stage2_step2400.svg
[rank0]:2025-11-04 08:16:20,366 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0816_stage0_step2400.svg
[rank3]:2025-11-04 08:16:20,494 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0816_real_step2400_rank3.svg
[rank3]:> Batch Time: 460.69 ms, GPU Bubble Ratio: 50.99%, 35.13%, 38.61%, 34.77%
[rank3]:2025-11-04 08:16:20,562 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0816_stage3_step2400.svg
[rank0]:2025-11-04 08:17:55,759 - INFO - [GC] Peforming periodical GC collection 2.37 seconds
[rank1]:2025-11-04 08:17:57,566 - INFO - Avg. fwd time: 16.8587 / Avg. bwd time: 24.5860 / Avg. batch time: 450.7195 (ms) / GPU bubble ratio: 26.44%
[rank2]:2025-11-04 08:17:57,558 - INFO - Avg. fwd time: 14.7850 / Avg. bwd time: 23.6981 / Avg. batch time: 398.8879 (ms) / GPU bubble ratio: 22.82%
[rank3]:2025-11-04 08:17:57,544 - INFO - Avg. fwd time: 16.7120 / Avg. bwd time: 25.1310 / Avg. batch time: 350.3408 (ms) / GPU bubble ratio: 4.45%
[rank0]:2025-11-04 08:17:57,589 - INFO - Avg. fwd time: 14.4566 / Avg. bwd time: 18.8015 / Avg. batch time: 499.9658 (ms) / GPU bubble ratio: 46.78%
[rank3]:2025-11-04 08:17:57,712 - INFO -  step: 2450  loss:  0.2350  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 7,127  tflops: 332.42  mfu: 33.61%
[rank0]:2025-11-04 08:17:57,731 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0336  memory: 56.91GiB(40.70%)  tps: 7,122  tflops: 332.17  mfu: 33.59%
[rank1]:2025-11-04 08:17:57,712 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0336  memory: 48.98GiB(35.03%)  tps: 7,125  tflops: 332.33  mfu: 33.60%
[rank2]:2025-11-04 08:17:57,717 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0336  memory: 39.30GiB(28.11%)  tps: 7,126  tflops: 332.36  mfu: 33.61%
[rank0]:2025-11-04 08:19:30,923 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:19:32,672 - INFO - Avg. fwd time: 16.8647 / Avg. bwd time: 24.4909 / Avg. batch time: 449.8933 (ms) / GPU bubble ratio: 26.46%
[rank2]:2025-11-04 08:19:32,665 - INFO - Avg. fwd time: 14.7897 / Avg. bwd time: 23.6220 / Avg. batch time: 398.1092 (ms) / GPU bubble ratio: 22.81%
[rank3]:2025-11-04 08:19:32,650 - INFO - Avg. fwd time: 16.7174 / Avg. bwd time: 25.0328 / Avg. batch time: 349.5949 (ms) / GPU bubble ratio: 4.46%
[rank0]:2025-11-04 08:19:32,695 - INFO - Avg. fwd time: 14.4592 / Avg. bwd time: 18.6907 / Avg. batch time: 499.1067 (ms) / GPU bubble ratio: 46.87%
[rank1]:2025-11-04 08:19:32,817 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0463  memory: 48.98GiB(35.03%)  tps: 8,614  tflops: 401.74  mfu: 40.62%
[rank2]:2025-11-04 08:19:32,822 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0463  memory: 39.30GiB(28.11%)  tps: 8,614  tflops: 401.74  mfu: 40.62%
[rank2]:2025-11-04 08:19:32,890 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0819_stage2_step2500.svg
[rank3]:2025-11-04 08:19:32,818 - INFO -  step: 2500  loss:  0.2153  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,614  tflops: 401.75  mfu: 40.62%
[rank0]:2025-11-04 08:19:32,839 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0463  memory: 56.91GiB(40.70%)  tps: 8,613  tflops: 401.73  mfu: 40.62%
[rank0]:2025-11-04 08:19:32,891 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0819_stage0_step2500.svg
[rank1]:2025-11-04 08:19:32,891 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0819_stage1_step2500.svg
[rank3]:2025-11-04 08:19:32,974 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0819_real_step2500_rank3.svg
[rank3]:> Batch Time: 457.81 ms, GPU Bubble Ratio: 50.98%, 34.79%, 38.80%, 34.99%
[rank3]:2025-11-04 08:19:33,018 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0819_stage3_step2500.svg
[rank0]:2025-11-04 08:21:07,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:21:09,352 - INFO - Avg. fwd time: 16.7271 / Avg. bwd time: 24.9385 / Avg. batch time: 348.9156 (ms) / GPU bubble ratio: 4.47%
[rank1]:2025-11-04 08:21:09,454 - INFO - Avg. fwd time: 16.8740 / Avg. bwd time: 24.4032 / Avg. batch time: 449.1696 (ms) / GPU bubble ratio: 26.48%
[rank2]:2025-11-04 08:21:09,402 - INFO - Avg. fwd time: 14.7971 / Avg. bwd time: 23.5557 / Avg. batch time: 397.4142 (ms) / GPU bubble ratio: 22.80%
[rank0]:2025-11-04 08:21:09,502 - INFO - Avg. fwd time: 14.4651 / Avg. bwd time: 18.5836 / Avg. batch time: 498.3574 (ms) / GPU bubble ratio: 46.95%
[rank1]:2025-11-04 08:21:09,509 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0679  memory: 48.98GiB(35.03%)  tps: 8,472  tflops: 395.15  mfu: 39.95%
[rank3]:2025-11-04 08:21:09,510 - INFO -  step: 2550  loss:  0.4617  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,472  tflops: 395.16  mfu: 39.96%
[rank2]:2025-11-04 08:21:09,515 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0679  memory: 39.30GiB(28.11%)  tps: 8,472  tflops: 395.15  mfu: 39.95%
[rank0]:2025-11-04 08:21:09,525 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0679  memory: 56.91GiB(40.70%)  tps: 8,473  tflops: 395.17  mfu: 39.96%
[rank0]:2025-11-04 08:22:44,900 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:22:46,666 - INFO - Avg. fwd time: 16.7367 / Avg. bwd time: 24.8661 / Avg. batch time: 348.4122 (ms) / GPU bubble ratio: 4.47%
[rank1]:2025-11-04 08:22:46,692 - INFO - Avg. fwd time: 16.8830 / Avg. bwd time: 24.3312 / Avg. batch time: 448.6202 (ms) / GPU bubble ratio: 26.50%
[rank2]:2025-11-04 08:22:46,684 - INFO - Avg. fwd time: 14.8043 / Avg. bwd time: 23.5000 / Avg. batch time: 396.8908 (ms) / GPU bubble ratio: 22.79%
[rank0]:2025-11-04 08:22:46,715 - INFO - Avg. fwd time: 14.4706 / Avg. bwd time: 18.4998 / Avg. batch time: 497.7870 (ms) / GPU bubble ratio: 47.01%
[rank1]:2025-11-04 08:22:46,836 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0727  memory: 48.98GiB(35.03%)  tps: 8,417  tflops: 392.57  mfu: 39.69%
[rank1]:2025-11-04 08:22:46,836 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-04 08:22:46,838 - INFO -  step: 2600  loss:  0.3995  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,417  tflops: 392.57  mfu: 39.69%
[rank3]:2025-11-04 08:22:46,838 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-04 08:22:46,845 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0727  memory: 39.30GiB(28.11%)  tps: 8,417  tflops: 392.56  mfu: 39.69%
[rank2]:2025-11-04 08:22:46,845 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 08:22:46,851 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0727  memory: 56.91GiB(40.70%)  tps: 8,417  tflops: 392.57  mfu: 39.69%
[rank0]:2025-11-04 08:22:46,851 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-04 08:23:03,345 - INFO - validate step: 2600  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,811
[rank3]:2025-11-04 08:23:03,375 - INFO - validate step: 2600  loss:  0.2420  memory: 47.72GiB(34.13%)  tps: 24,769
[rank2]:2025-11-04 08:23:03,363 - INFO - validate step: 2600  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,797
[rank0]:2025-11-04 08:23:03,313 - INFO - validate step: 2600  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,883
[rank1]:2025-11-04 08:23:03,426 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0823_stage1_step2600.svg
[rank2]:2025-11-04 08:23:03,426 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0823_stage2_step2600.svg
[rank0]:2025-11-04 08:23:03,429 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0823_stage0_step2600.svg
[rank3]:2025-11-04 08:23:03,510 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0823_real_step2600_rank3.svg
[rank3]:> Batch Time: 466.11 ms, GPU Bubble Ratio: 50.66%, 35.25%, 38.91%, 34.66%
[rank3]:2025-11-04 08:23:03,554 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0823_stage3_step2600.svg
[rank0]:2025-11-04 08:24:38,445 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 08:24:40,209 - INFO - Avg. fwd time: 16.8930 / Avg. bwd time: 24.2502 / Avg. batch time: 447.9691 (ms) / GPU bubble ratio: 26.52%
[rank2]:2025-11-04 08:24:40,204 - INFO - Avg. fwd time: 14.8128 / Avg. bwd time: 23.4351 / Avg. batch time: 396.2722 (ms) / GPU bubble ratio: 22.78%
[rank3]:2025-11-04 08:24:40,188 - INFO - Avg. fwd time: 16.7474 / Avg. bwd time: 24.7802 / Avg. batch time: 347.8092 (ms) / GPU bubble ratio: 4.48%
[rank0]:2025-11-04 08:24:40,235 - INFO - Avg. fwd time: 14.4769 / Avg. bwd time: 18.4014 / Avg. batch time: 497.1125 (ms) / GPU bubble ratio: 47.09%
[rank2]:2025-11-04 08:24:40,358 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0369  memory: 39.30GiB(28.11%)  tps: 8,446  tflops: 393.91  mfu: 39.83%
[rank3]:2025-11-04 08:24:40,353 - INFO -  step: 2650  loss:  0.3219  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,447  tflops: 393.99  mfu: 39.84%
[rank0]:2025-11-04 08:24:40,367 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0369  memory: 56.91GiB(40.70%)  tps: 8,441  tflops: 393.67  mfu: 39.81%
[rank1]:2025-11-04 08:24:40,351 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0369  memory: 48.98GiB(35.03%)  tps: 8,445  tflops: 393.87  mfu: 39.82%
[rank0]:2025-11-04 08:26:15,381 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:26:17,247 - INFO - Avg. fwd time: 16.7577 / Avg. bwd time: 24.7000 / Avg. batch time: 347.2480 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-11-04 08:26:17,299 - INFO - Avg. fwd time: 14.8208 / Avg. bwd time: 23.3728 / Avg. batch time: 395.6911 (ms) / GPU bubble ratio: 22.78%
[rank1]:2025-11-04 08:26:17,348 - INFO - Avg. fwd time: 16.9027 / Avg. bwd time: 24.1721 / Avg. batch time: 447.3550 (ms) / GPU bubble ratio: 26.55%
[rank1]:2025-11-04 08:26:17,404 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0514  memory: 48.98GiB(35.03%)  tps: 8,441  tflops: 393.68  mfu: 39.81%
[rank2]:2025-11-04 08:26:17,411 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0514  memory: 39.30GiB(28.11%)  tps: 8,441  tflops: 393.68  mfu: 39.81%
[rank0]:2025-11-04 08:26:17,397 - INFO - Avg. fwd time: 14.4826 / Avg. bwd time: 18.3068 / Avg. batch time: 496.4767 (ms) / GPU bubble ratio: 47.16%
[rank0]:2025-11-04 08:26:17,422 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0514  memory: 56.91GiB(40.70%)  tps: 8,441  tflops: 393.67  mfu: 39.80%
[rank0]:2025-11-04 08:26:17,475 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0826_stage0_step2700.svg
[rank3]:2025-11-04 08:26:17,405 - INFO -  step: 2700  loss:  0.3540  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,441  tflops: 393.69  mfu: 39.81%
[rank1]:2025-11-04 08:26:17,473 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0826_stage1_step2700.svg
[rank2]:2025-11-04 08:26:17,474 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0826_stage2_step2700.svg
[rank3]:2025-11-04 08:26:17,558 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0826_real_step2700_rank3.svg
[rank3]:> Batch Time: 463.94 ms, GPU Bubble Ratio: 51.39%, 35.18%, 38.18%, 34.45%
[rank3]:2025-11-04 08:26:17,602 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0826_stage3_step2700.svg
[rank0]:2025-11-04 08:27:52,181 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:27:53,949 - INFO - Avg. fwd time: 16.7661 / Avg. bwd time: 24.6288 / Avg. batch time: 346.7444 (ms) / GPU bubble ratio: 4.49%
[rank1]:2025-11-04 08:27:53,972 - INFO - Avg. fwd time: 16.9105 / Avg. bwd time: 24.1081 / Avg. batch time: 446.8163 (ms) / GPU bubble ratio: 26.56%
[rank2]:2025-11-04 08:27:53,964 - INFO - Avg. fwd time: 14.8271 / Avg. bwd time: 23.3224 / Avg. batch time: 395.1765 (ms) / GPU bubble ratio: 22.77%
[rank0]:2025-11-04 08:27:53,996 - INFO - Avg. fwd time: 14.4877 / Avg. bwd time: 18.2300 / Avg. batch time: 495.9194 (ms) / GPU bubble ratio: 47.22%
[rank2]:2025-11-04 08:27:54,126 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0385  memory: 39.30GiB(28.11%)  tps: 8,470  tflops: 395.05  mfu: 39.94%
[rank3]:2025-11-04 08:27:54,117 - INFO -  step: 2750  loss:  0.2950  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,471  tflops: 395.07  mfu: 39.95%
[rank0]:2025-11-04 08:27:54,130 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0385  memory: 56.91GiB(40.70%)  tps: 8,471  tflops: 395.09  mfu: 39.95%
[rank1]:2025-11-04 08:27:54,116 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0385  memory: 48.98GiB(35.03%)  tps: 8,471  tflops: 395.07  mfu: 39.95%
[rank0]:2025-11-04 08:29:29,396 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:29:31,190 - INFO - Avg. fwd time: 16.9196 / Avg. bwd time: 24.0350 / Avg. batch time: 446.2522 (ms) / GPU bubble ratio: 26.58%
[rank2]:2025-11-04 08:29:31,182 - INFO - Avg. fwd time: 14.8340 / Avg. bwd time: 23.2683 / Avg. batch time: 394.6485 (ms) / GPU bubble ratio: 22.76%
[rank3]:2025-11-04 08:29:31,162 - INFO - Avg. fwd time: 16.7756 / Avg. bwd time: 24.5561 / Avg. batch time: 346.2372 (ms) / GPU bubble ratio: 4.50%
[rank0]:2025-11-04 08:29:31,215 - INFO - Avg. fwd time: 14.4935 / Avg. bwd time: 18.1444 / Avg. batch time: 495.3335 (ms) / GPU bubble ratio: 47.29%
[rank3]:2025-11-04 08:29:31,335 - INFO -  step: 2800  loss:  0.2936  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,427  tflops: 393.02  mfu: 39.74%
[rank0]:2025-11-04 08:29:31,349 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0551  memory: 56.91GiB(40.70%)  tps: 8,426  tflops: 393.01  mfu: 39.74%
[rank3]:2025-11-04 08:29:31,335 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 08:29:31,349 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-04 08:29:31,334 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0551  memory: 48.98GiB(35.03%)  tps: 8,426  tflops: 393.01  mfu: 39.74%
[rank1]:2025-11-04 08:29:31,334 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-04 08:29:31,340 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0551  memory: 39.30GiB(28.11%)  tps: 8,427  tflops: 393.03  mfu: 39.74%
[rank2]:2025-11-04 08:29:31,340 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-04 08:29:48,232 - INFO - validate step: 2800  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,249
[rank3]:2025-11-04 08:29:48,245 - INFO - validate step: 2800  loss:  0.2406  memory: 47.72GiB(34.13%)  tps: 24,223
[rank0]:2025-11-04 08:29:48,181 - INFO - validate step: 2800  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,336
[rank1]:2025-11-04 08:29:48,217 - INFO - validate step: 2800  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,261
[rank1]:2025-11-04 08:29:48,307 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0829_stage1_step2800.svg
[rank2]:2025-11-04 08:29:48,297 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0829_stage2_step2800.svg
[rank0]:2025-11-04 08:29:48,300 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0829_stage0_step2800.svg
[rank3]:2025-11-04 08:29:48,384 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0829_real_step2800_rank3.svg
[rank3]:> Batch Time: 463.89 ms, GPU Bubble Ratio: 50.83%, 35.30%, 38.68%, 34.53%
[rank3]:2025-11-04 08:29:48,429 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0829_stage3_step2800.svg
[rank0]:2025-11-04 08:31:23,667 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 08:31:25,538 - INFO - Avg. fwd time: 16.7853 / Avg. bwd time: 24.4853 / Avg. batch time: 345.7471 (ms) / GPU bubble ratio: 4.51%
[rank2]:2025-11-04 08:31:25,590 - INFO - Avg. fwd time: 14.8414 / Avg. bwd time: 23.2158 / Avg. batch time: 394.1480 (ms) / GPU bubble ratio: 22.76%
[rank1]:2025-11-04 08:31:25,653 - INFO - Avg. fwd time: 16.9284 / Avg. bwd time: 23.9659 / Avg. batch time: 445.7288 (ms) / GPU bubble ratio: 26.60%
[rank2]:2025-11-04 08:31:25,718 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0536  memory: 39.30GiB(28.11%)  tps: 8,403  tflops: 391.93  mfu: 39.63%
[rank0]:2025-11-04 08:31:25,704 - INFO - Avg. fwd time: 14.4995 / Avg. bwd time: 18.0576 / Avg. batch time: 494.7937 (ms) / GPU bubble ratio: 47.36%
[rank0]:2025-11-04 08:31:25,731 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0536  memory: 56.91GiB(40.70%)  tps: 8,398  tflops: 391.67  mfu: 39.60%
[rank3]:2025-11-04 08:31:25,713 - INFO -  step: 2850  loss:  0.4083  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,405  tflops: 392.01  mfu: 39.64%
[rank1]:2025-11-04 08:31:25,711 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,403  tflops: 391.90  mfu: 39.63%
[rank0]:2025-11-04 08:33:00,866 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:33:02,617 - INFO - Avg. fwd time: 16.7928 / Avg. bwd time: 24.4252 / Avg. batch time: 345.3250 (ms) / GPU bubble ratio: 4.51%
[rank1]:2025-11-04 08:33:02,643 - INFO - Avg. fwd time: 16.9353 / Avg. bwd time: 23.9087 / Avg. batch time: 445.2708 (ms) / GPU bubble ratio: 26.62%
[rank2]:2025-11-04 08:33:02,637 - INFO - Avg. fwd time: 14.8467 / Avg. bwd time: 23.1725 / Avg. batch time: 393.7092 (ms) / GPU bubble ratio: 22.75%
[rank0]:2025-11-04 08:33:02,667 - INFO - Avg. fwd time: 14.5036 / Avg. bwd time: 17.9898 / Avg. batch time: 494.3188 (ms) / GPU bubble ratio: 47.41%
[rank1]:2025-11-04 08:33:02,780 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0421  memory: 48.98GiB(35.03%)  tps: 8,439  tflops: 393.62  mfu: 39.80%
[rank2]:2025-11-04 08:33:02,788 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0421  memory: 39.30GiB(28.11%)  tps: 8,439  tflops: 393.61  mfu: 39.80%
[rank3]:2025-11-04 08:33:02,780 - INFO -  step: 2900  loss:  0.3883  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,440  tflops: 393.62  mfu: 39.80%
[rank0]:2025-11-04 08:33:02,795 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0421  memory: 56.91GiB(40.70%)  tps: 8,440  tflops: 393.64  mfu: 39.80%
[rank1]:2025-11-04 08:33:02,850 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0833_stage1_step2900.svg
[rank2]:2025-11-04 08:33:02,849 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0833_stage2_step2900.svg
[rank3]:2025-11-04 08:33:02,933 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0833_real_step2900_rank3.svg
[rank3]:> Batch Time: 461.64 ms, GPU Bubble Ratio: 51.36%, 34.86%, 37.99%, 34.61%
[rank0]:2025-11-04 08:33:02,849 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0833_stage0_step2900.svg
[rank3]:2025-11-04 08:33:02,979 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0833_stage3_step2900.svg
[rank0]:2025-11-04 08:34:37,961 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 08:34:39,761 - INFO - Avg. fwd time: 16.9434 / Avg. bwd time: 23.8421 / Avg. batch time: 444.7533 (ms) / GPU bubble ratio: 26.64%
[rank2]:2025-11-04 08:34:39,755 - INFO - Avg. fwd time: 14.8528 / Avg. bwd time: 23.1254 / Avg. batch time: 393.2220 (ms) / GPU bubble ratio: 22.73%
[rank0]:2025-11-04 08:34:39,787 - INFO - Avg. fwd time: 14.5086 / Avg. bwd time: 17.9120 / Avg. batch time: 493.7802 (ms) / GPU bubble ratio: 47.47%
[rank3]:2025-11-04 08:34:39,737 - INFO - Avg. fwd time: 16.8018 / Avg. bwd time: 24.3570 / Avg. batch time: 344.8498 (ms) / GPU bubble ratio: 4.52%
[rank0]:2025-11-04 08:34:39,921 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1297  memory: 56.91GiB(40.70%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank3]:2025-11-04 08:34:39,908 - INFO -  step: 2950  loss:  0.4372  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank1]:2025-11-04 08:34:39,907 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1297  memory: 48.98GiB(35.03%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank2]:2025-11-04 08:34:39,914 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1297  memory: 39.30GiB(28.11%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank0]:2025-11-04 08:36:15,066 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 08:36:16,906 - INFO - Avg. fwd time: 16.8102 / Avg. bwd time: 24.2918 / Avg. batch time: 344.3951 (ms) / GPU bubble ratio: 4.52%
[rank2]:2025-11-04 08:36:16,959 - INFO - Avg. fwd time: 14.8592 / Avg. bwd time: 23.0763 / Avg. batch time: 392.7506 (ms) / GPU bubble ratio: 22.73%
[rank1]:2025-11-04 08:36:17,017 - INFO - Avg. fwd time: 16.9516 / Avg. bwd time: 23.7795 / Avg. batch time: 444.2623 (ms) / GPU bubble ratio: 26.65%
[rank1]:2025-11-04 08:36:17,072 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 48.98GiB(35.03%)  tps: 8,431  tflops: 393.22  mfu: 39.76%
[rank1]:2025-11-04 08:36:17,072 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 8,011  tflops: 373.62  mfu: 37.27%
[rank1]:2025-11-04 08:36:17,072 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-04 08:36:17,078 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0808  memory: 39.30GiB(28.11%)  tps: 8,431  tflops: 393.23  mfu: 39.76%
[rank2]:2025-11-04 08:36:17,078 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0808  tps: 8,011  tflops: 373.63  mfu: 37.27%
[rank2]:2025-11-04 08:36:17,078 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 08:36:17,066 - INFO - Avg. fwd time: 14.5132 / Avg. bwd time: 17.8392 / Avg. batch time: 493.2716 (ms) / GPU bubble ratio: 47.53%
[rank0]:2025-11-04 08:36:17,088 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0808  memory: 56.91GiB(40.70%)  tps: 8,431  tflops: 393.22  mfu: 39.76%
[rank3]:2025-11-04 08:36:17,075 - INFO -  step: 3000  loss:  0.3554  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,431  tflops: 393.23  mfu: 39.76%
[rank0]:2025-11-04 08:36:17,088 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0808  tps: 8,035  tflops: 374.73  mfu: 37.31%
[rank3]:2025-11-04 08:36:17,076 - INFO -  final step: 3000  loss:  0.3554  grad_norm:  0.0000  tps: 8,016  tflops: 373.88  mfu: 37.28%
[rank0]:2025-11-04 08:36:17,089 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-04 08:36:17,076 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 08:36:33,574 - INFO - validate step: 3000  loss: -1.0000  memory: 56.91GiB(40.70%)  tps: 24,847
[rank0]:2025-11-04 08:36:33,574 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 08:36:33,579 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-04 08:36:33,607 - INFO - validate step: 3000  loss: -1.0000  memory: 48.98GiB(35.03%)  tps: 24,773
[rank1]:2025-11-04 08:36:33,608 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 08:36:33,612 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-04 08:36:33,623 - INFO - validate step: 3000  loss: -1.0000  memory: 39.30GiB(28.11%)  tps: 24,758
[rank2]:2025-11-04 08:36:33,623 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 08:36:33,630 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-04 08:36:33,640 - INFO - validate step: 3000  loss:  0.2423  memory: 47.72GiB(34.13%)  tps: 24,729
[rank3]:2025-11-04 08:36:33,641 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 08:36:33,644 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 08:36:44,710 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-04 08:36:44,821 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank0/251104_0836_stage0_final3000.svg
[rank1]:2025-11-04 08:36:44,828 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank1/251104_0836_stage1_final3000.svg
[rank2]:2025-11-04 08:36:44,846 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank2/251104_0836_stage2_final3000.svg
[rank0]:2025-11-04 08:36:45,026 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251104_0836_rank0_stage0.svg
[rank0]:	> Counts Sum: 3479680, Total Sum: 5910080 (58.88%), Ratio(%) per element: [43.87, 44.96, 44.16, 44.31, 46.19, 46.14, 45.55, 45.7, 45.7, 45.94, 45.89, 45.94, 47.77, 47.92, 48.61, 47.82, 48.86, 49.4, 49.55, 49.06, 48.07, 50.24, 51.28, 50.59, 52.86, 52.76, 52.51, 54.24, 54.15, 54.05, 51.72, 56.22, 54.54, 55.38, 54.99, 57.85, 57.9, 57.11, 58.2, 59.33, 60.82, 60.67, 59.28, 59.48, 62.5, 62.3, 62.69, 62.54, 64.72, 63.53, 64.77, 65.51, 65.41, 67.49, 67.78, 67.58, 68.62, 69.91, 70.75, 69.66, 70.45, 71.64, 73.12, 73.91, 73.81, 74.06, 75.74, 75.69, 77.42, 78.21, 78.7, 80.18, 81.42]
[rank0]:2025-11-04 08:36:45,027 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 08:36:44,965 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0836_real_final3000_rank3.svg
[rank3]:> Batch Time: 465.19 ms, GPU Bubble Ratio: 51.06%, 35.33%, 38.72%, 34.74%
[rank1]:2025-11-04 08:36:45,070 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251104_0836_rank1_stage1.svg
[rank1]:	> Counts Sum: 1619440, Total Sum: 6557760 (24.70%), Ratio(%) per element: [24.5, 25.14, 24.35, 24.5, 24.35, 24.45, 25.24, 24.65, 24.7, 25.0, 24.8, 23.91, 24.16, 24.55, 25.04, 25.44, 24.65, 25.0, 24.3, 24.65, 24.8, 24.6, 24.85, 24.65, 24.85, 24.6, 25.34, 24.01, 24.6, 24.4, 24.8, 24.9, 24.5, 24.06, 24.65, 24.16, 24.8, 24.4, 24.95, 24.25, 24.8, 25.44, 24.65, 25.09, 24.25, 24.5, 24.9, 24.3, 24.35, 24.7, 24.3, 25.04, 25.29, 24.5, 24.55, 24.45, 24.2, 24.7, 24.65, 24.8, 24.85, 24.95, 25.29, 24.45, 24.11, 24.8, 24.7, 24.8, 25.14, 25.0, 24.65, 25.39, 25.0, 25.14, 25.09, 25.19, 25.04, 24.11, 24.5, 24.35, 24.35]
[rank1]:2025-11-04 08:36:45,070 - INFO - Destroying the purge thread.
[rank2]:2025-11-04 08:36:45,147 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251104_0836_rank2_stage2.svg
[rank2]:	> Counts Sum: 2032920, Total Sum: 5829120 (34.88%), Ratio(%) per element: [34.93, 34.58, 35.37, 34.68, 36.46, 34.88, 35.42, 36.31, 34.48, 35.07, 35.72, 35.27, 35.37, 35.22, 33.54, 35.32, 34.88, 35.57, 35.52, 34.53, 35.17, 34.63, 33.89, 35.57, 36.56, 34.23, 34.73, 35.22, 34.53, 35.37, 35.62, 34.33, 35.02, 34.83, 35.57, 35.77, 34.38, 35.96, 35.82, 34.78, 33.89, 34.48, 35.52, 34.43, 34.73, 33.74, 34.53, 33.15, 35.62, 34.93, 34.18, 34.63, 33.99, 34.18, 35.62, 32.6, 35.72, 35.12, 34.93, 33.69, 32.46, 34.88, 33.79, 35.67, 36.16, 36.06, 33.84, 34.43, 33.74, 34.73, 35.77, 34.38]
[rank2]:2025-11-04 08:36:45,147 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 08:36:45,172 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/pipeline_schedule/251104_0836_thry_final3000_rank3.svg
[rank3]:> Batch Time: 530.40 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-04 08:36:45,245 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/freeze_ratio_history/rank3/251104_0836_stage3_final3000.svg
[rank3]:2025-11-04 08:36:45,530 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200/frozen_params_histogram/251104_0836_rank3_stage3.svg
[rank3]:	> Counts Sum: 606880, Total Sum: 5262400 (11.53%), Ratio(%) per element: [11.21, 11.8, 11.21, 10.96, 11.16, 11.51, 11.51, 12.3, 11.41, 12.25, 12.05, 11.75, 11.56, 11.51, 11.21, 11.75, 11.36, 11.26, 11.26, 10.96, 11.36, 12.25, 11.01, 12.2, 11.41, 11.51, 11.26, 12.15, 11.06, 11.7, 11.85, 11.41, 12.0, 11.75, 11.01, 11.75, 11.41, 12.0, 11.61, 11.46, 11.7, 11.16, 11.85, 11.51, 11.31, 12.4, 11.46, 10.67, 11.06, 11.95, 10.91, 11.56, 12.15, 11.56, 10.86, 11.51, 11.56, 11.11, 11.7, 11.85, 11.16, 11.8, 11.85, 11.36, 11.11]
[rank3]:2025-11-04 08:36:45,531 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.04385
[rank3]:wandb:               final/avg_loss 0.35541
[rank3]:wandb:             final/avg_mfu(%) 37.27686
[rank3]:wandb:             final/avg_tflops 373.87845
[rank3]:wandb:    final/avg_throughput(tps) 8016.23409
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.35541
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.35541
[rank3]:wandb: loss_metrics/global_max_loss 0.35541
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_fullrand7_h200 at: https://wandb.ai/orangingq/torchtitan/runs/cpda05ep
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_fullrand7_h200/20251104-0648/wandb/run-20251104_064830-cpda05ep/logs
[rank0]:2025-11-04 08:36:47,027 - INFO - Training completed
[rank0]:2025-11-04 08:36:47,027 - INFO - Destroying the purge thread.
[rank1]:2025-11-04 08:36:47,266 - INFO - Process group destroyed
[rank2]:2025-11-04 08:36:47,269 - INFO - Process group destroyed
[rank0]:2025-11-04 08:36:47,288 - INFO - Process group destroyed
[rank3]:2025-11-04 08:36:47,481 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.14', 'layers.16', 'layers.8', 'layers.12', 'layers.11', 'layers.10', 'layers.13', 'layers.15'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.20', 'layers.23', 'layers.21', 'layers.18', 'layers.22', 'layers.17', 'layers.24'}
[rank3]:Stage 3: Modules to keep: {'layers.31', 'layers.26', 'output', 'layers.25', 'norm', 'layers.30', 'layers.29', 'layers.27', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_fullrand7_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_fullrand7_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_fullrand7_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_fullrand7_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_fullrand7_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_fullrand7_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_fullrand7_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_fullrand7_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.2', 'layers.6', 'layers.5', 'layers.0', 'layers.3', 'layers.4', 'layers.1', 'layers.7'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
