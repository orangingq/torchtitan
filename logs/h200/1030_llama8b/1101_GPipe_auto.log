
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 05:56:46 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 05:56:47.846000 665990 site-packages/torch/distributed/run.py:811] 
W1102 05:56:47.846000 665990 site-packages/torch/distributed/run.py:811] *****************************************
W1102 05:56:47.846000 665990 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 05:56:47.846000 665990 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-02 05:56:54,607 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 05:56:54,657 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 05:56:54,763 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 05:56:54,757 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 05:56:55,437 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 05:56:55,440 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 05:56:55,520 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 05:56:55,522 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 05:56:55,634 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 05:56:55,637 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 05:56:55,643 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-02 05:56:55,631 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 05:56:55,634 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 05:56:57,504 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 05:56:57,789 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-02 05:56:59,812 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-02 05:56:59,831 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 05:56:59,904 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 05:56:59,904 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-11-02 05:57:00,011 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-02 05:57:00,083 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 05:57:00,083 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-02 05:57:00,073 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 05:57:00,143 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank1]:2025-11-02 05:57:00,133 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 05:57:00,134 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-11-02 05:57:00,167 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 05:57:00,167 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-02 05:57:00,295 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 05:57:00,295 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-02 05:57:00,396 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 05:57:00,397 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 617xpgjr
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_auto_h200/20251102-0556/wandb/run-20251102_055700-617xpgjr
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_GPipe_auto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/617xpgjr
[rank3]:2025-11-02 05:57:01,729 - INFO - WandB logging enabled
[rank3]:2025-11-02 05:57:01,730 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 05:57:01,803 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 05:57:01,804 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-02 05:57:02,010 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 05:57:02,011 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 05:57:02,025 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 05:57:02,026 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 05:57:02,039 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 05:57:02,030 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_auto_h200
[rank0]:2025-11-02 05:57:02,030 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 05:57:02,030 - INFO - Preparing c4_validation dataset from allenai/c4
[rank0]:2025-11-02 05:57:05,605 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 05:57:05,605 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 05:57:14,156 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 05:57:14,156 - INFO - Finished loading the checkpoint in 8.55 seconds.
[rank0]:2025-11-02 05:57:14,156 - INFO - Training starts at step 1
[rank3]:2025-11-02 05:57:18,442 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 983  tflops: 45.86  mfu: 4.64%
[rank3]:2025-11-02 05:57:18,442 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 05:57:18,458 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 894  tflops: 41.72  mfu: 4.22%
[rank0]:2025-11-02 05:57:18,458 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 05:57:18,439 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 883  tflops: 41.17  mfu: 4.16%
[rank1]:2025-11-02 05:57:18,439 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 05:57:18,437 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 892  tflops: 41.58  mfu: 4.20%
[rank2]:2025-11-02 05:57:18,437 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 05:59:25,324 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 05:59:27,758 - INFO - Avg. fwd time: 14.4730 / Avg. bwd time: 42.5068 / Avg. batch time: 473.7577 (ms) / GPU bubble ratio: 3.78%
[rank0]:2025-11-02 05:59:27,887 - INFO - Avg. fwd time: 13.7951 / Avg. bwd time: 37.7803 / Avg. batch time: 643.1033 (ms) / GPU bubble ratio: 35.84%
[rank2]:2025-11-02 05:59:27,808 - INFO - Avg. fwd time: 13.0566 / Avg. bwd time: 36.1730 / Avg. batch time: 526.9106 (ms) / GPU bubble ratio: 25.26%
[rank1]:2025-11-02 05:59:27,855 - INFO - Avg. fwd time: 15.0643 / Avg. bwd time: 41.1561 / Avg. batch time: 587.6251 (ms) / GPU bubble ratio: 23.46%
[rank3]:2025-11-02 05:59:27,994 - INFO -  step: 50  loss: 12.7724  grad_norm: 7246.6392  memory: 73.38GiB(52.48%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank0]:2025-11-02 05:59:27,996 - INFO -  step: 50  loss: -4.0000  grad_norm: 7246.6392  memory: 66.72GiB(47.72%)  tps: 6,198  tflops: 289.05  mfu: 29.23%
[rank2]:2025-11-02 05:59:27,989 - INFO -  step: 50  loss: -4.0000  grad_norm: 7246.6392  memory: 57.29GiB(40.97%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank1]:2025-11-02 05:59:27,992 - INFO -  step: 50  loss: -4.0000  grad_norm: 7246.6392  memory: 64.32GiB(46.00%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank0]:2025-11-02 06:01:37,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 06:01:40,096 - INFO - Avg. fwd time: 13.0973 / Avg. bwd time: 36.3587 / Avg. batch time: 526.0758 (ms) / GPU bubble ratio: 24.79%
[rank3]:2025-11-02 06:01:40,047 - INFO - Avg. fwd time: 14.4807 / Avg. bwd time: 42.6061 / Avg. batch time: 473.1937 (ms) / GPU bubble ratio: 3.49%
[rank1]:2025-11-02 06:01:40,142 - INFO - Avg. fwd time: 15.0443 / Avg. bwd time: 41.2557 / Avg. batch time: 586.1829 (ms) / GPU bubble ratio: 23.16%
[rank0]:2025-11-02 06:01:40,176 - INFO - Avg. fwd time: 13.5591 / Avg. bwd time: 37.8621 / Avg. batch time: 641.1731 (ms) / GPU bubble ratio: 35.84%
[rank1]:2025-11-02 06:01:40,280 - INFO -  step: 100  loss: -4.0000  grad_norm: 72.2328  memory: 64.32GiB(46.00%)  tps: 6,193  tflops: 288.82  mfu: 29.20%
[rank1]:2025-11-02 06:01:40,280 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 06:01:40,278 - INFO -  step: 100  loss: -4.0000  grad_norm: 72.2328  memory: 57.29GiB(40.97%)  tps: 6,193  tflops: 288.82  mfu: 29.20%
[rank2]:2025-11-02 06:01:40,278 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:01:40,284 - INFO -  step: 100  loss: -4.0000  grad_norm: 72.2328  memory: 66.72GiB(47.72%)  tps: 6,193  tflops: 288.82  mfu: 29.20%
[rank0]:2025-11-02 06:01:40,285 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 06:01:40,282 - INFO -  step: 100  loss:  4.1768  grad_norm: 72.2328  memory: 73.38GiB(52.48%)  tps: 6,193  tflops: 288.82  mfu: 29.20%
[rank3]:2025-11-02 06:01:40,283 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:03:49,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:03:52,318 - INFO - Avg. fwd time: 14.4207 / Avg. bwd time: 42.6397 / Avg. batch time: 472.5429 (ms) / GPU bubble ratio: 3.40%
[rank1]:2025-11-02 06:03:52,407 - INFO - Avg. fwd time: 14.9947 / Avg. bwd time: 41.3074 / Avg. batch time: 585.2475 (ms) / GPU bubble ratio: 23.04%
[rank2]:2025-11-02 06:03:52,360 - INFO - Avg. fwd time: 13.0653 / Avg. bwd time: 36.4492 / Avg. batch time: 525.3361 (ms) / GPU bubble ratio: 24.60%
[rank3]:2025-11-02 06:03:52,483 - INFO -  step: 150  loss:  1.1594  grad_norm: 16.7735  memory: 73.38GiB(52.48%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank0]:2025-11-02 06:03:52,450 - INFO - Avg. fwd time: 13.4818 / Avg. bwd time: 37.8966 / Avg. batch time: 640.1000 (ms) / GPU bubble ratio: 35.79%
[rank0]:2025-11-02 06:03:52,486 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.7735  memory: 66.72GiB(47.72%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank1]:2025-11-02 06:03:52,482 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.7735  memory: 64.32GiB(46.00%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank2]:2025-11-02 06:03:52,479 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.7735  memory: 57.29GiB(40.97%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank0]:2025-11-02 06:06:01,966 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:06:04,387 - INFO - Avg. fwd time: 14.3826 / Avg. bwd time: 42.6598 / Avg. batch time: 472.2077 (ms) / GPU bubble ratio: 3.36%
[rank2]:2025-11-02 06:06:04,437 - INFO - Avg. fwd time: 13.0483 / Avg. bwd time: 36.4973 / Avg. batch time: 524.9613 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-11-02 06:06:04,516 - INFO - Avg. fwd time: 13.4525 / Avg. bwd time: 37.9076 / Avg. batch time: 639.5765 (ms) / GPU bubble ratio: 35.76%
[rank1]:2025-11-02 06:06:04,483 - INFO - Avg. fwd time: 14.9680 / Avg. bwd time: 41.3279 / Avg. batch time: 584.7789 (ms) / GPU bubble ratio: 22.98%
[rank0]:2025-11-02 06:06:04,625 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4985  memory: 66.72GiB(47.72%)  tps: 6,200  tflops: 289.15  mfu: 29.24%
[rank0]:2025-11-02 06:06:04,625 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 06:06:04,621 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4985  memory: 64.32GiB(46.00%)  tps: 6,200  tflops: 289.15  mfu: 29.24%
[rank1]:2025-11-02 06:06:04,621 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 06:06:04,618 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4985  memory: 57.29GiB(40.97%)  tps: 6,200  tflops: 289.15  mfu: 29.24%
[rank2]:2025-11-02 06:06:04,618 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 06:06:04,623 - INFO -  step: 200  loss:  0.3472  grad_norm:  0.4985  memory: 73.38GiB(52.48%)  tps: 6,200  tflops: 289.15  mfu: 29.24%
[rank3]:2025-11-02 06:06:04,623 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 06:06:21,591 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,137
[rank1]:2025-11-02 06:06:21,592 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:06:21,561 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,187
[rank0]:2025-11-02 06:06:21,562 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 06:06:21,603 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,116
[rank2]:2025-11-02 06:06:21,604 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 06:06:21,621 - INFO - validate step: 200  loss:  0.2308  memory: 73.38GiB(52.48%)  tps: 24,099
[rank3]:2025-11-02 06:06:21,622 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:08:31,327 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:08:33,745 - INFO - Avg. fwd time: 14.3720 / Avg. bwd time: 42.6791 / Avg. batch time: 472.1461 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-02 06:08:33,841 - INFO - Avg. fwd time: 14.9797 / Avg. bwd time: 41.3443 / Avg. batch time: 584.6679 (ms) / GPU bubble ratio: 22.93%
[rank2]:2025-11-02 06:08:33,795 - INFO - Avg. fwd time: 13.0543 / Avg. bwd time: 36.5294 / Avg. batch time: 524.8930 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-11-02 06:08:33,874 - INFO - Avg. fwd time: 13.4511 / Avg. bwd time: 37.9288 / Avg. batch time: 639.4584 (ms) / GPU bubble ratio: 35.72%
[rank2]:2025-11-02 06:08:33,975 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2482  memory: 57.29GiB(40.97%)  tps: 6,189  tflops: 288.64  mfu: 29.19%
[rank3]:2025-11-02 06:08:33,980 - INFO -  step: 250  loss:  0.2335  grad_norm:  0.2482  memory: 73.38GiB(52.48%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank0]:2025-11-02 06:08:33,982 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2482  memory: 66.72GiB(47.72%)  tps: 6,186  tflops: 288.53  mfu: 29.17%
[rank1]:2025-11-02 06:08:33,978 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2482  memory: 64.32GiB(46.00%)  tps: 6,188  tflops: 288.61  mfu: 29.18%
[rank0]:2025-11-02 06:10:43,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:10:46,181 - INFO - Avg. fwd time: 14.3658 / Avg. bwd time: 42.6883 / Avg. batch time: 472.0847 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-11-02 06:10:46,223 - INFO - Avg. fwd time: 13.0608 / Avg. bwd time: 36.5484 / Avg. batch time: 524.8322 (ms) / GPU bubble ratio: 24.38%
[rank0]:2025-11-02 06:10:46,314 - INFO - Avg. fwd time: 13.4464 / Avg. bwd time: 37.9464 / Avg. batch time: 639.3674 (ms) / GPU bubble ratio: 35.70%
[rank0]:2025-11-02 06:10:46,349 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 66.72GiB(47.72%)  tps: 6,189  tflops: 288.65  mfu: 29.19%
[rank0]:2025-11-02 06:10:46,349 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 06:10:46,270 - INFO - Avg. fwd time: 14.9873 / Avg. bwd time: 41.3593 / Avg. batch time: 584.5857 (ms) / GPU bubble ratio: 22.89%
[rank1]:2025-11-02 06:10:46,345 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 64.32GiB(46.00%)  tps: 6,189  tflops: 288.65  mfu: 29.19%
[rank1]:2025-11-02 06:10:46,345 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 06:10:46,343 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3184  memory: 57.29GiB(40.97%)  tps: 6,189  tflops: 288.65  mfu: 29.19%
[rank2]:2025-11-02 06:10:46,343 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 06:10:46,347 - INFO -  step: 300  loss:  0.2692  grad_norm:  0.3184  memory: 73.38GiB(52.48%)  tps: 6,189  tflops: 288.65  mfu: 29.19%
[rank3]:2025-11-02 06:10:46,348 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:12:56,356 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:12:58,800 - INFO - Avg. fwd time: 14.3727 / Avg. bwd time: 42.7020 / Avg. batch time: 472.2004 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-02 06:12:58,850 - INFO - Avg. fwd time: 13.0714 / Avg. bwd time: 36.5632 / Avg. batch time: 524.9506 (ms) / GPU bubble ratio: 24.36%
[rank0]:2025-11-02 06:12:58,930 - INFO - Avg. fwd time: 13.4445 / Avg. bwd time: 37.9621 / Avg. batch time: 639.4808 (ms) / GPU bubble ratio: 35.69%
[rank1]:2025-11-02 06:12:58,897 - INFO - Avg. fwd time: 14.9974 / Avg. bwd time: 41.3767 / Avg. batch time: 584.7035 (ms) / GPU bubble ratio: 22.87%
[rank3]:2025-11-02 06:12:59,035 - INFO -  step: 350  loss:  0.3343  grad_norm:  0.3598  memory: 73.38GiB(52.48%)  tps: 6,174  tflops: 287.95  mfu: 29.12%
[rank0]:2025-11-02 06:12:59,037 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 66.72GiB(47.72%)  tps: 6,174  tflops: 287.95  mfu: 29.12%
[rank1]:2025-11-02 06:12:59,033 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 64.32GiB(46.00%)  tps: 6,174  tflops: 287.95  mfu: 29.12%
[rank2]:2025-11-02 06:12:59,030 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3598  memory: 57.29GiB(40.97%)  tps: 6,174  tflops: 287.95  mfu: 29.12%
[rank0]:2025-11-02 06:15:08,928 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:15:11,381 - INFO - Avg. fwd time: 14.3795 / Avg. bwd time: 42.7146 / Avg. batch time: 472.3119 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 06:15:11,477 - INFO - Avg. fwd time: 15.0074 / Avg. bwd time: 41.3868 / Avg. batch time: 584.8123 (ms) / GPU bubble ratio: 22.86%
[rank2]:2025-11-02 06:15:11,430 - INFO - Avg. fwd time: 13.0825 / Avg. bwd time: 36.5751 / Avg. batch time: 525.0645 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-11-02 06:15:11,510 - INFO - Avg. fwd time: 13.4428 / Avg. bwd time: 37.9743 / Avg. batch time: 639.5847 (ms) / GPU bubble ratio: 35.69%
[rank3]:2025-11-02 06:15:11,616 - INFO -  step: 400  loss:  0.2755  grad_norm:  0.8213  memory: 73.38GiB(52.48%)  tps: 6,179  tflops: 288.19  mfu: 29.14%
[rank3]:2025-11-02 06:15:11,616 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 06:15:11,618 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8213  memory: 66.72GiB(47.72%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank0]:2025-11-02 06:15:11,618 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 06:15:11,614 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8213  memory: 64.32GiB(46.00%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank1]:2025-11-02 06:15:11,614 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 06:15:11,611 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.8213  memory: 57.29GiB(40.97%)  tps: 6,179  tflops: 288.18  mfu: 29.14%
[rank2]:2025-11-02 06:15:11,611 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 06:15:26,567 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,401
[rank0]:2025-11-02 06:15:26,568 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 06:15:26,637 - INFO - validate step: 400  loss:  0.2364  memory: 73.38GiB(52.48%)  tps: 27,270
[rank3]:2025-11-02 06:15:26,638 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 06:15:26,599 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,334
[rank1]:2025-11-02 06:15:26,600 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 06:15:26,618 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,294
[rank2]:2025-11-02 06:15:26,619 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 06:17:36,434 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:17:38,948 - INFO - Avg. fwd time: 14.3849 / Avg. bwd time: 42.7243 / Avg. batch time: 472.3985 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 06:17:38,991 - INFO - Avg. fwd time: 13.0874 / Avg. bwd time: 36.5852 / Avg. batch time: 525.1552 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-11-02 06:17:39,082 - INFO - Avg. fwd time: 13.4413 / Avg. bwd time: 37.9794 / Avg. batch time: 639.6605 (ms) / GPU bubble ratio: 35.69%
[rank1]:2025-11-02 06:17:39,038 - INFO - Avg. fwd time: 15.0112 / Avg. bwd time: 41.3890 / Avg. batch time: 584.8859 (ms) / GPU bubble ratio: 22.86%
[rank3]:2025-11-02 06:17:39,116 - INFO -  step: 450  loss:  0.3031  grad_norm:  0.3323  memory: 73.38GiB(52.48%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank2]:2025-11-02 06:17:39,111 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3323  memory: 57.29GiB(40.97%)  tps: 6,183  tflops: 288.38  mfu: 29.16%
[rank0]:2025-11-02 06:17:39,117 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3323  memory: 66.72GiB(47.72%)  tps: 6,180  tflops: 288.25  mfu: 29.15%
[rank1]:2025-11-02 06:17:39,114 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3323  memory: 64.32GiB(46.00%)  tps: 6,182  tflops: 288.33  mfu: 29.15%
[rank2]:2025-11-02 06:18:05,609 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank0]:2025-11-02 06:18:05,616 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2025-11-02 06:18:05,612 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-02 06:18:05,612 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank3]:2025-11-02 06:18:32,185 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 4.9902e-01
[rank2]:2025-11-02 06:18:32,181 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 5.9318e-01
[rank0]:2025-11-02 06:18:32,189 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.4444e+00
[rank1]:2025-11-02 06:18:32,185 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.4548e+00
[rank2]:2025-11-02 06:18:58,161 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.2757e+00
[rank1]:2025-11-02 06:18:58,171 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 4.7212e-01
[rank3]:2025-11-02 06:18:58,168 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.8446e+00
[rank0]:2025-11-02 06:18:58,175 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 8.9450e-01
[rank3]:2025-11-02 06:19:24,628 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.3901e+00
[rank2]:2025-11-02 06:19:24,625 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 2.6361e+00
[rank0]:2025-11-02 06:19:24,632 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.1800e+00
[rank1]:2025-11-02 06:19:24,628 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 2.8564e+00
[rank0]:2025-11-02 06:19:46,905 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:19:49,166 - INFO - Avg. fwd time: 14.3976 / Avg. bwd time: 42.6283 / Avg. batch time: 471.7086 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 06:19:49,208 - INFO - Avg. fwd time: 13.1044 / Avg. bwd time: 36.4314 / Avg. batch time: 524.2964 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-11-02 06:19:49,292 - INFO - Avg. fwd time: 13.4364 / Avg. bwd time: 37.9843 / Avg. batch time: 638.9511 (ms) / GPU bubble ratio: 35.62%
[rank1]:2025-11-02 06:19:49,252 - INFO - Avg. fwd time: 15.0123 / Avg. bwd time: 41.3112 / Avg. batch time: 584.1334 (ms) / GPU bubble ratio: 22.86%
[rank2]:2025-11-02 06:19:49,388 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.0885e+00
[rank2]:2025-11-02 06:19:49,388 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2710  memory: 59.22GiB(42.36%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank0]:2025-11-02 06:19:49,401 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 1.1041e+00
[rank0]:2025-11-02 06:19:49,402 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2710  memory: 66.72GiB(47.72%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank1]:2025-11-02 06:19:49,388 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.1813e+00
[rank1]:2025-11-02 06:19:49,388 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2710  memory: 67.21GiB(48.07%)  tps: 6,288  tflops: 293.29  mfu: 29.65%
[rank3]:2025-11-02 06:19:49,391 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.1431e+00
[rank3]:2025-11-02 06:19:49,394 - INFO -  step: 500  loss:  0.2944  grad_norm:  0.2710  memory: 75.33GiB(53.88%)  tps: 6,288  tflops: 293.28  mfu: 29.65%
[rank2]:2025-11-02 06:19:49,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0619_stage2_step500.svg
[rank0]:2025-11-02 06:19:49,485 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0619_stage0_step500.svg
[rank1]:2025-11-02 06:19:49,486 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0619_stage1_step500.svg
[rank3]:2025-11-02 06:19:49,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0619_real_step500_rank3.svg
[rank3]:> Batch Time: 617.10 ms, GPU Bubble Ratio: 33.09%, 27.85%, 36.29%, 26.68%
[rank3]:2025-11-02 06:19:49,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0619_stage3_step500.svg
[rank3]:2025-11-02 06:20:16,074 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.9895e-01
[rank0]:2025-11-02 06:20:16,078 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6079e-01
[rank2]:2025-11-02 06:20:16,071 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6353e-01
[rank1]:2025-11-02 06:20:16,074 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.9947e-01
[rank3]:2025-11-02 06:20:40,593 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.1253e+00
[rank0]:2025-11-02 06:20:40,603 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7641e+00
[rank2]:2025-11-02 06:20:40,583 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 2.5927e+00
[rank1]:2025-11-02 06:20:40,590 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4515e+00
[rank3]:2025-11-02 06:21:07,029 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.8346e+00
[rank0]:2025-11-02 06:21:07,033 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.2755e+00
[rank2]:2025-11-02 06:21:07,025 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8580e+00
[rank1]:2025-11-02 06:21:07,029 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1380e+00
[rank3]:2025-11-02 06:21:30,933 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3743e+00
[rank0]:2025-11-02 06:21:30,940 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.0276e+00
[rank2]:2025-11-02 06:21:30,923 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 1.6555e+00
[rank1]:2025-11-02 06:21:30,927 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.0485e-01
[rank0]:2025-11-02 06:21:54,717 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:21:57,128 - INFO - Avg. fwd time: 14.4231 / Avg. bwd time: 42.4067 / Avg. batch time: 470.1172 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 06:21:57,177 - INFO - Avg. fwd time: 13.1458 / Avg. bwd time: 36.0213 / Avg. batch time: 522.3345 (ms) / GPU bubble ratio: 24.70%
[rank0]:2025-11-02 06:21:57,257 - INFO - Avg. fwd time: 13.4387 / Avg. bwd time: 37.9470 / Avg. batch time: 636.6271 (ms) / GPU bubble ratio: 35.43%
[rank1]:2025-11-02 06:21:57,224 - INFO - Avg. fwd time: 15.0459 / Avg. bwd time: 40.9054 / Avg. batch time: 581.7117 (ms) / GPU bubble ratio: 23.05%
[rank3]:2025-11-02 06:21:57,365 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.2001e-01
[rank3]:2025-11-02 06:21:57,368 - INFO -  step: 550  loss:  0.1726  grad_norm:  0.2144  memory: 75.33GiB(53.88%)  tps: 6,401  tflops: 298.56  mfu: 30.19%
[rank0]:2025-11-02 06:21:57,369 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.8327e-01
[rank0]:2025-11-02 06:21:57,370 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2144  memory: 67.62GiB(48.36%)  tps: 6,402  tflops: 298.57  mfu: 30.19%
[rank2]:2025-11-02 06:21:57,362 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1084e-01
[rank2]:2025-11-02 06:21:57,363 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2144  memory: 61.15GiB(43.74%)  tps: 6,401  tflops: 298.56  mfu: 30.19%
[rank1]:2025-11-02 06:21:57,366 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.7983e-01
[rank1]:2025-11-02 06:21:57,366 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2144  memory: 68.17GiB(48.76%)  tps: 6,401  tflops: 298.55  mfu: 30.19%
[rank2]:2025-11-02 06:22:21,433 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4502e+01
[rank1]:2025-11-02 06:22:21,436 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.0678e+00
[rank3]:2025-11-02 06:22:21,443 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.0769e+01
[rank0]:2025-11-02 06:22:21,450 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.4644e+01
[rank3]:2025-11-02 06:22:45,294 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.5608e-01
[rank0]:2025-11-02 06:22:45,301 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.2108e+00
[rank2]:2025-11-02 06:22:45,285 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.3377e+00
[rank1]:2025-11-02 06:22:45,282 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5194e+00
[rank0]:2025-11-02 06:23:09,457 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.4183e+00
[rank2]:2025-11-02 06:23:09,438 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1455e-01
[rank1]:2025-11-02 06:23:09,444 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.6915e-01
[rank3]:2025-11-02 06:23:09,450 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 2.0649e+00
[rank1]:2025-11-02 06:23:32,992 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4542e+00
[rank3]:2025-11-02 06:23:33,001 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.6150e+00
[rank0]:2025-11-02 06:23:33,012 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.5293e+00
[rank2]:2025-11-02 06:23:32,995 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.4173e+00
[rank0]:2025-11-02 06:23:54,905 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:23:57,248 - INFO - Avg. fwd time: 14.4834 / Avg. bwd time: 41.9857 / Avg. batch time: 467.2193 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-11-02 06:23:57,278 - INFO - Avg. fwd time: 13.2543 / Avg. bwd time: 35.1283 / Avg. batch time: 518.5230 (ms) / GPU bubble ratio: 25.35%
[rank0]:2025-11-02 06:23:57,357 - INFO - Avg. fwd time: 13.4794 / Avg. bwd time: 37.7630 / Avg. batch time: 631.6675 (ms) / GPU bubble ratio: 35.10%
[rank0]:2025-11-02 06:23:57,395 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.4978e+00
[rank0]:2025-11-02 06:23:57,395 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6065  memory: 67.62GiB(48.36%)  tps: 6,825  tflops: 318.33  mfu: 32.19%
[rank0]:2025-11-02 06:23:57,395 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 06:23:57,315 - INFO - Avg. fwd time: 15.1684 / Avg. bwd time: 39.9038 / Avg. batch time: 576.8544 (ms) / GPU bubble ratio: 23.62%
[rank1]:2025-11-02 06:23:57,381 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9483e+00
[rank1]:2025-11-02 06:23:57,382 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6065  memory: 70.12GiB(50.15%)  tps: 6,826  tflops: 318.36  mfu: 32.19%
[rank1]:2025-11-02 06:23:57,382 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 06:23:57,375 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0546e+00
[rank2]:2025-11-02 06:23:57,375 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6065  memory: 62.11GiB(44.42%)  tps: 6,826  tflops: 318.36  mfu: 32.19%
[rank2]:2025-11-02 06:23:57,375 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 06:23:57,388 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.8049e+00
[rank3]:2025-11-02 06:23:57,390 - INFO -  step: 600  loss:  0.4703  grad_norm:  0.6065  memory: 76.44GiB(54.68%)  tps: 6,825  tflops: 318.34  mfu: 32.19%
[rank3]:2025-11-02 06:23:57,390 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 06:24:13,364 - INFO - validate step: 600  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,629
[rank0]:2025-11-02 06:24:13,332 - INFO - validate step: 600  loss: -1.0000  memory: 67.62GiB(48.36%)  tps: 25,703
[rank2]:2025-11-02 06:24:13,378 - INFO - validate step: 600  loss: -1.0000  memory: 62.11GiB(44.42%)  tps: 25,596
[rank3]:2025-11-02 06:24:13,388 - INFO - validate step: 600  loss:  0.2515  memory: 76.44GiB(54.68%)  tps: 25,605
[rank0]:2025-11-02 06:24:13,462 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0624_stage0_step600.svg
[rank1]:2025-11-02 06:24:13,463 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0624_stage1_step600.svg
[rank2]:2025-11-02 06:24:13,463 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0624_stage2_step600.svg
[rank3]:2025-11-02 06:24:13,567 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0624_real_step600_rank3.svg
[rank3]:> Batch Time: 574.71 ms, GPU Bubble Ratio: 30.39%, 33.71%, 46.27%, 25.67%
[rank3]:2025-11-02 06:24:13,630 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0624_stage3_step600.svg
[rank0]:2025-11-02 06:24:37,339 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.1621e+00
[rank2]:2025-11-02 06:24:37,323 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4642e+00
[rank1]:2025-11-02 06:24:37,319 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4663e+00
[rank3]:2025-11-02 06:24:37,329 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.9161e+00
[rank1]:2025-11-02 06:25:01,654 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.7455e-01
[rank2]:2025-11-02 06:25:01,644 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3629e+00
[rank3]:2025-11-02 06:25:01,661 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0014e+00
[rank0]:2025-11-02 06:25:01,667 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.6371e+00
[rank3]:2025-11-02 06:25:25,513 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.8069e+00
[rank0]:2025-11-02 06:25:25,523 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 9.8498e-01
[rank2]:2025-11-02 06:25:25,506 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2467e+00
[rank1]:2025-11-02 06:25:25,503 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0145e+00
[rank2]:2025-11-02 06:25:49,286 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.0541e+00
[rank1]:2025-11-02 06:25:49,296 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.1789e-01
[rank3]:2025-11-02 06:25:49,302 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.7489e+00
[rank0]:2025-11-02 06:25:49,303 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.6627e-01
[rank0]:2025-11-02 06:26:10,563 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:26:12,721 - INFO - Avg. fwd time: 14.5527 / Avg. bwd time: 41.6136 / Avg. batch time: 464.7885 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-02 06:26:12,782 - INFO - Avg. fwd time: 15.2798 / Avg. bwd time: 39.0824 / Avg. batch time: 572.8472 (ms) / GPU bubble ratio: 24.08%
[rank2]:2025-11-02 06:26:12,754 - INFO - Avg. fwd time: 13.3572 / Avg. bwd time: 34.3598 / Avg. batch time: 515.3633 (ms) / GPU bubble ratio: 25.93%
[rank0]:2025-11-02 06:26:12,831 - INFO - Avg. fwd time: 13.5293 / Avg. bwd time: 37.5482 / Avg. batch time: 627.6046 (ms) / GPU bubble ratio: 34.89%
[rank1]:2025-11-02 06:26:12,915 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.8960e-01
[rank1]:2025-11-02 06:26:12,916 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3863  memory: 70.12GiB(50.15%)  tps: 6,852  tflops: 319.59  mfu: 32.31%
[rank2]:2025-11-02 06:26:12,918 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6823e-01
[rank2]:2025-11-02 06:26:12,919 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3863  memory: 63.09GiB(45.12%)  tps: 6,853  tflops: 319.62  mfu: 32.32%
[rank3]:2025-11-02 06:26:12,925 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.7349e-01
[rank3]:2025-11-02 06:26:12,928 - INFO -  step: 650  loss:  0.2931  grad_norm:  0.3863  memory: 76.44GiB(54.68%)  tps: 6,853  tflops: 319.63  mfu: 32.32%
[rank0]:2025-11-02 06:26:12,935 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1216e+00
[rank0]:2025-11-02 06:26:12,935 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3863  memory: 69.57GiB(49.76%)  tps: 6,849  tflops: 319.45  mfu: 32.30%
[rank3]:2025-11-02 06:26:36,784 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 3.1813e+00
[rank1]:2025-11-02 06:26:36,777 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.5959e-01
[rank0]:2025-11-02 06:26:36,784 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 8.7690e-01
[rank2]:2025-11-02 06:26:36,768 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8027e+00
[rank3]:2025-11-02 06:27:00,493 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.1729e+00
[rank0]:2025-11-02 06:27:00,503 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0212e-01
[rank2]:2025-11-02 06:27:00,486 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8667e-01
[rank1]:2025-11-02 06:27:00,483 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.3765e-01
[rank3]:2025-11-02 06:27:24,539 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 9.4767e-01
[rank1]:2025-11-02 06:27:24,533 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.6325e-01
[rank2]:2025-11-02 06:27:24,523 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 9.2725e-01
[rank0]:2025-11-02 06:27:24,540 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.8697e+00
[rank0]:2025-11-02 06:27:48,184 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.6162e-01
[rank1]:2025-11-02 06:27:48,164 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4162e-01
[rank2]:2025-11-02 06:27:48,167 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9484e-01
[rank3]:2025-11-02 06:27:48,174 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.4041e+00
[rank0]:2025-11-02 06:28:09,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:28:11,968 - INFO - Avg. fwd time: 14.6157 / Avg. bwd time: 41.2508 / Avg. batch time: 462.3798 (ms) / GPU bubble ratio: 3.34%
[rank2]:2025-11-02 06:28:11,988 - INFO - Avg. fwd time: 13.4609 / Avg. bwd time: 33.5551 / Avg. batch time: 512.1356 (ms) / GPU bubble ratio: 26.56%
[rank1]:2025-11-02 06:28:12,040 - INFO - Avg. fwd time: 15.3836 / Avg. bwd time: 38.2875 / Avg. batch time: 568.7962 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-11-02 06:28:12,055 - INFO - Avg. fwd time: 13.5840 / Avg. bwd time: 37.2099 / Avg. batch time: 623.3587 (ms) / GPU bubble ratio: 34.81%
[rank3]:2025-11-02 06:28:12,166 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.9349e-01
[rank3]:2025-11-02 06:28:12,170 - INFO -  step: 700  loss:  0.3850  grad_norm:  0.3484  memory: 76.44GiB(54.68%)  tps: 6,870  tflops: 320.43  mfu: 32.40%
[rank1]:2025-11-02 06:28:12,160 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3668e+00
[rank1]:2025-11-02 06:28:12,160 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3484  memory: 70.12GiB(50.15%)  tps: 6,870  tflops: 320.41  mfu: 32.40%
[rank0]:2025-11-02 06:28:12,166 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 8.0945e-01
[rank0]:2025-11-02 06:28:12,167 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3484  memory: 69.57GiB(49.76%)  tps: 6,871  tflops: 320.45  mfu: 32.40%
[rank2]:2025-11-02 06:28:12,150 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.7870e-01
[rank2]:2025-11-02 06:28:12,150 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3484  memory: 63.09GiB(45.12%)  tps: 6,871  tflops: 320.45  mfu: 32.40%
[rank1]:2025-11-02 06:28:12,247 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0628_stage1_step700.svg
[rank0]:2025-11-02 06:28:12,247 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0628_stage0_step700.svg
[rank2]:2025-11-02 06:28:12,247 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0628_stage2_step700.svg
[rank3]:2025-11-02 06:28:12,351 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0628_real_step700_rank3.svg
[rank3]:> Batch Time: 564.39 ms, GPU Bubble Ratio: 36.19%, 33.06%, 48.58%, 24.68%
[rank3]:2025-11-02 06:28:12,418 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0628_stage3_step700.svg
[rank3]:2025-11-02 06:28:36,050 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.2909e+00
[rank0]:2025-11-02 06:28:36,063 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.5200e-01
[rank1]:2025-11-02 06:28:36,044 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2297e-01
[rank2]:2025-11-02 06:28:36,047 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.8099e-01
[rank3]:2025-11-02 06:28:59,823 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4733e+00
[rank1]:2025-11-02 06:28:59,817 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9823e-01
[rank0]:2025-11-02 06:28:59,824 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.5213e+00
[rank2]:2025-11-02 06:28:59,807 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4747e+00
[rank3]:2025-11-02 06:29:23,298 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.5407e+00
[rank1]:2025-11-02 06:29:23,291 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.4732e-01
[rank0]:2025-11-02 06:29:23,311 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.6307e-01
[rank2]:2025-11-02 06:29:23,294 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0585e-01
[rank1]:2025-11-02 06:29:47,184 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2019e+00
[rank0]:2025-11-02 06:29:47,191 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.6958e+00
[rank2]:2025-11-02 06:29:47,174 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.5241e+00
[rank3]:2025-11-02 06:29:47,190 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.1489e+00
[rank0]:2025-11-02 06:30:08,269 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:30:10,486 - INFO - Avg. fwd time: 14.6793 / Avg. bwd time: 40.8129 / Avg. batch time: 459.3757 (ms) / GPU bubble ratio: 3.36%
[rank0]:2025-11-02 06:30:10,600 - INFO - Avg. fwd time: 13.6257 / Avg. bwd time: 36.9536 / Avg. batch time: 619.5629 (ms) / GPU bubble ratio: 34.69%
[rank1]:2025-11-02 06:30:10,553 - INFO - Avg. fwd time: 15.4730 / Avg. bwd time: 37.5695 / Avg. batch time: 564.4207 (ms) / GPU bubble ratio: 24.82%
[rank2]:2025-11-02 06:30:10,520 - INFO - Avg. fwd time: 13.5427 / Avg. bwd time: 32.8988 / Avg. batch time: 508.5045 (ms) / GPU bubble ratio: 26.94%
[rank3]:2025-11-02 06:30:10,624 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.9964e+00
[rank3]:2025-11-02 06:30:10,627 - INFO -  step: 750  loss:  0.1634  grad_norm:  0.2901  memory: 77.56GiB(55.47%)  tps: 6,916  tflops: 322.55  mfu: 32.61%
[rank0]:2025-11-02 06:30:10,638 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 9.7426e-01
[rank0]:2025-11-02 06:30:10,638 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2901  memory: 69.57GiB(49.76%)  tps: 6,915  tflops: 322.51  mfu: 32.61%
[rank1]:2025-11-02 06:30:10,618 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6276e+00
[rank1]:2025-11-02 06:30:10,618 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2901  memory: 70.12GiB(50.15%)  tps: 6,916  tflops: 322.54  mfu: 32.61%
[rank2]:2025-11-02 06:30:10,621 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8568e-01
[rank2]:2025-11-02 06:30:10,621 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2901  memory: 63.09GiB(45.12%)  tps: 6,915  tflops: 322.51  mfu: 32.61%
[rank3]:2025-11-02 06:30:34,311 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.1739e-01
[rank1]:2025-11-02 06:30:34,304 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.6167e-01
[rank0]:2025-11-02 06:30:34,311 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.5932e+00
[rank2]:2025-11-02 06:30:34,295 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7115e-01
[rank3]:2025-11-02 06:30:57,781 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.7250e+00
[rank0]:2025-11-02 06:30:57,794 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.4216e+00
[rank1]:2025-11-02 06:30:57,775 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1891e+00
[rank2]:2025-11-02 06:30:57,778 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4311e-01
[rank3]:2025-11-02 06:31:21,134 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.5806e+00
[rank1]:2025-11-02 06:31:21,128 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2326e+00
[rank0]:2025-11-02 06:31:21,135 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.7847e+00
[rank2]:2025-11-02 06:31:21,118 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.7750e+00
[rank3]:2025-11-02 06:31:44,367 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.6977e+00
[rank1]:2025-11-02 06:31:44,361 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.7907e+00
[rank0]:2025-11-02 06:31:44,380 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.7575e+00
[rank2]:2025-11-02 06:31:44,364 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9895e+00
[rank0]:2025-11-02 06:32:05,615 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:32:07,831 - INFO - Avg. fwd time: 14.7109 / Avg. bwd time: 40.5097 / Avg. batch time: 457.1928 (ms) / GPU bubble ratio: 3.37%
[rank1]:2025-11-02 06:32:07,903 - INFO - Avg. fwd time: 15.5251 / Avg. bwd time: 37.0616 / Avg. batch time: 561.1477 (ms) / GPU bubble ratio: 25.03%
[rank2]:2025-11-02 06:32:07,851 - INFO - Avg. fwd time: 13.6001 / Avg. bwd time: 32.3638 / Avg. batch time: 505.7665 (ms) / GPU bubble ratio: 27.30%
[rank0]:2025-11-02 06:32:07,918 - INFO - Avg. fwd time: 13.6521 / Avg. bwd time: 36.7189 / Avg. batch time: 616.5381 (ms) / GPU bubble ratio: 34.64%
[rank3]:2025-11-02 06:32:08,028 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.6569e+00
[rank3]:2025-11-02 06:32:08,030 - INFO -  step: 800  loss:  0.3183  grad_norm:  0.3031  memory: 77.56GiB(55.47%)  tps: 6,978  tflops: 325.44  mfu: 32.91%
[rank3]:2025-11-02 06:32:08,031 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 06:32:08,028 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.6861e+00
[rank0]:2025-11-02 06:32:08,029 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3031  memory: 69.57GiB(49.76%)  tps: 6,978  tflops: 325.48  mfu: 32.91%
[rank0]:2025-11-02 06:32:08,029 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 06:32:08,021 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7473e+00
[rank1]:2025-11-02 06:32:08,022 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3031  memory: 70.12GiB(50.15%)  tps: 6,978  tflops: 325.44  mfu: 32.91%
[rank1]:2025-11-02 06:32:08,022 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 06:32:08,012 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.6614e+00
[rank2]:2025-11-02 06:32:08,012 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.3031  memory: 63.09GiB(45.12%)  tps: 6,978  tflops: 325.47  mfu: 32.91%
[rank2]:2025-11-02 06:32:08,012 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 06:32:24,104 - INFO - validate step: 800  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,454
[rank0]:2025-11-02 06:32:24,057 - INFO - validate step: 800  loss: -1.0000  memory: 69.57GiB(49.76%)  tps: 25,555
[rank1]:2025-11-02 06:32:24,091 - INFO - validate step: 800  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,491
[rank3]:2025-11-02 06:32:24,115 - INFO - validate step: 800  loss:  0.2573  memory: 77.56GiB(55.47%)  tps: 25,468
[rank2]:2025-11-02 06:32:24,199 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0632_stage2_step800.svg
[rank0]:2025-11-02 06:32:24,198 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0632_stage0_step800.svg
[rank1]:2025-11-02 06:32:24,196 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0632_stage1_step800.svg
[rank3]:2025-11-02 06:32:24,300 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0632_real_step800_rank3.svg
[rank3]:> Batch Time: 543.86 ms, GPU Bubble Ratio: 27.70%, 37.89%, 40.72%, 29.22%
[rank3]:2025-11-02 06:32:24,370 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0632_stage3_step800.svg
[rank3]:2025-11-02 06:32:48,063 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.7215e-01
[rank1]:2025-11-02 06:32:48,056 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.5303e-01
[rank0]:2025-11-02 06:32:48,076 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.1688e+00
[rank2]:2025-11-02 06:32:48,059 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3812e-01
[rank3]:2025-11-02 06:33:11,989 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.1888e+00
[rank0]:2025-11-02 06:33:11,989 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.7765e+00
[rank2]:2025-11-02 06:33:11,972 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9554e-01
[rank1]:2025-11-02 06:33:11,982 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5373e+00
[rank3]:2025-11-02 06:33:35,453 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.1582e+00
[rank0]:2025-11-02 06:33:35,466 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.1545e+00
[rank2]:2025-11-02 06:33:35,449 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3506e+00
[rank1]:2025-11-02 06:33:35,446 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6014e+00
[rank3]:2025-11-02 06:33:58,766 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.0234e+00
[rank0]:2025-11-02 06:33:58,766 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 8.0339e+00
[rank2]:2025-11-02 06:33:58,749 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.1308e+00
[rank1]:2025-11-02 06:33:58,759 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.8946e+00
[rank0]:2025-11-02 06:34:19,554 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:34:21,669 - INFO - Avg. fwd time: 14.7541 / Avg. bwd time: 40.1779 / Avg. batch time: 454.8756 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-11-02 06:34:21,704 - INFO - Avg. fwd time: 13.6619 / Avg. bwd time: 31.8396 / Avg. batch time: 502.9471 (ms) / GPU bubble ratio: 27.62%
[rank1]:2025-11-02 06:34:21,731 - INFO - Avg. fwd time: 15.5880 / Avg. bwd time: 36.5133 / Avg. batch time: 557.7555 (ms) / GPU bubble ratio: 25.27%
[rank0]:2025-11-02 06:34:21,796 - INFO - Avg. fwd time: 13.6832 / Avg. bwd time: 36.5050 / Avg. batch time: 613.5281 (ms) / GPU bubble ratio: 34.56%
[rank3]:2025-11-02 06:34:21,886 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.1112e+00
[rank3]:2025-11-02 06:34:21,888 - INFO -  step: 850  loss:  0.1237  grad_norm:  0.2497  memory: 77.56GiB(55.47%)  tps: 6,956  tflops: 324.42  mfu: 32.80%
[rank2]:2025-11-02 06:34:21,882 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8044e+00
[rank2]:2025-11-02 06:34:21,883 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2497  memory: 63.09GiB(45.12%)  tps: 6,955  tflops: 324.40  mfu: 32.80%
[rank1]:2025-11-02 06:34:21,879 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6919e+00
[rank1]:2025-11-02 06:34:21,879 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2497  memory: 70.12GiB(50.15%)  tps: 6,955  tflops: 324.37  mfu: 32.80%
[rank0]:2025-11-02 06:34:21,899 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9859e+00
[rank0]:2025-11-02 06:34:21,899 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2497  memory: 69.57GiB(49.76%)  tps: 6,952  tflops: 324.23  mfu: 32.78%
[rank3]:2025-11-02 06:34:45,303 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.2613e+00
[rank2]:2025-11-02 06:34:45,287 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.6598e-01
[rank0]:2025-11-02 06:34:45,304 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.9568e+00
[rank1]:2025-11-02 06:34:45,297 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.4594e-01
[rank3]:2025-11-02 06:35:08,375 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.6852e+00
[rank0]:2025-11-02 06:35:08,388 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 8.8171e+00
[rank1]:2025-11-02 06:35:08,369 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.6753e+00
[rank2]:2025-11-02 06:35:08,372 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4240e+00
[rank3]:2025-11-02 06:35:31,627 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.3131e-01
[rank2]:2025-11-02 06:35:31,610 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.7330e+00
[rank1]:2025-11-02 06:35:31,620 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8479e+00
[rank0]:2025-11-02 06:35:31,627 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.6408e+00
[rank1]:2025-11-02 06:35:54,699 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.3080e+00
[rank2]:2025-11-02 06:35:54,703 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2010e+00
[rank3]:2025-11-02 06:35:54,706 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.5942e+00
[rank0]:2025-11-02 06:35:54,719 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 9.9535e-01
[rank0]:2025-11-02 06:36:15,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:36:18,125 - INFO - Avg. fwd time: 14.7746 / Avg. bwd time: 39.8990 / Avg. batch time: 452.7988 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-11-02 06:36:18,154 - INFO - Avg. fwd time: 13.7098 / Avg. bwd time: 31.3417 / Avg. batch time: 500.3482 (ms) / GPU bubble ratio: 27.97%
[rank1]:2025-11-02 06:36:18,192 - INFO - Avg. fwd time: 15.6301 / Avg. bwd time: 36.0524 / Avg. batch time: 554.6679 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-11-02 06:36:18,258 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7950e+00
[rank3]:2025-11-02 06:36:18,261 - INFO -  step: 900  loss:  0.2011  grad_norm:  0.2034  memory: 77.56GiB(55.47%)  tps: 7,040  tflops: 328.33  mfu: 33.20%
[rank0]:2025-11-02 06:36:18,229 - INFO - Avg. fwd time: 13.7037 / Avg. bwd time: 36.2816 / Avg. batch time: 610.6478 (ms) / GPU bubble ratio: 34.51%
[rank0]:2025-11-02 06:36:18,259 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.2005e+00
[rank0]:2025-11-02 06:36:18,259 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2034  memory: 69.57GiB(49.76%)  tps: 7,040  tflops: 328.36  mfu: 33.20%
[rank2]:2025-11-02 06:36:18,242 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6137e+00
[rank2]:2025-11-02 06:36:18,243 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2034  memory: 63.09GiB(45.12%)  tps: 7,040  tflops: 328.36  mfu: 33.20%
[rank1]:2025-11-02 06:36:18,252 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1243e+00
[rank1]:2025-11-02 06:36:18,252 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2034  memory: 70.12GiB(50.15%)  tps: 7,039  tflops: 328.32  mfu: 33.20%
[rank0]:2025-11-02 06:36:18,329 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0636_stage0_step900.svg
[rank2]:2025-11-02 06:36:18,334 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0636_stage2_step900.svg
[rank1]:2025-11-02 06:36:18,331 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0636_stage1_step900.svg
[rank3]:2025-11-02 06:36:18,438 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0636_real_step900_rank3.svg
[rank3]:> Batch Time: 561.15 ms, GPU Bubble Ratio: 36.12%, 32.75%, 48.62%, 24.64%
[rank3]:2025-11-02 06:36:18,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0636_stage3_step900.svg
[rank1]:2025-11-02 06:36:41,645 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.4563e+00
[rank3]:2025-11-02 06:36:41,651 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.6145e+00
[rank0]:2025-11-02 06:36:41,665 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.7792e+00
[rank2]:2025-11-02 06:36:41,648 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.7919e-01
[rank3]:2025-11-02 06:37:05,225 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 8.1362e-01
[rank0]:2025-11-02 06:37:05,225 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 7.2689e-01
[rank2]:2025-11-02 06:37:05,209 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.2050e-01
[rank1]:2025-11-02 06:37:05,218 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.3355e-01
[rank3]:2025-11-02 06:37:28,541 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2172e+00
[rank2]:2025-11-02 06:37:28,537 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0776e-01
[rank1]:2025-11-02 06:37:28,534 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.9616e+00
[rank0]:2025-11-02 06:37:28,554 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.2883e+00
[rank2]:2025-11-02 06:37:52,194 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.3323e+00
[rank1]:2025-11-02 06:37:52,204 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0101e+00
[rank3]:2025-11-02 06:37:52,210 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.7965e+00
[rank0]:2025-11-02 06:37:52,211 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.6397e+00
[rank0]:2025-11-02 06:38:13,264 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:38:15,401 - INFO - Avg. fwd time: 14.8020 / Avg. bwd time: 39.6617 / Avg. batch time: 451.1130 (ms) / GPU bubble ratio: 3.41%
[rank1]:2025-11-02 06:38:15,463 - INFO - Avg. fwd time: 15.6729 / Avg. bwd time: 35.6712 / Avg. batch time: 552.2534 (ms) / GPU bubble ratio: 25.62%
[rank2]:2025-11-02 06:38:15,435 - INFO - Avg. fwd time: 13.7483 / Avg. bwd time: 30.9937 / Avg. batch time: 498.3327 (ms) / GPU bubble ratio: 28.17%
[rank0]:2025-11-02 06:38:15,527 - INFO - Avg. fwd time: 13.7226 / Avg. bwd time: 36.1452 / Avg. batch time: 608.5554 (ms) / GPU bubble ratio: 34.44%
[rank1]:2025-11-02 06:38:15,611 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1822e+00
[rank1]:2025-11-02 06:38:15,611 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.5967  memory: 70.12GiB(50.15%)  tps: 6,980  tflops: 325.56  mfu: 32.92%
[rank2]:2025-11-02 06:38:15,614 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.4279e+00
[rank2]:2025-11-02 06:38:15,614 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.5967  memory: 63.09GiB(45.12%)  tps: 6,980  tflops: 325.53  mfu: 32.91%
[rank3]:2025-11-02 06:38:15,617 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.2975e+01
[rank3]:2025-11-02 06:38:15,621 - INFO -  step: 950  loss:  0.3004  grad_norm:  0.5967  memory: 77.56GiB(55.47%)  tps: 6,980  tflops: 325.56  mfu: 32.92%
[rank0]:2025-11-02 06:38:15,631 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.0326e+00
[rank0]:2025-11-02 06:38:15,631 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.5967  memory: 69.57GiB(49.76%)  tps: 6,980  tflops: 325.53  mfu: 32.91%
[rank2]:2025-11-02 06:38:38,022 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.2887e+00
[rank1]:2025-11-02 06:38:38,031 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.9130e+00
[rank0]:2025-11-02 06:38:38,038 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.9085e+00
[rank3]:2025-11-02 06:38:38,032 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.1330e+00
[rank3]:2025-11-02 06:39:01,612 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.8872e+00
[rank1]:2025-11-02 06:39:01,606 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7420e+00
[rank2]:2025-11-02 06:39:01,609 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3461e+00
[rank0]:2025-11-02 06:39:01,625 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5080e-01
[rank0]:2025-11-02 06:39:23,778 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.8581e+00
[rank2]:2025-11-02 06:39:23,762 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8249e+00
[rank1]:2025-11-02 06:39:23,772 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.1600e+00
[rank3]:2025-11-02 06:39:23,772 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.5453e+00
[rank2]:2025-11-02 06:39:46,884 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.1099e-01
[rank1]:2025-11-02 06:39:46,881 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.0480e+00
[rank0]:2025-11-02 06:39:46,901 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.5622e+00
[rank3]:2025-11-02 06:39:46,884 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.9558e+00
[rank0]:2025-11-02 06:40:06,846 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:40:08,871 - INFO - Avg. fwd time: 14.8507 / Avg. bwd time: 39.2681 / Avg. batch time: 448.3475 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-11-02 06:40:08,897 - INFO - Avg. fwd time: 13.7954 / Avg. bwd time: 30.6102 / Avg. batch time: 495.1721 (ms) / GPU bubble ratio: 28.26%
[rank1]:2025-11-02 06:40:08,943 - INFO - Avg. fwd time: 15.7188 / Avg. bwd time: 35.3036 / Avg. batch time: 548.7161 (ms) / GPU bubble ratio: 25.61%
[rank0]:2025-11-02 06:40:08,964 - INFO - Avg. fwd time: 13.7469 / Avg. bwd time: 35.9852 / Avg. batch time: 605.4165 (ms) / GPU bubble ratio: 34.28%
[rank3]:2025-11-02 06:40:09,057 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0557e+00
[rank3]:2025-11-02 06:40:09,060 - INFO -  step: 1000  loss:  0.1592  grad_norm:  0.6838  memory: 78.44GiB(56.10%)  tps: 7,222  tflops: 336.82  mfu: 34.06%
[rank3]:2025-11-02 06:40:09,060 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 06:40:09,056 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6441e+00
[rank1]:2025-11-02 06:40:09,057 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.6838  memory: 70.12GiB(50.15%)  tps: 7,221  tflops: 336.79  mfu: 34.05%
[rank1]:2025-11-02 06:40:09,057 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 06:40:09,064 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.3061e+00
[rank0]:2025-11-02 06:40:09,064 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.6838  memory: 69.57GiB(49.76%)  tps: 7,222  tflops: 336.83  mfu: 34.06%
[rank0]:2025-11-02 06:40:09,064 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 06:40:09,047 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.5430e+00
[rank2]:2025-11-02 06:40:09,047 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.6838  memory: 63.09GiB(45.12%)  tps: 7,222  tflops: 336.83  mfu: 34.06%
[rank2]:2025-11-02 06:40:09,047 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 06:40:25,038 - INFO - validate step: 1000  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,630
[rank0]:2025-11-02 06:40:25,004 - INFO - validate step: 1000  loss: -1.0000  memory: 69.57GiB(49.76%)  tps: 25,696
[rank3]:2025-11-02 06:40:25,069 - INFO - validate step: 1000  loss:  0.2594  memory: 78.44GiB(56.10%)  tps: 25,586
[rank2]:2025-11-02 06:40:25,052 - INFO - validate step: 1000  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,593
[rank0]:2025-11-02 06:40:25,140 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0640_stage0_step1000.svg
[rank2]:2025-11-02 06:40:25,143 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0640_stage2_step1000.svg
[rank1]:2025-11-02 06:40:25,143 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0640_stage1_step1000.svg
[rank3]:2025-11-02 06:40:25,247 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0640_real_step1000_rank3.svg
[rank3]:> Batch Time: 519.59 ms, GPU Bubble Ratio: 30.29%, 27.43%, 44.25%, 26.20%
[rank3]:2025-11-02 06:40:25,315 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0640_stage3_step1000.svg
[rank2]:2025-11-02 06:40:48,453 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4109e+00
[rank1]:2025-11-02 06:40:48,450 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.9151e+00
[rank3]:2025-11-02 06:40:48,454 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.8568e+00
[rank0]:2025-11-02 06:40:48,470 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.0092e+00
[rank3]:2025-11-02 06:41:10,309 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4977e+00
[rank0]:2025-11-02 06:41:10,315 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.1615e+00
[rank2]:2025-11-02 06:41:10,299 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.1378e+00
[rank1]:2025-11-02 06:41:10,308 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.8391e+00
[rank3]:2025-11-02 06:41:33,314 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.2568e+00
[rank0]:2025-11-02 06:41:33,331 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.8949e+00
[rank1]:2025-11-02 06:41:33,311 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.0116e+00
[rank2]:2025-11-02 06:41:33,314 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5631e+00
[rank3]:2025-11-02 06:41:55,248 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.9882e+00
[rank0]:2025-11-02 06:41:55,258 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.7102e+00
[rank1]:2025-11-02 06:41:55,251 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.0784e+00
[rank2]:2025-11-02 06:41:55,241 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.8439e+00
[rank0]:2025-11-02 06:42:16,475 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:42:18,705 - INFO - Avg. fwd time: 14.8950 / Avg. bwd time: 38.8343 / Avg. batch time: 445.2238 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-11-02 06:42:18,774 - INFO - Avg. fwd time: 15.7547 / Avg. bwd time: 34.9475 / Avg. batch time: 545.0253 (ms) / GPU bubble ratio: 25.58%
[rank2]:2025-11-02 06:42:18,740 - INFO - Avg. fwd time: 13.8292 / Avg. bwd time: 30.2916 / Avg. batch time: 491.7477 (ms) / GPU bubble ratio: 28.22%
[rank3]:2025-11-02 06:42:18,856 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0331e+00
[rank3]:2025-11-02 06:42:18,859 - INFO -  step: 1050  loss:  0.2627  grad_norm:  0.6127  memory: 78.44GiB(56.10%)  tps: 7,199  tflops: 335.78  mfu: 33.95%
[rank0]:2025-11-02 06:42:18,835 - INFO - Avg. fwd time: 13.7604 / Avg. bwd time: 35.8646 / Avg. batch time: 602.5438 (ms) / GPU bubble ratio: 34.11%
[rank0]:2025-11-02 06:42:18,872 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.3451e+01
[rank0]:2025-11-02 06:42:18,873 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.6127  memory: 69.57GiB(49.76%)  tps: 7,194  tflops: 335.54  mfu: 33.93%
[rank1]:2025-11-02 06:42:18,853 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.6846e+00
[rank1]:2025-11-02 06:42:18,853 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.6127  memory: 70.12GiB(50.15%)  tps: 7,198  tflops: 335.70  mfu: 33.94%
[rank2]:2025-11-02 06:42:18,856 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6491e+00
[rank2]:2025-11-02 06:42:18,856 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.6127  memory: 63.09GiB(45.12%)  tps: 7,198  tflops: 335.73  mfu: 33.95%
[rank2]:2025-11-02 06:42:41,248 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0712e+00
[rank3]:2025-11-02 06:42:41,252 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.6797e+00
[rank1]:2025-11-02 06:42:41,258 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2901e+00
[rank0]:2025-11-02 06:42:41,265 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.4314e+00
[rank3]:2025-11-02 06:43:04,779 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3085e+00
[rank2]:2025-11-02 06:43:04,779 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1553e+00
[rank0]:2025-11-02 06:43:04,796 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.8697e+00
[rank1]:2025-11-02 06:43:04,776 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.3631e+00
[rank3]:2025-11-02 06:43:27,054 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4226e+00
[rank0]:2025-11-02 06:43:27,067 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.0053e+00
[rank1]:2025-11-02 06:43:27,060 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.9530e+00
[rank2]:2025-11-02 06:43:27,050 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.6206e+00
[rank3]:2025-11-02 06:43:50,715 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.0692e-01
[rank1]:2025-11-02 06:43:50,711 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0852e+00
[rank0]:2025-11-02 06:43:50,731 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.0535e+00
[rank2]:2025-11-02 06:43:50,714 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3386e+00
[rank0]:2025-11-02 06:44:10,766 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:44:12,756 - INFO - Avg. fwd time: 14.9564 / Avg. bwd time: 38.4256 / Avg. batch time: 442.4436 (ms) / GPU bubble ratio: 3.48%
[rank2]:2025-11-02 06:44:12,796 - INFO - Avg. fwd time: 13.8720 / Avg. bwd time: 30.0230 / Avg. batch time: 488.6985 (ms) / GPU bubble ratio: 28.14%
[rank1]:2025-11-02 06:44:12,861 - INFO - Avg. fwd time: 15.7968 / Avg. bwd time: 34.7077 / Avg. batch time: 542.3656 (ms) / GPU bubble ratio: 25.50%
[rank0]:2025-11-02 06:44:12,884 - INFO - Avg. fwd time: 13.7869 / Avg. bwd time: 35.7504 / Avg. batch time: 600.2986 (ms) / GPU bubble ratio: 33.98%
[rank3]:2025-11-02 06:44:12,968 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.2346e+00
[rank3]:2025-11-02 06:44:12,970 - INFO -  step: 1100  loss:  0.2545  grad_norm:  0.2135  memory: 79.24GiB(56.67%)  tps: 7,179  tflops: 334.83  mfu: 33.86%
[rank1]:2025-11-02 06:44:12,974 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6575e+00
[rank1]:2025-11-02 06:44:12,974 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2135  memory: 70.12GiB(50.15%)  tps: 7,178  tflops: 334.80  mfu: 33.85%
[rank0]:2025-11-02 06:44:12,981 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.2992e+00
[rank0]:2025-11-02 06:44:12,981 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2135  memory: 69.57GiB(49.76%)  tps: 7,179  tflops: 334.84  mfu: 33.86%
[rank2]:2025-11-02 06:44:12,964 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.3149e+00
[rank2]:2025-11-02 06:44:12,964 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2135  memory: 63.09GiB(45.12%)  tps: 7,179  tflops: 334.84  mfu: 33.86%
[rank1]:2025-11-02 06:44:13,055 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0644_stage1_step1100.svg
[rank0]:2025-11-02 06:44:13,054 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0644_stage0_step1100.svg
[rank2]:2025-11-02 06:44:13,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0644_stage2_step1100.svg
[rank3]:2025-11-02 06:44:13,161 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0644_real_step1100_rank3.svg
[rank3]:> Batch Time: 544.17 ms, GPU Bubble Ratio: 27.20%, 36.61%, 39.99%, 32.14%
[rank3]:2025-11-02 06:44:13,223 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0644_stage3_step1100.svg
[rank1]:2025-11-02 06:44:36,638 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2304e+00
[rank2]:2025-11-02 06:44:36,641 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1241e+00
[rank3]:2025-11-02 06:44:36,641 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4363e+00
[rank0]:2025-11-02 06:44:36,657 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.2394e+00
[rank2]:2025-11-02 06:44:58,743 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6435e+00
[rank0]:2025-11-02 06:44:58,761 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.2491e-01
[rank1]:2025-11-02 06:44:58,753 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0095e+00
[rank3]:2025-11-02 06:44:58,747 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5391e+00
[rank2]:2025-11-02 06:45:22,081 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7676e+00
[rank1]:2025-11-02 06:45:22,078 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.0202e+00
[rank3]:2025-11-02 06:45:22,081 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4244e+00
[rank0]:2025-11-02 06:45:22,098 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 3.5392e+00
[rank3]:2025-11-02 06:45:43,907 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.5353e+00
[rank0]:2025-11-02 06:45:43,921 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.9209e+00
[rank1]:2025-11-02 06:45:43,914 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.2282e-01
[rank2]:2025-11-02 06:45:43,904 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.0621e-01
[rank0]:2025-11-02 06:46:04,788 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:46:06,899 - INFO - Avg. fwd time: 15.0069 / Avg. bwd time: 37.9861 / Avg. batch time: 439.3268 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-11-02 06:46:06,965 - INFO - Avg. fwd time: 15.8307 / Avg. bwd time: 34.4255 / Avg. batch time: 539.2825 (ms) / GPU bubble ratio: 25.45%
[rank2]:2025-11-02 06:46:06,937 - INFO - Avg. fwd time: 13.9043 / Avg. bwd time: 29.7498 / Avg. batch time: 485.3239 (ms) / GPU bubble ratio: 28.04%
[rank0]:2025-11-02 06:46:07,042 - INFO - Avg. fwd time: 13.8042 / Avg. bwd time: 35.6430 / Avg. batch time: 597.8277 (ms) / GPU bubble ratio: 33.83%
[rank3]:2025-11-02 06:46:07,127 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4938e+00
[rank3]:2025-11-02 06:46:07,130 - INFO -  step: 1150  loss:  0.2465  grad_norm:  0.5417  memory: 79.24GiB(56.67%)  tps: 7,176  tflops: 334.69  mfu: 33.84%
[rank1]:2025-11-02 06:46:07,124 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0850e+00
[rank1]:2025-11-02 06:46:07,124 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5417  memory: 70.12GiB(50.15%)  tps: 7,177  tflops: 334.71  mfu: 33.84%
[rank0]:2025-11-02 06:46:07,144 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.3290e+00
[rank0]:2025-11-02 06:46:07,144 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5417  memory: 69.57GiB(49.76%)  tps: 7,176  tflops: 334.68  mfu: 33.84%
[rank2]:2025-11-02 06:46:07,127 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7587e+00
[rank2]:2025-11-02 06:46:07,127 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5417  memory: 63.09GiB(45.12%)  tps: 7,176  tflops: 334.68  mfu: 33.84%
[rank1]:2025-11-02 06:46:29,134 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5423e+00
[rank2]:2025-11-02 06:46:29,124 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.1910e+00
[rank3]:2025-11-02 06:46:29,128 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8454e+00
[rank0]:2025-11-02 06:46:29,141 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.5705e+00
[rank1]:2025-11-02 06:46:52,441 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1472e+00
[rank2]:2025-11-02 06:46:52,444 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7365e+00
[rank3]:2025-11-02 06:46:52,445 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2589e+00
[rank0]:2025-11-02 06:46:52,461 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 4.6690e+00
[rank3]:2025-11-02 06:47:14,240 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.6013e+00
[rank1]:2025-11-02 06:47:14,246 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6203e+00
[rank0]:2025-11-02 06:47:14,253 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.8245e+00
[rank2]:2025-11-02 06:47:14,236 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8711e+00
[rank3]:2025-11-02 06:47:37,531 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6405e-01
[rank1]:2025-11-02 06:47:37,528 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.2537e-01
[rank0]:2025-11-02 06:47:37,547 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0352e+00
[rank2]:2025-11-02 06:47:37,530 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7186e-01
[rank0]:2025-11-02 06:47:57,135 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:47:59,207 - INFO - Avg. fwd time: 15.0531 / Avg. bwd time: 37.5737 / Avg. batch time: 436.3913 (ms) / GPU bubble ratio: 3.52%
[rank1]:2025-11-02 06:47:59,290 - INFO - Avg. fwd time: 15.8597 / Avg. bwd time: 34.1900 / Avg. batch time: 536.4795 (ms) / GPU bubble ratio: 25.37%
[rank2]:2025-11-02 06:47:59,236 - INFO - Avg. fwd time: 13.9368 / Avg. bwd time: 29.4773 / Avg. batch time: 482.1055 (ms) / GPU bubble ratio: 27.96%
[rank3]:2025-11-02 06:47:59,342 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.2277e-01
[rank3]:2025-11-02 06:47:59,345 - INFO -  step: 1200  loss:  0.2932  grad_norm:  0.2175  memory: 79.24GiB(56.67%)  tps: 7,300  tflops: 340.49  mfu: 34.43%
[rank3]:2025-11-02 06:47:59,345 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 06:47:59,349 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.4398e-01
[rank1]:2025-11-02 06:47:59,349 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2175  memory: 70.12GiB(50.15%)  tps: 7,300  tflops: 340.46  mfu: 34.42%
[rank0]:2025-11-02 06:47:59,327 - INFO - Avg. fwd time: 13.8228 / Avg. bwd time: 35.4998 / Avg. batch time: 595.3651 (ms) / GPU bubble ratio: 33.72%
[rank0]:2025-11-02 06:47:59,353 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.0193e+00
[rank1]:2025-11-02 06:47:59,349 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 06:47:59,353 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2175  memory: 70.53GiB(50.44%)  tps: 7,301  tflops: 340.51  mfu: 34.43%
[rank0]:2025-11-02 06:47:59,353 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 06:47:59,339 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.6071e-01
[rank2]:2025-11-02 06:47:59,339 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2175  memory: 63.09GiB(45.12%)  tps: 7,300  tflops: 340.50  mfu: 34.43%
[rank2]:2025-11-02 06:47:59,339 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 06:48:15,396 - INFO - validate step: 1200  loss: -1.0000  memory: 70.53GiB(50.44%)  tps: 25,532
[rank0]:2025-11-02 06:48:15,397 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 06:48:15,401 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-02 06:48:15,455 - INFO - validate step: 1200  loss:  0.2590  memory: 79.24GiB(56.67%)  tps: 25,427
[rank3]:2025-11-02 06:48:15,456 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 06:48:15,430 - INFO - validate step: 1200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,472
[rank1]:2025-11-02 06:48:15,431 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 06:48:15,443 - INFO - validate step: 1200  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,436
[rank2]:2025-11-02 06:48:15,444 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 06:48:28,300 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.86 seconds.
[rank0]:2025-11-02 06:48:29,100 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 06:48:29,106 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.71 seconds.
[rank1]:2025-11-02 06:48:30,058 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.63 seconds.
[rank3]:2025-11-02 06:48:31,065 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.61 seconds.
[rank1]:2025-11-02 06:48:31,173 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0648_stage1_step1200.svg
[rank2]:2025-11-02 06:48:31,179 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0648_stage2_step1200.svg
[rank0]:2025-11-02 06:48:31,265 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0648_stage0_step1200.svg
[rank3]:2025-11-02 06:48:31,365 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0648_real_step1200_rank3.svg
[rank3]:> Batch Time: 506.35 ms, GPU Bubble Ratio: 32.53%, 24.52%, 42.73%, 30.78%
[rank3]:2025-11-02 06:48:31,431 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0648_stage3_step1200.svg
[rank1]:2025-11-02 06:48:55,554 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1130e+00
[rank2]:2025-11-02 06:48:55,557 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4464e+00
[rank3]:2025-11-02 06:48:55,557 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.4280e-01
[rank0]:2025-11-02 06:48:55,574 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.2255e+00
[rank2]:2025-11-02 06:49:17,267 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3181e+00
[rank3]:2025-11-02 06:49:17,271 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4699e+00
[rank1]:2025-11-02 06:49:17,277 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.4308e-01
[rank0]:2025-11-02 06:49:17,281 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.4115e+00
[rank3]:2025-11-02 06:49:40,433 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0373e+00
[rank1]:2025-11-02 06:49:40,430 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.5480e+00
[rank0]:2025-11-02 06:49:40,449 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6446e+00
[rank2]:2025-11-02 06:49:40,433 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8102e+00
[rank0]:2025-11-02 06:50:01,905 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.4995e+00
[rank1]:2025-11-02 06:50:01,901 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.2372e+00
[rank2]:2025-11-02 06:50:01,891 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.4702e+00
[rank3]:2025-11-02 06:50:01,895 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.3021e+00
[rank0]:2025-11-02 06:50:24,868 - INFO - [GC] Peforming periodical GC collection 2.05 seconds
[rank3]:2025-11-02 06:50:26,980 - INFO - Avg. fwd time: 15.0864 / Avg. bwd time: 37.2564 / Avg. batch time: 434.2385 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-11-02 06:50:27,018 - INFO - Avg. fwd time: 13.9567 / Avg. bwd time: 29.2836 / Avg. batch time: 479.7659 (ms) / GPU bubble ratio: 27.90%
[rank1]:2025-11-02 06:50:27,046 - INFO - Avg. fwd time: 15.8823 / Avg. bwd time: 33.9772 / Avg. batch time: 534.3108 (ms) / GPU bubble ratio: 25.35%
[rank0]:2025-11-02 06:50:27,122 - INFO - Avg. fwd time: 13.8370 / Avg. bwd time: 35.3845 / Avg. batch time: 593.6516 (ms) / GPU bubble ratio: 33.67%
[rank3]:2025-11-02 06:50:27,207 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.4912e-01
[rank3]:2025-11-02 06:50:27,209 - INFO -  step: 1250  loss:  0.3094  grad_norm:  0.4829  memory: 79.24GiB(56.67%)  tps: 6,218  tflops: 289.99  mfu: 29.32%
[rank1]:2025-11-02 06:50:27,203 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.8776e+00
[rank1]:2025-11-02 06:50:27,204 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4829  memory: 70.12GiB(50.15%)  tps: 6,217  tflops: 289.95  mfu: 29.32%
[rank0]:2025-11-02 06:50:27,223 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2225e+00
[rank0]:2025-11-02 06:50:27,223 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4829  memory: 70.53GiB(50.44%)  tps: 6,214  tflops: 289.83  mfu: 29.31%
[rank2]:2025-11-02 06:50:27,206 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8813e-01
[rank2]:2025-11-02 06:50:27,207 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4829  memory: 63.09GiB(45.12%)  tps: 6,217  tflops: 289.97  mfu: 29.32%
[rank3]:2025-11-02 06:50:49,069 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5581e+00
[rank0]:2025-11-02 06:50:49,079 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.3935e+00
[rank2]:2025-11-02 06:50:49,065 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1832e+00
[rank1]:2025-11-02 06:50:49,075 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.5596e-01
[rank3]:2025-11-02 06:51:12,722 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9960e-01
[rank2]:2025-11-02 06:51:12,722 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2687e-01
[rank1]:2025-11-02 06:51:12,719 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.2300e-01
[rank0]:2025-11-02 06:51:12,739 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.6624e-01
[rank3]:2025-11-02 06:51:34,208 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.6157e-01
[rank1]:2025-11-02 06:51:34,215 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.3038e-01
[rank0]:2025-11-02 06:51:34,218 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.9239e-01
[rank2]:2025-11-02 06:51:34,205 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.1805e+00
[rank3]:2025-11-02 06:51:57,345 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3451e+00
[rank0]:2025-11-02 06:51:57,362 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.1362e+00
[rank2]:2025-11-02 06:51:57,345 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4183e+00
[rank1]:2025-11-02 06:51:57,342 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5858e+00
[rank0]:2025-11-02 06:52:16,733 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:52:18,691 - INFO - Avg. fwd time: 15.1250 / Avg. bwd time: 36.9085 / Avg. batch time: 431.7539 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-11-02 06:52:18,731 - INFO - Avg. fwd time: 13.9826 / Avg. bwd time: 29.0599 / Avg. batch time: 477.0462 (ms) / GPU bubble ratio: 27.82%
[rank1]:2025-11-02 06:52:18,796 - INFO - Avg. fwd time: 15.9082 / Avg. bwd time: 33.7659 / Avg. batch time: 531.8808 (ms) / GPU bubble ratio: 25.29%
[rank0]:2025-11-02 06:52:18,814 - INFO - Avg. fwd time: 13.8557 / Avg. bwd time: 35.2367 / Avg. batch time: 591.5514 (ms) / GPU bubble ratio: 33.61%
[rank3]:2025-11-02 06:52:18,899 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.6160e-01
[rank3]:2025-11-02 06:52:18,901 - INFO -  step: 1300  loss:  0.1852  grad_norm:  0.1492  memory: 79.24GiB(56.67%)  tps: 7,335  tflops: 342.08  mfu: 34.59%
[rank1]:2025-11-02 06:52:18,905 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 6.2169e-01
[rank1]:2025-11-02 06:52:18,905 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1492  memory: 70.12GiB(50.15%)  tps: 7,334  tflops: 342.05  mfu: 34.59%
[rank2]:2025-11-02 06:52:18,895 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.5239e-01
[rank2]:2025-11-02 06:52:18,896 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1492  memory: 63.09GiB(45.12%)  tps: 7,335  tflops: 342.09  mfu: 34.59%
[rank0]:2025-11-02 06:52:18,909 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 9.5168e-01
[rank0]:2025-11-02 06:52:18,909 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1492  memory: 70.53GiB(50.44%)  tps: 7,335  tflops: 342.10  mfu: 34.59%
[rank1]:2025-11-02 06:52:18,986 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0652_stage1_step1300.svg
[rank2]:2025-11-02 06:52:18,987 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0652_stage2_step1300.svg
[rank0]:2025-11-02 06:52:18,981 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0652_stage0_step1300.svg
[rank3]:2025-11-02 06:52:19,085 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0652_real_step1300_rank3.svg
[rank3]:> Batch Time: 499.47 ms, GPU Bubble Ratio: 31.77%, 24.70%, 42.32%, 30.37%
[rank3]:2025-11-02 06:52:19,148 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0652_stage3_step1300.svg
[rank1]:2025-11-02 06:52:42,652 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.3275e+00
[rank3]:2025-11-02 06:52:42,655 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0475e+00
[rank2]:2025-11-02 06:52:42,655 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2075e+00
[rank0]:2025-11-02 06:52:42,672 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.0494e+00
[rank3]:2025-11-02 06:53:04,839 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8157e+00
[rank1]:2025-11-02 06:53:04,845 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5793e+00
[rank0]:2025-11-02 06:53:04,849 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.7414e+00
[rank2]:2025-11-02 06:53:04,835 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.0622e+00
[rank3]:2025-11-02 06:53:28,555 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6215e-01
[rank1]:2025-11-02 06:53:28,552 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1951e-01
[rank2]:2025-11-02 06:53:28,555 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1973e-01
[rank0]:2025-11-02 06:53:28,571 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.2095e-01
[rank3]:2025-11-02 06:53:50,072 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.3023e-01
[rank2]:2025-11-02 06:53:50,068 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6441e+00
[rank1]:2025-11-02 06:53:50,078 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.4697e-01
[rank0]:2025-11-02 06:53:50,082 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.4081e+00
[rank0]:2025-11-02 06:54:11,172 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:54:13,366 - INFO - Avg. fwd time: 15.1659 / Avg. bwd time: 36.6024 / Avg. batch time: 429.6250 (ms) / GPU bubble ratio: 3.60%
[rank2]:2025-11-02 06:54:13,402 - INFO - Avg. fwd time: 14.0083 / Avg. bwd time: 28.8770 / Avg. batch time: 474.7531 (ms) / GPU bubble ratio: 27.73%
[rank1]:2025-11-02 06:54:13,437 - INFO - Avg. fwd time: 15.9380 / Avg. bwd time: 33.5547 / Avg. batch time: 529.7437 (ms) / GPU bubble ratio: 25.26%
[rank1]:2025-11-02 06:54:13,516 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.9682e-01
[rank1]:2025-11-02 06:54:13,516 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3034  memory: 70.12GiB(50.15%)  tps: 7,148  tflops: 333.37  mfu: 33.71%
[rank2]:2025-11-02 06:54:13,519 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.1711e-01
[rank2]:2025-11-02 06:54:13,520 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3034  memory: 63.09GiB(45.12%)  tps: 7,147  tflops: 333.33  mfu: 33.70%
[rank0]:2025-11-02 06:54:13,498 - INFO - Avg. fwd time: 13.8737 / Avg. bwd time: 35.1314 / Avg. batch time: 589.8829 (ms) / GPU bubble ratio: 33.54%
[rank3]:2025-11-02 06:54:13,519 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2614e-01
[rank3]:2025-11-02 06:54:13,523 - INFO -  step: 1350  loss:  0.1305  grad_norm:  0.3034  memory: 79.24GiB(56.67%)  tps: 7,147  tflops: 333.34  mfu: 33.70%
[rank0]:2025-11-02 06:54:13,536 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7388e+00
[rank0]:2025-11-02 06:54:13,536 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3034  memory: 70.53GiB(50.44%)  tps: 7,147  tflops: 333.32  mfu: 33.70%
[rank3]:2025-11-02 06:54:35,293 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0011e+00
[rank0]:2025-11-02 06:54:35,303 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.4696e+00
[rank2]:2025-11-02 06:54:35,290 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.9739e-01
[rank1]:2025-11-02 06:54:35,299 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1395e+00
[rank3]:2025-11-02 06:54:58,487 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0483e-01
[rank0]:2025-11-02 06:54:58,503 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.6723e-01
[rank2]:2025-11-02 06:54:58,487 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6385e-01
[rank1]:2025-11-02 06:54:58,484 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.4009e+00
[rank0]:2025-11-02 06:55:20,077 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.5175e+00
[rank1]:2025-11-02 06:55:20,074 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0548e+00
[rank2]:2025-11-02 06:55:20,064 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 3.5768e-01
[rank3]:2025-11-02 06:55:20,068 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5710e+00
[rank3]:2025-11-02 06:55:43,255 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2012e+00
[rank0]:2025-11-02 06:55:43,271 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.6308e-01
[rank1]:2025-11-02 06:55:43,251 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.1846e+00
[rank2]:2025-11-02 06:55:43,255 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5429e+00
[rank0]:2025-11-02 06:56:03,094 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 06:56:05,095 - INFO - Avg. fwd time: 15.1928 / Avg. bwd time: 36.3424 / Avg. batch time: 427.7529 (ms) / GPU bubble ratio: 3.62%
[rank1]:2025-11-02 06:56:05,204 - INFO - Avg. fwd time: 15.9538 / Avg. bwd time: 33.4064 / Avg. batch time: 527.9481 (ms) / GPU bubble ratio: 25.20%
[rank2]:2025-11-02 06:56:05,136 - INFO - Avg. fwd time: 14.0269 / Avg. bwd time: 28.7072 / Avg. batch time: 472.7017 (ms) / GPU bubble ratio: 27.68%
[rank0]:2025-11-02 06:56:05,221 - INFO - Avg. fwd time: 13.8859 / Avg. bwd time: 35.0129 / Avg. batch time: 588.2783 (ms) / GPU bubble ratio: 33.50%
[rank1]:2025-11-02 06:56:05,312 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7187e+00
[rank1]:2025-11-02 06:56:05,313 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2099  memory: 70.12GiB(50.15%)  tps: 7,328  tflops: 341.76  mfu: 34.56%
[rank1]:2025-11-02 06:56:05,313 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 06:56:05,302 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4943e+00
[rank2]:2025-11-02 06:56:05,303 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2099  memory: 63.09GiB(45.12%)  tps: 7,328  tflops: 341.80  mfu: 34.56%
[rank2]:2025-11-02 06:56:05,303 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 06:56:05,316 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.9615e-01
[rank0]:2025-11-02 06:56:05,316 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2099  memory: 70.53GiB(50.44%)  tps: 7,329  tflops: 341.81  mfu: 34.56%
[rank0]:2025-11-02 06:56:05,316 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 06:56:05,306 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.9216e-01
[rank3]:2025-11-02 06:56:05,309 - INFO -  step: 1400  loss:  0.3864  grad_norm:  0.2099  memory: 79.24GiB(56.67%)  tps: 7,328  tflops: 341.80  mfu: 34.56%
[rank3]:2025-11-02 06:56:05,309 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 06:56:21,316 - INFO - validate step: 1400  loss: -1.0000  memory: 70.53GiB(50.44%)  tps: 25,600
[rank3]:2025-11-02 06:56:21,381 - INFO - validate step: 1400  loss:  0.2561  memory: 79.24GiB(56.67%)  tps: 25,487
[rank2]:2025-11-02 06:56:21,365 - INFO - validate step: 1400  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,502
[rank1]:2025-11-02 06:56:21,351 - INFO - validate step: 1400  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,539
[rank2]:2025-11-02 06:56:21,462 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0656_stage2_step1400.svg
[rank1]:2025-11-02 06:56:21,458 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0656_stage1_step1400.svg
[rank0]:2025-11-02 06:56:21,456 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0656_stage0_step1400.svg
[rank3]:2025-11-02 06:56:21,562 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0656_real_step1400_rank3.svg
[rank3]:> Batch Time: 539.22 ms, GPU Bubble Ratio: 27.27%, 36.68%, 40.03%, 32.43%
[rank3]:2025-11-02 06:56:21,628 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0656_stage3_step1400.svg
[rank1]:2025-11-02 06:56:45,137 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.6951e-01
[rank2]:2025-11-02 06:56:45,141 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2373e-01
[rank0]:2025-11-02 06:56:45,157 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6604e-01
[rank3]:2025-11-02 06:56:45,141 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2977e+00
[rank1]:2025-11-02 06:57:07,153 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1507e+00
[rank2]:2025-11-02 06:57:07,143 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.3108e+00
[rank0]:2025-11-02 06:57:07,156 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.9628e+00
[rank3]:2025-11-02 06:57:07,147 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.3039e-01
[rank1]:2025-11-02 06:57:30,980 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.7965e+00
[rank2]:2025-11-02 06:57:30,984 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3569e-01
[rank0]:2025-11-02 06:57:31,000 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.6687e-01
[rank3]:2025-11-02 06:57:30,984 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0690e+00
[rank3]:2025-11-02 06:57:53,047 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.4039e+00
[rank1]:2025-11-02 06:57:53,053 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2018e+00
[rank2]:2025-11-02 06:57:53,043 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.6765e+00
[rank0]:2025-11-02 06:57:53,057 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.9035e+00
[rank0]:2025-11-02 06:58:14,298 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 06:58:16,406 - INFO - Avg. fwd time: 15.2337 / Avg. bwd time: 36.0783 / Avg. batch time: 425.9631 (ms) / GPU bubble ratio: 3.63%
[rank1]:2025-11-02 06:58:16,472 - INFO - Avg. fwd time: 15.9836 / Avg. bwd time: 33.2346 / Avg. batch time: 526.1998 (ms) / GPU bubble ratio: 25.17%
[rank2]:2025-11-02 06:58:16,444 - INFO - Avg. fwd time: 14.0550 / Avg. bwd time: 28.5422 / Avg. batch time: 470.7665 (ms) / GPU bubble ratio: 27.61%
[rank0]:2025-11-02 06:58:16,548 - INFO - Avg. fwd time: 13.9070 / Avg. bwd time: 34.9109 / Avg. batch time: 586.8582 (ms) / GPU bubble ratio: 33.45%
[rank1]:2025-11-02 06:58:16,629 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0936e+00
[rank1]:2025-11-02 06:58:16,629 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.2835  memory: 70.12GiB(50.15%)  tps: 7,106  tflops: 331.44  mfu: 33.51%
[rank2]:2025-11-02 06:58:16,632 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7793e+00
[rank2]:2025-11-02 06:58:16,632 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.2835  memory: 63.09GiB(45.12%)  tps: 7,107  tflops: 331.47  mfu: 33.52%
[rank0]:2025-11-02 06:58:16,648 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8876e+00
[rank0]:2025-11-02 06:58:16,649 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.2835  memory: 70.53GiB(50.44%)  tps: 7,103  tflops: 331.28  mfu: 33.50%
[rank3]:2025-11-02 06:58:16,632 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6188e+00
[rank3]:2025-11-02 06:58:16,635 - INFO -  step: 1450  loss:  0.2096  grad_norm:  0.2835  memory: 79.24GiB(56.67%)  tps: 7,108  tflops: 331.51  mfu: 33.52%
[rank3]:2025-11-02 06:58:38,566 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.9238e-01
[rank2]:2025-11-02 06:58:38,563 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.2693e+00
[rank1]:2025-11-02 06:58:38,573 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1771e+00
[rank0]:2025-11-02 06:58:38,576 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.2828e+00
[rank2]:2025-11-02 06:59:02,261 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.3423e-01
[rank1]:2025-11-02 06:59:02,258 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.7832e+00
[rank0]:2025-11-02 06:59:02,277 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8152e+00
[rank3]:2025-11-02 06:59:02,261 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2465e+00
[rank2]:2025-11-02 06:59:24,567 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4966e+00
[rank1]:2025-11-02 06:59:24,577 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.9703e-01
[rank0]:2025-11-02 06:59:24,581 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.6901e-01
[rank3]:2025-11-02 06:59:24,571 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0960e+00
[rank3]:2025-11-02 06:59:48,358 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3696e-01
[rank1]:2025-11-02 06:59:48,355 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.4560e-01
[rank2]:2025-11-02 06:59:48,358 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7184e-01
[rank0]:2025-11-02 06:59:48,374 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.9572e-01
[rank0]:2025-11-02 07:00:08,342 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:00:10,453 - INFO - Avg. fwd time: 15.2747 / Avg. bwd time: 35.8258 / Avg. batch time: 424.2658 (ms) / GPU bubble ratio: 3.64%
[rank1]:2025-11-02 07:00:10,534 - INFO - Avg. fwd time: 16.0110 / Avg. bwd time: 33.0942 / Avg. batch time: 524.6137 (ms) / GPU bubble ratio: 25.12%
[rank2]:2025-11-02 07:00:10,485 - INFO - Avg. fwd time: 14.0842 / Avg. bwd time: 28.3720 / Avg. batch time: 468.8980 (ms) / GPU bubble ratio: 27.56%
[rank2]:2025-11-02 07:00:10,585 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.6024e+00
[rank2]:2025-11-02 07:00:10,585 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2293  memory: 63.09GiB(45.12%)  tps: 7,189  tflops: 335.29  mfu: 33.90%
[rank1]:2025-11-02 07:00:10,594 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.9252e-01
[rank1]:2025-11-02 07:00:10,595 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2293  memory: 70.12GiB(50.15%)  tps: 7,188  tflops: 335.26  mfu: 33.90%
[rank0]:2025-11-02 07:00:10,572 - INFO - Avg. fwd time: 13.9299 / Avg. bwd time: 34.7908 / Avg. batch time: 585.4311 (ms) / GPU bubble ratio: 33.42%
[rank0]:2025-11-02 07:00:10,598 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.9434e+00
[rank0]:2025-11-02 07:00:10,598 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2293  memory: 70.53GiB(50.44%)  tps: 7,189  tflops: 335.30  mfu: 33.90%
[rank3]:2025-11-02 07:00:10,588 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.3104e+00
[rank3]:2025-11-02 07:00:10,591 - INFO -  step: 1500  loss:  0.2603  grad_norm:  0.2293  memory: 79.24GiB(56.67%)  tps: 7,189  tflops: 335.29  mfu: 33.90%
[rank2]:2025-11-02 07:00:10,678 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0700_stage2_step1500.svg
[rank1]:2025-11-02 07:00:10,675 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0700_stage1_step1500.svg
[rank0]:2025-11-02 07:00:10,670 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0700_stage0_step1500.svg
[rank3]:2025-11-02 07:00:10,777 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0700_real_step1500_rank3.svg
[rank3]:> Batch Time: 512.58 ms, GPU Bubble Ratio: 32.75%, 24.52%, 42.83%, 30.54%
[rank3]:2025-11-02 07:00:10,844 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0700_stage3_step1500.svg
[rank3]:2025-11-02 07:00:34,587 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.5839e-01
[rank2]:2025-11-02 07:00:34,588 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3349e+00
[rank1]:2025-11-02 07:00:34,584 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2474e+00
[rank0]:2025-11-02 07:00:34,604 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0070e+00
[rank2]:2025-11-02 07:00:56,773 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.2569e-01
[rank0]:2025-11-02 07:00:56,786 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.8491e-01
[rank3]:2025-11-02 07:00:56,776 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5191e+00
[rank1]:2025-11-02 07:00:56,782 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5231e-01
[rank1]:2025-11-02 07:01:20,495 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2223e-01
[rank0]:2025-11-02 07:01:20,515 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.8207e-01
[rank3]:2025-11-02 07:01:20,498 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6263e-01
[rank2]:2025-11-02 07:01:20,498 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4762e-01
[rank3]:2025-11-02 07:01:42,558 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1899e+00
[rank1]:2025-11-02 07:01:42,564 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7993e+00
[rank2]:2025-11-02 07:01:42,554 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9442e+00
[rank0]:2025-11-02 07:01:42,568 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 2.7330e+00
[rank0]:2025-11-02 07:02:03,753 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:02:05,903 - INFO - Avg. fwd time: 15.3079 / Avg. bwd time: 35.6325 / Avg. batch time: 422.9823 (ms) / GPU bubble ratio: 3.65%
[rank1]:2025-11-02 07:02:05,969 - INFO - Avg. fwd time: 16.0357 / Avg. bwd time: 32.9605 / Avg. batch time: 523.3339 (ms) / GPU bubble ratio: 25.10%
[rank2]:2025-11-02 07:02:05,940 - INFO - Avg. fwd time: 14.1056 / Avg. bwd time: 28.2544 / Avg. batch time: 467.5153 (ms) / GPU bubble ratio: 27.51%
[rank0]:2025-11-02 07:02:06,044 - INFO - Avg. fwd time: 13.9470 / Avg. bwd time: 34.7231 / Avg. batch time: 584.4447 (ms) / GPU bubble ratio: 33.38%
[rank2]:2025-11-02 07:02:06,128 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3688e+00
[rank2]:2025-11-02 07:02:06,129 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4183  memory: 63.09GiB(45.12%)  tps: 7,090  tflops: 330.68  mfu: 33.44%
[rank1]:2025-11-02 07:02:06,125 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.4802e+00
[rank1]:2025-11-02 07:02:06,126 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4183  memory: 70.12GiB(50.15%)  tps: 7,091  tflops: 330.71  mfu: 33.44%
[rank0]:2025-11-02 07:02:06,145 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6431e+00
[rank0]:2025-11-02 07:02:06,145 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4183  memory: 70.53GiB(50.44%)  tps: 7,090  tflops: 330.67  mfu: 33.43%
[rank3]:2025-11-02 07:02:06,128 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2497e-01
[rank3]:2025-11-02 07:02:06,131 - INFO -  step: 1550  loss:  0.3125  grad_norm:  0.4183  memory: 79.24GiB(56.67%)  tps: 7,090  tflops: 330.69  mfu: 33.44%
[rank1]:2025-11-02 07:02:28,136 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2854e+00
[rank2]:2025-11-02 07:02:28,126 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.4157e+00
[rank0]:2025-11-02 07:02:28,139 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.8752e+00
[rank3]:2025-11-02 07:02:28,129 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0844e+00
[rank2]:2025-11-02 07:02:51,645 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5034e-01
[rank1]:2025-11-02 07:02:51,642 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3911e+00
[rank0]:2025-11-02 07:02:51,662 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4762e+00
[rank3]:2025-11-02 07:02:51,645 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0756e-01
[rank0]:2025-11-02 07:03:13,326 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 4.4988e+00
[rank3]:2025-11-02 07:03:13,316 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.9361e+00
[rank1]:2025-11-02 07:03:13,323 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.7686e+00
[rank2]:2025-11-02 07:03:13,313 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.4261e+00
[rank1]:2025-11-02 07:03:37,051 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.6144e-01
[rank2]:2025-11-02 07:03:37,054 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1423e+00
[rank0]:2025-11-02 07:03:37,071 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.1847e-01
[rank3]:2025-11-02 07:03:37,055 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0819e+00
[rank0]:2025-11-02 07:03:56,922 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:03:58,936 - INFO - Avg. fwd time: 15.3385 / Avg. bwd time: 35.4090 / Avg. batch time: 421.4343 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-11-02 07:03:58,978 - INFO - Avg. fwd time: 14.1260 / Avg. bwd time: 28.1103 / Avg. batch time: 465.8168 (ms) / GPU bubble ratio: 27.46%
[rank0]:2025-11-02 07:03:59,061 - INFO - Avg. fwd time: 13.9620 / Avg. bwd time: 34.6268 / Avg. batch time: 583.1479 (ms) / GPU bubble ratio: 33.34%
[rank1]:2025-11-02 07:03:59,043 - INFO - Avg. fwd time: 16.0554 / Avg. bwd time: 32.8262 / Avg. batch time: 521.8347 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-11-02 07:03:59,145 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4188e+00
[rank3]:2025-11-02 07:03:59,147 - INFO -  step: 1600  loss:  0.4776  grad_norm:  0.4198  memory: 79.24GiB(56.67%)  tps: 7,249  tflops: 338.08  mfu: 34.18%
[rank3]:2025-11-02 07:03:59,148 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 07:03:59,155 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 8.3110e-01
[rank0]:2025-11-02 07:03:59,155 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.4198  memory: 70.53GiB(50.44%)  tps: 7,249  tflops: 338.09  mfu: 34.19%
[rank0]:2025-11-02 07:03:59,155 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 07:03:59,151 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.9021e-01
[rank1]:2025-11-02 07:03:59,152 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.4198  memory: 70.12GiB(50.15%)  tps: 7,248  tflops: 338.04  mfu: 34.18%
[rank1]:2025-11-02 07:03:59,152 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 07:03:59,141 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8559e+00
[rank2]:2025-11-02 07:03:59,142 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.4198  memory: 63.09GiB(45.12%)  tps: 7,249  tflops: 338.08  mfu: 34.18%
[rank2]:2025-11-02 07:03:59,142 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 07:04:15,141 - INFO - validate step: 1600  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,618
[rank3]:2025-11-02 07:04:15,166 - INFO - validate step: 1600  loss:  0.2588  memory: 79.24GiB(56.67%)  tps: 25,572
[rank0]:2025-11-02 07:04:15,107 - INFO - validate step: 1600  loss: -1.0000  memory: 70.53GiB(50.44%)  tps: 25,678
[rank2]:2025-11-02 07:04:15,154 - INFO - validate step: 1600  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,581
[rank0]:2025-11-02 07:04:15,244 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0704_stage0_step1600.svg
[rank1]:2025-11-02 07:04:15,249 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0704_stage1_step1600.svg
[rank2]:2025-11-02 07:04:15,253 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0704_stage2_step1600.svg
[rank3]:2025-11-02 07:04:15,349 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0704_real_step1600_rank3.svg
[rank3]:> Batch Time: 506.69 ms, GPU Bubble Ratio: 32.18%, 24.73%, 42.30%, 30.06%
[rank3]:2025-11-02 07:04:15,417 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0704_stage3_step1600.svg
[rank1]:2025-11-02 07:04:39,122 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6283e+00
[rank2]:2025-11-02 07:04:39,125 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0830e+00
[rank3]:2025-11-02 07:04:39,125 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3961e+00
[rank0]:2025-11-02 07:04:39,141 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2576e+00
[rank1]:2025-11-02 07:05:01,175 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2507e-01
[rank2]:2025-11-02 07:05:01,166 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.7497e-01
[rank3]:2025-11-02 07:05:01,169 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.2673e-01
[rank0]:2025-11-02 07:05:01,179 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 9.4002e-01
[rank3]:2025-11-02 07:05:24,706 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3922e-01
[rank0]:2025-11-02 07:05:24,723 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3115e-01
[rank1]:2025-11-02 07:05:24,703 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2077e+00
[rank2]:2025-11-02 07:05:24,706 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9323e-01
[rank3]:2025-11-02 07:05:46,839 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.7694e+00
[rank0]:2025-11-02 07:05:46,849 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.7152e+00
[rank1]:2025-11-02 07:05:46,845 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.6352e+00
[rank2]:2025-11-02 07:05:46,836 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 4.7891e+00
[rank0]:2025-11-02 07:06:08,121 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:06:10,368 - INFO - Avg. fwd time: 15.3697 / Avg. bwd time: 35.2110 / Avg. batch time: 420.0960 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-11-02 07:06:10,407 - INFO - Avg. fwd time: 14.1458 / Avg. bwd time: 27.9924 / Avg. batch time: 464.3771 (ms) / GPU bubble ratio: 27.41%
[rank1]:2025-11-02 07:06:10,444 - INFO - Avg. fwd time: 16.0776 / Avg. bwd time: 32.6843 / Avg. batch time: 520.4755 (ms) / GPU bubble ratio: 25.05%
[rank1]:2025-11-02 07:06:10,518 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1116e-01
[rank1]:2025-11-02 07:06:10,518 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.5985  memory: 70.12GiB(50.15%)  tps: 7,100  tflops: 331.15  mfu: 33.48%
[rank2]:2025-11-02 07:06:10,521 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.9106e-01
[rank2]:2025-11-02 07:06:10,521 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.5985  memory: 63.09GiB(45.12%)  tps: 7,101  tflops: 331.18  mfu: 33.49%
[rank3]:2025-11-02 07:06:10,521 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6175e-01
[rank3]:2025-11-02 07:06:10,524 - INFO -  step: 1650  loss:  0.4919  grad_norm:  0.5985  memory: 79.24GiB(56.67%)  tps: 7,101  tflops: 331.21  mfu: 33.49%
[rank0]:2025-11-02 07:06:10,500 - INFO - Avg. fwd time: 13.9762 / Avg. bwd time: 34.5612 / Avg. batch time: 582.1167 (ms) / GPU bubble ratio: 33.30%
[rank0]:2025-11-02 07:06:10,538 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.3373e-01
[rank0]:2025-11-02 07:06:10,538 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.5985  memory: 70.53GiB(50.44%)  tps: 7,097  tflops: 331.00  mfu: 33.47%
[rank1]:2025-11-02 07:06:32,619 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3141e+00
[rank2]:2025-11-02 07:06:32,609 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.9586e+00
[rank3]:2025-11-02 07:06:32,613 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4180e+00
[rank0]:2025-11-02 07:06:32,622 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.7258e+00
[rank1]:2025-11-02 07:06:56,336 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.1438e-01
[rank2]:2025-11-02 07:06:56,339 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9197e-01
[rank3]:2025-11-02 07:06:56,339 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2620e+00
[rank0]:2025-11-02 07:06:56,355 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.4894e-01
[rank1]:2025-11-02 07:07:18,395 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4229e-01
[rank2]:2025-11-02 07:07:18,385 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.7560e-01
[rank3]:2025-11-02 07:07:18,389 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2412e+00
[rank0]:2025-11-02 07:07:18,398 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 8.7906e-01
[rank1]:2025-11-02 07:07:42,101 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5805e+00
[rank2]:2025-11-02 07:07:42,104 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9258e+00
[rank3]:2025-11-02 07:07:42,104 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5484e+00
[rank0]:2025-11-02 07:07:42,120 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7438e+00
[rank0]:2025-11-02 07:08:01,977 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:08:04,027 - INFO - Avg. fwd time: 14.1637 / Avg. bwd time: 27.8791 / Avg. batch time: 463.1138 (ms) / GPU bubble ratio: 27.37%
[rank3]:2025-11-02 07:08:03,986 - INFO - Avg. fwd time: 15.3956 / Avg. bwd time: 35.0423 / Avg. batch time: 418.9502 (ms) / GPU bubble ratio: 3.69%
[rank1]:2025-11-02 07:08:04,091 - INFO - Avg. fwd time: 16.0949 / Avg. bwd time: 32.5885 / Avg. batch time: 519.3906 (ms) / GPU bubble ratio: 25.01%
[rank0]:2025-11-02 07:08:04,109 - INFO - Avg. fwd time: 13.9896 / Avg. bwd time: 34.4817 / Avg. batch time: 581.1359 (ms) / GPU bubble ratio: 33.27%
[rank1]:2025-11-02 07:08:04,199 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1781e+00
[rank1]:2025-11-02 07:08:04,199 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.3453  memory: 70.12GiB(50.15%)  tps: 7,206  tflops: 336.10  mfu: 33.98%
[rank2]:2025-11-02 07:08:04,189 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 2.7951e+00
[rank2]:2025-11-02 07:08:04,190 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.3453  memory: 63.09GiB(45.12%)  tps: 7,207  tflops: 336.13  mfu: 33.99%
[rank3]:2025-11-02 07:08:04,192 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1248e+00
[rank3]:2025-11-02 07:08:04,195 - INFO -  step: 1700  loss:  0.4629  grad_norm:  0.3453  memory: 79.24GiB(56.67%)  tps: 7,207  tflops: 336.13  mfu: 33.99%
[rank0]:2025-11-02 07:08:04,202 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 1.6942e+00
[rank0]:2025-11-02 07:08:04,203 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.3453  memory: 70.53GiB(50.44%)  tps: 7,207  tflops: 336.14  mfu: 33.99%
[rank0]:2025-11-02 07:08:04,275 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0708_stage0_step1700.svg
[rank1]:2025-11-02 07:08:04,281 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0708_stage1_step1700.svg
[rank2]:2025-11-02 07:08:04,285 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0708_stage2_step1700.svg
[rank3]:2025-11-02 07:08:04,378 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0708_real_step1700_rank3.svg
[rank3]:> Batch Time: 544.16 ms, GPU Bubble Ratio: 27.21%, 36.67%, 39.87%, 32.07%
[rank3]:2025-11-02 07:08:04,444 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0708_stage3_step1700.svg
[rank2]:2025-11-02 07:08:28,054 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.1227e-01
[rank1]:2025-11-02 07:08:28,050 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.4967e-01
[rank3]:2025-11-02 07:08:28,054 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3896e-01
[rank0]:2025-11-02 07:08:28,070 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.9596e-01
[rank3]:2025-11-02 07:08:50,105 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2097e+00
[rank0]:2025-11-02 07:08:50,115 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.2497e-01
[rank2]:2025-11-02 07:08:50,102 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 8.6785e-01
[rank1]:2025-11-02 07:08:50,111 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3444e+00
[rank2]:2025-11-02 07:09:13,776 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1485e-01
[rank1]:2025-11-02 07:09:13,773 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.5493e-01
[rank3]:2025-11-02 07:09:13,776 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.6996e-01
[rank0]:2025-11-02 07:09:13,793 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.6956e-01
[rank3]:2025-11-02 07:09:35,922 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.0021e-01
[rank0]:2025-11-02 07:09:35,932 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 5.3179e-01
[rank2]:2025-11-02 07:09:35,918 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.9013e-01
[rank1]:2025-11-02 07:09:35,928 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.0891e-01
[rank0]:2025-11-02 07:09:57,365 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:09:59,539 - INFO - Avg. fwd time: 15.4244 / Avg. bwd time: 34.8669 / Avg. batch time: 417.7740 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-11-02 07:09:59,578 - INFO - Avg. fwd time: 14.1817 / Avg. bwd time: 27.7664 / Avg. batch time: 461.8375 (ms) / GPU bubble ratio: 27.34%
[rank1]:2025-11-02 07:09:59,605 - INFO - Avg. fwd time: 16.1137 / Avg. bwd time: 32.4693 / Avg. batch time: 518.2158 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-11-02 07:09:59,763 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0077e-01
[rank0]:2025-11-02 07:09:59,679 - INFO - Avg. fwd time: 14.0044 / Avg. bwd time: 34.4152 / Avg. batch time: 580.1910 (ms) / GPU bubble ratio: 33.24%
[rank2]:2025-11-02 07:09:59,763 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2109e-01
[rank2]:2025-11-02 07:09:59,763 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4941  memory: 63.09GiB(45.12%)  tps: 7,088  tflops: 330.59  mfu: 33.43%
[rank1]:2025-11-02 07:09:59,760 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.1401e-01
[rank1]:2025-11-02 07:09:59,760 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4941  memory: 70.12GiB(50.15%)  tps: 7,089  tflops: 330.63  mfu: 33.43%
[rank3]:2025-11-02 07:09:59,766 - INFO -  step: 1750  loss:  0.4432  grad_norm:  0.4941  memory: 79.24GiB(56.67%)  tps: 7,088  tflops: 330.60  mfu: 33.43%
[rank0]:2025-11-02 07:09:59,780 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.0337e-01
[rank0]:2025-11-02 07:09:59,780 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4941  memory: 70.53GiB(50.44%)  tps: 7,088  tflops: 330.58  mfu: 33.43%
[rank2]:2025-11-02 07:10:21,904 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5900e+00
[rank1]:2025-11-02 07:10:21,914 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.5795e+00
[rank3]:2025-11-02 07:10:21,907 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.7739e+00
[rank0]:2025-11-02 07:10:21,917 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.0593e+00
[rank2]:2025-11-02 07:10:45,825 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9435e+00
[rank1]:2025-11-02 07:10:45,822 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.8680e+00
[rank3]:2025-11-02 07:10:45,825 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7547e+00
[rank0]:2025-11-02 07:10:45,841 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.5819e+00
[rank3]:2025-11-02 07:11:07,617 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.0134e+00
[rank0]:2025-11-02 07:11:07,627 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 6.1811e+00
[rank2]:2025-11-02 07:11:07,614 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.9605e+00
[rank1]:2025-11-02 07:11:07,624 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.5547e+00
[rank2]:2025-11-02 07:11:30,574 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6374e-01
[rank1]:2025-11-02 07:11:30,571 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.0811e+00
[rank3]:2025-11-02 07:11:30,574 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.6644e-01
[rank0]:2025-11-02 07:11:30,591 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.1012e+00
[rank0]:2025-11-02 07:11:49,635 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:11:51,643 - INFO - Avg. fwd time: 15.4441 / Avg. bwd time: 34.6907 / Avg. batch time: 416.5175 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-11-02 07:11:51,677 - INFO - Avg. fwd time: 14.1929 / Avg. bwd time: 27.6429 / Avg. batch time: 460.4474 (ms) / GPU bubble ratio: 27.31%
[rank0]:2025-11-02 07:11:51,763 - INFO - Avg. fwd time: 14.0144 / Avg. bwd time: 34.3323 / Avg. batch time: 579.0709 (ms) / GPU bubble ratio: 33.21%
[rank2]:2025-11-02 07:11:51,776 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 1.8351e+00
[rank2]:2025-11-02 07:11:51,776 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0950  memory: 63.09GiB(45.12%)  tps: 7,313  tflops: 341.10  mfu: 34.49%
[rank2]:2025-11-02 07:11:51,776 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 07:11:51,724 - INFO - Avg. fwd time: 16.1197 / Avg. bwd time: 32.3681 / Avg. batch time: 516.9958 (ms) / GPU bubble ratio: 24.97%
[rank1]:2025-11-02 07:11:51,785 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3562e+00
[rank1]:2025-11-02 07:11:51,786 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0950  memory: 70.12GiB(50.15%)  tps: 7,313  tflops: 341.06  mfu: 34.49%
[rank1]:2025-11-02 07:11:51,786 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 07:11:51,779 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9015e+00
[rank3]:2025-11-02 07:11:51,782 - INFO -  step: 1800  loss:  0.0669  grad_norm:  0.0950  memory: 79.24GiB(56.67%)  tps: 7,313  tflops: 341.09  mfu: 34.49%
[rank3]:2025-11-02 07:11:51,782 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 07:11:51,789 - INFO - Freezing Ratio: [Stage0] 0.12, Threshold: 3.0883e+00
[rank0]:2025-11-02 07:11:51,789 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0950  memory: 70.53GiB(50.44%)  tps: 7,314  tflops: 341.11  mfu: 34.49%
[rank0]:2025-11-02 07:11:51,789 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 07:12:07,849 - INFO - validate step: 1800  loss: -1.0000  memory: 70.53GiB(50.44%)  tps: 25,505
[rank2]:2025-11-02 07:12:07,900 - INFO - validate step: 1800  loss: -1.0000  memory: 63.09GiB(45.12%)  tps: 25,404
[rank1]:2025-11-02 07:12:07,883 - INFO - validate step: 1800  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,445
[rank3]:2025-11-02 07:12:07,923 - INFO - validate step: 1800  loss:  0.2523  memory: 79.24GiB(56.67%)  tps: 25,378
[rank2]:2025-11-02 07:12:08,007 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0712_stage2_step1800.svg
[rank1]:2025-11-02 07:12:08,003 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0712_stage1_step1800.svg
[rank0]:2025-11-02 07:12:07,996 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0712_stage0_step1800.svg
[rank3]:2025-11-02 07:12:08,104 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0712_real_step1800_rank3.svg
[rank3]:> Batch Time: 498.23 ms, GPU Bubble Ratio: 31.98%, 24.86%, 42.93%, 30.87%
[rank3]:2025-11-02 07:12:08,172 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0712_stage3_step1800.svg
[rank1]:2025-11-02 07:12:31,144 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1865e+00
[rank3]:2025-11-02 07:12:31,147 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.5414e-01
[rank0]:2025-11-02 07:12:31,163 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.3486e-01
[rank2]:2025-11-02 07:12:31,147 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.3916e-01
[rank3]:2025-11-02 07:12:53,080 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.0643e+00
[rank0]:2025-11-02 07:12:53,090 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2186e+01
[rank2]:2025-11-02 07:12:53,077 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1668e+01
[rank1]:2025-11-02 07:12:53,087 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1007e+01
[rank2]:2025-11-02 07:13:13,748 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8870e+00
[rank1]:2025-11-02 07:13:13,751 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6494e+00
[rank3]:2025-11-02 07:13:13,751 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5885e+00
[rank0]:2025-11-02 07:13:13,761 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.4541e+00
[rank2]:2025-11-02 07:13:35,341 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0939e-01
[rank1]:2025-11-02 07:13:35,350 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.4897e-01
[rank3]:2025-11-02 07:13:35,344 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8173e+00
[rank0]:2025-11-02 07:13:35,354 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 8.9794e-01
[rank0]:2025-11-02 07:13:53,502 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:13:55,352 - INFO - Avg. fwd time: 15.4604 / Avg. bwd time: 34.5333 / Avg. batch time: 415.3854 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-11-02 07:13:55,393 - INFO - Avg. fwd time: 14.2041 / Avg. bwd time: 27.5146 / Avg. batch time: 459.1947 (ms) / GPU bubble ratio: 27.32%
[rank0]:2025-11-02 07:13:55,445 - INFO - Avg. fwd time: 14.0271 / Avg. bwd time: 34.2189 / Avg. batch time: 577.7220 (ms) / GPU bubble ratio: 33.19%
[rank1]:2025-11-02 07:13:55,425 - INFO - Avg. fwd time: 16.1263 / Avg. bwd time: 32.2686 / Avg. batch time: 515.7795 (ms) / GPU bubble ratio: 24.94%
[rank3]:2025-11-02 07:13:55,522 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.9357e+00
[rank3]:2025-11-02 07:13:55,524 - INFO -  step: 1850  loss:  0.3815  grad_norm:  0.2149  memory: 79.24GiB(56.67%)  tps: 7,613  tflops: 355.09  mfu: 35.90%
[rank0]:2025-11-02 07:13:55,529 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.0082e+00
[rank0]:2025-11-02 07:13:55,529 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2149  memory: 71.50GiB(51.14%)  tps: 7,608  tflops: 354.83  mfu: 35.88%
[rank2]:2025-11-02 07:13:55,518 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3446e+00
[rank2]:2025-11-02 07:13:55,519 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2149  memory: 63.09GiB(45.12%)  tps: 7,612  tflops: 355.03  mfu: 35.90%
[rank1]:2025-11-02 07:13:55,521 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5873e+00
[rank1]:2025-11-02 07:13:55,522 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.2149  memory: 70.12GiB(50.15%)  tps: 7,611  tflops: 354.96  mfu: 35.89%
[rank2]:2025-11-02 07:14:17,088 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4007e-01
[rank1]:2025-11-02 07:14:17,101 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2218e+00
[rank3]:2025-11-02 07:14:17,095 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4300e+00
[rank0]:2025-11-02 07:14:17,104 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8938e+00
[rank3]:2025-11-02 07:14:37,255 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9014e+00
[rank0]:2025-11-02 07:14:37,261 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.6192e+00
[rank2]:2025-11-02 07:14:37,251 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3216e+00
[rank1]:2025-11-02 07:14:37,254 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.7813e+00
[rank1]:2025-11-02 07:14:58,567 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.5351e-01
[rank3]:2025-11-02 07:14:58,561 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8297e-01
[rank0]:2025-11-02 07:14:58,571 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.5074e-01
[rank2]:2025-11-02 07:14:58,554 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.2379e-01
[rank2]:2025-11-02 07:15:18,648 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.0785e-01
[rank1]:2025-11-02 07:15:18,651 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6509e-01
[rank3]:2025-11-02 07:15:18,651 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.4019e-01
[rank0]:2025-11-02 07:15:18,658 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.3563e+00
[rank0]:2025-11-02 07:15:37,758 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:15:39,700 - INFO - Avg. fwd time: 15.4773 / Avg. bwd time: 34.3416 / Avg. batch time: 413.9817 (ms) / GPU bubble ratio: 3.73%
[rank2]:2025-11-02 07:15:39,735 - INFO - Avg. fwd time: 14.2223 / Avg. bwd time: 27.3027 / Avg. batch time: 457.5633 (ms) / GPU bubble ratio: 27.40%
[rank1]:2025-11-02 07:15:39,799 - INFO - Avg. fwd time: 16.1300 / Avg. bwd time: 32.1703 / Avg. batch time: 514.2600 (ms) / GPU bubble ratio: 24.86%
[rank0]:2025-11-02 07:15:39,817 - INFO - Avg. fwd time: 14.0454 / Avg. bwd time: 34.0176 / Avg. batch time: 575.6948 (ms) / GPU bubble ratio: 33.21%
[rank3]:2025-11-02 07:15:39,899 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.0734e-01
[rank3]:2025-11-02 07:15:39,902 - INFO -  step: 1900  loss:  0.1978  grad_norm:  0.1223  memory: 79.24GiB(56.67%)  tps: 7,849  tflops: 366.06  mfu: 37.01%
[rank0]:2025-11-02 07:15:39,909 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.4976e+00
[rank0]:2025-11-02 07:15:39,909 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1223  memory: 71.50GiB(51.14%)  tps: 7,848  tflops: 366.04  mfu: 37.01%
[rank2]:2025-11-02 07:15:39,893 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0933e+00
[rank2]:2025-11-02 07:15:39,893 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1223  memory: 64.04GiB(45.81%)  tps: 7,849  tflops: 366.06  mfu: 37.01%
[rank2]:2025-11-02 07:15:39,983 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0715_stage2_step1900.svg
[rank1]:2025-11-02 07:15:39,905 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.8700e-01
[rank1]:2025-11-02 07:15:39,906 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1223  memory: 70.12GiB(50.15%)  tps: 7,848  tflops: 366.03  mfu: 37.01%
[rank1]:2025-11-02 07:15:39,988 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0715_stage1_step1900.svg
[rank0]:2025-11-02 07:15:39,983 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0715_stage0_step1900.svg
[rank3]:2025-11-02 07:15:40,085 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0715_real_step1900_rank3.svg
[rank3]:> Batch Time: 494.92 ms, GPU Bubble Ratio: 31.67%, 24.74%, 45.78%, 29.70%
[rank3]:2025-11-02 07:15:40,152 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0715_stage3_step1900.svg
[rank3]:2025-11-02 07:16:00,121 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5256e-01
[rank0]:2025-11-02 07:16:00,128 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.0308e-01
[rank2]:2025-11-02 07:16:00,118 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.0225e-02
[rank1]:2025-11-02 07:16:00,121 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.0506e-01
[rank3]:2025-11-02 07:16:21,451 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2036e+00
[rank0]:2025-11-02 07:16:21,461 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0583e+00
[rank2]:2025-11-02 07:16:21,444 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9427e+00
[rank1]:2025-11-02 07:16:21,457 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.8417e-01
[rank2]:2025-11-02 07:16:41,410 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2277e+00
[rank1]:2025-11-02 07:16:41,414 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.1057e+00
[rank3]:2025-11-02 07:16:41,414 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9091e+00
[rank0]:2025-11-02 07:16:41,421 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4047e+00
[rank3]:2025-11-02 07:17:02,782 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8627e+00
[rank0]:2025-11-02 07:17:02,791 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.9860e+00
[rank2]:2025-11-02 07:17:02,775 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.0749e-01
[rank1]:2025-11-02 07:17:02,788 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0981e+00
[rank0]:2025-11-02 07:17:20,613 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:17:22,567 - INFO - Avg. fwd time: 14.2378 / Avg. bwd time: 27.1086 / Avg. batch time: 456.0236 (ms) / GPU bubble ratio: 27.47%
[rank3]:2025-11-02 07:17:22,534 - INFO - Avg. fwd time: 15.4920 / Avg. bwd time: 34.1590 / Avg. batch time: 412.6347 (ms) / GPU bubble ratio: 3.74%
[rank2]:2025-11-02 07:17:22,649 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.4738e-01
[rank2]:2025-11-02 07:17:22,649 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1001  memory: 64.04GiB(45.81%)  tps: 7,972  tflops: 371.83  mfu: 37.60%
[rank1]:2025-11-02 07:17:22,604 - INFO - Avg. fwd time: 16.1334 / Avg. bwd time: 32.0632 / Avg. batch time: 512.7406 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-11-02 07:17:22,652 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.2404e-01
[rank1]:2025-11-02 07:17:22,653 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1001  memory: 70.12GiB(50.15%)  tps: 7,973  tflops: 371.86  mfu: 37.60%
[rank3]:2025-11-02 07:17:22,653 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.8950e-01
[rank3]:2025-11-02 07:17:22,655 - INFO -  step: 1950  loss:  0.1625  grad_norm:  0.1001  memory: 79.24GiB(56.67%)  tps: 7,973  tflops: 371.84  mfu: 37.60%
[rank0]:2025-11-02 07:17:22,638 - INFO - Avg. fwd time: 14.0640 / Avg. bwd time: 33.8066 / Avg. batch time: 573.6738 (ms) / GPU bubble ratio: 33.24%
[rank0]:2025-11-02 07:17:22,656 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6215e+00
[rank0]:2025-11-02 07:17:22,656 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1001  memory: 72.50GiB(51.86%)  tps: 7,973  tflops: 371.86  mfu: 37.60%
[rank2]:2025-11-02 07:17:43,958 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0218e-01
[rank1]:2025-11-02 07:17:43,971 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2601e+00
[rank3]:2025-11-02 07:17:43,965 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.3577e-01
[rank0]:2025-11-02 07:17:43,975 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.0286e-01
[rank2]:2025-11-02 07:18:03,893 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5533e-01
[rank1]:2025-11-02 07:18:03,896 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.5867e-01
[rank0]:2025-11-02 07:18:03,900 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.9935e-01
[rank3]:2025-11-02 07:18:03,896 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.7241e-01
[rank0]:2025-11-02 07:18:25,179 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.0642e-01
[rank3]:2025-11-02 07:18:25,169 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0298e+00
[rank2]:2025-11-02 07:18:25,163 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8251e-01
[rank1]:2025-11-02 07:18:25,176 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.8489e-01
[rank1]:2025-11-02 07:18:45,044 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.8610e+00
[rank0]:2025-11-02 07:18:45,048 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.9972e+00
[rank3]:2025-11-02 07:18:45,044 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3852e+00
[rank2]:2025-11-02 07:18:45,041 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.6018e-01
[rank0]:2025-11-02 07:19:04,233 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:19:06,191 - INFO - Avg. fwd time: 15.5039 / Avg. bwd time: 34.0107 / Avg. batch time: 411.5393 (ms) / GPU bubble ratio: 3.75%
[rank2]:2025-11-02 07:19:06,225 - INFO - Avg. fwd time: 14.2513 / Avg. bwd time: 26.9429 / Avg. batch time: 454.7493 (ms) / GPU bubble ratio: 27.53%
[rank0]:2025-11-02 07:19:06,308 - INFO - Avg. fwd time: 14.0787 / Avg. bwd time: 33.6265 / Avg. batch time: 572.0904 (ms) / GPU bubble ratio: 33.29%
[rank1]:2025-11-02 07:19:06,292 - INFO - Avg. fwd time: 16.1346 / Avg. bwd time: 31.9913 / Avg. batch time: 511.5781 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 07:19:06,400 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0248e+00
[rank0]:2025-11-02 07:19:06,400 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1072  memory: 72.50GiB(51.86%)  tps: 7,896  tflops: 368.29  mfu: 37.24%
[rank0]:2025-11-02 07:19:06,400 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 07:19:06,390 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4239e+00
[rank3]:2025-11-02 07:19:06,392 - INFO -  step: 2000  loss:  0.1960  grad_norm:  0.1072  memory: 79.24GiB(56.67%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank3]:2025-11-02 07:19:06,393 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 07:19:06,383 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6497e+00
[rank2]:2025-11-02 07:19:06,384 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1072  memory: 64.04GiB(45.81%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank2]:2025-11-02 07:19:06,384 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 07:19:06,396 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4222e+00
[rank1]:2025-11-02 07:19:06,396 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1072  memory: 70.12GiB(50.15%)  tps: 7,896  tflops: 368.29  mfu: 37.24%
[rank1]:2025-11-02 07:19:06,397 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 07:19:22,585 - INFO - validate step: 2000  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,302
[rank0]:2025-11-02 07:19:22,551 - INFO - validate step: 2000  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,361
[rank2]:2025-11-02 07:19:22,620 - INFO - validate step: 2000  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,227
[rank3]:2025-11-02 07:19:22,645 - INFO - validate step: 2000  loss:  0.2444  memory: 79.24GiB(56.67%)  tps: 25,204
[rank2]:2025-11-02 07:19:22,718 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0719_stage2_step2000.svg
[rank1]:2025-11-02 07:19:22,728 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0719_stage1_step2000.svg
[rank0]:2025-11-02 07:19:22,727 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0719_stage0_step2000.svg
[rank3]:2025-11-02 07:19:22,821 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0719_real_step2000_rank3.svg
[rank3]:> Batch Time: 467.45 ms, GPU Bubble Ratio: 35.16%, 27.47%, 38.70%, 25.45%
[rank3]:2025-11-02 07:19:22,891 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0719_stage3_step2000.svg
[rank2]:2025-11-02 07:19:42,666 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2126e+00
[rank1]:2025-11-02 07:19:42,669 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 2.2727e+00
[rank0]:2025-11-02 07:19:42,673 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.4621e+00
[rank3]:2025-11-02 07:19:42,669 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6519e+00
[rank3]:2025-11-02 07:20:04,059 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.9001e-01
[rank2]:2025-11-02 07:20:04,052 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2095e-01
[rank1]:2025-11-02 07:20:04,065 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.1213e+00
[rank0]:2025-11-02 07:20:04,069 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.9425e-01
[rank3]:2025-11-02 07:20:23,878 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0757e+00
[rank2]:2025-11-02 07:20:23,875 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.7501e-01
[rank1]:2025-11-02 07:20:23,878 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0861e+00
[rank0]:2025-11-02 07:20:23,882 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.2744e-01
[rank2]:2025-11-02 07:20:45,209 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.4159e-01
[rank1]:2025-11-02 07:20:45,222 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9357e+00
[rank0]:2025-11-02 07:20:45,226 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.5958e-01
[rank3]:2025-11-02 07:20:45,215 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3902e+00
[rank0]:2025-11-02 07:21:03,179 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:21:05,018 - INFO - Avg. fwd time: 15.5173 / Avg. bwd time: 33.8460 / Avg. batch time: 410.3243 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-11-02 07:21:05,060 - INFO - Avg. fwd time: 14.2663 / Avg. bwd time: 26.7641 / Avg. batch time: 453.3557 (ms) / GPU bubble ratio: 27.60%
[rank1]:2025-11-02 07:21:05,092 - INFO - Avg. fwd time: 16.1375 / Avg. bwd time: 31.9003 / Avg. batch time: 510.2396 (ms) / GPU bubble ratio: 24.68%
[rank0]:2025-11-02 07:21:05,107 - INFO - Avg. fwd time: 14.0971 / Avg. bwd time: 33.4158 / Avg. batch time: 570.2750 (ms) / GPU bubble ratio: 33.35%
[rank0]:2025-11-02 07:21:05,186 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6247e+00
[rank0]:2025-11-02 07:21:05,187 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1193  memory: 72.50GiB(51.86%)  tps: 7,982  tflops: 372.27  mfu: 37.64%
[rank3]:2025-11-02 07:21:05,183 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7315e+00
[rank3]:2025-11-02 07:21:05,185 - INFO -  step: 2050  loss:  0.2179  grad_norm:  0.1193  memory: 79.24GiB(56.67%)  tps: 7,989  tflops: 372.61  mfu: 37.68%
[rank2]:2025-11-02 07:21:05,179 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1266e+00
[rank2]:2025-11-02 07:21:05,180 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1193  memory: 64.04GiB(45.81%)  tps: 7,988  tflops: 372.54  mfu: 37.67%
[rank1]:2025-11-02 07:21:05,183 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.0306e-01
[rank1]:2025-11-02 07:21:05,183 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1193  memory: 70.12GiB(50.15%)  tps: 7,985  tflops: 372.40  mfu: 37.65%
[rank3]:2025-11-02 07:21:26,434 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.7598e-01
[rank2]:2025-11-02 07:21:26,428 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1613e+00
[rank1]:2025-11-02 07:21:26,441 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.2477e-01
[rank0]:2025-11-02 07:21:26,444 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.9376e-01
[rank2]:2025-11-02 07:21:46,362 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0839e+00
[rank1]:2025-11-02 07:21:46,366 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1281e+00
[rank0]:2025-11-02 07:21:46,369 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.7040e+00
[rank3]:2025-11-02 07:21:46,366 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8713e+00
[rank1]:2025-11-02 07:22:07,713 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9015e+00
[rank0]:2025-11-02 07:22:07,717 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0992e+00
[rank3]:2025-11-02 07:22:07,707 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0936e+00
[rank2]:2025-11-02 07:22:07,701 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8742e+00
[rank1]:2025-11-02 07:22:27,518 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0036e+00
[rank0]:2025-11-02 07:22:27,522 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.9100e-01
[rank3]:2025-11-02 07:22:27,518 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3134e+00
[rank2]:2025-11-02 07:22:27,514 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.0254e-01
[rank0]:2025-11-02 07:22:46,769 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:22:48,794 - INFO - Avg. fwd time: 15.5303 / Avg. bwd time: 33.6895 / Avg. batch time: 409.1729 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-11-02 07:22:48,826 - INFO - Avg. fwd time: 14.2812 / Avg. bwd time: 26.5880 / Avg. batch time: 452.0153 (ms) / GPU bubble ratio: 27.67%
[rank1]:2025-11-02 07:22:48,875 - INFO - Avg. fwd time: 16.1385 / Avg. bwd time: 31.8265 / Avg. batch time: 509.0245 (ms) / GPU bubble ratio: 24.62%
[rank1]:2025-11-02 07:22:48,938 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0390e+00
[rank1]:2025-11-02 07:22:48,938 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1219  memory: 70.12GiB(50.15%)  tps: 7,896  tflops: 368.25  mfu: 37.23%
[rank0]:2025-11-02 07:22:48,915 - INFO - Avg. fwd time: 14.1125 / Avg. bwd time: 33.2277 / Avg. batch time: 568.6197 (ms) / GPU bubble ratio: 33.40%
[rank0]:2025-11-02 07:22:48,941 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.6607e-02
[rank0]:2025-11-02 07:22:48,942 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1219  memory: 72.50GiB(51.86%)  tps: 7,896  tflops: 368.25  mfu: 37.23%
[rank3]:2025-11-02 07:22:48,931 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3121e-01
[rank3]:2025-11-02 07:22:48,934 - INFO -  step: 2100  loss:  0.2230  grad_norm:  0.1219  memory: 79.24GiB(56.67%)  tps: 7,896  tflops: 368.28  mfu: 37.24%
[rank2]:2025-11-02 07:22:48,925 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8969e-01
[rank2]:2025-11-02 07:22:48,925 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1219  memory: 64.04GiB(45.81%)  tps: 7,896  tflops: 368.28  mfu: 37.24%
[rank2]:2025-11-02 07:22:49,009 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0722_stage2_step2100.svg
[rank1]:2025-11-02 07:22:49,015 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0722_stage1_step2100.svg
[rank0]:2025-11-02 07:22:49,012 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0722_stage0_step2100.svg
[rank3]:2025-11-02 07:22:49,118 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0722_real_step2100_rank3.svg
[rank3]:> Batch Time: 500.74 ms, GPU Bubble Ratio: 31.65%, 24.35%, 46.14%, 30.14%
[rank3]:2025-11-02 07:22:49,180 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0722_stage3_step2100.svg
[rank1]:2025-11-02 07:23:08,945 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5473e+00
[rank0]:2025-11-02 07:23:08,948 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7913e+00
[rank3]:2025-11-02 07:23:08,945 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5090e+00
[rank2]:2025-11-02 07:23:08,941 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.0231e-01
[rank3]:2025-11-02 07:23:30,249 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3447e+00
[rank2]:2025-11-02 07:23:30,243 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4288e+00
[rank1]:2025-11-02 07:23:30,256 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.7500e+00
[rank0]:2025-11-02 07:23:30,259 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.5708e-01
[rank2]:2025-11-02 07:23:50,172 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9654e-01
[rank1]:2025-11-02 07:23:50,175 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2314e+00
[rank0]:2025-11-02 07:23:50,179 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.3582e-01
[rank3]:2025-11-02 07:23:50,176 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3684e+00
[rank3]:2025-11-02 07:24:11,443 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.0573e-01
[rank2]:2025-11-02 07:24:11,436 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0588e+00
[rank1]:2025-11-02 07:24:11,449 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5425e+00
[rank0]:2025-11-02 07:24:11,453 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6619e-01
[rank0]:2025-11-02 07:24:29,319 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:24:31,129 - INFO - Avg. fwd time: 15.5407 / Avg. bwd time: 33.5609 / Avg. batch time: 408.2237 (ms) / GPU bubble ratio: 3.78%
[rank2]:2025-11-02 07:24:31,171 - INFO - Avg. fwd time: 14.2923 / Avg. bwd time: 26.4504 / Avg. batch time: 450.9315 (ms) / GPU bubble ratio: 27.72%
[rank1]:2025-11-02 07:24:31,204 - INFO - Avg. fwd time: 16.1407 / Avg. bwd time: 31.7517 / Avg. batch time: 507.9644 (ms) / GPU bubble ratio: 24.57%
[rank0]:2025-11-02 07:24:31,219 - INFO - Avg. fwd time: 14.1263 / Avg. bwd time: 33.0599 / Avg. batch time: 567.1833 (ms) / GPU bubble ratio: 33.44%
[rank3]:2025-11-02 07:24:31,295 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6113e-01
[rank3]:2025-11-02 07:24:31,297 - INFO -  step: 2150  loss:  0.1832  grad_norm:  0.1042  memory: 79.24GiB(56.67%)  tps: 8,003  tflops: 373.26  mfu: 37.74%
[rank2]:2025-11-02 07:24:31,291 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9843e-01
[rank2]:2025-11-02 07:24:31,292 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1042  memory: 64.04GiB(45.81%)  tps: 8,003  tflops: 373.24  mfu: 37.74%
[rank1]:2025-11-02 07:24:31,295 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 4.6570e-01
[rank1]:2025-11-02 07:24:31,295 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1042  memory: 70.12GiB(50.15%)  tps: 8,003  tflops: 373.28  mfu: 37.74%
[rank0]:2025-11-02 07:24:31,298 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1458e-01
[rank0]:2025-11-02 07:24:31,299 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1042  memory: 72.50GiB(51.86%)  tps: 8,003  tflops: 373.28  mfu: 37.74%
[rank2]:2025-11-02 07:24:52,607 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1515e+00
[rank3]:2025-11-02 07:24:52,614 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8657e-01
[rank1]:2025-11-02 07:24:52,620 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.2158e-01
[rank0]:2025-11-02 07:24:52,624 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1439e-01
[rank2]:2025-11-02 07:25:12,398 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7085e-01
[rank3]:2025-11-02 07:25:12,401 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.5993e-01
[rank1]:2025-11-02 07:25:12,401 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0106e+00
[rank0]:2025-11-02 07:25:12,405 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4514e+00
[rank2]:2025-11-02 07:25:33,754 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8592e+00
[rank3]:2025-11-02 07:25:33,761 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2902e-01
[rank1]:2025-11-02 07:25:33,767 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.3154e-01
[rank0]:2025-11-02 07:25:33,771 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 8.1491e-01
[rank1]:2025-11-02 07:25:53,608 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.0100e-01
[rank0]:2025-11-02 07:25:53,612 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.3511e-01
[rank2]:2025-11-02 07:25:53,605 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2327e-01
[rank3]:2025-11-02 07:25:53,609 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9671e-01
[rank0]:2025-11-02 07:26:12,816 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:26:14,777 - INFO - Avg. fwd time: 14.3049 / Avg. bwd time: 26.2926 / Avg. batch time: 449.6995 (ms) / GPU bubble ratio: 27.78%
[rank3]:2025-11-02 07:26:14,741 - INFO - Avg. fwd time: 15.5518 / Avg. bwd time: 33.4177 / Avg. batch time: 407.1626 (ms) / GPU bubble ratio: 3.78%
[rank1]:2025-11-02 07:26:14,844 - INFO - Avg. fwd time: 16.1418 / Avg. bwd time: 31.6785 / Avg. batch time: 506.8127 (ms) / GPU bubble ratio: 24.52%
[rank0]:2025-11-02 07:26:14,862 - INFO - Avg. fwd time: 14.1406 / Avg. bwd time: 32.8828 / Avg. batch time: 565.6221 (ms) / GPU bubble ratio: 33.49%
[rank2]:2025-11-02 07:26:14,937 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4778e+00
[rank2]:2025-11-02 07:26:14,937 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1011  memory: 64.04GiB(45.81%)  tps: 7,904  tflops: 368.64  mfu: 37.27%
[rank2]:2025-11-02 07:26:14,937 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 07:26:14,943 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4706e+00
[rank3]:2025-11-02 07:26:14,946 - INFO -  step: 2200  loss:  0.1766  grad_norm:  0.1011  memory: 79.24GiB(56.67%)  tps: 7,904  tflops: 368.63  mfu: 37.27%
[rank3]:2025-11-02 07:26:14,946 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 07:26:14,949 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4513e+00
[rank1]:2025-11-02 07:26:14,950 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1011  memory: 70.12GiB(50.15%)  tps: 7,903  tflops: 368.61  mfu: 37.27%
[rank1]:2025-11-02 07:26:14,950 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 07:26:14,953 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.1070e-01
[rank0]:2025-11-02 07:26:14,953 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1011  memory: 72.50GiB(51.86%)  tps: 7,903  tflops: 368.61  mfu: 37.27%
[rank0]:2025-11-02 07:26:14,953 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 07:26:31,202 - INFO - validate step: 2200  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,203
[rank0]:2025-11-02 07:26:31,168 - INFO - validate step: 2200  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,262
[rank3]:2025-11-02 07:26:31,260 - INFO - validate step: 2200  loss:  0.2433  memory: 79.24GiB(56.67%)  tps: 25,108
[rank2]:2025-11-02 07:26:31,237 - INFO - validate step: 2200  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,130
[rank1]:2025-11-02 07:26:31,335 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0726_stage1_step2200.svg
[rank0]:2025-11-02 07:26:31,333 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0726_stage0_step2200.svg
[rank2]:2025-11-02 07:26:31,330 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0726_stage2_step2200.svg
[rank3]:2025-11-02 07:26:31,433 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0726_real_step2200_rank3.svg
[rank3]:> Batch Time: 497.89 ms, GPU Bubble Ratio: 31.89%, 24.40%, 46.03%, 29.63%
[rank3]:2025-11-02 07:26:31,493 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0726_stage3_step2200.svg
[rank3]:2025-11-02 07:26:51,321 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8782e+00
[rank2]:2025-11-02 07:26:51,317 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4003e+00
[rank1]:2025-11-02 07:26:51,320 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6223e+00
[rank0]:2025-11-02 07:26:51,324 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.9984e+00
[rank1]:2025-11-02 07:27:12,577 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.2630e-01
[rank0]:2025-11-02 07:27:12,581 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.9968e-01
[rank3]:2025-11-02 07:27:12,571 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.8343e-01
[rank2]:2025-11-02 07:27:12,565 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.6642e-01
[rank3]:2025-11-02 07:27:32,460 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2005e+00
[rank2]:2025-11-02 07:27:32,457 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6992e+00
[rank0]:2025-11-02 07:27:32,464 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7929e+00
[rank1]:2025-11-02 07:27:32,460 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.8841e+00
[rank0]:2025-11-02 07:27:53,804 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4282e+00
[rank1]:2025-11-02 07:27:53,800 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1154e+00
[rank3]:2025-11-02 07:27:53,794 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2868e+00
[rank2]:2025-11-02 07:27:53,787 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8906e+00
[rank0]:2025-11-02 07:28:11,597 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:28:13,515 - INFO - Avg. fwd time: 15.5620 / Avg. bwd time: 33.2807 / Avg. batch time: 406.1447 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-11-02 07:28:13,550 - INFO - Avg. fwd time: 14.3160 / Avg. bwd time: 26.1477 / Avg. batch time: 448.5381 (ms) / GPU bubble ratio: 27.83%
[rank0]:2025-11-02 07:28:13,625 - INFO - Avg. fwd time: 14.1553 / Avg. bwd time: 32.7026 / Avg. batch time: 564.0716 (ms) / GPU bubble ratio: 33.54%
[rank1]:2025-11-02 07:28:13,589 - INFO - Avg. fwd time: 16.1438 / Avg. bwd time: 31.5971 / Avg. batch time: 505.6638 (ms) / GPU bubble ratio: 24.47%
[rank3]:2025-11-02 07:28:13,640 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1084e+00
[rank3]:2025-11-02 07:28:13,643 - INFO -  step: 2250  loss:  0.2207  grad_norm:  0.1210  memory: 79.24GiB(56.67%)  tps: 8,001  tflops: 373.19  mfu: 37.73%
[rank2]:2025-11-02 07:28:13,636 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8061e+00
[rank2]:2025-11-02 07:28:13,637 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1210  memory: 64.04GiB(45.81%)  tps: 8,000  tflops: 373.12  mfu: 37.73%
[rank0]:2025-11-02 07:28:13,643 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.9677e+00
[rank0]:2025-11-02 07:28:13,644 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1210  memory: 72.50GiB(51.86%)  tps: 7,994  tflops: 372.85  mfu: 37.70%
[rank1]:2025-11-02 07:28:13,639 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.2404e+00
[rank1]:2025-11-02 07:28:13,640 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1210  memory: 70.12GiB(50.15%)  tps: 7,997  tflops: 372.98  mfu: 37.71%
[rank0]:2025-11-02 07:28:35,034 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0829e+00
[rank1]:2025-11-02 07:28:35,031 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6553e+00
[rank3]:2025-11-02 07:28:35,024 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0395e-01
[rank2]:2025-11-02 07:28:35,018 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4839e+00
[rank0]:2025-11-02 07:28:54,846 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5082e+00
[rank1]:2025-11-02 07:28:54,843 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.5321e+00
[rank3]:2025-11-02 07:28:54,843 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5076e+00
[rank2]:2025-11-02 07:28:54,839 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4148e-01
[rank3]:2025-11-02 07:29:16,142 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5839e-01
[rank2]:2025-11-02 07:29:16,136 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7767e+00
[rank0]:2025-11-02 07:29:16,152 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.6207e-01
[rank1]:2025-11-02 07:29:16,148 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.9731e-01
[rank3]:2025-11-02 07:29:36,057 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4048e+00
[rank2]:2025-11-02 07:29:36,053 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3037e+00
[rank0]:2025-11-02 07:29:36,060 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4423e+00
[rank1]:2025-11-02 07:29:36,057 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 7.6783e-01
[rank0]:2025-11-02 07:29:55,168 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:29:57,103 - INFO - Avg. fwd time: 15.5710 / Avg. bwd time: 33.1690 / Avg. batch time: 405.3200 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-11-02 07:29:57,138 - INFO - Avg. fwd time: 14.3266 / Avg. bwd time: 26.0225 / Avg. batch time: 447.5785 (ms) / GPU bubble ratio: 27.88%
[rank1]:2025-11-02 07:29:57,205 - INFO - Avg. fwd time: 16.1446 / Avg. bwd time: 31.5434 / Avg. batch time: 504.7910 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-11-02 07:29:57,223 - INFO - Avg. fwd time: 14.1664 / Avg. bwd time: 32.5678 / Avg. batch time: 562.8832 (ms) / GPU bubble ratio: 33.58%
[rank1]:2025-11-02 07:29:57,309 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.7254e-01
[rank1]:2025-11-02 07:29:57,310 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1188  memory: 70.12GiB(50.15%)  tps: 7,902  tflops: 368.55  mfu: 37.27%
[rank3]:2025-11-02 07:29:57,303 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.4555e-01
[rank3]:2025-11-02 07:29:57,307 - INFO -  step: 2300  loss:  0.1930  grad_norm:  0.1188  memory: 79.24GiB(56.67%)  tps: 7,903  tflops: 368.58  mfu: 37.27%
[rank2]:2025-11-02 07:29:57,297 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.6040e-01
[rank2]:2025-11-02 07:29:57,297 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1188  memory: 64.04GiB(45.81%)  tps: 7,903  tflops: 368.59  mfu: 37.27%
[rank2]:2025-11-02 07:29:57,381 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0729_stage2_step2300.svg
[rank0]:2025-11-02 07:29:57,313 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0738e-01
[rank0]:2025-11-02 07:29:57,313 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1188  memory: 72.50GiB(51.86%)  tps: 7,902  tflops: 368.55  mfu: 37.27%
[rank0]:2025-11-02 07:29:57,386 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0729_stage0_step2300.svg
[rank1]:2025-11-02 07:29:57,385 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0729_stage1_step2300.svg
[rank3]:2025-11-02 07:29:57,487 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0729_real_step2300_rank3.svg
[rank3]:> Batch Time: 470.51 ms, GPU Bubble Ratio: 35.05%, 27.50%, 39.13%, 25.77%
[rank3]:2025-11-02 07:29:57,548 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0729_stage3_step2300.svg
[rank3]:2025-11-02 07:30:17,367 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0364e+00
[rank2]:2025-11-02 07:30:17,364 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3021e-01
[rank0]:2025-11-02 07:30:17,371 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.5128e-01
[rank1]:2025-11-02 07:30:17,367 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 6.1098e-01
[rank3]:2025-11-02 07:30:38,668 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9822e+00
[rank2]:2025-11-02 07:30:38,662 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5584e+00
[rank0]:2025-11-02 07:30:38,678 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0572e+00
[rank1]:2025-11-02 07:30:38,675 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.7950e+00
[rank3]:2025-11-02 07:30:58,484 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0192e+00
[rank2]:2025-11-02 07:30:58,480 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1830e+00
[rank1]:2025-11-02 07:30:58,483 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.3438e+00
[rank0]:2025-11-02 07:30:58,487 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.3616e+00
[rank1]:2025-11-02 07:31:19,873 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.3767e-01
[rank0]:2025-11-02 07:31:19,877 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.5816e-01
[rank3]:2025-11-02 07:31:19,867 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9719e-01
[rank2]:2025-11-02 07:31:19,860 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9377e-01
[rank0]:2025-11-02 07:31:37,686 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:31:39,523 - INFO - Avg. fwd time: 15.5807 / Avg. bwd time: 33.0434 / Avg. batch time: 404.3897 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-11-02 07:31:39,561 - INFO - Avg. fwd time: 14.3374 / Avg. bwd time: 25.8870 / Avg. batch time: 446.5139 (ms) / GPU bubble ratio: 27.93%
[rank1]:2025-11-02 07:31:39,595 - INFO - Avg. fwd time: 16.1461 / Avg. bwd time: 31.4741 / Avg. batch time: 503.7664 (ms) / GPU bubble ratio: 24.38%
[rank0]:2025-11-02 07:31:39,610 - INFO - Avg. fwd time: 14.1795 / Avg. bwd time: 32.4075 / Avg. batch time: 561.4951 (ms) / GPU bubble ratio: 33.62%
[rank0]:2025-11-02 07:31:39,688 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5134e+00
[rank0]:2025-11-02 07:31:39,689 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0994  memory: 72.50GiB(51.86%)  tps: 8,002  tflops: 373.21  mfu: 37.74%
[rank1]:2025-11-02 07:31:39,685 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.2642e+00
[rank1]:2025-11-02 07:31:39,685 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0994  memory: 70.12GiB(50.15%)  tps: 8,002  tflops: 373.21  mfu: 37.74%
[rank3]:2025-11-02 07:31:39,685 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1194e+00
[rank3]:2025-11-02 07:31:39,689 - INFO -  step: 2350  loss:  0.1804  grad_norm:  0.0994  memory: 79.24GiB(56.67%)  tps: 8,002  tflops: 373.20  mfu: 37.73%
[rank2]:2025-11-02 07:31:39,681 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.3648e-01
[rank2]:2025-11-02 07:31:39,681 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0994  memory: 64.04GiB(45.81%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank3]:2025-11-02 07:32:00,972 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1222e-01
[rank2]:2025-11-02 07:32:00,965 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5208e+00
[rank0]:2025-11-02 07:32:00,982 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7881e-01
[rank1]:2025-11-02 07:32:00,978 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.0301e-01
[rank3]:2025-11-02 07:32:20,900 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6668e-01
[rank2]:2025-11-02 07:32:20,897 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5386e-01
[rank0]:2025-11-02 07:32:20,904 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.6778e-01
[rank1]:2025-11-02 07:32:20,900 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.8530e-01
[rank2]:2025-11-02 07:32:42,125 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3049e+00
[rank0]:2025-11-02 07:32:42,142 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7546e-01
[rank1]:2025-11-02 07:32:42,138 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4025e+00
[rank3]:2025-11-02 07:32:42,131 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0314e+00
[rank3]:2025-11-02 07:33:02,020 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4994e+00
[rank2]:2025-11-02 07:33:02,016 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.7045e-01
[rank1]:2025-11-02 07:33:02,020 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 9.2967e-01
[rank0]:2025-11-02 07:33:02,023 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.0390e+00
[rank0]:2025-11-02 07:33:21,189 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:33:23,235 - INFO - Avg. fwd time: 15.5904 / Avg. bwd time: 32.9236 / Avg. batch time: 403.5058 (ms) / GPU bubble ratio: 3.81%
[rank2]:2025-11-02 07:33:23,266 - INFO - Avg. fwd time: 14.3487 / Avg. bwd time: 25.7521 / Avg. batch time: 445.4856 (ms) / GPU bubble ratio: 27.99%
[rank2]:2025-11-02 07:33:23,361 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3080e+00
[rank2]:2025-11-02 07:33:23,361 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1144  memory: 64.04GiB(45.81%)  tps: 7,901  tflops: 368.52  mfu: 37.26%
[rank2]:2025-11-02 07:33:23,361 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 07:33:23,352 - INFO - Avg. fwd time: 14.1911 / Avg. bwd time: 32.2648 / Avg. batch time: 560.2364 (ms) / GPU bubble ratio: 33.66%
[rank0]:2025-11-02 07:33:23,377 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.2530e-01
[rank0]:2025-11-02 07:33:23,378 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1144  memory: 72.50GiB(51.86%)  tps: 7,901  tflops: 368.48  mfu: 37.26%
[rank0]:2025-11-02 07:33:23,378 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 07:33:23,310 - INFO - Avg. fwd time: 16.1469 / Avg. bwd time: 31.4186 / Avg. batch time: 502.8433 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-11-02 07:33:23,373 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5586e+00
[rank1]:2025-11-02 07:33:23,374 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1144  memory: 70.12GiB(50.15%)  tps: 7,901  tflops: 368.48  mfu: 37.26%
[rank1]:2025-11-02 07:33:23,374 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 07:33:23,367 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0968e+00
[rank3]:2025-11-02 07:33:23,371 - INFO -  step: 2400  loss:  0.1854  grad_norm:  0.1144  memory: 79.24GiB(56.67%)  tps: 7,901  tflops: 368.51  mfu: 37.26%
[rank3]:2025-11-02 07:33:23,371 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 07:33:39,559 - INFO - validate step: 2400  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 25,313
[rank0]:2025-11-02 07:33:39,560 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 07:33:39,567 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 07:33:39,594 - INFO - validate step: 2400  loss: -1.0000  memory: 70.12GiB(50.15%)  tps: 25,253
[rank1]:2025-11-02 07:33:39,595 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 07:33:39,648 - INFO - validate step: 2400  loss:  0.2419  memory: 79.24GiB(56.67%)  tps: 25,166
[rank3]:2025-11-02 07:33:39,649 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 07:33:39,625 - INFO - validate step: 2400  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,185
[rank2]:2025-11-02 07:33:39,626 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 07:33:52,500 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.87 seconds.
[rank0]:2025-11-02 07:33:53,248 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 07:33:53,252 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.69 seconds.
[rank1]:2025-11-02 07:33:54,490 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.90 seconds.
[rank3]:2025-11-02 07:33:55,570 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.92 seconds.
[rank2]:2025-11-02 07:33:55,659 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0733_stage2_step2400.svg
[rank0]:2025-11-02 07:33:55,700 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0733_stage0_step2400.svg
[rank1]:2025-11-02 07:33:55,666 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0733_stage1_step2400.svg
[rank3]:2025-11-02 07:33:55,886 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0733_real_step2400_rank3.svg
[rank3]:> Batch Time: 499.86 ms, GPU Bubble Ratio: 31.68%, 24.35%, 46.24%, 30.27%
[rank3]:2025-11-02 07:33:55,959 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0733_stage3_step2400.svg
[rank2]:2025-11-02 07:34:15,701 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1247e-01
[rank1]:2025-11-02 07:34:15,704 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.6750e+00
[rank0]:2025-11-02 07:34:15,708 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.5290e+00
[rank3]:2025-11-02 07:34:15,704 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1218e+00
[rank3]:2025-11-02 07:34:37,076 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4933e+00
[rank2]:2025-11-02 07:34:37,070 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1580e+00
[rank0]:2025-11-02 07:34:37,086 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.4075e+00
[rank1]:2025-11-02 07:34:37,082 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2360e+00
[rank3]:2025-11-02 07:34:56,874 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4668e+00
[rank2]:2025-11-02 07:34:56,870 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2030e+00
[rank0]:2025-11-02 07:34:56,877 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.6080e+00
[rank1]:2025-11-02 07:34:56,873 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.0447e+00
[rank3]:2025-11-02 07:35:18,187 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.9066e-01
[rank2]:2025-11-02 07:35:18,180 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.9486e-01
[rank0]:2025-11-02 07:35:18,197 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4494e-01
[rank1]:2025-11-02 07:35:18,193 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.5660e-01
[rank0]:2025-11-02 07:35:38,303 - INFO - [GC] Peforming periodical GC collection 2.18 seconds
[rank3]:2025-11-02 07:35:40,140 - INFO - Avg. fwd time: 15.5980 / Avg. bwd time: 32.8246 / Avg. batch time: 402.7718 (ms) / GPU bubble ratio: 3.82%
[rank2]:2025-11-02 07:35:40,180 - INFO - Avg. fwd time: 14.3565 / Avg. bwd time: 25.6467 / Avg. batch time: 444.6550 (ms) / GPU bubble ratio: 28.03%
[rank0]:2025-11-02 07:35:40,227 - INFO - Avg. fwd time: 14.2023 / Avg. bwd time: 32.1353 / Avg. batch time: 559.1295 (ms) / GPU bubble ratio: 33.70%
[rank1]:2025-11-02 07:35:40,212 - INFO - Avg. fwd time: 16.1481 / Avg. bwd time: 31.3605 / Avg. batch time: 502.0229 (ms) / GPU bubble ratio: 24.29%
[rank3]:2025-11-02 07:35:40,301 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.1114e-01
[rank3]:2025-11-02 07:35:40,303 - INFO -  step: 2450  loss:  0.2289  grad_norm:  0.1194  memory: 79.24GiB(56.67%)  tps: 6,790  tflops: 316.67  mfu: 32.02%
[rank2]:2025-11-02 07:35:40,297 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1749e-01
[rank2]:2025-11-02 07:35:40,297 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1194  memory: 64.04GiB(45.81%)  tps: 6,789  tflops: 316.62  mfu: 32.01%
[rank0]:2025-11-02 07:35:40,304 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.4298e+00
[rank0]:2025-11-02 07:35:40,304 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1194  memory: 72.50GiB(51.86%)  tps: 6,785  tflops: 316.43  mfu: 32.00%
[rank1]:2025-11-02 07:35:40,300 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 3.3725e-01
[rank1]:2025-11-02 07:35:40,301 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1194  memory: 70.12GiB(50.15%)  tps: 6,787  tflops: 316.53  mfu: 32.01%
[rank3]:2025-11-02 07:36:01,574 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.3212e-01
[rank2]:2025-11-02 07:36:01,567 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5260e-01
[rank0]:2025-11-02 07:36:01,584 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.1127e+00
[rank1]:2025-11-02 07:36:01,580 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0057e+00
[rank3]:2025-11-02 07:36:21,451 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2471e-01
[rank2]:2025-11-02 07:36:21,447 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2293e+00
[rank0]:2025-11-02 07:36:21,454 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.2771e-01
[rank1]:2025-11-02 07:36:21,450 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 5.5140e-01
[rank3]:2025-11-02 07:36:42,770 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.7674e-01
[rank2]:2025-11-02 07:36:42,764 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.3958e+00
[rank0]:2025-11-02 07:36:42,781 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.5528e-01
[rank1]:2025-11-02 07:36:42,777 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.8498e-01
[rank0]:2025-11-02 07:37:02,559 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 5.1843e-01
[rank1]:2025-11-02 07:37:02,555 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 8.4985e-01
[rank3]:2025-11-02 07:37:02,556 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6414e+00
[rank2]:2025-11-02 07:37:02,552 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8716e-01
[rank0]:2025-11-02 07:37:21,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:37:23,759 - INFO - Avg. fwd time: 15.6069 / Avg. bwd time: 32.7146 / Avg. batch time: 401.9599 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-11-02 07:37:23,792 - INFO - Avg. fwd time: 14.3667 / Avg. bwd time: 25.5248 / Avg. batch time: 443.7106 (ms) / GPU bubble ratio: 28.08%
[rank1]:2025-11-02 07:37:23,861 - INFO - Avg. fwd time: 16.1494 / Avg. bwd time: 31.3045 / Avg. batch time: 501.1447 (ms) / GPU bubble ratio: 24.25%
[rank2]:2025-11-02 07:37:23,952 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.3975e-01
[rank2]:2025-11-02 07:37:23,952 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1238  memory: 64.04GiB(45.81%)  tps: 7,903  tflops: 368.61  mfu: 37.27%
[rank0]:2025-11-02 07:37:23,880 - INFO - Avg. fwd time: 14.2136 / Avg. bwd time: 31.9990 / Avg. batch time: 557.9365 (ms) / GPU bubble ratio: 33.74%
[rank0]:2025-11-02 07:37:23,968 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.2255e-01
[rank0]:2025-11-02 07:37:23,969 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1238  memory: 72.50GiB(51.86%)  tps: 7,902  tflops: 368.57  mfu: 37.27%
[rank1]:2025-11-02 07:37:23,965 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.6554e-01
[rank1]:2025-11-02 07:37:23,965 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1238  memory: 70.12GiB(50.15%)  tps: 7,902  tflops: 368.57  mfu: 37.27%
[rank3]:2025-11-02 07:37:23,958 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4189e-01
[rank3]:2025-11-02 07:37:23,961 - INFO -  step: 2500  loss:  0.2106  grad_norm:  0.1238  memory: 79.24GiB(56.67%)  tps: 7,903  tflops: 368.60  mfu: 37.27%
[rank2]:2025-11-02 07:37:24,039 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0737_stage2_step2500.svg
[rank0]:2025-11-02 07:37:24,046 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0737_stage0_step2500.svg
[rank1]:2025-11-02 07:37:24,044 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0737_stage1_step2500.svg
[rank3]:2025-11-02 07:37:24,146 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0737_real_step2500_rank3.svg
[rank3]:> Batch Time: 497.23 ms, GPU Bubble Ratio: 31.97%, 24.42%, 45.78%, 29.77%
[rank3]:2025-11-02 07:37:24,210 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0737_stage3_step2500.svg
[rank3]:2025-11-02 07:37:43,964 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.1211e-01
[rank2]:2025-11-02 07:37:43,960 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0377e-01
[rank0]:2025-11-02 07:37:43,967 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.1730e+00
[rank1]:2025-11-02 07:37:43,964 - INFO - Freezing Ratio: [Stage1] 0.44, Threshold: 1.1853e+00
[rank3]:2025-11-02 07:38:05,272 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.6095e-01
[rank2]:2025-11-02 07:38:05,265 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4023e-01
[rank0]:2025-11-02 07:38:05,282 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.7760e-01
[rank1]:2025-11-02 07:38:05,278 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.3934e-01
[rank3]:2025-11-02 07:38:25,768 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0816e+01
[rank2]:2025-11-02 07:38:25,764 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1494e+01
[rank0]:2025-11-02 07:38:25,772 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.2923e+01
[rank1]:2025-11-02 07:38:25,768 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1069e+01
[rank3]:2025-11-02 07:38:46,169 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.0405e+00
[rank2]:2025-11-02 07:38:46,162 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7887e+00
[rank0]:2025-11-02 07:38:46,169 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.7806e+00
[rank1]:2025-11-02 07:38:46,169 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.7389e+00
[rank0]:2025-11-02 07:39:04,350 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:39:06,322 - INFO - Avg. fwd time: 15.6205 / Avg. bwd time: 32.6135 / Avg. batch time: 401.2586 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-11-02 07:39:06,356 - INFO - Avg. fwd time: 14.3793 / Avg. bwd time: 25.4148 / Avg. batch time: 442.9026 (ms) / GPU bubble ratio: 28.12%
[rank2]:2025-11-02 07:39:06,441 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9442e+00
[rank2]:2025-11-02 07:39:06,441 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.2005  memory: 64.04GiB(45.81%)  tps: 7,993  tflops: 372.80  mfu: 37.69%
[rank0]:2025-11-02 07:39:06,430 - INFO - Avg. fwd time: 14.2322 / Avg. bwd time: 31.8295 / Avg. batch time: 556.6602 (ms) / GPU bubble ratio: 33.80%
[rank0]:2025-11-02 07:39:06,448 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5106e+00
[rank0]:2025-11-02 07:39:06,448 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.2005  memory: 73.46GiB(52.54%)  tps: 7,994  tflops: 372.83  mfu: 37.70%
[rank1]:2025-11-02 07:39:06,393 - INFO - Avg. fwd time: 16.1593 / Avg. bwd time: 31.2113 / Avg. batch time: 500.2081 (ms) / GPU bubble ratio: 24.24%
[rank1]:2025-11-02 07:39:06,441 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.9362e+00
[rank1]:2025-11-02 07:39:06,441 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.2005  memory: 71.10GiB(50.85%)  tps: 7,994  tflops: 372.84  mfu: 37.70%
[rank3]:2025-11-02 07:39:06,444 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4383e+00
[rank3]:2025-11-02 07:39:06,447 - INFO -  step: 2550  loss:  0.4661  grad_norm:  0.2005  memory: 79.24GiB(56.67%)  tps: 7,993  tflops: 372.81  mfu: 37.70%
[rank2]:2025-11-02 07:39:26,456 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0333e+00
[rank0]:2025-11-02 07:39:26,464 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1181e+00
[rank1]:2025-11-02 07:39:26,463 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.5385e+00
[rank3]:2025-11-02 07:39:26,463 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5650e+00
[rank3]:2025-11-02 07:39:46,620 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7087e+00
[rank2]:2025-11-02 07:39:46,617 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.1031e-01
[rank0]:2025-11-02 07:39:46,624 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7176e-01
[rank1]:2025-11-02 07:39:46,617 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5015e+00
[rank1]:2025-11-02 07:40:06,719 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.3964e+00
[rank3]:2025-11-02 07:40:06,719 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6649e+00
[rank2]:2025-11-02 07:40:06,712 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9495e+00
[rank0]:2025-11-02 07:40:06,720 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 4.8687e+00
[rank3]:2025-11-02 07:40:26,888 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1596e+00
[rank2]:2025-11-02 07:40:26,884 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.9055e-01
[rank0]:2025-11-02 07:40:26,892 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.4513e-01
[rank1]:2025-11-02 07:40:26,884 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.0859e+00
[rank0]:2025-11-02 07:40:44,958 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:40:46,806 - INFO - Avg. fwd time: 15.6336 / Avg. bwd time: 32.5317 / Avg. batch time: 400.7074 (ms) / GPU bubble ratio: 3.84%
[rank2]:2025-11-02 07:40:46,839 - INFO - Avg. fwd time: 14.3912 / Avg. bwd time: 25.3189 / Avg. batch time: 442.2503 (ms) / GPU bubble ratio: 28.17%
[rank0]:2025-11-02 07:40:46,885 - INFO - Avg. fwd time: 14.2526 / Avg. bwd time: 31.6525 / Avg. batch time: 555.4382 (ms) / GPU bubble ratio: 33.88%
[rank1]:2025-11-02 07:40:46,875 - INFO - Avg. fwd time: 16.1727 / Avg. bwd time: 31.1005 / Avg. batch time: 499.3053 (ms) / GPU bubble ratio: 24.26%
[rank3]:2025-11-02 07:40:46,962 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0601e+00
[rank3]:2025-11-02 07:40:46,965 - INFO -  step: 2600  loss:  0.3907  grad_norm:  0.1554  memory: 79.24GiB(56.67%)  tps: 8,150  tflops: 380.11  mfu: 38.43%
[rank3]:2025-11-02 07:40:46,965 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 07:40:46,956 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1372e-01
[rank2]:2025-11-02 07:40:46,956 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1554  memory: 64.04GiB(45.81%)  tps: 8,150  tflops: 380.12  mfu: 38.43%
[rank2]:2025-11-02 07:40:46,956 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 07:40:46,963 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.7007e-01
[rank0]:2025-11-02 07:40:46,963 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1554  memory: 73.46GiB(52.54%)  tps: 8,150  tflops: 380.12  mfu: 38.43%
[rank0]:2025-11-02 07:40:46,963 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 07:40:46,962 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 8.0542e-01
[rank1]:2025-11-02 07:40:46,962 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1554  memory: 71.10GiB(50.85%)  tps: 8,150  tflops: 380.10  mfu: 38.43%
[rank1]:2025-11-02 07:40:46,963 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 07:41:03,215 - INFO - validate step: 2600  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,192
[rank0]:2025-11-02 07:41:03,154 - INFO - validate step: 2600  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,299
[rank1]:2025-11-02 07:41:03,193 - INFO - validate step: 2600  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,237
[rank3]:2025-11-02 07:41:03,239 - INFO - validate step: 2600  loss:  0.2452  memory: 79.24GiB(56.67%)  tps: 25,170
[rank2]:2025-11-02 07:41:03,314 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0741_stage2_step2600.svg
[rank0]:2025-11-02 07:41:03,312 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0741_stage0_step2600.svg
[rank1]:2025-11-02 07:41:03,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0741_stage1_step2600.svg
[rank3]:2025-11-02 07:41:03,419 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0741_real_step2600_rank3.svg
[rank3]:> Batch Time: 475.07 ms, GPU Bubble Ratio: 35.89%, 31.85%, 39.26%, 25.28%
[rank3]:2025-11-02 07:41:03,483 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0741_stage3_step2600.svg
[rank3]:2025-11-02 07:41:23,619 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.7506e-01
[rank2]:2025-11-02 07:41:23,615 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1190e-01
[rank0]:2025-11-02 07:41:23,622 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5953e+00
[rank1]:2025-11-02 07:41:23,615 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.3080e-01
[rank3]:2025-11-02 07:41:43,643 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2537e+00
[rank2]:2025-11-02 07:41:43,636 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4527e+00
[rank0]:2025-11-02 07:41:43,643 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2079e+00
[rank1]:2025-11-02 07:41:43,643 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6001e-01
[rank3]:2025-11-02 07:42:03,940 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0105e+00
[rank0]:2025-11-02 07:42:03,943 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9551e-01
[rank2]:2025-11-02 07:42:03,936 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4986e-01
[rank1]:2025-11-02 07:42:03,936 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.1107e-01
[rank3]:2025-11-02 07:42:24,063 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0622e+00
[rank2]:2025-11-02 07:42:24,056 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7043e+00
[rank0]:2025-11-02 07:42:24,063 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.5014e+00
[rank1]:2025-11-02 07:42:24,062 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6991e+00
[rank0]:2025-11-02 07:42:42,217 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:42:44,079 - INFO - Avg. fwd time: 15.6479 / Avg. bwd time: 32.4393 / Avg. batch time: 400.0820 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-11-02 07:42:44,118 - INFO - Avg. fwd time: 14.4039 / Avg. bwd time: 25.2151 / Avg. batch time: 441.5264 (ms) / GPU bubble ratio: 28.21%
[rank1]:2025-11-02 07:42:44,147 - INFO - Avg. fwd time: 16.1877 / Avg. bwd time: 30.9718 / Avg. batch time: 498.2938 (ms) / GPU bubble ratio: 24.29%
[rank0]:2025-11-02 07:42:44,164 - INFO - Avg. fwd time: 14.2750 / Avg. bwd time: 31.4575 / Avg. batch time: 554.0726 (ms) / GPU bubble ratio: 33.97%
[rank1]:2025-11-02 07:42:44,236 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.3602e-01
[rank1]:2025-11-02 07:42:44,237 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1347  memory: 71.10GiB(50.85%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank3]:2025-11-02 07:42:44,238 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.9342e-01
[rank3]:2025-11-02 07:42:44,241 - INFO -  step: 2650  loss:  0.3125  grad_norm:  0.1347  memory: 79.24GiB(56.67%)  tps: 8,111  tflops: 378.29  mfu: 38.25%
[rank0]:2025-11-02 07:42:44,242 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6073e-01
[rank0]:2025-11-02 07:42:44,242 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1347  memory: 73.46GiB(52.54%)  tps: 8,104  tflops: 377.96  mfu: 38.22%
[rank2]:2025-11-02 07:42:44,235 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8895e-01
[rank2]:2025-11-02 07:42:44,235 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1347  memory: 64.04GiB(45.81%)  tps: 8,109  tflops: 378.22  mfu: 38.24%
[rank1]:2025-11-02 07:43:04,359 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.0817e-01
[rank3]:2025-11-02 07:43:04,359 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.9888e-01
[rank0]:2025-11-02 07:43:04,359 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.0705e+00
[rank2]:2025-11-02 07:43:04,352 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.1146e-01
[rank3]:2025-11-02 07:43:24,530 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7208e-01
[rank0]:2025-11-02 07:43:24,533 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8670e-01
[rank2]:2025-11-02 07:43:24,526 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.0709e-01
[rank1]:2025-11-02 07:43:24,526 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.6779e-01
[rank3]:2025-11-02 07:43:44,614 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.2937e-01
[rank2]:2025-11-02 07:43:44,608 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2825e-01
[rank0]:2025-11-02 07:43:44,615 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.2226e-01
[rank1]:2025-11-02 07:43:44,614 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.7534e-01
[rank0]:2025-11-02 07:44:04,888 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1496e+00
[rank2]:2025-11-02 07:44:04,882 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.9353e-01
[rank1]:2025-11-02 07:44:04,881 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4401e+00
[rank3]:2025-11-02 07:44:04,885 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3179e+00
[rank0]:2025-11-02 07:44:22,915 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:44:24,875 - INFO - Avg. fwd time: 15.6620 / Avg. bwd time: 32.3506 / Avg. batch time: 399.4839 (ms) / GPU bubble ratio: 3.85%
[rank2]:2025-11-02 07:44:24,909 - INFO - Avg. fwd time: 14.4167 / Avg. bwd time: 25.1104 / Avg. batch time: 440.8190 (ms) / GPU bubble ratio: 28.27%
[rank0]:2025-11-02 07:44:24,986 - INFO - Avg. fwd time: 14.2970 / Avg. bwd time: 31.2653 / Avg. batch time: 552.7527 (ms) / GPU bubble ratio: 34.06%
[rank0]:2025-11-02 07:44:25,001 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.5282e-01
[rank0]:2025-11-02 07:44:25,001 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1564  memory: 73.46GiB(52.54%)  tps: 8,130  tflops: 379.20  mfu: 38.34%
[rank2]:2025-11-02 07:44:24,994 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7523e+00
[rank2]:2025-11-02 07:44:24,994 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1564  memory: 64.04GiB(45.81%)  tps: 8,130  tflops: 379.20  mfu: 38.34%
[rank1]:2025-11-02 07:44:24,950 - INFO - Avg. fwd time: 16.2019 / Avg. bwd time: 30.8534 / Avg. batch time: 497.3177 (ms) / GPU bubble ratio: 24.31%
[rank1]:2025-11-02 07:44:25,000 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.2331e-01
[rank1]:2025-11-02 07:44:25,000 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1564  memory: 71.10GiB(50.85%)  tps: 8,130  tflops: 379.18  mfu: 38.34%
[rank3]:2025-11-02 07:44:25,000 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.2269e-01
[rank3]:2025-11-02 07:44:25,003 - INFO -  step: 2700  loss:  0.3431  grad_norm:  0.1564  memory: 79.24GiB(56.67%)  tps: 8,130  tflops: 379.19  mfu: 38.34%
[rank0]:2025-11-02 07:44:25,071 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0744_stage0_step2700.svg
[rank2]:2025-11-02 07:44:25,074 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0744_stage2_step2700.svg
[rank1]:2025-11-02 07:44:25,084 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0744_stage1_step2700.svg
[rank3]:2025-11-02 07:44:25,170 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0744_real_step2700_rank3.svg
[rank3]:> Batch Time: 470.91 ms, GPU Bubble Ratio: 38.80%, 27.15%, 42.45%, 24.77%
[rank3]:2025-11-02 07:44:25,232 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0744_stage3_step2700.svg
[rank2]:2025-11-02 07:44:45,418 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2774e+00
[rank0]:2025-11-02 07:44:45,425 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.0575e-01
[rank1]:2025-11-02 07:44:45,418 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2327e+00
[rank3]:2025-11-02 07:44:45,421 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.5256e-01
[rank1]:2025-11-02 07:45:05,460 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.8416e-01
[rank3]:2025-11-02 07:45:05,460 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5301e-01
[rank0]:2025-11-02 07:45:05,460 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.2797e-01
[rank2]:2025-11-02 07:45:05,453 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2685e+00
[rank1]:2025-11-02 07:45:25,694 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.7805e-01
[rank3]:2025-11-02 07:45:25,698 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.5726e-01
[rank0]:2025-11-02 07:45:25,701 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8728e-01
[rank2]:2025-11-02 07:45:25,694 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.3618e-01
[rank1]:2025-11-02 07:45:45,812 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4373e+00
[rank3]:2025-11-02 07:45:45,812 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5915e+00
[rank0]:2025-11-02 07:45:45,813 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6797e+00
[rank2]:2025-11-02 07:45:45,806 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8549e+00
[rank0]:2025-11-02 07:46:03,944 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:46:05,819 - INFO - Avg. fwd time: 15.6736 / Avg. bwd time: 32.2775 / Avg. batch time: 398.9911 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-11-02 07:46:05,859 - INFO - Avg. fwd time: 14.4264 / Avg. bwd time: 25.0292 / Avg. batch time: 440.2503 (ms) / GPU bubble ratio: 28.30%
[rank1]:2025-11-02 07:46:05,887 - INFO - Avg. fwd time: 16.2138 / Avg. bwd time: 30.7496 / Avg. batch time: 496.5195 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-11-02 07:46:05,904 - INFO - Avg. fwd time: 14.3146 / Avg. bwd time: 31.1118 / Avg. batch time: 551.6749 (ms) / GPU bubble ratio: 34.13%
[rank0]:2025-11-02 07:46:05,981 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1512e+00
[rank0]:2025-11-02 07:46:05,981 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1348  memory: 73.46GiB(52.54%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank2]:2025-11-02 07:46:05,973 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2365e+00
[rank2]:2025-11-02 07:46:05,974 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1348  memory: 64.04GiB(45.81%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank1]:2025-11-02 07:46:05,973 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1503e+00
[rank1]:2025-11-02 07:46:05,974 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1348  memory: 71.10GiB(50.85%)  tps: 8,113  tflops: 378.39  mfu: 38.26%
[rank3]:2025-11-02 07:46:05,977 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8199e+00
[rank3]:2025-11-02 07:46:05,980 - INFO -  step: 2750  loss:  0.2838  grad_norm:  0.1348  memory: 79.24GiB(56.67%)  tps: 8,113  tflops: 378.38  mfu: 38.26%
[rank3]:2025-11-02 07:46:26,071 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8658e+00
[rank0]:2025-11-02 07:46:26,072 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.5449e+00
[rank2]:2025-11-02 07:46:26,064 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.2342e+00
[rank1]:2025-11-02 07:46:26,071 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.8155e+00
[rank3]:2025-11-02 07:46:46,272 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.3084e-01
[rank0]:2025-11-02 07:46:46,275 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.7476e-01
[rank2]:2025-11-02 07:46:46,268 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1747e+00
[rank1]:2025-11-02 07:46:46,268 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5836e+00
[rank3]:2025-11-02 07:47:06,302 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0529e-01
[rank0]:2025-11-02 07:47:06,302 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3204e+00
[rank2]:2025-11-02 07:47:06,295 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.1159e+00
[rank1]:2025-11-02 07:47:06,302 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0390e+00
[rank1]:2025-11-02 07:47:26,499 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.0681e-01
[rank3]:2025-11-02 07:47:26,502 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.3588e-01
[rank0]:2025-11-02 07:47:26,506 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.0215e-02
[rank2]:2025-11-02 07:47:26,499 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3329e-01
[rank0]:2025-11-02 07:47:44,553 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:47:46,416 - INFO - Avg. fwd time: 15.6865 / Avg. bwd time: 32.1947 / Avg. batch time: 398.4304 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-11-02 07:47:46,453 - INFO - Avg. fwd time: 14.4379 / Avg. bwd time: 24.9338 / Avg. batch time: 439.5879 (ms) / GPU bubble ratio: 28.35%
[rank1]:2025-11-02 07:47:46,488 - INFO - Avg. fwd time: 16.2270 / Avg. bwd time: 30.6370 / Avg. batch time: 495.6022 (ms) / GPU bubble ratio: 24.35%
[rank0]:2025-11-02 07:47:46,499 - INFO - Avg. fwd time: 14.3347 / Avg. bwd time: 30.9350 / Avg. batch time: 550.4380 (ms) / GPU bubble ratio: 34.21%
[rank0]:2025-11-02 07:47:46,573 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 5.9354e-01
[rank0]:2025-11-02 07:47:46,574 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1508  memory: 73.46GiB(52.54%)  tps: 8,144  tflops: 379.83  mfu: 38.41%
[rank0]:2025-11-02 07:47:46,574 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 07:47:46,566 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0072e-01
[rank2]:2025-11-02 07:47:46,567 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1508  memory: 64.04GiB(45.81%)  tps: 8,144  tflops: 379.83  mfu: 38.40%
[rank2]:2025-11-02 07:47:46,567 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 07:47:46,573 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.1562e-01
[rank1]:2025-11-02 07:47:46,573 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1508  memory: 71.10GiB(50.85%)  tps: 8,143  tflops: 379.80  mfu: 38.40%
[rank1]:2025-11-02 07:47:46,573 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-02 07:47:46,573 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1917e-01
[rank3]:2025-11-02 07:47:46,576 - INFO -  step: 2800  loss:  0.2851  grad_norm:  0.1508  memory: 79.24GiB(56.67%)  tps: 8,144  tflops: 379.82  mfu: 38.40%
[rank3]:2025-11-02 07:47:46,576 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 07:48:02,770 - INFO - validate step: 2800  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,290
[rank1]:2025-11-02 07:48:02,806 - INFO - validate step: 2800  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,234
[rank3]:2025-11-02 07:48:02,857 - INFO - validate step: 2800  loss:  0.2438  memory: 79.24GiB(56.67%)  tps: 25,159
[rank2]:2025-11-02 07:48:02,832 - INFO - validate step: 2800  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,183
[rank0]:2025-11-02 07:48:02,932 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0748_stage0_step2800.svg
[rank2]:2025-11-02 07:48:02,931 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0748_stage2_step2800.svg
[rank1]:2025-11-02 07:48:02,940 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0748_stage1_step2800.svg
[rank3]:2025-11-02 07:48:03,035 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0748_real_step2800_rank3.svg
[rank3]:> Batch Time: 470.49 ms, GPU Bubble Ratio: 38.84%, 27.74%, 42.42%, 24.87%
[rank3]:2025-11-02 07:48:03,099 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0748_stage3_step2800.svg
[rank3]:2025-11-02 07:48:23,287 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1197e-01
[rank0]:2025-11-02 07:48:23,291 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2539e-01
[rank2]:2025-11-02 07:48:23,283 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3952e+00
[rank1]:2025-11-02 07:48:23,283 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.9435e-01
[rank3]:2025-11-02 07:48:43,465 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5344e-01
[rank0]:2025-11-02 07:48:43,466 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7583e+00
[rank2]:2025-11-02 07:48:43,459 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1005e+00
[rank1]:2025-11-02 07:48:43,465 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6757e+00
[rank1]:2025-11-02 07:49:03,661 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.3633e-01
[rank3]:2025-11-02 07:49:03,664 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.9863e-01
[rank0]:2025-11-02 07:49:03,668 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0727e-01
[rank2]:2025-11-02 07:49:03,661 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2312e-01
[rank1]:2025-11-02 07:49:23,791 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.7528e-01
[rank3]:2025-11-02 07:49:23,791 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0956e-01
[rank0]:2025-11-02 07:49:23,792 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.4252e-01
[rank2]:2025-11-02 07:49:23,785 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9336e-01
[rank0]:2025-11-02 07:49:41,934 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:49:43,909 - INFO - Avg. fwd time: 15.6994 / Avg. bwd time: 32.1153 / Avg. batch time: 397.8979 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-11-02 07:49:43,946 - INFO - Avg. fwd time: 14.4490 / Avg. bwd time: 24.8468 / Avg. batch time: 438.9751 (ms) / GPU bubble ratio: 28.39%
[rank1]:2025-11-02 07:49:43,985 - INFO - Avg. fwd time: 16.2408 / Avg. bwd time: 30.5238 / Avg. batch time: 494.7411 (ms) / GPU bubble ratio: 24.38%
[rank3]:2025-11-02 07:49:44,040 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5056e+00
[rank3]:2025-11-02 07:49:44,044 - INFO -  step: 2850  loss:  0.3959  grad_norm:  0.1635  memory: 79.24GiB(56.67%)  tps: 8,096  tflops: 377.60  mfu: 38.18%
[rank0]:2025-11-02 07:49:44,026 - INFO - Avg. fwd time: 14.3542 / Avg. bwd time: 30.7693 / Avg. batch time: 549.2762 (ms) / GPU bubble ratio: 34.28%
[rank0]:2025-11-02 07:49:44,044 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1000e+00
[rank0]:2025-11-02 07:49:44,044 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1635  memory: 73.46GiB(52.54%)  tps: 8,089  tflops: 377.27  mfu: 38.15%
[rank2]:2025-11-02 07:49:44,037 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.1435e-01
[rank2]:2025-11-02 07:49:44,037 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1635  memory: 64.04GiB(45.81%)  tps: 8,094  tflops: 377.53  mfu: 38.17%
[rank1]:2025-11-02 07:49:44,037 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.4039e-01
[rank1]:2025-11-02 07:49:44,037 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1635  memory: 71.10GiB(50.85%)  tps: 8,092  tflops: 377.43  mfu: 38.16%
[rank0]:2025-11-02 07:50:04,087 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.2858e+00
[rank2]:2025-11-02 07:50:04,080 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.0530e-01
[rank1]:2025-11-02 07:50:04,086 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.6182e-01
[rank3]:2025-11-02 07:50:04,086 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.7662e-01
[rank0]:2025-11-02 07:50:24,298 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0889e-01
[rank2]:2025-11-02 07:50:24,290 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.7524e-01
[rank1]:2025-11-02 07:50:24,290 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.2043e+00
[rank3]:2025-11-02 07:50:24,294 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3057e+00
[rank1]:2025-11-02 07:50:44,339 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.6405e+00
[rank3]:2025-11-02 07:50:44,339 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1304e+00
[rank2]:2025-11-02 07:50:44,332 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6368e-01
[rank0]:2025-11-02 07:50:44,339 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1454e+00
[rank1]:2025-11-02 07:51:04,545 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3993e+00
[rank3]:2025-11-02 07:51:04,548 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0306e+00
[rank2]:2025-11-02 07:51:04,545 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0147e-01
[rank0]:2025-11-02 07:51:04,552 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.6542e-01
[rank0]:2025-11-02 07:51:22,634 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:51:24,488 - INFO - Avg. fwd time: 15.7097 / Avg. bwd time: 32.0495 / Avg. batch time: 397.4526 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-11-02 07:51:24,524 - INFO - Avg. fwd time: 14.4585 / Avg. bwd time: 24.7694 / Avg. batch time: 438.4480 (ms) / GPU bubble ratio: 28.42%
[rank1]:2025-11-02 07:51:24,559 - INFO - Avg. fwd time: 16.2513 / Avg. bwd time: 30.4353 / Avg. batch time: 494.0124 (ms) / GPU bubble ratio: 24.40%
[rank2]:2025-11-02 07:51:24,638 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.7327e-01
[rank2]:2025-11-02 07:51:24,638 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1622  memory: 64.04GiB(45.81%)  tps: 8,143  tflops: 379.79  mfu: 38.40%
[rank0]:2025-11-02 07:51:24,570 - INFO - Avg. fwd time: 14.3704 / Avg. bwd time: 30.6270 / Avg. batch time: 548.2918 (ms) / GPU bubble ratio: 34.35%
[rank0]:2025-11-02 07:51:24,645 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.4488e-01
[rank0]:2025-11-02 07:51:24,645 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1622  memory: 73.46GiB(52.54%)  tps: 8,143  tflops: 379.79  mfu: 38.40%
[rank1]:2025-11-02 07:51:24,644 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7180e-01
[rank1]:2025-11-02 07:51:24,644 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1622  memory: 71.10GiB(50.85%)  tps: 8,143  tflops: 379.77  mfu: 38.40%
[rank3]:2025-11-02 07:51:24,644 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.4647e-01
[rank3]:2025-11-02 07:51:24,648 - INFO -  step: 2900  loss:  0.3759  grad_norm:  0.1622  memory: 79.24GiB(56.67%)  tps: 8,143  tflops: 379.79  mfu: 38.40%
[rank2]:2025-11-02 07:51:24,720 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0751_stage2_step2900.svg
[rank0]:2025-11-02 07:51:24,719 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0751_stage0_step2900.svg
[rank1]:2025-11-02 07:51:24,729 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0751_stage1_step2900.svg
[rank3]:2025-11-02 07:51:24,823 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0751_real_step2900_rank3.svg
[rank3]:> Batch Time: 473.94 ms, GPU Bubble Ratio: 35.74%, 31.67%, 39.08%, 25.23%
[rank3]:2025-11-02 07:51:24,892 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0751_stage3_step2900.svg
[rank1]:2025-11-02 07:51:45,019 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.8156e-01
[rank3]:2025-11-02 07:51:45,023 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0487e+00
[rank2]:2025-11-02 07:51:45,019 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8535e-01
[rank0]:2025-11-02 07:51:45,026 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3591e-01
[rank2]:2025-11-02 07:52:05,088 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.2233e-01
[rank1]:2025-11-02 07:52:05,094 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.1448e-01
[rank3]:2025-11-02 07:52:05,094 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2502e-01
[rank0]:2025-11-02 07:52:05,095 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.5420e-01
[rank2]:2025-11-02 07:52:25,287 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.5266e-01
[rank0]:2025-11-02 07:52:25,294 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0988e-01
[rank1]:2025-11-02 07:52:25,287 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.0277e-01
[rank3]:2025-11-02 07:52:25,290 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0554e-01
[rank1]:2025-11-02 07:52:45,369 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2932e-01
[rank3]:2025-11-02 07:52:45,369 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4601e-01
[rank2]:2025-11-02 07:52:45,363 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0777e+00
[rank0]:2025-11-02 07:52:45,370 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.5180e-01
[rank0]:2025-11-02 07:53:03,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:53:05,428 - INFO - Avg. fwd time: 15.7219 / Avg. bwd time: 31.9757 / Avg. batch time: 396.9585 (ms) / GPU bubble ratio: 3.87%
[rank2]:2025-11-02 07:53:05,470 - INFO - Avg. fwd time: 14.4691 / Avg. bwd time: 24.6858 / Avg. batch time: 437.8751 (ms) / GPU bubble ratio: 28.46%
[rank0]:2025-11-02 07:53:05,516 - INFO - Avg. fwd time: 14.3888 / Avg. bwd time: 30.4700 / Avg. batch time: 547.2013 (ms) / GPU bubble ratio: 34.42%
[rank1]:2025-11-02 07:53:05,498 - INFO - Avg. fwd time: 16.2639 / Avg. bwd time: 30.3316 / Avg. batch time: 493.2079 (ms) / GPU bubble ratio: 24.42%
[rank1]:2025-11-02 07:53:05,585 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.4934e+00
[rank1]:2025-11-02 07:53:05,586 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2128  memory: 71.10GiB(50.85%)  tps: 8,116  tflops: 378.51  mfu: 38.27%
[rank3]:2025-11-02 07:53:05,589 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.0317e+00
[rank3]:2025-11-02 07:53:05,592 - INFO -  step: 2950  loss:  0.4260  grad_norm:  0.2128  memory: 79.24GiB(56.67%)  tps: 8,115  tflops: 378.51  mfu: 38.27%
[rank2]:2025-11-02 07:53:05,585 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.4039e+00
[rank2]:2025-11-02 07:53:05,586 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2128  memory: 64.04GiB(45.81%)  tps: 8,115  tflops: 378.49  mfu: 38.27%
[rank0]:2025-11-02 07:53:05,592 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9360e+00
[rank0]:2025-11-02 07:53:05,593 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.2128  memory: 73.46GiB(52.54%)  tps: 8,115  tflops: 378.49  mfu: 38.27%
[rank3]:2025-11-02 07:53:25,631 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2869e+00
[rank2]:2025-11-02 07:53:25,624 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.1427e+00
[rank0]:2025-11-02 07:53:25,631 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.8289e+00
[rank1]:2025-11-02 07:53:25,630 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.3234e+00
[rank1]:2025-11-02 07:53:45,807 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6526e-01
[rank3]:2025-11-02 07:53:45,810 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2616e-01
[rank0]:2025-11-02 07:53:45,814 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5084e-01
[rank2]:2025-11-02 07:53:45,807 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3535e-01
[rank1]:2025-11-02 07:54:05,923 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1496e+00
[rank3]:2025-11-02 07:54:05,923 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1409e+00
[rank0]:2025-11-02 07:54:05,923 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7313e+00
[rank2]:2025-11-02 07:54:05,916 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5768e+00
[rank2]:2025-11-02 07:54:26,083 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6024e+00
[rank0]:2025-11-02 07:54:26,090 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1146e+00
[rank1]:2025-11-02 07:54:26,083 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.1040e+00
[rank3]:2025-11-02 07:54:26,087 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3314e+00
[rank0]:2025-11-02 07:54:44,180 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:54:46,110 - INFO - Avg. fwd time: 15.7331 / Avg. bwd time: 31.9043 / Avg. batch time: 396.4764 (ms) / GPU bubble ratio: 3.88%
[rank2]:2025-11-02 07:54:46,144 - INFO - Avg. fwd time: 14.4794 / Avg. bwd time: 24.6008 / Avg. batch time: 437.3037 (ms) / GPU bubble ratio: 28.51%
[rank1]:2025-11-02 07:54:46,186 - INFO - Avg. fwd time: 16.2752 / Avg. bwd time: 30.2362 / Avg. batch time: 492.4197 (ms) / GPU bubble ratio: 24.44%
[rank1]:2025-11-02 07:54:46,236 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4449e+00
[rank1]:2025-11-02 07:54:46,236 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1587  memory: 71.10GiB(50.85%)  tps: 8,139  tflops: 379.61  mfu: 38.38%
[rank1]:2025-11-02 07:54:46,236 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1587  tps: 7,305  tflops: 340.69  mfu: 33.77%
[rank1]:2025-11-02 07:54:46,237 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 07:54:46,236 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3767e+00
[rank3]:2025-11-02 07:54:46,240 - INFO -  step: 3000  loss:  0.3450  grad_norm:  0.1587  memory: 79.24GiB(56.67%)  tps: 8,139  tflops: 379.62  mfu: 38.38%
[rank3]:2025-11-02 07:54:46,240 - INFO -  final step: 3000  loss:  0.3450  grad_norm:  0.1587  tps: 7,307  tflops: 340.81  mfu: 33.78%
[rank3]:2025-11-02 07:54:46,241 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-02 07:54:46,230 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4651e+00
[rank2]:2025-11-02 07:54:46,230 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1587  memory: 64.04GiB(45.81%)  tps: 8,140  tflops: 379.63  mfu: 38.39%
[rank2]:2025-11-02 07:54:46,230 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1587  tps: 7,305  tflops: 340.72  mfu: 33.78%
[rank2]:2025-11-02 07:54:46,230 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 07:54:46,223 - INFO - Avg. fwd time: 14.4065 / Avg. bwd time: 30.3145 / Avg. batch time: 546.1346 (ms) / GPU bubble ratio: 34.49%
[rank0]:2025-11-02 07:54:46,237 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.6827e+00
[rank0]:2025-11-02 07:54:46,237 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1587  memory: 73.46GiB(52.54%)  tps: 8,140  tflops: 379.63  mfu: 38.39%
[rank0]:2025-11-02 07:54:46,237 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1587  tps: 7,304  tflops: 340.68  mfu: 33.77%
[rank0]:2025-11-02 07:54:46,237 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 07:55:02,389 - INFO - validate step: 3000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,360
[rank0]:2025-11-02 07:55:02,390 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 07:55:02,394 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-02 07:55:02,424 - INFO - validate step: 3000  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,304
[rank1]:2025-11-02 07:55:02,425 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 07:55:02,428 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 07:55:02,472 - INFO - validate step: 3000  loss:  0.2456  memory: 79.24GiB(56.67%)  tps: 25,236
[rank3]:2025-11-02 07:55:02,473 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 07:55:02,476 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 07:55:02,449 - INFO - validate step: 3000  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,254
[rank2]:2025-11-02 07:55:02,450 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 07:55:02,453 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 07:55:11,739 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank2/251102_0755_stage2_final3000.svg
[rank0]:2025-11-02 07:55:11,640 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-02 07:55:11,733 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank0/251102_0755_stage0_final3000.svg
[rank1]:2025-11-02 07:55:11,749 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank1/251102_0755_stage1_final3000.svg
[rank3]:2025-11-02 07:55:11,864 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0755_real_final3000_rank3.svg
[rank3]:> Batch Time: 500.96 ms, GPU Bubble Ratio: 30.57%, 25.23%, 42.36%, 29.33%
[rank2]:2025-11-02 07:55:12,010 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/frozen_params_histogram/251102_0755_rank2_stage2.svg
[rank2]:	> Counts Sum: 12744, Total Sum: 18360 (69.41%), Ratio(%) per element: [98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 97.25, 71.37, 71.37, 71.37, 71.37, 71.37, 71.37, 71.37, 71.37, 71.37, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 22.74, 22.74, 22.74, 22.74, 22.74, 22.74, 22.74, 22.74, 22.74, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-11-02 07:55:12,011 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 07:55:11,971 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/frozen_params_histogram/251102_0755_rank0_stage0.svg
[rank0]:	> Counts Sum: 8469, Total Sum: 18615 (45.50%), Ratio(%) per element: [0.0, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 70.19, 59.21, 59.21, 59.21, 59.21, 59.21, 59.21, 59.21, 59.21, 59.21, 32.54, 32.54, 32.54, 32.54, 32.54, 32.54, 32.54, 32.54, 32.54, 30.58, 30.58, 30.58, 30.58, 30.58, 30.58, 30.58, 30.58, 30.58, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-11-02 07:55:11,971 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-02 07:55:12,033 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/frozen_params_histogram/251102_0755_rank1_stage1.svg
[rank1]:	> Counts Sum: 11808, Total Sum: 20655 (57.17%), Ratio(%) per element: [97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 96.86, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 57.64, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 9.41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-11-02 07:55:12,033 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 07:55:12,063 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/pipeline_schedule/251102_0755_thry_final3000_rank3.svg
[rank3]:> Batch Time: 507.48 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 07:55:12,140 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/freeze_ratio_history/rank3/251102_0755_stage3_final3000.svg
[rank3]:2025-11-02 07:55:12,369 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200/frozen_params_histogram/251102_0755_rank3_stage3.svg
[rank3]:	> Counts Sum: 11718, Total Sum: 16575 (70.70%), Ratio(%) per element: [98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 98.03, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 97.64, 88.23, 88.23, 88.23, 88.23, 88.23, 88.23, 88.23, 88.23, 88.23, 85.88, 85.88, 85.88, 85.88, 85.88, 85.88, 85.88, 85.88, 85.88, 78.82, 78.82, 78.82, 78.82, 78.82, 78.82, 78.82, 78.82, 78.82, 61.96, 61.96, 61.96, 61.96, 61.96, 61.96, 61.96, 61.96, 61.96, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-11-02 07:55:12,369 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.24214
[rank3]:wandb:               final/avg_loss 0.345
[rank3]:wandb:             final/avg_mfu(%) 33.7842
[rank3]:wandb:             final/avg_tflops 340.81401
[rank3]:wandb:    final/avg_throughput(tps) 7307.3078
[rank3]:wandb:              final/grad_norm 0.15875
[rank3]:wandb:               final/max_loss 0.345
[rank3]:wandb:                    grad_norm 0.15875
[rank3]:wandb: loss_metrics/global_avg_loss 0.345
[rank3]:wandb: loss_metrics/global_max_loss 0.345
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_GPipe_auto_h200 at: https://wandb.ai/orangingq/torchtitan/runs/617xpgjr
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_GPipe_auto_h200/20251102-0556/wandb/run-20251102_055700-617xpgjr/logs
[rank0]:2025-11-02 07:55:13,971 - INFO - Training completed
[rank0]:2025-11-02 07:55:13,971 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 07:55:14,172 - INFO - Process group destroyed
[rank3]:2025-11-02 07:55:14,167 - INFO - Process group destroyed
[rank2]:2025-11-02 07:55:14,190 - INFO - Process group destroyed
[rank0]:2025-11-02 07:55:14,367 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.11', 'layers.14', 'layers.16', 'layers.9', 'layers.8', 'layers.13', 'layers.12', 'layers.15'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.22', 'layers.21', 'layers.17', 'layers.24', 'layers.23', 'layers.20', 'layers.18'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.5', 'layers.7', 'tok_embeddings', 'layers.1', 'layers.2', 'layers.0', 'layers.3', 'layers.4'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.31', 'norm', 'layers.26', 'output', 'layers.25', 'layers.27', 'layers.30', 'layers.28'}
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_GPipe_auto_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_GPipe_auto_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_GPipe_auto_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_auto_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_auto_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_GPipe_auto_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_auto_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_GPipe_auto_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
