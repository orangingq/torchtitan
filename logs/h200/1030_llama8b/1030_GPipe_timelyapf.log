
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Thu Oct 30 18:57:22 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1030_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1030 18:57:23.576000 3333409 site-packages/torch/distributed/run.py:811] 
W1030 18:57:23.576000 3333409 site-packages/torch/distributed/run.py:811] *****************************************
W1030 18:57:23.576000 3333409 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1030 18:57:23.576000 3333409 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-30 18:57:30,512 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-30 18:57:30,771 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-30 18:57:30,901 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-30 18:57:30,925 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-30 18:57:31,071 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-30 18:57:31,074 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-30 18:57:31,681 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-30 18:57:31,684 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 18:57:31,721 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-30 18:57:31,723 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 18:57:31,728 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-30 18:57:31,722 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-30 18:57:31,725 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 18:57:33,723 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-30 18:57:34,025 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-30 18:57:35,566 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-30 18:57:36,921 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-30 18:57:37,201 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-30 18:57:37,193 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-30 18:57:37,202 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-30 18:57:37,275 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-30 18:57:37,299 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-30 18:57:37,299 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-30 18:57:37,315 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-30 18:57:37,315 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-30 18:57:37,316 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-30 18:57:37,316 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-30 18:57:37,671 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-30 18:57:37,672 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-10-30 18:57:37,666 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-30 18:57:37,667 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-30 18:57:37,668 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-30 18:57:37,669 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run kips0cld
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_GPipe_timelyapf_dm1/20251030-1857/wandb/run-20251030_185738-kips0cld
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_GPipe_timelyapf_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/kips0cld
[rank3]:2025-10-30 18:57:39,203 - INFO - WandB logging enabled
[rank3]:2025-10-30 18:57:39,215 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-30 18:57:39,290 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-30 18:57:39,290 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-30 18:57:39,514 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-30 18:57:39,515 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-30 18:57:39,526 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-30 18:57:39,526 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 18:57:39,536 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_GPipe_timelyapf_dm1
[rank0]:2025-10-30 18:57:39,536 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 18:57:39,536 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-30 18:57:39,526 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 18:57:42,850 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 300)
[rank0]:2025-10-30 18:57:42,850 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-30 18:57:52,562 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-30 18:57:52,562 - INFO - Finished loading the checkpoint in 9.71 seconds.
[rank0]:2025-10-30 18:57:52,562 - INFO - Training starts at step 1
[rank3]:2025-10-30 18:57:56,908 - INFO -  step:  1  loss: 18.6142  grad_norm: 268.4282  memory: 58.03GiB(41.50%)  tps: 929  tflops: 43.33  mfu: 4.38%
[rank3]:2025-10-30 18:57:56,909 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 18:57:56,899 - INFO -  step:  1  loss: -4.0000  grad_norm: 268.4282  memory: 44.28GiB(31.67%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank2]:2025-10-30 18:57:56,900 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-30 18:57:56,923 - INFO -  step:  1  loss: -4.0000  grad_norm: 268.4282  memory: 49.75GiB(35.58%)  tps: 834  tflops: 38.89  mfu: 3.93%
[rank0]:2025-10-30 18:57:56,923 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-30 18:57:56,901 - INFO -  step:  1  loss: -4.0000  grad_norm: 268.4282  memory: 49.69GiB(35.54%)  tps: 836  tflops: 38.97  mfu: 3.94%
[rank1]:2025-10-30 18:57:56,901 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 18:58:14,690 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,691 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,691 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,691 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,691 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,691 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,692 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,692 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,692 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,692 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,692 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,693 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,693 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,693 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,693 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 18:58:14,693 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,645 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,647 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,648 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,648 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,648 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,649 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,649 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,649 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,650 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,650 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,650 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,651 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,651 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,651 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 18:58:14,652 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,735 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,736 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,736 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,736 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,736 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,737 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,738 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,738 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,738 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,738 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 18:58:14,738 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,778 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,778 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,778 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,779 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,780 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 18:58:14,781 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 19:00:02,943 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:00:05,586 - INFO -  step: 50  loss: -4.0000  grad_norm: 878.3508  memory: 57.29GiB(40.97%)  tps: 6,239  tflops: 290.97  mfu: 29.42%
[rank3]:2025-10-30 19:00:05,591 - INFO -  step: 50  loss:  9.9672  grad_norm: 878.3508  memory: 73.38GiB(52.48%)  tps: 6,239  tflops: 290.98  mfu: 29.42%
[rank0]:2025-10-30 19:00:05,592 - INFO -  step: 50  loss: -4.0000  grad_norm: 878.3508  memory: 66.72GiB(47.72%)  tps: 6,239  tflops: 291.01  mfu: 29.42%
[rank1]:2025-10-30 19:00:05,588 - INFO -  step: 50  loss: -4.0000  grad_norm: 878.3508  memory: 64.32GiB(46.00%)  tps: 6,239  tflops: 290.97  mfu: 29.42%
[rank3]:2025-10-30 19:00:06,032 - INFO - Avg. fwd time: 14.1773 / Avg. bwd time: 42.3966 / Avg. batch time: 472.1772 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-10-30 19:00:06,081 - INFO - Avg. fwd time: 12.8413 / Avg. bwd time: 36.0892 / Avg. batch time: 524.3430 (ms) / GPU bubble ratio: 25.35%
[rank1]:2025-10-30 19:00:06,127 - INFO - Avg. fwd time: 14.6277 / Avg. bwd time: 40.5632 / Avg. batch time: 583.1911 (ms) / GPU bubble ratio: 24.29%
[rank0]:2025-10-30 19:00:06,159 - INFO - Avg. fwd time: 13.5210 / Avg. bwd time: 37.8932 / Avg. batch time: 638.0437 (ms) / GPU bubble ratio: 35.54%
[rank0]:2025-10-30 19:02:14,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 19:02:16,640 - INFO -  step: 100  loss:  3.6282  grad_norm: 29.4186  memory: 73.38GiB(52.48%)  tps: 6,251  tflops: 291.56  mfu: 29.48%
[rank3]:2025-10-30 19:02:16,641 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-30 19:02:16,635 - INFO -  step: 100  loss: -4.0000  grad_norm: 29.4186  memory: 57.29GiB(40.97%)  tps: 6,251  tflops: 291.55  mfu: 29.48%
[rank2]:2025-10-30 19:02:16,635 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-30 19:02:16,642 - INFO -  step: 100  loss: -4.0000  grad_norm: 29.4186  memory: 66.72GiB(47.72%)  tps: 6,251  tflops: 291.55  mfu: 29.48%
[rank0]:2025-10-30 19:02:16,642 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-30 19:02:16,638 - INFO -  step: 100  loss: -4.0000  grad_norm: 29.4186  memory: 64.32GiB(46.00%)  tps: 6,251  tflops: 291.55  mfu: 29.48%
[rank1]:2025-10-30 19:02:16,638 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-30 19:02:17,125 - INFO - Avg. fwd time: 12.8810 / Avg. bwd time: 36.1927 / Avg. batch time: 523.2814 (ms) / GPU bubble ratio: 24.98%
[rank3]:2025-10-30 19:02:17,075 - INFO - Avg. fwd time: 14.1996 / Avg. bwd time: 42.5344 / Avg. batch time: 471.1232 (ms) / GPU bubble ratio: 3.66%
[rank0]:2025-10-30 19:02:17,203 - INFO - Avg. fwd time: 13.4520 / Avg. bwd time: 38.0502 / Avg. batch time: 637.0530 (ms) / GPU bubble ratio: 35.32%
[rank1]:2025-10-30 19:02:17,171 - INFO - Avg. fwd time: 14.7045 / Avg. bwd time: 40.7595 / Avg. batch time: 582.1847 (ms) / GPU bubble ratio: 23.79%
[rank0]:2025-10-30 19:04:24,956 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 19:04:27,577 - INFO -  step: 150  loss: -4.0000  grad_norm: 307.6640  memory: 64.32GiB(46.00%)  tps: 6,256  tflops: 291.80  mfu: 29.50%
[rank0]:2025-10-30 19:04:27,581 - INFO -  step: 150  loss: -4.0000  grad_norm: 307.6640  memory: 66.72GiB(47.72%)  tps: 6,256  tflops: 291.80  mfu: 29.50%
[rank2]:2025-10-30 19:04:27,574 - INFO -  step: 150  loss: -4.0000  grad_norm: 307.6640  memory: 57.29GiB(40.97%)  tps: 6,256  tflops: 291.80  mfu: 29.50%
[rank3]:2025-10-30 19:04:27,579 - INFO -  step: 150  loss:  6.6431  grad_norm: 307.6640  memory: 73.38GiB(52.48%)  tps: 6,256  tflops: 291.80  mfu: 29.50%
[rank2]:2025-10-30 19:04:28,151 - INFO - Avg. fwd time: 12.8717 / Avg. bwd time: 36.2052 / Avg. batch time: 522.3144 (ms) / GPU bubble ratio: 24.83%
[rank3]:2025-10-30 19:04:28,110 - INFO - Avg. fwd time: 14.1639 / Avg. bwd time: 42.5417 / Avg. batch time: 470.1841 (ms) / GPU bubble ratio: 3.52%
[rank1]:2025-10-30 19:04:28,196 - INFO - Avg. fwd time: 14.7281 / Avg. bwd time: 40.8334 / Avg. batch time: 581.2621 (ms) / GPU bubble ratio: 23.53%
[rank0]:2025-10-30 19:04:28,239 - INFO - Avg. fwd time: 13.4344 / Avg. bwd time: 38.0977 / Avg. batch time: 636.1288 (ms) / GPU bubble ratio: 35.19%
[rank0]:2025-10-30 19:06:35,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 19:06:38,235 - INFO -  step: 200  loss:  2.5604  grad_norm: 20.3910  memory: 73.38GiB(52.48%)  tps: 6,270  tflops: 292.43  mfu: 29.57%
[rank3]:2025-10-30 19:06:38,235 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-30 19:06:38,230 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.3910  memory: 57.29GiB(40.97%)  tps: 6,270  tflops: 292.43  mfu: 29.57%
[rank2]:2025-10-30 19:06:38,230 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 19:06:38,237 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.3910  memory: 66.72GiB(47.72%)  tps: 6,270  tflops: 292.43  mfu: 29.57%
[rank0]:2025-10-30 19:06:38,237 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-30 19:06:38,233 - INFO -  step: 200  loss: -4.0000  grad_norm: 20.3910  memory: 64.32GiB(46.00%)  tps: 6,270  tflops: 292.43  mfu: 29.57%
[rank1]:2025-10-30 19:06:38,233 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-30 19:06:54,705 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,867
[rank1]:2025-10-30 19:06:54,706 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-30 19:06:54,675 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,918
[rank0]:2025-10-30 19:06:54,676 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 19:06:54,734 - INFO - validate step: 200  loss:  0.8411  memory: 73.38GiB(52.48%)  tps: 24,827
[rank3]:2025-10-30 19:06:54,735 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-30 19:06:54,718 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,843
[rank2]:2025-10-30 19:06:54,719 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 19:06:55,137 - INFO - Avg. fwd time: 14.1522 / Avg. bwd time: 42.5292 / Avg. batch time: 469.6868 (ms) / GPU bubble ratio: 3.46%
[rank2]:2025-10-30 19:06:55,186 - INFO - Avg. fwd time: 12.8713 / Avg. bwd time: 36.1849 / Avg. batch time: 521.7712 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-10-30 19:06:55,265 - INFO - Avg. fwd time: 13.4224 / Avg. bwd time: 38.0888 / Avg. batch time: 635.5325 (ms) / GPU bubble ratio: 35.16%
[rank1]:2025-10-30 19:06:55,232 - INFO - Avg. fwd time: 14.7335 / Avg. bwd time: 40.8349 / Avg. batch time: 580.6980 (ms) / GPU bubble ratio: 23.45%
[rank0]:2025-10-30 19:09:02,789 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 19:09:05,410 - INFO -  step: 250  loss: -4.0000  grad_norm: 38.4215  memory: 64.32GiB(46.00%)  tps: 6,268  tflops: 292.32  mfu: 29.56%
[rank0]:2025-10-30 19:09:05,414 - INFO -  step: 250  loss: -4.0000  grad_norm: 38.4215  memory: 66.72GiB(47.72%)  tps: 6,266  tflops: 292.24  mfu: 29.55%
[rank3]:2025-10-30 19:09:05,412 - INFO -  step: 250  loss:  2.3653  grad_norm: 38.4215  memory: 73.38GiB(52.48%)  tps: 6,269  tflops: 292.38  mfu: 29.56%
[rank2]:2025-10-30 19:09:05,407 - INFO -  step: 250  loss: -4.0000  grad_norm: 38.4215  memory: 57.29GiB(40.97%)  tps: 6,268  tflops: 292.36  mfu: 29.56%
[rank3]:2025-10-30 19:09:05,852 - INFO - Avg. fwd time: 14.1408 / Avg. bwd time: 42.5199 / Avg. batch time: 469.3056 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-30 19:09:05,902 - INFO - Avg. fwd time: 12.8704 / Avg. bwd time: 36.1671 / Avg. batch time: 521.3646 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-10-30 19:09:05,948 - INFO - Avg. fwd time: 14.7382 / Avg. bwd time: 40.8402 / Avg. batch time: 580.2829 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-30 19:09:05,980 - INFO - Avg. fwd time: 13.4152 / Avg. bwd time: 38.0856 / Avg. batch time: 635.1161 (ms) / GPU bubble ratio: 35.13%
[rank3]:2025-10-30 19:09:31,328 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-30 19:09:58,701 - INFO - [Step 270] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-30 19:09:58,915 - INFO - [Step 270] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-30 19:09:59,005 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:09:59,021 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:09:59,040 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:04,928 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:04,963 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:04,994 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,009 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:04,953 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:04,984 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,016 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,041 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,083 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,117 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,122 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:10:05,188 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,130 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,165 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,156 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,192 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,229 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,153 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,190 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:05,228 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:10:05,223 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:10:05,260 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,202 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,239 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,277 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-30 19:10:05,267 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:10:05,297 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-30 19:10:05,335 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-30 19:10:05,314 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-30 19:10:20,880 - INFO - [Step 280] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-30 19:10:21,201 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1910_max_batch_time.svg
[rank3]:> Batch Time: 616.16 ms, GPU Bubble Ratio: 33.10%, 27.71%, 36.39%, 26.54%
[rank3]:2025-10-30 19:10:21,382 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1910_min_batch_time.svg
[rank3]:> Batch Time: 348.01 ms, GPU Bubble Ratio: 69.45%, 24.69%, 33.85%, 23.58%
[rank3]:2025-10-30 19:10:21,593 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1910_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 366.55 ms, GPU Bubble Ratio: 30.29%, 21.93%, 26.46%, 22.39%
[rank3]:2025-10-30 19:10:21,594 - INFO - 	> Batch Time: 366.55 ms (Average Freeze Ratio: 0.76, Time Reduction Rate: 0.41)
[rank0]:2025-10-30 19:11:12,621 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:11:14,975 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.00/0.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.16/0.48, [MB6] 0.30/0.89, [MB7] 0.33/1.00
[rank2]:2025-10-30 19:11:14,975 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8810  memory: 64.67GiB(46.25%)  tps: 6,323  tflops: 294.89  mfu: 29.82%
[rank1]:2025-10-30 19:11:14,976 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.04/0.11, [MB2] 0.30/0.89, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-30 19:11:14,977 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8810  memory: 72.68GiB(51.98%)  tps: 6,323  tflops: 294.89  mfu: 29.82%
[rank0]:2025-10-30 19:11:14,979 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.03/0.08, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-10-30 19:11:14,980 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.8810  memory: 69.02GiB(49.37%)  tps: 6,323  tflops: 294.89  mfu: 29.82%
[rank3]:2025-10-30 19:11:20,876 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.07/0.20
[rank3]:2025-10-30 19:11:20,882 - INFO -  step: 300  loss:  3.1269  grad_norm:  1.8810  memory: 83.98GiB(60.07%)  tps: 6,047  tflops: 282.04  mfu: 28.52%
[rank2]:2025-10-30 19:11:20,986 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1911_stage2_step300.svg
[rank1]:2025-10-30 19:11:20,967 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1911_stage1_step300.svg
[rank0]:2025-10-30 19:11:20,967 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1911_stage0_step300.svg
[rank3]:2025-10-30 19:11:21,067 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1911_real_step300_rank3.svg
[rank3]:> Batch Time: 617.91 ms, GPU Bubble Ratio: 33.16%, 27.81%, 36.32%, 26.51%
[rank3]:2025-10-30 19:11:21,133 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1911_stage3_step300.svg
[rank3]:2025-10-30 19:11:21,566 - INFO - Avg. fwd time: 14.2726 / Avg. bwd time: 41.0090 / Avg. batch time: 458.2833 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-10-30 19:11:21,640 - INFO - Avg. fwd time: 14.9288 / Avg. bwd time: 39.0880 / Avg. batch time: 582.5470 (ms) / GPU bubble ratio: 25.82%
[rank2]:2025-10-30 19:11:21,602 - INFO - Avg. fwd time: 13.0309 / Avg. bwd time: 34.6377 / Avg. batch time: 525.3990 (ms) / GPU bubble ratio: 27.42%
[rank0]:2025-10-30 19:11:21,676 - INFO - Avg. fwd time: 13.5605 / Avg. bwd time: 35.3251 / Avg. batch time: 634.5601 (ms) / GPU bubble ratio: 38.37%
[rank0]:2025-10-30 19:13:33,206 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 19:13:35,347 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.06/0.08, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-10-30 19:13:35,348 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.9115  memory: 73.87GiB(52.83%)  tps: 5,836  tflops: 272.20  mfu: 27.52%
[rank1]:2025-10-30 19:13:35,351 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.07/0.11, [MB2] 0.59/0.89, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-30 19:13:35,352 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.9115  memory: 72.68GiB(51.98%)  tps: 5,836  tflops: 272.18  mfu: 27.52%
[rank2]:2025-10-30 19:13:35,352 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.32/0.48, [MB6] 0.59/0.89, [MB7] 0.67/1.00
[rank2]:2025-10-30 19:13:35,352 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.9115  memory: 64.67GiB(46.25%)  tps: 5,836  tflops: 272.18  mfu: 27.52%
[rank3]:2025-10-30 19:13:41,363 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.13/0.20
[rank3]:2025-10-30 19:13:41,368 - INFO -  step: 350  loss:  2.3199  grad_norm:  1.9115  memory: 83.98GiB(60.07%)  tps: 5,831  tflops: 271.97  mfu: 27.50%
[rank3]:2025-10-30 19:13:41,709 - INFO - Avg. fwd time: 14.3358 / Avg. bwd time: 40.0668 / Avg. batch time: 451.1374 (ms) / GPU bubble ratio: 3.53%
[rank0]:2025-10-30 19:13:41,775 - INFO - Avg. fwd time: 13.6690 / Avg. bwd time: 34.1875 / Avg. batch time: 639.3516 (ms) / GPU bubble ratio: 40.12%
[rank1]:2025-10-30 19:13:41,761 - INFO - Avg. fwd time: 15.0290 / Avg. bwd time: 37.8454 / Avg. batch time: 588.4618 (ms) / GPU bubble ratio: 28.12%
[rank2]:2025-10-30 19:13:41,728 - INFO - Avg. fwd time: 13.1264 / Avg. bwd time: 33.5898 / Avg. batch time: 532.4883 (ms) / GPU bubble ratio: 29.81%
[rank0]:2025-10-30 19:15:45,098 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 19:15:47,078 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.11/0.11, [MB2] 0.89/0.89, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:15:47,079 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2338  memory: 73.42GiB(52.51%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank1]:2025-10-30 19:15:47,079 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-30 19:15:47,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.08/0.08, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:15:47,080 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2338  memory: 73.87GiB(52.83%)  tps: 6,219  tflops: 290.04  mfu: 29.33%
[rank0]:2025-10-30 19:15:47,080 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-30 19:15:47,079 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:15:47,079 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2338  memory: 65.00GiB(46.49%)  tps: 6,219  tflops: 290.05  mfu: 29.33%
[rank2]:2025-10-30 19:15:47,079 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 19:15:52,879 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 19:15:52,891 - INFO -  step: 400  loss:  1.8635  grad_norm:  0.2338  memory: 83.98GiB(60.07%)  tps: 6,229  tflops: 290.51  mfu: 29.37%
[rank3]:2025-10-30 19:15:52,891 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-30 19:16:08,996 - INFO - validate step: 400  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,689
[rank1]:2025-10-30 19:16:09,032 - INFO - validate step: 400  loss: -1.0000  memory: 73.42GiB(52.51%)  tps: 18,658
[rank3]:2025-10-30 19:16:09,052 - INFO - validate step: 400  loss:  0.8542  memory: 83.98GiB(60.07%)  tps: 25,348
[rank2]:2025-10-30 19:16:09,048 - INFO - validate step: 400  loss: -1.0000  memory: 65.00GiB(46.49%)  tps: 18,646
[rank2]:2025-10-30 19:16:09,132 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1916_stage2_step400.svg
[rank1]:2025-10-30 19:16:09,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1916_stage1_step400.svg
[rank0]:2025-10-30 19:16:09,130 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1916_stage0_step400.svg
[rank3]:2025-10-30 19:16:09,242 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1916_real_step400_rank3.svg
[rank3]:> Batch Time: 616.78 ms, GPU Bubble Ratio: 33.07%, 27.74%, 36.28%, 26.47%
[rank3]:2025-10-30 19:16:09,312 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1916_stage3_step400.svg
[rank3]:2025-10-30 19:16:09,633 - INFO - Avg. fwd time: 14.4096 / Avg. bwd time: 38.9944 / Avg. batch time: 443.1524 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-10-30 19:16:09,633 - INFO - Avg. fwd time: 13.3150 / Avg. bwd time: 31.7934 / Avg. batch time: 537.1769 (ms) / GPU bubble ratio: 32.82%
[rank1]:2025-10-30 19:16:09,669 - INFO - Avg. fwd time: 15.2346 / Avg. bwd time: 35.7416 / Avg. batch time: 591.0298 (ms) / GPU bubble ratio: 31.00%
[rank0]:2025-10-30 19:16:09,656 - INFO - Avg. fwd time: 13.8425 / Avg. bwd time: 32.1725 / Avg. batch time: 639.8391 (ms) / GPU bubble ratio: 42.47%
[rank0]:2025-10-30 19:18:06,564 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 19:18:08,450 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.08/0.08, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:18:08,450 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,858  tflops: 319.85  mfu: 32.34%
[rank1]:2025-10-30 19:18:08,450 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.11/0.11, [MB2] 0.89/0.89, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:18:08,451 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,860  tflops: 319.95  mfu: 32.35%
[rank2]:2025-10-30 19:18:08,449 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.48/0.48, [MB6] 0.89/0.89, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:18:08,450 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,861  tflops: 319.99  mfu: 32.36%
[rank3]:2025-10-30 19:18:14,019 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 19:18:14,025 - INFO -  step: 450  loss:  2.5811  grad_norm:  0.8762  memory: 83.98GiB(60.07%)  tps: 6,555  tflops: 305.73  mfu: 30.91%
[rank3]:2025-10-30 19:18:14,410 - INFO - Avg. fwd time: 14.4788 / Avg. bwd time: 37.9997 / Avg. batch time: 436.0649 (ms) / GPU bubble ratio: 3.72%
[rank2]:2025-10-30 19:18:14,432 - INFO - Avg. fwd time: 13.5200 / Avg. bwd time: 29.9452 / Avg. batch time: 539.3647 (ms) / GPU bubble ratio: 35.53%
[rank0]:2025-10-30 19:18:14,460 - INFO - Avg. fwd time: 14.0181 / Avg. bwd time: 28.5064 / Avg. batch time: 636.0898 (ms) / GPU bubble ratio: 46.52%
[rank1]:2025-10-30 19:18:14,455 - INFO - Avg. fwd time: 15.4539 / Avg. bwd time: 33.6453 / Avg. batch time: 591.0346 (ms) / GPU bubble ratio: 33.54%
[rank0]:2025-10-30 19:20:07,704 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:20:09,742 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1920_rank2_trend_line.svg
[rank3]:2025-10-30 19:20:09,734 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1920_rank3_trend_line.svg
[rank1]:2025-10-30 19:20:09,764 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1920_rank1_trend_line.svg
[rank1]:2025-10-30 19:20:09,771 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.02/0.02, [MB1] 0.02/0.02, [MB2] 0.02/0.02, [MB3] 0.02/0.02, [MB4] 0.02/0.02, [MB5] 0.02/0.02, [MB6] 0.35/0.35, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:20:09,773 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.02/0.02, [MB1] 0.02/0.02, [MB2] 0.02/0.02, [MB3] 0.02/0.02, [MB4] 0.02/0.02, [MB5] 0.02/0.02, [MB6] 0.35/0.35, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:20:09,774 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,752  tflops: 314.93  mfu: 31.84%
[rank0]:2025-10-30 19:20:09,756 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1920_rank0_trend_line.svg
[rank0]:2025-10-30 19:20:09,770 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:20:09,772 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:20:09,772 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,752  tflops: 314.93  mfu: 31.84%
[rank2]:2025-10-30 19:20:09,770 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:20:09,772 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:20:09,772 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,752  tflops: 314.93  mfu: 31.84%
[rank3]:2025-10-30 19:20:09,950 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1920_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 444.30 ms, GPU Bubble Ratio: 50.62%, 23.42%, 33.76%, 20.16%
[rank3]:2025-10-30 19:20:09,951 - INFO - 	> Batch Time: 444.30 ms (Average Freeze Ratio: 0.33)
[rank3]:2025-10-30 19:20:09,951 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank2]:2025-10-30 19:20:15,548 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1920_stage2_step500.svg
[rank3]:2025-10-30 19:20:15,475 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 19:20:15,480 - INFO -  step: 500  loss:  2.4173  grad_norm:  0.8986  memory: 83.98GiB(60.07%)  tps: 6,745  tflops: 314.59  mfu: 31.81%
[rank0]:2025-10-30 19:20:15,548 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1920_stage0_step500.svg
[rank1]:2025-10-30 19:20:15,549 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1920_stage1_step500.svg
[rank0]:2025-10-30 19:20:15,638 - INFO - Avg. fwd time: 14.1357 / Avg. bwd time: 25.9165 / Avg. batch time: 630.9945 (ms) / GPU bubble ratio: 49.22%
[rank3]:2025-10-30 19:20:15,666 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1920_real_step500_rank3.svg
[rank3]:> Batch Time: 611.23 ms, GPU Bubble Ratio: 33.42%, 27.97%, 36.49%, 26.68%
[rank3]:2025-10-30 19:20:15,729 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1920_stage3_step500.svg
[rank2]:2025-10-30 19:20:16,035 - INFO - Avg. fwd time: 13.6603 / Avg. bwd time: 28.6647 / Avg. batch time: 538.4325 (ms) / GPU bubble ratio: 37.11%
[rank3]:2025-10-30 19:20:16,038 - INFO - Avg. fwd time: 14.5371 / Avg. bwd time: 37.2310 / Avg. batch time: 430.5128 (ms) / GPU bubble ratio: 3.80%
[rank1]:2025-10-30 19:20:16,071 - INFO - Avg. fwd time: 15.6025 / Avg. bwd time: 32.1968 / Avg. batch time: 588.5924 (ms) / GPU bubble ratio: 35.03%
[rank0]:2025-10-30 19:22:10,719 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 19:22:12,615 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,669  tflops: 311.03  mfu: 31.45%
[rank1]:2025-10-30 19:22:12,616 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,669  tflops: 311.03  mfu: 31.45%
[rank2]:2025-10-30 19:22:12,614 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,669  tflops: 311.03  mfu: 31.45%
[rank0]:2025-10-30 19:22:12,707 - INFO - Avg. fwd time: 14.2497 / Avg. bwd time: 23.4328 / Avg. batch time: 625.1012 (ms) / GPU bubble ratio: 51.77%
[rank3]:2025-10-30 19:22:18,117 - INFO -  step: 550  loss:  2.5049  grad_norm:  0.1490  memory: 83.98GiB(60.07%)  tps: 6,680  tflops: 311.56  mfu: 31.50%
[rank2]:2025-10-30 19:22:18,434 - INFO - Avg. fwd time: 13.7953 / Avg. bwd time: 27.4370 / Avg. batch time: 536.5322 (ms) / GPU bubble ratio: 38.52%
[rank3]:2025-10-30 19:22:18,436 - INFO - Avg. fwd time: 14.5832 / Avg. bwd time: 36.5623 / Avg. batch time: 425.7193 (ms) / GPU bubble ratio: 3.89%
[rank1]:2025-10-30 19:22:18,470 - INFO - Avg. fwd time: 15.7447 / Avg. bwd time: 30.8073 / Avg. batch time: 585.2425 (ms) / GPU bubble ratio: 36.37%
[rank0]:2025-10-30 19:24:12,734 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 19:24:14,823 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1924_rank3_trend_line.svg
[rank2]:2025-10-30 19:24:14,837 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1924_rank2_trend_line.svg
[rank1]:2025-10-30 19:24:14,859 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1924_rank1_trend_line.svg
[rank1]:2025-10-30 19:24:14,865 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:24:14,867 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,701  tflops: 312.53  mfu: 31.60%
[rank1]:2025-10-30 19:24:14,867 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 19:24:14,858 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1924_rank0_trend_line.svg
[rank0]:2025-10-30 19:24:14,865 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:24:14,867 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,701  tflops: 312.53  mfu: 31.60%
[rank0]:2025-10-30 19:24:14,867 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-30 19:24:14,865 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:24:14,867 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,701  tflops: 312.53  mfu: 31.60%
[rank2]:2025-10-30 19:24:14,867 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-30 19:24:15,043 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1924_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 446.66 ms, GPU Bubble Ratio: 60.88%, 34.75%, 42.64%, 20.52%
[rank3]:2025-10-30 19:24:15,044 - INFO - 	> Batch Time: 446.66 ms (Average Freeze Ratio: 0.32)
[rank3]:2025-10-30 19:24:15,044 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 19:24:20,563 - INFO -  step: 600  loss:  2.0554  grad_norm:  0.7857  memory: 83.98GiB(60.07%)  tps: 6,690  tflops: 312.04  mfu: 31.55%
[rank3]:2025-10-30 19:24:20,564 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 19:24:36,827 - INFO - validate step: 600  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,652
[rank3]:2025-10-30 19:24:36,883 - INFO - validate step: 600  loss:  0.8452  memory: 83.98GiB(60.07%)  tps: 25,101
[rank2]:2025-10-30 19:24:36,879 - INFO - validate step: 600  loss: -1.0000  memory: 65.21GiB(46.64%)  tps: 18,608
[rank2]:2025-10-30 19:24:36,956 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1924_stage2_step600.svg
[rank1]:2025-10-30 19:24:36,870 - INFO - validate step: 600  loss: -1.0000  memory: 73.42GiB(52.51%)  tps: 18,616
[rank1]:2025-10-30 19:24:36,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1924_stage1_step600.svg
[rank0]:2025-10-30 19:24:36,959 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1924_stage0_step600.svg
[rank3]:2025-10-30 19:24:37,066 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1924_real_step600_rank3.svg
[rank3]:> Batch Time: 532.59 ms, GPU Bubble Ratio: 35.57%, 31.03%, 39.52%, 26.30%
[rank3]:2025-10-30 19:24:37,131 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1924_stage3_step600.svg
[rank3]:2025-10-30 19:24:37,525 - INFO - Avg. fwd time: 14.6241 / Avg. bwd time: 35.9972 / Avg. batch time: 421.6958 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-10-30 19:24:37,547 - INFO - Avg. fwd time: 13.9080 / Avg. bwd time: 26.4255 / Avg. batch time: 537.0759 (ms) / GPU bubble ratio: 39.92%
[rank0]:2025-10-30 19:24:37,579 - INFO - Avg. fwd time: 14.3468 / Avg. bwd time: 21.3836 / Avg. batch time: 622.3569 (ms) / GPU bubble ratio: 54.07%
[rank1]:2025-10-30 19:24:37,573 - INFO - Avg. fwd time: 15.8664 / Avg. bwd time: 29.6631 / Avg. batch time: 584.5938 (ms) / GPU bubble ratio: 37.69%
[rank0]:2025-10-30 19:26:32,173 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 19:26:34,053 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,991  tflops: 326.08  mfu: 32.97%
[rank1]:2025-10-30 19:26:34,054 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,991  tflops: 326.05  mfu: 32.97%
[rank0]:2025-10-30 19:26:34,054 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,988  tflops: 325.93  mfu: 32.96%
[rank0]:2025-10-30 19:26:34,147 - INFO - Avg. fwd time: 14.4159 / Avg. bwd time: 19.8926 / Avg. batch time: 619.9184 (ms) / GPU bubble ratio: 55.73%
[rank3]:2025-10-30 19:26:39,783 - INFO -  step: 650  loss:  2.2035  grad_norm:  1.2039  memory: 83.98GiB(60.07%)  tps: 6,666  tflops: 310.89  mfu: 31.43%
[rank3]:2025-10-30 19:26:40,102 - INFO - Avg. fwd time: 14.6524 / Avg. bwd time: 35.6082 / Avg. batch time: 418.9328 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-10-30 19:26:40,100 - INFO - Avg. fwd time: 13.9894 / Avg. bwd time: 25.6888 / Avg. batch time: 537.0322 (ms) / GPU bubble ratio: 40.89%
[rank1]:2025-10-30 19:26:40,136 - INFO - Avg. fwd time: 15.9528 / Avg. bwd time: 28.8294 / Avg. batch time: 583.6813 (ms) / GPU bubble ratio: 38.62%
[rank0]:2025-10-30 19:28:35,594 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:28:37,526 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,635  tflops: 309.44  mfu: 31.29%
[rank0]:2025-10-30 19:28:37,527 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,635  tflops: 309.44  mfu: 31.29%
[rank1]:2025-10-30 19:28:37,527 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,635  tflops: 309.44  mfu: 31.29%
[rank3]:2025-10-30 19:28:43,243 - INFO -  step: 700  loss:  2.3329  grad_norm:  1.1492  memory: 83.98GiB(60.07%)  tps: 6,635  tflops: 309.48  mfu: 31.29%
[rank2]:2025-10-30 19:28:43,321 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1928_stage2_step700.svg
[rank0]:2025-10-30 19:28:43,323 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1928_stage0_step700.svg
[rank1]:2025-10-30 19:28:43,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1928_stage1_step700.svg
[rank3]:2025-10-30 19:28:43,421 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1928_real_step700_rank3.svg
[rank3]:> Batch Time: 499.48 ms, GPU Bubble Ratio: 44.35%, 37.27%, 43.48%, 24.92%
[rank0]:2025-10-30 19:28:43,418 - INFO - Avg. fwd time: 14.4837 / Avg. bwd time: 18.3961 / Avg. batch time: 618.3808 (ms) / GPU bubble ratio: 57.46%
[rank3]:2025-10-30 19:28:43,487 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1928_stage3_step700.svg
[rank3]:2025-10-30 19:28:43,811 - INFO - Avg. fwd time: 14.6753 / Avg. bwd time: 35.2289 / Avg. batch time: 416.2235 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-10-30 19:28:43,806 - INFO - Avg. fwd time: 14.0700 / Avg. bwd time: 24.9483 / Avg. batch time: 537.9040 (ms) / GPU bubble ratio: 41.97%
[rank1]:2025-10-30 19:28:43,844 - INFO - Avg. fwd time: 16.0379 / Avg. bwd time: 27.9918 / Avg. batch time: 583.6776 (ms) / GPU bubble ratio: 39.65%
[rank0]:2025-10-30 19:30:38,653 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:30:40,534 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,660  tflops: 310.61  mfu: 31.41%
[rank1]:2025-10-30 19:30:40,534 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,660  tflops: 310.61  mfu: 31.41%
[rank0]:2025-10-30 19:30:40,534 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,660  tflops: 310.61  mfu: 31.41%
[rank3]:2025-10-30 19:30:46,195 - INFO -  step: 750  loss:  2.5209  grad_norm:  0.2299  memory: 83.98GiB(60.07%)  tps: 6,663  tflops: 310.76  mfu: 31.42%
[rank3]:2025-10-30 19:30:46,582 - INFO - Avg. fwd time: 14.6984 / Avg. bwd time: 34.8828 / Avg. batch time: 413.7425 (ms) / GPU bubble ratio: 4.13%
[rank2]:2025-10-30 19:30:46,604 - INFO - Avg. fwd time: 14.1402 / Avg. bwd time: 24.3123 / Avg. batch time: 538.5252 (ms) / GPU bubble ratio: 42.88%
[rank1]:2025-10-30 19:30:46,629 - INFO - Avg. fwd time: 16.1119 / Avg. bwd time: 27.2726 / Avg. batch time: 583.5500 (ms) / GPU bubble ratio: 40.52%
[rank0]:2025-10-30 19:30:46,636 - INFO - Avg. fwd time: 14.5438 / Avg. bwd time: 17.1090 / Avg. batch time: 616.9360 (ms) / GPU bubble ratio: 58.95%
[rank0]:2025-10-30 19:32:41,388 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 19:32:43,598 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1932_rank3_trend_line.svg
[rank2]:2025-10-30 19:32:43,638 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1932_rank2_trend_line.svg
[rank2]:2025-10-30 19:32:43,654 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-10-30 19:32:43,656 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.21GiB(46.64%)  tps: 6,654  tflops: 310.32  mfu: 31.38%
[rank2]:2025-10-30 19:32:43,656 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 19:32:43,648 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1932_rank0_trend_line.svg
[rank0]:2025-10-30 19:32:43,654 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-30 19:32:43,656 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,654  tflops: 310.32  mfu: 31.38%
[rank1]:2025-10-30 19:32:43,648 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1932_rank1_trend_line.svg
[rank1]:2025-10-30 19:32:43,654 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-30 19:32:43,656 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-30 19:32:43,656 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.42GiB(52.51%)  tps: 6,654  tflops: 310.32  mfu: 31.38%
[rank1]:2025-10-30 19:32:43,656 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 19:32:43,836 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1932_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 444.82 ms, GPU Bubble Ratio: 67.65%, 38.65%, 45.60%, 20.08%
[rank3]:2025-10-30 19:32:43,837 - INFO - 	> Batch Time: 444.82 ms (Average Freeze Ratio: 0.23)
[rank3]:2025-10-30 19:32:43,837 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.20/0.20, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-30 19:32:49,485 - INFO -  step: 800  loss:  1.7715  grad_norm:  0.4535  memory: 83.98GiB(60.07%)  tps: 6,645  tflops: 309.91  mfu: 31.34%
[rank3]:2025-10-30 19:32:49,485 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 19:33:05,617 - INFO - validate step: 800  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,651
[rank3]:2025-10-30 19:33:05,673 - INFO - validate step: 800  loss:  0.9051  memory: 83.98GiB(60.07%)  tps: 25,304
[rank2]:2025-10-30 19:33:05,669 - INFO - validate step: 800  loss: -1.0000  memory: 65.21GiB(46.64%)  tps: 18,607
[rank1]:2025-10-30 19:33:05,653 - INFO - validate step: 800  loss: -1.0000  memory: 73.42GiB(52.51%)  tps: 18,622
[rank2]:2025-10-30 19:33:05,753 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1933_stage2_step800.svg
[rank1]:2025-10-30 19:33:05,751 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1933_stage1_step800.svg
[rank0]:2025-10-30 19:33:05,754 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1933_stage0_step800.svg
[rank3]:2025-10-30 19:33:05,843 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1933_real_step800_rank3.svg
[rank3]:> Batch Time: 465.16 ms, GPU Bubble Ratio: 74.05%, 40.20%, 46.86%, 20.49%
[rank0]:2025-10-30 19:33:05,847 - INFO - Avg. fwd time: 14.5879 / Avg. bwd time: 16.1411 / Avg. batch time: 615.2369 (ms) / GPU bubble ratio: 60.04%
[rank3]:2025-10-30 19:33:05,912 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1933_stage3_step800.svg
[rank3]:2025-10-30 19:33:06,237 - INFO - Avg. fwd time: 14.7136 / Avg. bwd time: 34.6189 / Avg. batch time: 411.8416 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-30 19:33:06,233 - INFO - Avg. fwd time: 14.1925 / Avg. bwd time: 23.8328 / Avg. batch time: 538.3823 (ms) / GPU bubble ratio: 43.50%
[rank1]:2025-10-30 19:33:06,271 - INFO - Avg. fwd time: 16.1671 / Avg. bwd time: 26.7313 / Avg. batch time: 582.8428 (ms) / GPU bubble ratio: 41.12%
[rank0]:2025-10-30 19:35:32,864 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 19:35:35,421 - INFO -  step: 850  loss: -4.0000  grad_norm: 10.3899  memory: 73.42GiB(52.51%)  tps: 5,470  tflops: 255.11  mfu: 25.79%
[rank0]:2025-10-30 19:35:35,425 - INFO -  step: 850  loss: -4.0000  grad_norm: 10.3899  memory: 73.87GiB(52.83%)  tps: 5,468  tflops: 255.04  mfu: 25.79%
[rank2]:2025-10-30 19:35:35,419 - INFO -  step: 850  loss: -4.0000  grad_norm: 10.3899  memory: 65.21GiB(46.64%)  tps: 5,470  tflops: 255.14  mfu: 25.80%
[rank3]:2025-10-30 19:35:41,032 - INFO -  step: 850  loss:  2.8784  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,273  tflops: 245.93  mfu: 24.87%
[rank3]:2025-10-30 19:35:41,283 - INFO - Avg. fwd time: 14.8135 / Avg. bwd time: 33.8944 / Avg. batch time: 406.7405 (ms) / GPU bubble ratio: 4.20%
[rank2]:2025-10-30 19:35:41,436 - INFO - Avg. fwd time: 14.1183 / Avg. bwd time: 24.4998 / Avg. batch time: 540.7841 (ms) / GPU bubble ratio: 42.87%
[rank1]:2025-10-30 19:35:41,503 - INFO - Avg. fwd time: 16.0831 / Avg. bwd time: 27.4691 / Avg. batch time: 587.5590 (ms) / GPU bubble ratio: 40.70%
[rank0]:2025-10-30 19:35:41,535 - INFO - Avg. fwd time: 14.5223 / Avg. bwd time: 17.2734 / Avg. batch time: 621.1030 (ms) / GPU bubble ratio: 59.05%
[rank0]:2025-10-30 19:38:08,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 19:38:11,230 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.9822  memory: 73.42GiB(52.51%)  tps: 5,258  tflops: 245.22  mfu: 24.79%
[rank0]:2025-10-30 19:38:11,234 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.9822  memory: 73.87GiB(52.83%)  tps: 5,258  tflops: 245.22  mfu: 24.79%
[rank2]:2025-10-30 19:38:11,228 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.9822  memory: 65.21GiB(46.64%)  tps: 5,258  tflops: 245.22  mfu: 24.79%
[rank3]:2025-10-30 19:38:16,939 - INFO -  step: 900  loss:  2.4393  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,254  tflops: 245.07  mfu: 24.78%
[rank2]:2025-10-30 19:38:17,013 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1938_stage2_step900.svg
[rank0]:2025-10-30 19:38:17,011 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1938_stage0_step900.svg
[rank1]:2025-10-30 19:38:17,013 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1938_stage1_step900.svg
[rank3]:2025-10-30 19:38:17,118 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1938_real_step900_rank3.svg
[rank3]:> Batch Time: 483.94 ms, GPU Bubble Ratio: 46.20%, 38.73%, 44.50%, 24.12%
[rank3]:2025-10-30 19:38:17,179 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1938_stage3_step900.svg
[rank3]:2025-10-30 19:38:17,517 - INFO - Avg. fwd time: 14.9099 / Avg. bwd time: 33.2020 / Avg. batch time: 401.8578 (ms) / GPU bubble ratio: 4.22%
[rank2]:2025-10-30 19:38:17,651 - INFO - Avg. fwd time: 14.0395 / Avg. bwd time: 25.2037 / Avg. batch time: 544.8438 (ms) / GPU bubble ratio: 42.38%
[rank1]:2025-10-30 19:38:17,718 - INFO - Avg. fwd time: 15.9965 / Avg. bwd time: 28.2539 / Avg. batch time: 593.9880 (ms) / GPU bubble ratio: 40.40%
[rank0]:2025-10-30 19:38:17,763 - INFO - Avg. fwd time: 14.4553 / Avg. bwd time: 18.4869 / Avg. batch time: 628.7697 (ms) / GPU bubble ratio: 58.09%
[rank0]:2025-10-30 19:40:44,587 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:40:47,147 - INFO -  step: 950  loss: -4.0000  grad_norm:  1.3662  memory: 65.21GiB(46.64%)  tps: 5,254  tflops: 245.05  mfu: 24.78%
[rank1]:2025-10-30 19:40:47,150 - INFO -  step: 950  loss: -4.0000  grad_norm:  1.3662  memory: 73.42GiB(52.51%)  tps: 5,254  tflops: 245.05  mfu: 24.78%
[rank0]:2025-10-30 19:40:47,154 - INFO -  step: 950  loss: -4.0000  grad_norm:  1.3662  memory: 73.87GiB(52.83%)  tps: 5,254  tflops: 245.05  mfu: 24.78%
[rank3]:2025-10-30 19:40:52,767 - INFO -  step: 950  loss:  1.6365  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,257  tflops: 245.19  mfu: 24.79%
[rank3]:2025-10-30 19:40:53,017 - INFO - Avg. fwd time: 14.9859 / Avg. bwd time: 32.6702 / Avg. batch time: 398.1244 (ms) / GPU bubble ratio: 4.24%
[rank1]:2025-10-30 19:40:53,232 - INFO - Avg. fwd time: 15.9326 / Avg. bwd time: 28.8572 / Avg. batch time: 598.4495 (ms) / GPU bubble ratio: 40.13%
[rank2]:2025-10-30 19:40:53,167 - INFO - Avg. fwd time: 13.9808 / Avg. bwd time: 25.7473 / Avg. batch time: 547.5005 (ms) / GPU bubble ratio: 41.95%
[rank0]:2025-10-30 19:40:53,264 - INFO - Avg. fwd time: 14.4056 / Avg. bwd time: 19.4218 / Avg. batch time: 634.1827 (ms) / GPU bubble ratio: 57.33%
[rank0]:2025-10-30 19:43:20,314 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 19:43:22,878 - INFO -  step: 1000  loss: -4.0000  grad_norm:  7.4464  memory: 73.42GiB(52.51%)  tps: 5,260  tflops: 245.35  mfu: 24.81%
[rank0]:2025-10-30 19:43:22,882 - INFO -  step: 1000  loss: -4.0000  grad_norm:  7.4464  memory: 73.87GiB(52.83%)  tps: 5,260  tflops: 245.35  mfu: 24.81%
[rank1]:2025-10-30 19:43:22,878 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 19:43:22,882 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-30 19:43:22,875 - INFO -  step: 1000  loss: -4.0000  grad_norm:  7.4464  memory: 65.21GiB(46.64%)  tps: 5,260  tflops: 245.35  mfu: 24.81%
[rank2]:2025-10-30 19:43:22,876 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 19:43:28,530 - INFO -  step: 1000  loss:  1.9619  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,259  tflops: 245.30  mfu: 24.80%
[rank3]:2025-10-30 19:43:28,531 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 19:43:44,481 - INFO - validate step: 1000  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,964
[rank1]:2025-10-30 19:43:44,519 - INFO - validate step: 1000  loss: -1.0000  memory: 73.42GiB(52.51%)  tps: 18,928
[rank3]:2025-10-30 19:43:44,576 - INFO - validate step: 1000  loss:  0.8965  memory: 87.87GiB(62.85%)  tps: 25,529
[rank2]:2025-10-30 19:43:44,557 - INFO - validate step: 1000  loss: -1.0000  memory: 65.21GiB(46.64%)  tps: 18,892
[rank1]:2025-10-30 19:43:44,652 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1943_stage1_step1000.svg
[rank0]:2025-10-30 19:43:44,652 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1943_stage0_step1000.svg
[rank2]:2025-10-30 19:43:44,653 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1943_stage2_step1000.svg
[rank3]:2025-10-30 19:43:44,759 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1943_real_step1000_rank3.svg
[rank3]:> Batch Time: 499.45 ms, GPU Bubble Ratio: 35.69%, 27.94%, 35.69%, 26.97%
[rank3]:2025-10-30 19:43:44,823 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1943_stage3_step1000.svg
[rank3]:2025-10-30 19:43:45,075 - INFO - Avg. fwd time: 15.0651 / Avg. bwd time: 32.1096 / Avg. batch time: 394.1803 (ms) / GPU bubble ratio: 4.26%
[rank2]:2025-10-30 19:43:45,225 - INFO - Avg. fwd time: 13.9185 / Avg. bwd time: 26.3182 / Avg. batch time: 550.7841 (ms) / GPU bubble ratio: 41.56%
[rank0]:2025-10-30 19:43:45,326 - INFO - Avg. fwd time: 14.3529 / Avg. bwd time: 20.4034 / Avg. batch time: 640.3617 (ms) / GPU bubble ratio: 56.58%
[rank1]:2025-10-30 19:43:45,293 - INFO - Avg. fwd time: 15.8637 / Avg. bwd time: 29.4905 / Avg. batch time: 603.6290 (ms) / GPU bubble ratio: 39.89%
[rank0]:2025-10-30 19:46:12,425 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 19:46:14,996 - INFO -  step: 1050  loss: -4.0000  grad_norm:  1.4252  memory: 73.87GiB(52.83%)  tps: 5,443  tflops: 253.85  mfu: 25.67%
[rank1]:2025-10-30 19:46:14,992 - INFO -  step: 1050  loss: -4.0000  grad_norm:  1.4252  memory: 73.42GiB(52.51%)  tps: 5,444  tflops: 253.92  mfu: 25.67%
[rank2]:2025-10-30 19:46:14,989 - INFO -  step: 1050  loss: -4.0000  grad_norm:  1.4252  memory: 65.21GiB(46.64%)  tps: 5,446  tflops: 253.99  mfu: 25.68%
[rank3]:2025-10-30 19:46:20,669 - INFO -  step: 1050  loss:  2.3036  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,248  tflops: 244.78  mfu: 24.75%
[rank3]:2025-10-30 19:46:21,005 - INFO - Avg. fwd time: 15.1357 / Avg. bwd time: 31.6056 / Avg. batch time: 390.6299 (ms) / GPU bubble ratio: 4.28%
[rank1]:2025-10-30 19:46:21,206 - INFO - Avg. fwd time: 15.8025 / Avg. bwd time: 30.0616 / Avg. batch time: 608.3294 (ms) / GPU bubble ratio: 39.69%
[rank2]:2025-10-30 19:46:21,142 - INFO - Avg. fwd time: 13.8620 / Avg. bwd time: 26.8336 / Avg. batch time: 553.7820 (ms) / GPU bubble ratio: 41.21%
[rank0]:2025-10-30 19:46:21,253 - INFO - Avg. fwd time: 14.3059 / Avg. bwd time: 21.2884 / Avg. batch time: 645.9691 (ms) / GPU bubble ratio: 55.92%
[rank0]:2025-10-30 19:48:48,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 19:48:50,746 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4667  memory: 65.21GiB(46.64%)  tps: 5,260  tflops: 245.30  mfu: 24.80%
[rank0]:2025-10-30 19:48:50,752 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4667  memory: 73.87GiB(52.83%)  tps: 5,260  tflops: 245.30  mfu: 24.80%
[rank1]:2025-10-30 19:48:50,748 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4667  memory: 73.42GiB(52.51%)  tps: 5,260  tflops: 245.30  mfu: 24.80%
[rank3]:2025-10-30 19:48:56,414 - INFO -  step: 1100  loss:  2.0445  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,260  tflops: 245.32  mfu: 24.81%
[rank2]:2025-10-30 19:48:56,491 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1948_stage2_step1100.svg
[rank0]:2025-10-30 19:48:56,489 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1948_stage0_step1100.svg
[rank1]:2025-10-30 19:48:56,491 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1948_stage1_step1100.svg
[rank3]:2025-10-30 19:48:56,599 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1948_real_step1100_rank3.svg
[rank3]:> Batch Time: 585.48 ms, GPU Bubble Ratio: 30.51%, 24.93%, 33.71%, 37.96%
[rank3]:2025-10-30 19:48:56,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1948_stage3_step1100.svg
[rank3]:2025-10-30 19:48:56,917 - INFO - Avg. fwd time: 15.1906 / Avg. bwd time: 31.2121 / Avg. batch time: 387.8560 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-10-30 19:48:57,067 - INFO - Avg. fwd time: 13.8176 / Avg. bwd time: 27.2346 / Avg. batch time: 555.7133 (ms) / GPU bubble ratio: 40.90%
[rank1]:2025-10-30 19:48:57,136 - INFO - Avg. fwd time: 15.7543 / Avg. bwd time: 30.5055 / Avg. batch time: 611.5864 (ms) / GPU bubble ratio: 39.49%
[rank0]:2025-10-30 19:48:57,168 - INFO - Avg. fwd time: 14.2692 / Avg. bwd time: 21.9785 / Avg. batch time: 649.9326 (ms) / GPU bubble ratio: 55.38%
[rank0]:2025-10-30 19:51:24,209 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 19:51:26,785 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.7761  memory: 73.42GiB(52.51%)  tps: 5,250  tflops: 244.86  mfu: 24.76%
[rank0]:2025-10-30 19:51:26,788 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.7761  memory: 73.87GiB(52.83%)  tps: 5,250  tflops: 244.86  mfu: 24.76%
[rank2]:2025-10-30 19:51:26,782 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.7761  memory: 65.21GiB(46.64%)  tps: 5,250  tflops: 244.86  mfu: 24.76%
[rank3]:2025-10-30 19:51:32,433 - INFO -  step: 1150  loss:  2.0422  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,251  tflops: 244.89  mfu: 24.76%
[rank3]:2025-10-30 19:51:32,696 - INFO - Avg. fwd time: 15.2492 / Avg. bwd time: 30.7917 / Avg. batch time: 384.8928 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-10-30 19:51:32,847 - INFO - Avg. fwd time: 13.7702 / Avg. bwd time: 27.6637 / Avg. batch time: 557.0021 (ms) / GPU bubble ratio: 40.49%
[rank1]:2025-10-30 19:51:32,914 - INFO - Avg. fwd time: 15.7029 / Avg. bwd time: 30.9808 / Avg. batch time: 614.2930 (ms) / GPU bubble ratio: 39.20%
[rank0]:2025-10-30 19:51:32,946 - INFO - Avg. fwd time: 14.2292 / Avg. bwd time: 22.7170 / Avg. batch time: 653.3922 (ms) / GPU bubble ratio: 54.76%
[rank2]:2025-10-30 19:53:48,152 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 19:53:48,266 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 19:53:48,222 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-30 19:53:53,669 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-30 19:53:59,764 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 19:54:02,712 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1954_rank3_trend_line.svg
[rank2]:2025-10-30 19:54:02,737 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1954_rank2_trend_line.svg
[rank0]:2025-10-30 19:54:02,820 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1954_rank0_trend_line.svg
[rank0]:2025-10-30 19:54:02,826 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.23/0.23, [MB6] 0.23/0.23, [MB7] 1.00/1.00
[rank1]:2025-10-30 19:54:02,783 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_1954_rank1_trend_line.svg
[rank1]:2025-10-30 19:54:02,826 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.37/0.37, [MB1] 0.37/0.37, [MB2] 0.37/0.37, [MB3] 0.37/0.37, [MB4] 0.37/0.37, [MB5] 0.33/0.33, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 19:54:02,829 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0976  memory: 73.87GiB(52.83%)  tps: 5,250  tflops: 244.86  mfu: 24.76%
[rank1]:2025-10-30 19:54:02,830 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0976  memory: 73.42GiB(52.51%)  tps: 5,250  tflops: 244.85  mfu: 24.76%
[rank0]:2025-10-30 19:54:02,829 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-30 19:54:02,830 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-30 19:54:02,826 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.12/0.12, [MB1] 0.12/0.12, [MB2] 0.12/0.12, [MB3] 0.12/0.12, [MB4] 0.12/0.12, [MB5] 0.12/0.12, [MB6] 0.08/0.08, [MB7] 1.00/1.00
[rank2]:2025-10-30 19:54:02,829 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0976  memory: 65.21GiB(46.64%)  tps: 5,250  tflops: 244.85  mfu: 24.76%
[rank2]:2025-10-30 19:54:02,830 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-30 19:54:03,005 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1954_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 412.17 ms, GPU Bubble Ratio: 38.47%, 24.10%, 26.08%, 20.58%
[rank3]:2025-10-30 19:54:03,005 - INFO - 	> Batch Time: 412.17 ms (Average Freeze Ratio: 0.46)
[rank3]:2025-10-30 19:54:03,006 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 19:54:08,741 - INFO -  step: 1200  loss:  2.2753  grad_norm:  0.0000  memory: 87.87GiB(62.85%)  tps: 5,241  tflops: 244.44  mfu: 24.72%
[rank3]:2025-10-30 19:54:08,742 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-30 19:54:24,735 - INFO - validate step: 1200  loss: -1.0000  memory: 73.42GiB(52.51%)  tps: 18,699
[rank1]:2025-10-30 19:54:24,736 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 19:54:24,700 - INFO - validate step: 1200  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,728
[rank0]:2025-10-30 19:54:24,701 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 19:54:24,707 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-30 19:54:24,792 - INFO - validate step: 1200  loss:  0.9181  memory: 87.87GiB(62.85%)  tps: 25,520
[rank3]:2025-10-30 19:54:24,793 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 19:54:24,774 - INFO - validate step: 1200  loss: -1.0000  memory: 65.21GiB(46.64%)  tps: 18,666
[rank2]:2025-10-30 19:54:24,775 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 19:54:37,216 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.48 seconds.
[rank2]:2025-10-30 19:54:40,012 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.24 seconds.
[rank0]:2025-10-30 19:54:40,824 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-30 19:54:40,830 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.13 seconds.
[rank3]:2025-10-30 19:54:42,593 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.80 seconds.
[rank2]:2025-10-30 19:54:42,830 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1954_stage2_step1200.svg
[rank1]:2025-10-30 19:54:42,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1954_stage1_step1200.svg
[rank0]:2025-10-30 19:54:42,844 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1954_stage0_step1200.svg
[rank3]:2025-10-30 19:54:42,925 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1954_real_step1200_rank3.svg
[rank3]:> Batch Time: 587.68 ms, GPU Bubble Ratio: 30.78%, 25.14%, 33.89%, 38.44%
[rank3]:2025-10-30 19:54:42,992 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1954_stage3_step1200.svg
[rank3]:2025-10-30 19:54:44,164 - INFO - Avg. fwd time: 15.3025 / Avg. bwd time: 30.4072 / Avg. batch time: 382.3517 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-10-30 19:54:44,289 - INFO - Avg. fwd time: 13.7273 / Avg. bwd time: 28.0540 / Avg. batch time: 559.4707 (ms) / GPU bubble ratio: 40.26%
[rank1]:2025-10-30 19:54:44,342 - INFO - Avg. fwd time: 15.6549 / Avg. bwd time: 31.4133 / Avg. batch time: 618.0546 (ms) / GPU bubble ratio: 39.08%
[rank0]:2025-10-30 19:54:44,385 - INFO - Avg. fwd time: 14.1925 / Avg. bwd time: 23.3895 / Avg. batch time: 657.8416 (ms) / GPU bubble ratio: 54.30%
[rank3]:2025-10-30 19:54:47,619 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 19:55:09,786 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-30 19:55:11,642 - WARNING - Dataset medical is being re-looped
[rank2]:2025-10-30 19:55:12,092 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-30 19:56:41,160 - INFO - [GC] Peforming periodical GC collection 2.27 seconds
[rank1]:2025-10-30 19:56:43,051 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 5,923  tflops: 276.24  mfu: 27.93%
[rank0]:2025-10-30 19:56:43,049 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 5,921  tflops: 276.17  mfu: 27.92%
[rank2]:2025-10-30 19:56:43,049 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 5,924  tflops: 276.32  mfu: 27.94%
[rank0]:2025-10-30 19:56:43,144 - INFO - Avg. fwd time: 14.2331 / Avg. bwd time: 22.5444 / Avg. batch time: 655.2376 (ms) / GPU bubble ratio: 55.10%
[rank3]:2025-10-30 19:56:48,290 - INFO -  step: 1250  loss:  2.2804  grad_norm:  0.9907  memory: 87.87GiB(62.85%)  tps: 5,709  tflops: 266.26  mfu: 26.92%
[rank3]:2025-10-30 19:56:48,604 - INFO - Avg. fwd time: 15.2895 / Avg. bwd time: 30.3785 / Avg. batch time: 382.0911 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-10-30 19:56:48,601 - INFO - Avg. fwd time: 13.7730 / Avg. bwd time: 27.6126 / Avg. batch time: 558.5828 (ms) / GPU bubble ratio: 40.73%
[rank1]:2025-10-30 19:56:48,640 - INFO - Avg. fwd time: 15.7060 / Avg. bwd time: 30.9179 / Avg. batch time: 616.3140 (ms) / GPU bubble ratio: 39.48%
[rank0]:2025-10-30 19:58:41,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 19:58:42,868 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,837  tflops: 318.88  mfu: 32.24%
[rank1]:2025-10-30 19:58:42,869 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,837  tflops: 318.88  mfu: 32.24%
[rank2]:2025-10-30 19:58:42,868 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,837  tflops: 318.88  mfu: 32.24%
[rank3]:2025-10-30 19:58:48,085 - INFO -  step: 1300  loss:  2.3543  grad_norm:  0.4695  memory: 87.87GiB(62.85%)  tps: 6,838  tflops: 318.95  mfu: 32.25%
[rank1]:2025-10-30 19:58:48,169 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_1958_stage1_step1300.svg
[rank0]:2025-10-30 19:58:48,169 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_1958_stage0_step1300.svg
[rank2]:2025-10-30 19:58:48,165 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_1958_stage2_step1300.svg
[rank0]:2025-10-30 19:58:48,263 - INFO - Avg. fwd time: 14.2775 / Avg. bwd time: 21.6325 / Avg. batch time: 652.3185 (ms) / GPU bubble ratio: 55.96%
[rank3]:2025-10-30 19:58:48,268 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_1958_real_step1300_rank3.svg
[rank3]:> Batch Time: 585.62 ms, GPU Bubble Ratio: 30.51%, 24.95%, 33.72%, 38.36%
[rank3]:2025-10-30 19:58:48,333 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_1958_stage3_step1300.svg
[rank1]:2025-10-30 19:58:48,677 - INFO - Avg. fwd time: 15.7607 / Avg. bwd time: 30.3838 / Avg. batch time: 614.3252 (ms) / GPU bubble ratio: 39.91%
[rank3]:2025-10-30 19:58:48,644 - INFO - Avg. fwd time: 15.2766 / Avg. bwd time: 30.3539 / Avg. batch time: 381.8551 (ms) / GPU bubble ratio: 4.40%
[rank2]:2025-10-30 19:58:48,642 - INFO - Avg. fwd time: 13.8230 / Avg. bwd time: 27.1366 / Avg. batch time: 557.5109 (ms) / GPU bubble ratio: 41.23%
[rank0]:2025-10-30 20:00:41,497 - INFO - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2025-10-30 20:00:43,350 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,799  tflops: 317.13  mfu: 32.07%
[rank1]:2025-10-30 20:00:43,350 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,799  tflops: 317.13  mfu: 32.07%
[rank2]:2025-10-30 20:00:43,349 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,799  tflops: 317.13  mfu: 32.07%
[rank3]:2025-10-30 20:00:48,548 - INFO -  step: 1350  loss:  1.8713  grad_norm:  0.0315  memory: 87.87GiB(62.85%)  tps: 6,801  tflops: 317.18  mfu: 32.07%
[rank3]:2025-10-30 20:00:48,945 - INFO - Avg. fwd time: 15.2622 / Avg. bwd time: 30.3450 / Avg. batch time: 381.7387 (ms) / GPU bubble ratio: 4.42%
[rank2]:2025-10-30 20:00:48,971 - INFO - Avg. fwd time: 13.8681 / Avg. bwd time: 26.6974 / Avg. batch time: 556.6058 (ms) / GPU bubble ratio: 41.70%
[rank0]:2025-10-30 20:00:49,009 - INFO - Avg. fwd time: 14.3170 / Avg. bwd time: 20.7915 / Avg. batch time: 649.7083 (ms) / GPU bubble ratio: 56.77%
[rank1]:2025-10-30 20:00:48,999 - INFO - Avg. fwd time: 15.8099 / Avg. bwd time: 29.8906 / Avg. batch time: 612.5736 (ms) / GPU bubble ratio: 40.32%
[rank0]:2025-10-30 20:02:42,544 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:02:44,440 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,765  tflops: 315.53  mfu: 31.90%
[rank0]:2025-10-30 20:02:44,440 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-30 20:02:44,440 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,765  tflops: 315.53  mfu: 31.90%
[rank1]:2025-10-30 20:02:44,440 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-30 20:02:44,439 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,765  tflops: 315.53  mfu: 31.90%
[rank2]:2025-10-30 20:02:44,440 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-30 20:02:49,773 - INFO -  step: 1400  loss:  2.0601  grad_norm:  1.0167  memory: 87.87GiB(62.85%)  tps: 6,758  tflops: 315.19  mfu: 31.87%
[rank3]:2025-10-30 20:02:49,773 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-30 20:03:05,825 - INFO - validate step: 1400  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 19,153
[rank1]:2025-10-30 20:03:05,861 - INFO - validate step: 1400  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 19,122
[rank3]:2025-10-30 20:03:05,881 - INFO - validate step: 1400  loss:  0.9270  memory: 87.87GiB(62.85%)  tps: 25,430
[rank2]:2025-10-30 20:03:05,878 - INFO - validate step: 1400  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 19,107
[rank0]:2025-10-30 20:03:05,968 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2003_stage0_step1400.svg
[rank1]:2025-10-30 20:03:05,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2003_stage1_step1400.svg
[rank2]:2025-10-30 20:03:05,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2003_stage2_step1400.svg
[rank0]:2025-10-30 20:03:06,063 - INFO - Avg. fwd time: 14.3496 / Avg. bwd time: 20.1211 / Avg. batch time: 647.4861 (ms) / GPU bubble ratio: 57.41%
[rank3]:2025-10-30 20:03:06,060 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2003_real_step1400_rank3.svg
[rank3]:> Batch Time: 498.62 ms, GPU Bubble Ratio: 31.21%, 26.84%, 35.45%, 27.58%
[rank3]:2025-10-30 20:03:06,127 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2003_stage3_step1400.svg
[rank1]:2025-10-30 20:03:06,479 - INFO - Avg. fwd time: 15.8503 / Avg. bwd time: 29.4972 / Avg. batch time: 611.0372 (ms) / GPU bubble ratio: 40.63%
[rank3]:2025-10-30 20:03:06,445 - INFO - Avg. fwd time: 15.2485 / Avg. bwd time: 30.3567 / Avg. batch time: 381.8005 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-10-30 20:03:06,442 - INFO - Avg. fwd time: 13.9048 / Avg. bwd time: 26.3472 / Avg. batch time: 555.7458 (ms) / GPU bubble ratio: 42.06%
[rank0]:2025-10-30 20:04:59,420 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 20:05:01,296 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 7,094  tflops: 330.89  mfu: 33.46%
[rank1]:2025-10-30 20:05:01,296 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 7,097  tflops: 330.99  mfu: 33.47%
[rank2]:2025-10-30 20:05:01,296 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 7,098  tflops: 331.04  mfu: 33.47%
[rank0]:2025-10-30 20:05:01,392 - INFO - Avg. fwd time: 14.3849 / Avg. bwd time: 19.3915 / Avg. batch time: 644.3703 (ms) / GPU bubble ratio: 58.07%
[rank3]:2025-10-30 20:05:06,573 - INFO -  step: 1450  loss:  2.3971  grad_norm:  0.5737  memory: 87.87GiB(62.85%)  tps: 6,788  tflops: 316.58  mfu: 32.01%
[rank1]:2025-10-30 20:05:06,923 - INFO - Avg. fwd time: 15.8933 / Avg. bwd time: 29.0692 / Avg. batch time: 608.6675 (ms) / GPU bubble ratio: 40.90%
[rank3]:2025-10-30 20:05:06,890 - INFO - Avg. fwd time: 15.2375 / Avg. bwd time: 30.3489 / Avg. batch time: 381.7020 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-10-30 20:05:06,888 - INFO - Avg. fwd time: 13.9442 / Avg. bwd time: 25.9660 / Avg. batch time: 554.1106 (ms) / GPU bubble ratio: 42.38%
[rank0]:2025-10-30 20:06:59,824 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 20:07:01,730 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,802  tflops: 317.25  mfu: 32.08%
[rank0]:2025-10-30 20:07:01,730 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,802  tflops: 317.25  mfu: 32.08%
[rank2]:2025-10-30 20:07:01,730 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,802  tflops: 317.25  mfu: 32.08%
[rank3]:2025-10-30 20:07:06,965 - INFO -  step: 1500  loss:  2.1731  grad_norm:  0.9384  memory: 87.87GiB(62.85%)  tps: 6,805  tflops: 317.37  mfu: 32.09%
[rank2]:2025-10-30 20:07:07,055 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2007_stage2_step1500.svg
[rank1]:2025-10-30 20:07:07,047 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2007_stage1_step1500.svg
[rank0]:2025-10-30 20:07:07,051 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2007_stage0_step1500.svg
[rank3]:2025-10-30 20:07:07,147 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2007_real_step1500_rank3.svg
[rank3]:> Batch Time: 483.69 ms, GPU Bubble Ratio: 42.19%, 34.88%, 41.32%, 25.37%
[rank3]:2025-10-30 20:07:07,215 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2007_stage3_step1500.svg
[rank3]:2025-10-30 20:07:07,611 - INFO - Avg. fwd time: 15.2269 / Avg. bwd time: 30.3398 / Avg. batch time: 381.6013 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-10-30 20:07:07,638 - INFO - Avg. fwd time: 13.9810 / Avg. bwd time: 25.6114 / Avg. batch time: 553.4505 (ms) / GPU bubble ratio: 42.77%
[rank0]:2025-10-30 20:07:07,674 - INFO - Avg. fwd time: 14.4180 / Avg. bwd time: 18.7131 / Avg. batch time: 642.3346 (ms) / GPU bubble ratio: 58.74%
[rank1]:2025-10-30 20:07:07,665 - INFO - Avg. fwd time: 15.9340 / Avg. bwd time: 28.6714 / Avg. batch time: 607.3250 (ms) / GPU bubble ratio: 41.24%
[rank0]:2025-10-30 20:09:00,946 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:09:02,872 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,762  tflops: 315.40  mfu: 31.89%
[rank0]:2025-10-30 20:09:02,872 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,762  tflops: 315.40  mfu: 31.89%
[rank1]:2025-10-30 20:09:02,873 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,762  tflops: 315.40  mfu: 31.89%
[rank0]:2025-10-30 20:09:02,972 - INFO - Avg. fwd time: 14.4448 / Avg. bwd time: 18.1682 / Avg. batch time: 640.4900 (ms) / GPU bubble ratio: 59.26%
[rank3]:2025-10-30 20:09:08,181 - INFO -  step: 1550  loss:  1.8614  grad_norm:  0.4319  memory: 87.87GiB(62.85%)  tps: 6,758  tflops: 315.21  mfu: 31.87%
[rank3]:2025-10-30 20:09:08,504 - INFO - Avg. fwd time: 15.2167 / Avg. bwd time: 30.3409 / Avg. batch time: 381.5881 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-10-30 20:09:08,502 - INFO - Avg. fwd time: 14.0106 / Avg. bwd time: 25.3267 / Avg. batch time: 552.7110 (ms) / GPU bubble ratio: 43.06%
[rank1]:2025-10-30 20:09:08,538 - INFO - Avg. fwd time: 15.9670 / Avg. bwd time: 28.3524 / Avg. batch time: 606.0378 (ms) / GPU bubble ratio: 41.50%
[rank0]:2025-10-30 20:11:02,453 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 20:11:04,986 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_2011_rank3_trend_line.svg
[rank2]:2025-10-30 20:11:05,089 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_2011_rank2_trend_line.svg
[rank2]:2025-10-30 20:11:05,121 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 20:11:05,115 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_2011_rank0_trend_line.svg
[rank0]:2025-10-30 20:11:05,124 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-30 20:11:05,128 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,701  tflops: 312.52  mfu: 31.60%
[rank0]:2025-10-30 20:11:05,128 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 20:11:05,067 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule_adjustment/251030_2011_rank1_trend_line.svg
[rank1]:2025-10-30 20:11:05,122 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.17/0.17, [MB1] 0.17/0.17, [MB2] 0.17/0.17, [MB3] 0.17/0.17, [MB4] 0.17/0.17, [MB5] 0.17/0.17, [MB6] 0.75/0.75, [MB7] 1.00/1.00
[rank1]:2025-10-30 20:11:05,126 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,701  tflops: 312.53  mfu: 31.60%
[rank1]:2025-10-30 20:11:05,126 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-30 20:11:05,125 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,701  tflops: 312.53  mfu: 31.60%
[rank2]:2025-10-30 20:11:05,125 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-30 20:11:05,299 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2011_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 413.75 ms, GPU Bubble Ratio: 47.47%, 23.40%, 29.66%, 19.02%
[rank3]:2025-10-30 20:11:05,300 - INFO - 	> Batch Time: 413.75 ms (Average Freeze Ratio: 0.37)
[rank3]:2025-10-30 20:11:05,300 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-30 20:11:11,324 - INFO -  step: 1600  loss:  1.8512  grad_norm:  0.3963  memory: 87.87GiB(62.85%)  tps: 6,653  tflops: 310.28  mfu: 31.37%
[rank3]:2025-10-30 20:11:11,325 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-30 20:11:27,371 - INFO - validate step: 1600  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 18,413
[rank0]:2025-10-30 20:11:27,338 - INFO - validate step: 1600  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 18,443
[rank2]:2025-10-30 20:11:27,387 - INFO - validate step: 1600  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 18,400
[rank3]:2025-10-30 20:11:27,391 - INFO - validate step: 1600  loss:  0.9674  memory: 87.87GiB(62.85%)  tps: 25,498
[rank2]:2025-10-30 20:11:27,479 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2011_stage2_step1600.svg
[rank1]:2025-10-30 20:11:27,479 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2011_stage1_step1600.svg
[rank0]:2025-10-30 20:11:27,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2011_stage0_step1600.svg
[rank3]:2025-10-30 20:11:27,574 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2011_real_step1600_rank3.svg
[rank3]:> Batch Time: 454.64 ms, GPU Bubble Ratio: 73.53%, 38.91%, 45.67%, 20.53%
[rank0]:2025-10-30 20:11:27,576 - INFO - Avg. fwd time: 14.4745 / Avg. bwd time: 17.5713 / Avg. batch time: 638.8256 (ms) / GPU bubble ratio: 59.87%
[rank3]:2025-10-30 20:11:27,647 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2011_stage3_step1600.svg
[rank2]:2025-10-30 20:11:27,968 - INFO - Avg. fwd time: 14.0431 / Avg. bwd time: 25.0149 / Avg. batch time: 552.2551 (ms) / GPU bubble ratio: 43.42%
[rank3]:2025-10-30 20:11:27,971 - INFO - Avg. fwd time: 15.2076 / Avg. bwd time: 30.3374 / Avg. batch time: 381.5423 (ms) / GPU bubble ratio: 4.50%
[rank1]:2025-10-30 20:11:28,008 - INFO - Avg. fwd time: 16.0035 / Avg. bwd time: 28.0024 / Avg. batch time: 604.9812 (ms) / GPU bubble ratio: 41.81%
[rank0]:2025-10-30 20:13:20,891 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 20:13:22,763 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 7,097  tflops: 331.02  mfu: 33.47%
[rank1]:2025-10-30 20:13:22,765 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 7,099  tflops: 331.11  mfu: 33.48%
[rank2]:2025-10-30 20:13:22,763 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 7,100  tflops: 331.16  mfu: 33.48%
[rank3]:2025-10-30 20:13:27,726 - INFO -  step: 1650  loss:  2.4530  grad_norm:  0.7536  memory: 87.87GiB(62.85%)  tps: 6,808  tflops: 317.52  mfu: 32.10%
[rank3]:2025-10-30 20:13:28,124 - INFO - Avg. fwd time: 15.2003 / Avg. bwd time: 30.3337 / Avg. batch time: 381.4898 (ms) / GPU bubble ratio: 4.51%
[rank1]:2025-10-30 20:13:28,185 - INFO - Avg. fwd time: 16.0370 / Avg. bwd time: 27.6746 / Avg. batch time: 603.8366 (ms) / GPU bubble ratio: 42.09%
[rank2]:2025-10-30 20:13:28,152 - INFO - Avg. fwd time: 14.0738 / Avg. bwd time: 24.7233 / Avg. batch time: 551.6716 (ms) / GPU bubble ratio: 43.74%
[rank0]:2025-10-30 20:13:28,199 - INFO - Avg. fwd time: 14.5024 / Avg. bwd time: 17.0125 / Avg. batch time: 637.1139 (ms) / GPU bubble ratio: 60.43%
[rank0]:2025-10-30 20:15:20,774 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 20:15:22,637 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,834  tflops: 318.74  mfu: 32.23%
[rank0]:2025-10-30 20:15:22,636 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,834  tflops: 318.73  mfu: 32.23%
[rank2]:2025-10-30 20:15:22,636 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,834  tflops: 318.74  mfu: 32.23%
[rank3]:2025-10-30 20:15:27,626 - INFO -  step: 1700  loss:  2.9600  grad_norm:  1.5955  memory: 87.87GiB(62.85%)  tps: 6,832  tflops: 318.67  mfu: 32.22%
[rank2]:2025-10-30 20:15:27,710 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2015_stage2_step1700.svg
[rank1]:2025-10-30 20:15:27,723 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2015_stage1_step1700.svg
[rank0]:2025-10-30 20:15:27,713 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2015_stage0_step1700.svg
[rank3]:2025-10-30 20:15:27,808 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2015_real_step1700_rank3.svg
[rank3]:> Batch Time: 455.13 ms, GPU Bubble Ratio: 73.48%, 39.00%, 45.77%, 20.60%
[rank0]:2025-10-30 20:15:27,811 - INFO - Avg. fwd time: 14.5244 / Avg. bwd time: 16.5610 / Avg. batch time: 635.4726 (ms) / GPU bubble ratio: 60.87%
[rank3]:2025-10-30 20:15:27,878 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2015_stage3_step1700.svg
[rank2]:2025-10-30 20:15:28,192 - INFO - Avg. fwd time: 14.0981 / Avg. bwd time: 24.4873 / Avg. batch time: 550.9476 (ms) / GPU bubble ratio: 43.97%
[rank3]:2025-10-30 20:15:28,194 - INFO - Avg. fwd time: 15.1924 / Avg. bwd time: 30.3351 / Avg. batch time: 381.4787 (ms) / GPU bubble ratio: 4.52%
[rank1]:2025-10-30 20:15:28,229 - INFO - Avg. fwd time: 16.0635 / Avg. bwd time: 27.4095 / Avg. batch time: 602.6572 (ms) / GPU bubble ratio: 42.29%
[rank0]:2025-10-30 20:17:19,754 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:17:21,620 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,885  tflops: 321.12  mfu: 32.47%
[rank0]:2025-10-30 20:17:21,621 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,885  tflops: 321.12  mfu: 32.47%
[rank1]:2025-10-30 20:17:21,621 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,885  tflops: 321.12  mfu: 32.47%
[rank0]:2025-10-30 20:17:21,713 - INFO - Avg. fwd time: 14.5484 / Avg. bwd time: 16.0636 / Avg. batch time: 633.0593 (ms) / GPU bubble ratio: 61.32%
[rank3]:2025-10-30 20:17:26,679 - INFO -  step: 1750  loss:  2.6065  grad_norm:  0.6083  memory: 87.87GiB(62.85%)  tps: 6,881  tflops: 320.93  mfu: 32.45%
[rank2]:2025-10-30 20:17:26,994 - INFO - Avg. fwd time: 14.1248 / Avg. bwd time: 24.2275 / Avg. batch time: 549.5457 (ms) / GPU bubble ratio: 44.17%
[rank3]:2025-10-30 20:17:26,995 - INFO - Avg. fwd time: 15.1856 / Avg. bwd time: 30.3262 / Avg. batch time: 381.3834 (ms) / GPU bubble ratio: 4.53%
[rank1]:2025-10-30 20:17:27,030 - INFO - Avg. fwd time: 16.0929 / Avg. bwd time: 27.1174 / Avg. batch time: 600.7532 (ms) / GPU bubble ratio: 42.46%
[rank0]:2025-10-30 20:19:19,787 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:19:21,676 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,824  tflops: 318.25  mfu: 32.18%
[rank0]:2025-10-30 20:19:21,676 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-30 20:19:21,677 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,824  tflops: 318.25  mfu: 32.18%
[rank1]:2025-10-30 20:19:21,677 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-30 20:19:21,675 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,824  tflops: 318.25  mfu: 32.18%
[rank2]:2025-10-30 20:19:21,676 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-30 20:19:26,859 - INFO -  step: 1800  loss:  2.9156  grad_norm:  0.5077  memory: 87.87GiB(62.85%)  tps: 6,817  tflops: 317.93  mfu: 32.15%
[rank3]:2025-10-30 20:19:26,860 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-30 20:19:42,903 - INFO - validate step: 1800  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 19,296
[rank1]:2025-10-30 20:19:42,939 - INFO - validate step: 1800  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 19,265
[rank2]:2025-10-30 20:19:42,955 - INFO - validate step: 1800  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 19,249
[rank2]:2025-10-30 20:19:43,045 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2019_stage2_step1800.svg
[rank3]:2025-10-30 20:19:42,958 - INFO - validate step: 1800  loss:  0.9035  memory: 87.87GiB(62.85%)  tps: 25,445
[rank0]:2025-10-30 20:19:43,046 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2019_stage0_step1800.svg
[rank1]:2025-10-30 20:19:43,046 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2019_stage1_step1800.svg
[rank3]:2025-10-30 20:19:43,136 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2019_real_step1800_rank3.svg
[rank3]:> Batch Time: 455.34 ms, GPU Bubble Ratio: 73.44%, 39.04%, 45.79%, 20.65%
[rank3]:2025-10-30 20:19:43,204 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2019_stage3_step1800.svg
[rank2]:2025-10-30 20:19:43,626 - INFO - Avg. fwd time: 14.1499 / Avg. bwd time: 23.9824 / Avg. batch time: 549.0737 (ms) / GPU bubble ratio: 44.44%
[rank3]:2025-10-30 20:19:43,598 - INFO - Avg. fwd time: 15.1772 / Avg. bwd time: 30.3249 / Avg. batch time: 381.3442 (ms) / GPU bubble ratio: 4.54%
[rank0]:2025-10-30 20:19:43,669 - INFO - Avg. fwd time: 14.5710 / Avg. bwd time: 15.5952 / Avg. batch time: 631.6354 (ms) / GPU bubble ratio: 61.79%
[rank1]:2025-10-30 20:19:43,655 - INFO - Avg. fwd time: 16.1197 / Avg. bwd time: 26.8417 / Avg. batch time: 599.8085 (ms) / GPU bubble ratio: 42.70%
[rank0]:2025-10-30 20:21:36,275 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 20:21:38,164 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 7,110  tflops: 331.59  mfu: 33.53%
[rank0]:2025-10-30 20:21:38,164 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 7,107  tflops: 331.49  mfu: 33.52%
[rank2]:2025-10-30 20:21:38,163 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 7,111  tflops: 331.64  mfu: 33.53%
[rank0]:2025-10-30 20:21:38,259 - INFO - Avg. fwd time: 14.5899 / Avg. bwd time: 15.2150 / Avg. batch time: 630.2767 (ms) / GPU bubble ratio: 62.17%
[rank3]:2025-10-30 20:21:43,366 - INFO -  step: 1850  loss:  2.4844  grad_norm:  0.1428  memory: 87.87GiB(62.85%)  tps: 6,804  tflops: 317.33  mfu: 32.09%
[rank1]:2025-10-30 20:21:43,723 - INFO - Avg. fwd time: 16.1422 / Avg. bwd time: 26.6184 / Avg. batch time: 598.8384 (ms) / GPU bubble ratio: 42.88%
[rank3]:2025-10-30 20:21:43,688 - INFO - Avg. fwd time: 15.1727 / Avg. bwd time: 30.3208 / Avg. batch time: 381.2974 (ms) / GPU bubble ratio: 4.55%
[rank2]:2025-10-30 20:21:43,687 - INFO - Avg. fwd time: 14.1707 / Avg. bwd time: 23.7840 / Avg. batch time: 548.4873 (ms) / GPU bubble ratio: 44.64%
[rank0]:2025-10-30 20:23:36,779 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:23:38,669 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,798  tflops: 317.06  mfu: 32.06%
[rank1]:2025-10-30 20:23:38,670 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,798  tflops: 317.06  mfu: 32.06%
[rank0]:2025-10-30 20:23:38,669 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,798  tflops: 317.06  mfu: 32.06%
[rank2]:2025-10-30 20:23:43,940 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2023_stage2_step1900.svg
[rank3]:2025-10-30 20:23:43,854 - INFO -  step: 1900  loss:  2.5782  grad_norm:  0.1264  memory: 87.87GiB(62.85%)  tps: 6,799  tflops: 317.11  mfu: 32.06%
[rank1]:2025-10-30 20:23:43,940 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2023_stage1_step1900.svg
[rank0]:2025-10-30 20:23:43,942 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2023_stage0_step1900.svg
[rank3]:2025-10-30 20:23:44,034 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2023_real_step1900_rank3.svg
[rank3]:> Batch Time: 455.66 ms, GPU Bubble Ratio: 73.42%, 39.08%, 45.82%, 20.68%
[rank0]:2025-10-30 20:23:44,037 - INFO - Avg. fwd time: 14.6100 / Avg. bwd time: 14.7942 / Avg. batch time: 629.0540 (ms) / GPU bubble ratio: 62.61%
[rank3]:2025-10-30 20:23:44,102 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2023_stage3_step1900.svg
[rank2]:2025-10-30 20:23:44,416 - INFO - Avg. fwd time: 14.1936 / Avg. bwd time: 23.5642 / Avg. batch time: 548.1209 (ms) / GPU bubble ratio: 44.89%
[rank3]:2025-10-30 20:23:44,418 - INFO - Avg. fwd time: 15.1650 / Avg. bwd time: 30.3247 / Avg. batch time: 381.3049 (ms) / GPU bubble ratio: 4.56%
[rank1]:2025-10-30 20:23:44,452 - INFO - Avg. fwd time: 16.1668 / Avg. bwd time: 26.3712 / Avg. batch time: 598.0468 (ms) / GPU bubble ratio: 43.10%
[rank0]:2025-10-30 20:25:36,763 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:25:38,650 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank1]:2025-10-30 20:25:38,650 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank2]:2025-10-30 20:25:38,649 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank3]:2025-10-30 20:25:43,811 - INFO -  step: 1950  loss:  2.6360  grad_norm:  0.5883  memory: 87.87GiB(62.85%)  tps: 6,829  tflops: 318.52  mfu: 32.21%
[rank2]:2025-10-30 20:25:44,241 - INFO - Avg. fwd time: 14.2150 / Avg. bwd time: 23.3562 / Avg. batch time: 547.6948 (ms) / GPU bubble ratio: 45.12%
[rank3]:2025-10-30 20:25:44,214 - INFO - Avg. fwd time: 15.1591 / Avg. bwd time: 30.3124 / Avg. batch time: 381.1841 (ms) / GPU bubble ratio: 4.57%
[rank0]:2025-10-30 20:25:44,286 - INFO - Avg. fwd time: 14.6295 / Avg. bwd time: 14.3960 / Avg. batch time: 627.8205 (ms) / GPU bubble ratio: 63.01%
[rank1]:2025-10-30 20:25:44,273 - INFO - Avg. fwd time: 16.1899 / Avg. bwd time: 26.1373 / Avg. batch time: 597.2197 (ms) / GPU bubble ratio: 43.30%
[rank0]:2025-10-30 20:27:36,700 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:27:38,628 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank2]:2025-10-30 20:27:38,628 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-30 20:27:38,629 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank0]:2025-10-30 20:27:38,628 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,828  tflops: 318.45  mfu: 32.20%
[rank0]:2025-10-30 20:27:38,628 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-30 20:27:38,629 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-30 20:27:43,828 - INFO -  step: 2000  loss:  2.4497  grad_norm:  0.3307  memory: 87.87GiB(62.85%)  tps: 6,826  tflops: 318.36  mfu: 32.19%
[rank3]:2025-10-30 20:27:43,828 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-30 20:27:59,840 - INFO - validate step: 2000  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 19,311
[rank1]:2025-10-30 20:27:59,878 - INFO - validate step: 2000  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 19,277
[rank2]:2025-10-30 20:27:59,891 - INFO - validate step: 2000  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 19,264
[rank3]:2025-10-30 20:27:59,895 - INFO - validate step: 2000  loss:  0.9198  memory: 87.87GiB(62.85%)  tps: 25,496
[rank2]:2025-10-30 20:27:59,987 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2027_stage2_step2000.svg
[rank1]:2025-10-30 20:27:59,986 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2027_stage1_step2000.svg
[rank0]:2025-10-30 20:27:59,988 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2027_stage0_step2000.svg
[rank3]:2025-10-30 20:28:00,081 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2027_real_step2000_rank3.svg
[rank3]:> Batch Time: 455.63 ms, GPU Bubble Ratio: 73.39%, 39.07%, 45.81%, 20.71%
[rank3]:2025-10-30 20:28:00,154 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2027_stage3_step2000.svg
[rank0]:2025-10-30 20:28:00,082 - INFO - Avg. fwd time: 14.6450 / Avg. bwd time: 14.0714 / Avg. batch time: 626.6161 (ms) / GPU bubble ratio: 63.34%
[rank2]:2025-10-30 20:28:00,477 - INFO - Avg. fwd time: 14.2325 / Avg. bwd time: 23.1864 / Avg. batch time: 547.1510 (ms) / GPU bubble ratio: 45.29%
[rank3]:2025-10-30 20:28:00,480 - INFO - Avg. fwd time: 15.1550 / Avg. bwd time: 30.3030 / Avg. batch time: 381.0916 (ms) / GPU bubble ratio: 4.57%
[rank1]:2025-10-30 20:28:00,515 - INFO - Avg. fwd time: 16.2086 / Avg. bwd time: 25.9465 / Avg. batch time: 596.3478 (ms) / GPU bubble ratio: 43.45%
[rank0]:2025-10-30 20:29:52,891 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 20:29:54,773 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 7,130  tflops: 332.54  mfu: 33.62%
[rank0]:2025-10-30 20:29:54,772 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 7,128  tflops: 332.44  mfu: 33.61%
[rank2]:2025-10-30 20:29:54,772 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 7,131  tflops: 332.59  mfu: 33.63%
[rank0]:2025-10-30 20:29:54,867 - INFO - Avg. fwd time: 14.6626 / Avg. bwd time: 13.7107 / Avg. batch time: 624.8943 (ms) / GPU bubble ratio: 63.68%
[rank3]:2025-10-30 20:30:00,166 - INFO -  step: 2050  loss:  2.1190  grad_norm:  0.0887  memory: 87.87GiB(62.85%)  tps: 6,811  tflops: 317.68  mfu: 32.12%
[rank2]:2025-10-30 20:30:00,482 - INFO - Avg. fwd time: 14.2521 / Avg. bwd time: 22.9982 / Avg. batch time: 546.1619 (ms) / GPU bubble ratio: 45.44%
[rank3]:2025-10-30 20:30:00,483 - INFO - Avg. fwd time: 15.1513 / Avg. bwd time: 30.2964 / Avg. batch time: 381.0247 (ms) / GPU bubble ratio: 4.58%
[rank1]:2025-10-30 20:30:00,517 - INFO - Avg. fwd time: 16.2300 / Avg. bwd time: 25.7346 / Avg. batch time: 594.9950 (ms) / GPU bubble ratio: 43.58%
[rank0]:2025-10-30 20:31:52,623 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:31:54,516 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,841  tflops: 319.08  mfu: 32.26%
[rank0]:2025-10-30 20:31:54,516 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,841  tflops: 319.08  mfu: 32.26%
[rank1]:2025-10-30 20:31:54,516 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,841  tflops: 319.08  mfu: 32.26%
[rank3]:2025-10-30 20:31:59,689 - INFO -  step: 2100  loss:  2.1731  grad_norm:  0.2338  memory: 87.87GiB(62.85%)  tps: 6,854  tflops: 319.68  mfu: 32.32%
[rank0]:2025-10-30 20:31:59,775 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2031_stage0_step2100.svg
[rank1]:2025-10-30 20:31:59,771 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2031_stage1_step2100.svg
[rank2]:2025-10-30 20:31:59,779 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2031_stage2_step2100.svg
[rank3]:2025-10-30 20:31:59,874 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2031_real_step2100_rank3.svg
[rank3]:> Batch Time: 455.59 ms, GPU Bubble Ratio: 73.37%, 39.06%, 45.80%, 20.73%
[rank3]:2025-10-30 20:31:59,938 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2031_stage3_step2100.svg
[rank2]:2025-10-30 20:32:00,359 - INFO - Avg. fwd time: 14.2706 / Avg. bwd time: 22.8189 / Avg. batch time: 545.8192 (ms) / GPU bubble ratio: 45.64%
[rank3]:2025-10-30 20:32:00,329 - INFO - Avg. fwd time: 15.1474 / Avg. bwd time: 30.2852 / Avg. batch time: 380.9223 (ms) / GPU bubble ratio: 4.58%
[rank1]:2025-10-30 20:32:00,389 - INFO - Avg. fwd time: 16.2503 / Avg. bwd time: 25.5331 / Avg. batch time: 594.3073 (ms) / GPU bubble ratio: 43.76%
[rank0]:2025-10-30 20:32:00,400 - INFO - Avg. fwd time: 14.6790 / Avg. bwd time: 13.3681 / Avg. batch time: 623.8566 (ms) / GPU bubble ratio: 64.03%
[rank0]:2025-10-30 20:33:53,601 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:33:55,478 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,772  tflops: 315.86  mfu: 31.94%
[rank1]:2025-10-30 20:33:55,479 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,772  tflops: 315.87  mfu: 31.94%
[rank2]:2025-10-30 20:33:55,477 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,772  tflops: 315.87  mfu: 31.94%
[rank0]:2025-10-30 20:33:55,576 - INFO - Avg. fwd time: 14.6927 / Avg. bwd time: 13.0878 / Avg. batch time: 622.9275 (ms) / GPU bubble ratio: 64.32%
[rank3]:2025-10-30 20:34:00,619 - INFO -  step: 2150  loss:  2.1047  grad_norm:  0.8735  memory: 87.87GiB(62.85%)  tps: 6,774  tflops: 315.95  mfu: 31.95%
[rank2]:2025-10-30 20:34:00,943 - INFO - Avg. fwd time: 14.2860 / Avg. bwd time: 22.6725 / Avg. batch time: 545.4608 (ms) / GPU bubble ratio: 45.79%
[rank3]:2025-10-30 20:34:00,945 - INFO - Avg. fwd time: 15.1426 / Avg. bwd time: 30.2893 / Avg. batch time: 380.9450 (ms) / GPU bubble ratio: 4.59%
[rank1]:2025-10-30 20:34:00,978 - INFO - Avg. fwd time: 16.2671 / Avg. bwd time: 25.3683 / Avg. batch time: 593.6655 (ms) / GPU bubble ratio: 43.89%
[rank0]:2025-10-30 20:35:51,965 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:35:53,802 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,923  tflops: 322.91  mfu: 32.65%
[rank0]:2025-10-30 20:35:53,802 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-30 20:35:53,803 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,923  tflops: 322.91  mfu: 32.65%
[rank1]:2025-10-30 20:35:53,803 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-30 20:35:53,802 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,923  tflops: 322.91  mfu: 32.65%
[rank2]:2025-10-30 20:35:53,802 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-30 20:35:59,049 - INFO -  step: 2200  loss:  1.8882  grad_norm:  0.4091  memory: 87.87GiB(62.85%)  tps: 6,917  tflops: 322.63  mfu: 32.62%
[rank3]:2025-10-30 20:35:59,049 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-30 20:36:15,094 - INFO - validate step: 2200  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 19,238
[rank3]:2025-10-30 20:36:15,149 - INFO - validate step: 2200  loss:  0.9341  memory: 87.87GiB(62.85%)  tps: 25,444
[rank2]:2025-10-30 20:36:15,147 - INFO - validate step: 2200  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 19,190
[rank1]:2025-10-30 20:36:15,130 - INFO - validate step: 2200  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 19,206
[rank2]:2025-10-30 20:36:15,234 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2036_stage2_step2200.svg
[rank0]:2025-10-30 20:36:15,232 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2036_stage0_step2200.svg
[rank0]:2025-10-30 20:36:15,327 - INFO - Avg. fwd time: 14.7075 / Avg. bwd time: 12.7752 / Avg. batch time: 621.8144 (ms) / GPU bubble ratio: 64.64%
[rank1]:2025-10-30 20:36:15,233 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2036_stage1_step2200.svg
[rank3]:2025-10-30 20:36:15,334 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2036_real_step2200_rank3.svg
[rank3]:> Batch Time: 455.68 ms, GPU Bubble Ratio: 73.35%, 39.07%, 45.81%, 20.74%
[rank3]:2025-10-30 20:36:15,400 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2036_stage3_step2200.svg
[rank3]:2025-10-30 20:36:15,716 - INFO - Avg. fwd time: 15.1408 / Avg. bwd time: 30.2660 / Avg. batch time: 380.7460 (ms) / GPU bubble ratio: 4.59%
[rank2]:2025-10-30 20:36:15,715 - INFO - Avg. fwd time: 14.3028 / Avg. bwd time: 22.5090 / Avg. batch time: 544.9843 (ms) / GPU bubble ratio: 45.96%
[rank1]:2025-10-30 20:36:15,749 - INFO - Avg. fwd time: 16.2853 / Avg. bwd time: 25.1844 / Avg. batch time: 592.8727 (ms) / GPU bubble ratio: 44.04%
[rank0]:2025-10-30 20:38:08,623 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-30 20:38:10,484 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 7,099  tflops: 331.12  mfu: 33.48%
[rank1]:2025-10-30 20:38:10,484 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 7,102  tflops: 331.22  mfu: 33.49%
[rank2]:2025-10-30 20:38:10,484 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 7,103  tflops: 331.27  mfu: 33.50%
[rank3]:2025-10-30 20:38:15,573 - INFO -  step: 2250  loss:  1.8772  grad_norm:  0.0780  memory: 87.87GiB(62.85%)  tps: 6,803  tflops: 317.28  mfu: 32.08%
[rank3]:2025-10-30 20:38:15,966 - INFO - Avg. fwd time: 15.1365 / Avg. bwd time: 30.2631 / Avg. batch time: 380.7102 (ms) / GPU bubble ratio: 4.60%
[rank1]:2025-10-30 20:38:16,031 - INFO - Avg. fwd time: 16.3028 / Avg. bwd time: 25.0093 / Avg. batch time: 592.3030 (ms) / GPU bubble ratio: 44.20%
[rank2]:2025-10-30 20:38:15,998 - INFO - Avg. fwd time: 14.3188 / Avg. bwd time: 22.3533 / Avg. batch time: 544.7139 (ms) / GPU bubble ratio: 46.14%
[rank0]:2025-10-30 20:38:16,045 - INFO - Avg. fwd time: 14.7221 / Avg. bwd time: 12.4772 / Avg. batch time: 620.9415 (ms) / GPU bubble ratio: 64.96%
[rank0]:2025-10-30 20:40:07,890 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 20:40:09,781 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,867  tflops: 320.27  mfu: 32.38%
[rank1]:2025-10-30 20:40:09,782 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,867  tflops: 320.27  mfu: 32.38%
[rank2]:2025-10-30 20:40:09,780 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,867  tflops: 320.28  mfu: 32.38%
[rank3]:2025-10-30 20:40:14,889 - INFO -  step: 2300  loss:  2.2574  grad_norm:  0.7513  memory: 87.87GiB(62.85%)  tps: 6,866  tflops: 320.23  mfu: 32.38%
[rank1]:2025-10-30 20:40:14,972 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2040_stage1_step2300.svg
[rank0]:2025-10-30 20:40:14,973 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2040_stage0_step2300.svg
[rank2]:2025-10-30 20:40:14,973 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2040_stage2_step2300.svg
[rank0]:2025-10-30 20:40:15,065 - INFO - Avg. fwd time: 14.7338 / Avg. bwd time: 12.2327 / Avg. batch time: 619.9703 (ms) / GPU bubble ratio: 65.20%
[rank3]:2025-10-30 20:40:15,069 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2040_real_step2300_rank3.svg
[rank3]:> Batch Time: 455.72 ms, GPU Bubble Ratio: 73.33%, 39.07%, 45.82%, 20.76%
[rank3]:2025-10-30 20:40:15,132 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2040_stage3_step2300.svg
[rank2]:2025-10-30 20:40:15,455 - INFO - Avg. fwd time: 14.3322 / Avg. bwd time: 22.2258 / Avg. batch time: 544.2388 (ms) / GPU bubble ratio: 46.26%
[rank3]:2025-10-30 20:40:15,458 - INFO - Avg. fwd time: 15.1342 / Avg. bwd time: 30.2519 / Avg. batch time: 380.6108 (ms) / GPU bubble ratio: 4.60%
[rank1]:2025-10-30 20:40:15,494 - INFO - Avg. fwd time: 16.3171 / Avg. bwd time: 24.8655 / Avg. batch time: 591.5813 (ms) / GPU bubble ratio: 44.31%
[rank0]:2025-10-30 20:42:08,518 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 20:42:10,428 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,790  tflops: 316.69  mfu: 32.02%
[rank0]:2025-10-30 20:42:10,428 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,790  tflops: 316.69  mfu: 32.02%
[rank2]:2025-10-30 20:42:10,427 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,790  tflops: 316.69  mfu: 32.02%
[rank0]:2025-10-30 20:42:10,527 - INFO - Avg. fwd time: 14.7468 / Avg. bwd time: 11.9592 / Avg. batch time: 618.6754 (ms) / GPU bubble ratio: 65.47%
[rank3]:2025-10-30 20:42:15,561 - INFO -  step: 2350  loss:  1.9346  grad_norm:  0.9741  memory: 87.87GiB(62.85%)  tps: 6,789  tflops: 316.63  mfu: 32.02%
[rank1]:2025-10-30 20:42:15,921 - INFO - Avg. fwd time: 16.3331 / Avg. bwd time: 24.7053 / Avg. batch time: 590.5670 (ms) / GPU bubble ratio: 44.41%
[rank2]:2025-10-30 20:42:15,883 - INFO - Avg. fwd time: 14.3471 / Avg. bwd time: 22.0831 / Avg. batch time: 543.5004 (ms) / GPU bubble ratio: 46.38%
[rank3]:2025-10-30 20:42:15,885 - INFO - Avg. fwd time: 15.1282 / Avg. bwd time: 30.2590 / Avg. batch time: 380.6516 (ms) / GPU bubble ratio: 4.61%
[rank0]:2025-10-30 20:43:52,854 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-30 20:43:53,708 - WARNING - Dataset medical is being re-looped
[rank2]:2025-10-30 20:43:56,662 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-30 20:44:02,876 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-30 20:44:07,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 20:44:09,594 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 71.17GiB(50.91%)  tps: 6,874  tflops: 320.62  mfu: 32.42%
[rank2]:2025-10-30 20:44:09,594 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 6,518  tflops: 303.99  mfu: 29.94%
[rank2]:2025-10-30 20:44:09,594 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-30 20:44:09,595 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 73.87GiB(52.83%)  tps: 6,874  tflops: 320.62  mfu: 32.42%
[rank0]:2025-10-30 20:44:09,595 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 6,517  tflops: 303.96  mfu: 29.93%
[rank0]:2025-10-30 20:44:09,595 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-30 20:44:09,595 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 80.00GiB(57.22%)  tps: 6,874  tflops: 320.62  mfu: 32.42%
[rank1]:2025-10-30 20:44:09,596 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 6,518  tflops: 303.98  mfu: 29.94%
[rank1]:2025-10-30 20:44:09,596 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-30 20:44:14,738 - INFO -  step: 2400  loss:  2.4738  grad_norm:  0.3526  memory: 87.87GiB(62.85%)  tps: 6,874  tflops: 320.60  mfu: 32.42%
[rank3]:2025-10-30 20:44:14,738 - INFO -  final step: 2400  loss:  2.4738  grad_norm:  0.3526  tps: 6,456  tflops: 301.11  mfu: 29.65%
[rank3]:2025-10-30 20:44:14,739 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-30 20:44:30,856 - INFO - validate step: 2400  loss: -1.0000  memory: 73.87GiB(52.83%)  tps: 19,266
[rank0]:2025-10-30 20:44:30,857 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-30 20:44:30,862 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-30 20:44:30,907 - INFO - validate step: 2400  loss: -1.0000  memory: 71.17GiB(50.91%)  tps: 19,219
[rank2]:2025-10-30 20:44:30,908 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-30 20:44:30,914 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-30 20:44:30,911 - INFO - validate step: 2400  loss:  0.9302  memory: 87.87GiB(62.85%)  tps: 25,329
[rank3]:2025-10-30 20:44:30,911 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-30 20:44:30,916 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-30 20:44:30,892 - INFO - validate step: 2400  loss: -1.0000  memory: 80.00GiB(57.22%)  tps: 19,234
[rank1]:2025-10-30 20:44:30,893 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-30 20:44:30,899 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-30 20:44:40,556 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-10-30 20:44:40,676 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank2/251030_2044_stage2_final2400.svg
[rank1]:2025-10-30 20:44:40,679 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank1/251030_2044_stage1_final2400.svg
[rank0]:2025-10-30 20:44:40,682 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank0/251030_2044_stage0_final2400.svg
[rank3]:2025-10-30 20:44:40,781 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2044_real_final2400_rank3.svg
[rank3]:> Batch Time: 455.75 ms, GPU Bubble Ratio: 73.32%, 39.07%, 45.82%, 20.78%
[rank2]:2025-10-30 20:44:40,992 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/frozen_params_histogram/251030_2044_rank2_stage2.svg
[rank2]:	> Counts Sum: 4051760, Total Sum: 4907520 (82.56%), Ratio(%) per element: [82.92, 82.57, 82.57, 82.57, 82.98, 82.1, 82.15, 82.39, 82.86, 82.92, 82.21, 83.09, 81.98, 82.98, 82.15, 82.74, 82.86, 82.45, 81.92, 82.1, 82.33, 82.74, 82.45, 82.8, 83.15, 82.74, 82.21, 83.15, 82.45, 83.03, 82.39, 82.86, 82.74, 82.57, 81.98, 82.1, 82.21, 82.45, 83.03, 82.92, 81.98, 81.86, 82.27, 82.39, 82.57, 82.68, 83.03, 82.68, 82.74, 82.51, 82.27, 82.45, 83.33, 82.45, 82.15, 81.8, 82.39, 83.15, 82.8, 82.45, 82.74, 82.33, 82.68, 82.51, 82.33, 82.62, 82.62, 83.09, 82.68, 82.57, 82.15, 83.03]
[rank2]:2025-10-30 20:44:40,992 - INFO - Destroying the purge thread.
[rank3]:2025-10-30 20:44:40,987 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/pipeline_schedule/251030_2044_thry_final2400_rank3.svg
[rank3]:> Batch Time: 511.69 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank0]:2025-10-30 20:44:41,010 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/frozen_params_histogram/251030_2044_rank0_stage0.svg
[rank0]:	> Counts Sum: 4250240, Total Sum: 4975680 (85.42%), Ratio(%) per element: [85.85, 85.32, 85.38, 85.32, 84.85, 85.26, 85.91, 85.56, 85.32, 85.62, 85.21, 85.03, 85.44, 85.38, 85.03, 85.97, 85.62, 85.5, 85.56, 84.91, 85.5, 85.38, 85.38, 85.62, 84.85, 84.91, 85.26, 85.68, 85.5, 85.15, 85.91, 85.21, 85.56, 85.5, 85.21, 85.21, 85.03, 85.56, 85.03, 85.56, 85.44, 85.56, 84.85, 85.68, 85.73, 85.79, 85.03, 84.85, 85.73, 85.32, 86.03, 85.09, 85.44, 85.97, 85.68, 85.44, 85.56, 85.73, 85.73, 85.32, 85.26, 85.32, 85.38, 85.79, 85.44, 85.32, 85.68, 85.62, 85.32, 85.21, 84.97, 85.21, 85.73]
[rank0]:2025-10-30 20:44:41,010 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-10-30 20:44:41,003 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/frozen_params_histogram/251030_2044_rank1_stage1.svg
[rank1]:	> Counts Sum: 3739720, Total Sum: 5520960 (67.74%), Ratio(%) per element: [67.54, 67.31, 67.42, 67.78, 66.13, 68.6, 66.37, 67.95, 68.72, 68.25, 67.25, 69.19, 66.66, 67.89, 68.07, 68.19, 68.42, 68.07, 67.13, 68.3, 68.3, 67.19, 67.6, 67.25, 67.95, 67.25, 67.66, 66.02, 68.25, 67.78, 67.95, 66.6, 68.95, 67.48, 67.19, 67.19, 68.19, 68.07, 67.19, 68.3, 67.95, 68.6, 68.83, 68.01, 67.42, 67.37, 67.19, 67.01, 67.31, 69.01, 67.42, 69.07, 66.66, 66.6, 67.48, 68.77, 69.54, 67.95, 67.07, 67.07, 68.13, 68.95, 67.72, 67.89, 68.42, 67.6, 66.72, 66.9, 67.95, 67.19, 67.19, 67.07, 67.66, 68.48, 66.72, 68.3, 67.84, 67.01, 68.89, 68.54, 67.13]
[rank1]:2025-10-30 20:44:41,004 - INFO - Destroying the purge thread.
[rank3]:2025-10-30 20:44:41,078 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/freeze_ratio_history/rank3/251030_2044_stage3_final2400.svg
[rank3]:2025-10-30 20:44:41,413 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1/frozen_params_histogram/251030_2044_rank3_stage3.svg
[rank3]:	> Counts Sum: 523680, Total Sum: 4430400 (11.82%), Ratio(%) per element: [12.14, 11.44, 12.2, 11.97, 11.91, 12.08, 12.2, 12.26, 11.67, 12.08, 11.38, 12.32, 12.5, 12.14, 12.03, 11.26, 12.08, 11.61, 12.08, 12.44, 12.38, 11.56, 11.97, 12.38, 11.67, 12.2, 11.79, 11.44, 12.67, 10.91, 11.91, 11.91, 11.44, 11.67, 12.79, 11.91, 12.5, 12.85, 12.26, 11.85, 12.08, 11.79, 11.44, 12.14, 12.32, 11.44, 11.85, 12.03, 12.38, 11.73, 11.73, 11.97, 11.61, 12.44, 12.08, 12.2, 12.2, 12.55, 12.44, 11.97, 11.56, 11.79, 11.61, 12.79, 0.0]
[rank3]:2025-10-30 20:44:41,414 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 48-48, summary, console lines 430-437
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ƒâ–ˆâ–â–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–ƒâ–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–ƒâ–â–‚â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.53782
[rank3]:wandb:               final/avg_loss 2.47384
[rank3]:wandb:             final/avg_mfu(%) 29.64641
[rank3]:wandb:             final/avg_tflops 301.10637
[rank3]:wandb:    final/avg_throughput(tps) 6455.94618
[rank3]:wandb:              final/grad_norm 0.35259
[rank3]:wandb:               final/max_loss 2.47384
[rank3]:wandb:                    grad_norm 0.35259
[rank3]:wandb: loss_metrics/global_avg_loss 2.47384
[rank3]:wandb: loss_metrics/global_max_loss 2.47384
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1030_GPipe_timelyapf_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/kips0cld
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1030_GPipe_timelyapf_dm1/20251030-1857/wandb/run-20251030_185738-kips0cld/logs
[rank0]:2025-10-30 20:44:43,010 - INFO - Training completed
[rank0]:2025-10-30 20:44:43,011 - INFO - Destroying the purge thread.
[rank2]:2025-10-30 20:44:43,258 - INFO - Process group destroyed
[rank3]:2025-10-30 20:44:43,250 - INFO - Process group destroyed
[rank1]:2025-10-30 20:44:43,233 - INFO - Process group destroyed
[rank0]:2025-10-30 20:44:43,413 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.7', 'layers.3', 'layers.1', 'layers.0', 'layers.4', 'layers.5', 'layers.2', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.12', 'layers.16', 'layers.11', 'layers.15', 'layers.10', 'layers.14', 'layers.13', 'layers.9'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.24', 'layers.21', 'layers.20', 'layers.22', 'layers.19', 'layers.23', 'layers.17'}
[rank3]:Stage 3: Modules to keep: {'output', 'layers.25', 'layers.26', 'layers.28', 'norm', 'layers.29', 'layers.30', 'layers.27', 'layers.31'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_GPipe_timelyapf_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1030_GPipe_timelyapf_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1030_GPipe_timelyapf_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_GPipe_timelyapf_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_timelyapf_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_GPipe_timelyapf_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_GPipe_timelyapf_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1030_GPipe_timelyapf_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
