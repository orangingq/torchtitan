
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Oct 31 01:34:44 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1030_1F1B_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1031 01:34:45.915000 3629364 site-packages/torch/distributed/run.py:811] 
W1031 01:34:45.915000 3629364 site-packages/torch/distributed/run.py:811] *****************************************
W1031 01:34:45.915000 3629364 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1031 01:34:45.915000 3629364 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-10-31 01:34:52,912 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-31 01:34:52,865 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-31 01:34:52,894 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-31 01:34:52,895 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-31 01:34:53,806 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-31 01:34:53,808 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 01:34:53,851 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-31 01:34:53,853 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 01:34:53,859 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-10-31 01:34:53,835 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 01:34:53,838 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-31 01:34:53,847 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-31 01:34:53,849 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 01:34:55,532 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-31 01:34:55,826 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-31 01:34:57,573 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-31 01:34:58,997 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-31 01:34:59,239 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-31 01:34:59,321 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-31 01:34:59,321 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-31 01:34:59,258 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-31 01:34:59,316 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-31 01:34:59,340 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-31 01:34:59,340 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-31 01:34:59,547 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-31 01:34:59,548 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-10-31 01:34:59,576 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-31 01:34:59,581 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-31 01:34:59,581 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-31 01:34:59,652 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-31 01:34:59,652 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-31 01:34:59,865 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-31 01:34:59,865 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 8uhbyf4w
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_auto_dm1/20251031-0134/wandb/run-20251031_013500-8uhbyf4w
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_1F1B_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/8uhbyf4w
[rank3]:2025-10-31 01:35:01,270 - INFO - WandB logging enabled
[rank3]:2025-10-31 01:35:01,271 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-31 01:35:01,344 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-31 01:35:01,344 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-31 01:35:01,583 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 01:35:01,582 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_auto_dm1
[rank0]:2025-10-31 01:35:01,582 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 01:35:01,582 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-31 01:35:01,582 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-10-31 01:35:01,560 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-31 01:35:01,561 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-31 01:35:01,582 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 01:35:05,236 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 300)
[rank0]:2025-10-31 01:35:05,236 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-31 01:35:13,985 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-31 01:35:13,985 - INFO - Finished loading the checkpoint in 8.75 seconds.
[rank0]:2025-10-31 01:35:13,985 - INFO - Training starts at step 1
[rank2]:2025-10-31 01:35:17,899 - INFO -  step:  1  loss: -4.0000  grad_norm: 254.9296  memory: 27.12GiB(19.40%)  tps: 881  tflops: 41.08  mfu: 4.15%
[rank2]:2025-10-31 01:35:17,899 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-31 01:35:17,889 - INFO -  step:  1  loss: -4.0000  grad_norm: 254.9296  memory: 32.41GiB(23.18%)  tps: 897  tflops: 41.85  mfu: 4.23%
[rank1]:2025-10-31 01:35:17,889 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 01:35:17,931 - INFO -  step:  1  loss: 17.9055  grad_norm: 254.9296  memory: 35.49GiB(25.39%)  tps: 986  tflops: 46.00  mfu: 4.65%
[rank3]:2025-10-31 01:35:17,932 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-31 01:35:17,907 - INFO -  step:  1  loss: -4.0000  grad_norm: 254.9296  memory: 37.59GiB(26.89%)  tps: 881  tflops: 41.10  mfu: 4.16%
[rank0]:2025-10-31 01:35:17,908 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 01:35:35,550 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,551 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,551 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,552 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,552 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,552 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,553 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,553 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,553 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,554 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,554 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,554 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,554 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 01:35:35,555 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,593 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,593 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,594 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,595 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 01:35:35,596 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,638 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,639 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,639 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,639 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,639 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,640 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 01:35:35,641 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,681 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,682 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,683 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:35:35,684 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 01:37:23,783 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:37:26,411 - INFO -  step: 50  loss: -4.0000  grad_norm: 189.0462  memory: 38.72GiB(27.69%)  tps: 6,247  tflops: 291.36  mfu: 29.46%
[rank0]:2025-10-31 01:37:26,417 - INFO -  step: 50  loss: -4.0000  grad_norm: 189.0462  memory: 54.93GiB(39.29%)  tps: 6,247  tflops: 291.37  mfu: 29.46%
[rank3]:2025-10-31 01:37:26,415 - INFO -  step: 50  loss:  8.7190  grad_norm: 189.0462  memory: 46.16GiB(33.01%)  tps: 6,248  tflops: 291.43  mfu: 29.47%
[rank1]:2025-10-31 01:37:26,413 - INFO -  step: 50  loss: -4.0000  grad_norm: 189.0462  memory: 47.26GiB(33.80%)  tps: 6,246  tflops: 291.33  mfu: 29.46%
[rank2]:2025-10-31 01:37:26,893 - INFO - Avg. fwd time: 12.9830 / Avg. bwd time: 35.9350 / Avg. batch time: 523.4328 (ms) / GPU bubble ratio: 25.24%
[rank3]:2025-10-31 01:37:26,864 - INFO - Avg. fwd time: 14.5453 / Avg. bwd time: 42.0070 / Avg. batch time: 471.5600 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-10-31 01:37:26,939 - INFO - Avg. fwd time: 14.8708 / Avg. bwd time: 40.8614 / Avg. batch time: 581.8059 (ms) / GPU bubble ratio: 23.37%
[rank0]:2025-10-31 01:37:26,971 - INFO - Avg. fwd time: 13.1860 / Avg. bwd time: 38.0859 / Avg. batch time: 636.5207 (ms) / GPU bubble ratio: 35.56%
[rank0]:2025-10-31 01:39:34,273 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:39:36,895 - INFO -  step: 100  loss: -4.0000  grad_norm: 20.4604  memory: 38.72GiB(27.69%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank2]:2025-10-31 01:39:36,896 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-31 01:39:36,898 - INFO -  step: 100  loss: -4.0000  grad_norm: 20.4604  memory: 47.26GiB(33.80%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank1]:2025-10-31 01:39:36,898 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 01:39:36,900 - INFO -  step: 100  loss:  2.4379  grad_norm: 20.4604  memory: 46.16GiB(33.01%)  tps: 6,278  tflops: 292.82  mfu: 29.61%
[rank3]:2025-10-31 01:39:36,900 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-31 01:39:36,902 - INFO -  step: 100  loss: -4.0000  grad_norm: 20.4604  memory: 54.93GiB(39.29%)  tps: 6,278  tflops: 292.81  mfu: 29.61%
[rank0]:2025-10-31 01:39:36,902 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 01:39:37,341 - INFO - Avg. fwd time: 14.5274 / Avg. bwd time: 42.0406 / Avg. batch time: 469.7162 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-31 01:39:37,370 - INFO - Avg. fwd time: 13.0001 / Avg. bwd time: 36.0351 / Avg. batch time: 521.6075 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-31 01:39:37,417 - INFO - Avg. fwd time: 14.8544 / Avg. bwd time: 40.9687 / Avg. batch time: 579.9852 (ms) / GPU bubble ratio: 23.00%
[rank0]:2025-10-31 01:39:37,449 - INFO - Avg. fwd time: 13.2034 / Avg. bwd time: 38.2535 / Avg. batch time: 634.8007 (ms) / GPU bubble ratio: 35.15%
[rank0]:2025-10-31 01:41:44,581 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:41:47,194 - INFO -  step: 150  loss: -4.0000  grad_norm: 26.7723  memory: 38.72GiB(27.69%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank0]:2025-10-31 01:41:47,200 - INFO -  step: 150  loss: -4.0000  grad_norm: 26.7723  memory: 54.93GiB(39.29%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank1]:2025-10-31 01:41:47,196 - INFO -  step: 150  loss: -4.0000  grad_norm: 26.7723  memory: 47.26GiB(33.80%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank3]:2025-10-31 01:41:47,198 - INFO -  step: 150  loss:  4.5970  grad_norm: 26.7723  memory: 46.16GiB(33.01%)  tps: 6,287  tflops: 293.24  mfu: 29.65%
[rank3]:2025-10-31 01:41:47,723 - INFO - Avg. fwd time: 14.5058 / Avg. bwd time: 42.0140 / Avg. batch time: 468.7348 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-10-31 01:41:47,763 - INFO - Avg. fwd time: 13.0004 / Avg. bwd time: 36.0341 / Avg. batch time: 520.5935 (ms) / GPU bubble ratio: 24.65%
[rank0]:2025-10-31 01:41:47,851 - INFO - Avg. fwd time: 13.2145 / Avg. bwd time: 38.2872 / Avg. batch time: 633.7653 (ms) / GPU bubble ratio: 34.99%
[rank1]:2025-10-31 01:41:47,808 - INFO - Avg. fwd time: 14.8510 / Avg. bwd time: 40.9816 / Avg. batch time: 578.9549 (ms) / GPU bubble ratio: 22.85%
[rank0]:2025-10-31 01:43:54,676 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:43:57,299 - INFO -  step: 200  loss: -4.0000  grad_norm:  6.2358  memory: 38.72GiB(27.69%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank2]:2025-10-31 01:43:57,299 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 01:43:57,306 - INFO -  step: 200  loss: -4.0000  grad_norm:  6.2358  memory: 54.93GiB(39.29%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank0]:2025-10-31 01:43:57,306 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 01:43:57,304 - INFO -  step: 200  loss:  3.0912  grad_norm:  6.2358  memory: 46.16GiB(33.01%)  tps: 6,297  tflops: 293.67  mfu: 29.69%
[rank3]:2025-10-31 01:43:57,304 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-31 01:43:57,301 - INFO -  step: 200  loss: -4.0000  grad_norm:  6.2358  memory: 47.26GiB(33.80%)  tps: 6,296  tflops: 293.67  mfu: 29.69%
[rank1]:2025-10-31 01:43:57,302 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 01:44:16,271 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 21,598
[rank0]:2025-10-31 01:44:16,272 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-31 01:44:16,313 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 21,542
[rank2]:2025-10-31 01:44:16,314 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-31 01:44:16,300 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 21,560
[rank1]:2025-10-31 01:44:16,301 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 01:44:16,326 - INFO - validate step: 200  loss:  0.8668  memory: 46.16GiB(33.01%)  tps: 21,534
[rank3]:2025-10-31 01:44:16,327 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-31 01:44:16,763 - INFO - Avg. fwd time: 13.0029 / Avg. bwd time: 36.0233 / Avg. batch time: 519.9242 (ms) / GPU bubble ratio: 24.56%
[rank3]:2025-10-31 01:44:16,733 - INFO - Avg. fwd time: 14.4887 / Avg. bwd time: 41.9813 / Avg. batch time: 468.0781 (ms) / GPU bubble ratio: 3.49%
[rank1]:2025-10-31 01:44:16,808 - INFO - Avg. fwd time: 14.8566 / Avg. bwd time: 40.9824 / Avg. batch time: 578.2828 (ms) / GPU bubble ratio: 22.75%
[rank0]:2025-10-31 01:44:16,840 - INFO - Avg. fwd time: 13.2263 / Avg. bwd time: 38.2978 / Avg. batch time: 633.1045 (ms) / GPU bubble ratio: 34.89%
[rank0]:2025-10-31 01:46:23,720 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 01:46:26,331 - INFO -  step: 250  loss: -4.0000  grad_norm:  4.1261  memory: 38.72GiB(27.69%)  tps: 6,301  tflops: 293.86  mfu: 29.71%
[rank3]:2025-10-31 01:46:26,336 - INFO -  step: 250  loss:  2.4505  grad_norm:  4.1261  memory: 46.16GiB(33.01%)  tps: 6,301  tflops: 293.89  mfu: 29.72%
[rank1]:2025-10-31 01:46:26,334 - INFO -  step: 250  loss: -4.0000  grad_norm:  4.1261  memory: 47.26GiB(33.80%)  tps: 6,300  tflops: 293.83  mfu: 29.71%
[rank0]:2025-10-31 01:46:26,338 - INFO -  step: 250  loss: -4.0000  grad_norm:  4.1261  memory: 54.93GiB(39.29%)  tps: 6,298  tflops: 293.75  mfu: 29.70%
[rank3]:2025-10-31 01:46:26,776 - INFO - Avg. fwd time: 14.4726 / Avg. bwd time: 41.9546 / Avg. batch time: 467.5521 (ms) / GPU bubble ratio: 3.45%
[rank2]:2025-10-31 01:46:26,805 - INFO - Avg. fwd time: 12.9958 / Avg. bwd time: 36.0068 / Avg. batch time: 519.3749 (ms) / GPU bubble ratio: 24.52%
[rank1]:2025-10-31 01:46:26,850 - INFO - Avg. fwd time: 14.8495 / Avg. bwd time: 40.9729 / Avg. batch time: 577.7096 (ms) / GPU bubble ratio: 22.70%
[rank0]:2025-10-31 01:46:26,883 - INFO - Avg. fwd time: 13.2230 / Avg. bwd time: 38.2959 / Avg. batch time: 632.5384 (ms) / GPU bubble ratio: 34.84%
[rank2]:2025-10-31 01:46:52,371 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-31 01:46:52,375 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank1]:2025-10-31 01:46:52,374 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-31 01:46:52,378 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-31 01:47:18,414 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 4.0824e+00
[rank1]:2025-10-31 01:47:18,418 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4098e+00
[rank3]:2025-10-31 01:47:18,418 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.7681e+00
[rank0]:2025-10-31 01:47:18,422 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6710e+00
[rank2]:2025-10-31 01:47:44,363 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 8.0501e+00
[rank3]:2025-10-31 01:47:44,369 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0069e+00
[rank1]:2025-10-31 01:47:44,369 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 4.0945e+00
[rank0]:2025-10-31 01:47:44,373 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.7920e+00
[rank2]:2025-10-31 01:48:10,239 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 2.8334e+00
[rank3]:2025-10-31 01:48:10,243 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.4733e+00
[rank1]:2025-10-31 01:48:10,236 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.0987e+00
[rank0]:2025-10-31 01:48:10,246 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5128e+00
[rank0]:2025-10-31 01:48:32,438 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:48:34,939 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 4.6999e+01
[rank2]:2025-10-31 01:48:34,940 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.5170  memory: 38.72GiB(27.69%)  tps: 6,370  tflops: 297.09  mfu: 30.04%
[rank3]:2025-10-31 01:48:34,940 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.7324e+01
[rank3]:2025-10-31 01:48:34,942 - INFO -  step: 300  loss:  2.1772  grad_norm:  2.5170  memory: 46.16GiB(33.01%)  tps: 6,370  tflops: 297.09  mfu: 30.04%
[rank1]:2025-10-31 01:48:34,946 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 3.7911e+01
[rank1]:2025-10-31 01:48:34,946 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.5170  memory: 47.26GiB(33.80%)  tps: 6,370  tflops: 297.08  mfu: 30.04%
[rank0]:2025-10-31 01:48:34,950 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.8002e+01
[rank0]:2025-10-31 01:48:34,950 - INFO -  step: 300  loss: -4.0000  grad_norm:  2.5170  memory: 54.93GiB(39.29%)  tps: 6,370  tflops: 297.08  mfu: 30.04%
[rank2]:2025-10-31 01:48:35,035 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0148_stage2_step300.svg
[rank1]:2025-10-31 01:48:35,030 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0148_stage1_step300.svg
[rank0]:2025-10-31 01:48:35,035 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0148_stage0_step300.svg
[rank3]:2025-10-31 01:48:35,145 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0148_real_step300_rank3.svg
[rank3]:> Batch Time: 615.93 ms, GPU Bubble Ratio: 32.79%, 27.27%, 36.16%, 26.48%
[rank3]:2025-10-31 01:48:35,211 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0148_stage3_step300.svg
[rank2]:2025-10-31 01:48:35,690 - INFO - Avg. fwd time: 13.0155 / Avg. bwd time: 35.8332 / Avg. batch time: 517.9713 (ms) / GPU bubble ratio: 24.55%
[rank3]:2025-10-31 01:48:35,652 - INFO - Avg. fwd time: 14.4800 / Avg. bwd time: 41.7606 / Avg. batch time: 466.2215 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-10-31 01:48:35,730 - INFO - Avg. fwd time: 14.8693 / Avg. bwd time: 40.8017 / Avg. batch time: 576.1340 (ms) / GPU bubble ratio: 22.70%
[rank0]:2025-10-31 01:48:35,768 - INFO - Avg. fwd time: 13.2299 / Avg. bwd time: 38.3029 / Avg. batch time: 630.9616 (ms) / GPU bubble ratio: 34.66%
[rank2]:2025-10-31 01:48:59,136 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 5.8220e+00
[rank3]:2025-10-31 01:48:59,136 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.9968e+00
[rank1]:2025-10-31 01:48:59,136 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.5680e+00
[rank0]:2025-10-31 01:48:59,140 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 5.4338e+00
[rank2]:2025-10-31 01:49:23,948 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 1.9197e+01
[rank3]:2025-10-31 01:49:23,948 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.9523e+01
[rank1]:2025-10-31 01:49:23,954 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 3.7258e+01
[rank0]:2025-10-31 01:49:23,958 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 2.5469e+01
[rank2]:2025-10-31 01:49:47,870 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 4.6548e+00
[rank3]:2025-10-31 01:49:47,871 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.3914e+00
[rank1]:2025-10-31 01:49:47,870 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.9322e+00
[rank0]:2025-10-31 01:49:47,874 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5999e+00
[rank2]:2025-10-31 01:50:12,324 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 2.0605e+00
[rank3]:2025-10-31 01:50:12,330 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.0371e+00
[rank1]:2025-10-31 01:50:12,337 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 1.7219e+00
[rank0]:2025-10-31 01:50:12,341 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 3.8140e+00
[rank0]:2025-10-31 01:50:33,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:50:36,284 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 4.7624e+00
[rank2]:2025-10-31 01:50:36,285 - INFO -  step: 350  loss: -4.0000  grad_norm:  8.1168  memory: 38.72GiB(27.69%)  tps: 6,751  tflops: 314.87  mfu: 31.84%
[rank1]:2025-10-31 01:50:36,285 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4851e+00
[rank1]:2025-10-31 01:50:36,285 - INFO -  step: 350  loss: -4.0000  grad_norm:  8.1168  memory: 47.26GiB(33.80%)  tps: 6,751  tflops: 314.88  mfu: 31.84%
[rank3]:2025-10-31 01:50:36,285 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.5796e+00
[rank3]:2025-10-31 01:50:36,287 - INFO -  step: 350  loss:  2.5998  grad_norm:  8.1168  memory: 46.16GiB(33.01%)  tps: 6,751  tflops: 314.87  mfu: 31.84%
[rank0]:2025-10-31 01:50:36,288 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 3.8127e+00
[rank0]:2025-10-31 01:50:36,289 - INFO -  step: 350  loss: -4.0000  grad_norm:  8.1168  memory: 54.93GiB(39.29%)  tps: 6,751  tflops: 314.88  mfu: 31.84%
[rank3]:2025-10-31 01:50:36,672 - INFO - Avg. fwd time: 14.5437 / Avg. bwd time: 41.1091 / Avg. batch time: 461.7228 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-31 01:50:36,712 - INFO - Avg. fwd time: 13.0640 / Avg. bwd time: 35.3859 / Avg. batch time: 513.0036 (ms) / GPU bubble ratio: 24.45%
[rank1]:2025-10-31 01:50:36,761 - INFO - Avg. fwd time: 14.9094 / Avg. bwd time: 40.4777 / Avg. batch time: 570.8266 (ms) / GPU bubble ratio: 22.38%
[rank0]:2025-10-31 01:50:36,794 - INFO - Avg. fwd time: 13.2703 / Avg. bwd time: 37.9439 / Avg. batch time: 625.2872 (ms) / GPU bubble ratio: 34.48%
[rank2]:2025-10-31 01:51:00,283 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 4.7564e+00
[rank3]:2025-10-31 01:51:00,284 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.2865e+00
[rank1]:2025-10-31 01:51:00,296 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 3.6143e+00
[rank0]:2025-10-31 01:51:00,301 - INFO - Freezing Ratio: [Stage0] 0.25, Threshold: 4.2204e+00
[rank3]:2025-10-31 01:51:24,438 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.8247e+00
[rank1]:2025-10-31 01:51:24,438 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 5.3698e+00
[rank0]:2025-10-31 01:51:24,442 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.5967e+00
[rank2]:2025-10-31 01:51:24,438 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 4.9101e+00
[rank2]:2025-10-31 01:51:48,407 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 3.3140e+00
[rank3]:2025-10-31 01:51:48,407 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 7.9247e+00
[rank1]:2025-10-31 01:51:48,419 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 3.0872e+00
[rank0]:2025-10-31 01:51:48,424 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.8618e+00
[rank2]:2025-10-31 01:52:12,340 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.7560e+00
[rank3]:2025-10-31 01:52:12,341 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6666e+00
[rank1]:2025-10-31 01:52:12,340 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.7245e+00
[rank0]:2025-10-31 01:52:12,342 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 2.8745e+00
[rank0]:2025-10-31 01:52:33,984 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:52:36,413 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 1.4690e+00
[rank2]:2025-10-31 01:52:36,413 - INFO -  step: 400  loss: -4.0000  grad_norm:  4.5922  memory: 38.72GiB(27.69%)  tps: 6,819  tflops: 318.06  mfu: 32.16%
[rank2]:2025-10-31 01:52:36,413 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-31 01:52:36,425 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 2.1227e+00
[rank1]:2025-10-31 01:52:36,426 - INFO -  step: 400  loss: -4.0000  grad_norm:  4.5922  memory: 47.26GiB(33.80%)  tps: 6,819  tflops: 318.03  mfu: 32.16%
[rank1]:2025-10-31 01:52:36,426 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-31 01:52:36,413 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.4801e+00
[rank3]:2025-10-31 01:52:36,415 - INFO -  step: 400  loss:  2.0669  grad_norm:  4.5922  memory: 46.16GiB(33.01%)  tps: 6,819  tflops: 318.06  mfu: 32.16%
[rank3]:2025-10-31 01:52:36,415 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 01:52:36,430 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 1.8549e+00
[rank0]:2025-10-31 01:52:36,430 - INFO -  step: 400  loss: -4.0000  grad_norm:  4.5922  memory: 54.93GiB(39.29%)  tps: 6,819  tflops: 318.02  mfu: 32.16%
[rank0]:2025-10-31 01:52:36,430 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-31 01:52:51,794 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 26,653
[rank3]:2025-10-31 01:52:51,814 - INFO - validate step: 400  loss:  0.8836  memory: 46.16GiB(33.01%)  tps: 26,600
[rank0]:2025-10-31 01:52:51,762 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 26,716
[rank2]:2025-10-31 01:52:51,807 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 26,608
[rank2]:2025-10-31 01:52:51,900 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0152_stage2_step400.svg
[rank1]:2025-10-31 01:52:51,892 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0152_stage1_step400.svg
[rank0]:2025-10-31 01:52:51,899 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0152_stage0_step400.svg
[rank3]:2025-10-31 01:52:51,999 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0152_real_step400_rank3.svg
[rank3]:> Batch Time: 615.19 ms, GPU Bubble Ratio: 32.69%, 27.13%, 36.14%, 26.49%
[rank3]:2025-10-31 01:52:52,068 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0152_stage3_step400.svg
[rank2]:2025-10-31 01:52:52,458 - INFO - Avg. fwd time: 13.1289 / Avg. bwd time: 34.7905 / Avg. batch time: 507.6000 (ms) / GPU bubble ratio: 24.48%
[rank1]:2025-10-31 01:52:52,497 - INFO - Avg. fwd time: 14.9431 / Avg. bwd time: 40.2617 / Avg. batch time: 565.2099 (ms) / GPU bubble ratio: 21.86%
[rank3]:2025-10-31 01:52:52,431 - INFO - Avg. fwd time: 14.6268 / Avg. bwd time: 40.1690 / Avg. batch time: 456.9385 (ms) / GPU bubble ratio: 4.06%
[rank0]:2025-10-31 01:52:52,494 - INFO - Avg. fwd time: 13.3123 / Avg. bwd time: 37.6275 / Avg. batch time: 619.3729 (ms) / GPU bubble ratio: 34.20%
[rank3]:2025-10-31 01:53:15,834 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 7.6136e-01
[rank1]:2025-10-31 01:53:15,834 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.9543e+00
[rank0]:2025-10-31 01:53:15,835 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.3083e+00
[rank2]:2025-10-31 01:53:15,834 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.3494e+00
[rank2]:2025-10-31 01:53:39,870 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 2.3690e+00
[rank3]:2025-10-31 01:53:39,870 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.4678e+00
[rank1]:2025-10-31 01:53:39,883 - INFO - Freezing Ratio: [Stage1] 0.22, Threshold: 1.1222e+01
[rank0]:2025-10-31 01:53:39,887 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.6507e+01
[rank2]:2025-10-31 01:54:03,664 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 3.5884e+00
[rank3]:2025-10-31 01:54:03,665 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.7267e+00
[rank1]:2025-10-31 01:54:03,664 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4064e+00
[rank0]:2025-10-31 01:54:03,665 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 4.8075e+00
[rank2]:2025-10-31 01:54:27,652 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 5.3717e+00
[rank1]:2025-10-31 01:54:27,664 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 6.4388e+00
[rank3]:2025-10-31 01:54:27,652 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.7109e+00
[rank0]:2025-10-31 01:54:27,668 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 6.1759e+00
[rank0]:2025-10-31 01:54:49,038 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 01:54:51,425 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 5.9451e+00
[rank2]:2025-10-31 01:54:51,426 - INFO -  step: 450  loss: -4.0000  grad_norm:  3.9837  memory: 38.72GiB(27.69%)  tps: 6,848  tflops: 319.41  mfu: 32.30%
[rank1]:2025-10-31 01:54:51,423 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 2.1857e+01
[rank1]:2025-10-31 01:54:51,423 - INFO -  step: 450  loss: -4.0000  grad_norm:  3.9837  memory: 47.26GiB(33.80%)  tps: 6,848  tflops: 319.39  mfu: 32.29%
[rank3]:2025-10-31 01:54:51,426 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6049e+00
[rank3]:2025-10-31 01:54:51,428 - INFO -  step: 450  loss:  2.0009  grad_norm:  3.9837  memory: 46.16GiB(33.01%)  tps: 6,849  tflops: 319.43  mfu: 32.30%
[rank0]:2025-10-31 01:54:51,426 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.4621e+01
[rank0]:2025-10-31 01:54:51,427 - INFO -  step: 450  loss: -4.0000  grad_norm:  3.9837  memory: 54.93GiB(39.29%)  tps: 6,846  tflops: 319.29  mfu: 32.28%
[rank3]:2025-10-31 01:54:51,884 - INFO - Avg. fwd time: 14.6864 / Avg. bwd time: 39.5107 / Avg. batch time: 453.3547 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-10-31 01:54:51,917 - INFO - Avg. fwd time: 13.1739 / Avg. bwd time: 34.3943 / Avg. batch time: 503.6705 (ms) / GPU bubble ratio: 24.45%
[rank1]:2025-10-31 01:54:51,955 - INFO - Avg. fwd time: 14.9803 / Avg. bwd time: 39.9692 / Avg. batch time: 560.9962 (ms) / GPU bubble ratio: 21.64%
[rank0]:2025-10-31 01:54:51,991 - INFO - Avg. fwd time: 13.3597 / Avg. bwd time: 37.2045 / Avg. batch time: 614.7340 (ms) / GPU bubble ratio: 34.20%
[rank2]:2025-10-31 01:55:13,464 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.0974e+01
[rank1]:2025-10-31 01:55:13,467 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.6774e+00
[rank3]:2025-10-31 01:55:13,464 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.2214e+00
[rank0]:2025-10-31 01:55:13,471 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.5242e+00
[rank2]:2025-10-31 01:55:36,468 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 5.5603e+00
[rank3]:2025-10-31 01:55:36,481 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.2422e+00
[rank1]:2025-10-31 01:55:36,468 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 2.3403e+00
[rank0]:2025-10-31 01:55:36,481 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 5.0718e+00
[rank2]:2025-10-31 01:55:58,514 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.8073e+00
[rank1]:2025-10-31 01:55:58,517 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.4968e+00
[rank3]:2025-10-31 01:55:58,514 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.9831e+00
[rank0]:2025-10-31 01:55:58,521 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.9674e+00
[rank2]:2025-10-31 01:56:21,192 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.9814e+00
[rank1]:2025-10-31 01:56:21,192 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.7584e+00
[rank3]:2025-10-31 01:56:21,205 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.5332e-01
[rank0]:2025-10-31 01:56:21,200 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 2.9589e+00
[rank0]:2025-10-31 01:56:41,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 01:56:43,250 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.0248e+00
[rank2]:2025-10-31 01:56:43,250 - INFO -  step: 500  loss: -4.0000  grad_norm:  3.3368  memory: 38.72GiB(27.69%)  tps: 7,326  tflops: 341.68  mfu: 34.55%
[rank1]:2025-10-31 01:56:43,253 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3285e+00
[rank1]:2025-10-31 01:56:43,254 - INFO -  step: 500  loss: -4.0000  grad_norm:  3.3368  memory: 47.26GiB(33.80%)  tps: 7,325  tflops: 341.66  mfu: 34.55%
[rank3]:2025-10-31 01:56:43,250 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.2719e+00
[rank3]:2025-10-31 01:56:43,253 - INFO -  step: 500  loss:  3.1373  grad_norm:  3.3368  memory: 46.16GiB(33.01%)  tps: 7,326  tflops: 341.68  mfu: 34.55%
[rank0]:2025-10-31 01:56:43,257 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.0874e+00
[rank0]:2025-10-31 01:56:43,258 - INFO -  step: 500  loss: -4.0000  grad_norm:  3.3368  memory: 54.93GiB(39.29%)  tps: 7,325  tflops: 341.66  mfu: 34.55%
[rank2]:2025-10-31 01:56:43,330 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0156_stage2_step500.svg
[rank1]:2025-10-31 01:56:43,334 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0156_stage1_step500.svg
[rank0]:2025-10-31 01:56:43,331 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0156_stage0_step500.svg
[rank3]:2025-10-31 01:56:43,437 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0156_real_step500_rank3.svg
[rank3]:> Batch Time: 609.65 ms, GPU Bubble Ratio: 32.05%, 26.48%, 35.99%, 26.69%
[rank3]:2025-10-31 01:56:43,499 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0156_stage3_step500.svg
[rank2]:2025-10-31 01:56:43,856 - INFO - Avg. fwd time: 13.2464 / Avg. bwd time: 33.6497 / Avg. batch time: 498.8645 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-10-31 01:56:43,871 - INFO - Avg. fwd time: 15.0672 / Avg. bwd time: 39.0581 / Avg. batch time: 555.2691 (ms) / GPU bubble ratio: 22.02%
[rank3]:2025-10-31 01:56:43,858 - INFO - Avg. fwd time: 14.7375 / Avg. bwd time: 39.0043 / Avg. batch time: 449.3167 (ms) / GPU bubble ratio: 4.31%
[rank0]:2025-10-31 01:56:43,892 - INFO - Avg. fwd time: 13.4301 / Avg. bwd time: 36.5111 / Avg. batch time: 608.2921 (ms) / GPU bubble ratio: 34.32%
[rank2]:2025-10-31 01:57:06,134 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.2556e+00
[rank1]:2025-10-31 01:57:06,134 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 4.2504e+00
[rank3]:2025-10-31 01:57:06,147 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.5169e-01
[rank0]:2025-10-31 01:57:06,141 - INFO - Freezing Ratio: [Stage0] 0.37, Threshold: 7.5756e+00
[rank2]:2025-10-31 01:57:28,198 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 3.2874e+00
[rank3]:2025-10-31 01:57:28,198 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.4523e+00
[rank1]:2025-10-31 01:57:28,201 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.7082e+00
[rank0]:2025-10-31 01:57:28,206 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 5.2352e+00
[rank2]:2025-10-31 01:57:50,936 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.2045e+00
[rank3]:2025-10-31 01:57:50,949 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.8571e+00
[rank1]:2025-10-31 01:57:50,936 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 5.8348e+00
[rank0]:2025-10-31 01:57:50,943 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.0433e+01
[rank2]:2025-10-31 01:58:12,691 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.9484e+00
[rank1]:2025-10-31 01:58:12,694 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.1350e-01
[rank3]:2025-10-31 01:58:12,691 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.5657e+00
[rank0]:2025-10-31 01:58:12,692 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 2.5857e+00
[rank0]:2025-10-31 01:58:33,187 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 01:58:35,452 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.7188e+00
[rank1]:2025-10-31 01:58:35,453 - INFO -  step: 550  loss: -4.0000  grad_norm:  3.8798  memory: 47.26GiB(33.80%)  tps: 7,301  tflops: 340.54  mfu: 34.43%
[rank3]:2025-10-31 01:58:35,465 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.3876e+00
[rank3]:2025-10-31 01:58:35,468 - INFO -  step: 550  loss:  2.1405  grad_norm:  3.8798  memory: 46.16GiB(33.01%)  tps: 7,300  tflops: 340.49  mfu: 34.43%
[rank2]:2025-10-31 01:58:35,452 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.6872e+00
[rank2]:2025-10-31 01:58:35,453 - INFO -  step: 550  loss: -4.0000  grad_norm:  3.8798  memory: 38.72GiB(27.69%)  tps: 7,301  tflops: 340.53  mfu: 34.43%
[rank0]:2025-10-31 01:58:35,459 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 1.8823e+00
[rank0]:2025-10-31 01:58:35,460 - INFO -  step: 550  loss: -4.0000  grad_norm:  3.8798  memory: 54.93GiB(39.29%)  tps: 7,301  tflops: 340.53  mfu: 34.43%
[rank1]:2025-10-31 01:58:35,886 - INFO - Avg. fwd time: 15.1560 / Avg. bwd time: 38.1228 / Avg. batch time: 550.0991 (ms) / GPU bubble ratio: 22.52%
[rank3]:2025-10-31 01:58:35,818 - INFO - Avg. fwd time: 14.7854 / Avg. bwd time: 38.5644 / Avg. batch time: 445.8033 (ms) / GPU bubble ratio: 4.26%
[rank2]:2025-10-31 01:58:35,846 - INFO - Avg. fwd time: 13.3199 / Avg. bwd time: 32.8970 / Avg. batch time: 494.6338 (ms) / GPU bubble ratio: 25.25%
[rank0]:2025-10-31 01:58:35,883 - INFO - Avg. fwd time: 13.5218 / Avg. bwd time: 35.6019 / Avg. batch time: 602.1954 (ms) / GPU bubble ratio: 34.74%
[rank1]:2025-10-31 01:58:57,248 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.8324e+00
[rank3]:2025-10-31 01:58:57,245 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.7067e+01
[rank2]:2025-10-31 01:58:57,245 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.6536e+01
[rank0]:2025-10-31 01:58:57,246 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1111e+01
[rank1]:2025-10-31 01:59:18,324 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 5.5346e+00
[rank3]:2025-10-31 01:59:18,330 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.4645e+00
[rank2]:2025-10-31 01:59:18,323 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 6.2540e+00
[rank0]:2025-10-31 01:59:18,328 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.3979e+00
[rank1]:2025-10-31 01:59:40,123 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.9701e-01
[rank3]:2025-10-31 01:59:40,120 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2837e+00
[rank0]:2025-10-31 01:59:40,121 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3230e+00
[rank2]:2025-10-31 01:59:40,120 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.4793e+00
[rank2]:2025-10-31 02:00:01,181 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.5695e+00
[rank1]:2025-10-31 02:00:01,181 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 2.2481e+00
[rank3]:2025-10-31 02:00:01,187 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.6853e+00
[rank0]:2025-10-31 02:00:01,185 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 3.1376e+00
[rank0]:2025-10-31 02:00:20,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 02:00:22,921 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.8419e-01
[rank1]:2025-10-31 02:00:22,921 - INFO -  step: 600  loss: -4.0000  grad_norm:  4.6284  memory: 47.26GiB(33.80%)  tps: 7,623  tflops: 355.52  mfu: 35.95%
[rank1]:2025-10-31 02:00:22,921 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-31 02:00:22,918 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.9375e+00
[rank3]:2025-10-31 02:00:22,920 - INFO -  step: 600  loss:  2.5117  grad_norm:  4.6284  memory: 46.16GiB(33.01%)  tps: 7,624  tflops: 355.58  mfu: 35.95%
[rank3]:2025-10-31 02:00:22,920 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 02:00:22,918 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.2895e+00
[rank0]:2025-10-31 02:00:22,919 - INFO -  step: 600  loss: -4.0000  grad_norm:  4.6284  memory: 54.93GiB(39.29%)  tps: 7,623  tflops: 355.56  mfu: 35.95%
[rank0]:2025-10-31 02:00:22,919 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 02:00:22,917 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.4907e+00
[rank2]:2025-10-31 02:00:22,918 - INFO -  step: 600  loss: -4.0000  grad_norm:  4.6284  memory: 38.72GiB(27.69%)  tps: 7,623  tflops: 355.54  mfu: 35.95%
[rank2]:2025-10-31 02:00:22,918 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 02:00:38,910 - INFO - validate step: 600  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,612
[rank0]:2025-10-31 02:00:38,861 - INFO - validate step: 600  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,693
[rank1]:2025-10-31 02:00:38,896 - INFO - validate step: 600  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,641
[rank3]:2025-10-31 02:00:38,914 - INFO - validate step: 600  loss:  0.9021  memory: 46.16GiB(33.01%)  tps: 25,611
[rank2]:2025-10-31 02:00:38,993 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0200_stage2_step600.svg
[rank0]:2025-10-31 02:00:38,992 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0200_stage0_step600.svg
[rank1]:2025-10-31 02:00:38,995 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0200_stage1_step600.svg
[rank3]:2025-10-31 02:00:39,094 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0200_real_step600_rank3.svg
[rank3]:> Batch Time: 588.84 ms, GPU Bubble Ratio: 30.47%, 24.74%, 36.31%, 29.02%
[rank3]:2025-10-31 02:00:39,159 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0200_stage3_step600.svg
[rank3]:2025-10-31 02:00:39,567 - INFO - Avg. fwd time: 14.8464 / Avg. bwd time: 37.9815 / Avg. batch time: 441.3173 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-31 02:00:39,596 - INFO - Avg. fwd time: 13.3775 / Avg. bwd time: 32.3209 / Avg. batch time: 489.5966 (ms) / GPU bubble ratio: 25.33%
[rank1]:2025-10-31 02:00:39,628 - INFO - Avg. fwd time: 15.2266 / Avg. bwd time: 37.4231 / Avg. batch time: 544.3523 (ms) / GPU bubble ratio: 22.62%
[rank0]:2025-10-31 02:00:39,656 - INFO - Avg. fwd time: 13.6181 / Avg. bwd time: 34.6383 / Avg. batch time: 595.4635 (ms) / GPU bubble ratio: 35.17%
[rank1]:2025-10-31 02:01:00,285 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.3082e+00
[rank3]:2025-10-31 02:01:00,292 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4293e+00
[rank2]:2025-10-31 02:01:00,286 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.3673e+00
[rank0]:2025-10-31 02:01:00,289 - INFO - Freezing Ratio: [Stage0] 0.62, Threshold: 4.1403e+00
[rank0]:2025-10-31 02:01:21,651 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.7524e+00
[rank2]:2025-10-31 02:01:21,650 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.2240e+00
[rank1]:2025-10-31 02:01:21,653 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 9.0091e-01
[rank3]:2025-10-31 02:01:21,647 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.3630e+00
[rank1]:2025-10-31 02:01:42,733 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.3910e+01
[rank3]:2025-10-31 02:01:42,739 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.7488e+00
[rank0]:2025-10-31 02:01:42,737 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3845e+01
[rank2]:2025-10-31 02:01:42,733 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.8725e+01
[rank3]:2025-10-31 02:02:03,107 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.4155e+00
[rank1]:2025-10-31 02:02:03,104 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.0235e+00
[rank0]:2025-10-31 02:02:03,107 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 6.3552e+00
[rank2]:2025-10-31 02:02:03,103 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 6.4428e+00
[rank0]:2025-10-31 02:02:21,997 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 02:02:24,096 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6589e+00
[rank0]:2025-10-31 02:02:24,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.4557  memory: 54.93GiB(39.29%)  tps: 7,785  tflops: 363.07  mfu: 36.71%
[rank2]:2025-10-31 02:02:24,092 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.1782e+00
[rank2]:2025-10-31 02:02:24,092 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.4557  memory: 38.72GiB(27.69%)  tps: 7,788  tflops: 363.25  mfu: 36.73%
[rank3]:2025-10-31 02:02:24,098 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.8388e+00
[rank3]:2025-10-31 02:02:24,101 - INFO -  step: 650  loss:  2.2181  grad_norm:  4.4557  memory: 46.16GiB(33.01%)  tps: 7,788  tflops: 363.24  mfu: 36.73%
[rank1]:2025-10-31 02:02:24,089 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.2828e+00
[rank1]:2025-10-31 02:02:24,089 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.4557  memory: 47.26GiB(33.80%)  tps: 7,788  tflops: 363.22  mfu: 36.73%
[rank3]:2025-10-31 02:02:24,441 - INFO - Avg. fwd time: 14.8990 / Avg. bwd time: 37.4614 / Avg. batch time: 437.5278 (ms) / GPU bubble ratio: 4.26%
[rank1]:2025-10-31 02:02:24,473 - INFO - Avg. fwd time: 15.2960 / Avg. bwd time: 36.7011 / Avg. batch time: 539.2746 (ms) / GPU bubble ratio: 22.86%
[rank0]:2025-10-31 02:02:24,483 - INFO - Avg. fwd time: 13.6983 / Avg. bwd time: 33.8702 / Avg. batch time: 589.6013 (ms) / GPU bubble ratio: 35.46%
[rank2]:2025-10-31 02:02:24,458 - INFO - Avg. fwd time: 13.4330 / Avg. bwd time: 31.7805 / Avg. batch time: 485.2412 (ms) / GPU bubble ratio: 25.46%
[rank3]:2025-10-31 02:02:44,363 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.9442e+00
[rank1]:2025-10-31 02:02:44,359 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.5089e+00
[rank0]:2025-10-31 02:02:44,360 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.4393e+01
[rank2]:2025-10-31 02:02:44,359 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.3561e+00
[rank3]:2025-10-31 02:03:05,203 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4398e+01
[rank1]:2025-10-31 02:03:05,193 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.4135e+00
[rank0]:2025-10-31 02:03:05,197 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9218e+00
[rank2]:2025-10-31 02:03:05,196 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.2830e+00
[rank3]:2025-10-31 02:03:25,321 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.3580e+00
[rank1]:2025-10-31 02:03:25,317 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.6014e+00
[rank0]:2025-10-31 02:03:25,318 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5964e+01
[rank2]:2025-10-31 02:03:25,314 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.8735e+00
[rank1]:2025-10-31 02:03:46,243 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 5.4063e+00
[rank0]:2025-10-31 02:03:46,247 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8615e+00
[rank2]:2025-10-31 02:03:46,246 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2043e+00
[rank3]:2025-10-31 02:03:46,253 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7713e+00
[rank0]:2025-10-31 02:04:04,280 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:04:06,318 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.7624e+00
[rank3]:2025-10-31 02:04:06,321 - INFO -  step: 700  loss:  2.5701  grad_norm:  8.1650  memory: 46.16GiB(33.01%)  tps: 8,014  tflops: 373.78  mfu: 37.79%
[rank1]:2025-10-31 02:04:06,315 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.5707e+00
[rank1]:2025-10-31 02:04:06,315 - INFO -  step: 700  loss: -4.0000  grad_norm:  8.1650  memory: 47.26GiB(33.80%)  tps: 8,014  tflops: 373.76  mfu: 37.79%
[rank0]:2025-10-31 02:04:06,316 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.6199e+00
[rank0]:2025-10-31 02:04:06,316 - INFO -  step: 700  loss: -4.0000  grad_norm:  8.1650  memory: 54.93GiB(39.29%)  tps: 8,014  tflops: 373.78  mfu: 37.79%
[rank0]:2025-10-31 02:04:06,393 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0204_stage0_step700.svg
[rank2]:2025-10-31 02:04:06,312 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 2.4534e+00
[rank2]:2025-10-31 02:04:06,312 - INFO -  step: 700  loss: -4.0000  grad_norm:  8.1650  memory: 38.72GiB(27.69%)  tps: 8,014  tflops: 373.78  mfu: 37.79%
[rank2]:2025-10-31 02:04:06,405 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0204_stage2_step700.svg
[rank1]:2025-10-31 02:04:06,406 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0204_stage1_step700.svg
[rank3]:2025-10-31 02:04:06,502 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0204_real_step700_rank3.svg
[rank3]:> Batch Time: 586.34 ms, GPU Bubble Ratio: 30.40%, 24.64%, 36.32%, 29.22%
[rank3]:2025-10-31 02:04:06,574 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0204_stage3_step700.svg
[rank3]:2025-10-31 02:04:06,893 - INFO - Avg. fwd time: 14.9564 / Avg. bwd time: 36.9269 / Avg. batch time: 433.4692 (ms) / GPU bubble ratio: 4.25%
[rank1]:2025-10-31 02:04:06,917 - INFO - Avg. fwd time: 15.3812 / Avg. bwd time: 35.7744 / Avg. batch time: 533.5672 (ms) / GPU bubble ratio: 23.30%
[rank0]:2025-10-31 02:04:06,929 - INFO - Avg. fwd time: 13.8002 / Avg. bwd time: 32.8837 / Avg. batch time: 582.8813 (ms) / GPU bubble ratio: 35.93%
[rank2]:2025-10-31 02:04:06,907 - INFO - Avg. fwd time: 13.5016 / Avg. bwd time: 31.0881 / Avg. batch time: 480.4615 (ms) / GPU bubble ratio: 25.76%
[rank3]:2025-10-31 02:04:27,455 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1757e+00
[rank1]:2025-10-31 02:04:27,445 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.5965e+01
[rank2]:2025-10-31 02:04:27,448 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7257e+00
[rank0]:2025-10-31 02:04:27,449 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7491e+01
[rank2]:2025-10-31 02:04:47,505 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 5.6796e+00
[rank0]:2025-10-31 02:04:47,509 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.1095e+00
[rank3]:2025-10-31 02:04:47,512 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.2125e+00
[rank1]:2025-10-31 02:04:47,505 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.0955e+00
[rank3]:2025-10-31 02:05:08,379 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.2238e+00
[rank1]:2025-10-31 02:05:08,369 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.8415e+00
[rank2]:2025-10-31 02:05:08,372 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3862e+00
[rank0]:2025-10-31 02:05:08,373 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.4415e+00
[rank3]:2025-10-31 02:05:28,392 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.8201e+00
[rank1]:2025-10-31 02:05:28,386 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.3821e+01
[rank2]:2025-10-31 02:05:28,386 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.2985e+00
[rank0]:2025-10-31 02:05:28,390 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.0412e+01
[rank0]:2025-10-31 02:05:47,103 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:05:49,217 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.7605e+00
[rank3]:2025-10-31 02:05:49,219 - INFO -  step: 750  loss:  2.1779  grad_norm:  2.4891  memory: 46.16GiB(33.01%)  tps: 7,961  tflops: 371.32  mfu: 37.54%
[rank1]:2025-10-31 02:05:49,207 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2341e+00
[rank1]:2025-10-31 02:05:49,207 - INFO -  step: 750  loss: -4.0000  grad_norm:  2.4891  memory: 47.26GiB(33.80%)  tps: 7,962  tflops: 371.34  mfu: 37.55%
[rank2]:2025-10-31 02:05:49,210 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2076e+00
[rank2]:2025-10-31 02:05:49,210 - INFO -  step: 750  loss: -4.0000  grad_norm:  2.4891  memory: 38.72GiB(27.69%)  tps: 7,961  tflops: 371.32  mfu: 37.54%
[rank0]:2025-10-31 02:05:49,210 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4746e+00
[rank0]:2025-10-31 02:05:49,211 - INFO -  step: 750  loss: -4.0000  grad_norm:  2.4891  memory: 54.93GiB(39.29%)  tps: 7,962  tflops: 371.33  mfu: 37.55%
[rank2]:2025-10-31 02:05:49,677 - INFO - Avg. fwd time: 13.5622 / Avg. bwd time: 30.4760 / Avg. batch time: 476.5081 (ms) / GPU bubble ratio: 26.07%
[rank3]:2025-10-31 02:05:49,650 - INFO - Avg. fwd time: 15.0039 / Avg. bwd time: 36.4849 / Avg. batch time: 430.1050 (ms) / GPU bubble ratio: 4.23%
[rank1]:2025-10-31 02:05:49,706 - INFO - Avg. fwd time: 15.4612 / Avg. bwd time: 34.8893 / Avg. batch time: 528.7336 (ms) / GPU bubble ratio: 23.82%
[rank0]:2025-10-31 02:05:49,733 - INFO - Avg. fwd time: 13.8898 / Avg. bwd time: 32.0188 / Avg. batch time: 577.1653 (ms) / GPU bubble ratio: 36.37%
[rank2]:2025-10-31 02:06:09,301 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.2062e+00
[rank0]:2025-10-31 02:06:09,305 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7279e+00
[rank3]:2025-10-31 02:06:09,308 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.1104e+00
[rank1]:2025-10-31 02:06:09,301 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.6396e+00
[rank2]:2025-10-31 02:06:30,190 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.6069e+00
[rank0]:2025-10-31 02:06:30,191 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.9645e+01
[rank1]:2025-10-31 02:06:30,187 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.0200e+01
[rank3]:2025-10-31 02:06:30,197 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0919e+00
[rank2]:2025-10-31 02:06:50,126 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 9.2919e+00
[rank0]:2025-10-31 02:06:50,130 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4606e+00
[rank1]:2025-10-31 02:06:50,126 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.9481e+00
[rank3]:2025-10-31 02:06:50,133 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.7026e+00
[rank2]:2025-10-31 02:07:10,936 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8060e+00
[rank0]:2025-10-31 02:07:10,940 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2921e+02
[rank1]:2025-10-31 02:07:10,936 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.3060e+01
[rank3]:2025-10-31 02:07:10,946 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.7154e+00
[rank0]:2025-10-31 02:07:28,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:07:30,855 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.1001e+00
[rank2]:2025-10-31 02:07:30,855 - INFO -  step: 800  loss: -4.0000  grad_norm:  6.7893  memory: 38.72GiB(27.69%)  tps: 8,059  tflops: 375.89  mfu: 38.01%
[rank2]:2025-10-31 02:07:30,855 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 02:07:30,862 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.6839e+00
[rank0]:2025-10-31 02:07:30,862 - INFO -  step: 800  loss: -4.0000  grad_norm:  6.7893  memory: 54.93GiB(39.29%)  tps: 8,059  tflops: 375.87  mfu: 38.01%
[rank0]:2025-10-31 02:07:30,862 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 02:07:30,858 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.5209e+00
[rank1]:2025-10-31 02:07:30,858 - INFO -  step: 800  loss: -4.0000  grad_norm:  6.7893  memory: 47.26GiB(33.80%)  tps: 8,059  tflops: 375.87  mfu: 38.01%
[rank1]:2025-10-31 02:07:30,858 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 02:07:30,865 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.8124e+00
[rank3]:2025-10-31 02:07:30,867 - INFO -  step: 800  loss:  2.9181  grad_norm:  6.7893  memory: 46.16GiB(33.01%)  tps: 8,059  tflops: 375.89  mfu: 38.01%
[rank3]:2025-10-31 02:07:30,867 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 02:07:46,998 - INFO - validate step: 800  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,385
[rank2]:2025-10-31 02:07:47,048 - INFO - validate step: 800  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,295
[rank1]:2025-10-31 02:07:47,033 - INFO - validate step: 800  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,324
[rank3]:2025-10-31 02:07:47,051 - INFO - validate step: 800  loss:  0.8895  memory: 46.16GiB(33.01%)  tps: 25,310
[rank2]:2025-10-31 02:07:47,129 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0207_stage2_step800.svg
[rank0]:2025-10-31 02:07:47,128 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0207_stage0_step800.svg
[rank1]:2025-10-31 02:07:47,141 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0207_stage1_step800.svg
[rank3]:2025-10-31 02:07:47,235 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0207_real_step800_rank3.svg
[rank3]:> Batch Time: 559.24 ms, GPU Bubble Ratio: 32.94%, 26.56%, 39.18%, 26.02%
[rank3]:2025-10-31 02:07:47,311 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0207_stage3_step800.svg
[rank2]:2025-10-31 02:07:47,642 - INFO - Avg. fwd time: 13.6141 / Avg. bwd time: 29.9492 / Avg. batch time: 473.2947 (ms) / GPU bubble ratio: 26.37%
[rank0]:2025-10-31 02:07:47,669 - INFO - Avg. fwd time: 13.9571 / Avg. bwd time: 31.3683 / Avg. batch time: 572.6156 (ms) / GPU bubble ratio: 36.68%
[rank1]:2025-10-31 02:07:47,657 - INFO - Avg. fwd time: 15.5219 / Avg. bwd time: 34.2170 / Avg. batch time: 524.8501 (ms) / GPU bubble ratio: 24.19%
[rank3]:2025-10-31 02:07:47,634 - INFO - Avg. fwd time: 15.0413 / Avg. bwd time: 36.1338 / Avg. batch time: 427.4386 (ms) / GPU bubble ratio: 4.22%
[rank0]:2025-10-31 02:08:08,021 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4070e+01
[rank3]:2025-10-31 02:08:08,026 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5421e+00
[rank1]:2025-10-31 02:08:08,017 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.1533e+00
[rank2]:2025-10-31 02:08:08,017 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0638e+00
[rank1]:2025-10-31 02:08:27,960 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 7.6400e-01
[rank2]:2025-10-31 02:08:27,957 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2109e+00
[rank0]:2025-10-31 02:08:27,964 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5316e+00
[rank3]:2025-10-31 02:08:27,967 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.7402e+00
[rank2]:2025-10-31 02:08:48,715 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3155e+00
[rank0]:2025-10-31 02:08:48,719 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.1514e+00
[rank3]:2025-10-31 02:08:48,725 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.9315e+00
[rank1]:2025-10-31 02:08:48,715 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.7943e+00
[rank0]:2025-10-31 02:09:08,675 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.9043e+01
[rank3]:2025-10-31 02:09:08,678 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.2507e+00
[rank1]:2025-10-31 02:09:08,671 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.3888e+01
[rank2]:2025-10-31 02:09:08,668 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.8254e+00
[rank0]:2025-10-31 02:09:27,409 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 02:09:29,491 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2343e+00
[rank0]:2025-10-31 02:09:29,491 - INFO -  step: 850  loss: -4.0000  grad_norm:  2.0909  memory: 54.93GiB(39.29%)  tps: 7,993  tflops: 372.79  mfu: 37.69%
[rank1]:2025-10-31 02:09:29,487 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6833e+00
[rank1]:2025-10-31 02:09:29,487 - INFO -  step: 850  loss: -4.0000  grad_norm:  2.0909  memory: 47.26GiB(33.80%)  tps: 7,996  tflops: 372.93  mfu: 37.71%
[rank3]:2025-10-31 02:09:29,496 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.4616e+00
[rank3]:2025-10-31 02:09:29,499 - INFO -  step: 850  loss:  2.1251  grad_norm:  2.0909  memory: 46.16GiB(33.01%)  tps: 7,996  tflops: 372.95  mfu: 37.71%
[rank2]:2025-10-31 02:09:29,486 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9132e+00
[rank2]:2025-10-31 02:09:29,487 - INFO -  step: 850  loss: -4.0000  grad_norm:  2.0909  memory: 38.72GiB(27.69%)  tps: 7,997  tflops: 372.98  mfu: 37.71%
[rank2]:2025-10-31 02:09:29,853 - INFO - Avg. fwd time: 13.6782 / Avg. bwd time: 29.3154 / Avg. batch time: 470.0433 (ms) / GPU bubble ratio: 26.83%
[rank0]:2025-10-31 02:09:29,877 - INFO - Avg. fwd time: 14.0283 / Avg. bwd time: 30.6977 / Avg. batch time: 567.9897 (ms) / GPU bubble ratio: 37.00%
[rank1]:2025-10-31 02:09:29,863 - INFO - Avg. fwd time: 15.5857 / Avg. bwd time: 33.5236 / Avg. batch time: 520.9092 (ms) / GPU bubble ratio: 24.58%
[rank3]:2025-10-31 02:09:29,846 - INFO - Avg. fwd time: 15.0797 / Avg. bwd time: 35.7858 / Avg. batch time: 424.8008 (ms) / GPU bubble ratio: 4.21%
[rank2]:2025-10-31 02:09:49,238 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0232e+00
[rank0]:2025-10-31 02:09:49,246 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3707e+00
[rank1]:2025-10-31 02:09:49,238 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.0865e+00
[rank3]:2025-10-31 02:09:49,248 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.8784e+00
[rank2]:2025-10-31 02:10:09,991 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.7761e-01
[rank0]:2025-10-31 02:10:09,995 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.3603e+01
[rank1]:2025-10-31 02:10:09,991 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0693e+00
[rank3]:2025-10-31 02:10:10,001 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.0098e+00
[rank0]:2025-10-31 02:10:29,824 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9513e+00
[rank1]:2025-10-31 02:10:29,817 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.4647e+00
[rank3]:2025-10-31 02:10:29,826 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2126e+00
[rank2]:2025-10-31 02:10:29,817 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.2347e+00
[rank2]:2025-10-31 02:10:50,509 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7483e+00
[rank0]:2025-10-31 02:10:50,513 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6600e+00
[rank1]:2025-10-31 02:10:50,509 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5129e+00
[rank3]:2025-10-31 02:10:50,519 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.9481e+00
[rank0]:2025-10-31 02:11:08,363 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:11:10,339 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.0134e+00
[rank2]:2025-10-31 02:11:10,339 - INFO -  step: 900  loss: -4.0000  grad_norm:  3.7856  memory: 38.72GiB(27.69%)  tps: 8,123  tflops: 378.85  mfu: 38.31%
[rank0]:2025-10-31 02:11:10,346 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3965e+01
[rank0]:2025-10-31 02:11:10,347 - INFO -  step: 900  loss: -4.0000  grad_norm:  3.7856  memory: 54.93GiB(39.29%)  tps: 8,123  tflops: 378.84  mfu: 38.30%
[rank1]:2025-10-31 02:11:10,339 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.1384e+00
[rank1]:2025-10-31 02:11:10,339 - INFO -  step: 900  loss: -4.0000  grad_norm:  3.7856  memory: 47.26GiB(33.80%)  tps: 8,123  tflops: 378.85  mfu: 38.31%
[rank3]:2025-10-31 02:11:10,349 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0991e+00
[rank3]:2025-10-31 02:11:10,351 - INFO -  step: 900  loss:  2.4045  grad_norm:  3.7856  memory: 46.16GiB(33.01%)  tps: 8,123  tflops: 378.85  mfu: 38.31%
[rank2]:2025-10-31 02:11:10,421 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0211_stage2_step900.svg
[rank0]:2025-10-31 02:11:10,418 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0211_stage0_step900.svg
[rank1]:2025-10-31 02:11:10,421 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0211_stage1_step900.svg
[rank3]:2025-10-31 02:11:10,531 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0211_real_step900_rank3.svg
[rank3]:> Batch Time: 548.12 ms, GPU Bubble Ratio: 34.47%, 27.51%, 38.15%, 25.66%
[rank3]:2025-10-31 02:11:10,597 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0211_stage3_step900.svg
[rank2]:2025-10-31 02:11:11,031 - INFO - Avg. fwd time: 13.7352 / Avg. bwd time: 28.7400 / Avg. batch time: 467.0106 (ms) / GPU bubble ratio: 27.24%
[rank0]:2025-10-31 02:11:11,088 - INFO - Avg. fwd time: 14.0885 / Avg. bwd time: 30.1034 / Avg. batch time: 563.6530 (ms) / GPU bubble ratio: 37.28%
[rank3]:2025-10-31 02:11:11,004 - INFO - Avg. fwd time: 15.1132 / Avg. bwd time: 35.4610 / Avg. batch time: 422.3277 (ms) / GPU bubble ratio: 4.20%
[rank1]:2025-10-31 02:11:11,061 - INFO - Avg. fwd time: 15.6481 / Avg. bwd time: 32.8252 / Avg. batch time: 517.1807 (ms) / GPU bubble ratio: 25.02%
[rank1]:2025-10-31 02:11:31,303 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.3818e+00
[rank2]:2025-10-31 02:11:31,303 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.2764e+00
[rank0]:2025-10-31 02:11:31,307 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2195e+00
[rank3]:2025-10-31 02:11:31,313 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 7.4804e+00
[rank0]:2025-10-31 02:11:51,085 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8386e+00
[rank1]:2025-10-31 02:11:51,078 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.6896e+00
[rank3]:2025-10-31 02:11:51,088 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.0204e+00
[rank2]:2025-10-31 02:11:51,078 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0323e+00
[rank2]:2025-10-31 02:12:11,871 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3827e+00
[rank0]:2025-10-31 02:12:11,875 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2361e+01
[rank1]:2025-10-31 02:12:11,871 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5889e+00
[rank3]:2025-10-31 02:12:11,881 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1733e+00
[rank1]:2025-10-31 02:12:31,652 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.3891e+00
[rank3]:2025-10-31 02:12:31,662 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.2287e+00
[rank0]:2025-10-31 02:12:31,659 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8550e+00
[rank2]:2025-10-31 02:12:31,652 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1211e+00
[rank0]:2025-10-31 02:12:50,339 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:12:52,414 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8094e+00
[rank2]:2025-10-31 02:12:52,414 - INFO -  step: 950  loss: -4.0000  grad_norm:  2.8362  memory: 38.72GiB(27.69%)  tps: 8,025  tflops: 374.31  mfu: 37.85%
[rank1]:2025-10-31 02:12:52,414 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9603e+00
[rank1]:2025-10-31 02:12:52,415 - INFO -  step: 950  loss: -4.0000  grad_norm:  2.8362  memory: 47.26GiB(33.80%)  tps: 8,025  tflops: 374.31  mfu: 37.85%
[rank3]:2025-10-31 02:12:52,424 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3794e+00
[rank3]:2025-10-31 02:12:52,426 - INFO -  step: 950  loss:  2.8567  grad_norm:  2.8362  memory: 46.16GiB(33.01%)  tps: 8,026  tflops: 374.31  mfu: 37.85%
[rank0]:2025-10-31 02:12:52,418 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.1626e+00
[rank0]:2025-10-31 02:12:52,418 - INFO -  step: 950  loss: -4.0000  grad_norm:  2.8362  memory: 54.93GiB(39.29%)  tps: 8,026  tflops: 374.32  mfu: 37.85%
[rank3]:2025-10-31 02:12:52,763 - INFO - Avg. fwd time: 15.1379 / Avg. bwd time: 35.2276 / Avg. batch time: 420.5480 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-10-31 02:12:52,770 - INFO - Avg. fwd time: 13.7772 / Avg. bwd time: 28.3128 / Avg. batch time: 464.7868 (ms) / GPU bubble ratio: 27.55%
[rank1]:2025-10-31 02:12:52,780 - INFO - Avg. fwd time: 15.6937 / Avg. bwd time: 32.3029 / Avg. batch time: 514.4377 (ms) / GPU bubble ratio: 25.36%
[rank0]:2025-10-31 02:12:52,795 - INFO - Avg. fwd time: 14.1349 / Avg. bwd time: 29.6466 / Avg. batch time: 560.4430 (ms) / GPU bubble ratio: 37.50%
[rank2]:2025-10-31 02:13:12,236 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7544e+00
[rank1]:2025-10-31 02:13:12,236 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.5731e+00
[rank3]:2025-10-31 02:13:12,246 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.0059e+00
[rank0]:2025-10-31 02:13:12,243 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2232e+00
[rank1]:2025-10-31 02:13:32,968 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8301e+00
[rank3]:2025-10-31 02:13:32,977 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.2908e+00
[rank0]:2025-10-31 02:13:32,971 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2575e+00
[rank2]:2025-10-31 02:13:32,967 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9717e+00
[rank1]:2025-10-31 02:13:52,807 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 5.2582e+00
[rank3]:2025-10-31 02:13:52,817 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.7407e+00
[rank0]:2025-10-31 02:13:52,815 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9581e+01
[rank2]:2025-10-31 02:13:52,807 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4926e+00
[rank3]:2025-10-31 02:14:13,517 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9007e+00
[rank1]:2025-10-31 02:14:13,507 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.6054e-01
[rank0]:2025-10-31 02:14:13,511 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.7716e+00
[rank2]:2025-10-31 02:14:13,507 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0921e+00
[rank0]:2025-10-31 02:14:31,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:14:33,380 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 7.9122e+00
[rank2]:2025-10-31 02:14:33,380 - INFO -  step: 1000  loss: -4.0000  grad_norm:  1.4204  memory: 38.72GiB(27.69%)  tps: 8,114  tflops: 378.42  mfu: 38.26%
[rank2]:2025-10-31 02:14:33,380 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-31 02:14:33,390 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.4774e+00
[rank3]:2025-10-31 02:14:33,392 - INFO -  step: 1000  loss:  2.2849  grad_norm:  1.4204  memory: 46.16GiB(33.01%)  tps: 8,114  tflops: 378.43  mfu: 38.26%
[rank3]:2025-10-31 02:14:33,392 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-31 02:14:33,380 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9435e+01
[rank1]:2025-10-31 02:14:33,380 - INFO -  step: 1000  loss: -4.0000  grad_norm:  1.4204  memory: 47.26GiB(33.80%)  tps: 8,114  tflops: 378.42  mfu: 38.26%
[rank1]:2025-10-31 02:14:33,380 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 02:14:33,387 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4641e+02
[rank0]:2025-10-31 02:14:33,387 - INFO -  step: 1000  loss: -4.0000  grad_norm:  1.4204  memory: 54.93GiB(39.29%)  tps: 8,113  tflops: 378.41  mfu: 38.26%
[rank0]:2025-10-31 02:14:33,388 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 02:14:49,646 - INFO - validate step: 1000  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,193
[rank2]:2025-10-31 02:14:49,696 - INFO - validate step: 1000  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,105
[rank3]:2025-10-31 02:14:49,699 - INFO - validate step: 1000  loss:  0.8897  memory: 46.16GiB(33.01%)  tps: 25,119
[rank1]:2025-10-31 02:14:49,682 - INFO - validate step: 1000  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,128
[rank0]:2025-10-31 02:14:49,770 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0214_stage0_step1000.svg
[rank2]:2025-10-31 02:14:49,773 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0214_stage2_step1000.svg
[rank1]:2025-10-31 02:14:49,773 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0214_stage1_step1000.svg
[rank3]:2025-10-31 02:14:49,881 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0214_real_step1000_rank3.svg
[rank3]:> Batch Time: 522.63 ms, GPU Bubble Ratio: 32.39%, 24.79%, 35.21%, 27.49%
[rank3]:2025-10-31 02:14:49,950 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0214_stage3_step1000.svg
[rank3]:2025-10-31 02:14:50,268 - INFO - Avg. fwd time: 15.1647 / Avg. bwd time: 34.9700 / Avg. batch time: 418.5871 (ms) / GPU bubble ratio: 4.18%
[rank2]:2025-10-31 02:14:50,275 - INFO - Avg. fwd time: 13.8226 / Avg. bwd time: 27.8518 / Avg. batch time: 462.3469 (ms) / GPU bubble ratio: 27.89%
[rank1]:2025-10-31 02:14:50,285 - INFO - Avg. fwd time: 15.7425 / Avg. bwd time: 31.7417 / Avg. batch time: 511.4386 (ms) / GPU bubble ratio: 25.72%
[rank0]:2025-10-31 02:14:50,299 - INFO - Avg. fwd time: 14.1828 / Avg. bwd time: 29.1654 / Avg. batch time: 556.9508 (ms) / GPU bubble ratio: 37.73%
[rank1]:2025-10-31 02:15:10,581 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9544e+00
[rank0]:2025-10-31 02:15:10,588 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5178e+00
[rank2]:2025-10-31 02:15:10,584 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8680e+00
[rank3]:2025-10-31 02:15:10,594 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.9985e+00
[rank2]:2025-10-31 02:15:30,313 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.3554e+00
[rank3]:2025-10-31 02:15:30,323 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7983e+00
[rank1]:2025-10-31 02:15:30,313 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4963e+00
[rank0]:2025-10-31 02:15:30,320 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3847e+00
[rank3]:2025-10-31 02:15:50,992 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.5661e-01
[rank1]:2025-10-31 02:15:50,979 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5796e+00
[rank0]:2025-10-31 02:15:50,986 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.8748e+01
[rank2]:2025-10-31 02:15:50,982 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.1253e-01
[rank3]:2025-10-31 02:16:10,812 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.3430e+00
[rank1]:2025-10-31 02:16:10,802 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6399e+00
[rank0]:2025-10-31 02:16:10,809 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.6619e+00
[rank2]:2025-10-31 02:16:10,802 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.4374e-01
[rank0]:2025-10-31 02:16:29,374 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 02:16:31,442 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1915e+00
[rank3]:2025-10-31 02:16:31,444 - INFO -  step: 1050  loss:  2.1043  grad_norm:  2.4249  memory: 46.16GiB(33.01%)  tps: 8,052  tflops: 375.53  mfu: 37.97%
[rank1]:2025-10-31 02:16:31,429 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7367e+00
[rank1]:2025-10-31 02:16:31,430 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.4249  memory: 47.26GiB(33.80%)  tps: 8,051  tflops: 375.51  mfu: 37.97%
[rank0]:2025-10-31 02:16:31,436 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3196e+01
[rank0]:2025-10-31 02:16:31,436 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.4249  memory: 54.93GiB(39.29%)  tps: 8,048  tflops: 375.36  mfu: 37.95%
[rank2]:2025-10-31 02:16:31,432 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0859e+00
[rank2]:2025-10-31 02:16:31,432 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.4249  memory: 38.72GiB(27.69%)  tps: 8,052  tflops: 375.56  mfu: 37.97%
[rank3]:2025-10-31 02:16:31,876 - INFO - Avg. fwd time: 15.1876 / Avg. bwd time: 34.7513 / Avg. batch time: 416.9172 (ms) / GPU bubble ratio: 4.17%
[rank1]:2025-10-31 02:16:31,929 - INFO - Avg. fwd time: 15.7928 / Avg. bwd time: 31.1777 / Avg. batch time: 508.8201 (ms) / GPU bubble ratio: 26.15%
[rank0]:2025-10-31 02:16:31,957 - INFO - Avg. fwd time: 14.2264 / Avg. bwd time: 28.7329 / Avg. batch time: 553.8903 (ms) / GPU bubble ratio: 37.95%
[rank2]:2025-10-31 02:16:31,902 - INFO - Avg. fwd time: 13.8620 / Avg. bwd time: 27.4497 / Avg. batch time: 460.2899 (ms) / GPU bubble ratio: 28.20%
[rank2]:2025-10-31 02:16:51,308 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.9440e+00
[rank3]:2025-10-31 02:16:51,319 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.5908e+00
[rank1]:2025-10-31 02:16:51,309 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.6907e+00
[rank0]:2025-10-31 02:16:51,316 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6277e+01
[rank2]:2025-10-31 02:17:11,916 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6781e+00
[rank3]:2025-10-31 02:17:11,926 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.4669e+01
[rank1]:2025-10-31 02:17:11,913 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6697e+00
[rank0]:2025-10-31 02:17:11,920 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.4871e+00
[rank1]:2025-10-31 02:17:31,689 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2441e+00
[rank0]:2025-10-31 02:17:31,696 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9466e+00
[rank2]:2025-10-31 02:17:31,689 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.5432e+00
[rank3]:2025-10-31 02:17:31,699 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.0578e+00
[rank3]:2025-10-31 02:17:52,400 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1233e+00
[rank1]:2025-10-31 02:17:52,387 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5209e+00
[rank0]:2025-10-31 02:17:52,395 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.7898e+00
[rank2]:2025-10-31 02:17:52,391 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6451e+00
[rank0]:2025-10-31 02:18:10,160 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:18:12,147 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.4638e+00
[rank2]:2025-10-31 02:18:12,147 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.6399  memory: 38.72GiB(27.69%)  tps: 8,134  tflops: 379.37  mfu: 38.36%
[rank3]:2025-10-31 02:18:12,156 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.1760e+00
[rank3]:2025-10-31 02:18:12,159 - INFO -  step: 1100  loss:  2.1095  grad_norm:  1.6399  memory: 46.16GiB(33.01%)  tps: 8,134  tflops: 379.37  mfu: 38.36%
[rank1]:2025-10-31 02:18:12,147 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3192e+00
[rank1]:2025-10-31 02:18:12,147 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.6399  memory: 47.26GiB(33.80%)  tps: 8,134  tflops: 379.36  mfu: 38.36%
[rank1]:2025-10-31 02:18:12,232 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0218_stage1_step1100.svg
[rank0]:2025-10-31 02:18:12,154 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4814e+00
[rank0]:2025-10-31 02:18:12,154 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.6399  memory: 54.93GiB(39.29%)  tps: 8,134  tflops: 379.35  mfu: 38.36%
[rank0]:2025-10-31 02:18:12,229 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0218_stage0_step1100.svg
[rank2]:2025-10-31 02:18:12,232 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0218_stage2_step1100.svg
[rank3]:2025-10-31 02:18:12,339 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0218_real_step1100_rank3.svg
[rank3]:> Batch Time: 501.16 ms, GPU Bubble Ratio: 35.89%, 32.99%, 39.64%, 24.46%
[rank3]:2025-10-31 02:18:12,408 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0218_stage3_step1100.svg
[rank3]:2025-10-31 02:18:12,729 - INFO - Avg. fwd time: 15.2072 / Avg. bwd time: 34.5674 / Avg. batch time: 415.5215 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-31 02:18:12,737 - INFO - Avg. fwd time: 13.8943 / Avg. bwd time: 27.1225 / Avg. batch time: 458.5518 (ms) / GPU bubble ratio: 28.44%
[rank1]:2025-10-31 02:18:12,745 - INFO - Avg. fwd time: 15.8322 / Avg. bwd time: 30.7373 / Avg. batch time: 506.6420 (ms) / GPU bubble ratio: 26.47%
[rank0]:2025-10-31 02:18:12,760 - INFO - Avg. fwd time: 14.2602 / Avg. bwd time: 28.3951 / Avg. batch time: 551.3646 (ms) / GPU bubble ratio: 38.11%
[rank3]:2025-10-31 02:18:33,024 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.5111e+00
[rank1]:2025-10-31 02:18:33,011 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3304e+01
[rank0]:2025-10-31 02:18:33,018 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2965e+01
[rank2]:2025-10-31 02:18:33,014 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.8219e+00
[rank2]:2025-10-31 02:18:52,800 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.8458e+00
[rank3]:2025-10-31 02:18:52,809 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.4498e+00
[rank1]:2025-10-31 02:18:52,800 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5676e+00
[rank0]:2025-10-31 02:18:52,807 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.6128e+00
[rank2]:2025-10-31 02:19:13,413 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.8319e-01
[rank3]:2025-10-31 02:19:13,423 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3978e+00
[rank1]:2025-10-31 02:19:13,410 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4760e+00
[rank0]:2025-10-31 02:19:13,417 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6676e-01
[rank2]:2025-10-31 02:19:33,233 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.0929e+00
[rank3]:2025-10-31 02:19:33,243 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.8435e+00
[rank1]:2025-10-31 02:19:33,233 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4264e+00
[rank0]:2025-10-31 02:19:33,240 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2949e+00
[rank0]:2025-10-31 02:19:51,822 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:19:53,895 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5494e+01
[rank3]:2025-10-31 02:19:53,897 - INFO -  step: 1150  loss:  2.5647  grad_norm:  0.9988  memory: 46.16GiB(33.01%)  tps: 8,052  tflops: 375.55  mfu: 37.97%
[rank1]:2025-10-31 02:19:53,882 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8408e+00
[rank1]:2025-10-31 02:19:53,883 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.9988  memory: 47.26GiB(33.80%)  tps: 8,052  tflops: 375.56  mfu: 37.97%
[rank0]:2025-10-31 02:19:53,889 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.7890e+00
[rank0]:2025-10-31 02:19:53,890 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.9988  memory: 54.93GiB(39.29%)  tps: 8,052  tflops: 375.56  mfu: 37.97%
[rank2]:2025-10-31 02:19:53,885 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.9276e+00
[rank2]:2025-10-31 02:19:53,886 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.9988  memory: 38.72GiB(27.69%)  tps: 8,052  tflops: 375.55  mfu: 37.97%
[rank2]:2025-10-31 02:19:54,252 - INFO - Avg. fwd time: 13.9274 / Avg. bwd time: 26.7830 / Avg. batch time: 456.7935 (ms) / GPU bubble ratio: 28.70%
[rank3]:2025-10-31 02:19:54,245 - INFO - Avg. fwd time: 15.2266 / Avg. bwd time: 34.3800 / Avg. batch time: 414.0912 (ms) / GPU bubble ratio: 4.16%
[rank1]:2025-10-31 02:19:54,262 - INFO - Avg. fwd time: 15.8739 / Avg. bwd time: 30.2670 / Avg. batch time: 504.4140 (ms) / GPU bubble ratio: 26.82%
[rank0]:2025-10-31 02:19:54,277 - INFO - Avg. fwd time: 14.2963 / Avg. bwd time: 28.0345 / Avg. batch time: 548.7659 (ms) / GPU bubble ratio: 38.29%
[rank3]:2025-10-31 02:20:13,695 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2408e+00
[rank1]:2025-10-31 02:20:13,685 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9510e+00
[rank0]:2025-10-31 02:20:13,692 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1777e+01
[rank2]:2025-10-31 02:20:13,685 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8970e+00
[rank2]:2025-10-31 02:20:34,379 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.5451e+00
[rank3]:2025-10-31 02:20:34,389 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.5471e+00
[rank1]:2025-10-31 02:20:34,376 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3051e+01
[rank0]:2025-10-31 02:20:34,383 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8441e+01
[rank0]:2025-10-31 02:20:54,172 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5079e+00
[rank2]:2025-10-31 02:20:54,165 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.8835e+00
[rank3]:2025-10-31 02:20:54,175 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.8679e+00
[rank1]:2025-10-31 02:20:54,165 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2276e+00
[rank2]:2025-10-31 02:21:14,806 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5163e+00
[rank3]:2025-10-31 02:21:14,816 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1345e+00
[rank1]:2025-10-31 02:21:14,803 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2845e+01
[rank0]:2025-10-31 02:21:14,810 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.0311e+01
[rank3]:2025-10-31 02:21:23,556 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 02:21:23,698 - WARNING - Dataset medical is being re-looped
[rank1]:2025-10-31 02:21:30,103 - WARNING - Dataset medical is being re-looped
[rank2]:2025-10-31 02:21:31,070 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 02:21:32,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 02:21:34,612 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5682e+00
[rank0]:2025-10-31 02:21:34,612 - INFO -  step: 1200  loss: -4.0000  grad_norm:  3.4706  memory: 54.93GiB(39.29%)  tps: 8,133  tflops: 379.34  mfu: 38.36%
[rank0]:2025-10-31 02:21:34,612 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-31 02:21:34,605 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.8318e+00
[rank2]:2025-10-31 02:21:34,605 - INFO -  step: 1200  loss: -4.0000  grad_norm:  3.4706  memory: 38.72GiB(27.69%)  tps: 8,134  tflops: 379.35  mfu: 38.36%
[rank2]:2025-10-31 02:21:34,605 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-31 02:21:34,614 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.0178e+00
[rank3]:2025-10-31 02:21:34,617 - INFO -  step: 1200  loss:  1.9328  grad_norm:  3.4706  memory: 46.16GiB(33.01%)  tps: 8,134  tflops: 379.35  mfu: 38.36%
[rank3]:2025-10-31 02:21:34,617 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 02:21:34,605 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9512e+00
[rank1]:2025-10-31 02:21:34,605 - INFO -  step: 1200  loss: -4.0000  grad_norm:  3.4706  memory: 47.26GiB(33.80%)  tps: 8,133  tflops: 379.34  mfu: 38.36%
[rank1]:2025-10-31 02:21:34,605 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 02:21:50,964 - INFO - validate step: 1200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,039
[rank1]:2025-10-31 02:21:50,965 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 02:21:50,980 - INFO - validate step: 1200  loss:  0.8623  memory: 46.16GiB(33.01%)  tps: 25,034
[rank3]:2025-10-31 02:21:50,980 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 02:21:50,927 - INFO - validate step: 1200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,107
[rank0]:2025-10-31 02:21:50,927 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 02:21:50,932 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-31 02:21:50,976 - INFO - validate step: 1200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,021
[rank2]:2025-10-31 02:21:50,976 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 02:22:04,862 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.89 seconds.
[rank1]:2025-10-31 02:22:06,594 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.63 seconds.
[rank3]:2025-10-31 02:22:07,379 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.40 seconds.
[rank0]:2025-10-31 02:22:09,288 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 02:22:09,294 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.37 seconds.
[rank1]:2025-10-31 02:22:09,492 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0222_stage1_step1200.svg
[rank0]:2025-10-31 02:22:09,494 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0222_stage0_step1200.svg
[rank2]:2025-10-31 02:22:09,533 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0222_stage2_step1200.svg
[rank3]:2025-10-31 02:22:09,614 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0222_real_step1200_rank3.svg
[rank3]:> Batch Time: 498.16 ms, GPU Bubble Ratio: 39.00%, 32.83%, 39.43%, 24.06%
[rank3]:2025-10-31 02:22:09,686 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0222_stage3_step1200.svg
[rank3]:2025-10-31 02:22:10,683 - INFO - Avg. fwd time: 15.2456 / Avg. bwd time: 34.2135 / Avg. batch time: 412.8322 (ms) / GPU bubble ratio: 4.16%
[rank2]:2025-10-31 02:22:10,714 - INFO - Avg. fwd time: 13.9601 / Avg. bwd time: 26.4622 / Avg. batch time: 455.2232 (ms) / GPU bubble ratio: 28.96%
[rank1]:2025-10-31 02:22:10,745 - INFO - Avg. fwd time: 15.9129 / Avg. bwd time: 29.8381 / Avg. batch time: 502.4169 (ms) / GPU bubble ratio: 27.15%
[rank0]:2025-10-31 02:22:10,775 - INFO - Avg. fwd time: 14.3311 / Avg. bwd time: 27.7055 / Avg. batch time: 546.4380 (ms) / GPU bubble ratio: 38.46%
[rank2]:2025-10-31 02:22:12,313 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 02:22:12,840 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 02:22:15,974 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-31 02:22:16,364 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 02:22:30,961 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0151e+00
[rank3]:2025-10-31 02:22:30,971 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1137e+00
[rank1]:2025-10-31 02:22:30,958 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6944e+00
[rank0]:2025-10-31 02:22:30,965 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7344e+00
[rank2]:2025-10-31 02:22:50,872 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 8.6770e-01
[rank3]:2025-10-31 02:22:50,882 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.0652e+00
[rank1]:2025-10-31 02:22:50,873 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2160e+00
[rank0]:2025-10-31 02:22:50,880 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3193e-01
[rank2]:2025-10-31 02:23:11,508 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3185e+00
[rank3]:2025-10-31 02:23:11,518 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1193e+00
[rank1]:2025-10-31 02:23:11,505 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3298e+00
[rank0]:2025-10-31 02:23:11,512 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6954e+00
[rank3]:2025-10-31 02:23:31,381 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.1116e+00
[rank1]:2025-10-31 02:23:31,372 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2249e+00
[rank0]:2025-10-31 02:23:31,378 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2706e+00
[rank2]:2025-10-31 02:23:31,371 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9443e+00
[rank0]:2025-10-31 02:23:52,607 - INFO - [GC] Peforming periodical GC collection 2.58 seconds
[rank3]:2025-10-31 02:23:54,762 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.9202e+00
[rank3]:2025-10-31 02:23:54,767 - INFO -  step: 1250  loss:  2.8752  grad_norm:  3.4686  memory: 46.16GiB(33.01%)  tps: 6,618  tflops: 308.66  mfu: 31.21%
[rank1]:2025-10-31 02:23:54,749 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7674e+00
[rank1]:2025-10-31 02:23:54,749 - INFO -  step: 1250  loss: -4.0000  grad_norm:  3.4686  memory: 47.26GiB(33.80%)  tps: 6,618  tflops: 308.66  mfu: 31.21%
[rank0]:2025-10-31 02:23:54,756 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6977e+01
[rank0]:2025-10-31 02:23:54,757 - INFO -  step: 1250  loss: -4.0000  grad_norm:  3.4686  memory: 54.93GiB(39.29%)  tps: 6,616  tflops: 308.55  mfu: 31.20%
[rank2]:2025-10-31 02:23:54,751 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.9914e-01
[rank2]:2025-10-31 02:23:54,752 - INFO -  step: 1250  loss: -4.0000  grad_norm:  3.4686  memory: 38.72GiB(27.69%)  tps: 6,618  tflops: 308.68  mfu: 31.21%
[rank2]:2025-10-31 02:23:55,115 - INFO - Avg. fwd time: 13.9832 / Avg. bwd time: 26.2191 / Avg. batch time: 453.9394 (ms) / GPU bubble ratio: 29.15%
[rank3]:2025-10-31 02:23:55,109 - INFO - Avg. fwd time: 15.2588 / Avg. bwd time: 34.0797 / Avg. batch time: 411.8047 (ms) / GPU bubble ratio: 4.15%
[rank1]:2025-10-31 02:23:55,126 - INFO - Avg. fwd time: 15.9445 / Avg. bwd time: 29.5009 / Avg. batch time: 500.7969 (ms) / GPU bubble ratio: 27.40%
[rank0]:2025-10-31 02:23:55,141 - INFO - Avg. fwd time: 14.3572 / Avg. bwd time: 27.4446 / Avg. batch time: 544.5569 (ms) / GPU bubble ratio: 38.59%
[rank3]:2025-10-31 02:24:14,519 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.7909e+00
[rank1]:2025-10-31 02:24:14,509 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7329e+00
[rank0]:2025-10-31 02:24:14,517 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2541e+00
[rank2]:2025-10-31 02:24:14,509 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.6087e+00
[rank0]:2025-10-31 02:24:35,247 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3235e+01
[rank2]:2025-10-31 02:24:35,243 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7790e+00
[rank3]:2025-10-31 02:24:35,253 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.9766e+00
[rank1]:2025-10-31 02:24:35,240 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.6923e+00
[rank0]:2025-10-31 02:24:55,078 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7781e+00
[rank2]:2025-10-31 02:24:55,070 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.4334e+00
[rank3]:2025-10-31 02:24:55,080 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.0366e+00
[rank1]:2025-10-31 02:24:55,070 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1453e+00
[rank3]:2025-10-31 02:25:15,743 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.3543e+00
[rank1]:2025-10-31 02:25:15,730 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8015e+00
[rank0]:2025-10-31 02:25:15,737 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.2167e+00
[rank2]:2025-10-31 02:25:15,733 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.7266e-01
[rank0]:2025-10-31 02:25:33,642 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:25:35,620 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.5404e+00
[rank2]:2025-10-31 02:25:35,621 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9984  memory: 38.72GiB(27.69%)  tps: 8,121  tflops: 378.79  mfu: 38.30%
[rank3]:2025-10-31 02:25:35,630 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.2598e+00
[rank3]:2025-10-31 02:25:35,635 - INFO -  step: 1300  loss:  1.9539  grad_norm:  0.9984  memory: 46.16GiB(33.01%)  tps: 8,122  tflops: 378.79  mfu: 38.30%
[rank1]:2025-10-31 02:25:35,620 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5139e+00
[rank1]:2025-10-31 02:25:35,621 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9984  memory: 47.26GiB(33.80%)  tps: 8,121  tflops: 378.78  mfu: 38.30%
[rank0]:2025-10-31 02:25:35,627 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3933e+01
[rank0]:2025-10-31 02:25:35,628 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.9984  memory: 54.93GiB(39.29%)  tps: 8,121  tflops: 378.78  mfu: 38.30%
[rank2]:2025-10-31 02:25:35,713 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0225_stage2_step1300.svg
[rank1]:2025-10-31 02:25:35,713 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0225_stage1_step1300.svg
[rank0]:2025-10-31 02:25:35,713 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0225_stage0_step1300.svg
[rank3]:2025-10-31 02:25:35,819 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0225_real_step1300_rank3.svg
[rank3]:> Batch Time: 497.18 ms, GPU Bubble Ratio: 39.95%, 33.24%, 39.40%, 23.97%
[rank3]:2025-10-31 02:25:35,892 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0225_stage3_step1300.svg
[rank2]:2025-10-31 02:25:36,215 - INFO - Avg. fwd time: 14.0100 / Avg. bwd time: 25.9495 / Avg. batch time: 452.5111 (ms) / GPU bubble ratio: 29.36%
[rank3]:2025-10-31 02:25:36,207 - INFO - Avg. fwd time: 15.2748 / Avg. bwd time: 33.9288 / Avg. batch time: 410.6587 (ms) / GPU bubble ratio: 4.15%
[rank1]:2025-10-31 02:25:36,224 - INFO - Avg. fwd time: 15.9795 / Avg. bwd time: 29.1381 / Avg. batch time: 499.0078 (ms) / GPU bubble ratio: 27.67%
[rank0]:2025-10-31 02:25:36,238 - INFO - Avg. fwd time: 14.3860 / Avg. bwd time: 27.1639 / Avg. batch time: 542.4822 (ms) / GPU bubble ratio: 38.73%
[rank3]:2025-10-31 02:25:56,466 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3101e+00
[rank1]:2025-10-31 02:25:56,453 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3443e+00
[rank0]:2025-10-31 02:25:56,460 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.9902e+00
[rank2]:2025-10-31 02:25:56,456 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4244e+00
[rank3]:2025-10-31 02:26:16,286 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7743e+00
[rank1]:2025-10-31 02:26:16,276 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9866e+00
[rank0]:2025-10-31 02:26:16,284 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7733e+01
[rank2]:2025-10-31 02:26:16,276 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.9701e+00
[rank1]:2025-10-31 02:26:37,004 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7651e+00
[rank3]:2025-10-31 02:26:37,017 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.4858e+00
[rank0]:2025-10-31 02:26:37,011 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6660e+00
[rank2]:2025-10-31 02:26:37,007 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3351e+00
[rank2]:2025-10-31 02:26:56,788 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.1988e+00
[rank3]:2025-10-31 02:26:56,798 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.3365e-01
[rank1]:2025-10-31 02:26:56,788 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9696e+00
[rank0]:2025-10-31 02:26:56,795 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.6962e+00
[rank0]:2025-10-31 02:27:15,410 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 02:27:17,485 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9956e+01
[rank0]:2025-10-31 02:27:17,485 - INFO -  step: 1350  loss: -4.0000  grad_norm:  1.0516  memory: 54.93GiB(39.29%)  tps: 8,043  tflops: 375.11  mfu: 37.93%
[rank2]:2025-10-31 02:27:17,481 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8411e+00
[rank2]:2025-10-31 02:27:17,481 - INFO -  step: 1350  loss: -4.0000  grad_norm:  1.0516  memory: 38.72GiB(27.69%)  tps: 8,042  tflops: 375.10  mfu: 37.93%
[rank1]:2025-10-31 02:27:17,477 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.0029e+00
[rank1]:2025-10-31 02:27:17,478 - INFO -  step: 1350  loss: -4.0000  grad_norm:  1.0516  memory: 47.26GiB(33.80%)  tps: 8,043  tflops: 375.11  mfu: 37.93%
[rank3]:2025-10-31 02:27:17,490 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.1395e+00
[rank3]:2025-10-31 02:27:17,493 - INFO -  step: 1350  loss:  2.3997  grad_norm:  1.0516  memory: 46.16GiB(33.01%)  tps: 8,043  tflops: 375.11  mfu: 37.93%
[rank3]:2025-10-31 02:27:17,923 - INFO - Avg. fwd time: 15.2884 / Avg. bwd time: 33.7996 / Avg. batch time: 409.6725 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-10-31 02:27:17,951 - INFO - Avg. fwd time: 14.0330 / Avg. bwd time: 25.7105 / Avg. batch time: 451.2980 (ms) / GPU bubble ratio: 29.55%
[rank1]:2025-10-31 02:27:17,981 - INFO - Avg. fwd time: 16.0096 / Avg. bwd time: 28.8010 / Avg. batch time: 497.4588 (ms) / GPU bubble ratio: 27.94%
[rank0]:2025-10-31 02:27:18,011 - INFO - Avg. fwd time: 14.4115 / Avg. bwd time: 26.9048 / Avg. batch time: 540.6680 (ms) / GPU bubble ratio: 38.87%
[rank1]:2025-10-31 02:27:37,358 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4967e+00
[rank3]:2025-10-31 02:27:37,368 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 9.4125e-01
[rank0]:2025-10-31 02:27:37,365 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8790e+00
[rank2]:2025-10-31 02:27:37,358 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.4165e+00
[rank0]:2025-10-31 02:27:58,018 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4412e+01
[rank2]:2025-10-31 02:27:58,014 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0079e+00
[rank3]:2025-10-31 02:27:58,024 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.6639e+00
[rank1]:2025-10-31 02:27:58,011 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1369e+00
[rank3]:2025-10-31 02:28:17,886 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.3915e+00
[rank1]:2025-10-31 02:28:17,876 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7361e+00
[rank0]:2025-10-31 02:28:17,884 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3049e+00
[rank2]:2025-10-31 02:28:17,877 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.6156e+00
[rank2]:2025-10-31 02:28:38,568 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8049e+00
[rank1]:2025-10-31 02:28:38,565 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1114e+00
[rank3]:2025-10-31 02:28:38,578 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.6056e+00
[rank0]:2025-10-31 02:28:38,572 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.1729e+00
[rank0]:2025-10-31 02:28:56,480 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 02:28:58,467 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.1345e+00
[rank0]:2025-10-31 02:28:58,468 - INFO -  step: 1400  loss: -4.0000  grad_norm:  2.5333  memory: 54.93GiB(39.29%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank0]:2025-10-31 02:28:58,468 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-31 02:28:58,460 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7608e+00
[rank2]:2025-10-31 02:28:58,461 - INFO -  step: 1400  loss: -4.0000  grad_norm:  2.5333  memory: 38.72GiB(27.69%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank2]:2025-10-31 02:28:58,461 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-31 02:28:58,460 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4385e+00
[rank1]:2025-10-31 02:28:58,461 - INFO -  step: 1400  loss: -4.0000  grad_norm:  2.5333  memory: 47.26GiB(33.80%)  tps: 8,112  tflops: 378.36  mfu: 38.26%
[rank1]:2025-10-31 02:28:58,461 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-31 02:28:58,470 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0689e+00
[rank3]:2025-10-31 02:28:58,473 - INFO -  step: 1400  loss:  2.4210  grad_norm:  2.5333  memory: 46.16GiB(33.01%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank3]:2025-10-31 02:28:58,473 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-31 02:29:14,750 - INFO - validate step: 1400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,146
[rank3]:2025-10-31 02:29:14,765 - INFO - validate step: 1400  loss:  0.8539  memory: 46.16GiB(33.01%)  tps: 25,142
[rank0]:2025-10-31 02:29:14,712 - INFO - validate step: 1400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,216
[rank2]:2025-10-31 02:29:14,763 - INFO - validate step: 1400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,126
[rank1]:2025-10-31 02:29:14,845 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0229_stage1_step1400.svg
[rank0]:2025-10-31 02:29:14,847 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0229_stage0_step1400.svg
[rank2]:2025-10-31 02:29:14,849 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0229_stage2_step1400.svg
[rank3]:2025-10-31 02:29:14,947 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0229_real_step1400_rank3.svg
[rank3]:> Batch Time: 492.64 ms, GPU Bubble Ratio: 42.20%, 35.63%, 39.31%, 23.29%
[rank3]:2025-10-31 02:29:15,021 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0229_stage3_step1400.svg
[rank3]:2025-10-31 02:29:15,345 - INFO - Avg. fwd time: 15.3017 / Avg. bwd time: 33.6870 / Avg. batch time: 408.8279 (ms) / GPU bubble ratio: 4.14%
[rank1]:2025-10-31 02:29:15,361 - INFO - Avg. fwd time: 16.0356 / Avg. bwd time: 28.5348 / Avg. batch time: 496.1398 (ms) / GPU bubble ratio: 28.13%
[rank0]:2025-10-31 02:29:15,376 - INFO - Avg. fwd time: 14.4331 / Avg. bwd time: 26.6991 / Avg. batch time: 539.1387 (ms) / GPU bubble ratio: 38.97%
[rank2]:2025-10-31 02:29:15,353 - INFO - Avg. fwd time: 14.0533 / Avg. bwd time: 25.5104 / Avg. batch time: 450.2433 (ms) / GPU bubble ratio: 29.70%
[rank3]:2025-10-31 02:29:35,683 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.3052e+00
[rank1]:2025-10-31 02:29:35,670 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6699e+00
[rank0]:2025-10-31 02:29:35,677 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4141e+01
[rank2]:2025-10-31 02:29:35,673 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.0401e-01
[rank3]:2025-10-31 02:29:55,471 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.9750e+00
[rank1]:2025-10-31 02:29:55,461 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2552e+00
[rank0]:2025-10-31 02:29:55,468 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.5501e+00
[rank2]:2025-10-31 02:29:55,461 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8806e+00
[rank1]:2025-10-31 02:30:14,685 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9091e+00
[rank3]:2025-10-31 02:30:14,692 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.2477e+00
[rank0]:2025-10-31 02:30:14,692 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3844e+00
[rank2]:2025-10-31 02:30:14,688 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2315e+00
[rank1]:2025-10-31 02:30:34,497 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4536e+00
[rank3]:2025-10-31 02:30:34,507 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2824e+00
[rank0]:2025-10-31 02:30:34,504 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9569e+00
[rank2]:2025-10-31 02:30:34,497 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.7757e+00
[rank0]:2025-10-31 02:30:51,680 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 02:30:53,579 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7225e+00
[rank2]:2025-10-31 02:30:53,579 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.9748  memory: 38.72GiB(27.69%)  tps: 8,290  tflops: 386.65  mfu: 39.10%
[rank1]:2025-10-31 02:30:53,579 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6856e+00
[rank1]:2025-10-31 02:30:53,579 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.9748  memory: 47.26GiB(33.80%)  tps: 8,289  tflops: 386.60  mfu: 39.09%
[rank3]:2025-10-31 02:30:53,586 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.3710e-01
[rank3]:2025-10-31 02:30:53,588 - INFO -  step: 1450  loss:  2.3856  grad_norm:  0.9748  memory: 46.16GiB(33.01%)  tps: 8,290  tflops: 386.63  mfu: 39.09%
[rank0]:2025-10-31 02:30:53,586 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0063e+01
[rank0]:2025-10-31 02:30:53,586 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.9748  memory: 54.93GiB(39.29%)  tps: 8,285  tflops: 386.43  mfu: 39.07%
[rank3]:2025-10-31 02:30:53,939 - INFO - Avg. fwd time: 15.3205 / Avg. bwd time: 33.5091 / Avg. batch time: 407.5022 (ms) / GPU bubble ratio: 4.14%
[rank0]:2025-10-31 02:30:53,970 - INFO - Avg. fwd time: 14.4567 / Avg. bwd time: 26.4757 / Avg. batch time: 537.0795 (ms) / GPU bubble ratio: 39.03%
[rank2]:2025-10-31 02:30:53,945 - INFO - Avg. fwd time: 14.0759 / Avg. bwd time: 25.2871 / Avg. batch time: 448.7042 (ms) / GPU bubble ratio: 29.82%
[rank1]:2025-10-31 02:30:53,956 - INFO - Avg. fwd time: 16.0626 / Avg. bwd time: 28.2431 / Avg. batch time: 494.3090 (ms) / GPU bubble ratio: 28.29%
[rank1]:2025-10-31 02:31:13,447 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6707e+00
[rank3]:2025-10-31 02:31:13,457 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0723e+00
[rank0]:2025-10-31 02:31:13,454 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6614e+00
[rank2]:2025-10-31 02:31:13,447 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9571e+00
[rank1]:2025-10-31 02:31:32,522 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7133e+00
[rank3]:2025-10-31 02:31:32,529 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.6441e+00
[rank0]:2025-10-31 02:31:32,529 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.1767e+00
[rank2]:2025-10-31 02:31:32,522 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1079e+00
[rank1]:2025-10-31 02:31:52,384 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.6991e+00
[rank3]:2025-10-31 02:31:52,394 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0153e+00
[rank0]:2025-10-31 02:31:52,391 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.8041e+01
[rank2]:2025-10-31 02:31:52,384 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2126e+00
[rank1]:2025-10-31 02:32:11,508 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8242e+00
[rank0]:2025-10-31 02:32:11,515 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4174e+00
[rank2]:2025-10-31 02:32:11,508 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2260e+00
[rank3]:2025-10-31 02:32:11,515 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.9038e+00
[rank0]:2025-10-31 02:32:29,324 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:32:31,319 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7099e+00
[rank3]:2025-10-31 02:32:31,325 - INFO -  step: 1500  loss:  2.1564  grad_norm:  4.2332  memory: 46.16GiB(33.01%)  tps: 8,382  tflops: 390.93  mfu: 39.53%
[rank1]:2025-10-31 02:32:31,310 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4532e+00
[rank1]:2025-10-31 02:32:31,310 - INFO -  step: 1500  loss: -4.0000  grad_norm:  4.2332  memory: 47.26GiB(33.80%)  tps: 8,382  tflops: 390.95  mfu: 39.53%
[rank0]:2025-10-31 02:32:31,317 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.0961e+00
[rank0]:2025-10-31 02:32:31,317 - INFO -  step: 1500  loss: -4.0000  grad_norm:  4.2332  memory: 54.93GiB(39.29%)  tps: 8,382  tflops: 390.95  mfu: 39.53%
[rank2]:2025-10-31 02:32:31,310 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6876e+00
[rank2]:2025-10-31 02:32:31,310 - INFO -  step: 1500  loss: -4.0000  grad_norm:  4.2332  memory: 38.72GiB(27.69%)  tps: 8,382  tflops: 390.95  mfu: 39.53%
[rank1]:2025-10-31 02:32:31,404 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0232_stage1_step1500.svg
[rank0]:2025-10-31 02:32:31,404 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0232_stage0_step1500.svg
[rank2]:2025-10-31 02:32:31,405 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0232_stage2_step1500.svg
[rank3]:2025-10-31 02:32:31,510 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0232_real_step1500_rank3.svg
[rank3]:> Batch Time: 490.12 ms, GPU Bubble Ratio: 41.90%, 35.44%, 42.07%, 22.93%
[rank3]:2025-10-31 02:32:31,578 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0232_stage3_step1500.svg
[rank1]:2025-10-31 02:32:32,009 - INFO - Avg. fwd time: 16.0884 / Avg. bwd time: 27.9727 / Avg. batch time: 492.3921 (ms) / GPU bubble ratio: 28.41%
[rank3]:2025-10-31 02:32:31,954 - INFO - Avg. fwd time: 15.3404 / Avg. bwd time: 33.3185 / Avg. batch time: 406.0856 (ms) / GPU bubble ratio: 4.14%
[rank0]:2025-10-31 02:32:32,038 - INFO - Avg. fwd time: 14.4795 / Avg. bwd time: 26.2685 / Avg. batch time: 534.9515 (ms) / GPU bubble ratio: 39.06%
[rank2]:2025-10-31 02:32:31,981 - INFO - Avg. fwd time: 14.1010 / Avg. bwd time: 25.0462 / Avg. batch time: 447.0573 (ms) / GPU bubble ratio: 29.95%
[rank3]:2025-10-31 02:32:50,640 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.9007e-01
[rank1]:2025-10-31 02:32:50,633 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9431e+00
[rank0]:2025-10-31 02:32:50,641 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.4601e+01
[rank2]:2025-10-31 02:32:50,633 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2802e+00
[rank1]:2025-10-31 02:33:10,453 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8096e+00
[rank0]:2025-10-31 02:33:10,460 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8628e+00
[rank2]:2025-10-31 02:33:10,453 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6348e+00
[rank3]:2025-10-31 02:33:10,463 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3013e+00
[rank2]:2025-10-31 02:33:29,509 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2924e+00
[rank3]:2025-10-31 02:33:29,516 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 5.5705e+00
[rank1]:2025-10-31 02:33:29,509 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8772e+00
[rank0]:2025-10-31 02:33:29,516 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4076e+00
[rank0]:2025-10-31 02:33:49,409 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9343e+01
[rank2]:2025-10-31 02:33:49,402 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1941e+01
[rank3]:2025-10-31 02:33:49,411 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1747e+00
[rank1]:2025-10-31 02:33:49,402 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3925e+01
[rank0]:2025-10-31 02:34:06,526 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:34:08,444 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0165e+00
[rank2]:2025-10-31 02:34:08,445 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.7041  memory: 38.72GiB(27.69%)  tps: 8,434  tflops: 393.35  mfu: 39.77%
[rank3]:2025-10-31 02:34:08,451 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.0595e+00
[rank3]:2025-10-31 02:34:08,456 - INFO -  step: 1550  loss:  2.3255  grad_norm:  1.7041  memory: 46.16GiB(33.01%)  tps: 8,434  tflops: 393.37  mfu: 39.77%
[rank1]:2025-10-31 02:34:08,444 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2037e+00
[rank1]:2025-10-31 02:34:08,445 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.7041  memory: 47.26GiB(33.80%)  tps: 8,434  tflops: 393.35  mfu: 39.77%
[rank0]:2025-10-31 02:34:08,452 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7690e+00
[rank0]:2025-10-31 02:34:08,452 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.7041  memory: 54.93GiB(39.29%)  tps: 8,434  tflops: 393.35  mfu: 39.77%
[rank2]:2025-10-31 02:34:08,815 - INFO - Avg. fwd time: 14.1211 / Avg. bwd time: 24.8527 / Avg. batch time: 445.6441 (ms) / GPU bubble ratio: 30.04%
[rank3]:2025-10-31 02:34:08,810 - INFO - Avg. fwd time: 15.3570 / Avg. bwd time: 33.1557 / Avg. batch time: 404.8762 (ms) / GPU bubble ratio: 4.14%
[rank1]:2025-10-31 02:34:08,825 - INFO - Avg. fwd time: 16.1091 / Avg. bwd time: 27.7555 / Avg. batch time: 490.7613 (ms) / GPU bubble ratio: 28.50%
[rank0]:2025-10-31 02:34:08,841 - INFO - Avg. fwd time: 14.4972 / Avg. bwd time: 26.1019 / Avg. batch time: 533.1497 (ms) / GPU bubble ratio: 39.08%
[rank1]:2025-10-31 02:34:28,281 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0080e+01
[rank3]:2025-10-31 02:34:28,291 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3258e+00
[rank0]:2025-10-31 02:34:28,289 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7745e+02
[rank2]:2025-10-31 02:34:28,281 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1696e+00
[rank0]:2025-10-31 02:34:47,451 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1475e+01
[rank2]:2025-10-31 02:34:47,444 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2973e+00
[rank3]:2025-10-31 02:34:47,451 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5464e+00
[rank1]:2025-10-31 02:34:47,444 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3929e+01
[rank1]:2025-10-31 02:35:07,214 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.0148e+00
[rank3]:2025-10-31 02:35:07,225 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4768e+00
[rank0]:2025-10-31 02:35:07,222 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4092e+00
[rank2]:2025-10-31 02:35:07,214 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3379e+00
[rank3]:2025-10-31 02:35:26,351 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1071e+00
[rank1]:2025-10-31 02:35:26,344 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2915e+01
[rank0]:2025-10-31 02:35:26,351 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.4666e+01
[rank2]:2025-10-31 02:35:26,344 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8721e+00
[rank0]:2025-10-31 02:35:44,224 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:35:46,218 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3976e+00
[rank2]:2025-10-31 02:35:46,219 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8564  memory: 38.72GiB(27.69%)  tps: 8,379  tflops: 390.78  mfu: 39.51%
[rank2]:2025-10-31 02:35:46,219 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-31 02:35:46,228 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6949e+00
[rank3]:2025-10-31 02:35:46,232 - INFO -  step: 1600  loss:  2.0988  grad_norm:  0.8564  memory: 46.16GiB(33.01%)  tps: 8,379  tflops: 390.78  mfu: 39.51%
[rank3]:2025-10-31 02:35:46,232 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 02:35:46,218 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9758e+00
[rank1]:2025-10-31 02:35:46,219 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8564  memory: 47.26GiB(33.80%)  tps: 8,379  tflops: 390.78  mfu: 39.51%
[rank1]:2025-10-31 02:35:46,219 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 02:35:46,225 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.1839e+00
[rank0]:2025-10-31 02:35:46,226 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.8564  memory: 54.93GiB(39.29%)  tps: 8,379  tflops: 390.78  mfu: 39.51%
[rank0]:2025-10-31 02:35:46,226 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 02:36:02,489 - INFO - validate step: 1600  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,175
[rank0]:2025-10-31 02:36:02,455 - INFO - validate step: 1600  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,239
[rank2]:2025-10-31 02:36:02,504 - INFO - validate step: 1600  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,151
[rank1]:2025-10-31 02:36:02,597 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0236_stage1_step1600.svg
[rank3]:2025-10-31 02:36:02,511 - INFO - validate step: 1600  loss:  0.8606  memory: 46.16GiB(33.01%)  tps: 25,164
[rank0]:2025-10-31 02:36:02,601 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0236_stage0_step1600.svg
[rank2]:2025-10-31 02:36:02,600 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0236_stage2_step1600.svg
[rank3]:2025-10-31 02:36:02,724 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0236_real_step1600_rank3.svg
[rank3]:> Batch Time: 489.59 ms, GPU Bubble Ratio: 41.82%, 35.48%, 42.09%, 22.92%
[rank3]:2025-10-31 02:36:02,798 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0236_stage3_step1600.svg
[rank3]:2025-10-31 02:36:03,096 - INFO - Avg. fwd time: 15.3747 / Avg. bwd time: 32.9848 / Avg. batch time: 403.6055 (ms) / GPU bubble ratio: 4.15%
[rank0]:2025-10-31 02:36:03,129 - INFO - Avg. fwd time: 14.5171 / Avg. bwd time: 25.9197 / Avg. batch time: 531.2335 (ms) / GPU bubble ratio: 39.11%
[rank2]:2025-10-31 02:36:03,103 - INFO - Avg. fwd time: 14.1431 / Avg. bwd time: 24.6410 / Avg. batch time: 444.1516 (ms) / GPU bubble ratio: 30.14%
[rank1]:2025-10-31 02:36:03,114 - INFO - Avg. fwd time: 16.1318 / Avg. bwd time: 27.5177 / Avg. batch time: 489.0312 (ms) / GPU bubble ratio: 28.59%
[rank1]:2025-10-31 02:36:21,779 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4684e+00
[rank3]:2025-10-31 02:36:21,786 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.9756e+00
[rank0]:2025-10-31 02:36:21,786 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.2969e+01
[rank2]:2025-10-31 02:36:21,779 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4679e+00
[rank1]:2025-10-31 02:36:41,711 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6432e+00
[rank3]:2025-10-31 02:36:41,721 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3370e+00
[rank0]:2025-10-31 02:36:41,718 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.9705e+00
[rank2]:2025-10-31 02:36:41,711 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9210e+00
[rank1]:2025-10-31 02:37:00,812 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9521e+00
[rank3]:2025-10-31 02:37:00,818 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4816e+01
[rank0]:2025-10-31 02:37:00,819 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2265e+00
[rank2]:2025-10-31 02:37:00,812 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1404e+01
[rank0]:2025-10-31 02:37:19,883 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7564e-01
[rank2]:2025-10-31 02:37:19,876 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2947e+00
[rank1]:2025-10-31 02:37:19,876 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5269e+00
[rank3]:2025-10-31 02:37:19,883 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4209e+00
[rank0]:2025-10-31 02:37:37,137 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 02:37:39,059 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8606e+00
[rank1]:2025-10-31 02:37:39,059 - INFO -  step: 1650  loss: -4.0000  grad_norm:  1.9142  memory: 47.26GiB(33.80%)  tps: 8,483  tflops: 395.65  mfu: 40.00%
[rank3]:2025-10-31 02:37:39,066 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.5064e+00
[rank3]:2025-10-31 02:37:39,072 - INFO -  step: 1650  loss:  2.3317  grad_norm:  1.9142  memory: 46.16GiB(33.01%)  tps: 8,484  tflops: 395.69  mfu: 40.01%
[rank0]:2025-10-31 02:37:39,066 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4008e+01
[rank0]:2025-10-31 02:37:39,067 - INFO -  step: 1650  loss: -4.0000  grad_norm:  1.9142  memory: 54.93GiB(39.29%)  tps: 8,479  tflops: 395.48  mfu: 39.99%
[rank2]:2025-10-31 02:37:39,059 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7163e+00
[rank2]:2025-10-31 02:37:39,059 - INFO -  step: 1650  loss: -4.0000  grad_norm:  1.9142  memory: 38.72GiB(27.69%)  tps: 8,484  tflops: 395.71  mfu: 40.01%
[rank1]:2025-10-31 02:37:39,559 - INFO - Avg. fwd time: 16.1538 / Avg. bwd time: 27.2955 / Avg. batch time: 487.2734 (ms) / GPU bubble ratio: 28.67%
[rank3]:2025-10-31 02:37:39,499 - INFO - Avg. fwd time: 15.3943 / Avg. bwd time: 32.8015 / Avg. batch time: 402.2549 (ms) / GPU bubble ratio: 4.15%
[rank0]:2025-10-31 02:37:39,591 - INFO - Avg. fwd time: 14.5363 / Avg. bwd time: 25.7495 / Avg. batch time: 529.3020 (ms) / GPU bubble ratio: 39.11%
[rank2]:2025-10-31 02:37:39,529 - INFO - Avg. fwd time: 14.1641 / Avg. bwd time: 24.4431 / Avg. batch time: 442.6161 (ms) / GPU bubble ratio: 30.22%
[rank1]:2025-10-31 02:37:58,184 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3326e+00
[rank0]:2025-10-31 02:37:58,191 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3194e+00
[rank2]:2025-10-31 02:37:58,184 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0438e+00
[rank3]:2025-10-31 02:37:58,191 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4400e+00
[rank0]:2025-10-31 02:38:17,327 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6386e+00
[rank2]:2025-10-31 02:38:17,320 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3571e+00
[rank1]:2025-10-31 02:38:17,320 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7419e+00
[rank3]:2025-10-31 02:38:17,327 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.5374e+00
[rank1]:2025-10-31 02:38:36,416 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.3513e+00
[rank0]:2025-10-31 02:38:36,423 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.7935e+00
[rank2]:2025-10-31 02:38:36,415 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0789e+01
[rank3]:2025-10-31 02:38:36,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3584e+01
[rank1]:2025-10-31 02:38:55,533 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0152e+00
[rank0]:2025-10-31 02:38:55,541 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5446e+00
[rank2]:2025-10-31 02:38:55,534 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.5672e+00
[rank3]:2025-10-31 02:38:55,541 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.0814e+00
[rank0]:2025-10-31 02:39:12,735 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:39:14,619 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.9447e-01
[rank2]:2025-10-31 02:39:14,619 - INFO -  step: 1700  loss: -4.0000  grad_norm:  2.1784  memory: 38.72GiB(27.69%)  tps: 8,573  tflops: 399.83  mfu: 40.43%
[rank1]:2025-10-31 02:39:14,619 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6420e+00
[rank1]:2025-10-31 02:39:14,619 - INFO -  step: 1700  loss: -4.0000  grad_norm:  2.1784  memory: 47.26GiB(33.80%)  tps: 8,573  tflops: 399.83  mfu: 40.43%
[rank3]:2025-10-31 02:39:14,626 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.3462e+00
[rank3]:2025-10-31 02:39:14,629 - INFO -  step: 1700  loss:  1.7333  grad_norm:  2.1784  memory: 46.16GiB(33.01%)  tps: 8,573  tflops: 399.84  mfu: 40.43%
[rank0]:2025-10-31 02:39:14,626 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.3629e+00
[rank0]:2025-10-31 02:39:14,626 - INFO -  step: 1700  loss: -4.0000  grad_norm:  2.1784  memory: 54.93GiB(39.29%)  tps: 8,573  tflops: 399.83  mfu: 40.43%
[rank2]:2025-10-31 02:39:14,714 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0239_stage2_step1700.svg
[rank1]:2025-10-31 02:39:14,712 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0239_stage1_step1700.svg
[rank0]:2025-10-31 02:39:14,713 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0239_stage0_step1700.svg
[rank3]:2025-10-31 02:39:14,822 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0239_real_step1700_rank3.svg
[rank3]:> Batch Time: 489.05 ms, GPU Bubble Ratio: 41.73%, 35.52%, 42.05%, 22.92%
[rank3]:2025-10-31 02:39:14,893 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0239_stage3_step1700.svg
[rank2]:2025-10-31 02:39:15,191 - INFO - Avg. fwd time: 14.1808 / Avg. bwd time: 24.2831 / Avg. batch time: 441.2286 (ms) / GPU bubble ratio: 30.26%
[rank1]:2025-10-31 02:39:15,200 - INFO - Avg. fwd time: 16.1710 / Avg. bwd time: 27.1159 / Avg. batch time: 485.7056 (ms) / GPU bubble ratio: 28.70%
[rank3]:2025-10-31 02:39:15,182 - INFO - Avg. fwd time: 15.4110 / Avg. bwd time: 32.6368 / Avg. batch time: 401.0369 (ms) / GPU bubble ratio: 4.15%
[rank0]:2025-10-31 02:39:15,216 - INFO - Avg. fwd time: 14.5515 / Avg. bwd time: 25.6118 / Avg. batch time: 527.5939 (ms) / GPU bubble ratio: 39.10%
[rank0]:2025-10-31 02:39:33,916 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0374e+00
[rank2]:2025-10-31 02:39:33,908 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1843e+00
[rank3]:2025-10-31 02:39:33,916 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8992e+00
[rank1]:2025-10-31 02:39:33,909 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3036e+00
[rank2]:2025-10-31 02:39:53,044 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2452e+00
[rank1]:2025-10-31 02:39:53,044 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2267e+00
[rank3]:2025-10-31 02:39:53,051 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0944e+00
[rank0]:2025-10-31 02:39:53,051 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3074e+01
[rank2]:2025-10-31 02:40:12,150 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1776e+00
[rank1]:2025-10-31 02:40:12,151 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7207e+00
[rank3]:2025-10-31 02:40:12,157 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6642e+00
[rank0]:2025-10-31 02:40:12,158 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0225e+00
[rank1]:2025-10-31 02:40:31,311 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2585e+00
[rank3]:2025-10-31 02:40:31,318 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0432e+00
[rank0]:2025-10-31 02:40:31,318 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.3295e+00
[rank2]:2025-10-31 02:40:31,311 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2549e+00
[rank0]:2025-10-31 02:40:48,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:40:50,505 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4508e+00
[rank2]:2025-10-31 02:40:50,506 - INFO -  step: 1750  loss: -4.0000  grad_norm:  1.9656  memory: 38.72GiB(27.69%)  tps: 8,543  tflops: 398.47  mfu: 40.29%
[rank1]:2025-10-31 02:40:50,506 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3452e+00
[rank1]:2025-10-31 02:40:50,506 - INFO -  step: 1750  loss: -4.0000  grad_norm:  1.9656  memory: 47.26GiB(33.80%)  tps: 8,543  tflops: 398.47  mfu: 40.29%
[rank3]:2025-10-31 02:40:50,512 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1413e+00
[rank3]:2025-10-31 02:40:50,516 - INFO -  step: 1750  loss:  2.0520  grad_norm:  1.9656  memory: 46.16GiB(33.01%)  tps: 8,544  tflops: 398.47  mfu: 40.29%
[rank0]:2025-10-31 02:40:50,512 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5369e+00
[rank0]:2025-10-31 02:40:50,513 - INFO -  step: 1750  loss: -4.0000  grad_norm:  1.9656  memory: 54.93GiB(39.29%)  tps: 8,543  tflops: 398.47  mfu: 40.29%
[rank3]:2025-10-31 02:40:50,855 - INFO - Avg. fwd time: 15.4295 / Avg. bwd time: 32.4555 / Avg. batch time: 399.6976 (ms) / GPU bubble ratio: 4.16%
[rank0]:2025-10-31 02:40:50,889 - INFO - Avg. fwd time: 14.5690 / Avg. bwd time: 25.4602 / Avg. batch time: 525.7399 (ms) / GPU bubble ratio: 39.09%
[rank2]:2025-10-31 02:40:50,863 - INFO - Avg. fwd time: 14.1994 / Avg. bwd time: 24.1067 / Avg. batch time: 439.7225 (ms) / GPU bubble ratio: 30.31%
[rank1]:2025-10-31 02:40:50,874 - INFO - Avg. fwd time: 16.1902 / Avg. bwd time: 26.9178 / Avg. batch time: 484.0020 (ms) / GPU bubble ratio: 28.75%
[rank2]:2025-10-31 02:41:09,730 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4874e+01
[rank1]:2025-10-31 02:41:09,730 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.6330e+00
[rank0]:2025-10-31 02:41:09,737 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4962e+00
[rank3]:2025-10-31 02:41:09,737 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1515e+01
[rank2]:2025-10-31 02:41:28,882 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7540e+00
[rank1]:2025-10-31 02:41:28,882 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5345e+00
[rank0]:2025-10-31 02:41:28,889 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.2008e+00
[rank3]:2025-10-31 02:41:28,889 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1500e+00
[rank1]:2025-10-31 02:41:48,136 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2070e+00
[rank0]:2025-10-31 02:41:48,143 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8775e+00
[rank3]:2025-10-31 02:41:48,142 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0270e+00
[rank2]:2025-10-31 02:41:48,136 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2655e+00
[rank3]:2025-10-31 02:42:07,282 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3891e+00
[rank2]:2025-10-31 02:42:07,275 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2709e+01
[rank1]:2025-10-31 02:42:07,275 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6092e+00
[rank0]:2025-10-31 02:42:07,283 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.4971e+00
[rank0]:2025-10-31 02:42:24,516 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:42:26,434 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0433e+00
[rank2]:2025-10-31 02:42:26,435 - INFO -  step: 1800  loss: -4.0000  grad_norm:  1.5078  memory: 38.72GiB(27.69%)  tps: 8,540  tflops: 398.29  mfu: 40.27%
[rank2]:2025-10-31 02:42:26,435 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-31 02:42:26,435 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.9836e+00
[rank1]:2025-10-31 02:42:26,435 - INFO -  step: 1800  loss: -4.0000  grad_norm:  1.5078  memory: 47.26GiB(33.80%)  tps: 8,540  tflops: 398.29  mfu: 40.27%
[rank1]:2025-10-31 02:42:26,435 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 02:42:26,442 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.6250e+01
[rank0]:2025-10-31 02:42:26,442 - INFO -  step: 1800  loss: -4.0000  grad_norm:  1.5078  memory: 54.93GiB(39.29%)  tps: 8,540  tflops: 398.29  mfu: 40.27%
[rank0]:2025-10-31 02:42:26,442 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-31 02:42:26,441 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6001e+00
[rank3]:2025-10-31 02:42:26,448 - INFO -  step: 1800  loss:  2.2638  grad_norm:  1.5078  memory: 46.16GiB(33.01%)  tps: 8,540  tflops: 398.30  mfu: 40.27%
[rank3]:2025-10-31 02:42:26,448 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 02:42:42,682 - INFO - validate step: 1800  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,222
[rank3]:2025-10-31 02:42:42,739 - INFO - validate step: 1800  loss:  0.8657  memory: 46.16GiB(33.01%)  tps: 25,145
[rank2]:2025-10-31 02:42:42,733 - INFO - validate step: 1800  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,133
[rank1]:2025-10-31 02:42:42,717 - INFO - validate step: 1800  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,157
[rank2]:2025-10-31 02:42:42,820 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0242_stage2_step1800.svg
[rank1]:2025-10-31 02:42:42,821 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0242_stage1_step1800.svg
[rank0]:2025-10-31 02:42:42,823 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0242_stage0_step1800.svg
[rank3]:2025-10-31 02:42:42,924 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0242_real_step1800_rank3.svg
[rank3]:> Batch Time: 486.62 ms, GPU Bubble Ratio: 41.41%, 35.55%, 41.79%, 23.00%
[rank3]:2025-10-31 02:42:42,991 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0242_stage3_step1800.svg
[rank3]:2025-10-31 02:42:43,369 - INFO - Avg. fwd time: 15.4472 / Avg. bwd time: 32.2850 / Avg. batch time: 398.4414 (ms) / GPU bubble ratio: 4.16%
[rank2]:2025-10-31 02:42:43,398 - INFO - Avg. fwd time: 14.2170 / Avg. bwd time: 23.9409 / Avg. batch time: 438.3080 (ms) / GPU bubble ratio: 30.35%
[rank1]:2025-10-31 02:42:43,428 - INFO - Avg. fwd time: 16.2081 / Avg. bwd time: 26.7312 / Avg. batch time: 482.4015 (ms) / GPU bubble ratio: 28.79%
[rank0]:2025-10-31 02:42:43,458 - INFO - Avg. fwd time: 14.5858 / Avg. bwd time: 25.3175 / Avg. batch time: 524.0020 (ms) / GPU bubble ratio: 39.08%
[rank3]:2025-10-31 02:43:02,138 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0911e+00
[rank2]:2025-10-31 02:43:02,132 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7268e+00
[rank1]:2025-10-31 02:43:02,132 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3409e+00
[rank0]:2025-10-31 02:43:02,139 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6548e+01
[rank2]:2025-10-31 02:43:21,176 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.5445e-01
[rank1]:2025-10-31 02:43:21,176 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9930e+00
[rank0]:2025-10-31 02:43:21,183 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5742e+00
[rank3]:2025-10-31 02:43:21,183 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8452e+00
[rank3]:2025-10-31 02:43:40,264 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0380e+00
[rank2]:2025-10-31 02:43:40,258 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0586e+00
[rank1]:2025-10-31 02:43:40,258 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9997e+00
[rank0]:2025-10-31 02:43:40,265 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4705e+01
[rank1]:2025-10-31 02:43:59,360 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2795e+00
[rank0]:2025-10-31 02:43:59,367 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8090e+00
[rank3]:2025-10-31 02:43:59,366 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.8273e+00
[rank2]:2025-10-31 02:43:59,360 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.9374e+00
[rank0]:2025-10-31 02:44:16,507 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 02:44:18,423 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4515e+00
[rank2]:2025-10-31 02:44:18,416 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9893e+00
[rank2]:2025-10-31 02:44:18,417 - INFO -  step: 1850  loss: -4.0000  grad_norm:  3.1333  memory: 38.72GiB(27.69%)  tps: 8,562  tflops: 399.31  mfu: 40.38%
[rank1]:2025-10-31 02:44:18,416 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6623e+00
[rank1]:2025-10-31 02:44:18,417 - INFO -  step: 1850  loss: -4.0000  grad_norm:  3.1333  memory: 47.26GiB(33.80%)  tps: 8,560  tflops: 399.25  mfu: 40.37%
[rank0]:2025-10-31 02:44:18,423 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.1721e+00
[rank0]:2025-10-31 02:44:18,424 - INFO -  step: 1850  loss: -4.0000  grad_norm:  3.1333  memory: 54.93GiB(39.29%)  tps: 8,556  tflops: 399.07  mfu: 40.35%
[rank3]:2025-10-31 02:44:18,426 - INFO -  step: 1850  loss:  2.3862  grad_norm:  3.1333  memory: 46.16GiB(33.01%)  tps: 8,561  tflops: 399.30  mfu: 40.37%
[rank3]:2025-10-31 02:44:18,762 - INFO - Avg. fwd time: 15.4615 / Avg. bwd time: 32.1466 / Avg. batch time: 397.4201 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-31 02:44:18,771 - INFO - Avg. fwd time: 14.2313 / Avg. bwd time: 23.8063 / Avg. batch time: 437.1429 (ms) / GPU bubble ratio: 30.39%
[rank1]:2025-10-31 02:44:18,782 - INFO - Avg. fwd time: 16.2228 / Avg. bwd time: 26.5800 / Avg. batch time: 481.0852 (ms) / GPU bubble ratio: 28.82%
[rank0]:2025-10-31 02:44:18,797 - INFO - Avg. fwd time: 14.5989 / Avg. bwd time: 25.2019 / Avg. batch time: 522.5669 (ms) / GPU bubble ratio: 39.07%
[rank2]:2025-10-31 02:44:37,558 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0441e+01
[rank1]:2025-10-31 02:44:37,557 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0347e+01
[rank0]:2025-10-31 02:44:37,565 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8991e+01
[rank3]:2025-10-31 02:44:37,564 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.2751e+00
[rank0]:2025-10-31 02:44:56,627 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3426e+00
[rank3]:2025-10-31 02:44:56,626 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.6890e+00
[rank2]:2025-10-31 02:44:56,619 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6049e+00
[rank1]:2025-10-31 02:44:56,619 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.7474e+00
[rank2]:2025-10-31 02:45:15,696 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.9100e+00
[rank1]:2025-10-31 02:45:15,696 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6801e+01
[rank0]:2025-10-31 02:45:15,703 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4379e+02
[rank3]:2025-10-31 02:45:15,702 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9009e+00
[rank1]:2025-10-31 02:45:34,830 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4932e+00
[rank0]:2025-10-31 02:45:34,837 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4400e+00
[rank3]:2025-10-31 02:45:34,837 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9469e+00
[rank2]:2025-10-31 02:45:34,830 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.5785e+00
[rank0]:2025-10-31 02:45:52,000 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:45:53,916 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.7365e+00
[rank2]:2025-10-31 02:45:53,916 - INFO -  step: 1900  loss: -4.0000  grad_norm:  2.2912  memory: 38.72GiB(27.69%)  tps: 8,578  tflops: 400.08  mfu: 40.45%
[rank1]:2025-10-31 02:45:53,916 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0053e+00
[rank1]:2025-10-31 02:45:53,916 - INFO -  step: 1900  loss: -4.0000  grad_norm:  2.2912  memory: 47.26GiB(33.80%)  tps: 8,578  tflops: 400.08  mfu: 40.45%
[rank0]:2025-10-31 02:45:53,923 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7664e+00
[rank0]:2025-10-31 02:45:53,923 - INFO -  step: 1900  loss: -4.0000  grad_norm:  2.2912  memory: 54.93GiB(39.29%)  tps: 8,578  tflops: 400.08  mfu: 40.45%
[rank3]:2025-10-31 02:45:53,923 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8140e+00
[rank3]:2025-10-31 02:45:53,926 - INFO -  step: 1900  loss:  2.0626  grad_norm:  2.2912  memory: 46.16GiB(33.01%)  tps: 8,578  tflops: 400.09  mfu: 40.45%
[rank2]:2025-10-31 02:45:54,010 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0245_stage2_step1900.svg
[rank1]:2025-10-31 02:45:54,010 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0245_stage1_step1900.svg
[rank0]:2025-10-31 02:45:54,011 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0245_stage0_step1900.svg
[rank3]:2025-10-31 02:45:54,114 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0245_real_step1900_rank3.svg
[rank3]:> Batch Time: 483.70 ms, GPU Bubble Ratio: 41.04%, 38.09%, 41.47%, 22.70%
[rank3]:2025-10-31 02:45:54,182 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0245_stage3_step1900.svg
[rank3]:2025-10-31 02:45:54,479 - INFO - Avg. fwd time: 15.4773 / Avg. bwd time: 31.9934 / Avg. batch time: 396.2886 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-31 02:45:54,487 - INFO - Avg. fwd time: 14.2469 / Avg. bwd time: 23.6571 / Avg. batch time: 435.8522 (ms) / GPU bubble ratio: 30.43%
[rank1]:2025-10-31 02:45:54,498 - INFO - Avg. fwd time: 16.2387 / Avg. bwd time: 26.4123 / Avg. batch time: 479.6260 (ms) / GPU bubble ratio: 28.86%
[rank0]:2025-10-31 02:45:54,514 - INFO - Avg. fwd time: 14.6130 / Avg. bwd time: 25.0737 / Avg. batch time: 520.9756 (ms) / GPU bubble ratio: 39.06%
[rank3]:2025-10-31 02:46:13,313 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4938e+00
[rank2]:2025-10-31 02:46:13,307 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5821e+00
[rank1]:2025-10-31 02:46:13,307 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9586e+00
[rank0]:2025-10-31 02:46:13,314 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.7215e+01
[rank2]:2025-10-31 02:46:32,437 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.5456e+00
[rank1]:2025-10-31 02:46:32,438 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8433e+00
[rank0]:2025-10-31 02:46:32,445 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.2931e+00
[rank3]:2025-10-31 02:46:32,444 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1649e+01
[rank3]:2025-10-31 02:46:51,549 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3932e+00
[rank2]:2025-10-31 02:46:51,542 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8707e+00
[rank1]:2025-10-31 02:46:51,542 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1975e+00
[rank0]:2025-10-31 02:46:51,549 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.2324e+00
[rank3]:2025-10-31 02:47:10,653 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.4618e+00
[rank2]:2025-10-31 02:47:10,647 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1173e+00
[rank1]:2025-10-31 02:47:10,647 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6935e+00
[rank0]:2025-10-31 02:47:10,654 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4472e-01
[rank0]:2025-10-31 02:47:27,772 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:47:29,696 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2811e+01
[rank2]:2025-10-31 02:47:29,696 - INFO -  step: 1950  loss: -4.0000  grad_norm:  1.6568  memory: 38.72GiB(27.69%)  tps: 8,553  tflops: 398.91  mfu: 40.33%
[rank1]:2025-10-31 02:47:29,696 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.4840e+00
[rank1]:2025-10-31 02:47:29,696 - INFO -  step: 1950  loss: -4.0000  grad_norm:  1.6568  memory: 47.26GiB(33.80%)  tps: 8,553  tflops: 398.91  mfu: 40.33%
[rank0]:2025-10-31 02:47:29,703 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6626e+00
[rank0]:2025-10-31 02:47:29,704 - INFO -  step: 1950  loss: -4.0000  grad_norm:  1.6568  memory: 54.93GiB(39.29%)  tps: 8,553  tflops: 398.91  mfu: 40.33%
[rank3]:2025-10-31 02:47:29,703 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0423e+01
[rank3]:2025-10-31 02:47:29,706 - INFO -  step: 1950  loss:  2.7298  grad_norm:  1.6568  memory: 46.16GiB(33.01%)  tps: 8,553  tflops: 398.92  mfu: 40.34%
[rank3]:2025-10-31 02:47:30,131 - INFO - Avg. fwd time: 15.4920 / Avg. bwd time: 31.8482 / Avg. batch time: 395.2151 (ms) / GPU bubble ratio: 4.17%
[rank2]:2025-10-31 02:47:30,161 - INFO - Avg. fwd time: 14.2618 / Avg. bwd time: 23.5160 / Avg. batch time: 434.6458 (ms) / GPU bubble ratio: 30.47%
[rank1]:2025-10-31 02:47:30,193 - INFO - Avg. fwd time: 16.2555 / Avg. bwd time: 26.2559 / Avg. batch time: 478.2638 (ms) / GPU bubble ratio: 28.89%
[rank0]:2025-10-31 02:47:30,225 - INFO - Avg. fwd time: 14.6266 / Avg. bwd time: 24.9524 / Avg. batch time: 519.4907 (ms) / GPU bubble ratio: 39.05%
[rank2]:2025-10-31 02:47:48,843 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3194e+00
[rank1]:2025-10-31 02:47:48,843 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4083e+00
[rank0]:2025-10-31 02:47:48,851 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1048e+01
[rank3]:2025-10-31 02:47:48,850 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7749e+00
[rank3]:2025-10-31 02:48:08,020 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3481e+00
[rank2]:2025-10-31 02:48:08,013 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3119e+00
[rank1]:2025-10-31 02:48:08,013 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.6948e+00
[rank0]:2025-10-31 02:48:08,021 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3345e+01
[rank0]:2025-10-31 02:48:27,100 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.1821e+00
[rank3]:2025-10-31 02:48:27,100 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2737e+00
[rank2]:2025-10-31 02:48:27,093 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6260e+00
[rank1]:2025-10-31 02:48:27,093 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9019e+00
[rank3]:2025-10-31 02:48:46,234 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2252e+00
[rank2]:2025-10-31 02:48:46,227 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5975e+00
[rank1]:2025-10-31 02:48:46,227 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0307e+00
[rank0]:2025-10-31 02:48:46,234 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8675e+01
[rank0]:2025-10-31 02:49:03,422 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:49:05,348 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4843e+00
[rank3]:2025-10-31 02:49:05,351 - INFO -  step: 2000  loss:  2.0185  grad_norm:  2.0832  memory: 46.16GiB(33.01%)  tps: 8,565  tflops: 399.48  mfu: 40.39%
[rank3]:2025-10-31 02:49:05,351 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-31 02:49:05,341 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1170e+00
[rank1]:2025-10-31 02:49:05,342 - INFO -  step: 2000  loss: -4.0000  grad_norm:  2.0832  memory: 47.26GiB(33.80%)  tps: 8,565  tflops: 399.47  mfu: 40.39%
[rank1]:2025-10-31 02:49:05,342 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-31 02:49:05,341 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.8455e+00
[rank2]:2025-10-31 02:49:05,341 - INFO -  step: 2000  loss: -4.0000  grad_norm:  2.0832  memory: 38.72GiB(27.69%)  tps: 8,565  tflops: 399.47  mfu: 40.39%
[rank2]:2025-10-31 02:49:05,342 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-31 02:49:05,348 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.2535e+00
[rank0]:2025-10-31 02:49:05,349 - INFO -  step: 2000  loss: -4.0000  grad_norm:  2.0832  memory: 54.93GiB(39.29%)  tps: 8,565  tflops: 399.47  mfu: 40.39%
[rank0]:2025-10-31 02:49:05,349 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-31 02:49:21,732 - INFO - validate step: 2000  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,002
[rank1]:2025-10-31 02:49:21,767 - INFO - validate step: 2000  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,938
[rank2]:2025-10-31 02:49:21,783 - INFO - validate step: 2000  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,912
[rank3]:2025-10-31 02:49:21,786 - INFO - validate step: 2000  loss:  0.8566  memory: 46.16GiB(33.01%)  tps: 24,924
[rank1]:2025-10-31 02:49:21,873 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0249_stage1_step2000.svg
[rank2]:2025-10-31 02:49:21,873 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0249_stage2_step2000.svg
[rank0]:2025-10-31 02:49:21,874 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0249_stage0_step2000.svg
[rank3]:2025-10-31 02:49:21,978 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0249_real_step2000_rank3.svg
[rank3]:> Batch Time: 482.18 ms, GPU Bubble Ratio: 40.84%, 37.97%, 41.33%, 22.75%
[rank3]:2025-10-31 02:49:22,050 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0249_stage3_step2000.svg
[rank3]:2025-10-31 02:49:22,343 - INFO - Avg. fwd time: 15.5041 / Avg. bwd time: 31.7299 / Avg. batch time: 394.3419 (ms) / GPU bubble ratio: 4.18%
[rank1]:2025-10-31 02:49:22,363 - INFO - Avg. fwd time: 16.2691 / Avg. bwd time: 26.1283 / Avg. batch time: 477.1399 (ms) / GPU bubble ratio: 28.91%
[rank2]:2025-10-31 02:49:22,352 - INFO - Avg. fwd time: 14.2739 / Avg. bwd time: 23.4010 / Avg. batch time: 433.6494 (ms) / GPU bubble ratio: 30.50%
[rank0]:2025-10-31 02:49:22,380 - INFO - Avg. fwd time: 14.6376 / Avg. bwd time: 24.8534 / Avg. batch time: 518.2656 (ms) / GPU bubble ratio: 39.04%
[rank0]:2025-10-31 02:49:41,076 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5131e+00
[rank3]:2025-10-31 02:49:41,075 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.4857e+00
[rank1]:2025-10-31 02:49:41,068 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9632e+00
[rank2]:2025-10-31 02:49:41,069 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0917e+00
[rank3]:2025-10-31 02:50:00,201 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7044e+00
[rank1]:2025-10-31 02:50:00,195 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.9643e+00
[rank2]:2025-10-31 02:50:00,195 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9145e+00
[rank0]:2025-10-31 02:50:00,202 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.4743e+01
[rank1]:2025-10-31 02:50:19,276 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.7916e+00
[rank2]:2025-10-31 02:50:19,277 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9956e+00
[rank0]:2025-10-31 02:50:19,284 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4122e+00
[rank3]:2025-10-31 02:50:19,283 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.0630e+00
[rank1]:2025-10-31 02:50:38,380 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.6422e+00
[rank2]:2025-10-31 02:50:38,380 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6961e+00
[rank0]:2025-10-31 02:50:38,387 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.0723e+01
[rank3]:2025-10-31 02:50:38,387 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8450e+00
[rank0]:2025-10-31 02:50:55,625 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 02:50:57,532 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0499e+00
[rank0]:2025-10-31 02:50:57,532 - INFO -  step: 2050  loss: -4.0000  grad_norm:  2.5261  memory: 54.93GiB(39.29%)  tps: 8,551  tflops: 398.83  mfu: 40.33%
[rank3]:2025-10-31 02:50:57,531 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6802e+00
[rank3]:2025-10-31 02:50:57,534 - INFO -  step: 2050  loss:  2.0764  grad_norm:  2.5261  memory: 46.16GiB(33.01%)  tps: 8,556  tflops: 399.05  mfu: 40.35%
[rank1]:2025-10-31 02:50:57,525 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1451e+00
[rank1]:2025-10-31 02:50:57,525 - INFO -  step: 2050  loss: -4.0000  grad_norm:  2.5261  memory: 47.26GiB(33.80%)  tps: 8,555  tflops: 399.00  mfu: 40.34%
[rank2]:2025-10-31 02:50:57,525 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0437e+00
[rank2]:2025-10-31 02:50:57,525 - INFO -  step: 2050  loss: -4.0000  grad_norm:  2.5261  memory: 38.72GiB(27.69%)  tps: 8,556  tflops: 399.07  mfu: 40.35%
[rank1]:2025-10-31 02:50:57,895 - INFO - Avg. fwd time: 16.2834 / Avg. bwd time: 25.9852 / Avg. batch time: 475.9073 (ms) / GPU bubble ratio: 28.95%
[rank2]:2025-10-31 02:50:57,885 - INFO - Avg. fwd time: 14.2874 / Avg. bwd time: 23.2733 / Avg. batch time: 432.5605 (ms) / GPU bubble ratio: 30.53%
[rank0]:2025-10-31 02:50:57,910 - INFO - Avg. fwd time: 14.6501 / Avg. bwd time: 24.7437 / Avg. batch time: 516.9203 (ms) / GPU bubble ratio: 39.03%
[rank3]:2025-10-31 02:50:57,876 - INFO - Avg. fwd time: 15.5177 / Avg. bwd time: 31.5986 / Avg. batch time: 393.3739 (ms) / GPU bubble ratio: 4.18%
[rank0]:2025-10-31 02:51:16,558 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.0451e+00
[rank3]:2025-10-31 02:51:16,557 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3990e+00
[rank1]:2025-10-31 02:51:16,551 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2486e+00
[rank2]:2025-10-31 02:51:16,551 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8651e+00
[rank1]:2025-10-31 02:51:35,618 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9051e+00
[rank2]:2025-10-31 02:51:35,618 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3507e+00
[rank0]:2025-10-31 02:51:35,625 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1294e+01
[rank3]:2025-10-31 02:51:35,625 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.2560e+00
[rank1]:2025-10-31 02:51:54,734 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.9252e-01
[rank2]:2025-10-31 02:51:54,734 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.3971e+00
[rank0]:2025-10-31 02:51:54,741 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.4744e+00
[rank3]:2025-10-31 02:51:54,740 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5161e+00
[rank1]:2025-10-31 02:52:13,764 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3490e+00
[rank2]:2025-10-31 02:52:13,764 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2429e+00
[rank0]:2025-10-31 02:52:13,772 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7415e+00
[rank3]:2025-10-31 02:52:13,771 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2712e+00
[rank0]:2025-10-31 02:52:31,003 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:52:32,897 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.1216e+00
[rank2]:2025-10-31 02:52:32,898 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.6770  memory: 38.72GiB(27.69%)  tps: 8,590  tflops: 400.62  mfu: 40.51%
[rank0]:2025-10-31 02:52:32,904 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2078e+02
[rank0]:2025-10-31 02:52:32,905 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.6770  memory: 54.93GiB(39.29%)  tps: 8,590  tflops: 400.62  mfu: 40.51%
[rank3]:2025-10-31 02:52:32,904 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6342e+00
[rank3]:2025-10-31 02:52:32,906 - INFO -  step: 2100  loss:  2.2668  grad_norm:  0.6770  memory: 46.16GiB(33.01%)  tps: 8,590  tflops: 400.62  mfu: 40.51%
[rank1]:2025-10-31 02:52:32,897 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3611e+01
[rank1]:2025-10-31 02:52:32,898 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.6770  memory: 47.26GiB(33.80%)  tps: 8,590  tflops: 400.62  mfu: 40.51%
[rank1]:2025-10-31 02:52:32,985 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0252_stage1_step2100.svg
[rank2]:2025-10-31 02:52:32,984 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0252_stage2_step2100.svg
[rank0]:2025-10-31 02:52:32,984 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0252_stage0_step2100.svg
[rank3]:2025-10-31 02:52:33,090 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0252_real_step2100_rank3.svg
[rank3]:> Batch Time: 471.87 ms, GPU Bubble Ratio: 39.55%, 36.65%, 40.30%, 23.23%
[rank3]:2025-10-31 02:52:33,151 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0252_stage3_step2100.svg
[rank3]:2025-10-31 02:52:33,523 - INFO - Avg. fwd time: 15.5304 / Avg. bwd time: 31.4736 / Avg. batch time: 392.4496 (ms) / GPU bubble ratio: 4.18%
[rank1]:2025-10-31 02:52:33,583 - INFO - Avg. fwd time: 16.2967 / Avg. bwd time: 25.8489 / Avg. batch time: 474.7319 (ms) / GPU bubble ratio: 28.98%
[rank2]:2025-10-31 02:52:33,553 - INFO - Avg. fwd time: 14.3002 / Avg. bwd time: 23.1518 / Avg. batch time: 431.5207 (ms) / GPU bubble ratio: 30.57%
[rank0]:2025-10-31 02:52:33,613 - INFO - Avg. fwd time: 14.6616 / Avg. bwd time: 24.6392 / Avg. batch time: 515.6378 (ms) / GPU bubble ratio: 39.03%
[rank2]:2025-10-31 02:52:52,225 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8548e+00
[rank0]:2025-10-31 02:52:52,233 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.4399e+00
[rank3]:2025-10-31 02:52:52,232 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3864e+00
[rank1]:2025-10-31 02:52:52,226 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2639e+00
[rank3]:2025-10-31 02:53:11,285 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8152e+00
[rank1]:2025-10-31 02:53:11,279 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.3576e+00
[rank2]:2025-10-31 02:53:11,279 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.4474e+00
[rank0]:2025-10-31 02:53:11,286 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.6622e+01
[rank1]:2025-10-31 02:53:30,405 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8960e+00
[rank2]:2025-10-31 02:53:30,404 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2707e+00
[rank0]:2025-10-31 02:53:30,412 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9214e+00
[rank3]:2025-10-31 02:53:30,411 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9144e+00
[rank1]:2025-10-31 02:53:49,437 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9103e+00
[rank2]:2025-10-31 02:53:49,437 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5567e+00
[rank0]:2025-10-31 02:53:49,444 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8639e+00
[rank3]:2025-10-31 02:53:49,444 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9587e+00
[rank0]:2025-10-31 02:54:06,599 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 02:54:08,516 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3929e+00
[rank3]:2025-10-31 02:54:08,519 - INFO -  step: 2150  loss:  2.2474  grad_norm:  0.2620  memory: 46.16GiB(33.01%)  tps: 8,568  tflops: 399.62  mfu: 40.41%
[rank1]:2025-10-31 02:54:08,509 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4334e+01
[rank1]:2025-10-31 02:54:08,509 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2620  memory: 47.26GiB(33.80%)  tps: 8,568  tflops: 399.61  mfu: 40.41%
[rank2]:2025-10-31 02:54:08,509 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5305e+00
[rank2]:2025-10-31 02:54:08,510 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2620  memory: 38.72GiB(27.69%)  tps: 8,568  tflops: 399.61  mfu: 40.41%
[rank0]:2025-10-31 02:54:08,516 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.7288e+01
[rank0]:2025-10-31 02:54:08,517 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2620  memory: 54.93GiB(39.29%)  tps: 8,568  tflops: 399.61  mfu: 40.41%
[rank2]:2025-10-31 02:54:08,866 - INFO - Avg. fwd time: 14.3109 / Avg. bwd time: 23.0524 / Avg. batch time: 430.6600 (ms) / GPU bubble ratio: 30.59%
[rank0]:2025-10-31 02:54:08,891 - INFO - Avg. fwd time: 14.6712 / Avg. bwd time: 24.5538 / Avg. batch time: 514.5762 (ms) / GPU bubble ratio: 39.02%
[rank3]:2025-10-31 02:54:08,856 - INFO - Avg. fwd time: 15.5410 / Avg. bwd time: 31.3714 / Avg. batch time: 391.6961 (ms) / GPU bubble ratio: 4.19%
[rank1]:2025-10-31 02:54:08,876 - INFO - Avg. fwd time: 16.3079 / Avg. bwd time: 25.7374 / Avg. batch time: 473.7590 (ms) / GPU bubble ratio: 29.00%
[rank1]:2025-10-31 02:54:27,567 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.3516e+00
[rank2]:2025-10-31 02:54:27,567 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.7234e+00
[rank0]:2025-10-31 02:54:27,574 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.2350e+00
[rank3]:2025-10-31 02:54:27,573 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0838e+01
[rank3]:2025-10-31 02:54:46,654 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6367e+00
[rank1]:2025-10-31 02:54:46,647 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6442e+00
[rank2]:2025-10-31 02:54:46,647 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7461e+00
[rank0]:2025-10-31 02:54:46,654 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.8039e+01
[rank1]:2025-10-31 02:55:05,783 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4887e+00
[rank2]:2025-10-31 02:55:05,783 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2156e+00
[rank0]:2025-10-31 02:55:05,790 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5989e+00
[rank3]:2025-10-31 02:55:05,790 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7002e+00
[rank3]:2025-10-31 02:55:24,796 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0946e+01
[rank1]:2025-10-31 02:55:24,790 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1717e+00
[rank2]:2025-10-31 02:55:24,790 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5695e+01
[rank0]:2025-10-31 02:55:24,797 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.5908e+00
[rank0]:2025-10-31 02:55:41,963 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:55:43,857 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.5629e+00
[rank2]:2025-10-31 02:55:43,857 - INFO -  step: 2200  loss: -4.0000  grad_norm:  2.0059  memory: 38.72GiB(27.69%)  tps: 8,592  tflops: 400.72  mfu: 40.52%
[rank2]:2025-10-31 02:55:43,857 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 02:55:43,864 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2325e+01
[rank0]:2025-10-31 02:55:43,864 - INFO -  step: 2200  loss: -4.0000  grad_norm:  2.0059  memory: 54.93GiB(39.29%)  tps: 8,592  tflops: 400.72  mfu: 40.52%
[rank0]:2025-10-31 02:55:43,864 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-31 02:55:43,863 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2721e+00
[rank3]:2025-10-31 02:55:43,867 - INFO -  step: 2200  loss:  2.0161  grad_norm:  2.0059  memory: 46.16GiB(33.01%)  tps: 8,592  tflops: 400.72  mfu: 40.52%
[rank3]:2025-10-31 02:55:43,868 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-31 02:55:43,857 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3104e+00
[rank1]:2025-10-31 02:55:43,857 - INFO -  step: 2200  loss: -4.0000  grad_norm:  2.0059  memory: 47.26GiB(33.80%)  tps: 8,592  tflops: 400.72  mfu: 40.52%
[rank1]:2025-10-31 02:55:43,857 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 02:56:00,200 - INFO - validate step: 2200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,075
[rank1]:2025-10-31 02:56:00,235 - INFO - validate step: 2200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,010
[rank2]:2025-10-31 02:56:00,250 - INFO - validate step: 2200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,987
[rank3]:2025-10-31 02:56:00,254 - INFO - validate step: 2200  loss:  0.8616  memory: 46.16GiB(33.01%)  tps: 24,997
[rank1]:2025-10-31 02:56:00,335 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0256_stage1_step2200.svg
[rank2]:2025-10-31 02:56:00,334 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0256_stage2_step2200.svg
[rank0]:2025-10-31 02:56:00,333 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0256_stage0_step2200.svg
[rank3]:2025-10-31 02:56:00,439 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0256_real_step2200_rank3.svg
[rank3]:> Batch Time: 470.56 ms, GPU Bubble Ratio: 39.37%, 36.49%, 40.36%, 23.26%
[rank3]:2025-10-31 02:56:00,500 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0256_stage3_step2200.svg
[rank2]:2025-10-31 02:56:00,800 - INFO - Avg. fwd time: 14.3224 / Avg. bwd time: 22.9416 / Avg. batch time: 429.6947 (ms) / GPU bubble ratio: 30.62%
[rank3]:2025-10-31 02:56:00,790 - INFO - Avg. fwd time: 15.5524 / Avg. bwd time: 31.2573 / Avg. batch time: 390.8505 (ms) / GPU bubble ratio: 4.19%
[rank1]:2025-10-31 02:56:00,810 - INFO - Avg. fwd time: 16.3199 / Avg. bwd time: 25.6131 / Avg. batch time: 472.6681 (ms) / GPU bubble ratio: 29.03%
[rank0]:2025-10-31 02:56:00,824 - INFO - Avg. fwd time: 14.6814 / Avg. bwd time: 24.4586 / Avg. batch time: 513.3854 (ms) / GPU bubble ratio: 39.01%
[rank1]:2025-10-31 02:56:19,554 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.0709e+00
[rank2]:2025-10-31 02:56:19,554 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0288e+00
[rank0]:2025-10-31 02:56:19,561 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0572e+01
[rank3]:2025-10-31 02:56:19,560 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3175e+00
[rank1]:2025-10-31 02:56:38,589 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2796e+00
[rank2]:2025-10-31 02:56:38,589 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3705e+00
[rank0]:2025-10-31 02:56:38,595 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4723e+00
[rank3]:2025-10-31 02:56:38,595 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.4264e+00
[rank1]:2025-10-31 02:56:57,698 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1413e+01
[rank2]:2025-10-31 02:56:57,698 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3445e+00
[rank0]:2025-10-31 02:56:57,705 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5701e+01
[rank3]:2025-10-31 02:56:57,704 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3770e+00
[rank3]:2025-10-31 02:57:16,792 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.6189e-01
[rank1]:2025-10-31 02:57:16,786 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1664e+00
[rank2]:2025-10-31 02:57:16,786 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.0370e+00
[rank0]:2025-10-31 02:57:16,793 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.5981e+00
[rank0]:2025-10-31 02:57:33,948 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 02:57:35,859 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4761e+00
[rank2]:2025-10-31 02:57:35,859 - INFO -  step: 2250  loss: -4.0000  grad_norm:  1.7487  memory: 38.72GiB(27.69%)  tps: 8,568  tflops: 399.63  mfu: 40.41%
[rank0]:2025-10-31 02:57:35,866 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 9.0559e+00
[rank0]:2025-10-31 02:57:35,866 - INFO -  step: 2250  loss: -4.0000  grad_norm:  1.7487  memory: 54.93GiB(39.29%)  tps: 8,563  tflops: 399.38  mfu: 40.38%
[rank3]:2025-10-31 02:57:35,865 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0789e+00
[rank3]:2025-10-31 02:57:35,868 - INFO -  step: 2250  loss:  2.0055  grad_norm:  1.7487  memory: 46.16GiB(33.01%)  tps: 8,568  tflops: 399.61  mfu: 40.41%
[rank1]:2025-10-31 02:57:35,859 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8497e+00
[rank1]:2025-10-31 02:57:35,859 - INFO -  step: 2250  loss: -4.0000  grad_norm:  1.7487  memory: 47.26GiB(33.80%)  tps: 8,567  tflops: 399.56  mfu: 40.40%
[rank3]:2025-10-31 02:57:36,290 - INFO - Avg. fwd time: 15.5635 / Avg. bwd time: 31.1485 / Avg. batch time: 390.0474 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-10-31 02:57:36,324 - INFO - Avg. fwd time: 14.3334 / Avg. bwd time: 22.8361 / Avg. batch time: 428.7912 (ms) / GPU bubble ratio: 30.65%
[rank1]:2025-10-31 02:57:36,357 - INFO - Avg. fwd time: 16.3314 / Avg. bwd time: 25.4946 / Avg. batch time: 471.6468 (ms) / GPU bubble ratio: 29.06%
[rank0]:2025-10-31 02:57:36,391 - INFO - Avg. fwd time: 14.6917 / Avg. bwd time: 24.3680 / Avg. batch time: 512.2711 (ms) / GPU bubble ratio: 39.00%
[rank2]:2025-10-31 02:57:54,999 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.6881e-01
[rank3]:2025-10-31 02:57:55,005 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8207e+00
[rank1]:2025-10-31 02:57:54,999 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8317e+00
[rank0]:2025-10-31 02:57:55,006 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9657e+01
[rank1]:2025-10-31 02:58:14,040 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3527e+00
[rank2]:2025-10-31 02:58:14,040 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6364e+00
[rank0]:2025-10-31 02:58:14,048 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.2288e+00
[rank3]:2025-10-31 02:58:14,047 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7905e+00
[rank2]:2025-10-31 02:58:33,118 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6685e+00
[rank0]:2025-10-31 02:58:33,125 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1375e+02
[rank3]:2025-10-31 02:58:33,125 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6927e+00
[rank1]:2025-10-31 02:58:33,118 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0212e+01
[rank3]:2025-10-31 02:58:52,265 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1690e+00
[rank1]:2025-10-31 02:58:52,258 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9694e+00
[rank2]:2025-10-31 02:58:52,258 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.4685e-01
[rank0]:2025-10-31 02:58:52,265 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3869e+01
[rank0]:2025-10-31 02:59:09,417 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 02:59:11,327 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3956e+00
[rank2]:2025-10-31 02:59:11,327 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.6562  memory: 38.72GiB(27.69%)  tps: 8,581  tflops: 400.21  mfu: 40.47%
[rank0]:2025-10-31 02:59:11,334 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.9295e+00
[rank0]:2025-10-31 02:59:11,334 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.6562  memory: 54.93GiB(39.29%)  tps: 8,581  tflops: 400.21  mfu: 40.47%
[rank3]:2025-10-31 02:59:11,334 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9733e+00
[rank3]:2025-10-31 02:59:11,336 - INFO -  step: 2300  loss:  2.1818  grad_norm:  0.6562  memory: 46.16GiB(33.01%)  tps: 8,581  tflops: 400.22  mfu: 40.47%
[rank1]:2025-10-31 02:59:11,327 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0766e+00
[rank1]:2025-10-31 02:59:11,328 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.6562  memory: 47.26GiB(33.80%)  tps: 8,581  tflops: 400.21  mfu: 40.47%
[rank2]:2025-10-31 02:59:11,417 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0259_stage2_step2300.svg
[rank0]:2025-10-31 02:59:11,411 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0259_stage0_step2300.svg
[rank1]:2025-10-31 02:59:11,417 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0259_stage1_step2300.svg
[rank3]:2025-10-31 02:59:11,523 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0259_real_step2300_rank3.svg
[rank3]:> Batch Time: 467.88 ms, GPU Bubble Ratio: 39.00%, 36.13%, 43.05%, 22.96%
[rank3]:2025-10-31 02:59:11,585 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0259_stage3_step2300.svg
[rank3]:2025-10-31 02:59:11,878 - INFO - Avg. fwd time: 15.5725 / Avg. bwd time: 31.0593 / Avg. batch time: 389.3877 (ms) / GPU bubble ratio: 4.19%
[rank1]:2025-10-31 02:59:11,897 - INFO - Avg. fwd time: 16.3413 / Avg. bwd time: 25.3977 / Avg. batch time: 470.7962 (ms) / GPU bubble ratio: 29.08%
[rank2]:2025-10-31 02:59:11,886 - INFO - Avg. fwd time: 14.3426 / Avg. bwd time: 22.7496 / Avg. batch time: 428.0378 (ms) / GPU bubble ratio: 30.67%
[rank0]:2025-10-31 02:59:11,911 - INFO - Avg. fwd time: 14.7001 / Avg. bwd time: 24.2938 / Avg. batch time: 511.3436 (ms) / GPU bubble ratio: 38.99%
[rank2]:2025-10-31 02:59:30,630 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.3340e+00
[rank0]:2025-10-31 02:59:30,638 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.8639e+01
[rank3]:2025-10-31 02:59:30,637 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.9390e+00
[rank1]:2025-10-31 02:59:30,630 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5765e+01
[rank2]:2025-10-31 02:59:49,755 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3769e+00
[rank0]:2025-10-31 02:59:49,762 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5245e+00
[rank3]:2025-10-31 02:59:49,762 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 4.2085e+00
[rank1]:2025-10-31 02:59:49,755 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1600e+00
[rank3]:2025-10-31 03:00:08,838 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7266e+00
[rank1]:2025-10-31 03:00:08,832 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6812e+00
[rank2]:2025-10-31 03:00:08,832 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1815e+00
[rank0]:2025-10-31 03:00:08,839 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.9672e+00
[rank3]:2025-10-31 03:00:27,958 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 5.9160e+00
[rank1]:2025-10-31 03:00:27,951 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4802e+00
[rank2]:2025-10-31 03:00:27,951 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8145e+00
[rank0]:2025-10-31 03:00:27,958 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.7962e+00
[rank0]:2025-10-31 03:00:45,117 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:00:47,037 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4964e+01
[rank2]:2025-10-31 03:00:47,038 - INFO -  step: 2350  loss: -4.0000  grad_norm:  3.1175  memory: 38.72GiB(27.69%)  tps: 8,559  tflops: 399.20  mfu: 40.36%
[rank0]:2025-10-31 03:00:47,045 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8476e+00
[rank0]:2025-10-31 03:00:47,045 - INFO -  step: 2350  loss: -4.0000  grad_norm:  3.1175  memory: 54.93GiB(39.29%)  tps: 8,559  tflops: 399.20  mfu: 40.36%
[rank3]:2025-10-31 03:00:47,044 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6754e+01
[rank3]:2025-10-31 03:00:47,047 - INFO -  step: 2350  loss:  1.7638  grad_norm:  3.1175  memory: 46.16GiB(33.01%)  tps: 8,559  tflops: 399.20  mfu: 40.36%
[rank1]:2025-10-31 03:00:47,038 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9019e+01
[rank1]:2025-10-31 03:00:47,038 - INFO -  step: 2350  loss: -4.0000  grad_norm:  3.1175  memory: 47.26GiB(33.80%)  tps: 8,559  tflops: 399.20  mfu: 40.36%
[rank2]:2025-10-31 03:00:47,392 - INFO - Avg. fwd time: 14.3529 / Avg. bwd time: 22.6527 / Avg. batch time: 427.2132 (ms) / GPU bubble ratio: 30.70%
[rank0]:2025-10-31 03:00:47,418 - INFO - Avg. fwd time: 14.7096 / Avg. bwd time: 24.2106 / Avg. batch time: 510.3258 (ms) / GPU bubble ratio: 38.99%
[rank3]:2025-10-31 03:00:47,384 - INFO - Avg. fwd time: 15.5829 / Avg. bwd time: 30.9598 / Avg. batch time: 388.6539 (ms) / GPU bubble ratio: 4.20%
[rank1]:2025-10-31 03:00:47,405 - INFO - Avg. fwd time: 16.3521 / Avg. bwd time: 25.2891 / Avg. batch time: 469.8633 (ms) / GPU bubble ratio: 29.10%
[rank2]:2025-10-31 03:01:06,131 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1321e+00
[rank0]:2025-10-31 03:01:06,138 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5579e+01
[rank3]:2025-10-31 03:01:06,137 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1493e+00
[rank1]:2025-10-31 03:01:06,131 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0077e+00
[rank0]:2025-10-31 03:01:25,283 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3053e+01
[rank3]:2025-10-31 03:01:25,282 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1248e+00
[rank1]:2025-10-31 03:01:25,275 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2120e+00
[rank2]:2025-10-31 03:01:25,275 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6273e+00
[rank3]:2025-10-31 03:01:44,323 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3132e+00
[rank1]:2025-10-31 03:01:44,316 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1847e+00
[rank2]:2025-10-31 03:01:44,316 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5478e+00
[rank0]:2025-10-31 03:01:44,323 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.6241e+00
[rank3]:2025-10-31 03:02:03,435 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0882e+00
[rank1]:2025-10-31 03:02:03,428 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4238e+00
[rank2]:2025-10-31 03:02:03,428 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8670e+00
[rank0]:2025-10-31 03:02:03,435 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8302e+00
[rank2]:2025-10-31 03:02:05,288 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 03:02:16,653 - WARNING - Dataset alpaca is being re-looped
[rank1]:2025-10-31 03:02:20,092 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 03:02:20,594 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:02:22,509 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.8031e+00
[rank2]:2025-10-31 03:02:22,509 - INFO -  step: 2400  loss: -4.0000  grad_norm:  1.2468  memory: 38.72GiB(27.69%)  tps: 8,581  tflops: 400.20  mfu: 40.47%
[rank2]:2025-10-31 03:02:22,509 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  1.2468  tps: 7,930  tflops: 369.83  mfu: 36.49%
[rank2]:2025-10-31 03:02:22,510 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 03:02:22,516 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.7051e+00
[rank0]:2025-10-31 03:02:22,517 - INFO -  step: 2400  loss: -4.0000  grad_norm:  1.2468  memory: 54.93GiB(39.29%)  tps: 8,581  tflops: 400.20  mfu: 40.47%
[rank0]:2025-10-31 03:02:22,517 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  1.2468  tps: 7,929  tflops: 369.79  mfu: 36.49%
[rank0]:2025-10-31 03:02:22,517 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-31 03:02:22,516 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1410e+01
[rank3]:2025-10-31 03:02:22,518 - INFO -  step: 2400  loss:  2.1518  grad_norm:  1.2468  memory: 46.16GiB(33.01%)  tps: 8,581  tflops: 400.21  mfu: 40.47%
[rank3]:2025-10-31 03:02:22,518 - INFO -  final step: 2400  loss:  2.1518  grad_norm:  1.2468  tps: 7,933  tflops: 369.98  mfu: 36.50%
[rank3]:2025-10-31 03:02:22,519 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-31 03:02:22,509 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0508e+00
[rank1]:2025-10-31 03:02:22,509 - INFO -  step: 2400  loss: -4.0000  grad_norm:  1.2468  memory: 47.26GiB(33.80%)  tps: 8,581  tflops: 400.20  mfu: 40.47%
[rank1]:2025-10-31 03:02:22,510 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  1.2468  tps: 7,930  tflops: 369.85  mfu: 36.49%
[rank1]:2025-10-31 03:02:22,510 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 03:02:38,804 - INFO - validate step: 2400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,149
[rank0]:2025-10-31 03:02:38,804 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:02:38,809 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-31 03:02:38,859 - INFO - validate step: 2400  loss:  0.8602  memory: 46.16GiB(33.01%)  tps: 25,067
[rank3]:2025-10-31 03:02:38,860 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 03:02:38,867 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-31 03:02:38,840 - INFO - validate step: 2400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,083
[rank1]:2025-10-31 03:02:38,841 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 03:02:38,846 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-31 03:02:38,855 - INFO - validate step: 2400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,060
[rank2]:2025-10-31 03:02:38,855 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:02:38,860 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-31 03:02:50,035 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-10-31 03:02:50,141 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank0/251031_0302_stage0_final2400.svg
[rank1]:2025-10-31 03:02:50,180 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank1/251031_0302_stage1_final2400.svg
[rank2]:2025-10-31 03:02:50,172 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank2/251031_0302_stage2_final2400.svg
[rank3]:2025-10-31 03:02:50,276 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0302_real_final2400_rank3.svg
[rank3]:> Batch Time: 467.30 ms, GPU Bubble Ratio: 38.92%, 36.06%, 43.05%, 22.98%
[rank0]:2025-10-31 03:02:50,432 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/frozen_params_histogram/251031_0302_rank0_stage0.svg
[rank0]:	> Counts Sum: 12132, Total Sum: 15695 (77.30%), Ratio(%) per element: [0.0, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 94.88, 93.02, 93.02, 93.02, 93.02, 93.02, 93.02, 93.02, 93.02, 93.02, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 88.83, 84.65, 84.65, 84.65, 84.65, 84.65, 84.65, 84.65, 84.65, 84.65, 81.86, 81.86, 81.86, 81.86, 81.86, 81.86, 81.86, 81.86, 81.86, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2025-10-31 03:02:50,432 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-31 03:02:50,471 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/frozen_params_histogram/251031_0302_rank2_stage2.svg
[rank2]:	> Counts Sum: 11610, Total Sum: 15480 (75.00%), Ratio(%) per element: [99.06, 99.06, 99.06, 99.06, 99.06, 99.06, 99.06, 99.06, 99.06, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 93.95, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 78.6, 78.6, 78.6, 78.6, 78.6, 78.6, 78.6, 78.6, 78.6, 60.46, 60.46, 60.46, 60.46, 60.46, 60.46, 60.46, 60.46, 60.46, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2025-10-31 03:02:50,471 - INFO - Destroying the purge thread.
[rank3]:2025-10-31 03:02:50,528 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/pipeline_schedule/251031_0302_thry_final2400_rank3.svg
[rank3]:> Batch Time: 511.52 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-10-31 03:02:50,530 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/frozen_params_histogram/251031_0302_rank1_stage1.svg
[rank1]:	> Counts Sum: 13419, Total Sum: 17415 (77.05%), Ratio(%) per element: [95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 95.34, 91.62, 91.62, 91.62, 91.62, 91.62, 91.62, 91.62, 91.62, 91.62, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 86.97, 80.93, 80.93, 80.93, 80.93, 80.93, 80.93, 80.93, 80.93, 80.93, 69.3, 69.3, 69.3, 69.3, 69.3, 69.3, 69.3, 69.3, 69.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2025-10-31 03:02:50,530 - INFO - Destroying the purge thread.
[rank3]:2025-10-31 03:02:50,622 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/freeze_ratio_history/rank3/251031_0302_stage3_final2400.svg
[rank3]:2025-10-31 03:02:50,958 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1/frozen_params_histogram/251031_0302_rank3_stage3.svg
[rank3]:	> Counts Sum: 9405, Total Sum: 13975 (67.30%), Ratio(%) per element: [98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 98.6, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 91.16, 65.11, 65.11, 65.11, 65.11, 65.11, 65.11, 65.11, 65.11, 65.11, 41.39, 41.39, 41.39, 41.39, 41.39, 41.39, 41.39, 41.39, 41.39, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2025-10-31 03:02:50,959 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–‚â–â–â–â–â–‚â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–â–‚â–‚â–â–â–â–â–‚â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.06538
[rank3]:wandb:               final/avg_loss 2.15179
[rank3]:wandb:             final/avg_mfu(%) 36.50111
[rank3]:wandb:             final/avg_tflops 369.98217
[rank3]:wandb:    final/avg_throughput(tps) 7932.69492
[rank3]:wandb:              final/grad_norm 1.24685
[rank3]:wandb:               final/max_loss 2.15179
[rank3]:wandb:                    grad_norm 1.24685
[rank3]:wandb: loss_metrics/global_avg_loss 2.15179
[rank3]:wandb: loss_metrics/global_max_loss 2.15179
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1030_1F1B_auto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/8uhbyf4w
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1030_1F1B_auto_dm1/20251031-0134/wandb/run-20251031_013500-8uhbyf4w/logs
[rank0]:2025-10-31 03:02:52,432 - INFO - Training completed
[rank0]:2025-10-31 03:02:52,433 - INFO - Destroying the purge thread.
[rank1]:2025-10-31 03:02:52,655 - INFO - Process group destroyed
[rank3]:2025-10-31 03:02:52,764 - INFO - Process group destroyed
[rank2]:2025-10-31 03:02:52,747 - INFO - Process group destroyed
[rank0]:2025-10-31 03:02:52,828 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.24', 'layers.17', 'layers.19', 'layers.21', 'layers.20', 'layers.18', 'layers.23'}
[rank0]:Stage 0: Modules to keep: {'layers.6', 'layers.3', 'layers.0', 'layers.2', 'layers.7', 'layers.1', 'layers.4', 'layers.5', 'tok_embeddings'}
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.15', 'layers.11', 'layers.12', 'layers.14', 'layers.10', 'layers.16', 'layers.13', 'layers.8'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'layers.30', 'layers.28', 'layers.29', 'layers.25', 'layers.26', 'output', 'layers.31', 'norm'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_1F1B_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1030_1F1B_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1030_1F1B_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_1F1B_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1030_1F1B_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
