
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Oct 31 06:07:53 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1030_1F1B_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1031 06:07:54.482000 3834461 site-packages/torch/distributed/run.py:811] 
W1031 06:07:54.482000 3834461 site-packages/torch/distributed/run.py:811] *****************************************
W1031 06:07:54.482000 3834461 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1031 06:07:54.482000 3834461 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-31 06:08:01,498 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-31 06:08:01,519 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-31 06:08:01,523 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-31 06:08:01,617 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-31 06:08:02,624 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 06:08:02,627 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-31 06:08:02,627 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-31 06:08:02,629 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 06:08:02,650 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-31 06:08:02,652 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 06:08:02,658 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-10-31 06:08:02,635 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-31 06:08:02,637 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 06:08:04,355 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-31 06:08:04,628 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-31 06:08:06,165 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-31 06:08:07,618 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-10-31 06:08:07,872 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-31 06:08:07,921 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-10-31 06:08:08,005 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-31 06:08:07,944 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-31 06:08:07,944 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-10-31 06:08:08,078 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-31 06:08:08,078 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-10-31 06:08:08,153 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-31 06:08:08,153 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-31 06:08:08,215 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-31 06:08:08,291 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-31 06:08:08,291 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-31 06:08:08,309 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-31 06:08:08,309 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-31 06:08:08,508 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-31 06:08:08,508 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 034sqyy6
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_timelyauto_dm1/20251031-0608/wandb/run-20251031_060808-034sqyy6
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_1F1B_timelyauto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/034sqyy6
[rank3]:2025-10-31 06:08:09,825 - INFO - WandB logging enabled
[rank3]:2025-10-31 06:08:09,828 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-31 06:08:09,902 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-31 06:08:09,903 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-10-31 06:08:10,122 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-31 06:08:10,122 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-31 06:08:10,136 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 06:08:10,136 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_timelyauto_dm1
[rank0]:2025-10-31 06:08:10,136 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 06:08:10,136 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-31 06:08:10,138 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-31 06:08:10,249 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 06:08:13,626 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 300)
[rank0]:2025-10-31 06:08:13,627 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-31 06:08:22,225 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-31 06:08:22,226 - INFO - Finished loading the checkpoint in 8.60 seconds.
[rank0]:2025-10-31 06:08:22,226 - INFO - Training starts at step 1
[rank1]:2025-10-31 06:08:26,044 - INFO -  step:  1  loss: -4.0000  grad_norm: 223.7492  memory: 32.41GiB(23.18%)  tps: 922  tflops: 43.02  mfu: 4.35%
[rank1]:2025-10-31 06:08:26,044 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-31 06:08:26,063 - INFO -  step:  1  loss: -4.0000  grad_norm: 223.7492  memory: 37.59GiB(26.89%)  tps: 903  tflops: 42.12  mfu: 4.26%
[rank0]:2025-10-31 06:08:26,064 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-31 06:08:26,157 - INFO -  step:  1  loss: -4.0000  grad_norm: 223.7492  memory: 27.12GiB(19.40%)  tps: 905  tflops: 42.21  mfu: 4.27%
[rank2]:2025-10-31 06:08:26,157 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 06:08:26,189 - INFO -  step:  1  loss: 18.4423  grad_norm: 223.7492  memory: 35.49GiB(25.39%)  tps: 1,005  tflops: 46.85  mfu: 4.74%
[rank3]:2025-10-31 06:08:26,189 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 06:08:43,729 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,730 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,731 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,732 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,733 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,733 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,733 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,733 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,734 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 06:08:43,734 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,771 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,772 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,773 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 06:08:43,774 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,816 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,816 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,816 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,817 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,858 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,818 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 06:08:43,819 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,859 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,860 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:08:43,861 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 06:10:31,756 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:10:34,403 - INFO -  step: 50  loss: -4.0000  grad_norm: 492.3080  memory: 47.26GiB(33.80%)  tps: 6,254  tflops: 291.71  mfu: 29.50%
[rank2]:2025-10-31 06:10:34,401 - INFO -  step: 50  loss: -4.0000  grad_norm: 492.3080  memory: 38.72GiB(27.69%)  tps: 6,260  tflops: 291.97  mfu: 29.52%
[rank0]:2025-10-31 06:10:34,408 - INFO -  step: 50  loss: -4.0000  grad_norm: 492.3080  memory: 54.93GiB(39.29%)  tps: 6,255  tflops: 291.74  mfu: 29.50%
[rank3]:2025-10-31 06:10:34,405 - INFO -  step: 50  loss:  9.7952  grad_norm: 492.3080  memory: 46.16GiB(33.01%)  tps: 6,261  tflops: 292.04  mfu: 29.53%
[rank1]:2025-10-31 06:10:34,924 - INFO - Avg. fwd time: 14.9554 / Avg. bwd time: 40.7445 / Avg. batch time: 580.8238 (ms) / GPU bubble ratio: 23.28%
[rank2]:2025-10-31 06:10:34,879 - INFO - Avg. fwd time: 13.0193 / Avg. bwd time: 35.8642 / Avg. batch time: 522.5641 (ms) / GPU bubble ratio: 25.16%
[rank3]:2025-10-31 06:10:34,850 - INFO - Avg. fwd time: 14.5025 / Avg. bwd time: 41.9488 / Avg. batch time: 470.8589 (ms) / GPU bubble ratio: 4.09%
[rank0]:2025-10-31 06:10:34,957 - INFO - Avg. fwd time: 13.3000 / Avg. bwd time: 38.0887 / Avg. batch time: 635.5555 (ms) / GPU bubble ratio: 35.31%
[rank0]:2025-10-31 06:12:42,565 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:12:45,182 - INFO -  step: 100  loss: -4.0000  grad_norm: 23.4325  memory: 38.72GiB(27.69%)  tps: 6,264  tflops: 292.15  mfu: 29.54%
[rank2]:2025-10-31 06:12:45,182 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 06:12:45,187 - INFO -  step: 100  loss:  3.6856  grad_norm: 23.4325  memory: 46.16GiB(33.01%)  tps: 6,264  tflops: 292.15  mfu: 29.54%
[rank3]:2025-10-31 06:12:45,187 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-31 06:12:45,185 - INFO -  step: 100  loss: -4.0000  grad_norm: 23.4325  memory: 47.26GiB(33.80%)  tps: 6,264  tflops: 292.15  mfu: 29.54%
[rank1]:2025-10-31 06:12:45,185 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-31 06:12:45,189 - INFO -  step: 100  loss: -4.0000  grad_norm: 23.4325  memory: 54.93GiB(39.29%)  tps: 6,264  tflops: 292.15  mfu: 29.54%
[rank0]:2025-10-31 06:12:45,189 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 06:12:45,628 - INFO - Avg. fwd time: 14.5416 / Avg. bwd time: 42.0605 / Avg. batch time: 470.0491 (ms) / GPU bubble ratio: 3.67%
[rank2]:2025-10-31 06:12:45,657 - INFO - Avg. fwd time: 13.0490 / Avg. bwd time: 36.0154 / Avg. batch time: 521.8762 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-10-31 06:12:45,703 - INFO - Avg. fwd time: 14.9407 / Avg. bwd time: 40.9440 / Avg. batch time: 580.2302 (ms) / GPU bubble ratio: 22.95%
[rank0]:2025-10-31 06:12:45,735 - INFO - Avg. fwd time: 13.3177 / Avg. bwd time: 38.3378 / Avg. batch time: 635.1532 (ms) / GPU bubble ratio: 34.94%
[rank0]:2025-10-31 06:14:53,044 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:14:55,661 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.5392  memory: 38.72GiB(27.69%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank3]:2025-10-31 06:14:55,666 - INFO -  step: 150  loss:  2.4938  grad_norm: 13.5392  memory: 46.16GiB(33.01%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank1]:2025-10-31 06:14:55,664 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.5392  memory: 47.26GiB(33.80%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank0]:2025-10-31 06:14:55,668 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.5392  memory: 54.93GiB(39.29%)  tps: 6,278  tflops: 292.83  mfu: 29.61%
[rank2]:2025-10-31 06:14:56,236 - INFO - Avg. fwd time: 13.0480 / Avg. bwd time: 36.0547 / Avg. batch time: 520.9083 (ms) / GPU bubble ratio: 24.59%
[rank3]:2025-10-31 06:14:56,195 - INFO - Avg. fwd time: 14.5202 / Avg. bwd time: 42.0354 / Avg. batch time: 469.0635 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-31 06:14:56,281 - INFO - Avg. fwd time: 14.9235 / Avg. bwd time: 40.9980 / Avg. batch time: 579.2814 (ms) / GPU bubble ratio: 22.77%
[rank0]:2025-10-31 06:14:56,324 - INFO - Avg. fwd time: 13.3314 / Avg. bwd time: 38.4230 / Avg. batch time: 634.2737 (ms) / GPU bubble ratio: 34.72%
[rank0]:2025-10-31 06:17:03,582 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:17:06,207 - INFO -  step: 200  loss: -4.0000  grad_norm:  7.8958  memory: 38.72GiB(27.69%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank3]:2025-10-31 06:17:06,211 - INFO -  step: 200  loss:  2.8128  grad_norm:  7.8958  memory: 46.16GiB(33.01%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank2]:2025-10-31 06:17:06,207 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 06:17:06,211 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-31 06:17:06,209 - INFO -  step: 200  loss: -4.0000  grad_norm:  7.8958  memory: 47.26GiB(33.80%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank1]:2025-10-31 06:17:06,209 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 06:17:06,214 - INFO -  step: 200  loss: -4.0000  grad_norm:  7.8958  memory: 54.93GiB(39.29%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank0]:2025-10-31 06:17:06,214 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 06:17:22,337 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,405
[rank0]:2025-10-31 06:17:22,337 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 06:17:22,395 - INFO - validate step: 200  loss:  0.8859  memory: 46.16GiB(33.01%)  tps: 25,311
[rank3]:2025-10-31 06:17:22,396 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-31 06:17:22,367 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,351
[rank1]:2025-10-31 06:17:22,368 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-31 06:17:22,379 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,328
[rank2]:2025-10-31 06:17:22,380 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 06:17:22,800 - INFO - Avg. fwd time: 14.5167 / Avg. bwd time: 42.0376 / Avg. batch time: 468.7921 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-31 06:17:22,830 - INFO - Avg. fwd time: 13.0525 / Avg. bwd time: 36.0799 / Avg. batch time: 520.6579 (ms) / GPU bubble ratio: 24.51%
[rank1]:2025-10-31 06:17:22,875 - INFO - Avg. fwd time: 14.9183 / Avg. bwd time: 41.0230 / Avg. batch time: 579.0457 (ms) / GPU bubble ratio: 22.71%
[rank0]:2025-10-31 06:17:22,908 - INFO - Avg. fwd time: 13.3374 / Avg. bwd time: 38.4629 / Avg. batch time: 634.0645 (ms) / GPU bubble ratio: 34.64%
[rank0]:2025-10-31 06:19:30,048 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:19:32,664 - INFO -  step: 250  loss: -4.0000  grad_norm:  2.8808  memory: 38.72GiB(27.69%)  tps: 6,288  tflops: 293.26  mfu: 29.65%
[rank1]:2025-10-31 06:19:32,667 - INFO -  step: 250  loss: -4.0000  grad_norm:  2.8808  memory: 47.26GiB(33.80%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank0]:2025-10-31 06:19:32,671 - INFO -  step: 250  loss: -4.0000  grad_norm:  2.8808  memory: 54.93GiB(39.29%)  tps: 6,285  tflops: 293.15  mfu: 29.64%
[rank3]:2025-10-31 06:19:32,669 - INFO -  step: 250  loss:  2.3890  grad_norm:  2.8808  memory: 46.16GiB(33.01%)  tps: 6,288  tflops: 293.29  mfu: 29.66%
[rank2]:2025-10-31 06:19:33,139 - INFO - Avg. fwd time: 13.0486 / Avg. bwd time: 36.0908 / Avg. batch time: 520.2123 (ms) / GPU bubble ratio: 24.43%
[rank3]:2025-10-31 06:19:33,109 - INFO - Avg. fwd time: 14.5019 / Avg. bwd time: 42.0197 / Avg. batch time: 468.3423 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-31 06:19:33,185 - INFO - Avg. fwd time: 14.9057 / Avg. bwd time: 41.0310 / Avg. batch time: 578.5926 (ms) / GPU bubble ratio: 22.66%
[rank0]:2025-10-31 06:19:33,217 - INFO - Avg. fwd time: 13.3332 / Avg. bwd time: 38.4819 / Avg. batch time: 633.6391 (ms) / GPU bubble ratio: 34.58%
[rank3]:2025-10-31 06:19:58,549 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-31 06:20:24,592 - INFO - [Step 270] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-31 06:20:24,803 - INFO - [Step 270] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-10-31 06:20:24,861 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:24,886 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:24,858 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:24,887 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:24,841 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:24,871 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:24,833 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:24,856 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,002 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:24,959 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:24,996 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:24,913 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:24,953 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:25,000 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,027 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,082 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:25,036 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:25,091 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,057 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,101 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:25,052 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:25,107 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,137 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,137 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,138 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 06:20:25,138 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:25,146 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 06:20:25,179 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,139 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,171 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 06:20:25,201 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:25,162 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 06:20:40,552 - INFO - [Step 280] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-31 06:20:40,791 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0620_max_batch_time.svg
[rank3]:> Batch Time: 613.76 ms, GPU Bubble Ratio: 32.35%, 27.21%, 36.03%, 26.55%
[rank3]:2025-10-31 06:20:40,971 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0620_min_batch_time.svg
[rank3]:> Batch Time: 346.23 ms, GPU Bubble Ratio: 69.39%, 23.80%, 32.95%, 23.52%
[rank3]:2025-10-31 06:20:41,188 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0620_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.52 ms, GPU Bubble Ratio: 27.89%, 21.31%, 26.17%, 22.34%
[rank3]:2025-10-31 06:20:41,188 - INFO - 	> Batch Time: 364.52 ms (Average Freeze Ratio: 0.76, Time Reduction Rate: 0.41)
[rank0]:2025-10-31 06:21:19,683 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:21:22,040 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.81, [MB1] 0.28/0.83, [MB2] 0.28/0.84, [MB3] 0.27/0.82, [MB4] 0.26/0.79, [MB5] 0.26/0.79, [MB6] 0.09/0.28, [MB7] 0.33/1.00
[rank2]:2025-10-31 06:21:22,041 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.5741  memory: 38.72GiB(27.69%)  tps: 7,490  tflops: 349.32  mfu: 35.32%
[rank0]:2025-10-31 06:21:22,047 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.49, [MB1] 0.16/0.48, [MB2] 0.16/0.48, [MB3] 0.16/0.48, [MB4] 0.00/0.00, [MB5] 0.16/0.48, [MB6] 0.18/0.53, [MB7] 0.33/1.00
[rank0]:2025-10-31 06:21:22,048 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.5741  memory: 55.17GiB(39.46%)  tps: 7,490  tflops: 349.32  mfu: 35.32%
[rank1]:2025-10-31 06:21:22,043 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-10-31 06:21:22,043 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.5741  memory: 47.51GiB(33.98%)  tps: 7,490  tflops: 349.32  mfu: 35.32%
[rank3]:2025-10-31 06:21:22,044 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-10-31 06:21:22,046 - INFO -  step: 300  loss:  2.7375  grad_norm:  3.5741  memory: 47.02GiB(33.63%)  tps: 7,490  tflops: 349.32  mfu: 35.32%
[rank2]:2025-10-31 06:21:22,130 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0621_stage2_step300.svg
[rank0]:2025-10-31 06:21:22,129 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0621_stage0_step300.svg
[rank1]:2025-10-31 06:21:22,131 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0621_stage1_step300.svg
[rank3]:2025-10-31 06:21:22,234 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0621_real_step300_rank3.svg
[rank3]:> Batch Time: 616.74 ms, GPU Bubble Ratio: 32.52%, 27.24%, 36.08%, 26.48%
[rank3]:2025-10-31 06:21:22,301 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0621_stage3_step300.svg
[rank3]:2025-10-31 06:21:22,732 - INFO - Avg. fwd time: 14.6726 / Avg. bwd time: 40.2592 / Avg. batch time: 455.5557 (ms) / GPU bubble ratio: 3.53%
[rank2]:2025-10-31 06:21:22,766 - INFO - Avg. fwd time: 13.1905 / Avg. bwd time: 34.6493 / Avg. batch time: 506.5632 (ms) / GPU bubble ratio: 24.45%
[rank0]:2025-10-31 06:21:22,843 - INFO - Avg. fwd time: 13.4494 / Avg. bwd time: 36.1935 / Avg. batch time: 616.2224 (ms) / GPU bubble ratio: 35.55%
[rank1]:2025-10-31 06:21:22,803 - INFO - Avg. fwd time: 15.0648 / Avg. bwd time: 39.2699 / Avg. batch time: 563.1758 (ms) / GPU bubble ratio: 22.82%
[rank0]:2025-10-31 06:23:10,145 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:23:12,226 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.54/0.81, [MB1] 0.55/0.83, [MB2] 0.56/0.84, [MB3] 0.55/0.82, [MB4] 0.53/0.79, [MB5] 0.53/0.79, [MB6] 0.19/0.28, [MB7] 0.67/1.00
[rank2]:2025-10-31 06:23:12,226 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0037  memory: 39.13GiB(27.99%)  tps: 7,435  tflops: 346.76  mfu: 35.06%
[rank1]:2025-10-31 06:23:12,233 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-10-31 06:23:12,233 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0037  memory: 48.62GiB(34.78%)  tps: 7,434  tflops: 346.74  mfu: 35.06%
[rank0]:2025-10-31 06:23:12,241 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.49, [MB1] 0.32/0.48, [MB2] 0.32/0.48, [MB3] 0.32/0.48, [MB4] 0.00/0.00, [MB5] 0.32/0.48, [MB6] 0.36/0.53, [MB7] 0.67/1.00
[rank0]:2025-10-31 06:23:12,241 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0037  memory: 56.77GiB(40.60%)  tps: 7,434  tflops: 346.73  mfu: 35.06%
[rank3]:2025-10-31 06:23:12,232 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-10-31 06:23:12,236 - INFO -  step: 350  loss:  2.2606  grad_norm:  1.0037  memory: 47.33GiB(33.85%)  tps: 7,435  tflops: 346.75  mfu: 35.06%
[rank1]:2025-10-31 06:23:12,617 - INFO - Avg. fwd time: 15.1829 / Avg. bwd time: 37.9942 / Avg. batch time: 553.1499 (ms) / GPU bubble ratio: 23.09%
[rank2]:2025-10-31 06:23:12,607 - INFO - Avg. fwd time: 13.2795 / Avg. bwd time: 33.6892 / Avg. batch time: 497.8104 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-31 06:23:12,584 - INFO - Avg. fwd time: 14.7764 / Avg. bwd time: 39.1992 / Avg. batch time: 447.8176 (ms) / GPU bubble ratio: 3.58%
[rank0]:2025-10-31 06:23:12,647 - INFO - Avg. fwd time: 13.5263 / Avg. bwd time: 35.3952 / Avg. batch time: 605.5015 (ms) / GPU bubble ratio: 35.36%
[rank0]:2025-10-31 06:24:46,238 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:24:48,041 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:24:48,042 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0721  memory: 48.62GiB(34.78%)  tps: 8,550  tflops: 398.79  mfu: 40.32%
[rank1]:2025-10-31 06:24:48,042 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-31 06:24:48,047 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.83/0.83, [MB2] 0.84/0.84, [MB3] 0.82/0.82, [MB4] 0.79/0.79, [MB5] 0.79/0.79, [MB6] 0.28/0.28, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:24:48,047 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0721  memory: 39.13GiB(27.99%)  tps: 8,549  tflops: 398.74  mfu: 40.32%
[rank2]:2025-10-31 06:24:48,047 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 06:24:48,065 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.49/0.49, [MB1] 0.48/0.48, [MB2] 0.48/0.48, [MB3] 0.48/0.48, [MB4] 0.00/0.00, [MB5] 0.48/0.48, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:24:48,065 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.0721  memory: 56.77GiB(40.60%)  tps: 8,549  tflops: 398.73  mfu: 40.32%
[rank0]:2025-10-31 06:24:48,065 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-31 06:24:48,042 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:24:48,045 - INFO -  step: 400  loss:  2.4147  grad_norm:  0.0721  memory: 47.33GiB(33.85%)  tps: 8,550  tflops: 398.80  mfu: 40.32%
[rank3]:2025-10-31 06:24:48,045 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 06:25:04,236 - INFO - validate step: 400  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,330
[rank1]:2025-10-31 06:25:04,270 - INFO - validate step: 400  loss: -1.0000  memory: 48.62GiB(34.78%)  tps: 25,240
[rank2]:2025-10-31 06:25:04,287 - INFO - validate step: 400  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,223
[rank3]:2025-10-31 06:25:04,300 - INFO - validate step: 400  loss:  0.9092  memory: 47.33GiB(33.85%)  tps: 25,206
[rank1]:2025-10-31 06:25:04,382 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0625_stage1_step400.svg
[rank2]:2025-10-31 06:25:04,383 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0625_stage2_step400.svg
[rank0]:2025-10-31 06:25:04,381 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0625_stage0_step400.svg
[rank3]:2025-10-31 06:25:04,501 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0625_real_step400_rank3.svg
[rank3]:> Batch Time: 615.83 ms, GPU Bubble Ratio: 32.46%, 27.21%, 35.98%, 26.46%
[rank3]:2025-10-31 06:25:04,574 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0625_stage3_step400.svg
[rank3]:2025-10-31 06:25:04,831 - INFO - Avg. fwd time: 14.9751 / Avg. bwd time: 37.2926 / Avg. batch time: 434.0725 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-10-31 06:25:04,850 - INFO - Avg. fwd time: 15.3854 / Avg. bwd time: 35.9326 / Avg. batch time: 535.7603 (ms) / GPU bubble ratio: 23.37%
[rank2]:2025-10-31 06:25:04,845 - INFO - Avg. fwd time: 13.4405 / Avg. bwd time: 32.2032 / Avg. batch time: 482.5536 (ms) / GPU bubble ratio: 24.33%
[rank0]:2025-10-31 06:25:04,879 - INFO - Avg. fwd time: 13.6582 / Avg. bwd time: 33.8492 / Avg. batch time: 586.9541 (ms) / GPU bubble ratio: 35.25%
[rank0]:2025-10-31 06:26:29,913 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 06:26:31,572 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:26:31,608 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:26:31,635 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 9,377  tflops: 437.34  mfu: 44.22%
[rank2]:2025-10-31 06:26:31,642 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.83/0.83, [MB2] 0.84/0.84, [MB3] 0.82/0.82, [MB4] 0.79/0.79, [MB5] 0.79/0.79, [MB6] 0.28/0.28, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:26:31,642 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0505  memory: 39.13GiB(27.99%)  tps: 9,378  tflops: 437.38  mfu: 44.22%
[rank0]:2025-10-31 06:26:31,660 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.49/0.49, [MB1] 0.48/0.48, [MB2] 0.48/0.48, [MB3] 0.48/0.48, [MB4] 0.00/0.00, [MB5] 0.48/0.48, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:26:31,661 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0505  memory: 56.77GiB(40.60%)  tps: 9,370  tflops: 437.04  mfu: 44.19%
[rank3]:2025-10-31 06:26:31,636 - INFO -  step: 450  loss:  2.6546  grad_norm:  0.0000  memory: 47.33GiB(33.85%)  tps: 9,380  tflops: 437.49  mfu: 44.24%
[rank1]:2025-10-31 06:26:32,081 - INFO - Avg. fwd time: 15.5841 / Avg. bwd time: 33.8667 / Avg. batch time: 517.7450 (ms) / GPU bubble ratio: 23.59%
[rank2]:2025-10-31 06:26:32,057 - INFO - Avg. fwd time: 13.6181 / Avg. bwd time: 30.6170 / Avg. batch time: 466.6134 (ms) / GPU bubble ratio: 24.16%
[rank3]:2025-10-31 06:26:32,033 - INFO - Avg. fwd time: 15.1862 / Avg. bwd time: 35.2876 / Avg. batch time: 419.6522 (ms) / GPU bubble ratio: 3.78%
[rank0]:2025-10-31 06:26:32,111 - INFO - Avg. fwd time: 13.8003 / Avg. bwd time: 31.4094 / Avg. batch time: 567.5562 (ms) / GPU bubble ratio: 36.27%
[rank0]:2025-10-31 06:27:57,291 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:27:59,176 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0627_rank3_trend_line.svg
[rank1]:2025-10-31 06:27:59,191 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0627_rank1_trend_line.svg
[rank1]:2025-10-31 06:27:59,215 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.18/0.18, [MB1] 0.85/0.85, [MB2] 0.81/0.81, [MB3] 0.44/0.44, [MB4] 0.45/0.45, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:27:59,217 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.18/0.18, [MB1] 0.85/0.85, [MB2] 0.81/0.81, [MB3] 0.44/0.44, [MB4] 0.45/0.45, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:27:59,217 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 9,354  tflops: 436.25  mfu: 44.11%
[rank2]:2025-10-31 06:27:59,193 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0627_rank2_trend_line.svg
[rank2]:2025-10-31 06:27:59,214 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.51/0.51, [MB4] 0.24/0.24, [MB5] 0.25/0.25, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:27:59,219 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.51/0.51, [MB4] 0.24/0.24, [MB5] 0.25/0.25, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:27:59,219 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0113  memory: 39.13GiB(27.99%)  tps: 9,354  tflops: 436.28  mfu: 44.11%
[rank0]:2025-10-31 06:27:59,208 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0627_rank0_trend_line.svg
[rank0]:2025-10-31 06:27:59,214 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.26/0.26, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.44/0.44, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:27:59,219 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.26/0.26, [MB1] 0.21/0.21, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.44/0.44, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:27:59,220 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0113  memory: 56.77GiB(40.60%)  tps: 9,356  tflops: 436.37  mfu: 44.12%
[rank3]:2025-10-31 06:27:59,410 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0627_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 389.05 ms, GPU Bubble Ratio: 26.29%, 19.17%, 27.33%, 24.09%
[rank3]:2025-10-31 06:27:59,410 - INFO - 	> Batch Time: 389.05 ms (Average Freeze Ratio: 0.54)
[rank3]:2025-10-31 06:27:59,411 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.96/0.96, [MB5] 0.62/0.62, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:27:59,413 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.96/0.96, [MB5] 0.62/0.62, [MB6] 0.62/0.62, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:27:59,417 - INFO -  step: 500  loss:  2.6804  grad_norm:  0.0000  memory: 47.33GiB(33.85%)  tps: 9,333  tflops: 435.27  mfu: 44.01%
[rank1]:2025-10-31 06:27:59,485 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0627_stage1_step500.svg
[rank2]:2025-10-31 06:27:59,485 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0627_stage2_step500.svg
[rank0]:2025-10-31 06:27:59,483 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0627_stage0_step500.svg
[rank3]:2025-10-31 06:27:59,602 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0627_real_step500_rank3.svg
[rank3]:> Batch Time: 609.36 ms, GPU Bubble Ratio: 32.78%, 27.35%, 36.07%, 26.65%
[rank3]:2025-10-31 06:27:59,665 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0627_stage3_step500.svg
[rank1]:2025-10-31 06:27:59,957 - INFO - Avg. fwd time: 15.7214 / Avg. bwd time: 32.4412 / Avg. batch time: 505.3094 (ms) / GPU bubble ratio: 23.75%
[rank2]:2025-10-31 06:27:59,945 - INFO - Avg. fwd time: 13.7422 / Avg. bwd time: 29.5036 / Avg. batch time: 455.6083 (ms) / GPU bubble ratio: 24.06%
[rank3]:2025-10-31 06:27:59,924 - INFO - Avg. fwd time: 15.3323 / Avg. bwd time: 33.9101 / Avg. batch time: 409.7546 (ms) / GPU bubble ratio: 3.86%
[rank0]:2025-10-31 06:28:00,014 - INFO - Avg. fwd time: 13.8952 / Avg. bwd time: 29.7201 / Avg. batch time: 554.2522 (ms) / GPU bubble ratio: 37.05%
[rank0]:2025-10-31 06:29:33,392 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 06:29:35,294 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0744  memory: 39.13GiB(27.99%)  tps: 8,527  tflops: 397.69  mfu: 40.21%
[rank0]:2025-10-31 06:29:35,308 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0744  memory: 56.77GiB(40.60%)  tps: 8,526  tflops: 397.63  mfu: 40.21%
[rank1]:2025-10-31 06:29:35,295 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0744  memory: 48.62GiB(34.78%)  tps: 8,526  tflops: 397.68  mfu: 40.21%
[rank3]:2025-10-31 06:29:35,283 - INFO -  step: 550  loss:  2.0990  grad_norm:  0.0744  memory: 47.33GiB(33.85%)  tps: 8,545  tflops: 398.56  mfu: 40.30%
[rank2]:2025-10-31 06:29:35,640 - INFO - Avg. fwd time: 13.8186 / Avg. bwd time: 28.8173 / Avg. batch time: 446.8622 (ms) / GPU bubble ratio: 23.67%
[rank1]:2025-10-31 06:29:35,651 - INFO - Avg. fwd time: 15.8184 / Avg. bwd time: 31.5751 / Avg. batch time: 496.0102 (ms) / GPU bubble ratio: 23.56%
[rank3]:2025-10-31 06:29:35,615 - INFO - Avg. fwd time: 15.4583 / Avg. bwd time: 32.5937 / Avg. batch time: 401.2639 (ms) / GPU bubble ratio: 4.20%
[rank0]:2025-10-31 06:29:35,712 - INFO - Avg. fwd time: 13.9591 / Avg. bwd time: 28.4353 / Avg. batch time: 544.9201 (ms) / GPU bubble ratio: 37.76%
[rank0]:2025-10-31 06:31:09,840 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:31:11,959 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0631_rank3_trend_line.svg
[rank0]:2025-10-31 06:31:11,988 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0631_rank0_trend_line.svg
[rank0]:2025-10-31 06:31:11,994 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-31 06:31:12,001 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.9809  memory: 56.77GiB(40.60%)  tps: 8,472  tflops: 395.14  mfu: 39.95%
[rank0]:2025-10-31 06:31:12,001 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 06:31:11,962 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0631_rank2_trend_line.svg
[rank2]:2025-10-31 06:31:11,994 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.60/0.60, [MB2] 0.59/0.59, [MB3] 0.61/0.61, [MB4] 0.35/0.35, [MB5] 0.00/0.00, [MB6] 0.30/0.30, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:31:12,001 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.9809  memory: 39.13GiB(27.99%)  tps: 8,471  tflops: 395.09  mfu: 39.95%
[rank2]:2025-10-31 06:31:12,001 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-31 06:31:11,967 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0631_rank1_trend_line.svg
[rank1]:2025-10-31 06:31:11,995 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 0.99/0.99, [MB2] 0.98/0.98, [MB3] 0.64/0.64, [MB4] 0.16/0.16, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:31:12,001 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.9809  memory: 48.62GiB(34.78%)  tps: 8,471  tflops: 395.09  mfu: 39.95%
[rank1]:2025-10-31 06:31:12,002 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-31 06:31:12,191 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0631_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 393.60 ms, GPU Bubble Ratio: 34.81%, 22.12%, 27.94%, 26.44%
[rank3]:2025-10-31 06:31:12,192 - INFO - 	> Batch Time: 393.60 ms (Average Freeze Ratio: 0.49)
[rank3]:2025-10-31 06:31:12,192 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.77/0.77, [MB6] 0.43/0.43, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:31:12,201 - INFO -  step: 600  loss:  2.0759  grad_norm:  0.9809  memory: 47.33GiB(33.85%)  tps: 8,453  tflops: 394.24  mfu: 39.86%
[rank3]:2025-10-31 06:31:12,201 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-10-31 06:31:28,545 - INFO - validate step: 600  loss: -1.0000  memory: 48.62GiB(34.78%)  tps: 24,760
[rank0]:2025-10-31 06:31:28,512 - INFO - validate step: 600  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,807
[rank3]:2025-10-31 06:31:28,570 - INFO - validate step: 600  loss:  0.9141  memory: 47.33GiB(33.85%)  tps: 25,024
[rank2]:2025-10-31 06:31:28,560 - INFO - validate step: 600  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 24,736
[rank2]:2025-10-31 06:31:28,647 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0631_stage2_step600.svg
[rank1]:2025-10-31 06:31:28,644 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0631_stage1_step600.svg
[rank0]:2025-10-31 06:31:28,645 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0631_stage0_step600.svg
[rank3]:2025-10-31 06:31:28,753 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0631_real_step600_rank3.svg
[rank3]:> Batch Time: 532.33 ms, GPU Bubble Ratio: 30.47%, 29.13%, 37.09%, 26.41%
[rank3]:2025-10-31 06:31:28,817 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0631_stage3_step600.svg
[rank3]:2025-10-31 06:31:29,163 - INFO - Avg. fwd time: 15.5467 / Avg. bwd time: 31.5738 / Avg. batch time: 394.8449 (ms) / GPU bubble ratio: 4.53%
[rank2]:2025-10-31 06:31:29,201 - INFO - Avg. fwd time: 13.8791 / Avg. bwd time: 28.2600 / Avg. batch time: 440.2250 (ms) / GPU bubble ratio: 23.42%
[rank1]:2025-10-31 06:31:29,239 - INFO - Avg. fwd time: 15.8920 / Avg. bwd time: 30.9049 / Avg. batch time: 488.9581 (ms) / GPU bubble ratio: 23.43%
[rank0]:2025-10-31 06:31:29,284 - INFO - Avg. fwd time: 14.0071 / Avg. bwd time: 27.3914 / Avg. batch time: 537.8434 (ms) / GPU bubble ratio: 38.42%
[rank0]:2025-10-31 06:33:11,830 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 06:33:13,947 - INFO -  step: 650  loss:  2.2887  grad_norm:  0.7794  memory: 47.33GiB(33.85%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank2]:2025-10-31 06:33:13,948 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.7794  memory: 39.13GiB(27.99%)  tps: 7,773  tflops: 362.54  mfu: 36.66%
[rank1]:2025-10-31 06:33:13,942 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.7794  memory: 48.62GiB(34.78%)  tps: 7,773  tflops: 362.51  mfu: 36.65%
[rank0]:2025-10-31 06:33:13,963 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.7794  memory: 56.77GiB(40.60%)  tps: 7,769  tflops: 362.33  mfu: 36.64%
[rank2]:2025-10-31 06:33:14,323 - INFO - Avg. fwd time: 13.9211 / Avg. bwd time: 27.8292 / Avg. batch time: 437.5102 (ms) / GPU bubble ratio: 23.66%
[rank1]:2025-10-31 06:33:14,330 - INFO - Avg. fwd time: 15.9472 / Avg. bwd time: 30.3016 / Avg. batch time: 486.2684 (ms) / GPU bubble ratio: 23.91%
[rank3]:2025-10-31 06:33:14,287 - INFO - Avg. fwd time: 15.6094 / Avg. bwd time: 30.8109 / Avg. batch time: 392.0329 (ms) / GPU bubble ratio: 5.27%
[rank0]:2025-10-31 06:33:14,385 - INFO - Avg. fwd time: 13.9668 / Avg. bwd time: 28.2063 / Avg. batch time: 535.6017 (ms) / GPU bubble ratio: 37.01%
[rank0]:2025-10-31 06:34:56,861 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 06:34:59,002 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3476  memory: 56.77GiB(40.60%)  tps: 7,799  tflops: 363.75  mfu: 36.78%
[rank2]:2025-10-31 06:34:58,983 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3476  memory: 39.13GiB(27.99%)  tps: 7,799  tflops: 363.76  mfu: 36.78%
[rank1]:2025-10-31 06:34:58,982 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.3476  memory: 48.62GiB(34.78%)  tps: 7,799  tflops: 363.74  mfu: 36.78%
[rank3]:2025-10-31 06:34:58,984 - INFO -  step: 700  loss:  2.5898  grad_norm:  0.3476  memory: 47.33GiB(33.85%)  tps: 7,799  tflops: 363.76  mfu: 36.78%
[rank0]:2025-10-31 06:34:59,078 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0634_stage0_step700.svg
[rank2]:2025-10-31 06:34:59,079 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0634_stage2_step700.svg
[rank1]:2025-10-31 06:34:59,080 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0634_stage1_step700.svg
[rank3]:2025-10-31 06:34:59,188 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0634_real_step700_rank3.svg
[rank3]:> Batch Time: 510.63 ms, GPU Bubble Ratio: 19.84%, 32.91%, 38.14%, 33.30%
[rank3]:2025-10-31 06:34:59,256 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0634_stage3_step700.svg
[rank3]:2025-10-31 06:34:59,538 - INFO - Avg. fwd time: 15.6744 / Avg. bwd time: 30.0194 / Avg. batch time: 389.1508 (ms) / GPU bubble ratio: 6.06%
[rank2]:2025-10-31 06:34:59,575 - INFO - Avg. fwd time: 13.9603 / Avg. bwd time: 27.4009 / Avg. batch time: 434.7171 (ms) / GPU bubble ratio: 23.88%
[rank1]:2025-10-31 06:34:59,582 - INFO - Avg. fwd time: 15.9990 / Avg. bwd time: 29.6930 / Avg. batch time: 483.5318 (ms) / GPU bubble ratio: 24.40%
[rank0]:2025-10-31 06:34:59,640 - INFO - Avg. fwd time: 13.9224 / Avg. bwd time: 29.0207 / Avg. batch time: 533.3085 (ms) / GPU bubble ratio: 35.58%
[rank0]:2025-10-31 06:36:42,336 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:36:44,447 - INFO -  step: 750  loss:  2.3424  grad_norm:  0.0655  memory: 47.33GiB(33.85%)  tps: 7,768  tflops: 362.29  mfu: 36.63%
[rank1]:2025-10-31 06:36:44,451 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0655  memory: 48.62GiB(34.78%)  tps: 7,767  tflops: 362.27  mfu: 36.63%
[rank0]:2025-10-31 06:36:44,473 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0655  memory: 56.77GiB(40.60%)  tps: 7,767  tflops: 362.26  mfu: 36.63%
[rank2]:2025-10-31 06:36:44,460 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0655  memory: 39.13GiB(27.99%)  tps: 7,767  tflops: 362.24  mfu: 36.63%
[rank3]:2025-10-31 06:36:44,893 - INFO - Avg. fwd time: 15.7355 / Avg. bwd time: 29.3161 / Avg. batch time: 386.7227 (ms) / GPU bubble ratio: 6.80%
[rank1]:2025-10-31 06:36:44,971 - INFO - Avg. fwd time: 16.0449 / Avg. bwd time: 29.1790 / Avg. batch time: 481.2850 (ms) / GPU bubble ratio: 24.83%
[rank2]:2025-10-31 06:36:44,932 - INFO - Avg. fwd time: 13.9965 / Avg. bwd time: 27.0309 / Avg. batch time: 432.4132 (ms) / GPU bubble ratio: 24.10%
[rank0]:2025-10-31 06:36:45,017 - INFO - Avg. fwd time: 13.8860 / Avg. bwd time: 29.7222 / Avg. batch time: 531.4457 (ms) / GPU bubble ratio: 34.36%
[rank0]:2025-10-31 06:38:27,574 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:38:29,972 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0638_rank1_trend_line.svg
[rank2]:2025-10-31 06:38:29,952 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0638_rank2_trend_line.svg
[rank3]:2025-10-31 06:38:29,947 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0638_rank3_trend_line.svg
[rank1]:2025-10-31 06:38:30,004 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.80/0.80, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:38:30,010 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1961  memory: 48.62GiB(34.78%)  tps: 7,761  tflops: 361.96  mfu: 36.60%
[rank1]:2025-10-31 06:38:30,010 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 06:38:29,997 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0638_rank0_trend_line.svg
[rank0]:2025-10-31 06:38:30,003 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.40/0.40, [MB1] 0.38/0.38, [MB2] 0.39/0.39, [MB3] 0.32/0.32, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.29/0.29, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:38:30,012 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1961  memory: 56.77GiB(40.60%)  tps: 7,762  tflops: 362.02  mfu: 36.61%
[rank0]:2025-10-31 06:38:30,012 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-31 06:38:30,004 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.66/0.66, [MB2] 0.37/0.37, [MB3] 0.39/0.39, [MB4] 0.38/0.38, [MB5] 0.18/0.18, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:38:30,010 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1961  memory: 39.13GiB(27.99%)  tps: 7,761  tflops: 361.99  mfu: 36.60%
[rank2]:2025-10-31 06:38:30,010 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 06:38:30,200 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0638_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 383.64 ms, GPU Bubble Ratio: 22.75%, 22.71%, 25.85%, 25.71%
[rank3]:2025-10-31 06:38:30,201 - INFO - 	> Batch Time: 383.64 ms (Average Freeze Ratio: 0.61)
[rank3]:2025-10-31 06:38:30,201 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.83/0.83, [MB4] 0.83/0.83, [MB5] 0.83/0.83, [MB6] 0.71/0.71, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:38:30,211 - INFO -  step: 800  loss:  2.6906  grad_norm:  0.1961  memory: 47.33GiB(33.85%)  tps: 7,746  tflops: 361.26  mfu: 36.53%
[rank3]:2025-10-31 06:38:30,211 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 06:38:46,581 - INFO - validate step: 800  loss: -1.0000  memory: 48.62GiB(34.78%)  tps: 24,718
[rank0]:2025-10-31 06:38:46,548 - INFO - validate step: 800  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,771
[rank2]:2025-10-31 06:38:46,596 - INFO - validate step: 800  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 24,696
[rank3]:2025-10-31 06:38:46,606 - INFO - validate step: 800  loss:  0.9377  memory: 47.33GiB(33.85%)  tps: 24,985
[rank1]:2025-10-31 06:38:46,689 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0638_stage1_step800.svg
[rank0]:2025-10-31 06:38:46,684 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0638_stage0_step800.svg
[rank2]:2025-10-31 06:38:46,689 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0638_stage2_step800.svg
[rank3]:2025-10-31 06:38:46,792 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0638_real_step800_rank3.svg
[rank3]:> Batch Time: 497.55 ms, GPU Bubble Ratio: 17.51%, 34.98%, 39.39%, 36.14%
[rank3]:2025-10-31 06:38:46,863 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0638_stage3_step800.svg
[rank3]:2025-10-31 06:38:47,137 - INFO - Avg. fwd time: 15.7770 / Avg. bwd time: 28.8043 / Avg. batch time: 384.8945 (ms) / GPU bubble ratio: 7.34%
[rank1]:2025-10-31 06:38:47,175 - INFO - Avg. fwd time: 16.0771 / Avg. bwd time: 28.7950 / Avg. batch time: 479.5496 (ms) / GPU bubble ratio: 25.14%
[rank2]:2025-10-31 06:38:47,175 - INFO - Avg. fwd time: 14.0209 / Avg. bwd time: 26.7592 / Avg. batch time: 430.6383 (ms) / GPU bubble ratio: 24.24%
[rank0]:2025-10-31 06:38:47,203 - INFO - Avg. fwd time: 13.8584 / Avg. bwd time: 30.2484 / Avg. batch time: 529.9965 (ms) / GPU bubble ratio: 33.42%
[rank0]:2025-10-31 06:40:17,934 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 06:40:19,810 - INFO -  step: 850  loss:  2.4907  grad_norm:  1.3134  memory: 47.33GiB(33.85%)  tps: 8,790  tflops: 409.94  mfu: 41.45%
[rank0]:2025-10-31 06:40:19,826 - INFO -  step: 850  loss: -4.0000  grad_norm:  1.3134  memory: 56.77GiB(40.60%)  tps: 8,782  tflops: 409.61  mfu: 41.42%
[rank2]:2025-10-31 06:40:19,816 - INFO -  step: 850  loss: -4.0000  grad_norm:  1.3134  memory: 39.13GiB(27.99%)  tps: 8,788  tflops: 409.87  mfu: 41.44%
[rank1]:2025-10-31 06:40:19,794 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,789  tflops: 409.90  mfu: 41.45%
[rank2]:2025-10-31 06:40:20,156 - INFO - Avg. fwd time: 14.0473 / Avg. bwd time: 26.5108 / Avg. batch time: 426.6023 (ms) / GPU bubble ratio: 23.94%
[rank1]:2025-10-31 06:40:20,156 - INFO - Avg. fwd time: 16.1324 / Avg. bwd time: 28.2360 / Avg. batch time: 475.1413 (ms) / GPU bubble ratio: 25.30%
[rank3]:2025-10-31 06:40:20,127 - INFO - Avg. fwd time: 15.8215 / Avg. bwd time: 28.3115 / Avg. batch time: 380.9129 (ms) / GPU bubble ratio: 7.31%
[rank0]:2025-10-31 06:40:20,187 - INFO - Avg. fwd time: 13.9027 / Avg. bwd time: 29.3835 / Avg. batch time: 525.1851 (ms) / GPU bubble ratio: 34.06%
[rank0]:2025-10-31 06:41:50,901 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:41:52,785 - INFO -  step: 900  loss:  2.4015  grad_norm:  0.7662  memory: 47.33GiB(33.85%)  tps: 8,811  tflops: 410.96  mfu: 41.55%
[rank2]:2025-10-31 06:41:52,788 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.7662  memory: 39.13GiB(27.99%)  tps: 8,811  tflops: 410.96  mfu: 41.55%
[rank0]:2025-10-31 06:41:52,794 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.7662  memory: 56.77GiB(40.60%)  tps: 8,812  tflops: 410.98  mfu: 41.55%
[rank1]:2025-10-31 06:41:52,769 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,811  tflops: 410.95  mfu: 41.55%
[rank2]:2025-10-31 06:41:52,865 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0641_stage2_step900.svg
[rank0]:2025-10-31 06:41:52,864 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0641_stage0_step900.svg
[rank1]:2025-10-31 06:41:52,867 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0641_stage1_step900.svg
[rank3]:2025-10-31 06:41:52,974 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0641_real_step900_rank3.svg
[rank3]:> Batch Time: 494.57 ms, GPU Bubble Ratio: 17.17%, 35.41%, 39.15%, 36.04%
[rank3]:2025-10-31 06:41:53,036 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0641_stage3_step900.svg
[rank3]:2025-10-31 06:41:53,375 - INFO - Avg. fwd time: 15.8574 / Avg. bwd time: 27.8979 / Avg. batch time: 377.2819 (ms) / GPU bubble ratio: 7.22%
[rank2]:2025-10-31 06:41:53,411 - INFO - Avg. fwd time: 14.0687 / Avg. bwd time: 26.3019 / Avg. batch time: 422.9291 (ms) / GPU bubble ratio: 23.64%
[rank1]:2025-10-31 06:41:53,443 - INFO - Avg. fwd time: 16.1814 / Avg. bwd time: 27.7235 / Avg. batch time: 471.1004 (ms) / GPU bubble ratio: 25.44%
[rank0]:2025-10-31 06:41:53,476 - INFO - Avg. fwd time: 13.9442 / Avg. bwd time: 28.5175 / Avg. batch time: 520.7200 (ms) / GPU bubble ratio: 34.76%
[rank0]:2025-10-31 06:43:24,142 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:43:26,010 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,786  tflops: 409.78  mfu: 41.43%
[rank3]:2025-10-31 06:43:26,019 - INFO -  step: 950  loss:  2.3515  grad_norm:  3.7788  memory: 47.33GiB(33.85%)  tps: 8,787  tflops: 409.81  mfu: 41.44%
[rank0]:2025-10-31 06:43:26,042 - INFO -  step: 950  loss: -4.0000  grad_norm:  3.7788  memory: 56.77GiB(40.60%)  tps: 8,785  tflops: 409.74  mfu: 41.43%
[rank2]:2025-10-31 06:43:26,032 - INFO -  step: 950  loss: -4.0000  grad_norm:  3.7788  memory: 39.13GiB(27.99%)  tps: 8,786  tflops: 409.76  mfu: 41.43%
[rank3]:2025-10-31 06:43:26,347 - INFO - Avg. fwd time: 15.8877 / Avg. bwd time: 27.5620 / Avg. batch time: 374.4666 (ms) / GPU bubble ratio: 7.18%
[rank0]:2025-10-31 06:43:26,403 - INFO - Avg. fwd time: 13.9778 / Avg. bwd time: 27.8402 / Avg. batch time: 517.2254 (ms) / GPU bubble ratio: 35.32%
[rank2]:2025-10-31 06:43:26,374 - INFO - Avg. fwd time: 14.0883 / Avg. bwd time: 26.1337 / Avg. batch time: 420.0303 (ms) / GPU bubble ratio: 23.39%
[rank1]:2025-10-31 06:43:26,374 - INFO - Avg. fwd time: 16.2211 / Avg. bwd time: 27.3298 / Avg. batch time: 467.9148 (ms) / GPU bubble ratio: 25.54%
[rank0]:2025-10-31 06:44:58,652 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:45:00,541 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,666  tflops: 404.18  mfu: 40.87%
[rank1]:2025-10-31 06:45:00,542 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 06:45:00,572 - INFO -  step: 1000  loss: -4.0000  grad_norm:  2.4396  memory: 56.77GiB(40.60%)  tps: 8,666  tflops: 404.19  mfu: 40.87%
[rank0]:2025-10-31 06:45:00,572 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-31 06:45:00,561 - INFO -  step: 1000  loss: -4.0000  grad_norm:  2.4396  memory: 39.13GiB(27.99%)  tps: 8,666  tflops: 404.19  mfu: 40.87%
[rank2]:2025-10-31 06:45:00,561 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-31 06:45:00,556 - INFO -  step: 1000  loss:  2.2531  grad_norm:  2.4396  memory: 47.33GiB(33.85%)  tps: 8,666  tflops: 404.16  mfu: 40.87%
[rank3]:2025-10-31 06:45:00,556 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-31 06:45:16,677 - INFO - validate step: 1000  loss: -1.0000  memory: 48.62GiB(34.78%)  tps: 25,386
[rank0]:2025-10-31 06:45:16,644 - INFO - validate step: 1000  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,485
[rank2]:2025-10-31 06:45:16,695 - INFO - validate step: 1000  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,388
[rank3]:2025-10-31 06:45:16,709 - INFO - validate step: 1000  loss:  0.9074  memory: 47.33GiB(33.85%)  tps: 25,358
[rank1]:2025-10-31 06:45:16,786 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0645_stage1_step1000.svg
[rank0]:2025-10-31 06:45:16,784 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0645_stage0_step1000.svg
[rank2]:2025-10-31 06:45:16,784 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0645_stage2_step1000.svg
[rank3]:2025-10-31 06:45:16,886 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0645_real_step1000_rank3.svg
[rank3]:> Batch Time: 457.99 ms, GPU Bubble Ratio: 19.45%, 31.80%, 34.87%, 33.59%
[rank3]:2025-10-31 06:45:16,948 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0645_stage3_step1000.svg
[rank3]:2025-10-31 06:45:17,212 - INFO - Avg. fwd time: 15.9121 / Avg. bwd time: 27.2817 / Avg. batch time: 371.8452 (ms) / GPU bubble ratio: 7.07%
[rank1]:2025-10-31 06:45:17,239 - INFO - Avg. fwd time: 16.2626 / Avg. bwd time: 26.9163 / Avg. batch time: 464.9327 (ms) / GPU bubble ratio: 25.70%
[rank0]:2025-10-31 06:45:17,270 - INFO - Avg. fwd time: 14.0166 / Avg. bwd time: 27.1205 / Avg. batch time: 513.9095 (ms) / GPU bubble ratio: 35.96%
[rank2]:2025-10-31 06:45:17,239 - INFO - Avg. fwd time: 14.1055 / Avg. bwd time: 25.9597 / Avg. batch time: 417.3357 (ms) / GPU bubble ratio: 23.20%
[rank0]:2025-10-31 06:46:49,508 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 06:46:51,389 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,649  tflops: 403.41  mfu: 40.79%
[rank3]:2025-10-31 06:46:51,403 - INFO -  step: 1050  loss:  2.6234  grad_norm:  2.0431  memory: 47.33GiB(33.85%)  tps: 8,651  tflops: 403.49  mfu: 40.80%
[rank0]:2025-10-31 06:46:51,421 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.0431  memory: 56.77GiB(40.60%)  tps: 8,643  tflops: 403.13  mfu: 40.76%
[rank2]:2025-10-31 06:46:51,409 - INFO -  step: 1050  loss: -4.0000  grad_norm:  2.0431  memory: 39.13GiB(27.99%)  tps: 8,649  tflops: 403.40  mfu: 40.79%
[rank3]:2025-10-31 06:46:51,808 - INFO - Avg. fwd time: 15.9340 / Avg. bwd time: 27.0363 / Avg. batch time: 369.5112 (ms) / GPU bubble ratio: 6.97%
[rank1]:2025-10-31 06:46:51,880 - INFO - Avg. fwd time: 16.3002 / Avg. bwd time: 26.5412 / Avg. batch time: 462.3086 (ms) / GPU bubble ratio: 25.87%
[rank2]:2025-10-31 06:46:51,846 - INFO - Avg. fwd time: 14.1191 / Avg. bwd time: 25.8107 / Avg. batch time: 414.9568 (ms) / GPU bubble ratio: 23.02%
[rank0]:2025-10-31 06:46:51,913 - INFO - Avg. fwd time: 14.0503 / Avg. bwd time: 26.4824 / Avg. batch time: 510.9992 (ms) / GPU bubble ratio: 36.54%
[rank0]:2025-10-31 06:48:23,418 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:48:25,294 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,724  tflops: 406.88  mfu: 41.14%
[rank2]:2025-10-31 06:48:25,312 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.9707  memory: 39.13GiB(27.99%)  tps: 8,724  tflops: 406.89  mfu: 41.14%
[rank0]:2025-10-31 06:48:25,318 - INFO -  step: 1100  loss: -4.0000  grad_norm:  1.9707  memory: 56.77GiB(40.60%)  tps: 8,724  tflops: 406.91  mfu: 41.14%
[rank3]:2025-10-31 06:48:25,308 - INFO -  step: 1100  loss:  2.5012  grad_norm:  1.9707  memory: 47.33GiB(33.85%)  tps: 8,724  tflops: 406.88  mfu: 41.14%
[rank1]:2025-10-31 06:48:25,394 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0648_stage1_step1100.svg
[rank2]:2025-10-31 06:48:25,394 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0648_stage2_step1100.svg
[rank0]:2025-10-31 06:48:25,391 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0648_stage0_step1100.svg
[rank3]:2025-10-31 06:48:25,498 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0648_real_step1100_rank3.svg
[rank3]:> Batch Time: 444.16 ms, GPU Bubble Ratio: 26.19%, 30.71%, 32.77%, 30.79%
[rank3]:2025-10-31 06:48:25,562 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0648_stage3_step1100.svg
[rank1]:2025-10-31 06:48:25,855 - INFO - Avg. fwd time: 16.3292 / Avg. bwd time: 26.2519 / Avg. batch time: 460.1496 (ms) / GPU bubble ratio: 25.97%
[rank2]:2025-10-31 06:48:25,856 - INFO - Avg. fwd time: 14.1312 / Avg. bwd time: 25.6970 / Avg. batch time: 412.9908 (ms) / GPU bubble ratio: 22.85%
[rank3]:2025-10-31 06:48:25,827 - INFO - Avg. fwd time: 15.9519 / Avg. bwd time: 26.8285 / Avg. batch time: 367.5959 (ms) / GPU bubble ratio: 6.90%
[rank0]:2025-10-31 06:48:25,886 - INFO - Avg. fwd time: 14.0756 / Avg. bwd time: 25.9815 / Avg. batch time: 508.6080 (ms) / GPU bubble ratio: 36.99%
[rank0]:2025-10-31 06:49:57,444 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 06:49:59,329 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,712  tflops: 406.31  mfu: 41.08%
[rank3]:2025-10-31 06:49:59,344 - INFO -  step: 1150  loss:  2.3828  grad_norm:  4.3517  memory: 47.33GiB(33.85%)  tps: 8,712  tflops: 406.32  mfu: 41.08%
[rank2]:2025-10-31 06:49:59,353 - INFO -  step: 1150  loss: -4.0000  grad_norm:  4.3517  memory: 39.13GiB(27.99%)  tps: 8,711  tflops: 406.29  mfu: 41.08%
[rank0]:2025-10-31 06:49:59,354 - INFO -  step: 1150  loss: -4.0000  grad_norm:  4.3517  memory: 56.77GiB(40.60%)  tps: 8,712  tflops: 406.31  mfu: 41.08%
[rank3]:2025-10-31 06:49:59,661 - INFO - Avg. fwd time: 15.9706 / Avg. bwd time: 26.6146 / Avg. batch time: 365.5946 (ms) / GPU bubble ratio: 6.81%
[rank2]:2025-10-31 06:49:59,689 - INFO - Avg. fwd time: 14.1459 / Avg. bwd time: 25.5768 / Avg. batch time: 410.9555 (ms) / GPU bubble ratio: 22.67%
[rank1]:2025-10-31 06:49:59,689 - INFO - Avg. fwd time: 16.3635 / Avg. bwd time: 25.9357 / Avg. batch time: 457.8605 (ms) / GPU bubble ratio: 26.09%
[rank0]:2025-10-31 06:49:59,718 - INFO - Avg. fwd time: 14.1048 / Avg. bwd time: 25.4525 / Avg. batch time: 506.0651 (ms) / GPU bubble ratio: 37.47%
[rank1]:2025-10-31 06:51:16,140 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 06:51:25,408 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 06:51:29,797 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 06:51:30,220 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 06:51:31,679 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:51:33,980 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0651_rank3_trend_line.svg
[rank0]:2025-10-31 06:51:34,060 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0651_rank0_trend_line.svg
[rank0]:2025-10-31 06:51:34,066 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.17/0.17, [MB1] 0.15/0.15, [MB2] 0.15/0.15, [MB3] 0.15/0.15, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-31 06:51:34,073 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4605  memory: 56.77GiB(40.60%)  tps: 8,649  tflops: 403.38  mfu: 40.79%
[rank0]:2025-10-31 06:51:34,073 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 06:51:34,054 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0651_rank1_trend_line.svg
[rank1]:2025-10-31 06:51:34,067 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 06:51:34,070 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.62GiB(34.78%)  tps: 8,647  tflops: 403.29  mfu: 40.78%
[rank1]:2025-10-31 06:51:34,070 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-10-31 06:51:34,056 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0651_rank2_trend_line.svg
[rank2]:2025-10-31 06:51:34,067 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.88/0.88, [MB1] 0.60/0.60, [MB2] 0.33/0.33, [MB3] 0.35/0.35, [MB4] 0.34/0.34, [MB5] 0.33/0.33, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 06:51:34,074 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.4605  memory: 39.13GiB(27.99%)  tps: 8,649  tflops: 403.37  mfu: 40.79%
[rank2]:2025-10-31 06:51:34,074 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-31 06:51:34,271 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0651_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 382.47 ms, GPU Bubble Ratio: 25.09%, 23.85%, 25.05%, 25.08%
[rank3]:2025-10-31 06:51:34,272 - INFO - 	> Batch Time: 382.47 ms (Average Freeze Ratio: 0.43)
[rank3]:2025-10-31 06:51:34,273 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.96/0.96, [MB3] 0.81/0.81, [MB4] 0.81/0.81, [MB5] 0.81/0.81, [MB6] 0.81/0.81, [MB7] 1.00/1.00
[rank3]:2025-10-31 06:51:34,283 - INFO -  step: 1200  loss:  1.8337  grad_norm:  0.4605  memory: 47.33GiB(33.85%)  tps: 8,629  tflops: 402.45  mfu: 40.69%
[rank3]:2025-10-31 06:51:34,283 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 06:51:50,466 - INFO - validate step: 1200  loss: -1.0000  memory: 48.62GiB(34.78%)  tps: 24,983
[rank1]:2025-10-31 06:51:50,467 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 06:51:50,433 - INFO - validate step: 1200  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,037
[rank0]:2025-10-31 06:51:50,434 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 06:51:50,439 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-10-31 06:51:50,485 - INFO - validate step: 1200  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 24,960
[rank2]:2025-10-31 06:51:50,485 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 06:51:50,497 - INFO - validate step: 1200  loss:  0.9672  memory: 47.33GiB(33.85%)  tps: 25,263
[rank3]:2025-10-31 06:51:50,498 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 06:52:05,158 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.67 seconds.
[rank3]:2025-10-31 06:52:05,672 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.17 seconds.
[rank0]:2025-10-31 06:52:06,727 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 06:52:06,733 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.30 seconds.
[rank1]:2025-10-31 06:52:07,364 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.90 seconds.
[rank1]:2025-10-31 06:52:07,578 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0652_stage1_step1200.svg
[rank0]:2025-10-31 06:52:07,577 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0652_stage0_step1200.svg
[rank2]:2025-10-31 06:52:07,579 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0652_stage2_step1200.svg
[rank3]:2025-10-31 06:52:07,691 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0652_real_step1200_rank3.svg
[rank3]:> Batch Time: 442.49 ms, GPU Bubble Ratio: 44.40%, 30.99%, 32.44%, 30.42%
[rank3]:2025-10-31 06:52:07,759 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0652_stage3_step1200.svg
[rank3]:2025-10-31 06:52:08,659 - INFO - Avg. fwd time: 15.9881 / Avg. bwd time: 26.4396 / Avg. batch time: 363.9195 (ms) / GPU bubble ratio: 6.73%
[rank2]:2025-10-31 06:52:08,697 - INFO - Avg. fwd time: 14.1582 / Avg. bwd time: 25.4642 / Avg. batch time: 409.2453 (ms) / GPU bubble ratio: 22.55%
[rank1]:2025-10-31 06:52:08,744 - INFO - Avg. fwd time: 16.3928 / Avg. bwd time: 25.6568 / Avg. batch time: 455.9627 (ms) / GPU bubble ratio: 26.22%
[rank0]:2025-10-31 06:52:08,784 - INFO - Avg. fwd time: 14.1311 / Avg. bwd time: 24.9780 / Avg. batch time: 503.9583 (ms) / GPU bubble ratio: 37.92%
[rank2]:2025-10-31 06:52:16,366 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 06:52:16,951 - WARNING - Dataset medical is being re-looped
[rank1]:2025-10-31 06:52:17,430 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-31 06:52:28,700 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 06:53:50,251 - INFO - [GC] Peforming periodical GC collection 2.57 seconds
[rank2]:2025-10-31 06:53:52,266 - INFO -  step: 1250  loss: -4.0000  grad_norm:  1.9258  memory: 39.13GiB(27.99%)  tps: 6,727  tflops: 313.74  mfu: 31.72%
[rank0]:2025-10-31 06:53:52,280 - INFO -  step: 1250  loss: -4.0000  grad_norm:  1.9258  memory: 56.77GiB(40.60%)  tps: 6,723  tflops: 313.57  mfu: 31.71%
[rank1]:2025-10-31 06:53:52,277 - INFO -  step: 1250  loss: -4.0000  grad_norm:  1.9258  memory: 49.97GiB(35.74%)  tps: 6,725  tflops: 313.66  mfu: 31.72%
[rank3]:2025-10-31 06:53:52,261 - INFO -  step: 1250  loss:  2.1511  grad_norm:  1.9258  memory: 47.33GiB(33.85%)  tps: 6,728  tflops: 313.79  mfu: 31.73%
[rank2]:2025-10-31 06:53:52,624 - INFO - Avg. fwd time: 14.1622 / Avg. bwd time: 25.3902 / Avg. batch time: 408.3067 (ms) / GPU bubble ratio: 22.50%
[rank3]:2025-10-31 06:53:52,582 - INFO - Avg. fwd time: 15.9978 / Avg. bwd time: 26.3044 / Avg. batch time: 363.1097 (ms) / GPU bubble ratio: 6.80%
[rank0]:2025-10-31 06:53:52,689 - INFO - Avg. fwd time: 14.1462 / Avg. bwd time: 24.6744 / Avg. batch time: 503.3278 (ms) / GPU bubble ratio: 38.30%
[rank1]:2025-10-31 06:53:52,669 - INFO - Avg. fwd time: 16.3671 / Avg. bwd time: 25.8823 / Avg. batch time: 455.3898 (ms) / GPU bubble ratio: 25.78%
[rank0]:2025-10-31 06:55:30,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:55:33,017 - INFO -  step: 1300  loss:  2.3452  grad_norm:  0.3046  memory: 47.33GiB(33.85%)  tps: 8,131  tflops: 379.22  mfu: 38.34%
[rank0]:2025-10-31 06:55:33,038 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3046  memory: 56.77GiB(40.60%)  tps: 8,130  tflops: 379.20  mfu: 38.34%
[rank2]:2025-10-31 06:55:33,022 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3046  memory: 39.13GiB(27.99%)  tps: 8,131  tflops: 379.21  mfu: 38.34%
[rank1]:2025-10-31 06:55:33,034 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.3046  memory: 49.97GiB(35.74%)  tps: 8,131  tflops: 379.21  mfu: 38.34%
[rank0]:2025-10-31 06:55:33,118 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0655_stage0_step1300.svg
[rank2]:2025-10-31 06:55:33,119 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0655_stage2_step1300.svg
[rank1]:2025-10-31 06:55:33,120 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0655_stage1_step1300.svg
[rank3]:2025-10-31 06:55:33,218 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0655_real_step1300_rank3.svg
[rank3]:> Batch Time: 442.41 ms, GPU Bubble Ratio: 44.31%, 30.48%, 32.27%, 30.26%
[rank3]:2025-10-31 06:55:33,285 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0655_stage3_step1300.svg
[rank2]:2025-10-31 06:55:33,586 - INFO - Avg. fwd time: 14.1694 / Avg. bwd time: 25.3038 / Avg. batch time: 407.1717 (ms) / GPU bubble ratio: 22.44%
[rank3]:2025-10-31 06:55:33,541 - INFO - Avg. fwd time: 16.0118 / Avg. bwd time: 26.1403 / Avg. batch time: 362.1241 (ms) / GPU bubble ratio: 6.88%
[rank0]:2025-10-31 06:55:33,650 - INFO - Avg. fwd time: 14.1619 / Avg. bwd time: 24.3490 / Avg. batch time: 502.5364 (ms) / GPU bubble ratio: 38.69%
[rank1]:2025-10-31 06:55:33,632 - INFO - Avg. fwd time: 16.3406 / Avg. bwd time: 26.1282 / Avg. batch time: 454.6527 (ms) / GPU bubble ratio: 25.27%
[rank0]:2025-10-31 06:57:11,925 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 06:57:13,968 - INFO -  step: 1350  loss: -4.0000  grad_norm:  4.4463  memory: 56.77GiB(40.60%)  tps: 8,117  tflops: 378.56  mfu: 38.28%
[rank2]:2025-10-31 06:57:13,951 - INFO -  step: 1350  loss: -4.0000  grad_norm:  4.4463  memory: 39.13GiB(27.99%)  tps: 8,117  tflops: 378.56  mfu: 38.28%
[rank1]:2025-10-31 06:57:13,963 - INFO -  step: 1350  loss: -4.0000  grad_norm:  4.4463  memory: 49.97GiB(35.74%)  tps: 8,117  tflops: 378.56  mfu: 38.28%
[rank3]:2025-10-31 06:57:13,948 - INFO -  step: 1350  loss:  2.9757  grad_norm:  4.4463  memory: 47.33GiB(33.85%)  tps: 8,117  tflops: 378.56  mfu: 38.28%
[rank3]:2025-10-31 06:57:14,367 - INFO - Avg. fwd time: 16.0232 / Avg. bwd time: 25.9825 / Avg. batch time: 361.2078 (ms) / GPU bubble ratio: 6.97%
[rank2]:2025-10-31 06:57:14,403 - INFO - Avg. fwd time: 14.1760 / Avg. bwd time: 25.2254 / Avg. batch time: 406.1342 (ms) / GPU bubble ratio: 22.39%
[rank1]:2025-10-31 06:57:14,449 - INFO - Avg. fwd time: 16.3158 / Avg. bwd time: 26.3550 / Avg. batch time: 454.0006 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-31 06:57:14,504 - INFO - Avg. fwd time: 14.1771 / Avg. bwd time: 24.0477 / Avg. batch time: 501.8117 (ms) / GPU bubble ratio: 39.06%
[rank0]:2025-10-31 06:58:52,944 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 06:58:54,996 - INFO -  step: 1400  loss:  1.6806  grad_norm:  0.8234  memory: 47.33GiB(33.85%)  tps: 8,107  tflops: 378.12  mfu: 38.23%
[rank3]:2025-10-31 06:58:54,996 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-10-31 06:58:55,002 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8234  memory: 39.13GiB(27.99%)  tps: 8,107  tflops: 378.10  mfu: 38.23%
[rank2]:2025-10-31 06:58:55,002 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-31 06:58:55,011 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8234  memory: 49.97GiB(35.74%)  tps: 8,107  tflops: 378.11  mfu: 38.23%
[rank1]:2025-10-31 06:58:55,011 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 06:58:55,013 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.8234  memory: 56.77GiB(40.60%)  tps: 8,107  tflops: 378.13  mfu: 38.23%
[rank0]:2025-10-31 06:58:55,013 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 06:59:11,668 - INFO - validate step: 1400  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,594
[rank2]:2025-10-31 06:59:11,717 - INFO - validate step: 1400  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 24,505
[rank1]:2025-10-31 06:59:11,703 - INFO - validate step: 1400  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 24,539
[rank3]:2025-10-31 06:59:11,727 - INFO - validate step: 1400  loss:  0.9198  memory: 47.33GiB(33.85%)  tps: 24,483
[rank2]:2025-10-31 06:59:11,810 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0659_stage2_step1400.svg
[rank1]:2025-10-31 06:59:11,812 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0659_stage1_step1400.svg
[rank0]:2025-10-31 06:59:11,820 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0659_stage0_step1400.svg
[rank3]:2025-10-31 06:59:11,911 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0659_real_step1400_rank3.svg
[rank3]:> Batch Time: 443.50 ms, GPU Bubble Ratio: 44.12%, 30.07%, 32.34%, 30.37%
[rank3]:2025-10-31 06:59:11,980 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0659_stage3_step1400.svg
[rank2]:2025-10-31 06:59:12,287 - INFO - Avg. fwd time: 14.1809 / Avg. bwd time: 25.1626 / Avg. batch time: 405.3213 (ms) / GPU bubble ratio: 22.35%
[rank3]:2025-10-31 06:59:12,244 - INFO - Avg. fwd time: 16.0328 / Avg. bwd time: 25.8664 / Avg. batch time: 360.4964 (ms) / GPU bubble ratio: 7.02%
[rank1]:2025-10-31 06:59:12,335 - INFO - Avg. fwd time: 16.2966 / Avg. bwd time: 26.5360 / Avg. batch time: 453.4773 (ms) / GPU bubble ratio: 24.44%
[rank0]:2025-10-31 06:59:12,355 - INFO - Avg. fwd time: 14.1885 / Avg. bwd time: 23.8104 / Avg. batch time: 501.2467 (ms) / GPU bubble ratio: 39.35%
[rank0]:2025-10-31 07:00:50,810 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 07:00:52,832 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.3518  memory: 39.13GiB(27.99%)  tps: 8,102  tflops: 377.87  mfu: 38.21%
[rank1]:2025-10-31 07:00:52,843 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.3518  memory: 49.97GiB(35.74%)  tps: 8,100  tflops: 377.77  mfu: 38.20%
[rank0]:2025-10-31 07:00:52,847 - INFO -  step: 1450  loss: -4.0000  grad_norm:  3.3518  memory: 56.77GiB(40.60%)  tps: 8,097  tflops: 377.63  mfu: 38.18%
[rank3]:2025-10-31 07:00:52,826 - INFO -  step: 1450  loss:  1.9495  grad_norm:  3.3518  memory: 47.33GiB(33.85%)  tps: 8,103  tflops: 377.93  mfu: 38.21%
[rank3]:2025-10-31 07:00:53,157 - INFO - Avg. fwd time: 16.0422 / Avg. bwd time: 25.7390 / Avg. batch time: 359.7319 (ms) / GPU bubble ratio: 7.08%
[rank2]:2025-10-31 07:00:53,202 - INFO - Avg. fwd time: 14.1852 / Avg. bwd time: 25.1013 / Avg. batch time: 404.4610 (ms) / GPU bubble ratio: 22.29%
[rank1]:2025-10-31 07:00:53,249 - INFO - Avg. fwd time: 16.2750 / Avg. bwd time: 26.7326 / Avg. batch time: 452.9455 (ms) / GPU bubble ratio: 24.04%
[rank0]:2025-10-31 07:00:53,267 - INFO - Avg. fwd time: 14.2013 / Avg. bwd time: 23.5550 / Avg. batch time: 500.6552 (ms) / GPU bubble ratio: 39.67%
[rank0]:2025-10-31 07:02:31,742 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:02:33,805 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.7284  memory: 49.97GiB(35.74%)  tps: 8,114  tflops: 378.44  mfu: 38.26%
[rank2]:2025-10-31 07:02:33,795 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.7284  memory: 39.13GiB(27.99%)  tps: 8,114  tflops: 378.43  mfu: 38.26%
[rank0]:2025-10-31 07:02:33,809 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.7284  memory: 56.77GiB(40.60%)  tps: 8,114  tflops: 378.44  mfu: 38.26%
[rank3]:2025-10-31 07:02:33,789 - INFO -  step: 1500  loss:  2.2842  grad_norm:  0.7284  memory: 47.33GiB(33.85%)  tps: 8,114  tflops: 378.44  mfu: 38.27%
[rank1]:2025-10-31 07:02:33,890 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0702_stage1_step1500.svg
[rank2]:2025-10-31 07:02:33,889 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0702_stage2_step1500.svg
[rank0]:2025-10-31 07:02:33,893 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0702_stage0_step1500.svg
[rank3]:2025-10-31 07:02:33,986 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0702_real_step1500_rank3.svg
[rank3]:> Batch Time: 446.72 ms, GPU Bubble Ratio: 44.30%, 28.55%, 32.58%, 30.79%
[rank3]:2025-10-31 07:02:34,054 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0702_stage3_step1500.svg
[rank3]:2025-10-31 07:02:34,417 - INFO - Avg. fwd time: 16.0522 / Avg. bwd time: 25.6074 / Avg. batch time: 358.9913 (ms) / GPU bubble ratio: 7.16%
[rank1]:2025-10-31 07:02:34,498 - INFO - Avg. fwd time: 16.2562 / Avg. bwd time: 26.9172 / Avg. batch time: 452.4414 (ms) / GPU bubble ratio: 23.66%
[rank2]:2025-10-31 07:02:34,452 - INFO - Avg. fwd time: 14.1899 / Avg. bwd time: 25.0450 / Avg. batch time: 403.6393 (ms) / GPU bubble ratio: 22.24%
[rank0]:2025-10-31 07:02:34,537 - INFO - Avg. fwd time: 14.2141 / Avg. bwd time: 23.3132 / Avg. batch time: 500.1051 (ms) / GPU bubble ratio: 39.97%
[rank0]:2025-10-31 07:04:12,973 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 07:04:15,006 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.3717  memory: 39.13GiB(27.99%)  tps: 8,094  tflops: 377.50  mfu: 38.17%
[rank1]:2025-10-31 07:04:15,016 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.3717  memory: 49.97GiB(35.74%)  tps: 8,094  tflops: 377.50  mfu: 38.17%
[rank0]:2025-10-31 07:04:15,021 - INFO -  step: 1550  loss: -4.0000  grad_norm:  1.3717  memory: 56.77GiB(40.60%)  tps: 8,094  tflops: 377.50  mfu: 38.17%
[rank3]:2025-10-31 07:04:15,000 - INFO -  step: 1550  loss:  2.7029  grad_norm:  1.3717  memory: 47.33GiB(33.85%)  tps: 8,094  tflops: 377.51  mfu: 38.17%
[rank3]:2025-10-31 07:04:15,337 - INFO - Avg. fwd time: 16.0601 / Avg. bwd time: 25.5082 / Avg. batch time: 358.4407 (ms) / GPU bubble ratio: 7.22%
[rank2]:2025-10-31 07:04:15,378 - INFO - Avg. fwd time: 14.1932 / Avg. bwd time: 24.9977 / Avg. batch time: 403.0062 (ms) / GPU bubble ratio: 22.20%
[rank1]:2025-10-31 07:04:15,425 - INFO - Avg. fwd time: 16.2404 / Avg. bwd time: 27.0642 / Avg. batch time: 452.0327 (ms) / GPU bubble ratio: 23.36%
[rank0]:2025-10-31 07:04:15,444 - INFO - Avg. fwd time: 14.2236 / Avg. bwd time: 23.1227 / Avg. batch time: 499.6482 (ms) / GPU bubble ratio: 40.20%
[rank0]:2025-10-31 07:05:53,745 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 07:05:56,307 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0705_rank3_trend_line.svg
[rank2]:2025-10-31 07:05:56,406 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0705_rank2_trend_line.svg
[rank1]:2025-10-31 07:05:56,437 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0705_rank1_trend_line.svg
[rank1]:2025-10-31 07:05:56,466 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.83/0.83, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 07:05:56,477 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.3757  memory: 49.97GiB(35.74%)  tps: 8,074  tflops: 376.58  mfu: 38.08%
[rank1]:2025-10-31 07:05:56,477 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-10-31 07:05:56,466 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.64/0.64, [MB2] 0.38/0.38, [MB3] 0.40/0.40, [MB4] 0.39/0.39, [MB5] 0.08/0.08, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 07:05:56,474 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.3757  memory: 39.13GiB(27.99%)  tps: 8,074  tflops: 376.55  mfu: 38.07%
[rank2]:2025-10-31 07:05:56,474 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 07:05:56,459 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule_adjustment/251031_0705_rank0_trend_line.svg
[rank0]:2025-10-31 07:05:56,468 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.01, [MB7] 1.00/1.00
[rank0]:2025-10-31 07:05:56,478 - INFO -  step: 1600  loss: -4.0000  grad_norm:  1.3757  memory: 56.77GiB(40.60%)  tps: 8,074  tflops: 376.59  mfu: 38.08%
[rank0]:2025-10-31 07:05:56,478 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-31 07:05:56,662 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0705_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 389.34 ms, GPU Bubble Ratio: 29.35%, 21.67%, 26.13%, 25.90%
[rank3]:2025-10-31 07:05:56,662 - INFO - 	> Batch Time: 389.34 ms (Average Freeze Ratio: 0.55)
[rank3]:2025-10-31 07:05:56,663 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.84/0.84, [MB4] 0.85/0.85, [MB5] 0.85/0.85, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank3]:2025-10-31 07:05:56,672 - INFO -  step: 1600  loss:  2.0198  grad_norm:  1.3757  memory: 47.33GiB(33.85%)  tps: 8,057  tflops: 375.80  mfu: 38.00%
[rank3]:2025-10-31 07:05:56,672 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 07:06:13,181 - INFO - validate step: 1600  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,522
[rank1]:2025-10-31 07:06:13,216 - INFO - validate step: 1600  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 24,470
[rank3]:2025-10-31 07:06:13,237 - INFO - validate step: 1600  loss:  0.9411  memory: 47.33GiB(33.85%)  tps: 24,728
[rank0]:2025-10-31 07:06:13,320 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0706_stage0_step1600.svg
[rank1]:2025-10-31 07:06:13,323 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0706_stage1_step1600.svg
[rank2]:2025-10-31 07:06:13,231 - INFO - validate step: 1600  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 24,444
[rank2]:2025-10-31 07:06:13,324 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0706_stage2_step1600.svg
[rank3]:2025-10-31 07:06:13,411 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0706_real_step1600_rank3.svg
[rank3]:> Batch Time: 446.91 ms, GPU Bubble Ratio: 44.23%, 27.67%, 32.51%, 30.79%
[rank3]:2025-10-31 07:06:13,479 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0706_stage3_step1600.svg
[rank3]:2025-10-31 07:06:13,737 - INFO - Avg. fwd time: 16.0680 / Avg. bwd time: 25.4024 / Avg. batch time: 357.7959 (ms) / GPU bubble ratio: 7.28%
[rank0]:2025-10-31 07:06:13,822 - INFO - Avg. fwd time: 14.2348 / Avg. bwd time: 22.9083 / Avg. batch time: 499.1032 (ms) / GPU bubble ratio: 40.46%
[rank1]:2025-10-31 07:06:13,765 - INFO - Avg. fwd time: 16.2235 / Avg. bwd time: 27.2263 / Avg. batch time: 451.5400 (ms) / GPU bubble ratio: 23.02%
[rank2]:2025-10-31 07:06:13,765 - INFO - Avg. fwd time: 14.1973 / Avg. bwd time: 24.9435 / Avg. batch time: 402.2671 (ms) / GPU bubble ratio: 22.16%
[rank0]:2025-10-31 07:07:47,419 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 07:07:49,340 - INFO -  step: 1650  loss: -4.0000  grad_norm:  4.0456  memory: 39.13GiB(27.99%)  tps: 8,524  tflops: 397.55  mfu: 40.20%
[rank1]:2025-10-31 07:07:49,322 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,524  tflops: 397.56  mfu: 40.20%
[rank0]:2025-10-31 07:07:49,356 - INFO -  step: 1650  loss: -4.0000  grad_norm:  4.0456  memory: 56.77GiB(40.60%)  tps: 8,518  tflops: 397.27  mfu: 40.17%
[rank3]:2025-10-31 07:07:49,336 - INFO -  step: 1650  loss:  2.3290  grad_norm:  4.0456  memory: 47.33GiB(33.85%)  tps: 8,525  tflops: 397.59  mfu: 40.20%
[rank2]:2025-10-31 07:07:49,781 - INFO - Avg. fwd time: 14.2043 / Avg. bwd time: 24.8885 / Avg. batch time: 401.2223 (ms) / GPU bubble ratio: 22.05%
[rank3]:2025-10-31 07:07:49,740 - INFO - Avg. fwd time: 16.0788 / Avg. bwd time: 25.2903 / Avg. batch time: 356.7052 (ms) / GPU bubble ratio: 7.22%
[rank1]:2025-10-31 07:07:49,818 - INFO - Avg. fwd time: 16.2480 / Avg. bwd time: 26.9914 / Avg. batch time: 450.2946 (ms) / GPU bubble ratio: 23.18%
[rank0]:2025-10-31 07:07:49,860 - INFO - Avg. fwd time: 14.2391 / Avg. bwd time: 22.7589 / Avg. batch time: 497.8879 (ms) / GPU bubble ratio: 40.55%
[rank0]:2025-10-31 07:09:23,436 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:09:25,352 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,531  tflops: 397.87  mfu: 40.23%
[rank3]:2025-10-31 07:09:25,366 - INFO -  step: 1700  loss:  2.2301  grad_norm:  1.2758  memory: 47.33GiB(33.85%)  tps: 8,531  tflops: 397.88  mfu: 40.23%
[rank2]:2025-10-31 07:09:25,376 - INFO -  step: 1700  loss: -4.0000  grad_norm:  1.2758  memory: 39.13GiB(27.99%)  tps: 8,530  tflops: 397.85  mfu: 40.23%
[rank2]:2025-10-31 07:09:25,469 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0709_stage2_step1700.svg
[rank0]:2025-10-31 07:09:25,387 - INFO -  step: 1700  loss: -4.0000  grad_norm:  1.2758  memory: 56.77GiB(40.60%)  tps: 8,531  tflops: 397.87  mfu: 40.23%
[rank0]:2025-10-31 07:09:25,470 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0709_stage0_step1700.svg
[rank1]:2025-10-31 07:09:25,471 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0709_stage1_step1700.svg
[rank3]:2025-10-31 07:09:25,563 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0709_real_step1700_rank3.svg
[rank3]:> Batch Time: 446.83 ms, GPU Bubble Ratio: 44.05%, 28.48%, 32.56%, 30.82%
[rank3]:2025-10-31 07:09:25,631 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0709_stage3_step1700.svg
[rank3]:2025-10-31 07:09:25,888 - INFO - Avg. fwd time: 16.0863 / Avg. bwd time: 25.2027 / Avg. batch time: 355.8016 (ms) / GPU bubble ratio: 7.16%
[rank2]:2025-10-31 07:09:25,917 - INFO - Avg. fwd time: 14.2096 / Avg. bwd time: 24.8460 / Avg. batch time: 400.3495 (ms) / GPU bubble ratio: 21.96%
[rank0]:2025-10-31 07:09:25,975 - INFO - Avg. fwd time: 14.2413 / Avg. bwd time: 22.6393 / Avg. batch time: 496.8625 (ms) / GPU bubble ratio: 40.62%
[rank1]:2025-10-31 07:09:25,916 - INFO - Avg. fwd time: 16.2685 / Avg. bwd time: 26.7893 / Avg. batch time: 449.2453 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-10-31 07:10:59,854 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:11:01,772 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,496  tflops: 396.27  mfu: 40.07%
[rank0]:2025-10-31 07:11:01,806 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6550  memory: 56.77GiB(40.60%)  tps: 8,496  tflops: 396.27  mfu: 40.07%
[rank2]:2025-10-31 07:11:01,790 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6550  memory: 39.13GiB(27.99%)  tps: 8,497  tflops: 396.29  mfu: 40.07%
[rank3]:2025-10-31 07:11:01,786 - INFO -  step: 1750  loss:  2.7783  grad_norm:  0.6550  memory: 47.33GiB(33.85%)  tps: 8,496  tflops: 396.27  mfu: 40.07%
[rank1]:2025-10-31 07:11:02,149 - INFO - Avg. fwd time: 16.2915 / Avg. bwd time: 26.5619 / Avg. batch time: 448.1396 (ms) / GPU bubble ratio: 23.50%
[rank2]:2025-10-31 07:11:02,148 - INFO - Avg. fwd time: 14.2153 / Avg. bwd time: 24.7966 / Avg. batch time: 399.4667 (ms) / GPU bubble ratio: 21.87%
[rank3]:2025-10-31 07:11:02,119 - INFO - Avg. fwd time: 16.0947 / Avg. bwd time: 25.1143 / Avg. batch time: 354.8721 (ms) / GPU bubble ratio: 7.10%
[rank0]:2025-10-31 07:11:02,203 - INFO - Avg. fwd time: 14.2438 / Avg. bwd time: 22.5079 / Avg. batch time: 495.7834 (ms) / GPU bubble ratio: 40.70%
[rank0]:2025-10-31 07:12:36,004 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:12:37,912 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,521  tflops: 397.42  mfu: 40.18%
[rank1]:2025-10-31 07:12:37,912 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-31 07:12:37,925 - INFO -  step: 1800  loss:  2.3220  grad_norm:  0.7119  memory: 47.33GiB(33.85%)  tps: 8,521  tflops: 397.43  mfu: 40.18%
[rank3]:2025-10-31 07:12:37,926 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-10-31 07:12:37,932 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7119  memory: 39.13GiB(27.99%)  tps: 8,521  tflops: 397.41  mfu: 40.18%
[rank2]:2025-10-31 07:12:37,932 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 07:12:37,946 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.7119  memory: 56.77GiB(40.60%)  tps: 8,521  tflops: 397.42  mfu: 40.18%
[rank0]:2025-10-31 07:12:37,946 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 07:12:54,121 - INFO - validate step: 1800  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,324
[rank2]:2025-10-31 07:12:54,170 - INFO - validate step: 1800  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,225
[rank1]:2025-10-31 07:12:54,152 - INFO - validate step: 1800  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 25,222
[rank3]:2025-10-31 07:12:54,180 - INFO - validate step: 1800  loss:  0.9034  memory: 47.33GiB(33.85%)  tps: 25,201
[rank2]:2025-10-31 07:12:54,264 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0712_stage2_step1800.svg
[rank0]:2025-10-31 07:12:54,265 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0712_stage0_step1800.svg
[rank1]:2025-10-31 07:12:54,265 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0712_stage1_step1800.svg
[rank3]:2025-10-31 07:12:54,361 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0712_real_step1800_rank3.svg
[rank3]:> Batch Time: 446.17 ms, GPU Bubble Ratio: 43.80%, 29.95%, 32.62%, 30.71%
[rank3]:2025-10-31 07:12:54,430 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0712_stage3_step1800.svg
[rank2]:2025-10-31 07:12:54,817 - INFO - Avg. fwd time: 14.2206 / Avg. bwd time: 24.7494 / Avg. batch time: 398.6072 (ms) / GPU bubble ratio: 21.79%
[rank3]:2025-10-31 07:12:54,777 - INFO - Avg. fwd time: 16.1024 / Avg. bwd time: 25.0300 / Avg. batch time: 353.9777 (ms) / GPU bubble ratio: 7.04%
[rank0]:2025-10-31 07:12:54,898 - INFO - Avg. fwd time: 14.2456 / Avg. bwd time: 22.3840 / Avg. batch time: 494.7601 (ms) / GPU bubble ratio: 40.77%
[rank1]:2025-10-31 07:12:54,856 - INFO - Avg. fwd time: 16.3125 / Avg. bwd time: 26.3508 / Avg. batch time: 447.0890 (ms) / GPU bubble ratio: 23.66%
[rank0]:2025-10-31 07:14:28,720 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 07:14:30,660 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.7089  memory: 39.13GiB(27.99%)  tps: 8,490  tflops: 395.98  mfu: 40.04%
[rank0]:2025-10-31 07:14:30,671 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.7089  memory: 56.77GiB(40.60%)  tps: 8,485  tflops: 395.73  mfu: 40.01%
[rank1]:2025-10-31 07:14:30,637 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,490  tflops: 395.99  mfu: 40.04%
[rank3]:2025-10-31 07:14:30,651 - INFO -  step: 1850  loss:  2.5396  grad_norm:  0.7089  memory: 47.33GiB(33.85%)  tps: 8,492  tflops: 396.06  mfu: 40.05%
[rank2]:2025-10-31 07:14:31,009 - INFO - Avg. fwd time: 14.2252 / Avg. bwd time: 24.7116 / Avg. batch time: 397.9055 (ms) / GPU bubble ratio: 21.72%
[rank1]:2025-10-31 07:14:31,008 - INFO - Avg. fwd time: 16.3297 / Avg. bwd time: 26.1813 / Avg. batch time: 446.2424 (ms) / GPU bubble ratio: 23.79%
[rank3]:2025-10-31 07:14:30,981 - INFO - Avg. fwd time: 16.1097 / Avg. bwd time: 24.9595 / Avg. batch time: 353.2552 (ms) / GPU bubble ratio: 6.99%
[rank0]:2025-10-31 07:14:31,062 - INFO - Avg. fwd time: 14.2474 / Avg. bwd time: 22.2837 / Avg. batch time: 493.9339 (ms) / GPU bubble ratio: 40.83%
[rank0]:2025-10-31 07:16:05,031 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 07:16:06,984 - INFO -  step: 1900  loss: -4.0000  grad_norm:  1.1687  memory: 39.13GiB(27.99%)  tps: 8,505  tflops: 396.66  mfu: 40.11%
[rank1]:2025-10-31 07:16:06,960 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,505  tflops: 396.66  mfu: 40.11%
[rank3]:2025-10-31 07:16:06,974 - INFO -  step: 1900  loss:  2.2599  grad_norm:  1.1687  memory: 47.33GiB(33.85%)  tps: 8,505  tflops: 396.66  mfu: 40.11%
[rank0]:2025-10-31 07:16:06,995 - INFO -  step: 1900  loss: -4.0000  grad_norm:  1.1687  memory: 56.77GiB(40.60%)  tps: 8,505  tflops: 396.66  mfu: 40.11%
[rank0]:2025-10-31 07:16:07,081 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0716_stage0_step1900.svg
[rank2]:2025-10-31 07:16:07,079 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0716_stage2_step1900.svg
[rank1]:2025-10-31 07:16:07,079 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0716_stage1_step1900.svg
[rank3]:2025-10-31 07:16:07,173 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0716_real_step1900_rank3.svg
[rank3]:> Batch Time: 443.59 ms, GPU Bubble Ratio: 43.29%, 30.62%, 32.25%, 30.28%
[rank3]:2025-10-31 07:16:07,242 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0716_stage3_step1900.svg
[rank3]:2025-10-31 07:16:07,506 - INFO - Avg. fwd time: 16.1167 / Avg. bwd time: 24.8864 / Avg. batch time: 352.4683 (ms) / GPU bubble ratio: 6.94%
[rank0]:2025-10-31 07:16:07,591 - INFO - Avg. fwd time: 14.2494 / Avg. bwd time: 22.1712 / Avg. batch time: 493.0095 (ms) / GPU bubble ratio: 40.90%
[rank2]:2025-10-31 07:16:07,534 - INFO - Avg. fwd time: 14.2306 / Avg. bwd time: 24.6594 / Avg. batch time: 397.1284 (ms) / GPU bubble ratio: 21.66%
[rank1]:2025-10-31 07:16:07,534 - INFO - Avg. fwd time: 16.3487 / Avg. bwd time: 25.9906 / Avg. batch time: 445.2956 (ms) / GPU bubble ratio: 23.94%
[rank0]:2025-10-31 07:17:41,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:17:43,156 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,516  tflops: 397.19  mfu: 40.16%
[rank3]:2025-10-31 07:17:43,170 - INFO -  step: 1950  loss:  1.9351  grad_norm:  0.4609  memory: 47.33GiB(33.85%)  tps: 8,516  tflops: 397.19  mfu: 40.16%
[rank0]:2025-10-31 07:17:43,191 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.4609  memory: 56.77GiB(40.60%)  tps: 8,516  tflops: 397.19  mfu: 40.16%
[rank2]:2025-10-31 07:17:43,177 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.4609  memory: 39.13GiB(27.99%)  tps: 8,516  tflops: 397.20  mfu: 40.16%
[rank3]:2025-10-31 07:17:43,580 - INFO - Avg. fwd time: 16.1240 / Avg. bwd time: 24.8133 / Avg. batch time: 351.7080 (ms) / GPU bubble ratio: 6.88%
[rank2]:2025-10-31 07:17:43,622 - INFO - Avg. fwd time: 14.2350 / Avg. bwd time: 24.6162 / Avg. batch time: 396.3992 (ms) / GPU bubble ratio: 21.59%
[rank1]:2025-10-31 07:17:43,659 - INFO - Avg. fwd time: 16.3668 / Avg. bwd time: 25.8083 / Avg. batch time: 444.3829 (ms) / GPU bubble ratio: 24.07%
[rank0]:2025-10-31 07:17:43,704 - INFO - Avg. fwd time: 14.2514 / Avg. bwd time: 22.0653 / Avg. batch time: 492.1201 (ms) / GPU bubble ratio: 40.96%
[rank0]:2025-10-31 07:19:17,148 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 07:19:19,116 - INFO -  step: 2000  loss: -4.0000  grad_norm:  2.2627  memory: 56.77GiB(40.60%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank0]:2025-10-31 07:19:19,116 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-31 07:19:19,104 - INFO -  step: 2000  loss: -4.0000  grad_norm:  2.2627  memory: 39.13GiB(27.99%)  tps: 8,540  tflops: 398.30  mfu: 40.27%
[rank2]:2025-10-31 07:19:19,105 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-31 07:19:19,082 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank1]:2025-10-31 07:19:19,082 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-10-31 07:19:19,096 - INFO -  step: 2000  loss:  2.2296  grad_norm:  2.2627  memory: 47.33GiB(33.85%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank3]:2025-10-31 07:19:19,096 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-31 07:19:35,294 - INFO - validate step: 2000  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,320
[rank2]:2025-10-31 07:19:35,342 - INFO - validate step: 2000  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,227
[rank1]:2025-10-31 07:19:35,325 - INFO - validate step: 2000  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 25,219
[rank3]:2025-10-31 07:19:35,349 - INFO - validate step: 2000  loss:  0.8709  memory: 47.33GiB(33.85%)  tps: 25,204
[rank0]:2025-10-31 07:19:35,439 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0719_stage0_step2000.svg
[rank2]:2025-10-31 07:19:35,434 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0719_stage2_step2000.svg
[rank1]:2025-10-31 07:19:35,441 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0719_stage1_step2000.svg
[rank3]:2025-10-31 07:19:35,528 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0719_real_step2000_rank3.svg
[rank3]:> Batch Time: 443.64 ms, GPU Bubble Ratio: 42.93%, 31.14%, 32.26%, 30.28%
[rank3]:2025-10-31 07:19:35,597 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0719_stage3_step2000.svg
[rank3]:2025-10-31 07:19:35,863 - INFO - Avg. fwd time: 16.1300 / Avg. bwd time: 24.7478 / Avg. batch time: 351.0518 (ms) / GPU bubble ratio: 6.84%
[rank2]:2025-10-31 07:19:35,891 - INFO - Avg. fwd time: 14.2389 / Avg. bwd time: 24.5841 / Avg. batch time: 395.7679 (ms) / GPU bubble ratio: 21.52%
[rank1]:2025-10-31 07:19:35,891 - INFO - Avg. fwd time: 16.3814 / Avg. bwd time: 25.6582 / Avg. batch time: 443.6004 (ms) / GPU bubble ratio: 24.18%
[rank0]:2025-10-31 07:19:35,951 - INFO - Avg. fwd time: 14.2527 / Avg. bwd time: 21.9794 / Avg. batch time: 491.3542 (ms) / GPU bubble ratio: 41.01%
[rank0]:2025-10-31 07:21:09,851 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 07:21:11,785 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.5028  memory: 56.77GiB(40.60%)  tps: 8,490  tflops: 395.97  mfu: 40.04%
[rank2]:2025-10-31 07:21:11,769 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.5028  memory: 39.13GiB(27.99%)  tps: 8,496  tflops: 396.23  mfu: 40.06%
[rank1]:2025-10-31 07:21:11,751 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,496  tflops: 396.24  mfu: 40.06%
[rank3]:2025-10-31 07:21:11,765 - INFO -  step: 2050  loss:  2.2749  grad_norm:  0.5028  memory: 47.33GiB(33.85%)  tps: 8,497  tflops: 396.28  mfu: 40.07%
[rank2]:2025-10-31 07:21:12,115 - INFO - Avg. fwd time: 14.2430 / Avg. bwd time: 24.5472 / Avg. batch time: 395.1094 (ms) / GPU bubble ratio: 21.46%
[rank1]:2025-10-31 07:21:12,115 - INFO - Avg. fwd time: 16.3990 / Avg. bwd time: 25.4981 / Avg. batch time: 442.8109 (ms) / GPU bubble ratio: 24.31%
[rank3]:2025-10-31 07:21:12,084 - INFO - Avg. fwd time: 16.1367 / Avg. bwd time: 24.6816 / Avg. batch time: 350.3618 (ms) / GPU bubble ratio: 6.80%
[rank0]:2025-10-31 07:21:12,167 - INFO - Avg. fwd time: 14.2545 / Avg. bwd time: 21.8840 / Avg. batch time: 490.5839 (ms) / GPU bubble ratio: 41.07%
[rank0]:2025-10-31 07:22:45,878 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:22:47,781 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,531  tflops: 397.87  mfu: 40.23%
[rank3]:2025-10-31 07:22:47,795 - INFO -  step: 2100  loss:  1.8131  grad_norm:  1.2059  memory: 47.33GiB(33.85%)  tps: 8,531  tflops: 397.88  mfu: 40.23%
[rank0]:2025-10-31 07:22:47,815 - INFO -  step: 2100  loss: -4.0000  grad_norm:  1.2059  memory: 56.77GiB(40.60%)  tps: 8,531  tflops: 397.87  mfu: 40.23%
[rank0]:2025-10-31 07:22:47,896 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0722_stage0_step2100.svg
[rank2]:2025-10-31 07:22:47,803 - INFO -  step: 2100  loss: -4.0000  grad_norm:  1.2059  memory: 39.13GiB(27.99%)  tps: 8,530  tflops: 397.85  mfu: 40.23%
[rank2]:2025-10-31 07:22:47,894 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0722_stage2_step2100.svg
[rank1]:2025-10-31 07:22:47,899 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0722_stage1_step2100.svg
[rank3]:2025-10-31 07:22:47,996 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0722_real_step2100_rank3.svg
[rank3]:> Batch Time: 443.91 ms, GPU Bubble Ratio: 42.67%, 32.62%, 32.31%, 30.32%
[rank3]:2025-10-31 07:22:48,060 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0722_stage3_step2100.svg
[rank3]:2025-10-31 07:22:48,403 - INFO - Avg. fwd time: 16.1426 / Avg. bwd time: 24.6176 / Avg. batch time: 349.6858 (ms) / GPU bubble ratio: 6.75%
[rank2]:2025-10-31 07:22:48,445 - INFO - Avg. fwd time: 14.2471 / Avg. bwd time: 24.5114 / Avg. batch time: 394.4761 (ms) / GPU bubble ratio: 21.40%
[rank1]:2025-10-31 07:22:48,484 - INFO - Avg. fwd time: 16.4144 / Avg. bwd time: 25.3447 / Avg. batch time: 442.0379 (ms) / GPU bubble ratio: 24.42%
[rank0]:2025-10-31 07:22:48,526 - INFO - Avg. fwd time: 14.2564 / Avg. bwd time: 21.7928 / Avg. batch time: 489.8300 (ms) / GPU bubble ratio: 41.12%
[rank0]:2025-10-31 07:24:22,194 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 07:24:24,136 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.6882  memory: 56.77GiB(40.60%)  tps: 8,505  tflops: 396.67  mfu: 40.11%
[rank2]:2025-10-31 07:24:24,124 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.6882  memory: 39.13GiB(27.99%)  tps: 8,505  tflops: 396.67  mfu: 40.11%
[rank1]:2025-10-31 07:24:24,102 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,505  tflops: 396.67  mfu: 40.11%
[rank3]:2025-10-31 07:24:24,115 - INFO -  step: 2150  loss:  2.0290  grad_norm:  0.6882  memory: 47.33GiB(33.85%)  tps: 8,505  tflops: 396.68  mfu: 40.11%
[rank2]:2025-10-31 07:24:24,475 - INFO - Avg. fwd time: 14.2506 / Avg. bwd time: 24.4810 / Avg. batch time: 393.9459 (ms) / GPU bubble ratio: 21.35%
[rank1]:2025-10-31 07:24:24,476 - INFO - Avg. fwd time: 16.4276 / Avg. bwd time: 25.2201 / Avg. batch time: 441.4019 (ms) / GPU bubble ratio: 24.52%
[rank3]:2025-10-31 07:24:24,446 - INFO - Avg. fwd time: 16.1477 / Avg. bwd time: 24.5663 / Avg. batch time: 349.1444 (ms) / GPU bubble ratio: 6.71%
[rank0]:2025-10-31 07:24:24,532 - INFO - Avg. fwd time: 14.2580 / Avg. bwd time: 21.7184 / Avg. batch time: 489.2083 (ms) / GPU bubble ratio: 41.17%
[rank0]:2025-10-31 07:25:58,220 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:26:00,152 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,529  tflops: 397.79  mfu: 40.22%
[rank1]:2025-10-31 07:26:00,153 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-31 07:26:00,166 - INFO -  step: 2200  loss:  2.2647  grad_norm:  0.7655  memory: 47.33GiB(33.85%)  tps: 8,529  tflops: 397.79  mfu: 40.22%
[rank3]:2025-10-31 07:26:00,167 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 07:26:00,187 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.7655  memory: 56.77GiB(40.60%)  tps: 8,529  tflops: 397.79  mfu: 40.22%
[rank0]:2025-10-31 07:26:00,187 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-10-31 07:26:00,171 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.7655  memory: 39.13GiB(27.99%)  tps: 8,529  tflops: 397.80  mfu: 40.22%
[rank2]:2025-10-31 07:26:00,171 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 07:26:16,431 - INFO - validate step: 2200  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,215
[rank1]:2025-10-31 07:26:16,463 - INFO - validate step: 2200  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 25,114
[rank3]:2025-10-31 07:26:16,488 - INFO - validate step: 2200  loss:  0.8718  memory: 47.33GiB(33.85%)  tps: 25,097
[rank2]:2025-10-31 07:26:16,480 - INFO - validate step: 2200  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,116
[rank2]:2025-10-31 07:26:16,568 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0726_stage2_step2200.svg
[rank1]:2025-10-31 07:26:16,572 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0726_stage1_step2200.svg
[rank0]:2025-10-31 07:26:16,569 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0726_stage0_step2200.svg
[rank3]:2025-10-31 07:26:16,676 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0726_real_step2200_rank3.svg
[rank3]:> Batch Time: 443.84 ms, GPU Bubble Ratio: 42.37%, 33.93%, 32.28%, 30.31%
[rank3]:2025-10-31 07:26:16,741 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0726_stage3_step2200.svg
[rank2]:2025-10-31 07:26:17,032 - INFO - Avg. fwd time: 14.2547 / Avg. bwd time: 24.4484 / Avg. batch time: 393.3412 (ms) / GPU bubble ratio: 21.28%
[rank1]:2025-10-31 07:26:17,033 - INFO - Avg. fwd time: 16.4419 / Avg. bwd time: 25.0812 / Avg. batch time: 440.6806 (ms) / GPU bubble ratio: 24.62%
[rank3]:2025-10-31 07:26:17,005 - INFO - Avg. fwd time: 16.1538 / Avg. bwd time: 24.5042 / Avg. batch time: 348.5250 (ms) / GPU bubble ratio: 6.67%
[rank0]:2025-10-31 07:26:17,088 - INFO - Avg. fwd time: 14.2595 / Avg. bwd time: 21.6358 / Avg. batch time: 488.5031 (ms) / GPU bubble ratio: 41.22%
[rank0]:2025-10-31 07:27:50,474 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 07:27:52,418 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.8770  memory: 56.77GiB(40.60%)  tps: 8,535  tflops: 398.05  mfu: 40.25%
[rank2]:2025-10-31 07:27:52,404 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.8770  memory: 39.13GiB(27.99%)  tps: 8,540  tflops: 398.31  mfu: 40.27%
[rank1]:2025-10-31 07:27:52,384 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,540  tflops: 398.33  mfu: 40.28%
[rank3]:2025-10-31 07:27:52,398 - INFO -  step: 2250  loss:  2.2246  grad_norm:  0.8770  memory: 47.33GiB(33.85%)  tps: 8,542  tflops: 398.38  mfu: 40.28%
[rank3]:2025-10-31 07:27:52,809 - INFO - Avg. fwd time: 16.1594 / Avg. bwd time: 24.4433 / Avg. batch time: 347.9170 (ms) / GPU bubble ratio: 6.64%
[rank0]:2025-10-31 07:27:52,940 - INFO - Avg. fwd time: 14.2612 / Avg. bwd time: 21.5563 / Avg. batch time: 487.8233 (ms) / GPU bubble ratio: 41.26%
[rank2]:2025-10-31 07:27:52,854 - INFO - Avg. fwd time: 14.2580 / Avg. bwd time: 24.4154 / Avg. batch time: 392.7674 (ms) / GPU bubble ratio: 21.23%
[rank1]:2025-10-31 07:27:52,895 - INFO - Avg. fwd time: 16.4554 / Avg. bwd time: 24.9468 / Avg. batch time: 439.9833 (ms) / GPU bubble ratio: 24.72%
[rank0]:2025-10-31 07:29:26,396 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 07:29:28,340 - INFO -  step: 2300  loss:  2.4996  grad_norm:  1.8851  memory: 47.33GiB(33.85%)  tps: 8,539  tflops: 398.24  mfu: 40.27%
[rank0]:2025-10-31 07:29:28,360 - INFO -  step: 2300  loss: -4.0000  grad_norm:  1.8851  memory: 56.77GiB(40.60%)  tps: 8,538  tflops: 398.24  mfu: 40.27%
[rank1]:2025-10-31 07:29:28,326 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,538  tflops: 398.24  mfu: 40.27%
[rank2]:2025-10-31 07:29:28,346 - INFO -  step: 2300  loss: -4.0000  grad_norm:  1.8851  memory: 39.13GiB(27.99%)  tps: 8,539  tflops: 398.24  mfu: 40.27%
[rank0]:2025-10-31 07:29:28,441 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0729_stage0_step2300.svg
[rank1]:2025-10-31 07:29:28,443 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0729_stage1_step2300.svg
[rank2]:2025-10-31 07:29:28,440 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0729_stage2_step2300.svg
[rank3]:2025-10-31 07:29:28,547 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0729_real_step2300_rank3.svg
[rank3]:> Batch Time: 443.90 ms, GPU Bubble Ratio: 41.73%, 34.03%, 32.27%, 30.32%
[rank3]:2025-10-31 07:29:28,611 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0729_stage3_step2300.svg
[rank1]:2025-10-31 07:29:28,904 - INFO - Avg. fwd time: 16.4671 / Avg. bwd time: 24.8353 / Avg. batch time: 439.4025 (ms) / GPU bubble ratio: 24.80%
[rank2]:2025-10-31 07:29:28,905 - INFO - Avg. fwd time: 14.2611 / Avg. bwd time: 24.3911 / Avg. batch time: 392.2940 (ms) / GPU bubble ratio: 21.18%
[rank3]:2025-10-31 07:29:28,876 - INFO - Avg. fwd time: 16.1641 / Avg. bwd time: 24.3950 / Avg. batch time: 347.4292 (ms) / GPU bubble ratio: 6.61%
[rank0]:2025-10-31 07:29:28,963 - INFO - Avg. fwd time: 14.2627 / Avg. bwd time: 21.4915 / Avg. batch time: 487.2551 (ms) / GPU bubble ratio: 41.30%
[rank0]:2025-10-31 07:31:02,863 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 07:31:04,795 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,492  tflops: 396.06  mfu: 40.05%
[rank3]:2025-10-31 07:31:04,809 - INFO -  step: 2350  loss:  2.1025  grad_norm:  2.0944  memory: 47.33GiB(33.85%)  tps: 8,492  tflops: 396.07  mfu: 40.05%
[rank0]:2025-10-31 07:31:04,829 - INFO -  step: 2350  loss: -4.0000  grad_norm:  2.0944  memory: 56.77GiB(40.60%)  tps: 8,492  tflops: 396.06  mfu: 40.05%
[rank2]:2025-10-31 07:31:04,819 - INFO -  step: 2350  loss: -4.0000  grad_norm:  2.0944  memory: 39.13GiB(27.99%)  tps: 8,492  tflops: 396.05  mfu: 40.05%
[rank1]:2025-10-31 07:31:05,167 - INFO - Avg. fwd time: 16.4800 / Avg. bwd time: 24.7119 / Avg. batch time: 438.8123 (ms) / GPU bubble ratio: 24.90%
[rank2]:2025-10-31 07:31:05,167 - INFO - Avg. fwd time: 14.2640 / Avg. bwd time: 24.3649 / Avg. batch time: 391.8101 (ms) / GPU bubble ratio: 21.13%
[rank3]:2025-10-31 07:31:05,139 - INFO - Avg. fwd time: 16.1688 / Avg. bwd time: 24.3454 / Avg. batch time: 346.9109 (ms) / GPU bubble ratio: 6.57%
[rank0]:2025-10-31 07:31:05,221 - INFO - Avg. fwd time: 14.2642 / Avg. bwd time: 21.4182 / Avg. batch time: 486.6783 (ms) / GPU bubble ratio: 41.35%
[rank1]:2025-10-31 07:32:21,674 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 07:32:22,489 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 07:32:36,919 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 07:32:37,463 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 07:32:38,413 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 07:32:40,365 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.2605  memory: 56.77GiB(40.60%)  tps: 8,575  tflops: 399.93  mfu: 40.44%
[rank0]:2025-10-31 07:32:40,365 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.2605  tps: 8,204  tflops: 382.65  mfu: 37.74%
[rank0]:2025-10-31 07:32:40,365 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-31 07:32:40,330 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 49.97GiB(35.74%)  tps: 8,575  tflops: 399.93  mfu: 40.44%
[rank1]:2025-10-31 07:32:40,331 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.0000  tps: 8,206  tflops: 382.72  mfu: 37.74%
[rank1]:2025-10-31 07:32:40,331 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-31 07:32:40,349 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.2605  memory: 39.13GiB(27.99%)  tps: 8,575  tflops: 399.96  mfu: 40.44%
[rank2]:2025-10-31 07:32:40,349 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.2605  tps: 8,206  tflops: 382.71  mfu: 37.74%
[rank2]:2025-10-31 07:32:40,349 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-10-31 07:32:40,345 - INFO -  step: 2400  loss:  2.0445  grad_norm:  0.2605  memory: 47.33GiB(33.85%)  tps: 8,575  tflops: 399.94  mfu: 40.44%
[rank3]:2025-10-31 07:32:40,345 - INFO -  final step: 2400  loss:  2.0445  grad_norm:  0.2605  tps: 8,208  tflops: 382.80  mfu: 37.75%
[rank3]:2025-10-31 07:32:40,346 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-31 07:32:56,588 - INFO - validate step: 2400  loss: -1.0000  memory: 49.97GiB(35.74%)  tps: 25,196
[rank1]:2025-10-31 07:32:56,588 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 07:32:56,557 - INFO - validate step: 2400  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,297
[rank0]:2025-10-31 07:32:56,558 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 07:32:56,563 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-31 07:32:56,591 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-31 07:32:56,605 - INFO - validate step: 2400  loss: -1.0000  memory: 39.13GiB(27.99%)  tps: 25,196
[rank2]:2025-10-31 07:32:56,606 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 07:32:56,609 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-31 07:32:56,614 - INFO - validate step: 2400  loss:  0.8932  memory: 47.33GiB(33.85%)  tps: 25,179
[rank3]:2025-10-31 07:32:56,614 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 07:32:56,619 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-31 07:33:06,993 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-31 07:33:07,083 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank1/251031_0733_stage1_final2400.svg
[rank0]:2025-10-31 07:33:07,083 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank0/251031_0733_stage0_final2400.svg
[rank2]:2025-10-31 07:33:07,079 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank2/251031_0733_stage2_final2400.svg
[rank3]:2025-10-31 07:33:07,185 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0733_real_final2400_rank3.svg
[rank3]:> Batch Time: 443.94 ms, GPU Bubble Ratio: 41.59%, 34.11%, 32.26%, 30.32%
[rank1]:2025-10-31 07:33:07,329 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/frozen_params_histogram/251031_0733_rank1_stage1.svg
[rank1]:	> Counts Sum: 2471360, Total Sum: 5520960 (44.76%), Ratio(%) per element: [41.96, 42.25, 41.19, 41.72, 41.37, 41.78, 43.25, 42.31, 41.6, 42.78, 42.66, 42.48, 42.31, 41.72, 43.07, 42.95, 43.25, 43.19, 43.07, 42.95, 42.54, 42.84, 42.84, 43.25, 42.66, 43.66, 43.25, 45.01, 44.48, 45.77, 45.89, 44.48, 46.12, 45.12, 45.18, 45.12, 46.53, 45.95, 46.36, 45.71, 45.83, 46.0, 45.71, 45.42, 46.47, 46.94, 46.3, 45.59, 45.95, 45.95, 46.3, 45.77, 46.71, 46.47, 46.06, 46.36, 45.77, 46.0, 45.18, 45.71, 46.42, 45.59, 45.83, 46.18, 46.0, 46.0, 45.3, 45.3, 45.42, 46.88, 45.07, 46.18, 46.12, 45.36, 47.0, 45.77, 45.95, 45.95, 46.59, 46.06, 45.36]
[rank1]:2025-10-31 07:33:07,329 - INFO - Destroying the purge thread.
[rank0]:2025-10-31 07:33:07,326 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/frozen_params_histogram/251031_0733_rank0_stage0.svg
[rank0]:	> Counts Sum: 3944760, Total Sum: 4975680 (79.28%), Ratio(%) per element: [84.33, 67.72, 68.3, 68.3, 68.83, 67.89, 67.48, 68.83, 68.25, 68.54, 72.3, 72.06, 71.59, 71.88, 72.35, 72.06, 71.36, 72.47, 72.24, 75.0, 75.46, 75.52, 75.76, 75.52, 74.47, 75.46, 75.7, 75.11, 81.16, 82.15, 82.33, 81.51, 81.74, 81.16, 81.39, 82.04, 81.69, 83.15, 83.68, 84.33, 83.74, 83.56, 83.97, 83.39, 83.97, 83.74, 83.5, 83.33, 84.5, 84.03, 84.56, 84.21, 84.27, 83.92, 84.74, 84.15, 84.15, 84.15, 83.86, 84.44, 84.09, 85.03, 84.38, 84.97, 84.56, 84.62, 83.45, 84.44, 84.62, 84.38, 83.86, 83.92, 83.5]
[rank0]:2025-10-31 07:33:07,326 - INFO - Sleeping 2 seconds for other ranks to complete
[rank2]:2025-10-31 07:33:07,307 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/frozen_params_histogram/251031_0733_rank2_stage2.svg
[rank2]:	> Counts Sum: 2385800, Total Sum: 4907520 (48.62%), Ratio(%) per element: [25.0, 25.52, 25.17, 26.23, 24.76, 25.82, 25.17, 24.64, 25.7, 31.8, 30.8, 32.1, 30.86, 31.33, 31.27, 30.45, 31.16, 29.34, 40.19, 41.25, 40.25, 41.9, 41.43, 41.37, 40.61, 40.25, 41.31, 53.34, 52.52, 52.17, 53.52, 51.29, 53.46, 53.46, 53.05, 51.93, 57.62, 57.21, 55.39, 56.1, 56.74, 56.16, 57.98, 56.33, 57.15, 60.68, 60.56, 60.03, 59.97, 60.32, 59.15, 59.62, 58.56, 60.26, 60.68, 61.5, 60.44, 61.03, 61.73, 59.62, 62.2, 60.91, 60.68, 61.5, 60.32, 60.79, 60.73, 62.2, 61.38, 61.73, 61.32, 60.91]
[rank2]:2025-10-31 07:33:07,307 - INFO - Destroying the purge thread.
[rank3]:2025-10-31 07:33:07,359 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/pipeline_schedule/251031_0733_thry_final2400_rank3.svg
[rank3]:> Batch Time: 512.18 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-31 07:33:07,425 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/freeze_ratio_history/rank3/251031_0733_stage3_final2400.svg
[rank3]:2025-10-31 07:33:07,650 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1/frozen_params_histogram/251031_0733_rank3_stage3.svg
[rank3]:	> Counts Sum: 522080, Total Sum: 4430400 (11.78%), Ratio(%) per element: [4.16, 4.81, 3.75, 4.28, 3.52, 4.04, 3.93, 4.16, 3.93, 4.75, 4.04, 3.99, 4.46, 3.81, 3.81, 3.87, 3.87, 4.04, 5.57, 6.16, 4.69, 4.92, 5.28, 5.51, 4.92, 5.22, 5.57, 6.27, 6.39, 5.69, 6.04, 5.75, 6.8, 5.57, 5.75, 6.1, 7.98, 8.03, 7.57, 7.57, 7.68, 7.8, 7.15, 8.39, 8.21, 8.56, 9.21, 8.97, 8.68, 8.97, 8.03, 9.33, 8.68, 9.03, 39.43, 39.31, 39.55, 40.72, 40.66, 40.72, 38.49, 40.19, 40.37, 40.43, 40.49]
[rank3]:2025-10-31 07:33:07,651 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.9962
[rank3]:wandb:               final/avg_loss 2.04446
[rank3]:wandb:             final/avg_mfu(%) 37.74625
[rank3]:wandb:             final/avg_tflops 382.80401
[rank3]:wandb:    final/avg_throughput(tps) 8207.60486
[rank3]:wandb:              final/grad_norm 0.26055
[rank3]:wandb:               final/max_loss 2.04446
[rank3]:wandb:                    grad_norm 0.26055
[rank3]:wandb: loss_metrics/global_avg_loss 2.04446
[rank3]:wandb: loss_metrics/global_max_loss 2.04446
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1030_1F1B_timelyauto_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/034sqyy6
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1030_1F1B_timelyauto_dm1/20251031-0608/wandb/run-20251031_060808-034sqyy6/logs
[rank0]:2025-10-31 07:33:09,326 - INFO - Training completed
[rank0]:2025-10-31 07:33:09,327 - INFO - Destroying the purge thread.
[rank1]:2025-10-31 07:33:09,491 - INFO - Process group destroyed
[rank2]:2025-10-31 07:33:09,506 - INFO - Process group destroyed
[rank0]:2025-10-31 07:33:09,627 - INFO - Process group destroyed
[rank3]:2025-10-31 07:33:09,714 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.5', 'tok_embeddings', 'layers.6', 'layers.2', 'layers.1', 'layers.4', 'layers.3', 'layers.7'}
[rank2]:Stage 2: Modules to keep: {'layers.18', 'layers.23', 'layers.19', 'layers.17', 'layers.24', 'layers.20', 'layers.22', 'layers.21'}
[rank1]:Stage 1: Modules to keep: {'layers.8', 'layers.12', 'layers.11', 'layers.13', 'layers.15', 'layers.10', 'layers.9', 'layers.16', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'layers.26', 'output', 'norm', 'layers.30', 'layers.29', 'layers.27', 'layers.28', 'layers.31'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_1F1B_timelyauto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1030_1F1B_timelyauto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1030_1F1B_timelyauto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_timelyauto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_timelyauto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_1F1B_timelyauto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_timelyauto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1030_1F1B_timelyauto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
