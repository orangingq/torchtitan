
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Oct 31 03:03:01 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1030_1F1B_fullrand7.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with fullrand7 x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=fullrand7
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1031 03:03:03.012000 3692810 site-packages/torch/distributed/run.py:811] 
W1031 03:03:03.012000 3692810 site-packages/torch/distributed/run.py:811] *****************************************
W1031 03:03:03.012000 3692810 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1031 03:03:03.012000 3692810 site-packages/torch/distributed/run.py:811] *****************************************
[rank1]:2025-10-31 03:03:10,042 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-31 03:03:10,123 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-31 03:03:10,153 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-31 03:03:10,326 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-31 03:03:10,811 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-31 03:03:10,813 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-10-31 03:03:10,998 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-31 03:03:11,001 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-10-31 03:03:10,994 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-31 03:03:10,997 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 03:03:11,299 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-31 03:03:11,301 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-31 03:03:11,307 - INFO - [GC] Initial GC collection 0.00 seconds
[rank0]:2025-10-31 03:03:12,991 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-31 03:03:13,265 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-31 03:03:14,810 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank2]:2025-10-31 03:03:16,476 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-10-31 03:03:16,510 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-10-31 03:03:16,568 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-31 03:03:16,568 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-10-31 03:03:16,586 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-31 03:03:16,586 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-10-31 03:03:16,808 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-31 03:03:16,808 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-31 03:03:16,796 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-10-31 03:03:16,828 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-31 03:03:16,829 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-10-31 03:03:17,058 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-31 03:03:17,107 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-10-31 03:03:17,131 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-31 03:03:17,131 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:2025-10-31 03:03:17,340 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-31 03:03:17,341 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: setting up run cywvnh5c
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_fullrand7_dm1/20251031-0303/wandb/run-20251031_030317-cywvnh5c
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_1F1B_fullrand7_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/cywvnh5c
[rank3]:2025-10-31 03:03:18,620 - INFO - WandB logging enabled
[rank3]:2025-10-31 03:03:18,621 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-31 03:03:18,697 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-31 03:03:18,697 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:2025-10-31 03:03:18,909 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-31 03:03:18,910 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank1]:2025-10-31 03:03:18,924 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-31 03:03:18,924 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 03:03:18,948 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_fullrand7_dm1
[rank0]:2025-10-31 03:03:18,948 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 03:03:18,948 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-10-31 03:03:18,924 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-31 03:03:22,436 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 300)
[rank0]:2025-10-31 03:03:22,437 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-31 03:03:31,494 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-10-31 03:03:31,494 - INFO - Finished loading the checkpoint in 9.06 seconds.
[rank0]:2025-10-31 03:03:31,494 - INFO - Training starts at step 1
[rank1]:2025-10-31 03:03:35,649 - INFO -  step:  1  loss: -4.0000  grad_norm: 288.5037  memory: 32.41GiB(23.18%)  tps: 858  tflops: 40.04  mfu: 4.05%
[rank1]:2025-10-31 03:03:35,649 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-31 03:03:35,669 - INFO -  step:  1  loss: -4.0000  grad_norm: 288.5037  memory: 37.59GiB(26.89%)  tps: 883  tflops: 41.17  mfu: 4.16%
[rank0]:2025-10-31 03:03:35,669 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-31 03:03:35,660 - INFO -  step:  1  loss: -4.0000  grad_norm: 288.5037  memory: 27.12GiB(19.40%)  tps: 857  tflops: 39.97  mfu: 4.04%
[rank2]:2025-10-31 03:03:35,660 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-31 03:03:35,692 - INFO -  step:  1  loss: 18.8920  grad_norm: 288.5037  memory: 35.49GiB(25.39%)  tps: 963  tflops: 44.90  mfu: 4.54%
[rank3]:2025-10-31 03:03:35,692 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-31 03:03:53,300 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,300 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,301 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,302 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,303 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-31 03:03:53,303 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,257 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,258 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,259 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,259 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,259 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,260 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,260 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,260 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,261 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,261 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,261 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-31 03:03:53,262 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,387 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,387 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,388 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,388 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,388 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,388 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,388 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,345 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,389 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,346 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,390 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,390 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:03:53,390 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-31 03:03:53,347 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-31 03:05:41,396 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:05:44,031 - INFO -  step: 50  loss: -4.0000  grad_norm: 218.4623  memory: 38.72GiB(27.69%)  tps: 6,254  tflops: 291.68  mfu: 29.49%
[rank3]:2025-10-31 03:05:44,035 - INFO -  step: 50  loss:  9.2976  grad_norm: 218.4623  memory: 46.16GiB(33.01%)  tps: 6,255  tflops: 291.75  mfu: 29.50%
[rank1]:2025-10-31 03:05:44,033 - INFO -  step: 50  loss: -4.0000  grad_norm: 218.4623  memory: 47.26GiB(33.80%)  tps: 6,253  tflops: 291.65  mfu: 29.49%
[rank0]:2025-10-31 03:05:44,037 - INFO -  step: 50  loss: -4.0000  grad_norm: 218.4623  memory: 54.93GiB(39.29%)  tps: 6,254  tflops: 291.69  mfu: 29.49%
[rank2]:2025-10-31 03:05:44,505 - INFO - Avg. fwd time: 12.9417 / Avg. bwd time: 35.8237 / Avg. batch time: 522.7281 (ms) / GPU bubble ratio: 25.37%
[rank3]:2025-10-31 03:05:44,475 - INFO - Avg. fwd time: 14.5146 / Avg. bwd time: 41.9666 / Avg. batch time: 471.0774 (ms) / GPU bubble ratio: 4.08%
[rank0]:2025-10-31 03:05:44,583 - INFO - Avg. fwd time: 13.2205 / Avg. bwd time: 38.1318 / Avg. batch time: 635.6949 (ms) / GPU bubble ratio: 35.37%
[rank1]:2025-10-31 03:05:44,551 - INFO - Avg. fwd time: 14.8351 / Avg. bwd time: 40.7472 / Avg. batch time: 580.9380 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-10-31 03:07:51,804 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:07:54,430 - INFO -  step: 100  loss: -4.0000  grad_norm: 17.3732  memory: 47.26GiB(33.80%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank1]:2025-10-31 03:07:54,430 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-31 03:07:54,427 - INFO -  step: 100  loss: -4.0000  grad_norm: 17.3732  memory: 38.72GiB(27.69%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank2]:2025-10-31 03:07:54,427 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 03:07:54,432 - INFO -  step: 100  loss:  3.1707  grad_norm: 17.3732  memory: 46.16GiB(33.01%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank3]:2025-10-31 03:07:54,432 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-31 03:07:54,434 - INFO -  step: 100  loss: -4.0000  grad_norm: 17.3732  memory: 54.93GiB(39.29%)  tps: 6,282  tflops: 293.01  mfu: 29.63%
[rank0]:2025-10-31 03:07:54,434 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-31 03:07:54,900 - INFO - Avg. fwd time: 12.9485 / Avg. bwd time: 35.9099 / Avg. batch time: 521.1320 (ms) / GPU bubble ratio: 25.00%
[rank3]:2025-10-31 03:07:54,871 - INFO - Avg. fwd time: 14.5132 / Avg. bwd time: 42.0194 / Avg. batch time: 469.4710 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-10-31 03:07:54,946 - INFO - Avg. fwd time: 14.8227 / Avg. bwd time: 40.8653 / Avg. batch time: 579.3323 (ms) / GPU bubble ratio: 23.10%
[rank0]:2025-10-31 03:07:54,978 - INFO - Avg. fwd time: 13.2320 / Avg. bwd time: 38.2942 / Avg. batch time: 634.1576 (ms) / GPU bubble ratio: 35.00%
[rank0]:2025-10-31 03:10:02,111 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:10:04,728 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.1810  memory: 38.72GiB(27.69%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank3]:2025-10-31 03:10:04,732 - INFO -  step: 150  loss:  2.3639  grad_norm:  4.1810  memory: 46.16GiB(33.01%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank1]:2025-10-31 03:10:04,730 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.1810  memory: 47.26GiB(33.80%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank0]:2025-10-31 03:10:04,734 - INFO -  step: 150  loss: -4.0000  grad_norm:  4.1810  memory: 54.93GiB(39.29%)  tps: 6,287  tflops: 293.23  mfu: 29.65%
[rank3]:2025-10-31 03:10:05,253 - INFO - Avg. fwd time: 14.4886 / Avg. bwd time: 41.9965 / Avg. batch time: 468.4801 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-31 03:10:05,337 - INFO - Avg. fwd time: 14.8302 / Avg. bwd time: 40.9070 / Avg. batch time: 578.3555 (ms) / GPU bubble ratio: 22.90%
[rank2]:2025-10-31 03:10:05,293 - INFO - Avg. fwd time: 12.9533 / Avg. bwd time: 35.9339 / Avg. batch time: 520.1441 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-10-31 03:10:05,381 - INFO - Avg. fwd time: 13.2497 / Avg. bwd time: 38.3664 / Avg. batch time: 633.2436 (ms) / GPU bubble ratio: 34.79%
[rank0]:2025-10-31 03:12:12,465 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:12:15,074 - INFO -  step: 200  loss: -4.0000  grad_norm: 32.4291  memory: 38.72GiB(27.69%)  tps: 6,285  tflops: 293.12  mfu: 29.64%
[rank2]:2025-10-31 03:12:15,074 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-10-31 03:12:15,076 - INFO -  step: 200  loss: -4.0000  grad_norm: 32.4291  memory: 47.26GiB(33.80%)  tps: 6,285  tflops: 293.12  mfu: 29.64%
[rank1]:2025-10-31 03:12:15,076 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-31 03:12:15,078 - INFO -  step: 200  loss:  3.2961  grad_norm: 32.4291  memory: 46.16GiB(33.01%)  tps: 6,285  tflops: 293.13  mfu: 29.64%
[rank3]:2025-10-31 03:12:15,079 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-31 03:12:15,081 - INFO -  step: 200  loss: -4.0000  grad_norm: 32.4291  memory: 54.93GiB(39.29%)  tps: 6,285  tflops: 293.12  mfu: 29.64%
[rank0]:2025-10-31 03:12:15,081 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-31 03:12:31,542 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,873
[rank2]:2025-10-31 03:12:31,543 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-31 03:12:31,532 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,892
[rank1]:2025-10-31 03:12:31,533 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 03:12:31,557 - INFO - validate step: 200  loss:  0.9097  memory: 46.16GiB(33.01%)  tps: 24,857
[rank3]:2025-10-31 03:12:31,558 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-31 03:12:31,502 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,944
[rank0]:2025-10-31 03:12:31,502 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-31 03:12:31,966 - INFO - Avg. fwd time: 14.4846 / Avg. bwd time: 41.9945 / Avg. batch time: 468.1732 (ms) / GPU bubble ratio: 3.49%
[rank2]:2025-10-31 03:12:31,997 - INFO - Avg. fwd time: 12.9615 / Avg. bwd time: 35.9444 / Avg. batch time: 519.8464 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-10-31 03:12:32,041 - INFO - Avg. fwd time: 14.8358 / Avg. bwd time: 40.9255 / Avg. batch time: 578.0672 (ms) / GPU bubble ratio: 22.83%
[rank0]:2025-10-31 03:12:32,073 - INFO - Avg. fwd time: 13.2638 / Avg. bwd time: 38.3939 / Avg. batch time: 632.9910 (ms) / GPU bubble ratio: 34.71%
[rank0]:2025-10-31 03:14:39,072 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 03:14:41,690 - INFO -  step: 250  loss: -4.0000  grad_norm:  6.9927  memory: 38.72GiB(27.69%)  tps: 6,294  tflops: 293.57  mfu: 29.68%
[rank1]:2025-10-31 03:14:41,693 - INFO -  step: 250  loss: -4.0000  grad_norm:  6.9927  memory: 47.26GiB(33.80%)  tps: 6,294  tflops: 293.54  mfu: 29.68%
[rank3]:2025-10-31 03:14:41,695 - INFO -  step: 250  loss:  2.3324  grad_norm:  6.9927  memory: 46.16GiB(33.01%)  tps: 6,295  tflops: 293.60  mfu: 29.69%
[rank0]:2025-10-31 03:14:41,697 - INFO -  step: 250  loss: -4.0000  grad_norm:  6.9927  memory: 54.93GiB(39.29%)  tps: 6,292  tflops: 293.46  mfu: 29.67%
[rank2]:2025-10-31 03:14:42,163 - INFO - Avg. fwd time: 12.9597 / Avg. bwd time: 35.9350 / Avg. batch time: 519.4199 (ms) / GPU bubble ratio: 24.69%
[rank3]:2025-10-31 03:14:42,133 - INFO - Avg. fwd time: 14.4761 / Avg. bwd time: 41.9746 / Avg. batch time: 467.7593 (ms) / GPU bubble ratio: 3.45%
[rank1]:2025-10-31 03:14:42,208 - INFO - Avg. fwd time: 14.8345 / Avg. bwd time: 40.9240 / Avg. batch time: 577.6198 (ms) / GPU bubble ratio: 22.77%
[rank0]:2025-10-31 03:14:42,241 - INFO - Avg. fwd time: 13.2698 / Avg. bwd time: 38.4030 / Avg. batch time: 632.5668 (ms) / GPU bubble ratio: 34.65%
[rank3]:2025-10-31 03:15:07,585 - INFO - [Step 260] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-10-31 03:15:33,590 - INFO - [Step 270] âœ”ï¸  Setting Upperbound
[rank3]:2025-10-31 03:15:33,801 - INFO - [Step 270] ã€°ï¸ Monitoring Lowerbound
[rank1]:2025-10-31 03:15:33,847 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:33,876 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:33,831 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:33,861 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:33,822 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:33,845 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:33,904 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:33,853 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:33,878 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:33,992 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:33,950 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:33,985 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:33,943 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:33,989 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,017 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:34,046 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:34,090 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:34,027 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:34,080 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:34,043 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:34,096 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,071 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:34,128 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:34,159 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-10-31 03:15:34,190 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:34,135 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-10-31 03:15:34,167 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:34,151 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,125 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,126 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,126 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-10-31 03:15:34,127 - WARNING - Batch index 1081 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-10-31 03:15:49,541 - INFO - [Step 280] âœ”ï¸  Setting Lowerbound
[rank3]:2025-10-31 03:15:49,775 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0315_max_batch_time.svg
[rank3]:> Batch Time: 615.00 ms, GPU Bubble Ratio: 32.39%, 27.22%, 36.15%, 26.47%
[rank3]:2025-10-31 03:15:49,953 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0315_min_batch_time.svg
[rank3]:> Batch Time: 345.74 ms, GPU Bubble Ratio: 69.22%, 23.68%, 33.08%, 23.53%
[rank3]:2025-10-31 03:15:50,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0315_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 364.33 ms, GPU Bubble Ratio: 22.68%, 17.53%, 24.94%, 22.33%
[rank3]:2025-10-31 03:15:50,167 - INFO - 	> Batch Time: 364.33 ms (Average Freeze Ratio: 0.72, Time Reduction Rate: 0.41)
[rank0]:2025-10-31 03:16:28,337 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:16:30,483 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.07/0.20
[rank1]:2025-10-31 03:16:30,607 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.14/0.41, [MB7] 0.33/1.00
[rank2]:2025-10-31 03:16:30,573 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.82, [MB1] 0.28/0.83, [MB2] 0.28/0.83, [MB3] 0.27/0.82, [MB4] 0.27/0.82, [MB5] 0.27/0.80, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank0]:2025-10-31 03:16:30,642 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.49, [MB1] 0.16/0.48, [MB2] 0.16/0.48, [MB3] 0.16/0.48, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.18/0.54, [MB7] 0.33/1.00
[rank1]:2025-10-31 03:16:30,664 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.7848  memory: 47.53GiB(34.00%)  tps: 7,518  tflops: 350.62  mfu: 35.45%
[rank1]:2025-10-31 03:16:30,755 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0316_stage1_step300.svg
[rank3]:2025-10-31 03:16:30,667 - INFO -  step: 300  loss:  2.6209  grad_norm:  1.7848  memory: 46.78GiB(33.46%)  tps: 7,518  tflops: 350.62  mfu: 35.45%
[rank2]:2025-10-31 03:16:30,662 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.7848  memory: 39.23GiB(28.06%)  tps: 7,518  tflops: 350.62  mfu: 35.45%
[rank2]:2025-10-31 03:16:30,752 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0316_stage2_step300.svg
[rank0]:2025-10-31 03:16:30,669 - INFO -  step: 300  loss: -4.0000  grad_norm:  1.7848  memory: 55.54GiB(39.72%)  tps: 7,518  tflops: 350.62  mfu: 35.45%
[rank0]:2025-10-31 03:16:30,751 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0316_stage0_step300.svg
[rank3]:2025-10-31 03:16:30,852 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0316_real_step300_rank3.svg
[rank3]:> Batch Time: 615.81 ms, GPU Bubble Ratio: 32.59%, 27.34%, 36.29%, 26.44%
[rank3]:2025-10-31 03:16:30,917 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0316_stage3_step300.svg
[rank1]:2025-10-31 03:16:31,433 - INFO - Avg. fwd time: 15.0195 / Avg. bwd time: 39.1583 / Avg. batch time: 562.0782 (ms) / GPU bubble ratio: 22.89%
[rank3]:2025-10-31 03:16:31,360 - INFO - Avg. fwd time: 14.6554 / Avg. bwd time: 40.1991 / Avg. batch time: 454.9315 (ms) / GPU bubble ratio: 3.54%
[rank2]:2025-10-31 03:16:31,395 - INFO - Avg. fwd time: 13.1224 / Avg. bwd time: 34.4881 / Avg. batch time: 505.6688 (ms) / GPU bubble ratio: 24.68%
[rank0]:2025-10-31 03:16:31,471 - INFO - Avg. fwd time: 13.4176 / Avg. bwd time: 36.0933 / Avg. batch time: 615.0653 (ms) / GPU bubble ratio: 35.60%
[rank0]:2025-10-31 03:18:17,740 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:18:19,653 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.13/0.20
[rank2]:2025-10-31 03:18:19,733 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.55/0.82, [MB1] 0.55/0.83, [MB2] 0.55/0.83, [MB3] 0.55/0.82, [MB4] 0.55/0.82, [MB5] 0.53/0.80, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank1]:2025-10-31 03:18:19,762 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.27/0.41, [MB7] 0.67/1.00
[rank1]:2025-10-31 03:18:19,813 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0128  memory: 48.53GiB(34.71%)  tps: 7,505  tflops: 350.05  mfu: 35.39%
[rank3]:2025-10-31 03:18:19,813 - INFO -  step: 350  loss:  2.1006  grad_norm:  1.0128  memory: 47.23GiB(33.78%)  tps: 7,506  tflops: 350.06  mfu: 35.40%
[rank2]:2025-10-31 03:18:19,812 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0128  memory: 39.23GiB(28.06%)  tps: 7,505  tflops: 350.05  mfu: 35.39%
[rank0]:2025-10-31 03:18:19,797 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.49, [MB1] 0.32/0.48, [MB2] 0.32/0.48, [MB3] 0.32/0.48, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.36/0.54, [MB7] 0.67/1.00
[rank0]:2025-10-31 03:18:19,822 - INFO -  step: 350  loss: -4.0000  grad_norm:  1.0128  memory: 56.67GiB(40.53%)  tps: 7,505  tflops: 350.04  mfu: 35.39%
[rank1]:2025-10-31 03:18:20,192 - INFO - Avg. fwd time: 15.1554 / Avg. bwd time: 37.8306 / Avg. batch time: 551.3375 (ms) / GPU bubble ratio: 23.12%
[rank3]:2025-10-31 03:18:20,162 - INFO - Avg. fwd time: 14.7696 / Avg. bwd time: 39.0469 / Avg. batch time: 446.5379 (ms) / GPU bubble ratio: 3.58%
[rank2]:2025-10-31 03:18:20,178 - INFO - Avg. fwd time: 13.2272 / Avg. bwd time: 33.5237 / Avg. batch time: 496.1958 (ms) / GPU bubble ratio: 24.63%
[rank0]:2025-10-31 03:18:20,222 - INFO - Avg. fwd time: 13.5009 / Avg. bwd time: 35.3451 / Avg. batch time: 603.7032 (ms) / GPU bubble ratio: 35.27%
[rank0]:2025-10-31 03:19:52,556 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:19:54,204 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank1]:2025-10-31 03:19:54,312 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:19:54,294 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.82/0.82, [MB1] 0.83/0.83, [MB2] 0.83/0.83, [MB3] 0.82/0.82, [MB4] 0.82/0.82, [MB5] 0.80/0.80, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:19:54,342 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1497  memory: 48.53GiB(34.71%)  tps: 8,666  tflops: 404.19  mfu: 40.87%
[rank1]:2025-10-31 03:19:54,342 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-31 03:19:54,344 - INFO -  step: 400  loss:  2.6989  grad_norm:  0.1497  memory: 47.23GiB(33.78%)  tps: 8,666  tflops: 404.18  mfu: 40.87%
[rank3]:2025-10-31 03:19:54,345 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-31 03:19:54,348 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1497  memory: 39.23GiB(28.06%)  tps: 8,666  tflops: 404.16  mfu: 40.87%
[rank2]:2025-10-31 03:19:54,348 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 03:19:54,342 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.49/0.49, [MB1] 0.48/0.48, [MB2] 0.48/0.48, [MB3] 0.48/0.48, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.54/0.54, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:19:54,360 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.1497  memory: 56.77GiB(40.60%)  tps: 8,665  tflops: 404.15  mfu: 40.86%
[rank0]:2025-10-31 03:19:54,360 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-10-31 03:20:10,320 - INFO - validate step: 400  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,664
[rank1]:2025-10-31 03:20:10,353 - INFO - validate step: 400  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 25,584
[rank3]:2025-10-31 03:20:10,370 - INFO - validate step: 400  loss:  0.9391  memory: 47.23GiB(33.78%)  tps: 25,561
[rank2]:2025-10-31 03:20:10,369 - INFO - validate step: 400  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 25,568
[rank0]:2025-10-31 03:20:10,448 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0320_stage0_step400.svg
[rank1]:2025-10-31 03:20:10,449 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0320_stage1_step400.svg
[rank2]:2025-10-31 03:20:10,450 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0320_stage2_step400.svg
[rank3]:2025-10-31 03:20:10,552 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0320_real_step400_rank3.svg
[rank3]:> Batch Time: 614.94 ms, GPU Bubble Ratio: 32.50%, 27.30%, 36.16%, 26.43%
[rank3]:2025-10-31 03:20:10,621 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0320_stage3_step400.svg
[rank1]:2025-10-31 03:20:10,896 - INFO - Avg. fwd time: 15.3734 / Avg. bwd time: 35.8050 / Avg. batch time: 533.6937 (ms) / GPU bubble ratio: 23.28%
[rank3]:2025-10-31 03:20:10,877 - INFO - Avg. fwd time: 14.9738 / Avg. bwd time: 37.1009 / Avg. batch time: 432.5205 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-31 03:20:10,892 - INFO - Avg. fwd time: 13.4077 / Avg. bwd time: 31.9686 / Avg. batch time: 480.6322 (ms) / GPU bubble ratio: 24.47%
[rank0]:2025-10-31 03:20:10,922 - INFO - Avg. fwd time: 13.6449 / Avg. bwd time: 33.7156 / Avg. batch time: 584.8003 (ms) / GPU bubble ratio: 35.21%
[rank0]:2025-10-31 03:21:36,245 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 03:21:37,913 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-10-31 03:21:37,980 - INFO -  step: 450  loss:  2.1114  grad_norm:  0.0000  memory: 47.23GiB(33.78%)  tps: 9,351  tflops: 436.12  mfu: 44.10%
[rank2]:2025-10-31 03:21:37,933 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.82/0.82, [MB1] 0.83/0.83, [MB2] 0.83/0.83, [MB3] 0.82/0.82, [MB4] 0.82/0.82, [MB5] 0.80/0.80, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:21:37,985 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.6310  memory: 39.23GiB(28.06%)  tps: 9,350  tflops: 436.08  mfu: 44.09%
[rank1]:2025-10-31 03:21:37,950 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.41/0.41, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:21:37,979 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,349  tflops: 436.03  mfu: 44.09%
[rank0]:2025-10-31 03:21:37,979 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.49/0.49, [MB1] 0.48/0.48, [MB2] 0.48/0.48, [MB3] 0.48/0.48, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.54/0.54, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:21:38,000 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.6310  memory: 56.77GiB(40.60%)  tps: 9,343  tflops: 435.77  mfu: 44.06%
[rank3]:2025-10-31 03:21:38,376 - INFO - Avg. fwd time: 15.1910 / Avg. bwd time: 35.1334 / Avg. batch time: 418.4500 (ms) / GPU bubble ratio: 3.79%
[rank2]:2025-10-31 03:21:38,400 - INFO - Avg. fwd time: 13.5922 / Avg. bwd time: 30.3629 / Avg. batch time: 465.0453 (ms) / GPU bubble ratio: 24.39%
[rank1]:2025-10-31 03:21:38,423 - INFO - Avg. fwd time: 15.5731 / Avg. bwd time: 33.7469 / Avg. batch time: 516.0323 (ms) / GPU bubble ratio: 23.54%
[rank0]:2025-10-31 03:21:38,453 - INFO - Avg. fwd time: 13.8012 / Avg. bwd time: 31.2699 / Avg. batch time: 565.8525 (ms) / GPU bubble ratio: 36.28%
[rank0]:2025-10-31 03:23:04,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:23:05,905 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0323_rank1_trend_line.svg
[rank1]:2025-10-31 03:23:05,940 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.22/0.22, [MB1] 0.81/0.81, [MB2] 0.71/0.71, [MB3] 0.40/0.40, [MB4] 0.38/0.38, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:23:05,941 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.22/0.22, [MB1] 0.81/0.81, [MB2] 0.71/0.71, [MB3] 0.40/0.40, [MB4] 0.38/0.38, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:23:05,942 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,313  tflops: 434.36  mfu: 43.92%
[rank3]:2025-10-31 03:23:05,894 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0323_rank3_trend_line.svg
[rank2]:2025-10-31 03:23:05,900 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0323_rank2_trend_line.svg
[rank2]:2025-10-31 03:23:05,940 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.36/0.36, [MB4] 0.09/0.09, [MB5] 0.06/0.06, [MB6] 0.14/0.14, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:23:05,941 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.46/0.46, [MB2] 0.46/0.46, [MB3] 0.36/0.36, [MB4] 0.09/0.09, [MB5] 0.06/0.06, [MB6] 0.14/0.14, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:23:05,942 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1536  memory: 39.23GiB(28.06%)  tps: 9,314  tflops: 434.39  mfu: 43.92%
[rank0]:2025-10-31 03:23:05,933 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0323_rank0_trend_line.svg
[rank0]:2025-10-31 03:23:05,940 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.22/0.22, [MB1] 0.15/0.15, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:23:05,941 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.22/0.22, [MB1] 0.15/0.15, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.39/0.39, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:23:05,941 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1536  memory: 56.77GiB(40.60%)  tps: 9,315  tflops: 434.47  mfu: 43.93%
[rank3]:2025-10-31 03:23:06,131 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0323_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 386.38 ms, GPU Bubble Ratio: 26.59%, 19.91%, 25.85%, 23.95%
[rank3]:2025-10-31 03:23:06,132 - INFO - 	> Batch Time: 386.38 ms (Average Freeze Ratio: 0.50)
[rank3]:2025-10-31 03:23:06,132 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.91/0.91, [MB5] 0.65/0.65, [MB6] 0.64/0.64, [MB7] 1.00/1.00
[rank3]:2025-10-31 03:23:06,133 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.91/0.91, [MB5] 0.65/0.65, [MB6] 0.64/0.64, [MB7] 1.00/1.00
[rank3]:2025-10-31 03:23:06,136 - INFO -  step: 500  loss:  1.9728  grad_norm:  0.0000  memory: 47.23GiB(33.78%)  tps: 9,293  tflops: 433.41  mfu: 43.82%
[rank1]:2025-10-31 03:23:06,204 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0323_stage1_step500.svg
[rank2]:2025-10-31 03:23:06,204 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0323_stage2_step500.svg
[rank0]:2025-10-31 03:23:06,204 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0323_stage0_step500.svg
[rank3]:2025-10-31 03:23:06,315 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0323_real_step500_rank3.svg
[rank3]:> Batch Time: 608.96 ms, GPU Bubble Ratio: 32.86%, 27.46%, 36.28%, 26.60%
[rank3]:2025-10-31 03:23:06,377 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0323_stage3_step500.svg
[rank3]:2025-10-31 03:23:06,650 - INFO - Avg. fwd time: 15.3396 / Avg. bwd time: 33.7807 / Avg. batch time: 408.7719 (ms) / GPU bubble ratio: 3.87%
[rank1]:2025-10-31 03:23:06,692 - INFO - Avg. fwd time: 15.7075 / Avg. bwd time: 32.3212 / Avg. batch time: 503.8654 (ms) / GPU bubble ratio: 23.74%
[rank2]:2025-10-31 03:23:06,681 - INFO - Avg. fwd time: 13.7179 / Avg. bwd time: 29.2502 / Avg. batch time: 454.3133 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-10-31 03:23:06,750 - INFO - Avg. fwd time: 13.9039 / Avg. bwd time: 29.5938 / Avg. batch time: 552.8727 (ms) / GPU bubble ratio: 37.06%
[rank0]:2025-10-31 03:24:41,093 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:24:43,058 - INFO -  step: 550  loss:  2.3834  grad_norm:  1.5774  memory: 47.23GiB(33.78%)  tps: 8,452  tflops: 394.22  mfu: 39.86%
[rank1]:2025-10-31 03:24:43,066 - INFO -  step: 550  loss: -4.0000  grad_norm:  1.5774  memory: 48.53GiB(34.71%)  tps: 8,435  tflops: 393.39  mfu: 39.78%
[rank0]:2025-10-31 03:24:43,076 - INFO -  step: 550  loss: -4.0000  grad_norm:  1.5774  memory: 56.77GiB(40.60%)  tps: 8,434  tflops: 393.35  mfu: 39.77%
[rank2]:2025-10-31 03:24:43,069 - INFO -  step: 550  loss: -4.0000  grad_norm:  1.5774  memory: 39.23GiB(28.06%)  tps: 8,434  tflops: 393.38  mfu: 39.78%
[rank3]:2025-10-31 03:24:43,375 - INFO - Avg. fwd time: 15.4624 / Avg. bwd time: 32.4563 / Avg. batch time: 400.3763 (ms) / GPU bubble ratio: 4.25%
[rank1]:2025-10-31 03:24:43,417 - INFO - Avg. fwd time: 15.7906 / Avg. bwd time: 31.5110 / Avg. batch time: 495.0765 (ms) / GPU bubble ratio: 23.56%
[rank2]:2025-10-31 03:24:43,406 - INFO - Avg. fwd time: 13.7784 / Avg. bwd time: 28.7136 / Avg. batch time: 445.9381 (ms) / GPU bubble ratio: 23.77%
[rank0]:2025-10-31 03:24:43,473 - INFO - Avg. fwd time: 13.9685 / Avg. bwd time: 28.3417 / Avg. batch time: 544.0755 (ms) / GPU bubble ratio: 37.79%
[rank0]:2025-10-31 03:26:17,454 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:26:19,557 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0326_rank1_trend_line.svg
[rank1]:2025-10-31 03:26:19,590 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.50/0.50, [MB1] 0.97/0.97, [MB2] 0.98/0.98, [MB3] 0.52/0.52, [MB4] 0.27/0.27, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:26:19,592 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2034  memory: 48.53GiB(34.71%)  tps: 8,487  tflops: 395.83  mfu: 40.02%
[rank3]:2025-10-31 03:26:19,539 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0326_rank3_trend_line.svg
[rank1]:2025-10-31 03:26:19,592 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 03:26:19,583 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0326_rank0_trend_line.svg
[rank0]:2025-10-31 03:26:19,590 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:26:19,591 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2034  memory: 56.77GiB(40.60%)  tps: 8,488  tflops: 395.88  mfu: 40.03%
[rank0]:2025-10-31 03:26:19,591 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-31 03:26:19,560 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0326_rank2_trend_line.svg
[rank2]:2025-10-31 03:26:19,590 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.60/0.60, [MB2] 0.59/0.59, [MB3] 0.60/0.60, [MB4] 0.22/0.22, [MB5] 0.00/0.00, [MB6] 0.17/0.17, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:26:19,592 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.2034  memory: 39.23GiB(28.06%)  tps: 8,487  tflops: 395.84  mfu: 40.02%
[rank2]:2025-10-31 03:26:19,592 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-31 03:26:19,781 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0326_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 389.67 ms, GPU Bubble Ratio: 32.78%, 22.06%, 27.18%, 26.25%
[rank3]:2025-10-31 03:26:19,781 - INFO - 	> Batch Time: 389.67 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-10-31 03:26:19,782 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.68/0.68, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank3]:2025-10-31 03:26:19,787 - INFO -  step: 600  loss:  2.4398  grad_norm:  0.2034  memory: 47.23GiB(33.78%)  tps: 8,469  tflops: 395.00  mfu: 39.94%
[rank3]:2025-10-31 03:26:19,787 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-31 03:26:36,243 - INFO - validate step: 600  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,599
[rank3]:2025-10-31 03:26:36,298 - INFO - validate step: 600  loss:  0.9174  memory: 47.23GiB(33.78%)  tps: 24,809
[rank1]:2025-10-31 03:26:36,277 - INFO - validate step: 600  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 24,549
[rank2]:2025-10-31 03:26:36,292 - INFO - validate step: 600  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,526
[rank1]:2025-10-31 03:26:36,371 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0326_stage1_step600.svg
[rank0]:2025-10-31 03:26:36,374 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0326_stage0_step600.svg
[rank2]:2025-10-31 03:26:36,370 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0326_stage2_step600.svg
[rank3]:2025-10-31 03:26:36,476 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0326_real_step600_rank3.svg
[rank3]:> Batch Time: 520.20 ms, GPU Bubble Ratio: 29.31%, 26.78%, 33.57%, 27.29%
[rank3]:2025-10-31 03:26:36,540 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0326_stage3_step600.svg
[rank3]:2025-10-31 03:26:36,876 - INFO - Avg. fwd time: 15.5618 / Avg. bwd time: 31.3729 / Avg. batch time: 393.3962 (ms) / GPU bubble ratio: 4.55%
[rank2]:2025-10-31 03:26:36,914 - INFO - Avg. fwd time: 13.8230 / Avg. bwd time: 28.3164 / Avg. batch time: 439.0502 (ms) / GPU bubble ratio: 23.22%
[rank1]:2025-10-31 03:26:36,951 - INFO - Avg. fwd time: 15.8587 / Avg. bwd time: 30.8649 / Avg. batch time: 487.8698 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-10-31 03:26:36,989 - INFO - Avg. fwd time: 14.0180 / Avg. bwd time: 27.3379 / Avg. batch time: 536.9682 (ms) / GPU bubble ratio: 38.39%
[rank0]:2025-10-31 03:28:10,796 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:28:12,707 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3188  memory: 48.53GiB(34.71%)  tps: 8,495  tflops: 396.22  mfu: 40.06%
[rank3]:2025-10-31 03:28:12,699 - INFO -  step: 650  loss:  2.2143  grad_norm:  0.3188  memory: 47.23GiB(33.78%)  tps: 8,498  tflops: 396.35  mfu: 40.08%
[rank0]:2025-10-31 03:28:12,721 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3188  memory: 56.77GiB(40.60%)  tps: 8,491  tflops: 396.02  mfu: 40.04%
[rank2]:2025-10-31 03:28:12,710 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.3188  memory: 39.23GiB(28.06%)  tps: 8,496  tflops: 396.27  mfu: 40.07%
[rank3]:2025-10-31 03:28:13,017 - INFO - Avg. fwd time: 15.6367 / Avg. bwd time: 30.6063 / Avg. batch time: 388.1683 (ms) / GPU bubble ratio: 4.69%
[rank2]:2025-10-31 03:28:13,040 - INFO - Avg. fwd time: 13.8699 / Avg. bwd time: 27.9241 / Avg. batch time: 433.8916 (ms) / GPU bubble ratio: 22.94%
[rank1]:2025-10-31 03:28:13,046 - INFO - Avg. fwd time: 15.9270 / Avg. bwd time: 30.2740 / Avg. batch time: 482.6412 (ms) / GPU bubble ratio: 23.42%
[rank0]:2025-10-31 03:28:13,110 - INFO - Avg. fwd time: 14.0468 / Avg. bwd time: 26.7063 / Avg. batch time: 531.6992 (ms) / GPU bubble ratio: 38.68%
[rank0]:2025-10-31 03:29:46,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:29:48,169 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.8790  memory: 48.53GiB(34.71%)  tps: 8,581  tflops: 400.24  mfu: 40.47%
[rank0]:2025-10-31 03:29:48,187 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.8790  memory: 56.77GiB(40.60%)  tps: 8,581  tflops: 400.22  mfu: 40.47%
[rank3]:2025-10-31 03:29:48,163 - INFO -  step: 700  loss:  2.6142  grad_norm:  1.8790  memory: 47.23GiB(33.78%)  tps: 8,581  tflops: 400.24  mfu: 40.47%
[rank2]:2025-10-31 03:29:48,176 - INFO -  step: 700  loss: -4.0000  grad_norm:  1.8790  memory: 39.23GiB(28.06%)  tps: 8,581  tflops: 400.23  mfu: 40.47%
[rank1]:2025-10-31 03:29:48,263 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0329_stage1_step700.svg
[rank0]:2025-10-31 03:29:48,261 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0329_stage0_step700.svg
[rank2]:2025-10-31 03:29:48,263 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0329_stage2_step700.svg
[rank3]:2025-10-31 03:29:48,363 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0329_real_step700_rank3.svg
[rank3]:> Batch Time: 486.00 ms, GPU Bubble Ratio: 31.82%, 30.07%, 33.51%, 30.15%
[rank3]:2025-10-31 03:29:48,430 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0329_stage3_step700.svg
[rank3]:2025-10-31 03:29:48,682 - INFO - Avg. fwd time: 15.7128 / Avg. bwd time: 29.8133 / Avg. batch time: 382.6183 (ms) / GPU bubble ratio: 4.81%
[rank2]:2025-10-31 03:29:48,707 - INFO - Avg. fwd time: 13.9150 / Avg. bwd time: 27.4966 / Avg. batch time: 428.4064 (ms) / GPU bubble ratio: 22.67%
[rank1]:2025-10-31 03:29:48,713 - INFO - Avg. fwd time: 15.9930 / Avg. bwd time: 29.6663 / Avg. batch time: 477.0825 (ms) / GPU bubble ratio: 23.44%
[rank0]:2025-10-31 03:29:48,774 - INFO - Avg. fwd time: 14.0725 / Avg. bwd time: 26.0712 / Avg. batch time: 526.0919 (ms) / GPU bubble ratio: 38.96%
[rank0]:2025-10-31 03:31:22,442 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:31:24,367 - INFO -  step: 750  loss:  2.6280  grad_norm:  0.2910  memory: 47.23GiB(33.78%)  tps: 8,515  tflops: 397.16  mfu: 40.16%
[rank2]:2025-10-31 03:31:24,380 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2910  memory: 39.23GiB(28.06%)  tps: 8,515  tflops: 397.15  mfu: 40.16%
[rank1]:2025-10-31 03:31:24,375 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2910  memory: 48.53GiB(34.71%)  tps: 8,515  tflops: 397.14  mfu: 40.16%
[rank0]:2025-10-31 03:31:24,390 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2910  memory: 56.77GiB(40.60%)  tps: 8,515  tflops: 397.16  mfu: 40.16%
[rank3]:2025-10-31 03:31:24,774 - INFO - Avg. fwd time: 15.7773 / Avg. bwd time: 29.1486 / Avg. batch time: 378.0668 (ms) / GPU bubble ratio: 4.94%
[rank1]:2025-10-31 03:31:24,849 - INFO - Avg. fwd time: 16.0529 / Avg. bwd time: 29.1513 / Avg. batch time: 472.5533 (ms) / GPU bubble ratio: 23.47%
[rank2]:2025-10-31 03:31:24,811 - INFO - Avg. fwd time: 13.9536 / Avg. bwd time: 27.1486 / Avg. batch time: 423.9544 (ms) / GPU bubble ratio: 22.44%
[rank0]:2025-10-31 03:31:24,887 - INFO - Avg. fwd time: 14.0962 / Avg. bwd time: 25.5253 / Avg. batch time: 521.5245 (ms) / GPU bubble ratio: 39.22%
[rank0]:2025-10-31 03:32:58,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:33:00,482 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0333_rank3_trend_line.svg
[rank1]:2025-10-31 03:33:00,517 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0333_rank1_trend_line.svg
[rank2]:2025-10-31 03:33:00,502 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0333_rank2_trend_line.svg
[rank2]:2025-10-31 03:33:00,558 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.68/0.68, [MB2] 0.50/0.50, [MB3] 0.50/0.50, [MB4] 0.49/0.49, [MB5] 0.01/0.01, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:33:00,560 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1836  memory: 39.23GiB(28.06%)  tps: 8,517  tflops: 397.25  mfu: 40.17%
[rank2]:2025-10-31 03:33:00,560 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-31 03:33:00,552 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0333_rank0_trend_line.svg
[rank0]:2025-10-31 03:33:00,558 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-10-31 03:33:00,560 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1836  memory: 56.77GiB(40.60%)  tps: 8,518  tflops: 397.30  mfu: 40.17%
[rank0]:2025-10-31 03:33:00,560 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 03:33:00,558 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.78/0.78, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.25/0.25, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:33:00,560 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1836  memory: 48.53GiB(34.71%)  tps: 8,517  tflops: 397.24  mfu: 40.17%
[rank1]:2025-10-31 03:33:00,560 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-31 03:33:00,748 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0333_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 388.27 ms, GPU Bubble Ratio: 36.83%, 23.52%, 26.96%, 26.96%
[rank3]:2025-10-31 03:33:00,748 - INFO - 	> Batch Time: 388.27 ms (Average Freeze Ratio: 0.51)
[rank3]:2025-10-31 03:33:00,749 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.89/0.89, [MB4] 0.88/0.88, [MB5] 0.87/0.87, [MB6] 0.56/0.56, [MB7] 1.00/1.00
[rank3]:2025-10-31 03:33:00,754 - INFO -  step: 800  loss:  2.6415  grad_norm:  0.1836  memory: 47.23GiB(33.78%)  tps: 8,499  tflops: 396.40  mfu: 40.08%
[rank3]:2025-10-31 03:33:00,754 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-10-31 03:33:17,117 - INFO - validate step: 800  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 24,739
[rank0]:2025-10-31 03:33:17,085 - INFO - validate step: 800  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,788
[rank2]:2025-10-31 03:33:17,134 - INFO - validate step: 800  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,713
[rank3]:2025-10-31 03:33:17,142 - INFO - validate step: 800  loss:  0.8580  memory: 47.23GiB(33.78%)  tps: 24,995
[rank1]:2025-10-31 03:33:17,222 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0333_stage1_step800.svg
[rank0]:2025-10-31 03:33:17,223 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0333_stage0_step800.svg
[rank2]:2025-10-31 03:33:17,223 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0333_stage2_step800.svg
[rank3]:2025-10-31 03:33:17,314 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0333_real_step800_rank3.svg
[rank3]:> Batch Time: 467.55 ms, GPU Bubble Ratio: 43.84%, 30.59%, 34.28%, 32.68%
[rank3]:2025-10-31 03:33:17,384 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0333_stage3_step800.svg
[rank2]:2025-10-31 03:33:17,668 - INFO - Avg. fwd time: 13.9837 / Avg. bwd time: 26.8827 / Avg. batch time: 420.4758 (ms) / GPU bubble ratio: 22.25%
[rank3]:2025-10-31 03:33:17,644 - INFO - Avg. fwd time: 15.8253 / Avg. bwd time: 28.6383 / Avg. batch time: 374.5489 (ms) / GPU bubble ratio: 5.03%
[rank1]:2025-10-31 03:33:17,670 - INFO - Avg. fwd time: 16.0972 / Avg. bwd time: 28.7625 / Avg. batch time: 469.0488 (ms) / GPU bubble ratio: 23.49%
[rank0]:2025-10-31 03:33:17,729 - INFO - Avg. fwd time: 14.1139 / Avg. bwd time: 25.1155 / Avg. batch time: 517.9936 (ms) / GPU bubble ratio: 39.41%
[rank0]:2025-10-31 03:34:59,560 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:35:01,638 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,838  tflops: 365.55  mfu: 36.96%
[rank2]:2025-10-31 03:35:01,652 - INFO -  step: 850  loss: -4.0000  grad_norm:  2.5676  memory: 39.23GiB(28.06%)  tps: 7,838  tflops: 365.56  mfu: 36.96%
[rank3]:2025-10-31 03:35:01,642 - INFO -  step: 850  loss:  2.9272  grad_norm:  2.5676  memory: 47.23GiB(33.78%)  tps: 7,839  tflops: 365.63  mfu: 36.97%
[rank0]:2025-10-31 03:35:01,665 - INFO -  step: 850  loss: -4.0000  grad_norm:  2.5676  memory: 56.77GiB(40.60%)  tps: 7,833  tflops: 365.34  mfu: 36.94%
[rank3]:2025-10-31 03:35:01,988 - INFO - Avg. fwd time: 15.8695 / Avg. bwd time: 28.0953 / Avg. batch time: 372.9279 (ms) / GPU bubble ratio: 5.69%
[rank1]:2025-10-31 03:35:02,028 - INFO - Avg. fwd time: 16.1479 / Avg. bwd time: 28.2312 / Avg. batch time: 467.4555 (ms) / GPU bubble ratio: 24.05%
[rank2]:2025-10-31 03:35:02,025 - INFO - Avg. fwd time: 14.0140 / Avg. bwd time: 26.5853 / Avg. batch time: 418.9229 (ms) / GPU bubble ratio: 22.47%
[rank0]:2025-10-31 03:35:02,088 - INFO - Avg. fwd time: 14.0805 / Avg. bwd time: 25.8604 / Avg. batch time: 516.7673 (ms) / GPU bubble ratio: 38.17%
[rank0]:2025-10-31 03:36:44,033 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:36:46,119 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,841  tflops: 365.69  mfu: 36.98%
[rank2]:2025-10-31 03:36:46,133 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3491  memory: 39.23GiB(28.06%)  tps: 7,841  tflops: 365.69  mfu: 36.98%
[rank3]:2025-10-31 03:36:46,121 - INFO -  step: 900  loss:  2.0684  grad_norm:  0.3491  memory: 47.23GiB(33.78%)  tps: 7,841  tflops: 365.70  mfu: 36.98%
[rank1]:2025-10-31 03:36:46,217 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0336_stage1_step900.svg
[rank0]:2025-10-31 03:36:46,146 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.3491  memory: 56.77GiB(40.60%)  tps: 7,841  tflops: 365.69  mfu: 36.98%
[rank0]:2025-10-31 03:36:46,216 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0336_stage0_step900.svg
[rank2]:2025-10-31 03:36:46,217 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0336_stage2_step900.svg
[rank3]:2025-10-31 03:36:46,322 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0336_real_step900_rank3.svg
[rank3]:> Batch Time: 462.85 ms, GPU Bubble Ratio: 28.44%, 30.88%, 34.67%, 32.66%
[rank3]:2025-10-31 03:36:46,383 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0336_stage3_step900.svg
[rank2]:2025-10-31 03:36:46,779 - INFO - Avg. fwd time: 14.0407 / Avg. bwd time: 26.3034 / Avg. batch time: 417.7962 (ms) / GPU bubble ratio: 22.75%
[rank3]:2025-10-31 03:36:46,742 - INFO - Avg. fwd time: 15.9049 / Avg. bwd time: 27.6344 / Avg. batch time: 371.7474 (ms) / GPU bubble ratio: 6.30%
[rank1]:2025-10-31 03:36:46,816 - INFO - Avg. fwd time: 16.1916 / Avg. bwd time: 27.7543 / Avg. batch time: 466.3136 (ms) / GPU bubble ratio: 24.61%
[rank0]:2025-10-31 03:36:46,862 - INFO - Avg. fwd time: 14.0438 / Avg. bwd time: 26.6326 / Avg. batch time: 515.9796 (ms) / GPU bubble ratio: 36.93%
[rank0]:2025-10-31 03:38:28,502 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:38:30,591 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,841  tflops: 365.72  mfu: 36.98%
[rank3]:2025-10-31 03:38:30,594 - INFO -  step: 950  loss:  2.6673  grad_norm:  0.7633  memory: 47.23GiB(33.78%)  tps: 7,841  tflops: 365.72  mfu: 36.98%
[rank2]:2025-10-31 03:38:30,607 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7633  memory: 39.23GiB(28.06%)  tps: 7,841  tflops: 365.72  mfu: 36.98%
[rank0]:2025-10-31 03:38:30,618 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.7633  memory: 56.77GiB(40.60%)  tps: 7,841  tflops: 365.72  mfu: 36.98%
[rank1]:2025-10-31 03:38:30,978 - INFO - Avg. fwd time: 16.2254 / Avg. bwd time: 27.3812 / Avg. batch time: 465.3469 (ms) / GPU bubble ratio: 25.03%
[rank3]:2025-10-31 03:38:30,938 - INFO - Avg. fwd time: 15.9356 / Avg. bwd time: 27.2705 / Avg. batch time: 370.8302 (ms) / GPU bubble ratio: 6.79%
[rank2]:2025-10-31 03:38:30,976 - INFO - Avg. fwd time: 14.0598 / Avg. bwd time: 26.0990 / Avg. batch time: 416.8858 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-10-31 03:38:31,037 - INFO - Avg. fwd time: 14.0148 / Avg. bwd time: 27.2254 / Avg. batch time: 515.2824 (ms) / GPU bubble ratio: 35.97%
[rank0]:2025-10-31 03:40:12,762 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:40:14,846 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,858  tflops: 366.48  mfu: 37.06%
[rank1]:2025-10-31 03:40:14,846 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-31 03:40:14,873 - INFO -  step: 1000  loss: -4.0000  grad_norm:  1.1575  memory: 56.77GiB(40.60%)  tps: 7,858  tflops: 366.48  mfu: 37.06%
[rank0]:2025-10-31 03:40:14,873 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-31 03:40:14,855 - INFO -  step: 1000  loss:  2.0273  grad_norm:  1.1575  memory: 47.23GiB(33.78%)  tps: 7,857  tflops: 366.47  mfu: 37.05%
[rank3]:2025-10-31 03:40:14,855 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-31 03:40:14,861 - INFO -  step: 1000  loss: -4.0000  grad_norm:  1.1575  memory: 39.23GiB(28.06%)  tps: 7,858  tflops: 366.48  mfu: 37.06%
[rank2]:2025-10-31 03:40:14,861 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-31 03:40:31,267 - INFO - validate step: 1000  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 24,944
[rank0]:2025-10-31 03:40:31,236 - INFO - validate step: 1000  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,033
[rank3]:2025-10-31 03:40:31,297 - INFO - validate step: 1000  loss:  0.8874  memory: 47.23GiB(33.78%)  tps: 24,912
[rank2]:2025-10-31 03:40:31,285 - INFO - validate step: 1000  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,940
[rank1]:2025-10-31 03:40:31,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0340_stage1_step1000.svg
[rank0]:2025-10-31 03:40:31,372 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0340_stage0_step1000.svg
[rank2]:2025-10-31 03:40:31,373 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0340_stage2_step1000.svg
[rank3]:2025-10-31 03:40:31,476 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0340_real_step1000_rank3.svg
[rank3]:> Batch Time: 451.52 ms, GPU Bubble Ratio: 17.78%, 30.52%, 33.87%, 34.31%
[rank3]:2025-10-31 03:40:31,539 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0340_stage3_step1000.svg
[rank3]:2025-10-31 03:40:31,817 - INFO - Avg. fwd time: 15.9662 / Avg. bwd time: 26.8875 / Avg. batch time: 369.8377 (ms) / GPU bubble ratio: 7.30%
[rank2]:2025-10-31 03:40:31,854 - INFO - Avg. fwd time: 14.0818 / Avg. bwd time: 25.8707 / Avg. batch time: 415.9012 (ms) / GPU bubble ratio: 23.15%
[rank1]:2025-10-31 03:40:31,858 - INFO - Avg. fwd time: 16.2613 / Avg. bwd time: 26.9929 / Avg. batch time: 464.3444 (ms) / GPU bubble ratio: 25.48%
[rank0]:2025-10-31 03:40:31,916 - INFO - Avg. fwd time: 13.9850 / Avg. bwd time: 27.8504 / Avg. batch time: 514.5666 (ms) / GPU bubble ratio: 34.96%
[rank0]:2025-10-31 03:42:14,005 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-31 03:42:16,069 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,817  tflops: 364.57  mfu: 36.86%
[rank3]:2025-10-31 03:42:16,071 - INFO -  step: 1050  loss:  2.4170  grad_norm:  0.4625  memory: 47.23GiB(33.78%)  tps: 7,819  tflops: 364.67  mfu: 36.87%
[rank2]:2025-10-31 03:42:16,083 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.4625  memory: 39.23GiB(28.06%)  tps: 7,817  tflops: 364.59  mfu: 36.86%
[rank0]:2025-10-31 03:42:16,096 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.4625  memory: 56.77GiB(40.60%)  tps: 7,812  tflops: 364.37  mfu: 36.84%
[rank3]:2025-10-31 03:42:16,514 - INFO - Avg. fwd time: 15.9939 / Avg. bwd time: 26.5446 / Avg. batch time: 369.0155 (ms) / GPU bubble ratio: 7.78%
[rank2]:2025-10-31 03:42:16,554 - INFO - Avg. fwd time: 14.1002 / Avg. bwd time: 25.6747 / Avg. batch time: 415.1198 (ms) / GPU bubble ratio: 23.35%
[rank1]:2025-10-31 03:42:16,592 - INFO - Avg. fwd time: 16.2943 / Avg. bwd time: 26.6435 / Avg. batch time: 463.5444 (ms) / GPU bubble ratio: 25.90%
[rank0]:2025-10-31 03:42:16,638 - INFO - Avg. fwd time: 13.9586 / Avg. bwd time: 28.4146 / Avg. batch time: 514.0286 (ms) / GPU bubble ratio: 34.05%
[rank0]:2025-10-31 03:43:58,619 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:44:00,706 - INFO -  step: 1100  loss:  2.0353  grad_norm:  0.3483  memory: 47.23GiB(33.78%)  tps: 7,829  tflops: 365.16  mfu: 36.92%
[rank2]:2025-10-31 03:44:00,718 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3483  memory: 39.23GiB(28.06%)  tps: 7,829  tflops: 365.15  mfu: 36.92%
[rank1]:2025-10-31 03:44:00,703 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,829  tflops: 365.15  mfu: 36.92%
[rank0]:2025-10-31 03:44:00,731 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3483  memory: 56.77GiB(40.60%)  tps: 7,829  tflops: 365.15  mfu: 36.92%
[rank2]:2025-10-31 03:44:00,805 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0344_stage2_step1100.svg
[rank1]:2025-10-31 03:44:00,805 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0344_stage1_step1100.svg
[rank0]:2025-10-31 03:44:00,804 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0344_stage0_step1100.svg
[rank3]:2025-10-31 03:44:00,909 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0344_real_step1100_rank3.svg
[rank3]:> Batch Time: 488.07 ms, GPU Bubble Ratio: 16.08%, 36.10%, 39.16%, 39.35%
[rank3]:2025-10-31 03:44:00,973 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0344_stage3_step1100.svg
[rank3]:2025-10-31 03:44:01,253 - INFO - Avg. fwd time: 16.0167 / Avg. bwd time: 26.2711 / Avg. batch time: 368.3768 (ms) / GPU bubble ratio: 8.16%
[rank2]:2025-10-31 03:44:01,291 - INFO - Avg. fwd time: 14.1153 / Avg. bwd time: 25.5211 / Avg. batch time: 414.4944 (ms) / GPU bubble ratio: 23.50%
[rank1]:2025-10-31 03:44:01,296 - INFO - Avg. fwd time: 16.3211 / Avg. bwd time: 26.3704 / Avg. batch time: 462.9049 (ms) / GPU bubble ratio: 26.22%
[rank0]:2025-10-31 03:44:01,354 - INFO - Avg. fwd time: 13.9381 / Avg. bwd time: 28.8545 / Avg. batch time: 513.5912 (ms) / GPU bubble ratio: 33.34%
[rank0]:2025-10-31 03:45:43,440 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:45:45,534 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,815  tflops: 364.47  mfu: 36.85%
[rank3]:2025-10-31 03:45:45,538 - INFO -  step: 1150  loss:  2.8162  grad_norm:  0.3014  memory: 47.23GiB(33.78%)  tps: 7,815  tflops: 364.47  mfu: 36.85%
[rank2]:2025-10-31 03:45:45,547 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.3014  memory: 39.23GiB(28.06%)  tps: 7,815  tflops: 364.48  mfu: 36.85%
[rank0]:2025-10-31 03:45:45,561 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.3014  memory: 56.77GiB(40.60%)  tps: 7,815  tflops: 364.47  mfu: 36.85%
[rank3]:2025-10-31 03:45:45,889 - INFO - Avg. fwd time: 16.0385 / Avg. bwd time: 25.9951 / Avg. batch time: 367.6785 (ms) / GPU bubble ratio: 8.54%
[rank2]:2025-10-31 03:45:45,927 - INFO - Avg. fwd time: 14.1309 / Avg. bwd time: 25.3565 / Avg. batch time: 413.8248 (ms) / GPU bubble ratio: 23.66%
[rank1]:2025-10-31 03:45:45,929 - INFO - Avg. fwd time: 16.3492 / Avg. bwd time: 26.0804 / Avg. batch time: 462.2331 (ms) / GPU bubble ratio: 26.57%
[rank0]:2025-10-31 03:45:45,989 - INFO - Avg. fwd time: 13.9170 / Avg. bwd time: 29.3243 / Avg. batch time: 513.1358 (ms) / GPU bubble ratio: 32.59%
[rank0]:2025-10-31 03:47:26,005 - WARNING - Dataset alpaca is being re-looped
[rank3]:2025-10-31 03:47:26,868 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 03:47:28,016 - WARNING - Dataset alpaca is being re-looped
[rank0]:2025-10-31 03:47:28,086 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:47:28,576 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 03:47:30,554 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0347_rank3_trend_line.svg
[rank2]:2025-10-31 03:47:30,596 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0347_rank2_trend_line.svg
[rank1]:2025-10-31 03:47:30,615 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0347_rank1_trend_line.svg
[rank2]:2025-10-31 03:47:30,669 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.58/0.58, [MB2] 0.32/0.32, [MB3] 0.32/0.32, [MB4] 0.31/0.31, [MB5] 0.29/0.29, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 03:47:30,671 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1722  memory: 39.23GiB(28.06%)  tps: 7,793  tflops: 363.45  mfu: 36.75%
[rank2]:2025-10-31 03:47:30,672 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-31 03:47:30,663 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0347_rank0_trend_line.svg
[rank0]:2025-10-31 03:47:30,670 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.52/0.52, [MB1] 0.50/0.50, [MB2] 0.49/0.49, [MB3] 0.50/0.50, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.06/0.06, [MB7] 1.00/1.00
[rank0]:2025-10-31 03:47:30,672 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.1722  memory: 56.77GiB(40.60%)  tps: 7,794  tflops: 363.50  mfu: 36.75%
[rank0]:2025-10-31 03:47:30,672 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-10-31 03:47:30,670 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 03:47:30,672 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,792  tflops: 363.41  mfu: 36.74%
[rank1]:2025-10-31 03:47:30,672 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-10-31 03:47:30,860 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0347_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 388.45 ms, GPU Bubble Ratio: 22.25%, 25.37%, 27.02%, 27.22%
[rank3]:2025-10-31 03:47:30,860 - INFO - 	> Batch Time: 388.45 ms (Average Freeze Ratio: 0.62)
[rank3]:2025-10-31 03:47:30,861 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.92/0.92, [MB3] 0.78/0.78, [MB4] 0.77/0.77, [MB5] 0.76/0.76, [MB6] 0.76/0.76, [MB7] 1.00/1.00
[rank3]:2025-10-31 03:47:30,866 - INFO -  step: 1200  loss:  1.9624  grad_norm:  0.1722  memory: 47.23GiB(33.78%)  tps: 7,778  tflops: 362.75  mfu: 36.68%
[rank3]:2025-10-31 03:47:30,866 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-10-31 03:47:47,043 - INFO - validate step: 1200  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 25,020
[rank0]:2025-10-31 03:47:47,044 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 03:47:47,049 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank3]:2025-10-31 03:47:47,102 - INFO - validate step: 1200  loss:  0.8929  memory: 47.23GiB(33.78%)  tps: 25,231
[rank3]:2025-10-31 03:47:47,103 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:47:47,092 - INFO - validate step: 1200  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,944
[rank2]:2025-10-31 03:47:47,093 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 03:47:47,075 - INFO - validate step: 1200  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 24,972
[rank1]:2025-10-31 03:47:47,076 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 03:48:01,521 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.43 seconds.
[rank0]:2025-10-31 03:48:01,930 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-10-31 03:48:01,935 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.89 seconds.
[rank1]:2025-10-31 03:48:03,714 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.64 seconds.
[rank3]:2025-10-31 03:48:04,403 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.30 seconds.
[rank2]:2025-10-31 03:48:04,515 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0348_stage2_step1200.svg
[rank1]:2025-10-31 03:48:04,511 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0348_stage1_step1200.svg
[rank0]:2025-10-31 03:48:04,624 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0348_stage0_step1200.svg
[rank3]:2025-10-31 03:48:04,703 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0348_real_step1200_rank3.svg
[rank3]:> Batch Time: 488.95 ms, GPU Bubble Ratio: 16.10%, 36.74%, 39.54%, 39.53%
[rank3]:2025-10-31 03:48:04,770 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0348_stage3_step1200.svg
[rank3]:2025-10-31 03:48:05,876 - INFO - Avg. fwd time: 16.0592 / Avg. bwd time: 25.7652 / Avg. batch time: 367.2253 (ms) / GPU bubble ratio: 8.89%
[rank2]:2025-10-31 03:48:05,912 - INFO - Avg. fwd time: 14.1455 / Avg. bwd time: 25.2023 / Avg. batch time: 413.3861 (ms) / GPU bubble ratio: 23.85%
[rank0]:2025-10-31 03:48:05,971 - INFO - Avg. fwd time: 13.8979 / Avg. bwd time: 29.7504 / Avg. batch time: 512.8706 (ms) / GPU bubble ratio: 31.92%
[rank1]:2025-10-31 03:48:05,939 - INFO - Avg. fwd time: 16.3743 / Avg. bwd time: 25.8137 / Avg. batch time: 461.7676 (ms) / GPU bubble ratio: 26.91%
[rank1]:2025-10-31 03:48:06,408 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 03:48:10,879 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 03:48:11,677 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 03:48:12,716 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 03:49:35,969 - INFO - [GC] Peforming periodical GC collection 2.07 seconds
[rank3]:2025-10-31 03:49:37,980 - INFO -  step: 1250  loss:  2.5081  grad_norm:  0.7751  memory: 47.23GiB(33.78%)  tps: 7,388  tflops: 344.60  mfu: 34.84%
[rank2]:2025-10-31 03:49:37,993 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.7751  memory: 39.23GiB(28.06%)  tps: 7,387  tflops: 344.52  mfu: 34.84%
[rank1]:2025-10-31 03:49:37,976 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 7,387  tflops: 344.52  mfu: 34.84%
[rank0]:2025-10-31 03:49:37,999 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.7751  memory: 56.77GiB(40.60%)  tps: 7,383  tflops: 344.35  mfu: 34.82%
[rank3]:2025-10-31 03:49:38,298 - INFO - Avg. fwd time: 16.0789 / Avg. bwd time: 25.5690 / Avg. batch time: 365.3586 (ms) / GPU bubble ratio: 8.81%
[rank2]:2025-10-31 03:49:38,327 - INFO - Avg. fwd time: 14.1551 / Avg. bwd time: 25.1278 / Avg. batch time: 411.3746 (ms) / GPU bubble ratio: 23.61%
[rank1]:2025-10-31 03:49:38,323 - INFO - Avg. fwd time: 16.3973 / Avg. bwd time: 25.5307 / Avg. batch time: 459.2796 (ms) / GPU bubble ratio: 26.97%
[rank0]:2025-10-31 03:49:38,347 - INFO - Avg. fwd time: 13.9354 / Avg. bwd time: 29.1268 / Avg. batch time: 509.9705 (ms) / GPU bubble ratio: 32.45%
[rank0]:2025-10-31 03:51:06,341 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:51:08,162 - INFO -  step: 1300  loss:  2.4021  grad_norm:  0.0573  memory: 47.23GiB(33.78%)  tps: 9,084  tflops: 423.68  mfu: 42.84%
[rank2]:2025-10-31 03:51:08,176 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0573  memory: 39.23GiB(28.06%)  tps: 9,084  tflops: 423.67  mfu: 42.84%
[rank1]:2025-10-31 03:51:08,157 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,084  tflops: 423.68  mfu: 42.84%
[rank0]:2025-10-31 03:51:08,179 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0573  memory: 56.77GiB(40.60%)  tps: 9,084  tflops: 423.68  mfu: 42.84%
[rank2]:2025-10-31 03:51:08,259 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0351_stage2_step1300.svg
[rank1]:2025-10-31 03:51:08,258 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0351_stage1_step1300.svg
[rank0]:2025-10-31 03:51:08,258 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0351_stage0_step1300.svg
[rank3]:2025-10-31 03:51:08,361 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0351_real_step1300_rank3.svg
[rank3]:> Batch Time: 487.87 ms, GPU Bubble Ratio: 15.98%, 38.04%, 39.15%, 39.42%
[rank3]:2025-10-31 03:51:08,428 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0351_stage3_step1300.svg
[rank1]:2025-10-31 03:51:08,715 - INFO - Avg. fwd time: 16.4240 / Avg. bwd time: 25.2263 / Avg. batch time: 456.6592 (ms) / GPU bubble ratio: 27.03%
[rank3]:2025-10-31 03:51:08,691 - INFO - Avg. fwd time: 16.0987 / Avg. bwd time: 25.3685 / Avg. batch time: 363.3943 (ms) / GPU bubble ratio: 8.71%
[rank2]:2025-10-31 03:51:08,719 - INFO - Avg. fwd time: 14.1662 / Avg. bwd time: 25.0461 / Avg. batch time: 409.2677 (ms) / GPU bubble ratio: 23.35%
[rank0]:2025-10-31 03:51:08,740 - INFO - Avg. fwd time: 13.9763 / Avg. bwd time: 28.4625 / Avg. batch time: 506.9352 (ms) / GPU bubble ratio: 33.03%
[rank0]:2025-10-31 03:52:36,972 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:52:38,778 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0446  memory: 39.23GiB(28.06%)  tps: 9,042  tflops: 421.71  mfu: 42.64%
[rank1]:2025-10-31 03:52:38,759 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,042  tflops: 421.71  mfu: 42.64%
[rank0]:2025-10-31 03:52:38,776 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0446  memory: 56.77GiB(40.60%)  tps: 9,042  tflops: 421.73  mfu: 42.64%
[rank3]:2025-10-31 03:52:38,763 - INFO -  step: 1350  loss:  2.8894  grad_norm:  0.0446  memory: 47.23GiB(33.78%)  tps: 9,042  tflops: 421.72  mfu: 42.64%
[rank3]:2025-10-31 03:52:39,155 - INFO - Avg. fwd time: 16.1141 / Avg. bwd time: 25.1983 / Avg. batch time: 361.6422 (ms) / GPU bubble ratio: 8.61%
[rank2]:2025-10-31 03:52:39,192 - INFO - Avg. fwd time: 14.1750 / Avg. bwd time: 24.9761 / Avg. batch time: 407.4072 (ms) / GPU bubble ratio: 23.12%
[rank1]:2025-10-31 03:52:39,219 - INFO - Avg. fwd time: 16.4475 / Avg. bwd time: 24.9454 / Avg. batch time: 454.3245 (ms) / GPU bubble ratio: 27.11%
[rank0]:2025-10-31 03:52:39,252 - INFO - Avg. fwd time: 14.0144 / Avg. bwd time: 27.8418 / Avg. batch time: 504.1660 (ms) / GPU bubble ratio: 33.58%
[rank0]:2025-10-31 03:54:07,034 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 03:54:08,858 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2565  memory: 39.23GiB(28.06%)  tps: 9,094  tflops: 424.15  mfu: 42.89%
[rank2]:2025-10-31 03:54:08,858 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-10-31 03:54:08,838 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,094  tflops: 424.16  mfu: 42.89%
[rank1]:2025-10-31 03:54:08,838 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 03:54:08,861 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2565  memory: 56.77GiB(40.60%)  tps: 9,094  tflops: 424.13  mfu: 42.88%
[rank0]:2025-10-31 03:54:08,861 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-10-31 03:54:08,841 - INFO -  step: 1400  loss:  2.3663  grad_norm:  0.2565  memory: 47.23GiB(33.78%)  tps: 9,095  tflops: 424.17  mfu: 42.89%
[rank3]:2025-10-31 03:54:08,841 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-10-31 03:54:25,282 - INFO - validate step: 1400  loss: -1.0000  memory: 56.77GiB(40.60%)  tps: 24,944
[rank3]:2025-10-31 03:54:25,343 - INFO - validate step: 1400  loss:  0.8991  memory: 47.23GiB(33.78%)  tps: 24,822
[rank1]:2025-10-31 03:54:25,314 - INFO - validate step: 1400  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 24,860
[rank2]:2025-10-31 03:54:25,333 - INFO - validate step: 1400  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,862
[rank1]:2025-10-31 03:54:25,428 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0354_stage1_step1400.svg
[rank2]:2025-10-31 03:54:25,427 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0354_stage2_step1400.svg
[rank0]:2025-10-31 03:54:25,426 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0354_stage0_step1400.svg
[rank3]:2025-10-31 03:54:25,526 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0354_real_step1400_rank3.svg
[rank3]:> Batch Time: 451.23 ms, GPU Bubble Ratio: 16.75%, 34.24%, 34.08%, 34.56%
[rank3]:2025-10-31 03:54:25,594 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0354_stage3_step1400.svg
[rank0]:2025-10-31 03:54:25,901 - INFO - Avg. fwd time: 14.0449 / Avg. bwd time: 27.3615 / Avg. batch time: 501.8589 (ms) / GPU bubble ratio: 34.00%
[rank3]:2025-10-31 03:54:25,853 - INFO - Avg. fwd time: 16.1299 / Avg. bwd time: 25.0420 / Avg. batch time: 360.1129 (ms) / GPU bubble ratio: 8.54%
[rank1]:2025-10-31 03:54:25,876 - INFO - Avg. fwd time: 16.4665 / Avg. bwd time: 24.7211 / Avg. batch time: 452.3261 (ms) / GPU bubble ratio: 27.15%
[rank2]:2025-10-31 03:54:25,882 - INFO - Avg. fwd time: 14.1838 / Avg. bwd time: 24.9169 / Avg. batch time: 405.7874 (ms) / GPU bubble ratio: 22.91%
[rank0]:2025-10-31 03:55:54,233 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 03:55:56,018 - INFO -  step: 1450  loss:  1.9812  grad_norm:  0.2229  memory: 47.23GiB(33.78%)  tps: 9,035  tflops: 421.38  mfu: 42.61%
[rank1]:2025-10-31 03:55:56,015 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,032  tflops: 421.25  mfu: 42.59%
[rank2]:2025-10-31 03:55:56,031 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.2229  memory: 39.23GiB(28.06%)  tps: 9,032  tflops: 421.26  mfu: 42.59%
[rank0]:2025-10-31 03:55:56,039 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.2229  memory: 56.98GiB(40.76%)  tps: 9,026  tflops: 420.99  mfu: 42.57%
[rank0]:2025-10-31 03:55:56,387 - INFO - Avg. fwd time: 14.0784 / Avg. bwd time: 26.8200 / Avg. batch time: 499.4722 (ms) / GPU bubble ratio: 34.49%
[rank3]:2025-10-31 03:55:56,340 - INFO - Avg. fwd time: 16.1449 / Avg. bwd time: 24.8959 / Avg. batch time: 358.5942 (ms) / GPU bubble ratio: 8.44%
[rank1]:2025-10-31 03:55:56,363 - INFO - Avg. fwd time: 16.4853 / Avg. bwd time: 24.4759 / Avg. batch time: 450.3014 (ms) / GPU bubble ratio: 27.23%
[rank2]:2025-10-31 03:55:56,367 - INFO - Avg. fwd time: 14.1923 / Avg. bwd time: 24.8561 / Avg. batch time: 404.1745 (ms) / GPU bubble ratio: 22.71%
[rank0]:2025-10-31 03:57:24,078 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 03:57:25,862 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,118  tflops: 425.25  mfu: 43.00%
[rank3]:2025-10-31 03:57:25,865 - INFO -  step: 1500  loss:  1.8957  grad_norm:  0.1778  memory: 47.23GiB(33.78%)  tps: 9,118  tflops: 425.26  mfu: 43.00%
[rank2]:2025-10-31 03:57:25,879 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1778  memory: 39.23GiB(28.06%)  tps: 9,118  tflops: 425.25  mfu: 43.00%
[rank0]:2025-10-31 03:57:25,879 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1778  memory: 56.98GiB(40.76%)  tps: 9,118  tflops: 425.28  mfu: 43.00%
[rank0]:2025-10-31 03:57:25,958 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0357_stage0_step1500.svg
[rank1]:2025-10-31 03:57:25,963 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0357_stage1_step1500.svg
[rank2]:2025-10-31 03:57:25,963 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0357_stage2_step1500.svg
[rank3]:2025-10-31 03:57:26,062 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0357_real_step1500_rank3.svg
[rank3]:> Batch Time: 438.45 ms, GPU Bubble Ratio: 23.18%, 32.49%, 31.99%, 32.71%
[rank3]:2025-10-31 03:57:26,131 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0357_stage3_step1500.svg
[rank3]:2025-10-31 03:57:26,467 - INFO - Avg. fwd time: 16.1611 / Avg. bwd time: 24.7381 / Avg. batch time: 357.0454 (ms) / GPU bubble ratio: 8.36%
[rank2]:2025-10-31 03:57:26,504 - INFO - Avg. fwd time: 14.2005 / Avg. bwd time: 24.7936 / Avg. batch time: 402.5517 (ms) / GPU bubble ratio: 22.51%
[rank0]:2025-10-31 03:57:26,563 - INFO - Avg. fwd time: 14.1092 / Avg. bwd time: 26.3268 / Avg. batch time: 497.1480 (ms) / GPU bubble ratio: 34.93%
[rank1]:2025-10-31 03:57:26,530 - INFO - Avg. fwd time: 16.5035 / Avg. bwd time: 24.2480 / Avg. batch time: 448.2955 (ms) / GPU bubble ratio: 27.28%
[rank0]:2025-10-31 03:58:54,216 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 03:58:55,998 - INFO -  step: 1550  loss:  1.9832  grad_norm:  0.0824  memory: 47.23GiB(33.78%)  tps: 9,089  tflops: 423.91  mfu: 42.86%
[rank0]:2025-10-31 03:58:56,011 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0824  memory: 56.98GiB(40.76%)  tps: 9,089  tflops: 423.91  mfu: 42.86%
[rank1]:2025-10-31 03:58:55,995 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,089  tflops: 423.90  mfu: 42.86%
[rank2]:2025-10-31 03:58:56,013 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0824  memory: 39.23GiB(28.06%)  tps: 9,089  tflops: 423.90  mfu: 42.86%
[rank1]:2025-10-31 03:58:56,340 - INFO - Avg. fwd time: 16.5184 / Avg. bwd time: 24.0652 / Avg. batch time: 446.6623 (ms) / GPU bubble ratio: 27.31%
[rank2]:2025-10-31 03:58:56,344 - INFO - Avg. fwd time: 14.2076 / Avg. bwd time: 24.7426 / Avg. batch time: 401.2270 (ms) / GPU bubble ratio: 22.34%
[rank3]:2025-10-31 03:58:56,315 - INFO - Avg. fwd time: 16.1732 / Avg. bwd time: 24.6161 / Avg. batch time: 355.8078 (ms) / GPU bubble ratio: 8.29%
[rank0]:2025-10-31 03:58:56,366 - INFO - Avg. fwd time: 14.1339 / Avg. bwd time: 25.9327 / Avg. batch time: 495.2545 (ms) / GPU bubble ratio: 35.28%
[rank0]:2025-10-31 04:00:24,279 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 04:00:26,618 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0400_rank3_trend_line.svg
[rank1]:2025-10-31 04:00:26,737 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0400_rank1_trend_line.svg
[rank2]:2025-10-31 04:00:26,727 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0400_rank2_trend_line.svg
[rank2]:2025-10-31 04:00:26,761 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.76/0.76, [MB2] 0.46/0.46, [MB3] 0.43/0.43, [MB4] 0.42/0.42, [MB5] 0.40/0.40, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-10-31 04:00:26,764 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1004  memory: 39.23GiB(28.06%)  tps: 9,027  tflops: 421.02  mfu: 42.57%
[rank2]:2025-10-31 04:00:26,764 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 04:00:26,754 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule_adjustment/251031_0400_rank0_trend_line.svg
[rank0]:2025-10-31 04:00:26,761 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.25/0.25, [MB1] 0.22/0.22, [MB2] 0.22/0.22, [MB3] 0.23/0.23, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.01/0.01, [MB7] 1.00/1.00
[rank0]:2025-10-31 04:00:26,764 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.1004  memory: 56.98GiB(40.76%)  tps: 9,027  tflops: 421.01  mfu: 42.57%
[rank0]:2025-10-31 04:00:26,764 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-10-31 04:00:26,761 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.69/0.69, [MB1] 0.22/0.22, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-10-31 04:00:26,764 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 48.53GiB(34.71%)  tps: 9,025  tflops: 420.94  mfu: 42.56%
[rank1]:2025-10-31 04:00:26,764 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-10-31 04:00:26,953 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0400_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 374.50 ms, GPU Bubble Ratio: 23.67%, 23.93%, 24.83%, 25.22%
[rank3]:2025-10-31 04:00:26,954 - INFO - 	> Batch Time: 374.50 ms (Average Freeze Ratio: 0.48)
[rank3]:2025-10-31 04:00:26,955 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.82/0.82, [MB4] 0.80/0.80, [MB5] 0.79/0.79, [MB6] 0.79/0.79, [MB7] 1.00/1.00
[rank3]:2025-10-31 04:00:26,961 - INFO -  step: 1600  loss:  2.5669  grad_norm:  0.1004  memory: 47.23GiB(33.78%)  tps: 9,006  tflops: 420.05  mfu: 42.47%
[rank3]:2025-10-31 04:00:26,961 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-10-31 04:00:43,020 - INFO - validate step: 1600  loss: -1.0000  memory: 56.98GiB(40.76%)  tps: 25,198
[rank1]:2025-10-31 04:00:43,052 - INFO - validate step: 1600  loss: -1.0000  memory: 48.53GiB(34.71%)  tps: 25,148
[rank2]:2025-10-31 04:00:43,070 - INFO - validate step: 1600  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 25,120
[rank3]:2025-10-31 04:00:43,082 - INFO - validate step: 1600  loss:  0.9089  memory: 47.23GiB(33.78%)  tps: 25,409
[rank2]:2025-10-31 04:00:43,170 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0400_stage2_step1600.svg
[rank0]:2025-10-31 04:00:43,168 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0400_stage0_step1600.svg
[rank1]:2025-10-31 04:00:43,168 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0400_stage1_step1600.svg
[rank3]:2025-10-31 04:00:43,261 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0400_real_step1600_rank3.svg
[rank3]:> Batch Time: 439.00 ms, GPU Bubble Ratio: 39.95%, 32.74%, 31.82%, 32.76%
[rank3]:2025-10-31 04:00:43,333 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0400_stage3_step1600.svg
[rank3]:2025-10-31 04:00:43,593 - INFO - Avg. fwd time: 16.1856 / Avg. bwd time: 24.4854 / Avg. batch time: 354.5276 (ms) / GPU bubble ratio: 8.22%
[rank2]:2025-10-31 04:00:43,624 - INFO - Avg. fwd time: 14.2152 / Avg. bwd time: 24.6900 / Avg. batch time: 399.8375 (ms) / GPU bubble ratio: 22.16%
[rank0]:2025-10-31 04:00:43,682 - INFO - Avg. fwd time: 14.1607 / Avg. bwd time: 25.4960 / Avg. batch time: 493.2256 (ms) / GPU bubble ratio: 35.68%
[rank1]:2025-10-31 04:00:43,666 - INFO - Avg. fwd time: 16.5348 / Avg. bwd time: 23.8650 / Avg. batch time: 444.9352 (ms) / GPU bubble ratio: 27.36%
[rank0]:2025-10-31 04:02:17,167 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-10-31 04:02:19,071 - INFO -  step: 1650  loss:  2.5094  grad_norm:  0.0847  memory: 47.23GiB(33.78%)  tps: 8,534  tflops: 398.05  mfu: 40.25%
[rank0]:2025-10-31 04:02:19,093 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0847  memory: 56.98GiB(40.76%)  tps: 8,527  tflops: 397.70  mfu: 40.21%
[rank1]:2025-10-31 04:02:19,089 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0847  memory: 49.37GiB(35.31%)  tps: 8,530  tflops: 397.84  mfu: 40.23%
[rank2]:2025-10-31 04:02:19,080 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0847  memory: 39.23GiB(28.06%)  tps: 8,532  tflops: 397.96  mfu: 40.24%
[rank3]:2025-10-31 04:02:19,468 - INFO - Avg. fwd time: 16.1997 / Avg. bwd time: 24.3382 / Avg. batch time: 353.2867 (ms) / GPU bubble ratio: 8.20%
[rank2]:2025-10-31 04:02:19,504 - INFO - Avg. fwd time: 14.2263 / Avg. bwd time: 24.5955 / Avg. batch time: 398.4659 (ms) / GPU bubble ratio: 22.06%
[rank0]:2025-10-31 04:02:19,588 - INFO - Avg. fwd time: 14.1781 / Avg. bwd time: 25.1811 / Avg. batch time: 492.1277 (ms) / GPU bubble ratio: 36.02%
[rank1]:2025-10-31 04:02:19,550 - INFO - Avg. fwd time: 16.5188 / Avg. bwd time: 24.0171 / Avg. batch time: 443.9447 (ms) / GPU bubble ratio: 26.95%
[rank0]:2025-10-31 04:03:53,081 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 04:03:55,036 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2098  memory: 39.23GiB(28.06%)  tps: 8,537  tflops: 398.18  mfu: 40.26%
[rank3]:2025-10-31 04:03:55,024 - INFO -  step: 1700  loss:  2.4202  grad_norm:  0.2098  memory: 47.23GiB(33.78%)  tps: 8,538  tflops: 398.20  mfu: 40.26%
[rank0]:2025-10-31 04:03:55,049 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2098  memory: 56.98GiB(40.76%)  tps: 8,537  tflops: 398.18  mfu: 40.26%
[rank1]:2025-10-31 04:03:55,045 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2098  memory: 49.60GiB(35.48%)  tps: 8,537  tflops: 398.18  mfu: 40.26%
[rank2]:2025-10-31 04:03:55,134 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0403_stage2_step1700.svg
[rank0]:2025-10-31 04:03:55,133 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0403_stage0_step1700.svg
[rank1]:2025-10-31 04:03:55,132 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0403_stage1_step1700.svg
[rank3]:2025-10-31 04:03:55,227 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0403_real_step1700_rank3.svg
[rank3]:> Batch Time: 438.45 ms, GPU Bubble Ratio: 40.72%, 32.51%, 31.92%, 32.75%
[rank3]:2025-10-31 04:03:55,297 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0403_stage3_step1700.svg
[rank3]:2025-10-31 04:03:55,550 - INFO - Avg. fwd time: 16.2108 / Avg. bwd time: 24.2190 / Avg. batch time: 352.2752 (ms) / GPU bubble ratio: 8.19%
[rank2]:2025-10-31 04:03:55,580 - INFO - Avg. fwd time: 14.2353 / Avg. bwd time: 24.5119 / Avg. batch time: 397.3133 (ms) / GPU bubble ratio: 21.98%
[rank0]:2025-10-31 04:03:55,640 - INFO - Avg. fwd time: 14.1912 / Avg. bwd time: 24.9298 / Avg. batch time: 491.2771 (ms) / GPU bubble ratio: 36.30%
[rank1]:2025-10-31 04:03:55,625 - INFO - Avg. fwd time: 16.5043 / Avg. bwd time: 24.1551 / Avg. batch time: 443.1836 (ms) / GPU bubble ratio: 26.60%
[rank0]:2025-10-31 04:05:29,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 04:05:31,062 - INFO -  step: 1750  loss:  2.1481  grad_norm:  0.1806  memory: 47.23GiB(33.78%)  tps: 8,530  tflops: 397.85  mfu: 40.23%
[rank1]:2025-10-31 04:05:31,083 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1806  memory: 49.60GiB(35.48%)  tps: 8,530  tflops: 397.84  mfu: 40.23%
[rank2]:2025-10-31 04:05:31,076 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1806  memory: 39.23GiB(28.06%)  tps: 8,530  tflops: 397.83  mfu: 40.23%
[rank0]:2025-10-31 04:05:31,087 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.1806  memory: 56.98GiB(40.76%)  tps: 8,530  tflops: 397.84  mfu: 40.23%
[rank2]:2025-10-31 04:05:31,418 - INFO - Avg. fwd time: 14.2455 / Avg. bwd time: 24.4192 / Avg. batch time: 396.1076 (ms) / GPU bubble ratio: 21.91%
[rank3]:2025-10-31 04:05:31,392 - INFO - Avg. fwd time: 16.2228 / Avg. bwd time: 24.0883 / Avg. batch time: 351.1915 (ms) / GPU bubble ratio: 8.17%
[rank1]:2025-10-31 04:05:31,462 - INFO - Avg. fwd time: 16.4885 / Avg. bwd time: 24.3090 / Avg. batch time: 442.3629 (ms) / GPU bubble ratio: 26.22%
[rank0]:2025-10-31 04:05:31,481 - INFO - Avg. fwd time: 14.2061 / Avg. bwd time: 24.6577 / Avg. batch time: 490.3627 (ms) / GPU bubble ratio: 36.60%
[rank0]:2025-10-31 04:07:05,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 04:07:07,101 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.4060  memory: 39.23GiB(28.06%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank2]:2025-10-31 04:07:07,101 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 04:07:07,112 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.4060  memory: 56.98GiB(40.76%)  tps: 8,531  tflops: 397.90  mfu: 40.23%
[rank0]:2025-10-31 04:07:07,112 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-10-31 04:07:07,095 - INFO -  step: 1800  loss:  2.3947  grad_norm:  0.4060  memory: 47.23GiB(33.78%)  tps: 8,531  tflops: 397.87  mfu: 40.23%
[rank3]:2025-10-31 04:07:07,095 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-10-31 04:07:07,108 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.4060  memory: 49.60GiB(35.48%)  tps: 8,531  tflops: 397.89  mfu: 40.23%
[rank1]:2025-10-31 04:07:07,108 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-10-31 04:07:23,919 - INFO - validate step: 1800  loss: -1.0000  memory: 56.98GiB(40.76%)  tps: 24,372
[rank1]:2025-10-31 04:07:23,954 - INFO - validate step: 1800  loss: -1.0000  memory: 49.60GiB(35.48%)  tps: 24,315
[rank3]:2025-10-31 04:07:23,979 - INFO - validate step: 1800  loss:  0.8954  memory: 47.23GiB(33.78%)  tps: 24,262
[rank2]:2025-10-31 04:07:23,968 - INFO - validate step: 1800  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,284
[rank1]:2025-10-31 04:07:24,063 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0407_stage1_step1800.svg
[rank2]:2025-10-31 04:07:24,065 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0407_stage2_step1800.svg
[rank0]:2025-10-31 04:07:24,064 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0407_stage0_step1800.svg
[rank3]:2025-10-31 04:07:24,161 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0407_real_step1800_rank3.svg
[rank3]:> Batch Time: 438.10 ms, GPU Bubble Ratio: 41.77%, 32.30%, 32.01%, 32.74%
[rank3]:2025-10-31 04:07:24,230 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0407_stage3_step1800.svg
[rank3]:2025-10-31 04:07:24,564 - INFO - Avg. fwd time: 16.2322 / Avg. bwd time: 23.9821 / Avg. batch time: 350.2135 (ms) / GPU bubble ratio: 8.14%
[rank2]:2025-10-31 04:07:24,600 - INFO - Avg. fwd time: 14.2542 / Avg. bwd time: 24.3367 / Avg. batch time: 395.0240 (ms) / GPU bubble ratio: 21.85%
[rank1]:2025-10-31 04:07:24,645 - INFO - Avg. fwd time: 16.4736 / Avg. bwd time: 24.4471 / Avg. batch time: 441.5935 (ms) / GPU bubble ratio: 25.87%
[rank0]:2025-10-31 04:07:24,684 - INFO - Avg. fwd time: 14.2199 / Avg. bwd time: 24.4061 / Avg. batch time: 489.5074 (ms) / GPU bubble ratio: 36.87%
[rank0]:2025-10-31 04:08:58,281 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 04:09:00,232 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5835  memory: 56.98GiB(40.76%)  tps: 8,506  tflops: 396.70  mfu: 40.11%
[rank1]:2025-10-31 04:09:00,228 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5835  memory: 49.70GiB(35.55%)  tps: 8,509  tflops: 396.86  mfu: 40.13%
[rank3]:2025-10-31 04:09:00,213 - INFO -  step: 1850  loss:  2.1578  grad_norm:  0.5835  memory: 47.23GiB(33.78%)  tps: 8,513  tflops: 397.04  mfu: 40.15%
[rank2]:2025-10-31 04:09:00,222 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.5835  memory: 39.23GiB(28.06%)  tps: 8,511  tflops: 396.95  mfu: 40.14%
[rank3]:2025-10-31 04:09:00,531 - INFO - Avg. fwd time: 16.2409 / Avg. bwd time: 23.8908 / Avg. batch time: 349.3887 (ms) / GPU bubble ratio: 8.11%
[rank2]:2025-10-31 04:09:00,565 - INFO - Avg. fwd time: 14.2614 / Avg. bwd time: 24.2694 / Avg. batch time: 394.0872 (ms) / GPU bubble ratio: 21.78%
[rank0]:2025-10-31 04:09:00,627 - INFO - Avg. fwd time: 14.2316 / Avg. bwd time: 24.1951 / Avg. batch time: 488.8034 (ms) / GPU bubble ratio: 37.11%
[rank1]:2025-10-31 04:09:00,612 - INFO - Avg. fwd time: 16.4621 / Avg. bwd time: 24.5604 / Avg. batch time: 440.9774 (ms) / GPU bubble ratio: 25.58%
[rank0]:2025-10-31 04:10:34,276 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 04:10:36,212 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1577  memory: 49.70GiB(35.55%)  tps: 8,535  tflops: 398.06  mfu: 40.25%
[rank0]:2025-10-31 04:10:36,215 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1577  memory: 56.98GiB(40.76%)  tps: 8,535  tflops: 398.07  mfu: 40.25%
[rank3]:2025-10-31 04:10:36,193 - INFO -  step: 1900  loss:  2.5936  grad_norm:  0.1577  memory: 47.23GiB(33.78%)  tps: 8,535  tflops: 398.09  mfu: 40.25%
[rank2]:2025-10-31 04:10:36,205 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1577  memory: 39.23GiB(28.06%)  tps: 8,535  tflops: 398.07  mfu: 40.25%
[rank1]:2025-10-31 04:10:36,302 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0410_stage1_step1900.svg
[rank0]:2025-10-31 04:10:36,298 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0410_stage0_step1900.svg
[rank2]:2025-10-31 04:10:36,302 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0410_stage2_step1900.svg
[rank3]:2025-10-31 04:10:36,397 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0410_real_step1900_rank3.svg
[rank3]:> Batch Time: 437.52 ms, GPU Bubble Ratio: 42.20%, 31.26%, 32.07%, 32.74%
[rank3]:2025-10-31 04:10:36,466 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0410_stage3_step1900.svg
[rank3]:2025-10-31 04:10:36,729 - INFO - Avg. fwd time: 16.2514 / Avg. bwd time: 23.7778 / Avg. batch time: 348.5030 (ms) / GPU bubble ratio: 8.11%
[rank2]:2025-10-31 04:10:36,753 - INFO - Avg. fwd time: 14.2695 / Avg. bwd time: 24.1904 / Avg. batch time: 393.0991 (ms) / GPU bubble ratio: 21.73%
[rank1]:2025-10-31 04:10:36,800 - INFO - Avg. fwd time: 16.4484 / Avg. bwd time: 24.6967 / Avg. batch time: 440.2751 (ms) / GPU bubble ratio: 25.24%
[rank0]:2025-10-31 04:10:36,813 - INFO - Avg. fwd time: 14.2448 / Avg. bwd time: 23.9572 / Avg. batch time: 488.0285 (ms) / GPU bubble ratio: 37.38%
[rank0]:2025-10-31 04:12:10,265 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-31 04:12:12,201 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1709  memory: 49.70GiB(35.55%)  tps: 8,534  tflops: 398.04  mfu: 40.25%
[rank0]:2025-10-31 04:12:12,206 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1709  memory: 56.98GiB(40.76%)  tps: 8,534  tflops: 398.04  mfu: 40.25%
[rank3]:2025-10-31 04:12:12,181 - INFO -  step: 1950  loss:  2.0232  grad_norm:  0.1709  memory: 47.23GiB(33.78%)  tps: 8,535  tflops: 398.05  mfu: 40.25%
[rank2]:2025-10-31 04:12:12,193 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1709  memory: 39.23GiB(28.06%)  tps: 8,534  tflops: 398.05  mfu: 40.25%
[rank3]:2025-10-31 04:12:12,587 - INFO - Avg. fwd time: 16.2609 / Avg. bwd time: 23.6770 / Avg. batch time: 347.6007 (ms) / GPU bubble ratio: 8.08%
[rank2]:2025-10-31 04:12:12,624 - INFO - Avg. fwd time: 14.2773 / Avg. bwd time: 24.1146 / Avg. batch time: 392.1018 (ms) / GPU bubble ratio: 21.67%
[rank1]:2025-10-31 04:12:12,672 - INFO - Avg. fwd time: 16.4365 / Avg. bwd time: 24.8197 / Avg. batch time: 439.5932 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-10-31 04:12:12,712 - INFO - Avg. fwd time: 14.2575 / Avg. bwd time: 23.7347 / Avg. batch time: 487.2737 (ms) / GPU bubble ratio: 37.62%
[rank0]:2025-10-31 04:13:46,610 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 04:13:48,543 - INFO -  step: 2000  loss:  2.1757  grad_norm:  0.1171  memory: 47.23GiB(33.78%)  tps: 8,501  tflops: 396.51  mfu: 40.09%
[rank3]:2025-10-31 04:13:48,543 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-31 04:13:48,562 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1171  memory: 49.70GiB(35.55%)  tps: 8,501  tflops: 396.51  mfu: 40.09%
[rank1]:2025-10-31 04:13:48,562 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-10-31 04:13:48,565 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1171  memory: 56.98GiB(40.76%)  tps: 8,502  tflops: 396.51  mfu: 40.09%
[rank0]:2025-10-31 04:13:48,565 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-10-31 04:13:48,555 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1171  memory: 39.23GiB(28.06%)  tps: 8,501  tflops: 396.50  mfu: 40.09%
[rank2]:2025-10-31 04:13:48,555 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-10-31 04:14:05,272 - INFO - validate step: 2000  loss: -1.0000  memory: 49.70GiB(35.55%)  tps: 24,512
[rank0]:2025-10-31 04:14:05,237 - INFO - validate step: 2000  loss: -1.0000  memory: 56.98GiB(40.76%)  tps: 24,569
[rank2]:2025-10-31 04:14:05,285 - INFO - validate step: 2000  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,483
[rank3]:2025-10-31 04:14:05,292 - INFO - validate step: 2000  loss:  0.8972  memory: 47.23GiB(33.78%)  tps: 24,457
[rank1]:2025-10-31 04:14:05,381 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0414_stage1_step2000.svg
[rank0]:2025-10-31 04:14:05,382 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0414_stage0_step2000.svg
[rank2]:2025-10-31 04:14:05,382 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0414_stage2_step2000.svg
[rank3]:2025-10-31 04:14:05,480 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0414_real_step2000_rank3.svg
[rank3]:> Batch Time: 435.38 ms, GPU Bubble Ratio: 42.21%, 29.61%, 32.21%, 32.52%
[rank3]:2025-10-31 04:14:05,551 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0414_stage3_step2000.svg
[rank2]:2025-10-31 04:14:05,848 - INFO - Avg. fwd time: 14.2836 / Avg. bwd time: 24.0547 / Avg. batch time: 391.2945 (ms) / GPU bubble ratio: 21.62%
[rank3]:2025-10-31 04:14:05,817 - INFO - Avg. fwd time: 16.2688 / Avg. bwd time: 23.5838 / Avg. batch time: 346.8887 (ms) / GPU bubble ratio: 8.09%
[rank1]:2025-10-31 04:14:05,894 - INFO - Avg. fwd time: 16.4260 / Avg. bwd time: 24.9222 / Avg. batch time: 439.0702 (ms) / GPU bubble ratio: 24.66%
[rank0]:2025-10-31 04:14:05,914 - INFO - Avg. fwd time: 14.2666 / Avg. bwd time: 23.5614 / Avg. batch time: 486.7047 (ms) / GPU bubble ratio: 37.82%
[rank0]:2025-10-31 04:15:39,952 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-10-31 04:15:41,884 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1913  memory: 56.98GiB(40.76%)  tps: 8,476  tflops: 395.33  mfu: 39.97%
[rank2]:2025-10-31 04:15:41,871 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1913  memory: 39.23GiB(28.06%)  tps: 8,482  tflops: 395.59  mfu: 40.00%
[rank3]:2025-10-31 04:15:41,860 - INFO -  step: 2050  loss:  2.2451  grad_norm:  0.1913  memory: 47.23GiB(33.78%)  tps: 8,483  tflops: 395.66  mfu: 40.01%
[rank1]:2025-10-31 04:15:41,880 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1913  memory: 49.70GiB(35.55%)  tps: 8,480  tflops: 395.49  mfu: 39.99%
[rank2]:2025-10-31 04:15:42,211 - INFO - Avg. fwd time: 14.2902 / Avg. bwd time: 23.9933 / Avg. batch time: 390.4666 (ms) / GPU bubble ratio: 21.56%
[rank3]:2025-10-31 04:15:42,179 - INFO - Avg. fwd time: 16.2769 / Avg. bwd time: 23.5040 / Avg. batch time: 346.1438 (ms) / GPU bubble ratio: 8.06%
[rank1]:2025-10-31 04:15:42,256 - INFO - Avg. fwd time: 16.4146 / Avg. bwd time: 25.0333 / Avg. batch time: 438.5185 (ms) / GPU bubble ratio: 24.39%
[rank0]:2025-10-31 04:15:42,268 - INFO - Avg. fwd time: 14.2776 / Avg. bwd time: 23.3712 / Avg. batch time: 486.0932 (ms) / GPU bubble ratio: 38.04%
[rank0]:2025-10-31 04:17:15,694 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 04:17:17,601 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.3338  memory: 39.23GiB(28.06%)  tps: 8,557  tflops: 399.12  mfu: 40.36%
[rank3]:2025-10-31 04:17:17,590 - INFO -  step: 2100  loss:  2.2309  grad_norm:  0.3338  memory: 47.23GiB(33.78%)  tps: 8,558  tflops: 399.13  mfu: 40.36%
[rank1]:2025-10-31 04:17:17,610 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.3338  memory: 49.70GiB(35.55%)  tps: 8,557  tflops: 399.12  mfu: 40.36%
[rank0]:2025-10-31 04:17:17,608 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.3338  memory: 56.98GiB(40.76%)  tps: 8,558  tflops: 399.15  mfu: 40.36%
[rank2]:2025-10-31 04:17:17,688 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0417_stage2_step2100.svg
[rank1]:2025-10-31 04:17:17,690 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0417_stage1_step2100.svg
[rank0]:2025-10-31 04:17:17,689 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0417_stage0_step2100.svg
[rank3]:2025-10-31 04:17:17,792 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0417_real_step2100_rank3.svg
[rank3]:> Batch Time: 433.04 ms, GPU Bubble Ratio: 42.40%, 28.77%, 32.07%, 32.17%
[rank3]:2025-10-31 04:17:17,855 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0417_stage3_step2100.svg
[rank3]:2025-10-31 04:17:18,189 - INFO - Avg. fwd time: 16.2857 / Avg. bwd time: 23.4162 / Avg. batch time: 345.3892 (ms) / GPU bubble ratio: 8.04%
[rank2]:2025-10-31 04:17:18,225 - INFO - Avg. fwd time: 14.2969 / Avg. bwd time: 23.9327 / Avg. batch time: 389.6432 (ms) / GPU bubble ratio: 21.51%
[rank1]:2025-10-31 04:17:18,272 - INFO - Avg. fwd time: 16.4042 / Avg. bwd time: 25.1375 / Avg. batch time: 437.9364 (ms) / GPU bubble ratio: 24.11%
[rank0]:2025-10-31 04:17:18,312 - INFO - Avg. fwd time: 14.2891 / Avg. bwd time: 23.1732 / Avg. batch time: 485.4392 (ms) / GPU bubble ratio: 38.26%
[rank0]:2025-10-31 04:18:51,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 04:18:53,847 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2569  memory: 56.98GiB(40.76%)  tps: 8,512  tflops: 397.01  mfu: 40.14%
[rank2]:2025-10-31 04:18:53,838 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2569  memory: 39.23GiB(28.06%)  tps: 8,512  tflops: 397.02  mfu: 40.14%
[rank3]:2025-10-31 04:18:53,826 - INFO -  step: 2150  loss:  2.1494  grad_norm:  0.2569  memory: 47.23GiB(33.78%)  tps: 8,513  tflops: 397.03  mfu: 40.14%
[rank1]:2025-10-31 04:18:53,845 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.2569  memory: 49.70GiB(35.55%)  tps: 8,513  tflops: 397.03  mfu: 40.14%
[rank2]:2025-10-31 04:18:54,178 - INFO - Avg. fwd time: 14.3028 / Avg. bwd time: 23.8740 / Avg. batch time: 388.9639 (ms) / GPU bubble ratio: 21.48%
[rank3]:2025-10-31 04:18:54,148 - INFO - Avg. fwd time: 16.2924 / Avg. bwd time: 23.3497 / Avg. batch time: 344.7937 (ms) / GPU bubble ratio: 8.02%
[rank0]:2025-10-31 04:18:54,241 - INFO - Avg. fwd time: 14.2974 / Avg. bwd time: 23.0214 / Avg. batch time: 484.9097 (ms) / GPU bubble ratio: 38.43%
[rank1]:2025-10-31 04:18:54,225 - INFO - Avg. fwd time: 16.3958 / Avg. bwd time: 25.2205 / Avg. batch time: 437.4606 (ms) / GPU bubble ratio: 23.89%
[rank0]:2025-10-31 04:20:28,008 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-31 04:20:29,941 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.2145  memory: 39.23GiB(28.06%)  tps: 8,524  tflops: 397.57  mfu: 40.20%
[rank2]:2025-10-31 04:20:29,941 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-10-31 04:20:29,927 - INFO -  step: 2200  loss:  1.9882  grad_norm:  0.2145  memory: 47.23GiB(33.78%)  tps: 8,525  tflops: 397.58  mfu: 40.20%
[rank3]:2025-10-31 04:20:29,928 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-31 04:20:29,947 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.2145  memory: 49.70GiB(35.55%)  tps: 8,524  tflops: 397.58  mfu: 40.20%
[rank1]:2025-10-31 04:20:29,947 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-10-31 04:20:29,951 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.2145  memory: 56.98GiB(40.76%)  tps: 8,524  tflops: 397.57  mfu: 40.20%
[rank0]:2025-10-31 04:20:29,951 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-10-31 04:20:46,701 - INFO - validate step: 2200  loss: -1.0000  memory: 49.70GiB(35.55%)  tps: 24,448
[rank0]:2025-10-31 04:20:46,665 - INFO - validate step: 2200  loss: -1.0000  memory: 56.98GiB(40.76%)  tps: 24,506
[rank2]:2025-10-31 04:20:46,715 - INFO - validate step: 2200  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,419
[rank3]:2025-10-31 04:20:46,725 - INFO - validate step: 2200  loss:  0.8957  memory: 47.23GiB(33.78%)  tps: 24,386
[rank1]:2025-10-31 04:20:46,808 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0420_stage1_step2200.svg
[rank0]:2025-10-31 04:20:46,806 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0420_stage0_step2200.svg
[rank2]:2025-10-31 04:20:46,809 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0420_stage2_step2200.svg
[rank3]:2025-10-31 04:20:46,908 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0420_real_step2200_rank3.svg
[rank3]:> Batch Time: 432.37 ms, GPU Bubble Ratio: 42.53%, 28.23%, 32.13%, 32.08%
[rank3]:2025-10-31 04:20:46,971 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0420_stage3_step2200.svg
[rank2]:2025-10-31 04:20:47,253 - INFO - Avg. fwd time: 14.3088 / Avg. bwd time: 23.8155 / Avg. batch time: 388.2403 (ms) / GPU bubble ratio: 21.44%
[rank3]:2025-10-31 04:20:47,226 - INFO - Avg. fwd time: 16.2991 / Avg. bwd time: 23.2754 / Avg. batch time: 344.1603 (ms) / GPU bubble ratio: 8.01%
[rank1]:2025-10-31 04:20:47,300 - INFO - Avg. fwd time: 16.3854 / Avg. bwd time: 25.3198 / Avg. batch time: 436.9577 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-31 04:20:47,315 - INFO - Avg. fwd time: 14.3068 / Avg. bwd time: 22.8489 / Avg. batch time: 484.3438 (ms) / GPU bubble ratio: 38.63%
[rank0]:2025-10-31 04:22:21,010 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-31 04:22:22,933 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1832  memory: 39.23GiB(28.06%)  tps: 8,514  tflops: 397.10  mfu: 40.15%
[rank3]:2025-10-31 04:22:22,919 - INFO -  step: 2250  loss:  2.3618  grad_norm:  0.1832  memory: 47.23GiB(33.78%)  tps: 8,516  tflops: 397.20  mfu: 40.16%
[rank1]:2025-10-31 04:22:22,939 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1832  memory: 49.70GiB(35.55%)  tps: 8,512  tflops: 397.02  mfu: 40.14%
[rank0]:2025-10-31 04:22:22,943 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1832  memory: 56.98GiB(40.76%)  tps: 8,509  tflops: 396.85  mfu: 40.13%
[rank2]:2025-10-31 04:22:23,364 - INFO - Avg. fwd time: 14.3143 / Avg. bwd time: 23.7625 / Avg. batch time: 387.5251 (ms) / GPU bubble ratio: 21.40%
[rank3]:2025-10-31 04:22:23,324 - INFO - Avg. fwd time: 16.3053 / Avg. bwd time: 23.2107 / Avg. batch time: 343.5258 (ms) / GPU bubble ratio: 7.98%
[rank1]:2025-10-31 04:22:23,413 - INFO - Avg. fwd time: 16.3765 / Avg. bwd time: 25.4095 / Avg. batch time: 436.4725 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-10-31 04:22:23,455 - INFO - Avg. fwd time: 14.3157 / Avg. bwd time: 22.6878 / Avg. batch time: 483.8059 (ms) / GPU bubble ratio: 38.81%
[rank0]:2025-10-31 04:23:56,522 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 04:23:58,442 - INFO -  step: 2300  loss:  2.3603  grad_norm:  0.1347  memory: 47.23GiB(33.78%)  tps: 8,576  tflops: 399.99  mfu: 40.44%
[rank0]:2025-10-31 04:23:58,466 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1347  memory: 56.98GiB(40.76%)  tps: 8,576  tflops: 399.98  mfu: 40.44%
[rank2]:2025-10-31 04:23:58,456 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1347  memory: 39.23GiB(28.06%)  tps: 8,576  tflops: 399.99  mfu: 40.44%
[rank1]:2025-10-31 04:23:58,462 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1347  memory: 49.70GiB(35.55%)  tps: 8,576  tflops: 399.98  mfu: 40.44%
[rank1]:2025-10-31 04:23:58,548 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0423_stage1_step2300.svg
[rank0]:2025-10-31 04:23:58,545 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0423_stage0_step2300.svg
[rank2]:2025-10-31 04:23:58,549 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0423_stage2_step2300.svg
[rank3]:2025-10-31 04:23:58,651 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0423_real_step2300_rank3.svg
[rank3]:> Batch Time: 431.86 ms, GPU Bubble Ratio: 42.59%, 26.94%, 32.14%, 32.05%
[rank3]:2025-10-31 04:23:58,716 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0423_stage3_step2300.svg
[rank2]:2025-10-31 04:23:59,001 - INFO - Avg. fwd time: 14.3193 / Avg. bwd time: 23.7144 / Avg. batch time: 386.8819 (ms) / GPU bubble ratio: 21.35%
[rank1]:2025-10-31 04:23:59,048 - INFO - Avg. fwd time: 16.3691 / Avg. bwd time: 25.4838 / Avg. batch time: 436.0258 (ms) / GPU bubble ratio: 23.21%
[rank3]:2025-10-31 04:23:58,971 - INFO - Avg. fwd time: 16.3114 / Avg. bwd time: 23.1444 / Avg. batch time: 342.9464 (ms) / GPU bubble ratio: 7.96%
[rank0]:2025-10-31 04:23:59,062 - INFO - Avg. fwd time: 14.3233 / Avg. bwd time: 22.5493 / Avg. batch time: 483.3037 (ms) / GPU bubble ratio: 38.97%
[rank0]:2025-10-31 04:25:32,692 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-31 04:25:34,636 - INFO -  step: 2350  loss:  2.4248  grad_norm:  1.6297  memory: 47.23GiB(33.78%)  tps: 8,516  tflops: 397.20  mfu: 40.16%
[rank0]:2025-10-31 04:25:34,654 - INFO -  step: 2350  loss: -4.0000  grad_norm:  1.6297  memory: 56.98GiB(40.76%)  tps: 8,517  tflops: 397.22  mfu: 40.16%
[rank2]:2025-10-31 04:25:34,642 - INFO -  step: 2350  loss: -4.0000  grad_norm:  1.6297  memory: 39.23GiB(28.06%)  tps: 8,517  tflops: 397.23  mfu: 40.16%
[rank1]:2025-10-31 04:25:34,650 - INFO -  step: 2350  loss: -4.0000  grad_norm:  1.6297  memory: 49.70GiB(35.55%)  tps: 8,517  tflops: 397.22  mfu: 40.16%
[rank2]:2025-10-31 04:25:34,995 - INFO - Avg. fwd time: 14.3243 / Avg. bwd time: 23.6662 / Avg. batch time: 386.2132 (ms) / GPU bubble ratio: 21.31%
[rank3]:2025-10-31 04:25:34,966 - INFO - Avg. fwd time: 16.3182 / Avg. bwd time: 23.0785 / Avg. batch time: 342.3416 (ms) / GPU bubble ratio: 7.94%
[rank0]:2025-10-31 04:25:35,059 - INFO - Avg. fwd time: 14.3320 / Avg. bwd time: 22.3957 / Avg. batch time: 482.8030 (ms) / GPU bubble ratio: 39.14%
[rank1]:2025-10-31 04:25:35,041 - INFO - Avg. fwd time: 16.3609 / Avg. bwd time: 25.5671 / Avg. batch time: 435.5849 (ms) / GPU bubble ratio: 22.99%
[rank3]:2025-10-31 04:27:01,303 - WARNING - Dataset alpaca is being re-looped
[rank2]:2025-10-31 04:27:03,329 - WARNING - Dataset medical is being re-looped
[rank1]:2025-10-31 04:27:07,212 - WARNING - Dataset medical is being re-looped
[rank0]:2025-10-31 04:27:08,669 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-31 04:27:09,164 - WARNING - Dataset medical is being re-looped
[rank3]:2025-10-31 04:27:10,602 - INFO -  step: 2400  loss:  2.0541  grad_norm:  0.2423  memory: 47.23GiB(33.78%)  tps: 8,536  tflops: 398.14  mfu: 40.26%
[rank3]:2025-10-31 04:27:10,603 - INFO -  final step: 2400  loss:  2.0541  grad_norm:  0.2423  tps: 8,275  tflops: 385.96  mfu: 38.08%
[rank3]:2025-10-31 04:27:10,603 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 04:27:10,624 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.2423  memory: 56.98GiB(40.76%)  tps: 8,536  tflops: 398.12  mfu: 40.25%
[rank0]:2025-10-31 04:27:10,625 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.2423  tps: 8,272  tflops: 385.83  mfu: 38.07%
[rank0]:2025-10-31 04:27:10,625 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-10-31 04:27:10,614 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.2423  memory: 39.23GiB(28.06%)  tps: 8,536  tflops: 398.11  mfu: 40.25%
[rank2]:2025-10-31 04:27:10,614 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.2423  tps: 8,273  tflops: 385.83  mfu: 38.07%
[rank2]:2025-10-31 04:27:10,614 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-10-31 04:27:10,620 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.2423  memory: 49.70GiB(35.55%)  tps: 8,536  tflops: 398.12  mfu: 40.25%
[rank1]:2025-10-31 04:27:10,621 - INFO -  final step: 2400  loss: -4.0000  grad_norm:  0.2423  tps: 8,272  tflops: 385.82  mfu: 38.07%
[rank1]:2025-10-31 04:27:10,621 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-10-31 04:27:27,232 - INFO - validate step: 2400  loss: -1.0000  memory: 56.98GiB(40.76%)  tps: 24,664
[rank0]:2025-10-31 04:27:27,233 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-10-31 04:27:27,238 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank2]:2025-10-31 04:27:27,282 - INFO - validate step: 2400  loss: -1.0000  memory: 39.23GiB(28.06%)  tps: 24,576
[rank2]:2025-10-31 04:27:27,282 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-10-31 04:27:27,287 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank1]:2025-10-31 04:27:27,268 - INFO - validate step: 2400  loss: -1.0000  memory: 49.70GiB(35.55%)  tps: 24,605
[rank1]:2025-10-31 04:27:27,268 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-10-31 04:27:27,273 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank3]:2025-10-31 04:27:27,291 - INFO - validate step: 2400  loss:  0.8851  memory: 47.23GiB(33.78%)  tps: 24,547
[rank3]:2025-10-31 04:27:27,291 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-10-31 04:27:27,294 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 2400.
[rank0]:2025-10-31 04:27:37,536 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-10-31 04:27:37,633 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank1/251031_0427_stage1_final2400.svg
[rank0]:2025-10-31 04:27:37,648 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank0/251031_0427_stage0_final2400.svg
[rank2]:2025-10-31 04:27:37,641 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank2/251031_0427_stage2_final2400.svg
[rank3]:2025-10-31 04:27:37,762 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0427_real_final2400_rank3.svg
[rank3]:> Batch Time: 431.36 ms, GPU Bubble Ratio: 42.63%, 25.81%, 32.19%, 32.03%
[rank2]:2025-10-31 04:27:37,902 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/frozen_params_histogram/251031_0427_rank2_stage2.svg
[rank2]:	> Counts Sum: 2286200, Total Sum: 4907520 (46.59%), Ratio(%) per element: [48.29, 48.18, 47.24, 47.94, 46.94, 46.12, 47.06, 46.88, 45.48, 47.53, 46.94, 46.47, 46.65, 45.71, 48.06, 46.0, 44.71, 46.65, 46.0, 45.65, 45.42, 44.48, 46.24, 44.07, 46.53, 46.83, 46.94, 45.65, 46.3, 46.18, 47.41, 45.01, 47.94, 47.35, 48.94, 45.53, 46.88, 48.0, 47.71, 46.77, 47.06, 46.94, 46.24, 46.71, 48.35, 46.3, 47.12, 45.53, 46.83, 47.3, 46.88, 46.71, 46.18, 47.76, 45.77, 45.83, 46.3, 45.83, 46.06, 46.94, 46.12, 48.18, 47.24, 45.95, 45.36, 47.18, 45.07, 47.82, 45.71, 46.12, 45.65, 46.06]
[rank2]:2025-10-31 04:27:37,902 - INFO - Destroying the purge thread.
[rank1]:2025-10-31 04:27:37,882 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/frozen_params_histogram/251031_0427_rank1_stage1.svg
[rank1]:	> Counts Sum: 2815600, Total Sum: 5520960 (51.00%), Ratio(%) per element: [51.7, 50.99, 51.05, 50.82, 50.93, 50.23, 50.41, 51.17, 50.58, 50.29, 52.34, 50.52, 52.23, 50.11, 50.76, 51.29, 51.64, 50.7, 51.76, 50.0, 51.58, 51.29, 50.82, 50.58, 52.23, 50.93, 51.58, 51.46, 51.4, 51.93, 50.23, 50.46, 50.76, 51.11, 51.23, 51.05, 51.11, 51.29, 50.41, 51.76, 50.41, 51.46, 51.23, 49.88, 49.47, 50.23, 50.05, 51.23, 50.99, 49.94, 51.4, 51.93, 50.99, 50.82, 50.41, 51.4, 51.58, 51.11, 50.93, 51.29, 50.0, 50.46, 50.99, 51.05, 50.93, 50.7, 51.17, 51.64, 51.76, 51.17, 50.82, 51.05, 50.99, 51.17, 51.11, 51.52, 50.7, 52.23, 50.46, 50.35, 50.76]
[rank1]:2025-10-31 04:27:37,883 - INFO - Destroying the purge thread.
[rank0]:2025-10-31 04:27:37,962 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/frozen_params_histogram/251031_0427_rank0_stage0.svg
[rank0]:	> Counts Sum: 3854800, Total Sum: 4975680 (77.47%), Ratio(%) per element: [71.53, 70.83, 69.95, 71.53, 72.18, 69.89, 69.89, 72.24, 70.59, 71.59, 70.65, 70.59, 72.0, 72.18, 73.94, 72.82, 72.65, 72.71, 72.94, 72.3, 73.0, 72.76, 75.58, 74.11, 74.94, 74.7, 73.65, 74.47, 75.35, 75.05, 74.88, 75.46, 76.23, 76.17, 77.17, 75.52, 76.99, 77.58, 76.76, 78.57, 76.76, 79.4, 78.57, 78.93, 78.93, 79.34, 79.16, 79.34, 80.1, 80.57, 80.51, 80.75, 81.16, 81.39, 80.98, 83.33, 81.16, 82.51, 82.86, 83.03, 83.09, 83.5, 83.86, 83.56, 84.68, 84.62, 84.62, 84.91, 85.44, 85.79, 86.67, 86.79, 86.91]
[rank0]:2025-10-31 04:27:37,963 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-10-31 04:27:37,963 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/pipeline_schedule/251031_0427_thry_final2400_rank3.svg
[rank3]:> Batch Time: 514.03 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-10-31 04:27:38,050 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/freeze_ratio_history/rank3/251031_0427_stage3_final2400.svg
[rank3]:2025-10-31 04:27:38,360 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1/frozen_params_histogram/251031_0427_rank3_stage3.svg
[rank3]:	> Counts Sum: 544880, Total Sum: 4430400 (12.30%), Ratio(%) per element: [13.14, 12.03, 12.67, 12.85, 11.56, 12.61, 12.38, 13.38, 13.02, 12.61, 12.03, 12.14, 12.61, 12.91, 12.96, 12.26, 11.97, 12.55, 12.38, 12.79, 13.67, 11.73, 12.26, 12.08, 11.44, 12.79, 12.14, 11.03, 13.67, 13.2, 14.26, 12.32, 11.2, 11.73, 12.96, 11.15, 13.67, 13.32, 12.08, 12.32, 12.85, 12.96, 12.55, 11.79, 11.44, 11.79, 11.38, 11.73, 10.85, 11.91, 11.44, 11.09, 11.79, 11.79, 11.73, 12.73, 10.32, 10.97, 11.61, 12.44, 12.96, 12.85, 12.73, 11.79, 13.73]
[rank3]:2025-10-31 04:27:38,361 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–†â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–‚â–â–‚â–â–â–‚â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–â–â–â–‚â–‚â–â–‚â–â–â–â–‚â–‚â–â–â–â–‚â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–„â–‚â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.97988
[rank3]:wandb:               final/avg_loss 2.05406
[rank3]:wandb:             final/avg_mfu(%) 38.07663
[rank3]:wandb:             final/avg_tflops 385.95847
[rank3]:wandb:    final/avg_throughput(tps) 8275.23893
[rank3]:wandb:              final/grad_norm 0.24226
[rank3]:wandb:               final/max_loss 2.05406
[rank3]:wandb:                    grad_norm 0.24226
[rank3]:wandb: loss_metrics/global_avg_loss 2.05406
[rank3]:wandb: loss_metrics/global_max_loss 2.05406
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1030_1F1B_fullrand7_dm1 at: https://wandb.ai/orangingq/torchtitan/runs/cywvnh5c
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1030_1F1B_fullrand7_dm1/20251031-0303/wandb/run-20251031_030317-cywvnh5c/logs
[rank0]:2025-10-31 04:27:39,963 - INFO - Training completed
[rank0]:2025-10-31 04:27:39,963 - INFO - Destroying the purge thread.
[rank1]:2025-10-31 04:27:40,183 - INFO - Process group destroyed
[rank3]:2025-10-31 04:27:40,205 - INFO - Process group destroyed
[rank2]:2025-10-31 04:27:40,287 - INFO - Process group destroyed
[rank0]:2025-10-31 04:27:40,466 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.9', 'layers.11', 'layers.8', 'layers.14', 'layers.16', 'layers.10', 'layers.15', 'layers.12'}
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.22', 'layers.23', 'layers.21', 'layers.19', 'layers.18', 'layers.20', 'layers.17'}
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.6', 'tok_embeddings', 'layers.0', 'layers.3', 'layers.1', 'layers.2', 'layers.4', 'layers.7'}
[rank3]:Stage 3: Modules to keep: {'norm', 'layers.28', 'layers.26', 'layers.30', 'layers.31', 'output', 'layers.25', 'layers.27', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_1F1B_fullrand7_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1030_1F1B_fullrand7_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1030_1F1B_fullrand7_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_1F1B_fullrand7_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_1F1B_fullrand7_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_1F1B_fullrand7_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_1F1B_fullrand7_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1030_1F1B_fullrand7_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: fullrand7
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
