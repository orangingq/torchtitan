
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 07:07:28 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 07:07:29.572000 672812 site-packages/torch/distributed/run.py:811] 
W1102 07:07:29.572000 672812 site-packages/torch/distributed/run.py:811] *****************************************
W1102 07:07:29.572000 672812 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 07:07:29.572000 672812 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-11-02 07:07:36,462 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 07:07:36,578 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 07:07:36,652 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 07:07:36,623 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 07:07:37,178 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 07:07:37,180 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 07:07:37,185 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-02 07:07:37,527 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 07:07:37,530 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 07:07:37,590 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 07:07:37,592 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 07:07:37,597 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 07:07:37,600 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 07:07:39,126 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 07:07:39,406 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-02 07:07:41,175 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-02 07:07:41,425 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 07:07:41,495 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-11-02 07:07:41,457 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 07:07:41,441 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 07:07:41,517 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 07:07:41,517 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 07:07:41,554 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 07:07:41,554 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 07:07:41,548 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 07:07:41,548 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-02 07:07:41,836 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 07:07:41,837 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-11-02 07:07:41,889 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 07:07:41,889 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2025-11-02 07:07:41,911 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 07:07:41,911 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 5wjij0gs
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_nofreeze_h200/20251102-0707/wandb/run-20251102_070742-5wjij0gs
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/5wjij0gs
[rank3]:2025-11-02 07:07:43,341 - INFO - WandB logging enabled
[rank3]:2025-11-02 07:07:43,347 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 07:07:43,418 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 07:07:43,418 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-02 07:07:43,657 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_nofreeze_h200
[rank0]:2025-11-02 07:07:43,657 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 07:07:43,657 - INFO - Preparing c4_validation dataset from allenai/c4
[rank2]:2025-11-02 07:07:43,638 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 07:07:43,638 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-02 07:07:43,625 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 07:07:43,626 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 07:07:43,638 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 07:07:47,033 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 07:07:47,033 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 07:07:55,988 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 07:07:55,988 - INFO - Finished loading the checkpoint in 8.95 seconds.
[rank0]:2025-11-02 07:07:55,988 - INFO - Training starts at step 1
[rank0]:2025-11-02 07:07:59,879 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 891  tflops: 41.56  mfu: 4.20%
[rank0]:2025-11-02 07:07:59,880 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 07:07:59,901 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 993  tflops: 46.30  mfu: 4.68%
[rank3]:2025-11-02 07:07:59,901 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 07:07:59,869 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 893  tflops: 41.67  mfu: 4.21%
[rank2]:2025-11-02 07:07:59,870 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 07:07:59,860 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 893  tflops: 41.67  mfu: 4.21%
[rank1]:2025-11-02 07:07:59,860 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 07:10:06,475 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:10:08,934 - INFO - Avg. fwd time: 13.1302 / Avg. bwd time: 36.0015 / Avg. batch time: 524.4667 (ms) / GPU bubble ratio: 25.06%
[rank3]:2025-11-02 07:10:08,904 - INFO - Avg. fwd time: 14.6677 / Avg. bwd time: 42.1384 / Avg. batch time: 471.9878 (ms) / GPU bubble ratio: 3.72%
[rank0]:2025-11-02 07:10:09,012 - INFO - Avg. fwd time: 13.2936 / Avg. bwd time: 37.8696 / Avg. batch time: 639.1102 (ms) / GPU bubble ratio: 35.96%
[rank1]:2025-11-02 07:10:08,980 - INFO - Avg. fwd time: 15.1915 / Avg. bwd time: 41.0704 / Avg. batch time: 584.0408 (ms) / GPU bubble ratio: 22.93%
[rank2]:2025-11-02 07:10:09,131 - INFO -  step: 50  loss: -4.0000  grad_norm: 7277.1768  memory: 38.72GiB(27.69%)  tps: 6,211  tflops: 289.67  mfu: 29.29%
[rank1]:2025-11-02 07:10:09,133 - INFO -  step: 50  loss: -4.0000  grad_norm: 7277.1768  memory: 47.26GiB(33.80%)  tps: 6,210  tflops: 289.65  mfu: 29.29%
[rank3]:2025-11-02 07:10:09,135 - INFO -  step: 50  loss: 12.7733  grad_norm: 7277.1768  memory: 46.37GiB(33.17%)  tps: 6,212  tflops: 289.74  mfu: 29.30%
[rank0]:2025-11-02 07:10:09,137 - INFO -  step: 50  loss: -4.0000  grad_norm: 7277.1768  memory: 54.93GiB(39.29%)  tps: 6,211  tflops: 289.68  mfu: 29.29%
[rank0]:2025-11-02 07:12:18,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:12:20,930 - INFO - Avg. fwd time: 13.1478 / Avg. bwd time: 36.0888 / Avg. batch time: 524.7012 (ms) / GPU bubble ratio: 24.93%
[rank3]:2025-11-02 07:12:20,901 - INFO - Avg. fwd time: 14.7108 / Avg. bwd time: 42.2883 / Avg. batch time: 472.4467 (ms) / GPU bubble ratio: 3.48%
[rank0]:2025-11-02 07:12:21,008 - INFO - Avg. fwd time: 13.2239 / Avg. bwd time: 37.9453 / Avg. batch time: 638.5360 (ms) / GPU bubble ratio: 35.89%
[rank1]:2025-11-02 07:12:20,976 - INFO - Avg. fwd time: 15.0978 / Avg. bwd time: 41.1588 / Avg. batch time: 583.8049 (ms) / GPU bubble ratio: 22.91%
[rank0]:2025-11-02 07:12:21,134 - INFO -  step: 100  loss: -4.0000  grad_norm: 235.2189  memory: 54.93GiB(39.29%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank3]:2025-11-02 07:12:21,132 - INFO -  step: 100  loss:  5.4831  grad_norm: 235.2189  memory: 46.37GiB(33.17%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank2]:2025-11-02 07:12:21,127 - INFO -  step: 100  loss: -4.0000  grad_norm: 235.2189  memory: 38.72GiB(27.69%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank1]:2025-11-02 07:12:21,130 - INFO -  step: 100  loss: -4.0000  grad_norm: 235.2189  memory: 47.26GiB(33.80%)  tps: 6,206  tflops: 289.46  mfu: 29.27%
[rank3]:2025-11-02 07:12:21,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0712_real_step100_rank3.svg
[rank3]:> Batch Time: 621.90 ms, GPU Bubble Ratio: 33.88%, 27.39%, 36.39%, 26.29%
[rank0]:2025-11-02 07:14:30,592 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:14:33,158 - INFO - Avg. fwd time: 13.1508 / Avg. bwd time: 36.1405 / Avg. batch time: 524.8584 (ms) / GPU bubble ratio: 24.87%
[rank3]:2025-11-02 07:14:33,116 - INFO - Avg. fwd time: 14.7162 / Avg. bwd time: 42.3209 / Avg. batch time: 472.4262 (ms) / GPU bubble ratio: 3.41%
[rank0]:2025-11-02 07:14:33,246 - INFO - Avg. fwd time: 13.1978 / Avg. bwd time: 37.9812 / Avg. batch time: 638.4505 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-02 07:14:33,203 - INFO - Avg. fwd time: 15.0570 / Avg. bwd time: 41.1950 / Avg. batch time: 583.8141 (ms) / GPU bubble ratio: 22.92%
[rank0]:2025-11-02 07:14:33,282 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.7828  memory: 54.93GiB(39.29%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank1]:2025-11-02 07:14:33,278 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.7828  memory: 47.26GiB(33.80%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank3]:2025-11-02 07:14:33,279 - INFO -  step: 150  loss:  1.6060  grad_norm: 19.7828  memory: 46.37GiB(33.17%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank2]:2025-11-02 07:14:33,275 - INFO -  step: 150  loss: -4.0000  grad_norm: 19.7828  memory: 38.72GiB(27.69%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank0]:2025-11-02 07:16:42,522 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:16:44,947 - INFO - Avg. fwd time: 14.7109 / Avg. bwd time: 42.3351 / Avg. batch time: 472.3571 (ms) / GPU bubble ratio: 3.39%
[rank2]:2025-11-02 07:16:44,977 - INFO - Avg. fwd time: 13.1435 / Avg. bwd time: 36.1738 / Avg. batch time: 524.7091 (ms) / GPU bubble ratio: 24.81%
[rank0]:2025-11-02 07:16:45,055 - INFO - Avg. fwd time: 13.1906 / Avg. bwd time: 38.0007 / Avg. batch time: 638.2048 (ms) / GPU bubble ratio: 35.83%
[rank1]:2025-11-02 07:16:45,022 - INFO - Avg. fwd time: 15.0388 / Avg. bwd time: 41.2172 / Avg. batch time: 583.6058 (ms) / GPU bubble ratio: 22.88%
[rank3]:2025-11-02 07:16:45,178 - INFO -  step: 200  loss:  0.3537  grad_norm: 57.0242  memory: 46.37GiB(33.17%)  tps: 6,211  tflops: 289.68  mfu: 29.29%
[rank3]:2025-11-02 07:16:45,178 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 07:16:45,174 - INFO -  step: 200  loss: -4.0000  grad_norm: 57.0242  memory: 38.72GiB(27.69%)  tps: 6,211  tflops: 289.67  mfu: 29.29%
[rank2]:2025-11-02 07:16:45,174 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 07:16:45,176 - INFO -  step: 200  loss: -4.0000  grad_norm: 57.0242  memory: 47.26GiB(33.80%)  tps: 6,211  tflops: 289.67  mfu: 29.29%
[rank1]:2025-11-02 07:16:45,176 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 07:16:45,180 - INFO -  step: 200  loss: -4.0000  grad_norm: 57.0242  memory: 54.93GiB(39.29%)  tps: 6,211  tflops: 289.67  mfu: 29.29%
[rank0]:2025-11-02 07:16:45,180 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 07:17:01,841 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,586
[rank3]:2025-11-02 07:17:01,899 - INFO - validate step: 200  loss:  0.2310  memory: 46.37GiB(33.17%)  tps: 24,498
[rank1]:2025-11-02 07:17:01,870 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,536
[rank2]:2025-11-02 07:17:01,883 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,514
[rank3]:2025-11-02 07:17:02,078 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0717_real_step200_rank3.svg
[rank3]:> Batch Time: 620.57 ms, GPU Bubble Ratio: 33.74%, 27.26%, 36.10%, 26.31%
[rank0]:2025-11-02 07:19:11,399 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 07:19:13,892 - INFO - Avg. fwd time: 15.0307 / Avg. bwd time: 41.2316 / Avg. batch time: 583.6304 (ms) / GPU bubble ratio: 22.88%
[rank2]:2025-11-02 07:19:13,846 - INFO - Avg. fwd time: 13.1497 / Avg. bwd time: 36.1965 / Avg. batch time: 524.7792 (ms) / GPU bubble ratio: 24.77%
[rank3]:2025-11-02 07:19:13,817 - INFO - Avg. fwd time: 14.7121 / Avg. bwd time: 42.3448 / Avg. batch time: 472.3455 (ms) / GPU bubble ratio: 3.36%
[rank0]:2025-11-02 07:19:13,924 - INFO - Avg. fwd time: 13.1885 / Avg. bwd time: 38.0145 / Avg. batch time: 638.1970 (ms) / GPU bubble ratio: 35.82%
[rank0]:2025-11-02 07:19:14,048 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2474  memory: 54.93GiB(39.29%)  tps: 6,196  tflops: 289.00  mfu: 29.22%
[rank1]:2025-11-02 07:19:14,044 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2474  memory: 47.26GiB(33.80%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank3]:2025-11-02 07:19:14,046 - INFO -  step: 250  loss:  0.2344  grad_norm:  0.2474  memory: 46.37GiB(33.17%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank2]:2025-11-02 07:19:14,041 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2474  memory: 38.72GiB(27.69%)  tps: 6,199  tflops: 289.11  mfu: 29.23%
[rank0]:2025-11-02 07:21:23,400 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:21:25,914 - INFO - Avg. fwd time: 14.7129 / Avg. bwd time: 42.3535 / Avg. batch time: 472.3575 (ms) / GPU bubble ratio: 3.35%
[rank2]:2025-11-02 07:21:25,956 - INFO - Avg. fwd time: 13.1510 / Avg. bwd time: 36.2057 / Avg. batch time: 524.7392 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-11-02 07:21:26,001 - INFO - Avg. fwd time: 15.0247 / Avg. bwd time: 41.2383 / Avg. batch time: 583.5650 (ms) / GPU bubble ratio: 22.87%
[rank0]:2025-11-02 07:21:26,044 - INFO - Avg. fwd time: 13.1833 / Avg. bwd time: 38.0218 / Avg. batch time: 638.1152 (ms) / GPU bubble ratio: 35.80%
[rank0]:2025-11-02 07:21:26,080 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3120  memory: 54.93GiB(39.29%)  tps: 6,205  tflops: 289.38  mfu: 29.26%
[rank2]:2025-11-02 07:21:26,073 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3120  memory: 38.72GiB(27.69%)  tps: 6,205  tflops: 289.38  mfu: 29.26%
[rank3]:2025-11-02 07:21:26,078 - INFO -  step: 300  loss:  0.2702  grad_norm:  0.3120  memory: 46.37GiB(33.17%)  tps: 6,205  tflops: 289.38  mfu: 29.26%
[rank1]:2025-11-02 07:21:26,076 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3120  memory: 47.26GiB(33.80%)  tps: 6,205  tflops: 289.38  mfu: 29.26%
[rank3]:2025-11-02 07:21:26,256 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0721_real_step300_rank3.svg
[rank3]:> Batch Time: 621.15 ms, GPU Bubble Ratio: 33.79%, 27.30%, 36.23%, 26.31%
[rank0]:2025-11-02 07:23:35,841 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:23:38,313 - INFO - Avg. fwd time: 13.1574 / Avg. bwd time: 36.2177 / Avg. batch time: 524.9346 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-02 07:23:38,283 - INFO - Avg. fwd time: 14.7196 / Avg. bwd time: 42.3676 / Avg. batch time: 472.4858 (ms) / GPU bubble ratio: 3.34%
[rank0]:2025-11-02 07:23:38,391 - INFO - Avg. fwd time: 13.1847 / Avg. bwd time: 38.0293 / Avg. batch time: 638.2910 (ms) / GPU bubble ratio: 35.81%
[rank1]:2025-11-02 07:23:38,358 - INFO - Avg. fwd time: 15.0251 / Avg. bwd time: 41.2456 / Avg. batch time: 583.7493 (ms) / GPU bubble ratio: 22.88%
[rank1]:2025-11-02 07:23:38,511 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3792  memory: 47.26GiB(33.80%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank2]:2025-11-02 07:23:38,508 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3792  memory: 38.72GiB(27.69%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank3]:2025-11-02 07:23:38,513 - INFO -  step: 350  loss:  0.3383  grad_norm:  0.3792  memory: 46.37GiB(33.17%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank0]:2025-11-02 07:23:38,515 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3792  memory: 54.93GiB(39.29%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank0]:2025-11-02 07:25:48,016 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:25:50,487 - INFO - Avg. fwd time: 13.1584 / Avg. bwd time: 36.2230 / Avg. batch time: 524.9660 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-02 07:25:50,457 - INFO - Avg. fwd time: 14.7223 / Avg. bwd time: 42.3782 / Avg. batch time: 472.5573 (ms) / GPU bubble ratio: 3.33%
[rank0]:2025-11-02 07:25:50,566 - INFO - Avg. fwd time: 13.1841 / Avg. bwd time: 38.0322 / Avg. batch time: 638.2931 (ms) / GPU bubble ratio: 35.81%
[rank1]:2025-11-02 07:25:50,533 - INFO - Avg. fwd time: 15.0214 / Avg. bwd time: 41.2472 / Avg. batch time: 583.7627 (ms) / GPU bubble ratio: 22.89%
[rank0]:2025-11-02 07:25:50,689 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3257  memory: 54.93GiB(39.29%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank0]:2025-11-02 07:25:50,689 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 07:25:50,682 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3257  memory: 38.72GiB(27.69%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank2]:2025-11-02 07:25:50,682 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 07:25:50,685 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3257  memory: 47.26GiB(33.80%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank1]:2025-11-02 07:25:50,685 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 07:25:50,687 - INFO -  step: 400  loss:  0.2737  grad_norm:  0.3257  memory: 46.37GiB(33.17%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank3]:2025-11-02 07:25:50,687 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 07:26:05,676 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,330
[rank2]:2025-11-02 07:26:05,721 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,237
[rank3]:2025-11-02 07:26:05,733 - INFO - validate step: 400  loss:  0.2368  memory: 46.37GiB(33.17%)  tps: 27,225
[rank1]:2025-11-02 07:26:05,708 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,266
[rank3]:2025-11-02 07:26:05,913 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0726_real_step400_rank3.svg
[rank3]:> Batch Time: 622.28 ms, GPU Bubble Ratio: 34.00%, 27.47%, 36.25%, 26.24%
[rank0]:2025-11-02 07:28:15,405 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:28:17,914 - INFO - Avg. fwd time: 14.7249 / Avg. bwd time: 42.3891 / Avg. batch time: 472.6398 (ms) / GPU bubble ratio: 3.33%
[rank2]:2025-11-02 07:28:17,957 - INFO - Avg. fwd time: 13.1591 / Avg. bwd time: 36.2295 / Avg. batch time: 525.0909 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-11-02 07:28:18,004 - INFO - Avg. fwd time: 15.0214 / Avg. bwd time: 41.2495 / Avg. batch time: 583.8787 (ms) / GPU bubble ratio: 22.90%
[rank0]:2025-11-02 07:28:18,048 - INFO - Avg. fwd time: 13.1853 / Avg. bwd time: 38.0356 / Avg. batch time: 638.4034 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 07:28:18,083 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2865  memory: 54.93GiB(39.29%)  tps: 6,187  tflops: 288.56  mfu: 29.18%
[rank2]:2025-11-02 07:28:18,077 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2865  memory: 38.72GiB(27.69%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank1]:2025-11-02 07:28:18,079 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2865  memory: 47.26GiB(33.80%)  tps: 6,189  tflops: 288.64  mfu: 29.19%
[rank3]:2025-11-02 07:28:18,081 - INFO -  step: 450  loss:  0.3030  grad_norm:  0.2865  memory: 46.37GiB(33.17%)  tps: 6,190  tflops: 288.69  mfu: 29.19%
[rank0]:2025-11-02 07:30:27,620 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:30:30,052 - INFO - Avg. fwd time: 14.7268 / Avg. bwd time: 42.3946 / Avg. batch time: 472.6810 (ms) / GPU bubble ratio: 3.32%
[rank1]:2025-11-02 07:30:30,129 - INFO - Avg. fwd time: 15.0219 / Avg. bwd time: 41.2525 / Avg. batch time: 583.8875 (ms) / GPU bubble ratio: 22.90%
[rank2]:2025-11-02 07:30:30,082 - INFO - Avg. fwd time: 13.1604 / Avg. bwd time: 36.2346 / Avg. batch time: 525.1040 (ms) / GPU bubble ratio: 24.75%
[rank0]:2025-11-02 07:30:30,161 - INFO - Avg. fwd time: 13.1849 / Avg. bwd time: 38.0385 / Avg. batch time: 638.4080 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 07:30:30,285 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2904  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank3]:2025-11-02 07:30:30,283 - INFO -  step: 500  loss:  0.2965  grad_norm:  0.2904  memory: 46.37GiB(33.17%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank1]:2025-11-02 07:30:30,281 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2904  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank2]:2025-11-02 07:30:30,278 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2904  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.01  mfu: 29.22%
[rank3]:2025-11-02 07:30:30,462 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0730_real_step500_rank3.svg
[rank3]:> Batch Time: 620.16 ms, GPU Bubble Ratio: 33.69%, 27.24%, 36.18%, 26.31%
[rank0]:2025-11-02 07:32:39,714 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:32:42,136 - INFO - Avg. fwd time: 14.7275 / Avg. bwd time: 42.3995 / Avg. batch time: 472.7083 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-11-02 07:32:42,165 - INFO - Avg. fwd time: 13.1622 / Avg. bwd time: 36.2383 / Avg. batch time: 525.1617 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-11-02 07:32:42,211 - INFO - Avg. fwd time: 15.0233 / Avg. bwd time: 41.2549 / Avg. batch time: 583.9417 (ms) / GPU bubble ratio: 22.90%
[rank0]:2025-11-02 07:32:42,244 - INFO - Avg. fwd time: 13.1873 / Avg. bwd time: 38.0404 / Avg. batch time: 638.4601 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 07:32:42,367 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1945  memory: 54.93GiB(39.29%)  tps: 6,202  tflops: 289.27  mfu: 29.25%
[rank2]:2025-11-02 07:32:42,360 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1945  memory: 38.72GiB(27.69%)  tps: 6,202  tflops: 289.27  mfu: 29.25%
[rank1]:2025-11-02 07:32:42,363 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1945  memory: 47.26GiB(33.80%)  tps: 6,202  tflops: 289.27  mfu: 29.25%
[rank3]:2025-11-02 07:32:42,365 - INFO -  step: 550  loss:  0.1769  grad_norm:  0.1945  memory: 46.37GiB(33.17%)  tps: 6,202  tflops: 289.27  mfu: 29.25%
[rank0]:2025-11-02 07:34:52,708 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 07:34:55,363 - INFO - Avg. fwd time: 15.0325 / Avg. bwd time: 41.2689 / Avg. batch time: 584.1896 (ms) / GPU bubble ratio: 22.90%
[rank2]:2025-11-02 07:34:55,316 - INFO - Avg. fwd time: 13.1710 / Avg. bwd time: 36.2523 / Avg. batch time: 525.3890 (ms) / GPU bubble ratio: 24.74%
[rank3]:2025-11-02 07:34:55,273 - INFO - Avg. fwd time: 14.7378 / Avg. bwd time: 42.4203 / Avg. batch time: 472.9447 (ms) / GPU bubble ratio: 3.32%
[rank0]:2025-11-02 07:34:55,407 - INFO - Avg. fwd time: 13.1968 / Avg. bwd time: 38.0503 / Avg. batch time: 638.7222 (ms) / GPU bubble ratio: 35.81%
[rank1]:2025-11-02 07:34:55,439 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6487  memory: 47.26GiB(33.80%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank1]:2025-11-02 07:34:55,439 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 07:34:55,436 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6487  memory: 38.72GiB(27.69%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank2]:2025-11-02 07:34:55,436 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 07:34:55,441 - INFO -  step: 600  loss:  0.5276  grad_norm:  0.6487  memory: 46.37GiB(33.17%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank3]:2025-11-02 07:34:55,441 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 07:34:55,443 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6487  memory: 54.93GiB(39.29%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank0]:2025-11-02 07:34:55,443 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 07:35:10,314 - INFO - validate step: 600  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,544
[rank1]:2025-11-02 07:35:10,344 - INFO - validate step: 600  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,481
[rank3]:2025-11-02 07:35:10,371 - INFO - validate step: 600  loss:  0.2544  memory: 46.37GiB(33.17%)  tps: 27,436
[rank2]:2025-11-02 07:35:10,357 - INFO - validate step: 600  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,452
[rank3]:2025-11-02 07:35:10,549 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0735_real_step600_rank3.svg
[rank3]:> Batch Time: 628.11 ms, GPU Bubble Ratio: 34.04%, 27.43%, 36.40%, 26.23%
[rank0]:2025-11-02 07:37:21,990 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 07:37:24,472 - INFO - Avg. fwd time: 13.1881 / Avg. bwd time: 36.2710 / Avg. batch time: 525.8422 (ms) / GPU bubble ratio: 24.75%
[rank3]:2025-11-02 07:37:24,443 - INFO - Avg. fwd time: 14.7561 / Avg. bwd time: 42.4523 / Avg. batch time: 473.3406 (ms) / GPU bubble ratio: 3.31%
[rank0]:2025-11-02 07:37:24,550 - INFO - Avg. fwd time: 13.2111 / Avg. bwd time: 38.0624 / Avg. batch time: 639.2263 (ms) / GPU bubble ratio: 35.83%
[rank1]:2025-11-02 07:37:24,517 - INFO - Avg. fwd time: 15.0476 / Avg. bwd time: 41.2891 / Avg. batch time: 584.6721 (ms) / GPU bubble ratio: 22.92%
[rank1]:2025-11-02 07:37:24,670 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4739  memory: 47.26GiB(33.80%)  tps: 6,099  tflops: 284.44  mfu: 28.76%
[rank3]:2025-11-02 07:37:24,672 - INFO -  step: 650  loss:  0.3283  grad_norm:  0.4739  memory: 46.37GiB(33.17%)  tps: 6,100  tflops: 284.50  mfu: 28.77%
[rank2]:2025-11-02 07:37:24,667 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4739  memory: 38.72GiB(27.69%)  tps: 6,099  tflops: 284.47  mfu: 28.76%
[rank0]:2025-11-02 07:37:24,674 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4739  memory: 54.93GiB(39.29%)  tps: 6,097  tflops: 284.37  mfu: 28.75%
[rank0]:2025-11-02 07:39:36,157 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:39:38,633 - INFO - Avg. fwd time: 14.7713 / Avg. bwd time: 42.4806 / Avg. batch time: 473.6802 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-11-02 07:39:38,663 - INFO - Avg. fwd time: 13.2017 / Avg. bwd time: 36.2862 / Avg. batch time: 526.1829 (ms) / GPU bubble ratio: 24.76%
[rank0]:2025-11-02 07:39:38,742 - INFO - Avg. fwd time: 13.2232 / Avg. bwd time: 38.0718 / Avg. batch time: 639.6081 (ms) / GPU bubble ratio: 35.84%
[rank1]:2025-11-02 07:39:38,709 - INFO - Avg. fwd time: 15.0597 / Avg. bwd time: 41.3056 / Avg. batch time: 585.0366 (ms) / GPU bubble ratio: 22.92%
[rank0]:2025-11-02 07:39:38,865 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4358  memory: 54.93GiB(39.29%)  tps: 6,105  tflops: 284.73  mfu: 28.79%
[rank3]:2025-11-02 07:39:38,863 - INFO -  step: 700  loss:  0.4243  grad_norm:  0.4358  memory: 46.37GiB(33.17%)  tps: 6,105  tflops: 284.73  mfu: 28.79%
[rank2]:2025-11-02 07:39:38,858 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4358  memory: 38.72GiB(27.69%)  tps: 6,105  tflops: 284.73  mfu: 28.79%
[rank1]:2025-11-02 07:39:38,861 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4358  memory: 47.26GiB(33.80%)  tps: 6,105  tflops: 284.73  mfu: 28.79%
[rank3]:2025-11-02 07:39:39,047 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0739_real_step700_rank3.svg
[rank3]:> Batch Time: 629.09 ms, GPU Bubble Ratio: 34.15%, 27.58%, 36.32%, 26.20%
[rank0]:2025-11-02 07:41:49,879 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:41:52,408 - INFO - Avg. fwd time: 14.7814 / Avg. bwd time: 42.4994 / Avg. batch time: 473.9048 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-02 07:41:52,451 - INFO - Avg. fwd time: 13.2096 / Avg. bwd time: 36.2949 / Avg. batch time: 526.4465 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 07:41:52,498 - INFO - Avg. fwd time: 15.0676 / Avg. bwd time: 41.3172 / Avg. batch time: 585.3132 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 07:41:52,543 - INFO - Avg. fwd time: 13.2300 / Avg. bwd time: 38.0776 / Avg. batch time: 639.8935 (ms) / GPU bubble ratio: 35.85%
[rank0]:2025-11-02 07:41:52,578 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.3180  memory: 54.93GiB(39.29%)  tps: 6,127  tflops: 285.74  mfu: 28.89%
[rank2]:2025-11-02 07:41:52,572 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.3180  memory: 38.72GiB(27.69%)  tps: 6,127  tflops: 285.74  mfu: 28.89%
[rank1]:2025-11-02 07:41:52,574 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.3180  memory: 47.26GiB(33.80%)  tps: 6,127  tflops: 285.74  mfu: 28.89%
[rank3]:2025-11-02 07:41:52,576 - INFO -  step: 750  loss:  0.1842  grad_norm:  0.3180  memory: 46.37GiB(33.17%)  tps: 6,127  tflops: 285.75  mfu: 28.89%
[rank0]:2025-11-02 07:44:02,228 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:44:04,704 - INFO - Avg. fwd time: 14.7801 / Avg. bwd time: 42.5002 / Avg. batch time: 473.8943 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-11-02 07:44:04,780 - INFO - Avg. fwd time: 15.0655 / Avg. bwd time: 41.3174 / Avg. batch time: 585.2795 (ms) / GPU bubble ratio: 22.93%
[rank2]:2025-11-02 07:44:04,734 - INFO - Avg. fwd time: 13.2091 / Avg. bwd time: 36.2964 / Avg. batch time: 526.4153 (ms) / GPU bubble ratio: 24.77%
[rank0]:2025-11-02 07:44:04,812 - INFO - Avg. fwd time: 13.2284 / Avg. bwd time: 38.0779 / Avg. batch time: 639.8563 (ms) / GPU bubble ratio: 35.85%
[rank0]:2025-11-02 07:44:04,935 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4890  memory: 54.93GiB(39.29%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank0]:2025-11-02 07:44:04,935 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 07:44:04,931 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4890  memory: 47.26GiB(33.80%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank1]:2025-11-02 07:44:04,931 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 07:44:04,933 - INFO -  step: 800  loss:  0.3727  grad_norm:  0.4890  memory: 46.37GiB(33.17%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank2]:2025-11-02 07:44:04,929 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4890  memory: 38.72GiB(27.69%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank2]:2025-11-02 07:44:04,929 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 07:44:04,934 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 07:44:19,819 - INFO - validate step: 800  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,521
[rank2]:2025-11-02 07:44:19,862 - INFO - validate step: 800  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,429
[rank3]:2025-11-02 07:44:19,877 - INFO - validate step: 800  loss:  0.2684  memory: 46.37GiB(33.17%)  tps: 27,412
[rank1]:2025-11-02 07:44:19,850 - INFO - validate step: 800  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,456
[rank3]:2025-11-02 07:44:20,053 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0744_real_step800_rank3.svg
[rank3]:> Batch Time: 621.95 ms, GPU Bubble Ratio: 33.90%, 27.43%, 36.28%, 26.28%
[rank0]:2025-11-02 07:46:30,096 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:46:32,524 - INFO - Avg. fwd time: 14.7834 / Avg. bwd time: 42.5073 / Avg. batch time: 473.9711 (ms) / GPU bubble ratio: 3.30%
[rank0]:2025-11-02 07:46:32,632 - INFO - Avg. fwd time: 13.2306 / Avg. bwd time: 38.0799 / Avg. batch time: 639.9594 (ms) / GPU bubble ratio: 35.86%
[rank2]:2025-11-02 07:46:32,554 - INFO - Avg. fwd time: 13.2120 / Avg. bwd time: 36.3002 / Avg. batch time: 526.5137 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 07:46:32,600 - INFO - Avg. fwd time: 15.0670 / Avg. bwd time: 41.3188 / Avg. batch time: 585.3814 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 07:46:32,755 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2713  memory: 54.93GiB(39.29%)  tps: 6,162  tflops: 287.42  mfu: 29.06%
[rank2]:2025-11-02 07:46:32,748 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2713  memory: 38.72GiB(27.69%)  tps: 6,165  tflops: 287.52  mfu: 29.07%
[rank3]:2025-11-02 07:46:32,753 - INFO -  step: 850  loss:  0.1332  grad_norm:  0.2713  memory: 46.37GiB(33.17%)  tps: 6,165  tflops: 287.55  mfu: 29.07%
[rank1]:2025-11-02 07:46:32,751 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2713  memory: 47.26GiB(33.80%)  tps: 6,164  tflops: 287.49  mfu: 29.07%
[rank0]:2025-11-02 07:48:41,357 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:48:43,890 - INFO - Avg. fwd time: 14.7773 / Avg. bwd time: 42.4982 / Avg. batch time: 473.8424 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-02 07:48:43,934 - INFO - Avg. fwd time: 13.2065 / Avg. bwd time: 36.2950 / Avg. batch time: 526.3558 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-11-02 07:48:43,982 - INFO - Avg. fwd time: 15.0604 / Avg. bwd time: 41.3111 / Avg. batch time: 585.2100 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 07:48:44,028 - INFO - Avg. fwd time: 13.2235 / Avg. bwd time: 38.0752 / Avg. batch time: 639.7763 (ms) / GPU bubble ratio: 35.85%
[rank3]:2025-11-02 07:48:44,061 - INFO -  step: 900  loss:  0.2180  grad_norm:  0.2837  memory: 46.37GiB(33.17%)  tps: 6,239  tflops: 290.98  mfu: 29.42%
[rank1]:2025-11-02 07:48:44,059 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2837  memory: 47.26GiB(33.80%)  tps: 6,239  tflops: 290.98  mfu: 29.42%
[rank2]:2025-11-02 07:48:44,056 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2837  memory: 38.72GiB(27.69%)  tps: 6,239  tflops: 290.98  mfu: 29.42%
[rank0]:2025-11-02 07:48:44,063 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2837  memory: 54.93GiB(39.29%)  tps: 6,239  tflops: 290.98  mfu: 29.42%
[rank3]:2025-11-02 07:48:44,238 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0748_real_step900_rank3.svg
[rank3]:> Batch Time: 622.48 ms, GPU Bubble Ratio: 33.96%, 27.39%, 36.32%, 26.25%
[rank0]:2025-11-02 07:50:53,868 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 07:50:56,311 - INFO - Avg. fwd time: 14.7783 / Avg. bwd time: 42.5006 / Avg. batch time: 473.8643 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-02 07:50:56,341 - INFO - Avg. fwd time: 13.2066 / Avg. bwd time: 36.2961 / Avg. batch time: 526.3956 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 07:50:56,387 - INFO - Avg. fwd time: 15.0609 / Avg. bwd time: 41.3121 / Avg. batch time: 585.2491 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 07:50:56,420 - INFO - Avg. fwd time: 13.2229 / Avg. bwd time: 38.0758 / Avg. batch time: 639.8115 (ms) / GPU bubble ratio: 35.86%
[rank3]:2025-11-02 07:50:56,540 - INFO -  step: 950  loss:  0.3503  grad_norm:  0.6493  memory: 46.37GiB(33.17%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank1]:2025-11-02 07:50:56,538 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6493  memory: 47.26GiB(33.80%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank2]:2025-11-02 07:50:56,535 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6493  memory: 38.72GiB(27.69%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank0]:2025-11-02 07:50:56,542 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6493  memory: 54.93GiB(39.29%)  tps: 6,184  tflops: 288.40  mfu: 29.16%
[rank0]:2025-11-02 07:53:06,564 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:53:09,027 - INFO - Avg. fwd time: 13.2093 / Avg. bwd time: 36.3002 / Avg. batch time: 526.4458 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-11-02 07:53:08,997 - INFO - Avg. fwd time: 14.7812 / Avg. bwd time: 42.5061 / Avg. batch time: 473.9271 (ms) / GPU bubble ratio: 3.30%
[rank1]:2025-11-02 07:53:09,073 - INFO - Avg. fwd time: 15.0639 / Avg. bwd time: 41.3168 / Avg. batch time: 585.3044 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 07:53:09,106 - INFO - Avg. fwd time: 13.2258 / Avg. bwd time: 38.0793 / Avg. batch time: 639.8698 (ms) / GPU bubble ratio: 35.86%
[rank2]:2025-11-02 07:53:09,220 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2096  memory: 38.72GiB(27.69%)  tps: 6,174  tflops: 287.96  mfu: 29.12%
[rank2]:2025-11-02 07:53:09,220 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 07:53:09,225 - INFO -  step: 1000  loss:  0.1735  grad_norm:  0.2096  memory: 46.37GiB(33.17%)  tps: 6,174  tflops: 287.96  mfu: 29.12%
[rank3]:2025-11-02 07:53:09,225 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 07:53:09,223 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2096  memory: 47.26GiB(33.80%)  tps: 6,174  tflops: 287.96  mfu: 29.12%
[rank1]:2025-11-02 07:53:09,223 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 07:53:09,227 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2096  memory: 54.93GiB(39.29%)  tps: 6,174  tflops: 287.96  mfu: 29.12%
[rank0]:2025-11-02 07:53:09,227 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 07:53:24,172 - INFO - validate step: 1000  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,395
[rank1]:2025-11-02 07:53:24,159 - INFO - validate step: 1000  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,424
[rank0]:2025-11-02 07:53:24,129 - INFO - validate step: 1000  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,487
[rank3]:2025-11-02 07:53:24,186 - INFO - validate step: 1000  loss:  0.2706  memory: 46.37GiB(33.17%)  tps: 27,378
[rank3]:2025-11-02 07:53:24,366 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0753_real_step1000_rank3.svg
[rank3]:> Batch Time: 623.34 ms, GPU Bubble Ratio: 33.91%, 27.41%, 36.28%, 26.26%
[rank0]:2025-11-02 07:55:33,710 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 07:55:36,281 - INFO - Avg. fwd time: 14.7798 / Avg. bwd time: 42.5041 / Avg. batch time: 473.8954 (ms) / GPU bubble ratio: 3.30%
[rank2]:2025-11-02 07:55:36,326 - INFO - Avg. fwd time: 13.2080 / Avg. bwd time: 36.2999 / Avg. batch time: 526.4291 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-11-02 07:55:36,376 - INFO - Avg. fwd time: 15.0635 / Avg. bwd time: 41.3185 / Avg. batch time: 585.2902 (ms) / GPU bubble ratio: 22.93%
[rank3]:2025-11-02 07:55:36,455 - INFO -  step: 1050  loss:  0.2899  grad_norm:  0.5649  memory: 46.37GiB(33.17%)  tps: 6,194  tflops: 288.87  mfu: 29.21%
[rank2]:2025-11-02 07:55:36,451 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5649  memory: 38.72GiB(27.69%)  tps: 6,193  tflops: 288.84  mfu: 29.21%
[rank1]:2025-11-02 07:55:36,454 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5649  memory: 47.26GiB(33.80%)  tps: 6,192  tflops: 288.81  mfu: 29.20%
[rank0]:2025-11-02 07:55:36,422 - INFO - Avg. fwd time: 13.2238 / Avg. bwd time: 38.0785 / Avg. batch time: 639.8516 (ms) / GPU bubble ratio: 35.86%
[rank0]:2025-11-02 07:55:36,457 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5649  memory: 54.93GiB(39.29%)  tps: 6,191  tflops: 288.73  mfu: 29.19%
[rank0]:2025-11-02 07:57:48,252 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 07:57:50,738 - INFO - Avg. fwd time: 13.2176 / Avg. bwd time: 36.3112 / Avg. batch time: 526.6808 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 07:57:50,784 - INFO - Avg. fwd time: 15.0749 / Avg. bwd time: 41.3322 / Avg. batch time: 585.5642 (ms) / GPU bubble ratio: 22.94%
[rank3]:2025-11-02 07:57:50,708 - INFO - Avg. fwd time: 14.7918 / Avg. bwd time: 42.5230 / Avg. batch time: 474.1415 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-11-02 07:57:50,816 - INFO - Avg. fwd time: 13.2340 / Avg. bwd time: 38.0868 / Avg. batch time: 640.1424 (ms) / GPU bubble ratio: 35.86%
[rank0]:2025-11-02 07:57:50,937 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3292  memory: 54.93GiB(39.29%)  tps: 6,092  tflops: 284.11  mfu: 28.73%
[rank1]:2025-11-02 07:57:50,933 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3292  memory: 47.26GiB(33.80%)  tps: 6,092  tflops: 284.11  mfu: 28.73%
[rank2]:2025-11-02 07:57:50,931 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3292  memory: 38.72GiB(27.69%)  tps: 6,092  tflops: 284.11  mfu: 28.73%
[rank3]:2025-11-02 07:57:50,935 - INFO -  step: 1100  loss:  0.2945  grad_norm:  0.3292  memory: 46.37GiB(33.17%)  tps: 6,092  tflops: 284.12  mfu: 28.73%
[rank3]:2025-11-02 07:57:51,112 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0757_real_step1100_rank3.svg
[rank3]:> Batch Time: 631.38 ms, GPU Bubble Ratio: 34.21%, 27.62%, 36.48%, 26.19%
[rank0]:2025-11-02 08:00:01,219 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:00:03,667 - INFO - Avg. fwd time: 14.7947 / Avg. bwd time: 42.5281 / Avg. batch time: 474.2018 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:00:03,697 - INFO - Avg. fwd time: 13.2195 / Avg. bwd time: 36.3146 / Avg. batch time: 526.7583 (ms) / GPU bubble ratio: 24.77%
[rank0]:2025-11-02 08:00:03,775 - INFO - Avg. fwd time: 13.2350 / Avg. bwd time: 38.0882 / Avg. batch time: 640.2253 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-02 08:00:03,743 - INFO - Avg. fwd time: 15.0776 / Avg. bwd time: 41.3366 / Avg. batch time: 585.6456 (ms) / GPU bubble ratio: 22.94%
[rank3]:2025-11-02 08:00:03,894 - INFO -  step: 1150  loss:  0.2790  grad_norm:  0.5908  memory: 46.37GiB(33.17%)  tps: 6,161  tflops: 287.37  mfu: 29.06%
[rank1]:2025-11-02 08:00:03,892 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5908  memory: 47.26GiB(33.80%)  tps: 6,161  tflops: 287.37  mfu: 29.06%
[rank2]:2025-11-02 08:00:03,889 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5908  memory: 38.72GiB(27.69%)  tps: 6,161  tflops: 287.37  mfu: 29.06%
[rank0]:2025-11-02 08:00:03,896 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5908  memory: 54.93GiB(39.29%)  tps: 6,161  tflops: 287.37  mfu: 29.06%
[rank0]:2025-11-02 08:02:13,874 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:02:16,419 - INFO - Avg. fwd time: 14.7955 / Avg. bwd time: 42.5308 / Avg. batch time: 474.2270 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:02:16,463 - INFO - Avg. fwd time: 13.2220 / Avg. bwd time: 36.3178 / Avg. batch time: 526.7735 (ms) / GPU bubble ratio: 24.77%
[rank0]:2025-11-02 08:02:16,559 - INFO - Avg. fwd time: 13.2360 / Avg. bwd time: 38.0889 / Avg. batch time: 640.2466 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-02 08:02:16,513 - INFO - Avg. fwd time: 15.0786 / Avg. bwd time: 41.3381 / Avg. batch time: 585.6634 (ms) / GPU bubble ratio: 22.94%
[rank1]:2025-11-02 08:02:16,590 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3324  memory: 47.26GiB(33.80%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank1]:2025-11-02 08:02:16,590 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 08:02:16,592 - INFO -  step: 1200  loss:  0.3161  grad_norm:  0.3324  memory: 46.37GiB(33.17%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank3]:2025-11-02 08:02:16,592 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 08:02:16,588 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3324  memory: 38.72GiB(27.69%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank2]:2025-11-02 08:02:16,588 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 08:02:16,594 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3324  memory: 54.93GiB(39.29%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank0]:2025-11-02 08:02:16,594 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 08:02:31,502 - INFO - validate step: 1200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,477
[rank0]:2025-11-02 08:02:31,502 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 08:02:31,506 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2025-11-02 08:02:31,563 - INFO - validate step: 1200  loss:  0.2706  memory: 46.37GiB(33.17%)  tps: 27,361
[rank3]:2025-11-02 08:02:31,564 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 08:02:31,529 - INFO - validate step: 1200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,419
[rank1]:2025-11-02 08:02:31,530 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 08:02:31,547 - INFO - validate step: 1200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,382
[rank2]:2025-11-02 08:02:31,547 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 08:02:42,971 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.42 seconds.
[rank1]:2025-11-02 08:02:44,683 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.15 seconds.
[rank3]:2025-11-02 08:02:44,713 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.15 seconds.
[rank0]:2025-11-02 08:02:47,152 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 08:02:47,158 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.66 seconds.
[rank3]:2025-11-02 08:02:47,433 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0802_real_step1200_rank3.svg
[rank3]:> Batch Time: 625.51 ms, GPU Bubble Ratio: 34.00%, 27.52%, 36.24%, 26.27%
[rank0]:2025-11-02 08:04:59,708 - INFO - [GC] Peforming periodical GC collection 2.07 seconds
[rank3]:2025-11-02 08:05:02,169 - INFO - Avg. fwd time: 14.7949 / Avg. bwd time: 42.5454 / Avg. batch time: 474.3363 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:05:02,200 - INFO - Avg. fwd time: 13.2209 / Avg. bwd time: 36.3170 / Avg. batch time: 526.8973 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-11-02 08:05:02,278 - INFO - Avg. fwd time: 13.2371 / Avg. bwd time: 38.0882 / Avg. batch time: 640.3731 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 08:05:02,244 - INFO - Avg. fwd time: 15.0783 / Avg. bwd time: 41.3376 / Avg. batch time: 585.7870 (ms) / GPU bubble ratio: 22.95%
[rank0]:2025-11-02 08:05:02,398 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5546  memory: 54.93GiB(39.29%)  tps: 5,429  tflops: 253.21  mfu: 25.60%
[rank1]:2025-11-02 08:05:02,394 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5546  memory: 47.26GiB(33.80%)  tps: 5,430  tflops: 253.26  mfu: 25.61%
[rank3]:2025-11-02 08:05:02,396 - INFO -  step: 1250  loss:  0.3434  grad_norm:  0.5546  memory: 46.49GiB(33.25%)  tps: 5,431  tflops: 253.31  mfu: 25.61%
[rank2]:2025-11-02 08:05:02,391 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.5546  memory: 38.72GiB(27.69%)  tps: 5,431  tflops: 253.29  mfu: 25.61%
[rank0]:2025-11-02 08:07:12,179 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:07:14,611 - INFO - Avg. fwd time: 14.7956 / Avg. bwd time: 42.5457 / Avg. batch time: 474.3408 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:07:14,641 - INFO - Avg. fwd time: 13.2212 / Avg. bwd time: 36.3177 / Avg. batch time: 526.8883 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-11-02 08:07:14,686 - INFO - Avg. fwd time: 15.0794 / Avg. bwd time: 41.3384 / Avg. batch time: 585.7774 (ms) / GPU bubble ratio: 22.95%
[rank0]:2025-11-02 08:07:14,719 - INFO - Avg. fwd time: 13.2365 / Avg. bwd time: 38.0873 / Avg. batch time: 640.3603 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 08:07:14,836 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1945  memory: 47.26GiB(33.80%)  tps: 6,185  tflops: 288.49  mfu: 29.17%
[rank2]:2025-11-02 08:07:14,833 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1945  memory: 38.72GiB(27.69%)  tps: 6,185  tflops: 288.49  mfu: 29.17%
[rank3]:2025-11-02 08:07:14,838 - INFO -  step: 1300  loss:  0.1955  grad_norm:  0.1945  memory: 46.49GiB(33.25%)  tps: 6,185  tflops: 288.49  mfu: 29.17%
[rank0]:2025-11-02 08:07:14,839 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.1945  memory: 54.93GiB(39.29%)  tps: 6,185  tflops: 288.49  mfu: 29.17%
[rank3]:2025-11-02 08:07:15,020 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0807_real_step1300_rank3.svg
[rank3]:> Batch Time: 619.52 ms, GPU Bubble Ratio: 33.83%, 27.27%, 36.15%, 26.30%
[rank0]:2025-11-02 08:09:25,855 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:09:28,382 - INFO - Avg. fwd time: 14.8007 / Avg. bwd time: 42.5538 / Avg. batch time: 474.4453 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:09:28,429 - INFO - Avg. fwd time: 13.2255 / Avg. bwd time: 36.3233 / Avg. batch time: 527.0141 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-11-02 08:09:28,479 - INFO - Avg. fwd time: 15.0842 / Avg. bwd time: 41.3447 / Avg. batch time: 585.9134 (ms) / GPU bubble ratio: 22.95%
[rank0]:2025-11-02 08:09:28,527 - INFO - Avg. fwd time: 13.2403 / Avg. bwd time: 38.0911 / Avg. batch time: 640.5036 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:09:28,562 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2921  memory: 54.93GiB(39.29%)  tps: 6,126  tflops: 285.72  mfu: 28.89%
[rank1]:2025-11-02 08:09:28,558 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2921  memory: 47.26GiB(33.80%)  tps: 6,126  tflops: 285.72  mfu: 28.89%
[rank3]:2025-11-02 08:09:28,560 - INFO -  step: 1350  loss:  0.1378  grad_norm:  0.2921  memory: 46.49GiB(33.25%)  tps: 6,126  tflops: 285.73  mfu: 28.89%
[rank2]:2025-11-02 08:09:28,555 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.2921  memory: 38.72GiB(27.69%)  tps: 6,126  tflops: 285.72  mfu: 28.89%
[rank0]:2025-11-02 08:11:38,308 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 08:11:40,811 - INFO - Avg. fwd time: 13.2248 / Avg. bwd time: 36.3238 / Avg. batch time: 526.9866 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-11-02 08:11:40,857 - INFO - Avg. fwd time: 15.0836 / Avg. bwd time: 41.3444 / Avg. batch time: 585.8844 (ms) / GPU bubble ratio: 22.95%
[rank3]:2025-11-02 08:11:40,781 - INFO - Avg. fwd time: 14.8005 / Avg. bwd time: 42.5525 / Avg. batch time: 474.4299 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-11-02 08:11:40,891 - INFO - Avg. fwd time: 13.2389 / Avg. bwd time: 38.0902 / Avg. batch time: 640.4710 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:11:41,012 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3148  memory: 54.93GiB(39.29%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank0]:2025-11-02 08:11:41,012 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 08:11:41,005 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3148  memory: 38.72GiB(27.69%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank2]:2025-11-02 08:11:41,005 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 08:11:41,007 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3148  memory: 47.26GiB(33.80%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank3]:2025-11-02 08:11:41,010 - INFO -  step: 1400  loss:  0.4189  grad_norm:  0.3148  memory: 46.49GiB(33.25%)  tps: 6,185  tflops: 288.47  mfu: 29.17%
[rank1]:2025-11-02 08:11:41,008 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 08:11:41,010 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 08:11:55,970 - INFO - validate step: 1400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,383
[rank3]:2025-11-02 08:11:56,034 - INFO - validate step: 1400  loss:  0.2670  memory: 46.49GiB(33.25%)  tps: 27,265
[rank2]:2025-11-02 08:11:56,014 - INFO - validate step: 1400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,290
[rank1]:2025-11-02 08:11:56,001 - INFO - validate step: 1400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,320
[rank3]:2025-11-02 08:11:56,218 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0811_real_step1400_rank3.svg
[rank3]:> Batch Time: 625.06 ms, GPU Bubble Ratio: 34.07%, 27.44%, 36.30%, 26.25%
[rank0]:2025-11-02 08:14:07,742 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 08:14:10,178 - INFO - Avg. fwd time: 14.8083 / Avg. bwd time: 42.5648 / Avg. batch time: 474.5911 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 08:14:10,253 - INFO - Avg. fwd time: 15.0908 / Avg. bwd time: 41.3530 / Avg. batch time: 586.0830 (ms) / GPU bubble ratio: 22.95%
[rank2]:2025-11-02 08:14:10,208 - INFO - Avg. fwd time: 13.2320 / Avg. bwd time: 36.3317 / Avg. batch time: 527.1723 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-11-02 08:14:10,286 - INFO - Avg. fwd time: 13.2458 / Avg. bwd time: 38.0956 / Avg. batch time: 640.6802 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:14:10,405 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3290  memory: 54.93GiB(39.29%)  tps: 6,094  tflops: 284.21  mfu: 28.74%
[rank3]:2025-11-02 08:14:10,403 - INFO -  step: 1450  loss:  0.2480  grad_norm:  0.3290  memory: 46.49GiB(33.25%)  tps: 6,097  tflops: 284.35  mfu: 28.75%
[rank1]:2025-11-02 08:14:10,401 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3290  memory: 47.26GiB(33.80%)  tps: 6,095  tflops: 284.28  mfu: 28.74%
[rank2]:2025-11-02 08:14:10,398 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3290  memory: 38.72GiB(27.69%)  tps: 6,096  tflops: 284.32  mfu: 28.75%
[rank0]:2025-11-02 08:16:22,356 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:16:24,947 - INFO - Avg. fwd time: 14.8177 / Avg. bwd time: 42.5784 / Avg. batch time: 474.7731 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:16:24,993 - INFO - Avg. fwd time: 13.2391 / Avg. bwd time: 36.3393 / Avg. batch time: 527.3588 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-11-02 08:16:25,045 - INFO - Avg. fwd time: 15.0984 / Avg. bwd time: 41.3613 / Avg. batch time: 586.2856 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:16:25,093 - INFO - Avg. fwd time: 13.2537 / Avg. bwd time: 38.1021 / Avg. batch time: 640.8975 (ms) / GPU bubble ratio: 35.90%
[rank0]:2025-11-02 08:16:25,128 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3033  memory: 54.93GiB(39.29%)  tps: 6,081  tflops: 283.60  mfu: 28.68%
[rank3]:2025-11-02 08:16:25,126 - INFO -  step: 1500  loss:  0.2850  grad_norm:  0.3033  memory: 46.49GiB(33.25%)  tps: 6,081  tflops: 283.60  mfu: 28.68%
[rank2]:2025-11-02 08:16:25,122 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3033  memory: 38.72GiB(27.69%)  tps: 6,081  tflops: 283.60  mfu: 28.68%
[rank1]:2025-11-02 08:16:25,124 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3033  memory: 47.26GiB(33.80%)  tps: 6,081  tflops: 283.60  mfu: 28.68%
[rank3]:2025-11-02 08:16:25,309 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0816_real_step1500_rank3.svg
[rank3]:> Batch Time: 632.00 ms, GPU Bubble Ratio: 34.19%, 27.71%, 36.49%, 26.16%
[rank0]:2025-11-02 08:18:37,091 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:18:39,572 - INFO - Avg. fwd time: 14.8252 / Avg. bwd time: 42.5899 / Avg. batch time: 474.9258 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:18:39,602 - INFO - Avg. fwd time: 13.2458 / Avg. bwd time: 36.3461 / Avg. batch time: 527.5362 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-11-02 08:18:39,648 - INFO - Avg. fwd time: 15.1051 / Avg. bwd time: 41.3693 / Avg. batch time: 586.4746 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:18:39,681 - INFO - Avg. fwd time: 13.2602 / Avg. bwd time: 38.1068 / Avg. batch time: 641.0966 (ms) / GPU bubble ratio: 35.90%
[rank2]:2025-11-02 08:18:39,795 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4539  memory: 38.72GiB(27.69%)  tps: 6,083  tflops: 283.71  mfu: 28.69%
[rank1]:2025-11-02 08:18:39,797 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4539  memory: 47.26GiB(33.80%)  tps: 6,083  tflops: 283.71  mfu: 28.69%
[rank0]:2025-11-02 08:18:39,801 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4539  memory: 54.93GiB(39.29%)  tps: 6,083  tflops: 283.71  mfu: 28.69%
[rank3]:2025-11-02 08:18:39,799 - INFO -  step: 1550  loss:  0.3533  grad_norm:  0.4539  memory: 46.49GiB(33.25%)  tps: 6,083  tflops: 283.71  mfu: 28.69%
[rank0]:2025-11-02 08:20:50,877 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 08:20:53,395 - INFO - Avg. fwd time: 13.2493 / Avg. bwd time: 36.3495 / Avg. batch time: 527.6050 (ms) / GPU bubble ratio: 24.79%
[rank3]:2025-11-02 08:20:53,365 - INFO - Avg. fwd time: 14.8290 / Avg. bwd time: 42.5955 / Avg. batch time: 474.9992 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-02 08:20:53,441 - INFO - Avg. fwd time: 15.1084 / Avg. bwd time: 41.3735 / Avg. batch time: 586.5486 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:20:53,474 - INFO - Avg. fwd time: 13.2636 / Avg. bwd time: 38.1097 / Avg. batch time: 641.1761 (ms) / GPU bubble ratio: 35.90%
[rank1]:2025-11-02 08:20:53,589 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6755  memory: 47.26GiB(33.80%)  tps: 6,123  tflops: 285.58  mfu: 28.88%
[rank1]:2025-11-02 08:20:53,589 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 08:20:53,587 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6755  memory: 38.72GiB(27.69%)  tps: 6,123  tflops: 285.58  mfu: 28.88%
[rank2]:2025-11-02 08:20:53,587 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 08:20:53,591 - INFO -  step: 1600  loss:  0.5335  grad_norm:  0.6755  memory: 46.49GiB(33.25%)  tps: 6,123  tflops: 285.58  mfu: 28.88%
[rank3]:2025-11-02 08:20:53,591 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 08:20:53,593 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.6755  memory: 54.93GiB(39.29%)  tps: 6,123  tflops: 285.58  mfu: 28.88%
[rank0]:2025-11-02 08:20:53,593 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 08:21:08,509 - INFO - validate step: 1600  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,462
[rank1]:2025-11-02 08:21:08,539 - INFO - validate step: 1600  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,399
[rank3]:2025-11-02 08:21:08,564 - INFO - validate step: 1600  loss:  0.2710  memory: 46.49GiB(33.25%)  tps: 27,358
[rank2]:2025-11-02 08:21:08,551 - INFO - validate step: 1600  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,372
[rank3]:2025-11-02 08:21:08,747 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0821_real_step1600_rank3.svg
[rank3]:> Batch Time: 630.54 ms, GPU Bubble Ratio: 34.22%, 27.66%, 36.50%, 26.17%
[rank0]:2025-11-02 08:23:20,282 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 08:23:22,908 - INFO - Avg. fwd time: 13.2538 / Avg. bwd time: 36.3536 / Avg. batch time: 527.7386 (ms) / GPU bubble ratio: 24.80%
[rank3]:2025-11-02 08:23:22,861 - INFO - Avg. fwd time: 14.8347 / Avg. bwd time: 42.6042 / Avg. batch time: 475.1137 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-02 08:23:22,962 - INFO - Avg. fwd time: 15.1134 / Avg. bwd time: 41.3786 / Avg. batch time: 586.6913 (ms) / GPU bubble ratio: 22.97%
[rank0]:2025-11-02 08:23:23,012 - INFO - Avg. fwd time: 13.2676 / Avg. bwd time: 38.1126 / Avg. batch time: 641.3271 (ms) / GPU bubble ratio: 35.91%
[rank0]:2025-11-02 08:23:23,047 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6279  memory: 54.93GiB(39.29%)  tps: 6,089  tflops: 283.99  mfu: 28.72%
[rank1]:2025-11-02 08:23:23,043 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6279  memory: 47.26GiB(33.80%)  tps: 6,091  tflops: 284.06  mfu: 28.72%
[rank2]:2025-11-02 08:23:23,041 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6279  memory: 38.72GiB(27.69%)  tps: 6,091  tflops: 284.10  mfu: 28.73%
[rank3]:2025-11-02 08:23:23,045 - INFO -  step: 1650  loss:  0.5450  grad_norm:  0.6279  memory: 46.49GiB(33.25%)  tps: 6,092  tflops: 284.11  mfu: 28.73%
[rank0]:2025-11-02 08:25:34,786 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:25:37,274 - INFO - Avg. fwd time: 14.8394 / Avg. bwd time: 42.6116 / Avg. batch time: 475.2098 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:25:37,305 - INFO - Avg. fwd time: 13.2576 / Avg. bwd time: 36.3574 / Avg. batch time: 527.8330 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-11-02 08:25:37,350 - INFO - Avg. fwd time: 15.1176 / Avg. bwd time: 41.3830 / Avg. batch time: 586.7920 (ms) / GPU bubble ratio: 22.97%
[rank0]:2025-11-02 08:25:37,383 - INFO - Avg. fwd time: 13.2714 / Avg. bwd time: 38.1158 / Avg. batch time: 641.4336 (ms) / GPU bubble ratio: 35.91%
[rank1]:2025-11-02 08:25:37,498 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9448  memory: 47.26GiB(33.80%)  tps: 6,093  tflops: 284.17  mfu: 28.73%
[rank3]:2025-11-02 08:25:37,500 - INFO -  step: 1700  loss:  0.5145  grad_norm:  0.9448  memory: 46.49GiB(33.25%)  tps: 6,093  tflops: 284.17  mfu: 28.73%
[rank2]:2025-11-02 08:25:37,496 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9448  memory: 38.72GiB(27.69%)  tps: 6,093  tflops: 284.17  mfu: 28.73%
[rank0]:2025-11-02 08:25:37,502 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9448  memory: 54.93GiB(39.29%)  tps: 6,093  tflops: 284.17  mfu: 28.73%
[rank3]:2025-11-02 08:25:37,675 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0825_real_step1700_rank3.svg
[rank3]:> Batch Time: 628.98 ms, GPU Bubble Ratio: 34.12%, 27.58%, 36.41%, 26.20%
[rank0]:2025-11-02 08:27:49,007 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:27:51,502 - INFO - Avg. fwd time: 14.8435 / Avg. bwd time: 42.6178 / Avg. batch time: 475.2920 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:27:51,533 - INFO - Avg. fwd time: 13.2609 / Avg. bwd time: 36.3594 / Avg. batch time: 527.9286 (ms) / GPU bubble ratio: 24.81%
[rank1]:2025-11-02 08:27:51,579 - INFO - Avg. fwd time: 15.1214 / Avg. bwd time: 41.3869 / Avg. batch time: 586.8930 (ms) / GPU bubble ratio: 22.97%
[rank0]:2025-11-02 08:27:51,612 - INFO - Avg. fwd time: 13.2745 / Avg. bwd time: 38.1174 / Avg. batch time: 641.5388 (ms) / GPU bubble ratio: 35.91%
[rank1]:2025-11-02 08:27:51,727 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6103  memory: 47.26GiB(33.80%)  tps: 6,103  tflops: 284.65  mfu: 28.78%
[rank3]:2025-11-02 08:27:51,729 - INFO -  step: 1750  loss:  0.4844  grad_norm:  0.6103  memory: 46.49GiB(33.25%)  tps: 6,103  tflops: 284.65  mfu: 28.78%
[rank2]:2025-11-02 08:27:51,724 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6103  memory: 38.72GiB(27.69%)  tps: 6,103  tflops: 284.65  mfu: 28.78%
[rank0]:2025-11-02 08:27:51,731 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.6103  memory: 54.93GiB(39.29%)  tps: 6,103  tflops: 284.65  mfu: 28.78%
[rank0]:2025-11-02 08:30:00,999 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 08:30:03,515 - INFO - Avg. fwd time: 13.2580 / Avg. bwd time: 36.3561 / Avg. batch time: 527.8409 (ms) / GPU bubble ratio: 24.80%
[rank3]:2025-11-02 08:30:03,468 - INFO - Avg. fwd time: 14.8406 / Avg. bwd time: 42.6119 / Avg. batch time: 475.2193 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-02 08:30:03,566 - INFO - Avg. fwd time: 15.1182 / Avg. bwd time: 41.3832 / Avg. batch time: 586.8000 (ms) / GPU bubble ratio: 22.97%
[rank1]:2025-11-02 08:30:03,646 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1339  memory: 47.26GiB(33.80%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank1]:2025-11-02 08:30:03,646 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 08:30:03,643 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1339  memory: 38.72GiB(27.69%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank2]:2025-11-02 08:30:03,643 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 08:30:03,648 - INFO -  step: 1800  loss:  0.0631  grad_norm:  0.1339  memory: 46.49GiB(33.25%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank3]:2025-11-02 08:30:03,648 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 08:30:03,615 - INFO - Avg. fwd time: 13.2711 / Avg. bwd time: 38.1143 / Avg. batch time: 641.4398 (ms) / GPU bubble ratio: 35.91%
[rank0]:2025-11-02 08:30:03,650 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1339  memory: 54.93GiB(39.29%)  tps: 6,210  tflops: 289.63  mfu: 29.29%
[rank0]:2025-11-02 08:30:03,650 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 08:30:18,658 - INFO - validate step: 1800  loss:  0.2621  memory: 46.49GiB(33.25%)  tps: 27,290
[rank1]:2025-11-02 08:30:18,633 - INFO - validate step: 1800  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,330
[rank2]:2025-11-02 08:30:18,645 - INFO - validate step: 1800  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,304
[rank0]:2025-11-02 08:30:18,602 - INFO - validate step: 1800  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,396
[rank3]:2025-11-02 08:30:18,844 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0830_real_step1800_rank3.svg
[rank3]:> Batch Time: 613.55 ms, GPU Bubble Ratio: 33.76%, 27.22%, 36.14%, 26.37%
[rank0]:2025-11-02 08:32:27,638 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 08:32:30,054 - INFO - Avg. fwd time: 14.8369 / Avg. bwd time: 42.6047 / Avg. batch time: 475.1298 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:32:30,085 - INFO - Avg. fwd time: 13.2552 / Avg. bwd time: 36.3518 / Avg. batch time: 527.7554 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-11-02 08:32:30,131 - INFO - Avg. fwd time: 15.1147 / Avg. bwd time: 41.3786 / Avg. batch time: 586.7064 (ms) / GPU bubble ratio: 22.97%
[rank0]:2025-11-02 08:32:30,162 - INFO - Avg. fwd time: 13.2676 / Avg. bwd time: 38.1113 / Avg. batch time: 641.3408 (ms) / GPU bubble ratio: 35.91%
[rank3]:2025-11-02 08:32:30,279 - INFO -  step: 1850  loss:  0.3906  grad_norm:  0.4686  memory: 46.49GiB(33.25%)  tps: 6,224  tflops: 290.30  mfu: 29.35%
[rank1]:2025-11-02 08:32:30,277 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4686  memory: 47.26GiB(33.80%)  tps: 6,223  tflops: 290.24  mfu: 29.35%
[rank2]:2025-11-02 08:32:30,274 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4686  memory: 38.72GiB(27.69%)  tps: 6,224  tflops: 290.27  mfu: 29.35%
[rank0]:2025-11-02 08:32:30,281 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4686  memory: 54.93GiB(39.29%)  tps: 6,221  tflops: 290.16  mfu: 29.34%
[rank0]:2025-11-02 08:34:38,463 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:34:40,870 - INFO - Avg. fwd time: 14.8303 / Avg. bwd time: 42.5933 / Avg. batch time: 474.9822 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:34:40,902 - INFO - Avg. fwd time: 13.2497 / Avg. bwd time: 36.3450 / Avg. batch time: 527.5876 (ms) / GPU bubble ratio: 24.80%
[rank1]:2025-11-02 08:34:40,946 - INFO - Avg. fwd time: 15.1089 / Avg. bwd time: 41.3709 / Avg. batch time: 586.5253 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:34:40,978 - INFO - Avg. fwd time: 13.2611 / Avg. bwd time: 38.1059 / Avg. batch time: 641.1496 (ms) / GPU bubble ratio: 35.91%
[rank2]:2025-11-02 08:34:41,089 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1818  memory: 38.72GiB(27.69%)  tps: 6,262  tflops: 292.07  mfu: 29.53%
[rank3]:2025-11-02 08:34:41,094 - INFO -  step: 1900  loss:  0.2008  grad_norm:  0.1818  memory: 46.49GiB(33.25%)  tps: 6,262  tflops: 292.08  mfu: 29.53%
[rank1]:2025-11-02 08:34:41,092 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1818  memory: 47.26GiB(33.80%)  tps: 6,262  tflops: 292.07  mfu: 29.53%
[rank0]:2025-11-02 08:34:41,096 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1818  memory: 54.93GiB(39.29%)  tps: 6,262  tflops: 292.07  mfu: 29.53%
[rank3]:2025-11-02 08:34:41,273 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0834_real_step1900_rank3.svg
[rank3]:> Batch Time: 616.60 ms, GPU Bubble Ratio: 33.81%, 27.26%, 36.21%, 26.36%
[rank0]:2025-11-02 08:36:49,034 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:36:51,534 - INFO - Avg. fwd time: 14.8228 / Avg. bwd time: 42.5812 / Avg. batch time: 474.8234 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:36:51,583 - INFO - Avg. fwd time: 13.2435 / Avg. bwd time: 36.3380 / Avg. batch time: 527.4266 (ms) / GPU bubble ratio: 24.79%
[rank1]:2025-11-02 08:36:51,636 - INFO - Avg. fwd time: 15.1027 / Avg. bwd time: 41.3631 / Avg. batch time: 586.3518 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:36:51,685 - INFO - Avg. fwd time: 13.2541 / Avg. bwd time: 38.1002 / Avg. batch time: 640.9661 (ms) / GPU bubble ratio: 35.90%
[rank3]:2025-11-02 08:36:51,718 - INFO -  step: 1950  loss:  0.1658  grad_norm:  0.1628  memory: 46.49GiB(33.25%)  tps: 6,271  tflops: 292.50  mfu: 29.58%
[rank1]:2025-11-02 08:36:51,716 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1628  memory: 47.26GiB(33.80%)  tps: 6,271  tflops: 292.50  mfu: 29.58%
[rank2]:2025-11-02 08:36:51,714 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1628  memory: 38.72GiB(27.69%)  tps: 6,271  tflops: 292.50  mfu: 29.58%
[rank0]:2025-11-02 08:36:51,720 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1628  memory: 54.93GiB(39.29%)  tps: 6,271  tflops: 292.50  mfu: 29.58%
[rank0]:2025-11-02 08:38:59,641 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:39:02,069 - INFO - Avg. fwd time: 14.8172 / Avg. bwd time: 42.5718 / Avg. batch time: 474.7008 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:39:02,098 - INFO - Avg. fwd time: 13.2391 / Avg. bwd time: 36.3334 / Avg. batch time: 527.2880 (ms) / GPU bubble ratio: 24.79%
[rank0]:2025-11-02 08:39:02,176 - INFO - Avg. fwd time: 13.2487 / Avg. bwd time: 38.0961 / Avg. batch time: 640.8087 (ms) / GPU bubble ratio: 35.90%
[rank1]:2025-11-02 08:39:02,144 - INFO - Avg. fwd time: 15.0970 / Avg. bwd time: 41.3564 / Avg. batch time: 586.2026 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:39:02,294 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1510  memory: 54.93GiB(39.29%)  tps: 6,274  tflops: 292.61  mfu: 29.59%
[rank0]:2025-11-02 08:39:02,294 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 08:39:02,292 - INFO -  step: 2000  loss:  0.2034  grad_norm:  0.1510  memory: 46.49GiB(33.25%)  tps: 6,274  tflops: 292.62  mfu: 29.59%
[rank3]:2025-11-02 08:39:02,293 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 08:39:02,288 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1510  memory: 38.72GiB(27.69%)  tps: 6,274  tflops: 292.61  mfu: 29.59%
[rank2]:2025-11-02 08:39:02,288 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 08:39:02,290 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1510  memory: 47.26GiB(33.80%)  tps: 6,274  tflops: 292.61  mfu: 29.59%
[rank1]:2025-11-02 08:39:02,290 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 08:39:17,203 - INFO - validate step: 2000  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,474
[rank3]:2025-11-02 08:39:17,261 - INFO - validate step: 2000  loss:  0.2473  memory: 46.49GiB(33.25%)  tps: 27,366
[rank2]:2025-11-02 08:39:17,248 - INFO - validate step: 2000  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,380
[rank1]:2025-11-02 08:39:17,234 - INFO - validate step: 2000  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,410
[rank3]:2025-11-02 08:39:17,445 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0839_real_step2000_rank3.svg
[rank3]:> Batch Time: 617.42 ms, GPU Bubble Ratio: 33.76%, 27.40%, 36.15%, 26.34%
[rank0]:2025-11-02 08:41:25,434 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 08:41:27,850 - INFO - Avg. fwd time: 14.8114 / Avg. bwd time: 42.5620 / Avg. batch time: 474.5743 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 08:41:27,879 - INFO - Avg. fwd time: 13.2345 / Avg. bwd time: 36.3287 / Avg. batch time: 527.1607 (ms) / GPU bubble ratio: 24.78%
[rank1]:2025-11-02 08:41:27,925 - INFO - Avg. fwd time: 15.0916 / Avg. bwd time: 41.3496 / Avg. batch time: 586.0642 (ms) / GPU bubble ratio: 22.96%
[rank0]:2025-11-02 08:41:27,957 - INFO - Avg. fwd time: 13.2429 / Avg. bwd time: 38.0914 / Avg. batch time: 640.6612 (ms) / GPU bubble ratio: 35.90%
[rank0]:2025-11-02 08:41:28,075 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.2075  memory: 54.93GiB(39.29%)  tps: 6,260  tflops: 291.95  mfu: 29.52%
[rank3]:2025-11-02 08:41:28,074 - INFO -  step: 2050  loss:  0.2213  grad_norm:  0.2075  memory: 46.49GiB(33.25%)  tps: 6,263  tflops: 292.08  mfu: 29.53%
[rank2]:2025-11-02 08:41:28,069 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.2075  memory: 38.72GiB(27.69%)  tps: 6,262  tflops: 292.06  mfu: 29.53%
[rank1]:2025-11-02 08:41:28,071 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.2075  memory: 47.26GiB(33.80%)  tps: 6,261  tflops: 292.03  mfu: 29.53%
[rank0]:2025-11-02 08:43:36,002 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:43:38,497 - INFO - Avg. fwd time: 14.8059 / Avg. bwd time: 42.5525 / Avg. batch time: 474.4517 (ms) / GPU bubble ratio: 3.28%
[rank1]:2025-11-02 08:43:38,598 - INFO - Avg. fwd time: 15.0861 / Avg. bwd time: 41.3431 / Avg. batch time: 585.9159 (ms) / GPU bubble ratio: 22.95%
[rank2]:2025-11-02 08:43:38,546 - INFO - Avg. fwd time: 13.2301 / Avg. bwd time: 36.3243 / Avg. batch time: 527.0224 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-11-02 08:43:38,649 - INFO - Avg. fwd time: 13.2372 / Avg. bwd time: 38.0869 / Avg. batch time: 640.5049 (ms) / GPU bubble ratio: 35.90%
[rank0]:2025-11-02 08:43:38,684 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1770  memory: 54.93GiB(39.29%)  tps: 6,272  tflops: 292.54  mfu: 29.58%
[rank3]:2025-11-02 08:43:38,682 - INFO -  step: 2100  loss:  0.2282  grad_norm:  0.1770  memory: 46.49GiB(33.25%)  tps: 6,272  tflops: 292.54  mfu: 29.58%
[rank1]:2025-11-02 08:43:38,680 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1770  memory: 47.26GiB(33.80%)  tps: 6,272  tflops: 292.54  mfu: 29.58%
[rank2]:2025-11-02 08:43:38,677 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1770  memory: 38.72GiB(27.69%)  tps: 6,272  tflops: 292.54  mfu: 29.58%
[rank3]:2025-11-02 08:43:38,862 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0843_real_step2100_rank3.svg
[rank3]:> Batch Time: 618.52 ms, GPU Bubble Ratio: 33.91%, 27.43%, 36.21%, 26.31%
[rank0]:2025-11-02 08:45:46,651 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:45:49,049 - INFO - Avg. fwd time: 14.8007 / Avg. bwd time: 42.5441 / Avg. batch time: 474.3419 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 08:45:49,123 - INFO - Avg. fwd time: 15.0817 / Avg. bwd time: 41.3377 / Avg. batch time: 585.7975 (ms) / GPU bubble ratio: 22.95%
[rank2]:2025-11-02 08:45:49,078 - INFO - Avg. fwd time: 13.2260 / Avg. bwd time: 36.3203 / Avg. batch time: 526.9138 (ms) / GPU bubble ratio: 24.78%
[rank0]:2025-11-02 08:45:49,156 - INFO - Avg. fwd time: 13.2325 / Avg. bwd time: 38.0832 / Avg. batch time: 640.3790 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:45:49,272 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1772  memory: 54.93GiB(39.29%)  tps: 6,273  tflops: 292.58  mfu: 29.58%
[rank3]:2025-11-02 08:45:49,271 - INFO -  step: 2150  loss:  0.1878  grad_norm:  0.1772  memory: 46.49GiB(33.25%)  tps: 6,273  tflops: 292.58  mfu: 29.58%
[rank1]:2025-11-02 08:45:49,268 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1772  memory: 47.26GiB(33.80%)  tps: 6,273  tflops: 292.58  mfu: 29.58%
[rank2]:2025-11-02 08:45:49,266 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1772  memory: 38.72GiB(27.69%)  tps: 6,273  tflops: 292.58  mfu: 29.58%
[rank0]:2025-11-02 08:47:57,173 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 08:47:59,606 - INFO - Avg. fwd time: 13.2214 / Avg. bwd time: 36.3158 / Avg. batch time: 526.7728 (ms) / GPU bubble ratio: 24.77%
[rank1]:2025-11-02 08:47:59,649 - INFO - Avg. fwd time: 15.0765 / Avg. bwd time: 41.3315 / Avg. batch time: 585.6461 (ms) / GPU bubble ratio: 22.95%
[rank3]:2025-11-02 08:47:59,575 - INFO - Avg. fwd time: 14.7949 / Avg. bwd time: 42.5345 / Avg. batch time: 474.2166 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-11-02 08:47:59,682 - INFO - Avg. fwd time: 13.2272 / Avg. bwd time: 38.0790 / Avg. batch time: 640.2195 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:47:59,799 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1455  memory: 54.93GiB(39.29%)  tps: 6,276  tflops: 292.72  mfu: 29.60%
[rank0]:2025-11-02 08:47:59,799 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 08:47:59,792 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1455  memory: 38.72GiB(27.69%)  tps: 6,276  tflops: 292.72  mfu: 29.60%
[rank2]:2025-11-02 08:47:59,792 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 08:47:59,795 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1455  memory: 47.26GiB(33.80%)  tps: 6,276  tflops: 292.72  mfu: 29.60%
[rank1]:2025-11-02 08:47:59,795 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 08:47:59,797 - INFO -  step: 2200  loss:  0.1820  grad_norm:  0.1455  memory: 46.49GiB(33.25%)  tps: 6,276  tflops: 292.72  mfu: 29.60%
[rank3]:2025-11-02 08:47:59,797 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 08:48:14,779 - INFO - validate step: 2200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,343
[rank1]:2025-11-02 08:48:14,811 - INFO - validate step: 2200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,278
[rank3]:2025-11-02 08:48:14,837 - INFO - validate step: 2200  loss:  0.2463  memory: 46.49GiB(33.25%)  tps: 27,235
[rank2]:2025-11-02 08:48:14,825 - INFO - validate step: 2200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,247
[rank3]:2025-11-02 08:48:15,019 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0848_real_step2200_rank3.svg
[rank3]:> Batch Time: 618.55 ms, GPU Bubble Ratio: 33.89%, 27.37%, 36.30%, 26.32%
[rank0]:2025-11-02 08:50:22,855 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 08:50:25,345 - INFO - Avg. fwd time: 14.7895 / Avg. bwd time: 42.5254 / Avg. batch time: 474.0975 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 08:50:25,450 - INFO - Avg. fwd time: 15.0716 / Avg. bwd time: 41.3255 / Avg. batch time: 585.5180 (ms) / GPU bubble ratio: 22.94%
[rank2]:2025-11-02 08:50:25,395 - INFO - Avg. fwd time: 13.2172 / Avg. bwd time: 36.3112 / Avg. batch time: 526.6537 (ms) / GPU bubble ratio: 24.77%
[rank0]:2025-11-02 08:50:25,501 - INFO - Avg. fwd time: 13.2221 / Avg. bwd time: 38.0752 / Avg. batch time: 640.0850 (ms) / GPU bubble ratio: 35.89%
[rank0]:2025-11-02 08:50:25,536 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2097  memory: 54.93GiB(39.29%)  tps: 6,265  tflops: 292.20  mfu: 29.55%
[rank2]:2025-11-02 08:50:25,530 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2097  memory: 38.72GiB(27.69%)  tps: 6,268  tflops: 292.32  mfu: 29.56%
[rank1]:2025-11-02 08:50:25,532 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2097  memory: 47.26GiB(33.80%)  tps: 6,267  tflops: 292.28  mfu: 29.55%
[rank3]:2025-11-02 08:50:25,534 - INFO -  step: 2250  loss:  0.2258  grad_norm:  0.2097  memory: 46.49GiB(33.25%)  tps: 6,268  tflops: 292.34  mfu: 29.56%
[rank0]:2025-11-02 08:52:33,370 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:52:35,779 - INFO - Avg. fwd time: 14.7852 / Avg. bwd time: 42.5178 / Avg. batch time: 474.0020 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:52:35,811 - INFO - Avg. fwd time: 13.2139 / Avg. bwd time: 36.3075 / Avg. batch time: 526.5454 (ms) / GPU bubble ratio: 24.76%
[rank1]:2025-11-02 08:52:35,853 - INFO - Avg. fwd time: 15.0674 / Avg. bwd time: 41.3204 / Avg. batch time: 585.4013 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 08:52:35,886 - INFO - Avg. fwd time: 13.2179 / Avg. bwd time: 38.0720 / Avg. batch time: 639.9622 (ms) / GPU bubble ratio: 35.88%
[rank0]:2025-11-02 08:52:36,001 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1785  memory: 54.93GiB(39.29%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank2]:2025-11-02 08:52:35,995 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1785  memory: 38.72GiB(27.69%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank1]:2025-11-02 08:52:35,997 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1785  memory: 47.26GiB(33.80%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank3]:2025-11-02 08:52:35,999 - INFO -  step: 2300  loss:  0.1965  grad_norm:  0.1785  memory: 46.49GiB(33.25%)  tps: 6,279  tflops: 292.86  mfu: 29.61%
[rank3]:2025-11-02 08:52:36,180 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0852_real_step2300_rank3.svg
[rank3]:> Batch Time: 618.14 ms, GPU Bubble Ratio: 33.84%, 27.37%, 36.17%, 26.33%
[rank0]:2025-11-02 08:54:44,044 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 08:54:46,492 - INFO - Avg. fwd time: 13.2100 / Avg. bwd time: 36.3033 / Avg. batch time: 526.4343 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-11-02 08:54:46,462 - INFO - Avg. fwd time: 14.7802 / Avg. bwd time: 42.5093 / Avg. batch time: 473.8911 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 08:54:46,537 - INFO - Avg. fwd time: 15.0628 / Avg. bwd time: 41.3151 / Avg. batch time: 585.2811 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 08:54:46,569 - INFO - Avg. fwd time: 13.2132 / Avg. bwd time: 38.0681 / Avg. batch time: 639.8353 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 08:54:46,680 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1564  memory: 47.26GiB(33.80%)  tps: 6,269  tflops: 292.37  mfu: 29.56%
[rank2]:2025-11-02 08:54:46,678 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1564  memory: 38.72GiB(27.69%)  tps: 6,269  tflops: 292.37  mfu: 29.56%
[rank3]:2025-11-02 08:54:46,682 - INFO -  step: 2350  loss:  0.1828  grad_norm:  0.1564  memory: 46.49GiB(33.25%)  tps: 6,269  tflops: 292.37  mfu: 29.56%
[rank0]:2025-11-02 08:54:46,684 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1564  memory: 54.93GiB(39.29%)  tps: 6,269  tflops: 292.37  mfu: 29.56%
[rank0]:2025-11-02 08:56:54,531 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 08:56:57,041 - INFO - Avg. fwd time: 14.7756 / Avg. bwd time: 42.5015 / Avg. batch time: 473.7897 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:56:57,090 - INFO - Avg. fwd time: 13.2065 / Avg. bwd time: 36.2992 / Avg. batch time: 526.3200 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-11-02 08:56:57,143 - INFO - Avg. fwd time: 15.0586 / Avg. bwd time: 41.3099 / Avg. batch time: 585.1588 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 08:56:57,193 - INFO - Avg. fwd time: 13.2090 / Avg. bwd time: 38.0649 / Avg. batch time: 639.7071 (ms) / GPU bubble ratio: 35.88%
[rank0]:2025-11-02 08:56:57,229 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1600  memory: 54.93GiB(39.29%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank0]:2025-11-02 08:56:57,229 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 08:56:57,225 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1600  memory: 47.26GiB(33.80%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank1]:2025-11-02 08:56:57,225 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 08:56:57,227 - INFO -  step: 2400  loss:  0.1876  grad_norm:  0.1600  memory: 46.49GiB(33.25%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank3]:2025-11-02 08:56:57,227 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 08:56:57,222 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1600  memory: 38.72GiB(27.69%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank2]:2025-11-02 08:56:57,222 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 08:57:12,339 - INFO - validate step: 2400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,107
[rank0]:2025-11-02 08:57:12,340 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 08:57:12,351 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 08:57:12,383 - INFO - validate step: 2400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,018
[rank2]:2025-11-02 08:57:12,384 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 08:57:12,398 - INFO - validate step: 2400  loss:  0.2447  memory: 46.49GiB(33.25%)  tps: 27,000
[rank3]:2025-11-02 08:57:12,399 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 08:57:12,371 - INFO - validate step: 2400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,044
[rank1]:2025-11-02 08:57:12,372 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 08:57:23,838 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.45 seconds.
[rank3]:2025-11-02 08:57:25,307 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.91 seconds.
[rank1]:2025-11-02 08:57:25,431 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.06 seconds.
[rank0]:2025-11-02 08:57:27,950 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 08:57:27,956 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.62 seconds.
[rank3]:2025-11-02 08:57:28,270 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0857_real_step2400_rank3.svg
[rank3]:> Batch Time: 617.50 ms, GPU Bubble Ratio: 33.83%, 27.35%, 36.23%, 26.34%
[rank0]:2025-11-02 08:59:38,180 - INFO - [GC] Peforming periodical GC collection 2.01 seconds
[rank3]:2025-11-02 08:59:40,586 - INFO - Avg. fwd time: 14.7714 / Avg. bwd time: 42.4945 / Avg. batch time: 473.6995 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 08:59:40,616 - INFO - Avg. fwd time: 13.2031 / Avg. bwd time: 36.2956 / Avg. batch time: 526.2368 (ms) / GPU bubble ratio: 24.75%
[rank1]:2025-11-02 08:59:40,662 - INFO - Avg. fwd time: 15.0551 / Avg. bwd time: 41.3057 / Avg. batch time: 585.0677 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 08:59:40,696 - INFO - Avg. fwd time: 13.2064 / Avg. bwd time: 38.0624 / Avg. batch time: 639.6136 (ms) / GPU bubble ratio: 35.88%
[rank3]:2025-11-02 08:59:40,806 - INFO -  step: 2450  loss:  0.2297  grad_norm:  0.2023  memory: 46.49GiB(33.25%)  tps: 5,520  tflops: 257.45  mfu: 26.03%
[rank1]:2025-11-02 08:59:40,804 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2023  memory: 47.26GiB(33.80%)  tps: 5,519  tflops: 257.41  mfu: 26.03%
[rank2]:2025-11-02 08:59:40,802 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2023  memory: 38.72GiB(27.69%)  tps: 5,520  tflops: 257.43  mfu: 26.03%
[rank0]:2025-11-02 08:59:40,809 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2023  memory: 54.93GiB(39.29%)  tps: 5,518  tflops: 257.34  mfu: 26.02%
[rank0]:2025-11-02 09:01:48,714 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:01:51,133 - INFO - Avg. fwd time: 14.7674 / Avg. bwd time: 42.4875 / Avg. batch time: 473.6092 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:01:51,163 - INFO - Avg. fwd time: 13.2002 / Avg. bwd time: 36.2927 / Avg. batch time: 526.1337 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-02 09:01:51,208 - INFO - Avg. fwd time: 15.0511 / Avg. bwd time: 41.3011 / Avg. batch time: 584.9567 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 09:01:51,240 - INFO - Avg. fwd time: 13.2024 / Avg. bwd time: 38.0593 / Avg. batch time: 639.4966 (ms) / GPU bubble ratio: 35.87%
[rank2]:2025-11-02 09:01:51,348 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1811  memory: 38.72GiB(27.69%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank1]:2025-11-02 09:01:51,351 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1811  memory: 47.26GiB(33.80%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank0]:2025-11-02 09:01:51,354 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1811  memory: 54.93GiB(39.29%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank3]:2025-11-02 09:01:51,353 - INFO -  step: 2500  loss:  0.2126  grad_norm:  0.1811  memory: 46.49GiB(33.25%)  tps: 6,275  tflops: 292.68  mfu: 29.59%
[rank3]:2025-11-02 09:01:51,532 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0901_real_step2500_rank3.svg
[rank3]:> Batch Time: 617.79 ms, GPU Bubble Ratio: 33.83%, 27.36%, 36.09%, 26.34%
[rank0]:2025-11-02 09:04:01,062 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:04:03,615 - INFO - Avg. fwd time: 14.7671 / Avg. bwd time: 42.4866 / Avg. batch time: 473.5995 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 09:04:03,721 - INFO - Avg. fwd time: 15.0507 / Avg. bwd time: 41.3012 / Avg. batch time: 584.9538 (ms) / GPU bubble ratio: 22.93%
[rank2]:2025-11-02 09:04:03,667 - INFO - Avg. fwd time: 13.2000 / Avg. bwd time: 36.2930 / Avg. batch time: 526.1304 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 09:04:03,773 - INFO - Avg. fwd time: 13.2019 / Avg. bwd time: 38.0594 / Avg. batch time: 639.4942 (ms) / GPU bubble ratio: 35.87%
[rank3]:2025-11-02 09:04:03,806 - INFO -  step: 2550  loss:  0.4591  grad_norm:  0.3659  memory: 46.49GiB(33.25%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank1]:2025-11-02 09:04:03,804 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3659  memory: 47.26GiB(33.80%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank2]:2025-11-02 09:04:03,801 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3659  memory: 38.72GiB(27.69%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank0]:2025-11-02 09:04:03,808 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3659  memory: 54.93GiB(39.29%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank0]:2025-11-02 09:06:13,801 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:06:16,249 - INFO - Avg. fwd time: 14.7680 / Avg. bwd time: 42.4876 / Avg. batch time: 473.6142 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:06:16,279 - INFO - Avg. fwd time: 13.2007 / Avg. bwd time: 36.2939 / Avg. batch time: 526.1413 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-02 09:06:16,324 - INFO - Avg. fwd time: 15.0510 / Avg. bwd time: 41.3021 / Avg. batch time: 584.9652 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 09:06:16,358 - INFO - Avg. fwd time: 13.2025 / Avg. bwd time: 38.0599 / Avg. batch time: 639.5065 (ms) / GPU bubble ratio: 35.87%
[rank3]:2025-11-02 09:06:16,471 - INFO -  step: 2600  loss:  0.3877  grad_norm:  0.2687  memory: 46.49GiB(33.25%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank3]:2025-11-02 09:06:16,472 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 09:06:16,467 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2687  memory: 38.72GiB(27.69%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank2]:2025-11-02 09:06:16,467 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 09:06:16,469 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2687  memory: 47.26GiB(33.80%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank1]:2025-11-02 09:06:16,469 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 09:06:16,473 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2687  memory: 54.93GiB(39.29%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank0]:2025-11-02 09:06:16,473 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 09:06:31,491 - INFO - validate step: 2600  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,268
[rank0]:2025-11-02 09:06:31,459 - INFO - validate step: 2600  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,334
[rank3]:2025-11-02 09:06:31,517 - INFO - validate step: 2600  loss:  0.2491  memory: 46.49GiB(33.25%)  tps: 27,227
[rank2]:2025-11-02 09:06:31,503 - INFO - validate step: 2600  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,242
[rank3]:2025-11-02 09:06:31,704 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0906_real_step2600_rank3.svg
[rank3]:> Batch Time: 624.57 ms, GPU Bubble Ratio: 33.94%, 27.52%, 36.22%, 26.26%
[rank0]:2025-11-02 09:08:41,644 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 09:08:44,091 - INFO - Avg. fwd time: 14.7691 / Avg. bwd time: 42.4886 / Avg. batch time: 473.6304 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:08:44,121 - INFO - Avg. fwd time: 13.2017 / Avg. bwd time: 36.2949 / Avg. batch time: 526.1650 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-02 09:08:44,166 - INFO - Avg. fwd time: 15.0513 / Avg. bwd time: 41.3030 / Avg. batch time: 584.9883 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 09:08:44,198 - INFO - Avg. fwd time: 13.2032 / Avg. bwd time: 38.0605 / Avg. batch time: 639.5303 (ms) / GPU bubble ratio: 35.87%
[rank2]:2025-11-02 09:08:44,307 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2477  memory: 38.72GiB(27.69%)  tps: 6,169  tflops: 287.70  mfu: 29.09%
[rank0]:2025-11-02 09:08:44,313 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2477  memory: 54.93GiB(39.29%)  tps: 6,166  tflops: 287.59  mfu: 29.08%
[rank3]:2025-11-02 09:08:44,312 - INFO -  step: 2650  loss:  0.3099  grad_norm:  0.2477  memory: 46.49GiB(33.25%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank1]:2025-11-02 09:08:44,309 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2477  memory: 47.26GiB(33.80%)  tps: 6,168  tflops: 287.67  mfu: 29.09%
[rank0]:2025-11-02 09:10:54,277 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:10:56,815 - INFO - Avg. fwd time: 14.7700 / Avg. bwd time: 42.4896 / Avg. batch time: 473.6447 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 09:10:56,922 - INFO - Avg. fwd time: 15.0516 / Avg. bwd time: 41.3037 / Avg. batch time: 585.0001 (ms) / GPU bubble ratio: 22.93%
[rank2]:2025-11-02 09:10:56,867 - INFO - Avg. fwd time: 13.2024 / Avg. bwd time: 36.2956 / Avg. batch time: 526.1756 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 09:10:56,975 - INFO - Avg. fwd time: 13.2037 / Avg. bwd time: 38.0612 / Avg. batch time: 639.5444 (ms) / GPU bubble ratio: 35.87%
[rank0]:2025-11-02 09:10:57,010 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2919  memory: 54.93GiB(39.29%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank1]:2025-11-02 09:10:57,006 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2919  memory: 47.26GiB(33.80%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank2]:2025-11-02 09:10:57,004 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2919  memory: 38.72GiB(27.69%)  tps: 6,173  tflops: 287.93  mfu: 29.11%
[rank3]:2025-11-02 09:10:57,009 - INFO -  step: 2700  loss:  0.3416  grad_norm:  0.2919  memory: 46.49GiB(33.25%)  tps: 6,174  tflops: 287.94  mfu: 29.11%
[rank3]:2025-11-02 09:10:57,189 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0910_real_step2700_rank3.svg
[rank3]:> Batch Time: 623.68 ms, GPU Bubble Ratio: 33.93%, 27.36%, 36.27%, 26.29%
[rank0]:2025-11-02 09:13:07,122 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:13:09,583 - INFO - Avg. fwd time: 14.7708 / Avg. bwd time: 42.4908 / Avg. batch time: 473.6603 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:13:09,613 - INFO - Avg. fwd time: 13.2033 / Avg. bwd time: 36.2965 / Avg. batch time: 526.1988 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 09:13:09,692 - INFO - Avg. fwd time: 13.2039 / Avg. bwd time: 38.0615 / Avg. batch time: 639.5684 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-02 09:13:09,659 - INFO - Avg. fwd time: 15.0516 / Avg. bwd time: 41.3041 / Avg. batch time: 585.0238 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 09:13:09,806 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2202  memory: 54.93GiB(39.29%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank1]:2025-11-02 09:13:09,802 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2202  memory: 47.26GiB(33.80%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank2]:2025-11-02 09:13:09,799 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2202  memory: 38.72GiB(27.69%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank3]:2025-11-02 09:13:09,804 - INFO -  step: 2750  loss:  0.2806  grad_norm:  0.2202  memory: 46.49GiB(33.25%)  tps: 6,169  tflops: 287.72  mfu: 29.09%
[rank0]:2025-11-02 09:15:19,761 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 09:15:22,242 - INFO - Avg. fwd time: 13.2038 / Avg. bwd time: 36.2970 / Avg. batch time: 526.2075 (ms) / GPU bubble ratio: 24.74%
[rank3]:2025-11-02 09:15:22,214 - INFO - Avg. fwd time: 14.7717 / Avg. bwd time: 42.4917 / Avg. batch time: 473.6742 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-11-02 09:15:22,321 - INFO - Avg. fwd time: 13.2045 / Avg. bwd time: 38.0621 / Avg. batch time: 639.5773 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-02 09:15:22,288 - INFO - Avg. fwd time: 15.0519 / Avg. bwd time: 41.3050 / Avg. batch time: 585.0316 (ms) / GPU bubble ratio: 22.93%
[rank0]:2025-11-02 09:15:22,436 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2582  memory: 54.93GiB(39.29%)  tps: 6,177  tflops: 288.08  mfu: 29.13%
[rank0]:2025-11-02 09:15:22,436 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 09:15:22,432 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2582  memory: 47.26GiB(33.80%)  tps: 6,177  tflops: 288.08  mfu: 29.13%
[rank1]:2025-11-02 09:15:22,432 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 09:15:22,429 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2582  memory: 38.72GiB(27.69%)  tps: 6,177  tflops: 288.08  mfu: 29.13%
[rank2]:2025-11-02 09:15:22,429 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-02 09:15:22,434 - INFO -  step: 2800  loss:  0.2829  grad_norm:  0.2582  memory: 46.49GiB(33.25%)  tps: 6,177  tflops: 288.08  mfu: 29.13%
[rank3]:2025-11-02 09:15:22,435 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 09:15:37,373 - INFO - validate step: 2800  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,423
[rank1]:2025-11-02 09:15:37,403 - INFO - validate step: 2800  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,360
[rank3]:2025-11-02 09:15:37,433 - INFO - validate step: 2800  loss:  0.2471  memory: 46.49GiB(33.25%)  tps: 27,311
[rank2]:2025-11-02 09:15:37,419 - INFO - validate step: 2800  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,327
[rank3]:2025-11-02 09:15:37,614 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0915_real_step2800_rank3.svg
[rank3]:> Batch Time: 623.24 ms, GPU Bubble Ratio: 33.86%, 27.45%, 36.27%, 26.26%
[rank0]:2025-11-02 09:17:47,649 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 09:17:50,194 - INFO - Avg. fwd time: 14.7730 / Avg. bwd time: 42.4930 / Avg. batch time: 473.6944 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:17:50,248 - INFO - Avg. fwd time: 13.2043 / Avg. bwd time: 36.2979 / Avg. batch time: 526.2347 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 09:17:50,359 - INFO - Avg. fwd time: 13.2054 / Avg. bwd time: 38.0627 / Avg. batch time: 639.6088 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 09:17:50,305 - INFO - Avg. fwd time: 15.0522 / Avg. bwd time: 41.3057 / Avg. batch time: 585.0601 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 09:17:50,395 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2946  memory: 54.93GiB(39.29%)  tps: 6,158  tflops: 287.23  mfu: 29.04%
[rank3]:2025-11-02 09:17:50,393 - INFO -  step: 2850  loss:  0.3873  grad_norm:  0.2946  memory: 46.49GiB(33.25%)  tps: 6,161  tflops: 287.37  mfu: 29.06%
[rank1]:2025-11-02 09:17:50,391 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2946  memory: 47.26GiB(33.80%)  tps: 6,160  tflops: 287.30  mfu: 29.05%
[rank2]:2025-11-02 09:17:50,389 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2946  memory: 38.72GiB(27.69%)  tps: 6,161  tflops: 287.34  mfu: 29.05%
[rank0]:2025-11-02 09:20:00,344 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:20:02,792 - INFO - Avg. fwd time: 14.7735 / Avg. bwd time: 42.4936 / Avg. batch time: 473.7034 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:20:02,824 - INFO - Avg. fwd time: 13.2047 / Avg. bwd time: 36.2986 / Avg. batch time: 526.2391 (ms) / GPU bubble ratio: 24.74%
[rank1]:2025-11-02 09:20:02,867 - INFO - Avg. fwd time: 15.0524 / Avg. bwd time: 41.3059 / Avg. batch time: 585.0645 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 09:20:02,901 - INFO - Avg. fwd time: 13.2056 / Avg. bwd time: 38.0632 / Avg. batch time: 639.6138 (ms) / GPU bubble ratio: 35.88%
[rank0]:2025-11-02 09:20:03,015 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2858  memory: 54.93GiB(39.29%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank3]:2025-11-02 09:20:03,013 - INFO -  step: 2900  loss:  0.3708  grad_norm:  0.2858  memory: 46.49GiB(33.25%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank2]:2025-11-02 09:20:03,009 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2858  memory: 38.72GiB(27.69%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank1]:2025-11-02 09:20:03,011 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2858  memory: 47.26GiB(33.80%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank3]:2025-11-02 09:20:03,196 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0920_real_step2900_rank3.svg
[rank3]:> Batch Time: 623.38 ms, GPU Bubble Ratio: 33.96%, 27.49%, 36.28%, 26.25%
[rank0]:2025-11-02 09:22:13,196 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 09:22:15,688 - INFO - Avg. fwd time: 13.2056 / Avg. bwd time: 36.2997 / Avg. batch time: 526.2613 (ms) / GPU bubble ratio: 24.74%
[rank3]:2025-11-02 09:22:15,658 - INFO - Avg. fwd time: 14.7744 / Avg. bwd time: 42.4949 / Avg. batch time: 473.7202 (ms) / GPU bubble ratio: 3.29%
[rank0]:2025-11-02 09:22:15,767 - INFO - Avg. fwd time: 13.2061 / Avg. bwd time: 38.0637 / Avg. batch time: 639.6358 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 09:22:15,734 - INFO - Avg. fwd time: 15.0528 / Avg. bwd time: 41.3065 / Avg. batch time: 585.0865 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 09:22:15,879 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4332  memory: 54.93GiB(39.29%)  tps: 6,166  tflops: 287.57  mfu: 29.08%
[rank2]:2025-11-02 09:22:15,873 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4332  memory: 38.72GiB(27.69%)  tps: 6,166  tflops: 287.57  mfu: 29.08%
[rank1]:2025-11-02 09:22:15,875 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4332  memory: 47.26GiB(33.80%)  tps: 6,166  tflops: 287.57  mfu: 29.08%
[rank3]:2025-11-02 09:22:15,877 - INFO -  step: 2950  loss:  0.4203  grad_norm:  0.4332  memory: 46.49GiB(33.25%)  tps: 6,166  tflops: 287.57  mfu: 29.08%
[rank0]:2025-11-02 09:24:25,813 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:24:28,346 - INFO - Avg. fwd time: 14.7749 / Avg. bwd time: 42.4955 / Avg. batch time: 473.7289 (ms) / GPU bubble ratio: 3.29%
[rank2]:2025-11-02 09:24:28,399 - INFO - Avg. fwd time: 13.2061 / Avg. bwd time: 36.3004 / Avg. batch time: 526.2658 (ms) / GPU bubble ratio: 24.74%
[rank0]:2025-11-02 09:24:28,509 - INFO - Avg. fwd time: 13.2065 / Avg. bwd time: 38.0642 / Avg. batch time: 639.6431 (ms) / GPU bubble ratio: 35.88%
[rank1]:2025-11-02 09:24:28,455 - INFO - Avg. fwd time: 15.0532 / Avg. bwd time: 41.3071 / Avg. batch time: 585.0921 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 09:24:28,544 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2926  memory: 54.93GiB(39.29%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank0]:2025-11-02 09:24:28,544 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2926  tps: 6,249  tflops: 291.48  mfu: 28.65%
[rank0]:2025-11-02 09:24:28,544 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-02 09:24:28,540 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2926  memory: 47.26GiB(33.80%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank1]:2025-11-02 09:24:28,540 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2926  tps: 6,250  tflops: 291.50  mfu: 28.66%
[rank1]:2025-11-02 09:24:28,540 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-02 09:24:28,538 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2926  memory: 38.72GiB(27.69%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank2]:2025-11-02 09:24:28,538 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2926  tps: 6,250  tflops: 291.50  mfu: 28.66%
[rank2]:2025-11-02 09:24:28,538 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 09:24:28,543 - INFO -  step: 3000  loss:  0.3393  grad_norm:  0.2926  memory: 46.49GiB(33.25%)  tps: 6,175  tflops: 288.00  mfu: 29.12%
[rank3]:2025-11-02 09:24:28,543 - INFO -  final step: 3000  loss:  0.3393  grad_norm:  0.2926  tps: 6,252  tflops: 291.58  mfu: 28.67%
[rank3]:2025-11-02 09:24:28,543 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 09:24:43,429 - INFO - validate step: 3000  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,519
[rank0]:2025-11-02 09:24:43,430 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 09:24:43,432 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 09:24:43,472 - INFO - validate step: 3000  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,428
[rank2]:2025-11-02 09:24:43,473 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 09:24:43,478 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 09:24:43,490 - INFO - validate step: 3000  loss:  0.2487  memory: 46.49GiB(33.25%)  tps: 27,406
[rank3]:2025-11-02 09:24:43,491 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 09:24:43,494 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-02 09:24:43,459 - INFO - validate step: 3000  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,457
[rank1]:2025-11-02 09:24:43,459 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 09:24:43,464 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 09:24:53,580 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-02 09:24:53,604 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-02 09:24:53,604 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 09:24:53,604 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 09:24:53,782 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0924_real_final3000_rank3.svg
[rank3]:> Batch Time: 622.81 ms, GPU Bubble Ratio: 33.94%, 27.42%, 36.26%, 26.27%
[rank3]:2025-11-02 09:24:53,951 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200/pipeline_schedule/251102_0924_thry_final3000_rank3.svg
[rank3]:> Batch Time: 464.01 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 09:24:53,951 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–„â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.62074
[rank3]:wandb:               final/avg_loss 0.3393
[rank3]:wandb:             final/avg_mfu(%) 28.66601
[rank3]:wandb:             final/avg_tflops 291.5793
[rank3]:wandb:    final/avg_throughput(tps) 6251.67868
[rank3]:wandb:              final/grad_norm 0.29256
[rank3]:wandb:               final/max_loss 0.3393
[rank3]:wandb:                    grad_norm 0.29256
[rank3]:wandb: loss_metrics/global_avg_loss 0.3393
[rank3]:wandb: loss_metrics/global_max_loss 0.3393
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/5wjij0gs
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_nofreeze_h200/20251102-0707/wandb/run-20251102_070742-5wjij0gs/logs
[rank0]:2025-11-02 09:24:55,604 - INFO - Training completed
[rank0]:2025-11-02 09:24:55,604 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 09:24:55,804 - INFO - Process group destroyed
[rank2]:2025-11-02 09:24:55,820 - INFO - Process group destroyed
[rank3]:2025-11-02 09:24:55,804 - INFO - Process group destroyed
[rank0]:2025-11-02 09:24:56,063 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.2', 'layers.7', 'layers.4', 'tok_embeddings', 'layers.5', 'layers.0', 'layers.6', 'layers.3', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.23', 'layers.18', 'layers.21', 'layers.22', 'layers.17', 'layers.19', 'layers.20'}
[rank1]:Stage 1: Modules to keep: {'layers.12', 'layers.15', 'layers.8', 'layers.13', 'layers.14', 'layers.16', 'layers.11', 'layers.10', 'layers.9'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'norm', 'layers.31', 'layers.26', 'layers.25', 'layers.30', 'output', 'layers.27', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_nofreeze_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
