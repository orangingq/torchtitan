
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 17:19:04 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 17:19:06.091000 794758 site-packages/torch/distributed/run.py:811] 
W1102 17:19:06.091000 794758 site-packages/torch/distributed/run.py:811] *****************************************
W1102 17:19:06.091000 794758 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 17:19:06.091000 794758 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-02 17:19:13,380 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 17:19:13,393 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 17:19:13,453 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 17:19:13,518 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 17:19:14,374 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 17:19:14,376 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 17:19:14,374 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 17:19:14,376 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 17:19:14,370 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 17:19:14,373 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 17:19:14,379 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-02 17:19:14,375 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 17:19:14,377 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 17:19:16,222 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 17:19:16,529 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank1]:2025-11-02 17:19:18,589 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 17:19:18,570 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2025-11-02 17:19:18,661 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 17:19:18,661 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 17:19:18,738 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 17:19:18,877 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 17:19:18,877 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-02 17:19:18,812 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 17:19:18,812 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-02 17:19:18,826 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 17:19:18,888 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-02 17:19:18,911 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 17:19:18,912 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-02 17:19:19,004 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 17:19:19,004 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-02 17:19:19,114 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 17:19:19,114 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 8h4yla3f
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyauto_h200/20251102-1719/wandb/run-20251102_171919-8h4yla3f
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_timelyauto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/8h4yla3f
[rank3]:2025-11-02 17:19:20,353 - INFO - WandB logging enabled
[rank3]:2025-11-02 17:19:20,354 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 17:19:20,429 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 17:19:20,429 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-02 17:19:20,656 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 17:19:20,664 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 17:19:20,655 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyauto_h200
[rank0]:2025-11-02 17:19:20,655 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 17:19:20,656 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-02 17:19:20,638 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 17:19:20,638 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 17:19:20,655 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 17:19:23,967 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 17:19:23,968 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 17:19:33,390 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 17:19:33,390 - INFO - Finished loading the checkpoint in 9.42 seconds.
[rank0]:2025-11-02 17:19:33,391 - INFO - Training starts at step 1
[rank2]:2025-11-02 17:19:37,263 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 887  tflops: 41.36  mfu: 4.18%
[rank2]:2025-11-02 17:19:37,263 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 17:19:37,254 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 880  tflops: 41.05  mfu: 4.15%
[rank1]:2025-11-02 17:19:37,254 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 17:19:37,272 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 891  tflops: 41.57  mfu: 4.20%
[rank0]:2025-11-02 17:19:37,272 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 17:19:37,294 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 970  tflops: 45.24  mfu: 4.57%
[rank3]:2025-11-02 17:19:37,295 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 17:21:43,856 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:21:46,294 - INFO - Avg. fwd time: 14.6918 / Avg. bwd time: 42.1985 / Avg. batch time: 472.1448 (ms) / GPU bubble ratio: 3.61%
[rank1]:2025-11-02 17:21:46,370 - INFO - Avg. fwd time: 15.0954 / Avg. bwd time: 41.0355 / Avg. batch time: 584.0293 (ms) / GPU bubble ratio: 23.11%
[rank2]:2025-11-02 17:21:46,324 - INFO - Avg. fwd time: 13.1894 / Avg. bwd time: 36.1033 / Avg. batch time: 524.7950 (ms) / GPU bubble ratio: 24.86%
[rank0]:2025-11-02 17:21:46,402 - INFO - Avg. fwd time: 13.2551 / Avg. bwd time: 37.8386 / Avg. batch time: 639.0607 (ms) / GPU bubble ratio: 36.04%
[rank2]:2025-11-02 17:21:46,521 - INFO -  step: 50  loss: -4.0000  grad_norm: 7202.1758  memory: 38.72GiB(27.69%)  tps: 6,211  tflops: 289.68  mfu: 29.29%
[rank3]:2025-11-02 17:21:46,526 - INFO -  step: 50  loss: 12.7730  grad_norm: 7202.1758  memory: 46.16GiB(33.01%)  tps: 6,212  tflops: 289.74  mfu: 29.30%
[rank0]:2025-11-02 17:21:46,528 - INFO -  step: 50  loss: -4.0000  grad_norm: 7202.1758  memory: 54.93GiB(39.29%)  tps: 6,211  tflops: 289.68  mfu: 29.29%
[rank1]:2025-11-02 17:21:46,524 - INFO -  step: 50  loss: -4.0000  grad_norm: 7202.1758  memory: 47.26GiB(33.80%)  tps: 6,210  tflops: 289.65  mfu: 29.29%
[rank0]:2025-11-02 17:23:55,963 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:23:58,417 - INFO - Avg. fwd time: 13.2104 / Avg. bwd time: 36.2200 / Avg. batch time: 525.3345 (ms) / GPU bubble ratio: 24.73%
[rank3]:2025-11-02 17:23:58,388 - INFO - Avg. fwd time: 14.7365 / Avg. bwd time: 42.3475 / Avg. batch time: 472.8919 (ms) / GPU bubble ratio: 3.43%
[rank1]:2025-11-02 17:23:58,463 - INFO - Avg. fwd time: 15.0512 / Avg. bwd time: 41.1367 / Avg. batch time: 584.2912 (ms) / GPU bubble ratio: 23.07%
[rank0]:2025-11-02 17:23:58,496 - INFO - Avg. fwd time: 13.2032 / Avg. bwd time: 37.9354 / Avg. batch time: 638.9880 (ms) / GPU bubble ratio: 35.98%
[rank2]:2025-11-02 17:23:58,615 - INFO -  step: 100  loss: -4.0000  grad_norm: 30.9531  memory: 38.72GiB(27.69%)  tps: 6,202  tflops: 289.25  mfu: 29.25%
[rank2]:2025-11-02 17:23:58,615 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 17:23:58,617 - INFO -  step: 100  loss: -4.0000  grad_norm: 30.9531  memory: 47.26GiB(33.80%)  tps: 6,202  tflops: 289.25  mfu: 29.25%
[rank1]:2025-11-02 17:23:58,617 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 17:23:58,619 - INFO -  step: 100  loss:  4.0606  grad_norm: 30.9531  memory: 46.16GiB(33.01%)  tps: 6,202  tflops: 289.25  mfu: 29.25%
[rank3]:2025-11-02 17:23:58,619 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:23:58,621 - INFO -  step: 100  loss: -4.0000  grad_norm: 30.9531  memory: 54.93GiB(39.29%)  tps: 6,202  tflops: 289.25  mfu: 29.25%
[rank0]:2025-11-02 17:23:58,621 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:26:07,926 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:26:10,487 - INFO - Avg. fwd time: 13.1950 / Avg. bwd time: 36.2818 / Avg. batch time: 525.1772 (ms) / GPU bubble ratio: 24.63%
[rank3]:2025-11-02 17:26:10,445 - INFO - Avg. fwd time: 14.7313 / Avg. bwd time: 42.3716 / Avg. batch time: 472.8025 (ms) / GPU bubble ratio: 3.38%
[rank1]:2025-11-02 17:26:10,533 - INFO - Avg. fwd time: 15.0206 / Avg. bwd time: 41.1801 / Avg. batch time: 584.0483 (ms) / GPU bubble ratio: 23.02%
[rank2]:2025-11-02 17:26:10,604 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.4217  memory: 38.72GiB(27.69%)  tps: 6,207  tflops: 289.47  mfu: 29.27%
[rank3]:2025-11-02 17:26:10,609 - INFO -  step: 150  loss:  1.0837  grad_norm: 15.4217  memory: 46.16GiB(33.01%)  tps: 6,207  tflops: 289.48  mfu: 29.27%
[rank1]:2025-11-02 17:26:10,607 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.4217  memory: 47.26GiB(33.80%)  tps: 6,207  tflops: 289.47  mfu: 29.27%
[rank0]:2025-11-02 17:26:10,575 - INFO - Avg. fwd time: 13.1863 / Avg. bwd time: 37.9794 / Avg. batch time: 638.6601 (ms) / GPU bubble ratio: 35.91%
[rank0]:2025-11-02 17:26:10,611 - INFO -  step: 150  loss: -4.0000  grad_norm: 15.4217  memory: 54.93GiB(39.29%)  tps: 6,207  tflops: 289.47  mfu: 29.27%
[rank0]:2025-11-02 17:28:19,887 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:28:22,342 - INFO - Avg. fwd time: 13.1941 / Avg. bwd time: 36.3172 / Avg. batch time: 525.1049 (ms) / GPU bubble ratio: 24.57%
[rank3]:2025-11-02 17:28:22,313 - INFO - Avg. fwd time: 14.7275 / Avg. bwd time: 42.3832 / Avg. batch time: 472.7617 (ms) / GPU bubble ratio: 3.36%
[rank1]:2025-11-02 17:28:22,388 - INFO - Avg. fwd time: 15.0091 / Avg. bwd time: 41.2029 / Avg. batch time: 583.9318 (ms) / GPU bubble ratio: 22.99%
[rank0]:2025-11-02 17:28:22,420 - INFO - Avg. fwd time: 13.1807 / Avg. bwd time: 37.9984 / Avg. batch time: 638.5046 (ms) / GPU bubble ratio: 35.88%
[rank2]:2025-11-02 17:28:22,539 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 38.72GiB(27.69%)  tps: 6,209  tflops: 289.60  mfu: 29.28%
[rank2]:2025-11-02 17:28:22,539 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 17:28:22,541 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 47.26GiB(33.80%)  tps: 6,209  tflops: 289.60  mfu: 29.28%
[rank1]:2025-11-02 17:28:22,542 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 17:28:22,543 - INFO -  step: 200  loss:  0.3448  grad_norm:  0.4751  memory: 46.16GiB(33.01%)  tps: 6,209  tflops: 289.60  mfu: 29.28%
[rank3]:2025-11-02 17:28:22,544 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 17:28:22,546 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 54.93GiB(39.29%)  tps: 6,209  tflops: 289.60  mfu: 29.28%
[rank0]:2025-11-02 17:28:22,546 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 17:28:39,449 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 24,222
[rank2]:2025-11-02 17:28:39,450 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 17:28:39,437 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 24,243
[rank1]:2025-11-02 17:28:39,438 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:28:39,407 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 24,293
[rank0]:2025-11-02 17:28:39,408 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 17:28:39,467 - INFO - validate step: 200  loss:  0.2306  memory: 46.16GiB(33.01%)  tps: 24,205
[rank3]:2025-11-02 17:28:39,468 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:30:49,014 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 17:30:51,463 - INFO - Avg. fwd time: 13.1955 / Avg. bwd time: 36.3348 / Avg. batch time: 525.1158 (ms) / GPU bubble ratio: 24.54%
[rank3]:2025-11-02 17:30:51,433 - INFO - Avg. fwd time: 14.7275 / Avg. bwd time: 42.3958 / Avg. batch time: 472.7891 (ms) / GPU bubble ratio: 3.34%
[rank1]:2025-11-02 17:30:51,508 - INFO - Avg. fwd time: 15.0058 / Avg. bwd time: 41.2181 / Avg. batch time: 583.9176 (ms) / GPU bubble ratio: 22.97%
[rank0]:2025-11-02 17:30:51,540 - INFO - Avg. fwd time: 13.1837 / Avg. bwd time: 38.0168 / Avg. batch time: 638.4999 (ms) / GPU bubble ratio: 35.85%
[rank2]:2025-11-02 17:30:51,657 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2640  memory: 38.72GiB(27.69%)  tps: 6,196  tflops: 289.00  mfu: 29.22%
[rank1]:2025-11-02 17:30:51,660 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2640  memory: 47.26GiB(33.80%)  tps: 6,196  tflops: 288.97  mfu: 29.22%
[rank3]:2025-11-02 17:30:51,662 - INFO -  step: 250  loss:  0.2324  grad_norm:  0.2640  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank0]:2025-11-02 17:30:51,664 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2640  memory: 54.93GiB(39.29%)  tps: 6,194  tflops: 288.89  mfu: 29.21%
[rank0]:2025-11-02 17:33:01,161 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:33:03,733 - INFO - Avg. fwd time: 13.2011 / Avg. bwd time: 36.3504 / Avg. batch time: 525.1330 (ms) / GPU bubble ratio: 24.51%
[rank3]:2025-11-02 17:33:03,691 - INFO - Avg. fwd time: 14.7275 / Avg. bwd time: 42.4033 / Avg. batch time: 472.8023 (ms) / GPU bubble ratio: 3.33%
[rank1]:2025-11-02 17:33:03,781 - INFO - Avg. fwd time: 15.0089 / Avg. bwd time: 41.2340 / Avg. batch time: 583.9321 (ms) / GPU bubble ratio: 22.95%
[rank2]:2025-11-02 17:33:03,853 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3296  memory: 38.72GiB(27.69%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank2]:2025-11-02 17:33:03,854 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 17:33:03,858 - INFO -  step: 300  loss:  0.2695  grad_norm:  0.3296  memory: 46.16GiB(33.01%)  tps: 6,197  tflops: 289.03  mfu: 29.22%
[rank3]:2025-11-02 17:33:03,858 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 17:33:03,856 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3296  memory: 47.26GiB(33.80%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank1]:2025-11-02 17:33:03,856 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:33:03,825 - INFO - Avg. fwd time: 13.1903 / Avg. bwd time: 38.0407 / Avg. batch time: 638.5253 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 17:33:03,860 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3296  memory: 54.93GiB(39.29%)  tps: 6,197  tflops: 289.02  mfu: 29.22%
[rank0]:2025-11-02 17:33:03,860 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:35:13,685 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:35:16,154 - INFO - Avg. fwd time: 13.2110 / Avg. bwd time: 36.3661 / Avg. batch time: 525.2805 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-11-02 17:35:16,124 - INFO - Avg. fwd time: 14.7346 / Avg. bwd time: 42.4169 / Avg. batch time: 472.9398 (ms) / GPU bubble ratio: 3.33%
[rank0]:2025-11-02 17:35:16,233 - INFO - Avg. fwd time: 13.1942 / Avg. bwd time: 38.0523 / Avg. batch time: 638.6745 (ms) / GPU bubble ratio: 35.81%
[rank1]:2025-11-02 17:35:16,200 - INFO - Avg. fwd time: 15.0130 / Avg. bwd time: 41.2490 / Avg. batch time: 584.0803 (ms) / GPU bubble ratio: 22.94%
[rank1]:2025-11-02 17:35:16,352 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3706  memory: 47.26GiB(33.80%)  tps: 6,183  tflops: 288.37  mfu: 29.16%
[rank2]:2025-11-02 17:35:16,350 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3706  memory: 38.72GiB(27.69%)  tps: 6,183  tflops: 288.37  mfu: 29.16%
[rank3]:2025-11-02 17:35:16,354 - INFO -  step: 350  loss:  0.3348  grad_norm:  0.3706  memory: 46.16GiB(33.01%)  tps: 6,183  tflops: 288.37  mfu: 29.16%
[rank0]:2025-11-02 17:35:16,356 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3706  memory: 54.93GiB(39.29%)  tps: 6,183  tflops: 288.37  mfu: 29.16%
[rank0]:2025-11-02 17:37:25,992 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:37:28,465 - INFO - Avg. fwd time: 13.2154 / Avg. bwd time: 36.3746 / Avg. batch time: 525.3904 (ms) / GPU bubble ratio: 24.49%
[rank3]:2025-11-02 17:37:28,435 - INFO - Avg. fwd time: 14.7389 / Avg. bwd time: 42.4295 / Avg. batch time: 473.0501 (ms) / GPU bubble ratio: 3.32%
[rank0]:2025-11-02 17:37:28,544 - INFO - Avg. fwd time: 13.1915 / Avg. bwd time: 38.0569 / Avg. batch time: 638.7629 (ms) / GPU bubble ratio: 35.82%
[rank1]:2025-11-02 17:37:28,511 - INFO - Avg. fwd time: 15.0107 / Avg. bwd time: 41.2527 / Avg. batch time: 584.1828 (ms) / GPU bubble ratio: 22.95%
[rank1]:2025-11-02 17:37:28,663 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2951  memory: 47.26GiB(33.80%)  tps: 6,191  tflops: 288.77  mfu: 29.20%
[rank1]:2025-11-02 17:37:28,664 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-02 17:37:28,661 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2951  memory: 38.72GiB(27.69%)  tps: 6,191  tflops: 288.77  mfu: 29.20%
[rank2]:2025-11-02 17:37:28,661 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 17:37:28,665 - INFO -  step: 400  loss:  0.2726  grad_norm:  0.2951  memory: 46.16GiB(33.01%)  tps: 6,192  tflops: 288.77  mfu: 29.20%
[rank3]:2025-11-02 17:37:28,666 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 17:37:28,668 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2951  memory: 54.93GiB(39.29%)  tps: 6,191  tflops: 288.77  mfu: 29.20%
[rank0]:2025-11-02 17:37:28,668 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 17:37:43,699 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,251
[rank0]:2025-11-02 17:37:43,699 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 17:37:43,731 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,186
[rank1]:2025-11-02 17:37:43,731 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 17:37:43,743 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,158
[rank2]:2025-11-02 17:37:43,744 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 17:37:43,758 - INFO - validate step: 400  loss:  0.2368  memory: 46.16GiB(33.01%)  tps: 27,141
[rank3]:2025-11-02 17:37:43,760 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 17:39:53,498 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:39:56,061 - INFO - Avg. fwd time: 13.2216 / Avg. bwd time: 36.3837 / Avg. batch time: 525.5089 (ms) / GPU bubble ratio: 24.48%
[rank3]:2025-11-02 17:39:56,018 - INFO - Avg. fwd time: 14.7441 / Avg. bwd time: 42.4411 / Avg. batch time: 473.1652 (ms) / GPU bubble ratio: 3.31%
[rank0]:2025-11-02 17:39:56,151 - INFO - Avg. fwd time: 13.1916 / Avg. bwd time: 38.0653 / Avg. batch time: 638.8884 (ms) / GPU bubble ratio: 35.82%
[rank1]:2025-11-02 17:39:56,108 - INFO - Avg. fwd time: 15.0141 / Avg. bwd time: 41.2603 / Avg. batch time: 584.3011 (ms) / GPU bubble ratio: 22.95%
[rank1]:2025-11-02 17:39:56,183 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2957  memory: 47.26GiB(33.80%)  tps: 6,185  tflops: 288.46  mfu: 29.17%
[rank2]:2025-11-02 17:39:56,180 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2957  memory: 38.72GiB(27.69%)  tps: 6,186  tflops: 288.50  mfu: 29.17%
[rank3]:2025-11-02 17:39:56,185 - INFO -  step: 450  loss:  0.3014  grad_norm:  0.2957  memory: 46.16GiB(33.01%)  tps: 6,186  tflops: 288.52  mfu: 29.17%
[rank0]:2025-11-02 17:39:56,186 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2957  memory: 54.93GiB(39.29%)  tps: 6,183  tflops: 288.39  mfu: 29.16%
[rank3]:2025-11-02 17:40:22,444 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-02 17:40:48,976 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-02 17:40:49,229 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,244 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,188 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-02 17:40:49,221 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,244 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,249 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,274 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,257 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,346 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,274 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,299 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,338 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,413 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,381 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,423 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,388 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,443 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,385 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,439 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,467 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,522 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,523 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,523 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 17:40:49,524 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,477 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,531 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,487 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,525 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,492 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:40:49,547 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 17:40:49,564 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,556 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 17:40:49,586 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 17:41:05,326 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-02 17:41:05,572 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1741_max_batch_time.svg
[rank3]:> Batch Time: 624.09 ms, GPU Bubble Ratio: 34.03%, 27.64%, 36.00%, 26.25%
[rank3]:2025-11-02 17:41:05,757 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1741_min_batch_time.svg
[rank3]:> Batch Time: 352.25 ms, GPU Bubble Ratio: 70.05%, 23.86%, 32.66%, 23.40%
[rank3]:2025-11-02 17:41:05,972 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1741_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 371.03 ms, GPU Bubble Ratio: 23.75%, 17.60%, 24.28%, 22.21%
[rank3]:2025-11-02 17:41:05,972 - INFO - 	> Batch Time: 371.03 ms (Average Freeze Ratio: 0.71, Time Reduction Rate: 0.41)
[rank0]:2025-11-02 17:41:45,940 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:41:48,195 - INFO - Avg. fwd time: 13.3146 / Avg. bwd time: 35.5689 / Avg. batch time: 518.2031 (ms) / GPU bubble ratio: 24.53%
[rank3]:2025-11-02 17:41:48,182 - INFO - Avg. fwd time: 14.8513 / Avg. bwd time: 41.4844 / Avg. batch time: 466.3982 (ms) / GPU bubble ratio: 3.37%
[rank1]:2025-11-02 17:41:48,246 - INFO - Avg. fwd time: 15.1226 / Avg. bwd time: 40.2606 / Avg. batch time: 575.9809 (ms) / GPU bubble ratio: 23.08%
[rank0]:2025-11-02 17:41:48,279 - INFO - Avg. fwd time: 13.2713 / Avg. bwd time: 36.7530 / Avg. batch time: 629.4747 (ms) / GPU bubble ratio: 36.42%
[rank2]:2025-11-02 17:41:48,395 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.81, [MB1] 0.27/0.80, [MB2] 0.27/0.82, [MB3] 0.27/0.81, [MB4] 0.26/0.79, [MB5] 0.27/0.81, [MB6] 0.00/0.00, [MB7] 0.33/1.00
[rank2]:2025-11-02 17:41:48,396 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2650  memory: 39.07GiB(27.95%)  tps: 7,300  tflops: 340.49  mfu: 34.43%
[rank1]:2025-11-02 17:41:48,399 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/0.99, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.00/0.00, [MB6] 0.13/0.38, [MB7] 0.33/1.00
[rank1]:2025-11-02 17:41:48,400 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2650  memory: 48.08GiB(34.39%)  tps: 7,300  tflops: 340.48  mfu: 34.43%
[rank3]:2025-11-02 17:41:48,399 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.07/0.20
[rank3]:2025-11-02 17:41:48,402 - INFO -  step: 500  loss:  0.3006  grad_norm:  0.2650  memory: 46.47GiB(33.24%)  tps: 7,300  tflops: 340.48  mfu: 34.43%
[rank0]:2025-11-02 17:41:48,403 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.16/0.47, [MB1] 0.15/0.46, [MB2] 0.15/0.45, [MB3] 0.15/0.46, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.18/0.53, [MB7] 0.33/1.00
[rank0]:2025-11-02 17:41:48,403 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2650  memory: 55.09GiB(39.40%)  tps: 7,300  tflops: 340.48  mfu: 34.43%
[rank2]:2025-11-02 17:41:48,482 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1741_stage2_step500.svg
[rank1]:2025-11-02 17:41:48,497 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1741_stage1_step500.svg
[rank0]:2025-11-02 17:41:48,482 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1741_stage0_step500.svg
[rank3]:2025-11-02 17:41:48,570 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1741_real_step500_rank3.svg
[rank3]:> Batch Time: 413.52 ms, GPU Bubble Ratio: 46.47%, 30.87%, 34.34%, 26.77%
[rank3]:2025-11-02 17:41:48,633 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1741_stage3_step500.svg
[rank0]:2025-11-02 17:43:36,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:43:38,330 - INFO - Avg. fwd time: 13.3998 / Avg. bwd time: 34.8347 / Avg. batch time: 510.7852 (ms) / GPU bubble ratio: 24.45%
[rank1]:2025-11-02 17:43:38,345 - INFO - Avg. fwd time: 15.2366 / Avg. bwd time: 39.2923 / Avg. batch time: 567.5168 (ms) / GPU bubble ratio: 23.13%
[rank3]:2025-11-02 17:43:38,310 - INFO - Avg. fwd time: 14.9535 / Avg. bwd time: 40.5471 / Avg. batch time: 459.7039 (ms) / GPU bubble ratio: 3.42%
[rank0]:2025-11-02 17:43:38,376 - INFO - Avg. fwd time: 13.3407 / Avg. bwd time: 36.1656 / Avg. batch time: 620.5261 (ms) / GPU bubble ratio: 36.18%
[rank1]:2025-11-02 17:43:38,494 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.66/0.99, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.66/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.25/0.38, [MB7] 0.67/1.00
[rank1]:2025-11-02 17:43:38,495 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1423  memory: 48.88GiB(34.96%)  tps: 7,441  tflops: 347.04  mfu: 35.09%
[rank3]:2025-11-02 17:43:38,493 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.13/0.20
[rank3]:2025-11-02 17:43:38,497 - INFO -  step: 550  loss:  0.1657  grad_norm:  0.1423  memory: 47.84GiB(34.22%)  tps: 7,441  tflops: 347.05  mfu: 35.09%
[rank0]:2025-11-02 17:43:38,496 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.47, [MB1] 0.31/0.46, [MB2] 0.30/0.45, [MB3] 0.30/0.46, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.35/0.53, [MB7] 0.67/1.00
[rank0]:2025-11-02 17:43:38,497 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1423  memory: 56.40GiB(40.34%)  tps: 7,441  tflops: 347.05  mfu: 35.09%
[rank2]:2025-11-02 17:43:38,494 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.54/0.81, [MB1] 0.53/0.80, [MB2] 0.54/0.82, [MB3] 0.54/0.81, [MB4] 0.53/0.79, [MB5] 0.54/0.81, [MB6] 0.00/0.00, [MB7] 0.67/1.00
[rank2]:2025-11-02 17:43:38,494 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1423  memory: 39.52GiB(28.27%)  tps: 7,441  tflops: 347.03  mfu: 35.09%
[rank0]:2025-11-02 17:45:14,786 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:45:16,632 - INFO - Avg. fwd time: 13.5322 / Avg. bwd time: 33.7625 / Avg. batch time: 500.0026 (ms) / GPU bubble ratio: 24.33%
[rank1]:2025-11-02 17:45:16,657 - INFO - Avg. fwd time: 15.4078 / Avg. bwd time: 37.8490 / Avg. batch time: 555.2896 (ms) / GPU bubble ratio: 23.27%
[rank3]:2025-11-02 17:45:16,604 - INFO - Avg. fwd time: 15.1237 / Avg. bwd time: 39.1674 / Avg. batch time: 450.0188 (ms) / GPU bubble ratio: 3.49%
[rank0]:2025-11-02 17:45:16,689 - INFO - Avg. fwd time: 13.4569 / Avg. bwd time: 35.0090 / Avg. batch time: 607.5183 (ms) / GPU bubble ratio: 36.18%
[rank0]:2025-11-02 17:45:16,720 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-11-02 17:45:16,720 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1362  memory: 56.40GiB(40.34%)  tps: 8,340  tflops: 388.99  mfu: 39.33%
[rank0]:2025-11-02 17:45:16,720 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-02 17:45:16,707 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.81/0.81, [MB4] 0.79/0.79, [MB5] 0.81/0.81, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:45:16,708 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1362  memory: 39.52GiB(28.27%)  tps: 8,341  tflops: 389.03  mfu: 39.34%
[rank2]:2025-11-02 17:45:16,708 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 17:45:16,704 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.99/0.99, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank1]:2025-11-02 17:45:16,704 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1362  memory: 48.88GiB(34.96%)  tps: 8,341  tflops: 389.04  mfu: 39.34%
[rank1]:2025-11-02 17:45:16,704 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 17:45:16,700 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 17:45:16,704 - INFO -  step: 600  loss:  0.4377  grad_norm:  0.1362  memory: 47.84GiB(34.22%)  tps: 8,342  tflops: 389.06  mfu: 39.34%
[rank3]:2025-11-02 17:45:16,704 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 17:45:33,221 - INFO - validate step: 600  loss: -1.0000  memory: 56.40GiB(40.34%)  tps: 24,824
[rank1]:2025-11-02 17:45:33,255 - INFO - validate step: 600  loss: -1.0000  memory: 48.88GiB(34.96%)  tps: 24,749
[rank2]:2025-11-02 17:45:33,271 - INFO - validate step: 600  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,730
[rank3]:2025-11-02 17:45:33,272 - INFO - validate step: 600  loss:  0.2494  memory: 47.84GiB(34.22%)  tps: 24,725
[rank0]:2025-11-02 17:45:33,344 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1745_stage0_step600.svg
[rank1]:2025-11-02 17:45:33,347 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1745_stage1_step600.svg
[rank2]:2025-11-02 17:45:33,343 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1745_stage2_step600.svg
[rank3]:2025-11-02 17:45:33,450 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1745_real_step600_rank3.svg
[rank3]:> Batch Time: 432.59 ms, GPU Bubble Ratio: 39.16%, 29.70%, 34.62%, 26.45%
[rank3]:2025-11-02 17:45:33,515 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1745_stage3_step600.svg
[rank0]:2025-11-02 17:47:03,555 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 17:47:05,245 - INFO - Avg. fwd time: 15.5679 / Avg. bwd time: 36.5107 / Avg. batch time: 544.1605 (ms) / GPU bubble ratio: 23.44%
[rank2]:2025-11-02 17:47:05,240 - INFO - Avg. fwd time: 13.6662 / Avg. bwd time: 32.7299 / Avg. batch time: 490.2062 (ms) / GPU bubble ratio: 24.28%
[rank3]:2025-11-02 17:47:05,227 - INFO - Avg. fwd time: 15.2947 / Avg. bwd time: 37.8930 / Avg. batch time: 441.1852 (ms) / GPU bubble ratio: 3.55%
[rank0]:2025-11-02 17:47:05,277 - INFO - Avg. fwd time: 13.5747 / Avg. bwd time: 33.4676 / Avg. batch time: 595.6392 (ms) / GPU bubble ratio: 36.82%
[rank1]:2025-11-02 17:47:05,337 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.99/0.99, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 0.38/0.38, [MB7] 1.00/1.00
[rank3]:2025-11-02 17:47:05,301 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 17:47:05,366 - INFO -  step: 650  loss:  0.2725  grad_norm:  0.0000  memory: 47.84GiB(34.22%)  tps: 8,895  tflops: 414.88  mfu: 41.95%
[rank0]:2025-11-02 17:47:05,394 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.47/0.47, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.46/0.46, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.53/0.53, [MB7] 1.00/1.00
[rank0]:2025-11-02 17:47:05,394 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0792  memory: 56.44GiB(40.37%)  tps: 8,888  tflops: 414.52  mfu: 41.91%
[rank1]:2025-11-02 17:47:05,365 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 8,894  tflops: 414.80  mfu: 41.94%
[rank2]:2025-11-02 17:47:05,373 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.80/0.80, [MB2] 0.82/0.82, [MB3] 0.81/0.81, [MB4] 0.79/0.79, [MB5] 0.81/0.81, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:47:05,373 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0792  memory: 39.52GiB(28.27%)  tps: 8,894  tflops: 414.84  mfu: 41.95%
[rank0]:2025-11-02 17:48:35,775 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:48:37,493 - INFO - Avg. fwd time: 15.7258 / Avg. bwd time: 35.1637 / Avg. batch time: 532.9819 (ms) / GPU bubble ratio: 23.62%
[rank2]:2025-11-02 17:48:37,488 - INFO - Avg. fwd time: 13.7983 / Avg. bwd time: 31.6992 / Avg. batch time: 480.3690 (ms) / GPU bubble ratio: 24.23%
[rank3]:2025-11-02 17:48:37,474 - INFO - Avg. fwd time: 15.4642 / Avg. bwd time: 36.6224 / Avg. batch time: 432.3682 (ms) / GPU bubble ratio: 3.63%
[rank0]:2025-11-02 17:48:37,525 - INFO - Avg. fwd time: 13.6880 / Avg. bwd time: 31.9671 / Avg. batch time: 583.7207 (ms) / GPU bubble ratio: 37.43%
[rank0]:2025-11-02 17:48:37,793 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1748_rank0_trend_line.svg
[rank0]:2025-11-02 17:48:37,799 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.08/0.08, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank0]:2025-11-02 17:48:37,804 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.08/0.08, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.37/0.37, [MB7] 1.00/1.00
[rank0]:2025-11-02 17:48:37,805 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0840  memory: 56.44GiB(40.37%)  tps: 8,865  tflops: 413.46  mfu: 41.81%
[rank1]:2025-11-02 17:48:37,771 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1748_rank1_trend_line.svg
[rank1]:2025-11-02 17:48:37,800 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.12/0.12, [MB1] 0.62/0.62, [MB2] 0.50/0.50, [MB3] 0.51/0.51, [MB4] 0.52/0.52, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 17:48:37,802 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.12/0.12, [MB1] 0.62/0.62, [MB2] 0.50/0.50, [MB3] 0.51/0.51, [MB4] 0.52/0.52, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 17:48:37,802 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 8,862  tflops: 413.34  mfu: 41.79%
[rank2]:2025-11-02 17:48:37,761 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1748_rank2_trend_line.svg
[rank2]:2025-11-02 17:48:37,799 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.45/0.45, [MB2] 0.34/0.34, [MB3] 0.23/0.23, [MB4] 0.25/0.25, [MB5] 0.25/0.25, [MB6] 0.11/0.11, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:48:37,803 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.45/0.45, [MB2] 0.34/0.34, [MB3] 0.23/0.23, [MB4] 0.25/0.25, [MB5] 0.25/0.25, [MB6] 0.11/0.11, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:48:37,803 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0840  memory: 39.52GiB(28.27%)  tps: 8,863  tflops: 413.37  mfu: 41.80%
[rank3]:2025-11-02 17:48:37,759 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1748_rank3_trend_line.svg
[rank3]:2025-11-02 17:48:37,994 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1748_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 397.63 ms, GPU Bubble Ratio: 27.44%, 20.19%, 25.78%, 23.88%
[rank3]:2025-11-02 17:48:37,995 - INFO - 	> Batch Time: 397.63 ms (Average Freeze Ratio: 0.49)
[rank3]:2025-11-02 17:48:37,995 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.87/0.87, [MB4] 0.76/0.76, [MB5] 0.79/0.79, [MB6] 0.79/0.79, [MB7] 1.00/1.00
[rank3]:2025-11-02 17:48:37,998 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.87/0.87, [MB4] 0.76/0.76, [MB5] 0.79/0.79, [MB6] 0.79/0.79, [MB7] 1.00/1.00
[rank3]:2025-11-02 17:48:38,001 - INFO -  step: 700  loss:  0.3790  grad_norm:  0.0000  memory: 47.84GiB(34.22%)  tps: 8,843  tflops: 412.46  mfu: 41.70%
[rank0]:2025-11-02 17:48:38,068 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1748_stage0_step700.svg
[rank1]:2025-11-02 17:48:38,070 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1748_stage1_step700.svg
[rank2]:2025-11-02 17:48:38,068 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1748_stage2_step700.svg
[rank3]:2025-11-02 17:48:38,169 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1748_real_step700_rank3.svg
[rank3]:> Batch Time: 420.98 ms, GPU Bubble Ratio: 45.28%, 30.86%, 34.71%, 26.57%
[rank3]:2025-11-02 17:48:38,236 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1748_stage3_step700.svg
[rank0]:2025-11-02 17:50:15,505 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:50:17,406 - INFO - Avg. fwd time: 13.8738 / Avg. bwd time: 31.1891 / Avg. batch time: 473.0895 (ms) / GPU bubble ratio: 23.80%
[rank3]:2025-11-02 17:50:17,370 - INFO - Avg. fwd time: 15.5935 / Avg. bwd time: 35.4790 / Avg. batch time: 425.3183 (ms) / GPU bubble ratio: 3.94%
[rank0]:2025-11-02 17:50:17,476 - INFO - Avg. fwd time: 13.7540 / Avg. bwd time: 30.9565 / Avg. batch time: 575.8104 (ms) / GPU bubble ratio: 37.88%
[rank1]:2025-11-02 17:50:17,438 - INFO - Avg. fwd time: 15.8199 / Avg. bwd time: 34.4594 / Avg. batch time: 525.0698 (ms) / GPU bubble ratio: 23.39%
[rank1]:2025-11-02 17:50:17,510 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1581  memory: 48.88GiB(34.96%)  tps: 8,216  tflops: 383.20  mfu: 38.75%
[rank2]:2025-11-02 17:50:17,508 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1581  memory: 39.52GiB(28.27%)  tps: 8,216  tflops: 383.21  mfu: 38.75%
[rank3]:2025-11-02 17:50:17,491 - INFO -  step: 750  loss:  0.1759  grad_norm:  0.1581  memory: 47.84GiB(34.22%)  tps: 8,234  tflops: 384.04  mfu: 38.83%
[rank0]:2025-11-02 17:50:17,518 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.1581  memory: 56.44GiB(40.37%)  tps: 8,216  tflops: 383.17  mfu: 38.74%
[rank0]:2025-11-02 17:51:54,026 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:51:55,892 - INFO - Avg. fwd time: 15.8788 / Avg. bwd time: 33.9593 / Avg. batch time: 519.1268 (ms) / GPU bubble ratio: 23.20%
[rank2]:2025-11-02 17:51:55,878 - INFO - Avg. fwd time: 13.9207 / Avg. bwd time: 30.8158 / Avg. batch time: 467.5486 (ms) / GPU bubble ratio: 23.45%
[rank3]:2025-11-02 17:51:55,845 - INFO - Avg. fwd time: 15.6766 / Avg. bwd time: 34.6580 / Avg. batch time: 419.9878 (ms) / GPU bubble ratio: 4.12%
[rank0]:2025-11-02 17:51:55,947 - INFO - Avg. fwd time: 13.7953 / Avg. bwd time: 30.2035 / Avg. batch time: 569.8385 (ms) / GPU bubble ratio: 38.23%
[rank3]:2025-11-02 17:51:56,201 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1751_rank3_trend_line.svg
[rank0]:2025-11-02 17:51:56,238 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1751_rank0_trend_line.svg
[rank0]:2025-11-02 17:51:56,244 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 17:51:56,251 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1789  memory: 56.44GiB(40.37%)  tps: 8,297  tflops: 386.98  mfu: 39.13%
[rank0]:2025-11-02 17:51:56,251 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 17:51:56,215 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1751_rank1_trend_line.svg
[rank1]:2025-11-02 17:51:56,244 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.43/0.43, [MB1] 0.99/0.99, [MB2] 1.00/1.00, [MB3] 0.54/0.54, [MB4] 0.17/0.17, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 17:51:56,251 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1789  memory: 48.88GiB(34.96%)  tps: 8,296  tflops: 386.95  mfu: 39.13%
[rank1]:2025-11-02 17:51:56,251 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-02 17:51:56,214 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1751_rank2_trend_line.svg
[rank2]:2025-11-02 17:51:56,245 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.59/0.59, [MB2] 0.60/0.60, [MB3] 0.61/0.61, [MB4] 0.28/0.28, [MB5] 0.00/0.00, [MB6] 0.16/0.16, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:51:56,252 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.1789  memory: 39.52GiB(28.27%)  tps: 8,296  tflops: 386.94  mfu: 39.12%
[rank2]:2025-11-02 17:51:56,252 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 17:51:56,427 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1751_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 401.87 ms, GPU Bubble Ratio: 34.97%, 22.40%, 27.41%, 26.44%
[rank3]:2025-11-02 17:51:56,428 - INFO - 	> Batch Time: 401.87 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-11-02 17:51:56,428 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.99/0.99, [MB5] 0.72/0.72, [MB6] 0.48/0.48, [MB7] 1.00/1.00
[rank3]:2025-11-02 17:51:56,434 - INFO -  step: 800  loss:  0.3228  grad_norm:  0.1789  memory: 47.84GiB(34.22%)  tps: 8,280  tflops: 386.16  mfu: 39.05%
[rank3]:2025-11-02 17:51:56,434 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 17:52:13,222 - INFO - validate step: 800  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,135
[rank1]:2025-11-02 17:52:13,258 - INFO - validate step: 800  loss: -1.0000  memory: 48.88GiB(34.96%)  tps: 24,085
[rank2]:2025-11-02 17:52:13,274 - INFO - validate step: 800  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,064
[rank3]:2025-11-02 17:52:13,284 - INFO - validate step: 800  loss:  0.2521  memory: 47.84GiB(34.22%)  tps: 24,310
[rank0]:2025-11-02 17:52:13,357 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1752_stage0_step800.svg
[rank1]:2025-11-02 17:52:13,362 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1752_stage1_step800.svg
[rank2]:2025-11-02 17:52:13,357 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1752_stage2_step800.svg
[rank3]:2025-11-02 17:52:13,455 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1752_real_step800_rank3.svg
[rank3]:> Batch Time: 458.72 ms, GPU Bubble Ratio: 44.09%, 26.42%, 31.35%, 32.80%
[rank3]:2025-11-02 17:52:13,524 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1752_stage3_step800.svg
[rank0]:2025-11-02 17:53:50,760 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 17:53:52,579 - INFO - Avg. fwd time: 15.9595 / Avg. bwd time: 33.2924 / Avg. batch time: 513.2920 (ms) / GPU bubble ratio: 23.24%
[rank2]:2025-11-02 17:53:52,571 - INFO - Avg. fwd time: 13.9839 / Avg. bwd time: 30.3351 / Avg. batch time: 461.8709 (ms) / GPU bubble ratio: 23.24%
[rank3]:2025-11-02 17:53:52,547 - INFO - Avg. fwd time: 15.7717 / Avg. bwd time: 33.7989 / Avg. batch time: 414.3007 (ms) / GPU bubble ratio: 4.28%
[rank0]:2025-11-02 17:53:52,646 - INFO - Avg. fwd time: 13.8370 / Avg. bwd time: 29.4535 / Avg. batch time: 563.8810 (ms) / GPU bubble ratio: 38.58%
[rank0]:2025-11-02 17:53:52,765 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1245  memory: 56.44GiB(40.37%)  tps: 8,230  tflops: 383.83  mfu: 38.81%
[rank1]:2025-11-02 17:53:52,747 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1245  memory: 48.88GiB(34.96%)  tps: 8,234  tflops: 384.04  mfu: 38.83%
[rank2]:2025-11-02 17:53:52,750 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.1245  memory: 39.52GiB(28.27%)  tps: 8,235  tflops: 384.09  mfu: 38.84%
[rank3]:2025-11-02 17:53:52,745 - INFO -  step: 850  loss:  0.1187  grad_norm:  0.1245  memory: 47.84GiB(34.22%)  tps: 8,237  tflops: 384.15  mfu: 38.84%
[rank0]:2025-11-02 17:55:28,648 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 17:55:30,575 - INFO - Avg. fwd time: 14.0317 / Avg. bwd time: 29.8951 / Avg. batch time: 456.6443 (ms) / GPU bubble ratio: 23.04%
[rank3]:2025-11-02 17:55:30,536 - INFO - Avg. fwd time: 15.8427 / Avg. bwd time: 33.0305 / Avg. batch time: 409.0918 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-11-02 17:55:30,654 - INFO - Avg. fwd time: 13.8661 / Avg. bwd time: 28.7919 / Avg. batch time: 558.4123 (ms) / GPU bubble ratio: 38.89%
[rank1]:2025-11-02 17:55:30,615 - INFO - Avg. fwd time: 16.0219 / Avg. bwd time: 32.6935 / Avg. batch time: 507.9713 (ms) / GPU bubble ratio: 23.28%
[rank3]:2025-11-02 17:55:30,670 - INFO -  step: 900  loss:  0.1987  grad_norm:  0.1273  memory: 47.84GiB(34.22%)  tps: 8,366  tflops: 390.18  mfu: 39.45%
[rank0]:2025-11-02 17:55:30,695 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1273  memory: 56.44GiB(40.37%)  tps: 8,365  tflops: 390.15  mfu: 39.45%
[rank0]:2025-11-02 17:55:30,761 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1755_stage0_step900.svg
[rank1]:2025-11-02 17:55:30,678 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1273  memory: 48.88GiB(34.96%)  tps: 8,365  tflops: 390.15  mfu: 39.45%
[rank1]:2025-11-02 17:55:30,763 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1755_stage1_step900.svg
[rank2]:2025-11-02 17:55:30,681 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.1273  memory: 39.52GiB(28.27%)  tps: 8,365  tflops: 390.15  mfu: 39.45%
[rank2]:2025-11-02 17:55:30,761 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1755_stage2_step900.svg
[rank3]:2025-11-02 17:55:30,868 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1755_real_step900_rank3.svg
[rank3]:> Batch Time: 460.83 ms, GPU Bubble Ratio: 43.14%, 29.69%, 34.49%, 34.20%
[rank3]:2025-11-02 17:55:30,930 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1755_stage3_step900.svg
[rank0]:2025-11-02 17:57:08,024 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 17:57:09,842 - INFO - Avg. fwd time: 15.9032 / Avg. bwd time: 32.4582 / Avg. batch time: 405.2147 (ms) / GPU bubble ratio: 4.52%
[rank0]:2025-11-02 17:57:09,940 - INFO - Avg. fwd time: 13.8924 / Avg. bwd time: 28.2846 / Avg. batch time: 554.3938 (ms) / GPU bubble ratio: 39.14%
[rank1]:2025-11-02 17:57:09,873 - INFO - Avg. fwd time: 16.0772 / Avg. bwd time: 32.2282 / Avg. batch time: 504.0632 (ms) / GPU bubble ratio: 23.33%
[rank2]:2025-11-02 17:57:09,866 - INFO - Avg. fwd time: 14.0743 / Avg. bwd time: 29.5544 / Avg. batch time: 452.7924 (ms) / GPU bubble ratio: 22.92%
[rank1]:2025-11-02 17:57:10,043 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2259  memory: 48.88GiB(34.96%)  tps: 8,244  tflops: 384.52  mfu: 38.88%
[rank2]:2025-11-02 17:57:10,047 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2259  memory: 39.52GiB(28.27%)  tps: 8,244  tflops: 384.52  mfu: 38.88%
[rank3]:2025-11-02 17:57:10,043 - INFO -  step: 950  loss:  0.2942  grad_norm:  0.2259  memory: 47.84GiB(34.22%)  tps: 8,244  tflops: 384.49  mfu: 38.88%
[rank0]:2025-11-02 17:57:10,061 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.2259  memory: 56.44GiB(40.37%)  tps: 8,244  tflops: 384.52  mfu: 38.88%
[rank0]:2025-11-02 17:58:47,877 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 17:58:49,711 - INFO - Avg. fwd time: 16.1379 / Avg. bwd time: 31.7473 / Avg. batch time: 500.0770 (ms) / GPU bubble ratio: 23.40%
[rank2]:2025-11-02 17:58:49,703 - INFO - Avg. fwd time: 14.1201 / Avg. bwd time: 29.2132 / Avg. batch time: 448.8508 (ms) / GPU bubble ratio: 22.77%
[rank3]:2025-11-02 17:58:49,678 - INFO - Avg. fwd time: 15.9687 / Avg. bwd time: 31.8600 / Avg. batch time: 401.2758 (ms) / GPU bubble ratio: 4.65%
[rank0]:2025-11-02 17:58:49,777 - INFO - Avg. fwd time: 13.9232 / Avg. bwd time: 27.7505 / Avg. batch time: 550.2963 (ms) / GPU bubble ratio: 39.42%
[rank2]:2025-11-02 17:58:50,123 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1758_rank2_trend_line.svg
[rank3]:2025-11-02 17:58:50,120 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1758_rank3_trend_line.svg
[rank1]:2025-11-02 17:58:50,150 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1758_rank1_trend_line.svg
[rank1]:2025-11-02 17:58:50,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.72/0.72, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.41/0.41, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 17:58:50,182 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0877  memory: 48.88GiB(34.96%)  tps: 8,181  tflops: 381.55  mfu: 38.58%
[rank1]:2025-11-02 17:58:50,182 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 17:58:50,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.65/0.65, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.45/0.45, [MB5] 0.17/0.17, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 17:58:50,183 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0877  memory: 39.52GiB(28.27%)  tps: 8,181  tflops: 381.56  mfu: 38.58%
[rank2]:2025-11-02 17:58:50,183 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 17:58:50,170 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1758_rank0_trend_line.svg
[rank0]:2025-11-02 17:58:50,176 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 17:58:50,183 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0877  memory: 56.44GiB(40.37%)  tps: 8,182  tflops: 381.61  mfu: 38.59%
[rank0]:2025-11-02 17:58:50,183 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 17:58:50,369 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1758_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 398.79 ms, GPU Bubble Ratio: 38.70%, 23.60%, 26.91%, 26.78%
[rank3]:2025-11-02 17:58:50,369 - INFO - 	> Batch Time: 398.79 ms (Average Freeze Ratio: 0.52)
[rank3]:2025-11-02 17:58:50,370 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.85/0.85, [MB4] 0.83/0.83, [MB5] 0.86/0.86, [MB6] 0.66/0.66, [MB7] 1.00/1.00
[rank3]:2025-11-02 17:58:50,378 - INFO -  step: 1000  loss:  0.1667  grad_norm:  0.0877  memory: 47.84GiB(34.22%)  tps: 8,165  tflops: 380.81  mfu: 38.50%
[rank3]:2025-11-02 17:58:50,378 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 17:59:07,113 - INFO - validate step: 1000  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,195
[rank1]:2025-11-02 17:59:07,150 - INFO - validate step: 1000  loss: -1.0000  memory: 48.88GiB(34.96%)  tps: 24,139
[rank1]:2025-11-02 17:59:07,248 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1759_stage1_step1000.svg
[rank2]:2025-11-02 17:59:07,164 - INFO - validate step: 1000  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,122
[rank2]:2025-11-02 17:59:07,245 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1759_stage2_step1000.svg
[rank0]:2025-11-02 17:59:07,243 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1759_stage0_step1000.svg
[rank3]:2025-11-02 17:59:07,176 - INFO - validate step: 1000  loss:  0.2520  memory: 47.84GiB(34.22%)  tps: 24,386
[rank3]:2025-11-02 17:59:07,346 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1759_real_step1000_rank3.svg
[rank3]:> Batch Time: 463.10 ms, GPU Bubble Ratio: 43.32%, 30.68%, 34.59%, 33.46%
[rank3]:2025-11-02 17:59:07,410 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1759_stage3_step1000.svg
[rank0]:2025-11-02 18:00:49,369 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:00:51,396 - INFO - Avg. fwd time: 16.0136 / Avg. bwd time: 31.3325 / Avg. batch time: 398.8677 (ms) / GPU bubble ratio: 5.04%
[rank1]:2025-11-02 18:00:51,470 - INFO - Avg. fwd time: 16.1926 / Avg. bwd time: 31.1672 / Avg. batch time: 497.2551 (ms) / GPU bubble ratio: 23.81%
[rank1]:2025-11-02 18:00:51,524 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 7,849  tflops: 366.07  mfu: 37.01%
[rank2]:2025-11-02 18:00:51,433 - INFO - Avg. fwd time: 14.1558 / Avg. bwd time: 28.8719 / Avg. batch time: 446.3291 (ms) / GPU bubble ratio: 22.88%
[rank0]:2025-11-02 18:00:51,515 - INFO - Avg. fwd time: 13.9026 / Avg. bwd time: 28.2517 / Avg. batch time: 547.7053 (ms) / GPU bubble ratio: 38.43%
[rank3]:2025-11-02 18:00:51,533 - INFO -  step: 1050  loss:  0.2847  grad_norm:  0.5299  memory: 47.84GiB(34.22%)  tps: 7,850  tflops: 366.13  mfu: 37.02%
[rank2]:2025-11-02 18:00:51,543 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5299  memory: 39.52GiB(28.27%)  tps: 7,848  tflops: 366.05  mfu: 37.01%
[rank0]:2025-11-02 18:00:51,557 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5299  memory: 56.44GiB(40.37%)  tps: 7,843  tflops: 365.82  mfu: 36.99%
[rank0]:2025-11-02 18:02:35,908 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:02:37,815 - INFO - Avg. fwd time: 16.0617 / Avg. bwd time: 30.9651 / Avg. batch time: 397.2450 (ms) / GPU bubble ratio: 5.29%
[rank2]:2025-11-02 18:02:37,852 - INFO - Avg. fwd time: 14.1918 / Avg. bwd time: 28.6298 / Avg. batch time: 444.6074 (ms) / GPU bubble ratio: 22.95%
[rank1]:2025-11-02 18:02:37,853 - INFO - Avg. fwd time: 16.2480 / Avg. bwd time: 30.7261 / Avg. batch time: 495.3547 (ms) / GPU bubble ratio: 24.14%
[rank0]:2025-11-02 18:02:37,913 - INFO - Avg. fwd time: 13.8956 / Avg. bwd time: 28.6998 / Avg. batch time: 546.0140 (ms) / GPU bubble ratio: 37.59%
[rank1]:2025-11-02 18:02:38,001 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 7,694  tflops: 358.83  mfu: 36.28%
[rank3]:2025-11-02 18:02:38,015 - INFO -  step: 1100  loss:  0.2558  grad_norm:  0.2924  memory: 47.84GiB(34.22%)  tps: 7,693  tflops: 358.82  mfu: 36.28%
[rank0]:2025-11-02 18:02:38,035 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2924  memory: 56.44GiB(40.37%)  tps: 7,694  tflops: 358.83  mfu: 36.28%
[rank2]:2025-11-02 18:02:38,021 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.2924  memory: 39.52GiB(28.27%)  tps: 7,694  tflops: 358.83  mfu: 36.28%
[rank2]:2025-11-02 18:02:38,105 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1802_stage2_step1100.svg
[rank1]:2025-11-02 18:02:38,106 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1802_stage1_step1100.svg
[rank0]:2025-11-02 18:02:38,100 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1802_stage0_step1100.svg
[rank3]:2025-11-02 18:02:38,214 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1802_real_step1100_rank3.svg
[rank3]:> Batch Time: 502.67 ms, GPU Bubble Ratio: 15.47%, 39.25%, 39.55%, 35.95%
[rank3]:2025-11-02 18:02:38,278 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1802_stage3_step1100.svg
[rank0]:2025-11-02 18:04:21,566 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:04:23,468 - INFO - Avg. fwd time: 16.0984 / Avg. bwd time: 30.5841 / Avg. batch time: 395.4400 (ms) / GPU bubble ratio: 5.56%
[rank2]:2025-11-02 18:04:23,507 - INFO - Avg. fwd time: 14.2227 / Avg. bwd time: 28.3636 / Avg. batch time: 442.7286 (ms) / GPU bubble ratio: 23.05%
[rank1]:2025-11-02 18:04:23,508 - INFO - Avg. fwd time: 16.2989 / Avg. bwd time: 30.2419 / Avg. batch time: 493.2484 (ms) / GPU bubble ratio: 24.52%
[rank0]:2025-11-02 18:04:23,566 - INFO - Avg. fwd time: 13.8812 / Avg. bwd time: 29.1722 / Avg. batch time: 544.1202 (ms) / GPU bubble ratio: 36.70%
[rank2]:2025-11-02 18:04:23,674 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5501  memory: 39.52GiB(28.27%)  tps: 7,754  tflops: 361.63  mfu: 36.57%
[rank1]:2025-11-02 18:04:23,657 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 7,753  tflops: 361.62  mfu: 36.56%
[rank3]:2025-11-02 18:04:23,671 - INFO -  step: 1150  loss:  0.2542  grad_norm:  0.5501  memory: 47.84GiB(34.22%)  tps: 7,754  tflops: 361.63  mfu: 36.56%
[rank0]:2025-11-02 18:04:23,691 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5501  memory: 56.44GiB(40.37%)  tps: 7,753  tflops: 361.62  mfu: 36.56%
[rank0]:2025-11-02 18:06:06,797 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:06:08,861 - INFO - Avg. fwd time: 14.2509 / Avg. bwd time: 28.1135 / Avg. batch time: 440.9535 (ms) / GPU bubble ratio: 23.14%
[rank3]:2025-11-02 18:06:08,822 - INFO - Avg. fwd time: 16.1296 / Avg. bwd time: 30.2363 / Avg. batch time: 393.7691 (ms) / GPU bubble ratio: 5.80%
[rank1]:2025-11-02 18:06:08,899 - INFO - Avg. fwd time: 16.3437 / Avg. bwd time: 29.7971 / Avg. batch time: 491.2682 (ms) / GPU bubble ratio: 24.86%
[rank0]:2025-11-02 18:06:08,945 - INFO - Avg. fwd time: 13.8671 / Avg. bwd time: 29.6021 / Avg. batch time: 542.3339 (ms) / GPU bubble ratio: 35.88%
[rank3]:2025-11-02 18:06:09,281 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1806_rank3_trend_line.svg
[rank2]:2025-11-02 18:06:09,283 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1806_rank2_trend_line.svg
[rank2]:2025-11-02 18:06:09,362 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.78/0.78, [MB2] 0.58/0.58, [MB3] 0.24/0.24, [MB4] 0.24/0.24, [MB5] 0.24/0.24, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 18:06:09,369 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2743  memory: 39.52GiB(28.27%)  tps: 7,751  tflops: 361.49  mfu: 36.55%
[rank2]:2025-11-02 18:06:09,369 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 18:06:09,316 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1806_rank1_trend_line.svg
[rank1]:2025-11-02 18:06:09,362 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 0.24/0.24, [MB3] 0.21/0.21, [MB4] 0.23/0.23, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 18:06:09,366 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.88GiB(34.96%)  tps: 7,750  tflops: 361.44  mfu: 36.55%
[rank1]:2025-11-02 18:06:09,366 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-02 18:06:09,356 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1806_rank0_trend_line.svg
[rank0]:2025-11-02 18:06:09,362 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.37/0.37, [MB1] 0.03/0.03, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 18:06:09,370 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.2743  memory: 56.44GiB(40.37%)  tps: 7,752  tflops: 361.55  mfu: 36.56%
[rank0]:2025-11-02 18:06:09,370 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 18:06:09,544 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1806_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 403.42 ms, GPU Bubble Ratio: 25.42%, 25.22%, 27.85%, 27.32%
[rank3]:2025-11-02 18:06:09,545 - INFO - 	> Batch Time: 403.42 ms (Average Freeze Ratio: 0.51)
[rank3]:2025-11-02 18:06:09,545 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.96/0.96, [MB4] 0.74/0.74, [MB5] 0.75/0.75, [MB6] 0.75/0.75, [MB7] 1.00/1.00
[rank3]:2025-11-02 18:06:09,553 - INFO -  step: 1200  loss:  0.2904  grad_norm:  0.2743  memory: 47.84GiB(34.22%)  tps: 7,737  tflops: 360.85  mfu: 36.49%
[rank3]:2025-11-02 18:06:09,553 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 18:06:26,088 - INFO - validate step: 1200  loss: -1.0000  memory: 48.88GiB(34.96%)  tps: 24,495
[rank1]:2025-11-02 18:06:26,089 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 18:06:26,055 - INFO - validate step: 1200  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,548
[rank0]:2025-11-02 18:06:26,056 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 18:06:26,060 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 18:06:26,105 - INFO - validate step: 1200  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,474
[rank2]:2025-11-02 18:06:26,106 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 18:06:26,123 - INFO - validate step: 1200  loss:  0.2565  memory: 47.84GiB(34.22%)  tps: 24,721
[rank3]:2025-11-02 18:06:26,124 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 18:06:40,301 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.21 seconds.
[rank2]:2025-11-02 18:06:41,675 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.57 seconds.
[rank3]:2025-11-02 18:06:43,793 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.67 seconds.
[rank0]:2025-11-02 18:06:45,862 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 18:06:45,867 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.81 seconds.
[rank2]:2025-11-02 18:06:45,948 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1806_stage2_step1200.svg
[rank1]:2025-11-02 18:06:45,960 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1806_stage1_step1200.svg
[rank0]:2025-11-02 18:06:46,024 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1806_stage0_step1200.svg
[rank3]:2025-11-02 18:06:46,159 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1806_real_step1200_rank3.svg
[rank3]:> Batch Time: 500.56 ms, GPU Bubble Ratio: 15.64%, 40.12%, 39.51%, 36.71%
[rank3]:2025-11-02 18:06:46,227 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1806_stage3_step1200.svg
[rank0]:2025-11-02 18:08:26,760 - INFO - [GC] Peforming periodical GC collection 2.78 seconds
[rank2]:2025-11-02 18:08:28,585 - INFO - Avg. fwd time: 14.2709 / Avg. bwd time: 27.9187 / Avg. batch time: 438.6594 (ms) / GPU bubble ratio: 23.06%
[rank3]:2025-11-02 18:08:28,553 - INFO - Avg. fwd time: 16.1592 / Avg. bwd time: 29.9647 / Avg. batch time: 391.5699 (ms) / GPU bubble ratio: 5.77%
[rank1]:2025-11-02 18:08:28,627 - INFO - Avg. fwd time: 16.3654 / Avg. bwd time: 29.5952 / Avg. batch time: 488.9308 (ms) / GPU bubble ratio: 24.80%
[rank0]:2025-11-02 18:08:28,662 - INFO - Avg. fwd time: 13.8952 / Avg. bwd time: 29.1474 / Avg. batch time: 539.9743 (ms) / GPU bubble ratio: 36.23%
[rank2]:2025-11-02 18:08:28,756 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1964  memory: 39.52GiB(28.27%)  tps: 6,679  tflops: 311.52  mfu: 31.50%
[rank1]:2025-11-02 18:08:28,759 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1964  memory: 49.74GiB(35.58%)  tps: 6,678  tflops: 311.47  mfu: 31.49%
[rank3]:2025-11-02 18:08:28,747 - INFO -  step: 1250  loss:  0.3159  grad_norm:  0.1964  memory: 47.84GiB(34.22%)  tps: 6,681  tflops: 311.59  mfu: 31.51%
[rank0]:2025-11-02 18:08:28,768 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1964  memory: 56.44GiB(40.37%)  tps: 6,676  tflops: 311.36  mfu: 31.48%
[rank0]:2025-11-02 18:10:05,825 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:10:07,654 - INFO - Avg. fwd time: 14.2942 / Avg. bwd time: 27.7229 / Avg. batch time: 435.9879 (ms) / GPU bubble ratio: 22.90%
[rank3]:2025-11-02 18:10:07,623 - INFO - Avg. fwd time: 16.1936 / Avg. bwd time: 29.6485 / Avg. batch time: 389.0310 (ms) / GPU bubble ratio: 5.73%
[rank1]:2025-11-02 18:10:07,696 - INFO - Avg. fwd time: 16.3907 / Avg. bwd time: 29.3849 / Avg. batch time: 486.2157 (ms) / GPU bubble ratio: 24.68%
[rank0]:2025-11-02 18:10:07,732 - INFO - Avg. fwd time: 13.9230 / Avg. bwd time: 28.6622 / Avg. batch time: 537.2583 (ms) / GPU bubble ratio: 36.59%
[rank2]:2025-11-02 18:10:07,827 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0833  memory: 39.52GiB(28.27%)  tps: 8,269  tflops: 385.66  mfu: 38.99%
[rank1]:2025-11-02 18:10:07,828 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0833  memory: 49.74GiB(35.58%)  tps: 8,269  tflops: 385.67  mfu: 39.00%
[rank3]:2025-11-02 18:10:07,816 - INFO -  step: 1300  loss:  0.2033  grad_norm:  0.0833  memory: 47.84GiB(34.22%)  tps: 8,269  tflops: 385.67  mfu: 39.00%
[rank0]:2025-11-02 18:10:07,836 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0833  memory: 56.44GiB(40.37%)  tps: 8,269  tflops: 385.67  mfu: 39.00%
[rank0]:2025-11-02 18:10:07,910 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1810_stage0_step1300.svg
[rank2]:2025-11-02 18:10:07,909 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1810_stage2_step1300.svg
[rank1]:2025-11-02 18:10:07,912 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1810_stage1_step1300.svg
[rank3]:2025-11-02 18:10:08,007 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1810_real_step1300_rank3.svg
[rank3]:> Batch Time: 454.37 ms, GPU Bubble Ratio: 44.41%, 27.43%, 33.86%, 31.71%
[rank3]:2025-11-02 18:10:08,073 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1810_stage3_step1300.svg
[rank0]:2025-11-02 18:11:46,312 - INFO - [GC] Peforming periodical GC collection 0.05 seconds
[rank2]:2025-11-02 18:11:48,217 - INFO - Avg. fwd time: 14.3195 / Avg. bwd time: 27.5479 / Avg. batch time: 433.6718 (ms) / GPU bubble ratio: 22.77%
[rank1]:2025-11-02 18:11:48,258 - INFO - Avg. fwd time: 16.4194 / Avg. bwd time: 29.1945 / Avg. batch time: 483.8796 (ms) / GPU bubble ratio: 24.59%
[rank3]:2025-11-02 18:11:48,180 - INFO - Avg. fwd time: 16.2303 / Avg. bwd time: 29.3603 / Avg. batch time: 386.7976 (ms) / GPU bubble ratio: 5.71%
[rank0]:2025-11-02 18:11:48,299 - INFO - Avg. fwd time: 13.9548 / Avg. bwd time: 28.2117 / Avg. batch time: 534.9156 (ms) / GPU bubble ratio: 36.94%
[rank2]:2025-11-02 18:11:48,329 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1245  memory: 39.52GiB(28.27%)  tps: 8,151  tflops: 380.17  mfu: 38.44%
[rank1]:2025-11-02 18:11:48,336 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1245  memory: 49.74GiB(35.58%)  tps: 8,151  tflops: 380.15  mfu: 38.44%
[rank3]:2025-11-02 18:11:48,315 - INFO -  step: 1350  loss:  0.1382  grad_norm:  0.1245  memory: 47.84GiB(34.22%)  tps: 8,151  tflops: 380.18  mfu: 38.44%
[rank0]:2025-11-02 18:11:48,341 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.1245  memory: 56.44GiB(40.37%)  tps: 8,151  tflops: 380.16  mfu: 38.44%
[rank0]:2025-11-02 18:13:25,435 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:13:27,304 - INFO - Avg. fwd time: 14.3355 / Avg. bwd time: 27.4049 / Avg. batch time: 431.7012 (ms) / GPU bubble ratio: 22.65%
[rank3]:2025-11-02 18:13:27,270 - INFO - Avg. fwd time: 16.2541 / Avg. bwd time: 29.1291 / Avg. batch time: 384.9263 (ms) / GPU bubble ratio: 5.68%
[rank1]:2025-11-02 18:13:27,345 - INFO - Avg. fwd time: 16.4380 / Avg. bwd time: 29.0351 / Avg. batch time: 481.8676 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-11-02 18:13:27,381 - INFO - Avg. fwd time: 13.9765 / Avg. bwd time: 27.8443 / Avg. batch time: 532.9031 (ms) / GPU bubble ratio: 37.22%
[rank1]:2025-11-02 18:13:27,477 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2052  memory: 49.74GiB(35.58%)  tps: 8,263  tflops: 385.39  mfu: 38.97%
[rank1]:2025-11-02 18:13:27,477 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 18:13:27,476 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2052  memory: 39.52GiB(28.27%)  tps: 8,263  tflops: 385.36  mfu: 38.97%
[rank2]:2025-11-02 18:13:27,476 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 18:13:27,467 - INFO -  step: 1400  loss:  0.4309  grad_norm:  0.2052  memory: 47.84GiB(34.22%)  tps: 8,262  tflops: 385.35  mfu: 38.96%
[rank3]:2025-11-02 18:13:27,467 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 18:13:27,486 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.2052  memory: 56.44GiB(40.37%)  tps: 8,263  tflops: 385.37  mfu: 38.97%
[rank0]:2025-11-02 18:13:27,487 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 18:13:44,527 - INFO - validate step: 1400  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,024
[rank2]:2025-11-02 18:13:44,543 - INFO - validate step: 1400  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,000
[rank3]:2025-11-02 18:13:44,555 - INFO - validate step: 1400  loss:  0.2569  memory: 47.84GiB(34.22%)  tps: 23,972
[rank0]:2025-11-02 18:13:44,491 - INFO - validate step: 1400  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,088
[rank1]:2025-11-02 18:13:44,631 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1813_stage1_step1400.svg
[rank2]:2025-11-02 18:13:44,630 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1813_stage2_step1400.svg
[rank0]:2025-11-02 18:13:44,629 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1813_stage0_step1400.svg
[rank3]:2025-11-02 18:13:44,731 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1813_real_step1400_rank3.svg
[rank3]:> Batch Time: 460.29 ms, GPU Bubble Ratio: 45.11%, 27.70%, 33.82%, 31.63%
[rank3]:2025-11-02 18:13:44,799 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1813_stage3_step1400.svg
[rank0]:2025-11-02 18:15:23,706 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:15:25,513 - INFO - Avg. fwd time: 16.2909 / Avg. bwd time: 28.8884 / Avg. batch time: 383.0771 (ms) / GPU bubble ratio: 5.65%
[rank1]:2025-11-02 18:15:25,586 - INFO - Avg. fwd time: 16.4662 / Avg. bwd time: 28.8702 / Avg. batch time: 479.9416 (ms) / GPU bubble ratio: 24.43%
[rank2]:2025-11-02 18:15:25,543 - INFO - Avg. fwd time: 14.3610 / Avg. bwd time: 27.2566 / Avg. batch time: 429.7966 (ms) / GPU bubble ratio: 22.54%
[rank0]:2025-11-02 18:15:25,622 - INFO - Avg. fwd time: 14.0056 / Avg. bwd time: 27.4580 / Avg. batch time: 530.9574 (ms) / GPU bubble ratio: 37.53%
[rank1]:2025-11-02 18:15:25,716 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1683  memory: 49.74GiB(35.58%)  tps: 8,096  tflops: 377.59  mfu: 38.18%
[rank2]:2025-11-02 18:15:25,715 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1683  memory: 39.52GiB(28.27%)  tps: 8,097  tflops: 377.65  mfu: 38.19%
[rank3]:2025-11-02 18:15:25,707 - INFO -  step: 1450  loss:  0.2355  grad_norm:  0.1683  memory: 47.84GiB(34.22%)  tps: 8,099  tflops: 377.73  mfu: 38.19%
[rank0]:2025-11-02 18:15:25,726 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.1683  memory: 56.44GiB(40.37%)  tps: 8,092  tflops: 377.42  mfu: 38.16%
[rank0]:2025-11-02 18:17:04,163 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:17:06,083 - INFO - Avg. fwd time: 16.3318 / Avg. bwd time: 28.6324 / Avg. batch time: 381.1883 (ms) / GPU bubble ratio: 5.63%
[rank1]:2025-11-02 18:17:06,163 - INFO - Avg. fwd time: 16.4939 / Avg. bwd time: 28.7192 / Avg. batch time: 477.9911 (ms) / GPU bubble ratio: 24.33%
[rank2]:2025-11-02 18:17:06,122 - INFO - Avg. fwd time: 14.3866 / Avg. bwd time: 27.1160 / Avg. batch time: 427.8440 (ms) / GPU bubble ratio: 22.40%
[rank3]:2025-11-02 18:17:06,221 - INFO -  step: 1500  loss:  0.3227  grad_norm:  0.2427  memory: 47.84GiB(34.22%)  tps: 8,150  tflops: 380.13  mfu: 38.44%
[rank0]:2025-11-02 18:17:06,205 - INFO - Avg. fwd time: 14.0340 / Avg. bwd time: 27.0980 / Avg. batch time: 529.0269 (ms) / GPU bubble ratio: 37.80%
[rank0]:2025-11-02 18:17:06,247 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2427  memory: 56.44GiB(40.37%)  tps: 8,150  tflops: 380.10  mfu: 38.43%
[rank1]:2025-11-02 18:17:06,243 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2427  memory: 49.74GiB(35.58%)  tps: 8,149  tflops: 380.07  mfu: 38.43%
[rank2]:2025-11-02 18:17:06,239 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.2427  memory: 39.52GiB(28.27%)  tps: 8,149  tflops: 380.09  mfu: 38.43%
[rank0]:2025-11-02 18:17:06,319 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1817_stage0_step1500.svg
[rank1]:2025-11-02 18:17:06,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1817_stage1_step1500.svg
[rank2]:2025-11-02 18:17:06,322 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1817_stage2_step1500.svg
[rank3]:2025-11-02 18:17:06,419 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1817_real_step1500_rank3.svg
[rank3]:> Batch Time: 463.30 ms, GPU Bubble Ratio: 44.34%, 27.60%, 33.42%, 33.09%
[rank3]:2025-11-02 18:17:06,489 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1817_stage3_step1500.svg
[rank0]:2025-11-02 18:18:44,842 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:18:46,686 - INFO - Avg. fwd time: 14.4067 / Avg. bwd time: 27.0091 / Avg. batch time: 426.2919 (ms) / GPU bubble ratio: 22.28%
[rank3]:2025-11-02 18:18:46,653 - INFO - Avg. fwd time: 16.3655 / Avg. bwd time: 28.4219 / Avg. batch time: 379.6844 (ms) / GPU bubble ratio: 5.63%
[rank1]:2025-11-02 18:18:46,729 - INFO - Avg. fwd time: 16.5164 / Avg. bwd time: 28.6007 / Avg. batch time: 476.4350 (ms) / GPU bubble ratio: 24.24%
[rank0]:2025-11-02 18:18:46,764 - INFO - Avg. fwd time: 14.0570 / Avg. bwd time: 26.8073 / Avg. batch time: 527.5020 (ms) / GPU bubble ratio: 38.03%
[rank1]:2025-11-02 18:18:46,861 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.2182  memory: 49.74GiB(35.58%)  tps: 8,142  tflops: 379.73  mfu: 38.40%
[rank2]:2025-11-02 18:18:46,857 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.2182  memory: 39.52GiB(28.27%)  tps: 8,142  tflops: 379.73  mfu: 38.40%
[rank3]:2025-11-02 18:18:46,843 - INFO -  step: 1550  loss:  0.3595  grad_norm:  0.2182  memory: 47.84GiB(34.22%)  tps: 8,141  tflops: 379.72  mfu: 38.39%
[rank0]:2025-11-02 18:18:46,868 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.2182  memory: 56.44GiB(40.37%)  tps: 8,141  tflops: 379.72  mfu: 38.39%
[rank0]:2025-11-02 18:20:24,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:20:26,347 - INFO - Avg. fwd time: 14.4252 / Avg. bwd time: 26.8892 / Avg. batch time: 424.4026 (ms) / GPU bubble ratio: 22.12%
[rank3]:2025-11-02 18:20:26,315 - INFO - Avg. fwd time: 16.3992 / Avg. bwd time: 28.1698 / Avg. batch time: 377.8576 (ms) / GPU bubble ratio: 5.64%
[rank1]:2025-11-02 18:20:26,388 - INFO - Avg. fwd time: 16.5361 / Avg. bwd time: 28.4693 / Avg. batch time: 474.5463 (ms) / GPU bubble ratio: 24.13%
[rank0]:2025-11-02 18:20:26,425 - INFO - Avg. fwd time: 14.0783 / Avg. bwd time: 26.4856 / Avg. batch time: 525.6852 (ms) / GPU bubble ratio: 38.27%
[rank3]:2025-11-02 18:20:26,959 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1820_rank3_trend_line.svg
[rank2]:2025-11-02 18:20:27,008 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1820_rank2_trend_line.svg
[rank0]:2025-11-02 18:20:27,075 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1820_rank0_trend_line.svg
[rank0]:2025-11-02 18:20:27,105 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 18:20:27,114 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2339  memory: 56.44GiB(40.37%)  tps: 8,172  tflops: 381.14  mfu: 38.54%
[rank0]:2025-11-02 18:20:27,114 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 18:20:27,098 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule_adjustment/251102_1820_rank1_trend_line.svg
[rank1]:2025-11-02 18:20:27,105 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.54/0.54, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.84/0.84, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 18:20:27,114 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2339  memory: 49.74GiB(35.58%)  tps: 8,171  tflops: 381.11  mfu: 38.54%
[rank1]:2025-11-02 18:20:27,114 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 18:20:27,106 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.62/0.62, [MB2] 0.48/0.48, [MB3] 0.48/0.48, [MB4] 0.41/0.41, [MB5] 0.01/0.01, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 18:20:27,116 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2339  memory: 39.52GiB(28.27%)  tps: 8,171  tflops: 381.09  mfu: 38.53%
[rank2]:2025-11-02 18:20:27,116 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 18:20:27,285 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1820_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 403.95 ms, GPU Bubble Ratio: 30.95%, 24.37%, 27.65%, 27.38%
[rank3]:2025-11-02 18:20:27,285 - INFO - 	> Batch Time: 403.95 ms (Average Freeze Ratio: 0.49)
[rank3]:2025-11-02 18:20:27,286 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 0.89/0.89, [MB4] 0.88/0.88, [MB5] 0.85/0.85, [MB6] 0.59/0.59, [MB7] 1.00/1.00
[rank3]:2025-11-02 18:20:27,295 - INFO -  step: 1600  loss:  0.4998  grad_norm:  0.2339  memory: 47.84GiB(34.22%)  tps: 8,155  tflops: 380.36  mfu: 38.46%
[rank3]:2025-11-02 18:20:27,295 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 18:20:44,189 - INFO - validate step: 1600  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 23,988
[rank1]:2025-11-02 18:20:44,226 - INFO - validate step: 1600  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 23,937
[rank2]:2025-11-02 18:20:44,240 - INFO - validate step: 1600  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 23,921
[rank3]:2025-11-02 18:20:44,251 - INFO - validate step: 1600  loss:  0.2595  memory: 47.84GiB(34.22%)  tps: 24,159
[rank0]:2025-11-02 18:20:44,328 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1820_stage0_step1600.svg
[rank1]:2025-11-02 18:20:44,332 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1820_stage1_step1600.svg
[rank2]:2025-11-02 18:20:44,328 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1820_stage2_step1600.svg
[rank3]:2025-11-02 18:20:44,419 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1820_real_step1600_rank3.svg
[rank3]:> Batch Time: 461.94 ms, GPU Bubble Ratio: 44.38%, 26.93%, 33.73%, 32.83%
[rank3]:2025-11-02 18:20:44,489 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1820_stage3_step1600.svg
[rank0]:2025-11-02 18:22:30,475 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:22:32,538 - INFO - Avg. fwd time: 16.4287 / Avg. bwd time: 27.9334 / Avg. batch time: 377.1892 (ms) / GPU bubble ratio: 5.91%
[rank1]:2025-11-02 18:22:32,628 - INFO - Avg. fwd time: 16.5626 / Avg. bwd time: 28.2711 / Avg. batch time: 474.0216 (ms) / GPU bubble ratio: 24.33%
[rank2]:2025-11-02 18:22:32,581 - INFO - Avg. fwd time: 14.4434 / Avg. bwd time: 26.7689 / Avg. batch time: 423.7833 (ms) / GPU bubble ratio: 22.20%
[rank0]:2025-11-02 18:22:32,677 - INFO - Avg. fwd time: 14.0670 / Avg. bwd time: 26.8480 / Avg. batch time: 525.2909 (ms) / GPU bubble ratio: 37.69%
[rank0]:2025-11-02 18:22:32,719 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6361  memory: 56.44GiB(40.37%)  tps: 7,548  tflops: 352.05  mfu: 35.60%
[rank1]:2025-11-02 18:22:32,689 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6361  memory: 49.74GiB(35.58%)  tps: 7,553  tflops: 352.26  mfu: 35.62%
[rank2]:2025-11-02 18:22:32,705 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6361  memory: 39.52GiB(28.27%)  tps: 7,553  tflops: 352.26  mfu: 35.62%
[rank3]:2025-11-02 18:22:32,691 - INFO -  step: 1650  loss:  0.4686  grad_norm:  0.6361  memory: 47.84GiB(34.22%)  tps: 7,554  tflops: 352.34  mfu: 35.63%
[rank0]:2025-11-02 18:24:18,951 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:24:20,959 - INFO - Avg. fwd time: 14.4573 / Avg. bwd time: 26.6758 / Avg. batch time: 423.3088 (ms) / GPU bubble ratio: 22.26%
[rank3]:2025-11-02 18:24:20,922 - INFO - Avg. fwd time: 16.4515 / Avg. bwd time: 27.7513 / Avg. batch time: 376.6891 (ms) / GPU bubble ratio: 6.12%
[rank1]:2025-11-02 18:24:20,966 - INFO - Avg. fwd time: 16.5841 / Avg. bwd time: 28.1062 / Avg. batch time: 473.6264 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-11-02 18:24:21,021 - INFO - Avg. fwd time: 14.0574 / Avg. bwd time: 27.1728 / Avg. batch time: 525.0029 (ms) / GPU bubble ratio: 37.17%
[rank1]:2025-11-02 18:24:21,125 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.4560  memory: 49.74GiB(35.58%)  tps: 7,555  tflops: 352.35  mfu: 35.63%
[rank2]:2025-11-02 18:24:21,142 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.4560  memory: 39.52GiB(28.27%)  tps: 7,555  tflops: 352.35  mfu: 35.63%
[rank3]:2025-11-02 18:24:21,123 - INFO -  step: 1700  loss:  0.4516  grad_norm:  0.4560  memory: 47.84GiB(34.22%)  tps: 7,555  tflops: 352.37  mfu: 35.63%
[rank0]:2025-11-02 18:24:21,152 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.4560  memory: 56.44GiB(40.37%)  tps: 7,555  tflops: 352.36  mfu: 35.63%
[rank1]:2025-11-02 18:24:21,228 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1824_stage1_step1700.svg
[rank2]:2025-11-02 18:24:21,228 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1824_stage2_step1700.svg
[rank0]:2025-11-02 18:24:21,226 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1824_stage0_step1700.svg
[rank3]:2025-11-02 18:24:21,333 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1824_real_step1700_rank3.svg
[rank3]:> Batch Time: 511.12 ms, GPU Bubble Ratio: 17.14%, 38.47%, 40.43%, 39.30%
[rank3]:2025-11-02 18:24:21,403 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1824_stage3_step1700.svg
[rank0]:2025-11-02 18:26:07,614 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 18:26:09,632 - INFO - Avg. fwd time: 16.6070 / Avg. bwd time: 27.9235 / Avg. batch time: 473.2382 (ms) / GPU bubble ratio: 24.72%
[rank3]:2025-11-02 18:26:09,588 - INFO - Avg. fwd time: 16.4769 / Avg. bwd time: 27.5396 / Avg. batch time: 376.1694 (ms) / GPU bubble ratio: 6.39%
[rank2]:2025-11-02 18:26:09,627 - INFO - Avg. fwd time: 14.4728 / Avg. bwd time: 26.5691 / Avg. batch time: 422.8353 (ms) / GPU bubble ratio: 22.35%
[rank0]:2025-11-02 18:26:09,689 - INFO - Avg. fwd time: 14.0468 / Avg. bwd time: 27.5320 / Avg. batch time: 524.7353 (ms) / GPU bubble ratio: 36.61%
[rank1]:2025-11-02 18:26:09,792 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4251  memory: 49.74GiB(35.58%)  tps: 7,539  tflops: 351.60  mfu: 35.55%
[rank3]:2025-11-02 18:26:09,792 - INFO -  step: 1750  loss:  0.4474  grad_norm:  0.4251  memory: 47.84GiB(34.22%)  tps: 7,539  tflops: 351.60  mfu: 35.55%
[rank2]:2025-11-02 18:26:09,802 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4251  memory: 39.52GiB(28.27%)  tps: 7,539  tflops: 351.63  mfu: 35.55%
[rank0]:2025-11-02 18:26:09,818 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.4251  memory: 56.44GiB(40.37%)  tps: 7,539  tflops: 351.61  mfu: 35.55%
[rank0]:2025-11-02 18:27:53,755 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:27:55,735 - INFO - Avg. fwd time: 16.4904 / Avg. bwd time: 27.3290 / Avg. batch time: 375.5029 (ms) / GPU bubble ratio: 6.64%
[rank1]:2025-11-02 18:27:55,824 - INFO - Avg. fwd time: 16.6206 / Avg. bwd time: 27.7459 / Avg. batch time: 472.6549 (ms) / GPU bubble ratio: 24.91%
[rank2]:2025-11-02 18:27:55,778 - INFO - Avg. fwd time: 14.4808 / Avg. bwd time: 26.4607 / Avg. batch time: 422.1819 (ms) / GPU bubble ratio: 22.42%
[rank0]:2025-11-02 18:27:55,873 - INFO - Avg. fwd time: 14.0300 / Avg. bwd time: 27.8631 / Avg. batch time: 524.2574 (ms) / GPU bubble ratio: 36.07%
[rank1]:2025-11-02 18:27:55,887 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1149  memory: 49.74GiB(35.58%)  tps: 7,721  tflops: 360.12  mfu: 36.41%
[rank1]:2025-11-02 18:27:55,887 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 18:27:55,903 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1149  memory: 39.52GiB(28.27%)  tps: 7,721  tflops: 360.11  mfu: 36.41%
[rank3]:2025-11-02 18:27:55,894 - INFO -  step: 1800  loss:  0.0665  grad_norm:  0.1149  memory: 47.84GiB(34.22%)  tps: 7,721  tflops: 360.11  mfu: 36.41%
[rank2]:2025-11-02 18:27:55,903 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 18:27:55,894 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 18:27:55,915 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1149  memory: 56.44GiB(40.37%)  tps: 7,721  tflops: 360.12  mfu: 36.41%
[rank0]:2025-11-02 18:27:55,915 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 18:28:12,716 - INFO - validate step: 1800  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,381
[rank1]:2025-11-02 18:28:12,748 - INFO - validate step: 1800  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,293
[rank3]:2025-11-02 18:28:12,780 - INFO - validate step: 1800  loss:  0.2527  memory: 47.84GiB(34.22%)  tps: 24,259
[rank2]:2025-11-02 18:28:12,766 - INFO - validate step: 1800  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,291
[rank0]:2025-11-02 18:28:12,854 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1828_stage0_step1800.svg
[rank1]:2025-11-02 18:28:12,858 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1828_stage1_step1800.svg
[rank2]:2025-11-02 18:28:12,856 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1828_stage2_step1800.svg
[rank3]:2025-11-02 18:28:12,957 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1828_real_step1800_rank3.svg
[rank3]:> Batch Time: 499.63 ms, GPU Bubble Ratio: 16.71%, 38.72%, 40.11%, 40.29%
[rank3]:2025-11-02 18:28:13,025 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1828_stage3_step1800.svg
[rank0]:2025-11-02 18:29:56,640 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-02 18:29:58,601 - INFO - Avg. fwd time: 16.6311 / Avg. bwd time: 27.6068 / Avg. batch time: 472.1767 (ms) / GPU bubble ratio: 25.05%
[rank3]:2025-11-02 18:29:58,558 - INFO - Avg. fwd time: 16.5010 / Avg. bwd time: 27.1521 / Avg. batch time: 374.9382 (ms) / GPU bubble ratio: 6.86%
[rank2]:2025-11-02 18:29:58,594 - INFO - Avg. fwd time: 14.4863 / Avg. bwd time: 26.3792 / Avg. batch time: 421.6467 (ms) / GPU bubble ratio: 22.46%
[rank0]:2025-11-02 18:29:58,656 - INFO - Avg. fwd time: 14.0158 / Avg. bwd time: 28.1316 / Avg. batch time: 523.8630 (ms) / GPU bubble ratio: 35.64%
[rank0]:2025-11-02 18:29:58,785 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.3278  memory: 56.44GiB(40.37%)  tps: 7,723  tflops: 360.22  mfu: 36.42%
[rank1]:2025-11-02 18:29:58,758 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.3278  memory: 49.74GiB(35.58%)  tps: 7,728  tflops: 360.42  mfu: 36.44%
[rank3]:2025-11-02 18:29:58,757 - INFO -  step: 1850  loss:  0.3832  grad_norm:  0.3278  memory: 47.84GiB(34.22%)  tps: 7,730  tflops: 360.53  mfu: 36.45%
[rank2]:2025-11-02 18:29:58,774 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.3278  memory: 39.52GiB(28.27%)  tps: 7,728  tflops: 360.42  mfu: 36.44%
[rank0]:2025-11-02 18:31:42,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:31:44,113 - INFO - Avg. fwd time: 14.4909 / Avg. bwd time: 26.2814 / Avg. batch time: 421.0529 (ms) / GPU bubble ratio: 22.53%
[rank3]:2025-11-02 18:31:44,076 - INFO - Avg. fwd time: 16.5086 / Avg. bwd time: 26.9742 / Avg. batch time: 374.3373 (ms) / GPU bubble ratio: 7.07%
[rank0]:2025-11-02 18:31:44,175 - INFO - Avg. fwd time: 13.9980 / Avg. bwd time: 28.4270 / Avg. batch time: 523.4156 (ms) / GPU bubble ratio: 35.16%
[rank1]:2025-11-02 18:31:44,119 - INFO - Avg. fwd time: 16.6404 / Avg. bwd time: 27.4491 / Avg. batch time: 471.6408 (ms) / GPU bubble ratio: 25.22%
[rank0]:2025-11-02 18:31:44,301 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1425  memory: 56.44GiB(40.37%)  tps: 7,764  tflops: 362.10  mfu: 36.61%
[rank1]:2025-11-02 18:31:44,276 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1425  memory: 49.74GiB(35.58%)  tps: 7,764  tflops: 362.10  mfu: 36.61%
[rank2]:2025-11-02 18:31:44,287 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1425  memory: 39.52GiB(28.27%)  tps: 7,764  tflops: 362.11  mfu: 36.61%
[rank3]:2025-11-02 18:31:44,281 - INFO -  step: 1900  loss:  0.2000  grad_norm:  0.1425  memory: 47.84GiB(34.22%)  tps: 7,763  tflops: 362.08  mfu: 36.61%
[rank0]:2025-11-02 18:31:44,372 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1831_stage0_step1900.svg
[rank1]:2025-11-02 18:31:44,376 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1831_stage1_step1900.svg
[rank2]:2025-11-02 18:31:44,376 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1831_stage2_step1900.svg
[rank3]:2025-11-02 18:31:44,478 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1831_real_step1900_rank3.svg
[rank3]:> Batch Time: 500.73 ms, GPU Bubble Ratio: 16.55%, 37.85%, 40.71%, 40.39%
[rank3]:2025-11-02 18:31:44,547 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1831_stage3_step1900.svg
[rank0]:2025-11-02 18:33:27,521 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:33:29,515 - INFO - Avg. fwd time: 16.5149 / Avg. bwd time: 26.7976 / Avg. batch time: 373.7426 (ms) / GPU bubble ratio: 7.29%
[rank2]:2025-11-02 18:33:29,559 - INFO - Avg. fwd time: 14.4943 / Avg. bwd time: 26.1901 / Avg. batch time: 420.4828 (ms) / GPU bubble ratio: 22.59%
[rank0]:2025-11-02 18:33:29,654 - INFO - Avg. fwd time: 13.9804 / Avg. bwd time: 28.7058 / Avg. batch time: 522.9852 (ms) / GPU bubble ratio: 34.70%
[rank1]:2025-11-02 18:33:29,605 - INFO - Avg. fwd time: 16.6485 / Avg. bwd time: 27.2993 / Avg. batch time: 471.1256 (ms) / GPU bubble ratio: 25.37%
[rank1]:2025-11-02 18:33:29,669 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1052  memory: 49.74GiB(35.58%)  tps: 7,773  tflops: 362.53  mfu: 36.66%
[rank3]:2025-11-02 18:33:29,670 - INFO -  step: 1950  loss:  0.1650  grad_norm:  0.1052  memory: 47.84GiB(34.22%)  tps: 7,773  tflops: 362.54  mfu: 36.66%
[rank2]:2025-11-02 18:33:29,683 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1052  memory: 39.52GiB(28.27%)  tps: 7,773  tflops: 362.52  mfu: 36.65%
[rank0]:2025-11-02 18:33:29,696 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1052  memory: 56.44GiB(40.37%)  tps: 7,773  tflops: 362.52  mfu: 36.66%
[rank0]:2025-11-02 18:35:12,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 18:35:14,587 - INFO - Avg. fwd time: 14.4970 / Avg. bwd time: 26.1182 / Avg. batch time: 419.9960 (ms) / GPU bubble ratio: 22.64%
[rank3]:2025-11-02 18:35:14,550 - INFO - Avg. fwd time: 16.5195 / Avg. bwd time: 26.6570 / Avg. batch time: 373.2508 (ms) / GPU bubble ratio: 7.46%
[rank0]:2025-11-02 18:35:14,647 - INFO - Avg. fwd time: 13.9660 / Avg. bwd time: 28.9329 / Avg. batch time: 522.6090 (ms) / GPU bubble ratio: 34.33%
[rank1]:2025-11-02 18:35:14,593 - INFO - Avg. fwd time: 16.6552 / Avg. bwd time: 27.1769 / Avg. batch time: 470.6822 (ms) / GPU bubble ratio: 25.50%
[rank0]:2025-11-02 18:35:14,774 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1057  memory: 56.44GiB(40.37%)  tps: 7,796  tflops: 363.61  mfu: 36.77%
[rank0]:2025-11-02 18:35:14,774 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 18:35:14,745 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1057  memory: 49.74GiB(35.58%)  tps: 7,796  tflops: 363.62  mfu: 36.77%
[rank1]:2025-11-02 18:35:14,745 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 18:35:14,759 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1057  memory: 39.52GiB(28.27%)  tps: 7,796  tflops: 363.62  mfu: 36.77%
[rank2]:2025-11-02 18:35:14,759 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 18:35:14,749 - INFO -  step: 2000  loss:  0.2022  grad_norm:  0.1057  memory: 47.84GiB(34.22%)  tps: 7,796  tflops: 363.62  mfu: 36.77%
[rank3]:2025-11-02 18:35:14,749 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 18:35:31,447 - INFO - validate step: 2000  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,566
[rank1]:2025-11-02 18:35:31,480 - INFO - validate step: 2000  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,476
[rank2]:2025-11-02 18:35:31,498 - INFO - validate step: 2000  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,471
[rank0]:2025-11-02 18:35:31,588 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1835_stage0_step2000.svg
[rank1]:2025-11-02 18:35:31,592 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1835_stage1_step2000.svg
[rank3]:2025-11-02 18:35:31,511 - INFO - validate step: 2000  loss:  0.2433  memory: 47.84GiB(34.22%)  tps: 24,437
[rank2]:2025-11-02 18:35:31,590 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1835_stage2_step2000.svg
[rank3]:2025-11-02 18:35:31,692 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1835_real_step2000_rank3.svg
[rank3]:> Batch Time: 500.81 ms, GPU Bubble Ratio: 16.59%, 37.95%, 39.89%, 40.24%
[rank3]:2025-11-02 18:35:31,763 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1835_stage3_step2000.svg
[rank0]:2025-11-02 18:37:14,847 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:37:16,763 - INFO - Avg. fwd time: 16.5240 / Avg. bwd time: 26.5021 / Avg. batch time: 372.7146 (ms) / GPU bubble ratio: 7.65%
[rank0]:2025-11-02 18:37:16,863 - INFO - Avg. fwd time: 13.9504 / Avg. bwd time: 29.1854 / Avg. batch time: 522.2205 (ms) / GPU bubble ratio: 33.92%
[rank1]:2025-11-02 18:37:16,807 - INFO - Avg. fwd time: 16.6635 / Avg. bwd time: 27.0399 / Avg. batch time: 470.2180 (ms) / GPU bubble ratio: 25.65%
[rank2]:2025-11-02 18:37:16,802 - INFO - Avg. fwd time: 14.5004 / Avg. bwd time: 26.0382 / Avg. batch time: 419.4826 (ms) / GPU bubble ratio: 22.69%
[rank3]:2025-11-02 18:37:16,972 - INFO -  step: 2050  loss:  0.2217  grad_norm:  0.1559  memory: 47.84GiB(34.22%)  tps: 7,768  tflops: 362.30  mfu: 36.63%
[rank1]:2025-11-02 18:37:16,962 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1559  memory: 49.74GiB(35.58%)  tps: 7,766  tflops: 362.22  mfu: 36.62%
[rank2]:2025-11-02 18:37:16,973 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1559  memory: 39.52GiB(28.27%)  tps: 7,767  tflops: 362.24  mfu: 36.63%
[rank0]:2025-11-02 18:37:16,990 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1559  memory: 56.44GiB(40.37%)  tps: 7,762  tflops: 362.01  mfu: 36.60%
[rank0]:2025-11-02 18:39:00,117 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:39:02,116 - INFO - Avg. fwd time: 16.5275 / Avg. bwd time: 26.3618 / Avg. batch time: 372.2274 (ms) / GPU bubble ratio: 7.82%
[rank2]:2025-11-02 18:39:02,160 - INFO - Avg. fwd time: 14.5029 / Avg. bwd time: 25.9620 / Avg. batch time: 419.0018 (ms) / GPU bubble ratio: 22.74%
[rank0]:2025-11-02 18:39:02,259 - INFO - Avg. fwd time: 13.9351 / Avg. bwd time: 29.4238 / Avg. batch time: 521.8556 (ms) / GPU bubble ratio: 33.53%
[rank1]:2025-11-02 18:39:02,209 - INFO - Avg. fwd time: 16.6703 / Avg. bwd time: 26.9115 / Avg. batch time: 469.7841 (ms) / GPU bubble ratio: 25.78%
[rank1]:2025-11-02 18:39:02,274 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1410  memory: 49.74GiB(35.58%)  tps: 7,779  tflops: 362.81  mfu: 36.68%
[rank3]:2025-11-02 18:39:02,283 - INFO -  step: 2100  loss:  0.2266  grad_norm:  0.1410  memory: 47.84GiB(34.22%)  tps: 7,779  tflops: 362.81  mfu: 36.68%
[rank0]:2025-11-02 18:39:02,301 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1410  memory: 56.44GiB(40.37%)  tps: 7,779  tflops: 362.81  mfu: 36.68%
[rank0]:2025-11-02 18:39:02,369 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1839_stage0_step2100.svg
[rank2]:2025-11-02 18:39:02,289 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1410  memory: 39.52GiB(28.27%)  tps: 7,779  tflops: 362.79  mfu: 36.68%
[rank2]:2025-11-02 18:39:02,370 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1839_stage2_step2100.svg
[rank1]:2025-11-02 18:39:02,373 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1839_stage1_step2100.svg
[rank3]:2025-11-02 18:39:02,481 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1839_real_step2100_rank3.svg
[rank3]:> Batch Time: 501.33 ms, GPU Bubble Ratio: 16.75%, 38.24%, 40.60%, 39.01%
[rank3]:2025-11-02 18:39:02,544 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1839_stage3_step2100.svg
[rank0]:2025-11-02 18:40:45,452 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:40:47,355 - INFO - Avg. fwd time: 16.5303 / Avg. bwd time: 26.2434 / Avg. batch time: 371.8109 (ms) / GPU bubble ratio: 7.97%
[rank2]:2025-11-02 18:40:47,391 - INFO - Avg. fwd time: 14.5045 / Avg. bwd time: 25.8968 / Avg. batch time: 418.6041 (ms) / GPU bubble ratio: 22.79%
[rank0]:2025-11-02 18:40:47,454 - INFO - Avg. fwd time: 13.9216 / Avg. bwd time: 29.6173 / Avg. batch time: 521.5478 (ms) / GPU bubble ratio: 33.22%
[rank1]:2025-11-02 18:40:47,397 - INFO - Avg. fwd time: 16.6749 / Avg. bwd time: 26.8028 / Avg. batch time: 469.4218 (ms) / GPU bubble ratio: 25.90%
[rank1]:2025-11-02 18:40:47,553 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1291  memory: 49.74GiB(35.58%)  tps: 7,781  tflops: 362.92  mfu: 36.70%
[rank3]:2025-11-02 18:40:47,560 - INFO -  step: 2150  loss:  0.1854  grad_norm:  0.1291  memory: 47.84GiB(34.22%)  tps: 7,781  tflops: 362.93  mfu: 36.70%
[rank2]:2025-11-02 18:40:47,567 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1291  memory: 39.52GiB(28.27%)  tps: 7,781  tflops: 362.92  mfu: 36.70%
[rank0]:2025-11-02 18:40:47,578 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1291  memory: 56.44GiB(40.37%)  tps: 7,781  tflops: 362.93  mfu: 36.70%
[rank0]:2025-11-02 18:42:30,573 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:42:32,472 - INFO - Avg. fwd time: 16.5314 / Avg. bwd time: 26.1333 / Avg. batch time: 371.3468 (ms) / GPU bubble ratio: 8.09%
[rank2]:2025-11-02 18:42:32,509 - INFO - Avg. fwd time: 14.5058 / Avg. bwd time: 25.8252 / Avg. batch time: 418.1429 (ms) / GPU bubble ratio: 22.84%
[rank1]:2025-11-02 18:42:32,514 - INFO - Avg. fwd time: 16.6798 / Avg. bwd time: 26.6825 / Avg. batch time: 469.0009 (ms) / GPU bubble ratio: 26.03%
[rank0]:2025-11-02 18:42:32,570 - INFO - Avg. fwd time: 13.9071 / Avg. bwd time: 29.8342 / Avg. batch time: 521.1889 (ms) / GPU bubble ratio: 32.86%
[rank3]:2025-11-02 18:42:32,675 - INFO -  step: 2200  loss:  0.1794  grad_norm:  0.1070  memory: 47.84GiB(34.22%)  tps: 7,794  tflops: 363.49  mfu: 36.75%
[rank3]:2025-11-02 18:42:32,675 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 18:42:32,682 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1070  memory: 39.52GiB(28.27%)  tps: 7,793  tflops: 363.48  mfu: 36.75%
[rank2]:2025-11-02 18:42:32,682 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 18:42:32,694 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1070  memory: 56.44GiB(40.37%)  tps: 7,793  tflops: 363.48  mfu: 36.75%
[rank0]:2025-11-02 18:42:32,695 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 18:42:32,666 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1070  memory: 49.74GiB(35.58%)  tps: 7,794  tflops: 363.49  mfu: 36.75%
[rank1]:2025-11-02 18:42:32,666 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 18:42:49,355 - INFO - validate step: 2200  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,585
[rank3]:2025-11-02 18:42:49,423 - INFO - validate step: 2200  loss:  0.2420  memory: 47.84GiB(34.22%)  tps: 24,458
[rank2]:2025-11-02 18:42:49,406 - INFO - validate step: 2200  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,493
[rank1]:2025-11-02 18:42:49,388 - INFO - validate step: 2200  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,496
[rank2]:2025-11-02 18:42:49,496 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1842_stage2_step2200.svg
[rank0]:2025-11-02 18:42:49,492 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1842_stage0_step2200.svg
[rank1]:2025-11-02 18:42:49,497 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1842_stage1_step2200.svg
[rank3]:2025-11-02 18:42:49,605 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1842_real_step2200_rank3.svg
[rank3]:> Batch Time: 500.45 ms, GPU Bubble Ratio: 16.46%, 38.52%, 40.18%, 38.66%
[rank3]:2025-11-02 18:42:49,669 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1842_stage3_step2200.svg
[rank0]:2025-11-02 18:44:32,746 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:44:34,743 - INFO - Avg. fwd time: 16.5324 / Avg. bwd time: 26.0274 / Avg. batch time: 370.9166 (ms) / GPU bubble ratio: 8.21%
[rank2]:2025-11-02 18:44:34,789 - INFO - Avg. fwd time: 14.5079 / Avg. bwd time: 25.7544 / Avg. batch time: 417.7313 (ms) / GPU bubble ratio: 22.89%
[rank1]:2025-11-02 18:44:34,839 - INFO - Avg. fwd time: 16.6850 / Avg. bwd time: 26.5649 / Avg. batch time: 468.6289 (ms) / GPU bubble ratio: 26.17%
[rank3]:2025-11-02 18:44:34,912 - INFO -  step: 2250  loss:  0.2241  grad_norm:  0.1578  memory: 47.84GiB(34.22%)  tps: 7,766  tflops: 362.20  mfu: 36.62%
[rank2]:2025-11-02 18:44:34,919 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1578  memory: 39.52GiB(28.27%)  tps: 7,764  tflops: 362.11  mfu: 36.61%
[rank0]:2025-11-02 18:44:34,890 - INFO - Avg. fwd time: 13.8933 / Avg. bwd time: 30.0412 / Avg. batch time: 520.8775 (ms) / GPU bubble ratio: 32.52%
[rank0]:2025-11-02 18:44:34,932 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1578  memory: 56.44GiB(40.37%)  tps: 7,759  tflops: 361.90  mfu: 36.59%
[rank1]:2025-11-02 18:44:34,905 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.1578  memory: 49.74GiB(35.58%)  tps: 7,764  tflops: 362.10  mfu: 36.61%
[rank0]:2025-11-02 18:46:18,217 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:46:20,127 - INFO - Avg. fwd time: 16.5341 / Avg. bwd time: 25.9360 / Avg. batch time: 370.5878 (ms) / GPU bubble ratio: 8.32%
[rank2]:2025-11-02 18:46:20,163 - INFO - Avg. fwd time: 14.5096 / Avg. bwd time: 25.6976 / Avg. batch time: 417.4037 (ms) / GPU bubble ratio: 22.94%
[rank0]:2025-11-02 18:46:20,223 - INFO - Avg. fwd time: 13.8822 / Avg. bwd time: 30.2113 / Avg. batch time: 520.6313 (ms) / GPU bubble ratio: 32.25%
[rank1]:2025-11-02 18:46:20,168 - INFO - Avg. fwd time: 16.6891 / Avg. bwd time: 26.4725 / Avg. batch time: 468.3335 (ms) / GPU bubble ratio: 26.27%
[rank1]:2025-11-02 18:46:20,322 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1405  memory: 49.74GiB(35.58%)  tps: 7,771  tflops: 362.44  mfu: 36.65%
[rank3]:2025-11-02 18:46:20,329 - INFO -  step: 2300  loss:  0.1962  grad_norm:  0.1405  memory: 47.84GiB(34.22%)  tps: 7,771  tflops: 362.45  mfu: 36.65%
[rank2]:2025-11-02 18:46:20,333 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1405  memory: 39.52GiB(28.27%)  tps: 7,771  tflops: 362.46  mfu: 36.65%
[rank2]:2025-11-02 18:46:20,420 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1846_stage2_step2300.svg
[rank0]:2025-11-02 18:46:20,349 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1405  memory: 56.44GiB(40.37%)  tps: 7,771  tflops: 362.44  mfu: 36.65%
[rank0]:2025-11-02 18:46:20,416 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1846_stage0_step2300.svg
[rank1]:2025-11-02 18:46:20,420 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1846_stage1_step2300.svg
[rank3]:2025-11-02 18:46:20,531 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1846_real_step2300_rank3.svg
[rank3]:> Batch Time: 502.38 ms, GPU Bubble Ratio: 16.86%, 38.37%, 40.40%, 38.96%
[rank3]:2025-11-02 18:46:20,595 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1846_stage3_step2300.svg
[rank0]:2025-11-02 18:48:03,894 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:48:05,806 - INFO - Avg. fwd time: 16.5350 / Avg. bwd time: 25.8464 / Avg. batch time: 370.2202 (ms) / GPU bubble ratio: 8.42%
[rank2]:2025-11-02 18:48:05,840 - INFO - Avg. fwd time: 14.5113 / Avg. bwd time: 25.6368 / Avg. batch time: 417.0501 (ms) / GPU bubble ratio: 22.99%
[rank1]:2025-11-02 18:48:05,847 - INFO - Avg. fwd time: 16.6942 / Avg. bwd time: 26.3666 / Avg. batch time: 468.0154 (ms) / GPU bubble ratio: 26.39%
[rank0]:2025-11-02 18:48:05,900 - INFO - Avg. fwd time: 13.8695 / Avg. bwd time: 30.4010 / Avg. batch time: 520.3672 (ms) / GPU bubble ratio: 31.94%
[rank3]:2025-11-02 18:48:06,007 - INFO -  step: 2350  loss:  0.1826  grad_norm:  0.1187  memory: 47.84GiB(34.22%)  tps: 7,752  tflops: 361.55  mfu: 36.56%
[rank1]:2025-11-02 18:48:06,000 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1187  memory: 49.74GiB(35.58%)  tps: 7,752  tflops: 361.55  mfu: 36.56%
[rank0]:2025-11-02 18:48:06,026 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1187  memory: 56.44GiB(40.37%)  tps: 7,752  tflops: 361.55  mfu: 36.56%
[rank2]:2025-11-02 18:48:06,014 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1187  memory: 39.52GiB(28.27%)  tps: 7,752  tflops: 361.54  mfu: 36.56%
[rank0]:2025-11-02 18:49:49,055 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:49:51,074 - INFO - Avg. fwd time: 16.5364 / Avg. bwd time: 25.7499 / Avg. batch time: 369.8363 (ms) / GPU bubble ratio: 8.53%
[rank2]:2025-11-02 18:49:51,121 - INFO - Avg. fwd time: 14.5132 / Avg. bwd time: 25.5788 / Avg. batch time: 416.6702 (ms) / GPU bubble ratio: 23.02%
[rank1]:2025-11-02 18:49:51,168 - INFO - Avg. fwd time: 16.6992 / Avg. bwd time: 26.2662 / Avg. batch time: 467.6711 (ms) / GPU bubble ratio: 26.50%
[rank0]:2025-11-02 18:49:51,219 - INFO - Avg. fwd time: 13.8578 / Avg. bwd time: 30.5830 / Avg. batch time: 520.0769 (ms) / GPU bubble ratio: 31.64%
[rank2]:2025-11-02 18:49:51,244 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1179  memory: 39.52GiB(28.27%)  tps: 7,785  tflops: 363.09  mfu: 36.71%
[rank2]:2025-11-02 18:49:51,244 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 18:49:51,242 - INFO -  step: 2400  loss:  0.1891  grad_norm:  0.1179  memory: 47.84GiB(34.22%)  tps: 7,785  tflops: 363.07  mfu: 36.71%
[rank3]:2025-11-02 18:49:51,242 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 18:49:51,235 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1179  memory: 49.74GiB(35.58%)  tps: 7,785  tflops: 363.07  mfu: 36.71%
[rank1]:2025-11-02 18:49:51,235 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 18:49:51,260 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1179  memory: 56.44GiB(40.37%)  tps: 7,785  tflops: 363.07  mfu: 36.71%
[rank0]:2025-11-02 18:49:51,260 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 18:50:07,929 - INFO - validate step: 2400  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,573
[rank0]:2025-11-02 18:50:07,930 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 18:50:07,980 - INFO - validate step: 2400  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,474
[rank2]:2025-11-02 18:50:07,981 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 18:50:07,993 - INFO - validate step: 2400  loss:  0.2404  memory: 47.84GiB(34.22%)  tps: 24,453
[rank3]:2025-11-02 18:50:07,994 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 18:50:07,963 - INFO - validate step: 2400  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,486
[rank1]:2025-11-02 18:50:07,964 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 18:50:07,937 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 18:50:22,298 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.33 seconds.
[rank2]:2025-11-02 18:50:23,998 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.02 seconds.
[rank3]:2025-11-02 18:50:26,208 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.21 seconds.
[rank0]:2025-11-02 18:50:27,653 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 18:50:27,742 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1850_stage1_step2400.svg
[rank0]:2025-11-02 18:50:27,657 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.73 seconds.
[rank2]:2025-11-02 18:50:27,740 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1850_stage2_step2400.svg
[rank0]:2025-11-02 18:50:27,842 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1850_stage0_step2400.svg
[rank3]:2025-11-02 18:50:28,001 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1850_real_step2400_rank3.svg
[rank3]:> Batch Time: 502.20 ms, GPU Bubble Ratio: 16.89%, 38.36%, 40.25%, 39.13%
[rank3]:2025-11-02 18:50:28,074 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1850_stage3_step2400.svg
[rank0]:2025-11-02 18:52:13,692 - INFO - [GC] Peforming periodical GC collection 2.65 seconds
[rank3]:2025-11-02 18:52:15,593 - INFO - Avg. fwd time: 16.5372 / Avg. bwd time: 25.6716 / Avg. batch time: 369.5137 (ms) / GPU bubble ratio: 8.62%
[rank2]:2025-11-02 18:52:15,628 - INFO - Avg. fwd time: 14.5147 / Avg. bwd time: 25.5246 / Avg. batch time: 416.3598 (ms) / GPU bubble ratio: 23.07%
[rank1]:2025-11-02 18:52:15,635 - INFO - Avg. fwd time: 16.7031 / Avg. bwd time: 26.1830 / Avg. batch time: 467.3874 (ms) / GPU bubble ratio: 26.59%
[rank0]:2025-11-02 18:52:15,691 - INFO - Avg. fwd time: 13.8475 / Avg. bwd time: 30.7310 / Avg. batch time: 519.8376 (ms) / GPU bubble ratio: 31.40%
[rank2]:2025-11-02 18:52:15,797 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1564  memory: 39.52GiB(28.27%)  tps: 6,409  tflops: 298.92  mfu: 30.22%
[rank3]:2025-11-02 18:52:15,794 - INFO -  step: 2450  loss:  0.2313  grad_norm:  0.1564  memory: 47.84GiB(34.22%)  tps: 6,410  tflops: 298.97  mfu: 30.23%
[rank1]:2025-11-02 18:52:15,786 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1564  memory: 49.74GiB(35.58%)  tps: 6,409  tflops: 298.91  mfu: 30.22%
[rank0]:2025-11-02 18:52:15,813 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.1564  memory: 56.44GiB(40.37%)  tps: 6,406  tflops: 298.77  mfu: 30.21%
[rank0]:2025-11-02 18:53:58,920 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:54:00,832 - INFO - Avg. fwd time: 16.5385 / Avg. bwd time: 25.5838 / Avg. batch time: 369.1693 (ms) / GPU bubble ratio: 8.72%
[rank2]:2025-11-02 18:54:00,868 - INFO - Avg. fwd time: 14.5163 / Avg. bwd time: 25.4706 / Avg. batch time: 416.0153 (ms) / GPU bubble ratio: 23.10%
[rank1]:2025-11-02 18:54:00,873 - INFO - Avg. fwd time: 16.7078 / Avg. bwd time: 26.0919 / Avg. batch time: 467.0744 (ms) / GPU bubble ratio: 26.69%
[rank0]:2025-11-02 18:54:00,930 - INFO - Avg. fwd time: 13.8365 / Avg. bwd time: 30.8983 / Avg. batch time: 519.5731 (ms) / GPU bubble ratio: 31.12%
[rank3]:2025-11-02 18:54:01,033 - INFO -  step: 2500  loss:  0.2134  grad_norm:  0.1392  memory: 47.84GiB(34.22%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank2]:2025-11-02 18:54:01,038 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1392  memory: 39.52GiB(28.27%)  tps: 7,784  tflops: 363.05  mfu: 36.71%
[rank1]:2025-11-02 18:54:01,025 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1392  memory: 49.74GiB(35.58%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank0]:2025-11-02 18:54:01,052 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1392  memory: 56.44GiB(40.37%)  tps: 7,784  tflops: 363.06  mfu: 36.71%
[rank0]:2025-11-02 18:54:01,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1854_stage0_step2500.svg
[rank2]:2025-11-02 18:54:01,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1854_stage2_step2500.svg
[rank1]:2025-11-02 18:54:01,125 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1854_stage1_step2500.svg
[rank3]:2025-11-02 18:54:01,233 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1854_real_step2500_rank3.svg
[rank3]:> Batch Time: 501.73 ms, GPU Bubble Ratio: 16.80%, 38.23%, 40.17%, 40.21%
[rank3]:2025-11-02 18:54:01,300 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1854_stage3_step2500.svg
[rank0]:2025-11-02 18:55:45,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:55:47,861 - INFO - Avg. fwd time: 16.5441 / Avg. bwd time: 25.5063 / Avg. batch time: 368.8933 (ms) / GPU bubble ratio: 8.81%
[rank2]:2025-11-02 18:55:47,908 - INFO - Avg. fwd time: 14.5212 / Avg. bwd time: 25.4143 / Avg. batch time: 415.7574 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-11-02 18:55:47,958 - INFO - Avg. fwd time: 16.7159 / Avg. bwd time: 26.0047 / Avg. batch time: 466.8532 (ms) / GPU bubble ratio: 26.79%
[rank0]:2025-11-02 18:55:48,011 - INFO - Avg. fwd time: 13.8285 / Avg. bwd time: 31.0619 / Avg. batch time: 519.4034 (ms) / GPU bubble ratio: 30.86%
[rank3]:2025-11-02 18:55:48,035 - INFO -  step: 2550  loss:  0.4657  grad_norm:  0.3251  memory: 47.84GiB(34.22%)  tps: 7,656  tflops: 357.08  mfu: 36.11%
[rank2]:2025-11-02 18:55:48,043 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3251  memory: 39.52GiB(28.27%)  tps: 7,656  tflops: 357.07  mfu: 36.10%
[rank1]:2025-11-02 18:55:48,026 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3251  memory: 49.74GiB(35.58%)  tps: 7,656  tflops: 357.08  mfu: 36.10%
[rank0]:2025-11-02 18:55:48,053 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3251  memory: 56.44GiB(40.37%)  tps: 7,656  tflops: 357.08  mfu: 36.10%
[rank0]:2025-11-02 18:57:32,811 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 18:57:34,747 - INFO - Avg. fwd time: 16.5499 / Avg. bwd time: 25.4471 / Avg. batch time: 368.6778 (ms) / GPU bubble ratio: 8.87%
[rank2]:2025-11-02 18:57:34,786 - INFO - Avg. fwd time: 14.5258 / Avg. bwd time: 25.3727 / Avg. batch time: 415.5451 (ms) / GPU bubble ratio: 23.19%
[rank1]:2025-11-02 18:57:34,790 - INFO - Avg. fwd time: 16.7238 / Avg. bwd time: 25.9327 / Avg. batch time: 466.6717 (ms) / GPU bubble ratio: 26.88%
[rank0]:2025-11-02 18:57:34,846 - INFO - Avg. fwd time: 13.8229 / Avg. bwd time: 31.1977 / Avg. batch time: 519.2646 (ms) / GPU bubble ratio: 30.64%
[rank2]:2025-11-02 18:57:34,958 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2169  memory: 39.52GiB(28.27%)  tps: 7,662  tflops: 357.36  mfu: 36.13%
[rank2]:2025-11-02 18:57:34,958 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-02 18:57:34,952 - INFO -  step: 2600  loss:  0.3927  grad_norm:  0.2169  memory: 47.84GiB(34.22%)  tps: 7,662  tflops: 357.36  mfu: 36.13%
[rank3]:2025-11-02 18:57:34,952 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 18:57:34,944 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2169  memory: 49.74GiB(35.58%)  tps: 7,662  tflops: 357.36  mfu: 36.13%
[rank1]:2025-11-02 18:57:34,944 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 18:57:34,970 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2169  memory: 56.44GiB(40.37%)  tps: 7,662  tflops: 357.36  mfu: 36.13%
[rank0]:2025-11-02 18:57:34,970 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 18:57:51,605 - INFO - validate step: 2600  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,623
[rank2]:2025-11-02 18:57:51,656 - INFO - validate step: 2600  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,531
[rank3]:2025-11-02 18:57:51,672 - INFO - validate step: 2600  loss:  0.2438  memory: 47.84GiB(34.22%)  tps: 24,499
[rank1]:2025-11-02 18:57:51,638 - INFO - validate step: 2600  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,536
[rank2]:2025-11-02 18:57:51,744 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1857_stage2_step2600.svg
[rank1]:2025-11-02 18:57:51,746 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1857_stage1_step2600.svg
[rank0]:2025-11-02 18:57:51,747 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1857_stage0_step2600.svg
[rank3]:2025-11-02 18:57:51,851 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1857_real_step2600_rank3.svg
[rank3]:> Batch Time: 506.28 ms, GPU Bubble Ratio: 16.92%, 38.15%, 40.06%, 37.82%
[rank3]:2025-11-02 18:57:51,916 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1857_stage3_step2600.svg
[rank0]:2025-11-02 18:59:36,693 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 18:59:38,625 - INFO - Avg. fwd time: 16.5563 / Avg. bwd time: 25.3822 / Avg. batch time: 368.4328 (ms) / GPU bubble ratio: 8.94%
[rank1]:2025-11-02 18:59:38,670 - INFO - Avg. fwd time: 16.7327 / Avg. bwd time: 25.8517 / Avg. batch time: 466.4775 (ms) / GPU bubble ratio: 26.97%
[rank2]:2025-11-02 18:59:38,664 - INFO - Avg. fwd time: 14.5310 / Avg. bwd time: 25.3272 / Avg. batch time: 415.3166 (ms) / GPU bubble ratio: 23.22%
[rank0]:2025-11-02 18:59:38,726 - INFO - Avg. fwd time: 13.8165 / Avg. bwd time: 31.3498 / Avg. batch time: 519.1173 (ms) / GPU bubble ratio: 30.40%
[rank2]:2025-11-02 18:59:38,835 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1793  memory: 39.52GiB(28.27%)  tps: 7,643  tflops: 356.49  mfu: 36.05%
[rank3]:2025-11-02 18:59:38,831 - INFO -  step: 2650  loss:  0.3150  grad_norm:  0.1793  memory: 47.84GiB(34.22%)  tps: 7,645  tflops: 356.55  mfu: 36.05%
[rank1]:2025-11-02 18:59:38,825 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1793  memory: 49.74GiB(35.58%)  tps: 7,643  tflops: 356.46  mfu: 36.04%
[rank0]:2025-11-02 18:59:38,851 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1793  memory: 56.44GiB(40.37%)  tps: 7,639  tflops: 356.27  mfu: 36.02%
[rank0]:2025-11-02 19:01:23,773 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:01:25,811 - INFO - Avg. fwd time: 16.5625 / Avg. bwd time: 25.3189 / Avg. batch time: 368.2041 (ms) / GPU bubble ratio: 9.00%
[rank2]:2025-11-02 19:01:25,859 - INFO - Avg. fwd time: 14.5359 / Avg. bwd time: 25.2829 / Avg. batch time: 415.0955 (ms) / GPU bubble ratio: 23.26%
[rank1]:2025-11-02 19:01:25,908 - INFO - Avg. fwd time: 16.7409 / Avg. bwd time: 25.7757 / Avg. batch time: 466.2917 (ms) / GPU bubble ratio: 27.06%
[rank0]:2025-11-02 19:01:25,961 - INFO - Avg. fwd time: 13.8105 / Avg. bwd time: 31.4964 / Avg. batch time: 518.9797 (ms) / GPU bubble ratio: 30.16%
[rank2]:2025-11-02 19:01:25,991 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2361  memory: 39.52GiB(28.27%)  tps: 7,645  tflops: 356.56  mfu: 36.05%
[rank3]:2025-11-02 19:01:25,984 - INFO -  step: 2700  loss:  0.3467  grad_norm:  0.2361  memory: 47.84GiB(34.22%)  tps: 7,645  tflops: 356.58  mfu: 36.05%
[rank1]:2025-11-02 19:01:25,975 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2361  memory: 49.74GiB(35.58%)  tps: 7,645  tflops: 356.58  mfu: 36.05%
[rank0]:2025-11-02 19:01:26,002 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.2361  memory: 56.44GiB(40.37%)  tps: 7,645  tflops: 356.58  mfu: 36.05%
[rank0]:2025-11-02 19:01:26,072 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1901_stage0_step2700.svg
[rank2]:2025-11-02 19:01:26,074 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1901_stage2_step2700.svg
[rank1]:2025-11-02 19:01:26,073 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1901_stage1_step2700.svg
[rank3]:2025-11-02 19:01:26,181 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1901_real_step2700_rank3.svg
[rank3]:> Batch Time: 505.25 ms, GPU Bubble Ratio: 16.88%, 38.04%, 39.64%, 38.51%
[rank3]:2025-11-02 19:01:26,247 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1901_stage3_step2700.svg
[rank0]:2025-11-02 19:03:11,038 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:03:12,991 - INFO - Avg. fwd time: 16.5682 / Avg. bwd time: 25.2584 / Avg. batch time: 368.0137 (ms) / GPU bubble ratio: 9.08%
[rank1]:2025-11-02 19:03:13,033 - INFO - Avg. fwd time: 16.7480 / Avg. bwd time: 25.7133 / Avg. batch time: 466.1476 (ms) / GPU bubble ratio: 27.13%
[rank2]:2025-11-02 19:03:13,028 - INFO - Avg. fwd time: 14.5400 / Avg. bwd time: 25.2476 / Avg. batch time: 414.9232 (ms) / GPU bubble ratio: 23.29%
[rank0]:2025-11-02 19:03:13,089 - INFO - Avg. fwd time: 13.8055 / Avg. bwd time: 31.6178 / Avg. batch time: 518.8739 (ms) / GPU bubble ratio: 29.97%
[rank2]:2025-11-02 19:03:13,197 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1724  memory: 39.52GiB(28.27%)  tps: 7,641  tflops: 356.39  mfu: 36.04%
[rank3]:2025-11-02 19:03:13,194 - INFO -  step: 2750  loss:  0.2869  grad_norm:  0.1724  memory: 47.84GiB(34.22%)  tps: 7,641  tflops: 356.38  mfu: 36.03%
[rank1]:2025-11-02 19:03:13,187 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1724  memory: 49.74GiB(35.58%)  tps: 7,641  tflops: 356.37  mfu: 36.03%
[rank0]:2025-11-02 19:03:13,214 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1724  memory: 56.44GiB(40.37%)  tps: 7,641  tflops: 356.38  mfu: 36.03%
[rank0]:2025-11-02 19:04:57,946 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:04:59,888 - INFO - Avg. fwd time: 16.5743 / Avg. bwd time: 25.1943 / Avg. batch time: 367.7876 (ms) / GPU bubble ratio: 9.15%
[rank1]:2025-11-02 19:04:59,932 - INFO - Avg. fwd time: 16.7558 / Avg. bwd time: 25.6426 / Avg. batch time: 465.9571 (ms) / GPU bubble ratio: 27.21%
[rank2]:2025-11-02 19:04:59,927 - INFO - Avg. fwd time: 14.5449 / Avg. bwd time: 25.2028 / Avg. batch time: 414.7014 (ms) / GPU bubble ratio: 23.32%
[rank0]:2025-11-02 19:04:59,988 - INFO - Avg. fwd time: 13.7999 / Avg. bwd time: 31.7542 / Avg. batch time: 518.7265 (ms) / GPU bubble ratio: 29.74%
[rank2]:2025-11-02 19:05:00,103 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2032  memory: 39.52GiB(28.27%)  tps: 7,663  tflops: 357.40  mfu: 36.14%
[rank2]:2025-11-02 19:05:00,103 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-02 19:05:00,093 - INFO -  step: 2800  loss:  0.2872  grad_norm:  0.2032  memory: 47.84GiB(34.22%)  tps: 7,663  tflops: 357.43  mfu: 36.14%
[rank3]:2025-11-02 19:05:00,093 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 19:05:00,085 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2032  memory: 49.74GiB(35.58%)  tps: 7,663  tflops: 357.42  mfu: 36.14%
[rank1]:2025-11-02 19:05:00,085 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 19:05:00,112 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2032  memory: 56.44GiB(40.37%)  tps: 7,663  tflops: 357.42  mfu: 36.14%
[rank0]:2025-11-02 19:05:00,112 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 19:05:16,953 - INFO - validate step: 2800  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,322
[rank2]:2025-11-02 19:05:17,005 - INFO - validate step: 2800  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,234
[rank3]:2025-11-02 19:05:17,019 - INFO - validate step: 2800  loss:  0.2420  memory: 47.84GiB(34.22%)  tps: 24,201
[rank1]:2025-11-02 19:05:16,987 - INFO - validate step: 2800  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,234
[rank2]:2025-11-02 19:05:17,092 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1905_stage2_step2800.svg
[rank1]:2025-11-02 19:05:17,096 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1905_stage1_step2800.svg
[rank0]:2025-11-02 19:05:17,093 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1905_stage0_step2800.svg
[rank3]:2025-11-02 19:05:17,204 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1905_real_step2800_rank3.svg
[rank3]:> Batch Time: 504.50 ms, GPU Bubble Ratio: 16.78%, 38.13%, 40.66%, 37.58%
[rank3]:2025-11-02 19:05:17,271 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1905_stage3_step2800.svg
[rank0]:2025-11-02 19:07:02,153 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 19:07:04,193 - INFO - Avg. fwd time: 16.5799 / Avg. bwd time: 25.1408 / Avg. batch time: 367.5794 (ms) / GPU bubble ratio: 9.20%
[rank2]:2025-11-02 19:07:04,243 - INFO - Avg. fwd time: 14.5500 / Avg. bwd time: 25.1611 / Avg. batch time: 414.5102 (ms) / GPU bubble ratio: 23.36%
[rank1]:2025-11-02 19:07:04,295 - INFO - Avg. fwd time: 16.7637 / Avg. bwd time: 25.5753 / Avg. batch time: 465.7978 (ms) / GPU bubble ratio: 27.28%
[rank0]:2025-11-02 19:07:04,350 - INFO - Avg. fwd time: 13.7947 / Avg. bwd time: 31.8857 / Avg. batch time: 518.6107 (ms) / GPU bubble ratio: 29.53%
[rank2]:2025-11-02 19:07:04,377 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2333  memory: 39.52GiB(28.27%)  tps: 7,630  tflops: 355.84  mfu: 35.98%
[rank3]:2025-11-02 19:07:04,374 - INFO -  step: 2850  loss:  0.3974  grad_norm:  0.2333  memory: 47.84GiB(34.22%)  tps: 7,631  tflops: 355.91  mfu: 35.99%
[rank1]:2025-11-02 19:07:04,365 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2333  memory: 49.74GiB(35.58%)  tps: 7,629  tflops: 355.83  mfu: 35.98%
[rank0]:2025-11-02 19:07:04,392 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2333  memory: 56.44GiB(40.37%)  tps: 7,625  tflops: 355.62  mfu: 35.96%
[rank0]:2025-11-02 19:08:49,156 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:08:51,098 - INFO - Avg. fwd time: 16.5845 / Avg. bwd time: 25.0943 / Avg. batch time: 367.4046 (ms) / GPU bubble ratio: 9.25%
[rank1]:2025-11-02 19:08:51,140 - INFO - Avg. fwd time: 16.7699 / Avg. bwd time: 25.5190 / Avg. batch time: 465.6502 (ms) / GPU bubble ratio: 27.35%
[rank2]:2025-11-02 19:08:51,133 - INFO - Avg. fwd time: 14.5536 / Avg. bwd time: 25.1281 / Avg. batch time: 414.3379 (ms) / GPU bubble ratio: 23.38%
[rank0]:2025-11-02 19:08:51,194 - INFO - Avg. fwd time: 13.7901 / Avg. bwd time: 31.9944 / Avg. batch time: 518.4974 (ms) / GPU bubble ratio: 29.36%
[rank3]:2025-11-02 19:08:51,299 - INFO -  step: 2900  loss:  0.3789  grad_norm:  0.2199  memory: 47.84GiB(34.22%)  tps: 7,662  tflops: 357.34  mfu: 36.13%
[rank1]:2025-11-02 19:08:51,292 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2199  memory: 49.74GiB(35.58%)  tps: 7,661  tflops: 357.32  mfu: 36.13%
[rank0]:2025-11-02 19:08:51,319 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2199  memory: 56.44GiB(40.37%)  tps: 7,661  tflops: 357.33  mfu: 36.13%
[rank2]:2025-11-02 19:08:51,306 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2199  memory: 39.52GiB(28.27%)  tps: 7,661  tflops: 357.32  mfu: 36.13%
[rank1]:2025-11-02 19:08:51,396 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1908_stage1_step2900.svg
[rank0]:2025-11-02 19:08:51,392 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1908_stage0_step2900.svg
[rank2]:2025-11-02 19:08:51,392 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1908_stage2_step2900.svg
[rank3]:2025-11-02 19:08:51,506 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1908_real_step2900_rank3.svg
[rank3]:> Batch Time: 505.91 ms, GPU Bubble Ratio: 16.94%, 38.17%, 40.40%, 38.89%
[rank3]:2025-11-02 19:08:51,576 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1908_stage3_step2900.svg
[rank0]:2025-11-02 19:10:36,439 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:10:38,393 - INFO - Avg. fwd time: 16.5902 / Avg. bwd time: 25.0381 / Avg. batch time: 367.2119 (ms) / GPU bubble ratio: 9.31%
[rank2]:2025-11-02 19:10:38,429 - INFO - Avg. fwd time: 14.5581 / Avg. bwd time: 25.0912 / Avg. batch time: 414.1609 (ms) / GPU bubble ratio: 23.41%
[rank1]:2025-11-02 19:10:38,435 - INFO - Avg. fwd time: 16.7775 / Avg. bwd time: 25.4537 / Avg. batch time: 465.5004 (ms) / GPU bubble ratio: 27.42%
[rank0]:2025-11-02 19:10:38,489 - INFO - Avg. fwd time: 13.7853 / Avg. bwd time: 32.1174 / Avg. batch time: 518.3867 (ms) / GPU bubble ratio: 29.16%
[rank3]:2025-11-02 19:10:38,587 - INFO -  step: 2950  loss:  0.4300  grad_norm:  0.3371  memory: 47.84GiB(34.22%)  tps: 7,636  tflops: 356.13  mfu: 36.01%
[rank1]:2025-11-02 19:10:38,586 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.3371  memory: 49.74GiB(35.58%)  tps: 7,635  tflops: 356.10  mfu: 36.01%
[rank0]:2025-11-02 19:10:38,613 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.3371  memory: 56.44GiB(40.37%)  tps: 7,635  tflops: 356.10  mfu: 36.01%
[rank2]:2025-11-02 19:10:38,596 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.3371  memory: 39.52GiB(28.27%)  tps: 7,635  tflops: 356.11  mfu: 36.01%
[rank0]:2025-11-02 19:12:23,600 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 19:12:25,625 - INFO - Avg. fwd time: 16.5957 / Avg. bwd time: 24.9809 / Avg. batch time: 367.0324 (ms) / GPU bubble ratio: 9.38%
[rank2]:2025-11-02 19:12:25,674 - INFO - Avg. fwd time: 14.5627 / Avg. bwd time: 25.0518 / Avg. batch time: 413.9886 (ms) / GPU bubble ratio: 23.45%
[rank1]:2025-11-02 19:12:25,725 - INFO - Avg. fwd time: 16.7845 / Avg. bwd time: 25.3919 / Avg. batch time: 465.3566 (ms) / GPU bubble ratio: 27.49%
[rank1]:2025-11-02 19:12:25,792 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2129  memory: 49.74GiB(35.58%)  tps: 7,641  tflops: 356.39  mfu: 36.04%
[rank1]:2025-11-02 19:12:25,792 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2129  tps: 7,626  tflops: 355.66  mfu: 35.28%
[rank1]:2025-11-02 19:12:25,792 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 19:12:25,778 - INFO - Avg. fwd time: 13.7804 / Avg. bwd time: 32.2363 / Avg. batch time: 518.2819 (ms) / GPU bubble ratio: 28.97%
[rank0]:2025-11-02 19:12:25,820 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2129  memory: 56.44GiB(40.37%)  tps: 7,641  tflops: 356.39  mfu: 36.04%
[rank0]:2025-11-02 19:12:25,820 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2129  tps: 7,625  tflops: 355.63  mfu: 35.27%
[rank0]:2025-11-02 19:12:25,820 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-02 19:12:25,808 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2129  memory: 39.52GiB(28.27%)  tps: 7,641  tflops: 356.38  mfu: 36.03%
[rank2]:2025-11-02 19:12:25,808 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2129  tps: 7,626  tflops: 355.67  mfu: 35.28%
[rank2]:2025-11-02 19:12:25,808 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 19:12:25,794 - INFO -  step: 3000  loss:  0.3473  grad_norm:  0.2129  memory: 47.84GiB(34.22%)  tps: 7,641  tflops: 356.40  mfu: 36.04%
[rank3]:2025-11-02 19:12:25,795 - INFO -  final step: 3000  loss:  0.3473  grad_norm:  0.2129  tps: 7,627  tflops: 355.74  mfu: 35.28%
[rank3]:2025-11-02 19:12:25,795 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 19:12:42,487 - INFO - validate step: 3000  loss: -1.0000  memory: 56.44GiB(40.37%)  tps: 24,577
[rank0]:2025-11-02 19:12:42,487 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 19:12:42,491 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 19:12:42,536 - INFO - validate step: 3000  loss: -1.0000  memory: 39.52GiB(28.27%)  tps: 24,486
[rank2]:2025-11-02 19:12:42,537 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 19:12:42,541 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 19:12:42,549 - INFO - validate step: 3000  loss:  0.2438  memory: 47.84GiB(34.22%)  tps: 24,449
[rank3]:2025-11-02 19:12:42,550 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 19:12:42,553 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-02 19:12:42,519 - INFO - validate step: 3000  loss: -1.0000  memory: 49.74GiB(35.58%)  tps: 24,489
[rank1]:2025-11-02 19:12:42,519 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 19:12:42,522 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 19:12:54,464 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-02 19:12:54,565 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251102_1912_stage2_final3000.svg
[rank1]:2025-11-02 19:12:54,562 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251102_1912_stage1_final3000.svg
[rank0]:2025-11-02 19:12:54,569 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251102_1912_stage0_final3000.svg
[rank3]:2025-11-02 19:12:54,667 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1912_real_final3000_rank3.svg
[rank3]:> Batch Time: 502.65 ms, GPU Bubble Ratio: 17.11%, 37.74%, 39.65%, 38.42%
[rank2]:2025-11-02 19:12:54,826 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251102_1912_rank2_stage2.svg
[rank2]:	> Counts Sum: 2837440, Total Sum: 5829120 (48.68%), Ratio(%) per element: [31.32, 31.71, 32.31, 31.96, 32.41, 31.71, 31.66, 32.46, 32.11, 37.4, 38.68, 39.27, 38.78, 38.38, 38.73, 39.27, 38.53, 39.87, 40.95, 41.35, 42.29, 41.65, 41.05, 42.58, 40.26, 43.77, 42.14, 49.95, 49.9, 49.3, 47.77, 49.16, 49.8, 49.8, 49.45, 49.4, 55.08, 55.48, 53.95, 54.15, 55.53, 54.19, 55.38, 55.33, 54.34, 56.47, 57.85, 55.68, 55.38, 57.01, 56.02, 54.54, 57.21, 57.75, 58.0, 59.14, 57.9, 57.65, 57.75, 58.99, 58.1, 57.21, 58.3, 57.65, 58.1, 57.8, 57.8, 58.79, 57.6, 58.94, 57.7, 58.49]
[rank2]:2025-11-02 19:12:54,826 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 19:12:54,851 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251102_1912_thry_final3000_rank3.svg
[rank3]:> Batch Time: 512.14 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-11-02 19:12:54,831 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251102_1912_rank1_stage1.svg
[rank1]:	> Counts Sum: 3000560, Total Sum: 6557760 (45.76%), Ratio(%) per element: [37.84, 39.08, 38.38, 38.43, 38.29, 37.54, 37.25, 37.94, 37.89, 40.61, 41.5, 41.0, 41.0, 41.1, 41.5, 40.31, 40.51, 40.71, 43.57, 43.23, 43.03, 43.23, 43.03, 43.33, 43.13, 42.63, 43.67, 44.71, 43.67, 43.72, 45.3, 45.1, 45.15, 45.15, 44.26, 43.97, 46.19, 45.7, 46.19, 46.09, 46.24, 43.87, 44.61, 46.24, 45.94, 46.98, 48.22, 46.78, 46.78, 46.83, 45.84, 47.13, 46.59, 47.38, 48.86, 48.66, 48.32, 48.41, 47.92, 49.7, 48.71, 49.45, 48.61, 50.59, 51.48, 51.43, 51.03, 51.67, 51.53, 50.79, 51.38, 51.53, 52.22, 52.51, 52.71, 51.33, 52.47, 52.81, 52.91, 52.47, 51.97]
[rank1]:2025-11-02 19:12:54,831 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 19:12:54,872 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251102_1912_rank0_stage0.svg
[rank0]:	> Counts Sum: 5449640, Total Sum: 5910080 (92.21%), Ratio(%) per element: [93.23, 90.06, 89.87, 89.52, 89.97, 90.11, 90.06, 90.16, 89.87, 89.57, 90.61, 90.95, 90.51, 90.31, 90.56, 90.85, 90.56, 89.97, 90.95, 91.2, 90.71, 91.1, 91.2, 90.9, 91.05, 91.2, 90.66, 90.71, 92.68, 92.63, 92.29, 92.53, 92.83, 92.58, 92.19, 91.84, 92.24, 93.52, 93.37, 93.28, 93.37, 93.62, 93.33, 93.13, 93.62, 93.47, 93.57, 93.37, 93.52, 93.62, 93.42, 93.33, 93.42, 93.23, 93.23, 93.67, 93.47, 93.37, 93.57, 93.42, 93.33, 93.42, 93.57, 93.18, 93.57, 93.57, 93.47, 93.23, 93.33, 92.98, 93.87, 92.93, 93.28]
[rank0]:2025-11-02 19:12:54,873 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-02 19:12:54,938 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251102_1912_stage3_final3000.svg
[rank3]:2025-11-02 19:12:55,195 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251102_1912_rank3_stage3.svg
[rank3]:	> Counts Sum: 605280, Total Sum: 5262400 (11.50%), Ratio(%) per element: [5.33, 5.68, 5.23, 5.38, 5.43, 4.99, 5.53, 5.68, 5.73, 6.71, 6.42, 6.71, 7.01, 7.11, 6.71, 6.52, 5.28, 6.81, 7.95, 6.86, 7.11, 7.41, 7.46, 7.36, 7.41, 7.01, 7.31, 8.15, 8.25, 8.59, 8.05, 8.0, 8.44, 8.25, 8.79, 8.89, 9.43, 10.07, 9.83, 9.68, 9.48, 8.94, 8.99, 9.04, 9.63, 10.47, 10.62, 10.12, 10.37, 11.56, 10.42, 10.47, 10.52, 10.82, 28.7, 29.59, 28.45, 28.06, 28.45, 29.44, 28.65, 28.5, 29.19, 29.69, 28.6]
[rank3]:2025-11-02 19:12:55,195 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.14809
[rank3]:wandb:               final/avg_loss 0.34728
[rank3]:wandb:             final/avg_mfu(%) 35.28009
[rank3]:wandb:             final/avg_tflops 355.7363
[rank3]:wandb:    final/avg_throughput(tps) 7627.25297
[rank3]:wandb:              final/grad_norm 0.2129
[rank3]:wandb:               final/max_loss 0.34728
[rank3]:wandb:                    grad_norm 0.2129
[rank3]:wandb: loss_metrics/global_avg_loss 0.34728
[rank3]:wandb: loss_metrics/global_max_loss 0.34728
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_timelyauto_h200 at: https://wandb.ai/orangingq/torchtitan/runs/8h4yla3f
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_timelyauto_h200/20251102-1719/wandb/run-20251102_171919-8h4yla3f/logs
[rank0]:2025-11-02 19:12:56,873 - INFO - Training completed
[rank0]:2025-11-02 19:12:56,873 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 19:12:57,091 - INFO - Process group destroyed
[rank1]:2025-11-02 19:12:57,089 - INFO - Process group destroyed
[rank2]:2025-11-02 19:12:57,132 - INFO - Process group destroyed
[rank0]:2025-11-02 19:12:57,239 - INFO - Process group destroyed
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.11', 'layers.9', 'layers.15', 'layers.8', 'layers.12', 'layers.14', 'layers.13', 'layers.16'}
[rank2]:Stage 2: Modules to keep: {'layers.21', 'layers.20', 'layers.19', 'layers.22', 'layers.17', 'layers.18', 'layers.23', 'layers.24'}
[rank0]:Stage 0: Modules to keep: {'layers.7', 'layers.1', 'layers.5', 'layers.2', 'layers.4', 'layers.0', 'layers.3', 'layers.6', 'tok_embeddings'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.30', 'layers.26', 'output', 'layers.31', 'layers.27', 'norm', 'layers.28', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_timelyauto_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_timelyauto_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_timelyauto_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyauto_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_timelyauto_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyauto_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_timelyauto_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Nov  4 11:06:30 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run2.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_1F1B_timelyauto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyauto x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1104 11:06:31.610000 2619646 site-packages/torch/distributed/run.py:811] 
W1104 11:06:31.610000 2619646 site-packages/torch/distributed/run.py:811] *****************************************
W1104 11:06:31.610000 2619646 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1104 11:06:31.610000 2619646 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-11-04 11:06:38,618 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-04 11:06:38,835 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-04 11:06:38,833 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-04 11:06:38,953 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-04 11:06:39,140 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 11:06:39,143 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 11:06:39,672 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 11:06:39,675 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 11:06:39,681 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-04 11:06:39,689 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 11:06:39,691 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-04 11:06:39,660 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 11:06:39,662 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 11:06:41,470 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 11:06:41,753 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-04 11:06:43,495 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 11:06:43,764 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-04 11:06:43,743 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-04 11:06:43,825 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-04 11:06:43,849 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-04 11:06:43,850 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2025-11-04 11:06:43,825 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-04 11:06:43,825 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-04 11:06:44,081 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-04 11:06:44,081 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-11-04 11:06:44,107 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-04 11:06:44,108 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2025-11-04 11:06:44,122 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-04 11:06:44,196 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-04 11:06:44,196 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank2]:2025-11-04 11:06:44,407 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-04 11:06:44,408 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run dwc3kmcg
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyauto_h200/20251104-1106/wandb/run-20251104_110644-dwc3kmcg
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_1F1B_timelyauto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/dwc3kmcg
[rank3]:2025-11-04 11:06:45,662 - INFO - WandB logging enabled
[rank3]:2025-11-04 11:06:45,663 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-04 11:06:45,738 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-04 11:06:45,738 - INFO - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2025-11-04 11:06:45,980 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyauto_h200
[rank0]:2025-11-04 11:06:45,981 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 11:06:45,981 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-04 11:06:45,965 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-04 11:06:45,965 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-04 11:06:45,980 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-04 11:06:45,977 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-04 11:06:45,977 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 11:06:48,694 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-04 11:06:48,694 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-04 11:07:17,415 - INFO - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2025-11-04 11:07:17,415 - INFO - Finished loading the checkpoint in 28.72 seconds.
[rank0]:2025-11-04 11:07:17,415 - INFO - Training starts at step 1
[rank0]:2025-11-04 11:07:21,402 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.59GiB(26.89%)  tps: 436  tflops: 20.34  mfu: 2.06%
[rank0]:2025-11-04 11:07:21,402 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-04 11:07:21,426 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 459  tflops: 21.40  mfu: 2.16%
[rank3]:2025-11-04 11:07:21,426 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 11:07:21,383 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 32.41GiB(23.18%)  tps: 436  tflops: 20.33  mfu: 2.06%
[rank1]:2025-11-04 11:07:21,383 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-04 11:07:21,394 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 27.12GiB(19.40%)  tps: 440  tflops: 20.53  mfu: 2.08%
[rank2]:2025-11-04 11:07:21,394 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 11:09:28,319 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:09:30,759 - INFO - Avg. fwd time: 14.6831 / Avg. bwd time: 42.1894 / Avg. batch time: 472.9236 (ms) / GPU bubble ratio: 3.79%
[rank1]:2025-11-04 11:09:30,834 - INFO - Avg. fwd time: 15.0959 / Avg. bwd time: 41.0253 / Avg. batch time: 584.8586 (ms) / GPU bubble ratio: 23.23%
[rank2]:2025-11-04 11:09:30,788 - INFO - Avg. fwd time: 13.1871 / Avg. bwd time: 36.1729 / Avg. batch time: 525.6082 (ms) / GPU bubble ratio: 24.87%
[rank0]:2025-11-04 11:09:30,867 - INFO - Avg. fwd time: 13.2641 / Avg. bwd time: 37.6804 / Avg. batch time: 639.9727 (ms) / GPU bubble ratio: 36.32%
[rank0]:2025-11-04 11:09:30,993 - INFO -  step: 50  loss: -4.0000  grad_norm: 7327.1519  memory: 54.93GiB(39.29%)  tps: 6,195  tflops: 288.94  mfu: 29.21%
[rank3]:2025-11-04 11:09:30,991 - INFO -  step: 50  loss: 12.7732  grad_norm: 7327.1519  memory: 46.16GiB(33.01%)  tps: 6,196  tflops: 289.00  mfu: 29.22%
[rank1]:2025-11-04 11:09:30,989 - INFO -  step: 50  loss: -4.0000  grad_norm: 7327.1519  memory: 47.26GiB(33.80%)  tps: 6,194  tflops: 288.90  mfu: 29.21%
[rank2]:2025-11-04 11:09:30,986 - INFO -  step: 50  loss: -4.0000  grad_norm: 7327.1519  memory: 38.72GiB(27.69%)  tps: 6,195  tflops: 288.93  mfu: 29.21%
[rank0]:2025-11-04 11:11:40,671 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:11:43,105 - INFO - Avg. fwd time: 14.7272 / Avg. bwd time: 42.3197 / Avg. batch time: 473.0154 (ms) / GPU bubble ratio: 3.52%
[rank2]:2025-11-04 11:11:43,134 - INFO - Avg. fwd time: 13.2188 / Avg. bwd time: 36.2801 / Avg. batch time: 525.5035 (ms) / GPU bubble ratio: 24.65%
[rank0]:2025-11-04 11:11:43,212 - INFO - Avg. fwd time: 13.2259 / Avg. bwd time: 37.8414 / Avg. batch time: 639.3517 (ms) / GPU bubble ratio: 36.10%
[rank1]:2025-11-04 11:11:43,180 - INFO - Avg. fwd time: 15.0218 / Avg. bwd time: 41.0749 / Avg. batch time: 584.4622 (ms) / GPU bubble ratio: 23.22%
[rank0]:2025-11-04 11:11:43,338 - INFO -  step: 100  loss: -4.0000  grad_norm: 42.6992  memory: 54.93GiB(39.29%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank0]:2025-11-04 11:11:43,338 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 11:11:43,337 - INFO -  step: 100  loss:  4.3362  grad_norm: 42.6992  memory: 46.16GiB(33.01%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank3]:2025-11-04 11:11:43,338 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 11:11:43,334 - INFO -  step: 100  loss: -4.0000  grad_norm: 42.6992  memory: 47.26GiB(33.80%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank1]:2025-11-04 11:11:43,334 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 11:11:43,331 - INFO -  step: 100  loss: -4.0000  grad_norm: 42.6992  memory: 38.72GiB(27.69%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank2]:2025-11-04 11:11:43,332 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 11:13:52,988 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:13:55,512 - INFO - Avg. fwd time: 14.7207 / Avg. bwd time: 42.3456 / Avg. batch time: 472.7797 (ms) / GPU bubble ratio: 3.44%
[rank2]:2025-11-04 11:13:55,554 - INFO - Avg. fwd time: 13.2142 / Avg. bwd time: 36.3549 / Avg. batch time: 525.2275 (ms) / GPU bubble ratio: 24.50%
[rank0]:2025-11-04 11:13:55,645 - INFO - Avg. fwd time: 13.2316 / Avg. bwd time: 37.9452 / Avg. batch time: 638.9967 (ms) / GPU bubble ratio: 35.93%
[rank1]:2025-11-04 11:13:55,601 - INFO - Avg. fwd time: 14.9809 / Avg. bwd time: 41.1064 / Avg. batch time: 584.1011 (ms) / GPU bubble ratio: 23.18%
[rank3]:2025-11-04 11:13:55,678 - INFO -  step: 150  loss:  1.2274  grad_norm: 16.9012  memory: 46.16GiB(33.01%)  tps: 6,190  tflops: 288.71  mfu: 29.19%
[rank0]:2025-11-04 11:13:55,680 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.9012  memory: 54.93GiB(39.29%)  tps: 6,190  tflops: 288.71  mfu: 29.19%
[rank1]:2025-11-04 11:13:55,676 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.9012  memory: 47.26GiB(33.80%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank2]:2025-11-04 11:13:55,673 - INFO -  step: 150  loss: -4.0000  grad_norm: 16.9012  memory: 38.72GiB(27.69%)  tps: 6,190  tflops: 288.70  mfu: 29.19%
[rank0]:2025-11-04 11:16:05,191 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:16:07,622 - INFO - Avg. fwd time: 14.7164 / Avg. bwd time: 42.3544 / Avg. batch time: 472.6483 (ms) / GPU bubble ratio: 3.40%
[rank2]:2025-11-04 11:16:07,651 - INFO - Avg. fwd time: 13.2154 / Avg. bwd time: 36.3991 / Avg. batch time: 525.0789 (ms) / GPU bubble ratio: 24.41%
[rank0]:2025-11-04 11:16:07,730 - INFO - Avg. fwd time: 13.2403 / Avg. bwd time: 37.9962 / Avg. batch time: 638.7890 (ms) / GPU bubble ratio: 35.83%
[rank1]:2025-11-04 11:16:07,698 - INFO - Avg. fwd time: 14.9619 / Avg. bwd time: 41.1235 / Avg. batch time: 583.9112 (ms) / GPU bubble ratio: 23.16%
[rank3]:2025-11-04 11:16:07,855 - INFO -  step: 200  loss:  0.3465  grad_norm:  0.4752  memory: 46.16GiB(33.01%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank3]:2025-11-04 11:16:07,855 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 11:16:07,856 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4752  memory: 54.93GiB(39.29%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank0]:2025-11-04 11:16:07,856 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 11:16:07,851 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4752  memory: 47.26GiB(33.80%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank2]:2025-11-04 11:16:07,849 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4752  memory: 38.72GiB(27.69%)  tps: 6,198  tflops: 289.07  mfu: 29.23%
[rank1]:2025-11-04 11:16:07,851 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-04 11:16:07,849 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 11:16:24,033 - INFO - validate step: 200  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 25,320
[rank0]:2025-11-04 11:16:24,034 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 11:16:24,063 - INFO - validate step: 200  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 25,266
[rank1]:2025-11-04 11:16:24,064 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 11:16:24,080 - INFO - validate step: 200  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 25,235
[rank2]:2025-11-04 11:16:24,081 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 11:16:24,101 - INFO - validate step: 200  loss:  0.2308  memory: 46.16GiB(33.01%)  tps: 25,215
[rank3]:2025-11-04 11:16:24,102 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 11:18:33,921 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 11:18:36,348 - INFO - Avg. fwd time: 14.7172 / Avg. bwd time: 42.3713 / Avg. batch time: 472.6726 (ms) / GPU bubble ratio: 3.38%
[rank2]:2025-11-04 11:18:36,377 - INFO - Avg. fwd time: 13.2280 / Avg. bwd time: 36.4320 / Avg. batch time: 525.1161 (ms) / GPU bubble ratio: 24.34%
[rank0]:2025-11-04 11:18:36,455 - INFO - Avg. fwd time: 13.2562 / Avg. bwd time: 38.0423 / Avg. batch time: 638.8646 (ms) / GPU bubble ratio: 35.76%
[rank1]:2025-11-04 11:18:36,423 - INFO - Avg. fwd time: 14.9687 / Avg. bwd time: 41.1498 / Avg. batch time: 583.9444 (ms) / GPU bubble ratio: 23.12%
[rank0]:2025-11-04 11:18:36,579 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2509  memory: 54.93GiB(39.29%)  tps: 6,181  tflops: 288.26  mfu: 29.15%
[rank3]:2025-11-04 11:18:36,577 - INFO -  step: 250  loss:  0.2336  grad_norm:  0.2509  memory: 46.16GiB(33.01%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank1]:2025-11-04 11:18:36,575 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2509  memory: 47.26GiB(33.80%)  tps: 6,182  tflops: 288.33  mfu: 29.15%
[rank2]:2025-11-04 11:18:36,572 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2509  memory: 38.72GiB(27.69%)  tps: 6,183  tflops: 288.38  mfu: 29.16%
[rank0]:2025-11-04 11:20:46,362 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:20:48,889 - INFO - Avg. fwd time: 14.7177 / Avg. bwd time: 42.3804 / Avg. batch time: 472.6739 (ms) / GPU bubble ratio: 3.36%
[rank1]:2025-11-04 11:20:48,978 - INFO - Avg. fwd time: 14.9693 / Avg. bwd time: 41.1599 / Avg. batch time: 583.9508 (ms) / GPU bubble ratio: 23.10%
[rank2]:2025-11-04 11:20:48,932 - INFO - Avg. fwd time: 13.2371 / Avg. bwd time: 36.4500 / Avg. batch time: 525.1246 (ms) / GPU bubble ratio: 24.30%
[rank0]:2025-11-04 11:20:49,023 - INFO - Avg. fwd time: 13.2470 / Avg. bwd time: 38.0353 / Avg. batch time: 638.8431 (ms) / GPU bubble ratio: 35.78%
[rank0]:2025-11-04 11:20:49,058 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2915  memory: 54.93GiB(39.29%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank0]:2025-11-04 11:20:49,058 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 11:20:49,056 - INFO -  step: 300  loss:  0.2707  grad_norm:  0.2915  memory: 46.16GiB(33.01%)  tps: 6,184  tflops: 288.41  mfu: 29.16%
[rank3]:2025-11-04 11:20:49,057 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 11:20:49,054 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2915  memory: 47.26GiB(33.80%)  tps: 6,184  tflops: 288.40  mfu: 29.16%
[rank1]:2025-11-04 11:20:49,054 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 11:20:49,052 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2915  memory: 38.72GiB(27.69%)  tps: 6,184  tflops: 288.40  mfu: 29.16%
[rank2]:2025-11-04 11:20:49,052 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 11:22:58,997 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:23:01,446 - INFO - Avg. fwd time: 14.7223 / Avg. bwd time: 42.3933 / Avg. batch time: 472.7670 (ms) / GPU bubble ratio: 3.35%
[rank1]:2025-11-04 11:23:01,522 - INFO - Avg. fwd time: 14.9760 / Avg. bwd time: 41.1756 / Avg. batch time: 584.0532 (ms) / GPU bubble ratio: 23.09%
[rank2]:2025-11-04 11:23:01,476 - INFO - Avg. fwd time: 13.2461 / Avg. bwd time: 36.4647 / Avg. batch time: 525.2262 (ms) / GPU bubble ratio: 24.28%
[rank0]:2025-11-04 11:23:01,555 - INFO - Avg. fwd time: 13.2395 / Avg. bwd time: 38.0278 / Avg. batch time: 638.9158 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-04 11:23:01,680 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3950  memory: 54.93GiB(39.29%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank3]:2025-11-04 11:23:01,678 - INFO -  step: 350  loss:  0.3349  grad_norm:  0.3950  memory: 46.16GiB(33.01%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank1]:2025-11-04 11:23:01,675 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3950  memory: 47.26GiB(33.80%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank2]:2025-11-04 11:23:01,672 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3950  memory: 38.72GiB(27.69%)  tps: 6,177  tflops: 288.10  mfu: 29.13%
[rank0]:2025-11-04 11:25:11,711 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:25:14,200 - INFO - Avg. fwd time: 13.2557 / Avg. bwd time: 36.4758 / Avg. batch time: 525.3933 (ms) / GPU bubble ratio: 24.28%
[rank1]:2025-11-04 11:25:14,246 - INFO - Avg. fwd time: 14.9803 / Avg. bwd time: 41.1858 / Avg. batch time: 584.2236 (ms) / GPU bubble ratio: 23.09%
[rank3]:2025-11-04 11:25:14,170 - INFO - Avg. fwd time: 14.7300 / Avg. bwd time: 42.4105 / Avg. batch time: 472.9256 (ms) / GPU bubble ratio: 3.34%
[rank0]:2025-11-04 11:25:14,279 - INFO - Avg. fwd time: 13.2327 / Avg. bwd time: 38.0195 / Avg. batch time: 639.0592 (ms) / GPU bubble ratio: 35.84%
[rank0]:2025-11-04 11:25:14,404 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2998  memory: 54.93GiB(39.29%)  tps: 6,172  tflops: 287.87  mfu: 29.11%
[rank0]:2025-11-04 11:25:14,404 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 11:25:14,397 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2998  memory: 38.72GiB(27.69%)  tps: 6,172  tflops: 287.87  mfu: 29.11%
[rank1]:2025-11-04 11:25:14,400 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.2998  memory: 47.26GiB(33.80%)  tps: 6,172  tflops: 287.87  mfu: 29.11%
[rank2]:2025-11-04 11:25:14,397 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 11:25:14,400 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 11:25:14,403 - INFO -  step: 400  loss:  0.2718  grad_norm:  0.2998  memory: 46.16GiB(33.01%)  tps: 6,172  tflops: 287.88  mfu: 29.11%
[rank3]:2025-11-04 11:25:14,403 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 11:25:29,397 - INFO - validate step: 400  loss: -1.0000  memory: 54.93GiB(39.29%)  tps: 27,320
[rank0]:2025-11-04 11:25:29,398 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 11:25:29,440 - INFO - validate step: 400  loss: -1.0000  memory: 38.72GiB(27.69%)  tps: 27,229
[rank2]:2025-11-04 11:25:29,441 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 11:25:29,428 - INFO - validate step: 400  loss: -1.0000  memory: 47.26GiB(33.80%)  tps: 27,257
[rank1]:2025-11-04 11:25:29,428 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 11:25:29,454 - INFO - validate step: 400  loss:  0.2365  memory: 46.16GiB(33.01%)  tps: 27,216
[rank3]:2025-11-04 11:25:29,456 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 11:27:39,298 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:27:41,858 - INFO - Avg. fwd time: 13.2627 / Avg. bwd time: 36.4838 / Avg. batch time: 525.5084 (ms) / GPU bubble ratio: 24.27%
[rank3]:2025-11-04 11:27:41,815 - INFO - Avg. fwd time: 14.7343 / Avg. bwd time: 42.4242 / Avg. batch time: 473.0383 (ms) / GPU bubble ratio: 3.33%
[rank0]:2025-11-04 11:27:41,952 - INFO - Avg. fwd time: 13.2263 / Avg. bwd time: 38.0106 / Avg. batch time: 639.1552 (ms) / GPU bubble ratio: 35.87%
[rank1]:2025-11-04 11:27:41,907 - INFO - Avg. fwd time: 14.9843 / Avg. bwd time: 41.1926 / Avg. batch time: 584.3390 (ms) / GPU bubble ratio: 23.09%
[rank0]:2025-11-04 11:27:41,988 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2941  memory: 54.93GiB(39.29%)  tps: 6,178  tflops: 288.16  mfu: 29.14%
[rank2]:2025-11-04 11:27:41,981 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2941  memory: 38.72GiB(27.69%)  tps: 6,181  tflops: 288.27  mfu: 29.15%
[rank1]:2025-11-04 11:27:41,983 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2941  memory: 47.26GiB(33.80%)  tps: 6,180  tflops: 288.24  mfu: 29.14%
[rank3]:2025-11-04 11:27:41,986 - INFO -  step: 450  loss:  0.3029  grad_norm:  0.2941  memory: 46.16GiB(33.01%)  tps: 6,181  tflops: 288.30  mfu: 29.15%
[rank3]:2025-11-04 11:28:08,259 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-04 11:28:34,808 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank2]:2025-11-04 11:28:35,079 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,107 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,035 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank3]:2025-11-04 11:28:35,072 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,096 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,095 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,100 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,127 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,196 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,149 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,188 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,125 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,262 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,232 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,273 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,236 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,289 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,238 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,292 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,316 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,370 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,371 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,371 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 11:28:35,372 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,326 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,380 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 11:28:35,411 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,342 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:35,395 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,335 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,372 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,403 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 11:28:35,432 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 11:28:51,319 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-04 11:28:51,524 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1128_max_batch_time.svg
[rank3]:> Batch Time: 623.09 ms, GPU Bubble Ratio: 34.18%, 27.63%, 35.92%, 26.27%
[rank3]:2025-11-04 11:28:51,664 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1128_min_batch_time.svg
[rank3]:> Batch Time: 353.77 ms, GPU Bubble Ratio: 70.20%, 24.47%, 32.92%, 23.36%
[rank3]:2025-11-04 11:28:51,833 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1128_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 372.21 ms, GPU Bubble Ratio: 28.39%, 21.38%, 25.38%, 22.20%
[rank3]:2025-11-04 11:28:51,833 - INFO - 	> Batch Time: 372.21 ms (Average Freeze Ratio: 0.75, Time Reduction Rate: 0.40)
[rank0]:2025-11-04 11:29:31,334 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:29:33,549 - INFO - Avg. fwd time: 13.3537 / Avg. bwd time: 35.6861 / Avg. batch time: 517.9925 (ms) / GPU bubble ratio: 24.26%
[rank3]:2025-11-04 11:29:33,531 - INFO - Avg. fwd time: 14.8431 / Avg. bwd time: 41.4468 / Avg. batch time: 466.1094 (ms) / GPU bubble ratio: 3.39%
[rank0]:2025-11-04 11:29:33,623 - INFO - Avg. fwd time: 13.2993 / Avg. bwd time: 36.6664 / Avg. batch time: 629.5237 (ms) / GPU bubble ratio: 36.50%
[rank1]:2025-11-04 11:29:33,591 - INFO - Avg. fwd time: 15.0861 / Avg. bwd time: 40.2000 / Avg. batch time: 575.8245 (ms) / GPU bubble ratio: 23.19%
[rank0]:2025-11-04 11:29:33,742 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.15/0.44, [MB1] 0.15/0.46, [MB2] 0.15/0.45, [MB3] 0.15/0.45, [MB4] 0.00/0.00, [MB5] 0.14/0.43, [MB6] 0.17/0.52, [MB7] 0.33/1.00
[rank0]:2025-11-04 11:29:33,743 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2550  memory: 54.93GiB(39.29%)  tps: 7,330  tflops: 341.89  mfu: 34.57%
[rank2]:2025-11-04 11:29:33,735 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.27/0.81, [MB1] 0.26/0.78, [MB2] 0.26/0.78, [MB3] 0.27/0.80, [MB4] 0.27/0.81, [MB5] 0.26/0.79, [MB6] 0.08/0.24, [MB7] 0.33/1.00
[rank2]:2025-11-04 11:29:33,736 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2550  memory: 38.91GiB(27.83%)  tps: 7,330  tflops: 341.89  mfu: 34.57%
[rank3]:2025-11-04 11:29:33,738 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.07/0.20, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-04 11:29:33,742 - INFO -  step: 500  loss:  0.3013  grad_norm:  0.2550  memory: 47.45GiB(33.94%)  tps: 7,330  tflops: 341.89  mfu: 34.57%
[rank1]:2025-11-04 11:29:33,739 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.96, [MB1] 0.32/0.96, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/0.99, [MB5] 0.00/0.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-04 11:29:33,739 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2550  memory: 47.55GiB(34.01%)  tps: 7,330  tflops: 341.89  mfu: 34.57%
[rank0]:2025-11-04 11:29:33,804 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1129_stage0_step500.svg
[rank2]:2025-11-04 11:29:33,802 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1129_stage2_step500.svg
[rank1]:2025-11-04 11:29:33,805 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1129_stage1_step500.svg
[rank3]:2025-11-04 11:29:33,874 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1129_real_step500_rank3.svg
[rank3]:> Batch Time: 433.09 ms, GPU Bubble Ratio: 49.43%, 34.22%, 35.84%, 30.40%
[rank3]:2025-11-04 11:29:33,915 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1129_stage3_step500.svg
[rank0]:2025-11-04 11:31:21,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:31:23,345 - INFO - Avg. fwd time: 14.9511 / Avg. bwd time: 40.4516 / Avg. batch time: 458.9932 (ms) / GPU bubble ratio: 3.44%
[rank0]:2025-11-04 11:31:23,417 - INFO - Avg. fwd time: 13.3608 / Avg. bwd time: 36.0764 / Avg. batch time: 620.2153 (ms) / GPU bubble ratio: 36.23%
[rank2]:2025-11-04 11:31:23,371 - INFO - Avg. fwd time: 13.4353 / Avg. bwd time: 35.0021 / Avg. batch time: 510.1544 (ms) / GPU bubble ratio: 24.04%
[rank1]:2025-11-04 11:31:23,386 - INFO - Avg. fwd time: 15.1901 / Avg. bwd time: 39.2456 / Avg. batch time: 567.0335 (ms) / GPU bubble ratio: 23.20%
[rank2]:2025-11-04 11:31:23,525 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.54/0.81, [MB1] 0.52/0.78, [MB2] 0.52/0.78, [MB3] 0.54/0.80, [MB4] 0.54/0.81, [MB5] 0.52/0.79, [MB6] 0.16/0.24, [MB7] 0.67/1.00
[rank2]:2025-11-04 11:31:23,525 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1007  memory: 38.91GiB(27.83%)  tps: 7,462  tflops: 348.01  mfu: 35.19%
[rank1]:2025-11-04 11:31:23,529 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.64/0.96, [MB1] 0.64/0.96, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.66/0.99, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-04 11:31:23,529 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1007  memory: 48.02GiB(34.34%)  tps: 7,462  tflops: 348.01  mfu: 35.19%
[rank3]:2025-11-04 11:31:23,531 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.13/0.20, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-04 11:31:23,535 - INFO -  step: 550  loss:  0.1662  grad_norm:  0.1007  memory: 47.72GiB(34.13%)  tps: 7,461  tflops: 348.00  mfu: 35.19%
[rank0]:2025-11-04 11:31:23,541 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.30/0.44, [MB1] 0.31/0.46, [MB2] 0.30/0.45, [MB3] 0.30/0.45, [MB4] 0.00/0.00, [MB5] 0.29/0.43, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank0]:2025-11-04 11:31:23,541 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1007  memory: 57.02GiB(40.79%)  tps: 7,461  tflops: 347.98  mfu: 35.19%
[rank0]:2025-11-04 11:33:01,184 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:33:03,015 - INFO - Avg. fwd time: 13.5659 / Avg. bwd time: 33.9219 / Avg. batch time: 499.8554 (ms) / GPU bubble ratio: 24.00%
[rank3]:2025-11-04 11:33:02,986 - INFO - Avg. fwd time: 15.1103 / Avg. bwd time: 39.1438 / Avg. batch time: 449.7915 (ms) / GPU bubble ratio: 3.50%
[rank1]:2025-11-04 11:33:03,042 - INFO - Avg. fwd time: 15.3555 / Avg. bwd time: 37.8025 / Avg. batch time: 555.2724 (ms) / GPU bubble ratio: 23.41%
[rank0]:2025-11-04 11:33:03,070 - INFO - Avg. fwd time: 13.4737 / Avg. bwd time: 35.0066 / Avg. batch time: 607.5308 (ms) / GPU bubble ratio: 36.16%
[rank0]:2025-11-04 11:33:03,102 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.44/0.44, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 11:33:03,103 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1723  memory: 58.45GiB(41.81%)  tps: 8,228  tflops: 383.76  mfu: 38.80%
[rank0]:2025-11-04 11:33:03,103 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-11-04 11:33:03,085 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.78/0.78, [MB2] 0.78/0.78, [MB3] 0.80/0.80, [MB4] 0.81/0.81, [MB5] 0.79/0.79, [MB6] 0.24/0.24, [MB7] 1.00/1.00
[rank2]:2025-11-04 11:33:03,085 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1723  memory: 38.91GiB(27.83%)  tps: 8,228  tflops: 383.77  mfu: 38.80%
[rank2]:2025-11-04 11:33:03,085 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 11:33:03,083 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-04 11:33:03,087 - INFO -  step: 600  loss:  0.4526  grad_norm:  0.1723  memory: 47.72GiB(34.13%)  tps: 8,229  tflops: 383.80  mfu: 38.81%
[rank3]:2025-11-04 11:33:03,087 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 11:33:03,081 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.99/0.99, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 11:33:03,081 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.1723  memory: 48.02GiB(34.34%)  tps: 8,229  tflops: 383.80  mfu: 38.81%
[rank1]:2025-11-04 11:33:03,081 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 11:33:19,651 - INFO - validate step: 600  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,752
[rank2]:2025-11-04 11:33:19,701 - INFO - validate step: 600  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,652
[rank1]:2025-11-04 11:33:19,685 - INFO - validate step: 600  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,669
[rank1]:2025-11-04 11:33:19,765 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1133_stage1_step600.svg
[rank3]:2025-11-04 11:33:19,712 - INFO - validate step: 600  loss:  0.2476  memory: 47.72GiB(34.13%)  tps: 24,639
[rank0]:2025-11-04 11:33:19,765 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1133_stage0_step600.svg
[rank2]:2025-11-04 11:33:19,765 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1133_stage2_step600.svg
[rank3]:2025-11-04 11:33:19,856 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1133_real_step600_rank3.svg
[rank3]:> Batch Time: 444.02 ms, GPU Bubble Ratio: 37.89%, 33.07%, 34.80%, 29.21%
[rank3]:2025-11-04 11:33:19,900 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1133_stage3_step600.svg
[rank0]:2025-11-04 11:34:49,777 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 11:34:51,507 - INFO - Avg. fwd time: 13.5815 / Avg. bwd time: 33.4606 / Avg. batch time: 595.5153 (ms) / GPU bubble ratio: 36.80%
[rank1]:2025-11-04 11:34:51,475 - INFO - Avg. fwd time: 15.5105 / Avg. bwd time: 36.4694 / Avg. batch time: 544.2112 (ms) / GPU bubble ratio: 23.59%
[rank2]:2025-11-04 11:34:51,470 - INFO - Avg. fwd time: 13.6952 / Avg. bwd time: 32.9101 / Avg. batch time: 490.1298 (ms) / GPU bubble ratio: 23.93%
[rank3]:2025-11-04 11:34:51,456 - INFO - Avg. fwd time: 15.2803 / Avg. bwd time: 37.8803 / Avg. batch time: 441.0303 (ms) / GPU bubble ratio: 3.57%
[rank3]:2025-11-04 11:34:51,529 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 11:34:51,566 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.99/0.99, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 11:34:51,594 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,913  tflops: 415.72  mfu: 42.03%
[rank2]:2025-11-04 11:34:51,602 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.78/0.78, [MB2] 0.78/0.78, [MB3] 0.80/0.80, [MB4] 0.81/0.81, [MB5] 0.79/0.79, [MB6] 0.24/0.24, [MB7] 1.00/1.00
[rank2]:2025-11-04 11:34:51,603 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0652  memory: 38.91GiB(27.83%)  tps: 8,914  tflops: 415.75  mfu: 42.04%
[rank3]:2025-11-04 11:34:51,595 - INFO -  step: 650  loss:  0.2734  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,916  tflops: 415.84  mfu: 42.05%
[rank0]:2025-11-04 11:34:51,617 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.44/0.44, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 11:34:51,617 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0652  memory: 58.45GiB(41.81%)  tps: 8,908  tflops: 415.46  mfu: 42.01%
[rank0]:2025-11-04 11:36:21,820 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:36:23,514 - INFO - Avg. fwd time: 15.4486 / Avg. bwd time: 36.6058 / Avg. batch time: 432.1675 (ms) / GPU bubble ratio: 3.64%
[rank0]:2025-11-04 11:36:23,562 - INFO - Avg. fwd time: 13.6908 / Avg. bwd time: 31.9400 / Avg. batch time: 583.4897 (ms) / GPU bubble ratio: 37.44%
[rank1]:2025-11-04 11:36:23,535 - INFO - Avg. fwd time: 15.6654 / Avg. bwd time: 35.1287 / Avg. batch time: 533.0165 (ms) / GPU bubble ratio: 23.76%
[rank2]:2025-11-04 11:36:23,529 - INFO - Avg. fwd time: 13.8223 / Avg. bwd time: 31.8917 / Avg. batch time: 480.2697 (ms) / GPU bubble ratio: 23.85%
[rank3]:2025-11-04 11:36:23,588 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.20/0.20, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-04 11:36:23,675 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.44/0.44, [MB1] 0.46/0.46, [MB2] 0.45/0.45, [MB3] 0.45/0.45, [MB4] 0.00/0.00, [MB5] 0.43/0.43, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank0]:2025-11-04 11:36:23,676 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0878  memory: 58.45GiB(41.81%)  tps: 8,899  tflops: 415.04  mfu: 41.97%
[rank1]:2025-11-04 11:36:23,625 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.96/0.96, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.99/0.99, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 11:36:23,649 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,899  tflops: 415.05  mfu: 41.97%
[rank2]:2025-11-04 11:36:23,657 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.81/0.81, [MB1] 0.78/0.78, [MB2] 0.78/0.78, [MB3] 0.80/0.80, [MB4] 0.81/0.81, [MB5] 0.79/0.79, [MB6] 0.24/0.24, [MB7] 1.00/1.00
[rank2]:2025-11-04 11:36:23,657 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0878  memory: 38.91GiB(27.83%)  tps: 8,899  tflops: 415.05  mfu: 41.97%
[rank3]:2025-11-04 11:36:23,650 - INFO -  step: 700  loss:  0.3758  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,899  tflops: 415.06  mfu: 41.97%
[rank0]:2025-11-04 11:36:23,727 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1136_stage0_step700.svg
[rank1]:2025-11-04 11:36:23,728 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1136_stage1_step700.svg
[rank2]:2025-11-04 11:36:23,728 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1136_stage2_step700.svg
[rank3]:2025-11-04 11:36:23,814 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1136_real_step700_rank3.svg
[rank3]:> Batch Time: 434.33 ms, GPU Bubble Ratio: 47.76%, 32.94%, 35.64%, 28.77%
[rank3]:2025-11-04 11:36:23,858 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1136_stage3_step700.svg
[rank0]:2025-11-04 11:37:53,646 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:37:55,398 - INFO - Avg. fwd time: 15.5911 / Avg. bwd time: 35.5021 / Avg. batch time: 424.4664 (ms) / GPU bubble ratio: 3.70%
[rank1]:2025-11-04 11:37:55,453 - INFO - Avg. fwd time: 15.7982 / Avg. bwd time: 33.9772 / Avg. batch time: 523.3347 (ms) / GPU bubble ratio: 23.91%
[rank1]:2025-11-04 11:37:55,491 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,920  tflops: 416.01  mfu: 42.06%
[rank2]:2025-11-04 11:37:55,427 - INFO - Avg. fwd time: 13.9335 / Avg. bwd time: 31.0244 / Avg. batch time: 471.7398 (ms) / GPU bubble ratio: 23.76%
[rank3]:2025-11-04 11:37:55,493 - INFO -  step: 750  loss:  0.1516  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,920  tflops: 416.02  mfu: 42.06%
[rank0]:2025-11-04 11:37:55,484 - INFO - Avg. fwd time: 13.7852 / Avg. bwd time: 30.5849 / Avg. batch time: 573.1198 (ms) / GPU bubble ratio: 38.07%
[rank0]:2025-11-04 11:37:55,519 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0573  memory: 58.45GiB(41.81%)  tps: 8,920  tflops: 416.01  mfu: 42.06%
[rank2]:2025-11-04 11:37:55,498 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0573  memory: 38.91GiB(27.83%)  tps: 8,920  tflops: 416.02  mfu: 42.06%
[rank0]:2025-11-04 11:39:24,015 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 11:39:25,741 - INFO - Avg. fwd time: 15.8905 / Avg. bwd time: 33.1105 / Avg. batch time: 515.9262 (ms) / GPU bubble ratio: 24.02%
[rank2]:2025-11-04 11:39:25,736 - INFO - Avg. fwd time: 14.0131 / Avg. bwd time: 30.3506 / Avg. batch time: 465.2011 (ms) / GPU bubble ratio: 23.71%
[rank3]:2025-11-04 11:39:25,721 - INFO - Avg. fwd time: 15.6884 / Avg. bwd time: 34.6731 / Avg. batch time: 418.6009 (ms) / GPU bubble ratio: 3.75%
[rank0]:2025-11-04 11:39:25,773 - INFO - Avg. fwd time: 13.8473 / Avg. bwd time: 29.5986 / Avg. batch time: 565.1037 (ms) / GPU bubble ratio: 38.49%
[rank2]:2025-11-04 11:39:25,869 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0909  memory: 38.91GiB(27.83%)  tps: 9,065  tflops: 422.79  mfu: 42.75%
[rank2]:2025-11-04 11:39:25,869 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-04 11:39:25,859 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,065  tflops: 422.80  mfu: 42.75%
[rank1]:2025-11-04 11:39:25,859 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 11:39:25,861 - INFO -  step: 800  loss:  0.2990  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,065  tflops: 422.81  mfu: 42.75%
[rank3]:2025-11-04 11:39:25,861 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 11:39:25,882 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0909  memory: 58.45GiB(41.81%)  tps: 9,066  tflops: 422.83  mfu: 42.75%
[rank0]:2025-11-04 11:39:25,882 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-04 11:39:42,461 - INFO - validate step: 800  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,706
[rank1]:2025-11-04 11:39:42,493 - INFO - validate step: 800  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,625
[rank1]:2025-11-04 11:39:42,583 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1139_stage1_step800.svg
[rank2]:2025-11-04 11:39:42,510 - INFO - validate step: 800  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,614
[rank2]:2025-11-04 11:39:42,583 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1139_stage2_step800.svg
[rank3]:2025-11-04 11:39:42,528 - INFO - validate step: 800  loss:  0.2474  memory: 47.72GiB(34.13%)  tps: 24,576
[rank0]:2025-11-04 11:39:42,583 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1139_stage0_step800.svg
[rank3]:2025-11-04 11:39:42,662 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1139_real_step800_rank3.svg
[rank3]:> Batch Time: 431.70 ms, GPU Bubble Ratio: 48.44%, 33.53%, 36.22%, 29.57%
[rank3]:2025-11-04 11:39:42,707 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1139_stage3_step800.svg
[rank0]:2025-11-04 11:41:11,460 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 11:41:13,121 - INFO - Avg. fwd time: 15.9903 / Avg. bwd time: 32.2184 / Avg. batch time: 508.3024 (ms) / GPU bubble ratio: 24.13%
[rank2]:2025-11-04 11:41:13,116 - INFO - Avg. fwd time: 14.1030 / Avg. bwd time: 29.6474 / Avg. batch time: 458.4676 (ms) / GPU bubble ratio: 23.66%
[rank3]:2025-11-04 11:41:13,101 - INFO - Avg. fwd time: 15.7944 / Avg. bwd time: 33.8066 / Avg. batch time: 412.5069 (ms) / GPU bubble ratio: 3.81%
[rank0]:2025-11-04 11:41:13,151 - INFO - Avg. fwd time: 13.9132 / Avg. bwd time: 28.6096 / Avg. batch time: 556.9644 (ms) / GPU bubble ratio: 38.92%
[rank1]:2025-11-04 11:41:13,238 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,027  tflops: 421.04  mfu: 42.57%
[rank2]:2025-11-04 11:41:13,247 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0744  memory: 38.91GiB(27.83%)  tps: 9,028  tflops: 421.08  mfu: 42.58%
[rank3]:2025-11-04 11:41:13,240 - INFO -  step: 850  loss:  0.1217  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,031  tflops: 421.21  mfu: 42.59%
[rank0]:2025-11-04 11:41:13,264 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0744  memory: 58.45GiB(41.81%)  tps: 9,022  tflops: 420.78  mfu: 42.55%
[rank0]:2025-11-04 11:42:40,808 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 11:42:42,544 - INFO - Avg. fwd time: 15.8757 / Avg. bwd time: 33.0374 / Avg. batch time: 406.9923 (ms) / GPU bubble ratio: 3.85%
[rank1]:2025-11-04 11:42:42,599 - INFO - Avg. fwd time: 16.0672 / Avg. bwd time: 31.4214 / Avg. batch time: 501.3522 (ms) / GPU bubble ratio: 24.22%
[rank2]:2025-11-04 11:42:42,572 - INFO - Avg. fwd time: 14.1704 / Avg. bwd time: 29.0370 / Avg. batch time: 452.3225 (ms) / GPU bubble ratio: 23.58%
[rank3]:2025-11-04 11:42:42,641 - INFO -  step: 900  loss:  0.1889  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,163  tflops: 427.38  mfu: 43.21%
[rank0]:2025-11-04 11:42:42,633 - INFO - Avg. fwd time: 13.9627 / Avg. bwd time: 27.7120 / Avg. batch time: 549.5505 (ms) / GPU bubble ratio: 39.33%
[rank0]:2025-11-04 11:42:42,665 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0562  memory: 58.45GiB(41.81%)  tps: 9,163  tflops: 427.38  mfu: 43.21%
[rank1]:2025-11-04 11:42:42,639 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,163  tflops: 427.38  mfu: 43.21%
[rank1]:2025-11-04 11:42:42,712 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1142_stage1_step900.svg
[rank2]:2025-11-04 11:42:42,647 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0562  memory: 38.91GiB(27.83%)  tps: 9,163  tflops: 427.38  mfu: 43.21%
[rank2]:2025-11-04 11:42:42,712 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1142_stage2_step900.svg
[rank0]:2025-11-04 11:42:42,712 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1142_stage0_step900.svg
[rank3]:2025-11-04 11:42:42,799 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1142_real_step900_rank3.svg
[rank3]:> Batch Time: 431.66 ms, GPU Bubble Ratio: 49.37%, 33.57%, 36.41%, 29.71%
[rank3]:2025-11-04 11:42:42,839 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1142_stage3_step900.svg
[rank0]:2025-11-04 11:44:11,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:44:12,772 - INFO - Avg. fwd time: 14.2249 / Avg. bwd time: 28.5693 / Avg. batch time: 447.6506 (ms) / GPU bubble ratio: 23.52%
[rank1]:2025-11-04 11:44:12,778 - INFO - Avg. fwd time: 16.1292 / Avg. bwd time: 30.8095 / Avg. batch time: 496.0598 (ms) / GPU bubble ratio: 24.30%
[rank3]:2025-11-04 11:44:12,757 - INFO - Avg. fwd time: 15.9438 / Avg. bwd time: 32.4428 / Avg. batch time: 402.7732 (ms) / GPU bubble ratio: 3.89%
[rank0]:2025-11-04 11:44:12,809 - INFO - Avg. fwd time: 14.0042 / Avg. bwd time: 27.0367 / Avg. batch time: 543.9200 (ms) / GPU bubble ratio: 39.64%
[rank2]:2025-11-04 11:44:12,908 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0889  memory: 38.91GiB(27.83%)  tps: 9,076  tflops: 423.30  mfu: 42.80%
[rank1]:2025-11-04 11:44:12,897 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,076  tflops: 423.32  mfu: 42.80%
[rank3]:2025-11-04 11:44:12,898 - INFO -  step: 950  loss:  0.2642  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,076  tflops: 423.33  mfu: 42.80%
[rank0]:2025-11-04 11:44:12,920 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0889  memory: 58.45GiB(41.81%)  tps: 9,076  tflops: 423.33  mfu: 42.80%
[rank0]:2025-11-04 11:45:42,215 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:45:43,891 - INFO - Avg. fwd time: 14.2836 / Avg. bwd time: 28.0748 / Avg. batch time: 442.8948 (ms) / GPU bubble ratio: 23.49%
[rank3]:2025-11-04 11:45:43,876 - INFO - Avg. fwd time: 16.0197 / Avg. bwd time: 31.8330 / Avg. batch time: 398.4941 (ms) / GPU bubble ratio: 3.93%
[rank0]:2025-11-04 11:45:43,925 - INFO - Avg. fwd time: 14.0539 / Avg. bwd time: 26.3090 / Avg. batch time: 538.1583 (ms) / GPU bubble ratio: 40.00%
[rank1]:2025-11-04 11:45:43,896 - INFO - Avg. fwd time: 16.1987 / Avg. bwd time: 30.1709 / Avg. batch time: 490.6602 (ms) / GPU bubble ratio: 24.40%
[rank2]:2025-11-04 11:45:44,023 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0623  memory: 38.91GiB(27.83%)  tps: 8,991  tflops: 419.33  mfu: 42.40%
[rank2]:2025-11-04 11:45:44,023 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 11:45:44,013 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,991  tflops: 419.33  mfu: 42.40%
[rank1]:2025-11-04 11:45:44,013 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-04 11:45:44,015 - INFO -  step: 1000  loss:  0.1603  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,991  tflops: 419.34  mfu: 42.40%
[rank3]:2025-11-04 11:45:44,016 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 11:45:44,041 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0623  memory: 58.45GiB(41.81%)  tps: 8,990  tflops: 419.31  mfu: 42.40%
[rank0]:2025-11-04 11:45:44,041 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 11:46:00,624 - INFO - validate step: 1000  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,702
[rank2]:2025-11-04 11:46:00,670 - INFO - validate step: 1000  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,605
[rank1]:2025-11-04 11:46:00,655 - INFO - validate step: 1000  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,613
[rank3]:2025-11-04 11:46:00,689 - INFO - validate step: 1000  loss:  0.2466  memory: 47.72GiB(34.13%)  tps: 24,567
[rank0]:2025-11-04 11:46:00,739 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1146_stage0_step1000.svg
[rank2]:2025-11-04 11:46:00,735 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1146_stage2_step1000.svg
[rank1]:2025-11-04 11:46:00,740 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1146_stage1_step1000.svg
[rank3]:2025-11-04 11:46:00,824 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1146_real_step1000_rank3.svg
[rank3]:> Batch Time: 433.38 ms, GPU Bubble Ratio: 48.34%, 33.57%, 36.71%, 29.64%
[rank3]:2025-11-04 11:46:00,866 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1146_stage3_step1000.svg
[rank0]:2025-11-04 11:47:29,416 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 11:47:31,257 - INFO - Avg. fwd time: 16.2583 / Avg. bwd time: 29.5930 / Avg. batch time: 485.7514 (ms) / GPU bubble ratio: 24.49%
[rank2]:2025-11-04 11:47:31,230 - INFO - Avg. fwd time: 14.3330 / Avg. bwd time: 27.6340 / Avg. batch time: 438.5644 (ms) / GPU bubble ratio: 23.45%
[rank3]:2025-11-04 11:47:31,200 - INFO - Avg. fwd time: 16.0837 / Avg. bwd time: 31.2800 / Avg. batch time: 394.5751 (ms) / GPU bubble ratio: 3.97%
[rank0]:2025-11-04 11:47:31,291 - INFO - Avg. fwd time: 14.0920 / Avg. bwd time: 25.6559 / Avg. batch time: 532.9156 (ms) / GPU bubble ratio: 40.33%
[rank1]:2025-11-04 11:47:31,298 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,038  tflops: 421.52  mfu: 42.62%
[rank2]:2025-11-04 11:47:31,306 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1129  memory: 38.91GiB(27.83%)  tps: 9,038  tflops: 421.55  mfu: 42.62%
[rank3]:2025-11-04 11:47:31,299 - INFO -  step: 1050  loss:  0.2663  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,041  tflops: 421.68  mfu: 42.64%
[rank0]:2025-11-04 11:47:31,323 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.1129  memory: 58.45GiB(41.81%)  tps: 9,032  tflops: 421.26  mfu: 42.59%
[rank0]:2025-11-04 11:49:01,048 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 11:49:02,725 - INFO - Avg. fwd time: 16.3169 / Avg. bwd time: 29.1469 / Avg. batch time: 482.0645 (ms) / GPU bubble ratio: 24.55%
[rank2]:2025-11-04 11:49:02,717 - INFO - Avg. fwd time: 14.3811 / Avg. bwd time: 27.2972 / Avg. batch time: 435.3206 (ms) / GPU bubble ratio: 23.41%
[rank3]:2025-11-04 11:49:02,704 - INFO - Avg. fwd time: 16.1487 / Avg. bwd time: 30.8529 / Avg. batch time: 391.6756 (ms) / GPU bubble ratio: 4.00%
[rank0]:2025-11-04 11:49:02,748 - INFO - Avg. fwd time: 14.1305 / Avg. bwd time: 25.1307 / Avg. batch time: 528.8909 (ms) / GPU bubble ratio: 40.61%
[rank1]:2025-11-04 11:49:02,833 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,950  tflops: 417.41  mfu: 42.21%
[rank2]:2025-11-04 11:49:02,842 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0667  memory: 38.91GiB(27.83%)  tps: 8,950  tflops: 417.41  mfu: 42.20%
[rank3]:2025-11-04 11:49:02,835 - INFO -  step: 1100  loss:  0.2338  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,950  tflops: 417.41  mfu: 42.21%
[rank0]:2025-11-04 11:49:02,858 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0667  memory: 58.45GiB(41.81%)  tps: 8,950  tflops: 417.41  mfu: 42.21%
[rank1]:2025-11-04 11:49:02,908 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1149_stage1_step1100.svg
[rank2]:2025-11-04 11:49:02,904 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1149_stage2_step1100.svg
[rank0]:2025-11-04 11:49:02,905 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1149_stage0_step1100.svg
[rank3]:2025-11-04 11:49:02,995 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1149_real_step1100_rank3.svg
[rank3]:> Batch Time: 431.77 ms, GPU Bubble Ratio: 48.44%, 32.45%, 35.59%, 28.25%
[rank3]:2025-11-04 11:49:03,037 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1149_stage3_step1100.svg
[rank0]:2025-11-04 11:50:31,664 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 11:50:33,339 - INFO - Avg. fwd time: 16.3693 / Avg. bwd time: 28.6652 / Avg. batch time: 477.9362 (ms) / GPU bubble ratio: 24.62%
[rank2]:2025-11-04 11:50:33,333 - INFO - Avg. fwd time: 14.4244 / Avg. bwd time: 26.9341 / Avg. batch time: 431.6775 (ms) / GPU bubble ratio: 23.35%
[rank3]:2025-11-04 11:50:33,317 - INFO - Avg. fwd time: 16.2054 / Avg. bwd time: 30.3859 / Avg. batch time: 388.3881 (ms) / GPU bubble ratio: 4.03%
[rank0]:2025-11-04 11:50:33,370 - INFO - Avg. fwd time: 14.1644 / Avg. bwd time: 24.5772 / Avg. batch time: 524.4687 (ms) / GPU bubble ratio: 40.91%
[rank1]:2025-11-04 11:50:33,454 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,040  tflops: 421.62  mfu: 42.63%
[rank2]:2025-11-04 11:50:33,465 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0988  memory: 38.91GiB(27.83%)  tps: 9,040  tflops: 421.61  mfu: 42.63%
[rank3]:2025-11-04 11:50:33,456 - INFO -  step: 1150  loss:  0.2276  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,040  tflops: 421.63  mfu: 42.63%
[rank0]:2025-11-04 11:50:33,478 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0988  memory: 58.45GiB(41.81%)  tps: 9,040  tflops: 421.63  mfu: 42.63%
[rank0]:2025-11-04 11:52:02,284 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:52:04,086 - INFO - Avg. fwd time: 14.4676 / Avg. bwd time: 26.5872 / Avg. batch time: 428.3568 (ms) / GPU bubble ratio: 23.33%
[rank1]:2025-11-04 11:52:04,115 - INFO - Avg. fwd time: 16.4166 / Avg. bwd time: 28.2272 / Avg. batch time: 474.1773 (ms) / GPU bubble ratio: 24.68%
[rank3]:2025-11-04 11:52:04,055 - INFO - Avg. fwd time: 16.2565 / Avg. bwd time: 29.9607 / Avg. batch time: 385.3901 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-04 11:52:04,164 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0640  memory: 38.91GiB(27.83%)  tps: 9,032  tflops: 421.26  mfu: 42.59%
[rank1]:2025-11-04 11:52:04,156 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,032  tflops: 421.24  mfu: 42.59%
[rank2]:2025-11-04 11:52:04,164 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 11:52:04,156 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-04 11:52:04,158 - INFO -  step: 1200  loss:  0.2868  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,032  tflops: 421.25  mfu: 42.59%
[rank3]:2025-11-04 11:52:04,158 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 11:52:04,150 - INFO - Avg. fwd time: 14.1955 / Avg. bwd time: 24.0765 / Avg. batch time: 520.4676 (ms) / GPU bubble ratio: 41.17%
[rank0]:2025-11-04 11:52:04,180 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0640  memory: 58.45GiB(41.81%)  tps: 9,032  tflops: 421.24  mfu: 42.59%
[rank0]:2025-11-04 11:52:04,180 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 11:52:20,780 - INFO - validate step: 1200  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,640
[rank1]:2025-11-04 11:52:20,781 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 11:52:20,796 - INFO - validate step: 1200  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,627
[rank2]:2025-11-04 11:52:20,797 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 11:52:20,814 - INFO - validate step: 1200  loss:  0.2491  memory: 47.72GiB(34.13%)  tps: 24,593
[rank3]:2025-11-04 11:52:20,815 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 11:52:20,750 - INFO - validate step: 1200  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,720
[rank0]:2025-11-04 11:52:20,751 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 11:52:20,756 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-04 11:52:31,272 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.47 seconds.
[rank3]:2025-11-04 11:52:32,835 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.02 seconds.
[rank1]:2025-11-04 11:52:32,920 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.14 seconds.
[rank0]:2025-11-04 11:52:34,297 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 11:52:34,304 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.55 seconds.
[rank1]:2025-11-04 11:52:34,365 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1152_stage1_step1200.svg
[rank2]:2025-11-04 11:52:34,360 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1152_stage2_step1200.svg
[rank0]:2025-11-04 11:52:34,427 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1152_stage0_step1200.svg
[rank3]:2025-11-04 11:52:34,530 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1152_real_step1200_rank3.svg
[rank3]:> Batch Time: 435.22 ms, GPU Bubble Ratio: 47.10%, 33.44%, 36.78%, 29.56%
[rank3]:2025-11-04 11:52:34,602 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1152_stage3_step1200.svg
[rank0]:2025-11-04 11:54:05,602 - INFO - [GC] Peforming periodical GC collection 1.73 seconds
[rank2]:2025-11-04 11:54:07,282 - INFO - Avg. fwd time: 14.4968 / Avg. bwd time: 26.3111 / Avg. batch time: 425.8616 (ms) / GPU bubble ratio: 23.34%
[rank1]:2025-11-04 11:54:07,287 - INFO - Avg. fwd time: 16.4521 / Avg. bwd time: 27.8785 / Avg. batch time: 471.3321 (ms) / GPU bubble ratio: 24.76%
[rank3]:2025-11-04 11:54:07,268 - INFO - Avg. fwd time: 16.2947 / Avg. bwd time: 29.6427 / Avg. batch time: 383.1471 (ms) / GPU bubble ratio: 4.08%
[rank0]:2025-11-04 11:54:07,318 - INFO - Avg. fwd time: 14.2246 / Avg. bwd time: 23.6662 / Avg. batch time: 517.4420 (ms) / GPU bubble ratio: 41.42%
[rank2]:2025-11-04 11:54:07,414 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1098  memory: 38.91GiB(27.83%)  tps: 7,684  tflops: 358.36  mfu: 36.23%
[rank1]:2025-11-04 11:54:07,403 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 7,683  tflops: 358.34  mfu: 36.23%
[rank3]:2025-11-04 11:54:07,404 - INFO -  step: 1250  loss:  0.2767  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 7,686  tflops: 358.46  mfu: 36.24%
[rank0]:2025-11-04 11:54:07,430 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1098  memory: 58.45GiB(41.81%)  tps: 7,679  tflops: 358.15  mfu: 36.21%
[rank0]:2025-11-04 11:55:36,076 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 11:55:37,751 - INFO - Avg. fwd time: 16.4928 / Avg. bwd time: 27.5039 / Avg. batch time: 468.0777 (ms) / GPU bubble ratio: 24.80%
[rank2]:2025-11-04 11:55:37,746 - INFO - Avg. fwd time: 14.5304 / Avg. bwd time: 26.0263 / Avg. batch time: 422.9821 (ms) / GPU bubble ratio: 23.29%
[rank3]:2025-11-04 11:55:37,731 - INFO - Avg. fwd time: 16.3377 / Avg. bwd time: 29.2756 / Avg. batch time: 380.5496 (ms) / GPU bubble ratio: 4.11%
[rank0]:2025-11-04 11:55:37,779 - INFO - Avg. fwd time: 14.2549 / Avg. bwd time: 23.2272 / Avg. batch time: 513.9789 (ms) / GPU bubble ratio: 41.66%
[rank1]:2025-11-04 11:55:37,862 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,056  tflops: 422.38  mfu: 42.71%
[rank2]:2025-11-04 11:55:37,873 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0564  memory: 38.91GiB(27.83%)  tps: 9,056  tflops: 422.38  mfu: 42.71%
[rank3]:2025-11-04 11:55:37,863 - INFO -  step: 1300  loss:  0.1845  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,056  tflops: 422.38  mfu: 42.71%
[rank0]:2025-11-04 11:55:37,890 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0564  memory: 58.45GiB(41.81%)  tps: 9,056  tflops: 422.37  mfu: 42.71%
[rank2]:2025-11-04 11:55:37,941 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1155_stage2_step1300.svg
[rank1]:2025-11-04 11:55:37,941 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1155_stage1_step1300.svg
[rank0]:2025-11-04 11:55:37,940 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1155_stage0_step1300.svg
[rank3]:2025-11-04 11:55:38,027 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1155_real_step1300_rank3.svg
[rank3]:> Batch Time: 426.97 ms, GPU Bubble Ratio: 49.05%, 32.92%, 35.62%, 29.17%
[rank3]:2025-11-04 11:55:38,071 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1155_stage3_step1300.svg
[rank0]:2025-11-04 11:57:07,680 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:57:09,450 - INFO - Avg. fwd time: 14.5653 / Avg. bwd time: 25.7551 / Avg. batch time: 420.4624 (ms) / GPU bubble ratio: 23.28%
[rank1]:2025-11-04 11:57:09,479 - INFO - Avg. fwd time: 16.5342 / Avg. bwd time: 27.1628 / Avg. batch time: 465.2221 (ms) / GPU bubble ratio: 24.86%
[rank3]:2025-11-04 11:57:09,420 - INFO - Avg. fwd time: 16.3828 / Avg. bwd time: 28.9475 / Avg. batch time: 378.2825 (ms) / GPU bubble ratio: 4.13%
[rank2]:2025-11-04 11:57:09,530 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0749  memory: 38.91GiB(27.83%)  tps: 8,938  tflops: 416.85  mfu: 42.15%
[rank1]:2025-11-04 11:57:09,521 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,937  tflops: 416.85  mfu: 42.15%
[rank3]:2025-11-04 11:57:09,522 - INFO -  step: 1350  loss:  0.1278  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,938  tflops: 416.85  mfu: 42.15%
[rank0]:2025-11-04 11:57:09,515 - INFO - Avg. fwd time: 14.2822 / Avg. bwd time: 22.8298 / Avg. batch time: 510.9167 (ms) / GPU bubble ratio: 41.89%
[rank0]:2025-11-04 11:57:09,544 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0749  memory: 58.45GiB(41.81%)  tps: 8,938  tflops: 416.87  mfu: 42.15%
[rank0]:2025-11-04 11:58:38,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 11:58:40,017 - INFO - Avg. fwd time: 14.5889 / Avg. bwd time: 25.5443 / Avg. batch time: 418.3428 (ms) / GPU bubble ratio: 23.25%
[rank1]:2025-11-04 11:58:40,021 - INFO - Avg. fwd time: 16.5630 / Avg. bwd time: 26.8879 / Avg. batch time: 462.8282 (ms) / GPU bubble ratio: 24.90%
[rank0]:2025-11-04 11:58:40,050 - INFO - Avg. fwd time: 14.3022 / Avg. bwd time: 22.5199 / Avg. batch time: 508.3568 (ms) / GPU bubble ratio: 42.05%
[rank3]:2025-11-04 11:58:40,001 - INFO - Avg. fwd time: 16.4125 / Avg. bwd time: 28.6790 / Avg. batch time: 376.3682 (ms) / GPU bubble ratio: 4.15%
[rank2]:2025-11-04 11:58:40,149 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1141  memory: 38.91GiB(27.83%)  tps: 9,040  tflops: 421.63  mfu: 42.63%
[rank2]:2025-11-04 11:58:40,149 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 11:58:40,141 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1141  memory: 48.02GiB(34.34%)  tps: 9,040  tflops: 421.62  mfu: 42.63%
[rank1]:2025-11-04 11:58:40,141 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-04 11:58:40,140 - INFO -  step: 1400  loss:  0.3783  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,040  tflops: 421.64  mfu: 42.63%
[rank3]:2025-11-04 11:58:40,141 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 11:58:40,169 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1141  memory: 58.45GiB(41.81%)  tps: 9,039  tflops: 421.60  mfu: 42.63%
[rank0]:2025-11-04 11:58:40,169 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 11:58:56,823 - INFO - validate step: 1400  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,555
[rank2]:2025-11-04 11:58:56,840 - INFO - validate step: 1400  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,542
[rank3]:2025-11-04 11:58:56,854 - INFO - validate step: 1400  loss:  0.2553  memory: 47.72GiB(34.13%)  tps: 24,508
[rank0]:2025-11-04 11:58:56,790 - INFO - validate step: 1400  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,645
[rank2]:2025-11-04 11:58:56,908 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1158_stage2_step1400.svg
[rank1]:2025-11-04 11:58:56,909 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1158_stage1_step1400.svg
[rank0]:2025-11-04 11:58:56,908 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1158_stage0_step1400.svg
[rank3]:2025-11-04 11:58:56,996 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1158_real_step1400_rank3.svg
[rank3]:> Batch Time: 432.70 ms, GPU Bubble Ratio: 48.07%, 32.97%, 36.03%, 29.41%
[rank3]:2025-11-04 11:58:57,042 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1158_stage3_step1400.svg
[rank0]:2025-11-04 12:00:27,234 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 12:00:28,922 - INFO - Avg. fwd time: 16.6033 / Avg. bwd time: 26.5956 / Avg. batch time: 460.3924 (ms) / GPU bubble ratio: 24.94%
[rank3]:2025-11-04 12:00:28,902 - INFO - Avg. fwd time: 16.4562 / Avg. bwd time: 28.3939 / Avg. batch time: 374.4352 (ms) / GPU bubble ratio: 4.18%
[rank2]:2025-11-04 12:00:28,915 - INFO - Avg. fwd time: 14.6221 / Avg. bwd time: 25.3178 / Avg. batch time: 416.1935 (ms) / GPU bubble ratio: 23.23%
[rank1]:2025-11-04 12:00:29,038 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,884  tflops: 414.33  mfu: 41.89%
[rank0]:2025-11-04 12:00:28,955 - INFO - Avg. fwd time: 14.3310 / Avg. bwd time: 22.1864 / Avg. batch time: 505.7744 (ms) / GPU bubble ratio: 42.24%
[rank3]:2025-11-04 12:00:29,040 - INFO -  step: 1450  loss:  0.1947  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,887  tflops: 414.47  mfu: 41.91%
[rank2]:2025-11-04 12:00:29,048 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0709  memory: 38.91GiB(27.83%)  tps: 8,884  tflops: 414.37  mfu: 41.90%
[rank0]:2025-11-04 12:00:29,063 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0709  memory: 58.45GiB(41.81%)  tps: 8,878  tflops: 414.08  mfu: 41.87%
[rank0]:2025-11-04 12:01:59,889 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:02:01,690 - INFO - Avg. fwd time: 16.4987 / Avg. bwd time: 28.1382 / Avg. batch time: 372.7297 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-11-04 12:02:01,723 - INFO - Avg. fwd time: 14.6534 / Avg. bwd time: 25.1104 / Avg. batch time: 414.2865 (ms) / GPU bubble ratio: 23.21%
[rank0]:2025-11-04 12:02:01,784 - INFO - Avg. fwd time: 14.3586 / Avg. bwd time: 21.8633 / Avg. batch time: 503.4442 (ms) / GPU bubble ratio: 42.44%
[rank0]:2025-11-04 12:02:01,818 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1110  memory: 58.45GiB(41.81%)  tps: 8,832  tflops: 411.92  mfu: 41.65%
[rank3]:2025-11-04 12:02:01,792 - INFO -  step: 1500  loss:  0.2686  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,832  tflops: 411.94  mfu: 41.65%
[rank2]:2025-11-04 12:02:01,799 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1110  memory: 38.91GiB(27.83%)  tps: 8,832  tflops: 411.94  mfu: 41.65%
[rank1]:2025-11-04 12:02:01,753 - INFO - Avg. fwd time: 16.6417 / Avg. bwd time: 26.3221 / Avg. batch time: 458.2253 (ms) / GPU bubble ratio: 24.99%
[rank1]:2025-11-04 12:02:01,791 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,832  tflops: 411.93  mfu: 41.65%
[rank0]:2025-11-04 12:02:01,869 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1202_stage0_step1500.svg
[rank2]:2025-11-04 12:02:01,870 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1202_stage2_step1500.svg
[rank1]:2025-11-04 12:02:01,871 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1202_stage1_step1500.svg
[rank3]:2025-11-04 12:02:01,957 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1202_real_step1500_rank3.svg
[rank3]:> Batch Time: 436.53 ms, GPU Bubble Ratio: 49.44%, 32.92%, 36.20%, 28.79%
[rank3]:2025-11-04 12:02:02,003 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1202_stage3_step1500.svg
[rank0]:2025-11-04 12:03:32,534 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 12:03:34,283 - INFO - Avg. fwd time: 14.3803 / Avg. bwd time: 21.6128 / Avg. batch time: 501.5752 (ms) / GPU bubble ratio: 42.59%
[rank3]:2025-11-04 12:03:34,233 - INFO - Avg. fwd time: 16.5331 / Avg. bwd time: 27.9324 / Avg. batch time: 371.3578 (ms) / GPU bubble ratio: 4.21%
[rank1]:2025-11-04 12:03:34,253 - INFO - Avg. fwd time: 16.6731 / Avg. bwd time: 26.1026 / Avg. batch time: 456.4946 (ms) / GPU bubble ratio: 25.04%
[rank2]:2025-11-04 12:03:34,246 - INFO - Avg. fwd time: 14.6784 / Avg. bwd time: 24.9500 / Avg. batch time: 412.7703 (ms) / GPU bubble ratio: 23.20%
[rank3]:2025-11-04 12:03:34,368 - INFO -  step: 1550  loss:  0.2962  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,849  tflops: 412.72  mfu: 41.73%
[rank0]:2025-11-04 12:03:34,389 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0939  memory: 58.45GiB(41.81%)  tps: 8,850  tflops: 412.74  mfu: 41.73%
[rank2]:2025-11-04 12:03:34,377 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0939  memory: 38.91GiB(27.83%)  tps: 8,849  tflops: 412.71  mfu: 41.73%
[rank1]:2025-11-04 12:03:34,366 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,849  tflops: 412.72  mfu: 41.73%
[rank0]:2025-11-04 12:05:04,373 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 12:05:06,139 - INFO - Avg. fwd time: 14.4006 / Avg. bwd time: 21.3362 / Avg. batch time: 499.4012 (ms) / GPU bubble ratio: 42.75%
[rank3]:2025-11-04 12:05:06,095 - INFO - Avg. fwd time: 16.5648 / Avg. bwd time: 27.6993 / Avg. batch time: 369.7445 (ms) / GPU bubble ratio: 4.23%
[rank2]:2025-11-04 12:05:06,108 - INFO - Avg. fwd time: 14.7023 / Avg. bwd time: 24.7709 / Avg. batch time: 410.9686 (ms) / GPU bubble ratio: 23.16%
[rank1]:2025-11-04 12:05:06,112 - INFO - Avg. fwd time: 16.7026 / Avg. bwd time: 25.8606 / Avg. batch time: 454.4509 (ms) / GPU bubble ratio: 25.07%
[rank0]:2025-11-04 12:05:06,256 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0894  memory: 58.45GiB(41.81%)  tps: 8,917  tflops: 415.90  mfu: 42.05%
[rank0]:2025-11-04 12:05:06,256 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-04 12:05:06,230 - INFO -  step: 1600  loss:  0.4228  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,918  tflops: 415.93  mfu: 42.06%
[rank3]:2025-11-04 12:05:06,231 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 12:05:06,237 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0894  memory: 38.91GiB(27.83%)  tps: 8,918  tflops: 415.93  mfu: 42.06%
[rank2]:2025-11-04 12:05:06,237 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-04 12:05:06,229 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,918  tflops: 415.92  mfu: 42.05%
[rank1]:2025-11-04 12:05:06,229 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 12:05:22,811 - INFO - validate step: 1600  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,742
[rank3]:2025-11-04 12:05:22,874 - INFO - validate step: 1600  loss:  0.2498  memory: 47.72GiB(34.13%)  tps: 24,611
[rank2]:2025-11-04 12:05:22,859 - INFO - validate step: 1600  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,644
[rank1]:2025-11-04 12:05:22,843 - INFO - validate step: 1600  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,655
[rank0]:2025-11-04 12:05:22,930 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1205_stage0_step1600.svg
[rank2]:2025-11-04 12:05:22,930 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1205_stage2_step1600.svg
[rank1]:2025-11-04 12:05:22,931 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1205_stage1_step1600.svg
[rank3]:2025-11-04 12:05:23,011 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1205_real_step1600_rank3.svg
[rank3]:> Batch Time: 437.31 ms, GPU Bubble Ratio: 50.29%, 33.15%, 36.40%, 29.36%
[rank3]:2025-11-04 12:05:23,058 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1205_stage3_step1600.svg
[rank0]:2025-11-04 12:06:54,468 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 12:06:56,263 - INFO - Avg. fwd time: 16.5975 / Avg. bwd time: 27.4858 / Avg. batch time: 368.3507 (ms) / GPU bubble ratio: 4.26%
[rank0]:2025-11-04 12:06:56,364 - INFO - Avg. fwd time: 14.4370 / Avg. bwd time: 21.0761 / Avg. batch time: 497.5811 (ms) / GPU bubble ratio: 42.90%
[rank1]:2025-11-04 12:06:56,328 - INFO - Avg. fwd time: 16.7390 / Avg. bwd time: 25.6415 / Avg. batch time: 452.7049 (ms) / GPU bubble ratio: 25.11%
[rank1]:2025-11-04 12:06:56,371 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,759  tflops: 408.52  mfu: 41.31%
[rank2]:2025-11-04 12:06:56,296 - INFO - Avg. fwd time: 14.7368 / Avg. bwd time: 24.5989 / Avg. batch time: 409.4324 (ms) / GPU bubble ratio: 23.14%
[rank2]:2025-11-04 12:06:56,381 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0912  memory: 38.91GiB(27.83%)  tps: 8,759  tflops: 408.54  mfu: 41.31%
[rank3]:2025-11-04 12:06:56,373 - INFO -  step: 1650  loss:  0.4312  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,762  tflops: 408.65  mfu: 41.32%
[rank0]:2025-11-04 12:06:56,398 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0912  memory: 58.45GiB(41.81%)  tps: 8,753  tflops: 408.26  mfu: 41.28%
[rank0]:2025-11-04 12:08:27,185 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:08:28,892 - INFO - Avg. fwd time: 16.6236 / Avg. bwd time: 27.3145 / Avg. batch time: 367.1861 (ms) / GPU bubble ratio: 4.27%
[rank0]:2025-11-04 12:08:28,942 - INFO - Avg. fwd time: 14.4533 / Avg. bwd time: 20.8754 / Avg. batch time: 496.0003 (ms) / GPU bubble ratio: 43.02%
[rank1]:2025-11-04 12:08:28,911 - INFO - Avg. fwd time: 16.7627 / Avg. bwd time: 25.4602 / Avg. batch time: 451.2235 (ms) / GPU bubble ratio: 25.14%
[rank2]:2025-11-04 12:08:28,906 - INFO - Avg. fwd time: 14.7579 / Avg. bwd time: 24.4608 / Avg. batch time: 408.1278 (ms) / GPU bubble ratio: 23.12%
[rank3]:2025-11-04 12:08:29,026 - INFO -  step: 1700  loss:  0.4193  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,842  tflops: 412.38  mfu: 41.70%
[rank1]:2025-11-04 12:08:29,024 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,842  tflops: 412.37  mfu: 41.70%
[rank2]:2025-11-04 12:08:29,035 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0832  memory: 38.91GiB(27.83%)  tps: 8,841  tflops: 412.37  mfu: 41.70%
[rank0]:2025-11-04 12:08:29,049 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0832  memory: 58.45GiB(41.81%)  tps: 8,842  tflops: 412.38  mfu: 41.70%
[rank0]:2025-11-04 12:08:29,101 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1208_stage0_step1700.svg
[rank1]:2025-11-04 12:08:29,102 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1208_stage1_step1700.svg
[rank2]:2025-11-04 12:08:29,100 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1208_stage2_step1700.svg
[rank3]:2025-11-04 12:08:29,185 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1208_real_step1700_rank3.svg
[rank3]:> Batch Time: 437.00 ms, GPU Bubble Ratio: 48.80%, 33.18%, 35.99%, 29.38%
[rank3]:2025-11-04 12:08:29,230 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1208_stage3_step1700.svg
[rank0]:2025-11-04 12:09:59,461 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:10:01,179 - INFO - Avg. fwd time: 16.6519 / Avg. bwd time: 27.1213 / Avg. batch time: 365.8644 (ms) / GPU bubble ratio: 4.29%
[rank0]:2025-11-04 12:10:01,220 - INFO - Avg. fwd time: 14.4713 / Avg. bwd time: 20.6351 / Avg. batch time: 494.2131 (ms) / GPU bubble ratio: 43.17%
[rank1]:2025-11-04 12:10:01,198 - INFO - Avg. fwd time: 16.7882 / Avg. bwd time: 25.2588 / Avg. batch time: 449.5718 (ms) / GPU bubble ratio: 25.18%
[rank2]:2025-11-04 12:10:01,192 - INFO - Avg. fwd time: 14.7802 / Avg. bwd time: 24.3074 / Avg. batch time: 406.6729 (ms) / GPU bubble ratio: 23.11%
[rank3]:2025-11-04 12:10:01,315 - INFO -  step: 1750  loss:  0.4354  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,877  tflops: 414.01  mfu: 41.86%
[rank1]:2025-11-04 12:10:01,314 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,876  tflops: 414.00  mfu: 41.86%
[rank2]:2025-11-04 12:10:01,324 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0888  memory: 38.91GiB(27.83%)  tps: 8,877  tflops: 414.00  mfu: 41.86%
[rank0]:2025-11-04 12:10:01,340 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0888  memory: 58.45GiB(41.81%)  tps: 8,876  tflops: 413.99  mfu: 41.86%
[rank0]:2025-11-04 12:11:29,241 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:11:30,906 - INFO - Avg. fwd time: 16.6683 / Avg. bwd time: 26.9273 / Avg. batch time: 364.4385 (ms) / GPU bubble ratio: 4.30%
[rank1]:2025-11-04 12:11:30,968 - INFO - Avg. fwd time: 16.8038 / Avg. bwd time: 25.0642 / Avg. batch time: 447.7848 (ms) / GPU bubble ratio: 25.20%
[rank1]:2025-11-04 12:11:31,009 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,133  tflops: 425.97  mfu: 43.07%
[rank1]:2025-11-04 12:11:31,009 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-04 12:11:30,939 - INFO - Avg. fwd time: 14.7946 / Avg. bwd time: 24.1506 / Avg. batch time: 405.0856 (ms) / GPU bubble ratio: 23.09%
[rank2]:2025-11-04 12:11:31,017 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0474  memory: 38.91GiB(27.83%)  tps: 9,133  tflops: 425.98  mfu: 43.07%
[rank2]:2025-11-04 12:11:31,017 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-04 12:11:31,010 - INFO -  step: 1800  loss:  0.0693  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,133  tflops: 425.98  mfu: 43.07%
[rank3]:2025-11-04 12:11:31,010 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 12:11:31,002 - INFO - Avg. fwd time: 14.4827 / Avg. bwd time: 20.4110 / Avg. batch time: 492.3001 (ms) / GPU bubble ratio: 43.30%
[rank0]:2025-11-04 12:11:31,037 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0474  memory: 58.45GiB(41.81%)  tps: 9,133  tflops: 425.96  mfu: 43.07%
[rank0]:2025-11-04 12:11:31,037 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-04 12:11:47,783 - INFO - validate step: 1800  loss:  0.2452  memory: 47.72GiB(34.13%)  tps: 24,423
[rank0]:2025-11-04 12:11:47,719 - INFO - validate step: 1800  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,555
[rank1]:2025-11-04 12:11:47,751 - INFO - validate step: 1800  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,466
[rank1]:2025-11-04 12:11:47,838 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1211_stage1_step1800.svg
[rank2]:2025-11-04 12:11:47,768 - INFO - validate step: 1800  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,452
[rank2]:2025-11-04 12:11:47,836 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1211_stage2_step1800.svg
[rank0]:2025-11-04 12:11:47,835 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1211_stage0_step1800.svg
[rank3]:2025-11-04 12:11:47,924 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1211_real_step1800_rank3.svg
[rank3]:> Batch Time: 415.31 ms, GPU Bubble Ratio: 47.83%, 31.97%, 35.37%, 29.61%
[rank3]:2025-11-04 12:11:47,971 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1211_stage3_step1800.svg
[rank0]:2025-11-04 12:13:15,911 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 12:13:17,562 - INFO - Avg. fwd time: 16.6811 / Avg. bwd time: 26.7725 / Avg. batch time: 363.2988 (ms) / GPU bubble ratio: 4.31%
[rank1]:2025-11-04 12:13:17,580 - INFO - Avg. fwd time: 16.8163 / Avg. bwd time: 24.9052 / Avg. batch time: 446.3620 (ms) / GPU bubble ratio: 25.22%
[rank2]:2025-11-04 12:13:17,575 - INFO - Avg. fwd time: 14.8058 / Avg. bwd time: 24.0274 / Avg. batch time: 403.8259 (ms) / GPU bubble ratio: 23.07%
[rank0]:2025-11-04 12:13:17,610 - INFO - Avg. fwd time: 14.4909 / Avg. bwd time: 20.2255 / Avg. batch time: 490.7834 (ms) / GPU bubble ratio: 43.41%
[rank1]:2025-11-04 12:13:17,697 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1745  memory: 48.02GiB(34.34%)  tps: 9,108  tflops: 424.79  mfu: 42.95%
[rank2]:2025-11-04 12:13:17,704 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1745  memory: 38.91GiB(27.83%)  tps: 9,109  tflops: 424.83  mfu: 42.96%
[rank3]:2025-11-04 12:13:17,696 - INFO -  step: 1850  loss:  0.3740  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,111  tflops: 424.95  mfu: 42.97%
[rank0]:2025-11-04 12:13:17,722 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1745  memory: 58.45GiB(41.81%)  tps: 9,102  tflops: 424.51  mfu: 42.92%
[rank0]:2025-11-04 12:14:45,222 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 12:14:46,894 - INFO - Avg. fwd time: 14.8152 / Avg. bwd time: 23.8871 / Avg. batch time: 402.4016 (ms) / GPU bubble ratio: 23.06%
[rank3]:2025-11-04 12:14:46,881 - INFO - Avg. fwd time: 16.6926 / Avg. bwd time: 26.6021 / Avg. batch time: 362.0223 (ms) / GPU bubble ratio: 4.33%
[rank0]:2025-11-04 12:14:46,928 - INFO - Avg. fwd time: 14.4982 / Avg. bwd time: 20.0244 / Avg. batch time: 489.0682 (ms) / GPU bubble ratio: 43.53%
[rank1]:2025-11-04 12:14:46,897 - INFO - Avg. fwd time: 16.8280 / Avg. bwd time: 24.7292 / Avg. batch time: 444.7553 (ms) / GPU bubble ratio: 25.25%
[rank3]:2025-11-04 12:14:47,012 - INFO -  step: 1900  loss:  0.2031  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,172  tflops: 427.79  mfu: 43.25%
[rank0]:2025-11-04 12:14:47,038 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0281  memory: 58.45GiB(41.81%)  tps: 9,172  tflops: 427.78  mfu: 43.25%
[rank1]:2025-11-04 12:14:47,010 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,172  tflops: 427.79  mfu: 43.26%
[rank1]:2025-11-04 12:14:47,091 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1214_stage1_step1900.svg
[rank2]:2025-11-04 12:14:47,020 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0281  memory: 38.91GiB(27.83%)  tps: 9,172  tflops: 427.78  mfu: 43.25%
[rank2]:2025-11-04 12:14:47,090 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1214_stage2_step1900.svg
[rank0]:2025-11-04 12:14:47,089 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1214_stage0_step1900.svg
[rank3]:2025-11-04 12:14:47,177 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1214_real_step1900_rank3.svg
[rank3]:> Batch Time: 428.42 ms, GPU Bubble Ratio: 48.06%, 33.38%, 36.53%, 29.64%
[rank3]:2025-11-04 12:14:47,224 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1214_stage3_step1900.svg
[rank0]:2025-11-04 12:16:13,340 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 12:16:15,054 - INFO - Avg. fwd time: 14.8230 / Avg. bwd time: 23.7555 / Avg. batch time: 400.9827 (ms) / GPU bubble ratio: 23.03%
[rank3]:2025-11-04 12:16:15,020 - INFO - Avg. fwd time: 16.7021 / Avg. bwd time: 26.4314 / Avg. batch time: 360.7272 (ms) / GPU bubble ratio: 4.34%
[rank0]:2025-11-04 12:16:15,114 - INFO - Avg. fwd time: 14.5023 / Avg. bwd time: 19.8355 / Avg. batch time: 487.3303 (ms) / GPU bubble ratio: 43.63%
[rank1]:2025-11-04 12:16:15,085 - INFO - Avg. fwd time: 16.8382 / Avg. bwd time: 24.5616 / Avg. batch time: 443.1640 (ms) / GPU bubble ratio: 25.27%
[rank1]:2025-11-04 12:16:15,121 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,297  tflops: 433.63  mfu: 43.85%
[rank2]:2025-11-04 12:16:15,130 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0319  memory: 38.91GiB(27.83%)  tps: 9,297  tflops: 433.64  mfu: 43.85%
[rank3]:2025-11-04 12:16:15,122 - INFO -  step: 1950  loss:  0.1665  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,298  tflops: 433.64  mfu: 43.85%
[rank0]:2025-11-04 12:16:15,146 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0319  memory: 58.45GiB(41.81%)  tps: 9,298  tflops: 433.65  mfu: 43.85%
[rank0]:2025-11-04 12:17:42,002 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:17:43,662 - INFO - Avg. fwd time: 16.7096 / Avg. bwd time: 26.2956 / Avg. batch time: 359.6965 (ms) / GPU bubble ratio: 4.35%
[rank0]:2025-11-04 12:17:43,711 - INFO - Avg. fwd time: 14.5064 / Avg. bwd time: 19.6871 / Avg. batch time: 485.9622 (ms) / GPU bubble ratio: 43.71%
[rank1]:2025-11-04 12:17:43,680 - INFO - Avg. fwd time: 16.8462 / Avg. bwd time: 24.4244 / Avg. batch time: 441.8749 (ms) / GPU bubble ratio: 25.28%
[rank2]:2025-11-04 12:17:43,676 - INFO - Avg. fwd time: 14.8290 / Avg. bwd time: 23.6524 / Avg. batch time: 399.8356 (ms) / GPU bubble ratio: 23.01%
[rank1]:2025-11-04 12:17:43,793 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,239  tflops: 430.89  mfu: 43.57%
[rank1]:2025-11-04 12:17:43,793 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-04 12:17:43,801 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0448  memory: 38.91GiB(27.83%)  tps: 9,239  tflops: 430.89  mfu: 43.57%
[rank2]:2025-11-04 12:17:43,802 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-04 12:17:43,794 - INFO -  step: 2000  loss:  0.2018  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,239  tflops: 430.89  mfu: 43.57%
[rank3]:2025-11-04 12:17:43,795 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 12:17:43,817 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0448  memory: 58.45GiB(41.81%)  tps: 9,239  tflops: 430.89  mfu: 43.57%
[rank0]:2025-11-04 12:17:43,817 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-04 12:18:00,424 - INFO - validate step: 2000  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,664
[rank1]:2025-11-04 12:18:00,458 - INFO - validate step: 2000  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,579
[rank3]:2025-11-04 12:18:00,488 - INFO - validate step: 2000  loss:  0.2399  memory: 47.72GiB(34.13%)  tps: 24,539
[rank1]:2025-11-04 12:18:00,544 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1218_stage1_step2000.svg
[rank2]:2025-11-04 12:18:00,474 - INFO - validate step: 2000  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,568
[rank2]:2025-11-04 12:18:00,542 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1218_stage2_step2000.svg
[rank0]:2025-11-04 12:18:00,540 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1218_stage0_step2000.svg
[rank3]:2025-11-04 12:18:00,627 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1218_real_step2000_rank3.svg
[rank3]:> Batch Time: 427.47 ms, GPU Bubble Ratio: 47.89%, 33.41%, 36.42%, 29.63%
[rank3]:2025-11-04 12:18:00,675 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1218_stage3_step2000.svg
[rank0]:2025-11-04 12:19:27,818 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 12:19:29,457 - INFO - Avg. fwd time: 16.7189 / Avg. bwd time: 26.1481 / Avg. batch time: 358.5860 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-11-04 12:19:29,470 - INFO - Avg. fwd time: 14.8360 / Avg. bwd time: 23.5406 / Avg. batch time: 398.6058 (ms) / GPU bubble ratio: 22.98%
[rank1]:2025-11-04 12:19:29,475 - INFO - Avg. fwd time: 16.8554 / Avg. bwd time: 24.2719 / Avg. batch time: 440.4903 (ms) / GPU bubble ratio: 25.31%
[rank0]:2025-11-04 12:19:29,502 - INFO - Avg. fwd time: 14.5121 / Avg. bwd time: 19.5235 / Avg. batch time: 484.5016 (ms) / GPU bubble ratio: 43.80%
[rank2]:2025-11-04 12:19:29,596 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0841  memory: 38.91GiB(27.83%)  tps: 9,192  tflops: 428.71  mfu: 43.35%
[rank1]:2025-11-04 12:19:29,585 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,191  tflops: 428.69  mfu: 43.35%
[rank3]:2025-11-04 12:19:29,587 - INFO -  step: 2050  loss:  0.2231  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,195  tflops: 428.83  mfu: 43.36%
[rank0]:2025-11-04 12:19:29,612 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0841  memory: 58.45GiB(41.81%)  tps: 9,185  tflops: 428.40  mfu: 43.32%
[rank0]:2025-11-04 12:20:56,579 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:20:58,298 - INFO - Avg. fwd time: 16.7272 / Avg. bwd time: 26.0055 / Avg. batch time: 357.5072 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-11-04 12:20:58,333 - INFO - Avg. fwd time: 14.8437 / Avg. bwd time: 23.4279 / Avg. batch time: 397.4050 (ms) / GPU bubble ratio: 22.96%
[rank2]:2025-11-04 12:20:58,418 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0435  memory: 38.91GiB(27.83%)  tps: 9,223  tflops: 430.16  mfu: 43.49%
[rank1]:2025-11-04 12:20:58,366 - INFO - Avg. fwd time: 16.8641 / Avg. bwd time: 24.1274 / Avg. batch time: 439.1396 (ms) / GPU bubble ratio: 25.32%
[rank1]:2025-11-04 12:20:58,412 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,223  tflops: 430.14  mfu: 43.49%
[rank3]:2025-11-04 12:20:58,413 - INFO -  step: 2100  loss:  0.2283  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,223  tflops: 430.15  mfu: 43.49%
[rank0]:2025-11-04 12:20:58,405 - INFO - Avg. fwd time: 14.5175 / Avg. bwd time: 19.3579 / Avg. batch time: 483.0713 (ms) / GPU bubble ratio: 43.90%
[rank0]:2025-11-04 12:20:58,440 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0435  memory: 58.45GiB(41.81%)  tps: 9,222  tflops: 430.13  mfu: 43.49%
[rank2]:2025-11-04 12:20:58,487 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1220_stage2_step2100.svg
[rank1]:2025-11-04 12:20:58,488 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1220_stage1_step2100.svg
[rank0]:2025-11-04 12:20:58,488 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1220_stage0_step2100.svg
[rank3]:2025-11-04 12:20:58,577 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1220_real_step2100_rank3.svg
[rank3]:> Batch Time: 428.47 ms, GPU Bubble Ratio: 48.66%, 33.12%, 36.98%, 29.47%
[rank3]:2025-11-04 12:20:58,619 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1220_stage3_step2100.svg
[rank0]:2025-11-04 12:22:25,536 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 12:22:27,171 - INFO - Avg. fwd time: 14.8514 / Avg. bwd time: 23.3338 / Avg. batch time: 396.4350 (ms) / GPU bubble ratio: 22.94%
[rank1]:2025-11-04 12:22:27,173 - INFO - Avg. fwd time: 16.8712 / Avg. bwd time: 24.0087 / Avg. batch time: 438.0487 (ms) / GPU bubble ratio: 25.34%
[rank3]:2025-11-04 12:22:27,158 - INFO - Avg. fwd time: 16.7339 / Avg. bwd time: 25.8888 / Avg. batch time: 356.6236 (ms) / GPU bubble ratio: 4.39%
[rank0]:2025-11-04 12:22:27,198 - INFO - Avg. fwd time: 14.5211 / Avg. bwd time: 19.2233 / Avg. batch time: 481.9096 (ms) / GPU bubble ratio: 43.98%
[rank2]:2025-11-04 12:22:27,290 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0347  memory: 38.91GiB(27.83%)  tps: 9,218  tflops: 429.92  mfu: 43.47%
[rank1]:2025-11-04 12:22:27,283 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,218  tflops: 429.92  mfu: 43.47%
[rank3]:2025-11-04 12:22:27,284 - INFO -  step: 2150  loss:  0.1850  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,218  tflops: 429.93  mfu: 43.47%
[rank0]:2025-11-04 12:22:27,307 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0347  memory: 58.45GiB(41.81%)  tps: 9,218  tflops: 429.94  mfu: 43.47%
[rank0]:2025-11-04 12:23:54,329 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:23:55,972 - INFO - Avg. fwd time: 16.7413 / Avg. bwd time: 25.7614 / Avg. batch time: 355.6587 (ms) / GPU bubble ratio: 4.40%
[rank0]:2025-11-04 12:23:56,021 - INFO - Avg. fwd time: 14.5251 / Avg. bwd time: 19.0734 / Avg. batch time: 480.6242 (ms) / GPU bubble ratio: 44.08%
[rank2]:2025-11-04 12:23:55,988 - INFO - Avg. fwd time: 14.8588 / Avg. bwd time: 23.2259 / Avg. batch time: 395.3617 (ms) / GPU bubble ratio: 22.94%
[rank1]:2025-11-04 12:23:55,990 - INFO - Avg. fwd time: 16.8787 / Avg. bwd time: 23.8766 / Avg. batch time: 436.8374 (ms) / GPU bubble ratio: 25.36%
[rank0]:2025-11-04 12:23:56,132 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0358  memory: 58.45GiB(41.81%)  tps: 9,223  tflops: 430.15  mfu: 43.49%
[rank0]:2025-11-04 12:23:56,132 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-04 12:23:56,116 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0358  memory: 38.91GiB(27.83%)  tps: 9,223  tflops: 430.14  mfu: 43.49%
[rank2]:2025-11-04 12:23:56,116 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-04 12:23:56,104 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,223  tflops: 430.17  mfu: 43.50%
[rank1]:2025-11-04 12:23:56,104 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 12:23:56,105 - INFO -  step: 2200  loss:  0.1809  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,223  tflops: 430.17  mfu: 43.50%
[rank3]:2025-11-04 12:23:56,105 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 12:24:12,689 - INFO - validate step: 2200  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,740
[rank2]:2025-11-04 12:24:12,738 - INFO - validate step: 2200  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,642
[rank1]:2025-11-04 12:24:12,721 - INFO - validate step: 2200  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,649
[rank3]:2025-11-04 12:24:12,753 - INFO - validate step: 2200  loss:  0.2396  memory: 47.72GiB(34.13%)  tps: 24,606
[rank0]:2025-11-04 12:24:12,802 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1224_stage0_step2200.svg
[rank2]:2025-11-04 12:24:12,804 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1224_stage2_step2200.svg
[rank1]:2025-11-04 12:24:12,804 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1224_stage1_step2200.svg
[rank3]:2025-11-04 12:24:12,891 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1224_real_step2200_rank3.svg
[rank3]:> Batch Time: 428.66 ms, GPU Bubble Ratio: 48.17%, 33.35%, 35.36%, 29.58%
[rank3]:2025-11-04 12:24:12,934 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1224_stage3_step2200.svg
[rank0]:2025-11-04 12:25:39,868 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 12:25:41,591 - INFO - Avg. fwd time: 16.7485 / Avg. bwd time: 25.6382 / Avg. batch time: 354.7273 (ms) / GPU bubble ratio: 4.41%
[rank2]:2025-11-04 12:25:41,625 - INFO - Avg. fwd time: 14.8656 / Avg. bwd time: 23.1279 / Avg. batch time: 394.3345 (ms) / GPU bubble ratio: 22.92%
[rank1]:2025-11-04 12:25:41,658 - INFO - Avg. fwd time: 16.8859 / Avg. bwd time: 23.7503 / Avg. batch time: 435.6837 (ms) / GPU bubble ratio: 25.38%
[rank0]:2025-11-04 12:25:41,698 - INFO - Avg. fwd time: 14.5293 / Avg. bwd time: 18.9394 / Avg. batch time: 479.4005 (ms) / GPU bubble ratio: 44.15%
[rank0]:2025-11-04 12:25:41,729 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0535  memory: 58.45GiB(41.81%)  tps: 9,200  tflops: 429.11  mfu: 43.39%
[rank2]:2025-11-04 12:25:41,714 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0535  memory: 38.91GiB(27.83%)  tps: 9,207  tflops: 429.42  mfu: 43.42%
[rank1]:2025-11-04 12:25:41,704 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,206  tflops: 429.38  mfu: 43.42%
[rank3]:2025-11-04 12:25:41,706 - INFO -  step: 2250  loss:  0.2264  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,210  tflops: 429.54  mfu: 43.43%
[rank0]:2025-11-04 12:27:08,508 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:27:10,151 - INFO - Avg. fwd time: 16.7546 / Avg. bwd time: 25.5342 / Avg. batch time: 353.9412 (ms) / GPU bubble ratio: 4.42%
[rank0]:2025-11-04 12:27:10,196 - INFO - Avg. fwd time: 14.5335 / Avg. bwd time: 18.8346 / Avg. batch time: 478.3644 (ms) / GPU bubble ratio: 44.20%
[rank1]:2025-11-04 12:27:10,164 - INFO - Avg. fwd time: 16.8923 / Avg. bwd time: 23.6467 / Avg. batch time: 434.7017 (ms) / GPU bubble ratio: 25.39%
[rank2]:2025-11-04 12:27:10,160 - INFO - Avg. fwd time: 14.8707 / Avg. bwd time: 23.0479 / Avg. batch time: 393.4605 (ms) / GPU bubble ratio: 22.90%
[rank0]:2025-11-04 12:27:10,308 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0655  memory: 58.45GiB(41.81%)  tps: 9,248  tflops: 431.34  mfu: 43.61%
[rank1]:2025-11-04 12:27:10,278 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,249  tflops: 431.37  mfu: 43.62%
[rank2]:2025-11-04 12:27:10,286 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0655  memory: 38.91GiB(27.83%)  tps: 9,249  tflops: 431.38  mfu: 43.62%
[rank3]:2025-11-04 12:27:10,280 - INFO -  step: 2300  loss:  0.1980  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,249  tflops: 431.38  mfu: 43.62%
[rank0]:2025-11-04 12:27:10,356 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1227_stage0_step2300.svg
[rank1]:2025-11-04 12:27:10,357 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1227_stage1_step2300.svg
[rank2]:2025-11-04 12:27:10,355 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1227_stage2_step2300.svg
[rank3]:2025-11-04 12:27:10,448 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1227_real_step2300_rank3.svg
[rank3]:> Batch Time: 424.36 ms, GPU Bubble Ratio: 46.13%, 32.64%, 35.19%, 30.07%
[rank3]:2025-11-04 12:27:10,491 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1227_stage3_step2300.svg
[rank0]:2025-11-04 12:28:37,129 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 12:28:38,797 - INFO - Avg. fwd time: 16.8988 / Avg. bwd time: 23.5311 / Avg. batch time: 433.6188 (ms) / GPU bubble ratio: 25.41%
[rank2]:2025-11-04 12:28:38,795 - INFO - Avg. fwd time: 14.8757 / Avg. bwd time: 22.9608 / Avg. batch time: 392.4954 (ms) / GPU bubble ratio: 22.88%
[rank3]:2025-11-04 12:28:38,781 - INFO - Avg. fwd time: 16.7613 / Avg. bwd time: 25.4182 / Avg. batch time: 353.0628 (ms) / GPU bubble ratio: 4.43%
[rank0]:2025-11-04 12:28:38,828 - INFO - Avg. fwd time: 14.5390 / Avg. bwd time: 18.7066 / Avg. batch time: 477.2113 (ms) / GPU bubble ratio: 44.27%
[rank1]:2025-11-04 12:28:38,908 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,243  tflops: 431.09  mfu: 43.59%
[rank2]:2025-11-04 12:28:38,916 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0268  memory: 38.91GiB(27.83%)  tps: 9,243  tflops: 431.09  mfu: 43.59%
[rank3]:2025-11-04 12:28:38,909 - INFO -  step: 2350  loss:  0.1843  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,243  tflops: 431.10  mfu: 43.59%
[rank0]:2025-11-04 12:28:38,931 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0268  memory: 58.45GiB(41.81%)  tps: 9,244  tflops: 431.12  mfu: 43.59%
[rank0]:2025-11-04 12:30:05,944 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:30:07,685 - INFO - Avg. fwd time: 16.7677 / Avg. bwd time: 25.3121 / Avg. batch time: 352.2622 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-11-04 12:30:07,752 - INFO - Avg. fwd time: 16.9052 / Avg. bwd time: 23.4199 / Avg. batch time: 432.6151 (ms) / GPU bubble ratio: 25.43%
[rank1]:2025-11-04 12:30:07,797 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,216  tflops: 429.84  mfu: 43.46%
[rank1]:2025-11-04 12:30:07,797 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 12:30:07,720 - INFO - Avg. fwd time: 14.8806 / Avg. bwd time: 22.8805 / Avg. batch time: 391.6040 (ms) / GPU bubble ratio: 22.86%
[rank2]:2025-11-04 12:30:07,807 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0288  memory: 38.91GiB(27.83%)  tps: 9,216  tflops: 429.82  mfu: 43.46%
[rank2]:2025-11-04 12:30:07,808 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-04 12:30:07,798 - INFO -  step: 2400  loss:  0.1909  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,216  tflops: 429.84  mfu: 43.46%
[rank3]:2025-11-04 12:30:07,798 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 12:30:07,790 - INFO - Avg. fwd time: 14.5440 / Avg. bwd time: 18.5917 / Avg. batch time: 476.1430 (ms) / GPU bubble ratio: 44.33%
[rank0]:2025-11-04 12:30:07,821 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0288  memory: 58.45GiB(41.81%)  tps: 9,216  tflops: 429.83  mfu: 43.46%
[rank0]:2025-11-04 12:30:07,821 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 12:30:24,403 - INFO - validate step: 2400  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,701
[rank0]:2025-11-04 12:30:24,404 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 12:30:24,411 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-04 12:30:24,437 - INFO - validate step: 2400  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,615
[rank1]:2025-11-04 12:30:24,438 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 12:30:24,470 - INFO - validate step: 2400  loss:  0.2382  memory: 47.72GiB(34.13%)  tps: 24,569
[rank3]:2025-11-04 12:30:24,471 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 12:30:24,454 - INFO - validate step: 2400  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,606
[rank2]:2025-11-04 12:30:24,455 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 12:30:35,302 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.85 seconds.
[rank1]:2025-11-04 12:30:36,443 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.01 seconds.
[rank3]:2025-11-04 12:30:37,771 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.30 seconds.
[rank0]:2025-11-04 12:30:37,978 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 12:30:37,982 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.58 seconds.
[rank2]:2025-11-04 12:30:38,039 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1230_stage2_step2400.svg
[rank0]:2025-11-04 12:30:38,093 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1230_stage0_step2400.svg
[rank1]:2025-11-04 12:30:38,045 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1230_stage1_step2400.svg
[rank3]:2025-11-04 12:30:38,208 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1230_real_step2400_rank3.svg
[rank3]:> Batch Time: 429.59 ms, GPU Bubble Ratio: 46.34%, 33.64%, 35.55%, 30.05%
[rank3]:2025-11-04 12:30:38,293 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1230_stage3_step2400.svg
[rank0]:2025-11-04 12:32:06,207 - INFO - [GC] Peforming periodical GC collection 1.65 seconds
[rank1]:2025-11-04 12:32:07,996 - INFO - Avg. fwd time: 16.9103 / Avg. bwd time: 23.3286 / Avg. batch time: 431.7397 (ms) / GPU bubble ratio: 25.44%
[rank3]:2025-11-04 12:32:07,979 - INFO - Avg. fwd time: 16.7726 / Avg. bwd time: 25.2187 / Avg. batch time: 351.5502 (ms) / GPU bubble ratio: 4.44%
[rank2]:2025-11-04 12:32:07,992 - INFO - Avg. fwd time: 14.8847 / Avg. bwd time: 22.8098 / Avg. batch time: 390.8226 (ms) / GPU bubble ratio: 22.84%
[rank0]:2025-11-04 12:32:08,025 - INFO - Avg. fwd time: 14.5481 / Avg. bwd time: 18.4889 / Avg. batch time: 475.1984 (ms) / GPU bubble ratio: 44.38%
[rank1]:2025-11-04 12:32:08,104 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 7,902  tflops: 368.56  mfu: 37.27%
[rank3]:2025-11-04 12:32:08,105 - INFO -  step: 2450  loss:  0.2342  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 7,905  tflops: 368.68  mfu: 37.28%
[rank2]:2025-11-04 12:32:08,113 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0632  memory: 38.91GiB(27.83%)  tps: 7,903  tflops: 368.59  mfu: 37.27%
[rank0]:2025-11-04 12:32:08,132 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0632  memory: 58.45GiB(41.81%)  tps: 7,898  tflops: 368.34  mfu: 37.24%
[rank0]:2025-11-04 12:33:35,071 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 12:33:36,721 - INFO - Avg. fwd time: 16.9167 / Avg. bwd time: 23.2268 / Avg. batch time: 430.8009 (ms) / GPU bubble ratio: 25.45%
[rank3]:2025-11-04 12:33:36,701 - INFO - Avg. fwd time: 16.7788 / Avg. bwd time: 25.1184 / Avg. batch time: 350.7943 (ms) / GPU bubble ratio: 4.45%
[rank2]:2025-11-04 12:33:36,716 - INFO - Avg. fwd time: 14.8914 / Avg. bwd time: 22.7270 / Avg. batch time: 389.9838 (ms) / GPU bubble ratio: 22.83%
[rank0]:2025-11-04 12:33:36,754 - INFO - Avg. fwd time: 14.5527 / Avg. bwd time: 18.3807 / Avg. batch time: 474.1973 (ms) / GPU bubble ratio: 44.44%
[rank1]:2025-11-04 12:33:36,830 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,233  tflops: 430.63  mfu: 43.54%
[rank3]:2025-11-04 12:33:36,832 - INFO -  step: 2500  loss:  0.2150  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,233  tflops: 430.63  mfu: 43.54%
[rank2]:2025-11-04 12:33:36,840 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0384  memory: 38.91GiB(27.83%)  tps: 9,233  tflops: 430.62  mfu: 43.54%
[rank0]:2025-11-04 12:33:36,855 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0384  memory: 58.45GiB(41.81%)  tps: 9,233  tflops: 430.64  mfu: 43.54%
[rank0]:2025-11-04 12:33:36,907 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1233_stage0_step2500.svg
[rank1]:2025-11-04 12:33:36,905 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1233_stage1_step2500.svg
[rank2]:2025-11-04 12:33:36,905 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1233_stage2_step2500.svg
[rank3]:2025-11-04 12:33:36,999 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1233_real_step2500_rank3.svg
[rank3]:> Batch Time: 425.27 ms, GPU Bubble Ratio: 46.69%, 32.75%, 35.43%, 29.86%
[rank3]:2025-11-04 12:33:37,044 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1233_stage3_step2500.svg
[rank0]:2025-11-04 12:35:05,467 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:35:07,233 - INFO - Avg. fwd time: 16.7890 / Avg. bwd time: 25.0252 / Avg. batch time: 350.1290 (ms) / GPU bubble ratio: 4.46%
[rank2]:2025-11-04 12:35:07,270 - INFO - Avg. fwd time: 14.9006 / Avg. bwd time: 22.6546 / Avg. batch time: 389.2479 (ms) / GPU bubble ratio: 22.81%
[rank1]:2025-11-04 12:35:07,304 - INFO - Avg. fwd time: 16.9261 / Avg. bwd time: 23.1310 / Avg. batch time: 429.9701 (ms) / GPU bubble ratio: 25.47%
[rank1]:2025-11-04 12:35:07,351 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,050  tflops: 422.09  mfu: 42.68%
[rank3]:2025-11-04 12:35:07,352 - INFO -  step: 2550  loss:  0.4620  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,050  tflops: 422.09  mfu: 42.68%
[rank2]:2025-11-04 12:35:07,361 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1357  memory: 38.91GiB(27.83%)  tps: 9,050  tflops: 422.09  mfu: 42.68%
[rank0]:2025-11-04 12:35:07,346 - INFO - Avg. fwd time: 14.5587 / Avg. bwd time: 18.2786 / Avg. batch time: 473.3300 (ms) / GPU bubble ratio: 44.50%
[rank0]:2025-11-04 12:35:07,371 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1357  memory: 58.45GiB(41.81%)  tps: 9,050  tflops: 422.11  mfu: 42.68%
[rank0]:2025-11-04 12:36:36,475 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:36:38,149 - INFO - Avg. fwd time: 16.7993 / Avg. bwd time: 24.9508 / Avg. batch time: 349.6142 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-11-04 12:36:38,162 - INFO - Avg. fwd time: 14.9086 / Avg. bwd time: 22.5963 / Avg. batch time: 388.6822 (ms) / GPU bubble ratio: 22.81%
[rank1]:2025-11-04 12:36:38,166 - INFO - Avg. fwd time: 16.9353 / Avg. bwd time: 23.0524 / Avg. batch time: 429.3263 (ms) / GPU bubble ratio: 25.49%
[rank0]:2025-11-04 12:36:38,191 - INFO - Avg. fwd time: 14.5640 / Avg. bwd time: 18.1947 / Avg. batch time: 472.6453 (ms) / GPU bubble ratio: 44.55%
[rank1]:2025-11-04 12:36:38,279 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,009  tflops: 420.20  mfu: 42.49%
[rank1]:2025-11-04 12:36:38,279 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-04 12:36:38,280 - INFO -  step: 2600  loss:  0.3997  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,010  tflops: 420.20  mfu: 42.49%
[rank3]:2025-11-04 12:36:38,281 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-04 12:36:38,285 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0612  memory: 38.91GiB(27.83%)  tps: 9,010  tflops: 420.21  mfu: 42.49%
[rank2]:2025-11-04 12:36:38,286 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 12:36:38,304 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0612  memory: 58.45GiB(41.81%)  tps: 9,009  tflops: 420.18  mfu: 42.49%
[rank0]:2025-11-04 12:36:38,304 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 12:36:54,871 - INFO - validate step: 2600  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,725
[rank1]:2025-11-04 12:36:54,903 - INFO - validate step: 2600  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,640
[rank3]:2025-11-04 12:36:54,936 - INFO - validate step: 2600  loss:  0.2405  memory: 47.72GiB(34.13%)  tps: 24,594
[rank2]:2025-11-04 12:36:54,919 - INFO - validate step: 2600  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,625
[rank0]:2025-11-04 12:36:54,989 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1236_stage0_step2600.svg
[rank1]:2025-11-04 12:36:54,989 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1236_stage1_step2600.svg
[rank2]:2025-11-04 12:36:54,986 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1236_stage2_step2600.svg
[rank3]:2025-11-04 12:36:55,071 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1236_real_step2600_rank3.svg
[rank3]:> Batch Time: 434.12 ms, GPU Bubble Ratio: 47.77%, 33.62%, 36.01%, 29.63%
[rank3]:2025-11-04 12:36:55,115 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1236_stage3_step2600.svg
[rank0]:2025-11-04 12:38:23,716 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 12:38:25,408 - INFO - Avg. fwd time: 16.9453 / Avg. bwd time: 22.9654 / Avg. batch time: 428.5943 (ms) / GPU bubble ratio: 25.50%
[rank3]:2025-11-04 12:38:25,388 - INFO - Avg. fwd time: 16.8104 / Avg. bwd time: 24.8668 / Avg. batch time: 349.0294 (ms) / GPU bubble ratio: 4.47%
[rank2]:2025-11-04 12:38:25,403 - INFO - Avg. fwd time: 14.9169 / Avg. bwd time: 22.5280 / Avg. batch time: 388.0384 (ms) / GPU bubble ratio: 22.80%
[rank0]:2025-11-04 12:38:25,436 - INFO - Avg. fwd time: 14.5701 / Avg. bwd time: 18.0889 / Avg. batch time: 471.8390 (ms) / GPU bubble ratio: 44.63%
[rank1]:2025-11-04 12:38:25,516 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,041  tflops: 421.66  mfu: 42.63%
[rank3]:2025-11-04 12:38:25,518 - INFO -  step: 2650  loss:  0.3226  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,044  tflops: 421.81  mfu: 42.65%
[rank2]:2025-11-04 12:38:25,525 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0348  memory: 38.91GiB(27.83%)  tps: 9,041  tflops: 421.70  mfu: 42.64%
[rank0]:2025-11-04 12:38:25,544 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0348  memory: 58.45GiB(41.81%)  tps: 9,035  tflops: 421.38  mfu: 42.61%
[rank0]:2025-11-04 12:39:54,290 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:39:56,047 - INFO - Avg. fwd time: 16.8211 / Avg. bwd time: 24.7858 / Avg. batch time: 348.4652 (ms) / GPU bubble ratio: 4.48%
[rank2]:2025-11-04 12:39:56,085 - INFO - Avg. fwd time: 14.9242 / Avg. bwd time: 22.4636 / Avg. batch time: 387.4035 (ms) / GPU bubble ratio: 22.79%
[rank1]:2025-11-04 12:39:56,120 - INFO - Avg. fwd time: 16.9549 / Avg. bwd time: 22.8810 / Avg. batch time: 427.8784 (ms) / GPU bubble ratio: 25.52%
[rank1]:2025-11-04 12:39:56,167 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,037  tflops: 421.48  mfu: 42.62%
[rank3]:2025-11-04 12:39:56,169 - INFO -  step: 2700  loss:  0.3541  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,037  tflops: 421.49  mfu: 42.62%
[rank2]:2025-11-04 12:39:56,176 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0575  memory: 38.91GiB(27.83%)  tps: 9,037  tflops: 421.48  mfu: 42.62%
[rank2]:2025-11-04 12:39:56,243 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1239_stage2_step2700.svg
[rank0]:2025-11-04 12:39:56,161 - INFO - Avg. fwd time: 14.5757 / Avg. bwd time: 17.9983 / Avg. batch time: 471.0755 (ms) / GPU bubble ratio: 44.68%
[rank0]:2025-11-04 12:39:56,192 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0575  memory: 58.45GiB(41.81%)  tps: 9,037  tflops: 421.49  mfu: 42.62%
[rank0]:2025-11-04 12:39:56,243 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1239_stage0_step2700.svg
[rank1]:2025-11-04 12:39:56,243 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1239_stage1_step2700.svg
[rank3]:2025-11-04 12:39:56,327 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1239_real_step2700_rank3.svg
[rank3]:> Batch Time: 432.12 ms, GPU Bubble Ratio: 47.57%, 33.32%, 35.76%, 29.58%
[rank3]:2025-11-04 12:39:56,372 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1239_stage3_step2700.svg
[rank0]:2025-11-04 12:41:25,102 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:41:26,790 - INFO - Avg. fwd time: 16.8299 / Avg. bwd time: 24.7183 / Avg. batch time: 347.9949 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-11-04 12:41:26,803 - INFO - Avg. fwd time: 14.9298 / Avg. bwd time: 22.4119 / Avg. batch time: 386.8879 (ms) / GPU bubble ratio: 22.79%
[rank1]:2025-11-04 12:41:26,809 - INFO - Avg. fwd time: 16.9628 / Avg. bwd time: 22.8115 / Avg. batch time: 427.2933 (ms) / GPU bubble ratio: 25.53%
[rank0]:2025-11-04 12:41:26,838 - INFO - Avg. fwd time: 14.5803 / Avg. bwd time: 17.9205 / Avg. batch time: 470.4452 (ms) / GPU bubble ratio: 44.73%
[rank1]:2025-11-04 12:41:26,921 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0677  memory: 48.02GiB(34.34%)  tps: 9,027  tflops: 421.00  mfu: 42.57%
[rank3]:2025-11-04 12:41:26,920 - INFO -  step: 2750  loss:  0.2947  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,027  tflops: 421.02  mfu: 42.57%
[rank0]:2025-11-04 12:41:26,946 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0677  memory: 58.45GiB(41.81%)  tps: 9,027  tflops: 421.00  mfu: 42.57%
[rank2]:2025-11-04 12:41:26,928 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0677  memory: 38.91GiB(27.83%)  tps: 9,027  tflops: 421.01  mfu: 42.57%
[rank0]:2025-11-04 12:42:55,678 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:42:57,363 - INFO - Avg. fwd time: 16.8399 / Avg. bwd time: 24.6413 / Avg. batch time: 347.4576 (ms) / GPU bubble ratio: 4.49%
[rank2]:2025-11-04 12:42:57,376 - INFO - Avg. fwd time: 14.9363 / Avg. bwd time: 22.3541 / Avg. batch time: 386.2952 (ms) / GPU bubble ratio: 22.77%
[rank1]:2025-11-04 12:42:57,382 - INFO - Avg. fwd time: 16.9717 / Avg. bwd time: 22.7327 / Avg. batch time: 426.6220 (ms) / GPU bubble ratio: 25.55%
[rank0]:2025-11-04 12:42:57,404 - INFO - Avg. fwd time: 14.5850 / Avg. bwd time: 17.8162 / Avg. batch time: 469.7309 (ms) / GPU bubble ratio: 44.82%
[rank2]:2025-11-04 12:42:57,497 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0591  memory: 38.91GiB(27.83%)  tps: 9,045  tflops: 421.86  mfu: 42.66%
[rank2]:2025-11-04 12:42:57,497 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-04 12:42:57,489 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,045  tflops: 421.87  mfu: 42.66%
[rank1]:2025-11-04 12:42:57,489 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-04 12:42:57,490 - INFO -  step: 2800  loss:  0.2934  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,045  tflops: 421.86  mfu: 42.66%
[rank3]:2025-11-04 12:42:57,491 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 12:42:57,514 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0591  memory: 58.45GiB(41.81%)  tps: 9,045  tflops: 421.87  mfu: 42.66%
[rank0]:2025-11-04 12:42:57,514 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 12:43:14,072 - INFO - validate step: 2800  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,738
[rank2]:2025-11-04 12:43:14,121 - INFO - validate step: 2800  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,640
[rank1]:2025-11-04 12:43:14,104 - INFO - validate step: 2800  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,653
[rank3]:2025-11-04 12:43:14,138 - INFO - validate step: 2800  loss:  0.2390  memory: 47.72GiB(34.13%)  tps: 24,607
[rank0]:2025-11-04 12:43:14,191 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1243_stage0_step2800.svg
[rank2]:2025-11-04 12:43:14,189 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1243_stage2_step2800.svg
[rank1]:2025-11-04 12:43:14,192 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1243_stage1_step2800.svg
[rank3]:2025-11-04 12:43:14,275 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1243_real_step2800_rank3.svg
[rank3]:> Batch Time: 432.47 ms, GPU Bubble Ratio: 51.21%, 33.64%, 36.30%, 29.57%
[rank3]:2025-11-04 12:43:14,319 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1243_stage3_step2800.svg
[rank0]:2025-11-04 12:44:43,350 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 12:44:45,122 - INFO - Avg. fwd time: 16.8501 / Avg. bwd time: 24.5704 / Avg. batch time: 346.9702 (ms) / GPU bubble ratio: 4.50%
[rank2]:2025-11-04 12:44:45,161 - INFO - Avg. fwd time: 14.9426 / Avg. bwd time: 22.3003 / Avg. batch time: 385.7612 (ms) / GPU bubble ratio: 22.76%
[rank1]:2025-11-04 12:44:45,197 - INFO - Avg. fwd time: 16.9807 / Avg. bwd time: 22.6571 / Avg. batch time: 426.0172 (ms) / GPU bubble ratio: 25.57%
[rank1]:2025-11-04 12:44:45,248 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 8,988  tflops: 419.20  mfu: 42.39%
[rank3]:2025-11-04 12:44:45,249 - INFO -  step: 2850  loss:  0.4082  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 8,991  tflops: 419.36  mfu: 42.40%
[rank0]:2025-11-04 12:44:45,241 - INFO - Avg. fwd time: 14.5902 / Avg. bwd time: 17.7303 / Avg. batch time: 469.0740 (ms) / GPU bubble ratio: 44.88%
[rank0]:2025-11-04 12:44:45,276 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0594  memory: 58.45GiB(41.81%)  tps: 8,982  tflops: 418.93  mfu: 42.36%
[rank2]:2025-11-04 12:44:45,256 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0594  memory: 38.91GiB(27.83%)  tps: 8,989  tflops: 419.24  mfu: 42.39%
[rank0]:2025-11-04 12:46:13,991 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 12:46:15,701 - INFO - Avg. fwd time: 16.9879 / Avg. bwd time: 22.5944 / Avg. batch time: 425.4701 (ms) / GPU bubble ratio: 25.57%
[rank0]:2025-11-04 12:46:15,734 - INFO - Avg. fwd time: 14.5942 / Avg. bwd time: 17.6552 / Avg. batch time: 468.4869 (ms) / GPU bubble ratio: 44.93%
[rank3]:2025-11-04 12:46:15,679 - INFO - Avg. fwd time: 16.8580 / Avg. bwd time: 24.5083 / Avg. batch time: 346.5356 (ms) / GPU bubble ratio: 4.50%
[rank2]:2025-11-04 12:46:15,694 - INFO - Avg. fwd time: 14.9480 / Avg. bwd time: 22.2533 / Avg. batch time: 385.2768 (ms) / GPU bubble ratio: 22.75%
[rank1]:2025-11-04 12:46:15,809 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,046  tflops: 421.90  mfu: 42.66%
[rank0]:2025-11-04 12:46:15,834 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0527  memory: 58.45GiB(41.81%)  tps: 9,046  tflops: 421.91  mfu: 42.66%
[rank3]:2025-11-04 12:46:15,811 - INFO -  step: 2900  loss:  0.3883  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,046  tflops: 421.91  mfu: 42.66%
[rank2]:2025-11-04 12:46:15,818 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0527  memory: 38.91GiB(27.83%)  tps: 9,046  tflops: 421.90  mfu: 42.66%
[rank2]:2025-11-04 12:46:15,885 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1246_stage2_step2900.svg
[rank1]:2025-11-04 12:46:15,887 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1246_stage1_step2900.svg
[rank0]:2025-11-04 12:46:15,889 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1246_stage0_step2900.svg
[rank3]:2025-11-04 12:46:15,972 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1246_real_step2900_rank3.svg
[rank3]:> Batch Time: 431.14 ms, GPU Bubble Ratio: 49.05%, 33.31%, 35.64%, 30.04%
[rank3]:2025-11-04 12:46:16,018 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1246_stage3_step2900.svg
[rank0]:2025-11-04 12:47:44,499 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 12:47:46,199 - INFO - Avg. fwd time: 16.9965 / Avg. bwd time: 22.5238 / Avg. batch time: 424.8668 (ms) / GPU bubble ratio: 25.59%
[rank0]:2025-11-04 12:47:46,225 - INFO - Avg. fwd time: 14.5995 / Avg. bwd time: 17.5737 / Avg. batch time: 467.8375 (ms) / GPU bubble ratio: 44.98%
[rank3]:2025-11-04 12:47:46,179 - INFO - Avg. fwd time: 16.8675 / Avg. bwd time: 24.4389 / Avg. batch time: 346.0546 (ms) / GPU bubble ratio: 4.51%
[rank2]:2025-11-04 12:47:46,193 - INFO - Avg. fwd time: 14.9561 / Avg. bwd time: 22.1982 / Avg. batch time: 384.7451 (ms) / GPU bubble ratio: 22.75%
[rank1]:2025-11-04 12:47:46,304 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,053  tflops: 422.21  mfu: 42.69%
[rank3]:2025-11-04 12:47:46,305 - INFO -  step: 2950  loss:  0.4362  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,053  tflops: 422.22  mfu: 42.69%
[rank2]:2025-11-04 12:47:46,314 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0876  memory: 38.91GiB(27.83%)  tps: 9,052  tflops: 422.20  mfu: 42.69%
[rank0]:2025-11-04 12:47:46,330 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0876  memory: 58.45GiB(41.81%)  tps: 9,052  tflops: 422.21  mfu: 42.69%
[rank0]:2025-11-04 12:49:15,000 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 12:49:16,749 - INFO - Avg. fwd time: 16.8765 / Avg. bwd time: 24.3725 / Avg. batch time: 345.5947 (ms) / GPU bubble ratio: 4.51%
[rank2]:2025-11-04 12:49:16,786 - INFO - Avg. fwd time: 14.9643 / Avg. bwd time: 22.1405 / Avg. batch time: 384.2263 (ms) / GPU bubble ratio: 22.74%
[rank1]:2025-11-04 12:49:16,822 - INFO - Avg. fwd time: 17.0047 / Avg. bwd time: 22.4561 / Avg. batch time: 424.2783 (ms) / GPU bubble ratio: 25.59%
[rank1]:2025-11-04 12:49:16,869 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 48.02GiB(34.34%)  tps: 9,045  tflops: 421.88  mfu: 42.66%
[rank1]:2025-11-04 12:49:16,869 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 8,438  tflops: 393.55  mfu: 39.51%
[rank1]:2025-11-04 12:49:16,869 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-04 12:49:16,862 - INFO - Avg. fwd time: 14.6044 / Avg. bwd time: 17.4953 / Avg. batch time: 467.2057 (ms) / GPU bubble ratio: 45.04%
[rank0]:2025-11-04 12:49:16,893 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0666  memory: 58.45GiB(41.81%)  tps: 9,046  tflops: 421.89  mfu: 42.66%
[rank0]:2025-11-04 12:49:16,894 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0666  tps: 8,437  tflops: 393.50  mfu: 39.51%
[rank0]:2025-11-04 12:49:16,894 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-04 12:49:16,870 - INFO -  step: 3000  loss:  0.3548  grad_norm:  0.0000  memory: 47.72GiB(34.13%)  tps: 9,046  tflops: 421.89  mfu: 42.66%
[rank3]:2025-11-04 12:49:16,871 - INFO -  final step: 3000  loss:  0.3548  grad_norm:  0.0000  tps: 8,442  tflops: 393.72  mfu: 39.52%
[rank3]:2025-11-04 12:49:16,871 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-04 12:49:16,876 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0666  memory: 38.91GiB(27.83%)  tps: 9,046  tflops: 421.89  mfu: 42.66%
[rank2]:2025-11-04 12:49:16,876 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0666  tps: 8,439  tflops: 393.59  mfu: 39.51%
[rank2]:2025-11-04 12:49:16,876 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-04 12:49:33,468 - INFO - validate step: 3000  loss: -1.0000  memory: 38.91GiB(27.83%)  tps: 24,687
[rank2]:2025-11-04 12:49:33,469 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 12:49:33,471 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-04 12:49:33,452 - INFO - validate step: 3000  loss: -1.0000  memory: 48.02GiB(34.34%)  tps: 24,701
[rank1]:2025-11-04 12:49:33,453 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 12:49:33,457 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 12:49:33,419 - INFO - validate step: 3000  loss: -1.0000  memory: 58.45GiB(41.81%)  tps: 24,787
[rank0]:2025-11-04 12:49:33,419 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 12:49:33,424 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-04 12:49:33,485 - INFO - validate step: 3000  loss:  0.2408  memory: 47.72GiB(34.13%)  tps: 24,655
[rank3]:2025-11-04 12:49:33,486 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 12:49:33,491 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 12:49:43,911 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank2]:2025-11-04 12:49:44,012 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank2/251104_1249_stage2_final3000.svg
[rank1]:2025-11-04 12:49:44,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank1/251104_1249_stage1_final3000.svg
[rank0]:2025-11-04 12:49:44,046 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank0/251104_1249_stage0_final3000.svg
[rank3]:2025-11-04 12:49:44,158 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1249_real_final3000_rank3.svg
[rank3]:> Batch Time: 434.23 ms, GPU Bubble Ratio: 47.58%, 33.65%, 36.22%, 29.85%
[rank2]:2025-11-04 12:49:44,191 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251104_1249_rank2_stage2.svg
[rank2]:	> Counts Sum: 1527520, Total Sum: 5829120 (26.20%), Ratio(%) per element: [8.89, 8.94, 8.3, 9.09, 8.59, 8.89, 9.23, 9.28, 8.79, 11.01, 11.7, 11.11, 11.7, 11.46, 10.82, 11.06, 12.54, 12.1, 15.06, 14.62, 14.22, 15.46, 14.82, 15.76, 15.71, 15.41, 15.31, 18.37, 19.46, 19.02, 18.57, 19.61, 19.02, 19.46, 19.36, 19.71, 25.09, 23.51, 23.81, 23.61, 23.07, 23.76, 22.97, 21.88, 23.86, 34.14, 32.55, 32.75, 33.05, 31.66, 33.1, 35.91, 32.7, 34.09, 46.49, 46.88, 48.07, 47.23, 46.09, 48.17, 47.08, 48.12, 47.77, 49.65, 51.72, 50.0, 51.28, 50.34, 52.27, 51.28, 50.0, 50.0]
[rank2]:2025-11-04 12:49:44,191 - INFO - Destroying the purge thread.
[rank1]:2025-11-04 12:49:44,270 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251104_1249_rank1_stage1.svg
[rank1]:	> Counts Sum: 985760, Total Sum: 6557760 (15.03%), Ratio(%) per element: [14.42, 14.57, 14.77, 14.67, 14.82, 14.92, 15.21, 14.17, 14.57, 14.57, 14.32, 14.57, 14.47, 14.32, 14.42, 14.32, 14.72, 14.27, 15.31, 15.36, 14.82, 14.87, 14.97, 15.06, 15.06, 14.87, 15.11, 15.26, 15.01, 15.36, 15.41, 14.97, 14.92, 15.06, 14.67, 15.01, 15.06, 15.56, 15.06, 15.26, 15.26, 15.51, 15.01, 14.97, 14.62, 15.06, 15.21, 15.06, 15.9, 15.21, 15.16, 14.72, 15.21, 14.82, 14.92, 15.16, 15.41, 14.67, 15.01, 15.06, 15.46, 15.26, 15.01, 15.06, 14.62, 15.61, 15.51, 15.56, 14.67, 15.21, 15.66, 15.41, 15.46, 15.56, 15.31, 15.01, 15.46, 15.66, 15.41, 15.01, 15.11]
[rank1]:2025-11-04 12:49:44,270 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 12:49:44,361 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251104_1249_rank0_stage0.svg
[rank0]:	> Counts Sum: 3163040, Total Sum: 5910080 (53.52%), Ratio(%) per element: [70.75, 24.9, 24.6, 25.69, 24.2, 24.9, 25.14, 25.19, 26.18, 25.09, 28.65, 29.44, 27.32, 28.8, 29.94, 28.9, 28.75, 30.53, 30.08, 38.73, 39.37, 39.27, 38.14, 39.08, 38.93, 38.33, 38.93, 39.17, 56.81, 57.8, 55.68, 56.62, 55.92, 56.91, 55.28, 57.01, 57.01, 67.83, 66.4, 68.08, 68.03, 67.14, 68.13, 68.52, 68.18, 67.34, 69.56, 69.76, 69.07, 69.46, 69.36, 69.21, 70.1, 69.12, 70.35, 69.07, 68.62, 69.56, 69.66, 70.4, 69.66, 68.97, 69.86, 69.21, 70.55, 70.4, 69.51, 69.02, 69.81, 69.41, 70.3, 70.55, 68.33]
[rank0]:2025-11-04 12:49:44,361 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 12:49:44,330 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/pipeline_schedule/251104_1249_thry_final3000_rank3.svg
[rank3]:> Batch Time: 533.25 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-04 12:49:44,384 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/freeze_ratio_history/rank3/251104_1249_stage3_final3000.svg
[rank3]:2025-11-04 12:49:44,593 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200/frozen_params_histogram/251104_1249_rank3_stage3.svg
[rank3]:	> Counts Sum: 606880, Total Sum: 5262400 (11.53%), Ratio(%) per element: [11.16, 11.11, 10.77, 11.06, 10.57, 10.57, 11.7, 11.01, 10.86, 11.41, 11.31, 11.26, 10.86, 11.16, 11.31, 11.61, 11.7, 10.57, 10.67, 11.11, 10.96, 11.41, 11.31, 10.86, 10.32, 11.46, 10.42, 11.46, 11.36, 11.7, 10.96, 11.9, 11.21, 11.61, 11.75, 12.1, 12.1, 11.41, 11.75, 12.0, 11.9, 12.54, 11.75, 11.8, 12.1, 12.2, 11.75, 12.1, 12.1, 11.7, 12.54, 12.1, 11.46, 12.2, 12.0, 11.75, 12.4, 11.8, 12.0, 11.36, 11.7, 12.69, 12.1, 11.41, 11.95]
[rank3]:2025-11-04 12:49:44,594 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–â–â–â–â–â–‚â–‚â–â–â–â–â–â–â–â–â–â–‚â–â–â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–‚â–â–â–‚â–‚â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.94087
[rank3]:wandb:               final/avg_loss 0.35485
[rank3]:wandb:             final/avg_mfu(%) 39.51909
[rank3]:wandb:             final/avg_tflops 393.7155
[rank3]:wandb:    final/avg_throughput(tps) 8441.55532
[rank3]:wandb:              final/grad_norm 0
[rank3]:wandb:               final/max_loss 0.35485
[rank3]:wandb:                    grad_norm 0
[rank3]:wandb: loss_metrics/global_avg_loss 0.35485
[rank3]:wandb: loss_metrics/global_max_loss 0.35485
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_1F1B_timelyauto_h200 at: https://wandb.ai/orangingq/torchtitan/runs/dwc3kmcg
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_1F1B_timelyauto_h200/20251104-1106/wandb/run-20251104_110644-dwc3kmcg/logs
[rank0]:2025-11-04 12:49:46,361 - INFO - Training completed
[rank0]:2025-11-04 12:49:46,361 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 12:49:46,708 - INFO - Process group destroyed
[rank2]:2025-11-04 12:49:46,772 - INFO - Process group destroyed
[rank1]:2025-11-04 12:49:46,758 - INFO - Process group destroyed
[rank0]:2025-11-04 12:49:46,769 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.3', 'layers.1', 'tok_embeddings', 'layers.4', 'layers.5', 'layers.7', 'layers.6', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.10', 'layers.14', 'layers.16', 'layers.12', 'layers.9', 'layers.15', 'layers.13', 'layers.11', 'layers.8'}
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.17', 'layers.18', 'layers.22', 'layers.21', 'layers.24', 'layers.23', 'layers.20'}
[rank3]:Stage 3: Modules to keep: {'layers.28', 'layers.29', 'layers.31', 'layers.27', 'layers.25', 'output', 'norm', 'layers.26', 'layers.30'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_1F1B_timelyauto_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_1F1B_timelyauto_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_1F1B_timelyauto_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_1F1B_timelyauto_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_1F1B_timelyauto_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_1F1B_timelyauto_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_1F1B_timelyauto_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_1F1B_timelyauto_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
