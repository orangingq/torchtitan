
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 09:56:32 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 09:56:33.483000 689693 site-packages/torch/distributed/run.py:811] 
W1102 09:56:33.483000 689693 site-packages/torch/distributed/run.py:811] *****************************************
W1102 09:56:33.483000 689693 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 09:56:33.483000 689693 site-packages/torch/distributed/run.py:811] *****************************************
[rank0]:2025-11-02 09:56:40,400 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 09:56:40,404 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 09:56:40,471 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 09:56:40,514 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 09:56:41,454 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 09:56:41,456 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 09:56:41,462 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-11-02 09:56:41,457 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 09:56:41,459 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 09:56:41,475 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 09:56:41,478 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-02 09:56:41,484 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 09:56:41,486 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 09:56:43,193 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 09:56:43,479 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-02 09:56:45,217 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-02 09:56:45,467 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 09:56:45,526 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-02 09:56:45,549 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-02 09:56:45,549 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-11-02 09:56:45,487 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 09:56:45,569 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-02 09:56:45,569 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank2]:2025-11-02 09:56:45,704 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-02 09:56:45,836 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 09:56:45,836 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-11-02 09:56:45,849 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 09:56:45,849 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2025-11-02 09:56:45,778 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-02 09:56:45,778 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-02 09:56:45,980 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 09:56:45,980 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run pvh1yi67
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_timelyapf_h200/20251102-0956/wandb/run-20251102_095646-pvh1yi67
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_GPipe_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/pvh1yi67
[rank3]:2025-11-02 09:56:47,227 - INFO - WandB logging enabled
[rank3]:2025-11-02 09:56:47,229 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 09:56:47,301 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 09:56:47,301 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2025-11-02 09:56:47,548 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_timelyapf_h200
[rank0]:2025-11-02 09:56:47,548 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 09:56:47,548 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-02 09:56:47,536 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 09:56:47,536 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 09:56:47,548 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank1]:2025-11-02 09:56:47,551 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 09:56:47,551 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 09:56:51,080 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 09:56:51,080 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 09:57:00,106 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 09:57:00,106 - INFO - Finished loading the checkpoint in 9.03 seconds.
[rank0]:2025-11-02 09:57:00,106 - INFO - Training starts at step 1
[rank3]:2025-11-02 09:57:04,334 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 961  tflops: 44.80  mfu: 4.53%
[rank3]:2025-11-02 09:57:04,334 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 09:57:04,329 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 882  tflops: 41.14  mfu: 4.16%
[rank2]:2025-11-02 09:57:04,330 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 09:57:04,351 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 870  tflops: 40.59  mfu: 4.10%
[rank0]:2025-11-02 09:57:04,351 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-02 09:57:04,332 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 872  tflops: 40.67  mfu: 4.11%
[rank1]:2025-11-02 09:57:04,332 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 09:59:12,079 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 09:59:14,530 - INFO - Avg. fwd time: 14.5770 / Avg. bwd time: 42.9286 / Avg. batch time: 478.0498 (ms) / GPU bubble ratio: 3.77%
[rank2]:2025-11-02 09:59:14,580 - INFO - Avg. fwd time: 13.1152 / Avg. bwd time: 36.2751 / Avg. batch time: 531.3095 (ms) / GPU bubble ratio: 25.63%
[rank0]:2025-11-02 09:59:14,658 - INFO - Avg. fwd time: 13.7982 / Avg. bwd time: 37.8888 / Avg. batch time: 647.1147 (ms) / GPU bubble ratio: 36.10%
[rank1]:2025-11-02 09:59:14,626 - INFO - Avg. fwd time: 15.0423 / Avg. bwd time: 41.0378 / Avg. batch time: 591.6045 (ms) / GPU bubble ratio: 24.17%
[rank0]:2025-11-02 09:59:14,768 - INFO -  step: 50  loss: -4.0000  grad_norm: 7283.1577  memory: 66.72GiB(47.72%)  tps: 6,156  tflops: 287.11  mfu: 29.03%
[rank3]:2025-11-02 09:59:14,765 - INFO -  step: 50  loss: 12.7725  grad_norm: 7283.1577  memory: 73.38GiB(52.48%)  tps: 6,155  tflops: 287.08  mfu: 29.03%
[rank1]:2025-11-02 09:59:14,764 - INFO -  step: 50  loss: -4.0000  grad_norm: 7283.1577  memory: 64.32GiB(46.00%)  tps: 6,155  tflops: 287.07  mfu: 29.03%
[rank2]:2025-11-02 09:59:14,761 - INFO -  step: 50  loss: -4.0000  grad_norm: 7283.1577  memory: 57.29GiB(40.97%)  tps: 6,155  tflops: 287.07  mfu: 29.03%
[rank0]:2025-11-02 10:01:25,502 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:01:27,953 - INFO - Avg. fwd time: 14.6170 / Avg. bwd time: 43.0900 / Avg. batch time: 478.2258 (ms) / GPU bubble ratio: 3.46%
[rank0]:2025-11-02 10:01:28,082 - INFO - Avg. fwd time: 13.6192 / Avg. bwd time: 37.9976 / Avg. batch time: 646.1590 (ms) / GPU bubble ratio: 36.09%
[rank1]:2025-11-02 10:01:28,049 - INFO - Avg. fwd time: 15.0221 / Avg. bwd time: 41.1215 / Avg. batch time: 591.0245 (ms) / GPU bubble ratio: 24.00%
[rank2]:2025-11-02 10:01:28,003 - INFO - Avg. fwd time: 13.1715 / Avg. bwd time: 36.4509 / Avg. batch time: 531.2248 (ms) / GPU bubble ratio: 25.27%
[rank3]:2025-11-02 10:01:28,190 - INFO -  step: 100  loss:  4.3270  grad_norm: 79.9079  memory: 73.38GiB(52.48%)  tps: 6,140  tflops: 286.36  mfu: 28.95%
[rank3]:2025-11-02 10:01:28,190 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:01:28,193 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.9079  memory: 66.72GiB(47.72%)  tps: 6,140  tflops: 286.36  mfu: 28.95%
[rank0]:2025-11-02 10:01:28,193 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 10:01:28,188 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.9079  memory: 64.32GiB(46.00%)  tps: 6,140  tflops: 286.36  mfu: 28.95%
[rank1]:2025-11-02 10:01:28,188 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 10:01:28,186 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.9079  memory: 57.29GiB(40.97%)  tps: 6,140  tflops: 286.36  mfu: 28.95%
[rank2]:2025-11-02 10:01:28,186 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:03:38,677 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:03:41,221 - INFO - Avg. fwd time: 14.5612 / Avg. bwd time: 43.1339 / Avg. batch time: 477.6822 (ms) / GPU bubble ratio: 3.37%
[rank1]:2025-11-02 10:03:41,309 - INFO - Avg. fwd time: 14.9770 / Avg. bwd time: 41.1777 / Avg. batch time: 590.2436 (ms) / GPU bubble ratio: 23.89%
[rank2]:2025-11-02 10:03:41,263 - INFO - Avg. fwd time: 13.1405 / Avg. bwd time: 36.5394 / Avg. batch time: 530.5957 (ms) / GPU bubble ratio: 25.10%
[rank0]:2025-11-02 10:03:41,352 - INFO - Avg. fwd time: 13.5521 / Avg. bwd time: 38.0360 / Avg. batch time: 645.2764 (ms) / GPU bubble ratio: 36.04%
[rank0]:2025-11-02 10:03:41,387 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.8084  memory: 66.72GiB(47.72%)  tps: 6,150  tflops: 286.86  mfu: 29.00%
[rank3]:2025-11-02 10:03:41,385 - INFO -  step: 150  loss:  1.2288  grad_norm: 17.8084  memory: 73.38GiB(52.48%)  tps: 6,150  tflops: 286.86  mfu: 29.00%
[rank1]:2025-11-02 10:03:41,383 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.8084  memory: 64.32GiB(46.00%)  tps: 6,150  tflops: 286.86  mfu: 29.00%
[rank2]:2025-11-02 10:03:41,381 - INFO -  step: 150  loss: -4.0000  grad_norm: 17.8084  memory: 57.29GiB(40.97%)  tps: 6,150  tflops: 286.86  mfu: 29.00%
[rank0]:2025-11-02 10:05:51,855 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:05:54,302 - INFO - Avg. fwd time: 14.5276 / Avg. bwd time: 43.1592 / Avg. batch time: 477.4238 (ms) / GPU bubble ratio: 3.34%
[rank1]:2025-11-02 10:05:54,399 - INFO - Avg. fwd time: 14.9524 / Avg. bwd time: 41.2000 / Avg. batch time: 589.8702 (ms) / GPU bubble ratio: 23.84%
[rank2]:2025-11-02 10:05:54,353 - INFO - Avg. fwd time: 13.1190 / Avg. bwd time: 36.5866 / Avg. batch time: 530.3004 (ms) / GPU bubble ratio: 25.02%
[rank0]:2025-11-02 10:05:54,432 - INFO - Avg. fwd time: 13.5274 / Avg. bwd time: 38.0524 / Avg. batch time: 644.8515 (ms) / GPU bubble ratio: 36.01%
[rank3]:2025-11-02 10:05:54,539 - INFO -  step: 200  loss:  0.3464  grad_norm:  1.7593  memory: 73.38GiB(52.48%)  tps: 6,152  tflops: 286.95  mfu: 29.01%
[rank3]:2025-11-02 10:05:54,539 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 10:05:54,541 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.7593  memory: 66.72GiB(47.72%)  tps: 6,152  tflops: 286.94  mfu: 29.01%
[rank0]:2025-11-02 10:05:54,542 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-02 10:05:54,537 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.7593  memory: 64.32GiB(46.00%)  tps: 6,152  tflops: 286.94  mfu: 29.01%
[rank1]:2025-11-02 10:05:54,537 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 10:05:54,535 - INFO -  step: 200  loss: -4.0000  grad_norm:  1.7593  memory: 57.29GiB(40.97%)  tps: 6,152  tflops: 286.94  mfu: 29.01%
[rank2]:2025-11-02 10:05:54,535 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 10:06:10,913 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 25,019
[rank0]:2025-11-02 10:06:10,914 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 10:06:10,994 - INFO - validate step: 200  loss:  0.2600  memory: 73.38GiB(52.48%)  tps: 24,895
[rank3]:2025-11-02 10:06:10,995 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 10:06:10,943 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,967
[rank1]:2025-11-02 10:06:10,944 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 10:06:10,973 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,918
[rank2]:2025-11-02 10:06:10,974 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:08:21,777 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 10:08:24,231 - INFO - Avg. fwd time: 14.5250 / Avg. bwd time: 43.1820 / Avg. batch time: 477.4525 (ms) / GPU bubble ratio: 3.31%
[rank2]:2025-11-02 10:08:24,281 - INFO - Avg. fwd time: 13.1294 / Avg. bwd time: 36.6163 / Avg. batch time: 530.3364 (ms) / GPU bubble ratio: 24.96%
[rank1]:2025-11-02 10:08:24,328 - INFO - Avg. fwd time: 14.9712 / Avg. bwd time: 41.2278 / Avg. batch time: 589.9141 (ms) / GPU bubble ratio: 23.79%
[rank0]:2025-11-02 10:08:24,360 - INFO - Avg. fwd time: 13.5373 / Avg. bwd time: 38.0836 / Avg. batch time: 644.9254 (ms) / GPU bubble ratio: 35.97%
[rank3]:2025-11-02 10:08:24,466 - INFO -  step: 250  loss:  0.2339  grad_norm:  0.2691  memory: 73.38GiB(52.48%)  tps: 6,138  tflops: 286.26  mfu: 28.94%
[rank0]:2025-11-02 10:08:24,468 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2691  memory: 66.72GiB(47.72%)  tps: 6,134  tflops: 286.08  mfu: 28.93%
[rank2]:2025-11-02 10:08:24,462 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2691  memory: 57.29GiB(40.97%)  tps: 6,137  tflops: 286.22  mfu: 28.94%
[rank1]:2025-11-02 10:08:24,464 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2691  memory: 64.32GiB(46.00%)  tps: 6,135  tflops: 286.16  mfu: 28.93%
[rank0]:2025-11-02 10:10:35,419 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 10:10:38,048 - INFO - Avg. fwd time: 14.9884 / Avg. bwd time: 41.2488 / Avg. batch time: 590.0106 (ms) / GPU bubble ratio: 23.75%
[rank2]:2025-11-02 10:10:38,002 - INFO - Avg. fwd time: 13.1436 / Avg. bwd time: 36.6372 / Avg. batch time: 530.4338 (ms) / GPU bubble ratio: 24.92%
[rank3]:2025-11-02 10:10:37,960 - INFO - Avg. fwd time: 14.5273 / Avg. bwd time: 43.2015 / Avg. batch time: 477.5418 (ms) / GPU bubble ratio: 3.29%
[rank1]:2025-11-02 10:10:38,123 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2936  memory: 64.32GiB(46.00%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank1]:2025-11-02 10:10:38,123 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 10:10:38,120 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2936  memory: 57.29GiB(40.97%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank2]:2025-11-02 10:10:38,120 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:10:38,091 - INFO - Avg. fwd time: 13.5425 / Avg. bwd time: 38.1106 / Avg. batch time: 645.0308 (ms) / GPU bubble ratio: 35.94%
[rank0]:2025-11-02 10:10:38,126 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2936  memory: 66.72GiB(47.72%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank0]:2025-11-02 10:10:38,127 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 10:10:38,125 - INFO -  step: 300  loss:  0.2719  grad_norm:  0.2936  memory: 73.38GiB(52.48%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank3]:2025-11-02 10:10:38,125 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:12:49,267 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:12:51,738 - INFO - Avg. fwd time: 14.5346 / Avg. bwd time: 43.2155 / Avg. batch time: 477.6601 (ms) / GPU bubble ratio: 3.28%
[rank2]:2025-11-02 10:12:51,789 - INFO - Avg. fwd time: 13.1567 / Avg. bwd time: 36.6525 / Avg. batch time: 530.5610 (ms) / GPU bubble ratio: 24.90%
[rank1]:2025-11-02 10:12:51,835 - INFO - Avg. fwd time: 15.0044 / Avg. bwd time: 41.2620 / Avg. batch time: 590.1409 (ms) / GPU bubble ratio: 23.72%
[rank0]:2025-11-02 10:12:51,868 - INFO - Avg. fwd time: 13.5478 / Avg. bwd time: 38.1275 / Avg. batch time: 645.1685 (ms) / GPU bubble ratio: 35.92%
[rank3]:2025-11-02 10:12:51,975 - INFO -  step: 350  loss:  0.3352  grad_norm:  0.3918  memory: 73.38GiB(52.48%)  tps: 6,120  tflops: 285.45  mfu: 28.86%
[rank2]:2025-11-02 10:12:51,970 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3918  memory: 57.29GiB(40.97%)  tps: 6,120  tflops: 285.45  mfu: 28.86%
[rank1]:2025-11-02 10:12:51,973 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3918  memory: 64.32GiB(46.00%)  tps: 6,120  tflops: 285.45  mfu: 28.86%
[rank0]:2025-11-02 10:12:51,977 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3918  memory: 66.72GiB(47.72%)  tps: 6,120  tflops: 285.45  mfu: 28.86%
[rank0]:2025-11-02 10:15:03,044 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:15:05,522 - INFO - Avg. fwd time: 14.5433 / Avg. bwd time: 43.2277 / Avg. batch time: 477.7841 (ms) / GPU bubble ratio: 3.27%
[rank2]:2025-11-02 10:15:05,574 - INFO - Avg. fwd time: 13.1678 / Avg. bwd time: 36.6638 / Avg. batch time: 530.6906 (ms) / GPU bubble ratio: 24.88%
[rank1]:2025-11-02 10:15:05,621 - INFO - Avg. fwd time: 15.0102 / Avg. bwd time: 41.2714 / Avg. batch time: 590.2656 (ms) / GPU bubble ratio: 23.72%
[rank0]:2025-11-02 10:15:05,653 - INFO - Avg. fwd time: 13.5473 / Avg. bwd time: 38.1374 / Avg. batch time: 645.2920 (ms) / GPU bubble ratio: 35.92%
[rank2]:2025-11-02 10:15:05,756 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3044  memory: 57.29GiB(40.97%)  tps: 6,123  tflops: 285.59  mfu: 28.88%
[rank2]:2025-11-02 10:15:05,756 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 10:15:05,758 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3044  memory: 64.32GiB(46.00%)  tps: 6,123  tflops: 285.59  mfu: 28.88%
[rank0]:2025-11-02 10:15:05,762 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3044  memory: 66.72GiB(47.72%)  tps: 6,123  tflops: 285.59  mfu: 28.88%
[rank0]:2025-11-02 10:15:05,763 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 10:15:05,760 - INFO -  step: 400  loss:  0.2722  grad_norm:  0.3044  memory: 73.38GiB(52.48%)  tps: 6,123  tflops: 285.59  mfu: 28.88%
[rank3]:2025-11-02 10:15:05,760 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 10:15:05,758 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 10:15:20,840 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,166
[rank0]:2025-11-02 10:15:20,841 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-02 10:15:20,904 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,040
[rank2]:2025-11-02 10:15:20,905 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-02 10:15:20,870 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,105
[rank1]:2025-11-02 10:15:20,871 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-02 10:15:20,924 - INFO - validate step: 400  loss:  0.2353  memory: 73.38GiB(52.48%)  tps: 27,014
[rank3]:2025-11-02 10:15:20,926 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-02 10:17:32,051 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:17:34,600 - INFO - Avg. fwd time: 14.5512 / Avg. bwd time: 43.2357 / Avg. batch time: 477.8776 (ms) / GPU bubble ratio: 3.26%
[rank2]:2025-11-02 10:17:34,644 - INFO - Avg. fwd time: 13.1779 / Avg. bwd time: 36.6746 / Avg. batch time: 530.7928 (ms) / GPU bubble ratio: 24.86%
[rank1]:2025-11-02 10:17:34,691 - INFO - Avg. fwd time: 15.0192 / Avg. bwd time: 41.2784 / Avg. batch time: 590.3748 (ms) / GPU bubble ratio: 23.71%
[rank1]:2025-11-02 10:17:34,768 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2632  memory: 64.32GiB(46.00%)  tps: 6,118  tflops: 285.35  mfu: 28.85%
[rank2]:2025-11-02 10:17:34,765 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2632  memory: 57.29GiB(40.97%)  tps: 6,120  tflops: 285.43  mfu: 28.86%
[rank0]:2025-11-02 10:17:34,736 - INFO - Avg. fwd time: 13.5495 / Avg. bwd time: 38.1501 / Avg. batch time: 645.4202 (ms) / GPU bubble ratio: 35.92%
[rank0]:2025-11-02 10:17:34,771 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.2632  memory: 66.72GiB(47.72%)  tps: 6,117  tflops: 285.28  mfu: 28.85%
[rank3]:2025-11-02 10:17:34,769 - INFO -  step: 450  loss:  0.3043  grad_norm:  0.2632  memory: 73.38GiB(52.48%)  tps: 6,121  tflops: 285.47  mfu: 28.86%
[rank3]:2025-11-02 10:18:01,327 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-02 10:18:29,094 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-02 10:18:29,309 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank0]:2025-11-02 10:18:29,404 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:29,421 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:29,441 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:33,868 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:33,903 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:33,893 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:33,935 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:33,950 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:33,981 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:33,924 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:33,956 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:34,023 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:34,059 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,070 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,108 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:34,062 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:34,098 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:34,130 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:34,096 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:34,134 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:34,172 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,146 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,184 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:34,136 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:34,174 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-02 10:18:34,211 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:34,166 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:34,204 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:34,243 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,222 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-02 10:18:34,259 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-02 10:18:34,281 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-02 10:18:50,298 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-02 10:18:50,549 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1018_max_batch_time.svg
[rank3]:> Batch Time: 630.99 ms, GPU Bubble Ratio: 34.19%, 28.47%, 36.47%, 26.27%
[rank3]:2025-11-02 10:18:50,737 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1018_min_batch_time.svg
[rank3]:> Batch Time: 356.17 ms, GPU Bubble Ratio: 69.55%, 25.01%, 33.56%, 23.46%
[rank3]:2025-11-02 10:18:50,945 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1018_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 375.29 ms, GPU Bubble Ratio: 30.81%, 22.49%, 26.98%, 22.27%
[rank3]:2025-11-02 10:18:50,946 - INFO - 	> Batch Time: 375.29 ms (Average Freeze Ratio: 0.76, Time Reduction Rate: 0.41)
[rank0]:2025-11-02 10:19:37,385 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:19:39,532 - INFO - Avg. fwd time: 14.6669 / Avg. bwd time: 42.1512 / Avg. batch time: 470.1410 (ms) / GPU bubble ratio: 3.32%
[rank2]:2025-11-02 10:19:39,572 - INFO - Avg. fwd time: 13.2710 / Avg. bwd time: 35.8009 / Avg. batch time: 529.8615 (ms) / GPU bubble ratio: 25.91%
[rank1]:2025-11-02 10:19:39,640 - INFO - Avg. fwd time: 15.1248 / Avg. bwd time: 40.3001 / Avg. batch time: 588.7208 (ms) / GPU bubble ratio: 24.68%
[rank0]:2025-11-02 10:19:39,661 - INFO - Avg. fwd time: 13.6327 / Avg. bwd time: 36.5290 / Avg. batch time: 642.1087 (ms) / GPU bubble ratio: 37.50%
[rank2]:2025-11-02 10:19:39,759 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.28/0.84, [MB1] 0.28/0.84, [MB2] 0.26/0.77, [MB3] 0.00/0.00, [MB4] 0.29/0.86, [MB5] 0.30/0.91, [MB6] 0.32/0.95, [MB7] 0.33/1.00
[rank2]:2025-11-02 10:19:39,759 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1758  memory: 64.67GiB(46.25%)  tps: 6,554  tflops: 305.68  mfu: 30.91%
[rank1]:2025-11-02 10:19:39,762 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.31/0.94, [MB1] 0.04/0.13, [MB2] 0.31/0.93, [MB3] 0.32/0.96, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-02 10:19:39,762 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1758  memory: 72.68GiB(51.98%)  tps: 6,554  tflops: 305.67  mfu: 30.91%
[rank0]:2025-11-02 10:19:39,763 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.18/0.53, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.17/0.51, [MB7] 0.33/1.00
[rank0]:2025-11-02 10:19:39,763 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.1758  memory: 69.75GiB(49.89%)  tps: 6,554  tflops: 305.68  mfu: 30.91%
[rank3]:2025-11-02 10:19:44,352 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.07/0.20, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank3]:2025-11-02 10:19:44,356 - INFO -  step: 500  loss:  0.2982  grad_norm:  0.1758  memory: 84.49GiB(60.43%)  tps: 6,322  tflops: 294.85  mfu: 29.81%
[rank1]:2025-11-02 10:19:44,447 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1019_stage1_step500.svg
[rank2]:2025-11-02 10:19:44,440 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1019_stage2_step500.svg
[rank0]:2025-11-02 10:19:44,443 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1019_stage0_step500.svg
[rank3]:2025-11-02 10:19:44,534 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1019_real_step500_rank3.svg
[rank3]:> Batch Time: 375.52 ms, GPU Bubble Ratio: 67.55%, 23.90%, 32.79%, 22.95%
[rank3]:2025-11-02 10:19:44,599 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1019_stage3_step500.svg
[rank0]:2025-11-02 10:21:47,705 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:21:49,494 - INFO - Avg. fwd time: 14.7908 / Avg. bwd time: 40.8339 / Avg. batch time: 460.5632 (ms) / GPU bubble ratio: 3.38%
[rank1]:2025-11-02 10:21:49,560 - INFO - Avg. fwd time: 15.2054 / Avg. bwd time: 39.3905 / Avg. batch time: 586.6019 (ms) / GPU bubble ratio: 25.54%
[rank2]:2025-11-02 10:21:49,529 - INFO - Avg. fwd time: 13.3531 / Avg. bwd time: 34.9296 / Avg. batch time: 527.2269 (ms) / GPU bubble ratio: 26.74%
[rank0]:2025-11-02 10:21:49,575 - INFO - Avg. fwd time: 13.7010 / Avg. bwd time: 35.7103 / Avg. batch time: 639.1951 (ms) / GPU bubble ratio: 38.16%
[rank1]:2025-11-02 10:21:49,653 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.63/0.94, [MB1] 0.08/0.13, [MB2] 0.62/0.93, [MB3] 0.64/0.96, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-02 10:21:49,653 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1160  memory: 73.85GiB(52.82%)  tps: 6,307  tflops: 294.15  mfu: 29.74%
[rank2]:2025-11-02 10:21:49,655 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.56/0.84, [MB1] 0.56/0.84, [MB2] 0.51/0.77, [MB3] 0.00/0.00, [MB4] 0.58/0.86, [MB5] 0.61/0.91, [MB6] 0.64/0.95, [MB7] 0.67/1.00
[rank2]:2025-11-02 10:21:49,656 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1160  memory: 64.67GiB(46.25%)  tps: 6,307  tflops: 294.14  mfu: 29.74%
[rank0]:2025-11-02 10:21:49,655 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.35/0.53, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.34/0.51, [MB7] 0.67/1.00
[rank0]:2025-11-02 10:21:49,655 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.1160  memory: 72.58GiB(51.91%)  tps: 6,307  tflops: 294.15  mfu: 29.74%
[rank3]:2025-11-02 10:21:54,207 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.13/0.20, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2025-11-02 10:21:54,211 - INFO -  step: 550  loss:  0.1606  grad_norm:  0.1160  memory: 84.53GiB(60.46%)  tps: 6,309  tflops: 294.24  mfu: 29.75%
[rank0]:2025-11-02 10:23:43,561 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 10:23:45,304 - INFO - Avg. fwd time: 13.4945 / Avg. bwd time: 33.6439 / Avg. batch time: 522.4521 (ms) / GPU bubble ratio: 27.82%
[rank2]:2025-11-02 10:23:45,355 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.77/0.77, [MB3] 0.00/0.00, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:23:45,356 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0662  memory: 65.47GiB(46.83%)  tps: 7,080  tflops: 330.23  mfu: 33.39%
[rank1]:2025-11-02 10:23:45,332 - INFO - Avg. fwd time: 15.3622 / Avg. bwd time: 37.9706 / Avg. batch time: 580.8506 (ms) / GPU bubble ratio: 26.55%
[rank2]:2025-11-02 10:23:45,356 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 10:23:45,358 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.13/0.13, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:23:45,359 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0662  memory: 73.85GiB(52.82%)  tps: 7,080  tflops: 330.22  mfu: 33.39%
[rank1]:2025-11-02 10:23:45,359 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 10:23:45,280 - INFO - Avg. fwd time: 14.9702 / Avg. bwd time: 39.2049 / Avg. batch time: 448.9436 (ms) / GPU bubble ratio: 3.46%
[rank0]:2025-11-02 10:23:45,352 - INFO - Avg. fwd time: 13.8360 / Avg. bwd time: 34.2643 / Avg. batch time: 631.9888 (ms) / GPU bubble ratio: 39.11%
[rank0]:2025-11-02 10:23:45,357 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.53/0.53, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:23:45,357 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0662  memory: 72.58GiB(51.91%)  tps: 7,080  tflops: 330.23  mfu: 33.39%
[rank0]:2025-11-02 10:23:45,357 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 10:23:50,087 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.20/0.20, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 10:23:50,091 - INFO -  step: 600  loss:  0.4126  grad_norm:  0.0662  memory: 84.53GiB(60.46%)  tps: 7,069  tflops: 329.72  mfu: 33.34%
[rank3]:2025-11-02 10:23:50,091 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 10:24:06,522 - INFO - validate step: 600  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,354
[rank1]:2025-11-02 10:24:06,557 - INFO - validate step: 600  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,322
[rank2]:2025-11-02 10:24:06,595 - INFO - validate step: 600  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,286
[rank3]:2025-11-02 10:24:06,618 - INFO - validate step: 600  loss:  0.2457  memory: 84.53GiB(60.46%)  tps: 24,785
[rank0]:2025-11-02 10:24:06,687 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1024_stage0_step600.svg
[rank1]:2025-11-02 10:24:06,692 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1024_stage1_step600.svg
[rank2]:2025-11-02 10:24:06,690 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1024_stage2_step600.svg
[rank3]:2025-11-02 10:24:06,796 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1024_real_step600_rank3.svg
[rank3]:> Batch Time: 407.79 ms, GPU Bubble Ratio: 41.73%, 24.63%, 36.55%, 26.32%
[rank3]:2025-11-02 10:24:06,861 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1024_stage3_step600.svg
[rank0]:2025-11-02 10:25:46,460 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 10:25:47,781 - INFO - Avg. fwd time: 13.9697 / Avg. bwd time: 31.8794 / Avg. batch time: 622.7403 (ms) / GPU bubble ratio: 41.10%
[rank2]:2025-11-02 10:25:48,017 - INFO - Avg. fwd time: 13.6428 / Avg. bwd time: 32.4449 / Avg. batch time: 517.1373 (ms) / GPU bubble ratio: 28.70%
[rank1]:2025-11-02 10:25:48,043 - INFO - Avg. fwd time: 15.5331 / Avg. bwd time: 36.6156 / Avg. batch time: 574.0343 (ms) / GPU bubble ratio: 27.32%
[rank3]:2025-11-02 10:25:47,995 - INFO - Avg. fwd time: 15.1436 / Avg. bwd time: 37.8313 / Avg. batch time: 439.3303 (ms) / GPU bubble ratio: 3.54%
[rank0]:2025-11-02 10:25:48,097 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.53/0.53, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.51/0.51, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:25:48,097 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 8,065  tflops: 376.15  mfu: 38.03%
[rank2]:2025-11-02 10:25:48,096 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.84/0.84, [MB2] 0.77/0.77, [MB3] 0.00/0.00, [MB4] 0.86/0.86, [MB5] 0.91/0.91, [MB6] 0.95/0.95, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:25:48,096 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 8,071  tflops: 376.42  mfu: 38.06%
[rank1]:2025-11-02 10:25:48,097 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.94/0.94, [MB1] 0.13/0.13, [MB2] 0.93/0.93, [MB3] 0.96/0.96, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:25:48,097 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 8,068  tflops: 376.28  mfu: 38.05%
[rank3]:2025-11-02 10:25:52,723 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.20/0.20, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2025-11-02 10:25:52,727 - INFO -  step: 650  loss:  0.2702  grad_norm:  0.0000  memory: 84.53GiB(60.46%)  tps: 7,721  tflops: 360.09  mfu: 36.41%
[rank0]:2025-11-02 10:27:32,402 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:27:33,753 - INFO - Avg. fwd time: 14.0987 / Avg. bwd time: 29.4802 / Avg. batch time: 613.9107 (ms) / GPU bubble ratio: 43.21%
[rank3]:2025-11-02 10:27:33,968 - INFO - Avg. fwd time: 15.3143 / Avg. bwd time: 36.4494 / Avg. batch time: 429.6284 (ms) / GPU bubble ratio: 3.61%
[rank2]:2025-11-02 10:27:33,989 - INFO - Avg. fwd time: 13.7884 / Avg. bwd time: 31.2388 / Avg. batch time: 512.2693 (ms) / GPU bubble ratio: 29.68%
[rank1]:2025-11-02 10:27:34,016 - INFO - Avg. fwd time: 15.7008 / Avg. bwd time: 35.2557 / Avg. batch time: 567.6533 (ms) / GPU bubble ratio: 28.19%
[rank2]:2025-11-02 10:27:34,235 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1027_rank2_trend_line.svg
[rank3]:2025-11-02 10:27:34,222 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1027_rank3_trend_line.svg
[rank0]:2025-11-02 10:27:34,254 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1027_rank0_trend_line.svg
[rank0]:2025-11-02 10:27:34,261 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:27:34,262 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:27:34,263 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 7,716  tflops: 359.89  mfu: 36.39%
[rank2]:2025-11-02 10:27:34,261 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.64/0.64, [MB2] 0.64/0.64, [MB3] 0.64/0.64, [MB4] 0.64/0.64, [MB5] 0.64/0.64, [MB6] 0.15/0.15, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:27:34,263 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.84/0.84, [MB1] 0.64/0.64, [MB2] 0.64/0.64, [MB3] 0.64/0.64, [MB4] 0.64/0.64, [MB5] 0.64/0.64, [MB6] 0.15/0.15, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:27:34,263 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 7,716  tflops: 359.88  mfu: 36.39%
[rank1]:2025-11-02 10:27:34,254 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1027_rank1_trend_line.svg
[rank1]:2025-11-02 10:27:34,261 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.80/0.80, [MB1] 0.96/0.96, [MB2] 0.96/0.96, [MB3] 0.96/0.96, [MB4] 0.96/0.96, [MB5] 0.57/0.57, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:27:34,263 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.80/0.80, [MB1] 0.96/0.96, [MB2] 0.96/0.96, [MB3] 0.96/0.96, [MB4] 0.96/0.96, [MB5] 0.57/0.57, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:27:34,263 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 7,716  tflops: 359.89  mfu: 36.39%
[rank3]:2025-11-02 10:27:34,457 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1027_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 374.82 ms, GPU Bubble Ratio: 39.17%, 23.91%, 29.32%, 24.11%
[rank3]:2025-11-02 10:27:34,457 - INFO - 	> Batch Time: 374.82 ms (Average Freeze Ratio: 0.64)
[rank3]:2025-11-02 10:27:34,457 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 10:27:39,111 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 10:27:39,115 - INFO -  step: 700  loss:  0.4094  grad_norm:  0.0000  memory: 84.53GiB(60.46%)  tps: 7,700  tflops: 359.14  mfu: 36.31%
[rank0]:2025-11-02 10:27:39,187 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1027_stage0_step700.svg
[rank2]:2025-11-02 10:27:39,187 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1027_stage2_step700.svg
[rank1]:2025-11-02 10:27:39,191 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1027_stage1_step700.svg
[rank3]:2025-11-02 10:27:39,297 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1027_real_step700_rank3.svg
[rank3]:> Batch Time: 383.53 ms, GPU Bubble Ratio: 67.17%, 24.15%, 33.09%, 22.78%
[rank3]:2025-11-02 10:27:39,365 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1027_stage3_step700.svg
[rank0]:2025-11-02 10:29:34,558 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 10:29:36,517 - INFO - Avg. fwd time: 13.9074 / Avg. bwd time: 30.1860 / Avg. batch time: 512.0967 (ms) / GPU bubble ratio: 31.12%
[rank1]:2025-11-02 10:29:36,542 - INFO - Avg. fwd time: 15.8366 / Avg. bwd time: 34.0609 / Avg. batch time: 566.1242 (ms) / GPU bubble ratio: 29.49%
[rank0]:2025-11-02 10:29:36,549 - INFO - Avg. fwd time: 14.2050 / Avg. bwd time: 27.4168 / Avg. batch time: 610.2712 (ms) / GPU bubble ratio: 45.44%
[rank0]:2025-11-02 10:29:36,552 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,699  tflops: 312.44  mfu: 31.59%
[rank3]:2025-11-02 10:29:36,494 - INFO - Avg. fwd time: 15.3512 / Avg. bwd time: 36.0374 / Avg. batch time: 426.7672 (ms) / GPU bubble ratio: 3.67%
[rank1]:2025-11-02 10:29:36,552 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,699  tflops: 312.44  mfu: 31.59%
[rank2]:2025-11-02 10:29:36,552 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,699  tflops: 312.44  mfu: 31.59%
[rank3]:2025-11-02 10:29:41,153 - INFO -  step: 750  loss:  0.1495  grad_norm:  0.0266  memory: 84.53GiB(60.46%)  tps: 6,713  tflops: 313.08  mfu: 31.66%
[rank0]:2025-11-02 10:31:35,212 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:31:36,806 - INFO - Avg. fwd time: 14.2746 / Avg. bwd time: 25.8651 / Avg. batch time: 609.8226 (ms) / GPU bubble ratio: 47.34%
[rank3]:2025-11-02 10:31:37,099 - INFO - Avg. fwd time: 15.3600 / Avg. bwd time: 35.7706 / Avg. batch time: 424.8209 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-11-02 10:31:37,093 - INFO - Avg. fwd time: 13.9875 / Avg. bwd time: 29.3894 / Avg. batch time: 514.2810 (ms) / GPU bubble ratio: 32.52%
[rank1]:2025-11-02 10:31:37,131 - INFO - Avg. fwd time: 15.9266 / Avg. bwd time: 33.1580 / Avg. batch time: 567.2725 (ms) / GPU bubble ratio: 30.78%
[rank2]:2025-11-02 10:31:37,419 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1031_rank2_trend_line.svg
[rank2]:2025-11-02 10:31:37,441 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:31:37,443 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,776  tflops: 316.05  mfu: 31.96%
[rank2]:2025-11-02 10:31:37,443 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 10:31:37,434 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1031_rank1_trend_line.svg
[rank1]:2025-11-02 10:31:37,441 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.53/0.53, [MB1] 0.53/0.53, [MB2] 0.53/0.53, [MB3] 0.53/0.53, [MB4] 0.53/0.53, [MB5] 0.53/0.53, [MB6] 0.92/0.92, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:31:37,444 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,776  tflops: 316.05  mfu: 31.96%
[rank1]:2025-11-02 10:31:37,444 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 10:31:37,435 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1031_rank0_trend_line.svg
[rank0]:2025-11-02 10:31:37,441 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:31:37,443 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,776  tflops: 316.05  mfu: 31.96%
[rank0]:2025-11-02 10:31:37,443 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 10:31:37,403 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1031_rank3_trend_line.svg
[rank3]:2025-11-02 10:31:37,623 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1031_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 404.42 ms, GPU Bubble Ratio: 55.80%, 24.85%, 28.57%, 22.19%
[rank3]:2025-11-02 10:31:37,624 - INFO - 	> Batch Time: 404.42 ms (Average Freeze Ratio: 0.45)
[rank3]:2025-11-02 10:31:37,624 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 10:31:42,280 - INFO -  step: 800  loss:  0.3010  grad_norm:  0.0253  memory: 84.53GiB(60.46%)  tps: 6,763  tflops: 315.44  mfu: 31.89%
[rank3]:2025-11-02 10:31:42,280 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 10:31:58,573 - INFO - validate step: 800  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,386
[rank2]:2025-11-02 10:31:58,625 - INFO - validate step: 800  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,338
[rank1]:2025-11-02 10:31:58,609 - INFO - validate step: 800  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,353
[rank0]:2025-11-02 10:31:58,709 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1031_stage0_step800.svg
[rank3]:2025-11-02 10:31:58,633 - INFO - validate step: 800  loss:  0.2463  memory: 84.53GiB(60.46%)  tps: 25,049
[rank2]:2025-11-02 10:31:58,712 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1031_stage2_step800.svg
[rank1]:2025-11-02 10:31:58,709 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1031_stage1_step800.svg
[rank3]:2025-11-02 10:31:58,804 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1031_real_step800_rank3.svg
[rank3]:> Batch Time: 470.28 ms, GPU Bubble Ratio: 73.85%, 39.66%, 46.64%, 20.34%
[rank3]:2025-11-02 10:31:58,874 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1031_stage3_step800.svg
[rank0]:2025-11-02 10:33:53,562 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 10:33:55,103 - INFO - Avg. fwd time: 14.3534 / Avg. bwd time: 24.2631 / Avg. batch time: 607.0724 (ms) / GPU bubble ratio: 49.11%
[rank3]:2025-11-02 10:33:55,394 - INFO - Avg. fwd time: 15.3775 / Avg. bwd time: 35.4965 / Avg. batch time: 422.8897 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-11-02 10:33:55,388 - INFO - Avg. fwd time: 14.0763 / Avg. bwd time: 28.5687 / Avg. batch time: 514.2378 (ms) / GPU bubble ratio: 33.66%
[rank1]:2025-11-02 10:33:55,425 - INFO - Avg. fwd time: 16.0274 / Avg. bwd time: 32.2261 / Avg. batch time: 566.1654 (ms) / GPU bubble ratio: 31.82%
[rank0]:2025-11-02 10:33:55,503 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 7,006  tflops: 326.76  mfu: 33.04%
[rank2]:2025-11-02 10:33:55,502 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 7,009  tflops: 326.90  mfu: 33.05%
[rank1]:2025-11-02 10:33:55,503 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 7,008  tflops: 326.86  mfu: 33.05%
[rank3]:2025-11-02 10:34:00,076 - INFO -  step: 850  loss:  0.1328  grad_norm:  0.0176  memory: 84.53GiB(60.46%)  tps: 6,746  tflops: 314.62  mfu: 31.81%
[rank0]:2025-11-02 10:35:52,541 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:35:54,457 - INFO - Avg. fwd time: 15.3818 / Avg. bwd time: 35.2240 / Avg. batch time: 420.8314 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-11-02 10:35:54,480 - INFO - Avg. fwd time: 14.1446 / Avg. bwd time: 27.8397 / Avg. batch time: 515.0426 (ms) / GPU bubble ratio: 34.79%
[rank2]:2025-11-02 10:35:54,517 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,883  tflops: 321.03  mfu: 32.46%
[rank1]:2025-11-02 10:35:54,507 - INFO - Avg. fwd time: 16.1032 / Avg. bwd time: 31.3986 / Avg. batch time: 566.0167 (ms) / GPU bubble ratio: 32.86%
[rank1]:2025-11-02 10:35:54,517 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,883  tflops: 321.04  mfu: 32.46%
[rank0]:2025-11-02 10:35:54,514 - INFO - Avg. fwd time: 14.4111 / Avg. bwd time: 22.8479 / Avg. batch time: 605.4650 (ms) / GPU bubble ratio: 50.77%
[rank0]:2025-11-02 10:35:54,517 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,883  tflops: 321.03  mfu: 32.46%
[rank0]:2025-11-02 10:35:59,207 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1035_stage0_step900.svg
[rank3]:2025-11-02 10:35:59,137 - INFO -  step: 900  loss:  0.2029  grad_norm:  0.0190  memory: 84.53GiB(60.46%)  tps: 6,881  tflops: 320.91  mfu: 32.45%
[rank2]:2025-11-02 10:35:59,207 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1035_stage2_step900.svg
[rank1]:2025-11-02 10:35:59,206 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1035_stage1_step900.svg
[rank3]:2025-11-02 10:35:59,305 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1035_real_step900_rank3.svg
[rank3]:> Batch Time: 468.64 ms, GPU Bubble Ratio: 73.69%, 39.39%, 46.34%, 20.42%
[rank3]:2025-11-02 10:35:59,366 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1035_stage3_step900.svg
[rank0]:2025-11-02 10:37:53,021 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:37:54,584 - INFO - Avg. fwd time: 14.4608 / Avg. bwd time: 21.7601 / Avg. batch time: 604.0617 (ms) / GPU bubble ratio: 52.03%
[rank3]:2025-11-02 10:37:54,876 - INFO - Avg. fwd time: 15.3935 / Avg. bwd time: 35.0177 / Avg. batch time: 419.3456 (ms) / GPU bubble ratio: 3.83%
[rank2]:2025-11-02 10:37:54,870 - INFO - Avg. fwd time: 14.2021 / Avg. bwd time: 27.2814 / Avg. batch time: 515.4832 (ms) / GPU bubble ratio: 35.62%
[rank1]:2025-11-02 10:37:54,908 - INFO - Avg. fwd time: 16.1688 / Avg. bwd time: 30.7660 / Avg. batch time: 565.7320 (ms) / GPU bubble ratio: 33.63%
[rank0]:2025-11-02 10:37:54,985 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,800  tflops: 317.16  mfu: 32.07%
[rank2]:2025-11-02 10:37:54,985 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,800  tflops: 317.16  mfu: 32.07%
[rank1]:2025-11-02 10:37:54,986 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,800  tflops: 317.16  mfu: 32.07%
[rank3]:2025-11-02 10:37:59,720 - INFO -  step: 950  loss:  0.2754  grad_norm:  0.0322  memory: 84.53GiB(60.46%)  tps: 6,794  tflops: 316.86  mfu: 32.04%
[rank0]:2025-11-02 10:39:53,968 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:39:55,517 - INFO - Avg. fwd time: 14.5169 / Avg. bwd time: 20.6150 / Avg. batch time: 603.0834 (ms) / GPU bubble ratio: 53.40%
[rank3]:2025-11-02 10:39:55,804 - INFO - Avg. fwd time: 15.4076 / Avg. bwd time: 34.8162 / Avg. batch time: 417.9338 (ms) / GPU bubble ratio: 3.86%
[rank2]:2025-11-02 10:39:55,797 - INFO - Avg. fwd time: 14.2660 / Avg. bwd time: 26.6953 / Avg. batch time: 516.4383 (ms) / GPU bubble ratio: 36.55%
[rank1]:2025-11-02 10:39:55,834 - INFO - Avg. fwd time: 16.2422 / Avg. bwd time: 30.1008 / Avg. batch time: 565.9286 (ms) / GPU bubble ratio: 34.49%
[rank3]:2025-11-02 10:39:56,175 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1039_rank3_trend_line.svg
[rank2]:2025-11-02 10:39:56,222 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1039_rank2_trend_line.svg
[rank2]:2025-11-02 10:39:56,232 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank2]:2025-11-02 10:39:56,234 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,756  tflops: 315.12  mfu: 31.86%
[rank2]:2025-11-02 10:39:56,235 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 10:39:56,224 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1039_rank1_trend_line.svg
[rank1]:2025-11-02 10:39:56,232 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:39:56,235 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,756  tflops: 315.12  mfu: 31.86%
[rank1]:2025-11-02 10:39:56,235 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 10:39:56,226 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1039_rank0_trend_line.svg
[rank0]:2025-11-02 10:39:56,232 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank0]:2025-11-02 10:39:56,234 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,756  tflops: 315.12  mfu: 31.86%
[rank0]:2025-11-02 10:39:56,234 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 10:39:56,416 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1039_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 424.87 ms, GPU Bubble Ratio: 65.47%, 25.24%, 41.16%, 20.88%
[rank3]:2025-11-02 10:39:56,416 - INFO - 	> Batch Time: 424.87 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 10:39:56,417 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 10:40:00,974 - INFO -  step: 1000  loss:  0.1846  grad_norm:  0.0195  memory: 84.53GiB(60.46%)  tps: 6,756  tflops: 315.11  mfu: 31.86%
[rank3]:2025-11-02 10:40:00,974 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 10:40:17,166 - INFO - validate step: 1000  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,570
[rank3]:2025-11-02 10:40:17,220 - INFO - validate step: 1000  loss:  0.2486  memory: 84.53GiB(60.46%)  tps: 25,214
[rank2]:2025-11-02 10:40:17,216 - INFO - validate step: 1000  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,522
[rank1]:2025-11-02 10:40:17,200 - INFO - validate step: 1000  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,538
[rank0]:2025-11-02 10:40:17,308 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1040_stage0_step1000.svg
[rank2]:2025-11-02 10:40:17,295 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1040_stage2_step1000.svg
[rank1]:2025-11-02 10:40:17,290 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1040_stage1_step1000.svg
[rank3]:2025-11-02 10:40:17,393 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1040_real_step1000_rank3.svg
[rank3]:> Batch Time: 470.71 ms, GPU Bubble Ratio: 73.66%, 39.49%, 46.48%, 20.33%
[rank3]:2025-11-02 10:40:17,456 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1040_stage3_step1000.svg
[rank0]:2025-11-02 10:42:30,569 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 10:42:32,841 - INFO - Avg. fwd time: 15.4102 / Avg. bwd time: 34.6279 / Avg. batch time: 416.5225 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-11-02 10:42:32,865 - INFO - Avg. fwd time: 14.3176 / Avg. bwd time: 26.1662 / Avg. batch time: 516.0235 (ms) / GPU bubble ratio: 37.24%
[rank1]:2025-11-02 10:42:32,891 - INFO - Avg. fwd time: 16.2990 / Avg. bwd time: 29.5001 / Avg. batch time: 564.8265 (ms) / GPU bubble ratio: 35.13%
[rank1]:2025-11-02 10:42:32,979 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,033  tflops: 281.40  mfu: 28.45%
[rank2]:2025-11-02 10:42:32,979 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 6,034  tflops: 281.43  mfu: 28.46%
[rank0]:2025-11-02 10:42:32,968 - INFO - Avg. fwd time: 14.4938 / Avg. bwd time: 21.4064 / Avg. batch time: 605.2414 (ms) / GPU bubble ratio: 52.55%
[rank0]:2025-11-02 10:42:33,006 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5232  memory: 72.58GiB(51.91%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank3]:2025-11-02 10:42:37,553 - INFO -  step: 1050  loss:  0.2561  grad_norm:  0.5232  memory: 84.53GiB(60.46%)  tps: 5,838  tflops: 272.27  mfu: 27.53%
[rank0]:2025-11-02 10:44:53,120 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 10:44:55,274 - INFO - Avg. fwd time: 14.3704 / Avg. bwd time: 25.7571 / Avg. batch time: 517.4796 (ms) / GPU bubble ratio: 37.96%
[rank3]:2025-11-02 10:44:55,280 - INFO - Avg. fwd time: 15.4311 / Avg. bwd time: 34.4824 / Avg. batch time: 415.5863 (ms) / GPU bubble ratio: 3.92%
[rank1]:2025-11-02 10:44:55,310 - INFO - Avg. fwd time: 16.3608 / Avg. bwd time: 29.0371 / Avg. batch time: 565.7666 (ms) / GPU bubble ratio: 35.81%
[rank0]:2025-11-02 10:44:55,414 - INFO - Avg. fwd time: 14.4867 / Avg. bwd time: 22.1162 / Avg. batch time: 609.0064 (ms) / GPU bubble ratio: 51.92%
[rank1]:2025-11-02 10:44:55,490 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 5,748  tflops: 268.10  mfu: 27.11%
[rank2]:2025-11-02 10:44:55,490 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 5,748  tflops: 268.10  mfu: 27.11%
[rank0]:2025-11-02 10:44:55,517 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3358  memory: 72.58GiB(51.91%)  tps: 5,748  tflops: 268.10  mfu: 27.11%
[rank0]:2025-11-02 10:45:00,173 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1044_stage0_step1100.svg
[rank3]:2025-11-02 10:45:00,088 - INFO -  step: 1100  loss:  0.2427  grad_norm:  0.3358  memory: 84.53GiB(60.46%)  tps: 5,747  tflops: 268.06  mfu: 27.10%
[rank1]:2025-11-02 10:45:00,160 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1044_stage1_step1100.svg
[rank2]:2025-11-02 10:45:00,162 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1044_stage2_step1100.svg
[rank3]:2025-11-02 10:45:00,269 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1045_real_step1100_rank3.svg
[rank3]:> Batch Time: 567.15 ms, GPU Bubble Ratio: 24.98%, 49.07%, 55.01%, 33.08%
[rank3]:2025-11-02 10:45:00,332 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1045_stage3_step1100.svg
[rank0]:2025-11-02 10:47:14,967 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 10:47:17,112 - INFO - Avg. fwd time: 14.4186 / Avg. bwd time: 25.3173 / Avg. batch time: 517.2507 (ms) / GPU bubble ratio: 38.54%
[rank3]:2025-11-02 10:47:17,118 - INFO - Avg. fwd time: 15.4383 / Avg. bwd time: 34.3344 / Avg. batch time: 414.5582 (ms) / GPU bubble ratio: 3.95%
[rank1]:2025-11-02 10:47:17,149 - INFO - Avg. fwd time: 16.4178 / Avg. bwd time: 28.5402 / Avg. batch time: 564.9746 (ms) / GPU bubble ratio: 36.34%
[rank0]:2025-11-02 10:47:17,253 - INFO - Avg. fwd time: 14.4714 / Avg. bwd time: 22.8732 / Avg. batch time: 611.1601 (ms) / GPU bubble ratio: 51.12%
[rank0]:2025-11-02 10:47:17,356 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.6014  memory: 72.58GiB(51.91%)  tps: 5,776  tflops: 269.37  mfu: 27.24%
[rank1]:2025-11-02 10:47:17,329 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 5,776  tflops: 269.37  mfu: 27.24%
[rank2]:2025-11-02 10:47:17,329 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 5,776  tflops: 269.37  mfu: 27.24%
[rank3]:2025-11-02 10:47:22,009 - INFO -  step: 1150  loss:  0.2349  grad_norm:  0.6014  memory: 84.53GiB(60.46%)  tps: 5,772  tflops: 269.22  mfu: 27.22%
[rank0]:2025-11-02 10:49:36,153 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:49:38,410 - INFO - Avg. fwd time: 15.4455 / Avg. bwd time: 34.1847 / Avg. batch time: 413.4686 (ms) / GPU bubble ratio: 3.97%
[rank2]:2025-11-02 10:49:38,435 - INFO - Avg. fwd time: 14.4600 / Avg. bwd time: 24.9147 / Avg. batch time: 517.8073 (ms) / GPU bubble ratio: 39.17%
[rank1]:2025-11-02 10:49:38,461 - INFO - Avg. fwd time: 16.4655 / Avg. bwd time: 28.0843 / Avg. batch time: 565.0123 (ms) / GPU bubble ratio: 36.92%
[rank0]:2025-11-02 10:49:38,535 - INFO - Avg. fwd time: 14.4543 / Avg. bwd time: 23.5600 / Avg. batch time: 613.9587 (ms) / GPU bubble ratio: 50.47%
[rank3]:2025-11-02 10:49:38,879 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1049_rank3_trend_line.svg
[rank2]:2025-11-02 10:49:38,871 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1049_rank2_trend_line.svg
[rank1]:2025-11-02 10:49:38,865 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1049_rank1_trend_line.svg
[rank0]:2025-11-02 10:49:38,962 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1049_rank0_trend_line.svg
[rank0]:2025-11-02 10:49:38,970 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 10:49:38,973 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3117  memory: 72.58GiB(51.91%)  tps: 5,785  tflops: 269.80  mfu: 27.28%
[rank0]:2025-11-02 10:49:38,973 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 10:49:38,968 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank2]:2025-11-02 10:49:38,970 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 65.47GiB(46.83%)  tps: 5,784  tflops: 269.75  mfu: 27.28%
[rank2]:2025-11-02 10:49:38,970 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 10:49:38,968 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank1]:2025-11-02 10:49:38,970 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 5,784  tflops: 269.75  mfu: 27.28%
[rank1]:2025-11-02 10:49:38,970 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 10:49:39,152 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1049_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 433.18 ms, GPU Bubble Ratio: 47.24%, 35.26%, 43.66%, 20.42%
[rank3]:2025-11-02 10:49:39,153 - INFO - 	> Batch Time: 433.18 ms (Average Freeze Ratio: 0.29)
[rank3]:2025-11-02 10:49:39,153 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.20/0.20, [MB7] 1.00/1.00
[rank3]:2025-11-02 10:49:43,767 - INFO -  step: 1200  loss:  0.2850  grad_norm:  0.3117  memory: 84.53GiB(60.46%)  tps: 5,779  tflops: 269.53  mfu: 27.25%
[rank3]:2025-11-02 10:49:43,768 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 10:50:00,121 - INFO - validate step: 1200  loss:  0.2537  memory: 84.53GiB(60.46%)  tps: 25,048
[rank3]:2025-11-02 10:50:00,122 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 10:50:00,069 - INFO - validate step: 1200  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,417
[rank0]:2025-11-02 10:50:00,069 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 10:50:00,074 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 10:50:00,116 - INFO - validate step: 1200  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,371
[rank2]:2025-11-02 10:50:00,117 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 10:50:00,100 - INFO - validate step: 1200  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,385
[rank1]:2025-11-02 10:50:00,101 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 10:50:14,135 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.02 seconds.
[rank0]:2025-11-02 10:50:15,845 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-02 10:50:15,841 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.74 seconds.
[rank0]:2025-11-02 10:50:15,851 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.78 seconds.
[rank3]:2025-11-02 10:50:16,367 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.25 seconds.
[rank2]:2025-11-02 10:50:16,463 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1050_stage2_step1200.svg
[rank1]:2025-11-02 10:50:16,471 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1050_stage1_step1200.svg
[rank0]:2025-11-02 10:50:16,566 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1050_stage0_step1200.svg
[rank3]:2025-11-02 10:50:16,661 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1050_real_step1200_rank3.svg
[rank3]:> Batch Time: 562.58 ms, GPU Bubble Ratio: 24.94%, 49.24%, 55.17%, 33.15%
[rank3]:2025-11-02 10:50:16,740 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1050_stage3_step1200.svg
[rank0]:2025-11-02 10:52:27,816 - INFO - [GC] Peforming periodical GC collection 2.35 seconds
[rank0]:2025-11-02 10:52:29,574 - INFO - Avg. fwd time: 14.4926 / Avg. bwd time: 22.7160 / Avg. batch time: 615.3794 (ms) / GPU bubble ratio: 51.63%
[rank3]:2025-11-02 10:52:29,792 - INFO - Avg. fwd time: 15.5037 / Avg. bwd time: 33.7670 / Avg. batch time: 410.6548 (ms) / GPU bubble ratio: 4.02%
[rank2]:2025-11-02 10:52:29,950 - INFO - Avg. fwd time: 14.4092 / Avg. bwd time: 25.3529 / Avg. batch time: 520.8121 (ms) / GPU bubble ratio: 38.92%
[rank1]:2025-11-02 10:52:29,948 - INFO - Avg. fwd time: 16.5048 / Avg. bwd time: 27.7233 / Avg. batch time: 567.6030 (ms) / GPU bubble ratio: 37.66%
[rank0]:2025-11-02 10:52:30,036 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,463  tflops: 254.77  mfu: 25.76%
[rank2]:2025-11-02 10:52:30,055 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.1316  memory: 65.47GiB(46.83%)  tps: 5,464  tflops: 254.82  mfu: 25.77%
[rank1]:2025-11-02 10:52:30,035 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 5,464  tflops: 254.83  mfu: 25.77%
[rank3]:2025-11-02 10:52:34,681 - INFO -  step: 1250  loss:  0.2921  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 5,300  tflops: 247.21  mfu: 25.00%
[rank0]:2025-11-02 10:54:41,821 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:54:43,564 - INFO - Avg. fwd time: 14.5351 / Avg. bwd time: 21.7970 / Avg. batch time: 616.8077 (ms) / GPU bubble ratio: 52.88%
[rank3]:2025-11-02 10:54:43,782 - INFO - Avg. fwd time: 15.5695 / Avg. bwd time: 33.3151 / Avg. batch time: 407.5170 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-11-02 10:54:43,940 - INFO - Avg. fwd time: 14.3563 / Avg. bwd time: 25.8326 / Avg. batch time: 523.9726 (ms) / GPU bubble ratio: 38.64%
[rank1]:2025-11-02 10:54:43,938 - INFO - Avg. fwd time: 16.5489 / Avg. bwd time: 27.3339 / Avg. batch time: 570.3180 (ms) / GPU bubble ratio: 38.44%
[rank0]:2025-11-02 10:54:44,024 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,114  tflops: 285.16  mfu: 28.83%
[rank2]:2025-11-02 10:54:44,044 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0779  memory: 65.47GiB(46.83%)  tps: 6,114  tflops: 285.16  mfu: 28.83%
[rank1]:2025-11-02 10:54:44,024 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,114  tflops: 285.16  mfu: 28.83%
[rank3]:2025-11-02 10:54:48,741 - INFO -  step: 1300  loss:  0.1888  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 6,111  tflops: 285.01  mfu: 28.82%
[rank0]:2025-11-02 10:54:48,815 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1054_stage0_step1300.svg
[rank2]:2025-11-02 10:54:48,815 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1054_stage2_step1300.svg
[rank1]:2025-11-02 10:54:48,816 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1054_stage1_step1300.svg
[rank3]:2025-11-02 10:54:48,914 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1054_real_step1300_rank3.svg
[rank3]:> Batch Time: 518.47 ms, GPU Bubble Ratio: 76.37%, 45.46%, 22.62%, 39.26%
[rank3]:2025-11-02 10:54:48,979 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1054_stage3_step1300.svg
[rank0]:2025-11-02 10:56:56,902 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 10:56:58,972 - INFO - Avg. fwd time: 15.6361 / Avg. bwd time: 32.9044 / Avg. batch time: 404.7200 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-11-02 10:56:59,110 - INFO - Avg. fwd time: 14.3119 / Avg. bwd time: 26.2807 / Avg. batch time: 526.1120 (ms) / GPU bubble ratio: 38.28%
[rank2]:2025-11-02 10:56:59,171 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0903  memory: 65.47GiB(46.83%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank0]:2025-11-02 10:56:59,148 - INFO - Avg. fwd time: 14.5774 / Avg. bwd time: 20.9495 / Avg. batch time: 617.3645 (ms) / GPU bubble ratio: 53.96%
[rank0]:2025-11-02 10:56:59,151 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank1]:2025-11-02 10:56:59,139 - INFO - Avg. fwd time: 16.5943 / Avg. bwd time: 26.9770 / Avg. batch time: 572.0570 (ms) / GPU bubble ratio: 39.07%
[rank1]:2025-11-02 10:56:59,151 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,062  tflops: 282.75  mfu: 28.59%
[rank3]:2025-11-02 10:57:03,831 - INFO -  step: 1350  loss:  0.1310  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 6,064  tflops: 282.83  mfu: 28.60%
[rank0]:2025-11-02 10:59:10,558 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 10:59:12,342 - INFO - Avg. fwd time: 14.6065 / Avg. bwd time: 20.2738 / Avg. batch time: 618.9654 (ms) / GPU bubble ratio: 54.92%
[rank3]:2025-11-02 10:59:12,567 - INFO - Avg. fwd time: 15.6823 / Avg. bwd time: 32.5710 / Avg. batch time: 402.3865 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-11-02 10:59:12,724 - INFO - Avg. fwd time: 14.2719 / Avg. bwd time: 26.6342 / Avg. batch time: 528.9901 (ms) / GPU bubble ratio: 38.14%
[rank1]:2025-11-02 10:59:12,721 - INFO - Avg. fwd time: 16.6238 / Avg. bwd time: 26.6902 / Avg. batch time: 574.6056 (ms) / GPU bubble ratio: 39.70%
[rank1]:2025-11-02 10:59:12,808 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank1]:2025-11-02 10:59:12,808 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-02 10:59:12,828 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.1008  memory: 65.47GiB(46.83%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank2]:2025-11-02 10:59:12,828 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 10:59:12,808 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,129  tflops: 285.86  mfu: 28.90%
[rank0]:2025-11-02 10:59:12,809 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 10:59:17,419 - INFO -  step: 1400  loss:  0.3970  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 6,132  tflops: 286.02  mfu: 28.92%
[rank3]:2025-11-02 10:59:17,419 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 10:59:33,952 - INFO - validate step: 1400  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,373
[rank1]:2025-11-02 10:59:33,989 - INFO - validate step: 1400  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,339
[rank2]:2025-11-02 10:59:34,024 - INFO - validate step: 1400  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,326
[rank3]:2025-11-02 10:59:34,045 - INFO - validate step: 1400  loss:  0.2521  memory: 87.93GiB(62.89%)  tps: 24,638
[rank0]:2025-11-02 10:59:34,120 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1059_stage0_step1400.svg
[rank1]:2025-11-02 10:59:34,122 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1059_stage1_step1400.svg
[rank2]:2025-11-02 10:59:34,123 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1059_stage2_step1400.svg
[rank3]:2025-11-02 10:59:34,216 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1059_real_step1400_rank3.svg
[rank3]:> Batch Time: 523.32 ms, GPU Bubble Ratio: 76.28%, 45.43%, 22.62%, 39.09%
[rank3]:2025-11-02 10:59:34,283 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1059_stage3_step1400.svg
[rank0]:2025-11-02 11:01:43,635 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 11:01:45,391 - INFO - Avg. fwd time: 14.6482 / Avg. bwd time: 19.5386 / Avg. batch time: 619.6063 (ms) / GPU bubble ratio: 55.86%
[rank3]:2025-11-02 11:01:45,608 - INFO - Avg. fwd time: 15.7460 / Avg. bwd time: 32.2201 / Avg. batch time: 400.0525 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-11-02 11:01:45,765 - INFO - Avg. fwd time: 14.2373 / Avg. bwd time: 27.0271 / Avg. batch time: 530.9931 (ms) / GPU bubble ratio: 37.83%
[rank1]:2025-11-02 11:01:45,764 - INFO - Avg. fwd time: 16.6678 / Avg. bwd time: 26.3820 / Avg. batch time: 576.2631 (ms) / GPU bubble ratio: 40.24%
[rank2]:2025-11-02 11:01:45,868 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0964  memory: 65.47GiB(46.83%)  tps: 6,213  tflops: 289.79  mfu: 29.30%
[rank0]:2025-11-02 11:01:45,848 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,211  tflops: 289.68  mfu: 29.29%
[rank1]:2025-11-02 11:01:45,848 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,213  tflops: 289.76  mfu: 29.30%
[rank3]:2025-11-02 11:01:51,187 - INFO -  step: 1450  loss:  0.2065  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 5,973  tflops: 278.60  mfu: 28.17%
[rank0]:2025-11-02 11:04:01,543 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 11:04:03,662 - INFO - Avg. fwd time: 15.8069 / Avg. bwd time: 31.8939 / Avg. batch time: 397.8960 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-11-02 11:04:03,799 - INFO - Avg. fwd time: 14.2057 / Avg. bwd time: 27.3922 / Avg. batch time: 533.8324 (ms) / GPU bubble ratio: 37.66%
[rank1]:2025-11-02 11:04:03,829 - INFO - Avg. fwd time: 16.7101 / Avg. bwd time: 26.0965 / Avg. batch time: 578.7856 (ms) / GPU bubble ratio: 40.83%
[rank1]:2025-11-02 11:04:03,843 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 5,936  tflops: 276.88  mfu: 28.00%
[rank0]:2025-11-02 11:04:03,841 - INFO - Avg. fwd time: 14.6885 / Avg. bwd time: 18.8549 / Avg. batch time: 621.1821 (ms) / GPU bubble ratio: 56.80%
[rank0]:2025-11-02 11:04:03,844 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,936  tflops: 276.88  mfu: 28.00%
[rank2]:2025-11-02 11:04:03,864 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.1037  memory: 65.47GiB(46.83%)  tps: 5,936  tflops: 276.88  mfu: 28.00%
[rank3]:2025-11-02 11:04:08,472 - INFO -  step: 1500  loss:  0.2769  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 5,967  tflops: 278.31  mfu: 28.14%
[rank0]:2025-11-02 11:04:08,550 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1104_stage0_step1500.svg
[rank2]:2025-11-02 11:04:08,549 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1104_stage2_step1500.svg
[rank1]:2025-11-02 11:04:08,549 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1104_stage1_step1500.svg
[rank3]:2025-11-02 11:04:08,644 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1104_real_step1500_rank3.svg
[rank3]:> Batch Time: 528.89 ms, GPU Bubble Ratio: 76.09%, 45.30%, 22.87%, 38.62%
[rank3]:2025-11-02 11:04:08,712 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1104_stage3_step1500.svg
[rank0]:2025-11-02 11:06:17,556 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:06:19,341 - INFO - Avg. fwd time: 14.7217 / Avg. bwd time: 18.3058 / Avg. batch time: 621.9869 (ms) / GPU bubble ratio: 57.52%
[rank3]:2025-11-02 11:06:19,568 - INFO - Avg. fwd time: 15.8562 / Avg. bwd time: 31.6326 / Avg. batch time: 396.1731 (ms) / GPU bubble ratio: 4.10%
[rank2]:2025-11-02 11:06:19,725 - INFO - Avg. fwd time: 14.1809 / Avg. bwd time: 27.6856 / Avg. batch time: 535.6562 (ms) / GPU bubble ratio: 37.47%
[rank1]:2025-11-02 11:06:19,722 - INFO - Avg. fwd time: 16.7458 / Avg. bwd time: 25.8674 / Avg. batch time: 580.3538 (ms) / GPU bubble ratio: 41.26%
[rank2]:2025-11-02 11:06:19,828 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.1310  memory: 65.47GiB(46.83%)  tps: 6,025  tflops: 281.01  mfu: 28.41%
[rank1]:2025-11-02 11:06:19,808 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,025  tflops: 281.01  mfu: 28.41%
[rank0]:2025-11-02 11:06:19,808 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,025  tflops: 281.01  mfu: 28.41%
[rank3]:2025-11-02 11:06:24,495 - INFO -  step: 1550  loss:  0.3287  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 6,023  tflops: 280.90  mfu: 28.40%
[rank0]:2025-11-02 11:08:32,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:08:34,542 - INFO - Avg. fwd time: 14.7533 / Avg. bwd time: 17.7043 / Avg. batch time: 622.9907 (ms) / GPU bubble ratio: 58.32%
[rank3]:2025-11-02 11:08:34,766 - INFO - Avg. fwd time: 15.9039 / Avg. bwd time: 31.3416 / Avg. batch time: 394.1949 (ms) / GPU bubble ratio: 4.12%
[rank1]:2025-11-02 11:08:34,922 - INFO - Avg. fwd time: 16.7790 / Avg. bwd time: 25.6146 / Avg. batch time: 582.1969 (ms) / GPU bubble ratio: 41.75%
[rank2]:2025-11-02 11:08:34,923 - INFO - Avg. fwd time: 14.1493 / Avg. bwd time: 28.0034 / Avg. batch time: 537.7852 (ms) / GPU bubble ratio: 37.29%
[rank3]:2025-11-02 11:08:35,504 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1108_rank3_trend_line.svg
[rank1]:2025-11-02 11:08:35,602 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1108_rank1_trend_line.svg
[rank1]:2025-11-02 11:08:35,608 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 0.00/0.00
[rank1]:2025-11-02 11:08:35,611 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 73.85GiB(52.82%)  tps: 6,032  tflops: 281.35  mfu: 28.45%
[rank1]:2025-11-02 11:08:35,611 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 11:08:35,588 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1108_rank2_trend_line.svg
[rank2]:2025-11-02 11:08:35,609 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.09/0.09, [MB1] 0.09/0.09, [MB2] 0.09/0.09, [MB3] 0.09/0.09, [MB4] 0.09/0.09, [MB5] 0.09/0.09, [MB6] 0.19/0.19, [MB7] 1.00/1.00
[rank2]:2025-11-02 11:08:35,612 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.2483  memory: 65.47GiB(46.83%)  tps: 6,033  tflops: 281.39  mfu: 28.45%
[rank2]:2025-11-02 11:08:35,612 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 11:08:35,590 - INFO - Observed values (freeze ratio vs time) with Trend Line is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule_adjustment/251102_1108_rank0_trend_line.svg
[rank0]:2025-11-02 11:08:35,608 - INFO - Adjusted Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.00/0.00, [MB4] 0.00/0.00, [MB5] 0.00/0.00, [MB6] 0.00/0.00, [MB7] 1.00/1.00
[rank0]:2025-11-02 11:08:35,612 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,032  tflops: 281.35  mfu: 28.45%
[rank0]:2025-11-02 11:08:35,612 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-02 11:08:35,788 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1108_adjusted_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 414.06 ms, GPU Bubble Ratio: 55.48%, 34.27%, 27.03%, 20.76%
[rank3]:2025-11-02 11:08:35,788 - INFO - 	> Batch Time: 414.06 ms (Average Freeze Ratio: 0.31)
[rank3]:2025-11-02 11:08:35,789 - INFO - Adjusted Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 0.20/0.20
[rank3]:2025-11-02 11:08:40,503 - INFO -  step: 1600  loss:  0.4558  grad_norm:  0.0000  memory: 87.93GiB(62.89%)  tps: 6,023  tflops: 280.93  mfu: 28.41%
[rank3]:2025-11-02 11:08:40,503 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 11:08:57,067 - INFO - validate step: 1600  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,091
[rank0]:2025-11-02 11:08:57,031 - INFO - validate step: 1600  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,123
[rank3]:2025-11-02 11:08:57,125 - INFO - validate step: 1600  loss:  0.2559  memory: 87.93GiB(62.89%)  tps: 24,645
[rank2]:2025-11-02 11:08:57,103 - INFO - validate step: 1600  loss: -1.0000  memory: 65.47GiB(46.83%)  tps: 19,060
[rank1]:2025-11-02 11:08:57,201 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1108_stage1_step1600.svg
[rank2]:2025-11-02 11:08:57,200 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1108_stage2_step1600.svg
[rank0]:2025-11-02 11:08:57,203 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1108_stage0_step1600.svg
[rank3]:2025-11-02 11:08:57,300 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1108_real_step1600_rank3.svg
[rank3]:> Batch Time: 528.00 ms, GPU Bubble Ratio: 76.05%, 45.28%, 22.88%, 38.70%
[rank3]:2025-11-02 11:08:57,371 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1108_stage3_step1600.svg
[rank0]:2025-11-02 11:11:13,015 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 11:11:15,284 - INFO - Avg. fwd time: 15.9070 / Avg. bwd time: 31.3214 / Avg. batch time: 394.0321 (ms) / GPU bubble ratio: 4.11%
[rank2]:2025-11-02 11:11:15,311 - INFO - Avg. fwd time: 14.1983 / Avg. bwd time: 27.6637 / Avg. batch time: 537.4058 (ms) / GPU bubble ratio: 37.68%
[rank2]:2025-11-02 11:11:15,432 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,922  tflops: 276.21  mfu: 27.93%
[rank0]:2025-11-02 11:11:15,429 - INFO - Avg. fwd time: 14.7866 / Avg. bwd time: 17.1411 / Avg. batch time: 624.3528 (ms) / GPU bubble ratio: 59.09%
[rank0]:2025-11-02 11:11:15,432 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,919  tflops: 276.07  mfu: 27.91%
[rank1]:2025-11-02 11:11:15,418 - INFO - Avg. fwd time: 16.7414 / Avg. bwd time: 26.0881 / Avg. batch time: 584.3356 (ms) / GPU bubble ratio: 41.36%
[rank1]:2025-11-02 11:11:15,454 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.2502  memory: 73.85GiB(52.82%)  tps: 5,920  tflops: 276.09  mfu: 27.92%
[rank3]:2025-11-02 11:11:20,129 - INFO -  step: 1650  loss:  0.4660  grad_norm:  0.2502  memory: 87.93GiB(62.89%)  tps: 5,729  tflops: 267.18  mfu: 27.02%
[rank0]:2025-11-02 11:13:35,662 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:13:37,548 - INFO - Avg. fwd time: 14.8135 / Avg. bwd time: 16.6861 / Avg. batch time: 626.5209 (ms) / GPU bubble ratio: 59.78%
[rank2]:2025-11-02 11:13:37,837 - INFO - Avg. fwd time: 14.2411 / Avg. bwd time: 27.3600 / Avg. batch time: 538.0297 (ms) / GPU bubble ratio: 38.14%
[rank3]:2025-11-02 11:13:37,842 - INFO - Avg. fwd time: 15.9071 / Avg. bwd time: 31.3205 / Avg. batch time: 394.0036 (ms) / GPU bubble ratio: 4.11%
[rank1]:2025-11-02 11:13:37,983 - INFO - Avg. fwd time: 16.7081 / Avg. bwd time: 26.5042 / Avg. batch time: 587.1309 (ms) / GPU bubble ratio: 41.12%
[rank2]:2025-11-02 11:13:38,054 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank0]:2025-11-02 11:13:38,054 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,744  tflops: 267.90  mfu: 27.09%
[rank1]:2025-11-02 11:13:38,077 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.2755  memory: 73.85GiB(52.82%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank3]:2025-11-02 11:13:42,753 - INFO -  step: 1700  loss:  0.4607  grad_norm:  0.2755  memory: 87.93GiB(62.89%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank2]:2025-11-02 11:13:42,831 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1113_stage2_step1700.svg
[rank0]:2025-11-02 11:13:42,829 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1113_stage0_step1700.svg
[rank1]:2025-11-02 11:13:42,826 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1113_stage1_step1700.svg
[rank3]:2025-11-02 11:13:42,928 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1113_real_step1700_rank3.svg
[rank3]:> Batch Time: 558.64 ms, GPU Bubble Ratio: 77.46%, 17.82%, 54.13%, 31.86%
[rank3]:2025-11-02 11:13:42,997 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1113_stage3_step1700.svg
[rank0]:2025-11-02 11:15:57,994 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:15:59,890 - INFO - Avg. fwd time: 14.8423 / Avg. bwd time: 16.1849 / Avg. batch time: 627.6713 (ms) / GPU bubble ratio: 60.45%
[rank2]:2025-11-02 11:16:00,179 - INFO - Avg. fwd time: 14.2873 / Avg. bwd time: 27.0250 / Avg. batch time: 537.4922 (ms) / GPU bubble ratio: 38.51%
[rank3]:2025-11-02 11:16:00,185 - INFO - Avg. fwd time: 15.9058 / Avg. bwd time: 31.3242 / Avg. batch time: 393.9986 (ms) / GPU bubble ratio: 4.10%
[rank1]:2025-11-02 11:16:00,322 - INFO - Avg. fwd time: 16.6707 / Avg. bwd time: 26.9618 / Avg. batch time: 588.9744 (ms) / GPU bubble ratio: 40.73%
[rank2]:2025-11-02 11:16:00,393 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,755  tflops: 268.43  mfu: 27.14%
[rank1]:2025-11-02 11:16:00,416 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.2480  memory: 73.85GiB(52.82%)  tps: 5,755  tflops: 268.43  mfu: 27.14%
[rank0]:2025-11-02 11:16:00,392 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,755  tflops: 268.43  mfu: 27.14%
[rank3]:2025-11-02 11:16:05,069 - INFO -  step: 1750  loss:  0.4476  grad_norm:  0.2480  memory: 87.93GiB(62.89%)  tps: 5,756  tflops: 268.47  mfu: 27.15%
[rank0]:2025-11-02 11:18:18,034 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 11:18:20,213 - INFO - Avg. fwd time: 14.3223 / Avg. bwd time: 26.7067 / Avg. batch time: 537.4733 (ms) / GPU bubble ratio: 38.93%
[rank3]:2025-11-02 11:18:20,185 - INFO - Avg. fwd time: 15.8928 / Avg. bwd time: 31.3227 / Avg. batch time: 393.8575 (ms) / GPU bubble ratio: 4.10%
[rank1]:2025-11-02 11:18:20,317 - INFO - Avg. fwd time: 16.6251 / Avg. bwd time: 27.3864 / Avg. batch time: 591.1614 (ms) / GPU bubble ratio: 40.44%
[rank0]:2025-11-02 11:18:20,329 - INFO - Avg. fwd time: 14.8606 / Avg. bwd time: 15.7130 / Avg. batch time: 629.2249 (ms) / GPU bubble ratio: 61.13%
[rank0]:2025-11-02 11:18:20,332 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,854  tflops: 273.03  mfu: 27.61%
[rank0]:2025-11-02 11:18:20,332 - INFO - ðŸ”Ž  Running validation at step 1800
[rank2]:2025-11-02 11:18:20,332 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,854  tflops: 273.03  mfu: 27.61%
[rank2]:2025-11-02 11:18:20,332 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 11:18:20,354 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0617  memory: 73.85GiB(52.82%)  tps: 5,854  tflops: 273.03  mfu: 27.61%
[rank1]:2025-11-02 11:18:20,354 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 11:18:25,019 - INFO -  step: 1800  loss:  0.0655  grad_norm:  0.0617  memory: 87.93GiB(62.89%)  tps: 5,854  tflops: 273.01  mfu: 27.61%
[rank3]:2025-11-02 11:18:25,019 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 11:18:40,642 - INFO - validate step: 1800  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 20,190
[rank0]:2025-11-02 11:18:40,603 - INFO - validate step: 1800  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 20,207
[rank2]:2025-11-02 11:18:40,675 - INFO - validate step: 1800  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 20,135
[rank3]:2025-11-02 11:18:40,699 - INFO - validate step: 1800  loss:  0.2524  memory: 87.93GiB(62.89%)  tps: 26,124
[rank1]:2025-11-02 11:18:40,777 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1118_stage1_step1800.svg
[rank0]:2025-11-02 11:18:40,775 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1118_stage0_step1800.svg
[rank2]:2025-11-02 11:18:40,776 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1118_stage2_step1800.svg
[rank3]:2025-11-02 11:18:40,873 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1118_real_step1800_rank3.svg
[rank3]:> Batch Time: 545.08 ms, GPU Bubble Ratio: 77.95%, 17.81%, 54.37%, 33.11%
[rank3]:2025-11-02 11:18:40,942 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1118_stage3_step1800.svg
[rank0]:2025-11-02 11:20:53,457 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 11:20:55,289 - INFO - Avg. fwd time: 14.8745 / Avg. bwd time: 15.3298 / Avg. batch time: 630.3022 (ms) / GPU bubble ratio: 61.66%
[rank2]:2025-11-02 11:20:55,563 - INFO - Avg. fwd time: 14.3507 / Avg. bwd time: 26.4477 / Avg. batch time: 537.2679 (ms) / GPU bubble ratio: 39.25%
[rank3]:2025-11-02 11:20:55,569 - INFO - Avg. fwd time: 15.8831 / Avg. bwd time: 31.3074 / Avg. batch time: 393.6370 (ms) / GPU bubble ratio: 4.09%
[rank1]:2025-11-02 11:20:55,716 - INFO - Avg. fwd time: 16.5873 / Avg. bwd time: 27.7300 / Avg. batch time: 592.7519 (ms) / GPU bubble ratio: 40.19%
[rank1]:2025-11-02 11:20:55,807 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.1918  memory: 73.85GiB(52.82%)  tps: 6,061  tflops: 282.67  mfu: 28.58%
[rank0]:2025-11-02 11:20:55,784 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,060  tflops: 282.64  mfu: 28.58%
[rank2]:2025-11-02 11:20:55,785 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 6,063  tflops: 282.79  mfu: 28.59%
[rank3]:2025-11-02 11:21:00,459 - INFO -  step: 1850  loss:  0.3779  grad_norm:  0.1918  memory: 87.93GiB(62.89%)  tps: 5,862  tflops: 273.38  mfu: 27.64%
[rank0]:2025-11-02 11:23:12,167 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:23:13,990 - INFO - Avg. fwd time: 14.8868 / Avg. bwd time: 14.9058 / Avg. batch time: 631.6105 (ms) / GPU bubble ratio: 62.26%
[rank2]:2025-11-02 11:23:14,265 - INFO - Avg. fwd time: 14.3791 / Avg. bwd time: 26.1599 / Avg. batch time: 537.1527 (ms) / GPU bubble ratio: 39.62%
[rank3]:2025-11-02 11:23:14,272 - INFO - Avg. fwd time: 15.8704 / Avg. bwd time: 31.2767 / Avg. batch time: 393.2660 (ms) / GPU bubble ratio: 4.09%
[rank1]:2025-11-02 11:23:14,413 - INFO - Avg. fwd time: 16.5426 / Avg. bwd time: 28.1074 / Avg. batch time: 594.6278 (ms) / GPU bubble ratio: 39.93%
[rank0]:2025-11-02 11:23:14,482 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,906  tflops: 275.47  mfu: 27.85%
[rank2]:2025-11-02 11:23:14,482 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,906  tflops: 275.47  mfu: 27.85%
[rank1]:2025-11-02 11:23:14,505 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0921  memory: 73.85GiB(52.82%)  tps: 5,906  tflops: 275.47  mfu: 27.85%
[rank3]:2025-11-02 11:23:19,256 - INFO -  step: 1900  loss:  0.1953  grad_norm:  0.0921  memory: 87.93GiB(62.89%)  tps: 5,902  tflops: 275.28  mfu: 27.83%
[rank0]:2025-11-02 11:23:19,332 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1123_stage0_step1900.svg
[rank2]:2025-11-02 11:23:19,333 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1123_stage2_step1900.svg
[rank1]:2025-11-02 11:23:19,333 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1123_stage1_step1900.svg
[rank3]:2025-11-02 11:23:19,428 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1123_real_step1900_rank3.svg
[rank3]:> Batch Time: 547.54 ms, GPU Bubble Ratio: 77.80%, 17.70%, 54.26%, 33.63%
[rank3]:2025-11-02 11:23:19,496 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1123_stage3_step1900.svg
[rank0]:2025-11-02 11:25:31,411 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 11:25:33,585 - INFO - Avg. fwd time: 15.8549 / Avg. bwd time: 31.2499 / Avg. batch time: 392.9047 (ms) / GPU bubble ratio: 4.09%
[rank2]:2025-11-02 11:25:33,616 - INFO - Avg. fwd time: 14.4046 / Avg. bwd time: 25.8871 / Avg. batch time: 536.5194 (ms) / GPU bubble ratio: 39.92%
[rank0]:2025-11-02 11:25:33,739 - INFO - Avg. fwd time: 14.8971 / Avg. bwd time: 14.5046 / Avg. batch time: 632.3236 (ms) / GPU bubble ratio: 62.80%
[rank0]:2025-11-02 11:25:33,742 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,883  tflops: 274.36  mfu: 27.74%
[rank1]:2025-11-02 11:25:33,726 - INFO - Avg. fwd time: 16.4986 / Avg. bwd time: 28.4634 / Avg. batch time: 595.8729 (ms) / GPU bubble ratio: 39.64%
[rank1]:2025-11-02 11:25:33,764 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0810  memory: 73.85GiB(52.82%)  tps: 5,883  tflops: 274.36  mfu: 27.74%
[rank2]:2025-11-02 11:25:33,742 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,883  tflops: 274.36  mfu: 27.74%
[rank3]:2025-11-02 11:25:38,801 - INFO -  step: 1950  loss:  0.1620  grad_norm:  0.0810  memory: 87.93GiB(62.89%)  tps: 5,871  tflops: 273.81  mfu: 27.69%
[rank0]:2025-11-02 11:27:50,177 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:27:52,014 - INFO - Avg. fwd time: 14.9062 / Avg. bwd time: 14.1775 / Avg. batch time: 633.7797 (ms) / GPU bubble ratio: 63.29%
[rank2]:2025-11-02 11:27:52,291 - INFO - Avg. fwd time: 14.4251 / Avg. bwd time: 25.6647 / Avg. batch time: 536.8878 (ms) / GPU bubble ratio: 40.26%
[rank3]:2025-11-02 11:27:52,299 - INFO - Avg. fwd time: 15.8406 / Avg. bwd time: 31.2423 / Avg. batch time: 392.7107 (ms) / GPU bubble ratio: 4.09%
[rank0]:2025-11-02 11:27:52,509 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,903  tflops: 275.34  mfu: 27.84%
[rank0]:2025-11-02 11:27:52,509 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 11:27:52,441 - INFO - Avg. fwd time: 16.4624 / Avg. bwd time: 28.7540 / Avg. batch time: 597.7634 (ms) / GPU bubble ratio: 39.49%
[rank2]:2025-11-02 11:27:52,509 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,903  tflops: 275.34  mfu: 27.84%
[rank2]:2025-11-02 11:27:52,509 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 11:27:52,532 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0766  memory: 73.85GiB(52.82%)  tps: 5,903  tflops: 275.34  mfu: 27.84%
[rank1]:2025-11-02 11:27:52,532 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 11:27:57,227 - INFO -  step: 2000  loss:  0.1984  grad_norm:  0.0766  memory: 87.93GiB(62.89%)  tps: 5,918  tflops: 276.02  mfu: 27.91%
[rank3]:2025-11-02 11:27:57,228 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 11:28:12,849 - INFO - validate step: 2000  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 20,137
[rank2]:2025-11-02 11:28:12,922 - INFO - validate step: 2000  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 20,066
[rank1]:2025-11-02 11:28:12,889 - INFO - validate step: 2000  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 20,121
[rank3]:2025-11-02 11:28:12,945 - INFO - validate step: 2000  loss:  0.2462  memory: 87.93GiB(62.89%)  tps: 26,061
[rank0]:2025-11-02 11:28:13,024 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1128_stage0_step2000.svg
[rank2]:2025-11-02 11:28:13,025 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1128_stage2_step2000.svg
[rank1]:2025-11-02 11:28:13,026 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1128_stage1_step2000.svg
[rank3]:2025-11-02 11:28:13,117 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1128_real_step2000_rank3.svg
[rank3]:> Batch Time: 547.68 ms, GPU Bubble Ratio: 77.77%, 17.69%, 54.32%, 32.97%
[rank3]:2025-11-02 11:28:13,187 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1128_stage3_step2000.svg
[rank0]:2025-11-02 11:30:24,929 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 11:30:26,750 - INFO - Avg. fwd time: 14.9169 / Avg. bwd time: 13.8140 / Avg. batch time: 634.3839 (ms) / GPU bubble ratio: 63.77%
[rank2]:2025-11-02 11:30:27,026 - INFO - Avg. fwd time: 14.4489 / Avg. bwd time: 25.4176 / Avg. batch time: 536.2717 (ms) / GPU bubble ratio: 40.53%
[rank3]:2025-11-02 11:30:27,033 - INFO - Avg. fwd time: 15.8287 / Avg. bwd time: 31.2247 / Avg. batch time: 392.4550 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-11-02 11:30:27,177 - INFO - Avg. fwd time: 16.4229 / Avg. bwd time: 29.0772 / Avg. batch time: 598.8479 (ms) / GPU bubble ratio: 39.22%
[rank0]:2025-11-02 11:30:27,245 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,095  tflops: 284.29  mfu: 28.75%
[rank1]:2025-11-02 11:30:27,269 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0933  memory: 73.85GiB(52.82%)  tps: 6,096  tflops: 284.33  mfu: 28.75%
[rank2]:2025-11-02 11:30:27,246 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 6,099  tflops: 284.44  mfu: 28.76%
[rank3]:2025-11-02 11:30:31,971 - INFO -  step: 2050  loss:  0.2196  grad_norm:  0.0933  memory: 87.93GiB(62.89%)  tps: 5,893  tflops: 274.83  mfu: 27.79%
[rank0]:2025-11-02 11:32:43,483 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 11:32:45,659 - INFO - Avg. fwd time: 15.8167 / Avg. bwd time: 31.2089 / Avg. batch time: 392.2138 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-11-02 11:32:45,688 - INFO - Avg. fwd time: 14.4710 / Avg. bwd time: 25.1828 / Avg. batch time: 536.2033 (ms) / GPU bubble ratio: 40.84%
[rank1]:2025-11-02 11:32:45,792 - INFO - Avg. fwd time: 16.3851 / Avg. bwd time: 29.3840 / Avg. batch time: 600.3981 (ms) / GPU bubble ratio: 39.01%
[rank1]:2025-11-02 11:32:45,831 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0855  memory: 73.85GiB(52.82%)  tps: 5,912  tflops: 275.74  mfu: 27.88%
[rank2]:2025-11-02 11:32:45,809 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,912  tflops: 275.74  mfu: 27.88%
[rank0]:2025-11-02 11:32:45,806 - INFO - Avg. fwd time: 14.9267 / Avg. bwd time: 13.4688 / Avg. batch time: 635.4763 (ms) / GPU bubble ratio: 64.25%
[rank0]:2025-11-02 11:32:45,808 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,912  tflops: 275.74  mfu: 27.88%
[rank3]:2025-11-02 11:32:50,534 - INFO -  step: 2100  loss:  0.2252  grad_norm:  0.0855  memory: 87.93GiB(62.89%)  tps: 5,912  tflops: 275.75  mfu: 27.88%
[rank1]:2025-11-02 11:32:50,605 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1132_stage1_step2100.svg
[rank2]:2025-11-02 11:32:50,606 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1132_stage2_step2100.svg
[rank0]:2025-11-02 11:32:50,605 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1132_stage0_step2100.svg
[rank3]:2025-11-02 11:32:50,705 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1132_real_step2100_rank3.svg
[rank3]:> Batch Time: 549.69 ms, GPU Bubble Ratio: 77.72%, 17.79%, 54.30%, 32.86%
[rank3]:2025-11-02 11:32:50,767 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1132_stage3_step2100.svg
[rank0]:2025-11-02 11:35:02,296 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:35:04,103 - INFO - Avg. fwd time: 14.9348 / Avg. bwd time: 13.1863 / Avg. batch time: 636.2262 (ms) / GPU bubble ratio: 64.64%
[rank3]:2025-11-02 11:35:04,386 - INFO - Avg. fwd time: 15.8063 / Avg. bwd time: 31.1982 / Avg. batch time: 392.0286 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-11-02 11:35:04,378 - INFO - Avg. fwd time: 14.4889 / Avg. bwd time: 24.9907 / Avg. batch time: 536.0043 (ms) / GPU bubble ratio: 41.08%
[rank1]:2025-11-02 11:35:04,525 - INFO - Avg. fwd time: 16.3536 / Avg. bwd time: 29.6348 / Avg. batch time: 601.5228 (ms) / GPU bubble ratio: 38.84%
[rank1]:2025-11-02 11:35:04,615 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0830  memory: 73.85GiB(52.82%)  tps: 5,903  tflops: 275.30  mfu: 27.84%
[rank2]:2025-11-02 11:35:04,592 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,903  tflops: 275.30  mfu: 27.84%
[rank0]:2025-11-02 11:35:04,592 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,903  tflops: 275.30  mfu: 27.84%
[rank3]:2025-11-02 11:35:09,248 - INFO -  step: 2150  loss:  0.1843  grad_norm:  0.0830  memory: 87.93GiB(62.89%)  tps: 5,906  tflops: 275.45  mfu: 27.85%
[rank0]:2025-11-02 11:37:21,029 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:37:22,847 - INFO - Avg. fwd time: 14.9434 / Avg. bwd time: 12.8713 / Avg. batch time: 637.2414 (ms) / GPU bubble ratio: 65.08%
[rank2]:2025-11-02 11:37:23,120 - INFO - Avg. fwd time: 14.5087 / Avg. bwd time: 24.7766 / Avg. batch time: 535.9614 (ms) / GPU bubble ratio: 41.36%
[rank3]:2025-11-02 11:37:23,126 - INFO - Avg. fwd time: 15.7945 / Avg. bwd time: 31.1859 / Avg. batch time: 391.8186 (ms) / GPU bubble ratio: 4.08%
[rank1]:2025-11-02 11:37:23,267 - INFO - Avg. fwd time: 16.3187 / Avg. bwd time: 29.9146 / Avg. batch time: 602.9545 (ms) / GPU bubble ratio: 38.66%
[rank1]:2025-11-02 11:37:23,357 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0782  memory: 73.85GiB(52.82%)  tps: 5,905  tflops: 275.39  mfu: 27.84%
[rank1]:2025-11-02 11:37:23,357 - INFO - ðŸ”Ž  Running validation at step 2200
[rank2]:2025-11-02 11:37:23,334 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,905  tflops: 275.39  mfu: 27.84%
[rank2]:2025-11-02 11:37:23,334 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 11:37:23,334 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,905  tflops: 275.39  mfu: 27.84%
[rank0]:2025-11-02 11:37:23,334 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 11:37:28,011 - INFO -  step: 2200  loss:  0.1791  grad_norm:  0.0782  memory: 87.93GiB(62.89%)  tps: 5,904  tflops: 275.35  mfu: 27.84%
[rank3]:2025-11-02 11:37:28,012 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 11:37:43,684 - INFO - validate step: 2200  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 20,128
[rank1]:2025-11-02 11:37:43,719 - INFO - validate step: 2200  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 20,116
[rank2]:2025-11-02 11:37:43,752 - INFO - validate step: 2200  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 20,061
[rank3]:2025-11-02 11:37:43,776 - INFO - validate step: 2200  loss:  0.2454  memory: 87.93GiB(62.89%)  tps: 25,985
[rank1]:2025-11-02 11:37:43,848 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1137_stage1_step2200.svg
[rank2]:2025-11-02 11:37:43,848 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1137_stage2_step2200.svg
[rank0]:2025-11-02 11:37:43,849 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1137_stage0_step2200.svg
[rank3]:2025-11-02 11:37:43,952 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1137_real_step2200_rank3.svg
[rank3]:> Batch Time: 550.46 ms, GPU Bubble Ratio: 77.70%, 17.90%, 54.33%, 32.43%
[rank3]:2025-11-02 11:37:44,016 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1137_stage3_step2200.svg
[rank0]:2025-11-02 11:39:56,168 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 11:39:58,373 - INFO - Avg. fwd time: 14.5280 / Avg. bwd time: 24.5726 / Avg. batch time: 535.4600 (ms) / GPU bubble ratio: 41.58%
[rank3]:2025-11-02 11:39:58,343 - INFO - Avg. fwd time: 15.7841 / Avg. bwd time: 31.1661 / Avg. batch time: 391.5601 (ms) / GPU bubble ratio: 4.08%
[rank2]:2025-11-02 11:39:58,496 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 6,080  tflops: 283.56  mfu: 28.67%
[rank1]:2025-11-02 11:39:58,479 - INFO - Avg. fwd time: 16.2851 / Avg. bwd time: 30.1818 / Avg. batch time: 603.8618 (ms) / GPU bubble ratio: 38.44%
[rank0]:2025-11-02 11:39:58,493 - INFO - Avg. fwd time: 14.9519 / Avg. bwd time: 12.5711 / Avg. batch time: 637.7498 (ms) / GPU bubble ratio: 65.47%
[rank0]:2025-11-02 11:39:58,496 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 6,077  tflops: 283.42  mfu: 28.66%
[rank1]:2025-11-02 11:39:58,518 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0973  memory: 73.85GiB(52.82%)  tps: 6,077  tflops: 283.44  mfu: 28.66%
[rank3]:2025-11-02 11:40:03,192 - INFO -  step: 2250  loss:  0.2234  grad_norm:  0.0973  memory: 87.93GiB(62.89%)  tps: 5,876  tflops: 274.06  mfu: 27.71%
[rank0]:2025-11-02 11:42:14,729 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:42:16,555 - INFO - Avg. fwd time: 14.9589 / Avg. bwd time: 12.3247 / Avg. batch time: 638.9013 (ms) / GPU bubble ratio: 65.84%
[rank2]:2025-11-02 11:42:16,828 - INFO - Avg. fwd time: 14.5435 / Avg. bwd time: 24.4051 / Avg. batch time: 535.8036 (ms) / GPU bubble ratio: 41.85%
[rank3]:2025-11-02 11:42:16,838 - INFO - Avg. fwd time: 15.7746 / Avg. bwd time: 31.1602 / Avg. batch time: 391.4225 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-11-02 11:42:16,975 - INFO - Avg. fwd time: 16.2580 / Avg. bwd time: 30.4004 / Avg. batch time: 605.3385 (ms) / GPU bubble ratio: 38.34%
[rank1]:2025-11-02 11:42:17,066 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0827  memory: 73.85GiB(52.82%)  tps: 5,913  tflops: 275.77  mfu: 27.88%
[rank2]:2025-11-02 11:42:17,043 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,913  tflops: 275.77  mfu: 27.88%
[rank0]:2025-11-02 11:42:17,043 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,913  tflops: 275.77  mfu: 27.88%
[rank0]:2025-11-02 11:42:21,824 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1142_stage0_step2300.svg
[rank3]:2025-11-02 11:42:21,753 - INFO -  step: 2300  loss:  0.1952  grad_norm:  0.0827  memory: 87.93GiB(62.89%)  tps: 5,912  tflops: 275.75  mfu: 27.88%
[rank2]:2025-11-02 11:42:21,823 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1142_stage2_step2300.svg
[rank1]:2025-11-02 11:42:21,823 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1142_stage1_step2300.svg
[rank3]:2025-11-02 11:42:21,924 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1142_real_step2300_rank3.svg
[rank3]:> Batch Time: 550.00 ms, GPU Bubble Ratio: 77.71%, 17.91%, 54.37%, 31.87%
[rank3]:2025-11-02 11:42:21,987 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1142_stage3_step2300.svg
[rank0]:2025-11-02 11:44:33,488 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:44:35,317 - INFO - Avg. fwd time: 14.9666 / Avg. bwd time: 12.0491 / Avg. batch time: 639.2844 (ms) / GPU bubble ratio: 66.19%
[rank2]:2025-11-02 11:44:35,591 - INFO - Avg. fwd time: 14.5609 / Avg. bwd time: 24.2178 / Avg. batch time: 535.2627 (ms) / GPU bubble ratio: 42.04%
[rank3]:2025-11-02 11:44:35,599 - INFO - Avg. fwd time: 15.7637 / Avg. bwd time: 31.1544 / Avg. batch time: 391.2743 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-11-02 11:44:35,740 - INFO - Avg. fwd time: 16.2276 / Avg. bwd time: 30.6453 / Avg. batch time: 606.0872 (ms) / GPU bubble ratio: 38.13%
[rank2]:2025-11-02 11:44:35,808 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,904  tflops: 275.34  mfu: 27.84%
[rank0]:2025-11-02 11:44:35,807 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,904  tflops: 275.34  mfu: 27.84%
[rank1]:2025-11-02 11:44:35,830 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0741  memory: 73.85GiB(52.82%)  tps: 5,904  tflops: 275.34  mfu: 27.84%
[rank3]:2025-11-02 11:44:40,466 - INFO -  step: 2350  loss:  0.1816  grad_norm:  0.0741  memory: 87.93GiB(62.89%)  tps: 5,906  tflops: 275.45  mfu: 27.85%
[rank0]:2025-11-02 11:46:52,124 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 11:46:54,319 - INFO - Avg. fwd time: 15.7556 / Avg. bwd time: 31.1330 / Avg. batch time: 391.0229 (ms) / GPU bubble ratio: 4.07%
[rank2]:2025-11-02 11:46:54,349 - INFO - Avg. fwd time: 14.5779 / Avg. bwd time: 24.0386 / Avg. batch time: 535.2366 (ms) / GPU bubble ratio: 42.28%
[rank0]:2025-11-02 11:46:54,473 - INFO - Avg. fwd time: 14.9741 / Avg. bwd time: 11.7856 / Avg. batch time: 640.1451 (ms) / GPU bubble ratio: 66.56%
[rank0]:2025-11-02 11:46:54,475 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,908  tflops: 275.53  mfu: 27.86%
[rank0]:2025-11-02 11:46:54,476 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 11:46:54,459 - INFO - Avg. fwd time: 16.1989 / Avg. bwd time: 30.8791 / Avg. batch time: 607.2954 (ms) / GPU bubble ratio: 37.98%
[rank1]:2025-11-02 11:46:54,498 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0777  memory: 73.85GiB(52.82%)  tps: 5,908  tflops: 275.53  mfu: 27.86%
[rank1]:2025-11-02 11:46:54,498 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-02 11:46:54,476 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,908  tflops: 275.53  mfu: 27.86%
[rank2]:2025-11-02 11:46:54,476 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 11:46:59,148 - INFO -  step: 2400  loss:  0.1867  grad_norm:  0.0777  memory: 87.93GiB(62.89%)  tps: 5,907  tflops: 275.51  mfu: 27.86%
[rank3]:2025-11-02 11:46:59,148 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 11:47:14,819 - INFO - validate step: 2400  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 20,135
[rank0]:2025-11-02 11:47:14,819 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 11:47:14,827 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 11:47:14,893 - INFO - validate step: 2400  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 20,061
[rank2]:2025-11-02 11:47:14,894 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 11:47:14,858 - INFO - validate step: 2400  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 20,118
[rank1]:2025-11-02 11:47:14,859 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 11:47:14,916 - INFO - validate step: 2400  loss:  0.2436  memory: 87.93GiB(62.89%)  tps: 25,979
[rank3]:2025-11-02 11:47:14,917 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 11:47:28,380 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.49 seconds.
[rank1]:2025-11-02 11:47:29,750 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 14.89 seconds.
[rank3]:2025-11-02 11:47:30,198 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.28 seconds.
[rank0]:2025-11-02 11:47:31,002 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 11:47:31,006 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.19 seconds.
[rank2]:2025-11-02 11:47:31,105 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1147_stage2_step2400.svg
[rank1]:2025-11-02 11:47:31,110 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1147_stage1_step2400.svg
[rank0]:2025-11-02 11:47:31,175 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1147_stage0_step2400.svg
[rank3]:2025-11-02 11:47:31,321 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1147_real_step2400_rank3.svg
[rank3]:> Batch Time: 548.25 ms, GPU Bubble Ratio: 77.78%, 17.70%, 54.28%, 33.37%
[rank3]:2025-11-02 11:47:31,390 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1147_stage3_step2400.svg
[rank0]:2025-11-02 11:49:48,063 - INFO - [GC] Peforming periodical GC collection 2.16 seconds
[rank0]:2025-11-02 11:49:49,893 - INFO - Avg. fwd time: 14.9811 / Avg. bwd time: 11.5688 / Avg. batch time: 640.9987 (ms) / GPU bubble ratio: 66.86%
[rank2]:2025-11-02 11:49:50,166 - INFO - Avg. fwd time: 14.5913 / Avg. bwd time: 23.8910 / Avg. batch time: 535.3676 (ms) / GPU bubble ratio: 42.50%
[rank3]:2025-11-02 11:49:50,171 - INFO - Avg. fwd time: 15.7458 / Avg. bwd time: 31.1350 / Avg. batch time: 390.9491 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-11-02 11:49:50,318 - INFO - Avg. fwd time: 16.1747 / Avg. bwd time: 31.0713 / Avg. batch time: 608.4350 (ms) / GPU bubble ratio: 37.88%
[rank0]:2025-11-02 11:49:50,382 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,266  tflops: 245.61  mfu: 24.83%
[rank1]:2025-11-02 11:49:50,405 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0905  memory: 73.85GiB(52.82%)  tps: 5,267  tflops: 245.63  mfu: 24.84%
[rank2]:2025-11-02 11:49:50,383 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,269  tflops: 245.73  mfu: 24.85%
[rank3]:2025-11-02 11:49:55,199 - INFO -  step: 2450  loss:  0.2292  grad_norm:  0.0905  memory: 87.93GiB(62.89%)  tps: 5,111  tflops: 238.38  mfu: 24.10%
[rank0]:2025-11-02 11:52:08,171 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:52:10,000 - INFO - Avg. fwd time: 14.9883 / Avg. bwd time: 11.3256 / Avg. batch time: 641.9308 (ms) / GPU bubble ratio: 67.21%
[rank2]:2025-11-02 11:52:10,273 - INFO - Avg. fwd time: 14.6070 / Avg. bwd time: 23.7256 / Avg. batch time: 535.4870 (ms) / GPU bubble ratio: 42.73%
[rank3]:2025-11-02 11:52:10,279 - INFO - Avg. fwd time: 15.7371 / Avg. bwd time: 31.1244 / Avg. batch time: 390.7810 (ms) / GPU bubble ratio: 4.07%
[rank1]:2025-11-02 11:52:10,420 - INFO - Avg. fwd time: 16.1479 / Avg. bwd time: 31.2870 / Avg. batch time: 609.6886 (ms) / GPU bubble ratio: 37.76%
[rank2]:2025-11-02 11:52:10,486 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,847  tflops: 272.71  mfu: 27.57%
[rank0]:2025-11-02 11:52:10,485 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,847  tflops: 272.71  mfu: 27.57%
[rank1]:2025-11-02 11:52:10,509 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0868  memory: 73.85GiB(52.82%)  tps: 5,847  tflops: 272.71  mfu: 27.57%
[rank3]:2025-11-02 11:52:15,531 - INFO -  step: 2500  loss:  0.2119  grad_norm:  0.0868  memory: 87.93GiB(62.89%)  tps: 5,838  tflops: 272.27  mfu: 27.53%
[rank0]:2025-11-02 11:52:15,605 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1152_stage0_step2500.svg
[rank2]:2025-11-02 11:52:15,607 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1152_stage2_step2500.svg
[rank1]:2025-11-02 11:52:15,607 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1152_stage1_step2500.svg
[rank3]:2025-11-02 11:52:15,704 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1152_real_step2500_rank3.svg
[rank3]:> Batch Time: 549.15 ms, GPU Bubble Ratio: 77.70%, 17.83%, 54.32%, 32.84%
[rank3]:2025-11-02 11:52:15,770 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1152_stage3_step2500.svg
[rank0]:2025-11-02 11:54:30,288 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 11:54:32,527 - INFO - Avg. fwd time: 15.7346 / Avg. bwd time: 31.1144 / Avg. batch time: 390.6682 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-02 11:54:32,558 - INFO - Avg. fwd time: 14.6258 / Avg. bwd time: 23.5688 / Avg. batch time: 535.2032 (ms) / GPU bubble ratio: 42.91%
[rank0]:2025-11-02 11:54:32,676 - INFO - Avg. fwd time: 14.9990 / Avg. bwd time: 11.0925 / Avg. batch time: 642.4353 (ms) / GPU bubble ratio: 67.51%
[rank0]:2025-11-02 11:54:32,679 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,761  tflops: 268.70  mfu: 27.17%
[rank1]:2025-11-02 11:54:32,660 - INFO - Avg. fwd time: 16.1268 / Avg. bwd time: 31.4975 / Avg. batch time: 610.5094 (ms) / GPU bubble ratio: 37.59%
[rank1]:2025-11-02 11:54:32,701 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.1648  memory: 73.85GiB(52.82%)  tps: 5,761  tflops: 268.70  mfu: 27.17%
[rank2]:2025-11-02 11:54:32,679 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,761  tflops: 268.70  mfu: 27.17%
[rank3]:2025-11-02 11:54:37,657 - INFO -  step: 2550  loss:  0.4512  grad_norm:  0.1648  memory: 87.93GiB(62.89%)  tps: 5,764  tflops: 268.83  mfu: 27.18%
[rank0]:2025-11-02 11:56:52,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 11:56:54,340 - INFO - Avg. fwd time: 15.0094 / Avg. bwd time: 10.9002 / Avg. batch time: 643.5961 (ms) / GPU bubble ratio: 67.79%
[rank3]:2025-11-02 11:56:54,632 - INFO - Avg. fwd time: 15.7334 / Avg. bwd time: 31.1137 / Avg. batch time: 390.6442 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-02 11:56:54,625 - INFO - Avg. fwd time: 14.6428 / Avg. bwd time: 23.4397 / Avg. batch time: 535.7215 (ms) / GPU bubble ratio: 43.13%
[rank1]:2025-11-02 11:56:54,769 - INFO - Avg. fwd time: 16.1108 / Avg. bwd time: 31.6717 / Avg. batch time: 611.9397 (ms) / GPU bubble ratio: 37.53%
[rank0]:2025-11-02 11:56:54,834 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,763  tflops: 268.77  mfu: 27.18%
[rank0]:2025-11-02 11:56:54,834 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 11:56:54,857 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.1359  memory: 73.85GiB(52.82%)  tps: 5,763  tflops: 268.77  mfu: 27.18%
[rank1]:2025-11-02 11:56:54,857 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 11:56:54,834 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,763  tflops: 268.77  mfu: 27.18%
[rank2]:2025-11-02 11:56:54,834 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-02 11:56:59,862 - INFO -  step: 2600  loss:  0.3849  grad_norm:  0.1359  memory: 87.93GiB(62.89%)  tps: 5,761  tflops: 268.68  mfu: 27.17%
[rank3]:2025-11-02 11:56:59,862 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 11:57:15,435 - INFO - validate step: 2600  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,883
[rank2]:2025-11-02 11:57:15,505 - INFO - validate step: 2600  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 19,816
[rank1]:2025-11-02 11:57:15,473 - INFO - validate step: 2600  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,868
[rank3]:2025-11-02 11:57:15,529 - INFO - validate step: 2600  loss:  0.2472  memory: 87.93GiB(62.89%)  tps: 26,145
[rank0]:2025-11-02 11:57:15,604 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1157_stage0_step2600.svg
[rank2]:2025-11-02 11:57:15,604 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1157_stage2_step2600.svg
[rank1]:2025-11-02 11:57:15,603 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1157_stage1_step2600.svg
[rank3]:2025-11-02 11:57:15,702 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1157_real_step2600_rank3.svg
[rank3]:> Batch Time: 555.28 ms, GPU Bubble Ratio: 77.51%, 17.97%, 54.23%, 31.66%
[rank3]:2025-11-02 11:57:15,767 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1157_stage3_step2600.svg
[rank0]:2025-11-02 11:59:30,796 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-02 11:59:32,655 - INFO - Avg. fwd time: 15.0209 / Avg. bwd time: 10.6842 / Avg. batch time: 644.0777 (ms) / GPU bubble ratio: 68.07%
[rank2]:2025-11-02 11:59:32,930 - INFO - Avg. fwd time: 14.6618 / Avg. bwd time: 23.2949 / Avg. batch time: 535.4802 (ms) / GPU bubble ratio: 43.29%
[rank3]:2025-11-02 11:59:32,939 - INFO - Avg. fwd time: 15.7323 / Avg. bwd time: 31.1129 / Avg. batch time: 390.6185 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-02 11:59:33,145 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,952  tflops: 277.59  mfu: 28.07%
[rank1]:2025-11-02 11:59:33,079 - INFO - Avg. fwd time: 16.0933 / Avg. bwd time: 31.8676 / Avg. batch time: 612.7249 (ms) / GPU bubble ratio: 37.38%
[rank0]:2025-11-02 11:59:33,144 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,949  tflops: 277.45  mfu: 28.05%
[rank1]:2025-11-02 11:59:33,168 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.1347  memory: 73.85GiB(52.82%)  tps: 5,949  tflops: 277.48  mfu: 28.06%
[rank3]:2025-11-02 11:59:38,181 - INFO -  step: 2650  loss:  0.3083  grad_norm:  0.1347  memory: 87.93GiB(62.89%)  tps: 5,743  tflops: 267.84  mfu: 27.08%
[rank0]:2025-11-02 12:01:53,151 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 12:01:55,380 - INFO - Avg. fwd time: 15.7316 / Avg. bwd time: 31.1088 / Avg. batch time: 390.5695 (ms) / GPU bubble ratio: 4.06%
[rank2]:2025-11-02 12:01:55,412 - INFO - Avg. fwd time: 14.6801 / Avg. bwd time: 23.1555 / Avg. batch time: 535.6948 (ms) / GPU bubble ratio: 43.50%
[rank1]:2025-11-02 12:01:55,517 - INFO - Avg. fwd time: 16.0764 / Avg. bwd time: 32.0559 / Avg. batch time: 613.9241 (ms) / GPU bubble ratio: 37.28%
[rank1]:2025-11-02 12:01:55,559 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.1479  memory: 73.85GiB(52.82%)  tps: 5,753  tflops: 268.33  mfu: 27.13%
[rank2]:2025-11-02 12:01:55,537 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,753  tflops: 268.33  mfu: 27.13%
[rank0]:2025-11-02 12:01:55,534 - INFO - Avg. fwd time: 15.0323 / Avg. bwd time: 10.4765 / Avg. batch time: 644.9859 (ms) / GPU bubble ratio: 68.36%
[rank0]:2025-11-02 12:01:55,537 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,753  tflops: 268.33  mfu: 27.13%
[rank3]:2025-11-02 12:02:00,568 - INFO -  step: 2700  loss:  0.3369  grad_norm:  0.1479  memory: 87.93GiB(62.89%)  tps: 5,753  tflops: 268.34  mfu: 27.13%
[rank1]:2025-11-02 12:02:00,640 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1201_stage1_step2700.svg
[rank2]:2025-11-02 12:02:00,643 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1201_stage2_step2700.svg
[rank0]:2025-11-02 12:02:00,642 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1201_stage0_step2700.svg
[rank3]:2025-11-02 12:02:00,741 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1202_real_step2700_rank3.svg
[rank3]:> Batch Time: 554.73 ms, GPU Bubble Ratio: 77.53%, 17.79%, 54.24%, 33.02%
[rank3]:2025-11-02 12:02:00,806 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1202_stage3_step2700.svg
[rank0]:2025-11-02 12:04:15,829 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 12:04:17,692 - INFO - Avg. fwd time: 15.0418 / Avg. bwd time: 10.3048 / Avg. batch time: 645.6291 (ms) / GPU bubble ratio: 68.59%
[rank2]:2025-11-02 12:04:17,972 - INFO - Avg. fwd time: 14.6950 / Avg. bwd time: 23.0402 / Avg. batch time: 535.7624 (ms) / GPU bubble ratio: 43.65%
[rank3]:2025-11-02 12:04:17,980 - INFO - Avg. fwd time: 15.7314 / Avg. bwd time: 31.1047 / Avg. batch time: 390.5268 (ms) / GPU bubble ratio: 4.06%
[rank1]:2025-11-02 12:04:18,119 - INFO - Avg. fwd time: 16.0621 / Avg. bwd time: 32.2116 / Avg. batch time: 614.8073 (ms) / GPU bubble ratio: 37.19%
[rank0]:2025-11-02 12:04:18,185 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,743  tflops: 267.85  mfu: 27.08%
[rank1]:2025-11-02 12:04:18,208 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.1160  memory: 73.85GiB(52.82%)  tps: 5,743  tflops: 267.84  mfu: 27.08%
[rank2]:2025-11-02 12:04:18,185 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,743  tflops: 267.85  mfu: 27.08%
[rank3]:2025-11-02 12:04:23,181 - INFO -  step: 2750  loss:  0.2810  grad_norm:  0.1160  memory: 87.93GiB(62.89%)  tps: 5,744  tflops: 267.92  mfu: 27.09%
[rank0]:2025-11-02 12:06:38,083 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 12:06:39,944 - INFO - Avg. fwd time: 15.0523 / Avg. bwd time: 10.1115 / Avg. batch time: 646.4688 (ms) / GPU bubble ratio: 68.86%
[rank2]:2025-11-02 12:06:40,224 - INFO - Avg. fwd time: 14.7119 / Avg. bwd time: 22.9105 / Avg. batch time: 535.9549 (ms) / GPU bubble ratio: 43.84%
[rank3]:2025-11-02 12:06:40,231 - INFO - Avg. fwd time: 15.7305 / Avg. bwd time: 31.1056 / Avg. batch time: 390.5182 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-11-02 12:06:40,375 - INFO - Avg. fwd time: 16.0462 / Avg. bwd time: 32.3870 / Avg. batch time: 615.9181 (ms) / GPU bubble ratio: 37.09%
[rank0]:2025-11-02 12:06:40,440 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,759  tflops: 268.59  mfu: 27.16%
[rank0]:2025-11-02 12:06:40,440 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 12:06:40,463 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.1546  memory: 73.85GiB(52.82%)  tps: 5,759  tflops: 268.59  mfu: 27.16%
[rank1]:2025-11-02 12:06:40,463 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 12:06:40,441 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,759  tflops: 268.59  mfu: 27.16%
[rank2]:2025-11-02 12:06:40,441 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-02 12:06:45,437 - INFO -  step: 2800  loss:  0.2805  grad_norm:  0.1546  memory: 87.93GiB(62.89%)  tps: 5,759  tflops: 268.59  mfu: 27.16%
[rank3]:2025-11-02 12:06:45,437 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 12:07:01,413 - INFO - validate step: 2800  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,531
[rank1]:2025-11-02 12:07:01,454 - INFO - validate step: 2800  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,514
[rank2]:2025-11-02 12:07:01,489 - INFO - validate step: 2800  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 19,461
[rank3]:2025-11-02 12:07:01,514 - INFO - validate step: 2800  loss:  0.2448  memory: 87.93GiB(62.89%)  tps: 25,478
[rank1]:2025-11-02 12:07:01,587 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1207_stage1_step2800.svg
[rank2]:2025-11-02 12:07:01,590 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1207_stage2_step2800.svg
[rank0]:2025-11-02 12:07:01,590 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1207_stage0_step2800.svg
[rank3]:2025-11-02 12:07:01,696 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1207_real_step2800_rank3.svg
[rank3]:> Batch Time: 553.86 ms, GPU Bubble Ratio: 77.57%, 17.78%, 54.22%, 33.91%
[rank3]:2025-11-02 12:07:01,763 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1207_stage3_step2800.svg
[rank0]:2025-11-02 12:09:17,300 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 12:09:19,578 - INFO - Avg. fwd time: 14.7287 / Avg. bwd time: 22.7857 / Avg. batch time: 535.7695 (ms) / GPU bubble ratio: 43.98%
[rank3]:2025-11-02 12:09:19,545 - INFO - Avg. fwd time: 15.7296 / Avg. bwd time: 31.1088 / Avg. batch time: 390.5271 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-11-02 12:09:19,676 - INFO - Avg. fwd time: 16.0315 / Avg. bwd time: 32.5561 / Avg. batch time: 616.6169 (ms) / GPU bubble ratio: 36.96%
[rank1]:2025-11-02 12:09:19,720 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.1407  memory: 73.85GiB(52.82%)  tps: 5,925  tflops: 276.34  mfu: 27.94%
[rank2]:2025-11-02 12:09:19,697 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,927  tflops: 276.45  mfu: 27.95%
[rank0]:2025-11-02 12:09:19,694 - INFO - Avg. fwd time: 15.0629 / Avg. bwd time: 9.9253 / Avg. batch time: 646.9063 (ms) / GPU bubble ratio: 69.10%
[rank0]:2025-11-02 12:09:19,697 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,924  tflops: 276.30  mfu: 27.94%
[rank3]:2025-11-02 12:09:24,592 - INFO -  step: 2850  loss:  0.3886  grad_norm:  0.1407  memory: 87.93GiB(62.89%)  tps: 5,726  tflops: 267.04  mfu: 27.00%
[rank0]:2025-11-02 12:11:39,136 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 12:11:41,000 - INFO - Avg. fwd time: 15.0713 / Avg. bwd time: 9.7710 / Avg. batch time: 647.8443 (ms) / GPU bubble ratio: 69.32%
[rank2]:2025-11-02 12:11:41,280 - INFO - Avg. fwd time: 14.7422 / Avg. bwd time: 22.6822 / Avg. batch time: 536.1984 (ms) / GPU bubble ratio: 44.16%
[rank3]:2025-11-02 12:11:41,289 - INFO - Avg. fwd time: 15.7282 / Avg. bwd time: 31.1141 / Avg. batch time: 390.5506 (ms) / GPU bubble ratio: 4.05%
[rank1]:2025-11-02 12:11:41,426 - INFO - Avg. fwd time: 16.0185 / Avg. bwd time: 32.6959 / Avg. batch time: 617.7708 (ms) / GPU bubble ratio: 36.92%
[rank0]:2025-11-02 12:11:41,492 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,777  tflops: 269.46  mfu: 27.25%
[rank2]:2025-11-02 12:11:41,492 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,777  tflops: 269.46  mfu: 27.25%
[rank1]:2025-11-02 12:11:41,515 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.1461  memory: 73.85GiB(52.82%)  tps: 5,777  tflops: 269.46  mfu: 27.25%
[rank3]:2025-11-02 12:11:46,366 - INFO -  step: 2900  loss:  0.3721  grad_norm:  0.1461  memory: 87.93GiB(62.89%)  tps: 5,778  tflops: 269.50  mfu: 27.25%
[rank0]:2025-11-02 12:11:46,443 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1211_stage0_step2900.svg
[rank2]:2025-11-02 12:11:46,443 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1211_stage2_step2900.svg
[rank1]:2025-11-02 12:11:46,442 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1211_stage1_step2900.svg
[rank3]:2025-11-02 12:11:46,542 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1211_real_step2900_rank3.svg
[rank3]:> Batch Time: 554.23 ms, GPU Bubble Ratio: 77.51%, 17.93%, 54.19%, 32.75%
[rank3]:2025-11-02 12:11:46,612 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1211_stage3_step2900.svg
[rank0]:2025-11-02 12:14:01,559 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 12:14:03,424 - INFO - Avg. fwd time: 15.0811 / Avg. bwd time: 9.5971 / Avg. batch time: 648.1969 (ms) / GPU bubble ratio: 69.54%
[rank2]:2025-11-02 12:14:03,707 - INFO - Avg. fwd time: 14.7580 / Avg. bwd time: 22.5656 / Avg. batch time: 535.9691 (ms) / GPU bubble ratio: 44.29%
[rank3]:2025-11-02 12:14:03,716 - INFO - Avg. fwd time: 15.7285 / Avg. bwd time: 31.1103 / Avg. batch time: 390.5142 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-11-02 12:14:03,924 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,752  tflops: 268.25  mfu: 27.12%
[rank1]:2025-11-02 12:14:03,859 - INFO - Avg. fwd time: 16.0049 / Avg. bwd time: 32.8541 / Avg. batch time: 618.3691 (ms) / GPU bubble ratio: 36.79%
[rank1]:2025-11-02 12:14:03,947 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.1897  memory: 73.85GiB(52.82%)  tps: 5,752  tflops: 268.25  mfu: 27.12%
[rank0]:2025-11-02 12:14:03,924 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,752  tflops: 268.25  mfu: 27.12%
[rank3]:2025-11-02 12:14:08,869 - INFO -  step: 2950  loss:  0.4186  grad_norm:  0.1897  memory: 87.93GiB(62.89%)  tps: 5,749  tflops: 268.12  mfu: 27.11%
[rank0]:2025-11-02 12:16:23,875 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 12:16:26,119 - INFO - Avg. fwd time: 14.7729 / Avg. bwd time: 22.4532 / Avg. batch time: 536.1443 (ms) / GPU bubble ratio: 44.45%
[rank3]:2025-11-02 12:16:26,084 - INFO - Avg. fwd time: 15.7281 / Avg. bwd time: 31.1082 / Avg. batch time: 390.4858 (ms) / GPU bubble ratio: 4.05%
[rank0]:2025-11-02 12:16:26,248 - INFO - Avg. fwd time: 15.0904 / Avg. bwd time: 9.4292 / Avg. batch time: 648.9333 (ms) / GPU bubble ratio: 69.77%
[rank1]:2025-11-02 12:16:26,230 - INFO - Avg. fwd time: 15.9914 / Avg. bwd time: 33.0066 / Avg. batch time: 619.3405 (ms) / GPU bubble ratio: 36.71%
[rank2]:2025-11-02 12:16:26,251 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 71.19GiB(50.92%)  tps: 5,756  tflops: 268.45  mfu: 27.14%
[rank2]:2025-11-02 12:16:26,251 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 6,171  tflops: 287.80  mfu: 28.43%
[rank2]:2025-11-02 12:16:26,251 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 12:16:26,251 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 72.58GiB(51.91%)  tps: 5,756  tflops: 268.45  mfu: 27.14%
[rank0]:2025-11-02 12:16:26,251 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 6,170  tflops: 287.75  mfu: 28.43%
[rank0]:2025-11-02 12:16:26,251 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-02 12:16:26,273 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.1494  memory: 73.85GiB(52.82%)  tps: 5,756  tflops: 268.45  mfu: 27.14%
[rank1]:2025-11-02 12:16:26,274 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.1494  tps: 6,170  tflops: 287.77  mfu: 28.43%
[rank1]:2025-11-02 12:16:26,274 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 12:16:31,520 - INFO -  step: 3000  loss:  0.3414  grad_norm:  0.1494  memory: 87.93GiB(62.89%)  tps: 5,743  tflops: 267.84  mfu: 27.08%
[rank3]:2025-11-02 12:16:31,520 - INFO -  final step: 3000  loss:  0.3414  grad_norm:  0.1494  tps: 6,125  tflops: 285.65  mfu: 28.22%
[rank3]:2025-11-02 12:16:31,520 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 12:16:47,233 - INFO - validate step: 3000  loss: -1.0000  memory: 72.58GiB(51.91%)  tps: 19,522
[rank0]:2025-11-02 12:16:47,234 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 12:16:47,238 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-02 12:16:47,273 - INFO - validate step: 3000  loss: -1.0000  memory: 73.85GiB(52.82%)  tps: 19,505
[rank1]:2025-11-02 12:16:47,274 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 12:16:47,277 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 12:16:47,307 - INFO - validate step: 3000  loss: -1.0000  memory: 71.19GiB(50.92%)  tps: 19,453
[rank2]:2025-11-02 12:16:47,308 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 12:16:47,311 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 12:16:47,331 - INFO - validate step: 3000  loss:  0.2469  memory: 87.93GiB(62.89%)  tps: 25,908
[rank3]:2025-11-02 12:16:47,331 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 12:16:47,334 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-02 12:16:57,998 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-02 12:16:58,096 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251102_1216_stage0_final3000.svg
[rank1]:2025-11-02 12:16:58,103 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251102_1216_stage1_final3000.svg
[rank2]:2025-11-02 12:16:58,096 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251102_1216_stage2_final3000.svg
[rank3]:2025-11-02 12:16:58,240 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1216_real_final3000_rank3.svg
[rank3]:> Batch Time: 544.82 ms, GPU Bubble Ratio: 77.40%, 17.75%, 53.77%, 31.67%
[rank0]:2025-11-02 12:16:58,332 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251102_1216_rank0_stage0.svg
[rank0]:	> Counts Sum: 5065400, Total Sum: 5910080 (85.71%), Ratio(%) per element: [85.72, 85.62, 85.67, 85.86, 85.77, 85.62, 85.82, 85.27, 85.62, 85.27, 85.72, 85.57, 85.37, 85.82, 85.91, 85.77, 85.72, 85.52, 85.72, 85.42, 85.72, 85.62, 85.57, 85.77, 85.91, 85.57, 86.06, 85.57, 85.91, 85.86, 85.72, 85.67, 85.67, 86.01, 86.01, 85.96, 85.82, 85.67, 85.77, 85.82, 85.62, 85.32, 85.86, 85.96, 85.57, 85.77, 85.57, 85.77, 85.52, 85.57, 85.37, 85.86, 85.86, 85.72, 85.77, 85.91, 85.96, 85.57, 85.72, 85.91, 85.57, 85.91, 85.62, 85.42, 85.67, 85.91, 85.67, 85.86, 85.22, 85.82, 86.01, 85.22, 85.82]
[rank0]:2025-11-02 12:16:58,332 - INFO - Sleeping 2 seconds for other ranks to complete
[rank1]:2025-11-02 12:16:58,380 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251102_1216_rank1_stage1.svg
[rank1]:	> Counts Sum: 5375720, Total Sum: 6557760 (81.97%), Ratio(%) per element: [82.41, 82.21, 82.01, 81.22, 81.86, 82.16, 81.81, 82.11, 82.31, 82.06, 82.16, 82.31, 81.71, 82.41, 81.76, 81.66, 81.76, 81.96, 81.47, 81.57, 82.41, 82.21, 81.86, 82.11, 82.46, 82.01, 82.7, 82.41, 82.21, 81.96, 82.26, 81.81, 82.11, 82.31, 82.01, 82.31, 82.7, 81.66, 82.65, 81.27, 82.11, 82.41, 82.41, 82.31, 82.31, 81.27, 81.86, 81.86, 81.76, 82.16, 81.47, 81.76, 81.66, 82.41, 82.06, 81.71, 82.26, 82.31, 82.16, 82.31, 82.06, 81.86, 81.66, 82.6, 82.11, 82.11, 81.81, 82.8, 82.06, 82.41, 82.31, 82.31, 81.52, 81.32, 82.16, 81.32, 81.47, 82.75, 82.06, 81.86, 76.08]
[rank1]:2025-11-02 12:16:58,380 - INFO - Destroying the purge thread.
[rank2]:2025-11-02 12:16:58,436 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251102_1216_rank2_stage2.svg
[rank2]:	> Counts Sum: 4511880, Total Sum: 5829120 (77.40%), Ratio(%) per element: [76.72, 77.81, 77.66, 77.66, 76.53, 77.22, 77.71, 78.01, 77.76, 77.07, 77.66, 77.71, 78.06, 77.22, 78.06, 76.77, 77.71, 77.76, 77.42, 75.74, 77.51, 77.66, 77.47, 77.47, 76.77, 77.12, 77.17, 77.22, 78.75, 77.37, 76.87, 76.48, 77.71, 77.27, 77.02, 77.32, 77.27, 77.51, 76.58, 76.48, 78.45, 77.32, 77.12, 77.91, 77.47, 77.02, 77.56, 76.72, 77.66, 77.27, 77.71, 76.87, 78.01, 77.96, 78.26, 78.11, 77.37, 77.71, 77.42, 77.91, 77.47, 77.71, 77.42, 78.06, 77.86, 77.02, 76.87, 76.72, 77.12, 76.82, 76.82, 77.61]
[rank2]:2025-11-02 12:16:58,437 - INFO - Destroying the purge thread.
[rank3]:2025-11-02 12:16:58,416 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251102_1216_thry_final3000_rank3.svg
[rank3]:> Batch Time: 508.61 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:2025-11-02 12:16:58,490 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251102_1216_stage3_final3000.svg
[rank3]:2025-11-02 12:16:58,826 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251102_1216_rank3_stage3.svg
[rank3]:	> Counts Sum: 606880, Total Sum: 5262400 (11.53%), Ratio(%) per element: [11.56, 11.85, 12.0, 11.75, 11.46, 11.46, 12.45, 11.9, 11.95, 11.56, 11.85, 11.51, 11.51, 11.75, 11.95, 11.95, 11.56, 12.64, 11.51, 11.21, 12.4, 11.9, 11.75, 11.66, 11.31, 12.1, 11.9, 11.51, 11.85, 11.66, 11.9, 11.36, 12.2, 11.06, 11.36, 11.95, 12.0, 12.1, 11.21, 11.01, 12.15, 10.96, 12.05, 12.25, 12.4, 11.9, 11.56, 11.95, 10.82, 11.51, 11.85, 11.56, 11.06, 12.2, 11.75, 10.91, 12.4, 11.56, 10.86, 11.85, 11.75, 11.36, 11.56, 11.51, 0.0]
[rank3]:2025-11-02 12:16:58,826 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ˆâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.67512
[rank3]:wandb:               final/avg_loss 0.34141
[rank3]:wandb:             final/avg_mfu(%) 28.21889
[rank3]:wandb:             final/avg_tflops 285.65209
[rank3]:wandb:    final/avg_throughput(tps) 6124.59494
[rank3]:wandb:              final/grad_norm 0.14943
[rank3]:wandb:               final/max_loss 0.34141
[rank3]:wandb:                    grad_norm 0.14943
[rank3]:wandb: loss_metrics/global_avg_loss 0.34141
[rank3]:wandb: loss_metrics/global_max_loss 0.34141
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_GPipe_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/pvh1yi67
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_GPipe_timelyapf_h200/20251102-0956/wandb/run-20251102_095646-pvh1yi67/logs
[rank0]:2025-11-02 12:17:00,332 - INFO - Training completed
[rank0]:2025-11-02 12:17:00,333 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 12:17:00,503 - INFO - Process group destroyed
[rank2]:2025-11-02 12:17:00,522 - INFO - Process group destroyed
[rank3]:2025-11-02 12:17:00,651 - INFO - Process group destroyed
[rank0]:2025-11-02 12:17:00,751 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.6', 'layers.2', 'layers.0', 'tok_embeddings', 'layers.1', 'layers.3', 'layers.7', 'layers.4'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.10', 'layers.12', 'layers.9', 'layers.16', 'layers.8', 'layers.14', 'layers.15', 'layers.11'}
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.22', 'layers.21', 'layers.19', 'layers.23', 'layers.20', 'layers.18', 'layers.17'}
[rank3]:Stage 3: Modules to keep: {'layers.26', 'layers.29', 'layers.31', 'layers.25', 'output', 'layers.27', 'layers.30', 'layers.28', 'norm'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_GPipe_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_GPipe_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_GPipe_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_GPipe_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_timelyapf_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_GPipe_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3

ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Tue Nov  4 01:23:13 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1104 01:23:14.499000 2081857 site-packages/torch/distributed/run.py:811] 
W1104 01:23:14.499000 2081857 site-packages/torch/distributed/run.py:811] *****************************************
W1104 01:23:14.499000 2081857 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1104 01:23:14.499000 2081857 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-11-04 01:23:22,275 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-04 01:23:22,389 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-04 01:23:22,510 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-04 01:23:22,444 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-04 01:23:23,816 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-04 01:23:23,818 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 01:23:23,823 - INFO - [GC] Initial GC collection 0.00 seconds
[rank1]:2025-11-04 01:23:23,773 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-04 01:23:23,776 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank3]:2025-11-04 01:23:23,814 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-04 01:23:23,816 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank2]:2025-11-04 01:23:23,783 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-04 01:23:23,785 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-04 01:23:26,170 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-04 01:23:26,454 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-04 01:23:28,330 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2025-11-04 01:23:28,588 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-11-04 01:23:28,636 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-04 01:23:28,660 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-11-04 01:23:28,660 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank0]:2025-11-04 01:23:28,865 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-04 01:23:28,866 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-11-04 01:23:28,988 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-04 01:23:29,061 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-11-04 01:23:29,061 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank1]:2025-11-04 01:23:29,511 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-04 01:23:29,511 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: setting up run 2k4mxpnf
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_timelyapf_h200/20251104-0123/wandb/run-20251104_012329-2k4mxpnf
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_GPipe_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/2k4mxpnf
[rank3]:2025-11-04 01:23:30,361 - INFO - WandB logging enabled
[rank3]:2025-11-04 01:23:30,375 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-04 01:23:30,450 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-04 01:23:30,450 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-11-04 01:23:30,607 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-04 01:23:30,682 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-11-04 01:23:30,682 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-11-04 01:23:31,318 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-04 01:23:31,318 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank2]:2025-11-04 01:23:31,324 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-04 01:23:31,324 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-04 01:23:31,337 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_timelyapf_h200
[rank0]:2025-11-04 01:23:31,337 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 01:23:31,338 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-11-04 01:23:31,338 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank3]:2025-11-04 01:23:31,340 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-04 01:23:31,337 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-04 01:23:36,855 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-04 01:23:36,855 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-04 01:23:46,473 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-04 01:23:46,474 - INFO - Finished loading the checkpoint in 9.62 seconds.
[rank0]:2025-11-04 01:23:46,474 - INFO - Training starts at step 1
[rank3]:2025-11-04 01:23:52,856 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 58.03GiB(41.50%)  tps: 731  tflops: 34.07  mfu: 3.44%
[rank3]:2025-11-04 01:23:52,856 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 01:23:52,872 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.75GiB(35.58%)  tps: 676  tflops: 31.53  mfu: 3.19%
[rank0]:2025-11-04 01:23:52,872 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-11-04 01:23:52,853 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.69GiB(35.54%)  tps: 688  tflops: 32.08  mfu: 3.24%
[rank1]:2025-11-04 01:23:52,853 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-04 01:23:52,853 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 44.28GiB(31.67%)  tps: 738  tflops: 34.43  mfu: 3.48%
[rank2]:2025-11-04 01:23:52,853 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-04 01:25:59,900 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:26:02,334 - INFO - Avg. fwd time: 14.7082 / Avg. bwd time: 42.5582 / Avg. batch time: 481.0156 (ms) / GPU bubble ratio: 4.76%
[rank1]:2025-11-04 01:26:02,430 - INFO - Avg. fwd time: 15.4011 / Avg. bwd time: 41.1630 / Avg. batch time: 597.1430 (ms) / GPU bubble ratio: 24.22%
[rank2]:2025-11-04 01:26:02,384 - INFO - Avg. fwd time: 13.1994 / Avg. bwd time: 36.3022 / Avg. batch time: 535.7298 (ms) / GPU bubble ratio: 26.08%
[rank0]:2025-11-04 01:26:02,462 - INFO - Avg. fwd time: 14.1079 / Avg. bwd time: 37.8700 / Avg. batch time: 653.7016 (ms) / GPU bubble ratio: 36.39%
[rank1]:2025-11-04 01:26:02,568 - INFO -  step: 50  loss: -4.0000  grad_norm: 7207.1094  memory: 64.32GiB(46.00%)  tps: 6,189  tflops: 288.66  mfu: 29.19%
[rank3]:2025-11-04 01:26:02,570 - INFO -  step: 50  loss: 12.7727  grad_norm: 7207.1094  memory: 73.38GiB(52.48%)  tps: 6,189  tflops: 288.66  mfu: 29.19%
[rank0]:2025-11-04 01:26:02,572 - INFO -  step: 50  loss: -4.0000  grad_norm: 7207.1094  memory: 66.72GiB(47.72%)  tps: 6,190  tflops: 288.69  mfu: 29.19%
[rank2]:2025-11-04 01:26:02,565 - INFO -  step: 50  loss: -4.0000  grad_norm: 7207.1094  memory: 57.29GiB(40.97%)  tps: 6,189  tflops: 288.67  mfu: 29.19%
[rank0]:2025-11-04 01:28:12,047 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:28:14,465 - INFO - Avg. fwd time: 14.5449 / Avg. bwd time: 42.6117 / Avg. batch time: 476.0364 (ms) / GPU bubble ratio: 3.95%
[rank2]:2025-11-04 01:28:14,515 - INFO - Avg. fwd time: 13.1796 / Avg. bwd time: 36.4626 / Avg. batch time: 529.6897 (ms) / GPU bubble ratio: 25.02%
[rank1]:2025-11-04 01:28:14,561 - INFO - Avg. fwd time: 15.2017 / Avg. bwd time: 41.2585 / Avg. batch time: 590.1568 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-11-04 01:28:14,594 - INFO - Avg. fwd time: 13.7568 / Avg. bwd time: 37.9815 / Avg. batch time: 645.7866 (ms) / GPU bubble ratio: 35.91%
[rank0]:2025-11-04 01:28:14,704 - INFO -  step: 100  loss: -4.0000  grad_norm: 44.6876  memory: 66.72GiB(47.72%)  tps: 6,200  tflops: 289.16  mfu: 29.24%
[rank0]:2025-11-04 01:28:14,704 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:28:14,702 - INFO -  step: 100  loss:  3.8599  grad_norm: 44.6876  memory: 73.38GiB(52.48%)  tps: 6,200  tflops: 289.17  mfu: 29.24%
[rank3]:2025-11-04 01:28:14,702 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 01:28:14,700 - INFO -  step: 100  loss: -4.0000  grad_norm: 44.6876  memory: 64.32GiB(46.00%)  tps: 6,200  tflops: 289.16  mfu: 29.24%
[rank1]:2025-11-04 01:28:14,700 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 01:28:14,697 - INFO -  step: 100  loss: -4.0000  grad_norm: 44.6876  memory: 57.29GiB(40.97%)  tps: 6,200  tflops: 289.16  mfu: 29.24%
[rank2]:2025-11-04 01:28:14,697 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:30:24,015 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:30:26,536 - INFO - Avg. fwd time: 14.4308 / Avg. bwd time: 42.6356 / Avg. batch time: 474.0724 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-11-04 01:30:26,579 - INFO - Avg. fwd time: 13.1313 / Avg. bwd time: 36.5503 / Avg. batch time: 527.4169 (ms) / GPU bubble ratio: 24.64%
[rank1]:2025-11-04 01:30:26,627 - INFO - Avg. fwd time: 15.0948 / Avg. bwd time: 41.3015 / Avg. batch time: 587.5743 (ms) / GPU bubble ratio: 23.21%
[rank1]:2025-11-04 01:30:26,702 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.4658  memory: 64.32GiB(46.00%)  tps: 6,206  tflops: 289.45  mfu: 29.27%
[rank0]:2025-11-04 01:30:26,670 - INFO - Avg. fwd time: 13.6413 / Avg. bwd time: 38.0213 / Avg. batch time: 642.9313 (ms) / GPU bubble ratio: 35.72%
[rank0]:2025-11-04 01:30:26,706 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.4658  memory: 66.72GiB(47.72%)  tps: 6,206  tflops: 289.45  mfu: 29.27%
[rank3]:2025-11-04 01:30:26,703 - INFO -  step: 150  loss:  0.9669  grad_norm: 13.4658  memory: 73.38GiB(52.48%)  tps: 6,206  tflops: 289.45  mfu: 29.27%
[rank2]:2025-11-04 01:30:26,699 - INFO -  step: 150  loss: -4.0000  grad_norm: 13.4658  memory: 57.29GiB(40.97%)  tps: 6,206  tflops: 289.45  mfu: 29.27%
[rank0]:2025-11-04 01:32:35,929 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:32:38,348 - INFO - Avg. fwd time: 14.3768 / Avg. bwd time: 42.6415 / Avg. batch time: 473.1540 (ms) / GPU bubble ratio: 3.59%
[rank2]:2025-11-04 01:32:38,397 - INFO - Avg. fwd time: 13.1048 / Avg. bwd time: 36.5949 / Avg. batch time: 526.3578 (ms) / GPU bubble ratio: 24.46%
[rank1]:2025-11-04 01:32:38,443 - INFO - Avg. fwd time: 15.0474 / Avg. bwd time: 41.3159 / Avg. batch time: 586.3843 (ms) / GPU bubble ratio: 23.10%
[rank0]:2025-11-04 01:32:38,476 - INFO - Avg. fwd time: 13.5903 / Avg. bwd time: 38.0365 / Avg. batch time: 641.6097 (ms) / GPU bubble ratio: 35.63%
[rank2]:2025-11-04 01:32:38,579 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 57.29GiB(40.97%)  tps: 6,212  tflops: 289.72  mfu: 29.29%
[rank2]:2025-11-04 01:32:38,579 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 01:32:38,581 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 64.32GiB(46.00%)  tps: 6,212  tflops: 289.72  mfu: 29.29%
[rank1]:2025-11-04 01:32:38,581 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-04 01:32:38,583 - INFO -  step: 200  loss:  0.3449  grad_norm:  0.4751  memory: 73.38GiB(52.48%)  tps: 6,212  tflops: 289.72  mfu: 29.29%
[rank3]:2025-11-04 01:32:38,584 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-04 01:32:38,585 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4751  memory: 66.72GiB(47.72%)  tps: 6,212  tflops: 289.72  mfu: 29.29%
[rank0]:2025-11-04 01:32:38,586 - INFO - ðŸ”Ž  Running validation at step 200
[rank1]:2025-11-04 01:32:55,175 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,684
[rank1]:2025-11-04 01:32:55,176 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:32:55,143 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,739
[rank0]:2025-11-04 01:32:55,143 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-11-04 01:32:55,186 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,664
[rank2]:2025-11-04 01:32:55,187 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:32:55,207 - INFO - validate step: 200  loss:  0.2313  memory: 73.38GiB(52.48%)  tps: 24,641
[rank3]:2025-11-04 01:32:55,208 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:35:04,644 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 01:35:07,055 - INFO - Avg. fwd time: 14.3496 / Avg. bwd time: 42.6543 / Avg. batch time: 472.6640 (ms) / GPU bubble ratio: 3.52%
[rank2]:2025-11-04 01:35:07,104 - INFO - Avg. fwd time: 13.1015 / Avg. bwd time: 36.6248 / Avg. batch time: 525.7907 (ms) / GPU bubble ratio: 24.34%
[rank1]:2025-11-04 01:35:07,151 - INFO - Avg. fwd time: 15.0297 / Avg. bwd time: 41.3293 / Avg. batch time: 585.7267 (ms) / GPU bubble ratio: 23.02%
[rank0]:2025-11-04 01:35:07,183 - INFO - Avg. fwd time: 13.5732 / Avg. bwd time: 38.0564 / Avg. batch time: 640.8917 (ms) / GPU bubble ratio: 35.55%
[rank1]:2025-11-04 01:35:07,287 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2736  memory: 64.32GiB(46.00%)  tps: 6,201  tflops: 289.21  mfu: 29.24%
[rank0]:2025-11-04 01:35:07,291 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2736  memory: 66.72GiB(47.72%)  tps: 6,199  tflops: 289.13  mfu: 29.23%
[rank3]:2025-11-04 01:35:07,288 - INFO -  step: 250  loss:  0.2336  grad_norm:  0.2736  memory: 73.38GiB(52.48%)  tps: 6,202  tflops: 289.28  mfu: 29.25%
[rank2]:2025-11-04 01:35:07,284 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2736  memory: 57.29GiB(40.97%)  tps: 6,201  tflops: 289.24  mfu: 29.25%
[rank0]:2025-11-04 01:37:16,833 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:37:19,348 - INFO - Avg. fwd time: 14.3374 / Avg. bwd time: 42.6623 / Avg. batch time: 472.3881 (ms) / GPU bubble ratio: 3.47%
[rank2]:2025-11-04 01:37:19,391 - INFO - Avg. fwd time: 13.1009 / Avg. bwd time: 36.6389 / Avg. batch time: 525.4695 (ms) / GPU bubble ratio: 24.27%
[rank0]:2025-11-04 01:37:19,481 - INFO - Avg. fwd time: 13.5524 / Avg. bwd time: 38.0655 / Avg. batch time: 640.4665 (ms) / GPU bubble ratio: 35.52%
[rank1]:2025-11-04 01:37:19,438 - INFO - Avg. fwd time: 15.0166 / Avg. bwd time: 41.3342 / Avg. batch time: 585.3552 (ms) / GPU bubble ratio: 22.99%
[rank2]:2025-11-04 01:37:19,510 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2959  memory: 57.29GiB(40.97%)  tps: 6,195  tflops: 288.96  mfu: 29.22%
[rank2]:2025-11-04 01:37:19,510 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:37:19,514 - INFO -  step: 300  loss:  0.2706  grad_norm:  0.2959  memory: 73.38GiB(52.48%)  tps: 6,196  tflops: 288.96  mfu: 29.22%
[rank3]:2025-11-04 01:37:19,514 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:37:19,516 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2959  memory: 66.72GiB(47.72%)  tps: 6,195  tflops: 288.96  mfu: 29.22%
[rank0]:2025-11-04 01:37:19,516 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 01:37:19,512 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.2959  memory: 64.32GiB(46.00%)  tps: 6,195  tflops: 288.96  mfu: 29.22%
[rank1]:2025-11-04 01:37:19,512 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:39:29,272 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:39:31,711 - INFO - Avg. fwd time: 14.3344 / Avg. bwd time: 42.6712 / Avg. batch time: 472.2867 (ms) / GPU bubble ratio: 3.44%
[rank1]:2025-11-04 01:39:31,807 - INFO - Avg. fwd time: 15.0200 / Avg. bwd time: 41.3510 / Avg. batch time: 585.2157 (ms) / GPU bubble ratio: 22.94%
[rank2]:2025-11-04 01:39:31,761 - INFO - Avg. fwd time: 13.1097 / Avg. bwd time: 36.6521 / Avg. batch time: 525.3467 (ms) / GPU bubble ratio: 24.22%
[rank0]:2025-11-04 01:39:31,840 - INFO - Avg. fwd time: 13.5450 / Avg. bwd time: 38.0868 / Avg. batch time: 640.3073 (ms) / GPU bubble ratio: 35.49%
[rank1]:2025-11-04 01:39:31,944 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3806  memory: 64.32GiB(46.00%)  tps: 6,186  tflops: 288.51  mfu: 29.17%
[rank3]:2025-11-04 01:39:31,946 - INFO -  step: 350  loss:  0.3361  grad_norm:  0.3806  memory: 73.38GiB(52.48%)  tps: 6,186  tflops: 288.51  mfu: 29.17%
[rank0]:2025-11-04 01:39:31,948 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3806  memory: 66.72GiB(47.72%)  tps: 6,186  tflops: 288.51  mfu: 29.17%
[rank2]:2025-11-04 01:39:31,942 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3806  memory: 57.29GiB(40.97%)  tps: 6,186  tflops: 288.51  mfu: 29.17%
[rank0]:2025-11-04 01:41:41,567 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:41:44,012 - INFO - Avg. fwd time: 14.3306 / Avg. bwd time: 42.6756 / Avg. batch time: 472.1604 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-11-04 01:41:44,062 - INFO - Avg. fwd time: 13.1144 / Avg. bwd time: 36.6574 / Avg. batch time: 525.1907 (ms) / GPU bubble ratio: 24.18%
[rank1]:2025-11-04 01:41:44,109 - INFO - Avg. fwd time: 15.0216 / Avg. bwd time: 41.3568 / Avg. batch time: 585.0414 (ms) / GPU bubble ratio: 22.91%
[rank0]:2025-11-04 01:41:44,141 - INFO - Avg. fwd time: 13.5352 / Avg. bwd time: 38.0995 / Avg. batch time: 640.1196 (ms) / GPU bubble ratio: 35.47%
[rank2]:2025-11-04 01:41:44,243 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3247  memory: 57.29GiB(40.97%)  tps: 6,192  tflops: 288.79  mfu: 29.20%
[rank2]:2025-11-04 01:41:44,243 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-04 01:41:44,246 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3247  memory: 64.32GiB(46.00%)  tps: 6,192  tflops: 288.79  mfu: 29.20%
[rank1]:2025-11-04 01:41:44,246 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-04 01:41:44,250 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3247  memory: 66.72GiB(47.72%)  tps: 6,192  tflops: 288.79  mfu: 29.20%
[rank0]:2025-11-04 01:41:44,250 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-04 01:41:44,248 - INFO -  step: 400  loss:  0.2774  grad_norm:  0.3247  memory: 73.38GiB(52.48%)  tps: 6,192  tflops: 288.79  mfu: 29.20%
[rank3]:2025-11-04 01:41:44,248 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-11-04 01:41:59,242 - INFO - validate step: 400  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 27,310
[rank2]:2025-11-04 01:41:59,243 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-11-04 01:41:59,228 - INFO - validate step: 400  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 27,340
[rank1]:2025-11-04 01:41:59,229 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:41:59,197 - INFO - validate step: 400  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 27,404
[rank0]:2025-11-04 01:41:59,198 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-11-04 01:41:59,257 - INFO - validate step: 400  loss:  0.2371  memory: 73.38GiB(52.48%)  tps: 27,292
[rank3]:2025-11-04 01:41:59,258 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-11-04 01:44:08,970 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 01:44:11,531 - INFO - Avg. fwd time: 13.1223 / Avg. bwd time: 36.6632 / Avg. batch time: 525.1616 (ms) / GPU bubble ratio: 24.16%
[rank3]:2025-11-04 01:44:11,487 - INFO - Avg. fwd time: 14.3338 / Avg. bwd time: 42.6828 / Avg. batch time: 472.1451 (ms) / GPU bubble ratio: 3.39%
[rank0]:2025-11-04 01:44:11,624 - INFO - Avg. fwd time: 13.5319 / Avg. bwd time: 38.1096 / Avg. batch time: 640.0793 (ms) / GPU bubble ratio: 35.46%
[rank0]:2025-11-04 01:44:11,659 - INFO -  step: 450  loss: -4.0000  grad_norm:  2.6748  memory: 66.72GiB(47.72%)  tps: 6,184  tflops: 288.44  mfu: 29.17%
[rank3]:2025-11-04 01:44:11,657 - INFO -  step: 450  loss:  0.3116  grad_norm:  2.6748  memory: 73.38GiB(52.48%)  tps: 6,187  tflops: 288.58  mfu: 29.18%
[rank1]:2025-11-04 01:44:11,580 - INFO - Avg. fwd time: 15.0273 / Avg. bwd time: 41.3675 / Avg. batch time: 585.0034 (ms) / GPU bubble ratio: 22.88%
[rank1]:2025-11-04 01:44:11,655 - INFO -  step: 450  loss: -4.0000  grad_norm:  2.6748  memory: 64.32GiB(46.00%)  tps: 6,186  tflops: 288.52  mfu: 29.17%
[rank2]:2025-11-04 01:44:11,653 - INFO -  step: 450  loss: -4.0000  grad_norm:  2.6748  memory: 57.29GiB(40.97%)  tps: 6,187  tflops: 288.55  mfu: 29.18%
[rank3]:2025-11-04 01:44:37,898 - INFO - [Step 460] ã€°ï¸ Monitoring Upperbound
[rank3]:2025-11-04 01:45:08,993 - INFO - [Step 470] âœ”ï¸  Setting Upperbound
[rank3]:2025-11-04 01:45:09,228 - INFO - [Step 470] ã€°ï¸ Monitoring Lowerbound
[rank2]:2025-11-04 01:45:30,363 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,392 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,378 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,410 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,357 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,373 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,389 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,357 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,386 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,423 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,443 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,484 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,519 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,531 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,523 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,557 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,595 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,555 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,593 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,589 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,624 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:30,630 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,567 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,604 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,632 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank2]:2025-11-04 01:45:30,670 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,663 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,701 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,642 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,680 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank1]:2025-11-04 01:45:30,717 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank0]:2025-11-04 01:45:30,739 - WARNING - Batch index 1881 is larger than freeze ratio history length 0. Filling with zeros.
[rank3]:2025-11-04 01:45:47,212 - INFO - [Step 480] âœ”ï¸  Setting Lowerbound
[rank3]:2025-11-04 01:45:47,420 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0145_max_batch_time.svg
[rank3]:> Batch Time: 623.38 ms, GPU Bubble Ratio: 33.46%, 27.38%, 35.80%, 26.66%
[rank3]:2025-11-04 01:45:47,561 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0145_min_batch_time.svg
[rank3]:> Batch Time: 350.10 ms, GPU Bubble Ratio: 69.13%, 23.26%, 32.80%, 23.93%
[rank3]:2025-11-04 01:45:47,719 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0145_frozen_pipeline_schedule.svg
[rank3]:> Batch Time: 369.12 ms, GPU Bubble Ratio: 30.46%, 21.91%, 26.52%, 22.70%
[rank3]:2025-11-04 01:45:47,719 - INFO - 	> Batch Time: 369.12 ms (Average Freeze Ratio: 0.77, Time Reduction Rate: 0.41)
[rank0]:2025-11-04 01:46:28,459 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:46:30,666 - INFO - Avg. fwd time: 14.4357 / Avg. bwd time: 41.7148 / Avg. batch time: 465.5283 (ms) / GPU bubble ratio: 3.51%
[rank2]:2025-11-04 01:46:30,704 - INFO - Avg. fwd time: 13.2181 / Avg. bwd time: 35.7698 / Avg. batch time: 519.1269 (ms) / GPU bubble ratio: 24.51%
[rank1]:2025-11-04 01:46:30,751 - INFO - Avg. fwd time: 15.1794 / Avg. bwd time: 40.3779 / Avg. batch time: 577.9635 (ms) / GPU bubble ratio: 23.10%
[rank0]:2025-11-04 01:46:30,773 - INFO - Avg. fwd time: 13.6078 / Avg. bwd time: 36.5258 / Avg. batch time: 631.4056 (ms) / GPU bubble ratio: 36.48%
[rank2]:2025-11-04 01:46:41,826 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.29/0.86, [MB1] 0.29/0.86, [MB2] 0.29/0.86, [MB3] 0.29/0.87, [MB4] 0.01/0.04, [MB5] 0.33/1.00, [MB6] 0.26/0.77, [MB7] 0.33/1.00
[rank2]:2025-11-04 01:46:41,827 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2295  memory: 64.67GiB(46.25%)  tps: 5,455  tflops: 254.42  mfu: 25.73%
[rank1]:2025-11-04 01:46:44,077 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.96, [MB1] 0.06/0.18, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank1]:2025-11-04 01:46:44,078 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2295  memory: 72.68GiB(51.98%)  tps: 5,375  tflops: 250.67  mfu: 25.35%
[rank3]:2025-11-04 01:46:47,053 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.33/1.00, [MB1] 0.33/1.00, [MB2] 0.33/1.00, [MB3] 0.33/1.00, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.13/0.39, [MB7] 0.27/0.81
[rank3]:2025-11-04 01:46:47,059 - INFO -  step: 500  loss:  0.3006  grad_norm:  0.2295  memory: 83.85GiB(59.97%)  tps: 5,272  tflops: 245.87  mfu: 24.86%
[rank0]:2025-11-04 01:46:49,515 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.03/0.10, [MB4] 0.33/1.00, [MB5] 0.33/1.00, [MB6] 0.33/1.00, [MB7] 0.33/1.00
[rank0]:2025-11-04 01:46:49,516 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2295  memory: 67.58GiB(48.34%)  tps: 5,190  tflops: 242.04  mfu: 24.47%
[rank0]:2025-11-04 01:46:49,580 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0146_stage0_step500.svg
[rank1]:2025-11-04 01:46:49,581 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0146_stage1_step500.svg
[rank2]:2025-11-04 01:46:49,579 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0146_stage2_step500.svg
[rank3]:2025-11-04 01:46:49,658 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0146_real_step500_rank3.svg
[rank3]:> Batch Time: 404.50 ms, GPU Bubble Ratio: 70.00%, 29.69%, 38.14%, 25.03%
[rank3]:2025-11-04 01:46:49,700 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0146_stage3_step500.svg
[rank0]:2025-11-04 01:49:19,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 01:49:21,172 - INFO - Avg. fwd time: 14.5385 / Avg. bwd time: 40.6726 / Avg. batch time: 457.9263 (ms) / GPU bubble ratio: 3.55%
[rank2]:2025-11-04 01:49:21,199 - INFO - Avg. fwd time: 13.3166 / Avg. bwd time: 34.7659 / Avg. batch time: 511.9677 (ms) / GPU bubble ratio: 24.87%
[rank1]:2025-11-04 01:49:21,227 - INFO - Avg. fwd time: 15.2874 / Avg. bwd time: 39.2827 / Avg. batch time: 570.3657 (ms) / GPU bubble ratio: 23.46%
[rank0]:2025-11-04 01:49:21,243 - INFO - Avg. fwd time: 13.6965 / Avg. bwd time: 35.5431 / Avg. batch time: 623.6697 (ms) / GPU bubble ratio: 36.84%
[rank1]:2025-11-04 01:49:24,182 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.64/0.96, [MB1] 0.12/0.18, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2025-11-04 01:49:24,183 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0752  memory: 74.59GiB(53.35%)  tps: 5,117  tflops: 238.64  mfu: 24.13%
[rank0]:2025-11-04 01:49:25,465 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.07/0.10, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2025-11-04 01:49:25,466 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0752  memory: 74.10GiB(53.00%)  tps: 5,253  tflops: 245.00  mfu: 24.77%
[rank3]:2025-11-04 01:49:27,370 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.26/0.39, [MB7] 0.54/0.81
[rank3]:2025-11-04 01:49:27,374 - INFO -  step: 550  loss:  0.1607  grad_norm:  0.0752  memory: 83.85GiB(59.97%)  tps: 5,110  tflops: 238.33  mfu: 24.10%
[rank2]:2025-11-04 01:49:27,938 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.57/0.86, [MB1] 0.57/0.86, [MB2] 0.57/0.86, [MB3] 0.58/0.87, [MB4] 0.03/0.04, [MB5] 0.67/1.00, [MB6] 0.51/0.77, [MB7] 0.67/1.00
[rank2]:2025-11-04 01:49:27,939 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.0752  memory: 66.29GiB(47.41%)  tps: 4,932  tflops: 230.01  mfu: 23.26%
[rank0]:2025-11-04 01:51:33,246 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 01:51:35,062 - INFO - Avg. fwd time: 13.4557 / Avg. bwd time: 33.4789 / Avg. batch time: 505.2892 (ms) / GPU bubble ratio: 25.69%
[rank3]:2025-11-04 01:51:35,038 - INFO - Avg. fwd time: 14.6772 / Avg. bwd time: 39.4280 / Avg. batch time: 448.9941 (ms) / GPU bubble ratio: 3.60%
[rank1]:2025-11-04 01:51:35,089 - INFO - Avg. fwd time: 15.4521 / Avg. bwd time: 37.7688 / Avg. batch time: 563.3974 (ms) / GPU bubble ratio: 24.43%
[rank0]:2025-11-04 01:51:35,112 - INFO - Avg. fwd time: 13.8348 / Avg. bwd time: 34.1219 / Avg. batch time: 615.7901 (ms) / GPU bubble ratio: 37.70%
[rank2]:2025-11-04 01:51:35,835 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.86/0.86, [MB2] 0.86/0.86, [MB3] 0.87/0.87, [MB4] 0.04/0.04, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:51:35,836 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0606  memory: 66.29GiB(47.41%)  tps: 6,405  tflops: 298.74  mfu: 30.21%
[rank2]:2025-11-04 01:51:35,836 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-04 01:51:35,920 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.18/0.18, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:51:35,921 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0606  memory: 74.59GiB(53.35%)  tps: 6,218  tflops: 290.03  mfu: 29.33%
[rank1]:2025-11-04 01:51:35,921 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 01:51:36,408 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:51:36,409 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.0606  memory: 74.90GiB(53.57%)  tps: 6,256  tflops: 291.79  mfu: 29.50%
[rank0]:2025-11-04 01:51:36,409 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-04 01:51:39,047 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.39/0.39, [MB7] 0.81/0.81
[rank3]:2025-11-04 01:51:39,052 - INFO -  step: 600  loss:  0.4161  grad_norm:  0.0606  memory: 83.85GiB(59.97%)  tps: 6,221  tflops: 290.17  mfu: 29.34%
[rank3]:2025-11-04 01:51:39,052 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-04 01:51:55,322 - INFO - validate step: 600  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,658
[rank2]:2025-11-04 01:51:55,373 - INFO - validate step: 600  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,966
[rank1]:2025-11-04 01:51:55,357 - INFO - validate step: 600  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,075
[rank1]:2025-11-04 01:51:55,433 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0151_stage1_step600.svg
[rank3]:2025-11-04 01:51:55,382 - INFO - validate step: 600  loss:  0.2467  memory: 83.85GiB(59.97%)  tps: 25,083
[rank0]:2025-11-04 01:51:55,434 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0151_stage0_step600.svg
[rank2]:2025-11-04 01:51:55,434 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0151_stage2_step600.svg
[rank3]:2025-11-04 01:51:55,517 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0151_real_step600_rank3.svg
[rank3]:> Batch Time: 441.45 ms, GPU Bubble Ratio: 40.71%, 32.98%, 41.19%, 27.07%
[rank3]:2025-11-04 01:51:55,559 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0151_stage3_step600.svg
[rank0]:2025-11-04 01:53:30,450 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 01:53:31,802 - INFO - Avg. fwd time: 13.9685 / Avg. bwd time: 31.7482 / Avg. batch time: 605.7915 (ms) / GPU bubble ratio: 39.63%
[rank3]:2025-11-04 01:53:32,025 - INFO - Avg. fwd time: 14.8307 / Avg. bwd time: 38.2147 / Avg. batch time: 440.4593 (ms) / GPU bubble ratio: 3.65%
[rank2]:2025-11-04 01:53:32,043 - INFO - Avg. fwd time: 13.6041 / Avg. bwd time: 32.2794 / Avg. batch time: 499.3221 (ms) / GPU bubble ratio: 26.49%
[rank0]:2025-11-04 01:53:32,127 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:53:32,127 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,462  tflops: 394.68  mfu: 39.91%
[rank1]:2025-11-04 01:53:32,070 - INFO - Avg. fwd time: 15.6202 / Avg. bwd time: 36.4138 / Avg. batch time: 555.9202 (ms) / GPU bubble ratio: 25.12%
[rank1]:2025-11-04 01:53:32,127 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.18/0.18, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:53:32,128 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,465  tflops: 394.83  mfu: 39.92%
[rank2]:2025-11-04 01:53:32,108 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.86/0.86, [MB2] 0.86/0.86, [MB3] 0.87/0.87, [MB4] 0.04/0.04, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:53:32,125 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,467  tflops: 394.90  mfu: 39.93%
[rank3]:2025-11-04 01:53:33,826 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.39/0.39, [MB7] 0.81/0.81
[rank3]:2025-11-04 01:53:33,831 - INFO -  step: 650  loss:  0.2721  grad_norm:  0.0150  memory: 83.85GiB(59.97%)  tps: 8,321  tflops: 388.11  mfu: 39.24%
[rank0]:2025-11-04 01:55:19,409 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 01:55:20,810 - INFO - Avg. fwd time: 14.0980 / Avg. bwd time: 29.3588 / Avg. batch time: 599.3298 (ms) / GPU bubble ratio: 41.99%
[rank2]:2025-11-04 01:55:21,056 - INFO - Avg. fwd time: 13.7502 / Avg. bwd time: 31.0718 / Avg. batch time: 496.9274 (ms) / GPU bubble ratio: 27.84%
[rank1]:2025-11-04 01:55:21,085 - INFO - Avg. fwd time: 15.7850 / Avg. bwd time: 35.0507 / Avg. batch time: 551.9975 (ms) / GPU bubble ratio: 26.32%
[rank3]:2025-11-04 01:55:21,039 - INFO - Avg. fwd time: 14.9697 / Avg. bwd time: 37.1012 / Avg. batch time: 432.6194 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-11-04 01:55:21,126 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.86/0.86, [MB1] 0.86/0.86, [MB2] 0.86/0.86, [MB3] 0.87/0.87, [MB4] 0.04/0.04, [MB5] 1.00/1.00, [MB6] 0.77/0.77, [MB7] 1.00/1.00
[rank2]:2025-11-04 01:55:21,143 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank1]:2025-11-04 01:55:21,144 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.96/0.96, [MB1] 0.18/0.18, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2025-11-04 01:55:21,145 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank0]:2025-11-04 01:55:21,144 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.10/0.10, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2025-11-04 01:55:21,145 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,514  tflops: 350.47  mfu: 35.44%
[rank1]:2025-11-04 01:55:24,211 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0155_stage1_step700.svg
[rank0]:2025-11-04 01:55:24,213 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0155_stage0_step700.svg
[rank3]:2025-11-04 01:55:24,155 - INFO - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 0.39/0.39, [MB7] 0.81/0.81
[rank3]:2025-11-04 01:55:24,160 - INFO -  step: 700  loss:  0.3916  grad_norm:  0.0356  memory: 83.85GiB(59.97%)  tps: 7,425  tflops: 346.31  mfu: 35.02%
[rank2]:2025-11-04 01:55:24,211 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0155_stage2_step700.svg
[rank3]:2025-11-04 01:55:24,290 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0155_real_step700_rank3.svg
[rank3]:> Batch Time: 412.00 ms, GPU Bubble Ratio: 69.46%, 29.70%, 38.15%, 24.30%
[rank3]:2025-11-04 01:55:24,333 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0155_stage3_step700.svg
[rank0]:2025-11-04 01:57:03,702 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 01:57:05,404 - INFO - Avg. fwd time: 15.9219 / Avg. bwd time: 33.8774 / Avg. batch time: 546.2187 (ms) / GPU bubble ratio: 27.06%
[rank3]:2025-11-04 01:57:05,354 - INFO - Avg. fwd time: 15.0913 / Avg. bwd time: 36.0886 / Avg. batch time: 425.4412 (ms) / GPU bubble ratio: 3.76%
[rank2]:2025-11-04 01:57:05,378 - INFO - Avg. fwd time: 13.8728 / Avg. bwd time: 30.0327 / Avg. batch time: 492.4635 (ms) / GPU bubble ratio: 28.68%
[rank2]:2025-11-04 01:57:05,412 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank1]:2025-11-04 01:57:05,412 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,857  tflops: 366.44  mfu: 37.05%
[rank0]:2025-11-04 01:57:05,411 - INFO - Avg. fwd time: 14.2068 / Avg. bwd time: 27.3039 / Avg. batch time: 591.3665 (ms) / GPU bubble ratio: 43.84%
[rank0]:2025-11-04 01:57:05,414 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank3]:2025-11-04 01:57:08,042 - INFO -  step: 750  loss:  0.1325  grad_norm:  0.0144  memory: 83.85GiB(59.97%)  tps: 7,886  tflops: 367.80  mfu: 37.19%
[rank0]:2025-11-04 01:58:39,743 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 01:58:41,143 - INFO - Avg. fwd time: 14.2790 / Avg. bwd time: 25.7586 / Avg. batch time: 584.6596 (ms) / GPU bubble ratio: 45.22%
[rank3]:2025-11-04 01:58:41,374 - INFO - Avg. fwd time: 15.1785 / Avg. bwd time: 35.2682 / Avg. batch time: 419.5341 (ms) / GPU bubble ratio: 3.80%
[rank2]:2025-11-04 01:58:41,391 - INFO - Avg. fwd time: 13.9580 / Avg. bwd time: 29.2496 / Avg. batch time: 488.4050 (ms) / GPU bubble ratio: 29.23%
[rank0]:2025-11-04 01:58:41,479 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank0]:2025-11-04 01:58:41,479 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-04 01:58:41,421 - INFO - Avg. fwd time: 16.0140 / Avg. bwd time: 32.9933 / Avg. batch time: 541.1636 (ms) / GPU bubble ratio: 27.55%
[rank1]:2025-11-04 01:58:41,479 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,527  tflops: 397.72  mfu: 40.21%
[rank1]:2025-11-04 01:58:41,479 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-11-04 01:58:41,477 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,528  tflops: 397.73  mfu: 40.22%
[rank2]:2025-11-04 01:58:41,477 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 01:58:44,491 - INFO -  step: 800  loss:  0.2873  grad_norm:  0.0185  memory: 83.85GiB(59.97%)  tps: 8,494  tflops: 396.15  mfu: 40.06%
[rank3]:2025-11-04 01:58:44,491 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-04 01:59:01,001 - INFO - validate step: 800  loss:  0.2463  memory: 83.85GiB(59.97%)  tps: 24,812
[rank0]:2025-11-04 01:59:00,936 - INFO - validate step: 800  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,052
[rank1]:2025-11-04 01:59:00,973 - INFO - validate step: 800  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,012
[rank2]:2025-11-04 01:59:00,989 - INFO - validate step: 800  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,993
[rank2]:2025-11-04 01:59:01,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0159_stage2_step800.svg
[rank0]:2025-11-04 01:59:01,054 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0159_stage0_step800.svg
[rank1]:2025-11-04 01:59:01,054 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0159_stage1_step800.svg
[rank3]:2025-11-04 01:59:01,134 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0159_real_step800_rank3.svg
[rank3]:> Batch Time: 406.00 ms, GPU Bubble Ratio: 69.67%, 29.68%, 37.91%, 24.65%
[rank3]:2025-11-04 01:59:01,179 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0159_stage3_step800.svg
[rank0]:2025-11-04 02:00:38,481 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 02:00:39,806 - INFO - Avg. fwd time: 14.3597 / Avg. bwd time: 24.1631 / Avg. batch time: 578.0714 (ms) / GPU bubble ratio: 46.69%
[rank2]:2025-11-04 02:00:40,049 - INFO - Avg. fwd time: 14.0515 / Avg. bwd time: 28.4422 / Avg. batch time: 484.5437 (ms) / GPU bubble ratio: 29.84%
[rank3]:2025-11-04 02:00:40,032 - INFO - Avg. fwd time: 15.2700 / Avg. bwd time: 34.4718 / Avg. batch time: 413.8542 (ms) / GPU bubble ratio: 3.85%
[rank1]:2025-11-04 02:00:40,077 - INFO - Avg. fwd time: 16.1172 / Avg. bwd time: 32.0808 / Avg. batch time: 536.2761 (ms) / GPU bubble ratio: 28.10%
[rank2]:2025-11-04 02:00:40,132 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,263  tflops: 385.38  mfu: 38.97%
[rank0]:2025-11-04 02:00:40,134 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,258  tflops: 385.17  mfu: 38.95%
[rank1]:2025-11-04 02:00:40,134 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,261  tflops: 385.31  mfu: 38.96%
[rank3]:2025-11-04 02:00:42,621 - INFO -  step: 850  loss:  0.1340  grad_norm:  0.0135  memory: 83.85GiB(59.97%)  tps: 8,062  tflops: 375.99  mfu: 38.02%
[rank0]:2025-11-04 02:02:18,817 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:02:20,423 - INFO - Avg. fwd time: 15.3371 / Avg. bwd time: 33.7503 / Avg. batch time: 408.5847 (ms) / GPU bubble ratio: 3.89%
[rank2]:2025-11-04 02:02:20,448 - INFO - Avg. fwd time: 14.1240 / Avg. bwd time: 27.7238 / Avg. batch time: 481.6821 (ms) / GPU bubble ratio: 30.50%
[rank2]:2025-11-04 02:02:20,484 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,163  tflops: 380.74  mfu: 38.50%
[rank0]:2025-11-04 02:02:20,483 - INFO - Avg. fwd time: 14.4195 / Avg. bwd time: 22.7538 / Avg. batch time: 572.7824 (ms) / GPU bubble ratio: 48.08%
[rank0]:2025-11-04 02:02:20,486 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,163  tflops: 380.74  mfu: 38.50%
[rank1]:2025-11-04 02:02:20,474 - INFO - Avg. fwd time: 16.1950 / Avg. bwd time: 31.2698 / Avg. batch time: 532.4966 (ms) / GPU bubble ratio: 28.69%
[rank1]:2025-11-04 02:02:20,484 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,163  tflops: 380.75  mfu: 38.50%
[rank3]:2025-11-04 02:02:21,550 - INFO -  step: 900  loss:  0.2018  grad_norm:  0.0080  memory: 83.85GiB(59.97%)  tps: 8,281  tflops: 386.22  mfu: 39.05%
[rank2]:2025-11-04 02:02:21,595 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0202_stage2_step900.svg
[rank0]:2025-11-04 02:02:21,597 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0202_stage0_step900.svg
[rank1]:2025-11-04 02:02:21,596 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0202_stage1_step900.svg
[rank3]:2025-11-04 02:02:21,688 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0202_real_step900_rank3.svg
[rank3]:> Batch Time: 398.00 ms, GPU Bubble Ratio: 68.95%, 28.02%, 36.56%, 25.40%
[rank3]:2025-11-04 02:02:21,727 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0202_stage3_step900.svg
[rank0]:2025-11-04 02:04:00,843 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:04:02,297 - INFO - Avg. fwd time: 14.4711 / Avg. bwd time: 21.6705 / Avg. batch time: 569.2436 (ms) / GPU bubble ratio: 49.21%
[rank2]:2025-11-04 02:04:02,560 - INFO - Avg. fwd time: 14.1845 / Avg. bwd time: 27.1741 / Avg. batch time: 480.0033 (ms) / GPU bubble ratio: 31.07%
[rank3]:2025-11-04 02:04:02,543 - INFO - Avg. fwd time: 15.3907 / Avg. bwd time: 33.2434 / Avg. batch time: 404.9382 (ms) / GPU bubble ratio: 3.92%
[rank1]:2025-11-04 02:04:02,594 - INFO - Avg. fwd time: 16.2605 / Avg. bwd time: 30.6487 / Avg. batch time: 530.1158 (ms) / GPU bubble ratio: 29.21%
[rank2]:2025-11-04 02:04:02,659 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,018  tflops: 373.94  mfu: 37.81%
[rank0]:2025-11-04 02:04:02,661 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,018  tflops: 373.94  mfu: 37.81%
[rank1]:2025-11-04 02:04:02,661 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,017  tflops: 373.94  mfu: 37.81%
[rank3]:2025-11-04 02:04:09,977 - INFO -  step: 950  loss:  0.2689  grad_norm:  0.0372  memory: 83.85GiB(59.97%)  tps: 7,555  tflops: 352.39  mfu: 35.63%
[rank0]:2025-11-04 02:05:47,186 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:05:48,540 - INFO - Avg. fwd time: 14.5292 / Avg. bwd time: 20.5301 / Avg. batch time: 566.3797 (ms) / GPU bubble ratio: 50.48%
[rank2]:2025-11-04 02:05:48,781 - INFO - Avg. fwd time: 14.2505 / Avg. bwd time: 26.5965 / Avg. batch time: 479.0879 (ms) / GPU bubble ratio: 31.79%
[rank3]:2025-11-04 02:05:48,765 - INFO - Avg. fwd time: 15.4532 / Avg. bwd time: 32.6975 / Avg. batch time: 401.0465 (ms) / GPU bubble ratio: 3.95%
[rank1]:2025-11-04 02:05:48,810 - INFO - Avg. fwd time: 16.3342 / Avg. bwd time: 29.9970 / Avg. batch time: 528.4679 (ms) / GPU bubble ratio: 29.86%
[rank2]:2025-11-04 02:05:48,866 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,713  tflops: 359.75  mfu: 36.38%
[rank2]:2025-11-04 02:05:48,866 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 02:05:48,867 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,713  tflops: 359.75  mfu: 36.38%
[rank0]:2025-11-04 02:05:48,868 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-04 02:05:48,868 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,713  tflops: 359.75  mfu: 36.38%
[rank1]:2025-11-04 02:05:48,868 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-04 02:05:52,240 - INFO -  step: 1000  loss:  0.1930  grad_norm:  0.0124  memory: 84.22GiB(60.24%)  tps: 8,011  tflops: 373.63  mfu: 37.78%
[rank3]:2025-11-04 02:05:52,240 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-04 02:06:08,616 - INFO - validate step: 1000  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 20,742
[rank1]:2025-11-04 02:06:08,650 - INFO - validate step: 1000  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,706
[rank2]:2025-11-04 02:06:08,666 - INFO - validate step: 1000  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,687
[rank2]:2025-11-04 02:06:08,723 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0206_stage2_step1000.svg
[rank3]:2025-11-04 02:06:08,674 - INFO - validate step: 1000  loss:  0.2430  memory: 84.22GiB(60.24%)  tps: 24,925
[rank0]:2025-11-04 02:06:08,724 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0206_stage0_step1000.svg
[rank1]:2025-11-04 02:06:08,724 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0206_stage1_step1000.svg
[rank3]:2025-11-04 02:06:08,806 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0206_real_step1000_rank3.svg
[rank3]:> Batch Time: 412.75 ms, GPU Bubble Ratio: 69.91%, 30.64%, 38.84%, 24.45%
[rank3]:2025-11-04 02:06:08,846 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0206_stage3_step1000.svg
[rank0]:2025-11-04 02:07:48,207 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-04 02:07:49,915 - INFO - Avg. fwd time: 14.3062 / Avg. bwd time: 26.0764 / Avg. batch time: 476.9838 (ms) / GPU bubble ratio: 32.27%
[rank3]:2025-11-04 02:07:49,889 - INFO - Avg. fwd time: 15.5049 / Avg. bwd time: 32.1914 / Avg. batch time: 397.3844 (ms) / GPU bubble ratio: 3.98%
[rank1]:2025-11-04 02:07:49,942 - INFO - Avg. fwd time: 16.3945 / Avg. bwd time: 29.4087 / Avg. batch time: 525.6993 (ms) / GPU bubble ratio: 30.30%
[rank2]:2025-11-04 02:07:49,952 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,088  tflops: 377.22  mfu: 38.14%
[rank0]:2025-11-04 02:07:49,951 - INFO - Avg. fwd time: 14.5770 / Avg. bwd time: 19.5038 / Avg. batch time: 562.5172 (ms) / GPU bubble ratio: 51.53%
[rank0]:2025-11-04 02:07:49,954 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,084  tflops: 377.03  mfu: 38.12%
[rank1]:2025-11-04 02:07:49,952 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,087  tflops: 377.16  mfu: 38.14%
[rank3]:2025-11-04 02:07:52,241 - INFO -  step: 1050  loss:  0.2855  grad_norm:  0.0126  memory: 84.22GiB(60.24%)  tps: 7,910  tflops: 368.93  mfu: 37.30%
[rank0]:2025-11-04 02:09:33,652 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:09:35,006 - INFO - Avg. fwd time: 14.6283 / Avg. bwd time: 18.7024 / Avg. batch time: 560.7720 (ms) / GPU bubble ratio: 52.45%
[rank2]:2025-11-04 02:09:35,246 - INFO - Avg. fwd time: 14.3623 / Avg. bwd time: 25.6752 / Avg. batch time: 476.5838 (ms) / GPU bubble ratio: 32.79%
[rank3]:2025-11-04 02:09:35,229 - INFO - Avg. fwd time: 15.5616 / Avg. bwd time: 31.8161 / Avg. batch time: 394.8334 (ms) / GPU bubble ratio: 4.00%
[rank1]:2025-11-04 02:09:35,275 - INFO - Avg. fwd time: 16.4585 / Avg. bwd time: 28.9560 / Avg. batch time: 524.7992 (ms) / GPU bubble ratio: 30.77%
[rank1]:2025-11-04 02:09:35,329 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,774  tflops: 362.58  mfu: 36.66%
[rank2]:2025-11-04 02:09:35,327 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank0]:2025-11-04 02:09:35,329 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,774  tflops: 362.59  mfu: 36.66%
[rank3]:2025-11-04 02:09:37,272 - INFO -  step: 1100  loss:  0.2445  grad_norm:  0.0101  memory: 84.22GiB(60.24%)  tps: 7,800  tflops: 363.78  mfu: 36.78%
[rank1]:2025-11-04 02:09:37,321 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0209_stage1_step1100.svg
[rank2]:2025-11-04 02:09:37,321 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0209_stage2_step1100.svg
[rank0]:2025-11-04 02:09:37,322 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0209_stage0_step1100.svg
[rank3]:2025-11-04 02:09:37,401 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0209_real_step1100_rank3.svg
[rank3]:> Batch Time: 412.25 ms, GPU Bubble Ratio: 69.25%, 29.43%, 37.90%, 24.49%
[rank3]:2025-11-04 02:09:37,442 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0209_stage3_step1100.svg
[rank0]:2025-11-04 02:11:22,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:11:23,806 - INFO - Avg. fwd time: 14.6712 / Avg. bwd time: 17.8469 / Avg. batch time: 558.6364 (ms) / GPU bubble ratio: 53.43%
[rank3]:2025-11-04 02:11:24,034 - INFO - Avg. fwd time: 15.6042 / Avg. bwd time: 31.4355 / Avg. batch time: 392.1141 (ms) / GPU bubble ratio: 4.03%
[rank2]:2025-11-04 02:11:24,050 - INFO - Avg. fwd time: 14.4112 / Avg. bwd time: 25.2411 / Avg. batch time: 475.9143 (ms) / GPU bubble ratio: 33.35%
[rank1]:2025-11-04 02:11:24,078 - INFO - Avg. fwd time: 16.5137 / Avg. bwd time: 28.4660 / Avg. batch time: 523.5760 (ms) / GPU bubble ratio: 31.27%
[rank0]:2025-11-04 02:11:24,133 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,529  tflops: 351.16  mfu: 35.51%
[rank2]:2025-11-04 02:11:24,131 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,529  tflops: 351.16  mfu: 35.51%
[rank1]:2025-11-04 02:11:24,133 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,529  tflops: 351.16  mfu: 35.51%
[rank3]:2025-11-04 02:11:26,496 - INFO -  step: 1150  loss:  0.2314  grad_norm:  0.0128  memory: 84.22GiB(60.24%)  tps: 7,500  tflops: 349.81  mfu: 35.37%
[rank0]:2025-11-04 02:13:04,569 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:13:06,250 - INFO - Avg. fwd time: 15.6477 / Avg. bwd time: 31.0481 / Avg. batch time: 389.3432 (ms) / GPU bubble ratio: 4.05%
[rank2]:2025-11-04 02:13:06,276 - INFO - Avg. fwd time: 14.4557 / Avg. bwd time: 24.8451 / Avg. batch time: 474.3530 (ms) / GPU bubble ratio: 33.72%
[rank1]:2025-11-04 02:13:06,305 - INFO - Avg. fwd time: 16.5629 / Avg. bwd time: 28.0190 / Avg. batch time: 521.5122 (ms) / GPU bubble ratio: 31.61%
[rank0]:2025-11-04 02:13:06,316 - INFO - Avg. fwd time: 14.7096 / Avg. bwd time: 17.0662 / Avg. batch time: 555.7413 (ms) / GPU bubble ratio: 54.26%
[rank0]:2025-11-04 02:13:06,318 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank0]:2025-11-04 02:13:06,318 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-04 02:13:06,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank2]:2025-11-04 02:13:06,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-04 02:13:06,317 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank1]:2025-11-04 02:13:06,317 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-04 02:13:09,053 - INFO -  step: 1200  loss:  0.3046  grad_norm:  0.0150  memory: 84.22GiB(60.24%)  tps: 7,988  tflops: 372.56  mfu: 37.67%
[rank3]:2025-11-04 02:13:09,053 - INFO - ðŸ”Ž  Running validation at step 1200
[rank0]:2025-11-04 02:13:25,459 - INFO - validate step: 1200  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,400
[rank0]:2025-11-04 02:13:25,460 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 02:13:25,464 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2025-11-04 02:13:25,496 - INFO - validate step: 1200  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,357
[rank1]:2025-11-04 02:13:25,497 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 02:13:25,526 - INFO - validate step: 1200  loss:  0.2449  memory: 84.22GiB(60.24%)  tps: 24,865
[rank3]:2025-11-04 02:13:25,527 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 02:13:25,512 - INFO - validate step: 1200  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 21,339
[rank2]:2025-11-04 02:13:25,513 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 02:13:36,055 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.54 seconds.
[rank1]:2025-11-04 02:13:40,640 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 15.14 seconds.
[rank3]:2025-11-04 02:13:43,480 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.95 seconds.
[rank0]:2025-11-04 02:13:44,899 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 02:13:44,906 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 19.45 seconds.
[rank0]:2025-11-04 02:13:45,045 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0213_stage0_step1200.svg
[rank2]:2025-11-04 02:13:45,044 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0213_stage2_step1200.svg
[rank1]:2025-11-04 02:13:45,072 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0213_stage1_step1200.svg
[rank3]:2025-11-04 02:13:45,143 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0213_real_step1200_rank3.svg
[rank3]:> Batch Time: 410.00 ms, GPU Bubble Ratio: 69.70%, 29.92%, 38.26%, 24.51%
[rank3]:2025-11-04 02:13:45,223 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0213_stage3_step1200.svg
[rank0]:2025-11-04 02:15:33,367 - INFO - [GC] Peforming periodical GC collection 2.46 seconds
[rank0]:2025-11-04 02:15:34,732 - INFO - Avg. fwd time: 14.7417 / Avg. bwd time: 16.4495 / Avg. batch time: 554.9875 (ms) / GPU bubble ratio: 55.04%
[rank3]:2025-11-04 02:15:34,956 - INFO - Avg. fwd time: 15.6775 / Avg. bwd time: 30.7481 / Avg. batch time: 387.4292 (ms) / GPU bubble ratio: 4.14%
[rank2]:2025-11-04 02:15:34,972 - INFO - Avg. fwd time: 14.4879 / Avg. bwd time: 24.5307 / Avg. batch time: 474.6377 (ms) / GPU bubble ratio: 34.23%
[rank1]:2025-11-04 02:15:35,000 - INFO - Avg. fwd time: 16.5993 / Avg. bwd time: 27.6648 / Avg. batch time: 521.3971 (ms) / GPU bubble ratio: 32.08%
[rank0]:2025-11-04 02:15:35,055 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 6,321  tflops: 294.82  mfu: 29.81%
[rank2]:2025-11-04 02:15:35,052 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 6,324  tflops: 294.95  mfu: 29.82%
[rank1]:2025-11-04 02:15:35,054 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 6,323  tflops: 294.91  mfu: 29.82%
[rank3]:2025-11-04 02:15:37,268 - INFO -  step: 1250  loss:  0.2758  grad_norm:  0.0138  memory: 84.22GiB(60.24%)  tps: 6,218  tflops: 290.02  mfu: 29.33%
[rank0]:2025-11-04 02:17:13,851 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:17:15,198 - INFO - Avg. fwd time: 14.7742 / Avg. bwd time: 15.7841 / Avg. batch time: 552.1343 (ms) / GPU bubble ratio: 55.72%
[rank3]:2025-11-04 02:17:15,426 - INFO - Avg. fwd time: 15.7150 / Avg. bwd time: 30.4076 / Avg. batch time: 384.9765 (ms) / GPU bubble ratio: 4.16%
[rank2]:2025-11-04 02:17:15,441 - INFO - Avg. fwd time: 14.5245 / Avg. bwd time: 24.1921 / Avg. batch time: 472.9202 (ms) / GPU bubble ratio: 34.51%
[rank1]:2025-11-04 02:17:15,470 - INFO - Avg. fwd time: 16.6406 / Avg. bwd time: 27.2842 / Avg. batch time: 519.2507 (ms) / GPU bubble ratio: 32.33%
[rank0]:2025-11-04 02:17:15,526 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,154  tflops: 380.29  mfu: 38.45%
[rank2]:2025-11-04 02:17:15,524 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,154  tflops: 380.28  mfu: 38.45%
[rank1]:2025-11-04 02:17:15,526 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,154  tflops: 380.28  mfu: 38.45%
[rank0]:2025-11-04 02:17:18,440 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0217_stage0_step1300.svg
[rank3]:2025-11-04 02:17:18,388 - INFO -  step: 1300  loss:  0.2097  grad_norm:  0.0248  memory: 84.22GiB(60.24%)  tps: 8,102  tflops: 377.86  mfu: 38.21%
[rank2]:2025-11-04 02:17:18,439 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0217_stage2_step1300.svg
[rank1]:2025-11-04 02:17:18,439 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0217_stage1_step1300.svg
[rank3]:2025-11-04 02:17:18,522 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0217_real_step1300_rank3.svg
[rank3]:> Batch Time: 403.75 ms, GPU Bubble Ratio: 69.62%, 29.50%, 37.95%, 24.45%
[rank3]:2025-11-04 02:17:18,566 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0217_stage3_step1300.svg
[rank0]:2025-11-04 02:18:59,815 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:19:01,557 - INFO - Avg. fwd time: 15.7505 / Avg. bwd time: 30.1346 / Avg. batch time: 383.0561 (ms) / GPU bubble ratio: 4.17%
[rank1]:2025-11-04 02:19:01,614 - INFO - Avg. fwd time: 16.6842 / Avg. bwd time: 26.9348 / Avg. batch time: 517.6942 (ms) / GPU bubble ratio: 32.59%
[rank0]:2025-11-04 02:19:01,624 - INFO - Avg. fwd time: 14.8081 / Avg. bwd time: 15.1704 / Avg. batch time: 549.9264 (ms) / GPU bubble ratio: 56.39%
[rank0]:2025-11-04 02:19:01,627 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,721  tflops: 360.11  mfu: 36.41%
[rank2]:2025-11-04 02:19:01,585 - INFO - Avg. fwd time: 14.5630 / Avg. bwd time: 23.8825 / Avg. batch time: 471.7530 (ms) / GPU bubble ratio: 34.80%
[rank2]:2025-11-04 02:19:01,626 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,721  tflops: 360.10  mfu: 36.41%
[rank1]:2025-11-04 02:19:01,625 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,721  tflops: 360.11  mfu: 36.41%
[rank3]:2025-11-04 02:19:08,369 - INFO -  step: 1350  loss:  0.1547  grad_norm:  0.0287  memory: 84.22GiB(60.24%)  tps: 7,449  tflops: 347.41  mfu: 35.13%
[rank0]:2025-11-04 02:20:42,109 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:20:43,483 - INFO - Avg. fwd time: 14.8304 / Avg. bwd time: 14.6811 / Avg. batch time: 548.5516 (ms) / GPU bubble ratio: 56.96%
[rank3]:2025-11-04 02:20:43,711 - INFO - Avg. fwd time: 15.7781 / Avg. bwd time: 29.8668 / Avg. batch time: 381.1120 (ms) / GPU bubble ratio: 4.19%
[rank2]:2025-11-04 02:20:43,728 - INFO - Avg. fwd time: 14.5894 / Avg. bwd time: 23.6345 / Avg. batch time: 471.2185 (ms) / GPU bubble ratio: 35.11%
[rank1]:2025-11-04 02:20:43,756 - INFO - Avg. fwd time: 16.7131 / Avg. bwd time: 26.6553 / Avg. batch time: 516.8446 (ms) / GPU bubble ratio: 32.87%
[rank0]:2025-11-04 02:20:43,811 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank0]:2025-11-04 02:20:43,811 - INFO - ðŸ”Ž  Running validation at step 1400
[rank2]:2025-11-04 02:20:43,809 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank2]:2025-11-04 02:20:43,809 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-04 02:20:43,811 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,017  tflops: 373.91  mfu: 37.81%
[rank1]:2025-11-04 02:20:43,811 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-04 02:20:45,979 - INFO -  step: 1400  loss:  0.3975  grad_norm:  0.0171  memory: 84.22GiB(60.24%)  tps: 8,393  tflops: 391.44  mfu: 39.58%
[rank3]:2025-11-04 02:20:45,980 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-04 02:21:02,417 - INFO - validate step: 1400  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 22,014
[rank2]:2025-11-04 02:21:02,470 - INFO - validate step: 1400  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 21,949
[rank1]:2025-11-04 02:21:02,455 - INFO - validate step: 1400  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,970
[rank0]:2025-11-04 02:21:02,535 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0221_stage0_step1400.svg
[rank2]:2025-11-04 02:21:02,535 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0221_stage2_step1400.svg
[rank3]:2025-11-04 02:21:02,482 - INFO - validate step: 1400  loss:  0.2429  memory: 84.22GiB(60.24%)  tps: 24,823
[rank1]:2025-11-04 02:21:02,535 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0221_stage1_step1400.svg
[rank3]:2025-11-04 02:21:02,617 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0221_real_step1400_rank3.svg
[rank3]:> Batch Time: 424.75 ms, GPU Bubble Ratio: 70.74%, 32.46%, 40.39%, 22.55%
[rank3]:2025-11-04 02:21:02,663 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0221_stage3_step1400.svg
[rank0]:2025-11-04 02:22:44,281 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 02:22:45,618 - INFO - Avg. fwd time: 14.8646 / Avg. bwd time: 14.1488 / Avg. batch time: 546.6217 (ms) / GPU bubble ratio: 57.54%
[rank3]:2025-11-04 02:22:45,840 - INFO - Avg. fwd time: 15.8169 / Avg. bwd time: 29.6099 / Avg. batch time: 379.3520 (ms) / GPU bubble ratio: 4.20%
[rank1]:2025-11-04 02:22:45,885 - INFO - Avg. fwd time: 16.7563 / Avg. bwd time: 26.3548 / Avg. batch time: 515.4769 (ms) / GPU bubble ratio: 33.09%
[rank0]:2025-11-04 02:22:45,936 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,914  tflops: 369.09  mfu: 37.32%
[rank2]:2025-11-04 02:22:45,856 - INFO - Avg. fwd time: 14.6276 / Avg. bwd time: 23.3686 / Avg. batch time: 470.1822 (ms) / GPU bubble ratio: 35.35%
[rank2]:2025-11-04 02:22:45,934 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,918  tflops: 369.29  mfu: 37.34%
[rank1]:2025-11-04 02:22:45,936 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,916  tflops: 369.22  mfu: 37.33%
[rank3]:2025-11-04 02:22:47,576 - INFO -  step: 1450  loss:  0.1960  grad_norm:  0.0101  memory: 84.22GiB(60.24%)  tps: 7,795  tflops: 363.56  mfu: 36.76%
[rank0]:2025-11-04 02:24:28,466 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:24:30,141 - INFO - Avg. fwd time: 15.8565 / Avg. bwd time: 29.3626 / Avg. batch time: 377.6761 (ms) / GPU bubble ratio: 4.22%
[rank1]:2025-11-04 02:24:30,202 - INFO - Avg. fwd time: 16.7979 / Avg. bwd time: 26.0769 / Avg. batch time: 514.2861 (ms) / GPU bubble ratio: 33.31%
[rank0]:2025-11-04 02:24:30,213 - INFO - Avg. fwd time: 14.8975 / Avg. bwd time: 13.6537 / Avg. batch time: 544.9110 (ms) / GPU bubble ratio: 58.08%
[rank0]:2025-11-04 02:24:30,216 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,856  tflops: 366.39  mfu: 37.05%
[rank2]:2025-11-04 02:24:30,171 - INFO - Avg. fwd time: 14.6642 / Avg. bwd time: 23.1223 / Avg. batch time: 469.2947 (ms) / GPU bubble ratio: 35.59%
[rank2]:2025-11-04 02:24:30,215 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,856  tflops: 366.39  mfu: 37.05%
[rank1]:2025-11-04 02:24:30,215 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,856  tflops: 366.40  mfu: 37.05%
[rank0]:2025-11-04 02:24:31,331 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0224_stage0_step1500.svg
[rank2]:2025-11-04 02:24:31,331 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0224_stage2_step1500.svg
[rank3]:2025-11-04 02:24:31,278 - INFO -  step: 1500  loss:  0.3133  grad_norm:  0.0093  memory: 84.22GiB(60.24%)  tps: 7,900  tflops: 368.45  mfu: 37.25%
[rank1]:2025-11-04 02:24:31,330 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0224_stage1_step1500.svg
[rank3]:2025-11-04 02:24:31,406 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0224_real_step1500_rank3.svg
[rank3]:> Batch Time: 404.00 ms, GPU Bubble Ratio: 68.69%, 27.81%, 36.59%, 25.11%
[rank3]:2025-11-04 02:24:31,449 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0224_stage3_step1500.svg
[rank0]:2025-11-04 02:26:13,092 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:26:14,549 - INFO - Avg. fwd time: 14.9250 / Avg. bwd time: 13.2561 / Avg. batch time: 543.8151 (ms) / GPU bubble ratio: 58.54%
[rank2]:2025-11-04 02:26:14,813 - INFO - Avg. fwd time: 14.6931 / Avg. bwd time: 22.9233 / Avg. batch time: 468.8663 (ms) / GPU bubble ratio: 35.82%
[rank3]:2025-11-04 02:26:14,797 - INFO - Avg. fwd time: 15.8861 / Avg. bwd time: 29.1876 / Avg. batch time: 376.5011 (ms) / GPU bubble ratio: 4.23%
[rank1]:2025-11-04 02:26:14,847 - INFO - Avg. fwd time: 16.8321 / Avg. bwd time: 25.8524 / Avg. batch time: 513.6092 (ms) / GPU bubble ratio: 33.51%
[rank2]:2025-11-04 02:26:14,906 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank0]:2025-11-04 02:26:14,908 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank1]:2025-11-04 02:26:14,908 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,825  tflops: 364.95  mfu: 36.90%
[rank3]:2025-11-04 02:26:21,306 - INFO -  step: 1550  loss:  0.2954  grad_norm:  0.0447  memory: 84.22GiB(60.24%)  tps: 7,446  tflops: 347.26  mfu: 35.11%
[rank0]:2025-11-04 02:28:03,194 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:28:04,598 - INFO - Avg. fwd time: 14.9493 / Avg. bwd time: 12.8206 / Avg. batch time: 543.3245 (ms) / GPU bubble ratio: 59.11%
[rank3]:2025-11-04 02:28:04,831 - INFO - Avg. fwd time: 15.9116 / Avg. bwd time: 28.9935 / Avg. batch time: 375.1368 (ms) / GPU bubble ratio: 4.24%
[rank1]:2025-11-04 02:28:04,877 - INFO - Avg. fwd time: 16.8634 / Avg. bwd time: 25.6049 / Avg. batch time: 513.5827 (ms) / GPU bubble ratio: 33.85%
[rank2]:2025-11-04 02:28:04,847 - INFO - Avg. fwd time: 14.7197 / Avg. bwd time: 22.7036 / Avg. batch time: 469.1176 (ms) / GPU bubble ratio: 36.18%
[rank1]:2025-11-04 02:28:04,931 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,446  tflops: 347.27  mfu: 35.11%
[rank1]:2025-11-04 02:28:04,931 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-04 02:28:04,929 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,446  tflops: 347.27  mfu: 35.11%
[rank2]:2025-11-04 02:28:04,929 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 02:28:04,930 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,446  tflops: 347.27  mfu: 35.11%
[rank0]:2025-11-04 02:28:04,931 - INFO - ðŸ”Ž  Running validation at step 1600
[rank3]:2025-11-04 02:28:07,636 - INFO -  step: 1600  loss:  0.4263  grad_norm:  0.0214  memory: 84.22GiB(60.24%)  tps: 7,704  tflops: 359.34  mfu: 36.33%
[rank3]:2025-11-04 02:28:07,636 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-04 02:28:23,985 - INFO - validate step: 1600  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,497
[rank3]:2025-11-04 02:28:24,047 - INFO - validate step: 1600  loss:  0.2451  memory: 84.22GiB(60.24%)  tps: 24,961
[rank1]:2025-11-04 02:28:24,021 - INFO - validate step: 1600  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,456
[rank1]:2025-11-04 02:28:24,101 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0228_stage1_step1600.svg
[rank2]:2025-11-04 02:28:24,037 - INFO - validate step: 1600  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 21,436
[rank2]:2025-11-04 02:28:24,100 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0228_stage2_step1600.svg
[rank0]:2025-11-04 02:28:24,101 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0228_stage0_step1600.svg
[rank3]:2025-11-04 02:28:24,181 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0228_real_step1600_rank3.svg
[rank3]:> Batch Time: 411.00 ms, GPU Bubble Ratio: 69.38%, 29.33%, 37.97%, 24.36%
[rank3]:2025-11-04 02:28:24,227 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0228_stage3_step1600.svg
[rank0]:2025-11-04 02:30:01,971 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 02:30:03,821 - INFO - Avg. fwd time: 15.9388 / Avg. bwd time: 28.8095 / Avg. batch time: 373.8683 (ms) / GPU bubble ratio: 4.25%
[rank1]:2025-11-04 02:30:03,882 - INFO - Avg. fwd time: 16.8954 / Avg. bwd time: 25.3735 / Avg. batch time: 511.9017 (ms) / GPU bubble ratio: 33.94%
[rank1]:2025-11-04 02:30:03,895 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,202  tflops: 382.56  mfu: 38.68%
[rank2]:2025-11-04 02:30:03,850 - INFO - Avg. fwd time: 14.7483 / Avg. bwd time: 22.4992 / Avg. batch time: 467.6926 (ms) / GPU bubble ratio: 36.29%
[rank2]:2025-11-04 02:30:03,895 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,204  tflops: 382.62  mfu: 38.69%
[rank0]:2025-11-04 02:30:03,894 - INFO - Avg. fwd time: 14.9748 / Avg. bwd time: 12.4128 / Avg. batch time: 541.2126 (ms) / GPU bubble ratio: 59.52%
[rank0]:2025-11-04 02:30:03,897 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,199  tflops: 382.42  mfu: 38.67%
[rank3]:2025-11-04 02:30:12,124 - INFO -  step: 1650  loss:  0.4307  grad_norm:  0.0862  memory: 84.22GiB(60.24%)  tps: 7,580  tflops: 353.53  mfu: 35.75%
[rank0]:2025-11-04 02:31:50,550 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:31:51,946 - INFO - Avg. fwd time: 14.9953 / Avg. bwd time: 12.0833 / Avg. batch time: 541.0353 (ms) / GPU bubble ratio: 59.96%
[rank3]:2025-11-04 02:31:52,178 - INFO - Avg. fwd time: 15.9634 / Avg. bwd time: 28.6429 / Avg. batch time: 372.7186 (ms) / GPU bubble ratio: 4.26%
[rank2]:2025-11-04 02:31:52,196 - INFO - Avg. fwd time: 14.7709 / Avg. bwd time: 22.3341 / Avg. batch time: 468.0705 (ms) / GPU bubble ratio: 36.58%
[rank2]:2025-11-04 02:31:52,276 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,559  tflops: 352.53  mfu: 35.65%
[rank0]:2025-11-04 02:31:52,278 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,559  tflops: 352.53  mfu: 35.65%
[rank1]:2025-11-04 02:31:52,224 - INFO - Avg. fwd time: 16.9214 / Avg. bwd time: 25.1874 / Avg. batch time: 512.0737 (ms) / GPU bubble ratio: 34.21%
[rank1]:2025-11-04 02:31:52,278 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,558  tflops: 352.53  mfu: 35.64%
[rank3]:2025-11-04 02:31:55,006 - INFO -  step: 1700  loss:  0.4299  grad_norm:  0.0181  memory: 84.22GiB(60.24%)  tps: 7,963  tflops: 371.38  mfu: 37.55%
[rank2]:2025-11-04 02:31:55,059 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0231_stage2_step1700.svg
[rank0]:2025-11-04 02:31:55,060 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0231_stage0_step1700.svg
[rank1]:2025-11-04 02:31:55,058 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0231_stage1_step1700.svg
[rank3]:2025-11-04 02:31:55,136 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0231_real_step1700_rank3.svg
[rank3]:> Batch Time: 413.50 ms, GPU Bubble Ratio: 69.61%, 30.05%, 38.42%, 24.14%
[rank3]:2025-11-04 02:31:55,181 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0231_stage3_step1700.svg
[rank0]:2025-11-04 02:33:33,484 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:33:34,885 - INFO - Avg. fwd time: 15.0174 / Avg. bwd time: 11.7204 / Avg. batch time: 539.1710 (ms) / GPU bubble ratio: 60.33%
[rank3]:2025-11-04 02:33:35,120 - INFO - Avg. fwd time: 15.9897 / Avg. bwd time: 28.4579 / Avg. batch time: 371.4374 (ms) / GPU bubble ratio: 4.27%
[rank2]:2025-11-04 02:33:35,134 - INFO - Avg. fwd time: 14.7953 / Avg. bwd time: 22.1517 / Avg. batch time: 466.8184 (ms) / GPU bubble ratio: 36.68%
[rank1]:2025-11-04 02:33:35,163 - INFO - Avg. fwd time: 16.9496 / Avg. bwd time: 24.9820 / Avg. batch time: 510.5942 (ms) / GPU bubble ratio: 34.30%
[rank2]:2025-11-04 02:33:35,216 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,958  tflops: 371.17  mfu: 37.53%
[rank0]:2025-11-04 02:33:35,217 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,958  tflops: 371.17  mfu: 37.53%
[rank1]:2025-11-04 02:33:35,218 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,958  tflops: 371.17  mfu: 37.53%
[rank3]:2025-11-04 02:33:37,859 - INFO -  step: 1750  loss:  0.4512  grad_norm:  0.0253  memory: 84.22GiB(60.24%)  tps: 7,965  tflops: 371.49  mfu: 37.56%
[rank0]:2025-11-04 02:35:16,724 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:35:18,307 - INFO - Avg. fwd time: 16.0034 / Avg. bwd time: 28.2768 / Avg. batch time: 370.0821 (ms) / GPU bubble ratio: 4.28%
[rank2]:2025-11-04 02:35:18,335 - INFO - Avg. fwd time: 14.8099 / Avg. bwd time: 21.9763 / Avg. batch time: 466.2197 (ms) / GPU bubble ratio: 36.88%
[rank1]:2025-11-04 02:35:18,366 - INFO - Avg. fwd time: 16.9650 / Avg. bwd time: 24.7843 / Avg. batch time: 509.7716 (ms) / GPU bubble ratio: 34.48%
[rank2]:2025-11-04 02:35:18,380 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,941  tflops: 370.36  mfu: 37.45%
[rank2]:2025-11-04 02:35:18,381 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 02:35:18,379 - INFO - Avg. fwd time: 15.0287 / Avg. bwd time: 11.3787 / Avg. batch time: 537.9804 (ms) / GPU bubble ratio: 60.73%
[rank0]:2025-11-04 02:35:18,382 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,941  tflops: 370.36  mfu: 37.45%
[rank0]:2025-11-04 02:35:18,382 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-04 02:35:18,380 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,941  tflops: 370.36  mfu: 37.45%
[rank1]:2025-11-04 02:35:18,381 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-04 02:35:21,463 - INFO -  step: 1800  loss:  0.0865  grad_norm:  0.0064  memory: 84.22GiB(60.24%)  tps: 7,907  tflops: 368.79  mfu: 37.29%
[rank3]:2025-11-04 02:35:21,464 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-04 02:35:37,917 - INFO - validate step: 1800  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 20,968
[rank1]:2025-11-04 02:35:37,954 - INFO - validate step: 1800  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,927
[rank3]:2025-11-04 02:35:37,981 - INFO - validate step: 1800  loss:  0.2433  memory: 84.22GiB(60.24%)  tps: 24,800
[rank2]:2025-11-04 02:35:37,970 - INFO - validate step: 1800  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,910
[rank2]:2025-11-04 02:35:38,034 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0235_stage2_step1800.svg
[rank0]:2025-11-04 02:35:38,033 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0235_stage0_step1800.svg
[rank1]:2025-11-04 02:35:38,034 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0235_stage1_step1800.svg
[rank3]:2025-11-04 02:35:38,119 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0235_real_step1800_rank3.svg
[rank3]:> Batch Time: 395.50 ms, GPU Bubble Ratio: 69.76%, 29.11%, 37.53%, 24.81%
[rank3]:2025-11-04 02:35:38,164 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0235_stage3_step1800.svg
[rank0]:2025-11-04 02:37:15,757 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 02:37:17,087 - INFO - Avg. fwd time: 15.0375 / Avg. bwd time: 11.1012 / Avg. batch time: 536.9169 (ms) / GPU bubble ratio: 61.05%
[rank3]:2025-11-04 02:37:17,312 - INFO - Avg. fwd time: 16.0136 / Avg. bwd time: 28.1306 / Avg. batch time: 368.9800 (ms) / GPU bubble ratio: 4.29%
[rank2]:2025-11-04 02:37:17,327 - INFO - Avg. fwd time: 14.8216 / Avg. bwd time: 21.8333 / Avg. batch time: 465.6409 (ms) / GPU bubble ratio: 37.02%
[rank1]:2025-11-04 02:37:17,355 - INFO - Avg. fwd time: 16.9769 / Avg. bwd time: 24.6231 / Avg. batch time: 509.0082 (ms) / GPU bubble ratio: 34.62%
[rank0]:2025-11-04 02:37:17,407 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,234  tflops: 384.04  mfu: 38.83%
[rank2]:2025-11-04 02:37:17,405 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,239  tflops: 384.25  mfu: 38.85%
[rank1]:2025-11-04 02:37:17,407 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,237  tflops: 384.18  mfu: 38.85%
[rank3]:2025-11-04 02:37:19,913 - INFO -  step: 1850  loss:  0.3821  grad_norm:  0.0275  memory: 84.22GiB(60.24%)  tps: 8,037  tflops: 374.84  mfu: 37.90%
[rank0]:2025-11-04 02:38:59,941 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:39:01,261 - INFO - Avg. fwd time: 15.0447 / Avg. bwd time: 10.7942 / Avg. batch time: 536.0419 (ms) / GPU bubble ratio: 61.44%
[rank3]:2025-11-04 02:39:01,486 - INFO - Avg. fwd time: 16.0202 / Avg. bwd time: 27.9727 / Avg. batch time: 367.7565 (ms) / GPU bubble ratio: 4.30%
[rank2]:2025-11-04 02:39:01,502 - INFO - Avg. fwd time: 14.8318 / Avg. bwd time: 21.6742 / Avg. batch time: 465.3076 (ms) / GPU bubble ratio: 37.24%
[rank1]:2025-11-04 02:39:01,529 - INFO - Avg. fwd time: 16.9868 / Avg. bwd time: 24.4440 / Avg. batch time: 508.4677 (ms) / GPU bubble ratio: 34.81%
[rank0]:2025-11-04 02:39:01,582 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,864  tflops: 366.76  mfu: 37.08%
[rank2]:2025-11-04 02:39:01,581 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,864  tflops: 366.76  mfu: 37.08%
[rank1]:2025-11-04 02:39:01,583 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,864  tflops: 366.76  mfu: 37.08%
[rank3]:2025-11-04 02:39:04,485 - INFO -  step: 1900  loss:  0.2191  grad_norm:  0.0264  memory: 84.22GiB(60.24%)  tps: 7,834  tflops: 365.38  mfu: 36.94%
[rank1]:2025-11-04 02:39:04,538 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0239_stage1_step1900.svg
[rank2]:2025-11-04 02:39:04,539 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0239_stage2_step1900.svg
[rank0]:2025-11-04 02:39:04,538 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0239_stage0_step1900.svg
[rank3]:2025-11-04 02:39:04,623 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0239_real_step1900_rank3.svg
[rank3]:> Batch Time: 399.00 ms, GPU Bubble Ratio: 69.59%, 29.27%, 37.64%, 24.74%
[rank3]:2025-11-04 02:39:04,667 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0239_stage3_step1900.svg
[rank0]:2025-11-04 02:40:44,239 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:40:45,882 - INFO - Avg. fwd time: 16.0246 / Avg. bwd time: 27.8240 / Avg. batch time: 366.5871 (ms) / GPU bubble ratio: 4.31%
[rank1]:2025-11-04 02:40:45,943 - INFO - Avg. fwd time: 16.9944 / Avg. bwd time: 24.2731 / Avg. batch time: 507.6317 (ms) / GPU bubble ratio: 34.96%
[rank2]:2025-11-04 02:40:45,912 - INFO - Avg. fwd time: 14.8400 / Avg. bwd time: 21.5224 / Avg. batch time: 464.6705 (ms) / GPU bubble ratio: 37.40%
[rank2]:2025-11-04 02:40:45,958 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,848  tflops: 366.05  mfu: 37.01%
[rank0]:2025-11-04 02:40:45,957 - INFO - Avg. fwd time: 15.0500 / Avg. bwd time: 10.5036 / Avg. batch time: 534.8897 (ms) / GPU bubble ratio: 61.78%
[rank0]:2025-11-04 02:40:45,959 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,848  tflops: 366.06  mfu: 37.01%
[rank1]:2025-11-04 02:40:45,958 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,849  tflops: 366.06  mfu: 37.01%
[rank3]:2025-11-04 02:40:49,670 - INFO -  step: 1950  loss:  0.1818  grad_norm:  0.0152  memory: 84.22GiB(60.24%)  tps: 7,788  tflops: 363.25  mfu: 36.73%
[rank0]:2025-11-04 02:42:30,300 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:42:31,644 - INFO - Avg. fwd time: 15.0540 / Avg. bwd time: 10.2668 / Avg. batch time: 534.8564 (ms) / GPU bubble ratio: 62.13%
[rank3]:2025-11-04 02:42:31,874 - INFO - Avg. fwd time: 16.0274 / Avg. bwd time: 27.7080 / Avg. batch time: 365.6699 (ms) / GPU bubble ratio: 4.32%
[rank2]:2025-11-04 02:42:31,889 - INFO - Avg. fwd time: 14.8460 / Avg. bwd time: 21.3987 / Avg. batch time: 465.0587 (ms) / GPU bubble ratio: 37.65%
[rank1]:2025-11-04 02:42:31,917 - INFO - Avg. fwd time: 17.0001 / Avg. bwd time: 24.1337 / Avg. batch time: 507.8568 (ms) / GPU bubble ratio: 35.20%
[rank0]:2025-11-04 02:42:31,969 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,728  tflops: 360.42  mfu: 36.44%
[rank0]:2025-11-04 02:42:31,970 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-04 02:42:31,968 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,728  tflops: 360.42  mfu: 36.44%
[rank2]:2025-11-04 02:42:31,968 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-04 02:42:31,970 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,727  tflops: 360.41  mfu: 36.44%
[rank1]:2025-11-04 02:42:31,970 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-04 02:42:35,193 - INFO -  step: 2000  loss:  0.2154  grad_norm:  0.0237  memory: 84.22GiB(60.24%)  tps: 7,763  tflops: 362.09  mfu: 36.61%
[rank3]:2025-11-04 02:42:35,193 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-04 02:42:51,610 - INFO - validate step: 2000  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,854
[rank0]:2025-11-04 02:42:51,557 - INFO - validate step: 2000  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 20,911
[rank1]:2025-11-04 02:42:51,594 - INFO - validate step: 2000  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,873
[rank3]:2025-11-04 02:42:51,621 - INFO - validate step: 2000  loss:  0.2401  memory: 84.22GiB(60.24%)  tps: 24,934
[rank2]:2025-11-04 02:42:51,676 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0242_stage2_step2000.svg
[rank0]:2025-11-04 02:42:51,676 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0242_stage0_step2000.svg
[rank1]:2025-11-04 02:42:51,676 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0242_stage1_step2000.svg
[rank3]:2025-11-04 02:42:51,760 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0242_real_step2000_rank3.svg
[rank3]:> Batch Time: 397.50 ms, GPU Bubble Ratio: 69.53%, 28.92%, 37.36%, 25.98%
[rank3]:2025-11-04 02:42:51,806 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0242_stage3_step2000.svg
[rank0]:2025-11-04 02:44:32,688 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 02:44:33,991 - INFO - Avg. fwd time: 15.0594 / Avg. bwd time: 10.0036 / Avg. batch time: 533.9537 (ms) / GPU bubble ratio: 62.45%
[rank3]:2025-11-04 02:44:34,214 - INFO - Avg. fwd time: 16.0316 / Avg. bwd time: 27.5755 / Avg. batch time: 364.6327 (ms) / GPU bubble ratio: 4.33%
[rank2]:2025-11-04 02:44:34,230 - INFO - Avg. fwd time: 14.8540 / Avg. bwd time: 21.2616 / Avg. batch time: 464.6232 (ms) / GPU bubble ratio: 37.82%
[rank1]:2025-11-04 02:44:34,258 - INFO - Avg. fwd time: 17.0074 / Avg. bwd time: 23.9793 / Avg. batch time: 507.2409 (ms) / GPU bubble ratio: 35.36%
[rank1]:2025-11-04 02:44:34,306 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,976  tflops: 371.99  mfu: 37.61%
[rank0]:2025-11-04 02:44:34,306 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,973  tflops: 371.86  mfu: 37.60%
[rank2]:2025-11-04 02:44:34,304 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,977  tflops: 372.05  mfu: 37.62%
[rank3]:2025-11-04 02:44:35,813 - INFO -  step: 2050  loss:  0.2367  grad_norm:  0.0091  memory: 84.22GiB(60.24%)  tps: 7,863  tflops: 366.71  mfu: 37.08%
[rank0]:2025-11-04 02:46:05,049 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 02:46:06,670 - INFO - Avg. fwd time: 16.0399 / Avg. bwd time: 27.4162 / Avg. batch time: 363.4094 (ms) / GPU bubble ratio: 4.34%
[rank0]:2025-11-04 02:46:06,749 - INFO - Avg. fwd time: 15.0641 / Avg. bwd time: 9.7536 / Avg. batch time: 531.8619 (ms) / GPU bubble ratio: 62.67%
[rank0]:2025-11-04 02:46:06,752 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,861  tflops: 413.30  mfu: 41.79%
[rank2]:2025-11-04 02:46:06,701 - INFO - Avg. fwd time: 14.8619 / Avg. bwd time: 21.1321 / Avg. batch time: 462.9689 (ms) / GPU bubble ratio: 37.80%
[rank2]:2025-11-04 02:46:06,750 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,861  tflops: 413.30  mfu: 41.79%
[rank1]:2025-11-04 02:46:06,734 - INFO - Avg. fwd time: 17.0145 / Avg. bwd time: 23.8340 / Avg. batch time: 505.4204 (ms) / GPU bubble ratio: 35.34%
[rank1]:2025-11-04 02:46:06,750 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,862  tflops: 413.31  mfu: 41.79%
[rank3]:2025-11-04 02:46:09,908 - INFO -  step: 2100  loss:  0.2441  grad_norm:  0.0192  memory: 84.22GiB(60.24%)  tps: 8,706  tflops: 406.07  mfu: 41.06%
[rank0]:2025-11-04 02:46:09,959 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0246_stage0_step2100.svg
[rank2]:2025-11-04 02:46:09,957 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0246_stage2_step2100.svg
[rank1]:2025-11-04 02:46:09,956 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0246_stage1_step2100.svg
[rank3]:2025-11-04 02:46:10,042 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0246_real_step2100_rank3.svg
[rank3]:> Batch Time: 403.75 ms, GPU Bubble Ratio: 69.80%, 29.79%, 38.03%, 24.52%
[rank3]:2025-11-04 02:46:10,089 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0246_stage3_step2100.svg
[rank0]:2025-11-04 02:47:53,476 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:47:54,789 - INFO - Avg. fwd time: 15.0680 / Avg. bwd time: 9.5491 / Avg. batch time: 531.8131 (ms) / GPU bubble ratio: 62.97%
[rank3]:2025-11-04 02:47:55,013 - INFO - Avg. fwd time: 16.0412 / Avg. bwd time: 27.3247 / Avg. batch time: 362.6773 (ms) / GPU bubble ratio: 4.34%
[rank2]:2025-11-04 02:47:55,027 - INFO - Avg. fwd time: 14.8678 / Avg. bwd time: 21.0254 / Avg. batch time: 463.2851 (ms) / GPU bubble ratio: 38.02%
[rank1]:2025-11-04 02:47:55,057 - INFO - Avg. fwd time: 17.0199 / Avg. bwd time: 23.7138 / Avg. batch time: 505.5952 (ms) / GPU bubble ratio: 35.55%
[rank1]:2025-11-04 02:47:55,107 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,560  tflops: 352.61  mfu: 35.65%
[rank0]:2025-11-04 02:47:55,107 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,560  tflops: 352.62  mfu: 35.65%
[rank2]:2025-11-04 02:47:55,105 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,560  tflops: 352.62  mfu: 35.65%
[rank3]:2025-11-04 02:47:58,204 - INFO -  step: 2150  loss:  0.1989  grad_norm:  0.0150  memory: 84.22GiB(60.24%)  tps: 7,565  tflops: 352.82  mfu: 35.67%
[rank0]:2025-11-04 02:49:30,767 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:49:32,102 - INFO - Avg. fwd time: 15.0719 / Avg. bwd time: 9.3210 / Avg. batch time: 530.4142 (ms) / GPU bubble ratio: 63.21%
[rank2]:2025-11-04 02:49:32,341 - INFO - Avg. fwd time: 14.8741 / Avg. bwd time: 20.9070 / Avg. batch time: 462.2908 (ms) / GPU bubble ratio: 38.08%
[rank1]:2025-11-04 02:49:32,371 - INFO - Avg. fwd time: 17.0254 / Avg. bwd time: 23.5806 / Avg. batch time: 504.4452 (ms) / GPU bubble ratio: 35.60%
[rank3]:2025-11-04 02:49:32,326 - INFO - Avg. fwd time: 16.0465 / Avg. bwd time: 27.1901 / Avg. batch time: 361.6298 (ms) / GPU bubble ratio: 4.35%
[rank2]:2025-11-04 02:49:32,422 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,418  tflops: 392.61  mfu: 39.70%
[rank2]:2025-11-04 02:49:32,422 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 02:49:32,424 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,418  tflops: 392.61  mfu: 39.70%
[rank0]:2025-11-04 02:49:32,424 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-04 02:49:32,424 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,418  tflops: 392.61  mfu: 39.70%
[rank1]:2025-11-04 02:49:32,424 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-04 02:49:36,288 - INFO -  step: 2200  loss:  0.1925  grad_norm:  0.0156  memory: 84.22GiB(60.24%)  tps: 8,352  tflops: 389.55  mfu: 39.39%
[rank3]:2025-11-04 02:49:36,289 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-04 02:49:52,722 - INFO - validate step: 2200  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 20,179
[rank1]:2025-11-04 02:49:52,758 - INFO - validate step: 2200  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,143
[rank3]:2025-11-04 02:49:52,783 - INFO - validate step: 2200  loss:  0.2402  memory: 84.22GiB(60.24%)  tps: 24,834
[rank0]:2025-11-04 02:49:52,833 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0249_stage0_step2200.svg
[rank2]:2025-11-04 02:49:52,776 - INFO - validate step: 2200  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,124
[rank2]:2025-11-04 02:49:52,834 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0249_stage2_step2200.svg
[rank1]:2025-11-04 02:49:52,833 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0249_stage1_step2200.svg
[rank3]:2025-11-04 02:49:52,915 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0249_real_step2200_rank3.svg
[rank3]:> Batch Time: 405.50 ms, GPU Bubble Ratio: 69.87%, 29.99%, 38.32%, 23.88%
[rank3]:2025-11-04 02:49:52,957 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0249_stage3_step2200.svg
[rank0]:2025-11-04 02:51:31,497 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-11-04 02:51:33,197 - INFO - Avg. fwd time: 17.0310 / Avg. bwd time: 23.4534 / Avg. batch time: 503.7028 (ms) / GPU bubble ratio: 35.70%
[rank3]:2025-11-04 02:51:33,130 - INFO - Avg. fwd time: 16.0499 / Avg. bwd time: 27.0780 / Avg. batch time: 360.7490 (ms) / GPU bubble ratio: 4.36%
[rank2]:2025-11-04 02:51:33,161 - INFO - Avg. fwd time: 14.8806 / Avg. bwd time: 20.7943 / Avg. batch time: 461.6958 (ms) / GPU bubble ratio: 38.18%
[rank2]:2025-11-04 02:51:33,214 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,156  tflops: 380.41  mfu: 38.46%
[rank0]:2025-11-04 02:51:33,213 - INFO - Avg. fwd time: 15.0758 / Avg. bwd time: 9.1036 / Avg. batch time: 529.4355 (ms) / GPU bubble ratio: 63.46%
[rank0]:2025-11-04 02:51:33,216 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,152  tflops: 380.20  mfu: 38.44%
[rank1]:2025-11-04 02:51:33,214 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,155  tflops: 380.35  mfu: 38.46%
[rank3]:2025-11-04 02:51:36,501 - INFO -  step: 2250  loss:  0.2403  grad_norm:  0.0203  memory: 84.22GiB(60.24%)  tps: 7,899  tflops: 368.39  mfu: 37.25%
[rank0]:2025-11-04 02:53:05,990 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:53:07,289 - INFO - Avg. fwd time: 15.0791 / Avg. bwd time: 8.9252 / Avg. batch time: 528.2795 (ms) / GPU bubble ratio: 63.65%
[rank3]:2025-11-04 02:53:07,507 - INFO - Avg. fwd time: 16.0561 / Avg. bwd time: 26.9620 / Avg. batch time: 359.8599 (ms) / GPU bubble ratio: 4.37%
[rank2]:2025-11-04 02:53:07,524 - INFO - Avg. fwd time: 14.8859 / Avg. bwd time: 20.7016 / Avg. batch time: 460.8548 (ms) / GPU bubble ratio: 38.22%
[rank1]:2025-11-04 02:53:07,551 - INFO - Avg. fwd time: 17.0357 / Avg. bwd time: 23.3496 / Avg. batch time: 502.7414 (ms) / GPU bubble ratio: 35.74%
[rank0]:2025-11-04 02:53:07,599 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,680  tflops: 404.82  mfu: 40.93%
[rank2]:2025-11-04 02:53:07,597 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,680  tflops: 404.82  mfu: 40.93%
[rank1]:2025-11-04 02:53:07,599 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,679  tflops: 404.81  mfu: 40.93%
[rank3]:2025-11-04 02:53:09,282 - INFO -  step: 2300  loss:  0.2108  grad_norm:  0.0055  memory: 84.22GiB(60.24%)  tps: 8,830  tflops: 411.81  mfu: 41.64%
[rank1]:2025-11-04 02:53:09,329 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0253_stage1_step2300.svg
[rank3]:2025-11-04 02:53:09,411 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0253_real_step2300_rank3.svg
[rank3]:> Batch Time: 401.75 ms, GPU Bubble Ratio: 69.65%, 29.31%, 37.81%, 24.55%
[rank0]:2025-11-04 02:53:09,332 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0253_stage0_step2300.svg
[rank2]:2025-11-04 02:53:09,332 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0253_stage2_step2300.svg
[rank3]:2025-11-04 02:53:09,452 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0253_stage3_step2300.svg
[rank0]:2025-11-04 02:54:41,733 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 02:54:43,064 - INFO - Avg. fwd time: 15.0826 / Avg. bwd time: 8.7257 / Avg. batch time: 526.6919 (ms) / GPU bubble ratio: 63.84%
[rank3]:2025-11-04 02:54:43,289 - INFO - Avg. fwd time: 16.0617 / Avg. bwd time: 26.8401 / Avg. batch time: 358.9178 (ms) / GPU bubble ratio: 4.38%
[rank2]:2025-11-04 02:54:43,304 - INFO - Avg. fwd time: 14.8920 / Avg. bwd time: 20.5983 / Avg. batch time: 459.6210 (ms) / GPU bubble ratio: 38.23%
[rank1]:2025-11-04 02:54:43,333 - INFO - Avg. fwd time: 17.0411 / Avg. bwd time: 23.2330 / Avg. batch time: 501.3718 (ms) / GPU bubble ratio: 35.74%
[rank0]:2025-11-04 02:54:43,382 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,553  tflops: 398.90  mfu: 40.33%
[rank2]:2025-11-04 02:54:43,381 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,553  tflops: 398.90  mfu: 40.33%
[rank1]:2025-11-04 02:54:43,383 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,553  tflops: 398.90  mfu: 40.33%
[rank3]:2025-11-04 02:54:46,144 - INFO -  step: 2350  loss:  0.1976  grad_norm:  0.0069  memory: 84.22GiB(60.24%)  tps: 8,458  tflops: 394.46  mfu: 39.89%
[rank0]:2025-11-04 02:56:27,343 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-04 02:56:29,048 - INFO - Avg. fwd time: 17.0461 / Avg. bwd time: 23.1210 / Avg. batch time: 501.2931 (ms) / GPU bubble ratio: 35.90%
[rank3]:2025-11-04 02:56:28,982 - INFO - Avg. fwd time: 16.0638 / Avg. bwd time: 26.7474 / Avg. batch time: 358.1862 (ms) / GPU bubble ratio: 4.38%
[rank0]:2025-11-04 02:56:29,063 - INFO - Avg. fwd time: 15.0860 / Avg. bwd time: 8.5349 / Avg. batch time: 526.4061 (ms) / GPU bubble ratio: 64.10%
[rank0]:2025-11-04 02:56:29,066 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,751  tflops: 361.53  mfu: 36.56%
[rank2]:2025-11-04 02:56:29,014 - INFO - Avg. fwd time: 14.8977 / Avg. bwd time: 20.4989 / Avg. batch time: 459.6721 (ms) / GPU bubble ratio: 38.40%
[rank0]:2025-11-04 02:56:29,066 - INFO - ðŸ”Ž  Running validation at step 2400
[rank2]:2025-11-04 02:56:29,064 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,751  tflops: 361.53  mfu: 36.55%
[rank2]:2025-11-04 02:56:29,064 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-04 02:56:29,064 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,752  tflops: 361.54  mfu: 36.56%
[rank1]:2025-11-04 02:56:29,064 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-04 02:56:32,157 - INFO -  step: 2400  loss:  0.2043  grad_norm:  0.0144  memory: 84.22GiB(60.24%)  tps: 7,728  tflops: 360.41  mfu: 36.44%
[rank3]:2025-11-04 02:56:32,157 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-04 02:56:48,548 - INFO - validate step: 2400  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,025
[rank0]:2025-11-04 02:56:48,548 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 02:56:48,555 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-04 02:56:48,600 - INFO - validate step: 2400  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,967
[rank2]:2025-11-04 02:56:48,601 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 02:56:48,584 - INFO - validate step: 2400  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,984
[rank1]:2025-11-04 02:56:48,585 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 02:56:48,612 - INFO - validate step: 2400  loss:  0.2379  memory: 84.22GiB(60.24%)  tps: 24,893
[rank3]:2025-11-04 02:56:48,613 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 02:56:59,751 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.15 seconds.
[rank1]:2025-11-04 02:57:05,815 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 17.23 seconds.
[rank3]:2025-11-04 02:57:07,492 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 18.88 seconds.
[rank0]:2025-11-04 02:57:09,186 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-04 02:57:09,191 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 20.64 seconds.
[rank1]:2025-11-04 02:57:09,253 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0257_stage1_step2400.svg
[rank2]:2025-11-04 02:57:09,254 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0256_stage2_step2400.svg
[rank0]:2025-11-04 02:57:09,321 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0257_stage0_step2400.svg
[rank3]:2025-11-04 02:57:09,399 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0257_real_step2400_rank3.svg
[rank3]:> Batch Time: 401.50 ms, GPU Bubble Ratio: 69.75%, 29.61%, 37.96%, 24.51%
[rank3]:2025-11-04 02:57:09,489 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0257_stage3_step2400.svg
[rank0]:2025-11-04 02:58:53,466 - INFO - [GC] Peforming periodical GC collection 2.39 seconds
[rank0]:2025-11-04 02:58:54,864 - INFO - Avg. fwd time: 15.0900 / Avg. bwd time: 8.3778 / Avg. batch time: 526.2419 (ms) / GPU bubble ratio: 64.32%
[rank3]:2025-11-04 02:58:55,066 - INFO - Avg. fwd time: 16.0663 / Avg. bwd time: 26.6612 / Avg. batch time: 357.5078 (ms) / GPU bubble ratio: 4.39%
[rank2]:2025-11-04 02:58:55,081 - INFO - Avg. fwd time: 14.9011 / Avg. bwd time: 20.4162 / Avg. batch time: 459.7805 (ms) / GPU bubble ratio: 38.55%
[rank1]:2025-11-04 02:58:55,110 - INFO - Avg. fwd time: 17.0495 / Avg. bwd time: 23.0289 / Avg. batch time: 501.2929 (ms) / GPU bubble ratio: 36.04%
[rank1]:2025-11-04 02:58:55,153 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 6,472  tflops: 301.87  mfu: 30.52%
[rank0]:2025-11-04 02:58:55,155 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 6,470  tflops: 301.78  mfu: 30.51%
[rank2]:2025-11-04 02:58:55,152 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 6,473  tflops: 301.91  mfu: 30.53%
[rank3]:2025-11-04 02:58:56,791 - INFO -  step: 2450  loss:  0.2480  grad_norm:  0.0058  memory: 84.22GiB(60.24%)  tps: 6,391  tflops: 298.09  mfu: 30.14%
[rank0]:2025-11-04 03:00:34,702 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:00:36,011 - INFO - Avg. fwd time: 15.0937 / Avg. bwd time: 8.2018 / Avg. batch time: 525.4797 (ms) / GPU bubble ratio: 64.53%
[rank2]:2025-11-04 03:00:36,240 - INFO - Avg. fwd time: 14.9061 / Avg. bwd time: 20.3244 / Avg. batch time: 459.3260 (ms) / GPU bubble ratio: 38.64%
[rank3]:2025-11-04 03:00:36,227 - INFO - Avg. fwd time: 16.0712 / Avg. bwd time: 26.5550 / Avg. batch time: 356.6873 (ms) / GPU bubble ratio: 4.40%
[rank1]:2025-11-04 03:00:36,270 - INFO - Avg. fwd time: 17.0545 / Avg. bwd time: 22.9263 / Avg. batch time: 500.7198 (ms) / GPU bubble ratio: 36.12%
[rank1]:2025-11-04 03:00:36,315 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,098  tflops: 377.69  mfu: 38.19%
[rank0]:2025-11-04 03:00:36,315 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,098  tflops: 377.69  mfu: 38.19%
[rank2]:2025-11-04 03:00:36,313 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,098  tflops: 377.69  mfu: 38.19%
[rank1]:2025-11-04 03:00:38,351 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0300_stage1_step2500.svg
[rank0]:2025-11-04 03:00:38,353 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0300_stage0_step2500.svg
[rank2]:2025-11-04 03:00:38,350 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0300_stage2_step2500.svg
[rank3]:2025-11-04 03:00:38,299 - INFO -  step: 2500  loss:  0.2292  grad_norm:  0.0067  memory: 84.22GiB(60.24%)  tps: 8,070  tflops: 376.41  mfu: 38.06%
[rank3]:2025-11-04 03:00:38,440 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0300_real_step2500_rank3.svg
[rank3]:> Batch Time: 397.50 ms, GPU Bubble Ratio: 69.36%, 28.67%, 37.30%, 25.27%
[rank3]:2025-11-04 03:00:38,482 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0300_stage3_step2500.svg
[rank0]:2025-11-04 03:02:24,875 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-04 03:02:26,563 - INFO - Avg. fwd time: 14.9143 / Avg. bwd time: 20.2382 / Avg. batch time: 459.5119 (ms) / GPU bubble ratio: 38.80%
[rank3]:2025-11-04 03:02:26,530 - INFO - Avg. fwd time: 16.0788 / Avg. bwd time: 26.4712 / Avg. batch time: 356.0720 (ms) / GPU bubble ratio: 4.40%
[rank1]:2025-11-04 03:02:26,599 - INFO - Avg. fwd time: 17.0638 / Avg. bwd time: 22.8296 / Avg. batch time: 500.7967 (ms) / GPU bubble ratio: 36.27%
[rank1]:2025-11-04 03:02:26,622 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,427  tflops: 346.38  mfu: 35.02%
[rank0]:2025-11-04 03:02:26,621 - INFO - Avg. fwd time: 15.1008 / Avg. bwd time: 8.0330 / Avg. batch time: 525.3766 (ms) / GPU bubble ratio: 64.77%
[rank0]:2025-11-04 03:02:26,624 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,426  tflops: 346.37  mfu: 35.02%
[rank2]:2025-11-04 03:02:26,622 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,426  tflops: 346.37  mfu: 35.02%
[rank3]:2025-11-04 03:02:28,208 - INFO -  step: 2550  loss:  0.4847  grad_norm:  0.0133  memory: 84.22GiB(60.24%)  tps: 7,454  tflops: 347.64  mfu: 35.15%
[rank0]:2025-11-04 03:04:11,111 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:04:12,565 - INFO - Avg. fwd time: 15.1083 / Avg. bwd time: 7.8938 / Avg. batch time: 525.3671 (ms) / GPU bubble ratio: 64.97%
[rank1]:2025-11-04 03:04:12,851 - INFO - Avg. fwd time: 17.0724 / Avg. bwd time: 22.7496 / Avg. batch time: 500.9352 (ms) / GPU bubble ratio: 36.40%
[rank2]:2025-11-04 03:04:12,816 - INFO - Avg. fwd time: 14.9220 / Avg. bwd time: 20.1670 / Avg. batch time: 459.7416 (ms) / GPU bubble ratio: 38.94%
[rank3]:2025-11-04 03:04:12,799 - INFO - Avg. fwd time: 16.0859 / Avg. bwd time: 26.4114 / Avg. batch time: 355.6456 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-11-04 03:04:12,908 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,708  tflops: 359.48  mfu: 36.35%
[rank1]:2025-11-04 03:04:12,908 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 03:04:12,908 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,708  tflops: 359.49  mfu: 36.35%
[rank0]:2025-11-04 03:04:12,908 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-04 03:04:12,906 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,708  tflops: 359.49  mfu: 36.35%
[rank2]:2025-11-04 03:04:12,906 - INFO - ðŸ”Ž  Running validation at step 2600
[rank3]:2025-11-04 03:04:23,415 - INFO -  step: 2600  loss:  0.4313  grad_norm:  0.0581  memory: 84.22GiB(60.24%)  tps: 7,111  tflops: 331.65  mfu: 33.53%
[rank3]:2025-11-04 03:04:23,415 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-04 03:04:39,779 - INFO - validate step: 2600  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 15,243
[rank1]:2025-11-04 03:04:39,815 - INFO - validate step: 2600  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 15,223
[rank2]:2025-11-04 03:04:39,831 - INFO - validate step: 2600  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 15,213
[rank3]:2025-11-04 03:04:39,838 - INFO - validate step: 2600  loss:  0.2406  memory: 84.22GiB(60.24%)  tps: 24,943
[rank1]:2025-11-04 03:04:39,889 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0304_stage1_step2600.svg
[rank0]:2025-11-04 03:04:39,890 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0304_stage0_step2600.svg
[rank2]:2025-11-04 03:04:39,889 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0304_stage2_step2600.svg
[rank3]:2025-11-04 03:04:39,968 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0304_real_step2600_rank3.svg
[rank3]:> Batch Time: 408.25 ms, GPU Bubble Ratio: 69.56%, 29.88%, 38.25%, 24.68%
[rank3]:2025-11-04 03:04:40,011 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0304_stage3_step2600.svg
[rank0]:2025-11-04 03:06:22,961 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2025-11-04 03:06:24,325 - INFO - Avg. fwd time: 15.1166 / Avg. bwd time: 7.7373 / Avg. batch time: 524.9947 (ms) / GPU bubble ratio: 65.17%
[rank2]:2025-11-04 03:06:24,562 - INFO - Avg. fwd time: 14.9310 / Avg. bwd time: 20.0876 / Avg. batch time: 459.6386 (ms) / GPU bubble ratio: 39.05%
[rank3]:2025-11-04 03:06:24,549 - INFO - Avg. fwd time: 16.0939 / Avg. bwd time: 26.3429 / Avg. batch time: 355.1557 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-11-04 03:06:24,593 - INFO - Avg. fwd time: 17.0826 / Avg. bwd time: 22.6601 / Avg. batch time: 500.7303 (ms) / GPU bubble ratio: 36.50%
[rank1]:2025-11-04 03:06:24,640 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,815  tflops: 364.49  mfu: 36.85%
[rank2]:2025-11-04 03:06:24,637 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,816  tflops: 364.55  mfu: 36.86%
[rank0]:2025-11-04 03:06:24,639 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,812  tflops: 364.37  mfu: 36.84%
[rank3]:2025-11-04 03:06:28,059 - INFO -  step: 2650  loss:  0.3527  grad_norm:  0.0162  memory: 84.22GiB(60.24%)  tps: 7,570  tflops: 353.06  mfu: 35.70%
[rank0]:2025-11-04 03:08:13,892 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 03:08:15,556 - INFO - Avg. fwd time: 16.1026 / Avg. bwd time: 26.2699 / Avg. batch time: 354.6352 (ms) / GPU bubble ratio: 4.41%
[rank1]:2025-11-04 03:08:15,626 - INFO - Avg. fwd time: 17.0923 / Avg. bwd time: 22.5741 / Avg. batch time: 501.0476 (ms) / GPU bubble ratio: 36.67%
[rank1]:2025-11-04 03:08:15,650 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,379  tflops: 344.18  mfu: 34.80%
[rank0]:2025-11-04 03:08:15,649 - INFO - Avg. fwd time: 15.1245 / Avg. bwd time: 7.5869 / Avg. batch time: 525.1529 (ms) / GPU bubble ratio: 65.40%
[rank0]:2025-11-04 03:08:15,652 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,379  tflops: 344.17  mfu: 34.80%
[rank2]:2025-11-04 03:08:15,590 - INFO - Avg. fwd time: 14.9394 / Avg. bwd time: 20.0109 / Avg. batch time: 460.0523 (ms) / GPU bubble ratio: 39.22%
[rank2]:2025-11-04 03:08:15,650 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,379  tflops: 344.17  mfu: 34.80%
[rank1]:2025-11-04 03:08:18,047 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0308_stage1_step2700.svg
[rank0]:2025-11-04 03:08:18,050 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0308_stage0_step2700.svg
[rank2]:2025-11-04 03:08:18,047 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0308_stage2_step2700.svg
[rank3]:2025-11-04 03:08:17,995 - INFO -  step: 2700  loss:  0.3882  grad_norm:  0.0092  memory: 84.22GiB(60.24%)  tps: 7,452  tflops: 347.55  mfu: 35.14%
[rank3]:2025-11-04 03:08:18,128 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0308_real_step2700_rank3.svg
[rank3]:> Batch Time: 402.25 ms, GPU Bubble Ratio: 69.19%, 28.70%, 37.39%, 24.97%
[rank3]:2025-11-04 03:08:18,171 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0308_stage3_step2700.svg
[rank0]:2025-11-04 03:10:12,580 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:10:13,952 - INFO - Avg. fwd time: 15.1308 / Avg. bwd time: 7.4626 / Avg. batch time: 526.1157 (ms) / GPU bubble ratio: 65.64%
[rank3]:2025-11-04 03:10:14,175 - INFO - Avg. fwd time: 16.1068 / Avg. bwd time: 26.2322 / Avg. batch time: 354.3648 (ms) / GPU bubble ratio: 4.42%
[rank1]:2025-11-04 03:10:14,215 - INFO - Avg. fwd time: 17.1003 / Avg. bwd time: 22.5027 / Avg. batch time: 502.1434 (ms) / GPU bubble ratio: 36.91%
[rank0]:2025-11-04 03:10:14,264 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 6,907  tflops: 322.12  mfu: 32.57%
[rank2]:2025-11-04 03:10:14,189 - INFO - Avg. fwd time: 14.9460 / Avg. bwd time: 19.9470 / Avg. batch time: 461.2294 (ms) / GPU bubble ratio: 39.48%
[rank2]:2025-11-04 03:10:14,262 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 6,907  tflops: 322.12  mfu: 32.57%
[rank1]:2025-11-04 03:10:14,264 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 6,906  tflops: 322.12  mfu: 32.57%
[rank3]:2025-11-04 03:10:16,929 - INFO -  step: 2750  loss:  0.3234  grad_norm:  0.0136  memory: 84.22GiB(60.24%)  tps: 6,888  tflops: 321.26  mfu: 32.48%
[rank0]:2025-11-04 03:12:08,373 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:12:09,737 - INFO - Avg. fwd time: 15.1379 / Avg. bwd time: 7.3226 / Avg. batch time: 526.6781 (ms) / GPU bubble ratio: 65.88%
[rank2]:2025-11-04 03:12:09,972 - INFO - Avg. fwd time: 14.9534 / Avg. bwd time: 19.8752 / Avg. batch time: 462.0329 (ms) / GPU bubble ratio: 39.69%
[rank3]:2025-11-04 03:12:09,958 - INFO - Avg. fwd time: 16.1133 / Avg. bwd time: 26.1757 / Avg. batch time: 353.9602 (ms) / GPU bubble ratio: 4.42%
[rank1]:2025-11-04 03:12:09,998 - INFO - Avg. fwd time: 17.1093 / Avg. bwd time: 22.4225 / Avg. batch time: 502.8556 (ms) / GPU bubble ratio: 37.11%
[rank1]:2025-11-04 03:12:10,044 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,075  tflops: 330.00  mfu: 33.37%
[rank1]:2025-11-04 03:12:10,045 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-04 03:12:10,042 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,075  tflops: 330.00  mfu: 33.37%
[rank2]:2025-11-04 03:12:10,042 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-04 03:12:10,044 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,075  tflops: 330.00  mfu: 33.37%
[rank0]:2025-11-04 03:12:10,045 - INFO - ðŸ”Ž  Running validation at step 2800
[rank3]:2025-11-04 03:12:12,312 - INFO -  step: 2800  loss:  0.3224  grad_norm:  0.0195  memory: 84.22GiB(60.24%)  tps: 7,100  tflops: 331.15  mfu: 33.48%
[rank3]:2025-11-04 03:12:12,312 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-04 03:12:28,760 - INFO - validate step: 2800  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 21,886
[rank0]:2025-11-04 03:12:28,723 - INFO - validate step: 2800  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 21,930
[rank2]:2025-11-04 03:12:28,774 - INFO - validate step: 2800  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 21,867
[rank3]:2025-11-04 03:12:28,787 - INFO - validate step: 2800  loss:  0.2387  memory: 84.22GiB(60.24%)  tps: 24,864
[rank1]:2025-11-04 03:12:28,840 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0312_stage1_step2800.svg
[rank0]:2025-11-04 03:12:28,840 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0312_stage0_step2800.svg
[rank2]:2025-11-04 03:12:28,839 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0312_stage2_step2800.svg
[rank3]:2025-11-04 03:12:28,922 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0312_real_step2800_rank3.svg
[rank3]:> Batch Time: 402.00 ms, GPU Bubble Ratio: 69.25%, 28.97%, 37.50%, 24.98%
[rank3]:2025-11-04 03:12:28,967 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0312_stage3_step2800.svg
[rank0]:2025-11-04 03:14:10,613 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-04 03:14:12,284 - INFO - Avg. fwd time: 16.1224 / Avg. bwd time: 26.1030 / Avg. batch time: 353.4473 (ms) / GPU bubble ratio: 4.43%
[rank2]:2025-11-04 03:14:12,320 - INFO - Avg. fwd time: 14.9615 / Avg. bwd time: 19.8069 / Avg. batch time: 461.7223 (ms) / GPU bubble ratio: 39.76%
[rank1]:2025-11-04 03:14:12,358 - INFO - Avg. fwd time: 17.1190 / Avg. bwd time: 22.3462 / Avg. batch time: 502.4609 (ms) / GPU bubble ratio: 37.16%
[rank1]:2025-11-04 03:14:12,381 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,906  tflops: 368.73  mfu: 37.28%
[rank2]:2025-11-04 03:14:12,381 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,907  tflops: 368.78  mfu: 37.29%
[rank0]:2025-11-04 03:14:12,379 - INFO - Avg. fwd time: 15.1454 / Avg. bwd time: 7.1878 / Avg. batch time: 526.1412 (ms) / GPU bubble ratio: 66.04%
[rank0]:2025-11-04 03:14:12,383 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,903  tflops: 368.59  mfu: 37.27%
[rank3]:2025-11-04 03:14:15,642 - INFO -  step: 2850  loss:  0.4368  grad_norm:  0.0105  memory: 84.22GiB(60.24%)  tps: 7,667  tflops: 357.57  mfu: 36.16%
[rank0]:2025-11-04 03:16:03,563 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:16:04,937 - INFO - Avg. fwd time: 15.1511 / Avg. bwd time: 7.0761 / Avg. batch time: 526.7433 (ms) / GPU bubble ratio: 66.24%
[rank3]:2025-11-04 03:16:05,165 - INFO - Avg. fwd time: 16.1275 / Avg. bwd time: 26.0568 / Avg. batch time: 353.1152 (ms) / GPU bubble ratio: 4.43%
[rank1]:2025-11-04 03:16:05,207 - INFO - Avg. fwd time: 17.1261 / Avg. bwd time: 22.2821 / Avg. batch time: 503.1825 (ms) / GPU bubble ratio: 37.35%
[rank2]:2025-11-04 03:16:05,177 - INFO - Avg. fwd time: 14.9676 / Avg. bwd time: 19.7498 / Avg. batch time: 462.5167 (ms) / GPU bubble ratio: 39.95%
[rank2]:2025-11-04 03:16:05,253 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,258  tflops: 338.50  mfu: 34.23%
[rank0]:2025-11-04 03:16:05,255 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,258  tflops: 338.50  mfu: 34.23%
[rank1]:2025-11-04 03:16:05,256 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,258  tflops: 338.50  mfu: 34.23%
[rank2]:2025-11-04 03:16:08,650 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0316_stage2_step2900.svg
[rank0]:2025-11-04 03:16:08,650 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0316_stage0_step2900.svg
[rank3]:2025-11-04 03:16:08,595 - INFO -  step: 2900  loss:  0.4171  grad_norm:  0.0184  memory: 84.22GiB(60.24%)  tps: 7,253  tflops: 338.27  mfu: 34.20%
[rank1]:2025-11-04 03:16:08,650 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0316_stage1_step2900.svg
[rank3]:2025-11-04 03:16:08,726 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0316_real_step2900_rank3.svg
[rank3]:> Batch Time: 437.50 ms, GPU Bubble Ratio: 71.72%, 34.71%, 42.53%, 22.49%
[rank3]:2025-11-04 03:16:08,770 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0316_stage3_step2900.svg
[rank0]:2025-11-04 03:17:50,618 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-04 03:17:51,980 - INFO - Avg. fwd time: 15.1580 / Avg. bwd time: 6.9502 / Avg. batch time: 526.2502 (ms) / GPU bubble ratio: 66.39%
[rank2]:2025-11-04 03:17:52,218 - INFO - Avg. fwd time: 14.9748 / Avg. bwd time: 19.6858 / Avg. batch time: 462.2406 (ms) / GPU bubble ratio: 40.01%
[rank3]:2025-11-04 03:17:52,206 - INFO - Avg. fwd time: 16.1360 / Avg. bwd time: 25.9893 / Avg. batch time: 352.6388 (ms) / GPU bubble ratio: 4.43%
[rank1]:2025-11-04 03:17:52,247 - INFO - Avg. fwd time: 17.1347 / Avg. bwd time: 22.2105 / Avg. batch time: 502.8247 (ms) / GPU bubble ratio: 37.40%
[rank1]:2025-11-04 03:17:52,292 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 7,653  tflops: 356.96  mfu: 36.09%
[rank0]:2025-11-04 03:17:52,292 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 7,653  tflops: 356.96  mfu: 36.09%
[rank2]:2025-11-04 03:17:52,290 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 7,653  tflops: 356.96  mfu: 36.09%
[rank3]:2025-11-04 03:17:54,496 - INFO -  step: 2950  loss:  0.4695  grad_norm:  0.0214  memory: 84.22GiB(60.24%)  tps: 7,736  tflops: 360.80  mfu: 36.48%
[rank0]:2025-11-04 03:19:28,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-04 03:19:30,345 - INFO - Avg. fwd time: 16.1459 / Avg. bwd time: 25.9118 / Avg. batch time: 352.0914 (ms) / GPU bubble ratio: 4.44%
[rank1]:2025-11-04 03:19:30,416 - INFO - Avg. fwd time: 17.1430 / Avg. bwd time: 22.1417 / Avg. batch time: 502.0044 (ms) / GPU bubble ratio: 37.40%
[rank0]:2025-11-04 03:19:30,438 - INFO - Avg. fwd time: 15.1644 / Avg. bwd time: 6.8286 / Avg. batch time: 525.3013 (ms) / GPU bubble ratio: 66.51%
[rank0]:2025-11-04 03:19:30,441 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 74.90GiB(53.57%)  tps: 8,347  tflops: 389.28  mfu: 39.36%
[rank0]:2025-11-04 03:19:30,441 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 7,469  tflops: 348.33  mfu: 34.76%
[rank0]:2025-11-04 03:19:30,441 - INFO - ðŸ”Ž  Running validation at step 3000
[rank2]:2025-11-04 03:19:30,378 - INFO - Avg. fwd time: 14.9820 / Avg. bwd time: 19.6245 / Avg. batch time: 461.4962 (ms) / GPU bubble ratio: 40.01%
[rank2]:2025-11-04 03:19:30,439 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 66.29GiB(47.41%)  tps: 8,346  tflops: 389.28  mfu: 39.36%
[rank2]:2025-11-04 03:19:30,439 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 7,472  tflops: 348.51  mfu: 34.78%
[rank2]:2025-11-04 03:19:30,440 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-04 03:19:30,439 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.0000  memory: 74.59GiB(53.35%)  tps: 8,347  tflops: 389.29  mfu: 39.36%
[rank1]:2025-11-04 03:19:30,439 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.0000  tps: 7,470  tflops: 348.41  mfu: 34.76%
[rank1]:2025-11-04 03:19:30,439 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-04 03:19:34,291 - INFO -  step: 3000  loss:  0.3850  grad_norm:  0.0416  memory: 84.22GiB(60.24%)  tps: 8,209  tflops: 382.87  mfu: 38.71%
[rank3]:2025-11-04 03:19:34,292 - INFO -  final step: 3000  loss:  0.3850  grad_norm:  0.0416  tps: 7,420  tflops: 346.07  mfu: 34.52%
[rank3]:2025-11-04 03:19:34,292 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-04 03:19:50,710 - INFO - validate step: 3000  loss: -1.0000  memory: 74.59GiB(53.35%)  tps: 20,207
[rank1]:2025-11-04 03:19:50,711 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-04 03:19:50,714 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 03:19:50,675 - INFO - validate step: 3000  loss: -1.0000  memory: 74.90GiB(53.57%)  tps: 20,244
[rank0]:2025-11-04 03:19:50,676 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-04 03:19:50,680 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-04 03:19:50,725 - INFO - validate step: 3000  loss: -1.0000  memory: 66.29GiB(47.41%)  tps: 20,193
[rank2]:2025-11-04 03:19:50,725 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-04 03:19:50,728 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-04 03:19:50,736 - INFO - validate step: 3000  loss:  0.2406  memory: 84.22GiB(60.24%)  tps: 24,909
[rank3]:2025-11-04 03:19:50,737 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-04 03:19:50,739 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank0]:2025-11-04 03:20:03,586 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank1]:2025-11-04 03:20:03,727 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank1/251104_0320_stage1_final3000.svg
[rank2]:2025-11-04 03:20:03,698 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank2/251104_0320_stage2_final3000.svg
[rank0]:2025-11-04 03:20:03,725 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank0/251104_0320_stage0_final3000.svg
[rank3]:2025-11-04 03:20:03,802 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0320_real_final3000_rank3.svg
[rank3]:> Batch Time: 411.25 ms, GPU Bubble Ratio: 70.05%, 30.48%, 38.77%, 25.10%
[rank2]:2025-11-04 03:20:03,917 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251104_0320_rank2_stage2.svg
[rank2]:	> Counts Sum: 1349160, Total Sum: 5829120 (23.15%), Ratio(%) per element: [23.02, 22.43, 23.86, 21.59, 22.52, 22.77, 23.61, 23.91, 24.3, 22.92, 23.27, 23.22, 23.61, 23.12, 22.77, 22.43, 22.33, 24.55, 23.81, 23.81, 23.02, 21.83, 22.43, 23.46, 23.22, 23.86, 23.81, 22.92, 23.27, 22.57, 22.77, 22.57, 24.45, 22.18, 23.91, 23.71, 22.57, 23.61, 22.72, 22.87, 21.78, 23.07, 23.96, 23.12, 24.3, 23.76, 24.2, 22.18, 23.36, 23.41, 22.18, 23.22, 23.56, 24.06, 22.62, 23.61, 23.46, 22.23, 22.67, 22.18, 21.54, 24.7, 24.01, 23.27, 22.92, 22.97, 23.22, 22.33, 22.23, 22.18, 24.55, 23.66]
[rank2]:2025-11-04 03:20:03,917 - INFO - Destroying the purge thread.
[rank3]:2025-11-04 03:20:03,958 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/pipeline_schedule/251104_0320_thry_final3000_rank3.svg
[rank3]:> Batch Time: 532.54 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank1]:2025-11-04 03:20:04,032 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251104_0320_rank1_stage1.svg
[rank1]:	> Counts Sum: 797280, Total Sum: 6557760 (12.16%), Ratio(%) per element: [12.69, 11.85, 12.64, 11.8, 11.66, 12.4, 12.5, 12.69, 12.89, 12.25, 11.66, 12.25, 11.66, 11.66, 12.54, 11.9, 12.79, 12.89, 12.5, 11.26, 11.7, 11.56, 12.2, 10.96, 11.8, 12.89, 12.84, 11.06, 11.51, 12.54, 11.61, 11.9, 12.0, 12.45, 13.43, 12.99, 12.0, 12.4, 11.85, 11.51, 11.85, 12.15, 10.96, 13.14, 12.99, 12.15, 12.15, 12.1, 12.35, 12.25, 11.61, 12.4, 12.69, 12.54, 11.16, 11.95, 11.9, 12.25, 11.56, 12.15, 12.1, 13.29, 12.2, 11.61, 12.79, 12.99, 11.66, 11.85, 11.16, 11.41, 13.14, 12.74, 11.66, 11.75, 12.64, 11.61, 12.15, 11.61, 11.75, 13.29, 13.04]
[rank1]:2025-11-04 03:20:04,033 - INFO - Destroying the purge thread.
[rank0]:2025-11-04 03:20:03,991 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251104_0320_rank0_stage0.svg
[rank0]:	> Counts Sum: 2915680, Total Sum: 5910080 (49.33%), Ratio(%) per element: [49.25, 48.81, 48.96, 49.4, 48.86, 49.11, 49.25, 49.01, 49.5, 49.7, 49.4, 49.25, 49.3, 49.55, 49.45, 49.01, 48.17, 49.9, 49.3, 49.3, 49.11, 49.25, 49.55, 49.55, 49.2, 48.96, 49.95, 49.9, 49.4, 48.86, 49.45, 49.06, 49.4, 49.2, 49.4, 49.8, 50.29, 49.3, 49.35, 49.2, 49.45, 49.2, 49.16, 49.6, 49.7, 49.85, 49.2, 48.66, 49.3, 48.86, 49.5, 49.55, 49.01, 49.35, 50.04, 48.61, 49.5, 49.3, 49.7, 49.45, 49.3, 49.4, 49.45, 49.65, 49.4, 49.4, 48.96, 48.81, 49.3, 48.96, 49.06, 49.65, 50.0]
[rank0]:2025-11-04 03:20:03,991 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-04 03:20:04,018 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/freeze_ratio_history/rank3/251104_0320_stage3_final3000.svg
[rank3]:2025-11-04 03:20:04,297 - INFO - Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200/frozen_params_histogram/251104_0320_rank3_stage3.svg
[rank3]:	> Counts Sum: 606760, Total Sum: 5262400 (11.53%), Ratio(%) per element: [10.52, 10.37, 10.91, 10.82, 10.22, 11.11, 11.01, 14.77, 13.48, 11.36, 11.31, 10.96, 10.96, 11.01, 10.77, 10.67, 13.73, 13.43, 11.41, 11.11, 10.72, 9.83, 10.57, 11.16, 10.52, 14.22, 14.77, 10.07, 10.82, 10.86, 9.98, 10.86, 10.62, 11.41, 13.83, 13.53, 10.82, 11.16, 9.63, 11.06, 11.61, 11.06, 10.62, 13.38, 14.77, 11.26, 10.72, 10.62, 11.41, 10.77, 10.07, 10.57, 13.88, 12.99, 10.82, 10.86, 10.86, 10.67, 10.91, 11.11, 10.86, 13.43, 13.78, 14.03, 11.7]
[rank3]:2025-11-04 03:20:04,297 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading history steps 60-60, summary, console lines 435-442
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.20808
[rank3]:wandb:               final/avg_loss 0.38503
[rank3]:wandb:             final/avg_mfu(%) 34.51714
[rank3]:wandb:             final/avg_tflops 346.07094
[rank3]:wandb:    final/avg_throughput(tps) 7420.02039
[rank3]:wandb:              final/grad_norm 0.04157
[rank3]:wandb:               final/max_loss 0.38503
[rank3]:wandb:                    grad_norm 0.04157
[rank3]:wandb: loss_metrics/global_avg_loss 0.38503
[rank3]:wandb: loss_metrics/global_max_loss 0.38503
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_GPipe_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/2k4mxpnf
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_GPipe_timelyapf_h200/20251104-0123/wandb/run-20251104_012329-2k4mxpnf/logs
[rank0]:2025-11-04 03:20:05,991 - INFO - Training completed
[rank0]:2025-11-04 03:20:05,992 - INFO - Destroying the purge thread.
[rank1]:2025-11-04 03:20:06,807 - INFO - Process group destroyed
[rank3]:2025-11-04 03:20:06,855 - INFO - Process group destroyed
[rank2]:2025-11-04 03:20:07,233 - INFO - Process group destroyed
[rank0]:2025-11-04 03:20:07,256 - INFO - Process group destroyed
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.3', 'layers.2', 'layers.4', 'tok_embeddings', 'layers.0', 'layers.6', 'layers.7', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.11', 'layers.16', 'layers.14', 'layers.15', 'layers.9', 'layers.8', 'layers.12', 'layers.13', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'output', 'layers.30', 'layers.28', 'layers.31', 'layers.29', 'layers.26', 'layers.25', 'norm'}
[rank2]:Stage 2: Modules to keep: {'layers.23', 'layers.17', 'layers.24', 'layers.18', 'layers.21', 'layers.20', 'layers.22', 'layers.19'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_GPipe_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_GPipe_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_GPipe_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_GPipe_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_GPipe_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_GPipe_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_GPipe_timelyapf_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_GPipe_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
