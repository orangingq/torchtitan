
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Thu Oct 30 17:24:52 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 0,1,2,3
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1030_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1030 17:24:53.480000 3262505 site-packages/torch/distributed/run.py:811] 
W1030 17:24:53.480000 3262505 site-packages/torch/distributed/run.py:811] *****************************************
W1030 17:24:53.480000 3262505 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1030 17:24:53.480000 3262505 site-packages/torch/distributed/run.py:811] *****************************************
[rank2]:2025-10-30 17:25:00,620 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-10-30 17:25:00,791 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-10-30 17:25:00,843 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-10-30 17:25:00,970 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-10-30 17:25:01,205 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-10-30 17:25:01,208 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 17:25:01,609 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-10-30 17:25:01,611 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 17:25:01,615 - INFO - [GC] Initial GC collection 0.00 seconds
[rank3]:2025-10-30 17:25:01,660 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-10-30 17:25:01,662 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-10-30 17:25:01,705 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-10-30 17:25:01,708 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-10-30 17:25:03,365 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-10-30 17:25:03,668 - INFO - Preparing medical dataset from FreedomIntelligence/medical-o1-reasoning-SFT
[rank0]:2025-10-30 17:25:05,201 - INFO - Preparing alpaca dataset from tatsu-lab/alpaca
[rank0]:2025-10-30 17:25:06,638 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-10-30 17:25:06,800 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-30 17:25:06,891 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-30 17:25:06,942 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2025-10-30 17:25:06,872 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2025-10-30 17:25:06,872 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2025-10-30 17:25:06,923 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2025-10-30 17:25:06,965 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2025-10-30 17:25:06,965 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-10-30 17:25:06,997 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2025-10-30 17:25:06,998 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2025-10-30 17:25:07,074 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-10-30 17:25:07,074 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-10-30 17:25:07,262 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-10-30 17:25:07,262 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2025-10-30 17:25:07,263 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-10-30 17:25:07,263 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run sc6btyeu
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_GPipe_auto_dm1/20251030-1725/wandb/run-20251030_172507-sc6btyeu
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1030_GPipe_auto_dm1
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/sc6btyeu
[rank3]:2025-10-30 17:25:08,652 - INFO - WandB logging enabled
[rank3]:2025-10-30 17:25:08,654 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-10-30 17:25:08,729 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-10-30 17:25:08,729 - INFO - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2025-10-30 17:25:08,945 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-10-30 17:25:08,945 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-10-30 17:25:08,957 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-10-30 17:25:08,973 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 17:25:08,973 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_GPipe_auto_dm1
[rank0]:2025-10-30 17:25:08,974 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 17:25:08,974 - INFO - Preparing c4_validation dataset from allenai/c4
[rank1]:2025-10-30 17:25:08,974 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-10-30 17:25:12,441 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2400 (warmup 300)
[rank0]:2025-10-30 17:25:12,441 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-10-30 17:25:21,809 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-10-30 17:25:21,810 - INFO - Finished loading the checkpoint in 9.37 seconds.
[rank0]:2025-10-30 17:25:21,810 - INFO - Training starts at step 1
[rank3]:2025-10-30 17:25:26,241 - INFO -  step:  1  loss: 18.0191  grad_norm: 231.2583  memory: 58.03GiB(41.50%)  tps: 934  tflops: 43.57  mfu: 4.41%
[rank3]:2025-10-30 17:25:26,241 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-10-30 17:25:26,237 - INFO -  step:  1  loss: -4.0000  grad_norm: 231.2583  memory: 44.28GiB(31.67%)  tps: 845  tflops: 39.41  mfu: 3.98%
[rank2]:2025-10-30 17:25:26,237 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-10-30 17:25:26,258 - INFO -  step:  1  loss: -4.0000  grad_norm: 231.2583  memory: 49.75GiB(35.58%)  tps: 848  tflops: 39.56  mfu: 4.00%
[rank0]:2025-10-30 17:25:26,258 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2025-10-30 17:25:26,238 - INFO -  step:  1  loss: -4.0000  grad_norm: 231.2583  memory: 49.69GiB(35.54%)  tps: 850  tflops: 39.67  mfu: 4.01%
[rank1]:2025-10-30 17:25:26,239 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-10-30 17:25:43,958 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,959 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,959 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,960 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,960 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,960 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,961 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,961 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,961 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,962 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank3]:2025-10-30 17:25:43,963 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,001 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,002 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,002 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,002 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,002 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,002 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,003 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,004 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,004 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,004 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank2]:2025-10-30 17:25:44,004 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,047 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,048 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,048 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,048 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,048 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,048 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank1]:2025-10-30 17:25:44,049 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,089 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,090 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,091 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:25:44,092 - WARNING - Batch index 1 is larger than log time length 0. Filling with zeros.
[rank0]:2025-10-30 17:27:32,472 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 17:27:35,113 - INFO -  step: 50  loss:  9.0178  grad_norm: 538.6506  memory: 73.38GiB(52.48%)  tps: 6,230  tflops: 290.55  mfu: 29.38%
[rank0]:2025-10-30 17:27:35,115 - INFO -  step: 50  loss: -4.0000  grad_norm: 538.6506  memory: 66.72GiB(47.72%)  tps: 6,230  tflops: 290.58  mfu: 29.38%
[rank2]:2025-10-30 17:27:35,108 - INFO -  step: 50  loss: -4.0000  grad_norm: 538.6506  memory: 57.29GiB(40.97%)  tps: 6,230  tflops: 290.55  mfu: 29.38%
[rank1]:2025-10-30 17:27:35,111 - INFO -  step: 50  loss: -4.0000  grad_norm: 538.6506  memory: 64.32GiB(46.00%)  tps: 6,230  tflops: 290.55  mfu: 29.38%
[rank3]:2025-10-30 17:27:35,551 - INFO - Avg. fwd time: 14.2092 / Avg. bwd time: 42.3822 / Avg. batch time: 472.7854 (ms) / GPU bubble ratio: 4.24%
[rank2]:2025-10-30 17:27:35,600 - INFO - Avg. fwd time: 12.9031 / Avg. bwd time: 36.1091 / Avg. batch time: 525.3215 (ms) / GPU bubble ratio: 25.36%
[rank1]:2025-10-30 17:27:35,647 - INFO - Avg. fwd time: 14.5838 / Avg. bwd time: 40.5500 / Avg. batch time: 584.2650 (ms) / GPU bubble ratio: 24.51%
[rank0]:2025-10-30 17:27:35,680 - INFO - Avg. fwd time: 13.5858 / Avg. bwd time: 37.9193 / Avg. batch time: 639.1886 (ms) / GPU bubble ratio: 35.54%
[rank0]:2025-10-30 17:29:43,687 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:29:46,307 - INFO -  step: 100  loss: -4.0000  grad_norm: 440.3843  memory: 64.32GiB(46.00%)  tps: 6,244  tflops: 291.23  mfu: 29.45%
[rank1]:2025-10-30 17:29:46,308 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-30 17:29:46,305 - INFO -  step: 100  loss: -4.0000  grad_norm: 440.3843  memory: 57.29GiB(40.97%)  tps: 6,244  tflops: 291.23  mfu: 29.45%
[rank2]:2025-10-30 17:29:46,305 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 17:29:46,310 - INFO -  step: 100  loss:  4.6475  grad_norm: 440.3843  memory: 73.38GiB(52.48%)  tps: 6,244  tflops: 291.23  mfu: 29.45%
[rank3]:2025-10-30 17:29:46,310 - WARNING - Nothing to draw before the end of warmup.
[rank0]:2025-10-30 17:29:46,312 - INFO -  step: 100  loss: -4.0000  grad_norm: 440.3843  memory: 66.72GiB(47.72%)  tps: 6,244  tflops: 291.22  mfu: 29.45%
[rank0]:2025-10-30 17:29:46,312 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 17:29:46,750 - INFO - Avg. fwd time: 14.1904 / Avg. bwd time: 42.5662 / Avg. batch time: 471.5158 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-30 17:29:46,800 - INFO - Avg. fwd time: 12.8833 / Avg. bwd time: 36.1875 / Avg. batch time: 523.8138 (ms) / GPU bubble ratio: 25.06%
[rank1]:2025-10-30 17:29:46,846 - INFO - Avg. fwd time: 14.6435 / Avg. bwd time: 40.7871 / Avg. batch time: 582.7704 (ms) / GPU bubble ratio: 23.91%
[rank0]:2025-10-30 17:29:46,879 - INFO - Avg. fwd time: 13.4509 / Avg. bwd time: 38.0237 / Avg. batch time: 637.6082 (ms) / GPU bubble ratio: 35.42%
[rank0]:2025-10-30 17:31:54,859 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:31:57,508 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.2614  memory: 64.32GiB(46.00%)  tps: 6,244  tflops: 291.22  mfu: 29.45%
[rank3]:2025-10-30 17:31:57,511 - INFO -  step: 150  loss:  2.4262  grad_norm:  5.2614  memory: 73.38GiB(52.48%)  tps: 6,244  tflops: 291.22  mfu: 29.45%
[rank2]:2025-10-30 17:31:57,506 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.2614  memory: 57.29GiB(40.97%)  tps: 6,244  tflops: 291.22  mfu: 29.45%
[rank0]:2025-10-30 17:31:57,512 - INFO -  step: 150  loss: -4.0000  grad_norm:  5.2614  memory: 66.72GiB(47.72%)  tps: 6,244  tflops: 291.22  mfu: 29.45%
[rank3]:2025-10-30 17:31:58,039 - INFO - Avg. fwd time: 14.1617 / Avg. bwd time: 42.6224 / Avg. batch time: 470.9530 (ms) / GPU bubble ratio: 3.54%
[rank1]:2025-10-30 17:31:58,126 - INFO - Avg. fwd time: 14.6692 / Avg. bwd time: 40.8905 / Avg. batch time: 582.1866 (ms) / GPU bubble ratio: 23.65%
[rank2]:2025-10-30 17:31:58,080 - INFO - Avg. fwd time: 12.8628 / Avg. bwd time: 36.2072 / Avg. batch time: 523.1804 (ms) / GPU bubble ratio: 24.97%
[rank0]:2025-10-30 17:31:58,168 - INFO - Avg. fwd time: 13.4077 / Avg. bwd time: 38.0556 / Avg. batch time: 636.9968 (ms) / GPU bubble ratio: 35.37%
[rank0]:2025-10-30 17:34:06,513 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:34:09,149 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.4186  memory: 64.32GiB(46.00%)  tps: 6,223  tflops: 290.24  mfu: 29.35%
[rank1]:2025-10-30 17:34:09,149 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-10-30 17:34:09,147 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.4186  memory: 57.29GiB(40.97%)  tps: 6,223  tflops: 290.24  mfu: 29.35%
[rank2]:2025-10-30 17:34:09,147 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-10-30 17:34:09,151 - INFO -  step: 200  loss:  2.7555  grad_norm:  3.4186  memory: 73.38GiB(52.48%)  tps: 6,223  tflops: 290.25  mfu: 29.35%
[rank3]:2025-10-30 17:34:09,152 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 17:34:09,153 - INFO -  step: 200  loss: -4.0000  grad_norm:  3.4186  memory: 66.72GiB(47.72%)  tps: 6,223  tflops: 290.24  mfu: 29.35%
[rank0]:2025-10-30 17:34:09,153 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-10-30 17:34:25,692 - INFO - validate step: 200  loss: -1.0000  memory: 66.72GiB(47.72%)  tps: 24,767
[rank0]:2025-10-30 17:34:25,692 - WARNING - Nothing to draw before the end of warmup.
[rank1]:2025-10-30 17:34:25,721 - INFO - validate step: 200  loss: -1.0000  memory: 64.32GiB(46.00%)  tps: 24,717
[rank1]:2025-10-30 17:34:25,722 - WARNING - Nothing to draw before the end of warmup.
[rank2]:2025-10-30 17:34:25,734 - INFO - validate step: 200  loss: -1.0000  memory: 57.29GiB(40.97%)  tps: 24,695
[rank2]:2025-10-30 17:34:25,734 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 17:34:25,752 - INFO - validate step: 200  loss:  0.8206  memory: 73.38GiB(52.48%)  tps: 24,675
[rank3]:2025-10-30 17:34:25,754 - WARNING - Nothing to draw before the end of warmup.
[rank3]:2025-10-30 17:34:26,158 - INFO - Avg. fwd time: 14.1787 / Avg. bwd time: 42.6698 / Avg. batch time: 471.1400 (ms) / GPU bubble ratio: 3.47%
[rank1]:2025-10-30 17:34:26,255 - INFO - Avg. fwd time: 14.7044 / Avg. bwd time: 40.9619 / Avg. batch time: 582.4540 (ms) / GPU bubble ratio: 23.54%
[rank2]:2025-10-30 17:34:26,208 - INFO - Avg. fwd time: 12.8815 / Avg. bwd time: 36.2364 / Avg. batch time: 523.3773 (ms) / GPU bubble ratio: 24.92%
[rank0]:2025-10-30 17:34:26,288 - INFO - Avg. fwd time: 13.4072 / Avg. bwd time: 38.0889 / Avg. batch time: 637.2835 (ms) / GPU bubble ratio: 35.36%
[rank0]:2025-10-30 17:36:34,669 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:36:37,302 - INFO -  step: 250  loss: -4.0000  grad_norm: 11.9228  memory: 64.32GiB(46.00%)  tps: 6,226  tflops: 290.38  mfu: 29.36%
[rank2]:2025-10-30 17:36:37,299 - INFO -  step: 250  loss: -4.0000  grad_norm: 11.9228  memory: 57.29GiB(40.97%)  tps: 6,227  tflops: 290.41  mfu: 29.36%
[rank3]:2025-10-30 17:36:37,304 - INFO -  step: 250  loss:  2.0539  grad_norm: 11.9228  memory: 73.38GiB(52.48%)  tps: 6,227  tflops: 290.44  mfu: 29.37%
[rank0]:2025-10-30 17:36:37,306 - INFO -  step: 250  loss: -4.0000  grad_norm: 11.9228  memory: 66.72GiB(47.72%)  tps: 6,224  tflops: 290.30  mfu: 29.35%
[rank2]:2025-10-30 17:36:37,795 - INFO - Avg. fwd time: 12.8881 / Avg. bwd time: 36.2347 / Avg. batch time: 523.3127 (ms) / GPU bubble ratio: 24.90%
[rank3]:2025-10-30 17:36:37,744 - INFO - Avg. fwd time: 14.1824 / Avg. bwd time: 42.6896 / Avg. batch time: 471.0930 (ms) / GPU bubble ratio: 3.42%
[rank1]:2025-10-30 17:36:37,841 - INFO - Avg. fwd time: 14.7332 / Avg. bwd time: 41.0027 / Avg. batch time: 582.4223 (ms) / GPU bubble ratio: 23.44%
[rank0]:2025-10-30 17:36:37,873 - INFO - Avg. fwd time: 13.4106 / Avg. bwd time: 38.1037 / Avg. batch time: 637.2713 (ms) / GPU bubble ratio: 35.33%
[rank1]:2025-10-30 17:37:03,646 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-30 17:37:03,643 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2025-10-30 17:37:03,646 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2025-10-30 17:37:03,650 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank2]:2025-10-30 17:37:29,933 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 1.9414e+01
[rank3]:2025-10-30 17:37:29,937 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4000e+01
[rank0]:2025-10-30 17:37:29,940 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.6705e+01
[rank1]:2025-10-30 17:37:29,937 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.4864e+01
[rank1]:2025-10-30 17:37:55,539 - INFO - Freezing Ratio: [Stage1] 0.11, Threshold: 6.9290e+00
[rank0]:2025-10-30 17:37:55,530 - INFO - Freezing Ratio: [Stage0] 0.00, Threshold: 7.0538e+00
[rank2]:2025-10-30 17:37:55,532 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 5.6875e+00
[rank3]:2025-10-30 17:37:55,538 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 3.4192e+00
[rank1]:2025-10-30 17:38:21,899 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.3284e+00
[rank0]:2025-10-30 17:38:21,906 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 8.5976e-01
[rank2]:2025-10-30 17:38:21,898 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 2.0163e+00
[rank3]:2025-10-30 17:38:21,902 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 1.1324e+00
[rank0]:2025-10-30 17:38:44,490 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 17:38:47,036 - INFO - Freezing Ratio: [Stage2] 0.00, Threshold: 3.5580e+00
[rank2]:2025-10-30 17:38:47,036 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.9266  memory: 58.24GiB(41.66%)  tps: 6,314  tflops: 294.50  mfu: 29.78%
[rank3]:2025-10-30 17:38:47,039 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 4.5928e+00
[rank3]:2025-10-30 17:38:47,042 - INFO -  step: 300  loss:  3.1395  grad_norm:  3.9266  memory: 74.24GiB(53.10%)  tps: 6,314  tflops: 294.50  mfu: 29.78%
[rank0]:2025-10-30 17:38:47,033 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.2224e+01
[rank0]:2025-10-30 17:38:47,034 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.9266  memory: 70.53GiB(50.44%)  tps: 6,315  tflops: 294.52  mfu: 29.78%
[rank1]:2025-10-30 17:38:47,043 - INFO - Freezing Ratio: [Stage1] 0.11, Threshold: 4.8034e+00
[rank1]:2025-10-30 17:38:47,043 - INFO -  step: 300  loss: -4.0000  grad_norm:  3.9266  memory: 65.28GiB(46.69%)  tps: 6,314  tflops: 294.49  mfu: 29.78%
[rank2]:2025-10-30 17:38:47,125 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1738_stage2_step300.svg
[rank0]:2025-10-30 17:38:47,124 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1738_stage0_step300.svg
[rank1]:2025-10-30 17:38:47,127 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1738_stage1_step300.svg
[rank3]:2025-10-30 17:38:47,244 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1738_real_step300_rank3.svg
[rank3]:> Batch Time: 620.38 ms, GPU Bubble Ratio: 33.38%, 27.84%, 36.44%, 26.48%
[rank3]:2025-10-30 17:38:47,317 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1738_stage3_step300.svg
[rank3]:2025-10-30 17:38:47,801 - INFO - Avg. fwd time: 14.1827 / Avg. bwd time: 42.6158 / Avg. batch time: 470.4255 (ms) / GPU bubble ratio: 3.41%
[rank2]:2025-10-30 17:38:47,842 - INFO - Avg. fwd time: 12.9013 / Avg. bwd time: 36.0718 / Avg. batch time: 522.5772 (ms) / GPU bubble ratio: 25.03%
[rank1]:2025-10-30 17:38:47,886 - INFO - Avg. fwd time: 14.7619 / Avg. bwd time: 40.9424 / Avg. batch time: 581.9443 (ms) / GPU bubble ratio: 23.42%
[rank0]:2025-10-30 17:38:47,919 - INFO - Avg. fwd time: 13.4800 / Avg. bwd time: 37.4281 / Avg. batch time: 636.0817 (ms) / GPU bubble ratio: 35.97%
[rank2]:2025-10-30 17:39:12,757 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 3.7751e+00
[rank0]:2025-10-30 17:39:12,752 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.8348e+00
[rank3]:2025-10-30 17:39:12,761 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 6.5611e+00
[rank1]:2025-10-30 17:39:12,758 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 3.4658e+00
[rank0]:2025-10-30 17:39:37,963 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 1.8364e+01
[rank2]:2025-10-30 17:39:37,965 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 1.3024e+01
[rank3]:2025-10-30 17:39:37,969 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 8.7699e+00
[rank1]:2025-10-30 17:39:37,972 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.9365e+01
[rank0]:2025-10-30 17:40:03,037 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 2.7876e+00
[rank2]:2025-10-30 17:40:03,040 - INFO - Freezing Ratio: [Stage2] 0.25, Threshold: 3.4898e+00
[rank3]:2025-10-30 17:40:03,047 - INFO - Freezing Ratio: [Stage3] 0.14, Threshold: 2.8923e+00
[rank1]:2025-10-30 17:40:03,037 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.6978e+00
[rank0]:2025-10-30 17:40:28,095 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8838e+00
[rank2]:2025-10-30 17:40:28,094 - INFO - Freezing Ratio: [Stage2] 0.12, Threshold: 3.3646e+00
[rank3]:2025-10-30 17:40:28,101 - INFO - Freezing Ratio: [Stage3] 0.00, Threshold: 2.2263e+00
[rank1]:2025-10-30 17:40:28,104 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 3.4975e+00
[rank0]:2025-10-30 17:40:50,488 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:40:53,015 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 1.9538e+00
[rank1]:2025-10-30 17:40:53,015 - INFO -  step: 350  loss: -4.0000  grad_norm: 14.2179  memory: 67.21GiB(48.07%)  tps: 6,503  tflops: 303.30  mfu: 30.67%
[rank0]:2025-10-30 17:40:53,009 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 4.1032e+00
[rank0]:2025-10-30 17:40:53,010 - INFO -  step: 350  loss: -4.0000  grad_norm: 14.2179  memory: 72.50GiB(51.86%)  tps: 6,503  tflops: 303.29  mfu: 30.67%
[rank2]:2025-10-30 17:40:53,018 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 1.3017e+00
[rank2]:2025-10-30 17:40:53,018 - INFO -  step: 350  loss: -4.0000  grad_norm: 14.2179  memory: 59.22GiB(42.36%)  tps: 6,503  tflops: 303.28  mfu: 30.67%
[rank3]:2025-10-30 17:40:53,025 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.8312e+00
[rank3]:2025-10-30 17:40:53,027 - INFO -  step: 350  loss:  2.5262  grad_norm: 14.2179  memory: 74.24GiB(53.10%)  tps: 6,502  tflops: 303.27  mfu: 30.66%
[rank2]:2025-10-30 17:40:53,450 - INFO - Avg. fwd time: 12.9300 / Avg. bwd time: 35.7607 / Avg. batch time: 520.9185 (ms) / GPU bubble ratio: 25.22%
[rank3]:2025-10-30 17:40:53,415 - INFO - Avg. fwd time: 14.1854 / Avg. bwd time: 42.4627 / Avg. batch time: 469.1146 (ms) / GPU bubble ratio: 3.40%
[rank0]:2025-10-30 17:40:53,532 - INFO - Avg. fwd time: 13.6107 / Avg. bwd time: 36.1074 / Avg. batch time: 633.0880 (ms) / GPU bubble ratio: 37.17%
[rank1]:2025-10-30 17:40:53,530 - INFO - Avg. fwd time: 14.8008 / Avg. bwd time: 40.5246 / Avg. batch time: 580.3251 (ms) / GPU bubble ratio: 23.73%
[rank0]:2025-10-30 17:41:17,903 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.3542e+00
[rank2]:2025-10-30 17:41:17,901 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.0791e+01
[rank3]:2025-10-30 17:41:17,906 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.8467e+01
[rank1]:2025-10-30 17:41:17,912 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.4652e+01
[rank0]:2025-10-30 17:41:41,176 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 7.8421e+00
[rank2]:2025-10-30 17:41:41,179 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 6.2212e+00
[rank3]:2025-10-30 17:41:41,185 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.1450e+00
[rank1]:2025-10-30 17:41:41,182 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1644e+00
[rank0]:2025-10-30 17:42:05,984 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 3.9730e+01
[rank2]:2025-10-30 17:42:05,981 - INFO - Freezing Ratio: [Stage2] 0.38, Threshold: 2.8112e+01
[rank3]:2025-10-30 17:42:05,987 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.2736e+01
[rank1]:2025-10-30 17:42:05,994 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 4.3637e+01
[rank1]:2025-10-30 17:42:29,107 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 6.1505e+00
[rank0]:2025-10-30 17:42:29,101 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.8003e+00
[rank2]:2025-10-30 17:42:29,103 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 5.5391e+00
[rank3]:2025-10-30 17:42:29,110 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.3313e+00
[rank0]:2025-10-30 17:42:51,371 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 17:42:53,866 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 9.7821e+00
[rank0]:2025-10-30 17:42:53,867 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.9193  memory: 72.50GiB(51.86%)  tps: 6,778  tflops: 316.14  mfu: 31.97%
[rank0]:2025-10-30 17:42:53,867 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-10-30 17:42:53,869 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 7.6970e+00
[rank3]:2025-10-30 17:42:53,872 - INFO -  step: 400  loss:  2.4874  grad_norm:  0.9193  memory: 75.33GiB(53.88%)  tps: 6,779  tflops: 316.18  mfu: 31.97%
[rank3]:2025-10-30 17:42:53,873 - INFO - ðŸ”Ž  Running validation at step 400
[rank2]:2025-10-30 17:42:53,860 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 1.9183e+01
[rank2]:2025-10-30 17:42:53,860 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.9193  memory: 61.15GiB(43.74%)  tps: 6,779  tflops: 316.18  mfu: 31.97%
[rank2]:2025-10-30 17:42:53,860 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-30 17:42:53,875 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 1.4535e+01
[rank1]:2025-10-30 17:42:53,876 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.9193  memory: 67.21GiB(48.07%)  tps: 6,778  tflops: 316.13  mfu: 31.96%
[rank1]:2025-10-30 17:42:53,876 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-10-30 17:43:09,134 - INFO - validate step: 400  loss: -1.0000  memory: 67.21GiB(48.07%)  tps: 26,845
[rank0]:2025-10-30 17:43:09,101 - INFO - validate step: 400  loss: -1.0000  memory: 72.50GiB(51.86%)  tps: 26,888
[rank3]:2025-10-30 17:43:09,160 - INFO - validate step: 400  loss:  0.9217  memory: 75.33GiB(53.88%)  tps: 26,795
[rank2]:2025-10-30 17:43:09,147 - INFO - validate step: 400  loss: -1.0000  memory: 61.15GiB(43.74%)  tps: 26,796
[rank1]:2025-10-30 17:43:09,243 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1743_stage1_step400.svg
[rank0]:2025-10-30 17:43:09,243 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1743_stage0_step400.svg
[rank2]:2025-10-30 17:43:09,240 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1743_stage2_step400.svg
[rank3]:2025-10-30 17:43:09,351 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1743_real_step400_rank3.svg
[rank3]:> Batch Time: 619.33 ms, GPU Bubble Ratio: 33.27%, 27.76%, 36.40%, 26.45%
[rank3]:2025-10-30 17:43:09,422 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1743_stage3_step400.svg
[rank3]:2025-10-30 17:43:09,779 - INFO - Avg. fwd time: 14.2346 / Avg. bwd time: 41.8532 / Avg. batch time: 464.5340 (ms) / GPU bubble ratio: 3.41%
[rank0]:2025-10-30 17:43:09,856 - INFO - Avg. fwd time: 13.7485 / Avg. bwd time: 34.7076 / Avg. batch time: 627.3711 (ms) / GPU bubble ratio: 38.21%
[rank2]:2025-10-30 17:43:09,803 - INFO - Avg. fwd time: 13.0323 / Avg. bwd time: 34.8294 / Avg. batch time: 515.3634 (ms) / GPU bubble ratio: 25.70%
[rank1]:2025-10-30 17:43:09,856 - INFO - Avg. fwd time: 14.8361 / Avg. bwd time: 40.0970 / Avg. batch time: 576.0607 (ms) / GPU bubble ratio: 23.71%
[rank2]:2025-10-30 17:43:32,289 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 7.9504e-01
[rank3]:2025-10-30 17:43:32,302 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.4037e+00
[rank0]:2025-10-30 17:43:32,293 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 3.0896e+00
[rank1]:2025-10-30 17:43:32,299 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 2.3631e+00
[rank2]:2025-10-30 17:43:57,186 - INFO - Freezing Ratio: [Stage2] 0.62, Threshold: 4.8193e+00
[rank3]:2025-10-30 17:43:57,196 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.4206e+00
[rank0]:2025-10-30 17:43:57,193 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6385e+00
[rank1]:2025-10-30 17:43:57,202 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 4.5330e+00
[rank2]:2025-10-30 17:44:20,244 - INFO - Freezing Ratio: [Stage2] 0.50, Threshold: 6.5625e+00
[rank0]:2025-10-30 17:44:20,248 - INFO - Freezing Ratio: [Stage0] 0.49, Threshold: 6.6296e+00
[rank1]:2025-10-30 17:44:20,254 - INFO - Freezing Ratio: [Stage1] 0.00, Threshold: 7.1414e+00
[rank3]:2025-10-30 17:44:20,257 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.1377e+00
[rank1]:2025-10-30 17:44:45,110 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 2.5350e+00
[rank3]:2025-10-30 17:44:45,104 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.2362e+00
[rank2]:2025-10-30 17:44:45,094 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5417e+00
[rank0]:2025-10-30 17:44:45,101 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3322e+00
[rank0]:2025-10-30 17:45:05,839 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:45:08,143 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.6635e+01
[rank1]:2025-10-30 17:45:08,143 - INFO -  step: 450  loss: -4.0000  grad_norm:  1.9737  memory: 67.21GiB(48.07%)  tps: 6,884  tflops: 321.05  mfu: 32.46%
[rank3]:2025-10-30 17:45:08,146 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.6762e+01
[rank3]:2025-10-30 17:45:08,150 - INFO -  step: 450  loss:  2.1706  grad_norm:  1.9737  memory: 75.33GiB(53.88%)  tps: 6,885  tflops: 321.10  mfu: 32.47%
[rank2]:2025-10-30 17:45:08,130 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.5352e+01
[rank2]:2025-10-30 17:45:08,130 - INFO -  step: 450  loss: -4.0000  grad_norm:  1.9737  memory: 63.09GiB(45.12%)  tps: 6,885  tflops: 321.12  mfu: 32.47%
[rank0]:2025-10-30 17:45:08,137 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8804e+01
[rank0]:2025-10-30 17:45:08,138 - INFO -  step: 450  loss: -4.0000  grad_norm:  1.9737  memory: 72.50GiB(51.86%)  tps: 6,882  tflops: 320.97  mfu: 32.45%
[rank3]:2025-10-30 17:45:08,624 - INFO - Avg. fwd time: 14.2882 / Avg. bwd time: 41.3591 / Avg. batch time: 460.9378 (ms) / GPU bubble ratio: 3.42%
[rank2]:2025-10-30 17:45:08,651 - INFO - Avg. fwd time: 13.1742 / Avg. bwd time: 33.5764 / Avg. batch time: 510.5496 (ms) / GPU bubble ratio: 26.74%
[rank1]:2025-10-30 17:45:08,681 - INFO - Avg. fwd time: 14.8883 / Avg. bwd time: 39.6925 / Avg. batch time: 571.8495 (ms) / GPU bubble ratio: 23.64%
[rank0]:2025-10-30 17:45:08,707 - INFO - Avg. fwd time: 13.8614 / Avg. bwd time: 33.5735 / Avg. batch time: 621.9746 (ms) / GPU bubble ratio: 38.99%
[rank3]:2025-10-30 17:45:30,603 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.6676e+00
[rank2]:2025-10-30 17:45:30,587 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.8751e+00
[rank0]:2025-10-30 17:45:30,591 - INFO - Freezing Ratio: [Stage0] 0.74, Threshold: 7.4679e+00
[rank1]:2025-10-30 17:45:30,590 - INFO - Freezing Ratio: [Stage1] 0.33, Threshold: 6.8999e+00
[rank1]:2025-10-30 17:45:53,466 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 2.0157e+00
[rank2]:2025-10-30 17:45:53,450 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.9113e+00
[rank3]:2025-10-30 17:45:53,469 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.2692e+00
[rank0]:2025-10-30 17:45:53,460 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1106e+00
[rank1]:2025-10-30 17:46:15,987 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 1.5489e+01
[rank2]:2025-10-30 17:46:15,984 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1310e+00
[rank0]:2025-10-30 17:46:15,988 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1678e+01
[rank3]:2025-10-30 17:46:16,000 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.7229e+00
[rank1]:2025-10-30 17:46:38,305 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 3.9602e+00
[rank0]:2025-10-30 17:46:38,306 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0223e+00
[rank3]:2025-10-30 17:46:38,318 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 2.0312e+00
[rank2]:2025-10-30 17:46:38,299 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 2.7927e+00
[rank0]:2025-10-30 17:46:58,591 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:47:00,832 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 8.5557e+00
[rank1]:2025-10-30 17:47:00,833 - INFO -  step: 500  loss: -4.0000  grad_norm:  2.4753  memory: 70.12GiB(50.15%)  tps: 7,270  tflops: 339.05  mfu: 34.28%
[rank3]:2025-10-30 17:47:00,845 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 5.9654e+00
[rank3]:2025-10-30 17:47:00,847 - INFO -  step: 500  loss:  2.2860  grad_norm:  2.4753  memory: 75.33GiB(53.88%)  tps: 7,269  tflops: 339.03  mfu: 34.28%
[rank0]:2025-10-30 17:47:00,833 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3529e+01
[rank0]:2025-10-30 17:47:00,833 - INFO -  step: 500  loss: -4.0000  grad_norm:  2.4753  memory: 73.46GiB(52.54%)  tps: 7,269  tflops: 339.03  mfu: 34.28%
[rank2]:2025-10-30 17:47:00,829 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1286e+00
[rank2]:2025-10-30 17:47:00,829 - INFO -  step: 500  loss: -4.0000  grad_norm:  2.4753  memory: 64.04GiB(45.81%)  tps: 7,269  tflops: 339.02  mfu: 34.28%
[rank1]:2025-10-30 17:47:00,923 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1747_stage1_step500.svg
[rank0]:2025-10-30 17:47:00,915 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1747_stage0_step500.svg
[rank2]:2025-10-30 17:47:00,916 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1747_stage2_step500.svg
[rank3]:2025-10-30 17:47:01,032 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1747_real_step500_rank3.svg
[rank3]:> Batch Time: 616.53 ms, GPU Bubble Ratio: 33.94%, 27.41%, 36.55%, 26.51%
[rank3]:2025-10-30 17:47:01,095 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1747_stage3_step500.svg
[rank3]:2025-10-30 17:47:01,450 - INFO - Avg. fwd time: 14.3247 / Avg. bwd time: 41.0225 / Avg. batch time: 458.5105 (ms) / GPU bubble ratio: 3.43%
[rank2]:2025-10-30 17:47:01,467 - INFO - Avg. fwd time: 13.3103 / Avg. bwd time: 32.3318 / Avg. batch time: 506.8372 (ms) / GPU bubble ratio: 27.96%
[rank1]:2025-10-30 17:47:01,500 - INFO - Avg. fwd time: 15.0121 / Avg. bwd time: 38.5523 / Avg. batch time: 566.6301 (ms) / GPU bubble ratio: 24.37%
[rank0]:2025-10-30 17:47:01,510 - INFO - Avg. fwd time: 13.9733 / Avg. bwd time: 32.4282 / Avg. batch time: 615.5583 (ms) / GPU bubble ratio: 39.70%
[rank1]:2025-10-30 17:47:23,451 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.6080e+00
[rank0]:2025-10-30 17:47:23,452 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3249e+00
[rank3]:2025-10-30 17:47:23,464 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.4562e+00
[rank2]:2025-10-30 17:47:23,445 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.2605e+00
[rank1]:2025-10-30 17:47:45,923 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.6544e+00
[rank0]:2025-10-30 17:47:45,927 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7650e+00
[rank2]:2025-10-30 17:47:45,923 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2807e+00
[rank3]:2025-10-30 17:47:45,939 - INFO - Freezing Ratio: [Stage3] 0.42, Threshold: 1.0233e+01
[rank1]:2025-10-30 17:48:07,665 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 6.7177e+00
[rank0]:2025-10-30 17:48:07,666 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.4955e+00
[rank2]:2025-10-30 17:48:07,659 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 6.8627e+00
[rank3]:2025-10-30 17:48:07,675 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 6.5592e+00
[rank0]:2025-10-30 17:48:30,029 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0504e+01
[rank2]:2025-10-30 17:48:30,025 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.0115e+00
[rank3]:2025-10-30 17:48:30,041 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.3760e+00
[rank1]:2025-10-30 17:48:30,025 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 7.2571e+00
[rank0]:2025-10-30 17:48:48,893 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:48:50,988 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 3.2547e+00
[rank1]:2025-10-30 17:48:50,989 - INFO -  step: 550  loss: -4.0000  grad_norm:  6.0329  memory: 71.10GiB(50.85%)  tps: 7,437  tflops: 346.85  mfu: 35.07%
[rank2]:2025-10-30 17:48:50,982 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.4873e+00
[rank2]:2025-10-30 17:48:50,982 - INFO -  step: 550  loss: -4.0000  grad_norm:  6.0329  memory: 64.04GiB(45.81%)  tps: 7,437  tflops: 346.86  mfu: 35.07%
[rank0]:2025-10-30 17:48:50,989 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6588e+00
[rank0]:2025-10-30 17:48:50,989 - INFO -  step: 550  loss: -4.0000  grad_norm:  6.0329  memory: 73.46GiB(52.54%)  tps: 7,437  tflops: 346.85  mfu: 35.07%
[rank3]:2025-10-30 17:48:50,995 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.6720e+00
[rank3]:2025-10-30 17:48:50,998 - INFO -  step: 550  loss:  2.2838  grad_norm:  6.0329  memory: 77.56GiB(55.47%)  tps: 7,437  tflops: 346.87  mfu: 35.07%
[rank2]:2025-10-30 17:48:51,417 - INFO - Avg. fwd time: 13.4423 / Avg. bwd time: 31.1196 / Avg. batch time: 502.5369 (ms) / GPU bubble ratio: 29.06%
[rank0]:2025-10-30 17:48:51,457 - INFO - Avg. fwd time: 14.0870 / Avg. bwd time: 31.2778 / Avg. batch time: 608.3517 (ms) / GPU bubble ratio: 40.34%
[rank3]:2025-10-30 17:48:51,397 - INFO - Avg. fwd time: 14.3729 / Avg. bwd time: 40.5819 / Avg. batch time: 455.3998 (ms) / GPU bubble ratio: 3.46%
[rank1]:2025-10-30 17:48:51,444 - INFO - Avg. fwd time: 15.1578 / Avg. bwd time: 37.2021 / Avg. batch time: 560.6229 (ms) / GPU bubble ratio: 25.28%
[rank1]:2025-10-30 17:49:13,533 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.3871e+00
[rank2]:2025-10-30 17:49:13,533 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9395e+00
[rank3]:2025-10-30 17:49:13,549 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.4946e+00
[rank0]:2025-10-30 17:49:13,537 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.7328e+00
[rank1]:2025-10-30 17:49:34,368 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.6399e+00
[rank3]:2025-10-30 17:49:34,374 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.2683e+00
[rank2]:2025-10-30 17:49:34,361 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 4.7634e+00
[rank0]:2025-10-30 17:49:34,368 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6552e+00
[rank2]:2025-10-30 17:49:56,910 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5615e+00
[rank0]:2025-10-30 17:49:56,914 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7312e+00
[rank1]:2025-10-30 17:49:56,910 - INFO - Freezing Ratio: [Stage1] 0.67, Threshold: 4.5698e+00
[rank3]:2025-10-30 17:49:56,926 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.3359e+00
[rank1]:2025-10-30 17:50:17,783 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 4.9362e+00
[rank3]:2025-10-30 17:50:17,790 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0029e+00
[rank2]:2025-10-30 17:50:17,777 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.3427e+00
[rank0]:2025-10-30 17:50:17,784 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.4904e+00
[rank0]:2025-10-30 17:50:37,930 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:50:40,163 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 1.3108e+01
[rank1]:2025-10-30 17:50:40,163 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.4926  memory: 71.10GiB(50.85%)  tps: 7,504  tflops: 349.97  mfu: 35.39%
[rank1]:2025-10-30 17:50:40,164 - INFO - ðŸ”Ž  Running validation at step 600
[rank2]:2025-10-30 17:50:40,163 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.8788e+00
[rank2]:2025-10-30 17:50:40,163 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.4926  memory: 64.04GiB(45.81%)  tps: 7,503  tflops: 349.95  mfu: 35.38%
[rank2]:2025-10-30 17:50:40,163 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-10-30 17:50:40,179 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.0473e+00
[rank3]:2025-10-30 17:50:40,184 - INFO -  step: 600  loss:  2.5640  grad_norm:  1.4926  memory: 77.56GiB(55.47%)  tps: 7,503  tflops: 349.94  mfu: 35.38%
[rank3]:2025-10-30 17:50:40,184 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 17:50:40,167 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0816e+01
[rank0]:2025-10-30 17:50:40,167 - INFO -  step: 600  loss: -4.0000  grad_norm:  1.4926  memory: 73.46GiB(52.54%)  tps: 7,503  tflops: 349.96  mfu: 35.38%
[rank0]:2025-10-30 17:50:40,167 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-10-30 17:50:56,059 - INFO - validate step: 600  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,775
[rank1]:2025-10-30 17:50:56,093 - INFO - validate step: 600  loss: -1.0000  memory: 71.10GiB(50.85%)  tps: 25,713
[rank2]:2025-10-30 17:50:56,109 - INFO - validate step: 600  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,688
[rank3]:2025-10-30 17:50:56,120 - INFO - validate step: 600  loss:  0.8916  memory: 77.56GiB(55.47%)  tps: 25,704
[rank1]:2025-10-30 17:50:56,198 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1750_stage1_step600.svg
[rank2]:2025-10-30 17:50:56,190 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1750_stage2_step600.svg
[rank0]:2025-10-30 17:50:56,190 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1750_stage0_step600.svg
[rank3]:2025-10-30 17:50:56,308 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1750_real_step600_rank3.svg
[rank3]:> Batch Time: 601.10 ms, GPU Bubble Ratio: 43.69%, 26.45%, 37.54%, 25.18%
[rank3]:2025-10-30 17:50:56,374 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1750_stage3_step600.svg
[rank1]:2025-10-30 17:50:56,836 - INFO - Avg. fwd time: 15.2816 / Avg. bwd time: 36.0462 / Avg. batch time: 555.0322 (ms) / GPU bubble ratio: 26.02%
[rank2]:2025-10-30 17:50:56,808 - INFO - Avg. fwd time: 13.5488 / Avg. bwd time: 30.1434 / Avg. batch time: 498.3944 (ms) / GPU bubble ratio: 29.87%
[rank3]:2025-10-30 17:50:56,783 - INFO - Avg. fwd time: 14.4200 / Avg. bwd time: 40.1309 / Avg. batch time: 452.2121 (ms) / GPU bubble ratio: 3.50%
[rank0]:2025-10-30 17:50:56,863 - INFO - Avg. fwd time: 14.1850 / Avg. bwd time: 30.3283 / Avg. batch time: 601.7723 (ms) / GPU bubble ratio: 40.82%
[rank1]:2025-10-30 17:51:17,250 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8212e+00
[rank2]:2025-10-30 17:51:17,247 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.8432e+00
[rank3]:2025-10-30 17:51:17,260 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 4.0978e+00
[rank0]:2025-10-30 17:51:17,254 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3657e+00
[rank1]:2025-10-30 17:51:39,650 - INFO - Freezing Ratio: [Stage1] 0.78, Threshold: 2.4665e+00
[rank0]:2025-10-30 17:51:39,657 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.7023e+00
[rank3]:2025-10-30 17:51:39,669 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.1095e+00
[rank2]:2025-10-30 17:51:39,653 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.7253e-01
[rank1]:2025-10-30 17:52:00,439 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.1684e-01
[rank0]:2025-10-30 17:52:00,443 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6442e+00
[rank2]:2025-10-30 17:52:00,435 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 1.7950e+00
[rank3]:2025-10-30 17:52:00,449 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 1.0760e+00
[rank2]:2025-10-30 17:52:22,925 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4882e+01
[rank0]:2025-10-30 17:52:22,929 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.8419e+01
[rank1]:2025-10-30 17:52:22,922 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9423e+01
[rank3]:2025-10-30 17:52:22,941 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.5259e+00
[rank0]:2025-10-30 17:52:41,527 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-10-30 17:52:43,602 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 5.9526e+00
[rank2]:2025-10-30 17:52:43,602 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.1069  memory: 64.04GiB(45.81%)  tps: 7,621  tflops: 355.44  mfu: 35.94%
[rank3]:2025-10-30 17:52:43,615 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.9673e+00
[rank3]:2025-10-30 17:52:43,617 - INFO -  step: 650  loss:  1.9287  grad_norm:  4.1069  memory: 77.56GiB(55.47%)  tps: 7,621  tflops: 355.43  mfu: 35.94%
[rank0]:2025-10-30 17:52:43,609 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8259e+00
[rank0]:2025-10-30 17:52:43,609 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.1069  memory: 73.46GiB(52.54%)  tps: 7,617  tflops: 355.25  mfu: 35.92%
[rank1]:2025-10-30 17:52:43,602 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.8724e+00
[rank1]:2025-10-30 17:52:43,602 - INFO -  step: 650  loss: -4.0000  grad_norm:  4.1069  memory: 72.05GiB(51.54%)  tps: 7,620  tflops: 355.39  mfu: 35.93%
[rank2]:2025-10-30 17:52:44,034 - INFO - Avg. fwd time: 13.6288 / Avg. bwd time: 29.4096 / Avg. batch time: 494.9968 (ms) / GPU bubble ratio: 30.44%
[rank3]:2025-10-30 17:52:44,014 - INFO - Avg. fwd time: 14.4597 / Avg. bwd time: 39.7527 / Avg. batch time: 449.5788 (ms) / GPU bubble ratio: 3.53%
[rank0]:2025-10-30 17:52:44,072 - INFO - Avg. fwd time: 14.2546 / Avg. bwd time: 29.6371 / Avg. batch time: 596.4229 (ms) / GPU bubble ratio: 41.13%
[rank1]:2025-10-30 17:52:44,057 - INFO - Avg. fwd time: 15.3885 / Avg. bwd time: 35.0288 / Avg. batch time: 550.3972 (ms) / GPU bubble ratio: 26.72%
[rank3]:2025-10-30 17:53:06,049 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.5315e+00
[rank2]:2025-10-30 17:53:06,033 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2323e+00
[rank0]:2025-10-30 17:53:06,037 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.4161e+00
[rank1]:2025-10-30 17:53:06,030 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9139e+00
[rank3]:2025-10-30 17:53:26,710 - INFO - Freezing Ratio: [Stage3] 0.28, Threshold: 3.4386e+00
[rank2]:2025-10-30 17:53:26,698 - INFO - Freezing Ratio: [Stage2] 0.75, Threshold: 3.0700e+00
[rank0]:2025-10-30 17:53:26,705 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9503e+00
[rank1]:2025-10-30 17:53:26,697 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4280e+00
[rank3]:2025-10-30 17:53:49,071 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0661e+00
[rank2]:2025-10-30 17:53:49,055 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0171e+00
[rank0]:2025-10-30 17:53:49,059 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8262e-01
[rank1]:2025-10-30 17:53:49,052 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0129e+00
[rank3]:2025-10-30 17:54:09,877 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.8738e+01
[rank2]:2025-10-30 17:54:09,864 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.9420e+01
[rank0]:2025-10-30 17:54:09,872 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2727e+01
[rank1]:2025-10-30 17:54:09,864 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4191e+01
[rank0]:2025-10-30 17:54:28,489 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 17:54:30,594 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.1455e+00
[rank3]:2025-10-30 17:54:30,596 - INFO -  step: 700  loss:  2.5848  grad_norm:  4.2424  memory: 77.56GiB(55.47%)  tps: 7,658  tflops: 357.15  mfu: 36.11%
[rank2]:2025-10-30 17:54:30,581 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.4116e+00
[rank2]:2025-10-30 17:54:30,581 - INFO -  step: 700  loss: -4.0000  grad_norm:  4.2424  memory: 64.04GiB(45.81%)  tps: 7,658  tflops: 357.15  mfu: 36.11%
[rank0]:2025-10-30 17:54:30,588 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7492e+00
[rank0]:2025-10-30 17:54:30,588 - INFO -  step: 700  loss: -4.0000  grad_norm:  4.2424  memory: 73.46GiB(52.54%)  tps: 7,658  tflops: 357.15  mfu: 36.11%
[rank1]:2025-10-30 17:54:30,581 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.8683e+00
[rank1]:2025-10-30 17:54:30,581 - INFO -  step: 700  loss: -4.0000  grad_norm:  4.2424  memory: 72.05GiB(51.54%)  tps: 7,658  tflops: 357.15  mfu: 36.11%
[rank2]:2025-10-30 17:54:30,668 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1754_stage2_step700.svg
[rank0]:2025-10-30 17:54:30,671 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1754_stage0_step700.svg
[rank1]:2025-10-30 17:54:30,670 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1754_stage1_step700.svg
[rank3]:2025-10-30 17:54:30,780 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1754_real_step700_rank3.svg
[rank3]:> Batch Time: 585.70 ms, GPU Bubble Ratio: 42.06%, 24.73%, 39.54%, 26.41%
[rank3]:2025-10-30 17:54:30,848 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1754_stage3_step700.svg
[rank3]:2025-10-30 17:54:31,175 - INFO - Avg. fwd time: 14.4988 / Avg. bwd time: 39.3426 / Avg. batch time: 446.6878 (ms) / GPU bubble ratio: 3.57%
[rank2]:2025-10-30 17:54:31,195 - INFO - Avg. fwd time: 13.7101 / Avg. bwd time: 28.6615 / Avg. batch time: 491.3288 (ms) / GPU bubble ratio: 31.01%
[rank1]:2025-10-30 17:54:31,220 - INFO - Avg. fwd time: 15.5014 / Avg. bwd time: 33.9225 / Avg. batch time: 545.3998 (ms) / GPU bubble ratio: 27.50%
[rank0]:2025-10-30 17:54:31,235 - INFO - Avg. fwd time: 14.3251 / Avg. bwd time: 28.9428 / Avg. batch time: 590.7109 (ms) / GPU bubble ratio: 41.40%
[rank3]:2025-10-30 17:54:51,520 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.1686e+00
[rank2]:2025-10-30 17:54:51,507 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5992e+00
[rank0]:2025-10-30 17:54:51,514 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1456e+00
[rank1]:2025-10-30 17:54:51,507 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0833e+00
[rank1]:2025-10-30 17:55:12,284 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4034e+01
[rank3]:2025-10-30 17:55:12,297 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.8976e+00
[rank2]:2025-10-30 17:55:12,284 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7655e+01
[rank0]:2025-10-30 17:55:12,291 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5828e+01
[rank3]:2025-10-30 17:55:32,967 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.9344e+00
[rank2]:2025-10-30 17:55:32,954 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5862e+00
[rank0]:2025-10-30 17:55:32,961 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9937e+00
[rank1]:2025-10-30 17:55:32,954 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.5600e+00
[rank3]:2025-10-30 17:55:53,689 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.1282e+00
[rank2]:2025-10-30 17:55:53,677 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6305e+00
[rank0]:2025-10-30 17:55:53,684 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.8078e+00
[rank1]:2025-10-30 17:55:53,676 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3077e+00
[rank0]:2025-10-30 17:56:11,605 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:56:13,615 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0113e+00
[rank1]:2025-10-30 17:56:13,616 - INFO -  step: 750  loss: -4.0000  grad_norm:  4.1206  memory: 72.05GiB(51.54%)  tps: 7,951  tflops: 370.82  mfu: 37.49%
[rank2]:2025-10-30 17:56:13,615 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4485e+00
[rank2]:2025-10-30 17:56:13,616 - INFO -  step: 750  loss: -4.0000  grad_norm:  4.1206  memory: 64.04GiB(45.81%)  tps: 7,951  tflops: 370.82  mfu: 37.49%
[rank3]:2025-10-30 17:56:13,625 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 6.1230e+00
[rank3]:2025-10-30 17:56:13,627 - INFO -  step: 750  loss:  2.3326  grad_norm:  4.1206  memory: 78.44GiB(56.10%)  tps: 7,951  tflops: 370.84  mfu: 37.50%
[rank0]:2025-10-30 17:56:13,622 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9313e+00
[rank0]:2025-10-30 17:56:13,623 - INFO -  step: 750  loss: -4.0000  grad_norm:  4.1206  memory: 73.46GiB(52.54%)  tps: 7,951  tflops: 370.82  mfu: 37.49%
[rank2]:2025-10-30 17:56:14,109 - INFO - Avg. fwd time: 13.7887 / Avg. bwd time: 27.9534 / Avg. batch time: 486.8748 (ms) / GPU bubble ratio: 31.41%
[rank3]:2025-10-30 17:56:14,083 - INFO - Avg. fwd time: 14.5534 / Avg. bwd time: 38.8204 / Avg. batch time: 442.9232 (ms) / GPU bubble ratio: 3.60%
[rank1]:2025-10-30 17:56:14,136 - INFO - Avg. fwd time: 15.5999 / Avg. bwd time: 32.9726 / Avg. batch time: 539.8063 (ms) / GPU bubble ratio: 28.01%
[rank0]:2025-10-30 17:56:14,163 - INFO - Avg. fwd time: 14.3875 / Avg. bwd time: 28.3462 / Avg. batch time: 584.5046 (ms) / GPU bubble ratio: 41.51%
[rank1]:2025-10-30 17:56:34,356 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4440e+00
[rank3]:2025-10-30 17:56:34,369 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7651e+00
[rank2]:2025-10-30 17:56:34,356 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5720e+00
[rank0]:2025-10-30 17:56:34,363 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9676e+00
[rank2]:2025-10-30 17:56:54,407 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7837e+00
[rank3]:2025-10-30 17:56:54,417 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 1.7125e+00
[rank0]:2025-10-30 17:56:54,414 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5194e+00
[rank1]:2025-10-30 17:56:54,407 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0843e+00
[rank1]:2025-10-30 17:57:15,084 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1429e+01
[rank3]:2025-10-30 17:57:15,097 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 9.0671e+00
[rank2]:2025-10-30 17:57:15,084 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0908e+01
[rank0]:2025-10-30 17:57:15,091 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7989e+00
[rank2]:2025-10-30 17:57:35,072 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3599e+00
[rank1]:2025-10-30 17:57:35,072 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.2491e+00
[rank3]:2025-10-30 17:57:35,081 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 2.8633e+00
[rank0]:2025-10-30 17:57:35,079 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.7853e+00
[rank0]:2025-10-30 17:57:53,743 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 17:57:55,830 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.6383e+00
[rank1]:2025-10-30 17:57:55,830 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.6306  memory: 72.05GiB(51.54%)  tps: 8,015  tflops: 373.80  mfu: 37.80%
[rank1]:2025-10-30 17:57:55,830 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 17:57:55,843 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.3892e+00
[rank3]:2025-10-30 17:57:55,845 - INFO -  step: 800  loss:  2.2963  grad_norm:  1.6306  memory: 78.44GiB(56.10%)  tps: 8,014  tflops: 373.79  mfu: 37.79%
[rank3]:2025-10-30 17:57:55,846 - INFO - ðŸ”Ž  Running validation at step 800
[rank2]:2025-10-30 17:57:55,830 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 9.7813e+00
[rank2]:2025-10-30 17:57:55,831 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.6306  memory: 64.04GiB(45.81%)  tps: 8,015  tflops: 373.80  mfu: 37.80%
[rank2]:2025-10-30 17:57:55,831 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-10-30 17:57:55,837 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3129e+00
[rank0]:2025-10-30 17:57:55,837 - INFO -  step: 800  loss: -4.0000  grad_norm:  1.6306  memory: 73.46GiB(52.54%)  tps: 8,015  tflops: 373.80  mfu: 37.80%
[rank0]:2025-10-30 17:57:55,838 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-10-30 17:58:11,977 - INFO - validate step: 800  loss:  0.9290  memory: 78.44GiB(56.10%)  tps: 25,394
[rank2]:2025-10-30 17:58:11,968 - INFO - validate step: 800  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,383
[rank0]:2025-10-30 17:58:11,919 - INFO - validate step: 800  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,471
[rank1]:2025-10-30 17:58:11,953 - INFO - validate step: 800  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,406
[rank2]:2025-10-30 17:58:12,054 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1758_stage2_step800.svg
[rank0]:2025-10-30 17:58:12,053 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1758_stage0_step800.svg
[rank1]:2025-10-30 17:58:12,054 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1758_stage1_step800.svg
[rank3]:2025-10-30 17:58:12,166 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1758_real_step800_rank3.svg
[rank3]:> Batch Time: 554.23 ms, GPU Bubble Ratio: 45.41%, 29.46%, 42.01%, 24.19%
[rank3]:2025-10-30 17:58:12,242 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1758_stage3_step800.svg
[rank2]:2025-10-30 17:58:12,580 - INFO - Avg. fwd time: 13.8472 / Avg. bwd time: 27.4200 / Avg. batch time: 483.1997 (ms) / GPU bubble ratio: 31.68%
[rank3]:2025-10-30 17:58:12,558 - INFO - Avg. fwd time: 14.5979 / Avg. bwd time: 38.3888 / Avg. batch time: 439.8040 (ms) / GPU bubble ratio: 3.62%
[rank1]:2025-10-30 17:58:12,605 - INFO - Avg. fwd time: 15.6743 / Avg. bwd time: 32.2586 / Avg. batch time: 535.2739 (ms) / GPU bubble ratio: 28.36%
[rank0]:2025-10-30 17:58:12,620 - INFO - Avg. fwd time: 14.4344 / Avg. bwd time: 27.8975 / Avg. batch time: 579.5123 (ms) / GPU bubble ratio: 41.56%
[rank2]:2025-10-30 17:58:32,096 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3354e+00
[rank3]:2025-10-30 17:58:32,106 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.0681e+00
[rank0]:2025-10-30 17:58:32,103 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.5119e+00
[rank1]:2025-10-30 17:58:32,096 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.6790e+00
[rank1]:2025-10-30 17:58:52,858 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1469e+00
[rank3]:2025-10-30 17:58:52,871 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3561e+00
[rank0]:2025-10-30 17:58:52,865 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.9161e+00
[rank2]:2025-10-30 17:58:52,858 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5587e+00
[rank0]:2025-10-30 17:59:12,830 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.4913e+00
[rank2]:2025-10-30 17:59:12,822 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.9400e+00
[rank3]:2025-10-30 17:59:12,832 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 5.3842e+00
[rank1]:2025-10-30 17:59:12,822 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7430e+00
[rank2]:2025-10-30 17:59:33,541 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2482e+00
[rank0]:2025-10-30 17:59:33,548 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6936e+00
[rank3]:2025-10-30 17:59:33,554 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.4358e+00
[rank1]:2025-10-30 17:59:33,541 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2076e+00
[rank0]:2025-10-30 17:59:51,533 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 17:59:53,528 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.8505e+00
[rank1]:2025-10-30 17:59:53,528 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.8235  memory: 72.05GiB(51.54%)  tps: 8,065  tflops: 376.15  mfu: 38.03%
[rank2]:2025-10-30 17:59:53,528 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4723e+00
[rank2]:2025-10-30 17:59:53,528 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.8235  memory: 64.04GiB(45.81%)  tps: 8,066  tflops: 376.21  mfu: 38.04%
[rank0]:2025-10-30 17:59:53,535 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0298e+00
[rank0]:2025-10-30 17:59:53,535 - INFO -  step: 850  loss: -4.0000  grad_norm:  7.8235  memory: 73.46GiB(52.54%)  tps: 8,062  tflops: 376.00  mfu: 38.02%
[rank3]:2025-10-30 17:59:53,538 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.0390e+00
[rank3]:2025-10-30 17:59:53,543 - INFO -  step: 850  loss:  2.6794  grad_norm:  7.8235  memory: 78.44GiB(56.10%)  tps: 8,066  tflops: 376.19  mfu: 38.04%
[rank2]:2025-10-30 17:59:53,928 - INFO - Avg. fwd time: 13.9079 / Avg. bwd time: 26.8699 / Avg. batch time: 479.3946 (ms) / GPU bubble ratio: 31.95%
[rank0]:2025-10-30 17:59:53,967 - INFO - Avg. fwd time: 14.4836 / Avg. bwd time: 27.4350 / Avg. batch time: 574.3465 (ms) / GPU bubble ratio: 41.61%
[rank3]:2025-10-30 17:59:53,908 - INFO - Avg. fwd time: 14.6473 / Avg. bwd time: 37.9335 / Avg. batch time: 436.5283 (ms) / GPU bubble ratio: 3.64%
[rank1]:2025-10-30 17:59:53,953 - INFO - Avg. fwd time: 15.7517 / Avg. bwd time: 31.5229 / Avg. batch time: 530.5852 (ms) / GPU bubble ratio: 28.72%
[rank1]:2025-10-30 18:00:14,151 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3666e+01
[rank2]:2025-10-30 18:00:14,151 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0307e+01
[rank3]:2025-10-30 18:00:14,164 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5853e+01
[rank0]:2025-10-30 18:00:14,158 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1908e+01
[rank2]:2025-10-30 18:00:34,113 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 6.3983e+00
[rank1]:2025-10-30 18:00:34,113 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.1932e+00
[rank0]:2025-10-30 18:00:34,120 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8578e+00
[rank3]:2025-10-30 18:00:34,123 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 4.9080e+00
[rank1]:2025-10-30 18:00:54,849 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1144e+01
[rank0]:2025-10-30 18:00:54,857 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.9234e+00
[rank3]:2025-10-30 18:00:54,862 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2564e+01
[rank2]:2025-10-30 18:00:54,850 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8995e+01
[rank0]:2025-10-30 18:01:14,747 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9375e+00
[rank3]:2025-10-30 18:01:14,749 - INFO - Freezing Ratio: [Stage3] 0.55, Threshold: 3.2798e+00
[rank2]:2025-10-30 18:01:14,739 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.6352e+00
[rank1]:2025-10-30 18:01:14,740 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8430e+00
[rank0]:2025-10-30 18:01:33,387 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 18:01:35,453 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0175e+00
[rank3]:2025-10-30 18:01:35,455 - INFO -  step: 900  loss:  2.5671  grad_norm:  4.5423  memory: 78.44GiB(56.10%)  tps: 8,038  tflops: 374.91  mfu: 37.91%
[rank0]:2025-10-30 18:01:35,447 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1961e+01
[rank0]:2025-10-30 18:01:35,448 - INFO -  step: 900  loss: -4.0000  grad_norm:  4.5423  memory: 73.46GiB(52.54%)  tps: 8,038  tflops: 374.91  mfu: 37.91%
[rank2]:2025-10-30 18:01:35,440 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7084e+00
[rank2]:2025-10-30 18:01:35,440 - INFO -  step: 900  loss: -4.0000  grad_norm:  4.5423  memory: 64.04GiB(45.81%)  tps: 8,038  tflops: 374.91  mfu: 37.91%
[rank1]:2025-10-30 18:01:35,440 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.8324e+00
[rank1]:2025-10-30 18:01:35,440 - INFO -  step: 900  loss: -4.0000  grad_norm:  4.5423  memory: 72.05GiB(51.54%)  tps: 8,038  tflops: 374.91  mfu: 37.91%
[rank1]:2025-10-30 18:01:35,522 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1801_stage1_step900.svg
[rank0]:2025-10-30 18:01:35,521 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1801_stage0_step900.svg
[rank2]:2025-10-30 18:01:35,524 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1801_stage2_step900.svg
[rank3]:2025-10-30 18:01:35,640 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1801_real_step900_rank3.svg
[rank3]:> Batch Time: 550.08 ms, GPU Bubble Ratio: 45.46%, 29.69%, 48.30%, 23.82%
[rank3]:2025-10-30 18:01:35,707 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1801_stage3_step900.svg
[rank3]:2025-10-30 18:01:36,099 - INFO - Avg. fwd time: 14.6866 / Avg. bwd time: 37.5428 / Avg. batch time: 433.6935 (ms) / GPU bubble ratio: 3.66%
[rank2]:2025-10-30 18:01:36,125 - INFO - Avg. fwd time: 13.9610 / Avg. bwd time: 26.3844 / Avg. batch time: 476.0899 (ms) / GPU bubble ratio: 32.21%
[rank1]:2025-10-30 18:01:36,152 - INFO - Avg. fwd time: 15.8180 / Avg. bwd time: 30.8716 / Avg. batch time: 526.4986 (ms) / GPU bubble ratio: 29.06%
[rank0]:2025-10-30 18:01:36,179 - INFO - Avg. fwd time: 14.5264 / Avg. bwd time: 27.0255 / Avg. batch time: 569.8377 (ms) / GPU bubble ratio: 41.66%
[rank2]:2025-10-30 18:01:55,582 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6189e+00
[rank1]:2025-10-30 18:01:55,582 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.6464e+00
[rank0]:2025-10-30 18:01:55,589 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8320e+00
[rank3]:2025-10-30 18:01:55,592 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 9.7056e+00
[rank1]:2025-10-30 18:02:14,749 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8701e+00
[rank0]:2025-10-30 18:02:14,756 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5735e+00
[rank2]:2025-10-30 18:02:14,749 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.4905e+00
[rank3]:2025-10-30 18:02:14,755 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1074e+00
[rank2]:2025-10-30 18:02:34,714 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1602e+01
[rank1]:2025-10-30 18:02:34,714 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5206e+01
[rank0]:2025-10-30 18:02:34,721 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5645e+01
[rank3]:2025-10-30 18:02:34,723 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7417e+00
[rank1]:2025-10-30 18:02:53,884 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4425e+00
[rank0]:2025-10-30 18:02:53,892 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3705e+00
[rank3]:2025-10-30 18:02:53,891 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.8875e+00
[rank2]:2025-10-30 18:02:53,884 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3504e+00
[rank0]:2025-10-30 18:03:11,847 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-10-30 18:03:13,839 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.0264e+00
[rank0]:2025-10-30 18:03:13,840 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.8562  memory: 73.46GiB(52.54%)  tps: 8,326  tflops: 388.32  mfu: 39.26%
[rank3]:2025-10-30 18:03:13,842 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1044e+00
[rank3]:2025-10-30 18:03:13,845 - INFO -  step: 950  loss:  2.0413  grad_norm:  0.8562  memory: 79.24GiB(56.67%)  tps: 8,326  tflops: 388.34  mfu: 39.27%
[rank2]:2025-10-30 18:03:13,833 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2343e+01
[rank2]:2025-10-30 18:03:13,833 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.8562  memory: 64.04GiB(45.81%)  tps: 8,326  tflops: 388.32  mfu: 39.26%
[rank1]:2025-10-30 18:03:13,832 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 8.2878e+00
[rank1]:2025-10-30 18:03:13,833 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.8562  memory: 72.05GiB(51.54%)  tps: 8,326  tflops: 388.32  mfu: 39.26%
[rank0]:2025-10-30 18:03:14,240 - INFO - Avg. fwd time: 14.5596 / Avg. bwd time: 26.7110 / Avg. batch time: 565.4342 (ms) / GPU bubble ratio: 41.61%
[rank3]:2025-10-30 18:03:14,166 - INFO - Avg. fwd time: 14.7300 / Avg. bwd time: 37.1171 / Avg. batch time: 430.6037 (ms) / GPU bubble ratio: 3.68%
[rank2]:2025-10-30 18:03:14,201 - INFO - Avg. fwd time: 14.0019 / Avg. bwd time: 26.0100 / Avg. batch time: 472.6079 (ms) / GPU bubble ratio: 32.27%
[rank1]:2025-10-30 18:03:14,226 - INFO - Avg. fwd time: 15.8702 / Avg. bwd time: 30.3715 / Avg. batch time: 522.4171 (ms) / GPU bubble ratio: 29.19%
[rank1]:2025-10-30 18:03:33,116 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4803e+00
[rank3]:2025-10-30 18:03:33,123 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.3072e+00
[rank0]:2025-10-30 18:03:33,123 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0002e+00
[rank2]:2025-10-30 18:03:33,116 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.4654e+00
[rank1]:2025-10-30 18:03:53,032 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8089e+00
[rank2]:2025-10-30 18:03:53,032 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2450e+00
[rank3]:2025-10-30 18:03:53,042 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2815e+00
[rank0]:2025-10-30 18:03:53,039 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 4.8615e+00
[rank1]:2025-10-30 18:04:12,246 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2255e+00
[rank3]:2025-10-30 18:04:12,253 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.1613e+00
[rank0]:2025-10-30 18:04:12,253 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8823e+00
[rank2]:2025-10-30 18:04:12,247 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0323e+00
[rank1]:2025-10-30 18:04:32,114 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1066e+00
[rank2]:2025-10-30 18:04:32,114 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2326e+00
[rank3]:2025-10-30 18:04:32,124 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 8.3360e-01
[rank0]:2025-10-30 18:04:32,121 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8248e+00
[rank0]:2025-10-30 18:04:49,426 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-10-30 18:04:51,337 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 7.3622e+00
[rank1]:2025-10-30 18:04:51,338 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3106  memory: 72.05GiB(51.54%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank1]:2025-10-30 18:04:51,338 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-10-30 18:04:51,345 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3796e+01
[rank0]:2025-10-30 18:04:51,345 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3106  memory: 73.46GiB(52.54%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank0]:2025-10-30 18:04:51,345 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-10-30 18:04:51,344 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 3.9443e+00
[rank3]:2025-10-30 18:04:51,347 - INFO -  step: 1000  loss:  2.3662  grad_norm:  0.3106  memory: 79.24GiB(56.67%)  tps: 8,402  tflops: 391.87  mfu: 39.62%
[rank3]:2025-10-30 18:04:51,347 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-10-30 18:04:51,337 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.2505e+00
[rank2]:2025-10-30 18:04:51,338 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.3106  memory: 64.04GiB(45.81%)  tps: 8,402  tflops: 391.85  mfu: 39.62%
[rank2]:2025-10-30 18:04:51,338 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-10-30 18:05:07,518 - INFO - validate step: 1000  loss: -1.0000  memory: 72.05GiB(51.54%)  tps: 25,316
[rank2]:2025-10-30 18:05:07,536 - INFO - validate step: 1000  loss: -1.0000  memory: 64.04GiB(45.81%)  tps: 25,288
[rank0]:2025-10-30 18:05:07,482 - INFO - validate step: 1000  loss: -1.0000  memory: 73.46GiB(52.54%)  tps: 25,384
[rank1]:2025-10-30 18:05:07,612 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1805_stage1_step1000.svg
[rank3]:2025-10-30 18:05:07,539 - INFO - validate step: 1000  loss:  0.8728  memory: 79.24GiB(56.67%)  tps: 25,298
[rank2]:2025-10-30 18:05:07,610 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1805_stage2_step1000.svg
[rank0]:2025-10-30 18:05:07,607 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1805_stage0_step1000.svg
[rank3]:2025-10-30 18:05:07,726 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1805_real_step1000_rank3.svg
[rank3]:> Batch Time: 543.01 ms, GPU Bubble Ratio: 47.56%, 38.38%, 47.61%, 23.00%
[rank3]:2025-10-30 18:05:07,788 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1805_stage3_step1000.svg
[rank3]:2025-10-30 18:05:08,097 - INFO - Avg. fwd time: 14.7770 / Avg. bwd time: 36.6585 / Avg. batch time: 427.2776 (ms) / GPU bubble ratio: 3.70%
[rank2]:2025-10-30 18:05:08,120 - INFO - Avg. fwd time: 14.0450 / Avg. bwd time: 25.6181 / Avg. batch time: 468.8699 (ms) / GPU bubble ratio: 32.33%
[rank1]:2025-10-30 18:05:08,145 - INFO - Avg. fwd time: 15.9244 / Avg. bwd time: 29.8465 / Avg. batch time: 518.0507 (ms) / GPU bubble ratio: 29.32%
[rank0]:2025-10-30 18:05:08,159 - INFO - Avg. fwd time: 14.5937 / Avg. bwd time: 26.3806 / Avg. batch time: 560.7267 (ms) / GPU bubble ratio: 41.54%
[rank1]:2025-10-30 18:05:27,704 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0566e+01
[rank0]:2025-10-30 18:05:27,711 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9230e+01
[rank2]:2025-10-30 18:05:27,704 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 7.0477e+00
[rank3]:2025-10-30 18:05:27,713 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6251e+00
[rank1]:2025-10-30 18:05:46,871 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.7349e+00
[rank3]:2025-10-30 18:05:46,878 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.0151e+00
[rank0]:2025-10-30 18:05:46,879 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.4011e+00
[rank2]:2025-10-30 18:05:46,872 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.7050e+00
[rank1]:2025-10-30 18:06:06,862 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3597e+00
[rank3]:2025-10-30 18:06:06,871 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9994e+00
[rank0]:2025-10-30 18:06:06,869 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.7049e+00
[rank2]:2025-10-30 18:06:06,862 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5547e+00
[rank1]:2025-10-30 18:06:26,128 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3193e+00
[rank3]:2025-10-30 18:06:26,134 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.9832e+00
[rank0]:2025-10-30 18:06:26,135 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.3868e+00
[rank2]:2025-10-30 18:06:26,128 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3610e+00
[rank0]:2025-10-30 18:06:43,998 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2025-10-30 18:06:45,998 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2242e+00
[rank1]:2025-10-30 18:06:45,999 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.4939  memory: 72.05GiB(51.54%)  tps: 8,318  tflops: 387.97  mfu: 39.23%
[rank3]:2025-10-30 18:06:46,008 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4731e+00
[rank3]:2025-10-30 18:06:46,010 - INFO -  step: 1050  loss:  2.2833  grad_norm:  0.4939  memory: 79.24GiB(56.67%)  tps: 8,319  tflops: 388.01  mfu: 39.23%
[rank0]:2025-10-30 18:06:46,005 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8630e+00
[rank0]:2025-10-30 18:06:46,006 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.4939  memory: 73.46GiB(52.54%)  tps: 8,315  tflops: 387.80  mfu: 39.21%
[rank2]:2025-10-30 18:06:45,998 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2794e+00
[rank2]:2025-10-30 18:06:45,999 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.4939  memory: 64.04GiB(45.81%)  tps: 8,320  tflops: 388.04  mfu: 39.24%
[rank1]:2025-10-30 18:06:46,489 - INFO - Avg. fwd time: 15.9736 / Avg. bwd time: 29.3747 / Avg. batch time: 514.2555 (ms) / GPU bubble ratio: 29.45%
[rank3]:2025-10-30 18:06:46,432 - INFO - Avg. fwd time: 14.8188 / Avg. bwd time: 36.2587 / Avg. batch time: 424.3845 (ms) / GPU bubble ratio: 3.71%
[rank2]:2025-10-30 18:06:46,461 - INFO - Avg. fwd time: 14.0838 / Avg. bwd time: 25.2646 / Avg. batch time: 465.6380 (ms) / GPU bubble ratio: 32.40%
[rank0]:2025-10-30 18:06:46,517 - INFO - Avg. fwd time: 14.6244 / Avg. bwd time: 26.0837 / Avg. batch time: 556.6247 (ms) / GPU bubble ratio: 41.49%
[rank3]:2025-10-30 18:07:05,259 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 1.3544e+00
[rank1]:2025-10-30 18:07:05,252 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1577e+00
[rank0]:2025-10-30 18:07:05,259 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9334e+00
[rank2]:2025-10-30 18:07:05,252 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6966e+00
[rank3]:2025-10-30 18:07:25,196 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2510e+00
[rank0]:2025-10-30 18:07:25,193 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4095e+00
[rank1]:2025-10-30 18:07:25,187 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4445e+00
[rank2]:2025-10-30 18:07:25,186 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6290e+00
[rank3]:2025-10-30 18:07:44,406 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7145e+00
[rank0]:2025-10-30 18:07:44,407 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2369e+00
[rank1]:2025-10-30 18:07:44,400 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9230e+00
[rank2]:2025-10-30 18:07:44,400 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3439e+00
[rank3]:2025-10-30 18:08:04,413 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 3.8799e-01
[rank0]:2025-10-30 18:08:04,410 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1168e+01
[rank2]:2025-10-30 18:08:04,403 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3251e+00
[rank1]:2025-10-30 18:08:04,403 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.4562e+00
[rank0]:2025-10-30 18:08:21,606 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-10-30 18:08:23,552 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.2134e+00
[rank3]:2025-10-30 18:08:23,555 - INFO -  step: 1100  loss:  2.4417  grad_norm:  0.4819  memory: 79.24GiB(56.67%)  tps: 8,398  tflops: 391.70  mfu: 39.61%
[rank0]:2025-10-30 18:08:23,553 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.0222e+00
[rank0]:2025-10-30 18:08:23,553 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4819  memory: 73.46GiB(52.54%)  tps: 8,398  tflops: 391.68  mfu: 39.60%
[rank2]:2025-10-30 18:08:23,546 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.7734e+00
[rank2]:2025-10-30 18:08:23,546 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4819  memory: 64.04GiB(45.81%)  tps: 8,398  tflops: 391.68  mfu: 39.60%
[rank1]:2025-10-30 18:08:23,546 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.3739e+00
[rank1]:2025-10-30 18:08:23,547 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.4819  memory: 72.05GiB(51.54%)  tps: 8,398  tflops: 391.68  mfu: 39.60%
[rank0]:2025-10-30 18:08:23,626 - INFO - Frozen Ratio History of Rank 0 (Stage 0)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank0/251030_1808_stage0_step1100.svg
[rank2]:2025-10-30 18:08:23,625 - INFO - Frozen Ratio History of Rank 2 (Stage 2)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank2/251030_1808_stage2_step1100.svg
[rank1]:2025-10-30 18:08:23,629 - INFO - Frozen Ratio History of Rank 1 (Stage 1)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank1/251030_1808_stage1_step1100.svg
[rank3]:2025-10-30 18:08:23,742 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/pipeline_schedule/251030_1808_real_step1100_rank3.svg
[rank3]:> Batch Time: 539.69 ms, GPU Bubble Ratio: 47.22%, 38.53%, 47.55%, 23.19%
[rank3]:2025-10-30 18:08:23,804 - INFO - Frozen Ratio History of Rank 3 (Stage 3)  is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1/freeze_ratio_history/rank3/251030_1808_stage3_step1100.svg
[rank3]:2025-10-30 18:08:24,116 - INFO - Avg. fwd time: 14.8534 / Avg. bwd time: 35.9329 / Avg. batch time: 422.0330 (ms) / GPU bubble ratio: 3.73%
[rank0]:2025-10-30 18:08:24,178 - INFO - Avg. fwd time: 14.6499 / Avg. bwd time: 25.8516 / Avg. batch time: 553.3020 (ms) / GPU bubble ratio: 41.44%
[rank2]:2025-10-30 18:08:24,138 - INFO - Avg. fwd time: 14.1148 / Avg. bwd time: 24.9894 / Avg. batch time: 462.9966 (ms) / GPU bubble ratio: 32.43%
[rank1]:2025-10-30 18:08:24,164 - INFO - Avg. fwd time: 16.0139 / Avg. bwd time: 29.0066 / Avg. batch time: 511.1719 (ms) / GPU bubble ratio: 29.54%
[rank1]:2025-10-30 18:08:43,716 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0532e+00
[rank3]:2025-10-30 18:08:43,726 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9152e+00
[rank0]:2025-10-30 18:08:43,723 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2390e+00
[rank2]:2025-10-30 18:08:43,716 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0562e+00
[rank3]:2025-10-30 18:09:03,005 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.6018e+00
[rank2]:2025-10-30 18:09:02,999 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3562e+01
[rank0]:2025-10-30 18:09:03,006 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2902e+01
[rank1]:2025-10-30 18:09:02,999 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1773e+01
[rank2]:2025-10-30 18:09:22,918 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4375e+00
[rank3]:2025-10-30 18:09:22,927 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9701e+00
[rank0]:2025-10-30 18:09:22,925 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.5316e+00
[rank1]:2025-10-30 18:09:22,918 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1065e+00
[rank3]:2025-10-30 18:09:42,138 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 6.3551e-01
[rank2]:2025-10-30 18:09:42,131 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9749e+00
[rank0]:2025-10-30 18:09:42,139 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 6.4201e+00
[rank1]:2025-10-30 18:09:42,132 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3225e+00
[rank0]:2025-10-30 18:10:00,053 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-10-30 18:10:02,053 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1363e+00
[rank2]:2025-10-30 18:10:02,053 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.0503  memory: 64.04GiB(45.81%)  tps: 8,316  tflops: 387.87  mfu: 39.22%
[rank3]:2025-10-30 18:10:02,063 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9316e+00
[rank3]:2025-10-30 18:10:02,065 - INFO -  step: 1150  loss:  1.8812  grad_norm:  1.0503  memory: 79.24GiB(56.67%)  tps: 8,316  tflops: 387.86  mfu: 39.22%
[rank0]:2025-10-30 18:10:02,060 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 7.3465e+00
[rank0]:2025-10-30 18:10:02,061 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.0503  memory: 73.46GiB(52.54%)  tps: 8,316  tflops: 387.87  mfu: 39.22%
[rank1]:2025-10-30 18:10:02,053 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 9.7907e+00
[rank1]:2025-10-30 18:10:02,054 - INFO -  step: 1150  loss: -4.0000  grad_norm:  1.0503  memory: 72.05GiB(51.54%)  tps: 8,316  tflops: 387.87  mfu: 39.22%
[rank2]:2025-10-30 18:10:02,432 - INFO - Avg. fwd time: 14.1468 / Avg. bwd time: 24.6936 / Avg. batch time: 460.2604 (ms) / GPU bubble ratio: 32.49%
[rank3]:2025-10-30 18:10:02,395 - INFO - Avg. fwd time: 14.8886 / Avg. bwd time: 35.5944 / Avg. batch time: 419.5824 (ms) / GPU bubble ratio: 3.75%
[rank1]:2025-10-30 18:10:02,459 - INFO - Avg. fwd time: 16.0554 / Avg. bwd time: 28.6126 / Avg. batch time: 507.9631 (ms) / GPU bubble ratio: 29.65%
[rank0]:2025-10-30 18:10:02,471 - INFO - Avg. fwd time: 14.6764 / Avg. bwd time: 25.6034 / Avg. batch time: 549.8393 (ms) / GPU bubble ratio: 41.39%
[rank1]:2025-10-30 18:10:21,280 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 5.3213e+00
[rank2]:2025-10-30 18:10:21,280 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 5.3621e+00
[rank3]:2025-10-30 18:10:21,287 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1493e+00
[rank0]:2025-10-30 18:10:21,287 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2558e+00
[rank3]:2025-10-30 18:10:41,241 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5020e+00
[rank2]:2025-10-30 18:10:41,231 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 8.6042e+00
[rank0]:2025-10-30 18:10:41,239 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 5.3427e+00
[rank1]:2025-10-30 18:10:41,232 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.3324e+00
[rank0]:2025-10-30 18:11:00,417 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3788e+00
[rank1]:2025-10-30 18:11:00,410 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3102e+00
[rank2]:2025-10-30 18:11:00,410 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8206e+00
[rank3]:2025-10-30 18:11:00,416 - INFO - Freezing Ratio: [Stage3] 0.69, Threshold: 8.3335e+00
[rank1]:2025-10-30 18:11:20,342 - INFO - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9072e+00
[rank2]:2025-10-30 18:11:20,342 - INFO - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4911e+00
[rank3]:2025-10-30 18:11:20,352 - INFO - Freezing Ratio: [Stage3] 0.83, Threshold: 6.6984e-01
[rank0]:2025-10-30 18:11:20,349 - INFO - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6449e+01
[rank1]:2025-10-30 18:11:25,092 - INFO - Destroying the purge thread.
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/torchtitan/datasets/hf_datasets.py", line 371, in __iter__
[rank1]:[rank1]:     sample = next(iters[ds_i])
[rank1]:[rank1]: StopIteration
[rank1]:
[rank1]:[rank1]: During handling of the above exception, another exception occurred:
[rank1]:
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/torchtitan/datasets/hf_datasets.py", line 380, in __iter__
[rank1]:[rank1]:     sample = next(iters[ds_i])
[rank1]:[rank1]: StopIteration
[rank1]:
[rank1]:[rank1]: The above exception was the direct cause of the following exception:
[rank1]:
[rank1]:[rank1]: Traceback (most recent call last):
[rank1]:[rank1]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank1]:[rank1]:   File "<frozen runpy>", line 88, in _run_code
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 726, in <module>
[rank1]:[rank1]:     trainer.train()
[rank1]:[rank1]:     ~~~~~~~~~~~~~^^
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
[rank1]:[rank1]:     return f(*args, **kwargs)
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 584, in train
[rank1]:[rank1]:     self.train_step(data_iterator)
[rank1]:[rank1]:     ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 489, in train_step
[rank1]:[rank1]:     input_dict, labels = next(data_iterator)
[rank1]:[rank1]:                          ~~~~^^^^^^^^^^^^^^^
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 393, in batch_generator
[rank1]:[rank1]:     batch = next(data_iterator)
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torchdata/stateful_dataloader/stateful_dataloader.py", line 450, in __next__
[rank1]:[rank1]:     return super().__next__()
[rank1]:[rank1]:            ~~~~~~~~~~~~~~~~^^
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 738, in __next__
[rank1]:[rank1]:     data = self._next_data()
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torchdata/stateful_dataloader/stateful_dataloader.py", line 491, in _next_data
[rank1]:[rank1]:     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
[rank1]:[rank1]:   File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
[rank1]:[rank1]:     data.append(next(self.dataset_iter))
[rank1]:[rank1]:                 ~~~~^^^^^^^^^^^^^^^^^^^
[rank1]:[rank1]: RuntimeError: generator raised StopIteration
W1030 18:11:28.911000 3262505 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3262626 closing signal SIGTERM
W1030 18:11:28.912000 3262505 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3262628 closing signal SIGTERM
W1030 18:11:28.913000 3262505 site-packages/torch/distributed/elastic/multiprocessing/api.py:940] Sending process 3262629 closing signal SIGTERM
E1030 18:11:32.033000 3262505 site-packages/torch/distributed/elastic/multiprocessing/api.py:914] failed (exitcode: 1) local_rank: 1 (pid: 3262627) of binary: /opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/bin/python3.13
E1030 18:11:32.056000 3262505 site-packages/torch/distributed/elastic/multiprocessing/errors/error_handler.py:141] no error file defined for parent, to copy child error file (/tmp/torchelastic_60g9j58v/5deb2005-35de-439f-8341-34006471aa42_sl3xm6ze/attempt_0/1/error.json)
[rank2]:Stage 2: Modules to keep: {'layers.19', 'layers.21', 'layers.17', 'layers.18', 'layers.20', 'layers.24', 'layers.23', 'layers.22'}
[rank1]:Stage 1: Modules to keep: {'layers.15', 'layers.11', 'layers.16', 'layers.8', 'layers.9', 'layers.10', 'layers.13', 'layers.14', 'layers.12'}
[rank0]:Stage 0: Modules to keep: {'layers.7', 'layers.6', 'layers.3', 'layers.4', 'layers.0', 'layers.5', 'tok_embeddings', 'layers.1', 'layers.2'}
[rank3]:Stage 3: Modules to keep: {'layers.31', 'norm', 'layers.27', 'layers.25', 'output', 'layers.30', 'layers.28', 'layers.26', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1030_GPipe_auto_dm1
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1030_GPipe_auto_dm1
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1030_GPipe_auto_dm1
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1030_GPipe_auto_dm1
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1030_GPipe_auto_dm1
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1030_GPipe_auto_dm1
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 300
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: medical,alpaca
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2400
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1030_GPipe_auto_dm1
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1030_GPipe_auto_dm1
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- aggressiveness: 0
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
Traceback (most recent call last):
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ~~~~^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/run.py", line 946, in main
    run(args)
    ~~~^^^^^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/run.py", line 937, in run
    elastic_launch(
    ~~~~~~~~~~~~~~~
        config=config,
        ~~~~~~~~~~~~~~
        entrypoint=cmd,
        ~~~~~~~~~~~~~~~
    )(*cmd_args)
    ~^^^^^^^^^^^
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/launcher/api.py", line 159, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/launcher/api.py", line 300, in launch_agent
    raise ChildFailedError(
    ...<2 lines>...
    )
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
timelyfreeze.train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-10-30_18:11:32
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 0 (local_rank: 0)
  exitcode  : -15 (pid: 3262626)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3262626
[2]:
  time      : 2025-10-30_18:11:32
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 2 (local_rank: 2)
  exitcode  : -15 (pid: 3262628)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3262628
[3]:
  time      : 2025-10-30_18:11:32
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 3 (local_rank: 3)
  exitcode  : -15 (pid: 3262629)
  error_file: <N/A>
  traceback : Signal 15 (SIGTERM) received by PID 3262629
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-30_18:11:25
  host      : ip-172-16-131-118.sa-east-1.compute.internal
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3262627)
  error_file: /tmp/torchelastic_60g9j58v/5deb2005-35de-439f-8341-34006471aa42_sl3xm6ze/attempt_0/1/error.json
  traceback : Traceback (most recent call last):
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/torchtitan/datasets/hf_datasets.py", line 371, in __iter__
      sample = next(iters[ds_i])
  StopIteration
  
  During handling of the above exception, another exception occurred:
  
  Traceback (most recent call last):
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/torchtitan/datasets/hf_datasets.py", line 380, in __iter__
      sample = next(iters[ds_i])
  StopIteration
  
  The above exception was the direct cause of the following exception:
  
  Traceback (most recent call last):
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
      return f(*args, **kwargs)
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 584, in train
      self.train_step(data_iterator)
      ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 489, in train_step
      input_dict, labels = next(data_iterator)
                           ~~~~^^^^^^^^^^^^^^^
    File "/opt/dlami/nvme/DMLAB/shcho/torchtitan/timelyfreeze/train.py", line 393, in batch_generator
      batch = next(data_iterator)
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torchdata/stateful_dataloader/stateful_dataloader.py", line 450, in __next__
      return super().__next__()
             ~~~~~~~~~~~~~~~~^^
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 738, in __next__
      data = self._next_data()
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torchdata/stateful_dataloader/stateful_dataloader.py", line 491, in _next_data
      data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
    File "/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
      data.append(next(self.dataset_iter))
                  ~~~~^^^^^^^^^^^^^^^^^^^
  RuntimeError: generator raised StopIteration
  
============================================================
