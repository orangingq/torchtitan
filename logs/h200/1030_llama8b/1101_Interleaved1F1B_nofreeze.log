
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sun Nov  2 14:13:58 UTC 2025
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.131.118),  GPUs: 1,2,3,4
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/run3.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/1101_Interleaved1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16
âœ”ï¸Running with nofreeze x Interleaved1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml --job.description="Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W1102 14:13:59.272000 774451 site-packages/torch/distributed/run.py:811] 
W1102 14:13:59.272000 774451 site-packages/torch/distributed/run.py:811] *****************************************
W1102 14:13:59.272000 774451 site-packages/torch/distributed/run.py:811] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1102 14:13:59.272000 774451 site-packages/torch/distributed/run.py:811] *****************************************
[rank3]:2025-11-02 14:14:06,359 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank1]:2025-11-02 14:14:06,449 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank2]:2025-11-02 14:14:06,528 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank0]:2025-11-02 14:14:06,689 - INFO - Starting job: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:2025-11-02 14:14:07,218 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2025-11-02 14:14:07,220 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank1]:2025-11-02 14:14:07,439 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2025-11-02 14:14:07,442 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 14:14:07,530 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2025-11-02 14:14:07,533 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 14:14:07,539 - INFO - [GC] Initial GC collection 0.00 seconds
[rank2]:2025-11-02 14:14:07,508 - WARNING - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2025-11-02 14:14:07,511 - INFO - Building 1-D device mesh with ['pp'], [4]
[rank0]:2025-11-02 14:14:09,371 - INFO - Loading tokenizer from tokenizer.json
[rank0]:2025-11-02 14:14:09,655 - INFO - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2025-11-02 14:14:11,746 - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2025-11-02 14:14:11,768 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2025-11-02 14:14:11,842 - INFO - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2025-11-02 14:14:11,862 - INFO - PP rank 2 is building stage_idx 6 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28']
[rank2]:2025-11-02 14:14:11,864 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-02 14:14:12,002 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2025-11-02 14:14:11,950 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'repr' attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. 'repr' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank3]:/opt/dlami/nvme/DMLAB/shcho/miniforge3/envs/llm/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The 'frozen' attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. 'frozen' is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
[rank3]:  warnings.warn(
[rank1]:2025-11-02 14:14:12,025 - INFO - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2025-11-02 14:14:12,046 - INFO - PP rank 1 is building stage_idx 5 with modules ['layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank1]:2025-11-02 14:14:12,048 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank0]:2025-11-02 14:14:12,066 - INFO - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2025-11-02 14:14:12,089 - INFO - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank2]:2025-11-02 14:14:12,078 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2025-11-02 14:14:12,079 - INFO - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2025-11-02 14:14:12,111 - INFO - PP rank 0 is building stage_idx 4 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20']
[rank0]:2025-11-02 14:14:12,112 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-02 14:14:12,253 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2025-11-02 14:14:12,253 - INFO - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2025-11-02 14:14:12,326 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2025-11-02 14:14:12,326 - INFO - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run jnbzadwe
[rank3]:wandb: Tracking run with wandb version 0.22.2
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_Interleaved1F1B_nofreeze_h200/20251102-1414/wandb/run-20251102_141412-jnbzadwe
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 1101_Interleaved1F1B_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/jnbzadwe
[rank3]:2025-11-02 14:14:13,620 - INFO - WandB logging enabled
[rank3]:2025-11-02 14:14:13,621 - INFO - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2025-11-02 14:14:13,695 - INFO - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank3]:2025-11-02 14:14:13,716 - INFO - PP rank 3 is building stage_idx 7 with modules ['layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2025-11-02 14:14:13,717 - INFO - Using pipeline schedule Interleaved1F1B with 8 microbatches and 8 stages.
[rank1]:2025-11-02 14:14:13,961 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 14:14:13,945 - INFO - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_Interleaved1F1B_nofreeze_h200
[rank0]:2025-11-02 14:14:13,946 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 14:14:13,946 - INFO - Preparing c4_validation dataset from allenai/c4
[rank3]:2025-11-02 14:14:13,930 - INFO - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2025-11-02 14:14:13,930 - INFO - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2025-11-02 14:14:13,944 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank2]:2025-11-02 14:14:13,947 - INFO - Mixed precision training with TP or PP is handled by autocast
[rank0]:2025-11-02 14:14:17,767 - INFO - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 3000 (warmup 500)
[rank0]:2025-11-02 14:14:17,768 - INFO - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp.
[rank0]:2025-11-02 14:14:26,746 - INFO - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2025-11-02 14:14:26,746 - INFO - Finished loading the checkpoint in 8.98 seconds.
[rank0]:2025-11-02 14:14:26,746 - INFO - Training starts at step 1
[rank1]:2025-11-02 14:14:31,000 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 38.73GiB(27.70%)  tps: 862  tflops: 40.22  mfu: 4.07%
[rank1]:2025-11-02 14:14:31,000 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2025-11-02 14:14:31,010 - INFO -  step:  1  loss: 12.5722  grad_norm:     inf  memory: 36.75GiB(26.28%)  tps: 945  tflops: 44.07  mfu: 4.46%
[rank3]:2025-11-02 14:14:31,011 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 14:14:31,019 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 42.48GiB(30.38%)  tps: 864  tflops: 40.32  mfu: 4.08%
[rank0]:2025-11-02 14:14:31,019 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2025-11-02 14:14:30,997 - INFO -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 30.42GiB(21.76%)  tps: 854  tflops: 39.85  mfu: 4.03%
[rank2]:2025-11-02 14:14:30,997 - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2025-11-02 14:16:42,980 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 14:16:45,628 - INFO - Avg. fwd time: 8.1985 / Avg. bwd time: 20.5399 / Avg. batch time: 636.2887 (ms) / GPU bubble ratio: 27.74%
[rank0]:2025-11-02 14:16:45,623 - INFO - Avg. fwd time: 8.3817 / Avg. bwd time: 19.8545 / Avg. batch time: 665.0299 (ms) / GPU bubble ratio: 32.07%
[rank3]:2025-11-02 14:16:45,560 - INFO - Avg. fwd time: 7.6621 / Avg. bwd time: 22.5370 / Avg. batch time: 561.4112 (ms) / GPU bubble ratio: 13.93%
[rank2]:2025-11-02 14:16:45,581 - INFO - Avg. fwd time: 8.0157 / Avg. bwd time: 18.1451 / Avg. batch time: 594.1698 (ms) / GPU bubble ratio: 29.55%
[rank2]:2025-11-02 14:16:45,742 - INFO -  step: 50  loss: -4.0000  grad_norm: 7297.1377  memory: 43.55GiB(31.15%)  tps: 5,958  tflops: 277.89  mfu: 28.10%
[rank1]:2025-11-02 14:16:45,745 - INFO -  step: 50  loss: -4.0000  grad_norm: 7297.1377  memory: 53.47GiB(38.25%)  tps: 5,958  tflops: 277.88  mfu: 28.10%
[rank0]:2025-11-02 14:16:45,748 - INFO -  step: 50  loss: -4.0000  grad_norm: 7297.1377  memory: 59.39GiB(42.48%)  tps: 5,959  tflops: 277.92  mfu: 28.10%
[rank3]:2025-11-02 14:16:45,746 - INFO -  step: 50  loss: 12.7739  grad_norm: 7297.1377  memory: 51.83GiB(37.07%)  tps: 5,959  tflops: 277.91  mfu: 28.10%
[rank0]:2025-11-02 14:18:59,896 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2025-11-02 14:19:02,528 - INFO - Avg. fwd time: 8.2802 / Avg. bwd time: 19.8958 / Avg. batch time: 663.5089 (ms) / GPU bubble ratio: 32.06%
[rank1]:2025-11-02 14:19:02,533 - INFO - Avg. fwd time: 8.1555 / Avg. bwd time: 20.5351 / Avg. batch time: 634.7874 (ms) / GPU bubble ratio: 27.68%
[rank3]:2025-11-02 14:19:02,465 - INFO - Avg. fwd time: 7.6601 / Avg. bwd time: 22.5608 / Avg. batch time: 560.0467 (ms) / GPU bubble ratio: 13.66%
[rank2]:2025-11-02 14:19:02,486 - INFO - Avg. fwd time: 7.9585 / Avg. bwd time: 18.1486 / Avg. batch time: 592.7161 (ms) / GPU bubble ratio: 29.53%
[rank1]:2025-11-02 14:19:02,650 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.6377  memory: 53.47GiB(38.25%)  tps: 5,984  tflops: 279.08  mfu: 28.22%
[rank3]:2025-11-02 14:19:02,651 - INFO -  step: 100  loss:  4.2255  grad_norm: 79.6377  memory: 51.83GiB(37.07%)  tps: 5,984  tflops: 279.08  mfu: 28.22%
[rank2]:2025-11-02 14:19:02,647 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.6377  memory: 43.55GiB(31.15%)  tps: 5,984  tflops: 279.08  mfu: 28.22%
[rank0]:2025-11-02 14:19:02,654 - INFO -  step: 100  loss: -4.0000  grad_norm: 79.6377  memory: 59.39GiB(42.48%)  tps: 5,984  tflops: 279.08  mfu: 28.22%
[rank3]:2025-11-02 14:19:02,958 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1419_real_step100_rank3.svg
[rank3]:> Batch Time: 585.79 ms, GPU Bubble Ratio: 22.87%, 21.50%, 28.53%, 17.18%
[rank0]:2025-11-02 14:21:16,918 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:21:19,573 - INFO - Avg. fwd time: 7.6438 / Avg. bwd time: 22.5625 / Avg. batch time: 559.2197 (ms) / GPU bubble ratio: 13.58%
[rank1]:2025-11-02 14:21:19,630 - INFO - Avg. fwd time: 8.1304 / Avg. bwd time: 20.5406 / Avg. batch time: 634.4373 (ms) / GPU bubble ratio: 27.69%
[rank0]:2025-11-02 14:21:19,657 - INFO - Avg. fwd time: 8.2366 / Avg. bwd time: 19.9080 / Avg. batch time: 663.1478 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 14:21:19,599 - INFO - Avg. fwd time: 7.9268 / Avg. bwd time: 18.1605 / Avg. batch time: 592.3785 (ms) / GPU bubble ratio: 29.54%
[rank2]:2025-11-02 14:21:19,686 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.4698  memory: 43.55GiB(31.15%)  tps: 5,978  tflops: 278.81  mfu: 28.19%
[rank1]:2025-11-02 14:21:19,689 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.4698  memory: 53.47GiB(38.25%)  tps: 5,978  tflops: 278.81  mfu: 28.19%
[rank3]:2025-11-02 14:21:19,690 - INFO -  step: 150  loss:  1.1503  grad_norm: 18.4698  memory: 51.83GiB(37.07%)  tps: 5,978  tflops: 278.81  mfu: 28.19%
[rank0]:2025-11-02 14:21:19,693 - INFO -  step: 150  loss: -4.0000  grad_norm: 18.4698  memory: 59.39GiB(42.48%)  tps: 5,978  tflops: 278.81  mfu: 28.19%
[rank0]:2025-11-02 14:23:33,502 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:23:36,064 - INFO - Avg. fwd time: 7.6321 / Avg. bwd time: 22.5601 / Avg. batch time: 558.7254 (ms) / GPU bubble ratio: 13.54%
[rank2]:2025-11-02 14:23:36,085 - INFO - Avg. fwd time: 7.9122 / Avg. bwd time: 18.1675 / Avg. batch time: 591.7921 (ms) / GPU bubble ratio: 29.49%
[rank1]:2025-11-02 14:23:36,132 - INFO - Avg. fwd time: 8.1192 / Avg. bwd time: 20.5437 / Avg. batch time: 633.8298 (ms) / GPU bubble ratio: 27.65%
[rank0]:2025-11-02 14:23:36,127 - INFO - Avg. fwd time: 8.2174 / Avg. bwd time: 19.9137 / Avg. batch time: 662.5288 (ms) / GPU bubble ratio: 32.06%
[rank1]:2025-11-02 14:23:36,248 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4622  memory: 53.47GiB(38.25%)  tps: 5,999  tflops: 279.79  mfu: 28.29%
[rank1]:2025-11-02 14:23:36,248 - INFO - ðŸ”Ž  Running validation at step 200
[rank0]:2025-11-02 14:23:36,252 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4622  memory: 59.39GiB(42.48%)  tps: 5,999  tflops: 279.79  mfu: 28.29%
[rank0]:2025-11-02 14:23:36,252 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 14:23:36,250 - INFO -  step: 200  loss:  0.3476  grad_norm:  0.4622  memory: 51.83GiB(37.07%)  tps: 5,999  tflops: 279.79  mfu: 28.29%
[rank3]:2025-11-02 14:23:36,250 - INFO - ðŸ”Ž  Running validation at step 200
[rank2]:2025-11-02 14:23:36,245 - INFO -  step: 200  loss: -4.0000  grad_norm:  0.4622  memory: 43.55GiB(31.15%)  tps: 5,999  tflops: 279.79  mfu: 28.29%
[rank2]:2025-11-02 14:23:36,245 - INFO - ðŸ”Ž  Running validation at step 200
[rank3]:2025-11-02 14:23:59,446 - INFO - validate step: 200  loss:  0.2311  memory: 51.83GiB(37.07%)  tps: 17,658
[rank1]:2025-11-02 14:23:59,434 - INFO - validate step: 200  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 17,666
[rank0]:2025-11-02 14:23:59,427 - INFO - validate step: 200  loss: -1.0000  memory: 59.39GiB(42.48%)  tps: 17,674
[rank2]:2025-11-02 14:23:59,442 - INFO - validate step: 200  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 17,658
[rank3]:2025-11-02 14:23:59,741 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1423_real_step200_rank3.svg
[rank3]:> Batch Time: 583.77 ms, GPU Bubble Ratio: 22.76%, 21.39%, 28.42%, 17.18%
[rank0]:2025-11-02 14:26:13,991 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:26:16,551 - INFO - Avg. fwd time: 7.6321 / Avg. bwd time: 22.5642 / Avg. batch time: 558.6909 (ms) / GPU bubble ratio: 13.52%
[rank0]:2025-11-02 14:26:16,614 - INFO - Avg. fwd time: 8.2120 / Avg. bwd time: 19.9259 / Avg. batch time: 662.7537 (ms) / GPU bubble ratio: 32.07%
[rank2]:2025-11-02 14:26:16,572 - INFO - Avg. fwd time: 7.9111 / Avg. bwd time: 18.1760 / Avg. batch time: 591.9757 (ms) / GPU bubble ratio: 29.49%
[rank1]:2025-11-02 14:26:16,619 - INFO - Avg. fwd time: 8.1218 / Avg. bwd time: 20.5526 / Avg. batch time: 634.0382 (ms) / GPU bubble ratio: 27.64%
[rank2]:2025-11-02 14:26:16,732 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2543  memory: 43.55GiB(31.15%)  tps: 5,967  tflops: 278.30  mfu: 28.14%
[rank1]:2025-11-02 14:26:16,734 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2543  memory: 53.47GiB(38.25%)  tps: 5,967  tflops: 278.28  mfu: 28.14%
[rank0]:2025-11-02 14:26:16,738 - INFO -  step: 250  loss: -4.0000  grad_norm:  0.2543  memory: 59.39GiB(42.48%)  tps: 5,966  tflops: 278.26  mfu: 28.14%
[rank3]:2025-11-02 14:26:16,736 - INFO -  step: 250  loss:  0.2353  grad_norm:  0.2543  memory: 51.83GiB(37.07%)  tps: 5,967  tflops: 278.30  mfu: 28.14%
[rank0]:2025-11-02 14:28:31,078 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:28:33,762 - INFO - Avg. fwd time: 7.9132 / Avg. bwd time: 18.1849 / Avg. batch time: 591.9534 (ms) / GPU bubble ratio: 29.46%
[rank0]:2025-11-02 14:28:33,823 - INFO - Avg. fwd time: 8.2110 / Avg. bwd time: 19.9367 / Avg. batch time: 662.7701 (ms) / GPU bubble ratio: 32.05%
[rank3]:2025-11-02 14:28:33,734 - INFO - Avg. fwd time: 7.6344 / Avg. bwd time: 22.5683 / Avg. batch time: 558.7392 (ms) / GPU bubble ratio: 13.51%
[rank1]:2025-11-02 14:28:33,794 - INFO - Avg. fwd time: 8.1249 / Avg. bwd time: 20.5623 / Avg. batch time: 634.0369 (ms) / GPU bubble ratio: 27.61%
[rank2]:2025-11-02 14:28:33,852 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3201  memory: 43.55GiB(31.15%)  tps: 5,974  tflops: 278.64  mfu: 28.17%
[rank3]:2025-11-02 14:28:33,856 - INFO -  step: 300  loss:  0.2725  grad_norm:  0.3201  memory: 51.83GiB(37.07%)  tps: 5,974  tflops: 278.65  mfu: 28.17%
[rank0]:2025-11-02 14:28:33,858 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3201  memory: 59.39GiB(42.48%)  tps: 5,974  tflops: 278.64  mfu: 28.17%
[rank1]:2025-11-02 14:28:33,854 - INFO -  step: 300  loss: -4.0000  grad_norm:  0.3201  memory: 53.47GiB(38.25%)  tps: 5,974  tflops: 278.64  mfu: 28.17%
[rank3]:2025-11-02 14:28:34,146 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1428_real_step300_rank3.svg
[rank3]:> Batch Time: 585.39 ms, GPU Bubble Ratio: 22.74%, 21.30%, 28.37%, 17.23%
[rank0]:2025-11-02 14:30:48,632 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:30:51,222 - INFO - Avg. fwd time: 7.6373 / Avg. bwd time: 22.5736 / Avg. batch time: 558.8434 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-02 14:30:51,243 - INFO - Avg. fwd time: 7.9161 / Avg. bwd time: 18.1915 / Avg. batch time: 592.1956 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 14:30:51,289 - INFO - Avg. fwd time: 8.1281 / Avg. bwd time: 20.5692 / Avg. batch time: 634.2913 (ms) / GPU bubble ratio: 27.61%
[rank0]:2025-11-02 14:30:51,285 - INFO - Avg. fwd time: 8.2107 / Avg. bwd time: 19.9428 / Avg. batch time: 663.0385 (ms) / GPU bubble ratio: 32.06%
[rank1]:2025-11-02 14:30:51,405 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3596  memory: 53.47GiB(38.25%)  tps: 5,956  tflops: 277.77  mfu: 28.09%
[rank3]:2025-11-02 14:30:51,406 - INFO -  step: 350  loss:  0.3340  grad_norm:  0.3596  memory: 51.83GiB(37.07%)  tps: 5,956  tflops: 277.77  mfu: 28.09%
[rank0]:2025-11-02 14:30:51,408 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3596  memory: 59.39GiB(42.48%)  tps: 5,956  tflops: 277.77  mfu: 28.09%
[rank2]:2025-11-02 14:30:51,402 - INFO -  step: 350  loss: -4.0000  grad_norm:  0.3596  memory: 43.55GiB(31.15%)  tps: 5,956  tflops: 277.77  mfu: 28.09%
[rank0]:2025-11-02 14:33:05,837 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:33:08,437 - INFO - Avg. fwd time: 7.6403 / Avg. bwd time: 22.5790 / Avg. batch time: 558.9482 (ms) / GPU bubble ratio: 13.50%
[rank2]:2025-11-02 14:33:08,458 - INFO - Avg. fwd time: 7.9187 / Avg. bwd time: 18.1968 / Avg. batch time: 592.2215 (ms) / GPU bubble ratio: 29.44%
[rank0]:2025-11-02 14:33:08,501 - INFO - Avg. fwd time: 8.2101 / Avg. bwd time: 19.9477 / Avg. batch time: 663.0806 (ms) / GPU bubble ratio: 32.06%
[rank1]:2025-11-02 14:33:08,504 - INFO - Avg. fwd time: 8.1306 / Avg. bwd time: 20.5741 / Avg. batch time: 634.3290 (ms) / GPU bubble ratio: 27.60%
[rank2]:2025-11-02 14:33:08,616 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3091  memory: 43.55GiB(31.15%)  tps: 5,970  tflops: 278.45  mfu: 28.16%
[rank2]:2025-11-02 14:33:08,616 - INFO - ðŸ”Ž  Running validation at step 400
[rank3]:2025-11-02 14:33:08,620 - INFO -  step: 400  loss:  0.2728  grad_norm:  0.3091  memory: 51.83GiB(37.07%)  tps: 5,970  tflops: 278.46  mfu: 28.16%
[rank3]:2025-11-02 14:33:08,620 - INFO - ðŸ”Ž  Running validation at step 400
[rank1]:2025-11-02 14:33:08,619 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3091  memory: 53.47GiB(38.25%)  tps: 5,970  tflops: 278.45  mfu: 28.16%
[rank1]:2025-11-02 14:33:08,619 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 14:33:08,622 - INFO -  step: 400  loss: -4.0000  grad_norm:  0.3091  memory: 59.39GiB(42.48%)  tps: 5,970  tflops: 278.45  mfu: 28.16%
[rank0]:2025-11-02 14:33:08,622 - INFO - ðŸ”Ž  Running validation at step 400
[rank0]:2025-11-02 14:33:30,461 - INFO - validate step: 400  loss: -1.0000  memory: 59.39GiB(42.48%)  tps: 18,756
[rank1]:2025-11-02 14:33:30,468 - INFO - validate step: 400  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,747
[rank2]:2025-11-02 14:33:30,479 - INFO - validate step: 400  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,735
[rank3]:2025-11-02 14:33:30,481 - INFO - validate step: 400  loss:  0.2406  memory: 51.83GiB(37.07%)  tps: 18,738
[rank3]:2025-11-02 14:33:30,782 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1433_real_step400_rank3.svg
[rank3]:> Batch Time: 585.40 ms, GPU Bubble Ratio: 22.76%, 21.40%, 28.34%, 17.21%
[rank0]:2025-11-02 14:35:45,127 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:35:47,777 - INFO - Avg. fwd time: 7.6422 / Avg. bwd time: 22.5827 / Avg. batch time: 559.0084 (ms) / GPU bubble ratio: 13.49%
[rank2]:2025-11-02 14:35:47,806 - INFO - Avg. fwd time: 7.9198 / Avg. bwd time: 18.1996 / Avg. batch time: 592.3771 (ms) / GPU bubble ratio: 29.45%
[rank1]:2025-11-02 14:35:47,839 - INFO - Avg. fwd time: 8.1308 / Avg. bwd time: 20.5754 / Avg. batch time: 634.4866 (ms) / GPU bubble ratio: 27.61%
[rank0]:2025-11-02 14:35:47,868 - INFO - Avg. fwd time: 8.2080 / Avg. bwd time: 19.9514 / Avg. batch time: 663.2426 (ms) / GPU bubble ratio: 32.07%
[rank2]:2025-11-02 14:35:47,897 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3015  memory: 43.55GiB(31.15%)  tps: 5,961  tflops: 278.04  mfu: 28.11%
[rank1]:2025-11-02 14:35:47,900 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3015  memory: 53.47GiB(38.25%)  tps: 5,961  tflops: 278.01  mfu: 28.11%
[rank0]:2025-11-02 14:35:47,903 - INFO -  step: 450  loss: -4.0000  grad_norm:  0.3015  memory: 59.39GiB(42.48%)  tps: 5,960  tflops: 277.99  mfu: 28.11%
[rank3]:2025-11-02 14:35:47,901 - INFO -  step: 450  loss:  0.3034  grad_norm:  0.3015  memory: 51.83GiB(37.07%)  tps: 5,961  tflops: 278.04  mfu: 28.11%
[rank0]:2025-11-02 14:38:02,203 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:38:04,779 - INFO - Avg. fwd time: 7.6425 / Avg. bwd time: 22.5849 / Avg. batch time: 559.0160 (ms) / GPU bubble ratio: 13.48%
[rank2]:2025-11-02 14:38:04,800 - INFO - Avg. fwd time: 7.9192 / Avg. bwd time: 18.2010 / Avg. batch time: 592.3292 (ms) / GPU bubble ratio: 29.44%
[rank0]:2025-11-02 14:38:04,842 - INFO - Avg. fwd time: 8.2057 / Avg. bwd time: 19.9541 / Avg. batch time: 663.1887 (ms) / GPU bubble ratio: 32.06%
[rank1]:2025-11-02 14:38:04,846 - INFO - Avg. fwd time: 8.1300 / Avg. bwd time: 20.5756 / Avg. batch time: 634.4345 (ms) / GPU bubble ratio: 27.61%
[rank2]:2025-11-02 14:38:04,958 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2822  memory: 43.55GiB(31.15%)  tps: 5,977  tflops: 278.76  mfu: 28.19%
[rank0]:2025-11-02 14:38:04,964 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2822  memory: 59.39GiB(42.48%)  tps: 5,977  tflops: 278.76  mfu: 28.19%
[rank3]:2025-11-02 14:38:04,962 - INFO -  step: 500  loss:  0.2967  grad_norm:  0.2822  memory: 51.83GiB(37.07%)  tps: 5,977  tflops: 278.77  mfu: 28.19%
[rank1]:2025-11-02 14:38:04,961 - INFO -  step: 500  loss: -4.0000  grad_norm:  0.2822  memory: 53.47GiB(38.25%)  tps: 5,977  tflops: 278.76  mfu: 28.19%
[rank3]:2025-11-02 14:38:05,254 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1438_real_step500_rank3.svg
[rank3]:> Batch Time: 584.94 ms, GPU Bubble Ratio: 22.77%, 21.36%, 28.39%, 17.19%
[rank0]:2025-11-02 14:40:19,189 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:40:21,764 - INFO - Avg. fwd time: 7.9182 / Avg. bwd time: 18.2013 / Avg. batch time: 592.3598 (ms) / GPU bubble ratio: 29.45%
[rank0]:2025-11-02 14:40:21,807 - INFO - Avg. fwd time: 8.2034 / Avg. bwd time: 19.9563 / Avg. batch time: 663.2137 (ms) / GPU bubble ratio: 32.06%
[rank3]:2025-11-02 14:40:21,744 - INFO - Avg. fwd time: 7.6418 / Avg. bwd time: 22.5855 / Avg. batch time: 558.9814 (ms) / GPU bubble ratio: 13.48%
[rank1]:2025-11-02 14:40:21,812 - INFO - Avg. fwd time: 8.1290 / Avg. bwd time: 20.5756 / Avg. batch time: 634.4615 (ms) / GPU bubble ratio: 27.61%
[rank2]:2025-11-02 14:40:21,923 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2529  memory: 43.55GiB(31.15%)  tps: 5,981  tflops: 278.96  mfu: 28.21%
[rank0]:2025-11-02 14:40:21,929 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2529  memory: 59.39GiB(42.48%)  tps: 5,981  tflops: 278.96  mfu: 28.21%
[rank3]:2025-11-02 14:40:21,927 - INFO -  step: 550  loss:  0.1778  grad_norm:  0.2529  memory: 51.83GiB(37.07%)  tps: 5,981  tflops: 278.96  mfu: 28.21%
[rank1]:2025-11-02 14:40:21,926 - INFO -  step: 550  loss: -4.0000  grad_norm:  0.2529  memory: 53.47GiB(38.25%)  tps: 5,981  tflops: 278.96  mfu: 28.21%
[rank0]:2025-11-02 14:42:37,174 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:42:39,913 - INFO - Avg. fwd time: 7.9237 / Avg. bwd time: 18.2072 / Avg. batch time: 592.5989 (ms) / GPU bubble ratio: 29.45%
[rank3]:2025-11-02 14:42:39,884 - INFO - Avg. fwd time: 7.6482 / Avg. bwd time: 22.5960 / Avg. batch time: 559.2762 (ms) / GPU bubble ratio: 13.48%
[rank2]:2025-11-02 14:42:40,006 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6550  memory: 43.55GiB(31.15%)  tps: 5,933  tflops: 276.70  mfu: 27.98%
[rank2]:2025-11-02 14:42:40,006 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 14:42:39,947 - INFO - Avg. fwd time: 8.1349 / Avg. bwd time: 20.5819 / Avg. batch time: 634.7140 (ms) / GPU bubble ratio: 27.61%
[rank1]:2025-11-02 14:42:40,008 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6550  memory: 53.47GiB(38.25%)  tps: 5,933  tflops: 276.70  mfu: 27.98%
[rank1]:2025-11-02 14:42:40,009 - INFO - ðŸ”Ž  Running validation at step 600
[rank0]:2025-11-02 14:42:39,977 - INFO - Avg. fwd time: 8.2068 / Avg. bwd time: 19.9619 / Avg. batch time: 663.4768 (ms) / GPU bubble ratio: 32.07%
[rank0]:2025-11-02 14:42:40,012 - INFO -  step: 600  loss: -4.0000  grad_norm:  0.6550  memory: 59.39GiB(42.48%)  tps: 5,933  tflops: 276.70  mfu: 27.98%
[rank0]:2025-11-02 14:42:40,012 - INFO - ðŸ”Ž  Running validation at step 600
[rank3]:2025-11-02 14:42:40,010 - INFO -  step: 600  loss:  0.5243  grad_norm:  0.6550  memory: 51.83GiB(37.07%)  tps: 5,933  tflops: 276.70  mfu: 27.98%
[rank3]:2025-11-02 14:42:40,010 - INFO - ðŸ”Ž  Running validation at step 600
[rank1]:2025-11-02 14:43:01,753 - INFO - validate step: 600  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,837
[rank0]:2025-11-02 14:43:01,746 - INFO - validate step: 600  loss: -1.0000  memory: 59.39GiB(42.48%)  tps: 18,846
[rank2]:2025-11-02 14:43:01,761 - INFO - validate step: 600  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,828
[rank3]:2025-11-02 14:43:01,765 - INFO - validate step: 600  loss:  0.2540  memory: 51.83GiB(37.07%)  tps: 18,829
[rank3]:2025-11-02 14:43:02,057 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1443_real_step600_rank3.svg
[rank3]:> Batch Time: 592.07 ms, GPU Bubble Ratio: 23.08%, 21.48%, 28.58%, 17.09%
[rank0]:2025-11-02 14:45:18,557 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:45:21,162 - INFO - Avg. fwd time: 7.6601 / Avg. bwd time: 22.6125 / Avg. batch time: 559.8006 (ms) / GPU bubble ratio: 13.48%
[rank2]:2025-11-02 14:45:21,183 - INFO - Avg. fwd time: 7.9344 / Avg. bwd time: 18.2154 / Avg. batch time: 593.1775 (ms) / GPU bubble ratio: 29.47%
[rank1]:2025-11-02 14:45:21,230 - INFO - Avg. fwd time: 8.1464 / Avg. bwd time: 20.5917 / Avg. batch time: 635.3157 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 14:45:21,229 - INFO - Avg. fwd time: 8.2150 / Avg. bwd time: 19.9701 / Avg. batch time: 664.0988 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 14:45:21,340 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4604  memory: 43.55GiB(31.15%)  tps: 5,869  tflops: 273.73  mfu: 27.68%
[rank1]:2025-11-02 14:45:21,343 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4604  memory: 53.47GiB(38.25%)  tps: 5,869  tflops: 273.72  mfu: 27.68%
[rank0]:2025-11-02 14:45:21,347 - INFO -  step: 650  loss: -4.0000  grad_norm:  0.4604  memory: 59.39GiB(42.48%)  tps: 5,868  tflops: 273.69  mfu: 27.67%
[rank3]:2025-11-02 14:45:21,344 - INFO -  step: 650  loss:  0.3253  grad_norm:  0.4604  memory: 51.83GiB(37.07%)  tps: 5,869  tflops: 273.74  mfu: 27.68%
[rank0]:2025-11-02 14:47:37,917 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:47:40,566 - INFO - Avg. fwd time: 7.9433 / Avg. bwd time: 18.2231 / Avg. batch time: 593.5616 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 14:47:40,546 - INFO - Avg. fwd time: 7.6697 / Avg. bwd time: 22.6268 / Avg. batch time: 560.2358 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 14:47:40,613 - INFO - Avg. fwd time: 8.1557 / Avg. bwd time: 20.5999 / Avg. batch time: 635.7216 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 14:47:40,609 - INFO - Avg. fwd time: 8.2217 / Avg. bwd time: 19.9769 / Avg. batch time: 664.5259 (ms) / GPU bubble ratio: 32.11%
[rank2]:2025-11-02 14:47:40,724 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4674  memory: 43.55GiB(31.15%)  tps: 5,877  tflops: 274.12  mfu: 27.72%
[rank1]:2025-11-02 14:47:40,727 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4674  memory: 53.47GiB(38.25%)  tps: 5,877  tflops: 274.12  mfu: 27.72%
[rank0]:2025-11-02 14:47:40,730 - INFO -  step: 700  loss: -4.0000  grad_norm:  0.4674  memory: 59.39GiB(42.48%)  tps: 5,877  tflops: 274.12  mfu: 27.72%
[rank3]:2025-11-02 14:47:40,728 - INFO -  step: 700  loss:  0.4243  grad_norm:  0.4674  memory: 51.83GiB(37.07%)  tps: 5,877  tflops: 274.12  mfu: 27.72%
[rank3]:2025-11-02 14:47:41,027 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1447_real_step700_rank3.svg
[rank3]:> Batch Time: 593.17 ms, GPU Bubble Ratio: 23.09%, 21.54%, 28.50%, 17.10%
[rank0]:2025-11-02 14:49:56,807 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:49:59,514 - INFO - Avg. fwd time: 7.9488 / Avg. bwd time: 18.2283 / Avg. batch time: 593.8758 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 14:49:59,484 - INFO - Avg. fwd time: 7.6754 / Avg. bwd time: 22.6355 / Avg. batch time: 560.5008 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 14:49:59,610 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2977  memory: 43.55GiB(31.15%)  tps: 5,898  tflops: 275.10  mfu: 27.82%
[rank0]:2025-11-02 14:49:59,581 - INFO - Avg. fwd time: 8.2260 / Avg. bwd time: 19.9817 / Avg. batch time: 664.8666 (ms) / GPU bubble ratio: 32.12%
[rank0]:2025-11-02 14:49:59,616 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2977  memory: 59.39GiB(42.48%)  tps: 5,898  tflops: 275.10  mfu: 27.82%
[rank1]:2025-11-02 14:49:59,549 - INFO - Avg. fwd time: 8.1617 / Avg. bwd time: 20.6053 / Avg. batch time: 636.0481 (ms) / GPU bubble ratio: 27.64%
[rank3]:2025-11-02 14:49:59,614 - INFO -  step: 750  loss:  0.1846  grad_norm:  0.2977  memory: 51.83GiB(37.07%)  tps: 5,898  tflops: 275.10  mfu: 27.82%
[rank1]:2025-11-02 14:49:59,612 - INFO -  step: 750  loss: -4.0000  grad_norm:  0.2977  memory: 53.47GiB(38.25%)  tps: 5,898  tflops: 275.10  mfu: 27.82%
[rank0]:2025-11-02 14:52:14,286 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 14:52:16,940 - INFO - Avg. fwd time: 7.9490 / Avg. bwd time: 18.2298 / Avg. batch time: 593.8354 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 14:52:16,918 - INFO - Avg. fwd time: 7.6750 / Avg. bwd time: 22.6359 / Avg. batch time: 560.4903 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 14:52:16,987 - INFO - Avg. fwd time: 8.1617 / Avg. bwd time: 20.6066 / Avg. batch time: 636.0089 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 14:52:16,982 - INFO - Avg. fwd time: 8.2259 / Avg. bwd time: 19.9829 / Avg. batch time: 664.8312 (ms) / GPU bubble ratio: 32.11%
[rank2]:2025-11-02 14:52:17,096 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4683  memory: 43.55GiB(31.15%)  tps: 5,958  tflops: 277.90  mfu: 28.10%
[rank2]:2025-11-02 14:52:17,096 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 14:52:17,099 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4683  memory: 53.47GiB(38.25%)  tps: 5,958  tflops: 277.90  mfu: 28.10%
[rank1]:2025-11-02 14:52:17,099 - INFO - ðŸ”Ž  Running validation at step 800
[rank0]:2025-11-02 14:52:17,102 - INFO -  step: 800  loss: -4.0000  grad_norm:  0.4683  memory: 59.39GiB(42.48%)  tps: 5,958  tflops: 277.90  mfu: 28.10%
[rank0]:2025-11-02 14:52:17,102 - INFO - ðŸ”Ž  Running validation at step 800
[rank3]:2025-11-02 14:52:17,100 - INFO -  step: 800  loss:  0.3589  grad_norm:  0.4683  memory: 51.83GiB(37.07%)  tps: 5,958  tflops: 277.90  mfu: 28.10%
[rank3]:2025-11-02 14:52:17,100 - INFO - ðŸ”Ž  Running validation at step 800
[rank1]:2025-11-02 14:52:39,037 - INFO - validate step: 800  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,671
[rank3]:2025-11-02 14:52:39,049 - INFO - validate step: 800  loss:  0.2657  memory: 51.83GiB(37.07%)  tps: 18,663
[rank0]:2025-11-02 14:52:39,031 - INFO - validate step: 800  loss: -1.0000  memory: 59.39GiB(42.48%)  tps: 18,679
[rank2]:2025-11-02 14:52:39,046 - INFO - validate step: 800  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,661
[rank3]:2025-11-02 14:52:39,344 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1452_real_step800_rank3.svg
[rank3]:> Batch Time: 585.23 ms, GPU Bubble Ratio: 22.66%, 21.28%, 28.27%, 17.22%
[rank0]:2025-11-02 14:54:54,454 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 14:54:57,026 - INFO - Avg. fwd time: 7.6775 / Avg. bwd time: 22.6398 / Avg. batch time: 560.6047 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 14:54:57,047 - INFO - Avg. fwd time: 7.9518 / Avg. bwd time: 18.2324 / Avg. batch time: 593.9899 (ms) / GPU bubble ratio: 29.47%
[rank0]:2025-11-02 14:54:57,090 - INFO - Avg. fwd time: 8.2277 / Avg. bwd time: 19.9847 / Avg. batch time: 664.9991 (ms) / GPU bubble ratio: 32.12%
[rank1]:2025-11-02 14:54:57,093 - INFO - Avg. fwd time: 8.1644 / Avg. bwd time: 20.6088 / Avg. batch time: 636.1688 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 14:54:57,208 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2806  memory: 59.39GiB(42.48%)  tps: 5,929  tflops: 276.51  mfu: 27.96%
[rank3]:2025-11-02 14:54:57,206 - INFO -  step: 850  loss:  0.1340  grad_norm:  0.2806  memory: 51.83GiB(37.07%)  tps: 5,930  tflops: 276.55  mfu: 27.96%
[rank1]:2025-11-02 14:54:57,205 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2806  memory: 53.47GiB(38.25%)  tps: 5,929  tflops: 276.53  mfu: 27.96%
[rank2]:2025-11-02 14:54:57,202 - INFO -  step: 850  loss: -4.0000  grad_norm:  0.2806  memory: 43.55GiB(31.15%)  tps: 5,930  tflops: 276.55  mfu: 27.96%
[rank0]:2025-11-02 14:57:10,685 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:57:13,358 - INFO - Avg. fwd time: 7.6741 / Avg. bwd time: 22.6347 / Avg. batch time: 560.4381 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 14:57:13,389 - INFO - Avg. fwd time: 7.9491 / Avg. bwd time: 18.2307 / Avg. batch time: 593.7930 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 14:57:13,425 - INFO - Avg. fwd time: 8.1609 / Avg. bwd time: 20.6057 / Avg. batch time: 635.9630 (ms) / GPU bubble ratio: 27.63%
[rank1]:2025-11-02 14:57:13,490 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2825  memory: 53.47GiB(38.25%)  tps: 6,011  tflops: 280.35  mfu: 28.35%
[rank3]:2025-11-02 14:57:13,492 - INFO -  step: 900  loss:  0.2137  grad_norm:  0.2825  memory: 51.83GiB(37.07%)  tps: 6,011  tflops: 280.35  mfu: 28.35%
[rank0]:2025-11-02 14:57:13,459 - INFO - Avg. fwd time: 8.2248 / Avg. bwd time: 19.9829 / Avg. batch time: 664.7903 (ms) / GPU bubble ratio: 32.11%
[rank0]:2025-11-02 14:57:13,494 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2825  memory: 59.39GiB(42.48%)  tps: 6,011  tflops: 280.35  mfu: 28.35%
[rank2]:2025-11-02 14:57:13,487 - INFO -  step: 900  loss: -4.0000  grad_norm:  0.2825  memory: 43.55GiB(31.15%)  tps: 6,011  tflops: 280.35  mfu: 28.35%
[rank3]:2025-11-02 14:57:13,794 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1457_real_step900_rank3.svg
[rank3]:> Batch Time: 586.33 ms, GPU Bubble Ratio: 22.76%, 21.36%, 28.33%, 17.16%
[rank0]:2025-11-02 14:59:28,474 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 14:59:31,075 - INFO - Avg. fwd time: 7.6749 / Avg. bwd time: 22.6366 / Avg. batch time: 560.4802 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 14:59:31,096 - INFO - Avg. fwd time: 7.9496 / Avg. bwd time: 18.2318 / Avg. batch time: 593.8763 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 14:59:31,145 - INFO - Avg. fwd time: 8.1619 / Avg. bwd time: 20.6069 / Avg. batch time: 636.0456 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 14:59:31,139 - INFO - Avg. fwd time: 8.2251 / Avg. bwd time: 19.9840 / Avg. batch time: 664.8737 (ms) / GPU bubble ratio: 32.12%
[rank1]:2025-11-02 14:59:31,255 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6537  memory: 53.47GiB(38.25%)  tps: 5,946  tflops: 277.34  mfu: 28.04%
[rank0]:2025-11-02 14:59:31,259 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6537  memory: 59.39GiB(42.48%)  tps: 5,946  tflops: 277.34  mfu: 28.04%
[rank3]:2025-11-02 14:59:31,257 - INFO -  step: 950  loss:  0.3495  grad_norm:  0.6537  memory: 51.83GiB(37.07%)  tps: 5,946  tflops: 277.34  mfu: 28.04%
[rank2]:2025-11-02 14:59:31,252 - INFO -  step: 950  loss: -4.0000  grad_norm:  0.6537  memory: 43.55GiB(31.15%)  tps: 5,946  tflops: 277.34  mfu: 28.04%
[rank0]:2025-11-02 15:01:46,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2025-11-02 15:01:49,015 - INFO - Avg. fwd time: 8.1646 / Avg. bwd time: 20.6098 / Avg. batch time: 636.1396 (ms) / GPU bubble ratio: 27.63%
[rank3]:2025-11-02 15:01:48,945 - INFO - Avg. fwd time: 7.6776 / Avg. bwd time: 22.6407 / Avg. batch time: 560.6035 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-02 15:01:49,008 - INFO - Avg. fwd time: 8.2270 / Avg. bwd time: 19.9865 / Avg. batch time: 664.9704 (ms) / GPU bubble ratio: 32.11%
[rank2]:2025-11-02 15:01:48,966 - INFO - Avg. fwd time: 7.9524 / Avg. bwd time: 18.2347 / Avg. batch time: 593.9659 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 15:01:49,124 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2155  memory: 53.47GiB(38.25%)  tps: 5,942  tflops: 277.13  mfu: 28.02%
[rank1]:2025-11-02 15:01:49,124 - INFO - ðŸ”Ž  Running validation at step 1000
[rank3]:2025-11-02 15:01:49,125 - INFO -  step: 1000  loss:  0.1711  grad_norm:  0.2155  memory: 51.83GiB(37.07%)  tps: 5,942  tflops: 277.13  mfu: 28.02%
[rank3]:2025-11-02 15:01:49,126 - INFO - ðŸ”Ž  Running validation at step 1000
[rank0]:2025-11-02 15:01:49,128 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2155  memory: 59.39GiB(42.48%)  tps: 5,942  tflops: 277.13  mfu: 28.02%
[rank0]:2025-11-02 15:01:49,128 - INFO - ðŸ”Ž  Running validation at step 1000
[rank2]:2025-11-02 15:01:49,121 - INFO -  step: 1000  loss: -4.0000  grad_norm:  0.2155  memory: 43.55GiB(31.15%)  tps: 5,942  tflops: 277.13  mfu: 28.02%
[rank2]:2025-11-02 15:01:49,121 - INFO - ðŸ”Ž  Running validation at step 1000
[rank1]:2025-11-02 15:02:10,877 - INFO - validate step: 1000  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,830
[rank3]:2025-11-02 15:02:10,888 - INFO - validate step: 1000  loss:  0.2693  memory: 51.83GiB(37.07%)  tps: 18,823
[rank0]:2025-11-02 15:02:10,870 - INFO - validate step: 1000  loss: -1.0000  memory: 59.39GiB(42.48%)  tps: 18,840
[rank2]:2025-11-02 15:02:10,888 - INFO - validate step: 1000  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,818
[rank3]:2025-11-02 15:02:11,187 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1502_real_step1000_rank3.svg
[rank3]:> Batch Time: 588.38 ms, GPU Bubble Ratio: 22.83%, 21.35%, 28.36%, 17.14%
[rank0]:2025-11-02 15:04:25,303 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:04:28,015 - INFO - Avg. fwd time: 7.6761 / Avg. bwd time: 22.6392 / Avg. batch time: 560.5354 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:04:28,048 - INFO - Avg. fwd time: 7.9509 / Avg. bwd time: 18.2342 / Avg. batch time: 593.9323 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 15:04:28,084 - INFO - Avg. fwd time: 8.1629 / Avg. bwd time: 20.6084 / Avg. batch time: 636.1006 (ms) / GPU bubble ratio: 27.63%
[rank1]:2025-11-02 15:04:28,150 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5721  memory: 53.47GiB(38.25%)  tps: 5,968  tflops: 278.33  mfu: 28.14%
[rank3]:2025-11-02 15:04:28,152 - INFO -  step: 1050  loss:  0.2945  grad_norm:  0.5721  memory: 51.83GiB(37.07%)  tps: 5,968  tflops: 278.35  mfu: 28.14%
[rank0]:2025-11-02 15:04:28,119 - INFO - Avg. fwd time: 8.2256 / Avg. bwd time: 19.9859 / Avg. batch time: 664.9295 (ms) / GPU bubble ratio: 32.12%
[rank0]:2025-11-02 15:04:28,154 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5721  memory: 59.39GiB(42.48%)  tps: 5,967  tflops: 278.31  mfu: 28.14%
[rank2]:2025-11-02 15:04:28,148 - INFO -  step: 1050  loss: -4.0000  grad_norm:  0.5721  memory: 43.55GiB(31.15%)  tps: 5,968  tflops: 278.36  mfu: 28.15%
[rank0]:2025-11-02 15:06:44,835 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:06:47,426 - INFO - Avg. fwd time: 7.6823 / Avg. bwd time: 22.6477 / Avg. batch time: 560.8109 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:06:47,447 - INFO - Avg. fwd time: 7.9564 / Avg. bwd time: 18.2384 / Avg. batch time: 594.1781 (ms) / GPU bubble ratio: 29.46%
[rank1]:2025-11-02 15:06:47,493 - INFO - Avg. fwd time: 8.1688 / Avg. bwd time: 20.6132 / Avg. batch time: 636.3571 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 15:06:47,489 - INFO - Avg. fwd time: 8.2301 / Avg. bwd time: 19.9897 / Avg. batch time: 665.1948 (ms) / GPU bubble ratio: 32.12%
[rank2]:2025-11-02 15:06:47,601 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3261  memory: 43.55GiB(31.15%)  tps: 5,874  tflops: 273.98  mfu: 27.70%
[rank1]:2025-11-02 15:06:47,604 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3261  memory: 53.47GiB(38.25%)  tps: 5,874  tflops: 273.98  mfu: 27.70%
[rank3]:2025-11-02 15:06:47,606 - INFO -  step: 1100  loss:  0.2933  grad_norm:  0.3261  memory: 51.83GiB(37.07%)  tps: 5,874  tflops: 273.98  mfu: 27.70%
[rank0]:2025-11-02 15:06:47,608 - INFO -  step: 1100  loss: -4.0000  grad_norm:  0.3261  memory: 59.39GiB(42.48%)  tps: 5,874  tflops: 273.98  mfu: 27.70%
[rank3]:2025-11-02 15:06:47,900 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1506_real_step1100_rank3.svg
[rank3]:> Batch Time: 593.38 ms, GPU Bubble Ratio: 23.11%, 21.51%, 28.57%, 17.11%
[rank0]:2025-11-02 15:09:02,909 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:09:05,526 - INFO - Avg. fwd time: 7.9576 / Avg. bwd time: 18.2396 / Avg. batch time: 594.2553 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 15:09:05,506 - INFO - Avg. fwd time: 7.6834 / Avg. bwd time: 22.6490 / Avg. batch time: 560.8568 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:09:05,573 - INFO - Avg. fwd time: 8.1701 / Avg. bwd time: 20.6144 / Avg. batch time: 636.4360 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:09:05,570 - INFO - Avg. fwd time: 8.2309 / Avg. bwd time: 19.9906 / Avg. batch time: 665.2742 (ms) / GPU bubble ratio: 32.13%
[rank3]:2025-11-02 15:09:05,685 - INFO -  step: 1150  loss:  0.2763  grad_norm:  0.5868  memory: 51.83GiB(37.07%)  tps: 5,933  tflops: 276.71  mfu: 27.98%
[rank1]:2025-11-02 15:09:05,683 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5868  memory: 53.47GiB(38.25%)  tps: 5,933  tflops: 276.71  mfu: 27.98%
[rank0]:2025-11-02 15:09:05,687 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5868  memory: 59.39GiB(42.48%)  tps: 5,933  tflops: 276.71  mfu: 27.98%
[rank2]:2025-11-02 15:09:05,680 - INFO -  step: 1150  loss: -4.0000  grad_norm:  0.5868  memory: 43.55GiB(31.15%)  tps: 5,933  tflops: 276.71  mfu: 27.98%
[rank0]:2025-11-02 15:11:20,671 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:11:23,363 - INFO - Avg. fwd time: 7.6845 / Avg. bwd time: 22.6502 / Avg. batch time: 560.8988 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:11:23,396 - INFO - Avg. fwd time: 7.9589 / Avg. bwd time: 18.2410 / Avg. batch time: 594.2759 (ms) / GPU bubble ratio: 29.46%
[rank0]:2025-11-02 15:11:23,468 - INFO - Avg. fwd time: 8.2319 / Avg. bwd time: 19.9920 / Avg. batch time: 665.3014 (ms) / GPU bubble ratio: 32.12%
[rank0]:2025-11-02 15:11:23,504 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3265  memory: 59.51GiB(42.56%)  tps: 5,944  tflops: 277.24  mfu: 28.03%
[rank3]:2025-11-02 15:11:23,502 - INFO -  step: 1200  loss:  0.3155  grad_norm:  0.3265  memory: 51.83GiB(37.07%)  tps: 5,944  tflops: 277.24  mfu: 28.03%
[rank1]:2025-11-02 15:11:23,433 - INFO - Avg. fwd time: 8.1717 / Avg. bwd time: 20.6160 / Avg. batch time: 636.4609 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 15:11:23,504 - INFO - ðŸ”Ž  Running validation at step 1200
[rank1]:2025-11-02 15:11:23,500 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3265  memory: 53.47GiB(38.25%)  tps: 5,944  tflops: 277.24  mfu: 28.03%
[rank1]:2025-11-02 15:11:23,500 - INFO - ðŸ”Ž  Running validation at step 1200
[rank3]:2025-11-02 15:11:23,502 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 15:11:23,497 - INFO -  step: 1200  loss: -4.0000  grad_norm:  0.3265  memory: 43.55GiB(31.15%)  tps: 5,944  tflops: 277.24  mfu: 28.03%
[rank2]:2025-11-02 15:11:23,497 - INFO - ðŸ”Ž  Running validation at step 1200
[rank2]:2025-11-02 15:11:45,279 - INFO - validate step: 1200  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,805
[rank2]:2025-11-02 15:11:45,279 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 15:11:45,271 - INFO - validate step: 1200  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,814
[rank1]:2025-11-02 15:11:45,271 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 15:11:45,283 - INFO - validate step: 1200  loss:  0.2687  memory: 51.83GiB(37.07%)  tps: 18,806
[rank3]:2025-11-02 15:11:45,283 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 15:11:45,265 - INFO - validate step: 1200  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,823
[rank0]:2025-11-02 15:11:45,265 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 15:11:45,269 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 15:11:56,170 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 10.89 seconds.
[rank1]:2025-11-02 15:11:58,362 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.09 seconds.
[rank3]:2025-11-02 15:11:58,518 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 13.23 seconds.
[rank0]:2025-11-02 15:12:02,166 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 15:12:02,172 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.91 seconds.
[rank3]:2025-11-02 15:12:02,586 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1511_real_step1200_rank3.svg
[rank3]:> Batch Time: 587.89 ms, GPU Bubble Ratio: 22.84%, 21.29%, 28.28%, 17.21%
[rank0]:2025-11-02 15:14:19,819 - INFO - [GC] Peforming periodical GC collection 2.32 seconds
[rank2]:2025-11-02 15:14:22,428 - INFO - Avg. fwd time: 7.9586 / Avg. bwd time: 18.2407 / Avg. batch time: 594.3664 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 15:14:22,408 - INFO - Avg. fwd time: 7.6838 / Avg. bwd time: 22.6535 / Avg. batch time: 560.9407 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:14:22,474 - INFO - Avg. fwd time: 8.1716 / Avg. bwd time: 20.6162 / Avg. batch time: 636.5523 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:14:22,471 - INFO - Avg. fwd time: 8.2322 / Avg. bwd time: 19.9914 / Avg. batch time: 665.3931 (ms) / GPU bubble ratio: 32.13%
[rank3]:2025-11-02 15:14:22,585 - INFO -  step: 1250  loss:  0.3427  grad_norm:  0.4852  memory: 51.85GiB(37.08%)  tps: 5,208  tflops: 242.89  mfu: 24.56%
[rank1]:2025-11-02 15:14:22,583 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4852  memory: 53.47GiB(38.25%)  tps: 5,207  tflops: 242.88  mfu: 24.56%
[rank2]:2025-11-02 15:14:22,581 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4852  memory: 43.55GiB(31.15%)  tps: 5,208  tflops: 242.89  mfu: 24.56%
[rank0]:2025-11-02 15:14:22,587 - INFO -  step: 1250  loss: -4.0000  grad_norm:  0.4852  memory: 59.51GiB(42.56%)  tps: 5,207  tflops: 242.86  mfu: 24.56%
[rank0]:2025-11-02 15:16:37,430 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:16:40,030 - INFO - Avg. fwd time: 7.9595 / Avg. bwd time: 18.2412 / Avg. batch time: 594.3715 (ms) / GPU bubble ratio: 29.47%
[rank3]:2025-11-02 15:16:40,010 - INFO - Avg. fwd time: 7.6846 / Avg. bwd time: 22.6547 / Avg. batch time: 560.9775 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:16:40,077 - INFO - Avg. fwd time: 8.1725 / Avg. bwd time: 20.6165 / Avg. batch time: 636.5598 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:16:40,073 - INFO - Avg. fwd time: 8.2327 / Avg. bwd time: 19.9923 / Avg. batch time: 665.4009 (ms) / GPU bubble ratio: 32.13%
[rank1]:2025-11-02 15:16:40,185 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2057  memory: 53.47GiB(38.25%)  tps: 5,953  tflops: 277.67  mfu: 28.08%
[rank3]:2025-11-02 15:16:40,187 - INFO -  step: 1300  loss:  0.1955  grad_norm:  0.2057  memory: 51.85GiB(37.08%)  tps: 5,953  tflops: 277.67  mfu: 28.08%
[rank0]:2025-11-02 15:16:40,189 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2057  memory: 59.51GiB(42.56%)  tps: 5,953  tflops: 277.67  mfu: 28.08%
[rank2]:2025-11-02 15:16:40,183 - INFO -  step: 1300  loss: -4.0000  grad_norm:  0.2057  memory: 43.55GiB(31.15%)  tps: 5,953  tflops: 277.67  mfu: 28.08%
[rank3]:2025-11-02 15:16:40,484 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1516_real_step1300_rank3.svg
[rank3]:> Batch Time: 584.36 ms, GPU Bubble Ratio: 22.74%, 21.34%, 28.34%, 17.20%
[rank0]:2025-11-02 15:18:56,322 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:18:58,996 - INFO - Avg. fwd time: 7.6876 / Avg. bwd time: 22.6589 / Avg. batch time: 561.1117 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:18:59,030 - INFO - Avg. fwd time: 7.9622 / Avg. bwd time: 18.2437 / Avg. batch time: 594.5322 (ms) / GPU bubble ratio: 29.47%
[rank1]:2025-11-02 15:18:59,068 - INFO - Avg. fwd time: 8.1756 / Avg. bwd time: 20.6194 / Avg. batch time: 636.7276 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:18:59,104 - INFO - Avg. fwd time: 8.2348 / Avg. bwd time: 19.9944 / Avg. batch time: 665.5745 (ms) / GPU bubble ratio: 32.14%
[rank2]:2025-11-02 15:18:59,133 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3085  memory: 43.55GiB(31.15%)  tps: 5,896  tflops: 274.97  mfu: 27.80%
[rank3]:2025-11-02 15:18:59,137 - INFO -  step: 1350  loss:  0.1352  grad_norm:  0.3085  memory: 51.85GiB(37.08%)  tps: 5,896  tflops: 274.98  mfu: 27.80%
[rank1]:2025-11-02 15:18:59,135 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3085  memory: 53.47GiB(38.25%)  tps: 5,896  tflops: 274.97  mfu: 27.80%
[rank0]:2025-11-02 15:18:59,139 - INFO -  step: 1350  loss: -4.0000  grad_norm:  0.3085  memory: 59.51GiB(42.56%)  tps: 5,896  tflops: 274.97  mfu: 27.80%
[rank0]:2025-11-02 15:21:13,873 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:21:16,496 - INFO - Avg. fwd time: 7.6874 / Avg. bwd time: 22.6589 / Avg. batch time: 561.1056 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:21:16,516 - INFO - Avg. fwd time: 7.9622 / Avg. bwd time: 18.2440 / Avg. batch time: 594.5043 (ms) / GPU bubble ratio: 29.47%
[rank1]:2025-11-02 15:21:16,564 - INFO - Avg. fwd time: 8.1754 / Avg. bwd time: 20.6196 / Avg. batch time: 636.7006 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:21:16,559 - INFO - Avg. fwd time: 8.2344 / Avg. bwd time: 19.9948 / Avg. batch time: 665.5465 (ms) / GPU bubble ratio: 32.14%
[rank2]:2025-11-02 15:21:16,670 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3111  memory: 43.55GiB(31.15%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank2]:2025-11-02 15:21:16,670 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 15:21:16,673 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3111  memory: 53.47GiB(38.25%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank1]:2025-11-02 15:21:16,673 - INFO - ðŸ”Ž  Running validation at step 1400
[rank3]:2025-11-02 15:21:16,675 - INFO -  step: 1400  loss:  0.4205  grad_norm:  0.3111  memory: 51.85GiB(37.08%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank3]:2025-11-02 15:21:16,675 - INFO - ðŸ”Ž  Running validation at step 1400
[rank0]:2025-11-02 15:21:16,677 - INFO -  step: 1400  loss: -4.0000  grad_norm:  0.3111  memory: 59.51GiB(42.56%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank0]:2025-11-02 15:21:16,677 - INFO - ðŸ”Ž  Running validation at step 1400
[rank1]:2025-11-02 15:21:38,543 - INFO - validate step: 1400  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,729
[rank0]:2025-11-02 15:21:38,540 - INFO - validate step: 1400  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,735
[rank3]:2025-11-02 15:21:38,556 - INFO - validate step: 1400  loss:  0.2666  memory: 51.85GiB(37.08%)  tps: 18,720
[rank2]:2025-11-02 15:21:38,551 - INFO - validate step: 1400  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,720
[rank3]:2025-11-02 15:21:38,853 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1521_real_step1400_rank3.svg
[rank3]:> Batch Time: 589.15 ms, GPU Bubble Ratio: 22.91%, 21.47%, 28.47%, 17.12%
[rank0]:2025-11-02 15:23:55,353 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:23:57,935 - INFO - Avg. fwd time: 7.6918 / Avg. bwd time: 22.6650 / Avg. batch time: 561.3027 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:23:57,954 - INFO - Avg. fwd time: 7.9660 / Avg. bwd time: 18.2469 / Avg. batch time: 594.7215 (ms) / GPU bubble ratio: 29.48%
[rank0]:2025-11-02 15:23:57,997 - INFO - Avg. fwd time: 8.2377 / Avg. bwd time: 19.9974 / Avg. batch time: 665.7780 (ms) / GPU bubble ratio: 32.15%
[rank1]:2025-11-02 15:23:58,002 - INFO - Avg. fwd time: 8.1800 / Avg. bwd time: 20.6236 / Avg. batch time: 636.9259 (ms) / GPU bubble ratio: 27.64%
[rank2]:2025-11-02 15:23:58,107 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3212  memory: 43.55GiB(31.15%)  tps: 5,870  tflops: 273.78  mfu: 27.68%
[rank0]:2025-11-02 15:23:58,113 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3212  memory: 59.51GiB(42.56%)  tps: 5,869  tflops: 273.75  mfu: 27.68%
[rank1]:2025-11-02 15:23:58,109 - INFO -  step: 1450  loss: -4.0000  grad_norm:  0.3212  memory: 53.47GiB(38.25%)  tps: 5,870  tflops: 273.76  mfu: 27.68%
[rank3]:2025-11-02 15:23:58,111 - INFO -  step: 1450  loss:  0.2467  grad_norm:  0.3212  memory: 51.85GiB(37.08%)  tps: 5,870  tflops: 273.79  mfu: 27.68%
[rank0]:2025-11-02 15:26:14,962 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:26:17,739 - INFO - Avg. fwd time: 7.9702 / Avg. bwd time: 18.2502 / Avg. batch time: 594.9096 (ms) / GPU bubble ratio: 29.48%
[rank1]:2025-11-02 15:26:17,779 - INFO - Avg. fwd time: 8.1846 / Avg. bwd time: 20.6274 / Avg. batch time: 637.1243 (ms) / GPU bubble ratio: 27.64%
[rank3]:2025-11-02 15:26:17,704 - INFO - Avg. fwd time: 7.6967 / Avg. bwd time: 22.6714 / Avg. batch time: 561.5144 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:26:17,844 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3770  memory: 43.55GiB(31.15%)  tps: 5,862  tflops: 273.42  mfu: 27.65%
[rank1]:2025-11-02 15:26:17,847 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3770  memory: 53.47GiB(38.25%)  tps: 5,862  tflops: 273.42  mfu: 27.65%
[rank3]:2025-11-02 15:26:17,849 - INFO -  step: 1500  loss:  0.2912  grad_norm:  0.3770  memory: 51.85GiB(37.08%)  tps: 5,862  tflops: 273.43  mfu: 27.65%
[rank0]:2025-11-02 15:26:17,815 - INFO - Avg. fwd time: 8.2413 / Avg. bwd time: 20.0003 / Avg. batch time: 665.9842 (ms) / GPU bubble ratio: 32.15%
[rank0]:2025-11-02 15:26:17,851 - INFO -  step: 1500  loss: -4.0000  grad_norm:  0.3770  memory: 59.51GiB(42.56%)  tps: 5,862  tflops: 273.42  mfu: 27.65%
[rank3]:2025-11-02 15:26:18,140 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1526_real_step1500_rank3.svg
[rank3]:> Batch Time: 595.02 ms, GPU Bubble Ratio: 23.19%, 21.50%, 28.55%, 17.05%
[rank0]:2025-11-02 15:28:34,916 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:28:37,552 - INFO - Avg. fwd time: 7.7010 / Avg. bwd time: 22.6772 / Avg. batch time: 561.7028 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:28:37,571 - INFO - Avg. fwd time: 7.9741 / Avg. bwd time: 18.2532 / Avg. batch time: 595.1199 (ms) / GPU bubble ratio: 29.49%
[rank0]:2025-11-02 15:28:37,614 - INFO - Avg. fwd time: 8.2445 / Avg. bwd time: 20.0029 / Avg. batch time: 666.2074 (ms) / GPU bubble ratio: 32.16%
[rank1]:2025-11-02 15:28:37,619 - INFO - Avg. fwd time: 8.1888 / Avg. bwd time: 20.6312 / Avg. batch time: 637.3423 (ms) / GPU bubble ratio: 27.65%
[rank2]:2025-11-02 15:28:37,724 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4368  memory: 43.55GiB(31.15%)  tps: 5,856  tflops: 273.15  mfu: 27.62%
[rank0]:2025-11-02 15:28:37,730 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4368  memory: 59.51GiB(42.56%)  tps: 5,856  tflops: 273.15  mfu: 27.62%
[rank1]:2025-11-02 15:28:37,726 - INFO -  step: 1550  loss: -4.0000  grad_norm:  0.4368  memory: 53.47GiB(38.25%)  tps: 5,856  tflops: 273.15  mfu: 27.62%
[rank3]:2025-11-02 15:28:37,728 - INFO -  step: 1550  loss:  0.3535  grad_norm:  0.4368  memory: 51.85GiB(37.08%)  tps: 5,857  tflops: 273.15  mfu: 27.62%
[rank0]:2025-11-02 15:30:53,794 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:30:56,464 - INFO - Avg. fwd time: 7.9761 / Avg. bwd time: 18.2548 / Avg. batch time: 595.1961 (ms) / GPU bubble ratio: 29.49%
[rank0]:2025-11-02 15:30:56,506 - INFO - Avg. fwd time: 8.2461 / Avg. bwd time: 20.0045 / Avg. batch time: 666.2900 (ms) / GPU bubble ratio: 32.16%
[rank3]:2025-11-02 15:30:56,445 - INFO - Avg. fwd time: 7.7032 / Avg. bwd time: 22.6805 / Avg. batch time: 561.8036 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:30:56,510 - INFO - Avg. fwd time: 8.1910 / Avg. bwd time: 20.6334 / Avg. batch time: 637.4222 (ms) / GPU bubble ratio: 27.65%
[rank3]:2025-11-02 15:30:56,619 - INFO -  step: 1600  loss:  0.5374  grad_norm:  0.7614  memory: 51.85GiB(37.08%)  tps: 5,898  tflops: 275.09  mfu: 27.82%
[rank3]:2025-11-02 15:30:56,620 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 15:30:56,615 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.7614  memory: 43.55GiB(31.15%)  tps: 5,898  tflops: 275.09  mfu: 27.82%
[rank2]:2025-11-02 15:30:56,615 - INFO - ðŸ”Ž  Running validation at step 1600
[rank1]:2025-11-02 15:30:56,618 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.7614  memory: 53.47GiB(38.25%)  tps: 5,898  tflops: 275.09  mfu: 27.81%
[rank1]:2025-11-02 15:30:56,618 - INFO - ðŸ”Ž  Running validation at step 1600
[rank0]:2025-11-02 15:30:56,621 - INFO -  step: 1600  loss: -4.0000  grad_norm:  0.7614  memory: 59.51GiB(42.56%)  tps: 5,898  tflops: 275.09  mfu: 27.82%
[rank0]:2025-11-02 15:30:56,621 - INFO - ðŸ”Ž  Running validation at step 1600
[rank2]:2025-11-02 15:31:18,402 - INFO - validate step: 1600  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,801
[rank1]:2025-11-02 15:31:18,396 - INFO - validate step: 1600  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,808
[rank0]:2025-11-02 15:31:18,387 - INFO - validate step: 1600  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,819
[rank3]:2025-11-02 15:31:18,405 - INFO - validate step: 1600  loss:  0.2700  memory: 51.85GiB(37.08%)  tps: 18,802
[rank3]:2025-11-02 15:31:18,698 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1531_real_step1600_rank3.svg
[rank3]:> Batch Time: 593.25 ms, GPU Bubble Ratio: 23.09%, 21.45%, 28.60%, 17.08%
[rank0]:2025-11-02 15:33:35,124 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 15:33:37,848 - INFO - Avg. fwd time: 7.7062 / Avg. bwd time: 22.6842 / Avg. batch time: 561.9321 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:33:37,886 - INFO - Avg. fwd time: 7.9785 / Avg. bwd time: 18.2564 / Avg. batch time: 595.3444 (ms) / GPU bubble ratio: 29.49%
[rank1]:2025-11-02 15:33:37,927 - INFO - Avg. fwd time: 8.1941 / Avg. bwd time: 20.6357 / Avg. batch time: 637.5768 (ms) / GPU bubble ratio: 27.65%
[rank2]:2025-11-02 15:33:37,995 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6106  memory: 43.55GiB(31.15%)  tps: 5,869  tflops: 273.71  mfu: 27.68%
[rank1]:2025-11-02 15:33:37,997 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6106  memory: 53.47GiB(38.25%)  tps: 5,868  tflops: 273.69  mfu: 27.67%
[rank0]:2025-11-02 15:33:37,966 - INFO - Avg. fwd time: 8.2483 / Avg. bwd time: 20.0058 / Avg. batch time: 666.4508 (ms) / GPU bubble ratio: 32.17%
[rank0]:2025-11-02 15:33:38,001 - INFO -  step: 1650  loss: -4.0000  grad_norm:  0.6106  memory: 59.51GiB(42.56%)  tps: 5,868  tflops: 273.67  mfu: 27.67%
[rank3]:2025-11-02 15:33:37,999 - INFO -  step: 1650  loss:  0.5402  grad_norm:  0.6106  memory: 51.85GiB(37.08%)  tps: 5,869  tflops: 273.71  mfu: 27.68%
[rank0]:2025-11-02 15:35:54,485 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:35:57,139 - INFO - Avg. fwd time: 7.9805 / Avg. bwd time: 18.2579 / Avg. batch time: 595.4119 (ms) / GPU bubble ratio: 29.49%
[rank3]:2025-11-02 15:35:57,119 - INFO - Avg. fwd time: 7.7082 / Avg. bwd time: 22.6864 / Avg. batch time: 562.0146 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-02 15:35:57,181 - INFO - Avg. fwd time: 8.2501 / Avg. bwd time: 20.0065 / Avg. batch time: 666.5252 (ms) / GPU bubble ratio: 32.17%
[rank1]:2025-11-02 15:35:57,186 - INFO - Avg. fwd time: 8.1963 / Avg. bwd time: 20.6375 / Avg. batch time: 637.6476 (ms) / GPU bubble ratio: 27.65%
[rank2]:2025-11-02 15:35:57,289 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9575  memory: 43.55GiB(31.15%)  tps: 5,881  tflops: 274.29  mfu: 27.73%
[rank0]:2025-11-02 15:35:57,296 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9575  memory: 59.51GiB(42.56%)  tps: 5,881  tflops: 274.29  mfu: 27.73%
[rank1]:2025-11-02 15:35:57,292 - INFO -  step: 1700  loss: -4.0000  grad_norm:  0.9575  memory: 53.47GiB(38.25%)  tps: 5,881  tflops: 274.29  mfu: 27.73%
[rank3]:2025-11-02 15:35:57,294 - INFO -  step: 1700  loss:  0.5131  grad_norm:  0.9575  memory: 51.85GiB(37.08%)  tps: 5,881  tflops: 274.30  mfu: 27.73%
[rank3]:2025-11-02 15:35:57,585 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1535_real_step1700_rank3.svg
[rank3]:> Batch Time: 590.93 ms, GPU Bubble Ratio: 22.99%, 21.40%, 28.46%, 17.13%
[rank0]:2025-11-02 15:38:13,747 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:38:16,387 - INFO - Avg. fwd time: 7.7101 / Avg. bwd time: 22.6884 / Avg. batch time: 562.0923 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:38:16,408 - INFO - Avg. fwd time: 7.9824 / Avg. bwd time: 18.2593 / Avg. batch time: 595.5088 (ms) / GPU bubble ratio: 29.49%
[rank0]:2025-11-02 15:38:16,450 - INFO - Avg. fwd time: 8.2518 / Avg. bwd time: 20.0070 / Avg. batch time: 666.6295 (ms) / GPU bubble ratio: 32.18%
[rank1]:2025-11-02 15:38:16,454 - INFO - Avg. fwd time: 8.1986 / Avg. bwd time: 20.6394 / Avg. batch time: 637.7488 (ms) / GPU bubble ratio: 27.65%
[rank0]:2025-11-02 15:38:16,565 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5828  memory: 59.51GiB(42.56%)  tps: 5,882  tflops: 274.34  mfu: 27.74%
[rank1]:2025-11-02 15:38:16,561 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5828  memory: 53.47GiB(38.25%)  tps: 5,882  tflops: 274.34  mfu: 27.74%
[rank3]:2025-11-02 15:38:16,563 - INFO -  step: 1750  loss:  0.4853  grad_norm:  0.5828  memory: 51.85GiB(37.08%)  tps: 5,882  tflops: 274.35  mfu: 27.74%
[rank2]:2025-11-02 15:38:16,559 - INFO -  step: 1750  loss: -4.0000  grad_norm:  0.5828  memory: 43.55GiB(31.15%)  tps: 5,882  tflops: 274.34  mfu: 27.74%
[rank0]:2025-11-02 15:40:30,603 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 15:40:33,248 - INFO - Avg. fwd time: 7.9805 / Avg. bwd time: 18.2582 / Avg. batch time: 595.3839 (ms) / GPU bubble ratio: 29.49%
[rank1]:2025-11-02 15:40:33,288 - INFO - Avg. fwd time: 8.1966 / Avg. bwd time: 20.6383 / Avg. batch time: 637.6222 (ms) / GPU bubble ratio: 27.64%
[rank3]:2025-11-02 15:40:33,211 - INFO - Avg. fwd time: 7.7077 / Avg. bwd time: 22.6847 / Avg. batch time: 561.9801 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:40:33,355 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1288  memory: 43.55GiB(31.15%)  tps: 5,988  tflops: 279.30  mfu: 28.24%
[rank2]:2025-11-02 15:40:33,355 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 15:40:33,327 - INFO - Avg. fwd time: 8.2504 / Avg. bwd time: 20.0055 / Avg. batch time: 666.5014 (ms) / GPU bubble ratio: 32.17%
[rank0]:2025-11-02 15:40:33,362 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1288  memory: 59.51GiB(42.56%)  tps: 5,988  tflops: 279.30  mfu: 28.24%
[rank1]:2025-11-02 15:40:33,358 - INFO -  step: 1800  loss: -4.0000  grad_norm:  0.1288  memory: 53.47GiB(38.25%)  tps: 5,988  tflops: 279.30  mfu: 28.24%
[rank0]:2025-11-02 15:40:33,362 - INFO - ðŸ”Ž  Running validation at step 1800
[rank1]:2025-11-02 15:40:33,358 - INFO - ðŸ”Ž  Running validation at step 1800
[rank3]:2025-11-02 15:40:33,360 - INFO -  step: 1800  loss:  0.0665  grad_norm:  0.1288  memory: 51.85GiB(37.08%)  tps: 5,989  tflops: 279.30  mfu: 28.24%
[rank3]:2025-11-02 15:40:33,360 - INFO - ðŸ”Ž  Running validation at step 1800
[rank0]:2025-11-02 15:40:55,208 - INFO - validate step: 1800  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,750
[rank1]:2025-11-02 15:40:55,209 - INFO - validate step: 1800  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,746
[rank2]:2025-11-02 15:40:55,217 - INFO - validate step: 1800  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,736
[rank3]:2025-11-02 15:40:55,221 - INFO - validate step: 1800  loss:  0.2611  memory: 51.85GiB(37.08%)  tps: 18,737
[rank3]:2025-11-02 15:40:55,516 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1540_real_step1800_rank3.svg
[rank3]:> Batch Time: 577.45 ms, GPU Bubble Ratio: 22.30%, 21.07%, 28.12%, 17.35%
[rank0]:2025-11-02 15:43:09,101 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 15:43:11,682 - INFO - Avg. fwd time: 7.9786 / Avg. bwd time: 18.2564 / Avg. batch time: 595.2838 (ms) / GPU bubble ratio: 29.49%
[rank3]:2025-11-02 15:43:11,663 - INFO - Avg. fwd time: 7.7053 / Avg. bwd time: 22.6803 / Avg. batch time: 561.8543 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:43:11,728 - INFO - Avg. fwd time: 8.1945 / Avg. bwd time: 20.6365 / Avg. batch time: 637.5190 (ms) / GPU bubble ratio: 27.64%
[rank0]:2025-11-02 15:43:11,724 - INFO - Avg. fwd time: 8.2489 / Avg. bwd time: 20.0035 / Avg. batch time: 666.3940 (ms) / GPU bubble ratio: 32.17%
[rank3]:2025-11-02 15:43:11,835 - INFO -  step: 1850  loss:  0.3890  grad_norm:  0.4698  memory: 51.85GiB(37.08%)  tps: 5,997  tflops: 279.68  mfu: 28.28%
[rank1]:2025-11-02 15:43:11,833 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4698  memory: 53.47GiB(38.25%)  tps: 5,996  tflops: 279.66  mfu: 28.28%
[rank0]:2025-11-02 15:43:11,837 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4698  memory: 59.51GiB(42.56%)  tps: 5,996  tflops: 279.64  mfu: 28.28%
[rank2]:2025-11-02 15:43:11,831 - INFO -  step: 1850  loss: -4.0000  grad_norm:  0.4698  memory: 43.55GiB(31.15%)  tps: 5,997  tflops: 279.68  mfu: 28.28%
[rank0]:2025-11-02 15:45:24,788 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:45:27,348 - INFO - Avg. fwd time: 7.7012 / Avg. bwd time: 22.6738 / Avg. batch time: 561.6577 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:45:27,367 - INFO - Avg. fwd time: 7.9751 / Avg. bwd time: 18.2537 / Avg. batch time: 595.0751 (ms) / GPU bubble ratio: 29.48%
[rank1]:2025-11-02 15:45:27,412 - INFO - Avg. fwd time: 8.1908 / Avg. bwd time: 20.6337 / Avg. batch time: 637.3041 (ms) / GPU bubble ratio: 27.63%
[rank0]:2025-11-02 15:45:27,410 - INFO - Avg. fwd time: 8.2461 / Avg. bwd time: 20.0005 / Avg. batch time: 666.1725 (ms) / GPU bubble ratio: 32.16%
[rank2]:2025-11-02 15:45:27,514 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1827  memory: 43.55GiB(31.15%)  tps: 6,038  tflops: 281.59  mfu: 28.47%
[rank1]:2025-11-02 15:45:27,517 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1827  memory: 53.47GiB(38.25%)  tps: 6,038  tflops: 281.59  mfu: 28.47%
[rank3]:2025-11-02 15:45:27,518 - INFO -  step: 1900  loss:  0.2015  grad_norm:  0.1827  memory: 51.85GiB(37.08%)  tps: 6,038  tflops: 281.60  mfu: 28.47%
[rank0]:2025-11-02 15:45:27,520 - INFO -  step: 1900  loss: -4.0000  grad_norm:  0.1827  memory: 59.51GiB(42.56%)  tps: 6,038  tflops: 281.59  mfu: 28.47%
[rank3]:2025-11-02 15:45:27,815 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1545_real_step1900_rank3.svg
[rank3]:> Batch Time: 579.91 ms, GPU Bubble Ratio: 22.45%, 21.09%, 28.17%, 17.32%
[rank0]:2025-11-02 15:47:40,369 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:47:43,019 - INFO - Avg. fwd time: 7.6968 / Avg. bwd time: 22.6673 / Avg. batch time: 561.4538 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:47:43,056 - INFO - Avg. fwd time: 7.9714 / Avg. bwd time: 18.2506 / Avg. batch time: 594.8942 (ms) / GPU bubble ratio: 29.47%
[rank1]:2025-11-02 15:47:43,098 - INFO - Avg. fwd time: 8.1869 / Avg. bwd time: 20.6305 / Avg. batch time: 637.1181 (ms) / GPU bubble ratio: 27.63%
[rank1]:2025-11-02 15:47:43,170 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1580  memory: 53.47GiB(38.25%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank3]:2025-11-02 15:47:43,172 - INFO -  step: 1950  loss:  0.1654  grad_norm:  0.1580  memory: 51.85GiB(37.08%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank0]:2025-11-02 15:47:43,139 - INFO - Avg. fwd time: 8.2432 / Avg. bwd time: 19.9977 / Avg. batch time: 665.9815 (ms) / GPU bubble ratio: 32.15%
[rank0]:2025-11-02 15:47:43,174 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1580  memory: 59.51GiB(42.56%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank2]:2025-11-02 15:47:43,167 - INFO -  step: 1950  loss: -4.0000  grad_norm:  0.1580  memory: 43.55GiB(31.15%)  tps: 6,039  tflops: 281.66  mfu: 28.48%
[rank0]:2025-11-02 15:49:55,810 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:49:58,390 - INFO - Avg. fwd time: 7.6932 / Avg. bwd time: 22.6617 / Avg. batch time: 561.2833 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:49:58,410 - INFO - Avg. fwd time: 7.9685 / Avg. bwd time: 18.2483 / Avg. batch time: 594.7158 (ms) / GPU bubble ratio: 29.47%
[rank0]:2025-11-02 15:49:58,453 - INFO - Avg. fwd time: 8.2409 / Avg. bwd time: 19.9960 / Avg. batch time: 665.7931 (ms) / GPU bubble ratio: 32.14%
[rank1]:2025-11-02 15:49:58,456 - INFO - Avg. fwd time: 8.1838 / Avg. bwd time: 20.6281 / Avg. batch time: 636.9346 (ms) / GPU bubble ratio: 27.62%
[rank2]:2025-11-02 15:49:58,559 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1499  memory: 43.55GiB(31.15%)  tps: 6,051  tflops: 282.20  mfu: 28.53%
[rank2]:2025-11-02 15:49:58,559 - INFO - ðŸ”Ž  Running validation at step 2000
[rank0]:2025-11-02 15:49:58,565 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1499  memory: 59.51GiB(42.56%)  tps: 6,051  tflops: 282.20  mfu: 28.53%
[rank0]:2025-11-02 15:49:58,565 - INFO - ðŸ”Ž  Running validation at step 2000
[rank3]:2025-11-02 15:49:58,563 - INFO -  step: 2000  loss:  0.2033  grad_norm:  0.1499  memory: 51.85GiB(37.08%)  tps: 6,051  tflops: 282.20  mfu: 28.53%
[rank3]:2025-11-02 15:49:58,564 - INFO - ðŸ”Ž  Running validation at step 2000
[rank1]:2025-11-02 15:49:58,562 - INFO -  step: 2000  loss: -4.0000  grad_norm:  0.1499  memory: 53.47GiB(38.25%)  tps: 6,051  tflops: 282.20  mfu: 28.53%
[rank1]:2025-11-02 15:49:58,562 - INFO - ðŸ”Ž  Running validation at step 2000
[rank2]:2025-11-02 15:50:20,341 - INFO - validate step: 2000  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,805
[rank1]:2025-11-02 15:50:20,334 - INFO - validate step: 2000  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,814
[rank3]:2025-11-02 15:50:20,344 - INFO - validate step: 2000  loss:  0.2472  memory: 51.85GiB(37.08%)  tps: 18,807
[rank0]:2025-11-02 15:50:20,326 - INFO - validate step: 2000  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,823
[rank3]:2025-11-02 15:50:20,638 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1550_real_step2000_rank3.svg
[rank3]:> Batch Time: 580.06 ms, GPU Bubble Ratio: 22.36%, 21.13%, 28.15%, 17.31%
[rank0]:2025-11-02 15:52:33,193 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2025-11-02 15:52:35,776 - INFO - Avg. fwd time: 7.9651 / Avg. bwd time: 18.2455 / Avg. batch time: 594.5477 (ms) / GPU bubble ratio: 29.46%
[rank0]:2025-11-02 15:52:35,818 - INFO - Avg. fwd time: 8.2382 / Avg. bwd time: 19.9938 / Avg. batch time: 665.6128 (ms) / GPU bubble ratio: 32.14%
[rank1]:2025-11-02 15:52:35,821 - INFO - Avg. fwd time: 8.1803 / Avg. bwd time: 20.6251 / Avg. batch time: 636.7597 (ms) / GPU bubble ratio: 27.62%
[rank3]:2025-11-02 15:52:35,757 - INFO - Avg. fwd time: 7.6892 / Avg. bwd time: 22.6554 / Avg. batch time: 561.0924 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 15:52:35,924 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1987  memory: 53.47GiB(38.25%)  tps: 6,042  tflops: 281.79  mfu: 28.49%
[rank0]:2025-11-02 15:52:35,928 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1987  memory: 59.51GiB(42.56%)  tps: 6,041  tflops: 281.76  mfu: 28.49%
[rank3]:2025-11-02 15:52:35,926 - INFO -  step: 2050  loss:  0.2212  grad_norm:  0.1987  memory: 51.85GiB(37.08%)  tps: 6,042  tflops: 281.81  mfu: 28.49%
[rank2]:2025-11-02 15:52:35,922 - INFO -  step: 2050  loss: -4.0000  grad_norm:  0.1987  memory: 43.55GiB(31.15%)  tps: 6,042  tflops: 281.81  mfu: 28.49%
[rank0]:2025-11-02 15:54:48,456 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:54:51,093 - INFO - Avg. fwd time: 7.6853 / Avg. bwd time: 22.6493 / Avg. batch time: 560.9061 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:54:51,134 - INFO - Avg. fwd time: 7.9619 / Avg. bwd time: 18.2430 / Avg. batch time: 594.3555 (ms) / GPU bubble ratio: 29.46%
[rank0]:2025-11-02 15:54:51,223 - INFO - Avg. fwd time: 8.2358 / Avg. bwd time: 19.9919 / Avg. batch time: 665.4133 (ms) / GPU bubble ratio: 32.13%
[rank1]:2025-11-02 15:54:51,180 - INFO - Avg. fwd time: 8.1769 / Avg. bwd time: 20.6225 / Avg. batch time: 636.5633 (ms) / GPU bubble ratio: 27.61%
[rank2]:2025-11-02 15:54:51,252 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1788  memory: 43.55GiB(31.15%)  tps: 6,053  tflops: 282.33  mfu: 28.55%
[rank0]:2025-11-02 15:54:51,259 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1788  memory: 59.51GiB(42.56%)  tps: 6,053  tflops: 282.33  mfu: 28.55%
[rank1]:2025-11-02 15:54:51,255 - INFO -  step: 2100  loss: -4.0000  grad_norm:  0.1788  memory: 53.47GiB(38.25%)  tps: 6,053  tflops: 282.33  mfu: 28.55%
[rank3]:2025-11-02 15:54:51,257 - INFO -  step: 2100  loss:  0.2286  grad_norm:  0.1788  memory: 51.85GiB(37.08%)  tps: 6,053  tflops: 282.33  mfu: 28.55%
[rank3]:2025-11-02 15:54:51,548 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1554_real_step2100_rank3.svg
[rank3]:> Batch Time: 581.30 ms, GPU Bubble Ratio: 22.47%, 21.17%, 28.20%, 17.30%
[rank0]:2025-11-02 15:57:04,169 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:57:06,712 - INFO - Avg. fwd time: 7.6824 / Avg. bwd time: 22.6446 / Avg. batch time: 560.7648 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:57:06,730 - INFO - Avg. fwd time: 7.9594 / Avg. bwd time: 18.2409 / Avg. batch time: 594.2362 (ms) / GPU bubble ratio: 29.45%
[rank1]:2025-11-02 15:57:06,776 - INFO - Avg. fwd time: 8.1743 / Avg. bwd time: 20.6203 / Avg. batch time: 636.4392 (ms) / GPU bubble ratio: 27.61%
[rank0]:2025-11-02 15:57:06,775 - INFO - Avg. fwd time: 8.2337 / Avg. bwd time: 19.9901 / Avg. batch time: 665.2851 (ms) / GPU bubble ratio: 32.12%
[rank2]:2025-11-02 15:57:06,878 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1786  memory: 43.55GiB(31.15%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank1]:2025-11-02 15:57:06,881 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1786  memory: 53.47GiB(38.25%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank3]:2025-11-02 15:57:06,883 - INFO -  step: 2150  loss:  0.1883  grad_norm:  0.1786  memory: 51.85GiB(37.08%)  tps: 6,040  tflops: 281.72  mfu: 28.48%
[rank0]:2025-11-02 15:57:06,885 - INFO -  step: 2150  loss: -4.0000  grad_norm:  0.1786  memory: 59.51GiB(42.56%)  tps: 6,040  tflops: 281.71  mfu: 28.48%
[rank0]:2025-11-02 15:59:19,604 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 15:59:22,147 - INFO - Avg. fwd time: 7.6792 / Avg. bwd time: 22.6399 / Avg. batch time: 560.6138 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 15:59:22,168 - INFO - Avg. fwd time: 7.9566 / Avg. bwd time: 18.2387 / Avg. batch time: 594.0722 (ms) / GPU bubble ratio: 29.45%
[rank1]:2025-11-02 15:59:22,216 - INFO - Avg. fwd time: 8.1712 / Avg. bwd time: 20.6180 / Avg. batch time: 636.2703 (ms) / GPU bubble ratio: 27.60%
[rank0]:2025-11-02 15:59:22,213 - INFO - Avg. fwd time: 8.2315 / Avg. bwd time: 19.9877 / Avg. batch time: 665.1107 (ms) / GPU bubble ratio: 32.12%
[rank2]:2025-11-02 15:59:22,316 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1459  memory: 43.55GiB(31.15%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank2]:2025-11-02 15:59:22,316 - INFO - ðŸ”Ž  Running validation at step 2200
[rank1]:2025-11-02 15:59:22,319 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1459  memory: 53.47GiB(38.25%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank1]:2025-11-02 15:59:22,319 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 15:59:22,322 - INFO -  step: 2200  loss: -4.0000  grad_norm:  0.1459  memory: 59.51GiB(42.56%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank0]:2025-11-02 15:59:22,322 - INFO - ðŸ”Ž  Running validation at step 2200
[rank3]:2025-11-02 15:59:22,320 - INFO -  step: 2200  loss:  0.1822  grad_norm:  0.1459  memory: 51.85GiB(37.08%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank3]:2025-11-02 15:59:22,320 - INFO - ðŸ”Ž  Running validation at step 2200
[rank0]:2025-11-02 15:59:44,086 - INFO - validate step: 2200  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,821
[rank2]:2025-11-02 15:59:44,101 - INFO - validate step: 2200  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,802
[rank1]:2025-11-02 15:59:44,093 - INFO - validate step: 2200  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,812
[rank3]:2025-11-02 15:59:44,105 - INFO - validate step: 2200  loss:  0.2463  memory: 51.85GiB(37.08%)  tps: 18,803
[rank3]:2025-11-02 15:59:44,401 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1559_real_step2200_rank3.svg
[rank3]:> Batch Time: 582.41 ms, GPU Bubble Ratio: 22.65%, 21.22%, 28.33%, 17.24%
[rank0]:2025-11-02 16:01:57,116 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:01:59,760 - INFO - Avg. fwd time: 7.6761 / Avg. bwd time: 22.6356 / Avg. batch time: 560.4735 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:01:59,801 - INFO - Avg. fwd time: 7.9538 / Avg. bwd time: 18.2364 / Avg. batch time: 593.9511 (ms) / GPU bubble ratio: 29.45%
[rank0]:2025-11-02 16:01:59,890 - INFO - Avg. fwd time: 8.2295 / Avg. bwd time: 19.9853 / Avg. batch time: 664.9823 (ms) / GPU bubble ratio: 32.11%
[rank1]:2025-11-02 16:01:59,846 - INFO - Avg. fwd time: 8.1683 / Avg. bwd time: 20.6159 / Avg. batch time: 636.1458 (ms) / GPU bubble ratio: 27.60%
[rank2]:2025-11-02 16:01:59,919 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2087  memory: 43.55GiB(31.15%)  tps: 6,032  tflops: 281.32  mfu: 28.44%
[rank0]:2025-11-02 16:01:59,925 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2087  memory: 59.51GiB(42.56%)  tps: 6,031  tflops: 281.27  mfu: 28.44%
[rank1]:2025-11-02 16:01:59,921 - INFO -  step: 2250  loss: -4.0000  grad_norm:  0.2087  memory: 53.47GiB(38.25%)  tps: 6,031  tflops: 281.29  mfu: 28.44%
[rank3]:2025-11-02 16:01:59,923 - INFO -  step: 2250  loss:  0.2257  grad_norm:  0.2087  memory: 51.85GiB(37.08%)  tps: 6,032  tflops: 281.32  mfu: 28.44%
[rank0]:2025-11-02 16:04:12,602 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:04:15,182 - INFO - Avg. fwd time: 7.9516 / Avg. bwd time: 18.2346 / Avg. batch time: 593.8276 (ms) / GPU bubble ratio: 29.44%
[rank3]:2025-11-02 16:04:15,165 - INFO - Avg. fwd time: 7.6737 / Avg. bwd time: 22.6321 / Avg. batch time: 560.3620 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:04:15,228 - INFO - Avg. fwd time: 8.1659 / Avg. bwd time: 20.6141 / Avg. batch time: 636.0188 (ms) / GPU bubble ratio: 27.60%
[rank0]:2025-11-02 16:04:15,225 - INFO - Avg. fwd time: 8.2279 / Avg. bwd time: 19.9833 / Avg. batch time: 664.8507 (ms) / GPU bubble ratio: 32.11%
[rank2]:2025-11-02 16:04:15,328 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1814  memory: 43.55GiB(31.15%)  tps: 6,050  tflops: 282.16  mfu: 28.53%
[rank1]:2025-11-02 16:04:15,331 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1814  memory: 53.47GiB(38.25%)  tps: 6,050  tflops: 282.16  mfu: 28.53%
[rank0]:2025-11-02 16:04:15,335 - INFO -  step: 2300  loss: -4.0000  grad_norm:  0.1814  memory: 59.51GiB(42.56%)  tps: 6,050  tflops: 282.16  mfu: 28.53%
[rank3]:2025-11-02 16:04:15,333 - INFO -  step: 2300  loss:  0.1968  grad_norm:  0.1814  memory: 51.85GiB(37.08%)  tps: 6,050  tflops: 282.17  mfu: 28.53%
[rank3]:2025-11-02 16:04:15,626 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1604_real_step2300_rank3.svg
[rank3]:> Batch Time: 582.07 ms, GPU Bubble Ratio: 22.65%, 21.26%, 28.39%, 17.24%
[rank0]:2025-11-02 16:06:28,374 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:06:30,966 - INFO - Avg. fwd time: 7.9491 / Avg. bwd time: 18.2324 / Avg. batch time: 593.7111 (ms) / GPU bubble ratio: 29.44%
[rank1]:2025-11-02 16:06:31,012 - INFO - Avg. fwd time: 8.1632 / Avg. bwd time: 20.6121 / Avg. batch time: 635.8974 (ms) / GPU bubble ratio: 27.60%
[rank3]:2025-11-02 16:06:30,947 - INFO - Avg. fwd time: 7.6709 / Avg. bwd time: 22.6280 / Avg. batch time: 560.2290 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-02 16:06:31,012 - INFO - Avg. fwd time: 8.2261 / Avg. bwd time: 19.9812 / Avg. batch time: 664.7248 (ms) / GPU bubble ratio: 32.10%
[rank1]:2025-11-02 16:06:31,115 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1559  memory: 53.47GiB(38.25%)  tps: 6,033  tflops: 281.39  mfu: 28.45%
[rank3]:2025-11-02 16:06:31,117 - INFO -  step: 2350  loss:  0.1828  grad_norm:  0.1559  memory: 51.85GiB(37.08%)  tps: 6,033  tflops: 281.39  mfu: 28.45%
[rank0]:2025-11-02 16:06:31,119 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1559  memory: 59.51GiB(42.56%)  tps: 6,033  tflops: 281.39  mfu: 28.45%
[rank2]:2025-11-02 16:06:31,113 - INFO -  step: 2350  loss: -4.0000  grad_norm:  0.1559  memory: 43.55GiB(31.15%)  tps: 6,033  tflops: 281.39  mfu: 28.45%
[rank0]:2025-11-02 16:08:43,728 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:08:46,390 - INFO - Avg. fwd time: 7.6680 / Avg. bwd time: 22.6234 / Avg. batch time: 560.0918 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:08:46,430 - INFO - Avg. fwd time: 7.9467 / Avg. bwd time: 18.2305 / Avg. batch time: 593.5668 (ms) / GPU bubble ratio: 29.44%
[rank1]:2025-11-02 16:08:46,474 - INFO - Avg. fwd time: 8.1606 / Avg. bwd time: 20.6100 / Avg. batch time: 635.7501 (ms) / GPU bubble ratio: 27.59%
[rank0]:2025-11-02 16:08:46,519 - INFO - Avg. fwd time: 8.2244 / Avg. bwd time: 19.9792 / Avg. batch time: 664.5749 (ms) / GPU bubble ratio: 32.10%
[rank2]:2025-11-02 16:08:46,548 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1635  memory: 43.55GiB(31.15%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank2]:2025-11-02 16:08:46,548 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 16:08:46,551 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1635  memory: 53.47GiB(38.25%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank1]:2025-11-02 16:08:46,551 - INFO - ðŸ”Ž  Running validation at step 2400
[rank0]:2025-11-02 16:08:46,555 - INFO -  step: 2400  loss: -4.0000  grad_norm:  0.1635  memory: 59.51GiB(42.56%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank0]:2025-11-02 16:08:46,555 - INFO - ðŸ”Ž  Running validation at step 2400
[rank3]:2025-11-02 16:08:46,553 - INFO -  step: 2400  loss:  0.1878  grad_norm:  0.1635  memory: 51.85GiB(37.08%)  tps: 6,049  tflops: 282.11  mfu: 28.52%
[rank3]:2025-11-02 16:08:46,553 - INFO - ðŸ”Ž  Running validation at step 2400
[rank1]:2025-11-02 16:09:08,351 - INFO - validate step: 2400  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,790
[rank1]:2025-11-02 16:09:08,351 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:09:08,344 - INFO - validate step: 2400  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,799
[rank0]:2025-11-02 16:09:08,344 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:09:08,356 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2025-11-02 16:09:08,358 - INFO - validate step: 2400  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,781
[rank2]:2025-11-02 16:09:08,359 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank3]:2025-11-02 16:09:08,363 - INFO - validate step: 2400  loss:  0.2449  memory: 51.85GiB(37.08%)  tps: 18,782
[rank3]:2025-11-02 16:09:08,364 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 16:09:19,628 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 11.27 seconds.
[rank1]:2025-11-02 16:09:21,150 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.80 seconds.
[rank3]:2025-11-02 16:09:21,327 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 12.96 seconds.
[rank0]:2025-11-02 16:09:24,981 - INFO - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2025-11-02 16:09:24,986 - INFO - Finished saving the checkpoint (or staging if async is enabled)in 16.64 seconds.
[rank3]:2025-11-02 16:09:25,428 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1609_real_step2400_rank3.svg
[rank3]:> Batch Time: 580.40 ms, GPU Bubble Ratio: 22.47%, 21.18%, 28.22%, 17.28%
[rank0]:2025-11-02 16:11:39,946 - INFO - [GC] Peforming periodical GC collection 2.04 seconds
[rank2]:2025-11-02 16:11:42,561 - INFO - Avg. fwd time: 7.9443 / Avg. bwd time: 18.2282 / Avg. batch time: 593.4620 (ms) / GPU bubble ratio: 29.44%
[rank3]:2025-11-02 16:11:42,542 - INFO - Avg. fwd time: 7.6652 / Avg. bwd time: 22.6189 / Avg. batch time: 559.9570 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:11:42,607 - INFO - Avg. fwd time: 8.1582 / Avg. bwd time: 20.6082 / Avg. batch time: 635.6419 (ms) / GPU bubble ratio: 27.59%
[rank0]:2025-11-02 16:11:42,605 - INFO - Avg. fwd time: 8.2229 / Avg. bwd time: 19.9772 / Avg. batch time: 664.4623 (ms) / GPU bubble ratio: 32.10%
[rank2]:2025-11-02 16:11:42,705 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2031  memory: 43.55GiB(31.15%)  tps: 5,308  tflops: 247.54  mfu: 25.03%
[rank1]:2025-11-02 16:11:42,707 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2031  memory: 53.47GiB(38.25%)  tps: 5,307  tflops: 247.53  mfu: 25.03%
[rank3]:2025-11-02 16:11:42,709 - INFO -  step: 2450  loss:  0.2300  grad_norm:  0.2031  memory: 51.85GiB(37.08%)  tps: 5,308  tflops: 247.55  mfu: 25.03%
[rank0]:2025-11-02 16:11:42,711 - INFO -  step: 2450  loss: -4.0000  grad_norm:  0.2031  memory: 59.51GiB(42.56%)  tps: 5,307  tflops: 247.51  mfu: 25.03%
[rank0]:2025-11-02 16:13:55,252 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:13:57,830 - INFO - Avg. fwd time: 7.9421 / Avg. bwd time: 18.2262 / Avg. batch time: 593.3258 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:13:57,877 - INFO - Avg. fwd time: 8.1558 / Avg. bwd time: 20.6062 / Avg. batch time: 635.5013 (ms) / GPU bubble ratio: 27.59%
[rank3]:2025-11-02 16:13:57,814 - INFO - Avg. fwd time: 7.6626 / Avg. bwd time: 22.6147 / Avg. batch time: 559.8302 (ms) / GPU bubble ratio: 13.47%
[rank0]:2025-11-02 16:13:57,873 - INFO - Avg. fwd time: 8.2214 / Avg. bwd time: 19.9754 / Avg. batch time: 664.3175 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:13:57,975 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1797  memory: 43.55GiB(31.15%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank1]:2025-11-02 16:13:57,978 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1797  memory: 53.47GiB(38.25%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank0]:2025-11-02 16:13:57,982 - INFO -  step: 2500  loss: -4.0000  grad_norm:  0.1797  memory: 59.51GiB(42.56%)  tps: 6,056  tflops: 282.45  mfu: 28.56%
[rank3]:2025-11-02 16:13:57,980 - INFO -  step: 2500  loss:  0.2126  grad_norm:  0.1797  memory: 51.85GiB(37.08%)  tps: 6,056  tflops: 282.46  mfu: 28.56%
[rank3]:2025-11-02 16:13:58,275 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1613_real_step2500_rank3.svg
[rank3]:> Batch Time: 581.39 ms, GPU Bubble Ratio: 22.50%, 21.14%, 28.26%, 17.27%
[rank0]:2025-11-02 16:16:12,491 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:16:15,195 - INFO - Avg. fwd time: 7.6622 / Avg. bwd time: 22.6135 / Avg. batch time: 559.7992 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:16:15,283 - INFO - Avg. fwd time: 8.1553 / Avg. bwd time: 20.6060 / Avg. batch time: 635.4883 (ms) / GPU bubble ratio: 27.59%
[rank2]:2025-11-02 16:16:15,237 - INFO - Avg. fwd time: 7.9417 / Avg. bwd time: 18.2260 / Avg. batch time: 593.3120 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-02 16:16:15,360 - INFO -  step: 2550  loss:  0.4586  grad_norm:  0.3677  memory: 51.85GiB(37.08%)  tps: 5,963  tflops: 278.12  mfu: 28.12%
[rank1]:2025-11-02 16:16:15,358 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3677  memory: 53.47GiB(38.25%)  tps: 5,963  tflops: 278.12  mfu: 28.12%
[rank0]:2025-11-02 16:16:15,327 - INFO - Avg. fwd time: 8.2210 / Avg. bwd time: 19.9749 / Avg. batch time: 664.3045 (ms) / GPU bubble ratio: 32.09%
[rank0]:2025-11-02 16:16:15,362 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3677  memory: 59.51GiB(42.56%)  tps: 5,963  tflops: 278.12  mfu: 28.12%
[rank2]:2025-11-02 16:16:15,356 - INFO -  step: 2550  loss: -4.0000  grad_norm:  0.3677  memory: 43.55GiB(31.15%)  tps: 5,963  tflops: 278.12  mfu: 28.12%
[rank0]:2025-11-02 16:18:29,960 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:18:32,551 - INFO - Avg. fwd time: 7.6624 / Avg. bwd time: 22.6131 / Avg. batch time: 559.7986 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:18:32,617 - INFO - Avg. fwd time: 8.1556 / Avg. bwd time: 20.6063 / Avg. batch time: 635.4790 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:18:32,613 - INFO - Avg. fwd time: 8.2212 / Avg. bwd time: 19.9748 / Avg. batch time: 664.2941 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:18:32,570 - INFO - Avg. fwd time: 7.9420 / Avg. bwd time: 18.2261 / Avg. batch time: 593.3022 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-02 16:18:32,720 - INFO -  step: 2600  loss:  0.3872  grad_norm:  0.2676  memory: 51.85GiB(37.08%)  tps: 5,964  tflops: 278.16  mfu: 28.13%
[rank3]:2025-11-02 16:18:32,720 - INFO - ðŸ”Ž  Running validation at step 2600
[rank0]:2025-11-02 16:18:32,722 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2676  memory: 59.51GiB(42.56%)  tps: 5,964  tflops: 278.16  mfu: 28.13%
[rank0]:2025-11-02 16:18:32,722 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 16:18:32,718 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2676  memory: 53.47GiB(38.25%)  tps: 5,964  tflops: 278.16  mfu: 28.13%
[rank1]:2025-11-02 16:18:32,718 - INFO - ðŸ”Ž  Running validation at step 2600
[rank2]:2025-11-02 16:18:32,715 - INFO -  step: 2600  loss: -4.0000  grad_norm:  0.2676  memory: 43.55GiB(31.15%)  tps: 5,964  tflops: 278.16  mfu: 28.13%
[rank2]:2025-11-02 16:18:32,715 - INFO - ðŸ”Ž  Running validation at step 2600
[rank1]:2025-11-02 16:18:54,526 - INFO - validate step: 2600  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,782
[rank0]:2025-11-02 16:18:54,518 - INFO - validate step: 2600  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,792
[rank3]:2025-11-02 16:18:54,537 - INFO - validate step: 2600  loss:  0.2493  memory: 51.85GiB(37.08%)  tps: 18,775
[rank2]:2025-11-02 16:18:54,534 - INFO - validate step: 2600  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,774
[rank3]:2025-11-02 16:18:54,834 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1618_real_step2600_rank3.svg
[rank3]:> Batch Time: 586.57 ms, GPU Bubble Ratio: 22.78%, 21.25%, 28.29%, 17.20%
[rank0]:2025-11-02 16:21:09,469 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:21:12,058 - INFO - Avg. fwd time: 7.6626 / Avg. bwd time: 22.6126 / Avg. batch time: 559.7959 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:21:12,075 - INFO - Avg. fwd time: 7.9422 / Avg. bwd time: 18.2262 / Avg. batch time: 593.3129 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:21:12,122 - INFO - Avg. fwd time: 8.1560 / Avg. bwd time: 20.6066 / Avg. batch time: 635.4905 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:21:12,118 - INFO - Avg. fwd time: 8.2214 / Avg. bwd time: 19.9746 / Avg. batch time: 664.3048 (ms) / GPU bubble ratio: 32.09%
[rank3]:2025-11-02 16:21:12,223 - INFO -  step: 2650  loss:  0.3110  grad_norm:  0.2435  memory: 51.85GiB(37.08%)  tps: 5,950  tflops: 277.50  mfu: 28.06%
[rank1]:2025-11-02 16:21:12,221 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2435  memory: 53.47GiB(38.25%)  tps: 5,949  tflops: 277.48  mfu: 28.06%
[rank0]:2025-11-02 16:21:12,225 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2435  memory: 59.51GiB(42.56%)  tps: 5,949  tflops: 277.46  mfu: 28.05%
[rank2]:2025-11-02 16:21:12,218 - INFO -  step: 2650  loss: -4.0000  grad_norm:  0.2435  memory: 43.55GiB(31.15%)  tps: 5,950  tflops: 277.50  mfu: 28.06%
[rank0]:2025-11-02 16:23:26,895 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:23:29,590 - INFO - Avg. fwd time: 7.6629 / Avg. bwd time: 22.6124 / Avg. batch time: 559.7985 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:23:29,633 - INFO - Avg. fwd time: 7.9424 / Avg. bwd time: 18.2263 / Avg. batch time: 593.3067 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:23:29,682 - INFO - Avg. fwd time: 8.1562 / Avg. bwd time: 20.6069 / Avg. batch time: 635.4862 (ms) / GPU bubble ratio: 27.58%
[rank1]:2025-11-02 16:23:29,758 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.3064  memory: 53.47GiB(38.25%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank3]:2025-11-02 16:23:29,760 - INFO -  step: 2700  loss:  0.3421  grad_norm:  0.3064  memory: 51.85GiB(37.08%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank0]:2025-11-02 16:23:29,727 - INFO - Avg. fwd time: 8.2216 / Avg. bwd time: 19.9745 / Avg. batch time: 664.3016 (ms) / GPU bubble ratio: 32.09%
[rank0]:2025-11-02 16:23:29,762 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.3064  memory: 59.51GiB(42.56%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank2]:2025-11-02 16:23:29,756 - INFO -  step: 2700  loss: -4.0000  grad_norm:  0.3064  memory: 43.55GiB(31.15%)  tps: 5,956  tflops: 277.80  mfu: 28.09%
[rank3]:2025-11-02 16:23:30,056 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1623_real_step2700_rank3.svg
[rank3]:> Batch Time: 585.99 ms, GPU Bubble Ratio: 22.73%, 21.17%, 28.25%, 17.19%
[rank0]:2025-11-02 16:25:44,681 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:25:47,286 - INFO - Avg. fwd time: 7.6631 / Avg. bwd time: 22.6122 / Avg. batch time: 559.8001 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:25:47,306 - INFO - Avg. fwd time: 7.9427 / Avg. bwd time: 18.2265 / Avg. batch time: 593.3229 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:25:47,352 - INFO - Avg. fwd time: 8.1564 / Avg. bwd time: 20.6072 / Avg. batch time: 635.5036 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:25:47,348 - INFO - Avg. fwd time: 8.2218 / Avg. bwd time: 19.9744 / Avg. batch time: 664.3187 (ms) / GPU bubble ratio: 32.09%
[rank3]:2025-11-02 16:25:47,453 - INFO -  step: 2750  loss:  0.2799  grad_norm:  0.2229  memory: 51.85GiB(37.08%)  tps: 5,950  tflops: 277.49  mfu: 28.06%
[rank1]:2025-11-02 16:25:47,452 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2229  memory: 53.47GiB(38.25%)  tps: 5,949  tflops: 277.48  mfu: 28.06%
[rank0]:2025-11-02 16:25:47,455 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2229  memory: 59.51GiB(42.56%)  tps: 5,949  tflops: 277.48  mfu: 28.06%
[rank2]:2025-11-02 16:25:47,449 - INFO -  step: 2750  loss: -4.0000  grad_norm:  0.2229  memory: 43.55GiB(31.15%)  tps: 5,949  tflops: 277.48  mfu: 28.06%
[rank0]:2025-11-02 16:28:02,202 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2025-11-02 16:28:04,835 - INFO - Avg. fwd time: 7.9431 / Avg. bwd time: 18.2268 / Avg. batch time: 593.3176 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-02 16:28:04,816 - INFO - Avg. fwd time: 7.6635 / Avg. bwd time: 22.6120 / Avg. batch time: 559.8052 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:28:04,882 - INFO - Avg. fwd time: 8.1568 / Avg. bwd time: 20.6076 / Avg. batch time: 635.4991 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:28:04,879 - INFO - Avg. fwd time: 8.2219 / Avg. bwd time: 19.9743 / Avg. batch time: 664.3133 (ms) / GPU bubble ratio: 32.09%
[rank3]:2025-11-02 16:28:04,983 - INFO -  step: 2800  loss:  0.2830  grad_norm:  0.2579  memory: 51.85GiB(37.08%)  tps: 5,957  tflops: 277.82  mfu: 28.09%
[rank3]:2025-11-02 16:28:04,983 - INFO - ðŸ”Ž  Running validation at step 2800
[rank1]:2025-11-02 16:28:04,981 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2579  memory: 53.47GiB(38.25%)  tps: 5,957  tflops: 277.82  mfu: 28.09%
[rank1]:2025-11-02 16:28:04,981 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 16:28:04,984 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2579  memory: 59.51GiB(42.56%)  tps: 5,957  tflops: 277.82  mfu: 28.09%
[rank0]:2025-11-02 16:28:04,985 - INFO - ðŸ”Ž  Running validation at step 2800
[rank2]:2025-11-02 16:28:04,978 - INFO -  step: 2800  loss: -4.0000  grad_norm:  0.2579  memory: 43.55GiB(31.15%)  tps: 5,957  tflops: 277.82  mfu: 28.09%
[rank2]:2025-11-02 16:28:04,978 - INFO - ðŸ”Ž  Running validation at step 2800
[rank0]:2025-11-02 16:28:26,842 - INFO - validate step: 2800  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,740
[rank2]:2025-11-02 16:28:26,857 - INFO - validate step: 2800  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,722
[rank1]:2025-11-02 16:28:26,849 - INFO - validate step: 2800  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,731
[rank3]:2025-11-02 16:28:26,862 - INFO - validate step: 2800  loss:  0.2473  memory: 51.85GiB(37.08%)  tps: 18,722
[rank3]:2025-11-02 16:28:27,154 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1628_real_step2800_rank3.svg
[rank3]:> Batch Time: 585.59 ms, GPU Bubble Ratio: 22.73%, 21.21%, 28.27%, 17.21%
[rank0]:2025-11-02 16:30:42,018 - INFO - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2025-11-02 16:30:44,717 - INFO - Avg. fwd time: 7.6640 / Avg. bwd time: 22.6122 / Avg. batch time: 559.8212 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:30:44,762 - INFO - Avg. fwd time: 7.9436 / Avg. bwd time: 18.2271 / Avg. batch time: 593.3474 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:30:44,811 - INFO - Avg. fwd time: 8.1573 / Avg. bwd time: 20.6080 / Avg. batch time: 635.5313 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:30:44,859 - INFO - Avg. fwd time: 8.2224 / Avg. bwd time: 19.9745 / Avg. batch time: 664.3479 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:30:44,889 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2914  memory: 43.55GiB(31.15%)  tps: 5,935  tflops: 276.80  mfu: 27.99%
[rank3]:2025-11-02 16:30:44,893 - INFO -  step: 2850  loss:  0.3875  grad_norm:  0.2914  memory: 51.85GiB(37.08%)  tps: 5,935  tflops: 276.81  mfu: 27.99%
[rank1]:2025-11-02 16:30:44,891 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2914  memory: 53.47GiB(38.25%)  tps: 5,934  tflops: 276.78  mfu: 27.99%
[rank0]:2025-11-02 16:30:44,895 - INFO -  step: 2850  loss: -4.0000  grad_norm:  0.2914  memory: 59.51GiB(42.56%)  tps: 5,934  tflops: 276.76  mfu: 27.98%
[rank0]:2025-11-02 16:32:59,687 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:33:02,300 - INFO - Avg. fwd time: 7.6644 / Avg. bwd time: 22.6122 / Avg. batch time: 559.8279 (ms) / GPU bubble ratio: 13.47%
[rank1]:2025-11-02 16:33:02,360 - INFO - Avg. fwd time: 8.1576 / Avg. bwd time: 20.6083 / Avg. batch time: 635.5294 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:33:02,360 - INFO - Avg. fwd time: 8.2225 / Avg. bwd time: 19.9746 / Avg. batch time: 664.3458 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:33:02,318 - INFO - Avg. fwd time: 7.9440 / Avg. bwd time: 18.2275 / Avg. batch time: 593.3452 (ms) / GPU bubble ratio: 29.43%
[rank3]:2025-11-02 16:33:02,462 - INFO -  step: 2900  loss:  0.3712  grad_norm:  0.2833  memory: 51.85GiB(37.08%)  tps: 5,955  tflops: 277.74  mfu: 28.08%
[rank1]:2025-11-02 16:33:02,460 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2833  memory: 53.47GiB(38.25%)  tps: 5,955  tflops: 277.73  mfu: 28.08%
[rank0]:2025-11-02 16:33:02,464 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2833  memory: 59.51GiB(42.56%)  tps: 5,955  tflops: 277.73  mfu: 28.08%
[rank2]:2025-11-02 16:33:02,458 - INFO -  step: 2900  loss: -4.0000  grad_norm:  0.2833  memory: 43.55GiB(31.15%)  tps: 5,955  tflops: 277.73  mfu: 28.08%
[rank3]:2025-11-02 16:33:02,758 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1633_real_step2900_rank3.svg
[rank3]:> Batch Time: 586.15 ms, GPU Bubble Ratio: 22.79%, 21.24%, 28.24%, 17.19%
[rank0]:2025-11-02 16:35:17,539 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:35:20,147 - INFO - Avg. fwd time: 7.6649 / Avg. bwd time: 22.6124 / Avg. batch time: 559.8430 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:35:20,165 - INFO - Avg. fwd time: 7.9446 / Avg. bwd time: 18.2280 / Avg. batch time: 593.3712 (ms) / GPU bubble ratio: 29.43%
[rank1]:2025-11-02 16:35:20,209 - INFO - Avg. fwd time: 8.1581 / Avg. bwd time: 20.6087 / Avg. batch time: 635.5560 (ms) / GPU bubble ratio: 27.58%
[rank0]:2025-11-02 16:35:20,207 - INFO - Avg. fwd time: 8.2228 / Avg. bwd time: 19.9747 / Avg. batch time: 664.3715 (ms) / GPU bubble ratio: 32.09%
[rank2]:2025-11-02 16:35:20,307 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4026  memory: 43.55GiB(31.15%)  tps: 5,943  tflops: 277.17  mfu: 28.03%
[rank3]:2025-11-02 16:35:20,311 - INFO -  step: 2950  loss:  0.4215  grad_norm:  0.4026  memory: 51.85GiB(37.08%)  tps: 5,943  tflops: 277.17  mfu: 28.03%
[rank1]:2025-11-02 16:35:20,309 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4026  memory: 53.47GiB(38.25%)  tps: 5,943  tflops: 277.17  mfu: 28.03%
[rank0]:2025-11-02 16:35:20,313 - INFO -  step: 2950  loss: -4.0000  grad_norm:  0.4026  memory: 59.51GiB(42.56%)  tps: 5,943  tflops: 277.17  mfu: 28.03%
[rank0]:2025-11-02 16:37:35,104 - INFO - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2025-11-02 16:37:37,779 - INFO - Avg. fwd time: 7.6653 / Avg. bwd time: 22.6124 / Avg. batch time: 559.8508 (ms) / GPU bubble ratio: 13.47%
[rank2]:2025-11-02 16:37:37,823 - INFO - Avg. fwd time: 7.9451 / Avg. bwd time: 18.2284 / Avg. batch time: 593.3712 (ms) / GPU bubble ratio: 29.42%
[rank1]:2025-11-02 16:37:37,871 - INFO - Avg. fwd time: 8.1584 / Avg. bwd time: 20.6092 / Avg. batch time: 635.5576 (ms) / GPU bubble ratio: 27.58%
[rank2]:2025-11-02 16:37:37,949 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2795  memory: 43.55GiB(31.15%)  tps: 5,952  tflops: 277.59  mfu: 28.07%
[rank2]:2025-11-02 16:37:37,949 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2795  tps: 6,021  tflops: 280.83  mfu: 27.61%
[rank2]:2025-11-02 16:37:37,949 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 16:37:37,920 - INFO - Avg. fwd time: 8.2231 / Avg. bwd time: 19.9748 / Avg. batch time: 664.3742 (ms) / GPU bubble ratio: 32.09%
[rank0]:2025-11-02 16:37:37,955 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2795  memory: 59.51GiB(42.56%)  tps: 5,952  tflops: 277.59  mfu: 28.07%
[rank0]:2025-11-02 16:37:37,955 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2795  tps: 6,021  tflops: 280.83  mfu: 27.61%
[rank0]:2025-11-02 16:37:37,955 - INFO - ðŸ”Ž  Running validation at step 3000
[rank1]:2025-11-02 16:37:37,952 - INFO -  step: 3000  loss: -4.0000  grad_norm:  0.2795  memory: 53.47GiB(38.25%)  tps: 5,952  tflops: 277.59  mfu: 28.07%
[rank1]:2025-11-02 16:37:37,952 - INFO -  final step: 3000  loss: -4.0000  grad_norm:  0.2795  tps: 6,021  tflops: 280.83  mfu: 27.61%
[rank1]:2025-11-02 16:37:37,952 - INFO - ðŸ”Ž  Running validation at step 3000
[rank3]:2025-11-02 16:37:37,953 - INFO -  step: 3000  loss:  0.3394  grad_norm:  0.2795  memory: 51.85GiB(37.08%)  tps: 5,952  tflops: 277.59  mfu: 28.07%
[rank3]:2025-11-02 16:37:37,954 - INFO -  final step: 3000  loss:  0.3394  grad_norm:  0.2795  tps: 6,023  tflops: 280.89  mfu: 27.62%
[rank3]:2025-11-02 16:37:37,954 - INFO - ðŸ”Ž  Running validation at step 3000
[rank0]:2025-11-02 16:37:59,699 - INFO - validate step: 3000  loss: -1.0000  memory: 59.51GiB(42.56%)  tps: 18,838
[rank0]:2025-11-02 16:37:59,699 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank0]:2025-11-02 16:37:59,703 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank1]:2025-11-02 16:37:59,706 - INFO - validate step: 3000  loss: -1.0000  memory: 53.47GiB(38.25%)  tps: 18,829
[rank1]:2025-11-02 16:37:59,707 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank1]:2025-11-02 16:37:59,710 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 16:37:59,716 - INFO - validate step: 3000  loss:  0.2490  memory: 51.85GiB(37.08%)  tps: 18,822
[rank3]:2025-11-02 16:37:59,717 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 16:37:59,714 - INFO - validate step: 3000  loss: -1.0000  memory: 43.55GiB(31.15%)  tps: 18,820
[rank2]:2025-11-02 16:37:59,714 - INFO - Saving the checkpoint (or staging if async is enabled).
[rank2]:2025-11-02 16:37:59,717 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank3]:2025-11-02 16:37:59,720 - INFO - Saving a model only checkpoint in torch.float16 at last step, step 3000.
[rank2]:2025-11-02 16:38:09,569 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 16:38:09,569 - INFO - Destroying the purge thread.
[rank0]:2025-11-02 16:38:09,534 - INFO - [GC] GC collection invoked by checkpointer. 0.01 seconds
[rank0]:2025-11-02 16:38:09,569 - INFO - Sleeping 2 seconds for other ranks to complete
[rank3]:2025-11-02 16:38:09,854 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1638_real_final3000_rank3.svg
[rank3]:> Batch Time: 586.12 ms, GPU Bubble Ratio: 22.78%, 21.31%, 28.36%, 17.19%
[rank3]:2025-11-02 16:38:10,136 - INFO - Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200/pipeline_schedule/251102_1638_thry_final3000_rank3.svg
[rank3]:> Batch Time: 455.77 ms, GPU Bubble Ratio: 15.79%, 15.79%, 15.79%, 15.79%
[rank3]:2025-11-02 16:38:10,137 - INFO - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–ˆâ–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.72043
[rank3]:wandb:               final/avg_loss 0.33935
[rank3]:wandb:             final/avg_mfu(%) 27.61618
[rank3]:wandb:             final/avg_tflops 280.89445
[rank3]:wandb:    final/avg_throughput(tps) 6022.58749
[rank3]:wandb:              final/grad_norm 0.27949
[rank3]:wandb:               final/max_loss 0.33935
[rank3]:wandb:                    grad_norm 0.27949
[rank3]:wandb: loss_metrics/global_avg_loss 0.33935
[rank3]:wandb: loss_metrics/global_max_loss 0.33935
[rank3]:wandb:                          +20 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 1101_Interleaved1F1B_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/jnbzadwe
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/1101_Interleaved1F1B_nofreeze_h200/20251102-1414/wandb/run-20251102_141412-jnbzadwe/logs
[rank0]:2025-11-02 16:38:11,569 - INFO - Training completed
[rank0]:2025-11-02 16:38:11,569 - INFO - Destroying the purge thread.
[rank1]:2025-11-02 16:38:11,781 - INFO - Process group destroyed
[rank3]:2025-11-02 16:38:11,775 - INFO - Process group destroyed
[rank2]:2025-11-02 16:38:11,799 - INFO - Process group destroyed
[rank0]:2025-11-02 16:38:12,049 - INFO - Process group destroyed
[rank2]:Stage 2: Modules to keep: {'layers.9', 'layers.12', 'layers.10', 'layers.11'}
[rank2]:Stage 6: Modules to keep: {'layers.26', 'layers.27', 'layers.25', 'layers.28'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'tok_embeddings', 'layers.0', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.5', 'layers.7', 'layers.4', 'layers.6', 'layers.8'}
[rank1]:Stage 5: Modules to keep: {'layers.23', 'layers.21', 'layers.24', 'layers.22'}
[rank0]:Stage 4: Modules to keep: {'layers.17', 'layers.18', 'layers.20', 'layers.19'}
[rank3]:Stage 3: Modules to keep: {'layers.15', 'layers.13', 'layers.14', 'layers.16'}
[rank3]:Stage 7: Modules to keep: {'layers.31', 'output', 'norm', 'layers.29', 'layers.30'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/1030_llama8b/config_1101.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Instruct Experiment, without streaming mode, sample-level with truncation, 2 epochs, with bf16"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 1101_Interleaved1F1B_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/1101_Interleaved1F1B_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B-Instruct
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 2e-05
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.95
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 500
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 3000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: None
[rank3]:		- deterministic: False
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: Interleaved1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 7]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- interval: 1200
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B-Instruct/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/1101_Interleaved1F1B_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: True
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- seq_len: 1024
[rank3]:		- freq: 200
[rank3]:		- steps: 100
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.9
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 50
[rank3]:
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
