
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Jan  3 00:12:44 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_1F1B_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with nofreeze x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0103 00:12:45.946000 2977877 site-packages/torch/distributed/run.py:803] 
W0103 00:12:45.946000 2977877 site-packages/torch/distributed/run.py:803] *****************************************
W0103 00:12:45.946000 2977877 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0103 00:12:45.946000 2977877 site-packages/torch/distributed/run.py:803] *****************************************
[rank0]:2026-01-03 00:12:52,911 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank3]:2026-01-03 00:12:52,998 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank2]:2026-01-03 00:12:52,953 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank1]:2026-01-03 00:12:53,178 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank0]:2026-01-03 00:12:53,724 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-03 00:12:53,726 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-03 00:12:53,731 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-03 00:12:53,731 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 00:12:53,733 - Loading tokenizer from tokenizer.json
[rank3]:2026-01-03 00:12:53,844 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-03 00:12:53,846 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-03 00:12:53,851 - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2026-01-03 00:12:53,830 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-03 00:12:53,832 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-03 00:12:53,838 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 00:12:54,023 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank1]:2026-01-03 00:12:53,951 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-03 00:12:53,953 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-03 00:12:53,959 - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2026-01-03 00:12:56,795 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2026-01-03 00:12:56,867 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-03 00:12:56,867 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-03 00:12:56,947 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-03 00:12:57,081 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-03 00:12:57,082 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2026-01-03 00:12:57,187 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-03 00:12:57,236 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-03 00:12:57,259 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-03 00:12:57,259 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-03 00:12:57,488 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-03 00:12:57,489 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2026-01-03 00:13:10,785 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2026-01-03 00:13:10,856 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-03 00:13:10,856 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-03 00:13:11,081 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-03 00:13:11,082 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run 1mvwvj2y
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_1F1B_nofreeze_h200/20260103-0013/wandb/run-20260103_001316-1mvwvj2y
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_1F1B_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/1mvwvj2y
[rank3]:2026-01-03 00:13:17,718 - WandB logging enabled
[rank3]:2026-01-03 00:13:17,718 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-03 00:13:17,791 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-03 00:13:17,792 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-03 00:13:18,027 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-03 00:13:18,031 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 00:13:18,029 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_1F1B_nofreeze_h200
[rank0]:2026-01-03 00:13:18,029 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 00:13:18,029 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-03 00:13:18,029 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank3]:2026-01-03 00:13:18,013 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-03 00:13:18,013 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2026-01-03 00:13:18,026 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 00:13:29,032 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-03 00:13:29,032 - Finished loading the checkpoint in 11.00 seconds.
[rank0]:2026-01-03 00:13:29,032 - Training starts at step 1
[rank2]:2026-01-03 00:13:33,063 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 29.25GiB(20.92%)  tps: 452  tflops: 21.10  mfu: 2.13%
[rank2]:2026-01-03 00:13:33,063 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-03 00:13:33,067 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 36.44GiB(26.06%)  tps: 737  tflops: 34.37  mfu: 3.48%
[rank1]:2026-01-03 00:13:33,067 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 00:13:33,088 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 41.54GiB(29.71%)  tps: 457  tflops: 21.31  mfu: 2.16%
[rank0]:2026-01-03 00:13:33,088 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-03 00:13:33,081 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 1,070  tflops: 49.91  mfu: 5.05%
[rank3]:2026-01-03 00:13:33,081 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 00:15:50,751 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:15:53,532 - Avg. fwd time: 14.2779 / Avg. bwd time: 40.0481 / Avg. batch time: 567.8722 (ms) / GPU bubble ratio: 23.47%
[rank1]:2026-01-03 00:15:53,581 - Avg. fwd time: 16.2323 / Avg. bwd time: 45.4420 / Avg. batch time: 634.3988 (ms) / GPU bubble ratio: 22.23%
[rank3]:2026-01-03 00:15:53,487 - Avg. fwd time: 15.4686 / Avg. bwd time: 45.7847 / Avg. batch time: 508.7563 (ms) / GPU bubble ratio: 3.68%
[rank2]:2026-01-03 00:15:53,657 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 42.23GiB(30.21%)  tps: 5,710  tflops: 266.32  mfu: 26.93%
[rank1]:2026-01-03 00:15:53,659 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 51.01GiB(36.48%)  tps: 5,710  tflops: 266.33  mfu: 26.93%
[rank0]:2026-01-03 00:15:53,628 - Avg. fwd time: 14.4564 / Avg. bwd time: 42.6404 / Avg. batch time: 696.8199 (ms) / GPU bubble ratio: 34.45%
[rank0]:2026-01-03 00:15:53,664 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 58.66GiB(41.96%)  tps: 5,711  tflops: 266.36  mfu: 26.93%
[rank3]:2026-01-03 00:15:53,662 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 48.72GiB(34.84%)  tps: 5,711  tflops: 266.35  mfu: 26.93%
[rank0]:2026-01-03 00:18:14,304 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:18:17,075 - Avg. fwd time: 14.2798 / Avg. bwd time: 40.1171 / Avg. batch time: 567.6113 (ms) / GPU bubble ratio: 23.33%
[rank3]:2026-01-03 00:18:17,030 - Avg. fwd time: 15.4850 / Avg. bwd time: 45.8497 / Avg. batch time: 508.7151 (ms) / GPU bubble ratio: 3.55%
[rank1]:2026-01-03 00:18:17,124 - Avg. fwd time: 16.1985 / Avg. bwd time: 45.4733 / Avg. batch time: 633.8756 (ms) / GPU bubble ratio: 22.17%
[rank3]:2026-01-03 00:18:17,204 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 48.72GiB(34.84%)  tps: 5,707  tflops: 266.18  mfu: 26.91%
[rank0]:2026-01-03 00:18:17,171 - Avg. fwd time: 14.4437 / Avg. bwd time: 42.7433 / Avg. batch time: 696.0448 (ms) / GPU bubble ratio: 34.27%
[rank0]:2026-01-03 00:18:17,206 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 58.66GiB(41.96%)  tps: 5,707  tflops: 266.18  mfu: 26.91%
[rank2]:2026-01-03 00:18:17,200 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 42.23GiB(30.21%)  tps: 5,707  tflops: 266.18  mfu: 26.91%
[rank1]:2026-01-03 00:18:17,202 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 51.01GiB(36.48%)  tps: 5,707  tflops: 266.18  mfu: 26.91%
[rank3]:2026-01-03 00:18:17,362 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0018_step100_rank3.svg
[rank3]:			> Batch Time: 696.47 ms, GPU Bubble Ratio: 33.92%, 28.83%, 37.18%, 29.17%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB0,B]  208-42-251ms   | [S0,MB4,F]  251-13-265ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-13-328ms   | [S0,MB2,B]  335-43-378ms   | [S0,MB6,F]  378-14-392ms   | [S0,MB3,B]  398-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  462-43-505ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  588-42-631ms   | [S0,MB7,B]  653-42-696ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  208-15-223ms   | [S1,MB1,B]  225-45-270ms   | [S1,MB4,F]  271-15-287ms   | [S1,MB2,B]  288-45-334ms   | [S1,MB5,F]  334-15-350ms   | [S1,MB3,B]  351-46-397ms   | [S1,MB6,F]  398-15-414ms   | [S1,MB4,B]  415-45-461ms   | [S1,MB7,F]  461-15-477ms   | [S1,MB5,B]  478-46-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  606-45-652ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-40-162ms   | [S2,MB2,F]  162-13-176ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  225-13-239ms   | [S2,MB2,B]  247-40-288ms   | [S2,MB4,F]  288-13-302ms   | [S2,MB3,B]  311-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  375-40-415ms   | [S2,MB6,F]  415-13-429ms   | [S2,MB5,B]  438-40-478ms   | [S2,MB7,F]  478-13-492ms   | [S2,MB6,B]  501-40-541ms   | [S2,MB7,B]  565-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-45-184ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-247ms   | [S3,MB3,F]  247-15-262ms   | [S3,MB3,B]  264-46-311ms   | [S3,MB4,F]  311-15-326ms   | [S3,MB4,B]  328-46-374ms   | [S3,MB5,F]  374-15-389ms   | [S3,MB5,B]  391-46-437ms   | [S3,MB6,F]  437-15-452ms   | [S3,MB6,B]  454-46-501ms   | [S3,MB7,F]  501-15-516ms   | [S3,MB7,B]  518-46-564ms  
[rank0]:2026-01-03 00:20:37,916 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:20:40,699 - Avg. fwd time: 14.2682 / Avg. bwd time: 40.1638 / Avg. batch time: 567.6344 (ms) / GPU bubble ratio: 23.29%
[rank3]:2026-01-03 00:20:40,653 - Avg. fwd time: 15.4806 / Avg. bwd time: 45.8762 / Avg. batch time: 508.6610 (ms) / GPU bubble ratio: 3.50%
[rank1]:2026-01-03 00:20:40,749 - Avg. fwd time: 16.1823 / Avg. bwd time: 45.5004 / Avg. batch time: 633.8163 (ms) / GPU bubble ratio: 22.14%
[rank0]:2026-01-03 00:20:40,796 - Avg. fwd time: 14.4415 / Avg. bwd time: 42.7952 / Avg. batch time: 695.9162 (ms) / GPU bubble ratio: 34.20%
[rank0]:2026-01-03 00:20:40,831 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 58.66GiB(41.96%)  tps: 5,704  tflops: 266.02  mfu: 26.90%
[rank3]:2026-01-03 00:20:40,830 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 48.72GiB(34.84%)  tps: 5,704  tflops: 266.03  mfu: 26.90%
[rank2]:2026-01-03 00:20:40,825 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 42.23GiB(30.21%)  tps: 5,704  tflops: 266.02  mfu: 26.90%
[rank1]:2026-01-03 00:20:40,827 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 51.01GiB(36.48%)  tps: 5,704  tflops: 266.02  mfu: 26.90%
[rank0]:2026-01-03 00:23:01,269 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:23:03,997 - Avg. fwd time: 15.4679 / Avg. bwd time: 45.8837 / Avg. batch time: 508.5030 (ms) / GPU bubble ratio: 3.48%
[rank1]:2026-01-03 00:23:04,092 - Avg. fwd time: 16.1722 / Avg. bwd time: 45.5163 / Avg. batch time: 633.5318 (ms) / GPU bubble ratio: 22.10%
[rank2]:2026-01-03 00:23:04,042 - Avg. fwd time: 14.2579 / Avg. bwd time: 40.1942 / Avg. batch time: 567.3962 (ms) / GPU bubble ratio: 23.23%
[rank0]:2026-01-03 00:23:04,139 - Avg. fwd time: 14.4385 / Avg. bwd time: 42.8191 / Avg. batch time: 695.5883 (ms) / GPU bubble ratio: 34.15%
[rank1]:2026-01-03 00:23:04,170 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 51.01GiB(36.48%)  tps: 5,715  tflops: 266.55  mfu: 26.95%
[rank2]:2026-01-03 00:23:04,168 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 42.23GiB(30.21%)  tps: 5,715  tflops: 266.55  mfu: 26.95%
[rank3]:2026-01-03 00:23:04,172 -  step: 200  loss:  0.4945  grad_norm: 19.6900  memory: 48.72GiB(34.84%)  tps: 5,715  tflops: 266.55  mfu: 26.95%
[rank0]:2026-01-03 00:23:04,174 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 58.66GiB(41.96%)  tps: 5,715  tflops: 266.55  mfu: 26.95%
[rank3]:2026-01-03 00:23:04,303 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0023_step200_rank3.svg
[rank3]:			> Batch Time: 695.00 ms, GPU Bubble Ratio: 33.79%, 28.72%, 37.03%, 29.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  208-42-250ms   | [S0,MB4,F]  251-13-264ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-13-327ms   | [S0,MB2,B]  334-43-377ms   | [S0,MB6,F]  377-14-391ms   | [S0,MB3,B]  398-43-441ms   | [S0,MB7,F]  441-13-455ms   | [S0,MB4,B]  461-43-504ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  588-43-631ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-223ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  287-45-333ms   | [S1,MB5,F]  333-15-349ms   | [S1,MB3,B]  351-46-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  414-45-460ms   | [S1,MB7,F]  460-15-476ms   | [S1,MB5,B]  478-45-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  605-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  161-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  246-40-287ms   | [S2,MB4,F]  287-13-301ms   | [S2,MB3,B]  310-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  373-40-414ms   | [S2,MB6,F]  414-13-428ms   | [S2,MB5,B]  437-40-477ms   | [S2,MB7,F]  477-13-491ms   | [S2,MB6,B]  500-40-541ms   | [S2,MB7,B]  564-40-605ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  75-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  137-45-183ms   | [S3,MB2,F]  183-14-198ms   | [S3,MB2,B]  200-46-246ms   | [S3,MB3,F]  246-15-261ms   | [S3,MB3,B]  263-46-309ms   | [S3,MB4,F]  310-15-325ms   | [S3,MB4,B]  327-46-373ms   | [S3,MB5,F]  373-15-388ms   | [S3,MB5,B]  390-46-436ms   | [S3,MB6,F]  437-15-452ms   | [S3,MB6,B]  454-46-500ms   | [S3,MB7,F]  500-14-515ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-03 00:25:24,864 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:25:27,627 - Avg. fwd time: 14.2540 / Avg. bwd time: 40.2114 / Avg. batch time: 567.3834 (ms) / GPU bubble ratio: 23.20%
[rank3]:2026-01-03 00:25:27,582 - Avg. fwd time: 15.4635 / Avg. bwd time: 45.8915 / Avg. batch time: 508.4606 (ms) / GPU bubble ratio: 3.47%
[rank1]:2026-01-03 00:25:27,676 - Avg. fwd time: 16.1679 / Avg. bwd time: 45.5257 / Avg. batch time: 633.4972 (ms) / GPU bubble ratio: 22.09%
[rank2]:2026-01-03 00:25:27,752 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 42.23GiB(30.21%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank0]:2026-01-03 00:25:27,724 - Avg. fwd time: 14.4410 / Avg. bwd time: 42.8355 / Avg. batch time: 695.5411 (ms) / GPU bubble ratio: 34.12%
[rank0]:2026-01-03 00:25:27,759 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 58.66GiB(41.96%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank3]:2026-01-03 00:25:27,757 -  step: 250  loss:  0.2557  grad_norm:  1.7990  memory: 48.72GiB(34.84%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank1]:2026-01-03 00:25:27,755 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 51.01GiB(36.48%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank0]:2026-01-03 00:27:48,281 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:27:51,053 - Avg. fwd time: 14.2522 / Avg. bwd time: 40.2143 / Avg. batch time: 567.2554 (ms) / GPU bubble ratio: 23.19%
[rank3]:2026-01-03 00:27:51,008 - Avg. fwd time: 15.4602 / Avg. bwd time: 45.8905 / Avg. batch time: 508.3799 (ms) / GPU bubble ratio: 3.46%
[rank1]:2026-01-03 00:27:51,104 - Avg. fwd time: 16.1685 / Avg. bwd time: 45.5304 / Avg. batch time: 633.3541 (ms) / GPU bubble ratio: 22.07%
[rank2]:2026-01-03 00:27:51,179 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 42.23GiB(30.21%)  tps: 5,712  tflops: 266.39  mfu: 26.94%
[rank3]:2026-01-03 00:27:51,184 -  step: 300  loss:  0.2809  grad_norm:  0.4396  memory: 48.72GiB(34.84%)  tps: 5,712  tflops: 266.39  mfu: 26.94%
[rank0]:2026-01-03 00:27:51,151 - Avg. fwd time: 14.4435 / Avg. bwd time: 42.8502 / Avg. batch time: 695.3913 (ms) / GPU bubble ratio: 34.09%
[rank0]:2026-01-03 00:27:51,186 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 58.66GiB(41.96%)  tps: 5,712  tflops: 266.39  mfu: 26.94%
[rank1]:2026-01-03 00:27:51,182 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 51.01GiB(36.48%)  tps: 5,712  tflops: 266.39  mfu: 26.94%
[rank3]:2026-01-03 00:27:51,318 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0027_step300_rank3.svg
[rank3]:			> Batch Time: 695.06 ms, GPU Bubble Ratio: 33.72%, 28.77%, 37.12%, 29.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  208-42-250ms   | [S0,MB4,F]  250-13-264ms   | [S0,MB1,B]  270-43-313ms   | [S0,MB5,F]  314-13-327ms   | [S0,MB2,B]  334-43-377ms   | [S0,MB6,F]  377-14-391ms   | [S0,MB3,B]  397-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  461-43-504ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  588-43-631ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-223ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  287-45-333ms   | [S1,MB5,F]  333-15-349ms   | [S1,MB3,B]  351-45-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  414-46-460ms   | [S1,MB7,F]  461-15-477ms   | [S1,MB5,B]  478-45-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  605-45-650ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  161-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  247-40-287ms   | [S2,MB4,F]  287-13-301ms   | [S2,MB3,B]  310-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  374-40-414ms   | [S2,MB6,F]  414-13-428ms   | [S2,MB5,B]  437-40-477ms   | [S2,MB7,F]  477-13-491ms   | [S2,MB6,B]  500-40-541ms   | [S2,MB7,B]  564-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  75-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  137-45-183ms   | [S3,MB2,F]  183-14-198ms   | [S3,MB2,B]  200-46-246ms   | [S3,MB3,F]  246-15-261ms   | [S3,MB3,B]  264-46-310ms   | [S3,MB4,F]  310-15-325ms   | [S3,MB4,B]  327-46-373ms   | [S3,MB5,F]  373-15-389ms   | [S3,MB5,B]  390-46-437ms   | [S3,MB6,F]  437-15-452ms   | [S3,MB6,B]  454-46-500ms   | [S3,MB7,F]  500-15-515ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-03 00:30:11,920 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:30:14,653 - Avg. fwd time: 15.4594 / Avg. bwd time: 45.8931 / Avg. batch time: 508.3614 (ms) / GPU bubble ratio: 3.45%
[rank1]:2026-01-03 00:30:14,749 - Avg. fwd time: 16.1706 / Avg. bwd time: 45.5364 / Avg. batch time: 633.3502 (ms) / GPU bubble ratio: 22.06%
[rank2]:2026-01-03 00:30:14,699 - Avg. fwd time: 14.2536 / Avg. bwd time: 40.2208 / Avg. batch time: 567.2609 (ms) / GPU bubble ratio: 23.18%
[rank0]:2026-01-03 00:30:14,796 - Avg. fwd time: 14.4470 / Avg. bwd time: 42.8598 / Avg. batch time: 695.3802 (ms) / GPU bubble ratio: 34.07%
[rank1]:2026-01-03 00:30:14,827 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 51.01GiB(36.48%)  tps: 5,703  tflops: 265.99  mfu: 26.89%
[rank2]:2026-01-03 00:30:14,825 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 42.23GiB(30.21%)  tps: 5,703  tflops: 265.99  mfu: 26.89%
[rank3]:2026-01-03 00:30:14,830 -  step: 350  loss:  0.3283  grad_norm:  0.5292  memory: 48.72GiB(34.84%)  tps: 5,703  tflops: 265.99  mfu: 26.89%
[rank0]:2026-01-03 00:30:14,831 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 58.66GiB(41.96%)  tps: 5,703  tflops: 265.99  mfu: 26.89%
[rank0]:2026-01-03 00:32:35,352 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:32:38,093 - Avg. fwd time: 15.4579 / Avg. bwd time: 45.8929 / Avg. batch time: 508.3224 (ms) / GPU bubble ratio: 3.45%
[rank2]:2026-01-03 00:32:38,139 - Avg. fwd time: 14.2530 / Avg. bwd time: 40.2249 / Avg. batch time: 567.1937 (ms) / GPU bubble ratio: 23.16%
[rank0]:2026-01-03 00:32:38,236 - Avg. fwd time: 14.4507 / Avg. bwd time: 42.8677 / Avg. batch time: 695.3019 (ms) / GPU bubble ratio: 34.05%
[rank1]:2026-01-03 00:32:38,189 - Avg. fwd time: 16.1719 / Avg. bwd time: 45.5404 / Avg. batch time: 633.2739 (ms) / GPU bubble ratio: 22.04%
[rank1]:2026-01-03 00:32:38,268 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 51.01GiB(36.48%)  tps: 5,711  tflops: 266.37  mfu: 26.93%
[rank2]:2026-01-03 00:32:38,266 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 42.23GiB(30.21%)  tps: 5,711  tflops: 266.37  mfu: 26.93%
[rank3]:2026-01-03 00:32:38,270 -  step: 400  loss:  0.2626  grad_norm:  0.3711  memory: 48.72GiB(34.84%)  tps: 5,711  tflops: 266.37  mfu: 26.93%
[rank0]:2026-01-03 00:32:38,272 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 58.66GiB(41.96%)  tps: 5,711  tflops: 266.37  mfu: 26.93%
[rank3]:2026-01-03 00:32:38,403 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0032_step400_rank3.svg
[rank3]:			> Batch Time: 695.53 ms, GPU Bubble Ratio: 33.77%, 28.80%, 37.17%, 29.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  208-42-250ms   | [S0,MB4,F]  250-13-264ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-13-328ms   | [S0,MB2,B]  334-43-377ms   | [S0,MB6,F]  378-14-392ms   | [S0,MB3,B]  398-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  461-43-504ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  587-43-630ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-223ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  288-45-334ms   | [S1,MB5,F]  334-15-350ms   | [S1,MB3,B]  351-45-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  414-46-460ms   | [S1,MB7,F]  461-15-477ms   | [S1,MB5,B]  478-46-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  605-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  161-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  247-40-287ms   | [S2,MB4,F]  287-13-301ms   | [S2,MB3,B]  310-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  373-40-414ms   | [S2,MB6,F]  414-13-428ms   | [S2,MB5,B]  437-40-477ms   | [S2,MB7,F]  477-13-491ms   | [S2,MB6,B]  500-40-541ms   | [S2,MB7,B]  565-40-605ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB0,B]  75-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-45-183ms   | [S3,MB2,F]  183-14-198ms   | [S3,MB2,B]  200-46-246ms   | [S3,MB3,F]  247-14-261ms   | [S3,MB3,B]  263-46-310ms   | [S3,MB4,F]  310-15-325ms   | [S3,MB4,B]  327-46-373ms   | [S3,MB5,F]  373-14-388ms   | [S3,MB5,B]  390-46-436ms   | [S3,MB6,F]  437-15-452ms   | [S3,MB6,B]  454-46-500ms   | [S3,MB7,F]  500-15-515ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-03 00:34:58,827 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:35:01,554 - Avg. fwd time: 15.4549 / Avg. bwd time: 45.8907 / Avg. batch time: 508.2615 (ms) / GPU bubble ratio: 3.44%
[rank2]:2026-01-03 00:35:01,600 - Avg. fwd time: 14.2523 / Avg. bwd time: 40.2288 / Avg. batch time: 567.1502 (ms) / GPU bubble ratio: 23.15%
[rank1]:2026-01-03 00:35:01,650 - Avg. fwd time: 16.1724 / Avg. bwd time: 45.5426 / Avg. batch time: 633.2228 (ms) / GPU bubble ratio: 22.03%
[rank2]:2026-01-03 00:35:01,727 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 42.23GiB(30.21%)  tps: 5,710  tflops: 266.33  mfu: 26.93%
[rank0]:2026-01-03 00:35:01,698 - Avg. fwd time: 14.4525 / Avg. bwd time: 42.8736 / Avg. batch time: 695.2470 (ms) / GPU bubble ratio: 34.04%
[rank0]:2026-01-03 00:35:01,733 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 58.66GiB(41.96%)  tps: 5,710  tflops: 266.33  mfu: 26.93%
[rank3]:2026-01-03 00:35:01,732 -  step: 450  loss:  0.2786  grad_norm:  0.3552  memory: 48.72GiB(34.84%)  tps: 5,710  tflops: 266.33  mfu: 26.93%
[rank1]:2026-01-03 00:35:01,730 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 51.01GiB(36.48%)  tps: 5,710  tflops: 266.33  mfu: 26.93%
[rank0]:2026-01-03 00:37:22,237 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:37:24,964 - Avg. fwd time: 15.4532 / Avg. bwd time: 45.8895 / Avg. batch time: 508.2233 (ms) / GPU bubble ratio: 3.44%
[rank2]:2026-01-03 00:37:25,010 - Avg. fwd time: 14.2511 / Avg. bwd time: 40.2308 / Avg. batch time: 567.0891 (ms) / GPU bubble ratio: 23.14%
[rank1]:2026-01-03 00:37:25,061 - Avg. fwd time: 16.1731 / Avg. bwd time: 45.5448 / Avg. batch time: 633.1558 (ms) / GPU bubble ratio: 22.02%
[rank3]:2026-01-03 00:37:25,143 -  step: 500  loss:  0.2718  grad_norm:  0.3576  memory: 48.72GiB(34.84%)  tps: 5,712  tflops: 266.42  mfu: 26.94%
[rank0]:2026-01-03 00:37:25,109 - Avg. fwd time: 14.4537 / Avg. bwd time: 42.8789 / Avg. batch time: 695.1770 (ms) / GPU bubble ratio: 34.02%
[rank0]:2026-01-03 00:37:25,144 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 58.66GiB(41.96%)  tps: 5,712  tflops: 266.42  mfu: 26.94%
[rank1]:2026-01-03 00:37:25,140 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 51.01GiB(36.48%)  tps: 5,712  tflops: 266.42  mfu: 26.94%
[rank2]:2026-01-03 00:37:25,138 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 42.23GiB(30.21%)  tps: 5,712  tflops: 266.42  mfu: 26.94%
[rank3]:2026-01-03 00:37:25,277 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0037_step500_rank3.svg
[rank3]:			> Batch Time: 695.00 ms, GPU Bubble Ratio: 33.67%, 28.72%, 37.08%, 29.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB0,B]  207-42-250ms   | [S0,MB4,F]  250-13-264ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-13-328ms   | [S0,MB2,B]  335-43-378ms   | [S0,MB6,F]  378-14-392ms   | [S0,MB3,B]  398-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  461-43-505ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  588-43-631ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-222ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  288-45-334ms   | [S1,MB5,F]  334-15-350ms   | [S1,MB3,B]  351-45-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  414-46-460ms   | [S1,MB7,F]  461-15-477ms   | [S1,MB5,B]  478-45-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  605-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  161-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  247-40-288ms   | [S2,MB4,F]  288-13-302ms   | [S2,MB3,B]  310-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  374-40-414ms   | [S2,MB6,F]  414-13-428ms   | [S2,MB5,B]  437-40-478ms   | [S2,MB7,F]  478-13-492ms   | [S2,MB6,B]  501-40-541ms   | [S2,MB7,B]  564-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB0,B]  75-45-121ms    | [S3,MB1,F]  121-14-135ms   | [S3,MB1,B]  137-45-183ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-247ms   | [S3,MB3,F]  247-15-262ms   | [S3,MB3,B]  264-46-310ms   | [S3,MB4,F]  310-15-325ms   | [S3,MB4,B]  327-46-373ms   | [S3,MB5,F]  374-15-389ms   | [S3,MB5,B]  391-46-437ms   | [S3,MB6,F]  437-14-452ms   | [S3,MB6,B]  454-46-500ms   | [S3,MB7,F]  500-15-515ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-03 00:39:45,433 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:39:48,148 - Avg. fwd time: 15.4499 / Avg. bwd time: 45.8858 / Avg. batch time: 508.1540 (ms) / GPU bubble ratio: 3.44%
[rank2]:2026-01-03 00:39:48,195 - Avg. fwd time: 14.2487 / Avg. bwd time: 40.2314 / Avg. batch time: 567.0350 (ms) / GPU bubble ratio: 23.14%
[rank1]:2026-01-03 00:39:48,246 - Avg. fwd time: 16.1732 / Avg. bwd time: 45.5459 / Avg. batch time: 633.0961 (ms) / GPU bubble ratio: 22.01%
[rank0]:2026-01-03 00:39:48,294 - Avg. fwd time: 14.4540 / Avg. bwd time: 42.8835 / Avg. batch time: 695.1169 (ms) / GPU bubble ratio: 34.01%
[rank0]:2026-01-03 00:39:48,330 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 58.66GiB(41.96%)  tps: 5,721  tflops: 266.84  mfu: 26.98%
[rank3]:2026-01-03 00:39:48,328 -  step: 550  loss:  0.1622  grad_norm:  0.2790  memory: 48.72GiB(34.84%)  tps: 5,721  tflops: 266.84  mfu: 26.98%
[rank2]:2026-01-03 00:39:48,323 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 42.23GiB(30.21%)  tps: 5,721  tflops: 266.84  mfu: 26.98%
[rank1]:2026-01-03 00:39:48,325 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 51.01GiB(36.48%)  tps: 5,721  tflops: 266.84  mfu: 26.98%
[rank0]:2026-01-03 00:42:09,708 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:42:12,531 - Avg. fwd time: 14.2581 / Avg. bwd time: 40.2423 / Avg. batch time: 567.2452 (ms) / GPU bubble ratio: 23.14%
[rank3]:2026-01-03 00:42:12,485 - Avg. fwd time: 15.4598 / Avg. bwd time: 45.9033 / Avg. batch time: 508.3637 (ms) / GPU bubble ratio: 3.43%
[rank1]:2026-01-03 00:42:12,582 - Avg. fwd time: 16.1856 / Avg. bwd time: 45.5596 / Avg. batch time: 633.3246 (ms) / GPU bubble ratio: 22.01%
[rank0]:2026-01-03 00:42:12,631 - Avg. fwd time: 14.4669 / Avg. bwd time: 42.8980 / Avg. batch time: 695.3648 (ms) / GPU bubble ratio: 34.00%
[rank1]:2026-01-03 00:42:12,662 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 51.01GiB(36.48%)  tps: 5,676  tflops: 264.71  mfu: 26.77%
[rank2]:2026-01-03 00:42:12,660 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 42.23GiB(30.21%)  tps: 5,676  tflops: 264.71  mfu: 26.77%
[rank0]:2026-01-03 00:42:12,666 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 58.66GiB(41.96%)  tps: 5,676  tflops: 264.71  mfu: 26.77%
[rank3]:2026-01-03 00:42:12,664 -  step: 600  loss:  0.4080  grad_norm:  0.7070  memory: 48.72GiB(34.84%)  tps: 5,676  tflops: 264.71  mfu: 26.77%
[rank3]:2026-01-03 00:42:12,799 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0042_step600_rank3.svg
[rank3]:			> Batch Time: 701.19 ms, GPU Bubble Ratio: 33.77%, 28.78%, 37.19%, 29.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  209-43-252ms   | [S0,MB4,F]  252-14-266ms   | [S0,MB1,B]  273-43-316ms   | [S0,MB5,F]  316-14-330ms   | [S0,MB2,B]  337-43-380ms   | [S0,MB6,F]  380-14-394ms   | [S0,MB3,B]  401-43-444ms   | [S0,MB7,F]  444-14-458ms   | [S0,MB4,B]  465-43-508ms   | [S0,MB5,B]  529-43-572ms   | [S0,MB6,B]  593-43-636ms   | [S0,MB7,B]  658-43-701ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  163-45-208ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  226-45-272ms   | [S1,MB4,F]  272-16-288ms   | [S1,MB2,B]  290-46-336ms   | [S1,MB5,F]  336-16-352ms   | [S1,MB3,B]  354-46-400ms   | [S1,MB6,F]  400-16-417ms   | [S1,MB4,B]  418-46-464ms   | [S1,MB7,F]  464-16-481ms   | [S1,MB5,B]  482-46-529ms   | [S1,MB6,B]  546-45-592ms   | [S1,MB7,B]  611-45-657ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB0,B]  122-40-163ms   | [S2,MB2,F]  163-13-177ms   | [S2,MB1,B]  186-40-226ms   | [S2,MB3,F]  226-14-240ms   | [S2,MB2,B]  249-40-290ms   | [S2,MB4,F]  290-14-304ms   | [S2,MB3,B]  313-40-354ms   | [S2,MB5,F]  354-14-368ms   | [S2,MB4,B]  377-40-418ms   | [S2,MB6,F]  418-14-432ms   | [S2,MB5,B]  441-40-482ms   | [S2,MB7,F]  482-14-496ms   | [S2,MB6,B]  505-40-546ms   | [S2,MB7,B]  570-40-610ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB0,B]  76-45-122ms    | [S3,MB1,F]  122-14-137ms   | [S3,MB1,B]  139-46-185ms   | [S3,MB2,F]  185-15-201ms   | [S3,MB2,B]  203-46-249ms   | [S3,MB3,F]  249-15-264ms   | [S3,MB3,B]  266-46-313ms   | [S3,MB4,F]  313-15-328ms   | [S3,MB4,B]  330-46-377ms   | [S3,MB5,F]  377-15-392ms   | [S3,MB5,B]  394-46-441ms   | [S3,MB6,F]  441-15-456ms   | [S3,MB6,B]  458-46-505ms   | [S3,MB7,F]  505-15-520ms   | [S3,MB7,B]  522-46-569ms  
[rank0]:2026-01-03 00:44:35,159 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 00:44:37,957 - Avg. fwd time: 14.2738 / Avg. bwd time: 40.2577 / Avg. batch time: 567.6558 (ms) / GPU bubble ratio: 23.15%
[rank3]:2026-01-03 00:44:37,910 - Avg. fwd time: 15.4775 / Avg. bwd time: 45.9323 / Avg. batch time: 508.7313 (ms) / GPU bubble ratio: 3.43%
[rank1]:2026-01-03 00:44:38,008 - Avg. fwd time: 16.2030 / Avg. bwd time: 45.5766 / Avg. batch time: 633.7639 (ms) / GPU bubble ratio: 22.02%
[rank0]:2026-01-03 00:44:38,057 - Avg. fwd time: 14.4843 / Avg. bwd time: 42.9134 / Avg. batch time: 695.8279 (ms) / GPU bubble ratio: 34.01%
[rank1]:2026-01-03 00:44:38,088 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 51.01GiB(36.48%)  tps: 5,633  tflops: 262.73  mfu: 26.57%
[rank2]:2026-01-03 00:44:38,085 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 42.23GiB(30.21%)  tps: 5,633  tflops: 262.73  mfu: 26.57%
[rank0]:2026-01-03 00:44:38,092 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 58.66GiB(41.96%)  tps: 5,633  tflops: 262.73  mfu: 26.57%
[rank3]:2026-01-03 00:44:38,090 -  step: 650  loss:  0.2718  grad_norm:  0.5331  memory: 48.72GiB(34.84%)  tps: 5,633  tflops: 262.73  mfu: 26.57%
[rank0]:2026-01-03 00:47:00,501 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:47:03,280 - Avg. fwd time: 15.4926 / Avg. bwd time: 45.9569 / Avg. batch time: 509.0441 (ms) / GPU bubble ratio: 3.43%
[rank2]:2026-01-03 00:47:03,327 - Avg. fwd time: 14.2873 / Avg. bwd time: 40.2705 / Avg. batch time: 567.9785 (ms) / GPU bubble ratio: 23.16%
[rank1]:2026-01-03 00:47:03,378 - Avg. fwd time: 16.2179 / Avg. bwd time: 45.5913 / Avg. batch time: 634.1113 (ms) / GPU bubble ratio: 22.02%
[rank1]:2026-01-03 00:47:03,458 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 51.01GiB(36.48%)  tps: 5,635  tflops: 262.83  mfu: 26.58%
[rank2]:2026-01-03 00:47:03,456 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 42.23GiB(30.21%)  tps: 5,635  tflops: 262.83  mfu: 26.58%
[rank0]:2026-01-03 00:47:03,427 - Avg. fwd time: 14.4997 / Avg. bwd time: 42.9260 / Avg. batch time: 696.1961 (ms) / GPU bubble ratio: 34.01%
[rank0]:2026-01-03 00:47:03,462 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 58.66GiB(41.96%)  tps: 5,635  tflops: 262.83  mfu: 26.58%
[rank3]:2026-01-03 00:47:03,460 -  step: 700  loss:  0.3478  grad_norm:  0.5993  memory: 48.72GiB(34.84%)  tps: 5,635  tflops: 262.83  mfu: 26.58%
[rank3]:2026-01-03 00:47:03,594 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0047_step700_rank3.svg
[rank3]:			> Batch Time: 702.19 ms, GPU Bubble Ratio: 33.85%, 28.86%, 37.19%, 29.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  210-43-253ms   | [S0,MB4,F]  253-14-267ms   | [S0,MB1,B]  273-43-317ms   | [S0,MB5,F]  317-14-331ms   | [S0,MB2,B]  338-43-381ms   | [S0,MB6,F]  382-14-396ms   | [S0,MB3,B]  402-43-446ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  466-43-509ms   | [S0,MB5,B]  530-43-573ms   | [S0,MB6,B]  594-43-637ms   | [S0,MB7,B]  659-43-702ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-209ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  227-45-273ms   | [S1,MB4,F]  273-16-289ms   | [S1,MB2,B]  291-46-337ms   | [S1,MB5,F]  337-16-354ms   | [S1,MB3,B]  355-46-401ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  419-46-465ms   | [S1,MB7,F]  465-16-482ms   | [S1,MB5,B]  483-46-529ms   | [S1,MB6,B]  547-45-593ms   | [S1,MB7,B]  612-45-658ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-163ms   | [S2,MB2,F]  163-13-177ms   | [S2,MB1,B]  186-40-227ms   | [S2,MB3,F]  227-14-241ms   | [S2,MB2,B]  250-40-291ms   | [S2,MB4,F]  291-14-305ms   | [S2,MB3,B]  314-40-355ms   | [S2,MB5,F]  355-14-369ms   | [S2,MB4,B]  378-40-419ms   | [S2,MB6,F]  419-14-433ms   | [S2,MB5,B]  442-40-483ms   | [S2,MB7,F]  483-14-497ms   | [S2,MB6,B]  506-40-547ms   | [S2,MB7,B]  571-40-611ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-137ms   | [S3,MB1,B]  139-46-186ms   | [S3,MB2,F]  186-15-201ms   | [S3,MB2,B]  203-46-250ms   | [S3,MB3,F]  250-15-265ms   | [S3,MB3,B]  267-46-314ms   | [S3,MB4,F]  314-15-329ms   | [S3,MB4,B]  331-46-378ms   | [S3,MB5,F]  378-15-393ms   | [S3,MB5,B]  395-46-442ms   | [S3,MB6,F]  442-15-457ms   | [S3,MB6,B]  459-46-506ms   | [S3,MB7,F]  506-15-521ms   | [S3,MB7,B]  523-46-570ms  
[rank0]:2026-01-03 00:49:25,396 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:49:28,134 - Avg. fwd time: 15.5012 / Avg. bwd time: 45.9718 / Avg. batch time: 509.2264 (ms) / GPU bubble ratio: 3.43%
[rank2]:2026-01-03 00:49:28,181 - Avg. fwd time: 14.2953 / Avg. bwd time: 40.2787 / Avg. batch time: 568.1884 (ms) / GPU bubble ratio: 23.16%
[rank1]:2026-01-03 00:49:28,234 - Avg. fwd time: 16.2268 / Avg. bwd time: 45.6004 / Avg. batch time: 634.3358 (ms) / GPU bubble ratio: 22.03%
[rank0]:2026-01-03 00:49:28,283 - Avg. fwd time: 14.5088 / Avg. bwd time: 42.9340 / Avg. batch time: 696.4335 (ms) / GPU bubble ratio: 34.01%
[rank0]:2026-01-03 00:49:28,318 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 58.66GiB(41.96%)  tps: 5,655  tflops: 263.76  mfu: 26.67%
[rank3]:2026-01-03 00:49:28,316 -  step: 750  loss:  0.1444  grad_norm:  0.4049  memory: 48.72GiB(34.84%)  tps: 5,655  tflops: 263.77  mfu: 26.67%
[rank1]:2026-01-03 00:49:28,314 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 51.01GiB(36.48%)  tps: 5,655  tflops: 263.76  mfu: 26.67%
[rank2]:2026-01-03 00:49:28,312 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 42.23GiB(30.21%)  tps: 5,655  tflops: 263.76  mfu: 26.67%
[rank0]:2026-01-03 00:51:49,017 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:51:51,791 - Avg. fwd time: 15.5011 / Avg. bwd time: 45.9722 / Avg. batch time: 509.2229 (ms) / GPU bubble ratio: 3.42%
[rank1]:2026-01-03 00:51:51,890 - Avg. fwd time: 16.2272 / Avg. bwd time: 45.6019 / Avg. batch time: 634.3224 (ms) / GPU bubble ratio: 22.02%
[rank2]:2026-01-03 00:51:51,838 - Avg. fwd time: 14.2960 / Avg. bwd time: 40.2804 / Avg. batch time: 568.1745 (ms) / GPU bubble ratio: 23.16%
[rank0]:2026-01-03 00:51:51,939 - Avg. fwd time: 14.5095 / Avg. bwd time: 42.9359 / Avg. batch time: 696.4195 (ms) / GPU bubble ratio: 34.01%
[rank1]:2026-01-03 00:51:51,971 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 51.01GiB(36.48%)  tps: 5,702  tflops: 265.97  mfu: 26.89%
[rank2]:2026-01-03 00:51:51,968 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 42.23GiB(30.21%)  tps: 5,702  tflops: 265.97  mfu: 26.89%
[rank3]:2026-01-03 00:51:51,973 -  step: 800  loss:  0.2657  grad_norm:  0.5742  memory: 48.72GiB(34.84%)  tps: 5,703  tflops: 265.97  mfu: 26.89%
[rank0]:2026-01-03 00:51:51,975 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 58.66GiB(41.96%)  tps: 5,702  tflops: 265.96  mfu: 26.89%
[rank3]:2026-01-03 00:51:52,105 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0051_step800_rank3.svg
[rank3]:			> Batch Time: 697.06 ms, GPU Bubble Ratio: 33.76%, 28.77%, 37.10%, 29.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-32ms     | [S0,MB2,F]  31-14-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB0,B]  208-42-251ms   | [S0,MB4,F]  251-13-265ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  315-13-328ms   | [S0,MB2,B]  335-43-379ms   | [S0,MB6,F]  379-14-393ms   | [S0,MB3,B]  399-43-442ms   | [S0,MB7,F]  442-14-456ms   | [S0,MB4,B]  463-43-506ms   | [S0,MB5,B]  526-43-569ms   | [S0,MB6,B]  589-43-632ms   | [S0,MB7,B]  654-43-697ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  208-15-223ms   | [S1,MB1,B]  225-45-271ms   | [S1,MB4,F]  271-15-287ms   | [S1,MB2,B]  289-46-335ms   | [S1,MB5,F]  335-15-351ms   | [S1,MB3,B]  352-46-398ms   | [S1,MB6,F]  398-16-414ms   | [S1,MB4,B]  416-46-462ms   | [S1,MB7,F]  462-16-478ms   | [S1,MB5,B]  479-46-525ms   | [S1,MB6,B]  542-45-588ms   | [S1,MB7,B]  607-45-653ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-40-162ms   | [S2,MB2,F]  162-13-176ms   | [S2,MB1,B]  184-40-225ms   | [S2,MB3,F]  225-13-239ms   | [S2,MB2,B]  248-40-288ms   | [S2,MB4,F]  289-13-303ms   | [S2,MB3,B]  311-40-352ms   | [S2,MB5,F]  352-13-366ms   | [S2,MB4,B]  375-40-416ms   | [S2,MB6,F]  416-13-430ms   | [S2,MB5,B]  438-40-479ms   | [S2,MB7,F]  479-13-493ms   | [S2,MB6,B]  502-40-543ms   | [S2,MB7,B]  566-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-46-184ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-248ms   | [S3,MB3,F]  248-15-263ms   | [S3,MB3,B]  265-46-311ms   | [S3,MB4,F]  311-15-326ms   | [S3,MB4,B]  328-46-375ms   | [S3,MB5,F]  375-15-390ms   | [S3,MB5,B]  392-46-438ms   | [S3,MB6,F]  438-15-453ms   | [S3,MB6,B]  455-46-502ms   | [S3,MB7,F]  502-15-517ms   | [S3,MB7,B]  519-46-565ms  
[rank0]:2026-01-03 00:54:13,199 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:54:15,930 - Avg. fwd time: 15.5042 / Avg. bwd time: 45.9780 / Avg. batch time: 509.2892 (ms) / GPU bubble ratio: 3.42%
[rank1]:2026-01-03 00:54:16,030 - Avg. fwd time: 16.2313 / Avg. bwd time: 45.6047 / Avg. batch time: 634.4109 (ms) / GPU bubble ratio: 22.02%
[rank2]:2026-01-03 00:54:15,978 - Avg. fwd time: 14.2996 / Avg. bwd time: 40.2835 / Avg. batch time: 568.2581 (ms) / GPU bubble ratio: 23.16%
[rank0]:2026-01-03 00:54:16,080 - Avg. fwd time: 14.5135 / Avg. bwd time: 42.9392 / Avg. batch time: 696.5109 (ms) / GPU bubble ratio: 34.01%
[rank1]:2026-01-03 00:54:16,111 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 51.01GiB(36.48%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank2]:2026-01-03 00:54:16,109 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 42.23GiB(30.21%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank0]:2026-01-03 00:54:16,115 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 58.66GiB(41.96%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank3]:2026-01-03 00:54:16,113 -  step: 850  loss:  0.1216  grad_norm:  0.3777  memory: 48.72GiB(34.84%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank0]:2026-01-03 00:56:35,793 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:56:38,528 - Avg. fwd time: 15.4970 / Avg. bwd time: 45.9678 / Avg. batch time: 509.1452 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 00:56:38,576 - Avg. fwd time: 14.2952 / Avg. bwd time: 40.2802 / Avg. batch time: 568.0955 (ms) / GPU bubble ratio: 23.15%
[rank1]:2026-01-03 00:56:38,628 - Avg. fwd time: 16.2272 / Avg. bwd time: 45.6008 / Avg. batch time: 634.2391 (ms) / GPU bubble ratio: 22.01%
[rank0]:2026-01-03 00:56:38,677 - Avg. fwd time: 14.5093 / Avg. bwd time: 42.9366 / Avg. batch time: 696.3309 (ms) / GPU bubble ratio: 34.00%
[rank2]:2026-01-03 00:56:38,706 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 42.23GiB(30.21%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank1]:2026-01-03 00:56:38,708 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 51.01GiB(36.48%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank3]:2026-01-03 00:56:38,710 -  step: 900  loss:  0.1849  grad_norm:  0.4090  memory: 48.72GiB(34.84%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank0]:2026-01-03 00:56:38,712 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 58.66GiB(41.96%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank3]:2026-01-03 00:56:38,842 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0056_step900_rank3.svg
[rank3]:			> Batch Time: 694.03 ms, GPU Bubble Ratio: 33.53%, 28.56%, 36.94%, 29.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  208-42-250ms   | [S0,MB4,F]  251-13-264ms   | [S0,MB1,B]  270-43-313ms   | [S0,MB5,F]  314-14-328ms   | [S0,MB2,B]  334-43-377ms   | [S0,MB6,F]  377-14-391ms   | [S0,MB3,B]  397-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  461-43-504ms   | [S0,MB5,B]  524-43-567ms   | [S0,MB6,B]  587-43-630ms   | [S0,MB7,B]  651-43-694ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-223ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  287-45-333ms   | [S1,MB5,F]  333-15-349ms   | [S1,MB3,B]  351-45-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  414-46-460ms   | [S1,MB7,F]  460-15-476ms   | [S1,MB5,B]  477-46-523ms   | [S1,MB6,B]  540-45-586ms   | [S1,MB7,B]  604-45-650ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  162-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  247-40-287ms   | [S2,MB4,F]  287-13-301ms   | [S2,MB3,B]  310-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  373-40-414ms   | [S2,MB6,F]  414-13-428ms   | [S2,MB5,B]  436-40-477ms   | [S2,MB7,F]  477-14-491ms   | [S2,MB6,B]  500-40-540ms   | [S2,MB7,B]  563-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-45-184ms   | [S3,MB2,F]  184-14-199ms   | [S3,MB2,B]  201-46-247ms   | [S3,MB3,F]  247-15-262ms   | [S3,MB3,B]  264-46-310ms   | [S3,MB4,F]  310-15-325ms   | [S3,MB4,B]  327-46-373ms   | [S3,MB5,F]  373-15-388ms   | [S3,MB5,B]  390-46-436ms   | [S3,MB6,F]  436-15-451ms   | [S3,MB6,B]  453-46-499ms   | [S3,MB7,F]  499-15-514ms   | [S3,MB7,B]  516-46-563ms  
[rank0]:2026-01-03 00:58:59,523 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 00:59:02,277 - Avg. fwd time: 15.4979 / Avg. bwd time: 45.9701 / Avg. batch time: 509.1662 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 00:59:02,325 - Avg. fwd time: 14.2969 / Avg. bwd time: 40.2823 / Avg. batch time: 568.1289 (ms) / GPU bubble ratio: 23.15%
[rank1]:2026-01-03 00:59:02,377 - Avg. fwd time: 16.2289 / Avg. bwd time: 45.6025 / Avg. batch time: 634.2738 (ms) / GPU bubble ratio: 22.01%
[rank0]:2026-01-03 00:59:02,427 - Avg. fwd time: 14.5112 / Avg. bwd time: 42.9383 / Avg. batch time: 696.3664 (ms) / GPU bubble ratio: 34.00%
[rank2]:2026-01-03 00:59:02,456 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 42.23GiB(30.21%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank1]:2026-01-03 00:59:02,459 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 51.01GiB(36.48%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank0]:2026-01-03 00:59:02,463 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 58.66GiB(41.96%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank3]:2026-01-03 00:59:02,461 -  step: 950  loss:  0.2463  grad_norm:  0.7322  memory: 48.72GiB(34.84%)  tps: 5,699  tflops: 265.79  mfu: 26.87%
[rank0]:2026-01-03 01:01:23,609 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:01:26,341 - Avg. fwd time: 15.5007 / Avg. bwd time: 45.9745 / Avg. batch time: 509.2213 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 01:01:26,389 - Avg. fwd time: 14.3002 / Avg. bwd time: 40.2857 / Avg. batch time: 568.1804 (ms) / GPU bubble ratio: 23.14%
[rank1]:2026-01-03 01:01:26,441 - Avg. fwd time: 16.2317 / Avg. bwd time: 45.6058 / Avg. batch time: 634.3291 (ms) / GPU bubble ratio: 22.01%
[rank3]:2026-01-03 01:01:26,524 -  step: 1000  loss:  0.1516  grad_norm:  0.2949  memory: 48.72GiB(34.84%)  tps: 5,686  tflops: 265.22  mfu: 26.82%
[rank3]:2026-01-03 01:01:26,525 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 01:01:26,491 - Avg. fwd time: 14.5139 / Avg. bwd time: 42.9407 / Avg. batch time: 696.4240 (ms) / GPU bubble ratio: 34.00%
[rank0]:2026-01-03 01:01:26,526 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 58.66GiB(41.96%)  tps: 5,686  tflops: 265.21  mfu: 26.82%
[rank0]:2026-01-03 01:01:26,526 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 01:01:26,526 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-03 01:01:26,520 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 42.23GiB(30.21%)  tps: 5,686  tflops: 265.21  mfu: 26.82%
[rank2]:2026-01-03 01:01:26,520 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-03 01:01:26,522 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 51.01GiB(36.48%)  tps: 5,686  tflops: 265.21  mfu: 26.82%
[rank1]:2026-01-03 01:01:26,522 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 01:01:37,182 - Finished saving the checkpoint (or staging if async is enabled)in 10.66 seconds.
[rank3]:2026-01-03 01:01:39,523 - Finished saving the checkpoint (or staging if async is enabled)in 13.00 seconds.
[rank0]:2026-01-03 01:01:40,815 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-03 01:01:40,816 - Finished saving the checkpoint (or staging if async is enabled)in 14.29 seconds.
[rank1]:2026-01-03 01:01:42,480 - Finished saving the checkpoint (or staging if async is enabled)in 15.96 seconds.
[rank3]:2026-01-03 01:01:42,675 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0101_step1000_rank3.svg
[rank3]:			> Batch Time: 697.53 ms, GPU Bubble Ratio: 33.76%, 28.77%, 37.12%, 29.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  208-42-251ms   | [S0,MB4,F]  251-13-265ms   | [S0,MB1,B]  272-43-315ms   | [S0,MB5,F]  315-13-329ms   | [S0,MB2,B]  336-43-379ms   | [S0,MB6,F]  379-14-393ms   | [S0,MB3,B]  399-43-442ms   | [S0,MB7,F]  442-14-456ms   | [S0,MB4,B]  463-43-506ms   | [S0,MB5,B]  527-43-570ms   | [S0,MB6,B]  590-43-633ms   | [S0,MB7,B]  654-43-697ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB0,B]  162-45-208ms   | [S1,MB3,F]  208-15-224ms   | [S1,MB1,B]  225-45-271ms   | [S1,MB4,F]  271-15-287ms   | [S1,MB2,B]  289-45-335ms   | [S1,MB5,F]  335-15-351ms   | [S1,MB3,B]  352-46-398ms   | [S1,MB6,F]  399-15-415ms   | [S1,MB4,B]  416-46-462ms   | [S1,MB7,F]  462-15-478ms   | [S1,MB5,B]  480-46-526ms   | [S1,MB6,B]  543-45-589ms   | [S1,MB7,B]  607-45-653ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-40-162ms   | [S2,MB2,F]  162-13-176ms   | [S2,MB1,B]  185-40-225ms   | [S2,MB3,F]  225-13-239ms   | [S2,MB2,B]  248-40-289ms   | [S2,MB4,F]  289-13-303ms   | [S2,MB3,B]  312-40-352ms   | [S2,MB5,F]  352-13-366ms   | [S2,MB4,B]  376-40-416ms   | [S2,MB6,F]  416-14-430ms   | [S2,MB5,B]  439-40-480ms   | [S2,MB7,F]  480-14-494ms   | [S2,MB6,B]  502-40-543ms   | [S2,MB7,B]  566-40-607ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  122-14-136ms   | [S3,MB1,B]  138-46-185ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-248ms   | [S3,MB3,F]  248-15-263ms   | [S3,MB3,B]  265-46-311ms   | [S3,MB4,F]  311-15-327ms   | [S3,MB4,B]  329-46-375ms   | [S3,MB5,F]  375-15-391ms   | [S3,MB5,B]  393-46-439ms   | [S3,MB6,F]  439-15-454ms   | [S3,MB6,B]  456-46-502ms   | [S3,MB7,F]  502-15-517ms   | [S3,MB7,B]  519-46-565ms  
[rank0]:2026-01-03 01:04:06,167 - [GC] Peforming periodical GC collection 2.27 seconds
[rank3]:2026-01-03 01:04:08,944 - Avg. fwd time: 15.5016 / Avg. bwd time: 45.9925 / Avg. batch time: 509.3695 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 01:04:08,994 - Avg. fwd time: 14.3005 / Avg. bwd time: 40.2857 / Avg. batch time: 568.3535 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:04:09,047 - Avg. fwd time: 16.2315 / Avg. bwd time: 45.6067 / Avg. batch time: 634.5018 (ms) / GPU bubble ratio: 22.03%
[rank0]:2026-01-03 01:04:09,099 - Avg. fwd time: 14.5123 / Avg. bwd time: 42.9391 / Avg. batch time: 696.5951 (ms) / GPU bubble ratio: 34.02%
[rank1]:2026-01-03 01:04:09,130 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 51.01GiB(36.48%)  tps: 5,038  tflops: 234.97  mfu: 23.76%
[rank0]:2026-01-03 01:04:09,134 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 58.66GiB(41.96%)  tps: 5,038  tflops: 234.97  mfu: 23.76%
[rank3]:2026-01-03 01:04:09,133 -  step: 1050  loss:  0.2494  grad_norm:  0.8512  memory: 48.72GiB(34.84%)  tps: 5,038  tflops: 234.97  mfu: 23.76%
[rank2]:2026-01-03 01:04:09,128 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 42.23GiB(30.21%)  tps: 5,038  tflops: 234.97  mfu: 23.76%
[rank0]:2026-01-03 01:06:32,182 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:06:34,933 - Avg. fwd time: 15.5146 / Avg. bwd time: 46.0127 / Avg. batch time: 509.6413 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 01:06:34,983 - Avg. fwd time: 14.3131 / Avg. bwd time: 40.2966 / Avg. batch time: 568.6378 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:06:35,036 - Avg. fwd time: 16.2426 / Avg. bwd time: 45.6181 / Avg. batch time: 634.8061 (ms) / GPU bubble ratio: 22.04%
[rank3]:2026-01-03 01:06:35,121 -  step: 1100  loss:  0.2216  grad_norm:  0.3646  memory: 48.72GiB(34.84%)  tps: 5,611  tflops: 261.72  mfu: 26.46%
[rank0]:2026-01-03 01:06:35,088 - Avg. fwd time: 14.5233 / Avg. bwd time: 42.9464 / Avg. batch time: 696.9145 (ms) / GPU bubble ratio: 34.03%
[rank0]:2026-01-03 01:06:35,123 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 58.66GiB(41.96%)  tps: 5,611  tflops: 261.72  mfu: 26.46%
[rank2]:2026-01-03 01:06:35,117 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 42.23GiB(30.21%)  tps: 5,611  tflops: 261.72  mfu: 26.46%
[rank1]:2026-01-03 01:06:35,119 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 51.01GiB(36.48%)  tps: 5,611  tflops: 261.72  mfu: 26.46%
[rank3]:2026-01-03 01:06:35,256 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0106_step1100_rank3.svg
[rank3]:			> Batch Time: 704.66 ms, GPU Bubble Ratio: 33.99%, 28.90%, 37.19%, 29.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  210-43-253ms   | [S0,MB4,F]  253-14-267ms   | [S0,MB1,B]  274-43-317ms   | [S0,MB5,F]  317-14-331ms   | [S0,MB2,B]  338-43-381ms   | [S0,MB6,F]  382-14-396ms   | [S0,MB3,B]  403-43-446ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  466-43-510ms   | [S0,MB5,B]  531-43-574ms   | [S0,MB6,B]  595-43-638ms   | [S0,MB7,B]  661-43-704ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-209ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  227-46-273ms   | [S1,MB4,F]  273-16-289ms   | [S1,MB2,B]  291-46-337ms   | [S1,MB5,F]  337-16-353ms   | [S1,MB3,B]  356-46-402ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  420-46-466ms   | [S1,MB7,F]  466-16-482ms   | [S1,MB5,B]  484-46-530ms   | [S1,MB6,B]  549-45-595ms   | [S1,MB7,B]  614-45-660ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-163ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  186-40-227ms   | [S2,MB3,F]  227-14-241ms   | [S2,MB2,B]  250-40-291ms   | [S2,MB4,F]  291-14-305ms   | [S2,MB3,B]  314-40-355ms   | [S2,MB5,F]  355-14-370ms   | [S2,MB4,B]  378-40-419ms   | [S2,MB6,F]  419-14-434ms   | [S2,MB5,B]  443-40-484ms   | [S2,MB7,F]  484-14-498ms   | [S2,MB6,B]  507-40-548ms   | [S2,MB7,B]  573-40-614ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-123ms    | [S3,MB1,F]  123-15-138ms   | [S3,MB1,B]  140-46-186ms   | [S3,MB2,F]  186-15-201ms   | [S3,MB2,B]  203-46-250ms   | [S3,MB3,F]  250-15-265ms   | [S3,MB3,B]  267-46-314ms   | [S3,MB4,F]  314-15-329ms   | [S3,MB4,B]  331-46-378ms   | [S3,MB5,F]  378-15-394ms   | [S3,MB5,B]  396-46-442ms   | [S3,MB6,F]  443-15-458ms   | [S3,MB6,B]  460-46-507ms   | [S3,MB7,F]  507-15-523ms   | [S3,MB7,B]  525-46-571ms  
[rank0]:2026-01-03 01:08:56,496 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:08:59,239 - Avg. fwd time: 15.5174 / Avg. bwd time: 46.0167 / Avg. batch time: 509.6921 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 01:08:59,288 - Avg. fwd time: 14.3162 / Avg. bwd time: 40.3000 / Avg. batch time: 568.7015 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:08:59,342 - Avg. fwd time: 16.2449 / Avg. bwd time: 45.6207 / Avg. batch time: 634.8737 (ms) / GPU bubble ratio: 22.04%
[rank0]:2026-01-03 01:08:59,393 - Avg. fwd time: 14.5253 / Avg. bwd time: 42.9475 / Avg. batch time: 696.9834 (ms) / GPU bubble ratio: 34.03%
[rank0]:2026-01-03 01:08:59,429 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 58.66GiB(41.96%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank3]:2026-01-03 01:08:59,427 -  step: 1150  loss:  0.2111  grad_norm:  0.5336  memory: 48.72GiB(34.84%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank2]:2026-01-03 01:08:59,422 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 42.23GiB(30.21%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank1]:2026-01-03 01:08:59,425 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 51.01GiB(36.48%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank0]:2026-01-03 01:11:20,648 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 01:11:23,461 - Avg. fwd time: 14.3186 / Avg. bwd time: 40.3024 / Avg. batch time: 568.7368 (ms) / GPU bubble ratio: 23.17%
[rank3]:2026-01-03 01:11:23,411 - Avg. fwd time: 15.5197 / Avg. bwd time: 46.0196 / Avg. batch time: 509.7311 (ms) / GPU bubble ratio: 3.42%
[rank1]:2026-01-03 01:11:23,515 - Avg. fwd time: 16.2466 / Avg. bwd time: 45.6227 / Avg. batch time: 634.9140 (ms) / GPU bubble ratio: 22.04%
[rank0]:2026-01-03 01:11:23,567 - Avg. fwd time: 14.5268 / Avg. bwd time: 42.9479 / Avg. batch time: 697.0262 (ms) / GPU bubble ratio: 34.03%
[rank1]:2026-01-03 01:11:23,598 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 51.01GiB(36.48%)  tps: 5,682  tflops: 265.01  mfu: 26.80%
[rank2]:2026-01-03 01:11:23,596 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 42.23GiB(30.21%)  tps: 5,682  tflops: 265.01  mfu: 26.80%
[rank3]:2026-01-03 01:11:23,601 -  step: 1200  loss:  0.2638  grad_norm:  0.4373  memory: 48.72GiB(34.84%)  tps: 5,682  tflops: 265.01  mfu: 26.80%
[rank0]:2026-01-03 01:11:23,602 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 58.66GiB(41.96%)  tps: 5,682  tflops: 265.01  mfu: 26.80%
[rank3]:2026-01-03 01:11:23,733 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0111_step1200_rank3.svg
[rank3]:			> Batch Time: 699.56 ms, GPU Bubble Ratio: 33.94%, 28.92%, 37.18%, 29.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  208-42-251ms   | [S0,MB4,F]  251-13-265ms   | [S0,MB1,B]  272-43-315ms   | [S0,MB5,F]  315-14-329ms   | [S0,MB2,B]  336-43-379ms   | [S0,MB6,F]  380-14-394ms   | [S0,MB3,B]  400-43-443ms   | [S0,MB7,F]  443-14-457ms   | [S0,MB4,B]  464-43-507ms   | [S0,MB5,B]  528-43-571ms   | [S0,MB6,B]  591-43-634ms   | [S0,MB7,B]  656-43-699ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-208ms   | [S1,MB3,F]  208-15-223ms   | [S1,MB1,B]  226-45-271ms   | [S1,MB4,F]  271-15-287ms   | [S1,MB2,B]  290-46-336ms   | [S1,MB5,F]  336-15-352ms   | [S1,MB3,B]  353-46-399ms   | [S1,MB6,F]  399-16-415ms   | [S1,MB4,B]  417-46-464ms   | [S1,MB7,F]  463-16-479ms   | [S1,MB5,B]  481-46-527ms   | [S1,MB6,B]  545-45-590ms   | [S1,MB7,B]  609-45-654ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-40-162ms   | [S2,MB2,F]  162-13-176ms   | [S2,MB1,B]  185-40-225ms   | [S2,MB3,F]  226-13-240ms   | [S2,MB2,B]  249-40-289ms   | [S2,MB4,F]  289-14-304ms   | [S2,MB3,B]  312-40-353ms   | [S2,MB5,F]  353-14-367ms   | [S2,MB4,B]  376-40-417ms   | [S2,MB6,F]  417-14-431ms   | [S2,MB5,B]  440-40-480ms   | [S2,MB7,F]  481-14-495ms   | [S2,MB6,B]  504-40-544ms   | [S2,MB7,B]  568-40-608ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB0,B]  76-45-122ms    | [S3,MB1,F]  122-14-137ms   | [S3,MB1,B]  139-46-185ms   | [S3,MB2,F]  185-15-200ms   | [S3,MB2,B]  202-46-248ms   | [S3,MB3,F]  248-15-263ms   | [S3,MB3,B]  265-46-312ms   | [S3,MB4,F]  312-15-327ms   | [S3,MB4,B]  329-46-376ms   | [S3,MB5,F]  376-15-391ms   | [S3,MB5,B]  393-46-439ms   | [S3,MB6,F]  440-15-455ms   | [S3,MB6,B]  457-46-503ms   | [S3,MB7,F]  503-15-519ms   | [S3,MB7,B]  521-46-567ms  
[rank0]:2026-01-03 01:13:44,597 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 01:13:47,395 - Avg. fwd time: 14.3198 / Avg. bwd time: 40.3038 / Avg. batch time: 568.7534 (ms) / GPU bubble ratio: 23.17%
[rank3]:2026-01-03 01:13:47,346 - Avg. fwd time: 15.5201 / Avg. bwd time: 46.0204 / Avg. batch time: 509.7387 (ms) / GPU bubble ratio: 3.42%
[rank1]:2026-01-03 01:13:47,450 - Avg. fwd time: 16.2472 / Avg. bwd time: 45.6232 / Avg. batch time: 634.9314 (ms) / GPU bubble ratio: 22.04%
[rank0]:2026-01-03 01:13:47,502 - Avg. fwd time: 14.5274 / Avg. bwd time: 42.9480 / Avg. batch time: 697.0441 (ms) / GPU bubble ratio: 34.04%
[rank1]:2026-01-03 01:13:47,533 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 51.01GiB(36.48%)  tps: 5,691  tflops: 265.45  mfu: 26.84%
[rank2]:2026-01-03 01:13:47,531 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 42.23GiB(30.21%)  tps: 5,691  tflops: 265.45  mfu: 26.84%
[rank0]:2026-01-03 01:13:47,537 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 58.66GiB(41.96%)  tps: 5,691  tflops: 265.45  mfu: 26.84%
[rank3]:2026-01-03 01:13:47,536 -  step: 1250  loss:  0.2512  grad_norm:  0.5137  memory: 48.72GiB(34.84%)  tps: 5,692  tflops: 265.45  mfu: 26.84%
[rank0]:2026-01-03 01:16:08,563 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:16:11,301 - Avg. fwd time: 15.5211 / Avg. bwd time: 46.0221 / Avg. batch time: 509.7580 (ms) / GPU bubble ratio: 3.42%
[rank2]:2026-01-03 01:16:11,350 - Avg. fwd time: 14.3211 / Avg. bwd time: 40.3051 / Avg. batch time: 568.7669 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:16:11,405 - Avg. fwd time: 16.2483 / Avg. bwd time: 45.6246 / Avg. batch time: 634.9457 (ms) / GPU bubble ratio: 22.04%
[rank1]:2026-01-03 01:16:11,488 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 51.01GiB(36.48%)  tps: 5,691  tflops: 265.41  mfu: 26.84%
[rank2]:2026-01-03 01:16:11,486 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 42.23GiB(30.21%)  tps: 5,691  tflops: 265.41  mfu: 26.84%
[rank0]:2026-01-03 01:16:11,457 - Avg. fwd time: 14.5280 / Avg. bwd time: 42.9479 / Avg. batch time: 697.0584 (ms) / GPU bubble ratio: 34.04%
[rank0]:2026-01-03 01:16:11,492 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 58.66GiB(41.96%)  tps: 5,691  tflops: 265.41  mfu: 26.84%
[rank3]:2026-01-03 01:16:11,491 -  step: 1300  loss:  0.1790  grad_norm:  0.3540  memory: 48.72GiB(34.84%)  tps: 5,691  tflops: 265.42  mfu: 26.84%
[rank3]:2026-01-03 01:16:11,622 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0116_step1300_rank3.svg
[rank3]:			> Batch Time: 695.97 ms, GPU Bubble Ratio: 33.86%, 28.80%, 37.13%, 29.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  208-42-250ms   | [S0,MB4,F]  251-13-264ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-13-328ms   | [S0,MB2,B]  335-43-378ms   | [S0,MB6,F]  378-14-392ms   | [S0,MB3,B]  398-43-441ms   | [S0,MB7,F]  441-14-455ms   | [S0,MB4,B]  461-43-505ms   | [S0,MB5,B]  525-43-568ms   | [S0,MB6,B]  588-43-631ms   | [S0,MB7,B]  653-42-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  207-15-223ms   | [S1,MB1,B]  224-45-270ms   | [S1,MB4,F]  270-15-286ms   | [S1,MB2,B]  288-45-334ms   | [S1,MB5,F]  334-15-350ms   | [S1,MB3,B]  351-45-397ms   | [S1,MB6,F]  397-15-413ms   | [S1,MB4,B]  415-46-461ms   | [S1,MB7,F]  461-15-477ms   | [S1,MB5,B]  478-45-524ms   | [S1,MB6,B]  541-45-587ms   | [S1,MB7,B]  606-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-40-161ms   | [S2,MB2,F]  162-13-175ms   | [S2,MB1,B]  184-40-224ms   | [S2,MB3,F]  224-13-238ms   | [S2,MB2,B]  247-40-288ms   | [S2,MB4,F]  288-13-302ms   | [S2,MB3,B]  311-40-351ms   | [S2,MB5,F]  351-13-365ms   | [S2,MB4,B]  374-40-415ms   | [S2,MB6,F]  415-13-429ms   | [S2,MB5,B]  438-40-478ms   | [S2,MB7,F]  478-13-492ms   | [S2,MB6,B]  501-40-541ms   | [S2,MB7,B]  565-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-46-184ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-247ms   | [S3,MB3,F]  247-15-262ms   | [S3,MB3,B]  264-46-310ms   | [S3,MB4,F]  311-15-326ms   | [S3,MB4,B]  327-46-374ms   | [S3,MB5,F]  374-15-389ms   | [S3,MB5,B]  391-46-437ms   | [S3,MB6,F]  437-15-452ms   | [S3,MB6,B]  454-46-501ms   | [S3,MB7,F]  501-15-516ms   | [S3,MB7,B]  518-46-564ms  
[rank0]:2026-01-03 01:18:33,622 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:18:36,371 - Avg. fwd time: 15.5269 / Avg. bwd time: 46.0306 / Avg. batch time: 509.8708 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:18:36,420 - Avg. fwd time: 14.3258 / Avg. bwd time: 40.3101 / Avg. batch time: 568.8962 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:18:36,476 - Avg. fwd time: 16.2532 / Avg. bwd time: 45.6300 / Avg. batch time: 635.0843 (ms) / GPU bubble ratio: 22.05%
[rank2]:2026-01-03 01:18:36,556 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 42.23GiB(30.21%)  tps: 5,647  tflops: 263.37  mfu: 26.63%
[rank0]:2026-01-03 01:18:36,527 - Avg. fwd time: 14.5324 / Avg. bwd time: 42.9508 / Avg. batch time: 697.2032 (ms) / GPU bubble ratio: 34.04%
[rank0]:2026-01-03 01:18:36,562 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 58.66GiB(41.96%)  tps: 5,647  tflops: 263.37  mfu: 26.63%
[rank3]:2026-01-03 01:18:36,560 -  step: 1350  loss:  0.1236  grad_norm:  0.4636  memory: 48.72GiB(34.84%)  tps: 5,647  tflops: 263.38  mfu: 26.63%
[rank1]:2026-01-03 01:18:36,558 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 51.01GiB(36.48%)  tps: 5,647  tflops: 263.37  mfu: 26.63%
[rank0]:2026-01-03 01:20:57,545 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 01:21:00,378 - Avg. fwd time: 14.3262 / Avg. bwd time: 40.3115 / Avg. batch time: 568.8956 (ms) / GPU bubble ratio: 23.17%
[rank3]:2026-01-03 01:21:00,328 - Avg. fwd time: 15.5274 / Avg. bwd time: 46.0309 / Avg. batch time: 509.8755 (ms) / GPU bubble ratio: 3.41%
[rank1]:2026-01-03 01:21:00,436 - Avg. fwd time: 16.2533 / Avg. bwd time: 45.6307 / Avg. batch time: 635.0847 (ms) / GPU bubble ratio: 22.05%
[rank0]:2026-01-03 01:21:00,487 - Avg. fwd time: 14.5324 / Avg. bwd time: 42.9508 / Avg. batch time: 697.2051 (ms) / GPU bubble ratio: 34.04%
[rank1]:2026-01-03 01:21:00,519 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 51.01GiB(36.48%)  tps: 5,690  tflops: 265.40  mfu: 26.84%
[rank2]:2026-01-03 01:21:00,517 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 42.23GiB(30.21%)  tps: 5,690  tflops: 265.40  mfu: 26.84%
[rank0]:2026-01-03 01:21:00,523 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 58.66GiB(41.96%)  tps: 5,690  tflops: 265.40  mfu: 26.84%
[rank3]:2026-01-03 01:21:00,522 -  step: 1400  loss:  0.3597  grad_norm:  0.5406  memory: 48.72GiB(34.84%)  tps: 5,690  tflops: 265.41  mfu: 26.84%
[rank3]:2026-01-03 01:21:00,657 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0121_step1400_rank3.svg
[rank3]:			> Batch Time: 702.62 ms, GPU Bubble Ratio: 33.96%, 28.93%, 37.23%, 29.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  210-42-253ms   | [S0,MB4,F]  253-14-267ms   | [S0,MB1,B]  273-43-316ms   | [S0,MB5,F]  317-14-331ms   | [S0,MB2,B]  338-43-381ms   | [S0,MB6,F]  381-14-395ms   | [S0,MB3,B]  402-43-446ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  466-43-510ms   | [S0,MB5,B]  531-43-574ms   | [S0,MB6,B]  594-43-637ms   | [S0,MB7,B]  659-43-702ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-209ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  227-45-273ms   | [S1,MB4,F]  273-16-289ms   | [S1,MB2,B]  291-46-337ms   | [S1,MB5,F]  337-16-353ms   | [S1,MB3,B]  355-46-402ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  420-46-466ms   | [S1,MB7,F]  466-16-482ms   | [S1,MB5,B]  484-46-530ms   | [S1,MB6,B]  548-45-594ms   | [S1,MB7,B]  613-45-659ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-163ms   | [S2,MB2,F]  163-13-177ms   | [S2,MB1,B]  186-40-227ms   | [S2,MB3,F]  227-14-241ms   | [S2,MB2,B]  250-40-291ms   | [S2,MB4,F]  291-14-305ms   | [S2,MB3,B]  314-40-355ms   | [S2,MB5,F]  355-14-369ms   | [S2,MB4,B]  379-40-419ms   | [S2,MB6,F]  419-14-434ms   | [S2,MB5,B]  443-40-483ms   | [S2,MB7,F]  483-14-498ms   | [S2,MB6,B]  507-40-548ms   | [S2,MB7,B]  571-40-612ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-46-186ms   | [S3,MB2,F]  186-15-201ms   | [S3,MB2,B]  203-46-250ms   | [S3,MB3,F]  250-15-265ms   | [S3,MB3,B]  267-46-314ms   | [S3,MB4,F]  314-15-329ms   | [S3,MB4,B]  332-46-378ms   | [S3,MB5,F]  378-15-394ms   | [S3,MB5,B]  396-46-442ms   | [S3,MB6,F]  442-15-458ms   | [S3,MB6,B]  460-46-507ms   | [S3,MB7,F]  507-15-522ms   | [S3,MB7,B]  524-46-570ms  
[rank0]:2026-01-03 01:23:23,479 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:23:26,221 - Avg. fwd time: 15.5349 / Avg. bwd time: 46.0424 / Avg. batch time: 510.0268 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:23:26,273 - Avg. fwd time: 14.3327 / Avg. bwd time: 40.3181 / Avg. batch time: 569.0655 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 01:23:26,329 - Avg. fwd time: 16.2599 / Avg. bwd time: 45.6372 / Avg. batch time: 635.2667 (ms) / GPU bubble ratio: 22.05%
[rank2]:2026-01-03 01:23:26,410 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 42.23GiB(30.21%)  tps: 5,615  tflops: 261.89  mfu: 26.48%
[rank0]:2026-01-03 01:23:26,381 - Avg. fwd time: 14.5395 / Avg. bwd time: 42.9550 / Avg. batch time: 697.4007 (ms) / GPU bubble ratio: 34.05%
[rank0]:2026-01-03 01:23:26,416 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 58.66GiB(41.96%)  tps: 5,615  tflops: 261.89  mfu: 26.48%
[rank3]:2026-01-03 01:23:26,415 -  step: 1450  loss:  0.1860  grad_norm:  0.3945  memory: 48.72GiB(34.84%)  tps: 5,615  tflops: 261.89  mfu: 26.48%
[rank1]:2026-01-03 01:23:26,412 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 51.01GiB(36.48%)  tps: 5,615  tflops: 261.89  mfu: 26.48%
[rank0]:2026-01-03 01:25:49,685 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:25:52,495 - Avg. fwd time: 15.5446 / Avg. bwd time: 46.0567 / Avg. batch time: 510.2188 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:25:52,547 - Avg. fwd time: 14.3407 / Avg. bwd time: 40.3257 / Avg. batch time: 569.2661 (ms) / GPU bubble ratio: 23.18%
[rank0]:2026-01-03 01:25:52,657 - Avg. fwd time: 14.5482 / Avg. bwd time: 42.9603 / Avg. batch time: 697.6316 (ms) / GPU bubble ratio: 34.05%
[rank1]:2026-01-03 01:25:52,604 - Avg. fwd time: 16.2680 / Avg. bwd time: 45.6454 / Avg. batch time: 635.4820 (ms) / GPU bubble ratio: 22.06%
[rank1]:2026-01-03 01:25:52,689 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 51.01GiB(36.48%)  tps: 5,600  tflops: 261.20  mfu: 26.41%
[rank2]:2026-01-03 01:25:52,686 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 42.23GiB(30.21%)  tps: 5,600  tflops: 261.20  mfu: 26.41%
[rank3]:2026-01-03 01:25:52,692 -  step: 1500  loss:  0.2561  grad_norm:  0.5251  memory: 48.72GiB(34.84%)  tps: 5,600  tflops: 261.20  mfu: 26.41%
[rank0]:2026-01-03 01:25:52,693 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 58.66GiB(41.96%)  tps: 5,600  tflops: 261.20  mfu: 26.41%
[rank3]:2026-01-03 01:25:52,827 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0125_step1500_rank3.svg
[rank3]:			> Batch Time: 704.69 ms, GPU Bubble Ratio: 33.93%, 28.92%, 37.22%, 29.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB0,B]  210-43-253ms   | [S0,MB4,F]  253-14-267ms   | [S0,MB1,B]  274-43-317ms   | [S0,MB5,F]  317-14-332ms   | [S0,MB2,B]  339-43-382ms   | [S0,MB6,F]  382-14-397ms   | [S0,MB3,B]  403-43-446ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  467-43-511ms   | [S0,MB5,B]  532-43-575ms   | [S0,MB6,B]  596-43-639ms   | [S0,MB7,B]  661-43-704ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-210ms   | [S1,MB3,F]  210-15-225ms   | [S1,MB1,B]  228-45-274ms   | [S1,MB4,F]  274-16-290ms   | [S1,MB2,B]  292-46-338ms   | [S1,MB5,F]  338-16-355ms   | [S1,MB3,B]  356-46-402ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  420-46-467ms   | [S1,MB7,F]  467-16-483ms   | [S1,MB5,B]  485-46-532ms   | [S1,MB6,B]  549-45-595ms   | [S1,MB7,B]  614-45-660ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-164ms   | [S2,MB2,F]  164-14-178ms   | [S2,MB1,B]  187-40-227ms   | [S2,MB3,F]  227-14-242ms   | [S2,MB2,B]  251-40-292ms   | [S2,MB4,F]  292-14-306ms   | [S2,MB3,B]  315-40-356ms   | [S2,MB5,F]  356-14-370ms   | [S2,MB4,B]  379-40-420ms   | [S2,MB6,F]  420-14-434ms   | [S2,MB5,B]  443-40-484ms   | [S2,MB7,F]  485-14-499ms   | [S2,MB6,B]  508-40-549ms   | [S2,MB7,B]  573-40-614ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-123ms    | [S3,MB1,F]  123-15-138ms   | [S3,MB1,B]  140-46-187ms   | [S3,MB2,F]  186-15-202ms   | [S3,MB2,B]  204-46-251ms   | [S3,MB3,F]  250-15-266ms   | [S3,MB3,B]  268-46-315ms   | [S3,MB4,F]  314-15-330ms   | [S3,MB4,B]  332-46-379ms   | [S3,MB5,F]  379-15-394ms   | [S3,MB5,B]  396-46-443ms   | [S3,MB6,F]  443-15-459ms   | [S3,MB6,B]  460-46-507ms   | [S3,MB7,F]  507-15-523ms   | [S3,MB7,B]  525-46-572ms  
[rank0]:2026-01-03 01:28:15,947 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:28:18,732 - Avg. fwd time: 15.5530 / Avg. bwd time: 46.0695 / Avg. batch time: 510.3879 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:28:18,785 - Avg. fwd time: 14.3477 / Avg. bwd time: 40.3323 / Avg. batch time: 569.4539 (ms) / GPU bubble ratio: 23.18%
[rank1]:2026-01-03 01:28:18,844 - Avg. fwd time: 16.2754 / Avg. bwd time: 45.6525 / Avg. batch time: 635.6822 (ms) / GPU bubble ratio: 22.06%
[rank2]:2026-01-03 01:28:18,928 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 42.23GiB(30.21%)  tps: 5,602  tflops: 261.26  mfu: 26.42%
[rank3]:2026-01-03 01:28:18,933 -  step: 1550  loss:  0.2671  grad_norm:  0.5066  memory: 48.72GiB(34.84%)  tps: 5,602  tflops: 261.27  mfu: 26.42%
[rank0]:2026-01-03 01:28:18,899 - Avg. fwd time: 14.5561 / Avg. bwd time: 42.9650 / Avg. batch time: 697.8456 (ms) / GPU bubble ratio: 34.06%
[rank0]:2026-01-03 01:28:18,935 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 58.66GiB(41.96%)  tps: 5,602  tflops: 261.26  mfu: 26.42%
[rank1]:2026-01-03 01:28:18,931 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 51.01GiB(36.48%)  tps: 5,602  tflops: 261.26  mfu: 26.42%
[rank0]:2026-01-03 01:30:41,389 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:30:44,186 - Avg. fwd time: 15.5573 / Avg. bwd time: 46.0760 / Avg. batch time: 510.4734 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:30:44,239 - Avg. fwd time: 14.3511 / Avg. bwd time: 40.3356 / Avg. batch time: 569.5403 (ms) / GPU bubble ratio: 23.18%
[rank1]:2026-01-03 01:30:44,297 - Avg. fwd time: 16.2788 / Avg. bwd time: 45.6560 / Avg. batch time: 635.7754 (ms) / GPU bubble ratio: 22.07%
[rank2]:2026-01-03 01:30:44,378 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 42.23GiB(30.21%)  tps: 5,632  tflops: 262.69  mfu: 26.56%
[rank3]:2026-01-03 01:30:44,383 -  step: 1600  loss:  0.4009  grad_norm:  0.7882  memory: 48.72GiB(34.84%)  tps: 5,632  tflops: 262.69  mfu: 26.56%
[rank0]:2026-01-03 01:30:44,349 - Avg. fwd time: 14.5599 / Avg. bwd time: 42.9671 / Avg. batch time: 697.9475 (ms) / GPU bubble ratio: 34.06%
[rank0]:2026-01-03 01:30:44,384 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 58.66GiB(41.96%)  tps: 5,632  tflops: 262.69  mfu: 26.56%
[rank1]:2026-01-03 01:30:44,381 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 51.01GiB(36.48%)  tps: 5,632  tflops: 262.69  mfu: 26.56%
[rank3]:2026-01-03 01:30:44,516 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0130_step1600_rank3.svg
[rank3]:			> Batch Time: 702.62 ms, GPU Bubble Ratio: 33.95%, 28.88%, 37.19%, 29.05%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  210-42-253ms   | [S0,MB4,F]  253-14-267ms   | [S0,MB1,B]  274-43-317ms   | [S0,MB5,F]  317-14-331ms   | [S0,MB2,B]  338-43-381ms   | [S0,MB6,F]  381-14-395ms   | [S0,MB3,B]  402-43-446ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  466-43-510ms   | [S0,MB5,B]  531-43-574ms   | [S0,MB6,B]  594-43-637ms   | [S0,MB7,B]  659-43-702ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-209ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  227-45-273ms   | [S1,MB4,F]  273-16-289ms   | [S1,MB2,B]  291-46-337ms   | [S1,MB5,F]  338-16-354ms   | [S1,MB3,B]  355-46-402ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  420-46-466ms   | [S1,MB7,F]  466-16-482ms   | [S1,MB5,B]  484-46-530ms   | [S1,MB6,B]  548-45-594ms   | [S1,MB7,B]  613-45-658ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-163ms   | [S2,MB2,F]  164-13-177ms   | [S2,MB1,B]  186-40-227ms   | [S2,MB3,F]  227-14-241ms   | [S2,MB2,B]  250-40-291ms   | [S2,MB4,F]  291-14-305ms   | [S2,MB3,B]  314-40-355ms   | [S2,MB5,F]  355-14-369ms   | [S2,MB4,B]  379-40-419ms   | [S2,MB6,F]  420-14-434ms   | [S2,MB5,B]  443-40-483ms   | [S2,MB7,F]  484-14-498ms   | [S2,MB6,B]  507-40-548ms   | [S2,MB7,B]  571-40-612ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-46-186ms   | [S3,MB2,F]  186-15-201ms   | [S3,MB2,B]  203-46-250ms   | [S3,MB3,F]  250-15-265ms   | [S3,MB3,B]  267-46-314ms   | [S3,MB4,F]  314-15-330ms   | [S3,MB4,B]  332-46-378ms   | [S3,MB5,F]  379-15-394ms   | [S3,MB5,B]  396-46-442ms   | [S3,MB6,F]  443-15-458ms   | [S3,MB6,B]  460-46-507ms   | [S3,MB7,F]  507-15-522ms   | [S3,MB7,B]  524-46-571ms  
[rank0]:2026-01-03 01:33:07,340 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 01:33:10,192 - Avg. fwd time: 14.3558 / Avg. bwd time: 40.3398 / Avg. batch time: 569.6665 (ms) / GPU bubble ratio: 23.19%
[rank3]:2026-01-03 01:33:10,140 - Avg. fwd time: 15.5629 / Avg. bwd time: 46.0845 / Avg. batch time: 510.5849 (ms) / GPU bubble ratio: 3.41%
[rank1]:2026-01-03 01:33:10,251 - Avg. fwd time: 16.2838 / Avg. bwd time: 45.6605 / Avg. batch time: 635.9104 (ms) / GPU bubble ratio: 22.07%
[rank0]:2026-01-03 01:33:10,304 - Avg. fwd time: 14.5653 / Avg. bwd time: 42.9704 / Avg. batch time: 698.0928 (ms) / GPU bubble ratio: 34.07%
[rank1]:2026-01-03 01:33:10,335 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 51.01GiB(36.48%)  tps: 5,613  tflops: 261.78  mfu: 26.47%
[rank2]:2026-01-03 01:33:10,333 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 42.23GiB(30.21%)  tps: 5,613  tflops: 261.78  mfu: 26.47%
[rank0]:2026-01-03 01:33:10,339 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 58.66GiB(41.96%)  tps: 5,613  tflops: 261.78  mfu: 26.47%
[rank3]:2026-01-03 01:33:10,338 -  step: 1650  loss:  0.4374  grad_norm:  0.9184  memory: 48.72GiB(34.84%)  tps: 5,613  tflops: 261.78  mfu: 26.47%
[rank0]:2026-01-03 01:35:33,433 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:35:36,224 - Avg. fwd time: 15.5684 / Avg. bwd time: 46.0936 / Avg. batch time: 510.7018 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:35:36,276 - Avg. fwd time: 14.3608 / Avg. bwd time: 40.3444 / Avg. batch time: 569.7863 (ms) / GPU bubble ratio: 23.19%
[rank1]:2026-01-03 01:35:36,334 - Avg. fwd time: 16.2890 / Avg. bwd time: 45.6655 / Avg. batch time: 636.0394 (ms) / GPU bubble ratio: 22.07%
[rank2]:2026-01-03 01:35:36,415 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 42.23GiB(30.21%)  tps: 5,608  tflops: 261.55  mfu: 26.45%
[rank0]:2026-01-03 01:35:36,386 - Avg. fwd time: 14.5706 / Avg. bwd time: 42.9738 / Avg. batch time: 698.2322 (ms) / GPU bubble ratio: 34.07%
[rank0]:2026-01-03 01:35:36,422 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 58.66GiB(41.96%)  tps: 5,608  tflops: 261.55  mfu: 26.45%
[rank3]:2026-01-03 01:35:36,420 -  step: 1700  loss:  0.4016  grad_norm:  0.6211  memory: 48.72GiB(34.84%)  tps: 5,608  tflops: 261.55  mfu: 26.45%
[rank1]:2026-01-03 01:35:36,418 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 51.01GiB(36.48%)  tps: 5,608  tflops: 261.55  mfu: 26.45%
[rank3]:2026-01-03 01:35:36,554 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0135_step1700_rank3.svg
[rank3]:			> Batch Time: 702.12 ms, GPU Bubble Ratio: 33.92%, 28.88%, 37.17%, 29.06%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  210-42-252ms   | [S0,MB4,F]  253-13-266ms   | [S0,MB1,B]  274-43-317ms   | [S0,MB5,F]  317-14-331ms   | [S0,MB2,B]  338-43-381ms   | [S0,MB6,F]  381-14-396ms   | [S0,MB3,B]  402-43-445ms   | [S0,MB7,F]  446-14-460ms   | [S0,MB4,B]  466-43-509ms   | [S0,MB5,B]  530-43-573ms   | [S0,MB6,B]  594-43-637ms   | [S0,MB7,B]  659-43-702ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  164-45-209ms   | [S1,MB3,F]  209-15-225ms   | [S1,MB1,B]  227-45-273ms   | [S1,MB4,F]  273-16-289ms   | [S1,MB2,B]  291-46-337ms   | [S1,MB5,F]  338-16-354ms   | [S1,MB3,B]  355-46-402ms   | [S1,MB6,F]  402-16-418ms   | [S1,MB4,B]  419-46-466ms   | [S1,MB7,F]  466-16-482ms   | [S1,MB5,B]  483-46-530ms   | [S1,MB6,B]  548-45-594ms   | [S1,MB7,B]  612-45-658ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-40-163ms   | [S2,MB2,F]  163-13-177ms   | [S2,MB1,B]  186-40-227ms   | [S2,MB3,F]  227-14-241ms   | [S2,MB2,B]  250-40-291ms   | [S2,MB4,F]  291-14-305ms   | [S2,MB3,B]  314-40-355ms   | [S2,MB5,F]  355-14-369ms   | [S2,MB4,B]  378-40-419ms   | [S2,MB6,F]  419-14-433ms   | [S2,MB5,B]  442-40-483ms   | [S2,MB7,F]  483-14-497ms   | [S2,MB6,B]  507-40-547ms   | [S2,MB7,B]  571-40-612ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-46-186ms   | [S3,MB2,F]  186-15-201ms   | [S3,MB2,B]  203-46-250ms   | [S3,MB3,F]  250-15-265ms   | [S3,MB3,B]  267-46-314ms   | [S3,MB4,F]  314-15-329ms   | [S3,MB4,B]  331-46-378ms   | [S3,MB5,F]  378-15-393ms   | [S3,MB5,B]  395-46-442ms   | [S3,MB6,F]  442-15-458ms   | [S3,MB6,B]  460-46-506ms   | [S3,MB7,F]  507-15-522ms   | [S3,MB7,B]  524-46-570ms  
[rank0]:2026-01-03 01:37:59,335 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:38:02,132 - Avg. fwd time: 15.5730 / Avg. bwd time: 46.1009 / Avg. batch time: 510.7966 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:38:02,183 - Avg. fwd time: 14.3649 / Avg. bwd time: 40.3480 / Avg. batch time: 569.8941 (ms) / GPU bubble ratio: 23.20%
[rank1]:2026-01-03 01:38:02,242 - Avg. fwd time: 16.2931 / Avg. bwd time: 45.6693 / Avg. batch time: 636.1544 (ms) / GPU bubble ratio: 22.08%
[rank0]:2026-01-03 01:38:02,295 - Avg. fwd time: 14.5749 / Avg. bwd time: 42.9762 / Avg. batch time: 698.3561 (ms) / GPU bubble ratio: 34.07%
[rank0]:2026-01-03 01:38:02,331 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 58.66GiB(41.96%)  tps: 5,614  tflops: 261.86  mfu: 26.48%
[rank3]:2026-01-03 01:38:02,329 -  step: 1750  loss:  0.4086  grad_norm:  0.6343  memory: 48.72GiB(34.84%)  tps: 5,615  tflops: 261.86  mfu: 26.48%
[rank2]:2026-01-03 01:38:02,324 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 42.23GiB(30.21%)  tps: 5,614  tflops: 261.86  mfu: 26.48%
[rank1]:2026-01-03 01:38:02,327 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 51.01GiB(36.48%)  tps: 5,614  tflops: 261.86  mfu: 26.48%
[rank0]:2026-01-03 01:40:23,013 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:40:25,718 - Avg. fwd time: 15.5699 / Avg. bwd time: 46.0960 / Avg. batch time: 510.7305 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:40:25,769 - Avg. fwd time: 14.3630 / Avg. bwd time: 40.3459 / Avg. batch time: 569.8180 (ms) / GPU bubble ratio: 23.19%
[rank1]:2026-01-03 01:40:25,827 - Avg. fwd time: 16.2903 / Avg. bwd time: 45.6665 / Avg. batch time: 636.0729 (ms) / GPU bubble ratio: 22.08%
[rank0]:2026-01-03 01:40:25,880 - Avg. fwd time: 14.5722 / Avg. bwd time: 42.9741 / Avg. batch time: 698.2720 (ms) / GPU bubble ratio: 34.07%
[rank1]:2026-01-03 01:40:25,911 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 51.01GiB(36.48%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank0]:2026-01-03 01:40:25,915 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 58.66GiB(41.96%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank3]:2026-01-03 01:40:25,914 -  step: 1800  loss:  0.0769  grad_norm:  0.3149  memory: 48.72GiB(34.84%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank2]:2026-01-03 01:40:25,909 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 42.23GiB(30.21%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank3]:2026-01-03 01:40:26,047 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0140_step1800_rank3.svg
[rank3]:			> Batch Time: 687.81 ms, GPU Bubble Ratio: 33.50%, 28.43%, 36.80%, 29.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-58ms     | [S0,MB0,B]  206-42-249ms   | [S0,MB4,F]  249-13-262ms   | [S0,MB1,B]  268-42-311ms   | [S0,MB5,F]  311-13-325ms   | [S0,MB2,B]  331-43-374ms   | [S0,MB6,F]  374-13-388ms   | [S0,MB3,B]  394-43-437ms   | [S0,MB7,F]  437-13-451ms   | [S0,MB4,B]  456-43-499ms   | [S0,MB5,B]  519-42-561ms   | [S0,MB6,B]  581-42-624ms   | [S0,MB7,B]  645-42-687ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  160-45-205ms   | [S1,MB3,F]  206-15-221ms   | [S1,MB1,B]  222-45-268ms   | [S1,MB4,F]  268-15-283ms   | [S1,MB2,B]  285-45-330ms   | [S1,MB5,F]  331-15-346ms   | [S1,MB3,B]  347-45-393ms   | [S1,MB6,F]  393-15-409ms   | [S1,MB4,B]  410-45-455ms   | [S1,MB7,F]  456-15-471ms   | [S1,MB5,B]  472-45-518ms   | [S1,MB6,B]  535-45-581ms   | [S1,MB7,B]  598-45-644ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  120-40-160ms   | [S2,MB2,F]  160-13-174ms   | [S2,MB1,B]  182-40-222ms   | [S2,MB3,F]  222-13-236ms   | [S2,MB2,B]  244-40-285ms   | [S2,MB4,F]  285-13-299ms   | [S2,MB3,B]  307-40-347ms   | [S2,MB5,F]  347-13-361ms   | [S2,MB4,B]  369-40-410ms   | [S2,MB6,F]  410-13-423ms   | [S2,MB5,B]  432-40-472ms   | [S2,MB7,F]  472-13-486ms   | [S2,MB6,B]  495-40-535ms   | [S2,MB7,B]  557-40-598ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  75-45-120ms    | [S3,MB1,F]  120-14-134ms   | [S3,MB1,B]  136-45-182ms   | [S3,MB2,F]  182-14-197ms   | [S3,MB2,B]  198-45-244ms   | [S3,MB3,F]  244-14-259ms   | [S3,MB3,B]  261-45-307ms   | [S3,MB4,F]  307-14-322ms   | [S3,MB4,B]  324-45-369ms   | [S3,MB5,F]  369-14-384ms   | [S3,MB5,B]  386-45-432ms   | [S3,MB6,F]  432-14-447ms   | [S3,MB6,B]  449-45-495ms   | [S3,MB7,F]  494-14-509ms   | [S3,MB7,B]  511-45-557ms  
[rank0]:2026-01-03 01:42:46,355 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:42:49,086 - Avg. fwd time: 15.5663 / Avg. bwd time: 46.0900 / Avg. batch time: 510.6522 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:42:49,138 - Avg. fwd time: 14.3600 / Avg. bwd time: 40.3429 / Avg. batch time: 569.7397 (ms) / GPU bubble ratio: 23.19%
[rank1]:2026-01-03 01:42:49,194 - Avg. fwd time: 16.2868 / Avg. bwd time: 45.6629 / Avg. batch time: 635.9883 (ms) / GPU bubble ratio: 22.07%
[rank0]:2026-01-03 01:42:49,247 - Avg. fwd time: 14.5686 / Avg. bwd time: 42.9711 / Avg. batch time: 698.1837 (ms) / GPU bubble ratio: 34.07%
[rank0]:2026-01-03 01:42:49,282 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 58.66GiB(41.96%)  tps: 5,714  tflops: 266.50  mfu: 26.95%
[rank3]:2026-01-03 01:42:49,282 -  step: 1850  loss:  0.3556  grad_norm:  0.5551  memory: 48.72GiB(34.84%)  tps: 5,714  tflops: 266.50  mfu: 26.95%
[rank2]:2026-01-03 01:42:49,276 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 42.23GiB(30.21%)  tps: 5,714  tflops: 266.50  mfu: 26.95%
[rank1]:2026-01-03 01:42:49,279 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 51.01GiB(36.48%)  tps: 5,714  tflops: 266.50  mfu: 26.95%
[rank0]:2026-01-03 01:45:08,988 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:45:11,706 - Avg. fwd time: 15.5604 / Avg. bwd time: 46.0814 / Avg. batch time: 510.5340 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:45:11,759 - Avg. fwd time: 14.3556 / Avg. bwd time: 40.3389 / Avg. batch time: 569.6088 (ms) / GPU bubble ratio: 23.18%
[rank1]:2026-01-03 01:45:11,817 - Avg. fwd time: 16.2818 / Avg. bwd time: 45.6582 / Avg. batch time: 635.8488 (ms) / GPU bubble ratio: 22.07%
[rank0]:2026-01-03 01:45:11,872 - Avg. fwd time: 14.5637 / Avg. bwd time: 42.9676 / Avg. batch time: 698.0399 (ms) / GPU bubble ratio: 34.07%
[rank0]:2026-01-03 01:45:11,907 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 58.66GiB(41.96%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank3]:2026-01-03 01:45:11,906 -  step: 1900  loss:  0.2039  grad_norm:  0.3106  memory: 48.72GiB(34.84%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank2]:2026-01-03 01:45:11,901 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 42.23GiB(30.21%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank1]:2026-01-03 01:45:11,903 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 51.01GiB(36.48%)  tps: 5,744  tflops: 267.89  mfu: 27.09%
[rank3]:2026-01-03 01:45:12,040 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0145_step1900_rank3.svg
[rank3]:			> Batch Time: 690.94 ms, GPU Bubble Ratio: 33.68%, 28.68%, 36.97%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB0,B]  207-42-249ms   | [S0,MB4,F]  250-13-263ms   | [S0,MB1,B]  269-42-312ms   | [S0,MB5,F]  312-13-326ms   | [S0,MB2,B]  332-43-375ms   | [S0,MB6,F]  375-13-389ms   | [S0,MB3,B]  395-43-438ms   | [S0,MB7,F]  438-13-452ms   | [S0,MB4,B]  458-43-501ms   | [S0,MB5,B]  521-43-564ms   | [S0,MB6,B]  584-42-626ms   | [S0,MB7,B]  648-42-690ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  161-45-206ms   | [S1,MB3,F]  206-15-222ms   | [S1,MB1,B]  223-45-269ms   | [S1,MB4,F]  269-15-285ms   | [S1,MB2,B]  286-45-332ms   | [S1,MB5,F]  332-15-348ms   | [S1,MB3,B]  349-45-395ms   | [S1,MB6,F]  395-15-410ms   | [S1,MB4,B]  412-45-457ms   | [S1,MB7,F]  458-15-473ms   | [S1,MB5,B]  474-45-520ms   | [S1,MB6,B]  537-45-583ms   | [S1,MB7,B]  601-45-646ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB0,B]  120-40-160ms   | [S2,MB2,F]  161-13-174ms   | [S2,MB1,B]  183-40-223ms   | [S2,MB3,F]  223-13-237ms   | [S2,MB2,B]  245-40-285ms   | [S2,MB4,F]  286-13-299ms   | [S2,MB3,B]  308-40-348ms   | [S2,MB5,F]  348-13-362ms   | [S2,MB4,B]  371-40-411ms   | [S2,MB6,F]  411-13-425ms   | [S2,MB5,B]  434-40-474ms   | [S2,MB7,F]  474-13-488ms   | [S2,MB6,B]  497-40-537ms   | [S2,MB7,B]  560-40-600ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  75-45-120ms    | [S3,MB1,F]  120-14-135ms   | [S3,MB1,B]  137-45-182ms   | [S3,MB2,F]  182-14-197ms   | [S3,MB2,B]  199-45-245ms   | [S3,MB3,F]  245-14-260ms   | [S3,MB3,B]  262-45-308ms   | [S3,MB4,F]  308-14-322ms   | [S3,MB4,B]  324-45-370ms   | [S3,MB5,F]  370-14-385ms   | [S3,MB5,B]  387-45-433ms   | [S3,MB6,F]  433-14-448ms   | [S3,MB6,B]  450-45-496ms   | [S3,MB7,F]  496-14-511ms   | [S3,MB7,B]  513-45-559ms  
[rank0]:2026-01-03 01:47:31,258 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:47:33,972 - Avg. fwd time: 15.5536 / Avg. bwd time: 46.0709 / Avg. batch time: 510.3935 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:47:34,024 - Avg. fwd time: 14.3507 / Avg. bwd time: 40.3340 / Avg. batch time: 569.4639 (ms) / GPU bubble ratio: 23.18%
[rank1]:2026-01-03 01:47:34,086 - Avg. fwd time: 16.2762 / Avg. bwd time: 45.6526 / Avg. batch time: 635.6938 (ms) / GPU bubble ratio: 22.06%
[rank0]:2026-01-03 01:47:34,141 - Avg. fwd time: 14.5580 / Avg. bwd time: 42.9633 / Avg. batch time: 697.8785 (ms) / GPU bubble ratio: 34.06%
[rank2]:2026-01-03 01:47:34,170 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 42.23GiB(30.21%)  tps: 5,758  tflops: 268.56  mfu: 27.15%
[rank1]:2026-01-03 01:47:34,173 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 51.01GiB(36.48%)  tps: 5,758  tflops: 268.56  mfu: 27.15%
[rank3]:2026-01-03 01:47:34,176 -  step: 1950  loss:  0.1735  grad_norm:  0.2811  memory: 48.72GiB(34.84%)  tps: 5,758  tflops: 268.56  mfu: 27.15%
[rank0]:2026-01-03 01:47:34,177 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 58.66GiB(41.96%)  tps: 5,758  tflops: 268.56  mfu: 27.15%
[rank0]:2026-01-03 01:49:53,475 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 01:49:56,207 - Avg. fwd time: 15.5474 / Avg. bwd time: 46.0611 / Avg. batch time: 510.2635 (ms) / GPU bubble ratio: 3.41%
[rank2]:2026-01-03 01:49:56,260 - Avg. fwd time: 14.3459 / Avg. bwd time: 40.3292 / Avg. batch time: 569.3200 (ms) / GPU bubble ratio: 23.17%
[rank2]:2026-01-03 01:49:56,402 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 42.23GiB(30.21%)  tps: 5,760  tflops: 268.63  mfu: 27.16%
[rank2]:2026-01-03 01:49:56,403 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,771  tflops: 269.18  mfu: 26.12%
[rank2]:2026-01-03 01:49:56,403 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-03 01:49:56,317 - Avg. fwd time: 16.2711 / Avg. bwd time: 45.6475 / Avg. batch time: 635.5401 (ms) / GPU bubble ratio: 22.06%
[rank1]:2026-01-03 01:49:56,404 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 51.01GiB(36.48%)  tps: 5,760  tflops: 268.63  mfu: 27.16%
[rank1]:2026-01-03 01:49:56,405 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,785  tflops: 269.83  mfu: 26.15%
[rank1]:2026-01-03 01:49:56,405 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-03 01:49:56,408 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-03 01:49:56,373 - Avg. fwd time: 14.5527 / Avg. bwd time: 42.9590 / Avg. batch time: 697.7185 (ms) / GPU bubble ratio: 34.06%
[rank0]:2026-01-03 01:49:56,408 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 58.66GiB(41.96%)  tps: 5,760  tflops: 268.63  mfu: 27.16%
[rank0]:2026-01-03 01:49:56,409 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,772  tflops: 269.20  mfu: 26.12%
[rank0]:2026-01-03 01:49:56,409 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 01:49:56,413 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-03 01:49:56,407 -  step: 2000  loss:  0.2094  grad_norm:  0.2648  memory: 48.72GiB(34.84%)  tps: 5,760  tflops: 268.63  mfu: 27.16%
[rank3]:2026-01-03 01:49:56,407 - â„¹ï¸ final step: 2000  loss:  0.2094  grad_norm:  0.2648  tps: 5,792  tflops: 270.15  mfu: 26.19%
[rank3]:2026-01-03 01:49:56,408 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-03 01:49:56,413 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2026-01-03 01:49:56,407 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-03 01:50:06,778 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-03 01:50:06,802 - Destroying the purge thread.
[rank1]:2026-01-03 01:50:06,802 - Destroying the purge thread.
[rank0]:2026-01-03 01:50:06,803 - Sleeping 2 seconds for other ranks to complete
[rank3]:2026-01-03 01:50:06,942 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0150_final2000_rank3.svg
[rank3]:			> Batch Time: 697.06 ms, GPU Bubble Ratio: 33.77%, 28.75%, 37.07%, 29.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  208-42-251ms   | [S0,MB4,F]  251-13-265ms   | [S0,MB1,B]  271-43-314ms   | [S0,MB5,F]  314-14-328ms   | [S0,MB2,B]  335-43-378ms   | [S0,MB6,F]  378-14-392ms   | [S0,MB3,B]  399-43-442ms   | [S0,MB7,F]  442-14-456ms   | [S0,MB4,B]  462-43-505ms   | [S0,MB5,B]  526-43-569ms   | [S0,MB6,B]  589-43-632ms   | [S0,MB7,B]  654-43-697ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  162-45-207ms   | [S1,MB3,F]  208-15-223ms   | [S1,MB1,B]  225-45-271ms   | [S1,MB4,F]  271-15-287ms   | [S1,MB2,B]  288-46-334ms   | [S1,MB5,F]  335-15-351ms   | [S1,MB3,B]  352-46-398ms   | [S1,MB6,F]  398-16-414ms   | [S1,MB4,B]  416-46-462ms   | [S1,MB7,F]  462-16-478ms   | [S1,MB5,B]  479-46-525ms   | [S1,MB6,B]  543-45-588ms   | [S1,MB7,B]  607-45-653ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-40-162ms   | [S2,MB2,F]  162-13-176ms   | [S2,MB1,B]  184-40-225ms   | [S2,MB3,F]  225-13-239ms   | [S2,MB2,B]  248-40-288ms   | [S2,MB4,F]  288-13-302ms   | [S2,MB3,B]  311-40-352ms   | [S2,MB5,F]  352-14-366ms   | [S2,MB4,B]  375-40-415ms   | [S2,MB6,F]  415-14-429ms   | [S2,MB5,B]  438-40-479ms   | [S2,MB7,F]  479-14-493ms   | [S2,MB6,B]  502-40-542ms   | [S2,MB7,B]  566-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-46-184ms   | [S3,MB2,F]  184-15-199ms   | [S3,MB2,B]  201-46-247ms   | [S3,MB3,F]  247-15-262ms   | [S3,MB3,B]  264-46-311ms   | [S3,MB4,F]  311-15-326ms   | [S3,MB4,B]  328-46-374ms   | [S3,MB5,F]  374-15-389ms   | [S3,MB5,B]  391-46-438ms   | [S3,MB6,F]  438-15-453ms   | [S3,MB6,B]  455-46-501ms   | [S3,MB7,F]  502-15-517ms   | [S3,MB7,B]  519-46-565ms  
[rank3]:2026-01-03 01:50:07,080 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200/pipeline_schedule/260103_0150_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 501.12 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB0,B]  151-30-182ms   | [S0,MB4,F]  182-15-197ms   | [S0,MB1,B]  197-30-227ms   | [S0,MB5,F]  227-15-242ms   | [S0,MB2,B]  242-30-273ms   | [S0,MB6,F]  273-15-288ms   | [S0,MB3,B]  288-30-318ms   | [S0,MB7,F]  318-15-334ms   | [S0,MB4,B]  334-30-364ms   | [S0,MB5,B]  379-30-410ms   | [S0,MB6,B]  425-30-455ms   | [S0,MB7,B]  470-30-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB0,B]  121-30-151ms   | [S1,MB3,F]  151-15-167ms   | [S1,MB1,B]  167-30-197ms   | [S1,MB4,F]  197-15-212ms   | [S1,MB2,B]  212-30-242ms   | [S1,MB5,F]  242-15-258ms   | [S1,MB3,B]  258-30-288ms   | [S1,MB6,F]  288-15-303ms   | [S1,MB4,B]  303-30-334ms   | [S1,MB7,F]  334-15-349ms   | [S1,MB5,B]  349-30-379ms   | [S1,MB6,B]  394-30-425ms   | [S1,MB7,B]  440-30-470ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB0,B]  91-30-121ms    | [S2,MB2,F]  121-15-136ms   | [S2,MB1,B]  136-30-167ms   | [S2,MB3,F]  167-15-182ms   | [S2,MB2,B]  182-30-212ms   | [S2,MB4,F]  212-15-227ms   | [S2,MB3,B]  227-30-258ms   | [S2,MB5,F]  258-15-273ms   | [S2,MB4,B]  273-30-303ms   | [S2,MB6,F]  303-15-318ms   | [S2,MB5,B]  318-30-349ms   | [S2,MB7,F]  349-15-364ms   | [S2,MB6,B]  364-30-394ms   | [S2,MB7,B]  410-30-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB0,B]  60-30-91ms     | [S3,MB1,F]  91-15-106ms    | [S3,MB1,B]  106-30-136ms   | [S3,MB2,F]  136-15-151ms   | [S3,MB2,B]  151-30-182ms   | [S3,MB3,F]  182-15-197ms   | [S3,MB3,B]  197-30-227ms   | [S3,MB4,F]  227-15-242ms   | [S3,MB4,B]  242-30-273ms   | [S3,MB5,F]  273-15-288ms   | [S3,MB5,B]  288-30-318ms   | [S3,MB6,F]  318-15-334ms   | [S3,MB6,B]  334-30-364ms   | [S3,MB7,F]  364-15-379ms   | [S3,MB7,B]  379-30-410ms  
[rank3]:2026-01-03 01:50:07,080 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.82857
[rank3]:wandb:               final/avg_loss 0.20941
[rank3]:wandb:             final/avg_mfu(%) 26.18945
[rank3]:wandb:             final/avg_tflops 270.15464
[rank3]:wandb:    final/avg_throughput(tps) 5792.31798
[rank3]:wandb:              final/grad_norm 0.26478
[rank3]:wandb:               final/max_loss 0.20941
[rank3]:wandb:                    grad_norm 0.26478
[rank3]:wandb: loss_metrics/global_avg_loss 0.20941
[rank3]:wandb: loss_metrics/global_max_loss 0.20941
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_1F1B_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/1mvwvj2y
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_1F1B_nofreeze_h200/20260103-0013/wandb/run-20260103_001316-1mvwvj2y/logs
[rank0]:2026-01-03 01:50:08,803 - Training completed
[rank0]:2026-01-03 01:50:08,803 - Destroying the purge thread.
[rank3]:2026-01-03 01:50:09,054 - Process group destroyed
[rank1]:2026-01-03 01:50:09,057 - Process group destroyed
[rank0]:2026-01-03 01:50:09,123 - Process group destroyed
[rank2]:2026-01-03 01:50:09,122 - Process group destroyed
[rank0]:[W103 01:50:10.886576540 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:[W103 01:50:10.900921422 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:[W103 01:50:10.872206468 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W103 01:50:10.090858281 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:Stage 2: Modules to keep: {'layers.24', 'layers.19', 'layers.21', 'layers.17', 'layers.23', 'layers.20', 'layers.22', 'layers.18'}
[rank0]:Stage 0: Modules to keep: {'layers.3', 'layers.0', 'layers.7', 'layers.1', 'layers.2', 'layers.5', 'tok_embeddings', 'layers.4', 'layers.6'}
[rank1]:Stage 1: Modules to keep: {'layers.16', 'layers.13', 'layers.15', 'layers.14', 'layers.11', 'layers.9', 'layers.8', 'layers.12', 'layers.10'}
[rank3]:Stage 3: Modules to keep: {'layers.29', 'layers.25', 'layers.27', 'layers.30', 'output', 'layers.26', 'norm', 'layers.31', 'layers.28'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_1F1B_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_1F1B_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_1F1B_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_1F1B_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_1F1B_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_1F1B_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_1F1B_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W103 01:50:16.482172031 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
