
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Jan  2 20:32:03 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_GPipe_timelyauto.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with timelyauto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyauto --freezing.threshold=0.0001 --freezing.max_freeze_ratio=0.8 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0102 20:32:04.275000 2912227 site-packages/torch/distributed/run.py:803] 
W0102 20:32:04.275000 2912227 site-packages/torch/distributed/run.py:803] *****************************************
W0102 20:32:04.275000 2912227 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0102 20:32:04.275000 2912227 site-packages/torch/distributed/run.py:803] *****************************************
[rank3]:2026-01-02 20:32:11,151 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank2]:2026-01-02 20:32:11,299 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank0]:2026-01-02 20:32:11,397 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank1]:2026-01-02 20:32:11,361 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank3]:2026-01-02 20:32:11,738 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-02 20:32:11,741 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-02 20:32:11,747 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 20:32:12,177 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-02 20:32:12,178 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-02 20:32:12,183 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-02 20:32:12,183 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 20:32:12,185 - Loading tokenizer from tokenizer.json
[rank2]:2026-01-02 20:32:12,159 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-02 20:32:12,161 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-02 20:32:12,167 - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2026-01-02 20:32:12,166 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-02 20:32:12,168 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-02 20:32:12,173 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 20:32:12,511 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2026-01-02 20:32:14,087 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-02 20:32:14,306 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 20:32:14,333 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 20:32:14,414 - Model llama3 8B size: 8,030,261,248 total parameters
[rank2]:2026-01-02 20:32:14,385 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-02 20:32:14,385 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-02 20:32:14,335 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 20:32:14,436 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-02 20:32:14,436 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-02 20:32:14,437 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-02 20:32:14,437 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2026-01-02 20:32:14,633 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-02 20:32:14,634 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank1]:2026-01-02 20:32:14,732 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-02 20:32:14,733 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2026-01-02 20:32:14,754 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-02 20:32:14,754 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run ugk8g01s
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_timelyauto_h200/20260102-2032/wandb/run-20260102_203214-ugk8g01s
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_GPipe_timelyauto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ugk8g01s
[rank3]:2026-01-02 20:32:16,049 - WandB logging enabled
[rank3]:2026-01-02 20:32:16,050 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-02 20:32:16,122 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-02 20:32:16,122 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2026-01-02 20:32:16,372 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_timelyauto_h200
[rank0]:2026-01-02 20:32:16,372 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 20:32:16,372 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-02 20:32:16,372 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank2]:2026-01-02 20:32:16,366 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-02 20:32:16,350 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-02 20:32:16,350 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2026-01-02 20:32:16,366 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-02 20:32:16,362 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 20:32:26,332 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-02 20:32:26,332 - Finished loading the checkpoint in 9.96 seconds.
[rank0]:2026-01-02 20:32:26,333 - Training starts at step 1
[rank2]:2026-01-02 20:32:30,819 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.30GiB(35.26%)  tps: 996  tflops: 46.44  mfu: 4.70%
[rank2]:2026-01-02 20:32:30,820 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 20:32:30,843 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.18GiB(39.46%)  tps: 997  tflops: 46.51  mfu: 4.70%
[rank0]:2026-01-02 20:32:30,843 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-02 20:32:30,826 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 61.09GiB(43.70%)  tps: 1,113  tflops: 51.89  mfu: 5.25%
[rank3]:2026-01-02 20:32:30,826 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-02 20:32:30,823 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.37GiB(39.61%)  tps: 998  tflops: 46.57  mfu: 4.71%
[rank1]:2026-01-02 20:32:30,823 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 20:34:48,639 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:34:51,420 - Avg. fwd time: 14.2754 / Avg. bwd time: 40.2046 / Avg. batch time: 569.3045 (ms) / GPU bubble ratio: 23.44%
[rank3]:2026-01-02 20:34:51,375 - Avg. fwd time: 15.3533 / Avg. bwd time: 45.9926 / Avg. batch time: 509.5033 (ms) / GPU bubble ratio: 3.68%
[rank1]:2026-01-02 20:34:51,470 - Avg. fwd time: 16.1588 / Avg. bwd time: 45.3741 / Avg. batch time: 636.7623 (ms) / GPU bubble ratio: 22.69%
[rank1]:2026-01-02 20:34:51,548 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 70.00GiB(50.07%)  tps: 5,705  tflops: 266.08  mfu: 26.90%
[rank0]:2026-01-02 20:34:51,517 - Avg. fwd time: 14.9054 / Avg. bwd time: 42.7083 / Avg. batch time: 699.6608 (ms) / GPU bubble ratio: 34.12%
[rank0]:2026-01-02 20:34:51,553 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 72.15GiB(51.60%)  tps: 5,705  tflops: 266.10  mfu: 26.91%
[rank2]:2026-01-02 20:34:51,546 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 62.32GiB(44.58%)  tps: 5,705  tflops: 266.07  mfu: 26.90%
[rank3]:2026-01-02 20:34:51,550 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 76.42GiB(54.66%)  tps: 5,705  tflops: 266.08  mfu: 26.90%
[rank0]:2026-01-02 20:37:12,439 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:37:15,165 - Avg. fwd time: 15.3303 / Avg. bwd time: 46.0762 / Avg. batch time: 509.1299 (ms) / GPU bubble ratio: 3.51%
[rank1]:2026-01-02 20:37:15,260 - Avg. fwd time: 16.1344 / Avg. bwd time: 45.4319 / Avg. batch time: 635.4964 (ms) / GPU bubble ratio: 22.50%
[rank2]:2026-01-02 20:37:15,210 - Avg. fwd time: 14.2815 / Avg. bwd time: 40.3140 / Avg. batch time: 568.5709 (ms) / GPU bubble ratio: 23.18%
[rank1]:2026-01-02 20:37:15,338 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 70.00GiB(50.07%)  tps: 5,697  tflops: 265.72  mfu: 26.87%
[rank1]:2026-01-02 20:37:15,338 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 20:37:15,307 - Avg. fwd time: 14.7956 / Avg. bwd time: 42.8367 / Avg. batch time: 698.0941 (ms) / GPU bubble ratio: 33.95%
[rank0]:2026-01-02 20:37:15,342 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 72.15GiB(51.60%)  tps: 5,697  tflops: 265.72  mfu: 26.87%
[rank0]:2026-01-02 20:37:15,342 - Nothing to draw before the end of warmup.
[rank2]:2026-01-02 20:37:15,336 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 62.32GiB(44.58%)  tps: 5,697  tflops: 265.72  mfu: 26.87%
[rank2]:2026-01-02 20:37:15,336 - Nothing to draw before the end of warmup.
[rank3]:2026-01-02 20:37:15,340 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 76.42GiB(54.66%)  tps: 5,697  tflops: 265.72  mfu: 26.87%
[rank3]:2026-01-02 20:37:15,340 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 20:39:36,132 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:39:38,868 - Avg. fwd time: 15.2886 / Avg. bwd time: 46.1165 / Avg. batch time: 508.8243 (ms) / GPU bubble ratio: 3.46%
[rank1]:2026-01-02 20:39:38,964 - Avg. fwd time: 16.1106 / Avg. bwd time: 45.4633 / Avg. batch time: 634.8876 (ms) / GPU bubble ratio: 22.41%
[rank0]:2026-01-02 20:39:39,011 - Avg. fwd time: 14.7536 / Avg. bwd time: 42.8951 / Avg. batch time: 697.3965 (ms) / GPU bubble ratio: 33.87%
[rank2]:2026-01-02 20:39:38,914 - Avg. fwd time: 14.2570 / Avg. bwd time: 40.3752 / Avg. batch time: 568.1424 (ms) / GPU bubble ratio: 23.07%
[rank1]:2026-01-02 20:39:39,043 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 70.00GiB(50.07%)  tps: 5,701  tflops: 265.88  mfu: 26.88%
[rank0]:2026-01-02 20:39:39,047 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 72.15GiB(51.60%)  tps: 5,701  tflops: 265.88  mfu: 26.88%
[rank2]:2026-01-02 20:39:39,040 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 62.32GiB(44.58%)  tps: 5,701  tflops: 265.88  mfu: 26.88%
[rank3]:2026-01-02 20:39:39,045 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 76.42GiB(54.66%)  tps: 5,701  tflops: 265.88  mfu: 26.88%
[rank3]:2026-01-02 20:40:04,670 - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-02 20:40:33,386 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank1]:2026-01-02 20:40:33,512 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank2]:2026-01-02 20:40:33,465 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank0]:2026-01-02 20:40:33,557 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank3]:2026-01-02 20:41:02,162 - [Step 180] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-02 20:41:02,375 - [Step 180] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-02 20:41:35,783 - [Step 200] âœ”ï¸  Setting Lowerbound
[rank0]:2026-01-02 20:41:35,864 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 20:41:35,888 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.26/0.26, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:41:35,891 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.50/0.50, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-02 20:41:35,887 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 20:41:36,011 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2041_max_batch_time.svg
[rank3]:			> Batch Time: 676.48 ms, GPU Bubble Ratio: 31.64%, 27.08%, 35.21%, 27.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-73ms     | [S0,MB5,F]  73-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  307-42-349ms   | [S0,MB1,B]  354-42-396ms   | [S0,MB2,B]  401-43-444ms   | [S0,MB3,B]  447-43-490ms   | [S0,MB4,B]  493-43-537ms   | [S0,MB5,B]  540-43-583ms   | [S0,MB6,B]  586-43-630ms   | [S0,MB7,B]  633-43-676ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB3,F]  67-15-83ms     | [S1,MB4,F]  83-15-98ms     | [S1,MB5,F]  98-15-114ms    | [S1,MB6,F]  114-15-129ms   | [S1,MB7,F]  129-15-145ms   | [S1,MB0,B]  262-45-307ms   | [S1,MB1,B]  308-45-354ms   | [S1,MB2,B]  355-45-401ms   | [S1,MB3,B]  401-45-447ms   | [S1,MB4,B]  448-45-493ms   | [S1,MB5,B]  494-45-540ms   | [S1,MB6,B]  541-45-586ms   | [S1,MB7,B]  587-45-633ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-81ms     | [S2,MB3,F]  83-13-96ms     | [S2,MB4,F]  98-13-112ms    | [S2,MB5,F]  114-13-128ms   | [S2,MB6,F]  129-13-143ms   | [S2,MB7,F]  145-13-159ms   | [S2,MB0,B]  221-40-262ms   | [S2,MB1,B]  268-40-308ms   | [S2,MB2,B]  314-40-355ms   | [S2,MB3,B]  361-40-401ms   | [S2,MB4,B]  407-40-448ms   | [S2,MB5,B]  453-40-494ms   | [S2,MB6,B]  500-40-541ms   | [S2,MB7,B]  546-40-587ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  73-14-87ms     | [S3,MB2,F]  87-14-102ms    | [S3,MB3,F]  102-14-116ms   | [S3,MB4,F]  116-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-160ms   | [S3,MB7,F]  160-14-175ms   | [S3,MB0,B]  175-46-221ms   AFR(10):0.9846 | [S3,MB1,B]  221-46-268ms   AFR(10):0.9846 | [S3,MB2,B]  268-46-314ms   AFR(10):0.9846 | [S3,MB3,B]  314-46-361ms   AFR(10):0.9846 | [S3,MB4,B]  361-46-407ms   AFR(10):0.9846 | [S3,MB5,B]  407-46-453ms   AFR(10):0.9846 | [S3,MB6,B]  453-46-500ms   AFR(10):0.9846 | [S3,MB7,B]  500-46-546ms   AFR(10):0.9846
[rank3]:2026-01-02 20:41:36,128 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2041_min_batch_time.svg
[rank3]:			> Batch Time: 384.00 ms, GPU Bubble Ratio: 69.48%, 23.27%, 31.95%, 24.63%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-73ms     | [S0,MB5,F]  73-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  235-0-235ms    | [S0,MB1,B]  256-0-256ms    | [S0,MB2,B]  278-0-278ms    | [S0,MB3,B]  299-0-299ms    | [S0,MB4,B]  320-0-320ms    | [S0,MB5,B]  341-0-341ms    | [S0,MB6,B]  362-0-362ms    | [S0,MB7,B]  384-0-384ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB3,F]  67-15-83ms     | [S1,MB4,F]  83-15-98ms     | [S1,MB5,F]  98-15-114ms    | [S1,MB6,F]  114-15-129ms   | [S1,MB7,F]  129-15-145ms   | [S1,MB0,B]  215-20-235ms   | [S1,MB1,B]  236-20-256ms   | [S1,MB2,B]  257-20-278ms   | [S1,MB3,B]  278-20-299ms   | [S1,MB4,B]  299-20-320ms   | [S1,MB5,B]  320-21-341ms   | [S1,MB6,B]  341-21-362ms   | [S1,MB7,B]  362-21-384ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-81ms     | [S2,MB3,F]  83-13-96ms     | [S2,MB4,F]  98-13-112ms    | [S2,MB5,F]  114-13-128ms   | [S2,MB6,F]  129-13-143ms   | [S2,MB7,F]  145-13-159ms   | [S2,MB0,B]  196-18-215ms   | [S2,MB1,B]  217-18-236ms   | [S2,MB2,B]  239-18-257ms   | [S2,MB3,B]  260-18-278ms   | [S2,MB4,B]  281-18-299ms   | [S2,MB5,B]  302-18-320ms   | [S2,MB6,B]  323-18-341ms   | [S2,MB7,B]  344-18-362ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  73-14-87ms     | [S3,MB2,F]  87-14-102ms    | [S3,MB3,F]  102-14-116ms   | [S3,MB4,F]  116-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-160ms   | [S3,MB7,F]  160-14-175ms   | [S3,MB0,B]  175-21-196ms   AFR(10):0.9846 | [S3,MB1,B]  196-21-217ms   AFR(10):0.9846 | [S3,MB2,B]  217-21-239ms   AFR(10):0.9846 | [S3,MB3,B]  239-20-260ms   AFR(10):0.9846 | [S3,MB4,B]  260-21-281ms   AFR(10):0.9846 | [S3,MB5,B]  281-20-302ms   AFR(10):0.9846 | [S3,MB6,B]  302-20-323ms   AFR(10):0.9846 | [S3,MB7,B]  323-20-344ms   AFR(10):0.9846
[rank3]:2026-01-02 20:41:36,266 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2041_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 423.94 ms, GPU Bubble Ratio: 34.39%, 21.24%, 30.03%, 22.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-73ms     | [S0,MB5,F]  73-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  262-42-305ms   | [S0,MB1,B]  305-42-348ms   | [S0,MB2,B]  348-43-391ms   | [S0,MB3,B]  391-32-423ms   | [S0,MB4,B]  423-0-423ms    | [S0,MB5,B]  423-0-423ms    | [S0,MB6,B]  423-0-423ms    | [S0,MB7,B]  423-0-423ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB3,F]  67-15-83ms     | [S1,MB4,F]  83-15-98ms     | [S1,MB5,F]  98-15-114ms    | [S1,MB6,F]  114-15-129ms   | [S1,MB7,F]  129-15-145ms   | [S1,MB0,B]  217-45-262ms   | [S1,MB1,B]  262-35-298ms   | [S1,MB2,B]  298-20-319ms   | [S1,MB3,B]  319-20-339ms   | [S1,MB4,B]  339-20-360ms   | [S1,MB5,B]  360-21-381ms   | [S1,MB6,B]  381-21-402ms   | [S1,MB7,B]  402-21-423ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-81ms     | [S2,MB3,F]  83-13-96ms     | [S2,MB4,F]  98-13-112ms    | [S2,MB5,F]  114-13-128ms   | [S2,MB6,F]  129-13-143ms   | [S2,MB7,F]  145-13-159ms   | [S2,MB0,B]  199-18-217ms   | [S2,MB1,B]  222-40-262ms   | [S2,MB2,B]  268-29-298ms   | [S2,MB3,B]  298-20-319ms   | [S2,MB4,B]  321-18-339ms   | [S2,MB5,B]  342-18-360ms   | [S2,MB6,B]  363-18-381ms   | [S2,MB7,B]  384-18-402ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  73-14-87ms     | [S3,MB2,F]  87-14-102ms    | [S3,MB3,F]  102-14-116ms   | [S3,MB4,F]  116-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-160ms   | [S3,MB7,F]  160-14-175ms   | [S3,MB0,B]  175-23-199ms   AFR(10):0.9846 | [S3,MB1,B]  199-23-222ms   AFR(10):0.9846 | [S3,MB2,B]  222-46-268ms   AFR(10):0.9846 | [S3,MB3,B]  268-20-289ms   AFR(10):0.9846 | [S3,MB4,B]  289-31-321ms   AFR(10):0.9846 | [S3,MB5,B]  321-20-342ms   AFR(10):0.9846 | [S3,MB6,B]  342-20-363ms   AFR(10):0.9846 | [S3,MB7,B]  363-21-384ms   AFR(10):0.9846
[rank3]:2026-01-02 20:41:36,267 - 	> Batch Time: 423.94 ms (Average Freeze Ratio: 0.73, Time Reduction Rate: 0.37)
[rank3]:2026-01-02 20:41:36,269 - Current/Expected Freeze Ratio per Block: [MB0] 0.90/0.90, [MB1] 0.92/0.92, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:41:38,178 - Avg. fwd time: 14.2365 / Avg. bwd time: 38.1238 / Avg. batch time: 545.0607 (ms) / GPU bubble ratio: 23.15%
[rank3]:2026-01-02 20:41:38,152 - Avg. fwd time: 15.2553 / Avg. bwd time: 43.5305 / Avg. batch time: 487.7205 (ms) / GPU bubble ratio: 3.57%
[rank1]:2026-01-02 20:41:38,237 - Avg. fwd time: 16.0986 / Avg. bwd time: 42.9120 / Avg. batch time: 609.3518 (ms) / GPU bubble ratio: 22.53%
[rank1]:2026-01-02 20:41:38,272 -  step: 200  loss: -4.0000  grad_norm:  7.3628  memory: 70.00GiB(50.07%)  tps: 6,871  tflops: 320.45  mfu: 32.40%
[rank2]:2026-01-02 20:41:38,270 -  step: 200  loss: -4.0000  grad_norm:  7.3628  memory: 62.32GiB(44.58%)  tps: 6,871  tflops: 320.45  mfu: 32.40%
[rank3]:2026-01-02 20:41:38,274 -  step: 200  loss:  0.8742  grad_norm:  7.3628  memory: 76.42GiB(54.66%)  tps: 6,871  tflops: 320.46  mfu: 32.40%
[rank0]:2026-01-02 20:41:38,241 - Avg. fwd time: 14.7133 / Avg. bwd time: 38.5087 / Avg. batch time: 667.1910 (ms) / GPU bubble ratio: 36.18%
[rank0]:2026-01-02 20:41:38,276 -  step: 200  loss: -4.0000  grad_norm:  7.3628  memory: 72.15GiB(51.60%)  tps: 6,871  tflops: 320.45  mfu: 32.40%
[rank1]:2026-01-02 20:41:38,334 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2041_stage1_step200.svg
[rank2]:2026-01-02 20:41:38,333 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2041_stage2_step200.svg
[rank3]:2026-01-02 20:41:38,400 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2041_step200_rank3.svg
[rank3]:			> Batch Time: 405.50 ms, GPU Bubble Ratio: 71.37%, 26.91%, 35.38%, 28.08%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB4,F]  59-14-73ms     | [S0,MB5,F]  73-14-87ms     | [S0,MB6,F]  87-14-101ms    | [S0,MB7,F]  101-14-116ms   | [S0,MB0,B]  255-0-255ms    | [S0,MB1,B]  277-0-277ms    | [S0,MB2,B]  298-0-298ms    | [S0,MB3,B]  319-0-319ms    | [S0,MB4,B]  341-0-341ms    | [S0,MB5,B]  362-0-362ms    | [S0,MB6,B]  384-0-384ms    | [S0,MB7,B]  405-0-405ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  84-15-100ms    | [S1,MB5,F]  100-15-116ms   | [S1,MB6,F]  117-15-132ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  234-20-255ms   | [S1,MB1,B]  255-20-276ms   | [S1,MB2,B]  277-20-298ms   | [S1,MB3,B]  298-20-319ms   | [S1,MB4,B]  319-20-340ms   | [S1,MB5,B]  341-21-362ms   | [S1,MB6,B]  362-21-383ms   | [S1,MB7,B]  384-21-405ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  149-13-162ms   | [S2,MB0,B]  215-18-234ms   | [S2,MB1,B]  237-18-255ms   | [S2,MB2,B]  258-18-277ms   | [S2,MB3,B]  279-18-298ms   | [S2,MB4,B]  300-18-319ms   | [S2,MB5,B]  322-18-340ms   | [S2,MB6,B]  343-18-361ms   | [S2,MB7,B]  364-18-383ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  108-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-21-214ms   | [S3,MB1,B]  215-21-236ms   | [S3,MB2,B]  236-21-258ms   | [S3,MB3,B]  258-21-279ms   | [S3,MB4,B]  279-20-300ms   | [S3,MB5,B]  300-21-321ms   | [S3,MB6,B]  321-20-342ms   | [S3,MB7,B]  342-20-363ms  
[rank0]:2026-01-02 20:41:38,333 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2041_stage0_step200.svg
[rank3]:2026-01-02 20:41:38,443 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2041_stage3_step200.svg
[rank0]:2026-01-02 20:41:38,509 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2041_rank0_stage0.svg
[rank0]:	> Counts Sum: 46720, Total Sum: 46720 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2026-01-02 20:41:38,522 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2041_rank1_stage1.svg
[rank1]:	> Counts Sum: 51840, Total Sum: 51840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank1]:2026-01-02 20:41:38,559 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2041_stage1.svg
[rank2]:2026-01-02 20:41:38,510 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2041_rank2_stage2.svg
[rank2]:	> Counts Sum: 46080, Total Sum: 46080 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-02 20:41:38,547 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2041_stage2.svg
[rank3]:2026-01-02 20:41:38,609 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2041_rank3_stage3.svg
[rank3]:	> Counts Sum: 40960, Total Sum: 41600 (98.46%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 87.5, 87.5, 100.0, 93.75, 100.0, 100.0, 87.5, 93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 93.75, 100.0, 93.75, 100.0, 100.0, 93.75, 100.0]
[rank0]:2026-01-02 20:41:38,544 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2041_stage0.svg
[rank3]:2026-01-02 20:41:38,645 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2041_stage3.svg
[rank0]:2026-01-02 20:43:35,765 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 20:43:35,791 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.26, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-02 20:43:35,788 - Current/Expected Freeze Ratio per Block: [MB0] 0.60/0.90, [MB1] 0.61/0.92, [MB2] 0.00/0.00, [MB3] 0.67/1.00, [MB4] 0.39/0.59, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.66/1.00
[rank2]:2026-01-02 20:43:35,784 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.00/0.00, [MB2] 0.34/0.50, [MB3] 0.60/0.90, [MB4] 0.66/1.00, [MB5] 0.67/1.00, [MB6] 0.66/1.00, [MB7] 0.67/1.00
[rank1]:2026-01-02 20:43:35,787 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-02 20:43:37,923 - Avg. fwd time: 15.2391 / Avg. bwd time: 41.7807 / Avg. batch time: 473.5050 (ms) / GPU bubble ratio: 3.66%
[rank2]:2026-01-02 20:43:37,953 - Avg. fwd time: 14.2264 / Avg. bwd time: 36.5006 / Avg. batch time: 528.6205 (ms) / GPU bubble ratio: 23.23%
[rank1]:2026-01-02 20:43:37,988 - Avg. fwd time: 16.0912 / Avg. bwd time: 41.0836 / Avg. batch time: 591.9245 (ms) / GPU bubble ratio: 22.73%
[rank1]:2026-01-02 20:43:38,043 -  step: 250  loss: -4.0000  grad_norm:  1.2986  memory: 70.00GiB(50.07%)  tps: 6,840  tflops: 319.01  mfu: 32.26%
[rank0]:2026-01-02 20:43:38,011 - Avg. fwd time: 14.7074 / Avg. bwd time: 37.3758 / Avg. batch time: 648.6151 (ms) / GPU bubble ratio: 35.76%
[rank0]:2026-01-02 20:43:38,047 -  step: 250  loss: -4.0000  grad_norm:  1.2986  memory: 72.15GiB(51.60%)  tps: 6,840  tflops: 319.01  mfu: 32.26%
[rank3]:2026-01-02 20:43:38,045 -  step: 250  loss:  0.2842  grad_norm:  1.2986  memory: 76.42GiB(54.66%)  tps: 6,840  tflops: 319.01  mfu: 32.26%
[rank2]:2026-01-02 20:43:38,040 -  step: 250  loss: -4.0000  grad_norm:  1.2986  memory: 62.32GiB(44.58%)  tps: 6,840  tflops: 319.01  mfu: 32.26%
[rank0]:2026-01-02 20:45:27,476 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:45:27,503 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.50/0.50, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-02 20:45:27,506 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 20:45:27,510 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.26/0.26, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 20:45:27,506 - Current/Expected Freeze Ratio per Block: [MB0] 0.90/0.90, [MB1] 0.92/0.92, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:45:29,470 - Avg. fwd time: 14.2177 / Avg. bwd time: 34.7781 / Avg. batch time: 510.1287 (ms) / GPU bubble ratio: 23.16%
[rank3]:2026-01-02 20:45:29,444 - Avg. fwd time: 15.2271 / Avg. bwd time: 39.7478 / Avg. batch time: 457.0868 (ms) / GPU bubble ratio: 3.78%
[rank1]:2026-01-02 20:45:29,531 - Avg. fwd time: 16.0919 / Avg. bwd time: 39.1275 / Avg. batch time: 574.7066 (ms) / GPU bubble ratio: 23.13%
[rank0]:2026-01-02 20:45:29,535 - Avg. fwd time: 14.7098 / Avg. bwd time: 36.2278 / Avg. batch time: 629.5864 (ms) / GPU bubble ratio: 35.27%
[rank0]:2026-01-02 20:45:29,571 -  step: 300  loss: -4.0000  grad_norm:  0.5685  memory: 72.15GiB(51.60%)  tps: 7,346  tflops: 342.60  mfu: 34.64%
[rank2]:2026-01-02 20:45:29,564 -  step: 300  loss: -4.0000  grad_norm:  0.5685  memory: 62.32GiB(44.58%)  tps: 7,346  tflops: 342.60  mfu: 34.64%
[rank3]:2026-01-02 20:45:29,568 -  step: 300  loss:  0.2890  grad_norm:  0.5685  memory: 76.42GiB(54.66%)  tps: 7,346  tflops: 342.60  mfu: 34.64%
[rank1]:2026-01-02 20:45:29,566 -  step: 300  loss: -4.0000  grad_norm:  0.5685  memory: 70.00GiB(50.07%)  tps: 7,346  tflops: 342.60  mfu: 34.64%
[rank1]:2026-01-02 20:45:29,614 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2045_stage1_step300.svg
[rank0]:2026-01-02 20:45:29,615 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2045_stage0_step300.svg
[rank2]:2026-01-02 20:45:29,614 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2045_stage2_step300.svg
[rank3]:2026-01-02 20:45:29,696 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2045_step300_rank3.svg
[rank3]:			> Batch Time: 515.28 ms, GPU Bubble Ratio: 32.37%, 33.28%, 40.82%, 35.56%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  283-42-325ms   | [S0,MB1,B]  326-43-369ms   | [S0,MB2,B]  369-43-412ms   | [S0,MB3,B]  413-39-452ms   | [S0,MB4,B]  452-19-471ms   | [S0,MB5,B]  470-7-478ms    | [S0,MB6,B]  479-18-498ms   | [S0,MB7,B]  499-16-515ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  84-15-100ms    | [S1,MB5,F]  100-15-116ms   | [S1,MB6,F]  117-15-132ms   | [S1,MB7,F]  132-15-148ms   | [S1,MB0,B]  237-45-283ms   | [S1,MB1,B]  282-35-318ms   | [S1,MB2,B]  319-22-341ms   | [S1,MB3,B]  341-23-365ms   | [S1,MB4,B]  369-21-390ms   | [S1,MB5,B]  412-21-434ms   | [S1,MB6,B]  452-22-475ms   | [S1,MB7,B]  475-22-497ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  148-13-162ms   | [S2,MB0,B]  217-20-237ms   | [S2,MB1,B]  240-40-281ms   | [S2,MB2,B]  286-30-316ms   | [S2,MB3,B]  317-20-338ms   | [S2,MB4,B]  339-19-359ms   | [S2,MB5,B]  360-19-380ms   | [S2,MB6,B]  381-19-401ms   | [S2,MB7,B]  412-20-433ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  108-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-14-191ms   | [S3,MB0,B]  193-23-217ms   | [S3,MB1,B]  216-23-240ms   | [S3,MB2,B]  240-46-286ms   | [S3,MB3,B]  285-21-307ms   | [S3,MB4,B]  307-28-336ms   | [S3,MB5,B]  336-22-359ms   | [S3,MB6,B]  359-21-381ms   | [S3,MB7,B]  381-22-403ms  
[rank0]:2026-01-02 20:45:29,787 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2045_rank0_stage0.svg
[rank0]:	> Counts Sum: 133680, Total Sum: 280320 (47.69%), Ratio(%) per element: [41.66, 56.25, 57.29, 60.41, 59.37, 57.29, 58.33, 57.29, 58.33, 59.37, 55.2, 57.29, 57.29, 58.33, 56.25, 53.12, 54.16, 53.12, 55.2, 47.91, 50.0, 48.95, 51.04, 48.95, 57.29, 48.95, 55.2, 50.0, 40.62, 41.66, 44.79, 47.91, 43.75, 45.83, 51.04, 41.66, 43.75, 42.7, 45.83, 41.66, 46.87, 46.87, 45.83, 42.7, 37.5, 45.83, 44.79, 44.79, 42.7, 42.7, 44.79, 37.5, 43.75, 42.7, 44.79, 47.91, 48.95, 38.54, 40.62, 45.83, 41.66, 42.7, 43.75, 44.79, 41.66, 42.7, 39.58, 39.58, 39.58, 41.66, 41.66, 42.7, 47.91]
[rank2]:2026-01-02 20:45:29,786 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2045_rank2_stage2.svg
[rank2]:	> Counts Sum: 175160, Total Sum: 276480 (63.35%), Ratio(%) per element: [79.16, 76.04, 75.0, 71.87, 80.2, 73.95, 73.95, 76.04, 75.0, 71.87, 72.91, 71.87, 77.08, 72.91, 78.12, 73.95, 71.87, 75.0, 61.45, 61.45, 70.83, 69.79, 58.33, 60.41, 62.5, 61.45, 61.45, 67.7, 66.66, 65.62, 59.37, 62.5, 59.37, 59.37, 62.5, 58.33, 61.45, 54.16, 64.58, 58.33, 68.75, 64.58, 63.54, 68.75, 57.29, 56.25, 51.04, 53.12, 54.16, 63.54, 52.08, 56.25, 56.25, 56.25, 59.37, 59.37, 65.62, 56.25, 63.54, 59.37, 55.2, 58.33, 57.29, 52.08, 50.0, 55.2, 59.37, 62.5, 52.08, 51.04, 53.12, 55.2]
[rank3]:2026-01-02 20:45:29,735 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2045_stage3_step300.svg
[rank1]:2026-01-02 20:45:29,794 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2045_rank1_stage1.svg
[rank1]:	> Counts Sum: 196960, Total Sum: 311040 (63.32%), Ratio(%) per element: [71.87, 77.08, 69.79, 68.75, 75.0, 75.0, 76.04, 72.91, 76.04, 76.04, 69.79, 72.91, 71.87, 68.75, 70.83, 71.87, 66.66, 71.87, 67.7, 68.75, 69.79, 72.91, 76.04, 65.62, 66.66, 77.08, 67.7, 68.75, 64.58, 70.83, 66.66, 73.95, 65.62, 63.54, 70.83, 66.66, 73.95, 65.62, 69.79, 71.87, 72.91, 65.62, 67.7, 65.62, 68.75, 52.08, 56.25, 51.04, 54.16, 56.25, 50.0, 57.29, 59.37, 54.16, 59.37, 59.37, 52.08, 59.37, 53.12, 51.04, 56.25, 55.2, 58.33, 48.95, 57.29, 51.04, 54.16, 58.33, 52.08, 53.12, 50.0, 54.16, 46.87, 56.25, 51.04, 56.25, 56.25, 52.08, 53.12, 53.12, 61.45]
[rank3]:2026-01-02 20:45:29,894 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2045_rank3_stage3.svg
[rank3]:	> Counts Sum: 157440, Total Sum: 249600 (63.08%), Ratio(%) per element: [77.08, 76.04, 70.83, 71.87, 75.0, 69.79, 71.87, 69.79, 72.91, 70.83, 66.66, 68.75, 67.7, 67.7, 72.91, 72.91, 63.54, 70.83, 57.29, 61.45, 59.37, 64.58, 64.58, 65.62, 64.58, 69.79, 65.62, 65.62, 68.75, 62.5, 69.79, 60.41, 64.58, 64.58, 70.83, 67.7, 53.12, 62.5, 57.29, 57.29, 53.12, 56.25, 64.58, 55.2, 50.0, 54.16, 54.16, 53.12, 63.54, 56.25, 58.33, 53.12, 60.41, 55.2, 54.16, 55.2, 59.37, 65.62, 54.16, 60.41, 60.41, 58.33, 55.2, 56.25, 58.33]
[rank1]:2026-01-02 20:45:29,945 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2045_stage1.svg
[rank0]:2026-01-02 20:45:29,933 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2045_stage0.svg
[rank2]:2026-01-02 20:45:29,938 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2045_stage2.svg
[rank3]:2026-01-02 20:45:30,044 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2045_stage3.svg
[rank0]:2026-01-02 20:47:10,386 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-02 20:47:10,406 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:47:10,403 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.50/0.50, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 20:47:10,410 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.26/0.26, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 20:47:10,407 - Current/Expected Freeze Ratio per Block: [MB0] 0.90/0.90, [MB1] 0.92/0.92, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:47:12,364 - Avg. fwd time: 14.2193 / Avg. bwd time: 33.0510 / Avg. batch time: 493.1209 (ms) / GPU bubble ratio: 23.31%
[rank3]:2026-01-02 20:47:12,337 - Avg. fwd time: 15.2249 / Avg. bwd time: 37.8451 / Avg. batch time: 441.8071 (ms) / GPU bubble ratio: 3.90%
[rank1]:2026-01-02 20:47:12,421 - Avg. fwd time: 16.1006 / Avg. bwd time: 37.1808 / Avg. batch time: 559.7794 (ms) / GPU bubble ratio: 23.85%
[rank0]:2026-01-02 20:47:12,426 - Avg. fwd time: 14.7022 / Avg. bwd time: 33.9912 / Avg. batch time: 609.5020 (ms) / GPU bubble ratio: 36.09%
[rank0]:2026-01-02 20:47:12,461 -  step: 350  loss: -4.0000  grad_norm:  0.3488  memory: 72.15GiB(51.60%)  tps: 7,962  tflops: 371.34  mfu: 37.55%
[rank2]:2026-01-02 20:47:12,455 -  step: 350  loss: -4.0000  grad_norm:  0.3488  memory: 62.32GiB(44.58%)  tps: 7,962  tflops: 371.34  mfu: 37.55%
[rank3]:2026-01-02 20:47:12,459 -  step: 350  loss:  0.3389  grad_norm:  0.3488  memory: 76.42GiB(54.66%)  tps: 7,962  tflops: 371.35  mfu: 37.55%
[rank1]:2026-01-02 20:47:12,457 -  step: 350  loss: -4.0000  grad_norm:  0.3488  memory: 70.00GiB(50.07%)  tps: 7,962  tflops: 371.34  mfu: 37.55%
[rank3]:2026-01-02 20:48:53,147 - Current/Expected Freeze Ratio per Block: [MB0] 0.90/0.90, [MB1] 0.92/0.92, [MB2] 0.00/0.00, [MB3] 1.00/1.00, [MB4] 0.59/0.59, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 20:48:53,117 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 20:48:53,150 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.26/0.26, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:48:53,144 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.50/0.50, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-02 20:48:53,147 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 20:48:55,114 - Avg. fwd time: 14.2198 / Avg. bwd time: 31.7705 / Avg. batch time: 480.4503 (ms) / GPU bubble ratio: 23.42%
[rank3]:2026-01-02 20:48:55,082 - Avg. fwd time: 15.2214 / Avg. bwd time: 36.4141 / Avg. batch time: 430.3009 (ms) / GPU bubble ratio: 4.00%
[rank1]:2026-01-02 20:48:55,172 - Avg. fwd time: 16.1054 / Avg. bwd time: 35.7243 / Avg. batch time: 548.7699 (ms) / GPU bubble ratio: 24.44%
[rank1]:2026-01-02 20:48:55,208 -  step: 400  loss: -4.0000  grad_norm:  0.2126  memory: 70.00GiB(50.07%)  tps: 7,973  tflops: 371.85  mfu: 37.60%
[rank2]:2026-01-02 20:48:55,205 -  step: 400  loss: -4.0000  grad_norm:  0.2126  memory: 62.32GiB(44.58%)  tps: 7,973  tflops: 371.85  mfu: 37.60%
[rank2]:2026-01-02 20:48:55,258 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2048_stage2_step400.svg
[rank0]:2026-01-02 20:48:55,176 - Avg. fwd time: 14.6953 / Avg. bwd time: 32.3202 / Avg. batch time: 594.6232 (ms) / GPU bubble ratio: 36.75%
[rank0]:2026-01-02 20:48:55,212 -  step: 400  loss: -4.0000  grad_norm:  0.2126  memory: 72.15GiB(51.60%)  tps: 7,973  tflops: 371.85  mfu: 37.60%
[rank0]:2026-01-02 20:48:55,257 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2048_stage0_step400.svg
[rank3]:2026-01-02 20:48:55,210 -  step: 400  loss:  0.2749  grad_norm:  0.2126  memory: 76.42GiB(54.66%)  tps: 7,973  tflops: 371.85  mfu: 37.60%
[rank1]:2026-01-02 20:48:55,260 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2048_stage1_step400.svg
[rank3]:2026-01-02 20:48:55,333 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2048_step400_rank3.svg
[rank3]:			> Batch Time: 495.50 ms, GPU Bubble Ratio: 42.79%, 32.50%, 40.16%, 31.04%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-73ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  286-42-328ms   | [S0,MB1,B]  329-43-372ms   | [S0,MB2,B]  372-43-415ms   | [S0,MB3,B]  415-37-452ms   | [S0,MB4,B]  453-0-453ms    | [S0,MB5,B]  453-0-453ms    | [S0,MB6,B]  474-0-474ms    | [S0,MB7,B]  495-0-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-84ms     | [S1,MB4,F]  84-15-100ms    | [S1,MB5,F]  100-15-116ms   | [S1,MB6,F]  116-15-132ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  241-45-286ms   | [S1,MB1,B]  290-35-326ms   | [S1,MB2,B]  326-20-347ms   | [S1,MB3,B]  347-20-368ms   | [S1,MB4,B]  372-20-393ms   | [S1,MB5,B]  415-20-436ms   | [S1,MB6,B]  453-20-473ms   | [S1,MB7,B]  473-20-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  149-13-162ms   | [S2,MB0,B]  222-18-240ms   | [S2,MB1,B]  250-40-291ms   | [S2,MB2,B]  296-28-325ms   | [S2,MB3,B]  325-20-346ms   | [S2,MB4,B]  350-18-369ms   | [S2,MB5,B]  371-18-390ms   | [S2,MB6,B]  392-18-410ms   | [S2,MB7,B]  415-18-434ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  108-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-28-222ms   | [S3,MB1,B]  221-28-250ms   | [S3,MB2,B]  250-46-296ms   | [S3,MB3,B]  296-20-316ms   | [S3,MB4,B]  316-33-349ms   | [S3,MB5,B]  350-20-371ms   | [S3,MB6,B]  371-20-391ms   | [S3,MB7,B]  391-20-412ms  
[rank3]:2026-01-02 20:48:55,376 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2048_stage3_step400.svg
[rank2]:2026-01-02 20:48:55,430 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2048_rank2_stage2.svg
[rank2]:	> Counts Sum: 359560, Total Sum: 506880 (70.94%), Ratio(%) per element: [81.81, 77.84, 77.84, 76.7, 80.68, 78.4, 78.97, 78.4, 77.84, 76.13, 77.84, 74.43, 78.97, 76.13, 76.7, 79.54, 76.13, 77.27, 70.45, 69.31, 73.86, 74.43, 68.18, 68.75, 69.31, 69.88, 69.88, 73.29, 70.45, 73.86, 69.31, 71.59, 68.75, 69.31, 71.59, 67.04, 68.18, 66.47, 72.15, 66.47, 75.0, 73.86, 72.15, 72.72, 67.61, 67.04, 62.5, 65.9, 65.34, 71.02, 64.2, 64.2, 65.9, 66.47, 68.75, 69.31, 70.45, 65.34, 71.02, 68.75, 65.9, 67.61, 67.04, 64.2, 63.63, 65.34, 69.31, 68.18, 65.34, 65.34, 67.04, 66.47]
[rank0]:2026-01-02 20:48:55,427 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2048_rank0_stage0.svg
[rank0]:	> Counts Sum: 258080, Total Sum: 513920 (50.22%), Ratio(%) per element: [47.15, 56.25, 55.68, 59.09, 58.52, 57.38, 56.81, 56.81, 57.95, 58.52, 55.68, 55.68, 55.68, 56.25, 55.68, 53.4, 54.54, 53.4, 53.97, 48.86, 51.13, 52.27, 52.27, 51.13, 54.54, 50.56, 53.4, 51.7, 46.59, 46.59, 47.72, 50.0, 46.59, 48.29, 50.56, 46.02, 46.59, 47.72, 49.43, 46.02, 48.86, 49.43, 50.0, 47.15, 44.31, 47.72, 48.86, 49.43, 47.15, 46.59, 47.15, 44.88, 47.72, 48.29, 47.72, 50.0, 51.13, 45.45, 46.59, 49.43, 46.02, 46.59, 48.29, 49.43, 46.02, 46.59, 46.02, 44.31, 46.59, 47.15, 47.15, 47.72, 49.43]
[rank1]:2026-01-02 20:48:55,442 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2048_rank1_stage1.svg
[rank1]:	> Counts Sum: 404160, Total Sum: 570240 (70.88%), Ratio(%) per element: [75.56, 79.54, 76.13, 73.86, 78.4, 79.54, 78.4, 77.27, 78.97, 77.84, 75.0, 77.27, 75.56, 73.86, 75.0, 76.13, 73.86, 75.56, 75.56, 76.13, 76.13, 76.13, 78.97, 72.15, 74.43, 79.54, 73.86, 73.86, 73.29, 75.56, 73.29, 78.4, 73.29, 71.02, 73.86, 73.29, 77.27, 73.29, 75.56, 76.7, 77.27, 70.45, 74.43, 71.59, 75.0, 64.77, 66.47, 63.06, 65.34, 67.04, 62.5, 67.61, 68.75, 64.77, 68.18, 68.18, 64.77, 67.04, 64.77, 63.06, 65.9, 65.34, 67.04, 61.93, 65.9, 61.93, 64.77, 67.04, 63.06, 63.06, 63.06, 64.77, 60.79, 66.47, 63.06, 65.34, 66.47, 63.06, 64.2, 64.77, 68.18]
[rank3]:2026-01-02 20:48:55,534 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2048_rank3_stage3.svg
[rank3]:	> Counts Sum: 323840, Total Sum: 457600 (70.77%), Ratio(%) per element: [80.68, 78.4, 76.7, 77.27, 79.54, 77.27, 77.84, 76.7, 77.84, 76.7, 75.0, 76.13, 75.56, 75.56, 77.27, 78.97, 73.29, 77.84, 69.88, 69.31, 68.75, 72.72, 73.29, 71.59, 71.59, 76.13, 73.29, 72.72, 76.13, 69.88, 73.86, 69.88, 72.72, 71.59, 76.13, 75.0, 66.47, 70.45, 65.9, 68.18, 65.9, 68.18, 71.02, 65.34, 63.06, 65.9, 63.06, 65.34, 68.18, 65.34, 64.77, 64.77, 69.31, 63.63, 63.06, 63.06, 64.77, 68.75, 64.2, 65.34, 67.04, 65.34, 64.2, 63.06, 63.06]
[rank1]:2026-01-02 20:48:55,715 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2048_stage1.svg
[rank2]:2026-01-02 20:48:55,704 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2048_stage2.svg
[rank0]:2026-01-02 20:48:55,687 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2048_stage0.svg
[rank3]:2026-01-02 20:48:55,789 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2048_stage3.svg
[rank0]:2026-01-02 20:50:35,968 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:50:37,949 - Avg. fwd time: 14.2200 / Avg. bwd time: 30.7845 / Avg. batch time: 470.3341 (ms) / GPU bubble ratio: 23.45%
[rank3]:2026-01-02 20:50:37,923 - Avg. fwd time: 15.2190 / Avg. bwd time: 35.2007 / Avg. batch time: 420.5499 (ms) / GPU bubble ratio: 4.09%
[rank1]:2026-01-02 20:50:38,008 - Avg. fwd time: 16.1110 / Avg. bwd time: 34.5845 / Avg. batch time: 539.9920 (ms) / GPU bubble ratio: 24.89%
[rank0]:2026-01-02 20:50:38,012 - Avg. fwd time: 14.6890 / Avg. bwd time: 31.0264 / Avg. batch time: 582.8422 (ms) / GPU bubble ratio: 37.25%
[rank0]:2026-01-02 20:50:38,048 -  step: 450  loss: -4.0000  grad_norm:  0.1634  memory: 72.15GiB(51.60%)  tps: 7,966  tflops: 371.54  mfu: 37.57%
[rank2]:2026-01-02 20:50:38,041 -  step: 450  loss: -4.0000  grad_norm:  0.1634  memory: 62.32GiB(44.58%)  tps: 7,966  tflops: 371.54  mfu: 37.57%
[rank3]:2026-01-02 20:50:38,046 -  step: 450  loss:  0.2967  grad_norm:  0.1634  memory: 76.42GiB(54.66%)  tps: 7,966  tflops: 371.54  mfu: 37.57%
[rank1]:2026-01-02 20:50:38,044 -  step: 450  loss: -4.0000  grad_norm:  0.1634  memory: 70.00GiB(50.07%)  tps: 7,966  tflops: 371.54  mfu: 37.57%
[rank0]:2026-01-02 20:52:18,670 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:52:20,633 - Avg. fwd time: 15.2175 / Avg. bwd time: 34.3071 / Avg. batch time: 413.3698 (ms) / GPU bubble ratio: 4.15%
[rank0]:2026-01-02 20:52:20,732 - Avg. fwd time: 14.6833 / Avg. bwd time: 29.9929 / Avg. batch time: 573.5853 (ms) / GPU bubble ratio: 37.69%
[rank2]:2026-01-02 20:52:20,665 - Avg. fwd time: 14.2206 / Avg. bwd time: 29.9849 / Avg. batch time: 462.4050 (ms) / GPU bubble ratio: 23.52%
[rank1]:2026-01-02 20:52:20,727 - Avg. fwd time: 16.1142 / Avg. bwd time: 33.6845 / Avg. batch time: 533.1441 (ms) / GPU bubble ratio: 25.28%
[rank1]:2026-01-02 20:52:20,764 -  step: 500  loss: -4.0000  grad_norm:  0.1824  memory: 70.00GiB(50.07%)  tps: 7,975  tflops: 371.96  mfu: 37.61%
[rank0]:2026-01-02 20:52:20,768 -  step: 500  loss: -4.0000  grad_norm:  0.1824  memory: 72.15GiB(51.60%)  tps: 7,975  tflops: 371.96  mfu: 37.61%
[rank0]:2026-01-02 20:52:20,810 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2052_stage0_step500.svg
[rank2]:2026-01-02 20:52:20,761 -  step: 500  loss: -4.0000  grad_norm:  0.1824  memory: 62.32GiB(44.58%)  tps: 7,975  tflops: 371.96  mfu: 37.61%
[rank2]:2026-01-02 20:52:20,811 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2052_stage2_step500.svg
[rank3]:2026-01-02 20:52:20,766 -  step: 500  loss:  0.3013  grad_norm:  0.1824  memory: 76.42GiB(54.66%)  tps: 7,975  tflops: 371.96  mfu: 37.61%
[rank1]:2026-01-02 20:52:20,812 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2052_stage1_step500.svg
[rank3]:2026-01-02 20:52:20,888 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2052_step500_rank3.svg
[rank3]:			> Batch Time: 491.75 ms, GPU Bubble Ratio: 42.06%, 31.77%, 39.34%, 32.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  282-42-324ms   | [S0,MB1,B]  324-43-367ms   | [S0,MB2,B]  367-43-411ms   | [S0,MB3,B]  411-38-449ms   | [S0,MB4,B]  449-0-449ms    | [S0,MB5,B]  449-0-449ms    | [S0,MB6,B]  470-0-470ms    | [S0,MB7,B]  491-0-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  133-16-149ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  281-36-318ms   | [S1,MB2,B]  318-20-339ms   | [S1,MB3,B]  339-20-360ms   | [S1,MB4,B]  367-20-388ms   | [S1,MB5,B]  411-20-432ms   | [S1,MB6,B]  449-20-470ms   | [S1,MB7,B]  470-20-490ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  217-18-235ms   | [S2,MB1,B]  240-40-281ms   | [S2,MB2,B]  287-30-318ms   | [S2,MB3,B]  318-20-338ms   | [S2,MB4,B]  342-18-361ms   | [S2,MB5,B]  363-18-381ms   | [S2,MB6,B]  384-18-402ms   | [S2,MB7,B]  411-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-22-216ms   | [S3,MB1,B]  216-23-240ms   | [S3,MB2,B]  240-46-286ms   | [S3,MB3,B]  286-21-307ms   | [S3,MB4,B]  307-34-341ms   | [S3,MB5,B]  341-20-362ms   | [S3,MB6,B]  362-20-383ms   | [S3,MB7,B]  383-20-404ms  
[rank3]:2026-01-02 20:52:20,927 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2052_stage3_step500.svg
[rank0]:2026-01-02 20:52:20,985 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2052_rank0_stage0.svg
[rank0]:	> Counts Sum: 382480, Total Sum: 747520 (51.17%), Ratio(%) per element: [48.43, 55.46, 57.03, 57.03, 57.81, 56.25, 56.25, 56.25, 56.64, 57.03, 56.25, 55.85, 55.07, 55.46, 55.85, 53.12, 54.68, 54.29, 53.12, 50.0, 51.95, 52.34, 51.56, 51.56, 54.68, 50.78, 52.34, 51.95, 48.43, 48.43, 50.39, 50.39, 48.82, 50.0, 51.17, 48.82, 48.43, 49.6, 50.39, 47.65, 50.78, 50.0, 51.17, 48.43, 48.04, 49.6, 50.0, 49.6, 48.82, 48.43, 48.82, 47.26, 50.0, 49.6, 49.6, 50.39, 52.34, 48.04, 50.0, 50.0, 47.26, 48.43, 49.6, 50.0, 48.04, 48.04, 48.43, 48.04, 48.04, 49.6, 48.43, 48.82, 49.6]
[rank2]:2026-01-02 20:52:20,982 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2052_rank2_stage2.svg
[rank2]:	> Counts Sum: 543960, Total Sum: 737280 (73.78%), Ratio(%) per element: [82.81, 79.68, 79.29, 78.51, 81.64, 80.07, 80.85, 79.29, 79.68, 77.73, 78.9, 76.17, 78.12, 78.51, 78.51, 80.85, 76.95, 79.29, 73.82, 73.82, 76.17, 75.78, 72.65, 71.48, 73.82, 73.43, 73.82, 76.17, 73.04, 75.39, 73.04, 74.6, 70.31, 73.04, 73.82, 71.09, 71.87, 71.09, 75.0, 70.7, 75.78, 76.17, 75.0, 75.0, 71.87, 70.31, 67.96, 70.7, 69.53, 73.43, 69.14, 67.96, 69.92, 69.92, 72.26, 73.04, 74.21, 68.35, 73.82, 72.65, 69.92, 71.09, 71.09, 68.35, 67.18, 67.96, 70.7, 69.92, 69.14, 68.35, 71.09, 69.14]
[rank1]:2026-01-02 20:52:20,993 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2052_rank1_stage1.svg
[rank1]:	> Counts Sum: 611360, Total Sum: 829440 (73.71%), Ratio(%) per element: [78.9, 81.64, 79.68, 76.17, 80.46, 81.25, 79.68, 79.68, 80.46, 77.73, 76.95, 78.12, 77.73, 76.56, 76.95, 77.34, 75.78, 77.73, 77.34, 78.12, 78.12, 77.34, 78.12, 75.39, 76.56, 80.07, 76.17, 75.78, 75.78, 76.95, 76.17, 79.29, 75.78, 74.21, 75.78, 75.0, 76.95, 75.78, 75.39, 77.34, 77.73, 73.43, 75.39, 74.21, 76.56, 69.92, 69.92, 67.18, 69.14, 71.09, 67.96, 71.48, 71.87, 68.35, 71.87, 71.87, 68.75, 71.09, 68.75, 68.75, 69.53, 69.53, 70.31, 67.96, 69.92, 66.79, 68.35, 70.31, 67.18, 67.57, 67.18, 69.14, 66.4, 70.7, 67.96, 68.75, 69.92, 67.96, 67.96, 69.14, 71.87]
[rank3]:2026-01-02 20:52:21,085 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2052_rank3_stage3.svg
[rank3]:	> Counts Sum: 490240, Total Sum: 665600 (73.65%), Ratio(%) per element: [81.64, 79.29, 78.51, 80.07, 80.85, 78.9, 79.68, 78.9, 79.68, 78.9, 77.34, 78.51, 77.34, 77.34, 79.29, 79.68, 75.0, 78.51, 74.21, 74.21, 72.26, 76.17, 77.34, 75.78, 75.39, 78.51, 75.78, 74.6, 76.56, 72.26, 75.39, 71.87, 74.6, 73.82, 78.12, 75.78, 71.09, 73.43, 69.14, 71.87, 69.14, 70.7, 73.43, 69.92, 67.18, 71.09, 66.4, 69.14, 69.92, 68.35, 69.92, 69.14, 72.26, 67.96, 66.4, 67.18, 68.35, 73.04, 68.35, 68.75, 70.7, 69.92, 68.75, 66.01, 67.57]
[rank1]:2026-01-02 20:52:21,377 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2052_stage1.svg
[rank0]:2026-01-02 20:52:21,375 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2052_stage0.svg
[rank2]:2026-01-02 20:52:21,365 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2052_stage2.svg
[rank3]:2026-01-02 20:52:21,450 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2052_stage3.svg
[rank0]:2026-01-02 20:54:01,382 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 20:54:03,354 - Avg. fwd time: 15.2116 / Avg. bwd time: 33.5173 / Avg. batch time: 406.9885 (ms) / GPU bubble ratio: 4.22%
[rank2]:2026-01-02 20:54:03,379 - Avg. fwd time: 14.2186 / Avg. bwd time: 29.3281 / Avg. batch time: 455.8287 (ms) / GPU bubble ratio: 23.57%
[rank1]:2026-01-02 20:54:03,434 - Avg. fwd time: 16.1148 / Avg. bwd time: 32.9428 / Avg. batch time: 527.3791 (ms) / GPU bubble ratio: 25.58%
[rank1]:2026-01-02 20:54:03,470 -  step: 550  loss: -4.0000  grad_norm:  0.1862  memory: 70.00GiB(50.07%)  tps: 7,976  tflops: 372.01  mfu: 37.61%
[rank0]:2026-01-02 20:54:03,439 - Avg. fwd time: 14.6765 / Avg. bwd time: 29.1379 / Avg. batch time: 565.8490 (ms) / GPU bubble ratio: 38.06%
[rank0]:2026-01-02 20:54:03,474 -  step: 550  loss: -4.0000  grad_norm:  0.1862  memory: 72.15GiB(51.60%)  tps: 7,976  tflops: 372.01  mfu: 37.61%
[rank2]:2026-01-02 20:54:03,468 -  step: 550  loss: -4.0000  grad_norm:  0.1862  memory: 62.32GiB(44.58%)  tps: 7,976  tflops: 372.01  mfu: 37.61%
[rank3]:2026-01-02 20:54:03,472 -  step: 550  loss:  0.1725  grad_norm:  0.1862  memory: 76.42GiB(54.66%)  tps: 7,976  tflops: 372.01  mfu: 37.62%
[rank0]:2026-01-02 20:55:45,145 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:55:47,155 - Avg. fwd time: 15.2232 / Avg. bwd time: 32.9778 / Avg. batch time: 402.7547 (ms) / GPU bubble ratio: 4.26%
[rank2]:2026-01-02 20:55:47,180 - Avg. fwd time: 14.2311 / Avg. bwd time: 28.7918 / Avg. batch time: 450.8367 (ms) / GPU bubble ratio: 23.66%
[rank1]:2026-01-02 20:55:47,239 - Avg. fwd time: 16.1298 / Avg. bwd time: 32.3307 / Avg. batch time: 523.0801 (ms) / GPU bubble ratio: 25.88%
[rank0]:2026-01-02 20:55:47,244 - Avg. fwd time: 14.6837 / Avg. bwd time: 28.4333 / Avg. batch time: 559.9178 (ms) / GPU bubble ratio: 38.40%
[rank0]:2026-01-02 20:55:47,280 -  step: 600  loss: -4.0000  grad_norm:  0.5000  memory: 72.15GiB(51.60%)  tps: 7,892  tflops: 368.07  mfu: 37.22%
[rank3]:2026-01-02 20:55:47,277 -  step: 600  loss:  0.4029  grad_norm:  0.5000  memory: 76.42GiB(54.66%)  tps: 7,892  tflops: 368.07  mfu: 37.22%
[rank2]:2026-01-02 20:55:47,273 -  step: 600  loss: -4.0000  grad_norm:  0.5000  memory: 62.32GiB(44.58%)  tps: 7,892  tflops: 368.07  mfu: 37.22%
[rank1]:2026-01-02 20:55:47,275 -  step: 600  loss: -4.0000  grad_norm:  0.5000  memory: 70.00GiB(50.07%)  tps: 7,892  tflops: 368.07  mfu: 37.22%
[rank1]:2026-01-02 20:55:47,325 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2055_stage1_step600.svg
[rank3]:2026-01-02 20:55:47,402 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2055_step600_rank3.svg
[rank3]:			> Batch Time: 501.75 ms, GPU Bubble Ratio: 42.58%, 32.66%, 40.42%, 32.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  290-42-333ms   | [S0,MB1,B]  333-43-376ms   | [S0,MB2,B]  376-43-419ms   | [S0,MB3,B]  420-39-459ms   | [S0,MB4,B]  459-0-459ms    | [S0,MB5,B]  459-0-459ms    | [S0,MB6,B]  480-0-480ms    | [S0,MB7,B]  501-0-501ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  102-16-118ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  135-16-151ms   | [S1,MB0,B]  245-45-290ms   | [S1,MB1,B]  290-35-326ms   | [S1,MB2,B]  326-21-347ms   | [S1,MB3,B]  347-21-368ms   | [S1,MB4,B]  376-21-397ms   | [S1,MB5,B]  419-20-440ms   | [S1,MB6,B]  459-20-480ms   | [S1,MB7,B]  480-20-500ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  85-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  118-14-132ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  151-14-165ms   | [S2,MB0,B]  226-18-244ms   | [S2,MB1,B]  249-40-290ms   | [S2,MB2,B]  296-27-323ms   | [S2,MB3,B]  323-21-345ms   | [S2,MB4,B]  347-18-366ms   | [S2,MB5,B]  369-18-387ms   | [S2,MB6,B]  390-18-408ms   | [S2,MB7,B]  420-18-438ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  127-15-142ms   | [S3,MB5,F]  144-15-159ms   | [S3,MB6,F]  161-15-177ms   | [S3,MB7,F]  179-15-194ms   | [S3,MB0,B]  196-29-226ms   | [S3,MB1,B]  225-23-248ms   | [S3,MB2,B]  249-46-296ms   | [S3,MB3,B]  295-21-316ms   | [S3,MB4,B]  316-30-346ms   | [S3,MB5,B]  347-21-368ms   | [S3,MB6,B]  368-21-389ms   | [S3,MB7,B]  389-21-410ms  
[rank0]:2026-01-02 20:55:47,324 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2055_stage0_step600.svg
[rank2]:2026-01-02 20:55:47,325 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2055_stage2_step600.svg
[rank0]:2026-01-02 20:55:47,495 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2055_rank0_stage0.svg
[rank0]:	> Counts Sum: 506880, Total Sum: 981120 (51.66%), Ratio(%) per element: [49.4, 55.35, 56.25, 56.25, 56.84, 55.35, 55.65, 55.65, 56.25, 55.65, 55.95, 55.65, 54.76, 55.65, 55.65, 53.27, 54.46, 53.86, 53.57, 50.29, 52.38, 52.38, 52.38, 52.97, 54.76, 51.19, 53.57, 51.48, 49.7, 50.0, 51.48, 50.89, 50.0, 50.29, 51.48, 50.0, 50.0, 49.7, 50.29, 49.1, 51.48, 51.19, 52.08, 48.8, 49.4, 50.59, 50.29, 49.7, 49.4, 49.7, 49.7, 49.1, 50.0, 50.0, 50.0, 50.89, 52.97, 49.1, 51.19, 50.89, 48.21, 49.7, 50.59, 51.19, 48.8, 49.1, 50.29, 48.8, 48.8, 50.0, 49.7, 49.4, 50.29]
[rank3]:2026-01-02 20:55:47,441 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2055_stage3_step600.svg
[rank2]:2026-01-02 20:55:47,502 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2055_rank2_stage2.svg
[rank2]:	> Counts Sum: 728360, Total Sum: 967680 (75.27%), Ratio(%) per element: [81.54, 80.05, 80.35, 79.46, 81.54, 79.76, 81.84, 79.76, 79.76, 78.27, 78.57, 77.97, 79.16, 79.46, 79.16, 81.54, 78.57, 79.76, 75.59, 75.59, 77.67, 77.08, 74.4, 73.21, 76.78, 75.29, 75.89, 78.57, 73.8, 77.38, 74.4, 75.29, 72.32, 75.59, 75.29, 73.21, 74.4, 72.61, 75.89, 72.91, 76.78, 77.08, 76.78, 76.48, 73.51, 72.61, 71.42, 73.51, 72.32, 74.7, 71.72, 71.42, 72.61, 72.32, 72.32, 74.1, 75.29, 69.64, 74.4, 73.8, 72.61, 71.42, 72.32, 69.94, 69.94, 71.13, 72.02, 71.42, 71.72, 70.53, 72.61, 70.83]
[rank1]:2026-01-02 20:55:47,508 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2055_rank1_stage1.svg
[rank1]:	> Counts Sum: 818560, Total Sum: 1088640 (75.19%), Ratio(%) per element: [80.35, 82.73, 80.05, 77.67, 80.95, 80.95, 80.35, 80.35, 81.54, 78.27, 77.38, 79.16, 77.97, 78.27, 77.08, 78.27, 76.78, 78.27, 77.38, 78.27, 78.57, 78.27, 78.57, 75.59, 77.38, 80.35, 77.38, 77.38, 76.48, 77.97, 77.67, 79.46, 76.78, 75.29, 76.19, 75.89, 77.97, 76.78, 76.48, 77.97, 77.08, 75.0, 77.08, 75.89, 77.08, 72.91, 72.32, 69.64, 71.13, 73.8, 70.83, 73.8, 73.21, 70.53, 73.21, 74.4, 70.83, 73.21, 70.83, 71.13, 71.72, 72.91, 72.32, 70.53, 72.32, 69.64, 71.72, 72.02, 69.94, 69.34, 69.94, 71.13, 69.04, 72.02, 69.94, 71.72, 72.02, 71.13, 70.83, 72.02, 73.51]
[rank3]:2026-01-02 20:55:47,600 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2055_rank3_stage3.svg
[rank3]:	> Counts Sum: 656640, Total Sum: 873600 (75.16%), Ratio(%) per element: [81.84, 80.65, 79.76, 80.35, 81.54, 80.65, 79.76, 79.76, 80.65, 80.35, 78.27, 79.46, 77.97, 78.57, 80.35, 80.35, 75.59, 78.86, 76.48, 76.19, 74.4, 77.08, 77.97, 77.08, 77.38, 78.27, 77.67, 76.48, 77.38, 74.7, 77.08, 74.4, 76.48, 75.0, 78.27, 77.38, 73.8, 75.0, 72.02, 73.8, 71.13, 73.21, 74.4, 73.21, 70.53, 72.32, 70.23, 71.13, 72.02, 69.64, 71.72, 71.13, 74.1, 71.13, 69.34, 67.85, 68.75, 73.51, 70.53, 70.53, 72.32, 71.13, 70.23, 67.85, 68.45]
[rank0]:2026-01-02 20:55:47,981 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2055_stage0.svg
[rank2]:2026-01-02 20:55:48,018 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2055_stage2.svg
[rank1]:2026-01-02 20:55:48,021 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2055_stage1.svg
[rank3]:2026-01-02 20:55:48,066 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2055_stage3.svg
[rank0]:2026-01-02 20:57:30,432 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 20:57:32,415 - Avg. fwd time: 15.2453 / Avg. bwd time: 32.5073 / Avg. batch time: 399.1606 (ms) / GPU bubble ratio: 4.29%
[rank2]:2026-01-02 20:57:32,446 - Avg. fwd time: 14.2517 / Avg. bwd time: 28.3410 / Avg. batch time: 446.6920 (ms) / GPU bubble ratio: 23.72%
[rank1]:2026-01-02 20:57:32,509 - Avg. fwd time: 16.1527 / Avg. bwd time: 31.8121 / Avg. batch time: 519.5459 (ms) / GPU bubble ratio: 26.14%
[rank0]:2026-01-02 20:57:32,515 - Avg. fwd time: 14.7017 / Avg. bwd time: 27.8377 / Avg. batch time: 555.0174 (ms) / GPU bubble ratio: 38.68%
[rank0]:2026-01-02 20:57:32,550 -  step: 650  loss: -4.0000  grad_norm:  0.3468  memory: 72.15GiB(51.60%)  tps: 7,782  tflops: 362.95  mfu: 36.70%
[rank3]:2026-01-02 20:57:32,548 -  step: 650  loss:  0.2743  grad_norm:  0.3468  memory: 76.42GiB(54.66%)  tps: 7,782  tflops: 362.95  mfu: 36.70%
[rank2]:2026-01-02 20:57:32,544 -  step: 650  loss: -4.0000  grad_norm:  0.3468  memory: 62.32GiB(44.58%)  tps: 7,782  tflops: 362.95  mfu: 36.70%
[rank1]:2026-01-02 20:57:32,546 -  step: 650  loss: -4.0000  grad_norm:  0.3468  memory: 70.00GiB(50.07%)  tps: 7,782  tflops: 362.95  mfu: 36.70%
[rank0]:2026-01-02 20:59:15,091 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:59:17,133 - Avg. fwd time: 15.2650 / Avg. bwd time: 32.1036 / Avg. batch time: 396.0838 (ms) / GPU bubble ratio: 4.33%
[rank2]:2026-01-02 20:59:17,160 - Avg. fwd time: 14.2703 / Avg. bwd time: 27.9611 / Avg. batch time: 443.2020 (ms) / GPU bubble ratio: 23.77%
[rank0]:2026-01-02 20:59:17,228 - Avg. fwd time: 14.7166 / Avg. bwd time: 27.3269 / Avg. batch time: 550.8509 (ms) / GPU bubble ratio: 38.94%
[rank0]:2026-01-02 20:59:17,263 -  step: 700  loss: -4.0000  grad_norm:  0.2879  memory: 72.15GiB(51.60%)  tps: 7,823  tflops: 364.88  mfu: 36.89%
[rank2]:2026-01-02 20:59:17,257 -  step: 700  loss: -4.0000  grad_norm:  0.2879  memory: 62.32GiB(44.58%)  tps: 7,823  tflops: 364.88  mfu: 36.89%
[rank3]:2026-01-02 20:59:17,261 -  step: 700  loss:  0.3598  grad_norm:  0.2879  memory: 76.42GiB(54.66%)  tps: 7,823  tflops: 364.88  mfu: 36.89%
[rank1]:2026-01-02 20:59:17,222 - Avg. fwd time: 16.1732 / Avg. bwd time: 31.3735 / Avg. batch time: 516.5558 (ms) / GPU bubble ratio: 26.36%
[rank1]:2026-01-02 20:59:17,259 -  step: 700  loss: -4.0000  grad_norm:  0.2879  memory: 70.00GiB(50.07%)  tps: 7,823  tflops: 364.88  mfu: 36.89%
[rank1]:2026-01-02 20:59:17,309 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2059_stage1_step700.svg
[rank0]:2026-01-02 20:59:17,308 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2059_stage0_step700.svg
[rank3]:2026-01-02 20:59:17,388 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2059_step700_rank3.svg
[rank3]:			> Batch Time: 496.75 ms, GPU Bubble Ratio: 42.15%, 31.87%, 38.69%, 32.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  286-42-329ms   | [S0,MB1,B]  329-43-373ms   | [S0,MB2,B]  373-43-416ms   | [S0,MB3,B]  416-37-454ms   | [S0,MB4,B]  454-0-454ms    | [S0,MB5,B]  454-0-454ms    | [S0,MB6,B]  475-0-475ms    | [S0,MB7,B]  496-0-496ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  241-45-286ms   | [S1,MB1,B]  286-35-322ms   | [S1,MB2,B]  323-21-344ms   | [S1,MB3,B]  345-21-366ms   | [S1,MB4,B]  372-21-393ms   | [S1,MB5,B]  416-20-437ms   | [S1,MB6,B]  454-20-474ms   | [S1,MB7,B]  475-20-495ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  222-18-240ms   | [S2,MB1,B]  245-40-285ms   | [S2,MB2,B]  291-31-323ms   | [S2,MB3,B]  323-22-345ms   | [S2,MB4,B]  347-18-366ms   | [S2,MB5,B]  368-18-387ms   | [S2,MB6,B]  389-18-408ms   | [S2,MB7,B]  416-18-435ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  110-15-125ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-23-221ms   | [S3,MB1,B]  221-23-244ms   | [S3,MB2,B]  244-46-291ms   | [S3,MB3,B]  291-21-312ms   | [S3,MB4,B]  312-34-347ms   | [S3,MB5,B]  346-21-368ms   | [S3,MB6,B]  368-21-389ms   | [S3,MB7,B]  389-21-410ms  
[rank2]:2026-01-02 20:59:17,310 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2059_stage2_step700.svg
[rank0]:2026-01-02 20:59:17,480 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2059_rank0_stage0.svg
[rank0]:	> Counts Sum: 631280, Total Sum: 1214720 (51.97%), Ratio(%) per element: [50.24, 55.52, 56.0, 55.76, 56.49, 55.76, 55.52, 55.52, 56.49, 55.76, 55.76, 55.52, 55.28, 55.52, 54.8, 53.84, 54.32, 54.08, 53.84, 50.72, 52.4, 52.64, 52.64, 53.36, 54.56, 51.68, 54.32, 52.4, 49.75, 50.24, 51.92, 50.96, 50.48, 50.48, 51.68, 50.0, 50.72, 50.0, 50.72, 50.24, 51.92, 51.2, 52.4, 49.27, 50.24, 50.72, 50.48, 50.48, 50.0, 50.0, 49.75, 49.75, 50.48, 50.48, 50.72, 51.2, 52.4, 49.51, 51.2, 51.2, 49.51, 50.24, 50.48, 51.44, 49.27, 50.24, 50.72, 50.0, 49.03, 50.48, 50.0, 49.75, 50.96]
[rank3]:2026-01-02 20:59:17,430 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2059_stage3_step700.svg
[rank2]:2026-01-02 20:59:17,482 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2059_rank2_stage2.svg
[rank2]:	> Counts Sum: 912760, Total Sum: 1198080 (76.19%), Ratio(%) per element: [81.49, 81.0, 81.49, 79.8, 82.69, 80.76, 82.21, 80.76, 81.0, 79.32, 78.84, 78.84, 79.32, 79.8, 79.56, 81.25, 78.84, 80.28, 76.44, 76.68, 77.4, 77.88, 75.48, 74.75, 78.12, 76.68, 76.92, 79.32, 75.0, 78.6, 75.96, 76.2, 74.51, 76.68, 77.16, 74.03, 75.72, 74.27, 76.68, 73.79, 77.64, 77.64, 76.68, 77.64, 75.0, 74.03, 73.31, 73.79, 72.83, 75.72, 73.55, 73.31, 74.51, 73.55, 73.79, 74.75, 76.92, 71.15, 75.48, 74.51, 73.07, 72.59, 73.79, 70.67, 70.67, 71.39, 72.11, 71.63, 72.11, 71.15, 73.07, 71.39]
[rank1]:2026-01-02 20:59:17,490 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2059_rank1_stage1.svg
[rank1]:	> Counts Sum: 1025760, Total Sum: 1347840 (76.10%), Ratio(%) per element: [81.73, 83.65, 81.49, 79.56, 82.21, 82.21, 81.73, 81.73, 82.69, 79.56, 78.6, 80.52, 79.08, 79.56, 78.6, 80.04, 78.36, 79.56, 78.12, 78.84, 80.04, 78.6, 79.08, 76.92, 78.36, 81.0, 78.36, 77.64, 76.92, 77.88, 77.88, 79.32, 76.92, 75.96, 75.96, 76.44, 78.36, 77.4, 76.44, 77.88, 77.16, 75.24, 77.4, 75.72, 77.4, 73.31, 73.55, 71.15, 72.11, 74.75, 71.63, 74.51, 73.79, 71.39, 73.55, 74.51, 72.35, 74.03, 72.59, 72.59, 72.35, 74.03, 73.07, 72.35, 73.55, 70.67, 73.07, 72.59, 71.39, 71.15, 71.15, 73.07, 70.67, 73.07, 71.39, 72.59, 73.07, 71.87, 71.63, 73.07, 74.27]
[rank3]:2026-01-02 20:59:17,589 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2059_rank3_stage3.svg
[rank3]:	> Counts Sum: 823040, Total Sum: 1081600 (76.09%), Ratio(%) per element: [82.45, 81.73, 80.76, 81.25, 81.73, 81.73, 80.52, 80.52, 81.25, 81.25, 79.56, 80.52, 79.32, 80.28, 81.73, 81.49, 77.64, 80.52, 77.88, 78.36, 76.2, 78.12, 79.32, 78.6, 78.36, 79.56, 78.6, 78.6, 77.88, 76.68, 78.36, 76.44, 77.64, 76.2, 79.32, 78.36, 75.0, 76.2, 73.07, 74.75, 71.87, 74.51, 75.24, 73.31, 72.35, 73.79, 72.35, 71.39, 72.83, 71.15, 72.35, 71.63, 73.31, 71.63, 69.47, 68.99, 69.23, 72.11, 69.95, 70.43, 72.35, 70.91, 70.43, 68.5, 68.02]
[rank0]:2026-01-02 20:59:18,074 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2059_stage0.svg
[rank3]:2026-01-02 20:59:18,178 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2059_stage3.svg
[rank2]:2026-01-02 20:59:18,123 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2059_stage2.svg
[rank1]:2026-01-02 20:59:18,118 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2059_stage1.svg
[rank0]:2026-01-02 21:01:00,192 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 21:01:02,213 - Avg. fwd time: 14.2812 / Avg. bwd time: 27.6252 / Avg. batch time: 440.0507 (ms) / GPU bubble ratio: 23.82%
[rank3]:2026-01-02 21:01:02,188 - Avg. fwd time: 15.2759 / Avg. bwd time: 31.7307 / Avg. batch time: 393.1821 (ms) / GPU bubble ratio: 4.36%
[rank0]:2026-01-02 21:01:02,280 - Avg. fwd time: 14.7266 / Avg. bwd time: 26.8888 / Avg. batch time: 547.1859 (ms) / GPU bubble ratio: 39.16%
[rank1]:2026-01-02 21:01:02,274 - Avg. fwd time: 16.1868 / Avg. bwd time: 30.9921 / Avg. batch time: 513.9053 (ms) / GPU bubble ratio: 26.56%
[rank2]:2026-01-02 21:01:02,309 -  step: 750  loss: -4.0000  grad_norm:  0.2439  memory: 62.32GiB(44.58%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank3]:2026-01-02 21:01:02,314 -  step: 750  loss:  0.1499  grad_norm:  0.2439  memory: 76.42GiB(54.66%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank0]:2026-01-02 21:01:02,316 -  step: 750  loss: -4.0000  grad_norm:  0.2439  memory: 72.15GiB(51.60%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank1]:2026-01-02 21:01:02,311 -  step: 750  loss: -4.0000  grad_norm:  0.2439  memory: 70.00GiB(50.07%)  tps: 7,798  tflops: 363.70  mfu: 36.77%
[rank0]:2026-01-02 21:02:42,813 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:02:44,822 - Avg. fwd time: 15.2755 / Avg. bwd time: 31.3932 / Avg. batch time: 390.4726 (ms) / GPU bubble ratio: 4.39%
[rank2]:2026-01-02 21:02:44,847 - Avg. fwd time: 14.2813 / Avg. bwd time: 27.3288 / Avg. batch time: 436.9987 (ms) / GPU bubble ratio: 23.83%
[rank0]:2026-01-02 21:02:44,916 - Avg. fwd time: 14.7243 / Avg. bwd time: 26.5004 / Avg. batch time: 543.6276 (ms) / GPU bubble ratio: 39.33%
[rank0]:2026-01-02 21:02:44,951 -  step: 800  loss: -4.0000  grad_norm:  0.2531  memory: 72.15GiB(51.60%)  tps: 7,982  tflops: 372.27  mfu: 37.64%
[rank3]:2026-01-02 21:02:44,949 -  step: 800  loss:  0.2720  grad_norm:  0.2531  memory: 76.42GiB(54.66%)  tps: 7,982  tflops: 372.27  mfu: 37.64%
[rank2]:2026-01-02 21:02:44,945 -  step: 800  loss: -4.0000  grad_norm:  0.2531  memory: 62.32GiB(44.58%)  tps: 7,982  tflops: 372.27  mfu: 37.64%
[rank1]:2026-01-02 21:02:44,909 - Avg. fwd time: 16.1871 / Avg. bwd time: 30.6526 / Avg. batch time: 511.2504 (ms) / GPU bubble ratio: 26.71%
[rank1]:2026-01-02 21:02:44,947 -  step: 800  loss: -4.0000  grad_norm:  0.2531  memory: 70.00GiB(50.07%)  tps: 7,982  tflops: 372.27  mfu: 37.64%
[rank0]:2026-01-02 21:02:44,998 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2102_stage0_step800.svg
[rank2]:2026-01-02 21:02:44,998 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2102_stage2_step800.svg
[rank1]:2026-01-02 21:02:44,998 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2102_stage1_step800.svg
[rank3]:2026-01-02 21:02:45,075 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2102_step800_rank3.svg
[rank3]:			> Batch Time: 492.25 ms, GPU Bubble Ratio: 41.91%, 31.78%, 39.23%, 31.88%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  281-42-324ms   | [S0,MB1,B]  324-43-367ms   | [S0,MB2,B]  368-43-411ms   | [S0,MB3,B]  411-38-450ms   | [S0,MB4,B]  450-0-450ms    | [S0,MB5,B]  450-0-450ms    | [S0,MB6,B]  471-0-471ms    | [S0,MB7,B]  492-0-492ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  133-16-149ms   | [S1,MB0,B]  237-45-282ms   | [S1,MB1,B]  282-35-317ms   | [S1,MB2,B]  318-20-339ms   | [S1,MB3,B]  339-20-360ms   | [S1,MB4,B]  368-20-388ms   | [S1,MB5,B]  411-20-432ms   | [S1,MB6,B]  450-20-470ms   | [S1,MB7,B]  471-20-491ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  101-13-114ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-14-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  218-18-236ms   | [S2,MB1,B]  241-40-281ms   | [S2,MB2,B]  287-30-317ms   | [S2,MB3,B]  317-20-338ms   | [S2,MB4,B]  344-18-362ms   | [S2,MB5,B]  365-18-384ms   | [S2,MB6,B]  386-18-405ms   | [S2,MB7,B]  411-18-430ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-22-217ms   | [S3,MB1,B]  217-23-240ms   | [S3,MB2,B]  240-46-287ms   | [S3,MB3,B]  286-21-307ms   | [S3,MB4,B]  307-36-343ms   | [S3,MB5,B]  343-21-364ms   | [S3,MB6,B]  364-20-385ms   | [S3,MB7,B]  385-20-406ms  
[rank3]:2026-01-02 21:02:45,118 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2102_stage3_step800.svg
[rank1]:2026-01-02 21:02:45,180 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2102_rank1_stage1.svg
[rank1]:	> Counts Sum: 1232960, Total Sum: 1607040 (76.72%), Ratio(%) per element: [82.25, 83.87, 82.05, 80.04, 82.45, 83.06, 81.85, 82.05, 83.26, 80.04, 79.23, 81.04, 79.43, 80.44, 79.03, 80.64, 79.03, 80.04, 78.22, 79.23, 80.24, 78.62, 79.03, 77.82, 78.42, 81.04, 78.83, 78.02, 77.41, 78.22, 78.22, 79.83, 77.62, 76.61, 77.21, 77.21, 78.22, 77.82, 76.61, 78.02, 77.62, 75.8, 77.41, 76.41, 77.21, 74.59, 74.59, 72.78, 72.98, 75.2, 72.98, 75.2, 74.39, 72.37, 73.99, 75.0, 73.38, 74.79, 73.18, 73.38, 73.18, 74.59, 73.99, 72.98, 75.0, 71.57, 73.58, 73.79, 72.17, 72.17, 72.37, 74.39, 71.97, 73.79, 72.17, 73.79, 73.79, 72.37, 72.58, 73.58, 74.79]
[rank0]:2026-01-02 21:02:45,171 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2102_rank0_stage0.svg
[rank0]:	> Counts Sum: 755680, Total Sum: 1448320 (52.18%), Ratio(%) per element: [50.4, 55.44, 56.25, 55.64, 56.45, 56.65, 55.64, 55.24, 56.45, 56.04, 55.64, 55.44, 55.24, 55.44, 54.83, 54.23, 54.23, 54.43, 54.43, 50.8, 52.82, 52.62, 52.62, 53.02, 53.83, 51.61, 54.03, 52.21, 50.0, 50.8, 52.21, 51.41, 50.8, 50.8, 51.81, 50.2, 51.0, 50.6, 51.0, 51.2, 52.01, 51.81, 52.62, 49.59, 50.8, 50.8, 50.8, 50.8, 50.0, 50.4, 50.4, 49.79, 50.4, 50.6, 51.2, 51.2, 52.62, 50.0, 51.2, 51.41, 49.79, 50.8, 50.4, 51.41, 50.4, 50.6, 50.8, 50.0, 49.59, 50.6, 50.4, 50.4, 51.41]
[rank2]:2026-01-02 21:02:45,170 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2102_rank2_stage2.svg
[rank2]:	> Counts Sum: 1097160, Total Sum: 1428480 (76.81%), Ratio(%) per element: [82.25, 81.65, 82.05, 80.84, 83.26, 81.65, 82.66, 81.45, 82.05, 79.63, 79.43, 79.23, 79.63, 80.24, 80.24, 81.65, 79.83, 80.44, 77.62, 77.41, 78.22, 79.23, 77.21, 76.41, 78.02, 77.41, 77.62, 79.63, 76.2, 79.03, 76.81, 76.61, 75.2, 77.21, 77.62, 74.79, 76.2, 74.79, 77.21, 74.19, 77.82, 77.82, 77.01, 78.02, 76.0, 74.39, 73.99, 74.79, 72.98, 76.41, 73.99, 73.79, 74.79, 74.39, 74.19, 75.8, 77.01, 71.77, 76.0, 74.39, 73.18, 73.18, 74.19, 71.77, 70.96, 72.58, 72.78, 71.97, 73.18, 72.37, 73.18, 72.17]
[rank3]:2026-01-02 21:02:45,277 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2102_rank3_stage3.svg
[rank3]:	> Counts Sum: 989440, Total Sum: 1289600 (76.72%), Ratio(%) per element: [82.86, 82.66, 81.45, 82.05, 82.25, 82.25, 81.45, 81.04, 81.65, 81.85, 80.64, 81.45, 80.24, 81.45, 82.45, 82.25, 78.83, 81.25, 79.03, 79.83, 78.02, 79.23, 80.64, 79.83, 79.43, 80.64, 79.43, 78.83, 78.62, 77.82, 79.03, 76.81, 78.42, 77.21, 79.23, 79.03, 75.8, 77.01, 73.99, 74.79, 73.18, 74.79, 75.4, 74.19, 73.38, 73.58, 72.98, 71.57, 73.18, 71.77, 72.58, 71.16, 73.99, 71.77, 70.16, 68.95, 69.75, 72.17, 69.75, 70.76, 72.37, 70.76, 70.56, 68.75, 68.54]
[rank0]:2026-01-02 21:02:45,879 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2102_stage0.svg
[rank2]:2026-01-02 21:02:45,902 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2102_stage2.svg
[rank1]:2026-01-02 21:02:45,944 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2102_stage1.svg
[rank3]:2026-01-02 21:02:45,996 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2102_stage3.svg
[rank0]:2026-01-02 21:04:26,671 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:04:28,617 - Avg. fwd time: 15.2788 / Avg. bwd time: 31.0761 / Avg. batch time: 387.9561 (ms) / GPU bubble ratio: 4.41%
[rank2]:2026-01-02 21:04:28,647 - Avg. fwd time: 14.2857 / Avg. bwd time: 27.0633 / Avg. batch time: 434.3150 (ms) / GPU bubble ratio: 23.84%
[rank0]:2026-01-02 21:04:28,715 - Avg. fwd time: 14.7272 / Avg. bwd time: 26.1586 / Avg. batch time: 540.5200 (ms) / GPU bubble ratio: 39.49%
[rank0]:2026-01-02 21:04:28,750 -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory: 72.15GiB(51.60%)  tps: 7,892  tflops: 368.09  mfu: 37.22%
[rank3]:2026-01-02 21:04:28,748 -  step: 850  loss:  0.1218  grad_norm:  0.2550  memory: 76.42GiB(54.66%)  tps: 7,892  tflops: 368.10  mfu: 37.22%
[rank2]:2026-01-02 21:04:28,744 -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory: 62.32GiB(44.58%)  tps: 7,892  tflops: 368.09  mfu: 37.22%
[rank1]:2026-01-02 21:04:28,708 - Avg. fwd time: 16.1928 / Avg. bwd time: 30.3497 / Avg. batch time: 508.9231 (ms) / GPU bubble ratio: 26.84%
[rank1]:2026-01-02 21:04:28,746 -  step: 850  loss: -4.0000  grad_norm:  0.2550  memory: 70.00GiB(50.07%)  tps: 7,892  tflops: 368.09  mfu: 37.22%
[rank0]:2026-01-02 21:06:08,398 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:06:10,354 - Avg. fwd time: 15.2690 / Avg. bwd time: 30.7786 / Avg. batch time: 385.4901 (ms) / GPU bubble ratio: 4.44%
[rank2]:2026-01-02 21:06:10,381 - Avg. fwd time: 14.2792 / Avg. bwd time: 26.8209 / Avg. batch time: 431.8188 (ms) / GPU bubble ratio: 23.86%
[rank1]:2026-01-02 21:06:10,437 - Avg. fwd time: 16.1860 / Avg. bwd time: 30.0775 / Avg. batch time: 506.7354 (ms) / GPU bubble ratio: 26.96%
[rank3]:2026-01-02 21:06:10,477 -  step: 900  loss:  0.1874  grad_norm:  0.2325  memory: 76.42GiB(54.66%)  tps: 8,053  tflops: 375.59  mfu: 37.98%
[rank0]:2026-01-02 21:06:10,444 - Avg. fwd time: 14.7177 / Avg. bwd time: 25.8518 / Avg. batch time: 537.6173 (ms) / GPU bubble ratio: 39.63%
[rank0]:2026-01-02 21:06:10,479 -  step: 900  loss: -4.0000  grad_norm:  0.2325  memory: 72.15GiB(51.60%)  tps: 8,053  tflops: 375.58  mfu: 37.98%
[rank0]:2026-01-02 21:06:10,521 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2106_stage0_step900.svg
[rank2]:2026-01-02 21:06:10,472 -  step: 900  loss: -4.0000  grad_norm:  0.2325  memory: 62.32GiB(44.58%)  tps: 8,053  tflops: 375.58  mfu: 37.98%
[rank2]:2026-01-02 21:06:10,521 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2106_stage2_step900.svg
[rank1]:2026-01-02 21:06:10,475 -  step: 900  loss: -4.0000  grad_norm:  0.2325  memory: 70.00GiB(50.07%)  tps: 8,053  tflops: 375.58  mfu: 37.98%
[rank1]:2026-01-02 21:06:10,523 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2106_stage1_step900.svg
[rank3]:2026-01-02 21:06:10,602 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2106_step900_rank3.svg
[rank3]:			> Batch Time: 491.50 ms, GPU Bubble Ratio: 42.03%, 31.91%, 39.26%, 32.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  73-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  281-42-324ms   | [S0,MB1,B]  324-42-367ms   | [S0,MB2,B]  367-43-410ms   | [S0,MB3,B]  410-38-449ms   | [S0,MB4,B]  449-0-449ms    | [S0,MB5,B]  449-0-449ms    | [S0,MB6,B]  469-0-469ms    | [S0,MB7,B]  491-0-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  133-16-149ms   | [S1,MB0,B]  237-45-282ms   | [S1,MB1,B]  281-35-316ms   | [S1,MB2,B]  316-20-337ms   | [S1,MB3,B]  337-20-358ms   | [S1,MB4,B]  366-20-387ms   | [S1,MB5,B]  410-20-431ms   | [S1,MB6,B]  448-20-469ms   | [S1,MB7,B]  469-20-490ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  218-18-236ms   | [S2,MB1,B]  240-40-280ms   | [S2,MB2,B]  285-29-315ms   | [S2,MB3,B]  315-21-337ms   | [S2,MB4,B]  340-18-359ms   | [S2,MB5,B]  361-18-380ms   | [S2,MB6,B]  382-18-401ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-22-216ms   | [S3,MB1,B]  217-22-239ms   | [S3,MB2,B]  239-46-286ms   | [S3,MB3,B]  285-21-306ms   | [S3,MB4,B]  306-35-341ms   | [S3,MB5,B]  340-20-361ms   | [S3,MB6,B]  361-20-382ms   | [S3,MB7,B]  382-20-402ms  
[rank3]:2026-01-02 21:06:10,640 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2106_stage3_step900.svg
[rank0]:2026-01-02 21:06:10,697 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2106_rank0_stage0.svg
[rank0]:	> Counts Sum: 880080, Total Sum: 1681920 (52.33%), Ratio(%) per element: [50.69, 55.55, 56.94, 55.72, 56.42, 56.42, 55.72, 55.55, 56.59, 56.07, 55.72, 55.38, 55.03, 55.55, 54.68, 53.99, 54.16, 54.51, 54.34, 51.04, 52.6, 52.6, 52.77, 52.95, 53.64, 51.56, 53.64, 52.43, 50.17, 51.56, 52.08, 51.38, 50.86, 51.21, 52.6, 50.69, 51.56, 51.04, 51.38, 51.56, 52.25, 52.08, 52.43, 49.65, 51.21, 50.69, 51.21, 50.86, 50.17, 50.52, 50.34, 50.34, 51.04, 51.04, 51.56, 51.04, 52.6, 50.34, 51.38, 51.56, 49.82, 50.86, 50.86, 51.73, 50.52, 50.69, 50.86, 50.0, 50.0, 50.52, 51.04, 50.52, 51.38]
[rank2]:2026-01-02 21:06:10,694 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2106_rank2_stage2.svg
[rank2]:	> Counts Sum: 1281560, Total Sum: 1658880 (77.25%), Ratio(%) per element: [82.63, 82.11, 82.11, 81.42, 83.68, 82.11, 82.63, 81.77, 82.63, 79.68, 79.86, 79.34, 80.2, 80.9, 80.72, 81.94, 80.2, 80.55, 78.12, 78.12, 78.81, 79.86, 77.77, 77.25, 78.47, 77.77, 77.95, 79.86, 76.73, 79.34, 77.25, 77.43, 75.86, 77.77, 77.95, 75.34, 76.04, 75.34, 77.6, 74.47, 77.77, 78.29, 77.25, 78.12, 76.56, 74.82, 74.3, 75.0, 73.78, 77.08, 74.65, 74.82, 75.34, 75.17, 74.65, 75.69, 77.08, 72.22, 75.86, 75.0, 73.26, 73.61, 74.82, 72.74, 72.22, 73.43, 73.61, 72.91, 73.61, 73.09, 73.43, 72.22]
[rank1]:2026-01-02 21:06:10,704 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2106_rank1_stage1.svg
[rank1]:	> Counts Sum: 1440160, Total Sum: 1866240 (77.17%), Ratio(%) per element: [82.29, 84.02, 82.29, 80.55, 82.98, 82.98, 82.11, 82.29, 83.33, 80.38, 79.51, 81.07, 79.51, 80.55, 79.34, 80.55, 79.51, 80.38, 78.47, 78.99, 80.03, 78.81, 79.16, 78.12, 78.47, 81.25, 78.81, 77.77, 77.6, 78.47, 78.12, 79.68, 77.95, 77.25, 77.43, 77.43, 78.47, 77.43, 77.25, 78.12, 77.6, 76.56, 77.6, 76.56, 77.77, 75.34, 75.34, 74.13, 73.95, 75.34, 73.95, 75.86, 75.0, 73.43, 74.47, 75.69, 73.78, 75.34, 73.95, 73.95, 74.13, 75.0, 74.82, 73.95, 75.69, 72.22, 74.3, 74.47, 73.26, 73.61, 72.91, 75.34, 72.74, 74.47, 73.09, 74.82, 74.65, 73.26, 73.61, 73.95, 75.69]
[rank3]:2026-01-02 21:06:10,800 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2106_rank3_stage3.svg
[rank3]:	> Counts Sum: 1155840, Total Sum: 1497600 (77.18%), Ratio(%) per element: [82.81, 83.15, 81.94, 82.11, 82.29, 82.81, 81.42, 81.25, 81.25, 81.94, 81.25, 81.77, 80.9, 81.94, 82.29, 82.29, 79.34, 81.25, 79.16, 80.2, 78.81, 79.68, 80.9, 80.2, 79.86, 80.72, 79.86, 79.34, 78.99, 78.29, 78.99, 77.25, 78.29, 77.6, 79.51, 79.16, 76.56, 77.25, 75.0, 75.0, 74.13, 75.52, 75.34, 74.65, 74.13, 74.3, 73.09, 72.39, 74.13, 73.26, 73.26, 72.22, 74.3, 72.91, 71.18, 69.44, 71.18, 72.04, 70.48, 71.0, 72.74, 71.52, 71.18, 69.44, 69.96]
[rank3]:2026-01-02 21:06:11,616 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2106_stage3.svg
[rank0]:2026-01-02 21:06:11,568 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2106_stage0.svg
[rank2]:2026-01-02 21:06:11,545 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2106_stage2.svg
[rank1]:2026-01-02 21:06:11,564 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2106_stage1.svg
[rank0]:2026-01-02 21:07:52,114 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:07:54,085 - Avg. fwd time: 15.2686 / Avg. bwd time: 30.5507 / Avg. batch time: 383.6592 (ms) / GPU bubble ratio: 4.46%
[rank2]:2026-01-02 21:07:54,112 - Avg. fwd time: 14.2805 / Avg. bwd time: 26.6099 / Avg. batch time: 429.7718 (ms) / GPU bubble ratio: 23.88%
[rank3]:2026-01-02 21:07:54,212 -  step: 950  loss:  0.2453  grad_norm:  0.3497  memory: 76.42GiB(54.66%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank0]:2026-01-02 21:07:54,179 - Avg. fwd time: 14.7167 / Avg. bwd time: 25.5718 / Avg. batch time: 535.1540 (ms) / GPU bubble ratio: 39.77%
[rank0]:2026-01-02 21:07:54,214 -  step: 950  loss: -4.0000  grad_norm:  0.3497  memory: 72.15GiB(51.60%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank2]:2026-01-02 21:07:54,208 -  step: 950  loss: -4.0000  grad_norm:  0.3497  memory: 62.32GiB(44.58%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank1]:2026-01-02 21:07:54,172 - Avg. fwd time: 16.1878 / Avg. bwd time: 29.8367 / Avg. batch time: 504.9062 (ms) / GPU bubble ratio: 27.08%
[rank1]:2026-01-02 21:07:54,210 -  step: 950  loss: -4.0000  grad_norm:  0.3497  memory: 70.00GiB(50.07%)  tps: 7,897  tflops: 368.32  mfu: 37.24%
[rank0]:2026-01-02 21:09:34,956 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:09:36,953 - Avg. fwd time: 15.2717 / Avg. bwd time: 30.3313 / Avg. batch time: 381.9246 (ms) / GPU bubble ratio: 4.48%
[rank2]:2026-01-02 21:09:36,981 - Avg. fwd time: 14.2841 / Avg. bwd time: 26.4261 / Avg. batch time: 427.8785 (ms) / GPU bubble ratio: 23.88%
[rank0]:2026-01-02 21:09:37,051 - Avg. fwd time: 14.7185 / Avg. bwd time: 25.3251 / Avg. batch time: 532.9336 (ms) / GPU bubble ratio: 39.89%
[rank0]:2026-01-02 21:09:37,086 -  step: 1000  loss: -4.0000  grad_norm:  0.1624  memory: 72.15GiB(51.60%)  tps: 7,963  tflops: 371.41  mfu: 37.55%
[rank0]:2026-01-02 21:09:37,086 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 21:09:37,086 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2026-01-02 21:09:37,084 -  step: 1000  loss:  0.1581  grad_norm:  0.1624  memory: 76.42GiB(54.66%)  tps: 7,963  tflops: 371.42  mfu: 37.55%
[rank3]:2026-01-02 21:09:37,084 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 21:09:37,079 -  step: 1000  loss: -4.0000  grad_norm:  0.1624  memory: 62.32GiB(44.58%)  tps: 7,963  tflops: 371.41  mfu: 37.55%
[rank2]:2026-01-02 21:09:37,079 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 21:09:37,043 - Avg. fwd time: 16.1920 / Avg. bwd time: 29.6226 / Avg. batch time: 503.2541 (ms) / GPU bubble ratio: 27.17%
[rank1]:2026-01-02 21:09:37,082 -  step: 1000  loss: -4.0000  grad_norm:  0.1624  memory: 70.00GiB(50.07%)  tps: 7,963  tflops: 371.41  mfu: 37.55%
[rank1]:2026-01-02 21:09:37,082 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 21:09:48,479 - Finished saving the checkpoint (or staging if async is enabled)in 11.40 seconds.
[rank1]:2026-01-02 21:09:49,462 - Finished saving the checkpoint (or staging if async is enabled)in 12.38 seconds.
[rank3]:2026-01-02 21:09:50,451 - Finished saving the checkpoint (or staging if async is enabled)in 13.37 seconds.
[rank0]:2026-01-02 21:09:52,330 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 21:09:52,331 - Finished saving the checkpoint (or staging if async is enabled)in 15.25 seconds.
[rank0]:2026-01-02 21:09:52,383 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2109_stage0_step1000.svg
[rank2]:2026-01-02 21:09:52,386 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2109_stage2_step1000.svg
[rank1]:2026-01-02 21:09:52,385 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2109_stage1_step1000.svg
[rank3]:2026-01-02 21:09:52,465 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2109_step1000_rank3.svg
[rank3]:			> Batch Time: 493.75 ms, GPU Bubble Ratio: 42.48%, 32.07%, 39.55%, 31.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  284-42-327ms   | [S0,MB1,B]  327-43-370ms   | [S0,MB2,B]  370-43-413ms   | [S0,MB3,B]  414-36-450ms   | [S0,MB4,B]  451-0-451ms    | [S0,MB5,B]  451-0-451ms    | [S0,MB6,B]  472-0-472ms    | [S0,MB7,B]  493-0-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-16-117ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  239-45-284ms   | [S1,MB1,B]  285-34-319ms   | [S1,MB2,B]  321-20-341ms   | [S1,MB3,B]  342-20-363ms   | [S1,MB4,B]  370-20-391ms   | [S1,MB5,B]  414-20-435ms   | [S1,MB6,B]  451-20-471ms   | [S1,MB7,B]  472-20-492ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  134-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  220-18-239ms   | [S2,MB1,B]  243-40-283ms   | [S2,MB2,B]  290-30-320ms   | [S2,MB3,B]  320-19-340ms   | [S2,MB4,B]  347-18-365ms   | [S2,MB5,B]  368-18-386ms   | [S2,MB6,B]  389-18-407ms   | [S2,MB7,B]  414-18-432ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-24-219ms   | [S3,MB1,B]  219-22-242ms   | [S3,MB2,B]  243-46-289ms   | [S3,MB3,B]  289-21-310ms   | [S3,MB4,B]  310-36-347ms   | [S3,MB5,B]  346-21-367ms   | [S3,MB6,B]  367-20-388ms   | [S3,MB7,B]  388-20-409ms  
[rank3]:2026-01-02 21:09:52,505 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2109_stage3_step1000.svg
[rank0]:2026-01-02 21:09:52,597 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2109_rank0_stage0.svg
[rank0]:	> Counts Sum: 1004480, Total Sum: 1915520 (52.44%), Ratio(%) per element: [50.76, 55.48, 56.7, 55.48, 56.09, 56.25, 55.33, 55.33, 56.4, 56.25, 55.48, 55.03, 55.03, 55.33, 55.03, 54.26, 54.72, 54.26, 54.42, 51.06, 52.74, 52.59, 52.59, 53.5, 53.5, 52.13, 53.65, 52.59, 50.45, 51.98, 52.28, 51.52, 50.91, 51.67, 52.59, 50.6, 52.13, 51.21, 51.52, 51.82, 52.28, 52.28, 52.59, 49.69, 51.21, 51.06, 51.52, 50.76, 50.45, 50.6, 50.91, 50.3, 51.67, 51.06, 51.67, 51.21, 52.59, 50.3, 51.52, 51.82, 50.45, 51.06, 51.21, 51.67, 50.91, 50.91, 51.06, 50.45, 50.3, 50.6, 51.06, 50.6, 51.21]
[rank2]:2026-01-02 21:09:52,559 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2109_rank2_stage2.svg
[rank2]:	> Counts Sum: 1465960, Total Sum: 1889280 (77.59%), Ratio(%) per element: [82.77, 82.46, 82.01, 81.55, 83.38, 82.01, 82.77, 82.01, 82.77, 79.87, 80.03, 79.72, 80.64, 80.94, 81.25, 81.85, 79.87, 80.48, 78.35, 78.5, 79.26, 79.87, 78.5, 76.98, 78.81, 78.5, 77.74, 79.42, 77.59, 79.11, 77.59, 77.59, 76.82, 78.35, 78.5, 76.21, 76.52, 76.06, 78.5, 75.3, 78.04, 78.65, 77.74, 78.2, 76.98, 75.45, 74.69, 75.15, 74.69, 77.13, 75.15, 75.45, 75.6, 75.45, 75.3, 76.21, 76.52, 72.86, 76.21, 75.45, 73.78, 74.08, 75.3, 73.47, 73.17, 73.78, 73.47, 73.17, 74.23, 73.47, 74.08, 73.01]
[rank1]:2026-01-02 21:09:52,565 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2109_rank1_stage1.svg
[rank1]:	> Counts Sum: 1647360, Total Sum: 2125440 (77.51%), Ratio(%) per element: [82.16, 83.68, 82.01, 80.94, 82.77, 82.62, 82.31, 82.16, 83.23, 80.79, 79.87, 81.09, 79.57, 80.79, 79.72, 80.79, 79.72, 80.64, 78.96, 79.26, 80.18, 78.96, 78.96, 78.81, 78.65, 81.4, 78.81, 78.2, 77.89, 78.2, 78.35, 80.18, 77.89, 77.13, 77.43, 77.43, 78.35, 78.04, 77.13, 78.5, 78.04, 76.82, 78.04, 77.13, 77.74, 75.6, 75.91, 74.69, 74.54, 75.76, 74.69, 76.06, 75.45, 74.08, 74.69, 76.21, 74.39, 76.21, 74.39, 74.69, 74.54, 75.6, 75.15, 75.15, 76.06, 72.71, 75.15, 75.3, 74.08, 74.39, 73.78, 75.76, 73.78, 75.0, 73.78, 75.15, 75.0, 73.78, 74.23, 74.54, 76.06]
[rank3]:2026-01-02 21:09:52,763 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2109_rank3_stage3.svg
[rank3]:	> Counts Sum: 1322240, Total Sum: 1705600 (77.52%), Ratio(%) per element: [82.92, 82.92, 82.31, 82.31, 82.31, 82.62, 81.85, 81.25, 81.85, 82.46, 81.7, 82.16, 81.09, 82.31, 82.77, 82.16, 79.72, 81.7, 78.96, 80.48, 79.57, 79.57, 81.09, 80.18, 80.18, 80.79, 80.18, 79.57, 79.11, 78.81, 78.65, 77.59, 78.65, 77.74, 79.42, 79.57, 77.43, 77.43, 75.91, 75.76, 75.15, 76.21, 76.06, 75.76, 75.15, 74.84, 73.47, 73.62, 73.93, 73.47, 74.08, 73.01, 74.54, 73.17, 71.95, 69.96, 71.64, 72.1, 71.18, 70.88, 72.56, 71.79, 71.34, 69.51, 70.27]
[rank0]:2026-01-02 21:09:53,641 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2109_stage0.svg
[rank2]:2026-01-02 21:09:53,643 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2109_stage2.svg
[rank3]:2026-01-02 21:09:53,723 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2109_stage3.svg
[rank1]:2026-01-02 21:09:53,654 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2109_stage1.svg
[rank0]:2026-01-02 21:11:36,297 - [GC] Peforming periodical GC collection 1.73 seconds
[rank3]:2026-01-02 21:11:38,372 - Avg. fwd time: 15.2701 / Avg. bwd time: 30.1491 / Avg. batch time: 380.5536 (ms) / GPU bubble ratio: 4.52%
[rank2]:2026-01-02 21:11:38,400 - Avg. fwd time: 14.2823 / Avg. bwd time: 26.2579 / Avg. batch time: 426.2946 (ms) / GPU bubble ratio: 23.92%
[rank0]:2026-01-02 21:11:38,462 - Avg. fwd time: 14.7156 / Avg. bwd time: 25.0989 / Avg. batch time: 531.0449 (ms) / GPU bubble ratio: 40.02%
[rank0]:2026-01-02 21:11:38,497 -  step: 1050  loss: -4.0000  grad_norm:  0.4575  memory: 72.15GiB(51.60%)  tps: 6,747  tflops: 314.70  mfu: 31.82%
[rank2]:2026-01-02 21:11:38,491 -  step: 1050  loss: -4.0000  grad_norm:  0.4575  memory: 62.32GiB(44.58%)  tps: 6,747  tflops: 314.70  mfu: 31.82%
[rank3]:2026-01-02 21:11:38,495 -  step: 1050  loss:  0.2720  grad_norm:  0.4575  memory: 76.42GiB(54.66%)  tps: 6,747  tflops: 314.70  mfu: 31.82%
[rank1]:2026-01-02 21:11:38,453 - Avg. fwd time: 16.1913 / Avg. bwd time: 29.4322 / Avg. batch time: 501.8705 (ms) / GPU bubble ratio: 27.27%
[rank1]:2026-01-02 21:11:38,493 -  step: 1050  loss: -4.0000  grad_norm:  0.4575  memory: 70.00GiB(50.07%)  tps: 6,747  tflops: 314.70  mfu: 31.82%
[rank0]:2026-01-02 21:13:21,383 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:13:23,367 - Avg. fwd time: 15.2862 / Avg. bwd time: 30.0004 / Avg. batch time: 379.4870 (ms) / GPU bubble ratio: 4.53%
[rank0]:2026-01-02 21:13:23,468 - Avg. fwd time: 14.7282 / Avg. bwd time: 24.9006 / Avg. batch time: 529.5390 (ms) / GPU bubble ratio: 40.13%
[rank2]:2026-01-02 21:13:23,399 - Avg. fwd time: 14.2960 / Avg. bwd time: 26.1068 / Avg. batch time: 425.0311 (ms) / GPU bubble ratio: 23.95%
[rank2]:2026-01-02 21:13:23,497 -  step: 1100  loss: -4.0000  grad_norm:  0.1966  memory: 62.32GiB(44.58%)  tps: 7,801  tflops: 363.86  mfu: 36.79%
[rank1]:2026-01-02 21:13:23,459 - Avg. fwd time: 16.2061 / Avg. bwd time: 29.2617 / Avg. batch time: 500.8246 (ms) / GPU bubble ratio: 27.37%
[rank1]:2026-01-02 21:13:23,499 -  step: 1100  loss: -4.0000  grad_norm:  0.1966  memory: 70.00GiB(50.07%)  tps: 7,801  tflops: 363.86  mfu: 36.79%
[rank0]:2026-01-02 21:13:23,503 -  step: 1100  loss: -4.0000  grad_norm:  0.1966  memory: 72.15GiB(51.60%)  tps: 7,801  tflops: 363.86  mfu: 36.79%
[rank0]:2026-01-02 21:13:23,551 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2113_stage0_step1100.svg
[rank3]:2026-01-02 21:13:23,502 -  step: 1100  loss:  0.2245  grad_norm:  0.1966  memory: 76.42GiB(54.66%)  tps: 7,802  tflops: 363.86  mfu: 36.79%
[rank2]:2026-01-02 21:13:23,549 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2113_stage2_step1100.svg
[rank1]:2026-01-02 21:13:23,548 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2113_stage1_step1100.svg
[rank3]:2026-01-02 21:13:23,628 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2113_step1100_rank3.svg
[rank3]:			> Batch Time: 500.50 ms, GPU Bubble Ratio: 42.65%, 31.99%, 39.77%, 31.20%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  291-42-333ms   | [S0,MB1,B]  333-43-376ms   | [S0,MB2,B]  376-43-419ms   | [S0,MB3,B]  420-36-456ms   | [S0,MB4,B]  458-0-458ms    | [S0,MB5,B]  458-0-458ms    | [S0,MB6,B]  479-0-479ms    | [S0,MB7,B]  500-0-500ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  136-16-153ms   | [S1,MB0,B]  246-45-292ms   | [S1,MB1,B]  291-36-327ms   | [S1,MB2,B]  328-21-349ms   | [S1,MB3,B]  349-21-370ms   | [S1,MB4,B]  376-21-397ms   | [S1,MB5,B]  420-20-441ms   | [S1,MB6,B]  458-20-478ms   | [S1,MB7,B]  479-20-499ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  153-14-167ms   | [S2,MB0,B]  227-18-246ms   | [S2,MB1,B]  251-40-291ms   | [S2,MB2,B]  297-29-327ms   | [S2,MB3,B]  327-20-347ms   | [S2,MB4,B]  353-18-371ms   | [S2,MB5,B]  374-18-393ms   | [S2,MB6,B]  395-18-414ms   | [S2,MB7,B]  421-18-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-144ms   | [S3,MB5,F]  146-15-161ms   | [S3,MB6,F]  163-15-179ms   | [S3,MB7,F]  181-15-196ms   | [S3,MB0,B]  199-29-228ms   | [S3,MB1,B]  227-23-250ms   | [S3,MB2,B]  250-46-297ms   | [S3,MB3,B]  296-21-318ms   | [S3,MB4,B]  317-34-352ms   | [S3,MB5,B]  352-21-373ms   | [S3,MB6,B]  373-21-394ms   | [S3,MB7,B]  395-21-416ms  
[rank3]:2026-01-02 21:13:23,668 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2113_stage3_step1100.svg
[rank0]:2026-01-02 21:13:23,727 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2113_rank0_stage0.svg
[rank0]:	> Counts Sum: 1128880, Total Sum: 2149120 (52.53%), Ratio(%) per element: [50.81, 55.57, 56.52, 55.84, 56.11, 56.38, 55.7, 55.57, 56.52, 56.25, 55.16, 54.89, 54.89, 55.16, 54.89, 54.34, 55.02, 54.48, 54.21, 51.63, 52.71, 52.98, 52.98, 53.12, 53.53, 52.03, 53.39, 52.58, 50.54, 52.17, 52.71, 51.76, 51.08, 51.9, 52.71, 50.95, 52.03, 51.22, 51.49, 52.03, 52.3, 52.3, 52.71, 50.13, 51.63, 51.35, 51.76, 51.08, 50.67, 50.81, 51.08, 50.27, 51.9, 51.22, 51.49, 51.22, 52.58, 50.27, 51.49, 51.9, 50.54, 51.22, 51.22, 51.49, 51.08, 50.81, 51.08, 50.54, 50.4, 50.54, 51.22, 50.67, 51.35]
[rank2]:2026-01-02 21:13:23,725 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2113_rank2_stage2.svg
[rank2]:	> Counts Sum: 1650360, Total Sum: 2119680 (77.86%), Ratio(%) per element: [83.01, 82.88, 82.47, 81.92, 83.69, 82.33, 83.15, 82.2, 83.01, 80.43, 80.43, 80.16, 81.11, 81.25, 81.52, 82.06, 80.57, 81.11, 78.8, 78.66, 79.34, 79.61, 78.8, 77.3, 78.66, 79.07, 77.85, 79.75, 77.85, 78.8, 77.98, 77.85, 77.44, 78.39, 78.53, 76.49, 76.63, 76.9, 78.8, 75.4, 78.26, 78.53, 77.85, 78.26, 77.17, 75.81, 74.86, 75.13, 75.13, 77.17, 75.4, 75.27, 76.08, 75.4, 75.27, 75.95, 76.63, 73.23, 75.81, 76.08, 73.91, 74.45, 75.81, 73.91, 73.64, 74.18, 73.77, 73.91, 74.59, 73.91, 74.59, 73.36]
[rank1]:2026-01-02 21:13:23,728 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2113_rank1_stage1.svg
[rank1]:	> Counts Sum: 1854560, Total Sum: 2384640 (77.77%), Ratio(%) per element: [82.06, 83.69, 82.2, 81.38, 83.15, 82.88, 82.6, 82.47, 83.42, 80.97, 80.43, 81.38, 80.29, 81.11, 80.02, 81.11, 80.29, 81.38, 79.21, 79.75, 80.16, 79.21, 79.07, 79.21, 78.8, 81.38, 79.07, 78.53, 77.85, 77.98, 78.53, 79.75, 77.98, 77.3, 77.98, 77.71, 78.39, 77.71, 77.17, 78.8, 77.98, 77.17, 78.39, 77.03, 77.71, 75.81, 75.81, 75.13, 75.0, 75.81, 75.0, 76.49, 75.81, 74.32, 75.13, 76.35, 74.86, 76.49, 75.0, 74.86, 75.13, 75.67, 75.54, 75.27, 76.49, 73.23, 75.81, 75.27, 74.45, 74.72, 74.04, 76.08, 74.32, 75.13, 74.32, 75.67, 75.0, 73.91, 74.59, 75.4, 76.49]
[rank3]:2026-01-02 21:13:23,829 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2113_rank3_stage3.svg
[rank3]:	> Counts Sum: 1488640, Total Sum: 1913600 (77.79%), Ratio(%) per element: [83.01, 83.01, 82.88, 82.47, 82.47, 82.74, 81.92, 81.79, 82.06, 82.33, 81.79, 82.06, 81.38, 82.2, 82.6, 82.33, 80.02, 81.65, 79.34, 80.7, 80.02, 79.89, 81.25, 80.29, 80.57, 80.7, 80.57, 79.48, 79.21, 79.07, 78.94, 78.39, 78.8, 77.85, 79.75, 79.75, 77.98, 77.98, 76.22, 75.95, 75.67, 76.76, 76.22, 76.63, 75.81, 75.4, 74.72, 73.77, 74.18, 73.77, 74.45, 72.96, 75.13, 73.5, 72.28, 70.24, 72.14, 72.01, 71.19, 71.05, 72.82, 72.41, 71.73, 69.83, 70.1]
[rank0]:2026-01-02 21:13:24,786 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2113_stage0.svg
[rank2]:2026-01-02 21:13:24,788 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2113_stage2.svg
[rank1]:2026-01-02 21:13:24,776 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2113_stage1.svg
[rank3]:2026-01-02 21:13:24,867 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2113_stage3.svg
[rank0]:2026-01-02 21:15:05,555 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:15:07,534 - Avg. fwd time: 15.2889 / Avg. bwd time: 29.8303 / Avg. batch time: 378.1406 (ms) / GPU bubble ratio: 4.55%
[rank2]:2026-01-02 21:15:07,562 - Avg. fwd time: 14.2991 / Avg. bwd time: 25.9646 / Avg. batch time: 423.6213 (ms) / GPU bubble ratio: 23.96%
[rank1]:2026-01-02 21:15:07,615 - Avg. fwd time: 16.2099 / Avg. bwd time: 29.0980 / Avg. batch time: 499.5597 (ms) / GPU bubble ratio: 27.44%
[rank1]:2026-01-02 21:15:07,656 -  step: 1150  loss: -4.0000  grad_norm:  0.2407  memory: 70.00GiB(50.07%)  tps: 7,865  tflops: 366.83  mfu: 37.09%
[rank0]:2026-01-02 21:15:07,625 - Avg. fwd time: 14.7290 / Avg. bwd time: 24.7103 / Avg. batch time: 527.8458 (ms) / GPU bubble ratio: 40.23%
[rank0]:2026-01-02 21:15:07,660 -  step: 1150  loss: -4.0000  grad_norm:  0.2407  memory: 72.15GiB(51.60%)  tps: 7,865  tflops: 366.83  mfu: 37.09%
[rank3]:2026-01-02 21:15:07,658 -  step: 1150  loss:  0.2128  grad_norm:  0.2407  memory: 76.42GiB(54.66%)  tps: 7,865  tflops: 366.83  mfu: 37.09%
[rank2]:2026-01-02 21:15:07,654 -  step: 1150  loss: -4.0000  grad_norm:  0.2407  memory: 62.32GiB(44.58%)  tps: 7,865  tflops: 366.83  mfu: 37.09%
[rank0]:2026-01-02 21:16:48,276 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:16:50,263 - Avg. fwd time: 15.2907 / Avg. bwd time: 29.6858 / Avg. batch time: 376.9932 (ms) / GPU bubble ratio: 4.56%
[rank1]:2026-01-02 21:16:50,356 - Avg. fwd time: 16.2129 / Avg. bwd time: 28.9516 / Avg. batch time: 498.3823 (ms) / GPU bubble ratio: 27.50%
[rank0]:2026-01-02 21:16:50,365 - Avg. fwd time: 14.7297 / Avg. bwd time: 24.5400 / Avg. batch time: 526.2757 (ms) / GPU bubble ratio: 40.31%
[rank2]:2026-01-02 21:16:50,296 - Avg. fwd time: 14.3016 / Avg. bwd time: 25.8361 / Avg. batch time: 422.2811 (ms) / GPU bubble ratio: 23.96%
[rank1]:2026-01-02 21:16:50,396 -  step: 1200  loss: -4.0000  grad_norm:  0.2304  memory: 70.00GiB(50.07%)  tps: 7,974  tflops: 371.89  mfu: 37.60%
[rank1]:2026-01-02 21:16:50,445 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2116_stage1_step1200.svg
[rank0]:2026-01-02 21:16:50,400 -  step: 1200  loss: -4.0000  grad_norm:  0.2304  memory: 72.15GiB(51.60%)  tps: 7,974  tflops: 371.89  mfu: 37.60%
[rank0]:2026-01-02 21:16:50,448 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2116_stage0_step1200.svg
[rank2]:2026-01-02 21:16:50,394 -  step: 1200  loss: -4.0000  grad_norm:  0.2304  memory: 62.32GiB(44.58%)  tps: 7,974  tflops: 371.89  mfu: 37.60%
[rank2]:2026-01-02 21:16:50,447 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2116_stage2_step1200.svg
[rank3]:2026-01-02 21:16:50,398 -  step: 1200  loss:  0.2703  grad_norm:  0.2304  memory: 76.42GiB(54.66%)  tps: 7,974  tflops: 371.89  mfu: 37.60%
[rank3]:2026-01-02 21:16:50,523 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2116_step1200_rank3.svg
[rank3]:			> Batch Time: 492.75 ms, GPU Bubble Ratio: 42.24%, 31.90%, 39.46%, 31.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  283-42-326ms   | [S0,MB1,B]  326-43-369ms   | [S0,MB2,B]  369-43-412ms   | [S0,MB3,B]  412-37-450ms   | [S0,MB4,B]  450-0-450ms    | [S0,MB5,B]  450-0-450ms    | [S0,MB6,B]  471-0-471ms    | [S0,MB7,B]  492-0-492ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-16-117ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  238-45-283ms   | [S1,MB1,B]  286-34-320ms   | [S1,MB2,B]  321-20-341ms   | [S1,MB3,B]  342-20-363ms   | [S1,MB4,B]  369-20-390ms   | [S1,MB5,B]  412-20-433ms   | [S1,MB6,B]  450-20-470ms   | [S1,MB7,B]  471-20-491ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-14-115ms   | [S2,MB5,F]  117-14-131ms   | [S2,MB6,F]  134-14-148ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  219-18-237ms   | [S2,MB1,B]  246-40-286ms   | [S2,MB2,B]  291-28-320ms   | [S2,MB3,B]  320-20-341ms   | [S2,MB4,B]  346-18-365ms   | [S2,MB5,B]  367-18-386ms   | [S2,MB6,B]  388-18-407ms   | [S2,MB7,B]  412-18-431ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-15-158ms   | [S3,MB6,F]  161-15-176ms   | [S3,MB7,F]  178-15-193ms   | [S3,MB0,B]  195-23-218ms   | [S3,MB1,B]  218-28-246ms   | [S3,MB2,B]  245-46-292ms   | [S3,MB3,B]  291-21-312ms   | [S3,MB4,B]  312-34-346ms   | [S3,MB5,B]  346-21-367ms   | [S3,MB6,B]  367-20-388ms   | [S3,MB7,B]  388-20-409ms  
[rank3]:2026-01-02 21:16:50,564 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2116_stage3_step1200.svg
[rank1]:2026-01-02 21:16:50,624 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2116_rank1_stage1.svg
[rank1]:	> Counts Sum: 2061760, Total Sum: 2643840 (77.98%), Ratio(%) per element: [82.1, 83.82, 82.47, 81.49, 83.21, 82.84, 82.47, 82.47, 83.21, 81.12, 80.26, 81.37, 80.63, 81.0, 80.51, 81.0, 80.51, 81.74, 79.28, 79.9, 80.02, 79.04, 79.53, 79.77, 79.04, 81.37, 79.53, 78.55, 78.06, 78.3, 78.92, 79.77, 78.06, 77.45, 78.06, 77.94, 78.43, 77.94, 77.45, 78.67, 78.18, 77.45, 78.3, 77.2, 77.94, 75.73, 76.22, 75.61, 75.61, 76.1, 75.36, 76.96, 76.22, 74.87, 75.36, 76.83, 75.0, 77.08, 75.36, 75.24, 75.49, 75.85, 75.73, 75.85, 76.47, 73.65, 75.98, 75.73, 75.0, 75.0, 74.38, 76.34, 74.63, 75.36, 74.5, 75.98, 75.49, 74.14, 74.75, 75.61, 76.47]
[rank0]:2026-01-02 21:16:50,623 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2116_rank0_stage0.svg
[rank0]:	> Counts Sum: 1253280, Total Sum: 2382720 (52.60%), Ratio(%) per element: [50.98, 55.75, 56.49, 55.75, 55.88, 56.49, 55.75, 55.39, 56.49, 56.25, 55.02, 55.26, 54.9, 55.14, 55.02, 54.16, 55.39, 54.53, 54.41, 51.59, 53.18, 53.18, 53.06, 53.18, 53.55, 52.32, 53.43, 52.32, 50.73, 51.96, 52.69, 51.83, 51.34, 51.96, 52.69, 50.98, 52.08, 51.34, 51.59, 51.96, 52.45, 52.69, 52.69, 50.12, 51.71, 51.22, 51.71, 51.47, 50.61, 50.73, 51.34, 50.61, 52.08, 51.47, 51.71, 51.22, 52.69, 50.24, 51.83, 52.08, 50.98, 51.22, 51.22, 51.59, 51.1, 50.73, 51.1, 50.49, 50.49, 50.49, 51.22, 50.73, 51.34]
[rank2]:2026-01-02 21:16:50,619 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2116_rank2_stage2.svg
[rank2]:	> Counts Sum: 1834760, Total Sum: 2350080 (78.07%), Ratio(%) per element: [83.21, 83.33, 82.59, 82.23, 84.06, 82.59, 83.45, 82.59, 83.08, 80.51, 80.51, 80.51, 81.25, 81.37, 81.49, 81.86, 81.0, 81.25, 79.16, 78.92, 79.65, 79.9, 79.41, 78.06, 79.04, 79.77, 78.06, 80.14, 78.43, 79.65, 78.43, 78.55, 78.06, 78.92, 79.04, 77.2, 76.83, 77.08, 79.04, 75.49, 78.43, 78.55, 78.06, 78.43, 76.83, 76.34, 75.12, 75.36, 75.49, 76.96, 75.85, 75.36, 76.1, 75.85, 75.0, 75.36, 76.59, 73.16, 75.73, 75.85, 74.01, 74.38, 75.73, 73.77, 73.89, 74.5, 73.77, 73.89, 74.75, 74.14, 74.5, 73.4]
[rank3]:2026-01-02 21:16:50,722 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2116_rank3_stage3.svg
[rank3]:	> Counts Sum: 1655040, Total Sum: 2121600 (78.01%), Ratio(%) per element: [83.33, 83.45, 82.96, 82.84, 82.72, 83.08, 82.47, 82.35, 82.59, 82.47, 82.1, 82.35, 81.49, 82.59, 82.84, 82.47, 80.26, 81.74, 80.02, 81.25, 80.51, 79.9, 81.37, 80.14, 80.75, 81.25, 80.88, 79.53, 79.16, 79.04, 78.67, 78.43, 79.16, 77.81, 79.41, 79.28, 78.18, 78.3, 76.1, 76.1, 76.22, 76.96, 76.47, 76.83, 75.61, 75.73, 75.36, 73.77, 74.63, 74.5, 74.01, 73.4, 75.12, 74.01, 72.3, 70.46, 72.18, 71.81, 71.56, 71.44, 73.03, 72.79, 72.18, 70.09, 70.46]
[rank1]:2026-01-02 21:16:51,791 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2116_stage1.svg
[rank0]:2026-01-02 21:16:51,771 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2116_stage0.svg
[rank2]:2026-01-02 21:16:51,805 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2116_stage2.svg
[rank3]:2026-01-02 21:16:51,840 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2116_stage3.svg
[rank0]:2026-01-02 21:18:32,095 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:18:34,063 - Avg. fwd time: 15.2906 / Avg. bwd time: 29.5273 / Avg. batch time: 375.7178 (ms) / GPU bubble ratio: 4.57%
[rank2]:2026-01-02 21:18:34,092 - Avg. fwd time: 14.3021 / Avg. bwd time: 25.7227 / Avg. batch time: 421.0105 (ms) / GPU bubble ratio: 23.95%
[rank1]:2026-01-02 21:18:34,148 - Avg. fwd time: 16.2133 / Avg. bwd time: 28.8104 / Avg. batch time: 497.2670 (ms) / GPU bubble ratio: 27.57%
[rank1]:2026-01-02 21:18:34,189 -  step: 1250  loss: -4.0000  grad_norm:  0.2652  memory: 70.00GiB(50.07%)  tps: 7,893  tflops: 368.11  mfu: 37.22%
[rank3]:2026-01-02 21:18:34,192 -  step: 1250  loss:  0.2513  grad_norm:  0.2652  memory: 76.42GiB(54.66%)  tps: 7,893  tflops: 368.12  mfu: 37.22%
[rank0]:2026-01-02 21:18:34,158 - Avg. fwd time: 14.7282 / Avg. bwd time: 24.3838 / Avg. batch time: 524.7985 (ms) / GPU bubble ratio: 40.38%
[rank0]:2026-01-02 21:18:34,193 -  step: 1250  loss: -4.0000  grad_norm:  0.2652  memory: 72.15GiB(51.60%)  tps: 7,893  tflops: 368.11  mfu: 37.22%
[rank2]:2026-01-02 21:18:34,187 -  step: 1250  loss: -4.0000  grad_norm:  0.2652  memory: 62.32GiB(44.58%)  tps: 7,893  tflops: 368.11  mfu: 37.22%
[rank0]:2026-01-02 21:20:14,865 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:20:16,820 - Avg. fwd time: 15.2921 / Avg. bwd time: 29.3884 / Avg. batch time: 374.6129 (ms) / GPU bubble ratio: 4.58%
[rank1]:2026-01-02 21:20:16,908 - Avg. fwd time: 16.2155 / Avg. bwd time: 28.6885 / Avg. batch time: 496.2897 (ms) / GPU bubble ratio: 27.62%
[rank2]:2026-01-02 21:20:16,853 - Avg. fwd time: 14.3034 / Avg. bwd time: 25.6152 / Avg. batch time: 419.8978 (ms) / GPU bubble ratio: 23.95%
[rank0]:2026-01-02 21:20:16,917 - Avg. fwd time: 14.7280 / Avg. bwd time: 24.2381 / Avg. batch time: 523.4876 (ms) / GPU bubble ratio: 40.45%
[rank1]:2026-01-02 21:20:16,949 -  step: 1300  loss: -4.0000  grad_norm:  0.1970  memory: 70.00GiB(50.07%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank1]:2026-01-02 21:20:17,000 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2120_stage1_step1300.svg
[rank3]:2026-01-02 21:20:16,951 -  step: 1300  loss:  0.1851  grad_norm:  0.1970  memory: 76.42GiB(54.66%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank2]:2026-01-02 21:20:16,947 -  step: 1300  loss: -4.0000  grad_norm:  0.1970  memory: 62.32GiB(44.58%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank2]:2026-01-02 21:20:17,001 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2120_stage2_step1300.svg
[rank0]:2026-01-02 21:20:16,953 -  step: 1300  loss: -4.0000  grad_norm:  0.1970  memory: 72.15GiB(51.60%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank0]:2026-01-02 21:20:17,001 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2120_stage0_step1300.svg
[rank3]:2026-01-02 21:20:17,074 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2120_step1300_rank3.svg
[rank3]:			> Batch Time: 489.25 ms, GPU Bubble Ratio: 42.20%, 31.37%, 38.89%, 32.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-117ms   | [S0,MB0,B]  281-42-323ms   | [S0,MB1,B]  324-43-367ms   | [S0,MB2,B]  367-43-410ms   | [S0,MB3,B]  410-36-446ms   | [S0,MB4,B]  447-0-447ms    | [S0,MB5,B]  447-0-447ms    | [S0,MB6,B]  468-0-468ms    | [S0,MB7,B]  489-0-489ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  133-16-149ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  280-36-316ms   | [S1,MB2,B]  317-20-338ms   | [S1,MB3,B]  338-20-359ms   | [S1,MB4,B]  366-20-387ms   | [S1,MB5,B]  410-20-430ms   | [S1,MB6,B]  447-20-467ms   | [S1,MB7,B]  467-20-488ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  117-13-130ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  217-18-235ms   | [S2,MB1,B]  239-40-279ms   | [S2,MB2,B]  284-30-315ms   | [S2,MB3,B]  315-20-336ms   | [S2,MB4,B]  338-18-357ms   | [S2,MB5,B]  359-18-377ms   | [S2,MB6,B]  379-18-398ms   | [S2,MB7,B]  410-18-428ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-14-191ms   | [S3,MB0,B]  193-22-216ms   | [S3,MB1,B]  216-21-238ms   | [S3,MB2,B]  238-46-285ms   | [S3,MB3,B]  283-21-304ms   | [S3,MB4,B]  304-33-338ms   | [S3,MB5,B]  337-20-358ms   | [S3,MB6,B]  358-20-379ms   | [S3,MB7,B]  379-20-400ms  
[rank3]:2026-01-02 21:20:17,115 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2120_stage3_step1300.svg
[rank1]:2026-01-02 21:20:17,179 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2120_rank1_stage1.svg
[rank1]:	> Counts Sum: 2268960, Total Sum: 2903040 (78.16%), Ratio(%) per element: [82.14, 83.81, 82.81, 81.58, 83.37, 82.81, 82.47, 82.25, 82.92, 81.02, 80.46, 81.25, 80.69, 81.13, 80.35, 80.58, 80.69, 81.8, 79.46, 80.13, 80.24, 79.24, 79.79, 79.91, 79.46, 81.58, 79.79, 79.01, 78.45, 78.68, 79.12, 79.79, 78.34, 77.67, 78.12, 78.23, 78.45, 78.01, 77.56, 78.79, 78.57, 77.79, 78.68, 77.34, 78.45, 76.11, 76.56, 76.0, 75.78, 76.33, 75.55, 77.23, 76.45, 75.11, 75.55, 77.0, 75.55, 77.12, 75.78, 75.44, 75.55, 75.89, 75.66, 75.89, 76.45, 73.99, 76.0, 76.11, 75.22, 75.33, 74.66, 76.45, 75.0, 75.66, 74.66, 76.11, 75.66, 74.66, 74.88, 75.78, 76.45]
[rank2]:2026-01-02 21:20:17,178 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2120_rank2_stage2.svg
[rank2]:	> Counts Sum: 2019160, Total Sum: 2580480 (78.25%), Ratio(%) per element: [83.03, 83.48, 82.36, 82.47, 83.92, 82.81, 83.37, 82.92, 82.92, 80.8, 80.69, 80.58, 80.8, 81.25, 81.25, 81.91, 80.91, 81.36, 79.46, 79.35, 79.68, 80.13, 79.24, 78.57, 79.24, 80.02, 78.45, 80.24, 78.57, 79.68, 78.34, 79.01, 78.23, 78.79, 79.12, 77.45, 77.12, 77.56, 79.35, 76.0, 78.68, 78.45, 78.01, 78.68, 77.23, 76.67, 75.44, 75.78, 76.22, 77.34, 76.33, 75.89, 76.67, 76.0, 75.22, 75.44, 76.89, 73.43, 75.78, 75.66, 74.21, 74.44, 75.78, 74.21, 74.1, 74.55, 73.99, 74.33, 74.77, 74.33, 74.77, 73.77]
[rank0]:2026-01-02 21:20:17,174 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2120_rank0_stage0.svg
[rank0]:	> Counts Sum: 1377680, Total Sum: 2616320 (52.66%), Ratio(%) per element: [51.11, 55.8, 56.58, 55.91, 55.91, 56.8, 55.58, 55.46, 56.36, 56.36, 55.13, 55.35, 54.68, 55.02, 54.79, 54.35, 55.24, 54.46, 54.57, 51.89, 52.9, 53.01, 53.12, 53.23, 53.45, 52.56, 53.23, 52.45, 50.89, 52.12, 52.67, 51.78, 51.22, 52.12, 52.56, 51.22, 52.23, 51.22, 51.56, 51.78, 52.45, 52.56, 52.56, 50.66, 51.89, 51.22, 51.78, 51.45, 51.22, 50.89, 51.45, 50.78, 52.0, 51.56, 51.78, 51.33, 52.67, 50.55, 51.78, 52.23, 51.0, 51.45, 51.11, 51.67, 51.45, 50.78, 51.11, 50.66, 50.78, 50.44, 51.33, 50.78, 51.56]
[rank3]:2026-01-02 21:20:17,273 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2120_rank3_stage3.svg
[rank3]:	> Counts Sum: 1821440, Total Sum: 2329600 (78.19%), Ratio(%) per element: [83.25, 83.37, 83.14, 83.25, 82.92, 83.03, 82.7, 82.81, 82.81, 82.7, 82.14, 82.58, 81.91, 82.81, 82.92, 82.7, 80.58, 81.91, 80.24, 81.58, 80.46, 80.24, 81.69, 80.35, 80.69, 81.13, 81.13, 79.68, 79.12, 79.01, 78.9, 78.68, 79.01, 77.67, 79.35, 79.68, 78.01, 78.12, 76.33, 76.11, 76.33, 77.0, 76.67, 76.67, 75.55, 76.0, 75.0, 73.66, 74.66, 74.88, 74.44, 74.1, 75.0, 74.21, 72.76, 70.98, 72.32, 72.54, 71.98, 71.42, 73.1, 72.99, 72.99, 70.53, 71.31]
[rank0]:2026-01-02 21:20:18,438 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2120_stage0.svg
[rank1]:2026-01-02 21:20:18,461 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2120_stage1.svg
[rank3]:2026-01-02 21:20:18,523 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2120_stage3.svg
[rank2]:2026-01-02 21:20:18,557 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2120_stage2.svg
[rank0]:2026-01-02 21:22:00,057 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 21:22:02,088 - Avg. fwd time: 14.3098 / Avg. bwd time: 25.5189 / Avg. batch time: 418.9433 (ms) / GPU bubble ratio: 23.94%
[rank3]:2026-01-02 21:22:02,054 - Avg. fwd time: 15.2990 / Avg. bwd time: 29.2739 / Avg. batch time: 373.7478 (ms) / GPU bubble ratio: 4.59%
[rank1]:2026-01-02 21:22:02,149 - Avg. fwd time: 16.2221 / Avg. bwd time: 28.5776 / Avg. batch time: 495.4855 (ms) / GPU bubble ratio: 27.67%
[rank1]:2026-01-02 21:22:02,190 -  step: 1350  loss: -4.0000  grad_norm:  0.2016  memory: 70.00GiB(50.07%)  tps: 7,784  tflops: 363.05  mfu: 36.71%
[rank0]:2026-01-02 21:22:02,158 - Avg. fwd time: 14.7338 / Avg. bwd time: 24.1058 / Avg. batch time: 522.3800 (ms) / GPU bubble ratio: 40.52%
[rank0]:2026-01-02 21:22:02,194 -  step: 1350  loss: -4.0000  grad_norm:  0.2016  memory: 72.15GiB(51.60%)  tps: 7,784  tflops: 363.05  mfu: 36.71%
[rank2]:2026-01-02 21:22:02,187 -  step: 1350  loss: -4.0000  grad_norm:  0.2016  memory: 62.32GiB(44.58%)  tps: 7,784  tflops: 363.05  mfu: 36.71%
[rank3]:2026-01-02 21:22:02,192 -  step: 1350  loss:  0.1282  grad_norm:  0.2016  memory: 76.42GiB(54.66%)  tps: 7,784  tflops: 363.05  mfu: 36.71%
[rank0]:2026-01-02 21:23:43,205 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:23:45,247 - Avg. fwd time: 15.2992 / Avg. bwd time: 29.1563 / Avg. batch time: 372.8038 (ms) / GPU bubble ratio: 4.60%
[rank2]:2026-01-02 21:23:45,276 - Avg. fwd time: 14.3106 / Avg. bwd time: 25.4255 / Avg. batch time: 417.9991 (ms) / GPU bubble ratio: 23.95%
[rank1]:2026-01-02 21:23:45,330 - Avg. fwd time: 16.2233 / Avg. bwd time: 28.4718 / Avg. batch time: 494.7127 (ms) / GPU bubble ratio: 27.72%
[rank1]:2026-01-02 21:23:45,372 -  step: 1400  loss: -4.0000  grad_norm:  0.2599  memory: 70.00GiB(50.07%)  tps: 7,939  tflops: 370.29  mfu: 37.44%
[rank0]:2026-01-02 21:23:45,341 - Avg. fwd time: 14.7334 / Avg. bwd time: 23.9893 / Avg. batch time: 521.3205 (ms) / GPU bubble ratio: 40.58%
[rank0]:2026-01-02 21:23:45,376 -  step: 1400  loss: -4.0000  grad_norm:  0.2599  memory: 72.15GiB(51.60%)  tps: 7,939  tflops: 370.29  mfu: 37.44%
[rank3]:2026-01-02 21:23:45,374 -  step: 1400  loss:  0.3676  grad_norm:  0.2599  memory: 76.42GiB(54.66%)  tps: 7,939  tflops: 370.30  mfu: 37.44%
[rank2]:2026-01-02 21:23:45,370 -  step: 1400  loss: -4.0000  grad_norm:  0.2599  memory: 62.32GiB(44.58%)  tps: 7,939  tflops: 370.29  mfu: 37.44%
[rank1]:2026-01-02 21:23:45,422 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2123_stage1_step1400.svg
[rank0]:2026-01-02 21:23:45,425 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2123_stage0_step1400.svg
[rank3]:2026-01-02 21:23:45,498 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2123_step1400_rank3.svg
[rank3]:			> Batch Time: 496.25 ms, GPU Bubble Ratio: 42.04%, 31.68%, 39.06%, 30.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-104ms    | [S0,MB7,F]  105-14-119ms   | [S0,MB0,B]  285-42-328ms   | [S0,MB1,B]  328-43-371ms   | [S0,MB2,B]  372-43-415ms   | [S0,MB3,B]  415-38-453ms   | [S0,MB4,B]  454-0-454ms    | [S0,MB5,B]  454-0-454ms    | [S0,MB6,B]  475-0-475ms    | [S0,MB7,B]  496-0-496ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  240-45-285ms   | [S1,MB1,B]  291-36-327ms   | [S1,MB2,B]  329-20-350ms   | [S1,MB3,B]  350-20-371ms   | [S1,MB4,B]  372-21-394ms   | [S1,MB5,B]  415-20-436ms   | [S1,MB6,B]  453-20-474ms   | [S1,MB7,B]  474-20-495ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  221-18-239ms   | [S2,MB1,B]  250-40-290ms   | [S2,MB2,B]  296-31-328ms   | [S2,MB3,B]  328-20-349ms   | [S2,MB4,B]  353-18-372ms   | [S2,MB5,B]  374-18-393ms   | [S2,MB6,B]  395-18-414ms   | [S2,MB7,B]  416-18-435ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-23-220ms   | [S3,MB1,B]  220-29-250ms   | [S3,MB2,B]  249-46-296ms   | [S3,MB3,B]  296-21-317ms   | [S3,MB4,B]  317-35-353ms   | [S3,MB5,B]  352-21-374ms   | [S3,MB6,B]  374-21-395ms   | [S3,MB7,B]  395-20-416ms  
[rank2]:2026-01-02 21:23:45,425 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2123_stage2_step1400.svg
[rank0]:2026-01-02 21:23:45,602 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2123_rank0_stage0.svg
[rank0]:	> Counts Sum: 1502080, Total Sum: 2849920 (52.71%), Ratio(%) per element: [51.12, 55.94, 56.55, 55.84, 55.73, 56.86, 55.22, 55.73, 56.65, 56.45, 55.32, 55.22, 55.12, 55.12, 54.81, 54.61, 55.12, 54.4, 54.61, 51.94, 52.97, 53.27, 53.38, 53.17, 53.38, 52.76, 53.17, 52.56, 51.02, 52.04, 52.56, 51.84, 51.33, 52.25, 52.45, 51.43, 52.35, 51.33, 51.63, 51.74, 52.25, 52.35, 52.35, 50.81, 51.84, 51.43, 51.74, 51.74, 51.53, 50.92, 51.43, 50.92, 52.15, 51.63, 51.94, 51.53, 52.66, 50.71, 51.84, 52.15, 50.92, 51.43, 51.12, 51.74, 51.33, 50.71, 51.22, 50.92, 50.81, 50.4, 51.22, 50.92, 51.53]
[rank3]:2026-01-02 21:23:45,540 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2123_stage3_step1400.svg
[rank2]:2026-01-02 21:23:45,600 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2123_rank2_stage2.svg
[rank2]:	> Counts Sum: 2203560, Total Sum: 2810880 (78.39%), Ratio(%) per element: [82.99, 83.4, 82.17, 82.37, 83.7, 82.78, 83.19, 83.09, 82.99, 80.94, 80.73, 80.94, 80.94, 81.14, 81.55, 82.17, 81.14, 81.25, 79.5, 79.4, 79.81, 80.02, 79.61, 78.89, 79.5, 80.22, 78.79, 80.22, 78.58, 79.81, 78.38, 79.09, 78.07, 79.09, 79.2, 77.66, 77.04, 77.66, 79.5, 76.12, 78.68, 78.58, 78.38, 78.99, 77.45, 76.74, 75.61, 75.92, 76.02, 77.45, 76.84, 75.81, 77.04, 76.33, 75.71, 75.81, 77.45, 73.87, 75.71, 75.61, 74.69, 75.0, 75.71, 74.28, 74.28, 74.79, 74.07, 74.59, 74.89, 74.79, 75.3, 73.97]
[rank1]:2026-01-02 21:23:45,600 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2123_rank1_stage1.svg
[rank1]:	> Counts Sum: 2476160, Total Sum: 3162240 (78.30%), Ratio(%) per element: [82.27, 83.7, 82.68, 81.65, 83.09, 82.68, 82.37, 82.37, 82.78, 81.14, 80.63, 81.25, 80.84, 81.04, 80.53, 80.73, 80.84, 81.76, 79.5, 80.02, 80.22, 79.2, 79.61, 80.12, 79.5, 81.25, 79.91, 79.09, 78.58, 78.79, 79.09, 79.71, 78.58, 77.86, 78.27, 78.38, 78.48, 78.17, 77.86, 78.89, 78.48, 77.76, 78.79, 77.45, 78.68, 76.43, 76.84, 76.12, 76.12, 76.84, 75.92, 77.25, 76.84, 75.1, 75.81, 77.25, 75.81, 77.15, 76.12, 75.81, 75.71, 76.22, 76.02, 76.22, 76.74, 74.38, 76.02, 76.22, 75.3, 75.81, 75.2, 76.84, 75.2, 75.92, 75.3, 76.33, 75.71, 75.1, 75.2, 76.02, 76.74]
[rank3]:2026-01-02 21:23:45,698 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2123_rank3_stage3.svg
[rank3]:	> Counts Sum: 1987840, Total Sum: 2537600 (78.34%), Ratio(%) per element: [83.29, 83.6, 83.29, 83.29, 83.09, 83.29, 83.09, 82.99, 82.99, 82.99, 82.37, 82.99, 81.96, 82.78, 83.19, 82.88, 80.63, 82.27, 80.53, 81.55, 80.63, 80.53, 81.86, 80.53, 80.84, 81.14, 81.25, 79.91, 78.99, 79.2, 78.89, 78.79, 79.2, 77.76, 79.4, 79.61, 78.07, 77.97, 76.74, 76.43, 76.63, 76.94, 76.63, 77.15, 76.12, 76.22, 75.51, 74.07, 75.1, 74.89, 74.69, 74.18, 75.51, 74.38, 72.64, 70.79, 72.54, 72.43, 72.23, 71.1, 72.74, 72.84, 72.54, 71.0, 71.82]
[rank1]:2026-01-02 21:23:46,986 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2123_stage1.svg
[rank0]:2026-01-02 21:23:47,073 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2123_stage0.svg
[rank3]:2026-01-02 21:23:47,044 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2123_stage3.svg
[rank2]:2026-01-02 21:23:47,087 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2123_stage2.svg
[rank0]:2026-01-02 21:25:29,737 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 21:25:31,734 - Avg. fwd time: 14.3190 / Avg. bwd time: 25.3431 / Avg. batch time: 417.2983 (ms) / GPU bubble ratio: 23.96%
[rank3]:2026-01-02 21:25:31,700 - Avg. fwd time: 15.3088 / Avg. bwd time: 29.0699 / Avg. batch time: 372.1869 (ms) / GPU bubble ratio: 4.61%
[rank1]:2026-01-02 21:25:31,793 - Avg. fwd time: 16.2326 / Avg. bwd time: 28.3753 / Avg. batch time: 494.1400 (ms) / GPU bubble ratio: 27.78%
[rank1]:2026-01-02 21:25:31,835 -  step: 1450  loss: -4.0000  grad_norm:  0.2332  memory: 70.00GiB(50.07%)  tps: 7,695  tflops: 358.88  mfu: 36.29%
[rank2]:2026-01-02 21:25:31,832 -  step: 1450  loss: -4.0000  grad_norm:  0.2332  memory: 62.32GiB(44.58%)  tps: 7,695  tflops: 358.88  mfu: 36.29%
[rank0]:2026-01-02 21:25:31,803 - Avg. fwd time: 14.7410 / Avg. bwd time: 23.8781 / Avg. batch time: 520.4861 (ms) / GPU bubble ratio: 40.64%
[rank0]:2026-01-02 21:25:31,839 -  step: 1450  loss: -4.0000  grad_norm:  0.2332  memory: 72.15GiB(51.60%)  tps: 7,695  tflops: 358.88  mfu: 36.29%
[rank3]:2026-01-02 21:25:31,837 -  step: 1450  loss:  0.1885  grad_norm:  0.2332  memory: 76.42GiB(54.66%)  tps: 7,695  tflops: 358.89  mfu: 36.29%
[rank0]:2026-01-02 21:27:14,193 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:27:16,232 - Avg. fwd time: 15.3213 / Avg. bwd time: 28.9855 / Avg. batch time: 371.6103 (ms) / GPU bubble ratio: 4.62%
[rank2]:2026-01-02 21:27:16,261 - Avg. fwd time: 14.3293 / Avg. bwd time: 25.2645 / Avg. batch time: 416.6013 (ms) / GPU bubble ratio: 23.97%
[rank1]:2026-01-02 21:27:16,318 - Avg. fwd time: 16.2437 / Avg. bwd time: 28.2867 / Avg. batch time: 493.5436 (ms) / GPU bubble ratio: 27.82%
[rank3]:2026-01-02 21:27:16,362 -  step: 1500  loss:  0.2708  grad_norm:  0.3171  memory: 76.42GiB(54.66%)  tps: 7,837  tflops: 365.54  mfu: 36.96%
[rank0]:2026-01-02 21:27:16,328 - Avg. fwd time: 14.7507 / Avg. bwd time: 23.7715 / Avg. batch time: 519.6479 (ms) / GPU bubble ratio: 40.69%
[rank0]:2026-01-02 21:27:16,363 -  step: 1500  loss: -4.0000  grad_norm:  0.3171  memory: 72.15GiB(51.60%)  tps: 7,837  tflops: 365.54  mfu: 36.96%
[rank2]:2026-01-02 21:27:16,357 -  step: 1500  loss: -4.0000  grad_norm:  0.3171  memory: 62.32GiB(44.58%)  tps: 7,837  tflops: 365.54  mfu: 36.96%
[rank1]:2026-01-02 21:27:16,359 -  step: 1500  loss: -4.0000  grad_norm:  0.3171  memory: 70.00GiB(50.07%)  tps: 7,837  tflops: 365.54  mfu: 36.96%
[rank1]:2026-01-02 21:27:16,410 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2127_stage1_step1500.svg
[rank0]:2026-01-02 21:27:16,412 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2127_stage0_step1500.svg
[rank2]:2026-01-02 21:27:16,413 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2127_stage2_step1500.svg
[rank3]:2026-01-02 21:27:16,486 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2127_step1500_rank3.svg
[rank3]:			> Batch Time: 498.50 ms, GPU Bubble Ratio: 42.06%, 31.61%, 39.65%, 30.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  76-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  287-42-330ms   | [S0,MB1,B]  330-43-373ms   | [S0,MB2,B]  374-43-417ms   | [S0,MB3,B]  417-38-456ms   | [S0,MB4,B]  456-0-456ms    | [S0,MB5,B]  456-0-456ms    | [S0,MB6,B]  477-0-477ms    | [S0,MB7,B]  498-0-498ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  136-16-153ms   | [S1,MB0,B]  242-45-288ms   | [S1,MB1,B]  291-36-328ms   | [S1,MB2,B]  328-21-349ms   | [S1,MB3,B]  349-21-370ms   | [S1,MB4,B]  374-21-395ms   | [S1,MB5,B]  417-20-438ms   | [S1,MB6,B]  456-20-477ms   | [S1,MB7,B]  477-20-498ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-14-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  152-14-167ms   | [S2,MB0,B]  223-18-242ms   | [S2,MB1,B]  251-40-292ms   | [S2,MB2,B]  297-28-326ms   | [S2,MB3,B]  326-20-347ms   | [S2,MB4,B]  353-18-372ms   | [S2,MB5,B]  374-18-393ms   | [S2,MB6,B]  396-18-414ms   | [S2,MB7,B]  418-18-436ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-161ms   | [S3,MB6,F]  163-15-178ms   | [S3,MB7,F]  181-15-196ms   | [S3,MB0,B]  198-24-222ms   | [S3,MB1,B]  223-29-252ms   | [S3,MB2,B]  251-46-298ms   | [S3,MB3,B]  297-21-318ms   | [S3,MB4,B]  318-34-353ms   | [S3,MB5,B]  353-21-374ms   | [S3,MB6,B]  374-21-395ms   | [S3,MB7,B]  395-21-416ms  
[rank3]:2026-01-02 21:27:16,528 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2127_stage3_step1500.svg
[rank1]:2026-01-02 21:27:16,591 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2127_rank1_stage1.svg
[rank1]:	> Counts Sum: 2683360, Total Sum: 3421440 (78.43%), Ratio(%) per element: [82.48, 83.8, 82.57, 81.81, 83.04, 82.67, 82.48, 82.48, 83.04, 81.15, 80.77, 81.15, 80.87, 81.34, 80.68, 80.77, 80.77, 81.81, 79.64, 80.3, 80.2, 79.35, 79.64, 80.39, 79.54, 81.53, 79.92, 79.16, 78.5, 78.78, 78.97, 79.64, 78.5, 77.93, 78.21, 78.5, 78.59, 78.4, 77.93, 78.97, 78.5, 77.65, 78.88, 77.46, 78.88, 76.42, 76.89, 76.42, 76.42, 77.17, 75.94, 77.36, 76.98, 75.28, 75.94, 77.08, 75.85, 77.46, 76.13, 75.94, 76.04, 76.42, 76.23, 76.51, 77.17, 74.81, 76.23, 76.42, 75.56, 76.23, 75.66, 76.98, 75.28, 76.23, 75.66, 76.42, 75.94, 75.47, 75.37, 76.13, 76.6]
[rank0]:2026-01-02 21:27:16,583 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2127_rank0_stage0.svg
[rank0]:	> Counts Sum: 1626480, Total Sum: 3083520 (52.75%), Ratio(%) per element: [51.13, 55.96, 56.62, 56.15, 55.87, 56.91, 55.2, 55.87, 56.72, 56.43, 55.2, 55.2, 55.11, 54.82, 54.64, 54.64, 55.11, 54.45, 54.45, 52.17, 52.93, 53.4, 53.21, 53.5, 53.5, 53.03, 53.31, 52.84, 50.94, 52.46, 52.55, 51.89, 51.42, 52.17, 52.46, 51.42, 52.55, 51.32, 51.89, 51.7, 52.08, 52.36, 52.36, 50.94, 51.98, 51.6, 51.6, 51.6, 51.51, 51.04, 51.51, 50.94, 51.98, 51.7, 51.89, 51.51, 52.55, 50.75, 51.79, 52.17, 50.94, 51.51, 51.13, 51.7, 51.32, 50.75, 51.6, 50.94, 51.04, 50.47, 51.23, 51.04, 51.51]
[rank2]:2026-01-02 21:27:16,589 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2127_rank2_stage2.svg
[rank2]:	> Counts Sum: 2387960, Total Sum: 3041280 (78.52%), Ratio(%) per element: [82.85, 83.23, 82.29, 82.38, 83.61, 82.76, 83.14, 83.14, 83.14, 81.15, 80.96, 81.15, 80.96, 81.25, 81.34, 82.19, 81.15, 81.06, 79.82, 79.54, 79.64, 80.2, 79.64, 79.35, 79.73, 80.49, 79.16, 80.2, 78.88, 80.11, 78.78, 79.16, 78.21, 79.07, 79.35, 77.74, 77.55, 77.74, 79.64, 76.04, 78.97, 78.5, 78.21, 78.97, 77.55, 76.79, 75.94, 76.32, 76.13, 77.65, 77.17, 76.23, 76.98, 76.51, 75.47, 76.04, 77.27, 74.24, 75.85, 75.85, 74.9, 75.09, 76.13, 73.95, 74.71, 75.0, 74.24, 74.9, 75.18, 74.9, 75.66, 73.86]
[rank3]:2026-01-02 21:27:16,685 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2127_rank3_stage3.svg
[rank3]:	> Counts Sum: 2154240, Total Sum: 2745600 (78.46%), Ratio(%) per element: [83.33, 83.8, 83.52, 83.52, 83.23, 83.52, 83.14, 83.23, 83.23, 82.95, 82.48, 83.04, 81.72, 83.04, 83.04, 82.95, 80.87, 82.29, 80.58, 81.62, 80.68, 80.58, 81.62, 80.87, 81.15, 81.25, 81.15, 79.73, 79.45, 79.35, 78.59, 78.88, 79.45, 78.21, 79.35, 79.64, 78.31, 78.31, 76.89, 76.7, 76.89, 77.46, 77.17, 77.46, 76.7, 76.23, 75.75, 74.43, 75.47, 74.81, 74.71, 74.05, 75.66, 74.81, 72.63, 70.83, 72.72, 72.44, 71.78, 71.11, 72.82, 72.91, 72.63, 71.11, 71.87]
[rank0]:2026-01-02 21:27:18,058 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2127_stage0.svg
[rank1]:2026-01-02 21:27:18,106 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2127_stage1.svg
[rank3]:2026-01-02 21:27:18,104 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2127_stage3.svg
[rank2]:2026-01-02 21:27:18,164 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2127_stage2.svg
[rank0]:2026-01-02 21:29:00,484 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:29:02,483 - Avg. fwd time: 15.3322 / Avg. bwd time: 28.9011 / Avg. batch time: 371.0193 (ms) / GPU bubble ratio: 4.62%
[rank2]:2026-01-02 21:29:02,514 - Avg. fwd time: 14.3385 / Avg. bwd time: 25.1928 / Avg. batch time: 415.9480 (ms) / GPU bubble ratio: 23.97%
[rank1]:2026-01-02 21:29:02,564 - Avg. fwd time: 16.2540 / Avg. bwd time: 28.2024 / Avg. batch time: 492.9935 (ms) / GPU bubble ratio: 27.86%
[rank1]:2026-01-02 21:29:02,608 -  step: 1550  loss: -4.0000  grad_norm:  0.2860  memory: 70.00GiB(50.07%)  tps: 7,710  tflops: 359.61  mfu: 36.36%
[rank0]:2026-01-02 21:29:02,576 - Avg. fwd time: 14.7600 / Avg. bwd time: 23.6708 / Avg. batch time: 518.8756 (ms) / GPU bubble ratio: 40.75%
[rank0]:2026-01-02 21:29:02,612 -  step: 1550  loss: -4.0000  grad_norm:  0.2860  memory: 72.15GiB(51.60%)  tps: 7,710  tflops: 359.61  mfu: 36.36%
[rank3]:2026-01-02 21:29:02,610 -  step: 1550  loss:  0.2704  grad_norm:  0.2860  memory: 76.42GiB(54.66%)  tps: 7,710  tflops: 359.61  mfu: 36.36%
[rank2]:2026-01-02 21:29:02,605 -  step: 1550  loss: -4.0000  grad_norm:  0.2860  memory: 62.32GiB(44.58%)  tps: 7,710  tflops: 359.61  mfu: 36.36%
[rank0]:2026-01-02 21:30:44,279 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 21:30:46,346 - Avg. fwd time: 14.3432 / Avg. bwd time: 25.1225 / Avg. batch time: 415.2732 (ms) / GPU bubble ratio: 23.97%
[rank3]:2026-01-02 21:30:46,316 - Avg. fwd time: 15.3371 / Avg. bwd time: 28.8169 / Avg. batch time: 370.3827 (ms) / GPU bubble ratio: 4.63%
[rank1]:2026-01-02 21:30:46,404 - Avg. fwd time: 16.2590 / Avg. bwd time: 28.1193 / Avg. batch time: 492.3944 (ms) / GPU bubble ratio: 27.90%
[rank0]:2026-01-02 21:30:46,415 - Avg. fwd time: 14.7634 / Avg. bwd time: 23.5745 / Avg. batch time: 518.0606 (ms) / GPU bubble ratio: 40.80%
[rank2]:2026-01-02 21:30:46,444 -  step: 1600  loss: -4.0000  grad_norm:  0.3502  memory: 62.32GiB(44.58%)  tps: 7,889  tflops: 367.95  mfu: 37.20%
[rank3]:2026-01-02 21:30:46,448 -  step: 1600  loss:  0.4005  grad_norm:  0.3502  memory: 76.42GiB(54.66%)  tps: 7,889  tflops: 367.96  mfu: 37.20%
[rank1]:2026-01-02 21:30:46,446 -  step: 1600  loss: -4.0000  grad_norm:  0.3502  memory: 70.00GiB(50.07%)  tps: 7,889  tflops: 367.95  mfu: 37.20%
[rank1]:2026-01-02 21:30:46,498 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2130_stage1_step1600.svg
[rank0]:2026-01-02 21:30:46,450 -  step: 1600  loss: -4.0000  grad_norm:  0.3502  memory: 72.15GiB(51.60%)  tps: 7,889  tflops: 367.95  mfu: 37.20%
[rank0]:2026-01-02 21:30:46,501 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2130_stage0_step1600.svg
[rank2]:2026-01-02 21:30:46,501 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2130_stage2_step1600.svg
[rank3]:2026-01-02 21:30:46,572 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2130_step1600_rank3.svg
[rank3]:			> Batch Time: 495.75 ms, GPU Bubble Ratio: 42.37%, 31.98%, 39.34%, 33.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-104ms    | [S0,MB7,F]  105-14-119ms   | [S0,MB0,B]  286-42-329ms   | [S0,MB1,B]  329-43-372ms   | [S0,MB2,B]  372-43-416ms   | [S0,MB3,B]  416-36-452ms   | [S0,MB4,B]  453-0-453ms    | [S0,MB5,B]  453-0-453ms    | [S0,MB6,B]  474-0-474ms    | [S0,MB7,B]  495-0-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  102-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  135-16-152ms   | [S1,MB0,B]  241-45-286ms   | [S1,MB1,B]  286-34-320ms   | [S1,MB2,B]  320-21-342ms   | [S1,MB3,B]  342-21-363ms   | [S1,MB4,B]  372-21-393ms   | [S1,MB5,B]  416-20-437ms   | [S1,MB6,B]  452-20-473ms   | [S1,MB7,B]  473-20-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  222-18-241ms   | [S2,MB1,B]  244-40-284ms   | [S2,MB2,B]  290-28-319ms   | [S2,MB3,B]  319-20-340ms   | [S2,MB4,B]  341-18-360ms   | [S2,MB5,B]  361-18-380ms   | [S2,MB6,B]  383-18-402ms   | [S2,MB7,B]  416-18-434ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-23-221ms   | [S3,MB1,B]  221-21-243ms   | [S3,MB2,B]  243-46-290ms   | [S3,MB3,B]  289-21-311ms   | [S3,MB4,B]  311-29-340ms   | [S3,MB5,B]  340-21-361ms   | [S3,MB6,B]  361-21-382ms   | [S3,MB7,B]  382-21-403ms  
[rank3]:2026-01-02 21:30:46,616 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2130_stage3_step1600.svg
[rank1]:2026-01-02 21:30:46,677 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2130_rank1_stage1.svg
[rank1]:	> Counts Sum: 2890560, Total Sum: 3680640 (78.53%), Ratio(%) per element: [82.48, 83.89, 82.83, 82.04, 83.09, 82.74, 82.57, 82.48, 83.09, 81.33, 81.07, 81.33, 81.07, 81.6, 80.98, 80.98, 80.98, 82.04, 79.75, 80.36, 80.36, 79.57, 79.84, 80.54, 79.84, 81.6, 79.92, 79.22, 78.6, 78.69, 79.13, 79.66, 78.52, 77.99, 78.25, 78.6, 78.69, 78.34, 77.72, 78.78, 78.34, 77.81, 78.96, 77.64, 78.78, 76.49, 77.02, 76.67, 76.49, 77.2, 76.14, 77.46, 77.11, 75.44, 75.88, 77.28, 76.05, 77.46, 76.4, 76.05, 76.23, 76.49, 76.23, 76.76, 77.2, 75.08, 76.32, 76.67, 75.7, 76.32, 75.7, 76.93, 75.44, 76.4, 75.7, 76.49, 76.05, 75.7, 75.44, 76.23, 76.58]
[rank0]:2026-01-02 21:30:46,674 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2130_rank0_stage0.svg
[rank0]:	> Counts Sum: 1750880, Total Sum: 3317120 (52.78%), Ratio(%) per element: [51.49, 55.8, 56.51, 55.98, 55.8, 56.95, 55.1, 55.54, 56.51, 56.51, 55.1, 55.01, 54.84, 54.57, 54.48, 55.01, 54.92, 54.22, 54.31, 52.28, 52.99, 53.25, 53.34, 53.43, 53.52, 53.08, 53.25, 52.9, 51.4, 52.37, 52.64, 51.84, 51.49, 52.11, 52.46, 51.58, 52.81, 51.23, 51.76, 51.76, 52.2, 52.46, 52.37, 51.05, 52.28, 51.67, 51.76, 51.58, 51.76, 51.32, 51.58, 50.96, 52.11, 51.84, 52.11, 51.58, 52.64, 50.88, 51.84, 52.2, 50.96, 51.58, 51.23, 52.02, 51.4, 50.79, 51.58, 51.23, 51.05, 50.7, 51.23, 51.23, 51.49]
[rank2]:2026-01-02 21:30:46,674 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2130_rank2_stage2.svg
[rank2]:	> Counts Sum: 2572360, Total Sum: 3271680 (78.63%), Ratio(%) per element: [82.83, 83.36, 82.39, 82.39, 83.53, 82.83, 83.01, 83.18, 83.18, 81.07, 80.89, 81.16, 80.72, 81.25, 81.25, 82.21, 81.07, 80.89, 79.84, 79.92, 79.92, 80.54, 79.92, 79.48, 80.01, 80.45, 79.4, 80.19, 79.22, 80.1, 78.78, 79.4, 78.43, 79.13, 79.57, 77.81, 77.72, 77.9, 80.01, 76.4, 79.04, 78.96, 78.69, 79.22, 77.72, 77.11, 76.05, 76.76, 76.14, 77.46, 77.11, 76.4, 76.84, 76.49, 75.79, 76.23, 77.37, 74.64, 75.88, 76.05, 75.26, 74.91, 76.23, 74.38, 74.82, 74.82, 74.38, 74.91, 75.08, 74.82, 75.79, 73.94]
[rank3]:2026-01-02 21:30:46,774 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2130_rank3_stage3.svg
[rank3]:	> Counts Sum: 2320640, Total Sum: 2953600 (78.57%), Ratio(%) per element: [83.62, 83.8, 83.62, 83.53, 83.45, 83.36, 83.45, 83.18, 83.27, 83.09, 82.65, 83.09, 81.69, 82.92, 83.09, 83.01, 80.98, 82.48, 80.72, 81.51, 80.63, 80.45, 81.42, 80.89, 81.25, 81.07, 81.16, 79.92, 79.22, 79.84, 78.96, 79.04, 79.57, 78.43, 79.31, 79.4, 78.43, 78.78, 77.2, 76.76, 76.93, 77.81, 77.55, 77.81, 76.93, 76.05, 76.14, 74.38, 75.7, 74.91, 75.0, 73.94, 75.96, 74.64, 72.79, 70.77, 72.62, 72.62, 72.09, 71.39, 72.88, 73.15, 72.97, 71.3, 72.18]
[rank0]:2026-01-02 21:30:48,248 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2130_stage0.svg
[rank1]:2026-01-02 21:30:48,274 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2130_stage1.svg
[rank2]:2026-01-02 21:30:48,317 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2130_stage2.svg
[rank3]:2026-01-02 21:30:48,373 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2130_stage3.svg
[rank0]:2026-01-02 21:32:30,815 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:32:32,834 - Avg. fwd time: 15.3436 / Avg. bwd time: 28.7533 / Avg. batch time: 369.9230 (ms) / GPU bubble ratio: 4.64%
[rank2]:2026-01-02 21:32:32,864 - Avg. fwd time: 14.3487 / Avg. bwd time: 25.0553 / Avg. batch time: 414.7086 (ms) / GPU bubble ratio: 23.99%
[rank0]:2026-01-02 21:32:32,928 - Avg. fwd time: 14.7687 / Avg. bwd time: 23.4881 / Avg. batch time: 517.3991 (ms) / GPU bubble ratio: 40.85%
[rank1]:2026-01-02 21:32:32,918 - Avg. fwd time: 16.2654 / Avg. bwd time: 28.0432 / Avg. batch time: 491.9341 (ms) / GPU bubble ratio: 27.94%
[rank1]:2026-01-02 21:32:32,959 -  step: 1650  loss: -4.0000  grad_norm:  0.4775  memory: 70.00GiB(50.07%)  tps: 7,691  tflops: 358.71  mfu: 36.27%
[rank2]:2026-01-02 21:32:32,957 -  step: 1650  loss: -4.0000  grad_norm:  0.4775  memory: 62.32GiB(44.58%)  tps: 7,691  tflops: 358.71  mfu: 36.27%
[rank3]:2026-01-02 21:32:32,961 -  step: 1650  loss:  0.4302  grad_norm:  0.4775  memory: 76.42GiB(54.66%)  tps: 7,691  tflops: 358.72  mfu: 36.27%
[rank0]:2026-01-02 21:32:32,963 -  step: 1650  loss: -4.0000  grad_norm:  0.4775  memory: 72.15GiB(51.60%)  tps: 7,691  tflops: 358.71  mfu: 36.27%
[rank0]:2026-01-02 21:34:15,351 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:34:17,375 - Avg. fwd time: 15.3506 / Avg. bwd time: 28.6836 / Avg. batch time: 369.4192 (ms) / GPU bubble ratio: 4.64%
[rank2]:2026-01-02 21:34:17,405 - Avg. fwd time: 14.3552 / Avg. bwd time: 24.9950 / Avg. batch time: 414.1432 (ms) / GPU bubble ratio: 23.99%
[rank1]:2026-01-02 21:34:17,461 - Avg. fwd time: 16.2723 / Avg. bwd time: 27.9724 / Avg. batch time: 491.4590 (ms) / GPU bubble ratio: 27.98%
[rank3]:2026-01-02 21:34:17,506 -  step: 1700  loss:  0.4112  grad_norm:  0.4095  memory: 76.42GiB(54.66%)  tps: 7,836  tflops: 365.47  mfu: 36.95%
[rank0]:2026-01-02 21:34:17,472 - Avg. fwd time: 14.7738 / Avg. bwd time: 23.4062 / Avg. batch time: 516.7348 (ms) / GPU bubble ratio: 40.89%
[rank0]:2026-01-02 21:34:17,508 -  step: 1700  loss: -4.0000  grad_norm:  0.4095  memory: 72.15GiB(51.60%)  tps: 7,836  tflops: 365.47  mfu: 36.95%
[rank2]:2026-01-02 21:34:17,501 -  step: 1700  loss: -4.0000  grad_norm:  0.4095  memory: 62.32GiB(44.58%)  tps: 7,836  tflops: 365.47  mfu: 36.95%
[rank1]:2026-01-02 21:34:17,504 -  step: 1700  loss: -4.0000  grad_norm:  0.4095  memory: 70.00GiB(50.07%)  tps: 7,836  tflops: 365.47  mfu: 36.95%
[rank1]:2026-01-02 21:34:17,554 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2134_stage1_step1700.svg
[rank0]:2026-01-02 21:34:17,554 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2134_stage0_step1700.svg
[rank2]:2026-01-02 21:34:17,556 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2134_stage2_step1700.svg
[rank3]:2026-01-02 21:34:17,629 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2134_step1700_rank3.svg
[rank3]:			> Batch Time: 496.75 ms, GPU Bubble Ratio: 42.25%, 31.89%, 39.31%, 31.96%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  286-42-329ms   | [S0,MB1,B]  329-43-372ms   | [S0,MB2,B]  372-43-416ms   | [S0,MB3,B]  416-37-454ms   | [S0,MB4,B]  454-0-454ms    | [S0,MB5,B]  454-0-454ms    | [S0,MB6,B]  475-0-475ms    | [S0,MB7,B]  496-0-496ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  102-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  135-16-152ms   | [S1,MB0,B]  240-45-286ms   | [S1,MB1,B]  286-35-322ms   | [S1,MB2,B]  322-21-343ms   | [S1,MB3,B]  343-21-364ms   | [S1,MB4,B]  372-21-393ms   | [S1,MB5,B]  416-20-437ms   | [S1,MB6,B]  454-20-475ms   | [S1,MB7,B]  475-20-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  118-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  151-14-166ms   | [S2,MB0,B]  221-18-240ms   | [S2,MB1,B]  245-40-285ms   | [S2,MB2,B]  291-29-321ms   | [S2,MB3,B]  321-21-343ms   | [S2,MB4,B]  347-18-366ms   | [S2,MB5,B]  369-18-387ms   | [S2,MB6,B]  389-18-408ms   | [S2,MB7,B]  416-18-435ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  93-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  127-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  179-15-195ms   | [S3,MB0,B]  197-24-221ms   | [S3,MB1,B]  221-23-244ms   | [S3,MB2,B]  244-46-291ms   | [S3,MB3,B]  291-21-312ms   | [S3,MB4,B]  312-34-347ms   | [S3,MB5,B]  347-21-368ms   | [S3,MB6,B]  368-21-389ms   | [S3,MB7,B]  389-20-410ms  
[rank3]:2026-01-02 21:34:17,672 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2134_stage3_step1700.svg
[rank1]:2026-01-02 21:34:17,733 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2134_rank1_stage1.svg
[rank1]:	> Counts Sum: 3097760, Total Sum: 3939840 (78.63%), Ratio(%) per element: [82.73, 84.04, 82.97, 82.31, 83.38, 82.97, 82.81, 82.73, 83.3, 81.49, 81.25, 81.57, 81.33, 81.74, 81.16, 81.08, 81.25, 82.31, 79.68, 80.34, 80.42, 79.68, 79.93, 80.75, 80.01, 81.57, 79.93, 79.35, 78.7, 78.53, 79.11, 79.6, 78.61, 78.04, 78.12, 78.7, 78.61, 78.28, 77.54, 78.7, 78.37, 77.87, 78.78, 77.54, 79.02, 76.64, 76.97, 76.8, 76.64, 77.22, 76.23, 77.63, 76.97, 75.65, 76.06, 77.3, 76.31, 77.38, 76.56, 76.15, 76.31, 76.56, 76.23, 76.89, 77.05, 75.57, 76.31, 76.8, 75.82, 76.31, 76.06, 76.89, 75.57, 76.48, 75.82, 76.39, 76.15, 75.9, 75.49, 76.39, 76.64]
[rank0]:2026-01-02 21:34:17,726 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2134_rank0_stage0.svg
[rank0]:	> Counts Sum: 1875280, Total Sum: 3550720 (52.81%), Ratio(%) per element: [51.39, 56.0, 56.74, 56.0, 56.08, 56.99, 55.42, 55.92, 56.57, 56.66, 54.93, 54.76, 54.68, 54.52, 54.68, 54.76, 54.93, 54.27, 54.19, 52.13, 52.96, 53.28, 53.12, 53.28, 53.7, 53.12, 53.2, 52.87, 51.56, 52.3, 52.71, 51.89, 51.56, 52.22, 52.38, 51.8, 52.87, 51.39, 51.8, 51.8, 52.38, 52.46, 52.22, 51.23, 52.3, 51.64, 51.72, 51.64, 51.72, 51.31, 51.56, 51.06, 52.05, 51.97, 51.97, 51.64, 52.71, 50.9, 51.72, 52.22, 51.06, 51.48, 51.31, 52.05, 51.31, 50.9, 51.56, 51.39, 51.15, 50.65, 51.39, 51.23, 51.72]
[rank2]:2026-01-02 21:34:17,729 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2134_rank2_stage2.svg
[rank2]:	> Counts Sum: 2756760, Total Sum: 3502080 (78.72%), Ratio(%) per element: [82.73, 83.14, 82.56, 82.48, 83.55, 82.97, 83.14, 83.22, 83.14, 81.16, 81.25, 81.25, 80.83, 81.41, 81.41, 82.56, 81.33, 81.08, 79.93, 80.18, 80.09, 80.67, 80.26, 79.85, 80.18, 80.59, 79.68, 80.09, 79.27, 80.09, 78.78, 79.35, 78.53, 79.19, 79.44, 77.87, 78.12, 78.04, 79.93, 76.56, 78.86, 79.27, 78.53, 79.27, 77.79, 77.46, 76.39, 76.89, 76.64, 77.46, 77.22, 76.8, 77.05, 76.56, 75.9, 76.23, 77.46, 74.58, 75.9, 75.98, 75.41, 75.24, 76.39, 74.34, 74.75, 74.67, 74.34, 74.75, 74.91, 74.83, 75.49, 74.09]
[rank3]:2026-01-02 21:34:17,831 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2134_rank3_stage3.svg
[rank3]:	> Counts Sum: 2487040, Total Sum: 3161600 (78.66%), Ratio(%) per element: [83.79, 83.71, 83.79, 83.63, 83.63, 83.47, 83.63, 83.38, 83.47, 83.05, 82.81, 83.14, 81.74, 82.89, 83.22, 83.14, 81.16, 82.64, 80.75, 81.9, 80.67, 80.75, 81.82, 81.08, 81.41, 81.25, 81.57, 79.93, 79.52, 80.09, 79.02, 79.44, 79.76, 78.78, 79.6, 79.52, 78.28, 78.86, 77.13, 76.89, 77.13, 77.87, 77.79, 77.87, 76.97, 76.06, 76.15, 74.58, 75.9, 75.24, 74.83, 74.17, 75.74, 74.67, 72.86, 70.55, 72.53, 72.53, 71.71, 71.38, 72.61, 73.35, 72.69, 71.21, 72.12]
[rank0]:2026-01-02 21:34:19,413 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2134_stage0.svg
[rank1]:2026-01-02 21:34:19,465 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2134_stage1.svg
[rank2]:2026-01-02 21:34:19,471 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2134_stage2.svg
[rank3]:2026-01-02 21:34:19,554 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2134_stage3.svg
[rank0]:2026-01-02 21:36:02,066 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:36:04,090 - Avg. fwd time: 15.3560 / Avg. bwd time: 28.6243 / Avg. batch time: 368.9863 (ms) / GPU bubble ratio: 4.65%
[rank0]:2026-01-02 21:36:04,188 - Avg. fwd time: 14.7781 / Avg. bwd time: 23.3296 / Avg. batch time: 516.1659 (ms) / GPU bubble ratio: 40.94%
[rank2]:2026-01-02 21:36:04,120 - Avg. fwd time: 14.3602 / Avg. bwd time: 24.9387 / Avg. batch time: 413.6604 (ms) / GPU bubble ratio: 24.00%
[rank1]:2026-01-02 21:36:04,176 - Avg. fwd time: 16.2776 / Avg. bwd time: 27.9055 / Avg. batch time: 491.0644 (ms) / GPU bubble ratio: 28.02%
[rank1]:2026-01-02 21:36:04,219 -  step: 1750  loss: -4.0000  grad_norm:  0.6036  memory: 70.00GiB(50.07%)  tps: 7,677  tflops: 358.03  mfu: 36.20%
[rank0]:2026-01-02 21:36:04,223 -  step: 1750  loss: -4.0000  grad_norm:  0.6036  memory: 72.15GiB(51.60%)  tps: 7,677  tflops: 358.03  mfu: 36.20%
[rank3]:2026-01-02 21:36:04,221 -  step: 1750  loss:  0.4149  grad_norm:  0.6036  memory: 76.42GiB(54.66%)  tps: 7,677  tflops: 358.04  mfu: 36.20%
[rank2]:2026-01-02 21:36:04,216 -  step: 1750  loss: -4.0000  grad_norm:  0.6036  memory: 62.32GiB(44.58%)  tps: 7,677  tflops: 358.03  mfu: 36.20%
[rank0]:2026-01-02 21:37:44,914 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:37:46,851 - Avg. fwd time: 15.3516 / Avg. bwd time: 28.5573 / Avg. batch time: 368.4110 (ms) / GPU bubble ratio: 4.65%
[rank2]:2026-01-02 21:37:46,881 - Avg. fwd time: 14.3568 / Avg. bwd time: 24.8802 / Avg. batch time: 413.0497 (ms) / GPU bubble ratio: 24.01%
[rank1]:2026-01-02 21:37:46,937 - Avg. fwd time: 16.2732 / Avg. bwd time: 27.8398 / Avg. batch time: 490.5409 (ms) / GPU bubble ratio: 28.06%
[rank3]:2026-01-02 21:37:46,982 -  step: 1800  loss:  0.0802  grad_norm:  0.1382  memory: 76.42GiB(54.66%)  tps: 7,972  tflops: 371.82  mfu: 37.60%
[rank2]:2026-01-02 21:37:46,977 -  step: 1800  loss: -4.0000  grad_norm:  0.1382  memory: 62.32GiB(44.58%)  tps: 7,972  tflops: 371.81  mfu: 37.59%
[rank0]:2026-01-02 21:37:46,948 - Avg. fwd time: 14.7730 / Avg. bwd time: 23.2565 / Avg. batch time: 515.4670 (ms) / GPU bubble ratio: 40.98%
[rank0]:2026-01-02 21:37:46,984 -  step: 1800  loss: -4.0000  grad_norm:  0.1382  memory: 72.15GiB(51.60%)  tps: 7,972  tflops: 371.81  mfu: 37.59%
[rank1]:2026-01-02 21:37:46,980 -  step: 1800  loss: -4.0000  grad_norm:  0.1382  memory: 70.00GiB(50.07%)  tps: 7,972  tflops: 371.81  mfu: 37.59%
[rank1]:2026-01-02 21:37:47,031 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2137_stage1_step1800.svg
[rank2]:2026-01-02 21:37:47,033 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2137_stage2_step1800.svg
[rank0]:2026-01-02 21:37:47,031 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2137_stage0_step1800.svg
[rank3]:2026-01-02 21:37:47,105 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2137_step1800_rank3.svg
[rank3]:			> Batch Time: 489.00 ms, GPU Bubble Ratio: 42.87%, 32.55%, 40.36%, 32.53%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-44ms     | [S0,MB3,F]  44-13-58ms     | [S0,MB4,F]  58-13-72ms     | [S0,MB5,F]  72-13-86ms     | [S0,MB6,F]  86-13-100ms    | [S0,MB7,F]  100-13-114ms   | [S0,MB0,B]  281-42-324ms   | [S0,MB1,B]  324-42-367ms   | [S0,MB2,B]  367-43-410ms   | [S0,MB3,B]  410-36-447ms   | [S0,MB4,B]  446-0-446ms    | [S0,MB5,B]  447-0-447ms    | [S0,MB6,B]  467-0-467ms    | [S0,MB7,B]  489-0-489ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-36ms     | [S1,MB1,F]  37-14-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB3,F]  67-15-82ms     | [S1,MB4,F]  83-15-98ms     | [S1,MB5,F]  98-15-113ms    | [S1,MB6,F]  114-15-129ms   | [S1,MB7,F]  129-15-145ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  281-35-316ms   | [S1,MB2,B]  316-20-337ms   | [S1,MB3,B]  337-20-358ms   | [S1,MB4,B]  367-20-388ms   | [S1,MB5,B]  410-20-431ms   | [S1,MB6,B]  446-20-467ms   | [S1,MB7,B]  467-20-488ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  36-17-54ms     | [S2,MB1,F]  54-13-67ms     | [S2,MB2,F]  68-13-81ms     | [S2,MB3,F]  82-13-96ms     | [S2,MB4,F]  98-13-111ms    | [S2,MB5,F]  113-13-127ms   | [S2,MB6,F]  129-13-142ms   | [S2,MB7,F]  145-13-158ms   | [S2,MB0,B]  217-18-236ms   | [S2,MB1,B]  239-40-280ms   | [S2,MB2,B]  285-28-314ms   | [S2,MB3,B]  314-19-334ms   | [S2,MB4,B]  339-18-357ms   | [S2,MB5,B]  360-18-378ms   | [S2,MB6,B]  380-18-398ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-72ms     | [S3,MB1,F]  74-14-88ms     | [S3,MB2,F]  90-14-104ms    | [S3,MB3,F]  107-14-121ms   | [S3,MB4,F]  123-14-137ms   | [S3,MB5,F]  139-14-153ms   | [S3,MB6,F]  156-14-170ms   | [S3,MB7,F]  172-14-186ms   | [S3,MB0,B]  189-28-217ms   | [S3,MB1,B]  217-22-239ms   | [S3,MB2,B]  239-45-285ms   | [S3,MB3,B]  284-20-305ms   | [S3,MB4,B]  305-33-339ms   | [S3,MB5,B]  338-20-359ms   | [S3,MB6,B]  359-20-379ms   | [S3,MB7,B]  379-20-400ms  
[rank3]:2026-01-02 21:37:47,148 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2137_stage3_step1800.svg
[rank1]:2026-01-02 21:37:47,209 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2137_rank1_stage1.svg
[rank1]:	> Counts Sum: 3304960, Total Sum: 4199040 (78.71%), Ratio(%) per element: [82.87, 84.02, 83.1, 82.56, 83.56, 83.17, 83.02, 82.87, 83.48, 81.63, 81.4, 81.71, 81.55, 81.86, 81.4, 81.17, 81.4, 82.33, 79.86, 80.4, 80.55, 80.09, 80.24, 80.94, 80.09, 81.71, 80.24, 79.47, 78.78, 78.54, 79.32, 79.62, 78.54, 78.16, 78.0, 78.93, 78.62, 78.24, 77.77, 78.7, 78.31, 77.77, 78.7, 77.54, 78.85, 76.69, 77.16, 76.92, 76.77, 77.39, 76.31, 77.62, 77.08, 75.61, 76.15, 77.31, 76.38, 77.31, 76.54, 76.31, 76.46, 76.54, 76.38, 76.85, 76.92, 75.61, 76.38, 76.77, 75.92, 76.23, 76.08, 76.85, 75.69, 76.46, 75.92, 76.62, 76.08, 75.84, 75.61, 76.38, 76.69]
[rank2]:2026-01-02 21:37:47,205 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2137_rank2_stage2.svg
[rank2]:	> Counts Sum: 2941160, Total Sum: 3732480 (78.80%), Ratio(%) per element: [82.87, 83.17, 82.87, 82.63, 83.71, 83.17, 83.25, 83.25, 83.41, 81.4, 81.63, 81.55, 81.17, 81.71, 81.71, 82.87, 81.63, 81.4, 79.86, 80.01, 80.09, 80.63, 80.24, 79.7, 79.93, 80.78, 79.7, 80.01, 79.01, 80.16, 78.7, 79.32, 78.47, 78.85, 79.47, 77.93, 78.0, 78.0, 79.7, 77.0, 78.78, 79.24, 78.62, 79.08, 78.08, 77.39, 76.54, 76.77, 76.85, 77.46, 77.46, 76.77, 77.08, 76.69, 75.77, 76.31, 77.31, 74.92, 76.0, 76.08, 75.69, 75.46, 76.31, 74.61, 74.76, 75.0, 74.61, 74.61, 75.0, 75.15, 75.61, 74.22]
[rank0]:2026-01-02 21:37:47,202 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2137_rank0_stage0.svg
[rank0]:	> Counts Sum: 1999680, Total Sum: 3784320 (52.84%), Ratio(%) per element: [51.38, 55.86, 56.55, 56.01, 56.09, 56.86, 55.32, 55.86, 56.48, 56.4, 55.01, 54.78, 54.7, 54.62, 54.7, 54.7, 54.78, 54.39, 54.39, 52.23, 53.0, 53.31, 53.08, 53.16, 53.62, 53.08, 53.16, 52.77, 51.69, 52.23, 52.85, 51.92, 51.62, 52.23, 52.54, 51.77, 52.93, 51.38, 51.85, 51.85, 52.39, 52.54, 52.39, 51.38, 52.31, 51.77, 51.77, 51.77, 51.69, 51.38, 51.62, 51.0, 52.0, 52.08, 52.16, 51.69, 52.62, 51.0, 51.92, 52.31, 51.08, 51.54, 51.31, 52.08, 51.46, 50.92, 51.69, 51.54, 51.15, 50.69, 51.46, 51.38, 51.77]
[rank3]:2026-01-02 21:37:47,307 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2137_rank3_stage3.svg
[rank3]:	> Counts Sum: 2653440, Total Sum: 3369600 (78.75%), Ratio(%) per element: [84.02, 83.87, 83.95, 83.71, 83.87, 83.71, 83.79, 83.33, 83.64, 83.33, 82.87, 83.33, 82.02, 83.17, 83.41, 83.41, 81.4, 82.94, 80.86, 81.79, 80.78, 80.63, 81.79, 81.17, 81.48, 81.17, 81.79, 80.32, 79.55, 80.4, 79.24, 79.62, 79.78, 78.93, 79.93, 79.39, 78.31, 78.78, 76.92, 77.0, 77.16, 77.77, 78.0, 77.85, 77.39, 75.92, 75.92, 74.45, 75.92, 74.69, 74.92, 74.15, 75.84, 74.53, 73.07, 70.52, 72.6, 72.37, 71.99, 71.45, 72.6, 73.3, 72.83, 71.52, 72.06]
[rank0]:2026-01-02 21:37:48,976 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2137_stage0.svg
[rank2]:2026-01-02 21:37:49,087 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2137_stage2.svg
[rank1]:2026-01-02 21:37:49,055 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2137_stage1.svg
[rank3]:2026-01-02 21:37:49,145 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2137_stage3.svg
[rank0]:2026-01-02 21:39:28,778 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 21:39:30,720 - Avg. fwd time: 15.3461 / Avg. bwd time: 28.4892 / Avg. batch time: 367.8184 (ms) / GPU bubble ratio: 4.66%
[rank2]:2026-01-02 21:39:30,751 - Avg. fwd time: 14.3526 / Avg. bwd time: 24.8216 / Avg. batch time: 412.4363 (ms) / GPU bubble ratio: 24.01%
[rank1]:2026-01-02 21:39:30,802 - Avg. fwd time: 16.2682 / Avg. bwd time: 27.7779 / Avg. batch time: 489.9431 (ms) / GPU bubble ratio: 28.08%
[rank0]:2026-01-02 21:39:30,814 - Avg. fwd time: 14.7680 / Avg. bwd time: 23.1786 / Avg. batch time: 514.7108 (ms) / GPU bubble ratio: 41.02%
[rank0]:2026-01-02 21:39:30,849 -  step: 1850  loss: -4.0000  grad_norm:  0.2717  memory: 72.15GiB(51.60%)  tps: 7,887  tflops: 367.86  mfu: 37.19%
[rank3]:2026-01-02 21:39:30,847 -  step: 1850  loss:  0.3572  grad_norm:  0.2717  memory: 76.42GiB(54.66%)  tps: 7,887  tflops: 367.86  mfu: 37.20%
[rank2]:2026-01-02 21:39:30,843 -  step: 1850  loss: -4.0000  grad_norm:  0.2717  memory: 62.32GiB(44.58%)  tps: 7,887  tflops: 367.86  mfu: 37.19%
[rank1]:2026-01-02 21:39:30,845 -  step: 1850  loss: -4.0000  grad_norm:  0.2717  memory: 70.00GiB(50.07%)  tps: 7,887  tflops: 367.86  mfu: 37.19%
[rank0]:2026-01-02 21:41:09,824 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 21:41:11,826 - Avg. fwd time: 14.3468 / Avg. bwd time: 24.7661 / Avg. batch time: 411.7784 (ms) / GPU bubble ratio: 24.01%
[rank3]:2026-01-02 21:41:11,795 - Avg. fwd time: 15.3384 / Avg. bwd time: 28.4180 / Avg. batch time: 367.1823 (ms) / GPU bubble ratio: 4.67%
[rank1]:2026-01-02 21:41:11,880 - Avg. fwd time: 16.2618 / Avg. bwd time: 27.7138 / Avg. batch time: 489.3176 (ms) / GPU bubble ratio: 28.10%
[rank2]:2026-01-02 21:41:11,922 -  step: 1900  loss: -4.0000  grad_norm:  0.1842  memory: 62.32GiB(44.58%)  tps: 8,105  tflops: 378.00  mfu: 38.22%
[rank0]:2026-01-02 21:41:11,893 - Avg. fwd time: 14.7606 / Avg. bwd time: 23.1073 / Avg. batch time: 513.9255 (ms) / GPU bubble ratio: 41.05%
[rank0]:2026-01-02 21:41:11,928 -  step: 1900  loss: -4.0000  grad_norm:  0.1842  memory: 72.15GiB(51.60%)  tps: 8,105  tflops: 378.00  mfu: 38.22%
[rank3]:2026-01-02 21:41:11,926 -  step: 1900  loss:  0.2041  grad_norm:  0.1842  memory: 76.42GiB(54.66%)  tps: 8,105  tflops: 378.00  mfu: 38.22%
[rank1]:2026-01-02 21:41:11,924 -  step: 1900  loss: -4.0000  grad_norm:  0.1842  memory: 70.00GiB(50.07%)  tps: 8,105  tflops: 378.00  mfu: 38.22%
[rank1]:2026-01-02 21:41:11,975 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2141_stage1_step1900.svg
[rank2]:2026-01-02 21:41:11,978 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2141_stage2_step1900.svg
[rank0]:2026-01-02 21:41:11,976 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2141_stage0_step1900.svg
[rank3]:2026-01-02 21:41:12,050 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2141_step1900_rank3.svg
[rank3]:			> Batch Time: 483.75 ms, GPU Bubble Ratio: 42.24%, 31.53%, 39.18%, 31.46%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-44ms     | [S0,MB3,F]  45-13-58ms     | [S0,MB4,F]  58-13-72ms     | [S0,MB5,F]  72-14-86ms     | [S0,MB6,F]  86-14-100ms    | [S0,MB7,F]  101-14-115ms   | [S0,MB0,B]  277-42-319ms   | [S0,MB1,B]  319-42-362ms   | [S0,MB2,B]  362-43-406ms   | [S0,MB3,B]  406-35-441ms   | [S0,MB4,B]  441-0-441ms    | [S0,MB5,B]  441-0-441ms    | [S0,MB6,B]  462-0-462ms    | [S0,MB7,B]  483-0-483ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-68ms     | [S1,MB3,F]  68-15-83ms     | [S1,MB4,F]  83-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-130ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  231-45-276ms   | [S1,MB1,B]  280-34-315ms   | [S1,MB2,B]  316-20-337ms   | [S1,MB3,B]  337-20-358ms   | [S1,MB4,B]  362-20-383ms   | [S1,MB5,B]  406-20-426ms   | [S1,MB6,B]  441-20-462ms   | [S1,MB7,B]  462-20-482ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-82ms     | [S2,MB3,F]  83-13-97ms     | [S2,MB4,F]  99-13-112ms    | [S2,MB5,F]  114-13-128ms   | [S2,MB6,F]  130-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  212-18-231ms   | [S2,MB1,B]  239-40-280ms   | [S2,MB2,B]  286-29-316ms   | [S2,MB3,B]  315-19-335ms   | [S2,MB4,B]  340-18-359ms   | [S2,MB5,B]  361-18-379ms   | [S2,MB6,B]  381-18-400ms   | [S2,MB7,B]  406-18-424ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  75-14-89ms     | [S3,MB2,F]  91-14-105ms    | [S3,MB3,F]  107-14-122ms   | [S3,MB4,F]  124-14-138ms   | [S3,MB5,F]  140-14-155ms   | [S3,MB6,F]  157-14-171ms   | [S3,MB7,F]  174-14-188ms   | [S3,MB0,B]  190-21-212ms   | [S3,MB1,B]  212-27-239ms   | [S3,MB2,B]  239-46-285ms   | [S3,MB3,B]  285-20-306ms   | [S3,MB4,B]  306-34-340ms   | [S3,MB5,B]  340-20-361ms   | [S3,MB6,B]  361-20-381ms   | [S3,MB7,B]  381-20-401ms  
[rank2]:2026-01-02 21:41:12,151 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2141_rank2_stage2.svg
[rank2]:	> Counts Sum: 3125560, Total Sum: 3962880 (78.87%), Ratio(%) per element: [82.92, 83.13, 82.84, 82.84, 83.72, 83.28, 83.28, 83.35, 83.57, 81.54, 81.68, 81.68, 81.25, 81.54, 81.75, 82.77, 81.54, 81.46, 79.86, 79.86, 80.08, 80.66, 80.45, 79.65, 80.01, 80.59, 79.79, 80.3, 78.99, 80.3, 78.56, 79.28, 78.63, 78.99, 79.5, 77.97, 77.97, 77.9, 79.79, 77.18, 78.92, 79.21, 78.41, 78.92, 78.05, 77.61, 76.52, 77.03, 77.03, 77.61, 77.9, 76.88, 77.18, 76.81, 76.09, 76.3, 77.39, 75.21, 76.09, 76.45, 75.87, 75.65, 76.3, 74.49, 74.78, 75.0, 74.7, 75.0, 75.14, 75.07, 75.72, 74.56]
[rank0]:2026-01-02 21:41:12,150 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2141_rank0_stage0.svg
[rank0]:	> Counts Sum: 2124080, Total Sum: 4017920 (52.87%), Ratio(%) per element: [51.67, 55.88, 56.25, 55.88, 55.88, 56.68, 55.15, 56.03, 56.39, 56.39, 54.94, 54.72, 54.65, 54.5, 54.5, 54.72, 54.72, 54.36, 54.21, 52.32, 52.97, 53.19, 53.12, 53.12, 53.7, 53.12, 53.19, 52.76, 51.67, 52.25, 52.83, 52.1, 51.59, 52.47, 52.61, 52.03, 52.83, 51.52, 51.96, 51.81, 52.54, 52.47, 52.47, 51.59, 52.47, 51.96, 51.88, 51.81, 51.88, 51.3, 51.74, 51.09, 51.96, 52.18, 52.18, 51.67, 52.68, 51.09, 51.81, 52.39, 51.09, 51.74, 51.3, 52.1, 51.38, 51.01, 51.81, 51.45, 51.3, 50.94, 51.59, 51.38, 51.88]
[rank3]:2026-01-02 21:41:12,093 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2141_stage3_step1900.svg
[rank1]:2026-01-02 21:41:12,154 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2141_rank1_stage1.svg
[rank1]:	> Counts Sum: 3512160, Total Sum: 4458240 (78.78%), Ratio(%) per element: [82.92, 83.93, 82.99, 82.48, 83.72, 83.21, 83.06, 82.77, 83.43, 81.54, 81.54, 81.68, 81.61, 81.75, 81.32, 81.25, 81.25, 82.41, 79.79, 80.3, 80.45, 80.08, 80.23, 80.88, 80.08, 81.61, 80.08, 79.43, 78.85, 78.77, 79.36, 79.65, 78.56, 78.41, 78.34, 78.85, 78.63, 78.27, 77.83, 78.77, 78.34, 77.76, 78.7, 77.54, 78.99, 76.81, 77.47, 76.96, 77.25, 77.54, 76.52, 77.61, 77.25, 75.87, 76.38, 77.32, 76.67, 77.61, 76.74, 76.52, 76.45, 76.74, 76.59, 76.96, 76.96, 75.72, 76.52, 76.88, 76.01, 76.52, 76.16, 76.96, 75.87, 76.45, 76.09, 76.81, 76.38, 75.94, 75.65, 76.45, 76.74]
[rank3]:2026-01-02 21:41:12,252 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2141_rank3_stage3.svg
[rank3]:	> Counts Sum: 2819840, Total Sum: 3577600 (78.82%), Ratio(%) per element: [84.15, 83.86, 84.08, 83.86, 84.01, 83.93, 84.01, 83.28, 83.72, 83.43, 82.99, 83.5, 82.19, 83.28, 83.5, 83.21, 81.68, 83.06, 80.88, 81.9, 80.74, 80.66, 81.75, 81.03, 81.39, 80.95, 81.9, 80.37, 79.5, 80.45, 78.99, 79.65, 79.72, 78.92, 79.79, 79.28, 78.27, 78.7, 76.67, 77.18, 77.25, 77.76, 77.97, 77.83, 77.47, 76.09, 76.01, 74.7, 75.79, 74.92, 75.21, 74.56, 76.01, 74.78, 73.25, 70.27, 72.89, 72.67, 72.16, 71.65, 72.96, 73.32, 73.18, 71.58, 72.23]
[rank2]:2026-01-02 21:41:14,132 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2141_stage2.svg
[rank3]:2026-01-02 21:41:14,172 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2141_stage3.svg
[rank1]:2026-01-02 21:41:14,183 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2141_stage1.svg
[rank0]:2026-01-02 21:41:14,200 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2141_stage0.svg
[rank0]:2026-01-02 21:42:53,183 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 21:42:55,156 - Avg. fwd time: 14.3403 / Avg. bwd time: 24.7134 / Avg. batch time: 411.1749 (ms) / GPU bubble ratio: 24.02%
[rank3]:2026-01-02 21:42:55,126 - Avg. fwd time: 15.3299 / Avg. bwd time: 28.3582 / Avg. batch time: 366.6323 (ms) / GPU bubble ratio: 4.67%
[rank2]:2026-01-02 21:42:55,258 -  step: 1950  loss: -4.0000  grad_norm:  0.1332  memory: 62.32GiB(44.58%)  tps: 7,928  tflops: 369.74  mfu: 37.39%
[rank0]:2026-01-02 21:42:55,229 - Avg. fwd time: 14.7522 / Avg. bwd time: 23.0397 / Avg. batch time: 513.2034 (ms) / GPU bubble ratio: 41.09%
[rank1]:2026-01-02 21:42:55,217 - Avg. fwd time: 16.2540 / Avg. bwd time: 27.6548 / Avg. batch time: 488.7481 (ms) / GPU bubble ratio: 28.13%
[rank1]:2026-01-02 21:42:55,260 -  step: 1950  loss: -4.0000  grad_norm:  0.1332  memory: 70.00GiB(50.07%)  tps: 7,928  tflops: 369.74  mfu: 37.39%
[rank3]:2026-01-02 21:42:55,262 -  step: 1950  loss:  0.1743  grad_norm:  0.1332  memory: 76.42GiB(54.66%)  tps: 7,928  tflops: 369.75  mfu: 37.39%
[rank0]:2026-01-02 21:42:55,264 -  step: 1950  loss: -4.0000  grad_norm:  0.1332  memory: 72.15GiB(51.60%)  tps: 7,928  tflops: 369.74  mfu: 37.39%
[rank0]:2026-01-02 21:44:34,137 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 21:44:36,105 - Avg. fwd time: 15.3219 / Avg. bwd time: 28.2877 / Avg. batch time: 366.0004 (ms) / GPU bubble ratio: 4.68%
[rank2]:2026-01-02 21:44:36,136 - Avg. fwd time: 14.3340 / Avg. bwd time: 24.6642 / Avg. batch time: 410.5666 (ms) / GPU bubble ratio: 24.01%
[rank0]:2026-01-02 21:44:36,209 - Avg. fwd time: 14.7447 / Avg. bwd time: 22.9781 / Avg. batch time: 512.5047 (ms) / GPU bubble ratio: 41.12%
[rank2]:2026-01-02 21:44:36,238 -  step: 2000  loss: -4.0000  grad_norm:  0.1584  memory: 62.32GiB(44.58%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank2]:2026-01-02 21:44:36,238 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1584  tps: 7,736  tflops: 360.79  mfu: 35.24%
[rank2]:2026-01-02 21:44:36,238 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 21:44:36,241 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2026-01-02 21:44:36,195 - Avg. fwd time: 16.2470 / Avg. bwd time: 27.6002 / Avg. batch time: 488.1940 (ms) / GPU bubble ratio: 28.15%
[rank1]:2026-01-02 21:44:36,240 -  step: 2000  loss: -4.0000  grad_norm:  0.1584  memory: 70.00GiB(50.07%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank1]:2026-01-02 21:44:36,240 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1584  tps: 7,736  tflops: 360.80  mfu: 35.24%
[rank1]:2026-01-02 21:44:36,240 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 21:44:36,244 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 21:44:36,244 -  step: 2000  loss: -4.0000  grad_norm:  0.1584  memory: 72.15GiB(51.60%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank0]:2026-01-02 21:44:36,244 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1584  tps: 7,736  tflops: 360.80  mfu: 35.24%
[rank0]:2026-01-02 21:44:36,244 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 21:44:36,249 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-02 21:44:36,242 -  step: 2000  loss:  0.2097  grad_norm:  0.1584  memory: 76.42GiB(54.66%)  tps: 8,113  tflops: 378.37  mfu: 38.26%
[rank3]:2026-01-02 21:44:36,243 - â„¹ï¸ final step: 2000  loss:  0.2097  grad_norm:  0.1584  tps: 7,739  tflops: 360.94  mfu: 35.26%
[rank3]:2026-01-02 21:44:36,243 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-02 21:44:36,247 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 21:44:46,526 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 21:44:46,602 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank0/260102_2144_stage0_final2000.svg
[rank2]:2026-01-02 21:44:46,620 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank2/260102_2144_stage2_final2000.svg
[rank1]:2026-01-02 21:44:46,607 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank1/260102_2144_stage1_final2000.svg
[rank3]:2026-01-02 21:44:46,704 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2144_final2000_rank3.svg
[rank3]:			> Batch Time: 493.50 ms, GPU Bubble Ratio: 42.27%, 31.82%, 39.33%, 32.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  284-42-327ms   | [S0,MB1,B]  326-43-369ms   | [S0,MB2,B]  370-43-413ms   | [S0,MB3,B]  413-37-451ms   | [S0,MB4,B]  451-0-451ms    | [S0,MB5,B]  451-0-451ms    | [S0,MB6,B]  472-0-472ms    | [S0,MB7,B]  493-0-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  239-45-284ms   | [S1,MB1,B]  285-35-320ms   | [S1,MB2,B]  321-21-342ms   | [S1,MB3,B]  342-20-363ms   | [S1,MB4,B]  370-20-391ms   | [S1,MB5,B]  413-20-434ms   | [S1,MB6,B]  451-20-471ms   | [S1,MB7,B]  472-20-492ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  220-18-239ms   | [S2,MB1,B]  244-40-284ms   | [S2,MB2,B]  289-30-319ms   | [S2,MB3,B]  320-20-340ms   | [S2,MB4,B]  344-18-363ms   | [S2,MB5,B]  365-18-384ms   | [S2,MB6,B]  386-18-405ms   | [S2,MB7,B]  413-18-432ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-15-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-23-218ms   | [S3,MB1,B]  219-22-242ms   | [S3,MB2,B]  243-46-289ms   | [S3,MB3,B]  289-21-310ms   | [S3,MB4,B]  310-34-344ms   | [S3,MB5,B]  343-21-364ms   | [S3,MB6,B]  364-20-385ms   | [S3,MB7,B]  385-20-406ms  
[rank3]:2026-01-02 21:44:46,832 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/pipeline_schedule/260102_2144_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 500.76 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB4,F]  60-15-75ms     | [S0,MB5,F]  75-15-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-121ms   | [S0,MB0,B]  257-30-288ms   | [S0,MB1,B]  288-30-318ms   | [S0,MB2,B]  318-30-349ms   | [S0,MB3,B]  349-30-379ms   | [S0,MB4,B]  379-30-409ms   | [S0,MB5,B]  409-30-440ms   | [S0,MB6,B]  440-30-470ms   | [S0,MB7,B]  470-30-500ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-75ms     | [S1,MB4,F]  75-15-91ms     | [S1,MB5,F]  91-15-106ms    | [S1,MB6,F]  106-15-121ms   | [S1,MB7,F]  121-15-136ms   | [S1,MB0,B]  227-30-257ms   | [S1,MB1,B]  257-30-288ms   | [S1,MB2,B]  288-30-318ms   | [S1,MB3,B]  318-30-349ms   | [S1,MB4,B]  349-30-379ms   | [S1,MB5,B]  379-30-409ms   | [S1,MB6,B]  409-30-440ms   | [S1,MB7,B]  440-30-470ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB2,F]  60-15-75ms     | [S2,MB3,F]  75-15-91ms     | [S2,MB4,F]  91-15-106ms    | [S2,MB5,F]  106-15-121ms   | [S2,MB6,F]  121-15-136ms   | [S2,MB7,F]  136-15-151ms   | [S2,MB0,B]  197-30-227ms   | [S2,MB1,B]  227-30-257ms   | [S2,MB2,B]  257-30-288ms   | [S2,MB3,B]  288-30-318ms   | [S2,MB4,B]  318-30-349ms   | [S2,MB5,B]  349-30-379ms   | [S2,MB6,B]  379-30-409ms   | [S2,MB7,B]  409-30-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB1,F]  60-15-75ms     | [S3,MB2,F]  75-15-91ms     | [S3,MB3,F]  91-15-106ms    | [S3,MB4,F]  106-15-121ms   | [S3,MB5,F]  121-15-136ms   | [S3,MB6,F]  136-15-151ms   | [S3,MB7,F]  151-15-166ms   | [S3,MB0,B]  166-30-197ms   | [S3,MB1,B]  197-30-227ms   | [S3,MB2,B]  227-30-257ms   | [S3,MB3,B]  257-30-288ms   | [S3,MB4,B]  288-30-318ms   | [S3,MB5,B]  318-30-349ms   | [S3,MB6,B]  349-30-379ms   | [S3,MB7,B]  379-30-409ms  
[rank2]:2026-01-02 21:44:46,813 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2144_rank2_stage2.svg
[rank2]:	> Counts Sum: 3309960, Total Sum: 4193280 (78.93%), Ratio(%) per element: [83.1, 83.31, 83.1, 83.1, 83.85, 83.51, 83.44, 83.58, 83.65, 81.66, 81.79, 81.73, 81.38, 81.66, 81.79, 82.89, 81.52, 81.45, 79.87, 80.08, 80.15, 80.83, 80.56, 79.53, 80.08, 80.63, 79.8, 80.35, 79.25, 80.42, 78.91, 79.53, 78.84, 79.05, 79.67, 78.15, 77.88, 78.22, 79.39, 77.12, 78.77, 79.25, 78.29, 78.91, 77.74, 77.54, 76.85, 76.78, 77.19, 77.67, 77.74, 77.06, 77.12, 76.78, 76.3, 76.3, 77.26, 75.27, 76.09, 76.3, 75.82, 75.68, 76.16, 74.38, 74.86, 75.06, 74.86, 75.13, 75.2, 75.2, 75.96, 74.58]
[rank0]:2026-01-02 21:44:46,777 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2144_rank0_stage0.svg
[rank0]:	> Counts Sum: 2248480, Total Sum: 4251520 (52.89%), Ratio(%) per element: [51.85, 55.76, 55.97, 55.76, 55.7, 56.52, 55.21, 55.97, 56.45, 56.38, 54.94, 54.6, 54.53, 54.39, 54.39, 54.67, 54.8, 54.18, 54.05, 52.47, 52.81, 53.15, 53.02, 53.29, 53.7, 53.22, 53.29, 52.67, 51.85, 52.33, 52.81, 52.12, 51.71, 52.4, 52.6, 52.19, 52.88, 51.64, 52.06, 51.85, 52.74, 52.4, 52.6, 51.64, 52.54, 52.33, 51.92, 51.78, 51.85, 51.3, 51.71, 51.03, 51.99, 52.19, 52.26, 51.71, 52.67, 51.16, 51.85, 52.47, 51.16, 51.71, 51.37, 52.19, 51.51, 51.16, 51.92, 51.64, 51.44, 50.96, 51.57, 51.51, 51.85]
[rank1]:2026-01-02 21:44:46,830 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2144_rank1_stage1.svg
[rank1]:	> Counts Sum: 3719360, Total Sum: 4717440 (78.84%), Ratio(%) per element: [82.89, 83.79, 82.89, 82.62, 83.58, 83.1, 82.96, 82.69, 83.17, 81.59, 81.59, 81.86, 81.66, 81.79, 81.38, 81.31, 81.45, 82.34, 79.8, 80.35, 80.63, 80.01, 80.28, 80.9, 80.08, 81.59, 80.28, 79.32, 78.77, 78.91, 79.32, 79.67, 78.64, 78.57, 78.36, 79.05, 78.57, 78.29, 78.02, 78.77, 78.57, 77.81, 78.7, 77.74, 78.98, 76.85, 77.54, 77.19, 77.54, 77.6, 76.57, 77.67, 77.33, 75.96, 76.51, 77.33, 76.78, 77.67, 76.85, 76.64, 76.57, 76.71, 76.64, 76.92, 77.06, 75.89, 76.78, 76.92, 76.23, 76.64, 76.3, 76.99, 75.89, 76.51, 76.3, 76.92, 76.57, 76.09, 75.68, 76.71, 76.85]
[rank3]:2026-01-02 21:44:46,884 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_ratio_history/rank3/260102_2144_stage3_final2000.svg
[rank3]:2026-01-02 21:44:47,058 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/frozen_params_histogram/260102_2144_rank3_stage3.svg
[rank3]:	> Counts Sum: 2986240, Total Sum: 3785600 (78.88%), Ratio(%) per element: [84.2, 83.92, 84.2, 83.72, 84.06, 84.06, 84.2, 83.37, 83.79, 83.37, 83.1, 83.65, 82.28, 83.37, 83.58, 83.1, 81.93, 83.24, 80.97, 82.21, 80.83, 80.7, 81.59, 81.25, 81.45, 80.83, 81.86, 80.28, 79.39, 80.42, 79.18, 79.53, 79.87, 78.77, 79.67, 79.39, 78.57, 78.7, 76.71, 77.47, 77.19, 77.74, 77.81, 78.02, 77.47, 76.09, 76.23, 74.79, 75.89, 75.13, 75.27, 74.58, 75.82, 74.65, 73.35, 70.53, 73.0, 73.0, 72.04, 71.77, 72.87, 73.48, 73.21, 71.9, 72.52]
[rank0]:2026-01-02 21:44:48,825 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2144_stage0.svg
[rank0]:2026-01-02 21:44:48,830 - Sleeping 2 seconds for other ranks to complete
[rank1]:2026-01-02 21:44:49,250 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2144_stage1.svg
[rank1]:2026-01-02 21:44:49,254 - Destroying the purge thread.
[rank2]:2026-01-02 21:44:49,439 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2144_stage2.svg
[rank2]:2026-01-02 21:44:49,444 - Destroying the purge thread.
[rank3]:2026-01-02 21:44:49,441 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200/afr_time_plot/260102_2144_stage3.svg
[rank3]:2026-01-02 21:44:49,445 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading output.log; uploading config.yaml
[rank3]:wandb: uploading history steps 40-40, summary, console lines 479-495
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.11712
[rank3]:wandb:               final/avg_loss 0.20968
[rank3]:wandb:             final/avg_mfu(%) 35.25676
[rank3]:wandb:             final/avg_tflops 360.93999
[rank3]:wandb:    final/avg_throughput(tps) 7738.82388
[rank3]:wandb:              final/grad_norm 0.15835
[rank3]:wandb:               final/max_loss 0.20968
[rank3]:wandb:                    grad_norm 0.15835
[rank3]:wandb: loss_metrics/global_avg_loss 0.20968
[rank3]:wandb: loss_metrics/global_max_loss 0.20968
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_GPipe_timelyauto_h200 at: https://wandb.ai/orangingq/torchtitan/runs/ugk8g01s
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_GPipe_timelyauto_h200/20260102-2032/wandb/run-20260102_203214-ugk8g01s/logs
[rank0]:2026-01-02 21:44:50,830 - Training completed
[rank0]:2026-01-02 21:44:50,830 - Destroying the purge thread.
[rank1]:2026-01-02 21:44:51,084 - Process group destroyed
[rank2]:2026-01-02 21:44:51,129 - Process group destroyed
[rank0]:2026-01-02 21:44:51,128 - Process group destroyed
[rank3]:2026-01-02 21:44:51,129 - Process group destroyed
[rank2]:[W102 21:44:52.960513465 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W102 21:44:52.917946489 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:[W102 21:44:52.960214679 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W102 21:44:52.057143704 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.18', 'layers.23', 'layers.21', 'layers.24', 'layers.19', 'layers.20', 'layers.17'}
[rank0]:Stage 0: Modules to keep: {'layers.0', 'layers.4', 'layers.6', 'layers.5', 'tok_embeddings', 'layers.3', 'layers.1', 'layers.7', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.15', 'layers.12', 'layers.11', 'layers.10', 'layers.9', 'layers.13', 'layers.8', 'layers.16', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'norm', 'layers.30', 'layers.31', 'layers.28', 'layers.27', 'output', 'layers.26', 'layers.29'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_GPipe_timelyauto_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_GPipe_timelyauto_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_GPipe_timelyauto_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_timelyauto_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyauto_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_GPipe_timelyauto_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_timelyauto_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_GPipe_timelyauto_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyauto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.0001
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W102 21:44:58.536995530 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
