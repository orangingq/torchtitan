
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Jan  3 15:03:25 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_ZBVZeroBubble_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with nofreeze x ZBVZeroBubble ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0103 15:03:26.953000 3559466 site-packages/torch/distributed/run.py:803] 
W0103 15:03:26.953000 3559466 site-packages/torch/distributed/run.py:803] *****************************************
W0103 15:03:26.953000 3559466 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0103 15:03:26.953000 3559466 site-packages/torch/distributed/run.py:803] *****************************************
[rank3]:2026-01-03 15:03:33,950 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank0]:2026-01-03 15:03:34,054 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank1]:2026-01-03 15:03:34,065 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank2]:2026-01-03 15:03:34,247 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank3]:2026-01-03 15:03:34,801 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-03 15:03:34,804 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-03 15:03:34,809 - Deterministic algorithm enabled (expect perf degradation).
[rank2]:2026-01-03 15:03:35,052 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-03 15:03:35,054 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-03 15:03:35,060 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 15:03:35,008 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-03 15:03:35,010 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-03 15:03:35,015 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-03 15:03:35,015 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 15:03:35,016 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-03 15:03:35,026 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-03 15:03:35,028 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-03 15:03:35,033 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 15:03:35,299 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank1]:2026-01-03 15:03:37,397 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2026-01-03 15:03:37,467 - PP rank 1 is building stage_idx 1 with modules ['layers.4', 'layers.5', 'layers.6', 'layers.7', 'layers.8']
[rank1]:2026-01-03 15:03:37,486 - PP rank 1 is building stage_idx 6 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28']
[rank1]:2026-01-03 15:03:37,487 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank1]:2026-01-03 15:03:37,714 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-03 15:03:37,714 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank2]:2026-01-03 15:03:38,131 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2026-01-03 15:03:38,205 - PP rank 2 is building stage_idx 2 with modules ['layers.9', 'layers.10', 'layers.11', 'layers.12']
[rank2]:2026-01-03 15:03:38,225 - PP rank 2 is building stage_idx 5 with modules ['layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-03 15:03:38,225 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank2]:2026-01-03 15:03:38,442 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-03 15:03:38,442 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2026-01-03 15:03:38,475 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank0]:wandb: setting up run ev9k400q
[rank0]:wandb: Tracking run with wandb version 0.23.1
[rank0]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_ZBVZeroBubble_nofreeze_h200/20260103-1503/wandb/run-20260103_150339-ev9k400q
[rank0]:wandb: Run `wandb offline` to turn off syncing.
[rank0]:wandb: Syncing run 260102_ZBVZeroBubble_nofreeze_h200
[rank0]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/ev9k400q
[rank0]:2026-01-03 15:03:40,577 - WandB logging enabled
[rank0]:2026-01-03 15:03:40,577 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-03 15:03:40,627 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-03 15:03:40,650 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3']
[rank0]:2026-01-03 15:03:40,671 - PP rank 0 is building stage_idx 7 with modules ['layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank0]:2026-01-03 15:03:40,671 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank0]:2026-01-03 15:03:40,909 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-03 15:03:40,909 - CUDA memory usage for model: 9.61GiB(6.88%)
[rank3]:2026-01-03 15:03:58,089 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-03 15:03:58,162 - PP rank 3 is building stage_idx 3 with modules ['layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank3]:2026-01-03 15:03:58,182 - PP rank 3 is building stage_idx 4 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20']
[rank3]:2026-01-03 15:03:58,182 - Using pipeline schedule ZBVZeroBubble with 8 microbatches and 8 stages.
[rank3]:2026-01-03 15:03:58,391 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-03 15:03:58,391 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank2]:2026-01-03 15:03:58,405 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-03 15:03:58,405 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-03 15:03:58,404 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 15:03:58,404 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_ZBVZeroBubble_nofreeze_h200
[rank0]:2026-01-03 15:03:58,404 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 15:03:58,405 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-03 15:03:58,405 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank0]:2026-01-03 15:04:09,850 - [GC] GC collection for checkpoint loading. 0.03 seconds
[rank0]:2026-01-03 15:04:09,850 - Finished loading the checkpoint in 11.45 seconds.
[rank0]:2026-01-03 15:04:09,851 - Training starts at step 1
[rank2]:2026-01-03 15:04:13,753 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 33.45GiB(23.92%)  tps: 461  tflops: 21.48  mfu: 2.17%
[rank2]:2026-01-03 15:04:13,753 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-03 15:04:13,763 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 37.98GiB(27.17%)  tps: 451  tflops: 21.04  mfu: 2.13%
[rank1]:2026-01-03 15:04:13,763 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-03 15:04:13,760 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 36.96GiB(26.44%)  tps: 1,049  tflops: 48.92  mfu: 4.95%
[rank3]:2026-01-03 15:04:13,760 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 15:04:13,760 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 44.58GiB(31.89%)  tps: 495  tflops: 23.06  mfu: 2.33%
[rank0]:2026-01-03 15:04:13,760 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 15:06:09,030 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 15:06:11,485 - Avg. fwd time: 7.0195 / Avg. bwd-weight time: 11.2101 / Avg. bwd-input time: 9.1113 / Avg. batch time: 559.5978 (ms) / GPU bubble ratio: 21.83%
[rank2]:2026-01-03 15:06:11,474 - Avg. fwd time: 7.0483 / Avg. bwd-weight time: 11.2825 / Avg. bwd-input time: 9.1551 / Avg. batch time: 558.2629 (ms) / GPU bubble ratio: 21.22%
[rank1]:2026-01-03 15:06:11,482 - Avg. fwd time: 8.0291 / Avg. bwd-weight time: 12.7482 / Avg. bwd-input time: 10.3746 / Avg. batch time: 577.3414 (ms) / GPU bubble ratio: 13.67%
[rank0]:2026-01-03 15:06:11,464 - Avg. fwd time: 7.8883 / Avg. full-bwd time: 22.9686 (Avg. bwd-weight time: 15.1408 / Avg. bwd-input time: 11.5702) / Avg. batch time: 582.6309 (ms) / GPU bubble ratio: 10.12%
[rank3]:2026-01-03 15:06:11,511 -  step: 50  loss: -4.0000  grad_norm: 5745.0029  memory: 49.97GiB(35.74%)  tps: 6,818  tflops: 317.99  mfu: 32.15%
[rank2]:2026-01-03 15:06:11,511 -  step: 50  loss: -4.0000  grad_norm: 5745.0029  memory: 46.44GiB(33.21%)  tps: 6,818  tflops: 317.97  mfu: 32.15%
[rank1]:2026-01-03 15:06:11,513 -  step: 50  loss: -4.0000  grad_norm: 5745.0029  memory: 52.63GiB(37.64%)  tps: 6,818  tflops: 317.99  mfu: 32.15%
[rank0]:2026-01-03 15:06:11,521 -  step: 50  loss:  9.4337  grad_norm: 5745.0029  memory: 63.64GiB(45.52%)  tps: 6,817  tflops: 317.96  mfu: 32.15%
[rank0]:2026-01-03 15:08:09,309 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 15:08:11,762 - Avg. fwd time: 7.0156 / Avg. bwd-weight time: 11.2238 / Avg. bwd-input time: 9.1095 / Avg. batch time: 559.4635 (ms) / GPU bubble ratio: 21.79%
[rank3]:2026-01-03 15:08:11,788 -  step: 100  loss: -4.0000  grad_norm: 46.5242  memory: 49.97GiB(35.74%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank1]:2026-01-03 15:08:11,759 - Avg. fwd time: 8.0047 / Avg. bwd-weight time: 12.7532 / Avg. bwd-input time: 10.3676 / Avg. batch time: 577.2179 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:08:11,790 -  step: 100  loss: -4.0000  grad_norm: 46.5242  memory: 52.63GiB(37.64%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank2]:2026-01-03 15:08:11,752 - Avg. fwd time: 7.0495 / Avg. bwd-weight time: 11.3017 / Avg. bwd-input time: 9.1573 / Avg. batch time: 558.1510 (ms) / GPU bubble ratio: 21.14%
[rank2]:2026-01-03 15:08:11,788 -  step: 100  loss: -4.0000  grad_norm: 46.5242  memory: 46.44GiB(33.21%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank0]:2026-01-03 15:08:11,742 - Avg. fwd time: 7.8797 / Avg. full-bwd time: 23.0660 (Avg. bwd-weight time: 15.1541 / Avg. bwd-input time: 11.5809) / Avg. batch time: 582.5868 (ms) / GPU bubble ratio: 9.97%
[rank0]:2026-01-03 15:08:11,798 -  step: 100  loss:  4.2964  grad_norm: 46.5242  memory: 63.64GiB(45.52%)  tps: 6,811  tflops: 317.67  mfu: 32.12%
[rank3]:2026-01-03 15:08:12,121 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1508_step100_rank3.svg
[rank3]:			> Batch Time: 589.06 ms, GPU Bubble Ratio: 10.48%, 15.11%, 24.87%, 25.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-6-30ms      | [S0,MB3,F]  35-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  61-6-68ms      | [S7,MB0,F]  80-10-90ms     | [S7,MB0,BI] 92-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-156ms   | [S7,MB2,F]  156-8-164ms    | [S7,MB2,BI] 166-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-201ms    | [S7,MB3,BI] 203-11-214ms   | [S7,MB3,BW] 214-15-230ms   | [S0,MB7,F]  230-7-237ms    | [S0,MB0,B]  247-22-270ms   | [S7,MB4,F]  270-7-278ms    | [S7,MB4,BI] 280-11-291ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-330ms   | [S7,MB5,F]  330-8-338ms    | [S7,MB5,BI] 341-11-352ms   | [S7,MB5,BW] 353-15-368ms   | [S0,MB2,B]  369-23-392ms   | [S7,MB6,F]  393-8-402ms    | [S7,MB6,BI] 404-11-415ms   | [S7,MB6,BW] 416-15-431ms   | [S0,MB3,B]  432-23-455ms   | [S7,MB7,F]  455-8-463ms    | [S7,MB7,BI] 466-11-477ms   | [S7,MB7,BW] 477-15-493ms   | [S0,MB4,B]  495-23-518ms   | [S0,MB5,B]  519-23-542ms   | [S0,MB6,B]  542-23-565ms   | [S0,MB7,B]  566-23-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 99-11-110ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 135-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 172-11-183ms   | [S1,MB6,F]  183-8-192ms    | [S1,MB0,BI] 199-11-211ms   | [S1,MB0,BW] 211-14-225ms   | [S6,MB4,F]  226-6-232ms    | [S6,MB3,BI] 233-9-242ms    | [S6,MB3,BW] 242-11-253ms   | [S1,MB7,F]  253-8-262ms    | [S1,MB1,BI] 277-11-289ms   | [S1,MB1,BW] 289-14-303ms   | [S6,MB5,F]  303-6-310ms    | [S6,MB4,BI] 310-9-320ms    | [S6,MB4,BW] 320-11-331ms   | [S1,MB2,BI] 338-11-349ms   | [S1,MB2,BW] 350-14-364ms   | [S6,MB6,F]  364-6-371ms    | [S6,MB5,BI] 371-9-380ms    | [S6,MB5,BW] 381-11-392ms   | [S1,MB3,BI] 401-11-412ms   | [S1,MB3,BW] 412-14-427ms   | [S6,MB7,F]  427-6-434ms    | [S6,MB6,BI] 434-9-443ms    | [S6,MB6,BW] 443-11-454ms   | [S1,MB4,BI] 462-11-474ms   | [S6,MB7,BI] 474-9-483ms    | [S1,MB5,BI] 483-11-495ms   | [S1,MB4,BW] 495-14-509ms   | [S1,MB6,BI] 509-11-521ms   | [S1,MB5,BW] 521-14-535ms   | [S1,MB7,BI] 535-11-547ms   | [S1,MB6,BW] 547-14-561ms   | [S6,MB7,BW] 561-11-573ms   | [S1,MB7,BW] 575-14-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-87ms      | [S5,MB0,BI] 98-9-108ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-126ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 144-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 181-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 242-9-251ms    | [S2,MB1,BW] 251-11-262ms   | [S5,MB5,F]  262-6-269ms    | [S5,MB3,BI] 269-9-279ms    | [S5,MB3,BW] 279-11-290ms   | [S2,MB7,F]  290-6-297ms    | [S2,MB2,BI] 319-9-328ms    | [S2,MB2,BW] 329-11-340ms   | [S5,MB6,F]  340-6-347ms    | [S5,MB4,BI] 347-9-356ms    | [S5,MB4,BW] 356-11-368ms   | [S2,MB3,BI] 380-9-389ms    | [S2,MB3,BW] 390-11-401ms   | [S5,MB7,F]  401-6-408ms    | [S5,MB5,BI] 408-9-417ms    | [S5,MB5,BW] 417-11-429ms   | [S2,MB4,BI] 443-9-452ms    | [S5,MB6,BI] 452-9-461ms    | [S2,MB5,BI] 461-9-471ms    | [S5,MB7,BI] 483-9-492ms    | [S2,MB6,BI] 492-9-501ms    | [S2,MB4,BW] 501-11-513ms   | [S2,MB7,BI] 513-9-522ms    | [S2,MB5,BW] 522-11-534ms   | [S5,MB6,BW] 534-11-545ms   | [S5,MB7,BW] 545-11-557ms   | [S2,MB6,BW] 558-11-570ms   | [S2,MB7,BW] 570-11-581ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  54-6-60ms      | [S3,MB2,F]  63-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-117ms    | [S4,MB0,BW] 117-11-128ms   | [S3,MB4,F]  128-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-171ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-229ms   | [S4,MB5,F]  229-6-236ms    | [S4,MB2,BI] 236-9-245ms    | [S4,MB2,BW] 245-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 278-9-288ms    | [S3,MB2,BW] 288-11-299ms   | [S4,MB6,F]  299-6-306ms    | [S4,MB3,BI] 306-9-315ms    | [S4,MB3,BW] 315-11-327ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 356-9-365ms    | [S3,MB3,BW] 365-11-377ms   | [S4,MB7,F]  377-6-384ms    | [S4,MB4,BI] 384-9-393ms    | [S4,MB4,BW] 393-11-404ms   | [S3,MB4,BI] 417-9-426ms    | [S4,MB5,BI] 426-9-435ms    | [S3,MB5,BI] 435-9-445ms    | [S4,MB6,BI] 461-9-470ms    | [S3,MB6,BI] 470-9-480ms    | [S4,MB7,BI] 492-9-501ms    | [S3,MB7,BI] 501-9-510ms    | [S3,MB4,BW] 510-11-522ms   | [S4,MB5,BW] 522-11-533ms   | [S4,MB6,BW] 533-11-544ms   | [S4,MB7,BW] 544-11-556ms   | [S3,MB5,BW] 557-11-569ms   | [S3,MB6,BW] 568-11-580ms   | [S3,MB7,BW] 580-11-591ms  
[rank0]:2026-01-03 15:10:09,863 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:10:12,301 - Avg. fwd time: 7.8715 / Avg. full-bwd time: 23.0934 (Avg. bwd-weight time: 15.1526 / Avg. bwd-input time: 11.5876) / Avg. batch time: 582.9679 (ms) / GPU bubble ratio: 10.01%
[rank1]:2026-01-03 15:10:12,318 - Avg. fwd time: 7.9922 / Avg. bwd-weight time: 12.7557 / Avg. bwd-input time: 10.3758 / Avg. batch time: 577.5514 (ms) / GPU bubble ratio: 13.78%
[rank1]:2026-01-03 15:10:12,349 -  step: 150  loss: -4.0000  grad_norm: 22.2568  memory: 52.63GiB(37.64%)  tps: 6,795  tflops: 316.92  mfu: 32.04%
[rank3]:2026-01-03 15:10:12,320 - Avg. fwd time: 7.0067 / Avg. bwd-weight time: 11.2277 / Avg. bwd-input time: 9.1156 / Avg. batch time: 559.3248 (ms) / GPU bubble ratio: 21.76%
[rank3]:2026-01-03 15:10:12,346 -  step: 150  loss: -4.0000  grad_norm: 22.2568  memory: 49.97GiB(35.74%)  tps: 6,795  tflops: 316.92  mfu: 32.04%
[rank2]:2026-01-03 15:10:12,309 - Avg. fwd time: 7.0448 / Avg. bwd-weight time: 11.3087 / Avg. bwd-input time: 9.1678 / Avg. batch time: 558.4843 (ms) / GPU bubble ratio: 21.15%
[rank2]:2026-01-03 15:10:12,346 -  step: 150  loss: -4.0000  grad_norm: 22.2568  memory: 46.44GiB(33.21%)  tps: 6,795  tflops: 316.92  mfu: 32.04%
[rank0]:2026-01-03 15:10:12,356 -  step: 150  loss:  1.9473  grad_norm: 22.2568  memory: 63.64GiB(45.52%)  tps: 6,795  tflops: 316.92  mfu: 32.04%
[rank0]:2026-01-03 15:12:10,038 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-03 15:12:12,479 - Avg. fwd time: 7.9837 / Avg. bwd-weight time: 12.7555 / Avg. bwd-input time: 10.3805 / Avg. batch time: 577.2514 (ms) / GPU bubble ratio: 13.74%
[rank0]:2026-01-03 15:12:12,463 - Avg. fwd time: 7.8653 / Avg. full-bwd time: 23.1054 (Avg. bwd-weight time: 15.1476 / Avg. bwd-input time: 11.5893) / Avg. batch time: 582.6592 (ms) / GPU bubble ratio: 9.97%
[rank2]:2026-01-03 15:12:12,471 - Avg. fwd time: 7.0390 / Avg. bwd-weight time: 11.3106 / Avg. bwd-input time: 9.1732 / Avg. batch time: 558.1780 (ms) / GPU bubble ratio: 21.11%
[rank3]:2026-01-03 15:12:12,483 - Avg. fwd time: 7.0000 / Avg. bwd-weight time: 11.2291 / Avg. bwd-input time: 9.1199 / Avg. batch time: 559.1365 (ms) / GPU bubble ratio: 21.74%
[rank3]:2026-01-03 15:12:12,509 -  step: 200  loss: -4.0000  grad_norm:  8.5519  memory: 49.97GiB(35.74%)  tps: 6,817  tflops: 317.97  mfu: 32.15%
[rank1]:2026-01-03 15:12:12,511 -  step: 200  loss: -4.0000  grad_norm:  8.5519  memory: 52.63GiB(37.64%)  tps: 6,817  tflops: 317.97  mfu: 32.15%
[rank0]:2026-01-03 15:12:12,519 -  step: 200  loss:  0.4918  grad_norm:  8.5519  memory: 63.64GiB(45.52%)  tps: 6,817  tflops: 317.97  mfu: 32.15%
[rank2]:2026-01-03 15:12:12,509 -  step: 200  loss: -4.0000  grad_norm:  8.5519  memory: 46.44GiB(33.21%)  tps: 6,817  tflops: 317.97  mfu: 32.15%
[rank3]:2026-01-03 15:12:12,829 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1512_step200_rank3.svg
[rank3]:			> Batch Time: 587.02 ms, GPU Bubble Ratio: 10.60%, 14.94%, 24.75%, 25.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-6-31ms      | [S0,MB3,F]  35-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-68ms      | [S7,MB0,F]  80-10-90ms     | [S7,MB0,BI] 92-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-155ms   | [S7,MB2,F]  155-8-163ms    | [S7,MB2,BI] 165-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-200ms    | [S7,MB3,BI] 203-11-214ms   | [S7,MB3,BW] 214-15-229ms   | [S0,MB7,F]  230-7-237ms    | [S0,MB0,B]  247-22-270ms   | [S7,MB4,F]  270-7-278ms    | [S7,MB4,BI] 280-11-291ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-330ms   | [S7,MB5,F]  330-8-339ms    | [S7,MB5,BI] 341-11-352ms   | [S7,MB5,BW] 352-15-368ms   | [S0,MB2,B]  368-23-391ms   | [S7,MB6,F]  392-8-400ms    | [S7,MB6,BI] 402-11-414ms   | [S7,MB6,BW] 414-15-429ms   | [S0,MB3,B]  430-23-453ms   | [S7,MB7,F]  453-8-461ms    | [S7,MB7,BI] 463-11-475ms   | [S7,MB7,BW] 475-15-490ms   | [S0,MB4,B]  493-23-516ms   | [S0,MB5,B]  517-23-540ms   | [S0,MB6,B]  540-23-563ms   | [S0,MB7,B]  564-23-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 98-11-110ms    | [S6,MB2,F]  109-6-116ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-182ms   | [S1,MB6,F]  182-8-191ms    | [S1,MB0,BI] 199-11-210ms   | [S1,MB0,BW] 210-14-225ms   | [S6,MB4,F]  225-6-232ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 241-11-253ms   | [S1,MB7,F]  253-8-261ms    | [S1,MB1,BI] 276-11-288ms   | [S1,MB1,BW] 288-14-302ms   | [S6,MB5,F]  302-6-309ms    | [S6,MB4,BI] 309-9-318ms    | [S6,MB4,BW] 318-11-330ms   | [S1,MB2,BI] 337-11-348ms   | [S1,MB2,BW] 348-14-363ms   | [S6,MB6,F]  363-6-370ms    | [S6,MB5,BI] 370-9-379ms    | [S6,MB5,BW] 379-11-391ms   | [S1,MB3,BI] 398-11-410ms   | [S1,MB3,BW] 410-14-424ms   | [S6,MB7,F]  424-6-431ms    | [S6,MB6,BI] 431-9-441ms    | [S6,MB6,BW] 441-11-452ms   | [S1,MB4,BI] 460-11-471ms   | [S6,MB7,BI] 471-9-481ms    | [S1,MB5,BI] 481-11-492ms   | [S1,MB4,BW] 492-14-507ms   | [S1,MB6,BI] 507-11-518ms   | [S1,MB5,BW] 519-14-533ms   | [S1,MB7,BI] 533-11-544ms   | [S1,MB6,BW] 545-14-559ms   | [S6,MB7,BW] 559-11-570ms   | [S1,MB7,BW] 572-14-587ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-44ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-62ms      | [S5,MB1,F]  63-6-69ms      | [S2,MB4,F]  73-6-80ms      | [S5,MB2,F]  80-6-87ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 107-11-119ms   | [S5,MB3,F]  118-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 143-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 180-11-191ms   | [S5,MB4,F]  192-6-198ms    | [S5,MB2,BI] 198-9-208ms    | [S5,MB2,BW] 208-11-219ms   | [S2,MB6,F]  219-6-226ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 250-11-262ms   | [S5,MB5,F]  262-6-268ms    | [S5,MB3,BI] 269-9-278ms    | [S5,MB3,BW] 278-11-289ms   | [S2,MB7,F]  289-6-296ms    | [S2,MB2,BI] 318-9-327ms    | [S2,MB2,BW] 328-11-339ms   | [S5,MB6,F]  339-6-346ms    | [S5,MB4,BI] 346-9-355ms    | [S5,MB4,BW] 355-11-367ms   | [S2,MB3,BI] 379-9-388ms    | [S2,MB3,BW] 388-11-400ms   | [S5,MB7,F]  400-6-406ms    | [S5,MB5,BI] 406-9-416ms    | [S5,MB5,BW] 416-11-427ms   | [S2,MB4,BI] 440-9-450ms    | [S5,MB6,BI] 450-9-459ms    | [S2,MB5,BI] 459-9-468ms    | [S5,MB7,BI] 480-9-490ms    | [S2,MB6,BI] 490-9-499ms    | [S2,MB4,BW] 499-11-511ms   | [S2,MB7,BI] 511-9-520ms    | [S2,MB5,BW] 520-11-531ms   | [S5,MB6,BW] 531-11-543ms   | [S5,MB7,BW] 543-11-554ms   | [S2,MB6,BW] 556-11-568ms   | [S2,MB7,BW] 567-11-579ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  46-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 116-11-128ms   | [S3,MB4,F]  127-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-170ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-228ms   | [S4,MB5,F]  228-6-235ms    | [S4,MB2,BI] 235-9-244ms    | [S4,MB2,BW] 244-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 278-9-287ms    | [S3,MB2,BW] 287-11-298ms   | [S4,MB6,F]  298-6-305ms    | [S4,MB3,BI] 305-9-315ms    | [S4,MB3,BW] 315-11-326ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 355-9-364ms    | [S3,MB3,BW] 364-11-375ms   | [S4,MB7,F]  376-6-382ms    | [S4,MB4,BI] 382-9-392ms    | [S4,MB4,BW] 392-11-403ms   | [S3,MB4,BI] 416-9-425ms    | [S4,MB5,BI] 425-9-434ms    | [S3,MB5,BI] 434-9-443ms    | [S4,MB6,BI] 459-9-468ms    | [S3,MB6,BI] 468-9-477ms    | [S4,MB7,BI] 489-9-499ms    | [S3,MB7,BI] 499-9-508ms    | [S3,MB4,BW] 508-11-519ms   | [S4,MB5,BW] 519-11-530ms   | [S4,MB6,BW] 530-11-542ms   | [S4,MB7,BW] 542-11-553ms   | [S3,MB5,BW] 555-11-566ms   | [S3,MB6,BW] 566-11-578ms   | [S3,MB7,BW] 577-11-589ms  
[rank0]:2026-01-03 15:14:10,601 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:14:13,027 - Avg. fwd time: 7.8627 / Avg. full-bwd time: 23.1152 (Avg. bwd-weight time: 15.1460 / Avg. bwd-input time: 11.5917) / Avg. batch time: 582.8992 (ms) / GPU bubble ratio: 10.00%
[rank1]:2026-01-03 15:14:13,045 - Avg. fwd time: 7.9816 / Avg. bwd-weight time: 12.7554 / Avg. bwd-input time: 10.3857 / Avg. batch time: 577.3969 (ms) / GPU bubble ratio: 13.76%
[rank3]:2026-01-03 15:14:13,048 - Avg. fwd time: 6.9980 / Avg. bwd-weight time: 11.2291 / Avg. bwd-input time: 9.1242 / Avg. batch time: 559.0667 (ms) / GPU bubble ratio: 21.72%
[rank3]:2026-01-03 15:14:13,074 -  step: 250  loss: -4.0000  grad_norm:  0.6128  memory: 49.97GiB(35.74%)  tps: 6,795  tflops: 316.91  mfu: 32.04%
[rank2]:2026-01-03 15:14:13,037 - Avg. fwd time: 7.0378 / Avg. bwd-weight time: 11.3117 / Avg. bwd-input time: 9.1789 / Avg. batch time: 558.3190 (ms) / GPU bubble ratio: 21.11%
[rank2]:2026-01-03 15:14:13,074 -  step: 250  loss: -4.0000  grad_norm:  0.6128  memory: 46.44GiB(33.21%)  tps: 6,795  tflops: 316.91  mfu: 32.04%
[rank0]:2026-01-03 15:14:13,084 -  step: 250  loss:  0.2501  grad_norm:  0.6128  memory: 63.64GiB(45.52%)  tps: 6,795  tflops: 316.91  mfu: 32.04%
[rank1]:2026-01-03 15:14:13,076 -  step: 250  loss: -4.0000  grad_norm:  0.6128  memory: 52.63GiB(37.64%)  tps: 6,795  tflops: 316.91  mfu: 32.04%
[rank0]:2026-01-03 15:16:10,832 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:16:13,268 - Avg. fwd time: 7.8610 / Avg. full-bwd time: 23.1221 (Avg. bwd-weight time: 15.1435 / Avg. bwd-input time: 11.5912) / Avg. batch time: 582.7920 (ms) / GPU bubble ratio: 9.98%
[rank2]:2026-01-03 15:16:13,278 - Avg. fwd time: 7.0386 / Avg. bwd-weight time: 11.3122 / Avg. bwd-input time: 9.1819 / Avg. batch time: 558.1569 (ms) / GPU bubble ratio: 21.08%
[rank1]:2026-01-03 15:16:13,287 - Avg. fwd time: 7.9813 / Avg. bwd-weight time: 12.7553 / Avg. bwd-input time: 10.3893 / Avg. batch time: 577.2477 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 15:16:13,317 -  step: 300  loss: -4.0000  grad_norm:  0.5632  memory: 52.63GiB(37.64%)  tps: 6,813  tflops: 317.76  mfu: 32.13%
[rank3]:2026-01-03 15:16:13,289 - Avg. fwd time: 6.9987 / Avg. bwd-weight time: 11.2292 / Avg. bwd-input time: 9.1260 / Avg. batch time: 558.9870 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 15:16:13,314 -  step: 300  loss: -4.0000  grad_norm:  0.5632  memory: 49.97GiB(35.74%)  tps: 6,813  tflops: 317.76  mfu: 32.13%
[rank0]:2026-01-03 15:16:13,325 -  step: 300  loss:  0.2757  grad_norm:  0.5632  memory: 63.64GiB(45.52%)  tps: 6,813  tflops: 317.76  mfu: 32.13%
[rank2]:2026-01-03 15:16:13,315 -  step: 300  loss: -4.0000  grad_norm:  0.5632  memory: 46.44GiB(33.21%)  tps: 6,813  tflops: 317.76  mfu: 32.13%
[rank3]:2026-01-03 15:16:13,632 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1516_step300_rank3.svg
[rank3]:			> Batch Time: 587.12 ms, GPU Bubble Ratio: 10.51%, 14.92%, 24.76%, 25.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-6-16ms       | [S0,MB2,F]  24-6-31ms      | [S0,MB3,F]  36-6-43ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-69ms      | [S7,MB0,F]  80-10-91ms     | [S7,MB0,BI] 92-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-156ms   | [S7,MB2,F]  156-7-163ms    | [S7,MB2,BI] 166-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-200ms    | [S7,MB3,BI] 202-11-214ms   | [S7,MB3,BW] 214-15-229ms   | [S0,MB7,F]  230-7-237ms    | [S0,MB0,B]  247-23-270ms   | [S7,MB4,F]  270-7-278ms    | [S7,MB4,BI] 280-11-291ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-330ms   | [S7,MB5,F]  330-8-338ms    | [S7,MB5,BI] 341-11-353ms   | [S7,MB5,BW] 353-15-368ms   | [S0,MB2,B]  368-23-392ms   | [S7,MB6,F]  392-8-400ms    | [S7,MB6,BI] 403-11-414ms   | [S7,MB6,BW] 414-15-430ms   | [S0,MB3,B]  430-23-453ms   | [S7,MB7,F]  453-8-462ms    | [S7,MB7,BI] 464-11-476ms   | [S7,MB7,BW] 476-15-491ms   | [S0,MB4,B]  494-23-517ms   | [S0,MB5,B]  517-23-540ms   | [S0,MB6,B]  541-23-564ms   | [S0,MB7,B]  564-23-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 98-11-110ms    | [S6,MB2,F]  110-6-116ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-182ms   | [S1,MB6,F]  182-8-191ms    | [S1,MB0,BI] 199-11-210ms   | [S1,MB0,BW] 210-14-224ms   | [S6,MB4,F]  225-6-231ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 241-11-252ms   | [S1,MB7,F]  252-8-261ms    | [S1,MB1,BI] 276-11-288ms   | [S1,MB1,BW] 288-14-302ms   | [S6,MB5,F]  302-6-309ms    | [S6,MB4,BI] 309-9-318ms    | [S6,MB4,BW] 318-11-330ms   | [S1,MB2,BI] 337-11-349ms   | [S1,MB2,BW] 349-14-363ms   | [S6,MB6,F]  363-6-370ms    | [S6,MB5,BI] 370-9-379ms    | [S6,MB5,BW] 379-11-391ms   | [S1,MB3,BI] 399-11-411ms   | [S1,MB3,BW] 411-14-425ms   | [S6,MB7,F]  425-6-432ms    | [S6,MB6,BI] 432-9-441ms    | [S6,MB6,BW] 441-11-453ms   | [S1,MB4,BI] 460-11-472ms   | [S6,MB7,BI] 472-9-481ms    | [S1,MB5,BI] 482-11-493ms   | [S1,MB4,BW] 493-14-507ms   | [S1,MB6,BI] 508-11-519ms   | [S1,MB5,BW] 519-14-534ms   | [S1,MB7,BI] 534-11-546ms   | [S1,MB6,BW] 545-14-560ms   | [S6,MB7,BW] 560-11-571ms   | [S1,MB7,BW] 573-14-587ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-69ms      | [S2,MB4,F]  74-6-80ms      | [S5,MB2,F]  80-6-87ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 107-11-119ms   | [S5,MB3,F]  118-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 143-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 180-11-191ms   | [S5,MB4,F]  191-6-198ms    | [S5,MB2,BI] 198-9-208ms    | [S5,MB2,BW] 208-11-219ms   | [S2,MB6,F]  219-6-226ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 250-11-261ms   | [S5,MB5,F]  262-6-268ms    | [S5,MB3,BI] 268-9-278ms    | [S5,MB3,BW] 278-11-289ms   | [S2,MB7,F]  289-6-296ms    | [S2,MB2,BI] 318-9-327ms    | [S2,MB2,BW] 328-11-339ms   | [S5,MB6,F]  339-6-346ms    | [S5,MB4,BI] 346-9-355ms    | [S5,MB4,BW] 355-11-367ms   | [S2,MB3,BI] 379-9-388ms    | [S2,MB3,BW] 388-11-400ms   | [S5,MB7,F]  400-6-407ms    | [S5,MB5,BI] 407-9-416ms    | [S5,MB5,BW] 416-11-428ms   | [S2,MB4,BI] 441-9-450ms    | [S5,MB6,BI] 451-9-460ms    | [S2,MB5,BI] 460-9-469ms    | [S5,MB7,BI] 481-9-490ms    | [S2,MB6,BI] 490-9-500ms    | [S2,MB4,BW] 500-11-511ms   | [S2,MB7,BI] 511-9-520ms    | [S2,MB5,BW] 521-11-532ms   | [S5,MB6,BW] 532-11-543ms   | [S5,MB7,BW] 544-11-555ms   | [S2,MB6,BW] 557-11-568ms   | [S2,MB7,BW] 568-11-580ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 116-11-128ms   | [S3,MB4,F]  127-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-170ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 207-9-217ms    | [S3,MB1,BW] 217-11-228ms   | [S4,MB5,F]  228-6-235ms    | [S4,MB2,BI] 235-9-244ms    | [S4,MB2,BW] 244-11-256ms   | [S3,MB6,F]  256-6-262ms    | [S3,MB2,BI] 277-9-287ms    | [S3,MB2,BW] 287-11-298ms   | [S4,MB6,F]  298-6-305ms    | [S4,MB3,BI] 305-9-314ms    | [S4,MB3,BW] 314-11-326ms   | [S3,MB7,F]  326-6-332ms    | [S3,MB3,BI] 355-9-364ms    | [S3,MB3,BW] 364-11-375ms   | [S4,MB7,F]  375-6-382ms    | [S4,MB4,BI] 382-9-391ms    | [S4,MB4,BW] 391-11-403ms   | [S3,MB4,BI] 416-9-425ms    | [S4,MB5,BI] 425-9-434ms    | [S3,MB5,BI] 434-9-444ms    | [S4,MB6,BI] 460-9-469ms    | [S3,MB6,BI] 469-9-478ms    | [S4,MB7,BI] 490-9-499ms    | [S3,MB7,BI] 499-9-509ms    | [S3,MB4,BW] 509-11-520ms   | [S4,MB5,BW] 520-11-531ms   | [S4,MB6,BW] 531-11-543ms   | [S4,MB7,BW] 542-11-554ms   | [S3,MB5,BW] 556-11-567ms   | [S3,MB6,BW] 567-11-578ms   | [S3,MB7,BW] 578-11-590ms  
[rank0]:2026-01-03 15:18:11,523 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:18:13,975 - Avg. fwd time: 7.0410 / Avg. bwd-weight time: 11.3125 / Avg. bwd-input time: 9.1845 / Avg. batch time: 558.3049 (ms) / GPU bubble ratio: 21.08%
[rank3]:2026-01-03 15:18:13,986 - Avg. fwd time: 7.0007 / Avg. bwd-weight time: 11.2293 / Avg. bwd-input time: 9.1284 / Avg. batch time: 559.0033 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 15:18:14,012 -  step: 350  loss: -4.0000  grad_norm:  0.7545  memory: 49.97GiB(35.74%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank0]:2026-01-03 15:18:13,967 - Avg. fwd time: 7.8620 / Avg. full-bwd time: 23.1307 (Avg. bwd-weight time: 15.1431 / Avg. bwd-input time: 11.5918) / Avg. batch time: 583.0377 (ms) / GPU bubble ratio: 10.00%
[rank0]:2026-01-03 15:18:14,022 -  step: 350  loss:  0.3261  grad_norm:  0.7545  memory: 63.64GiB(45.52%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank1]:2026-01-03 15:18:13,984 - Avg. fwd time: 7.9828 / Avg. bwd-weight time: 12.7554 / Avg. bwd-input time: 10.3922 / Avg. batch time: 577.4113 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 15:18:14,014 -  step: 350  loss: -4.0000  grad_norm:  0.7545  memory: 52.63GiB(37.64%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank2]:2026-01-03 15:18:14,012 -  step: 350  loss: -4.0000  grad_norm:  0.7545  memory: 46.44GiB(33.21%)  tps: 6,787  tflops: 316.56  mfu: 32.01%
[rank0]:2026-01-03 15:20:11,822 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:20:14,282 - Avg. fwd time: 7.0428 / Avg. bwd-weight time: 11.3126 / Avg. bwd-input time: 9.1862 / Avg. batch time: 558.2434 (ms) / GPU bubble ratio: 21.06%
[rank3]:2026-01-03 15:20:14,293 - Avg. fwd time: 7.0021 / Avg. bwd-weight time: 11.2291 / Avg. bwd-input time: 9.1296 / Avg. batch time: 559.0125 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 15:20:14,318 -  step: 400  loss: -4.0000  grad_norm:  0.3696  memory: 49.97GiB(35.74%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank0]:2026-01-03 15:20:14,272 - Avg. fwd time: 7.8624 / Avg. full-bwd time: 23.1389 (Avg. bwd-weight time: 15.1435 / Avg. bwd-input time: 11.5918) / Avg. batch time: 582.9831 (ms) / GPU bubble ratio: 9.98%
[rank0]:2026-01-03 15:20:14,329 -  step: 400  loss:  0.2617  grad_norm:  0.3696  memory: 63.64GiB(45.52%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank1]:2026-01-03 15:20:14,291 - Avg. fwd time: 7.9840 / Avg. bwd-weight time: 12.7555 / Avg. bwd-input time: 10.3945 / Avg. batch time: 577.3655 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:20:14,321 -  step: 400  loss: -4.0000  grad_norm:  0.3696  memory: 52.63GiB(37.64%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank2]:2026-01-03 15:20:14,318 -  step: 400  loss: -4.0000  grad_norm:  0.3696  memory: 46.44GiB(33.21%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank3]:2026-01-03 15:20:14,626 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1520_step400_rank3.svg
[rank3]:			> Batch Time: 587.61 ms, GPU Bubble Ratio: 10.53%, 14.97%, 24.78%, 25.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-6-31ms      | [S0,MB3,F]  35-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-69ms      | [S7,MB0,F]  80-10-90ms     | [S7,MB0,BI] 92-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-155ms   | [S7,MB2,F]  155-8-163ms    | [S7,MB2,BI] 165-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-200ms    | [S7,MB3,BI] 202-11-214ms   | [S7,MB3,BW] 214-15-229ms   | [S0,MB7,F]  229-7-236ms    | [S0,MB0,B]  247-22-270ms   | [S7,MB4,F]  270-7-278ms    | [S7,MB4,BI] 280-11-292ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-330ms   | [S7,MB5,F]  330-8-338ms    | [S7,MB5,BI] 340-11-352ms   | [S7,MB5,BW] 352-15-367ms   | [S0,MB2,B]  368-23-391ms   | [S7,MB6,F]  391-8-400ms    | [S7,MB6,BI] 402-11-414ms   | [S7,MB6,BW] 414-15-429ms   | [S0,MB3,B]  430-23-453ms   | [S7,MB7,F]  453-8-462ms    | [S7,MB7,BI] 464-11-475ms   | [S7,MB7,BW] 476-15-491ms   | [S0,MB4,B]  493-23-516ms   | [S0,MB5,B]  517-23-540ms   | [S0,MB6,B]  540-23-563ms   | [S0,MB7,B]  564-23-587ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 98-11-110ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-183ms   | [S1,MB6,F]  183-8-191ms    | [S1,MB0,BI] 199-11-210ms   | [S1,MB0,BW] 211-14-225ms   | [S6,MB4,F]  225-6-232ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 241-11-253ms   | [S1,MB7,F]  253-8-261ms    | [S1,MB1,BI] 276-11-288ms   | [S1,MB1,BW] 288-14-302ms   | [S6,MB5,F]  302-6-309ms    | [S6,MB4,BI] 309-9-319ms    | [S6,MB4,BW] 319-11-330ms   | [S1,MB2,BI] 337-11-348ms   | [S1,MB2,BW] 349-14-363ms   | [S6,MB6,F]  363-6-370ms    | [S6,MB5,BI] 370-9-379ms    | [S6,MB5,BW] 379-11-391ms   | [S1,MB3,BI] 399-11-411ms   | [S1,MB3,BW] 411-14-425ms   | [S6,MB7,F]  425-6-432ms    | [S6,MB6,BI] 432-9-441ms    | [S6,MB6,BW] 441-11-453ms   | [S1,MB4,BI] 460-11-472ms   | [S6,MB7,BI] 472-9-481ms    | [S1,MB5,BI] 481-11-493ms   | [S1,MB4,BW] 493-14-507ms   | [S1,MB6,BI] 507-11-519ms   | [S1,MB5,BW] 519-14-533ms   | [S1,MB7,BI] 533-11-545ms   | [S1,MB6,BW] 545-14-560ms   | [S6,MB7,BW] 560-11-571ms   | [S1,MB7,BW] 573-14-587ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-87ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 107-11-119ms   | [S5,MB3,F]  119-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 143-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 180-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-219ms   | [S2,MB6,F]  219-6-226ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 250-11-262ms   | [S5,MB5,F]  262-6-269ms    | [S5,MB3,BI] 269-9-278ms    | [S5,MB3,BW] 278-11-290ms   | [S2,MB7,F]  290-6-297ms    | [S2,MB2,BI] 318-9-328ms    | [S2,MB2,BW] 328-11-339ms   | [S5,MB6,F]  339-6-346ms    | [S5,MB4,BI] 346-9-355ms    | [S5,MB4,BW] 355-11-367ms   | [S2,MB3,BI] 379-9-388ms    | [S2,MB3,BW] 388-11-400ms   | [S5,MB7,F]  400-6-407ms    | [S5,MB5,BI] 407-9-416ms    | [S5,MB5,BW] 416-11-428ms   | [S2,MB4,BI] 441-9-450ms    | [S5,MB6,BI] 450-9-459ms    | [S2,MB5,BI] 460-9-469ms    | [S5,MB7,BI] 481-9-490ms    | [S2,MB6,BI] 490-9-499ms    | [S2,MB4,BW] 500-11-511ms   | [S2,MB7,BI] 511-9-520ms    | [S2,MB5,BW] 520-11-532ms   | [S5,MB6,BW] 532-11-543ms   | [S5,MB7,BW] 543-11-555ms   | [S2,MB6,BW] 557-11-568ms   | [S2,MB7,BW] 568-11-579ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 116-11-128ms   | [S3,MB4,F]  128-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-170ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-228ms   | [S4,MB5,F]  228-6-235ms    | [S4,MB2,BI] 235-9-245ms    | [S4,MB2,BW] 245-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 278-9-287ms    | [S3,MB2,BW] 287-11-299ms   | [S4,MB6,F]  298-6-305ms    | [S4,MB3,BI] 305-9-315ms    | [S4,MB3,BW] 315-11-326ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 355-9-364ms    | [S3,MB3,BW] 364-11-376ms   | [S4,MB7,F]  376-6-382ms    | [S4,MB4,BI] 383-9-392ms    | [S4,MB4,BW] 392-11-403ms   | [S3,MB4,BI] 416-9-425ms    | [S4,MB5,BI] 425-9-434ms    | [S3,MB5,BI] 434-9-444ms    | [S4,MB6,BI] 459-9-469ms    | [S3,MB6,BI] 468-9-478ms    | [S4,MB7,BI] 490-9-499ms    | [S3,MB7,BI] 499-9-508ms    | [S3,MB4,BW] 508-11-520ms   | [S4,MB5,BW] 520-11-531ms   | [S4,MB6,BW] 531-11-542ms   | [S4,MB7,BW] 542-11-554ms   | [S3,MB5,BW] 555-11-567ms   | [S3,MB6,BW] 567-11-578ms   | [S3,MB7,BW] 578-11-589ms  
[rank0]:2026-01-03 15:22:12,416 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:22:14,867 - Avg. fwd time: 7.0434 / Avg. bwd-weight time: 11.3124 / Avg. bwd-input time: 9.1873 / Avg. batch time: 558.3478 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 15:22:14,903 -  step: 450  loss: -4.0000  grad_norm:  0.7621  memory: 46.44GiB(33.21%)  tps: 6,794  tflops: 316.86  mfu: 32.04%
[rank3]:2026-01-03 15:22:14,877 - Avg. fwd time: 7.0029 / Avg. bwd-weight time: 11.2290 / Avg. bwd-input time: 9.1307 / Avg. batch time: 559.0268 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 15:22:14,902 -  step: 450  loss: -4.0000  grad_norm:  0.7621  memory: 49.97GiB(35.74%)  tps: 6,794  tflops: 316.86  mfu: 32.04%
[rank1]:2026-01-03 15:22:14,875 - Avg. fwd time: 7.9842 / Avg. bwd-weight time: 12.7554 / Avg. bwd-input time: 10.3964 / Avg. batch time: 577.4784 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 15:22:14,905 -  step: 450  loss: -4.0000  grad_norm:  0.7621  memory: 52.63GiB(37.64%)  tps: 6,794  tflops: 316.86  mfu: 32.04%
[rank0]:2026-01-03 15:22:14,857 - Avg. fwd time: 7.8624 / Avg. full-bwd time: 23.1451 (Avg. bwd-weight time: 15.1443 / Avg. bwd-input time: 11.5922) / Avg. batch time: 583.0936 (ms) / GPU bubble ratio: 9.99%
[rank0]:2026-01-03 15:22:14,913 -  step: 450  loss:  0.2781  grad_norm:  0.7621  memory: 63.64GiB(45.52%)  tps: 6,794  tflops: 316.86  mfu: 32.04%
[rank0]:2026-01-03 15:24:12,695 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:24:15,133 - Avg. fwd time: 7.8619 / Avg. full-bwd time: 23.1485 (Avg. bwd-weight time: 15.1437 / Avg. bwd-input time: 11.5920) / Avg. batch time: 583.0295 (ms) / GPU bubble ratio: 9.98%
[rank2]:2026-01-03 15:24:15,145 - Avg. fwd time: 7.0434 / Avg. bwd-weight time: 11.3122 / Avg. bwd-input time: 9.1878 / Avg. batch time: 558.2702 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:24:15,180 -  step: 500  loss: -4.0000  grad_norm:  0.3611  memory: 46.44GiB(33.21%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank1]:2026-01-03 15:24:15,152 - Avg. fwd time: 7.9845 / Avg. bwd-weight time: 12.7553 / Avg. bwd-input time: 10.3975 / Avg. batch time: 577.4089 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:24:15,183 -  step: 500  loss: -4.0000  grad_norm:  0.3611  memory: 52.63GiB(37.64%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank3]:2026-01-03 15:24:15,155 - Avg. fwd time: 7.0031 / Avg. bwd-weight time: 11.2288 / Avg. bwd-input time: 9.1313 / Avg. batch time: 559.0111 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:24:15,180 -  step: 500  loss: -4.0000  grad_norm:  0.3611  memory: 49.97GiB(35.74%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank0]:2026-01-03 15:24:15,191 -  step: 500  loss:  0.2740  grad_norm:  0.3611  memory: 63.64GiB(45.52%)  tps: 6,811  tflops: 317.66  mfu: 32.12%
[rank3]:2026-01-03 15:24:15,487 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1524_step500_rank3.svg
[rank3]:			> Batch Time: 588.55 ms, GPU Bubble Ratio: 10.58%, 15.08%, 24.91%, 25.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-6-30ms      | [S0,MB3,F]  35-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-68ms      | [S7,MB0,F]  80-10-90ms     | [S7,MB0,BI] 92-11-103ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-126ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-155ms   | [S7,MB2,F]  155-8-163ms    | [S7,MB2,BI] 165-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-200ms    | [S7,MB3,BI] 202-11-214ms   | [S7,MB3,BW] 214-15-229ms   | [S0,MB7,F]  229-7-237ms    | [S0,MB0,B]  247-23-270ms   | [S7,MB4,F]  270-7-278ms    | [S7,MB4,BI] 280-11-292ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-330ms   | [S7,MB5,F]  331-8-339ms    | [S7,MB5,BI] 341-11-353ms   | [S7,MB5,BW] 353-15-368ms   | [S0,MB2,B]  369-23-392ms   | [S7,MB6,F]  393-8-401ms    | [S7,MB6,BI] 403-11-415ms   | [S7,MB6,BW] 415-15-431ms   | [S0,MB3,B]  431-23-454ms   | [S7,MB7,F]  454-8-463ms    | [S7,MB7,BI] 465-11-476ms   | [S7,MB7,BW] 477-15-492ms   | [S0,MB4,B]  494-23-517ms   | [S0,MB5,B]  518-23-541ms   | [S0,MB6,B]  541-23-564ms   | [S0,MB7,B]  565-23-588ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  20-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 98-11-110ms    | [S6,MB2,F]  109-6-116ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-152ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-183ms   | [S1,MB6,F]  183-8-191ms    | [S1,MB0,BI] 199-11-211ms   | [S1,MB0,BW] 211-14-225ms   | [S6,MB4,F]  225-6-232ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 241-11-253ms   | [S1,MB7,F]  253-8-261ms    | [S1,MB1,BI] 276-11-288ms   | [S1,MB1,BW] 288-14-302ms   | [S6,MB5,F]  302-6-309ms    | [S6,MB4,BI] 309-9-319ms    | [S6,MB4,BW] 319-11-330ms   | [S1,MB2,BI] 338-11-349ms   | [S1,MB2,BW] 349-14-364ms   | [S6,MB6,F]  364-6-370ms    | [S6,MB5,BI] 370-9-380ms    | [S6,MB5,BW] 380-11-391ms   | [S1,MB3,BI] 400-11-411ms   | [S1,MB3,BW] 412-14-426ms   | [S6,MB7,F]  426-6-433ms    | [S6,MB6,BI] 433-9-442ms    | [S6,MB6,BW] 442-11-454ms   | [S1,MB4,BI] 461-11-472ms   | [S6,MB7,BI] 473-9-482ms    | [S1,MB5,BI] 482-11-494ms   | [S1,MB4,BW] 494-14-508ms   | [S1,MB6,BI] 508-11-520ms   | [S1,MB5,BW] 520-14-534ms   | [S1,MB7,BI] 534-11-546ms   | [S1,MB6,BW] 546-14-561ms   | [S6,MB7,BW] 561-11-572ms   | [S1,MB7,BW] 574-14-588ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-69ms      | [S2,MB4,F]  74-6-80ms      | [S5,MB2,F]  81-6-87ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 107-11-119ms   | [S5,MB3,F]  118-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 143-11-155ms   | [S2,MB5,F]  155-6-161ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 180-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 250-11-262ms   | [S5,MB5,F]  262-6-269ms    | [S5,MB3,BI] 269-9-278ms    | [S5,MB3,BW] 278-11-290ms   | [S2,MB7,F]  290-6-297ms    | [S2,MB2,BI] 318-9-328ms    | [S2,MB2,BW] 328-11-339ms   | [S5,MB6,F]  339-6-346ms    | [S5,MB4,BI] 346-9-355ms    | [S5,MB4,BW] 355-11-367ms   | [S2,MB3,BI] 380-9-389ms    | [S2,MB3,BW] 389-11-400ms   | [S5,MB7,F]  400-6-407ms    | [S5,MB5,BI] 407-9-417ms    | [S5,MB5,BW] 417-11-428ms   | [S2,MB4,BI] 442-9-451ms    | [S5,MB6,BI] 451-9-461ms    | [S2,MB5,BI] 461-9-470ms    | [S5,MB7,BI] 482-9-491ms    | [S2,MB6,BI] 491-9-500ms    | [S2,MB4,BW] 500-11-512ms   | [S2,MB7,BI] 512-9-521ms    | [S2,MB5,BW] 521-11-533ms   | [S5,MB6,BW] 533-11-544ms   | [S5,MB7,BW] 544-11-556ms   | [S2,MB6,BW] 557-11-569ms   | [S2,MB7,BW] 569-11-580ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 116-11-128ms   | [S3,MB4,F]  127-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-170ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-228ms   | [S4,MB5,F]  229-6-235ms    | [S4,MB2,BI] 236-9-245ms    | [S4,MB2,BW] 245-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 278-9-287ms    | [S3,MB2,BW] 287-11-298ms   | [S4,MB6,F]  299-6-305ms    | [S4,MB3,BI] 306-9-315ms    | [S4,MB3,BW] 315-11-326ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 355-9-365ms    | [S3,MB3,BW] 365-11-376ms   | [S4,MB7,F]  376-6-383ms    | [S4,MB4,BI] 383-9-392ms    | [S4,MB4,BW] 392-11-403ms   | [S3,MB4,BI] 416-9-426ms    | [S4,MB5,BI] 426-9-435ms    | [S3,MB5,BI] 435-9-444ms    | [S4,MB6,BI] 460-9-469ms    | [S3,MB6,BI] 469-9-479ms    | [S4,MB7,BI] 491-9-500ms    | [S3,MB7,BI] 500-9-509ms    | [S3,MB4,BW] 509-11-520ms   | [S4,MB5,BW] 520-11-532ms   | [S4,MB6,BW] 532-11-543ms   | [S4,MB7,BW] 543-11-554ms   | [S3,MB5,BW] 556-11-567ms   | [S3,MB6,BW] 567-11-579ms   | [S3,MB7,BW] 579-11-590ms  
[rank0]:2026-01-03 15:26:12,952 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:26:15,389 - Avg. fwd time: 7.0434 / Avg. bwd-weight time: 11.3121 / Avg. bwd-input time: 9.1887 / Avg. batch time: 558.3020 (ms) / GPU bubble ratio: 21.06%
[rank3]:2026-01-03 15:26:15,398 - Avg. fwd time: 7.0030 / Avg. bwd-weight time: 11.2283 / Avg. bwd-input time: 9.1315 / Avg. batch time: 558.9713 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:26:15,424 -  step: 550  loss: -4.0000  grad_norm:  0.3091  memory: 49.97GiB(35.74%)  tps: 6,813  tflops: 317.75  mfu: 32.13%
[rank1]:2026-01-03 15:26:15,397 - Avg. fwd time: 7.9842 / Avg. bwd-weight time: 12.7550 / Avg. bwd-input time: 10.3985 / Avg. batch time: 577.4459 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:26:15,426 -  step: 550  loss: -4.0000  grad_norm:  0.3091  memory: 52.63GiB(37.64%)  tps: 6,813  tflops: 317.75  mfu: 32.13%
[rank0]:2026-01-03 15:26:15,379 - Avg. fwd time: 7.8607 / Avg. full-bwd time: 23.1524 (Avg. bwd-weight time: 15.1428 / Avg. bwd-input time: 11.5910) / Avg. batch time: 582.9656 (ms) / GPU bubble ratio: 9.97%
[rank0]:2026-01-03 15:26:15,434 -  step: 550  loss:  0.1624  grad_norm:  0.3091  memory: 63.64GiB(45.52%)  tps: 6,813  tflops: 317.75  mfu: 32.13%
[rank2]:2026-01-03 15:26:15,424 -  step: 550  loss: -4.0000  grad_norm:  0.3091  memory: 46.44GiB(33.21%)  tps: 6,813  tflops: 317.75  mfu: 32.13%
[rank0]:2026-01-03 15:28:13,890 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:28:16,379 - Avg. fwd time: 7.0486 / Avg. bwd-weight time: 11.3134 / Avg. bwd-input time: 9.1924 / Avg. batch time: 558.4420 (ms) / GPU bubble ratio: 21.05%
[rank2]:2026-01-03 15:28:16,415 -  step: 600  loss: -4.0000  grad_norm:  0.7185  memory: 46.44GiB(33.21%)  tps: 6,771  tflops: 315.79  mfu: 31.93%
[rank3]:2026-01-03 15:28:16,389 - Avg. fwd time: 7.0079 / Avg. bwd-weight time: 11.2293 / Avg. bwd-input time: 9.1346 / Avg. batch time: 559.1526 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:28:16,415 -  step: 600  loss: -4.0000  grad_norm:  0.7185  memory: 49.97GiB(35.74%)  tps: 6,771  tflops: 315.79  mfu: 31.93%
[rank1]:2026-01-03 15:28:16,386 - Avg. fwd time: 7.9902 / Avg. bwd-weight time: 12.7568 / Avg. bwd-input time: 10.4029 / Avg. batch time: 577.6010 (ms) / GPU bubble ratio: 13.71%
[rank1]:2026-01-03 15:28:16,417 -  step: 600  loss: -4.0000  grad_norm:  0.7185  memory: 52.63GiB(37.64%)  tps: 6,771  tflops: 315.79  mfu: 31.93%
[rank0]:2026-01-03 15:28:16,369 - Avg. fwd time: 7.8659 / Avg. full-bwd time: 23.1594 (Avg. bwd-weight time: 15.1467 / Avg. bwd-input time: 11.5960) / Avg. batch time: 583.2190 (ms) / GPU bubble ratio: 9.97%
[rank0]:2026-01-03 15:28:16,425 -  step: 600  loss:  0.4060  grad_norm:  0.7185  memory: 63.64GiB(45.52%)  tps: 6,771  tflops: 315.79  mfu: 31.93%
[rank3]:2026-01-03 15:28:16,732 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1528_step600_rank3.svg
[rank3]:			> Batch Time: 596.20 ms, GPU Bubble Ratio: 10.97%, 15.47%, 25.25%, 25.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  27-7-34ms      | [S0,MB3,F]  39-7-46ms      | [S0,MB4,F]  48-7-55ms      | [S0,MB5,F]  57-7-64ms      | [S0,MB6,F]  66-7-73ms      | [S7,MB0,F]  84-10-95ms     | [S7,MB0,BI] 96-11-108ms    | [S7,MB0,BW] 108-15-123ms   | [S7,MB1,F]  123-8-131ms    | [S7,MB1,BI] 133-11-144ms   | [S7,MB1,BW] 145-15-160ms   | [S7,MB2,F]  160-8-168ms    | [S7,MB2,BI] 170-11-182ms   | [S7,MB2,BW] 182-15-197ms   | [S7,MB3,F]  197-8-206ms    | [S7,MB3,BI] 208-11-219ms   | [S7,MB3,BW] 220-15-235ms   | [S0,MB7,F]  235-7-242ms    | [S0,MB0,B]  253-23-276ms   | [S7,MB4,F]  276-8-284ms    | [S7,MB4,BI] 286-11-298ms   | [S7,MB4,BW] 298-15-313ms   | [S0,MB1,B]  314-23-337ms   | [S7,MB5,F]  337-8-346ms    | [S7,MB5,BI] 348-11-360ms   | [S7,MB5,BW] 360-15-375ms   | [S0,MB2,B]  376-23-399ms   | [S7,MB6,F]  400-8-408ms    | [S7,MB6,BI] 410-11-422ms   | [S7,MB6,BW] 422-15-438ms   | [S0,MB3,B]  438-23-462ms   | [S7,MB7,F]  462-8-470ms    | [S7,MB7,BI] 472-11-484ms   | [S7,MB7,BW] 484-15-500ms   | [S0,MB4,B]  502-23-525ms   | [S0,MB5,B]  526-23-549ms   | [S0,MB6,B]  549-23-572ms   | [S0,MB7,B]  573-23-596ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  57-8-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-82ms      | [S6,MB0,BI] 90-9-99ms      | [S6,MB0,BW] 100-11-111ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-136ms    | [S6,MB1,BW] 136-11-147ms   | [S6,MB3,F]  147-6-154ms    | [S6,MB2,BI] 164-9-173ms    | [S6,MB2,BW] 173-11-184ms   | [S1,MB6,F]  185-8-193ms    | [S1,MB0,BI] 201-11-213ms   | [S1,MB0,BW] 213-14-227ms   | [S6,MB4,F]  227-6-234ms    | [S6,MB3,BI] 234-9-244ms    | [S6,MB3,BW] 244-11-255ms   | [S1,MB7,F]  255-8-264ms    | [S1,MB1,BI] 279-11-291ms   | [S1,MB1,BW] 291-14-306ms   | [S6,MB5,F]  305-6-312ms    | [S6,MB4,BI] 312-9-322ms    | [S6,MB4,BW] 322-11-333ms   | [S1,MB2,BI] 340-11-352ms   | [S1,MB2,BW] 352-14-367ms   | [S6,MB6,F]  367-6-374ms    | [S6,MB5,BI] 374-9-383ms    | [S6,MB5,BW] 383-11-395ms   | [S1,MB3,BI] 402-11-414ms   | [S1,MB3,BW] 414-14-429ms   | [S6,MB7,F]  429-6-436ms    | [S6,MB6,BI] 436-9-445ms    | [S6,MB6,BW] 445-11-457ms   | [S1,MB4,BI] 464-11-476ms   | [S6,MB7,BI] 476-9-485ms    | [S1,MB5,BI] 485-11-497ms   | [S1,MB4,BW] 497-14-512ms   | [S1,MB6,BI] 511-11-523ms   | [S1,MB5,BW] 523-14-538ms   | [S1,MB7,BI] 538-11-550ms   | [S1,MB6,BW] 550-14-564ms   | [S6,MB7,BW] 564-11-575ms   | [S1,MB7,BW] 577-14-592ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  64-6-70ms      | [S2,MB4,F]  75-6-82ms      | [S5,MB2,F]  82-6-89ms      | [S5,MB0,BI] 99-9-109ms     | [S5,MB0,BW] 109-11-120ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-145ms    | [S5,MB1,BW] 145-11-156ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 173-9-182ms    | [S2,MB0,BW] 182-11-194ms   | [S5,MB4,F]  194-6-201ms    | [S5,MB2,BI] 201-9-210ms    | [S5,MB2,BW] 210-11-222ms   | [S2,MB6,F]  222-7-229ms    | [S2,MB1,BI] 243-9-253ms    | [S2,MB1,BW] 253-11-264ms   | [S5,MB5,F]  265-6-272ms    | [S5,MB3,BI] 272-9-281ms    | [S5,MB3,BW] 281-11-292ms   | [S2,MB7,F]  292-7-299ms    | [S2,MB2,BI] 321-9-331ms    | [S2,MB2,BW] 331-11-342ms   | [S5,MB6,F]  342-6-349ms    | [S5,MB4,BI] 349-9-359ms    | [S5,MB4,BW] 359-11-370ms   | [S2,MB3,BI] 383-9-392ms    | [S2,MB3,BW] 392-11-404ms   | [S5,MB7,F]  404-6-411ms    | [S5,MB5,BI] 411-9-420ms    | [S5,MB5,BW] 420-11-432ms   | [S2,MB4,BI] 445-9-454ms    | [S5,MB6,BI] 454-9-464ms    | [S2,MB5,BI] 464-9-473ms    | [S5,MB7,BI] 485-9-494ms    | [S2,MB6,BI] 494-9-504ms    | [S2,MB4,BW] 504-11-515ms   | [S2,MB7,BI] 515-9-525ms    | [S2,MB5,BW] 525-11-536ms   | [S5,MB6,BW] 536-11-547ms   | [S5,MB7,BW] 547-11-559ms   | [S2,MB6,BW] 561-11-572ms   | [S2,MB7,BW] 572-11-584ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  81-6-88ms      | [S4,MB3,F]  88-6-95ms      | [S4,MB0,BI] 108-9-118ms    | [S4,MB0,BW] 118-11-129ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 145-9-154ms    | [S3,MB0,BW] 154-11-165ms   | [S4,MB4,F]  166-6-172ms    | [S4,MB1,BI] 172-9-182ms    | [S4,MB1,BW] 182-11-193ms   | [S3,MB5,F]  193-6-200ms    | [S3,MB1,BI] 210-9-219ms    | [S3,MB1,BW] 219-11-231ms   | [S4,MB5,F]  231-6-238ms    | [S4,MB2,BI] 238-9-247ms    | [S4,MB2,BW] 247-11-258ms   | [S3,MB6,F]  258-6-265ms    | [S3,MB2,BI] 281-9-290ms    | [S3,MB2,BW] 290-11-301ms   | [S4,MB6,F]  301-6-308ms    | [S4,MB3,BI] 308-9-318ms    | [S4,MB3,BW] 318-11-329ms   | [S3,MB7,F]  329-6-336ms    | [S3,MB3,BI] 359-9-368ms    | [S3,MB3,BW] 368-11-379ms   | [S4,MB7,F]  379-6-386ms    | [S4,MB4,BI] 386-9-395ms    | [S4,MB4,BW] 396-11-407ms   | [S3,MB4,BI] 420-9-429ms    | [S4,MB5,BI] 430-9-439ms    | [S3,MB5,BI] 439-9-448ms    | [S4,MB6,BI] 464-9-473ms    | [S3,MB6,BI] 473-9-482ms    | [S4,MB7,BI] 494-9-503ms    | [S3,MB7,BI] 504-9-513ms    | [S3,MB4,BW] 513-11-524ms   | [S4,MB5,BW] 524-11-535ms   | [S4,MB6,BW] 535-11-547ms   | [S4,MB7,BW] 547-11-558ms   | [S3,MB5,BW] 560-11-571ms   | [S3,MB6,BW] 571-11-583ms   | [S3,MB7,BW] 582-11-594ms  
[rank0]:2026-01-03 15:30:16,154 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:30:18,618 - Avg. fwd time: 7.8755 / Avg. full-bwd time: 23.1712 (Avg. bwd-weight time: 15.1538 / Avg. bwd-input time: 11.6053) / Avg. batch time: 583.9099 (ms) / GPU bubble ratio: 10.01%
[rank2]:2026-01-03 15:30:18,628 - Avg. fwd time: 7.0575 / Avg. bwd-weight time: 11.3157 / Avg. bwd-input time: 9.1979 / Avg. batch time: 558.8465 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:30:18,665 -  step: 650  loss: -4.0000  grad_norm:  0.5461  memory: 46.44GiB(33.21%)  tps: 6,701  tflops: 312.54  mfu: 31.60%
[rank1]:2026-01-03 15:30:18,637 - Avg. fwd time: 8.0004 / Avg. bwd-weight time: 12.7596 / Avg. bwd-input time: 10.4090 / Avg. batch time: 578.0238 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:30:18,668 -  step: 650  loss: -4.0000  grad_norm:  0.5461  memory: 52.63GiB(37.64%)  tps: 6,701  tflops: 312.54  mfu: 31.60%
[rank3]:2026-01-03 15:30:18,640 - Avg. fwd time: 7.0162 / Avg. bwd-weight time: 11.2312 / Avg. bwd-input time: 9.1396 / Avg. batch time: 559.4832 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:30:18,665 -  step: 650  loss: -4.0000  grad_norm:  0.5461  memory: 49.97GiB(35.74%)  tps: 6,701  tflops: 312.54  mfu: 31.60%
[rank0]:2026-01-03 15:30:18,676 -  step: 650  loss:  0.2677  grad_norm:  0.5461  memory: 63.64GiB(45.52%)  tps: 6,701  tflops: 312.54  mfu: 31.60%
[rank0]:2026-01-03 15:32:18,207 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:32:20,695 - Avg. fwd time: 7.0651 / Avg. bwd-weight time: 11.3176 / Avg. bwd-input time: 9.2023 / Avg. batch time: 559.1258 (ms) / GPU bubble ratio: 21.06%
[rank1]:2026-01-03 15:32:20,705 - Avg. fwd time: 8.0094 / Avg. bwd-weight time: 12.7620 / Avg. bwd-input time: 10.4145 / Avg. batch time: 578.3171 (ms) / GPU bubble ratio: 13.72%
[rank3]:2026-01-03 15:32:20,707 - Avg. fwd time: 7.0233 / Avg. bwd-weight time: 11.2326 / Avg. bwd-input time: 9.1435 / Avg. batch time: 559.7940 (ms) / GPU bubble ratio: 21.69%
[rank0]:2026-01-03 15:32:20,690 - Avg. fwd time: 7.8845 / Avg. full-bwd time: 23.1830 (Avg. bwd-weight time: 15.1604 / Avg. bwd-input time: 11.6142) / Avg. batch time: 584.4410 (ms) / GPU bubble ratio: 10.03%
[rank2]:2026-01-03 15:32:20,732 -  step: 700  loss: -4.0000  grad_norm:  0.6215  memory: 46.44GiB(33.21%)  tps: 6,711  tflops: 313.01  mfu: 31.65%
[rank1]:2026-01-03 15:32:20,735 -  step: 700  loss: -4.0000  grad_norm:  0.6215  memory: 52.63GiB(37.64%)  tps: 6,711  tflops: 313.01  mfu: 31.65%
[rank3]:2026-01-03 15:32:20,732 -  step: 700  loss: -4.0000  grad_norm:  0.6215  memory: 49.97GiB(35.74%)  tps: 6,711  tflops: 313.01  mfu: 31.65%
[rank0]:2026-01-03 15:32:20,743 -  step: 700  loss:  0.3472  grad_norm:  0.6215  memory: 63.64GiB(45.52%)  tps: 6,711  tflops: 313.01  mfu: 31.65%
[rank3]:2026-01-03 15:32:21,040 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1532_step700_rank3.svg
[rank3]:			> Batch Time: 597.33 ms, GPU Bubble Ratio: 10.98%, 15.51%, 25.32%, 25.86%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  29-7-36ms      | [S0,MB3,F]  41-7-48ms      | [S0,MB4,F]  50-7-57ms      | [S0,MB5,F]  59-7-66ms      | [S0,MB6,F]  68-7-75ms      | [S7,MB0,F]  86-10-97ms     | [S7,MB0,BI] 99-11-110ms    | [S7,MB0,BW] 111-15-126ms   | [S7,MB1,F]  126-8-134ms    | [S7,MB1,BI] 136-11-147ms   | [S7,MB1,BW] 148-15-163ms   | [S7,MB2,F]  163-8-171ms    | [S7,MB2,BI] 173-11-185ms   | [S7,MB2,BW] 185-15-200ms   | [S7,MB3,F]  200-8-209ms    | [S7,MB3,BI] 210-11-222ms   | [S7,MB3,BW] 222-15-238ms   | [S0,MB7,F]  238-7-245ms    | [S0,MB0,B]  255-23-279ms   | [S7,MB4,F]  279-8-287ms    | [S7,MB4,BI] 289-11-300ms   | [S7,MB4,BW] 300-15-315ms   | [S0,MB1,B]  316-23-339ms   | [S7,MB5,F]  339-8-347ms    | [S7,MB5,BI] 350-11-361ms   | [S7,MB5,BW] 361-15-377ms   | [S0,MB2,B]  377-23-401ms   | [S7,MB6,F]  401-8-410ms    | [S7,MB6,BI] 412-11-424ms   | [S7,MB6,BW] 424-15-440ms   | [S0,MB3,B]  440-23-463ms   | [S7,MB7,F]  464-8-472ms    | [S7,MB7,BI] 474-11-486ms   | [S7,MB7,BW] 486-15-501ms   | [S0,MB4,B]  503-23-527ms   | [S0,MB5,B]  527-23-550ms   | [S0,MB6,B]  550-23-573ms   | [S0,MB7,B]  574-23-597ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  39-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-82ms      | [S6,MB0,BI] 90-9-100ms     | [S6,MB0,BW] 100-11-111ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-136ms    | [S6,MB1,BW] 136-11-148ms   | [S6,MB3,F]  148-6-155ms    | [S6,MB2,BI] 164-9-173ms    | [S6,MB2,BW] 174-11-185ms   | [S1,MB6,F]  185-8-194ms    | [S1,MB0,BI] 202-11-213ms   | [S1,MB0,BW] 214-14-228ms   | [S6,MB4,F]  228-6-235ms    | [S6,MB3,BI] 235-9-244ms    | [S6,MB3,BW] 244-11-256ms   | [S1,MB7,F]  256-8-265ms    | [S1,MB1,BI] 280-11-292ms   | [S1,MB1,BW] 292-14-306ms   | [S6,MB5,F]  306-6-313ms    | [S6,MB4,BI] 313-9-323ms    | [S6,MB4,BW] 323-11-334ms   | [S1,MB2,BI] 341-11-353ms   | [S1,MB2,BW] 353-14-368ms   | [S6,MB6,F]  368-6-374ms    | [S6,MB5,BI] 375-9-384ms    | [S6,MB5,BW] 384-11-396ms   | [S1,MB3,BI] 403-11-415ms   | [S1,MB3,BW] 415-14-429ms   | [S6,MB7,F]  430-6-436ms    | [S6,MB6,BI] 437-9-446ms    | [S6,MB6,BW] 446-11-457ms   | [S1,MB4,BI] 465-11-476ms   | [S6,MB7,BI] 476-9-486ms    | [S1,MB5,BI] 486-11-497ms   | [S1,MB4,BW] 498-14-512ms   | [S1,MB6,BI] 512-11-524ms   | [S1,MB5,BW] 524-14-538ms   | [S1,MB7,BI] 538-11-550ms   | [S1,MB6,BW] 550-14-564ms   | [S6,MB7,BW] 565-11-576ms   | [S1,MB7,BW] 578-14-592ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-56ms      | [S2,MB3,F]  57-6-64ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-6-82ms      | [S5,MB2,F]  82-6-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 109-11-120ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-145ms    | [S5,MB1,BW] 145-11-157ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 173-9-183ms    | [S2,MB0,BW] 183-11-194ms   | [S5,MB4,F]  194-6-201ms    | [S5,MB2,BI] 201-9-211ms    | [S5,MB2,BW] 211-11-222ms   | [S2,MB6,F]  222-7-229ms    | [S2,MB1,BI] 244-9-253ms    | [S2,MB1,BW] 254-11-265ms   | [S5,MB5,F]  265-6-272ms    | [S5,MB3,BI] 272-9-281ms    | [S5,MB3,BW] 282-11-293ms   | [S2,MB7,F]  293-7-300ms    | [S2,MB2,BI] 322-9-332ms    | [S2,MB2,BW] 332-11-343ms   | [S5,MB6,F]  343-6-350ms    | [S5,MB4,BI] 350-9-359ms    | [S5,MB4,BW] 360-11-371ms   | [S2,MB3,BI] 384-9-393ms    | [S2,MB3,BW] 393-11-405ms   | [S5,MB7,F]  405-6-412ms    | [S5,MB5,BI] 412-9-421ms    | [S5,MB5,BW] 421-11-433ms   | [S2,MB4,BI] 446-9-455ms    | [S5,MB6,BI] 455-9-465ms    | [S2,MB5,BI] 464-9-474ms    | [S5,MB7,BI] 486-9-495ms    | [S2,MB6,BI] 495-9-504ms    | [S2,MB4,BW] 504-11-516ms   | [S2,MB7,BI] 516-9-525ms    | [S2,MB5,BW] 525-11-537ms   | [S5,MB6,BW] 536-11-548ms   | [S5,MB7,BW] 548-11-559ms   | [S2,MB6,BW] 561-11-573ms   | [S2,MB7,BW] 573-11-584ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  82-6-89ms      | [S4,MB3,F]  89-6-96ms      | [S4,MB0,BI] 109-9-118ms    | [S4,MB0,BW] 118-11-129ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 145-9-154ms    | [S3,MB0,BW] 155-11-166ms   | [S4,MB4,F]  166-6-173ms    | [S4,MB1,BI] 173-9-182ms    | [S4,MB1,BW] 182-11-194ms   | [S3,MB5,F]  194-6-201ms    | [S3,MB1,BI] 210-9-220ms    | [S3,MB1,BW] 220-11-231ms   | [S4,MB5,F]  231-6-238ms    | [S4,MB2,BI] 238-9-247ms    | [S4,MB2,BW] 248-11-259ms   | [S3,MB6,F]  259-6-266ms    | [S3,MB2,BI] 281-9-291ms    | [S3,MB2,BW] 291-11-302ms   | [S4,MB6,F]  302-6-309ms    | [S4,MB3,BI] 309-9-319ms    | [S4,MB3,BW] 319-11-330ms   | [S3,MB7,F]  330-6-337ms    | [S3,MB3,BI] 359-9-369ms    | [S3,MB3,BW] 369-11-380ms   | [S4,MB7,F]  380-6-387ms    | [S4,MB4,BI] 387-9-397ms    | [S4,MB4,BW] 397-11-408ms   | [S3,MB4,BI] 421-9-430ms    | [S4,MB5,BI] 431-9-440ms    | [S3,MB5,BI] 440-9-449ms    | [S4,MB6,BI] 464-9-474ms    | [S3,MB6,BI] 474-9-483ms    | [S4,MB7,BI] 495-9-504ms    | [S3,MB7,BI] 504-9-513ms    | [S3,MB4,BW] 513-11-525ms   | [S4,MB5,BW] 525-11-536ms   | [S4,MB6,BW] 536-11-547ms   | [S4,MB7,BW] 547-11-559ms   | [S3,MB5,BW] 560-11-572ms   | [S3,MB6,BW] 572-11-583ms   | [S3,MB7,BW] 583-11-594ms  
[rank0]:2026-01-03 15:34:19,951 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:34:22,411 - Avg. fwd time: 7.0696 / Avg. bwd-weight time: 11.3189 / Avg. bwd-input time: 9.2051 / Avg. batch time: 559.3419 (ms) / GPU bubble ratio: 21.07%
[rank0]:2026-01-03 15:34:22,401 - Avg. fwd time: 7.8891 / Avg. full-bwd time: 23.1878 (Avg. bwd-weight time: 15.1638 / Avg. bwd-input time: 11.6188) / Avg. batch time: 584.7765 (ms) / GPU bubble ratio: 10.05%
[rank1]:2026-01-03 15:34:22,423 - Avg. fwd time: 8.0147 / Avg. bwd-weight time: 12.7636 / Avg. bwd-input time: 10.4178 / Avg. batch time: 578.5419 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:34:22,453 -  step: 750  loss: -4.0000  grad_norm:  0.4297  memory: 52.63GiB(37.64%)  tps: 6,730  tflops: 313.90  mfu: 31.74%
[rank2]:2026-01-03 15:34:22,450 -  step: 750  loss: -4.0000  grad_norm:  0.4297  memory: 46.44GiB(33.21%)  tps: 6,730  tflops: 313.90  mfu: 31.74%
[rank3]:2026-01-03 15:34:22,424 - Avg. fwd time: 7.0277 / Avg. bwd-weight time: 11.2337 / Avg. bwd-input time: 9.1462 / Avg. batch time: 559.9564 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 15:34:22,450 -  step: 750  loss: -4.0000  grad_norm:  0.4297  memory: 49.97GiB(35.74%)  tps: 6,730  tflops: 313.90  mfu: 31.74%
[rank0]:2026-01-03 15:34:22,461 -  step: 750  loss:  0.1440  grad_norm:  0.4297  memory: 63.64GiB(45.52%)  tps: 6,730  tflops: 313.91  mfu: 31.74%
[rank0]:2026-01-03 15:36:20,399 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-03 15:36:22,899 - Avg. fwd time: 8.0153 / Avg. bwd-weight time: 12.7638 / Avg. bwd-input time: 10.4186 / Avg. batch time: 578.5127 (ms) / GPU bubble ratio: 13.72%
[rank3]:2026-01-03 15:36:22,903 - Avg. fwd time: 7.0282 / Avg. bwd-weight time: 11.2338 / Avg. bwd-input time: 9.1468 / Avg. batch time: 559.9627 (ms) / GPU bubble ratio: 21.68%
[rank2]:2026-01-03 15:36:22,892 - Avg. fwd time: 7.0702 / Avg. bwd-weight time: 11.3192 / Avg. bwd-input time: 9.2059 / Avg. batch time: 559.3111 (ms) / GPU bubble ratio: 21.06%
[rank0]:2026-01-03 15:36:22,881 - Avg. fwd time: 7.8891 / Avg. full-bwd time: 23.1899 (Avg. bwd-weight time: 15.1643 / Avg. bwd-input time: 11.6189) / Avg. batch time: 584.6920 (ms) / GPU bubble ratio: 10.04%
[rank1]:2026-01-03 15:36:22,931 -  step: 800  loss: -4.0000  grad_norm:  0.6082  memory: 52.63GiB(37.64%)  tps: 6,800  tflops: 317.13  mfu: 32.07%
[rank3]:2026-01-03 15:36:22,928 -  step: 800  loss: -4.0000  grad_norm:  0.6082  memory: 49.97GiB(35.74%)  tps: 6,800  tflops: 317.13  mfu: 32.07%
[rank2]:2026-01-03 15:36:22,928 -  step: 800  loss: -4.0000  grad_norm:  0.6082  memory: 46.44GiB(33.21%)  tps: 6,800  tflops: 317.13  mfu: 32.07%
[rank0]:2026-01-03 15:36:22,939 -  step: 800  loss:  0.2640  grad_norm:  0.6082  memory: 63.64GiB(45.52%)  tps: 6,800  tflops: 317.13  mfu: 32.07%
[rank3]:2026-01-03 15:36:23,239 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1536_step800_rank3.svg
[rank3]:			> Batch Time: 589.61 ms, GPU Bubble Ratio: 10.56%, 15.05%, 24.80%, 25.34%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  25-7-32ms      | [S0,MB3,F]  36-6-43ms      | [S0,MB4,F]  45-6-52ms      | [S0,MB5,F]  54-6-61ms      | [S0,MB6,F]  62-6-69ms      | [S7,MB0,F]  81-10-91ms     | [S7,MB0,BI] 93-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-141ms   | [S7,MB1,BW] 141-15-156ms   | [S7,MB2,F]  156-8-164ms    | [S7,MB2,BI] 166-11-178ms   | [S7,MB2,BW] 178-15-193ms   | [S7,MB3,F]  193-8-201ms    | [S7,MB3,BI] 203-11-215ms   | [S7,MB3,BW] 215-15-230ms   | [S0,MB7,F]  230-7-238ms    | [S0,MB0,B]  248-22-271ms   | [S7,MB4,F]  271-7-279ms    | [S7,MB4,BI] 281-11-292ms   | [S7,MB4,BW] 293-15-308ms   | [S0,MB1,B]  308-23-331ms   | [S7,MB5,F]  331-8-340ms    | [S7,MB5,BI] 342-11-353ms   | [S7,MB5,BW] 354-15-369ms   | [S0,MB2,B]  369-23-393ms   | [S7,MB6,F]  394-8-402ms    | [S7,MB6,BI] 404-11-416ms   | [S7,MB6,BW] 416-15-431ms   | [S0,MB3,B]  432-23-455ms   | [S7,MB7,F]  455-8-464ms    | [S7,MB7,BI] 466-11-477ms   | [S7,MB7,BW] 477-15-493ms   | [S0,MB4,B]  495-23-519ms   | [S0,MB5,B]  519-23-542ms   | [S0,MB6,B]  543-23-566ms   | [S0,MB7,B]  566-23-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 99-11-110ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 125-9-135ms    | [S6,MB1,BW] 135-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 172-11-183ms   | [S1,MB6,F]  183-8-192ms    | [S1,MB0,BI] 200-11-211ms   | [S1,MB0,BW] 211-14-226ms   | [S6,MB4,F]  226-6-232ms    | [S6,MB3,BI] 232-9-242ms    | [S6,MB3,BW] 242-11-253ms   | [S1,MB7,F]  253-8-262ms    | [S1,MB1,BI] 277-11-289ms   | [S1,MB1,BW] 289-14-303ms   | [S6,MB5,F]  303-6-310ms    | [S6,MB4,BI] 310-9-319ms    | [S6,MB4,BW] 319-11-331ms   | [S1,MB2,BI] 338-11-350ms   | [S1,MB2,BW] 350-14-364ms   | [S6,MB6,F]  364-6-371ms    | [S6,MB5,BI] 371-9-380ms    | [S6,MB5,BW] 380-11-392ms   | [S1,MB3,BI] 400-11-412ms   | [S1,MB3,BW] 412-14-426ms   | [S6,MB7,F]  426-6-433ms    | [S6,MB6,BI] 433-9-442ms    | [S6,MB6,BW] 442-11-454ms   | [S1,MB4,BI] 461-11-473ms   | [S6,MB7,BI] 473-9-482ms    | [S1,MB5,BI] 483-11-494ms   | [S1,MB4,BW] 494-14-509ms   | [S1,MB6,BI] 509-11-520ms   | [S1,MB5,BW] 520-14-535ms   | [S1,MB7,BI] 535-11-547ms   | [S1,MB6,BW] 547-14-561ms   | [S6,MB7,BW] 561-11-572ms   | [S1,MB7,BW] 574-14-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 98-9-108ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-125ms    | [S5,MB1,BI] 134-9-144ms    | [S5,MB1,BW] 144-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 181-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 242-9-251ms    | [S2,MB1,BW] 251-11-263ms   | [S5,MB5,F]  263-6-269ms    | [S5,MB3,BI] 270-9-279ms    | [S5,MB3,BW] 279-11-290ms   | [S2,MB7,F]  291-6-297ms    | [S2,MB2,BI] 319-9-328ms    | [S2,MB2,BW] 329-11-340ms   | [S5,MB6,F]  340-6-347ms    | [S5,MB4,BI] 347-9-356ms    | [S5,MB4,BW] 356-11-368ms   | [S2,MB3,BI] 380-9-389ms    | [S2,MB3,BW] 389-11-401ms   | [S5,MB7,F]  401-6-408ms    | [S5,MB5,BI] 408-9-417ms    | [S5,MB5,BW] 417-11-429ms   | [S2,MB4,BI] 442-9-451ms    | [S5,MB6,BI] 451-9-461ms    | [S2,MB5,BI] 461-9-470ms    | [S5,MB7,BI] 482-9-491ms    | [S2,MB6,BI] 492-9-501ms    | [S2,MB4,BW] 501-11-512ms   | [S2,MB7,BI] 512-9-521ms    | [S2,MB5,BW] 522-11-533ms   | [S5,MB6,BW] 533-11-545ms   | [S5,MB7,BW] 545-11-556ms   | [S2,MB6,BW] 558-11-569ms   | [S2,MB7,BW] 569-11-581ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  54-6-60ms      | [S3,MB2,F]  63-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 117-11-128ms   | [S3,MB4,F]  128-6-134ms    | [S3,MB0,BI] 143-9-153ms    | [S3,MB0,BW] 153-11-164ms   | [S4,MB4,F]  164-6-171ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-192ms   | [S3,MB5,F]  192-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-229ms   | [S4,MB5,F]  229-6-236ms    | [S4,MB2,BI] 236-9-245ms    | [S4,MB2,BW] 245-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 279-9-288ms    | [S3,MB2,BW] 288-11-299ms   | [S4,MB6,F]  300-6-306ms    | [S4,MB3,BI] 307-9-316ms    | [S4,MB3,BW] 316-11-327ms   | [S3,MB7,F]  327-6-334ms    | [S3,MB3,BI] 356-9-365ms    | [S3,MB3,BW] 365-11-377ms   | [S4,MB7,F]  377-6-383ms    | [S4,MB4,BI] 384-9-393ms    | [S4,MB4,BW] 393-11-404ms   | [S3,MB4,BI] 417-9-426ms    | [S4,MB5,BI] 426-9-435ms    | [S3,MB5,BI] 436-9-445ms    | [S4,MB6,BI] 461-9-470ms    | [S3,MB6,BI] 470-9-479ms    | [S4,MB7,BI] 491-9-500ms    | [S3,MB7,BI] 501-9-510ms    | [S3,MB4,BW] 510-11-521ms   | [S4,MB5,BW] 521-11-532ms   | [S4,MB6,BW] 532-11-544ms   | [S4,MB7,BW] 544-11-555ms   | [S3,MB5,BW] 557-11-568ms   | [S3,MB6,BW] 568-11-579ms   | [S3,MB7,BW] 580-11-591ms  
[rank0]:2026-01-03 15:38:21,540 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:38:23,993 - Avg. fwd time: 7.0724 / Avg. bwd-weight time: 11.3197 / Avg. bwd-input time: 9.2071 / Avg. batch time: 559.4234 (ms) / GPU bubble ratio: 21.06%
[rank0]:2026-01-03 15:38:23,983 - Avg. fwd time: 7.8908 / Avg. full-bwd time: 23.1931 (Avg. bwd-weight time: 15.1661 / Avg. bwd-input time: 11.6210) / Avg. batch time: 584.8008 (ms) / GPU bubble ratio: 10.04%
[rank1]:2026-01-03 15:38:24,002 - Avg. fwd time: 8.0177 / Avg. bwd-weight time: 12.7643 / Avg. bwd-input time: 10.4199 / Avg. batch time: 578.6292 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:38:24,032 -  step: 850  loss: -4.0000  grad_norm:  0.3855  memory: 52.63GiB(37.64%)  tps: 6,765  tflops: 315.50  mfu: 31.90%
[rank3]:2026-01-03 15:38:24,004 - Avg. fwd time: 7.0301 / Avg. bwd-weight time: 11.2342 / Avg. bwd-input time: 9.1476 / Avg. batch time: 560.0281 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:38:24,030 -  step: 850  loss: -4.0000  grad_norm:  0.3855  memory: 49.97GiB(35.74%)  tps: 6,765  tflops: 315.50  mfu: 31.90%
[rank2]:2026-01-03 15:38:24,030 -  step: 850  loss: -4.0000  grad_norm:  0.3855  memory: 46.44GiB(33.21%)  tps: 6,765  tflops: 315.50  mfu: 31.90%
[rank0]:2026-01-03 15:38:24,040 -  step: 850  loss:  0.1211  grad_norm:  0.3855  memory: 63.64GiB(45.52%)  tps: 6,765  tflops: 315.50  mfu: 31.90%
[rank0]:2026-01-03 15:40:21,043 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 15:40:23,500 - Avg. fwd time: 7.0700 / Avg. bwd-weight time: 11.3191 / Avg. bwd-input time: 9.2058 / Avg. batch time: 559.2545 (ms) / GPU bubble ratio: 21.05%
[rank0]:2026-01-03 15:40:23,489 - Avg. fwd time: 7.8874 / Avg. full-bwd time: 23.1915 (Avg. bwd-weight time: 15.1635 / Avg. bwd-input time: 11.6171) / Avg. batch time: 584.4561 (ms) / GPU bubble ratio: 10.01%
[rank3]:2026-01-03 15:40:23,510 - Avg. fwd time: 7.0283 / Avg. bwd-weight time: 11.2337 / Avg. bwd-input time: 9.1465 / Avg. batch time: 559.8973 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:40:23,536 -  step: 900  loss: -4.0000  grad_norm:  0.4107  memory: 49.97GiB(35.74%)  tps: 6,855  tflops: 319.71  mfu: 32.33%
[rank1]:2026-01-03 15:40:23,510 - Avg. fwd time: 8.0150 / Avg. bwd-weight time: 12.7634 / Avg. bwd-input time: 10.4183 / Avg. batch time: 578.4587 (ms) / GPU bubble ratio: 13.71%
[rank1]:2026-01-03 15:40:23,539 -  step: 900  loss: -4.0000  grad_norm:  0.4107  memory: 52.63GiB(37.64%)  tps: 6,855  tflops: 319.71  mfu: 32.33%
[rank2]:2026-01-03 15:40:23,536 -  step: 900  loss: -4.0000  grad_norm:  0.4107  memory: 46.44GiB(33.21%)  tps: 6,855  tflops: 319.71  mfu: 32.33%
[rank0]:2026-01-03 15:40:23,547 -  step: 900  loss:  0.1839  grad_norm:  0.4107  memory: 63.64GiB(45.52%)  tps: 6,855  tflops: 319.71  mfu: 32.33%
[rank3]:2026-01-03 15:40:23,844 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1540_step900_rank3.svg
[rank3]:			> Batch Time: 584.14 ms, GPU Bubble Ratio: 9.94%, 14.35%, 24.26%, 24.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  22-6-29ms      | [S0,MB3,F]  33-6-40ms      | [S0,MB4,F]  42-6-49ms      | [S0,MB5,F]  51-6-58ms      | [S0,MB6,F]  60-6-67ms      | [S7,MB0,F]  78-10-88ms     | [S7,MB0,BI] 90-11-101ms    | [S7,MB0,BW] 102-14-117ms   | [S7,MB1,F]  117-7-124ms    | [S7,MB1,BI] 127-11-138ms   | [S7,MB1,BW] 138-15-153ms   | [S7,MB2,F]  153-8-161ms    | [S7,MB2,BI] 163-11-175ms   | [S7,MB2,BW] 175-15-190ms   | [S7,MB3,F]  190-8-198ms    | [S7,MB3,BI] 200-11-212ms   | [S7,MB3,BW] 212-15-227ms   | [S0,MB7,F]  227-7-234ms    | [S0,MB0,B]  245-22-268ms   | [S7,MB4,F]  268-7-276ms    | [S7,MB4,BI] 278-11-289ms   | [S7,MB4,BW] 289-15-304ms   | [S0,MB1,B]  305-23-328ms   | [S7,MB5,F]  328-8-336ms    | [S7,MB5,BI] 338-11-350ms   | [S7,MB5,BW] 350-15-365ms   | [S0,MB2,B]  366-23-389ms   | [S7,MB6,F]  389-8-397ms    | [S7,MB6,BI] 399-11-411ms   | [S7,MB6,BW] 411-15-427ms   | [S0,MB3,B]  427-23-450ms   | [S7,MB7,F]  451-8-459ms    | [S7,MB7,BI] 461-11-472ms   | [S7,MB7,BW] 473-15-488ms   | [S0,MB4,B]  490-23-513ms   | [S0,MB5,B]  514-23-537ms   | [S0,MB6,B]  537-23-560ms   | [S0,MB7,B]  561-23-584ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-99ms      | [S6,MB0,BW] 99-11-110ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-182ms   | [S1,MB6,F]  182-8-191ms    | [S1,MB0,BI] 199-11-210ms   | [S1,MB0,BW] 211-14-225ms   | [S6,MB4,F]  225-6-232ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 241-11-252ms   | [S1,MB7,F]  253-8-261ms    | [S1,MB1,BI] 276-11-288ms   | [S1,MB1,BW] 288-14-302ms   | [S6,MB5,F]  302-6-309ms    | [S6,MB4,BI] 309-9-318ms    | [S6,MB4,BW] 318-11-330ms   | [S1,MB2,BI] 337-11-348ms   | [S1,MB2,BW] 349-14-363ms   | [S6,MB6,F]  363-6-370ms    | [S6,MB5,BI] 370-9-379ms    | [S6,MB5,BW] 379-11-391ms   | [S1,MB3,BI] 399-11-410ms   | [S1,MB3,BW] 410-14-425ms   | [S6,MB7,F]  425-6-432ms    | [S6,MB6,BI] 432-9-441ms    | [S6,MB6,BW] 441-11-452ms   | [S1,MB4,BI] 460-11-471ms   | [S6,MB7,BI] 471-9-481ms    | [S1,MB5,BI] 481-11-492ms   | [S1,MB4,BW] 493-14-507ms   | [S1,MB6,BI] 507-11-518ms   | [S1,MB5,BW] 519-14-533ms   | [S1,MB7,BI] 533-11-545ms   | [S1,MB6,BW] 545-14-559ms   | [S6,MB7,BW] 559-11-571ms   | [S1,MB7,BW] 572-14-587ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 98-9-108ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 143-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 180-11-191ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-219ms   | [S2,MB6,F]  219-6-226ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 250-11-262ms   | [S5,MB5,F]  262-6-269ms    | [S5,MB3,BI] 269-9-278ms    | [S5,MB3,BW] 278-11-289ms   | [S2,MB7,F]  289-6-296ms    | [S2,MB2,BI] 318-9-327ms    | [S2,MB2,BW] 327-11-339ms   | [S5,MB6,F]  339-6-346ms    | [S5,MB4,BI] 346-9-355ms    | [S5,MB4,BW] 355-11-366ms   | [S2,MB3,BI] 379-9-388ms    | [S2,MB3,BW] 388-11-400ms   | [S5,MB7,F]  400-6-407ms    | [S5,MB5,BI] 407-9-416ms    | [S5,MB5,BW] 416-11-427ms   | [S2,MB4,BI] 441-9-450ms    | [S5,MB6,BI] 450-9-459ms    | [S2,MB5,BI] 459-9-468ms    | [S5,MB7,BI] 480-9-490ms    | [S2,MB6,BI] 490-9-499ms    | [S2,MB4,BW] 499-11-511ms   | [S2,MB7,BI] 511-9-520ms    | [S2,MB5,BW] 520-11-531ms   | [S5,MB6,BW] 531-11-543ms   | [S5,MB7,BW] 543-11-554ms   | [S2,MB6,BW] 556-11-568ms   | [S2,MB7,BW] 567-11-579ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  54-6-60ms      | [S3,MB2,F]  63-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  81-6-87ms      | [S4,MB3,F]  88-6-94ms      | [S4,MB0,BI] 107-9-117ms    | [S4,MB0,BW] 117-11-128ms   | [S3,MB4,F]  127-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 152-11-164ms   | [S4,MB4,F]  164-6-170ms    | [S4,MB1,BI] 170-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-228ms   | [S4,MB5,F]  228-6-235ms    | [S4,MB2,BI] 235-9-244ms    | [S4,MB2,BW] 244-11-256ms   | [S3,MB6,F]  256-6-262ms    | [S3,MB2,BI] 278-9-287ms    | [S3,MB2,BW] 287-11-298ms   | [S4,MB6,F]  298-6-305ms    | [S4,MB3,BI] 305-9-314ms    | [S4,MB3,BW] 314-11-326ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 355-9-364ms    | [S3,MB3,BW] 364-11-376ms   | [S4,MB7,F]  375-6-382ms    | [S4,MB4,BI] 382-9-391ms    | [S4,MB4,BW] 391-11-403ms   | [S3,MB4,BI] 416-9-425ms    | [S4,MB5,BI] 425-9-434ms    | [S3,MB5,BI] 434-9-443ms    | [S4,MB6,BI] 459-9-468ms    | [S3,MB6,BI] 468-9-477ms    | [S4,MB7,BI] 490-9-499ms    | [S3,MB7,BI] 499-9-508ms    | [S3,MB4,BW] 508-11-520ms   | [S4,MB5,BW] 519-11-531ms   | [S4,MB6,BW] 531-11-542ms   | [S4,MB7,BW] 542-11-553ms   | [S3,MB5,BW] 555-11-566ms   | [S3,MB6,BW] 566-11-578ms   | [S3,MB7,BW] 577-11-589ms  
[rank0]:2026-01-03 15:42:21,757 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:42:24,217 - Avg. fwd time: 7.8880 / Avg. full-bwd time: 23.1927 (Avg. bwd-weight time: 15.1639 / Avg. bwd-input time: 11.6172) / Avg. batch time: 584.4640 (ms) / GPU bubble ratio: 10.00%
[rank1]:2026-01-03 15:42:24,234 - Avg. fwd time: 8.0161 / Avg. bwd-weight time: 12.7638 / Avg. bwd-input time: 10.4191 / Avg. batch time: 578.5176 (ms) / GPU bubble ratio: 13.71%
[rank1]:2026-01-03 15:42:24,264 -  step: 950  loss: -4.0000  grad_norm:  0.7498  memory: 52.63GiB(37.64%)  tps: 6,786  tflops: 316.49  mfu: 32.00%
[rank3]:2026-01-03 15:42:24,235 - Avg. fwd time: 7.0291 / Avg. bwd-weight time: 11.2337 / Avg. bwd-input time: 9.1470 / Avg. batch time: 559.9131 (ms) / GPU bubble ratio: 21.67%
[rank3]:2026-01-03 15:42:24,261 -  step: 950  loss: -4.0000  grad_norm:  0.7498  memory: 49.97GiB(35.74%)  tps: 6,786  tflops: 316.49  mfu: 32.00%
[rank2]:2026-01-03 15:42:24,224 - Avg. fwd time: 7.0710 / Avg. bwd-weight time: 11.3193 / Avg. bwd-input time: 9.2065 / Avg. batch time: 559.3110 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:42:24,261 -  step: 950  loss: -4.0000  grad_norm:  0.7498  memory: 46.44GiB(33.21%)  tps: 6,786  tflops: 316.49  mfu: 32.00%
[rank0]:2026-01-03 15:42:24,272 -  step: 950  loss:  0.2468  grad_norm:  0.7498  memory: 63.64GiB(45.52%)  tps: 6,786  tflops: 316.49  mfu: 32.00%
[rank0]:2026-01-03 15:44:22,605 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 15:44:25,067 - Avg. fwd time: 7.0306 / Avg. bwd-weight time: 11.2339 / Avg. bwd-input time: 9.1481 / Avg. batch time: 559.9612 (ms) / GPU bubble ratio: 21.67%
[rank1]:2026-01-03 15:44:25,064 - Avg. fwd time: 8.0179 / Avg. bwd-weight time: 12.7642 / Avg. bwd-input time: 10.4204 / Avg. batch time: 578.5394 (ms) / GPU bubble ratio: 13.71%
[rank2]:2026-01-03 15:44:25,054 - Avg. fwd time: 7.0725 / Avg. bwd-weight time: 11.3196 / Avg. bwd-input time: 9.2077 / Avg. batch time: 559.3301 (ms) / GPU bubble ratio: 21.05%
[rank0]:2026-01-03 15:44:25,043 - Avg. fwd time: 7.8893 / Avg. full-bwd time: 23.1945 (Avg. bwd-weight time: 15.1649 / Avg. bwd-input time: 11.6186) / Avg. batch time: 584.4995 (ms) / GPU bubble ratio: 10.00%
[rank0]:2026-01-03 15:44:25,103 -  step: 1000  loss:  0.1515  grad_norm:  0.3011  memory: 63.64GiB(45.52%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank0]:2026-01-03 15:44:25,103 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 15:44:25,103 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2026-01-03 15:44:25,092 -  step: 1000  loss: -4.0000  grad_norm:  0.3011  memory: 49.97GiB(35.74%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank3]:2026-01-03 15:44:25,092 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-03 15:44:25,095 -  step: 1000  loss: -4.0000  grad_norm:  0.3011  memory: 52.63GiB(37.64%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank1]:2026-01-03 15:44:25,095 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 15:44:25,092 -  step: 1000  loss: -4.0000  grad_norm:  0.3011  memory: 46.44GiB(33.21%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank2]:2026-01-03 15:44:25,092 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-03 15:44:36,613 - Finished saving the checkpoint (or staging if async is enabled)in 11.52 seconds.
[rank2]:2026-01-03 15:44:36,895 - Finished saving the checkpoint (or staging if async is enabled)in 11.80 seconds.
[rank1]:2026-01-03 15:44:38,331 - Finished saving the checkpoint (or staging if async is enabled)in 13.24 seconds.
[rank0]:2026-01-03 15:44:42,965 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-03 15:44:42,974 - Finished saving the checkpoint (or staging if async is enabled)in 17.87 seconds.
[rank3]:2026-01-03 15:44:43,424 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1544_step1000_rank3.svg
[rank3]:			> Batch Time: 589.56 ms, GPU Bubble Ratio: 10.51%, 14.91%, 24.75%, 25.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-6-31ms      | [S0,MB3,F]  36-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-69ms      | [S7,MB0,F]  80-10-91ms     | [S7,MB0,BI] 93-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-141ms   | [S7,MB1,BW] 141-15-156ms   | [S7,MB2,F]  156-8-164ms    | [S7,MB2,BI] 166-11-178ms   | [S7,MB2,BW] 178-15-193ms   | [S7,MB3,F]  193-8-201ms    | [S7,MB3,BI] 203-11-215ms   | [S7,MB3,BW] 215-15-230ms   | [S0,MB7,F]  231-7-238ms    | [S0,MB0,B]  248-22-271ms   | [S7,MB4,F]  271-8-279ms    | [S7,MB4,BI] 281-11-293ms   | [S7,MB4,BW] 293-15-308ms   | [S0,MB1,B]  308-23-331ms   | [S7,MB5,F]  332-8-340ms    | [S7,MB5,BI] 342-11-354ms   | [S7,MB5,BW] 354-15-369ms   | [S0,MB2,B]  370-23-393ms   | [S7,MB6,F]  393-8-402ms    | [S7,MB6,BI] 404-11-416ms   | [S7,MB6,BW] 416-15-432ms   | [S0,MB3,B]  432-23-455ms   | [S7,MB7,F]  456-8-464ms    | [S7,MB7,BI] 466-11-478ms   | [S7,MB7,BW] 478-15-493ms   | [S0,MB4,B]  496-23-519ms   | [S0,MB5,B]  519-23-542ms   | [S0,MB6,B]  543-23-566ms   | [S0,MB7,B]  566-23-589ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-7-81ms      | [S6,MB0,BI] 89-9-99ms      | [S6,MB0,BW] 99-11-111ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 126-9-135ms    | [S6,MB1,BW] 135-11-147ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 163-9-172ms    | [S6,MB2,BW] 172-11-183ms   | [S1,MB6,F]  184-8-192ms    | [S1,MB0,BI] 200-11-211ms   | [S1,MB0,BW] 212-14-226ms   | [S6,MB4,F]  226-6-233ms    | [S6,MB3,BI] 233-9-242ms    | [S6,MB3,BW] 242-11-254ms   | [S1,MB7,F]  254-8-263ms    | [S1,MB1,BI] 278-11-289ms   | [S1,MB1,BW] 289-14-304ms   | [S6,MB5,F]  304-6-311ms    | [S6,MB4,BI] 311-9-320ms    | [S6,MB4,BW] 320-11-332ms   | [S1,MB2,BI] 338-11-350ms   | [S1,MB2,BW] 350-14-364ms   | [S6,MB6,F]  365-6-372ms    | [S6,MB5,BI] 372-9-381ms    | [S6,MB5,BW] 381-11-392ms   | [S1,MB3,BI] 401-11-412ms   | [S1,MB3,BW] 412-14-427ms   | [S6,MB7,F]  427-6-434ms    | [S6,MB6,BI] 434-9-443ms    | [S6,MB6,BW] 443-11-455ms   | [S1,MB4,BI] 462-11-474ms   | [S6,MB7,BI] 474-9-483ms    | [S1,MB5,BI] 483-11-495ms   | [S1,MB4,BW] 495-14-509ms   | [S1,MB6,BI] 509-11-521ms   | [S1,MB5,BW] 521-14-535ms   | [S1,MB7,BI] 535-11-547ms   | [S1,MB6,BW] 547-14-562ms   | [S6,MB7,BW] 562-11-573ms   | [S1,MB7,BW] 575-14-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 99-9-108ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-126ms    | [S5,MB1,BI] 135-9-144ms    | [S5,MB1,BW] 144-11-156ms   | [S2,MB5,F]  156-6-163ms    | [S2,MB0,BI] 172-9-181ms    | [S2,MB0,BW] 181-11-193ms   | [S5,MB4,F]  193-6-199ms    | [S5,MB2,BI] 200-9-209ms    | [S5,MB2,BW] 209-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 242-9-251ms    | [S2,MB1,BW] 252-11-263ms   | [S5,MB5,F]  263-6-270ms    | [S5,MB3,BI] 270-9-279ms    | [S5,MB3,BW] 279-11-291ms   | [S2,MB7,F]  291-6-298ms    | [S2,MB2,BI] 320-9-329ms    | [S2,MB2,BW] 329-11-341ms   | [S5,MB6,F]  341-6-348ms    | [S5,MB4,BI] 348-9-357ms    | [S5,MB4,BW] 357-11-368ms   | [S2,MB3,BI] 381-9-390ms    | [S2,MB3,BW] 390-11-401ms   | [S5,MB7,F]  402-6-408ms    | [S5,MB5,BI] 409-9-418ms    | [S5,MB5,BW] 418-11-429ms   | [S2,MB4,BI] 443-9-452ms    | [S5,MB6,BI] 452-9-462ms    | [S2,MB5,BI] 462-9-471ms    | [S5,MB7,BI] 483-9-492ms    | [S2,MB6,BI] 492-9-501ms    | [S2,MB4,BW] 502-11-513ms   | [S2,MB7,BI] 513-9-522ms    | [S2,MB5,BW] 522-11-534ms   | [S5,MB6,BW] 534-11-545ms   | [S5,MB7,BW] 545-11-557ms   | [S2,MB6,BW] 558-11-570ms   | [S2,MB7,BW] 570-11-581ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  81-6-88ms      | [S4,MB3,F]  88-6-95ms      | [S4,MB0,BI] 108-9-117ms    | [S4,MB0,BW] 117-11-128ms   | [S3,MB4,F]  128-6-135ms    | [S3,MB0,BI] 144-9-153ms    | [S3,MB0,BW] 153-11-164ms   | [S4,MB4,F]  165-6-171ms    | [S4,MB1,BI] 171-9-181ms    | [S4,MB1,BW] 181-11-192ms   | [S3,MB5,F]  192-6-199ms    | [S3,MB1,BI] 209-9-218ms    | [S3,MB1,BW] 218-11-229ms   | [S4,MB5,F]  229-6-236ms    | [S4,MB2,BI] 236-9-246ms    | [S4,MB2,BW] 246-11-257ms   | [S3,MB6,F]  257-6-264ms    | [S3,MB2,BI] 279-9-288ms    | [S3,MB2,BW] 288-11-300ms   | [S4,MB6,F]  300-6-307ms    | [S4,MB3,BI] 307-9-316ms    | [S4,MB3,BW] 316-11-327ms   | [S3,MB7,F]  327-6-334ms    | [S3,MB3,BI] 357-9-366ms    | [S3,MB3,BW] 366-11-377ms   | [S4,MB7,F]  377-6-384ms    | [S4,MB4,BI] 384-9-394ms    | [S4,MB4,BW] 394-11-405ms   | [S3,MB4,BI] 418-9-427ms    | [S4,MB5,BI] 427-9-436ms    | [S3,MB5,BI] 436-9-446ms    | [S4,MB6,BI] 461-9-470ms    | [S3,MB6,BI] 470-9-480ms    | [S4,MB7,BI] 492-9-501ms    | [S3,MB7,BI] 501-9-510ms    | [S3,MB4,BW] 510-11-522ms   | [S4,MB5,BW] 522-11-533ms   | [S4,MB6,BW] 533-11-544ms   | [S4,MB7,BW] 544-11-555ms   | [S3,MB5,BW] 558-11-569ms   | [S3,MB6,BW] 569-11-580ms   | [S3,MB7,BW] 580-11-591ms  
[rank0]:2026-01-03 15:46:43,626 - [GC] Peforming periodical GC collection 2.21 seconds
[rank0]:2026-01-03 15:46:46,137 - Avg. fwd time: 7.8897 / Avg. full-bwd time: 23.1933 (Avg. bwd-weight time: 15.1642 / Avg. bwd-input time: 11.6174) / Avg. batch time: 584.5617 (ms) / GPU bubble ratio: 10.01%
[rank3]:2026-01-03 15:46:46,157 - Avg. fwd time: 7.0313 / Avg. bwd-weight time: 11.2340 / Avg. bwd-input time: 9.1487 / Avg. batch time: 560.0220 (ms) / GPU bubble ratio: 21.68%
[rank2]:2026-01-03 15:46:46,148 - Avg. fwd time: 7.0726 / Avg. bwd-weight time: 11.3196 / Avg. bwd-input time: 9.2082 / Avg. batch time: 559.4418 (ms) / GPU bubble ratio: 21.06%
[rank1]:2026-01-03 15:46:46,155 - Avg. fwd time: 8.0184 / Avg. bwd-weight time: 12.7641 / Avg. bwd-input time: 10.4207 / Avg. batch time: 578.6532 (ms) / GPU bubble ratio: 13.72%
[rank0]:2026-01-03 15:46:46,194 -  step: 1050  loss:  0.2500  grad_norm:  0.8566  memory: 63.64GiB(45.52%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank3]:2026-01-03 15:46:46,183 -  step: 1050  loss: -4.0000  grad_norm:  0.8566  memory: 49.97GiB(35.74%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank2]:2026-01-03 15:46:46,183 -  step: 1050  loss: -4.0000  grad_norm:  0.8566  memory: 46.44GiB(33.21%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank1]:2026-01-03 15:46:46,185 -  step: 1050  loss: -4.0000  grad_norm:  0.8566  memory: 52.63GiB(37.64%)  tps: 5,806  tflops: 270.80  mfu: 27.38%
[rank0]:2026-01-03 15:48:45,961 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 15:48:48,418 - Avg. fwd time: 7.8963 / Avg. full-bwd time: 23.1996 (Avg. bwd-weight time: 15.1693 / Avg. bwd-input time: 11.6238) / Avg. batch time: 584.9168 (ms) / GPU bubble ratio: 10.02%
[rank2]:2026-01-03 15:48:48,427 - Avg. fwd time: 7.0785 / Avg. bwd-weight time: 11.3212 / Avg. bwd-input time: 9.2116 / Avg. batch time: 559.6423 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:48:48,464 -  step: 1100  loss: -4.0000  grad_norm:  0.3897  memory: 46.44GiB(33.21%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank3]:2026-01-03 15:48:48,438 - Avg. fwd time: 7.0365 / Avg. bwd-weight time: 11.2353 / Avg. bwd-input time: 9.1517 / Avg. batch time: 560.2434 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:48:48,464 -  step: 1100  loss: -4.0000  grad_norm:  0.3897  memory: 49.97GiB(35.74%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank1]:2026-01-03 15:48:48,437 - Avg. fwd time: 8.0251 / Avg. bwd-weight time: 12.7658 / Avg. bwd-input time: 10.4241 / Avg. batch time: 578.8583 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:48:48,467 -  step: 1100  loss: -4.0000  grad_norm:  0.3897  memory: 52.63GiB(37.64%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank0]:2026-01-03 15:48:48,475 -  step: 1100  loss:  0.2214  grad_norm:  0.3897  memory: 63.64GiB(45.52%)  tps: 6,699  tflops: 312.46  mfu: 31.59%
[rank3]:2026-01-03 15:48:48,778 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1548_step1100_rank3.svg
[rank3]:			> Batch Time: 598.77 ms, GPU Bubble Ratio: 10.85%, 15.56%, 25.27%, 25.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  29-7-36ms      | [S0,MB3,F]  40-7-48ms      | [S0,MB4,F]  49-7-57ms      | [S0,MB5,F]  58-7-65ms      | [S0,MB6,F]  67-7-74ms      | [S7,MB0,F]  86-10-96ms     | [S7,MB0,BI] 98-11-110ms    | [S7,MB0,BW] 110-15-125ms   | [S7,MB1,F]  125-8-133ms    | [S7,MB1,BI] 135-11-147ms   | [S7,MB1,BW] 147-15-162ms   | [S7,MB2,F]  162-8-170ms    | [S7,MB2,BI] 172-11-184ms   | [S7,MB2,BW] 184-15-200ms   | [S7,MB3,F]  200-8-208ms    | [S7,MB3,BI] 210-11-222ms   | [S7,MB3,BW] 222-15-237ms   | [S0,MB7,F]  238-7-245ms    | [S0,MB0,B]  255-23-278ms   | [S7,MB4,F]  278-8-286ms    | [S7,MB4,BI] 288-11-300ms   | [S7,MB4,BW] 300-15-315ms   | [S0,MB1,B]  315-23-339ms   | [S7,MB5,F]  339-8-347ms    | [S7,MB5,BI] 349-11-361ms   | [S7,MB5,BW] 362-15-377ms   | [S0,MB2,B]  378-23-402ms   | [S7,MB6,F]  402-8-411ms    | [S7,MB6,BI] 413-11-425ms   | [S7,MB6,BW] 425-15-441ms   | [S0,MB3,B]  441-23-465ms   | [S7,MB7,F]  465-8-473ms    | [S7,MB7,BI] 475-11-487ms   | [S7,MB7,BW] 488-15-503ms   | [S0,MB4,B]  505-23-529ms   | [S0,MB5,B]  529-23-552ms   | [S0,MB6,B]  552-23-575ms   | [S0,MB7,B]  575-23-598ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-8-39ms      | [S1,MB3,F]  39-8-47ms      | [S1,MB4,F]  48-8-57ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-83ms      | [S6,MB0,BI] 91-9-100ms     | [S6,MB0,BW] 100-11-112ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-136ms    | [S6,MB1,BW] 137-11-148ms   | [S6,MB3,F]  148-6-155ms    | [S6,MB2,BI] 164-9-174ms    | [S6,MB2,BW] 174-11-185ms   | [S1,MB6,F]  185-8-194ms    | [S1,MB0,BI] 202-11-214ms   | [S1,MB0,BW] 214-14-228ms   | [S6,MB4,F]  228-6-235ms    | [S6,MB3,BI] 235-9-244ms    | [S6,MB3,BW] 245-11-256ms   | [S1,MB7,F]  256-8-265ms    | [S1,MB1,BI] 280-11-292ms   | [S1,MB1,BW] 292-14-307ms   | [S6,MB5,F]  307-6-314ms    | [S6,MB4,BI] 314-9-323ms    | [S6,MB4,BW] 323-11-334ms   | [S1,MB2,BI] 342-11-354ms   | [S1,MB2,BW] 354-14-368ms   | [S6,MB6,F]  368-7-375ms    | [S6,MB5,BI] 375-9-385ms    | [S6,MB5,BW] 385-11-396ms   | [S1,MB3,BI] 405-11-416ms   | [S1,MB3,BW] 417-14-431ms   | [S6,MB7,F]  431-7-438ms    | [S6,MB6,BI] 438-9-447ms    | [S6,MB6,BW] 448-11-459ms   | [S1,MB4,BI] 466-11-478ms   | [S6,MB7,BI] 478-9-487ms    | [S1,MB5,BI] 488-11-499ms   | [S1,MB4,BW] 500-14-514ms   | [S1,MB6,BI] 514-11-526ms   | [S1,MB5,BW] 526-14-540ms   | [S1,MB7,BI] 541-11-552ms   | [S1,MB6,BW] 552-14-566ms   | [S6,MB7,BW] 567-11-578ms   | [S1,MB7,BW] 580-14-594ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-57ms      | [S2,MB3,F]  57-6-64ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-7-82ms      | [S5,MB2,F]  82-7-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 109-11-121ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-146ms    | [S5,MB1,BW] 146-11-157ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 174-9-183ms    | [S2,MB0,BW] 183-11-195ms   | [S5,MB4,F]  195-6-202ms    | [S5,MB2,BI] 202-9-211ms    | [S5,MB2,BW] 211-11-222ms   | [S2,MB6,F]  223-7-230ms    | [S2,MB1,BI] 244-9-254ms    | [S2,MB1,BW] 254-11-265ms   | [S5,MB5,F]  266-6-273ms    | [S5,MB3,BI] 273-9-282ms    | [S5,MB3,BW] 282-11-294ms   | [S2,MB7,F]  294-7-301ms    | [S2,MB2,BI] 323-9-332ms    | [S2,MB2,BW] 332-11-343ms   | [S5,MB6,F]  344-6-351ms    | [S5,MB4,BI] 351-9-360ms    | [S5,MB4,BW] 360-11-371ms   | [S2,MB3,BI] 384-9-394ms    | [S2,MB3,BW] 394-11-405ms   | [S5,MB7,F]  406-7-413ms    | [S5,MB5,BI] 413-9-422ms    | [S5,MB5,BW] 422-11-433ms   | [S2,MB4,BI] 447-9-457ms    | [S5,MB6,BI] 457-9-466ms    | [S2,MB5,BI] 466-9-476ms    | [S5,MB7,BI] 487-9-497ms    | [S2,MB6,BI] 497-9-506ms    | [S2,MB4,BW] 506-11-518ms   | [S2,MB7,BI] 518-9-527ms    | [S2,MB5,BW] 527-11-538ms   | [S5,MB6,BW] 539-11-550ms   | [S5,MB7,BW] 550-11-562ms   | [S2,MB6,BW] 563-11-575ms   | [S2,MB7,BW] 575-11-586ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  64-6-71ms      | [S4,MB2,F]  71-6-78ms      | [S3,MB3,F]  82-6-89ms      | [S4,MB3,F]  89-6-96ms      | [S4,MB0,BI] 109-9-118ms    | [S4,MB0,BW] 119-11-130ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 145-9-155ms    | [S3,MB0,BW] 155-11-166ms   | [S4,MB4,F]  166-6-173ms    | [S4,MB1,BI] 173-9-182ms    | [S4,MB1,BW] 182-11-194ms   | [S3,MB5,F]  194-6-201ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 220-11-231ms   | [S4,MB5,F]  232-6-239ms    | [S4,MB2,BI] 239-9-248ms    | [S4,MB2,BW] 248-11-259ms   | [S3,MB6,F]  259-6-266ms    | [S3,MB2,BI] 282-9-291ms    | [S3,MB2,BW] 291-11-303ms   | [S4,MB6,F]  303-6-310ms    | [S4,MB3,BI] 310-9-319ms    | [S4,MB3,BW] 319-11-331ms   | [S3,MB7,F]  330-6-337ms    | [S3,MB3,BI] 360-9-369ms    | [S3,MB3,BW] 369-11-381ms   | [S4,MB7,F]  381-6-388ms    | [S4,MB4,BI] 388-9-397ms    | [S4,MB4,BW] 397-11-408ms   | [S3,MB4,BI] 422-9-431ms    | [S4,MB5,BI] 431-9-440ms    | [S3,MB5,BI] 440-9-450ms    | [S4,MB6,BI] 466-9-475ms    | [S3,MB6,BI] 475-9-484ms    | [S4,MB7,BI] 496-9-506ms    | [S3,MB7,BI] 506-9-515ms    | [S3,MB4,BW] 515-11-526ms   | [S4,MB5,BW] 526-11-538ms   | [S4,MB6,BW] 538-11-549ms   | [S4,MB7,BW] 549-11-560ms   | [S3,MB5,BW] 562-11-573ms   | [S3,MB6,BW] 573-11-585ms   | [S3,MB7,BW] 585-11-596ms  
[rank0]:2026-01-03 15:50:47,126 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 15:50:49,581 - Avg. fwd time: 7.8978 / Avg. full-bwd time: 23.2009 (Avg. bwd-weight time: 15.1704 / Avg. bwd-input time: 11.6252) / Avg. batch time: 584.9951 (ms) / GPU bubble ratio: 10.03%
[rank0]:2026-01-03 15:50:49,634 -  step: 1150  loss:  0.2104  grad_norm:  0.5777  memory: 63.64GiB(45.52%)  tps: 6,761  tflops: 315.35  mfu: 31.89%
[rank1]:2026-01-03 15:50:49,596 - Avg. fwd time: 8.0265 / Avg. bwd-weight time: 12.7662 / Avg. bwd-input time: 10.4251 / Avg. batch time: 578.9381 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:50:49,626 -  step: 1150  loss: -4.0000  grad_norm:  0.5777  memory: 52.63GiB(37.64%)  tps: 6,761  tflops: 315.35  mfu: 31.89%
[rank3]:2026-01-03 15:50:49,598 - Avg. fwd time: 7.0378 / Avg. bwd-weight time: 11.2355 / Avg. bwd-input time: 9.1526 / Avg. batch time: 560.2909 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:50:49,624 -  step: 1150  loss: -4.0000  grad_norm:  0.5777  memory: 49.97GiB(35.74%)  tps: 6,761  tflops: 315.35  mfu: 31.89%
[rank2]:2026-01-03 15:50:49,588 - Avg. fwd time: 7.0798 / Avg. bwd-weight time: 11.3215 / Avg. bwd-input time: 9.2127 / Avg. batch time: 559.7228 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:50:49,624 -  step: 1150  loss: -4.0000  grad_norm:  0.5777  memory: 46.44GiB(33.21%)  tps: 6,761  tflops: 315.35  mfu: 31.89%
[rank0]:2026-01-03 15:52:47,934 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 15:52:50,423 - Avg. fwd time: 7.8992 / Avg. full-bwd time: 23.2018 (Avg. bwd-weight time: 15.1714 / Avg. bwd-input time: 11.6265) / Avg. batch time: 584.9988 (ms) / GPU bubble ratio: 10.02%
[rank1]:2026-01-03 15:52:50,425 - Avg. fwd time: 8.0275 / Avg. bwd-weight time: 12.7663 / Avg. bwd-input time: 10.4255 / Avg. batch time: 578.9506 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:52:50,457 -  step: 1200  loss: -4.0000  grad_norm:  0.9152  memory: 52.63GiB(37.64%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank2]:2026-01-03 15:52:50,417 - Avg. fwd time: 7.0809 / Avg. bwd-weight time: 11.3217 / Avg. bwd-input time: 9.2134 / Avg. batch time: 559.7355 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:52:50,455 -  step: 1200  loss: -4.0000  grad_norm:  0.9152  memory: 46.44GiB(33.21%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank3]:2026-01-03 15:52:50,427 - Avg. fwd time: 7.0387 / Avg. bwd-weight time: 11.2357 / Avg. bwd-input time: 9.1533 / Avg. batch time: 560.3288 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:52:50,454 -  step: 1200  loss: -4.0000  grad_norm:  0.9152  memory: 49.97GiB(35.74%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank0]:2026-01-03 15:52:50,466 -  step: 1200  loss:  0.2709  grad_norm:  0.9152  memory: 63.64GiB(45.52%)  tps: 6,780  tflops: 316.21  mfu: 31.97%
[rank3]:2026-01-03 15:52:50,767 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1552_step1200_rank3.svg
[rank3]:			> Batch Time: 592.69 ms, GPU Bubble Ratio: 10.76%, 15.33%, 25.07%, 25.61%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  26-7-33ms      | [S0,MB3,F]  38-6-45ms      | [S0,MB4,F]  47-6-54ms      | [S0,MB5,F]  56-7-63ms      | [S0,MB6,F]  64-7-71ms      | [S7,MB0,F]  83-10-93ms     | [S7,MB0,BI] 95-11-107ms    | [S7,MB0,BW] 107-14-122ms   | [S7,MB1,F]  122-7-130ms    | [S7,MB1,BI] 132-11-143ms   | [S7,MB1,BW] 144-15-159ms   | [S7,MB2,F]  159-8-167ms    | [S7,MB2,BI] 169-11-180ms   | [S7,MB2,BW] 181-15-196ms   | [S7,MB3,F]  196-8-204ms    | [S7,MB3,BI] 206-11-218ms   | [S7,MB3,BW] 218-15-233ms   | [S0,MB7,F]  233-7-240ms    | [S0,MB0,B]  251-23-274ms   | [S7,MB4,F]  274-8-282ms    | [S7,MB4,BI] 284-11-295ms   | [S7,MB4,BW] 296-15-311ms   | [S0,MB1,B]  311-23-334ms   | [S7,MB5,F]  334-8-342ms    | [S7,MB5,BI] 345-11-356ms   | [S7,MB5,BW] 357-15-372ms   | [S0,MB2,B]  372-23-396ms   | [S7,MB6,F]  396-8-405ms    | [S7,MB6,BI] 407-11-419ms   | [S7,MB6,BW] 419-15-435ms   | [S0,MB3,B]  435-23-459ms   | [S7,MB7,F]  459-8-467ms    | [S7,MB7,BI] 469-11-481ms   | [S7,MB7,BW] 481-15-496ms   | [S0,MB4,B]  499-23-522ms   | [S0,MB5,B]  522-23-545ms   | [S0,MB6,B]  546-23-569ms   | [S0,MB7,B]  569-23-592ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  57-8-66ms      | [S1,MB5,F]  66-8-74ms      | [S6,MB1,F]  75-6-82ms      | [S6,MB0,BI] 90-9-99ms      | [S6,MB0,BW] 99-11-111ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 126-9-135ms    | [S6,MB1,BW] 135-11-147ms   | [S6,MB3,F]  147-6-153ms    | [S6,MB2,BI] 163-9-172ms    | [S6,MB2,BW] 172-11-184ms   | [S1,MB6,F]  184-8-192ms    | [S1,MB0,BI] 200-11-212ms   | [S1,MB0,BW] 212-14-226ms   | [S6,MB4,F]  226-6-233ms    | [S6,MB3,BI] 233-9-243ms    | [S6,MB3,BW] 243-11-254ms   | [S1,MB7,F]  254-8-263ms    | [S1,MB1,BI] 278-11-289ms   | [S1,MB1,BW] 290-14-304ms   | [S6,MB5,F]  304-6-311ms    | [S6,MB4,BI] 311-9-320ms    | [S6,MB4,BW] 320-11-332ms   | [S1,MB2,BI] 339-11-351ms   | [S1,MB2,BW] 351-14-365ms   | [S6,MB6,F]  365-6-372ms    | [S6,MB5,BI] 372-9-382ms    | [S6,MB5,BW] 382-11-393ms   | [S1,MB3,BI] 402-11-413ms   | [S1,MB3,BW] 414-14-428ms   | [S6,MB7,F]  428-6-435ms    | [S6,MB6,BI] 435-9-444ms    | [S6,MB6,BW] 444-11-456ms   | [S1,MB4,BI] 464-11-475ms   | [S6,MB7,BI] 475-9-485ms    | [S1,MB5,BI] 485-11-496ms   | [S1,MB4,BW] 496-14-511ms   | [S1,MB6,BI] 511-11-523ms   | [S1,MB5,BW] 523-14-537ms   | [S1,MB7,BI] 537-11-549ms   | [S1,MB6,BW] 549-14-563ms   | [S6,MB7,BW] 563-11-575ms   | [S1,MB7,BW] 577-14-591ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  30-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 99-9-108ms     | [S5,MB0,BW] 109-11-120ms   | [S5,MB3,F]  119-6-126ms    | [S5,MB1,BI] 135-9-144ms    | [S5,MB1,BW] 144-11-156ms   | [S2,MB5,F]  156-6-163ms    | [S2,MB0,BI] 172-9-181ms    | [S2,MB0,BW] 181-11-193ms   | [S5,MB4,F]  193-6-200ms    | [S5,MB2,BI] 200-9-209ms    | [S5,MB2,BW] 209-11-221ms   | [S2,MB6,F]  221-6-228ms    | [S2,MB1,BI] 242-9-252ms    | [S2,MB1,BW] 252-11-263ms   | [S5,MB5,F]  263-6-270ms    | [S5,MB3,BI] 270-9-280ms    | [S5,MB3,BW] 280-11-291ms   | [S2,MB7,F]  291-6-298ms    | [S2,MB2,BI] 320-9-329ms    | [S2,MB2,BW] 329-11-341ms   | [S5,MB6,F]  341-6-348ms    | [S5,MB4,BI] 348-9-357ms    | [S5,MB4,BW] 357-11-369ms   | [S2,MB3,BI] 381-9-391ms    | [S2,MB3,BW] 391-11-402ms   | [S5,MB7,F]  402-6-409ms    | [S5,MB5,BI] 409-9-418ms    | [S5,MB5,BW] 418-11-430ms   | [S2,MB4,BI] 444-9-453ms    | [S5,MB6,BI] 453-9-463ms    | [S2,MB5,BI] 463-9-472ms    | [S5,MB7,BI] 484-9-494ms    | [S2,MB6,BI] 494-9-503ms    | [S2,MB4,BW] 503-11-515ms   | [S2,MB7,BI] 515-9-524ms    | [S2,MB5,BW] 524-11-535ms   | [S5,MB6,BW] 535-11-547ms   | [S5,MB7,BW] 547-11-558ms   | [S2,MB6,BW] 560-11-571ms   | [S2,MB7,BW] 571-11-583ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  81-6-88ms      | [S4,MB3,F]  88-6-95ms      | [S4,MB0,BI] 108-9-117ms    | [S4,MB0,BW] 118-11-129ms   | [S3,MB4,F]  128-6-135ms    | [S3,MB0,BI] 144-9-153ms    | [S3,MB0,BW] 153-11-165ms   | [S4,MB4,F]  165-6-172ms    | [S4,MB1,BI] 172-9-181ms    | [S4,MB1,BW] 181-11-192ms   | [S3,MB5,F]  192-6-199ms    | [S3,MB1,BI] 209-9-218ms    | [S3,MB1,BW] 218-11-230ms   | [S4,MB5,F]  230-6-236ms    | [S4,MB2,BI] 237-9-246ms    | [S4,MB2,BW] 246-11-257ms   | [S3,MB6,F]  257-6-264ms    | [S3,MB2,BI] 279-9-289ms    | [S3,MB2,BW] 289-11-300ms   | [S4,MB6,F]  300-6-307ms    | [S4,MB3,BI] 307-9-316ms    | [S4,MB3,BW] 316-11-328ms   | [S3,MB7,F]  328-6-335ms    | [S3,MB3,BI] 357-9-366ms    | [S3,MB3,BW] 367-11-378ms   | [S4,MB7,F]  378-6-385ms    | [S4,MB4,BI] 385-9-394ms    | [S4,MB4,BW] 394-11-405ms   | [S3,MB4,BI] 418-9-427ms    | [S4,MB5,BI] 428-9-437ms    | [S3,MB5,BI] 437-9-446ms    | [S4,MB6,BI] 462-9-471ms    | [S3,MB6,BI] 472-9-481ms    | [S4,MB7,BI] 494-9-503ms    | [S3,MB7,BI] 503-9-512ms    | [S3,MB4,BW] 512-11-523ms   | [S4,MB5,BW] 523-11-535ms   | [S4,MB6,BW] 535-11-546ms   | [S4,MB7,BW] 546-11-557ms   | [S3,MB5,BW] 559-11-571ms   | [S3,MB6,BW] 570-11-582ms   | [S3,MB7,BW] 582-11-593ms  
[rank0]:2026-01-03 15:54:48,800 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 15:54:51,272 - Avg. fwd time: 7.9000 / Avg. full-bwd time: 23.2024 (Avg. bwd-weight time: 15.1721 / Avg. bwd-input time: 11.6273) / Avg. batch time: 585.0048 (ms) / GPU bubble ratio: 10.02%
[rank0]:2026-01-03 15:54:51,321 -  step: 1250  loss:  0.2512  grad_norm:  0.5288  memory: 63.64GiB(45.52%)  tps: 6,778  tflops: 316.15  mfu: 31.97%
[rank1]:2026-01-03 15:54:51,283 - Avg. fwd time: 8.0278 / Avg. bwd-weight time: 12.7662 / Avg. bwd-input time: 10.4257 / Avg. batch time: 578.9913 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 15:54:51,313 -  step: 1250  loss: -4.0000  grad_norm:  0.5288  memory: 52.63GiB(37.64%)  tps: 6,778  tflops: 316.14  mfu: 31.97%
[rank3]:2026-01-03 15:54:51,284 - Avg. fwd time: 7.0390 / Avg. bwd-weight time: 11.2356 / Avg. bwd-input time: 9.1534 / Avg. batch time: 560.3443 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:54:51,310 -  step: 1250  loss: -4.0000  grad_norm:  0.5288  memory: 49.97GiB(35.74%)  tps: 6,778  tflops: 316.14  mfu: 31.97%
[rank2]:2026-01-03 15:54:51,274 - Avg. fwd time: 7.0812 / Avg. bwd-weight time: 11.3217 / Avg. bwd-input time: 9.2137 / Avg. batch time: 559.7781 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:54:51,310 -  step: 1250  loss: -4.0000  grad_norm:  0.5288  memory: 46.44GiB(33.21%)  tps: 6,778  tflops: 316.14  mfu: 31.97%
[rank0]:2026-01-03 15:56:49,448 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 15:56:51,906 - Avg. fwd time: 7.9008 / Avg. full-bwd time: 23.2032 (Avg. bwd-weight time: 15.1727 / Avg. bwd-input time: 11.6281) / Avg. batch time: 584.9712 (ms) / GPU bubble ratio: 10.01%
[rank3]:2026-01-03 15:56:51,921 - Avg. fwd time: 7.0394 / Avg. bwd-weight time: 11.2356 / Avg. bwd-input time: 9.1538 / Avg. batch time: 560.3598 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:56:51,948 -  step: 1300  loss: -4.0000  grad_norm:  0.3598  memory: 49.97GiB(35.74%)  tps: 6,791  tflops: 316.71  mfu: 32.02%
[rank1]:2026-01-03 15:56:51,921 - Avg. fwd time: 8.0282 / Avg. bwd-weight time: 12.7662 / Avg. bwd-input time: 10.4259 / Avg. batch time: 578.9811 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 15:56:51,950 -  step: 1300  loss: -4.0000  grad_norm:  0.3598  memory: 52.63GiB(37.64%)  tps: 6,791  tflops: 316.71  mfu: 32.02%
[rank2]:2026-01-03 15:56:51,912 - Avg. fwd time: 7.0817 / Avg. bwd-weight time: 11.3217 / Avg. bwd-input time: 9.2140 / Avg. batch time: 559.7682 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:56:51,948 -  step: 1300  loss: -4.0000  grad_norm:  0.3598  memory: 46.44GiB(33.21%)  tps: 6,791  tflops: 316.71  mfu: 32.02%
[rank0]:2026-01-03 15:56:51,959 -  step: 1300  loss:  0.1785  grad_norm:  0.3598  memory: 63.64GiB(45.52%)  tps: 6,791  tflops: 316.72  mfu: 32.02%
[rank3]:2026-01-03 15:56:52,259 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1556_step1300_rank3.svg
[rank3]:			> Batch Time: 585.12 ms, GPU Bubble Ratio: 10.02%, 14.62%, 24.47%, 24.91%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  21-6-28ms      | [S0,MB3,F]  33-6-40ms      | [S0,MB4,F]  42-6-49ms      | [S0,MB5,F]  50-6-57ms      | [S0,MB6,F]  59-6-66ms      | [S7,MB0,F]  77-10-88ms     | [S7,MB0,BI] 90-11-101ms    | [S7,MB0,BW] 101-14-116ms   | [S7,MB1,F]  116-7-124ms    | [S7,MB1,BI] 126-11-137ms   | [S7,MB1,BW] 138-15-153ms   | [S7,MB2,F]  153-8-161ms    | [S7,MB2,BI] 163-11-175ms   | [S7,MB2,BW] 175-15-190ms   | [S7,MB3,F]  190-8-198ms    | [S7,MB3,BI] 200-11-212ms   | [S7,MB3,BW] 212-15-227ms   | [S0,MB7,F]  227-7-234ms    | [S0,MB0,B]  245-22-268ms   | [S7,MB4,F]  268-7-276ms    | [S7,MB4,BI] 278-11-289ms   | [S7,MB4,BW] 289-15-304ms   | [S0,MB1,B]  304-23-327ms   | [S7,MB5,F]  328-8-336ms    | [S7,MB5,BI] 338-11-350ms   | [S7,MB5,BW] 350-15-365ms   | [S0,MB2,B]  366-23-389ms   | [S7,MB6,F]  389-8-398ms    | [S7,MB6,BI] 400-11-412ms   | [S7,MB6,BW] 412-15-427ms   | [S0,MB3,B]  428-23-451ms   | [S7,MB7,F]  451-8-460ms    | [S7,MB7,BI] 462-11-473ms   | [S7,MB7,BW] 473-15-488ms   | [S0,MB4,B]  491-23-514ms   | [S0,MB5,B]  515-23-538ms   | [S0,MB6,B]  538-23-561ms   | [S0,MB7,B]  562-23-585ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-55ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-98ms      | [S6,MB0,BW] 98-11-110ms    | [S6,MB2,F]  110-6-116ms    | [S6,MB1,BI] 125-9-134ms    | [S6,MB1,BW] 134-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-171ms    | [S6,MB2,BW] 171-11-183ms   | [S1,MB6,F]  183-8-191ms    | [S1,MB0,BI] 199-11-211ms   | [S1,MB0,BW] 211-14-225ms   | [S6,MB4,F]  225-6-232ms    | [S6,MB3,BI] 232-9-241ms    | [S6,MB3,BW] 242-11-253ms   | [S1,MB7,F]  253-8-262ms    | [S1,MB1,BI] 277-11-288ms   | [S1,MB1,BW] 289-14-303ms   | [S6,MB5,F]  303-6-310ms    | [S6,MB4,BI] 310-9-319ms    | [S6,MB4,BW] 319-11-331ms   | [S1,MB2,BI] 338-11-349ms   | [S1,MB2,BW] 349-14-363ms   | [S6,MB6,F]  364-6-371ms    | [S6,MB5,BI] 371-9-380ms    | [S6,MB5,BW] 380-11-391ms   | [S1,MB3,BI] 400-11-412ms   | [S1,MB3,BW] 412-14-426ms   | [S6,MB7,F]  426-6-433ms    | [S6,MB6,BI] 433-9-442ms    | [S6,MB6,BW] 442-11-454ms   | [S1,MB4,BI] 461-11-473ms   | [S6,MB7,BI] 473-9-482ms    | [S1,MB5,BI] 482-11-493ms   | [S1,MB4,BW] 494-14-508ms   | [S1,MB6,BI] 508-11-520ms   | [S1,MB5,BW] 520-14-534ms   | [S1,MB7,BI] 534-11-546ms   | [S1,MB6,BW] 546-14-560ms   | [S6,MB7,BW] 560-11-572ms   | [S1,MB7,BW] 573-14-588ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 98-9-107ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-125ms    | [S5,MB1,BI] 134-9-143ms    | [S5,MB1,BW] 144-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-180ms    | [S2,MB0,BW] 181-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 208-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 241-9-250ms    | [S2,MB1,BW] 251-11-262ms   | [S5,MB5,F]  262-6-269ms    | [S5,MB3,BI] 269-9-278ms    | [S5,MB3,BW] 279-11-290ms   | [S2,MB7,F]  290-6-297ms    | [S2,MB2,BI] 319-9-328ms    | [S2,MB2,BW] 328-11-340ms   | [S5,MB6,F]  340-6-346ms    | [S5,MB4,BI] 347-9-356ms    | [S5,MB4,BW] 356-11-367ms   | [S2,MB3,BI] 380-9-389ms    | [S2,MB3,BW] 389-11-400ms   | [S5,MB7,F]  401-6-407ms    | [S5,MB5,BI] 408-9-417ms    | [S5,MB5,BW] 417-11-428ms   | [S2,MB4,BI] 442-9-451ms    | [S5,MB6,BI] 451-9-460ms    | [S2,MB5,BI] 461-9-470ms    | [S5,MB7,BI] 482-9-491ms    | [S2,MB6,BI] 491-9-500ms    | [S2,MB4,BW] 500-11-512ms   | [S2,MB7,BI] 512-9-521ms    | [S2,MB5,BW] 521-11-532ms   | [S5,MB6,BW] 532-11-544ms   | [S5,MB7,BW] 544-11-555ms   | [S2,MB6,BW] 557-11-569ms   | [S2,MB7,BW] 568-11-580ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-53ms      | [S4,MB1,F]  54-6-60ms      | [S3,MB2,F]  63-6-69ms      | [S4,MB2,F]  69-6-76ms      | [S3,MB3,F]  80-6-87ms      | [S4,MB3,F]  87-6-94ms      | [S4,MB0,BI] 107-9-116ms    | [S4,MB0,BW] 116-11-128ms   | [S3,MB4,F]  127-6-134ms    | [S3,MB0,BI] 143-9-152ms    | [S3,MB0,BW] 153-11-164ms   | [S4,MB4,F]  164-6-171ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-191ms   | [S3,MB5,F]  191-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 217-11-229ms   | [S4,MB5,F]  229-6-236ms    | [S4,MB2,BI] 236-9-245ms    | [S4,MB2,BW] 245-11-256ms   | [S3,MB6,F]  256-6-263ms    | [S3,MB2,BI] 278-9-287ms    | [S3,MB2,BW] 288-11-299ms   | [S4,MB6,F]  299-6-306ms    | [S4,MB3,BI] 306-9-315ms    | [S4,MB3,BW] 315-11-326ms   | [S3,MB7,F]  326-6-333ms    | [S3,MB3,BI] 356-9-365ms    | [S3,MB3,BW] 365-11-376ms   | [S4,MB7,F]  376-6-383ms    | [S4,MB4,BI] 383-9-392ms    | [S4,MB4,BW] 392-11-404ms   | [S3,MB4,BI] 417-9-426ms    | [S4,MB5,BI] 426-9-435ms    | [S3,MB5,BI] 435-9-444ms    | [S4,MB6,BI] 460-9-469ms    | [S3,MB6,BI] 470-9-479ms    | [S4,MB7,BI] 491-9-500ms    | [S3,MB7,BI] 500-9-509ms    | [S3,MB4,BW] 509-11-521ms   | [S4,MB5,BW] 521-11-532ms   | [S4,MB6,BW] 532-11-543ms   | [S4,MB7,BW] 543-11-554ms   | [S3,MB5,BW] 556-11-567ms   | [S3,MB6,BW] 568-11-579ms   | [S3,MB7,BW] 579-11-590ms  
[rank0]:2026-01-03 15:58:51,205 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 15:58:53,665 - Avg. fwd time: 7.9037 / Avg. full-bwd time: 23.2057 (Avg. bwd-weight time: 15.1747 / Avg. bwd-input time: 11.6307) / Avg. batch time: 585.1455 (ms) / GPU bubble ratio: 10.01%
[rank0]:2026-01-03 15:58:53,721 -  step: 1350  loss:  0.1237  grad_norm:  0.5286  memory: 63.64GiB(45.52%)  tps: 6,728  tflops: 313.79  mfu: 31.73%
[rank3]:2026-01-03 15:58:53,685 - Avg. fwd time: 7.0417 / Avg. bwd-weight time: 11.2362 / Avg. bwd-input time: 9.1553 / Avg. batch time: 560.4493 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 15:58:53,710 -  step: 1350  loss: -4.0000  grad_norm:  0.5286  memory: 49.97GiB(35.74%)  tps: 6,728  tflops: 313.79  mfu: 31.73%
[rank2]:2026-01-03 15:58:53,673 - Avg. fwd time: 7.0841 / Avg. bwd-weight time: 11.3223 / Avg. bwd-input time: 9.2156 / Avg. batch time: 559.8862 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 15:58:53,710 -  step: 1350  loss: -4.0000  grad_norm:  0.5286  memory: 46.44GiB(33.21%)  tps: 6,728  tflops: 313.79  mfu: 31.73%
[rank1]:2026-01-03 15:58:53,681 - Avg. fwd time: 8.0309 / Avg. bwd-weight time: 12.7670 / Avg. bwd-input time: 10.4275 / Avg. batch time: 579.1012 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 15:58:53,713 -  step: 1350  loss: -4.0000  grad_norm:  0.5286  memory: 52.63GiB(37.64%)  tps: 6,728  tflops: 313.79  mfu: 31.73%
[rank0]:2026-01-03 16:00:51,769 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:00:54,259 - Avg. fwd time: 7.9040 / Avg. full-bwd time: 23.2064 (Avg. bwd-weight time: 15.1749 / Avg. bwd-input time: 11.6310) / Avg. batch time: 585.1016 (ms) / GPU bubble ratio: 10.00%
[rank0]:2026-01-03 16:00:54,315 -  step: 1400  loss:  0.3585  grad_norm:  0.4784  memory: 63.64GiB(45.52%)  tps: 6,793  tflops: 316.83  mfu: 32.04%
[rank2]:2026-01-03 16:00:54,268 - Avg. fwd time: 7.0842 / Avg. bwd-weight time: 11.3223 / Avg. bwd-input time: 9.2159 / Avg. batch time: 559.8674 (ms) / GPU bubble ratio: 21.06%
[rank2]:2026-01-03 16:00:54,305 -  step: 1400  loss: -4.0000  grad_norm:  0.4784  memory: 46.44GiB(33.21%)  tps: 6,793  tflops: 316.83  mfu: 32.04%
[rank1]:2026-01-03 16:00:54,277 - Avg. fwd time: 8.0310 / Avg. bwd-weight time: 12.7670 / Avg. bwd-input time: 10.4276 / Avg. batch time: 579.0812 (ms) / GPU bubble ratio: 13.72%
[rank1]:2026-01-03 16:00:54,307 -  step: 1400  loss: -4.0000  grad_norm:  0.4784  memory: 52.63GiB(37.64%)  tps: 6,793  tflops: 316.83  mfu: 32.04%
[rank3]:2026-01-03 16:00:54,279 - Avg. fwd time: 7.0418 / Avg. bwd-weight time: 11.2362 / Avg. bwd-input time: 9.1556 / Avg. batch time: 560.4544 (ms) / GPU bubble ratio: 21.68%
[rank3]:2026-01-03 16:00:54,305 -  step: 1400  loss: -4.0000  grad_norm:  0.4784  memory: 49.97GiB(35.74%)  tps: 6,793  tflops: 316.83  mfu: 32.04%
[rank3]:2026-01-03 16:00:54,625 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1600_step1400_rank3.svg
[rank3]:			> Batch Time: 596.27 ms, GPU Bubble Ratio: 10.84%, 15.45%, 25.22%, 25.76%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  28-7-35ms      | [S0,MB3,F]  39-7-46ms      | [S0,MB4,F]  48-7-55ms      | [S0,MB5,F]  57-7-64ms      | [S0,MB6,F]  66-7-73ms      | [S7,MB0,F]  84-10-95ms     | [S7,MB0,BI] 97-11-108ms    | [S7,MB0,BW] 109-15-124ms   | [S7,MB1,F]  124-8-132ms    | [S7,MB1,BI] 134-11-145ms   | [S7,MB1,BW] 145-15-160ms   | [S7,MB2,F]  161-8-169ms    | [S7,MB2,BI] 171-11-182ms   | [S7,MB2,BW] 183-15-198ms   | [S7,MB3,F]  198-8-206ms    | [S7,MB3,BI] 208-11-220ms   | [S7,MB3,BW] 220-15-236ms   | [S0,MB7,F]  236-7-243ms    | [S0,MB0,B]  254-23-277ms   | [S7,MB4,F]  277-8-285ms    | [S7,MB4,BI] 287-11-299ms   | [S7,MB4,BW] 299-15-314ms   | [S0,MB1,B]  314-23-338ms   | [S7,MB5,F]  338-8-346ms    | [S7,MB5,BI] 348-11-360ms   | [S7,MB5,BW] 361-15-376ms   | [S0,MB2,B]  376-23-400ms   | [S7,MB6,F]  400-8-409ms    | [S7,MB6,BI] 411-11-423ms   | [S7,MB6,BW] 423-15-439ms   | [S0,MB3,B]  439-23-462ms   | [S7,MB7,F]  462-8-471ms    | [S7,MB7,BI] 473-11-485ms   | [S7,MB7,BW] 485-15-500ms   | [S0,MB4,B]  502-23-526ms   | [S0,MB5,B]  526-23-549ms   | [S0,MB6,B]  549-23-572ms   | [S0,MB7,B]  573-23-596ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  39-8-47ms      | [S1,MB4,F]  48-8-56ms      | [S6,MB0,F]  57-8-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-82ms      | [S6,MB0,BI] 90-9-100ms     | [S6,MB0,BW] 100-11-112ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-136ms    | [S6,MB1,BW] 136-11-148ms   | [S6,MB3,F]  148-6-155ms    | [S6,MB2,BI] 164-9-174ms    | [S6,MB2,BW] 174-11-185ms   | [S1,MB6,F]  185-8-194ms    | [S1,MB0,BI] 202-11-214ms   | [S1,MB0,BW] 214-14-228ms   | [S6,MB4,F]  228-6-235ms    | [S6,MB3,BI] 235-9-244ms    | [S6,MB3,BW] 245-11-256ms   | [S1,MB7,F]  256-8-265ms    | [S1,MB1,BI] 280-11-292ms   | [S1,MB1,BW] 292-14-306ms   | [S6,MB5,F]  306-6-313ms    | [S6,MB4,BI] 314-9-323ms    | [S6,MB4,BW] 323-11-334ms   | [S1,MB2,BI] 342-11-353ms   | [S1,MB2,BW] 353-14-368ms   | [S6,MB6,F]  368-6-375ms    | [S6,MB5,BI] 375-9-384ms    | [S6,MB5,BW] 384-11-396ms   | [S1,MB3,BI] 404-11-416ms   | [S1,MB3,BW] 416-14-430ms   | [S6,MB7,F]  430-6-437ms    | [S6,MB6,BI] 437-9-447ms    | [S6,MB6,BW] 447-11-458ms   | [S1,MB4,BI] 466-11-478ms   | [S6,MB7,BI] 478-9-487ms    | [S1,MB5,BI] 487-11-499ms   | [S1,MB4,BW] 499-14-513ms   | [S1,MB6,BI] 513-11-525ms   | [S1,MB5,BW] 525-14-539ms   | [S1,MB7,BI] 540-11-551ms   | [S1,MB6,BW] 552-14-566ms   | [S6,MB7,BW] 566-11-577ms   | [S1,MB7,BW] 579-14-593ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-56ms      | [S2,MB3,F]  57-6-64ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-6-82ms      | [S5,MB2,F]  82-6-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 109-11-121ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-145ms    | [S5,MB1,BW] 146-11-157ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 174-9-183ms    | [S2,MB0,BW] 183-11-194ms   | [S5,MB4,F]  194-6-201ms    | [S5,MB2,BI] 202-9-211ms    | [S5,MB2,BW] 211-11-222ms   | [S2,MB6,F]  222-7-229ms    | [S2,MB1,BI] 244-9-254ms    | [S2,MB1,BW] 254-11-265ms   | [S5,MB5,F]  265-6-272ms    | [S5,MB3,BI] 273-9-282ms    | [S5,MB3,BW] 282-11-293ms   | [S2,MB7,F]  294-7-301ms    | [S2,MB2,BI] 323-9-332ms    | [S2,MB2,BW] 332-11-343ms   | [S5,MB6,F]  344-6-350ms    | [S5,MB4,BI] 351-9-360ms    | [S5,MB4,BW] 360-11-371ms   | [S2,MB3,BI] 384-9-393ms    | [S2,MB3,BW] 394-11-405ms   | [S5,MB7,F]  405-6-412ms    | [S5,MB5,BI] 412-9-422ms    | [S5,MB5,BW] 422-11-433ms   | [S2,MB4,BI] 447-9-456ms    | [S5,MB6,BI] 456-9-465ms    | [S2,MB5,BI] 465-9-475ms    | [S5,MB7,BI] 487-9-496ms    | [S2,MB6,BI] 496-9-505ms    | [S2,MB4,BW] 506-11-517ms   | [S2,MB7,BI] 517-9-526ms    | [S2,MB5,BW] 527-11-538ms   | [S5,MB6,BW] 538-11-549ms   | [S5,MB7,BW] 550-11-561ms   | [S2,MB6,BW] 563-11-574ms   | [S2,MB7,BW] 574-11-585ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  82-6-89ms      | [S4,MB3,F]  89-6-96ms      | [S4,MB0,BI] 109-9-118ms    | [S4,MB0,BW] 118-11-130ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 145-9-154ms    | [S3,MB0,BW] 155-11-166ms   | [S4,MB4,F]  166-6-173ms    | [S4,MB1,BI] 173-9-182ms    | [S4,MB1,BW] 182-11-194ms   | [S3,MB5,F]  194-6-201ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 220-11-231ms   | [S4,MB5,F]  231-6-238ms    | [S4,MB2,BI] 238-9-248ms    | [S4,MB2,BW] 248-11-259ms   | [S3,MB6,F]  259-6-266ms    | [S3,MB2,BI] 282-9-291ms    | [S3,MB2,BW] 291-11-302ms   | [S4,MB6,F]  302-6-309ms    | [S4,MB3,BI] 310-9-319ms    | [S4,MB3,BW] 319-11-330ms   | [S3,MB7,F]  330-6-337ms    | [S3,MB3,BI] 360-9-369ms    | [S3,MB3,BW] 369-11-380ms   | [S4,MB7,F]  380-6-387ms    | [S4,MB4,BI] 387-9-396ms    | [S4,MB4,BW] 396-11-408ms   | [S3,MB4,BI] 421-9-430ms    | [S4,MB5,BI] 431-9-440ms    | [S3,MB5,BI] 440-9-449ms    | [S4,MB6,BI] 465-9-474ms    | [S3,MB6,BI] 474-9-484ms    | [S4,MB7,BI] 496-9-505ms    | [S3,MB7,BI] 505-9-515ms    | [S3,MB4,BW] 515-11-526ms   | [S4,MB5,BW] 526-11-537ms   | [S4,MB6,BW] 537-11-548ms   | [S4,MB7,BW] 548-11-560ms   | [S3,MB5,BW] 561-11-573ms   | [S3,MB6,BW] 573-11-584ms   | [S3,MB7,BW] 584-11-596ms  
[rank0]:2026-01-03 16:02:54,189 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:02:56,646 - Avg. fwd time: 7.9083 / Avg. full-bwd time: 23.2104 (Avg. bwd-weight time: 15.1781 / Avg. bwd-input time: 11.6350) / Avg. batch time: 585.3671 (ms) / GPU bubble ratio: 10.02%
[rank0]:2026-01-03 16:02:56,703 -  step: 1450  loss:  0.1859  grad_norm:  0.3927  memory: 63.64GiB(45.52%)  tps: 6,694  tflops: 312.19  mfu: 31.57%
[rank2]:2026-01-03 16:02:56,657 - Avg. fwd time: 7.0875 / Avg. bwd-weight time: 11.3232 / Avg. bwd-input time: 9.2178 / Avg. batch time: 560.0348 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:02:56,692 -  step: 1450  loss: -4.0000  grad_norm:  0.3927  memory: 46.44GiB(33.21%)  tps: 6,694  tflops: 312.19  mfu: 31.57%
[rank1]:2026-01-03 16:02:56,663 - Avg. fwd time: 8.0350 / Avg. bwd-weight time: 12.7680 / Avg. bwd-input time: 10.4297 / Avg. batch time: 579.2510 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 16:02:56,694 -  step: 1450  loss: -4.0000  grad_norm:  0.3927  memory: 52.63GiB(37.64%)  tps: 6,694  tflops: 312.19  mfu: 31.57%
[rank3]:2026-01-03 16:02:56,666 - Avg. fwd time: 7.0448 / Avg. bwd-weight time: 11.2370 / Avg. bwd-input time: 9.1573 / Avg. batch time: 560.5926 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 16:02:56,692 -  step: 1450  loss: -4.0000  grad_norm:  0.3927  memory: 49.97GiB(35.74%)  tps: 6,694  tflops: 312.19  mfu: 31.57%
[rank0]:2026-01-03 16:04:56,691 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:04:59,205 - Avg. fwd time: 7.9136 / Avg. full-bwd time: 23.2157 (Avg. bwd-weight time: 15.1820 / Avg. bwd-input time: 11.6400) / Avg. batch time: 585.6467 (ms) / GPU bubble ratio: 10.03%
[rank2]:2026-01-03 16:04:59,210 - Avg. fwd time: 7.0915 / Avg. bwd-weight time: 11.3242 / Avg. bwd-input time: 9.2201 / Avg. batch time: 560.1940 (ms) / GPU bubble ratio: 21.07%
[rank1]:2026-01-03 16:04:59,221 - Avg. fwd time: 8.0398 / Avg. bwd-weight time: 12.7694 / Avg. bwd-input time: 10.4323 / Avg. batch time: 579.4164 (ms) / GPU bubble ratio: 13.73%
[rank3]:2026-01-03 16:04:59,225 - Avg. fwd time: 7.0486 / Avg. bwd-weight time: 11.2379 / Avg. bwd-input time: 9.1595 / Avg. batch time: 560.7690 (ms) / GPU bubble ratio: 21.69%
[rank0]:2026-01-03 16:04:59,262 -  step: 1500  loss:  0.2554  grad_norm:  0.5268  memory: 63.64GiB(45.52%)  tps: 6,684  tflops: 311.75  mfu: 31.52%
[rank2]:2026-01-03 16:04:59,251 -  step: 1500  loss: -4.0000  grad_norm:  0.5268  memory: 46.44GiB(33.21%)  tps: 6,684  tflops: 311.75  mfu: 31.52%
[rank1]:2026-01-03 16:04:59,254 -  step: 1500  loss: -4.0000  grad_norm:  0.5268  memory: 52.63GiB(37.64%)  tps: 6,684  tflops: 311.75  mfu: 31.52%
[rank3]:2026-01-03 16:04:59,251 -  step: 1500  loss: -4.0000  grad_norm:  0.5268  memory: 49.97GiB(35.74%)  tps: 6,684  tflops: 311.75  mfu: 31.52%
[rank3]:2026-01-03 16:04:59,576 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1604_step1500_rank3.svg
[rank3]:			> Batch Time: 601.80 ms, GPU Bubble Ratio: 11.22%, 15.94%, 25.69%, 26.22%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  30-7-37ms      | [S0,MB3,F]  42-7-49ms      | [S0,MB4,F]  50-7-58ms      | [S0,MB5,F]  59-7-67ms      | [S0,MB6,F]  68-7-75ms      | [S7,MB0,F]  87-10-98ms     | [S7,MB0,BI] 100-11-111ms   | [S7,MB0,BW] 111-15-126ms   | [S7,MB1,F]  126-8-135ms    | [S7,MB1,BI] 136-11-148ms   | [S7,MB1,BW] 148-15-163ms   | [S7,MB2,F]  163-8-172ms    | [S7,MB2,BI] 174-11-185ms   | [S7,MB2,BW] 186-15-201ms   | [S7,MB3,F]  201-8-210ms    | [S7,MB3,BI] 212-11-224ms   | [S7,MB3,BW] 224-15-239ms   | [S0,MB7,F]  239-7-247ms    | [S0,MB0,B]  257-23-280ms   | [S7,MB4,F]  280-8-289ms    | [S7,MB4,BI] 290-11-302ms   | [S7,MB4,BW] 302-15-317ms   | [S0,MB1,B]  318-23-341ms   | [S7,MB5,F]  341-8-350ms    | [S7,MB5,BI] 352-11-364ms   | [S7,MB5,BW] 365-15-380ms   | [S0,MB2,B]  381-23-404ms   | [S7,MB6,F]  405-8-413ms    | [S7,MB6,BI] 415-11-427ms   | [S7,MB6,BW] 427-15-443ms   | [S0,MB3,B]  443-23-466ms   | [S7,MB7,F]  466-8-475ms    | [S7,MB7,BI] 477-11-489ms   | [S7,MB7,BW] 489-15-505ms   | [S0,MB4,B]  508-23-531ms   | [S0,MB5,B]  531-23-554ms   | [S0,MB6,B]  555-23-578ms   | [S0,MB7,B]  578-23-601ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-8-39ms      | [S1,MB3,F]  39-8-48ms      | [S1,MB4,F]  48-8-57ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-83ms      | [S6,MB0,BI] 91-9-100ms     | [S6,MB0,BW] 100-11-112ms   | [S6,MB2,F]  112-7-119ms    | [S6,MB1,BI] 127-9-137ms    | [S6,MB1,BW] 137-11-148ms   | [S6,MB3,F]  148-6-155ms    | [S6,MB2,BI] 165-9-174ms    | [S6,MB2,BW] 174-11-186ms   | [S1,MB6,F]  186-8-195ms    | [S1,MB0,BI] 203-11-214ms   | [S1,MB0,BW] 215-14-229ms   | [S6,MB4,F]  229-6-236ms    | [S6,MB3,BI] 236-9-246ms    | [S6,MB3,BW] 246-11-257ms   | [S1,MB7,F]  257-8-266ms    | [S1,MB1,BI] 281-11-293ms   | [S1,MB1,BW] 293-14-307ms   | [S6,MB5,F]  307-7-314ms    | [S6,MB4,BI] 315-9-324ms    | [S6,MB4,BW] 324-11-336ms   | [S1,MB2,BI] 343-11-355ms   | [S1,MB2,BW] 355-14-369ms   | [S6,MB6,F]  369-7-376ms    | [S6,MB5,BI] 377-9-386ms    | [S6,MB5,BW] 386-11-398ms   | [S1,MB3,BI] 406-11-418ms   | [S1,MB3,BW] 418-14-432ms   | [S6,MB7,F]  432-7-439ms    | [S6,MB6,BI] 440-9-449ms    | [S6,MB6,BW] 449-11-460ms   | [S1,MB4,BI] 468-11-480ms   | [S6,MB7,BI] 480-9-489ms    | [S1,MB5,BI] 490-11-501ms   | [S1,MB4,BW] 502-14-516ms   | [S1,MB6,BI] 516-11-528ms   | [S1,MB5,BW] 528-14-542ms   | [S1,MB7,BI] 542-11-554ms   | [S1,MB6,BW] 554-14-568ms   | [S6,MB7,BW] 569-11-580ms   | [S1,MB7,BW] 582-14-596ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-30ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  39-6-46ms      | [S5,MB0,F]  48-8-57ms      | [S2,MB3,F]  57-6-64ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-7-82ms      | [S5,MB2,F]  82-7-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 110-11-121ms   | [S5,MB3,F]  121-6-128ms    | [S5,MB1,BI] 137-9-146ms    | [S5,MB1,BW] 146-11-157ms   | [S2,MB5,F]  158-6-165ms    | [S2,MB0,BI] 174-9-183ms    | [S2,MB0,BW] 184-11-195ms   | [S5,MB4,F]  195-6-202ms    | [S5,MB2,BI] 202-9-211ms    | [S5,MB2,BW] 212-11-223ms   | [S2,MB6,F]  223-7-230ms    | [S2,MB1,BI] 245-9-255ms    | [S2,MB1,BW] 255-11-266ms   | [S5,MB5,F]  267-6-273ms    | [S5,MB3,BI] 274-9-283ms    | [S5,MB3,BW] 283-11-294ms   | [S2,MB7,F]  294-7-301ms    | [S2,MB2,BI] 324-9-333ms    | [S2,MB2,BW] 333-11-345ms   | [S5,MB6,F]  345-6-352ms    | [S5,MB4,BI] 352-9-361ms    | [S5,MB4,BW] 361-11-373ms   | [S2,MB3,BI] 386-9-395ms    | [S2,MB3,BW] 395-11-407ms   | [S5,MB7,F]  407-6-414ms    | [S5,MB5,BI] 414-9-423ms    | [S5,MB5,BW] 423-11-435ms   | [S2,MB4,BI] 449-9-458ms    | [S5,MB6,BI] 458-9-467ms    | [S2,MB5,BI] 468-9-477ms    | [S5,MB7,BI] 489-9-499ms    | [S2,MB6,BI] 499-9-508ms    | [S2,MB4,BW] 508-11-520ms   | [S2,MB7,BI] 520-9-529ms    | [S2,MB5,BW] 529-11-541ms   | [S5,MB6,BW] 541-11-552ms   | [S5,MB7,BW] 552-11-564ms   | [S2,MB6,BW] 565-11-577ms   | [S2,MB7,BW] 577-11-588ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  30-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  55-6-61ms      | [S3,MB2,F]  64-6-71ms      | [S4,MB2,F]  71-6-78ms      | [S3,MB3,F]  82-6-89ms      | [S4,MB3,F]  89-6-96ms      | [S4,MB0,BI] 109-9-119ms    | [S4,MB0,BW] 119-11-130ms   | [S3,MB4,F]  130-6-137ms    | [S3,MB0,BI] 146-9-155ms    | [S3,MB0,BW] 155-11-166ms   | [S4,MB4,F]  167-6-173ms    | [S4,MB1,BI] 173-9-183ms    | [S4,MB1,BW] 183-11-194ms   | [S3,MB5,F]  194-7-201ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 221-11-232ms   | [S4,MB5,F]  232-6-239ms    | [S4,MB2,BI] 239-9-248ms    | [S4,MB2,BW] 248-11-260ms   | [S3,MB6,F]  260-6-267ms    | [S3,MB2,BI] 283-9-292ms    | [S3,MB2,BW] 292-11-303ms   | [S4,MB6,F]  304-6-310ms    | [S4,MB3,BI] 311-9-320ms    | [S4,MB3,BW] 320-11-331ms   | [S3,MB7,F]  331-6-338ms    | [S3,MB3,BI] 361-9-370ms    | [S3,MB3,BW] 370-11-382ms   | [S4,MB7,F]  382-6-388ms    | [S4,MB4,BI] 389-9-398ms    | [S4,MB4,BW] 398-11-409ms   | [S3,MB4,BI] 423-9-432ms    | [S4,MB5,BI] 432-9-442ms    | [S3,MB5,BI] 442-9-451ms    | [S4,MB6,BI] 467-9-476ms    | [S3,MB6,BI] 477-9-486ms    | [S4,MB7,BI] 499-9-508ms    | [S3,MB7,BI] 508-9-517ms    | [S3,MB4,BW] 517-11-528ms   | [S4,MB5,BW] 528-11-540ms   | [S4,MB6,BW] 540-11-551ms   | [S4,MB7,BW] 551-11-562ms   | [S3,MB5,BW] 564-11-575ms   | [S3,MB6,BW] 576-11-587ms   | [S3,MB7,BW] 587-11-598ms  
[rank0]:2026-01-03 16:06:59,437 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 16:07:01,942 - Avg. fwd time: 7.0520 / Avg. bwd-weight time: 11.2386 / Avg. bwd-input time: 9.1614 / Avg. batch time: 560.9209 (ms) / GPU bubble ratio: 21.69%
[rank2]:2026-01-03 16:07:01,931 - Avg. fwd time: 7.0952 / Avg. bwd-weight time: 11.3251 / Avg. bwd-input time: 9.2223 / Avg. batch time: 560.3730 (ms) / GPU bubble ratio: 21.07%
[rank0]:2026-01-03 16:07:01,924 - Avg. fwd time: 7.9183 / Avg. full-bwd time: 23.2199 (Avg. bwd-weight time: 15.1854 / Avg. bwd-input time: 11.6443) / Avg. batch time: 585.9305 (ms) / GPU bubble ratio: 10.04%
[rank0]:2026-01-03 16:07:01,982 -  step: 1550  loss:  0.2659  grad_norm:  0.4955  memory: 63.64GiB(45.52%)  tps: 6,675  tflops: 311.34  mfu: 31.48%
[rank1]:2026-01-03 16:07:01,944 - Avg. fwd time: 8.0442 / Avg. bwd-weight time: 12.7706 / Avg. bwd-input time: 10.4346 / Avg. batch time: 579.6012 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 16:07:01,974 -  step: 1550  loss: -4.0000  grad_norm:  0.4955  memory: 52.63GiB(37.64%)  tps: 6,675  tflops: 311.34  mfu: 31.48%
[rank3]:2026-01-03 16:07:01,971 -  step: 1550  loss: -4.0000  grad_norm:  0.4955  memory: 49.97GiB(35.74%)  tps: 6,675  tflops: 311.34  mfu: 31.48%
[rank2]:2026-01-03 16:07:01,972 -  step: 1550  loss: -4.0000  grad_norm:  0.4955  memory: 46.44GiB(33.21%)  tps: 6,675  tflops: 311.34  mfu: 31.48%
[rank0]:2026-01-03 16:09:01,232 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 16:09:03,742 - Avg. fwd time: 7.9206 / Avg. full-bwd time: 23.2225 (Avg. bwd-weight time: 15.1872 / Avg. bwd-input time: 11.6466) / Avg. batch time: 586.0572 (ms) / GPU bubble ratio: 10.05%
[rank2]:2026-01-03 16:09:03,755 - Avg. fwd time: 7.0971 / Avg. bwd-weight time: 11.3255 / Avg. bwd-input time: 9.2235 / Avg. batch time: 560.4296 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:09:03,789 -  step: 1600  loss: -4.0000  grad_norm:  0.8231  memory: 46.44GiB(33.21%)  tps: 6,725  tflops: 313.65  mfu: 31.71%
[rank1]:2026-01-03 16:09:03,762 - Avg. fwd time: 8.0464 / Avg. bwd-weight time: 12.7711 / Avg. bwd-input time: 10.4358 / Avg. batch time: 579.6594 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 16:09:03,792 -  step: 1600  loss: -4.0000  grad_norm:  0.8231  memory: 52.63GiB(37.64%)  tps: 6,725  tflops: 313.65  mfu: 31.71%
[rank3]:2026-01-03 16:09:03,761 - Avg. fwd time: 7.0536 / Avg. bwd-weight time: 11.2390 / Avg. bwd-input time: 9.1625 / Avg. batch time: 560.9960 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:09:03,789 -  step: 1600  loss: -4.0000  grad_norm:  0.8231  memory: 49.97GiB(35.74%)  tps: 6,725  tflops: 313.65  mfu: 31.71%
[rank0]:2026-01-03 16:09:03,800 -  step: 1600  loss:  0.4017  grad_norm:  0.8231  memory: 63.64GiB(45.52%)  tps: 6,725  tflops: 313.65  mfu: 31.71%
[rank3]:2026-01-03 16:09:04,106 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1609_step1600_rank3.svg
[rank3]:			> Batch Time: 600.70 ms, GPU Bubble Ratio: 11.30%, 15.96%, 25.68%, 26.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  31-7-38ms      | [S0,MB3,F]  43-7-50ms      | [S0,MB4,F]  52-7-59ms      | [S0,MB5,F]  61-7-68ms      | [S0,MB6,F]  69-7-76ms      | [S7,MB0,F]  88-10-98ms     | [S7,MB0,BI] 100-11-112ms   | [S7,MB0,BW] 112-15-127ms   | [S7,MB1,F]  127-8-135ms    | [S7,MB1,BI] 137-11-149ms   | [S7,MB1,BW] 149-15-164ms   | [S7,MB2,F]  164-8-173ms    | [S7,MB2,BI] 175-11-186ms   | [S7,MB2,BW] 186-15-202ms   | [S7,MB3,F]  202-8-210ms    | [S7,MB3,BI] 212-11-224ms   | [S7,MB3,BW] 224-15-240ms   | [S0,MB7,F]  240-7-247ms    | [S0,MB0,B]  258-23-281ms   | [S7,MB4,F]  281-8-289ms    | [S7,MB4,BI] 291-11-303ms   | [S7,MB4,BW] 303-15-318ms   | [S0,MB1,B]  318-23-342ms   | [S7,MB5,F]  342-8-350ms    | [S7,MB5,BI] 352-11-364ms   | [S7,MB5,BW] 364-15-379ms   | [S0,MB2,B]  379-23-403ms   | [S7,MB6,F]  404-8-412ms    | [S7,MB6,BI] 415-11-426ms   | [S7,MB6,BW] 427-15-443ms   | [S0,MB3,B]  443-23-466ms   | [S7,MB7,F]  466-8-475ms    | [S7,MB7,BI] 477-11-488ms   | [S7,MB7,BW] 489-15-504ms   | [S0,MB4,B]  506-23-530ms   | [S0,MB5,B]  530-23-554ms   | [S0,MB6,B]  554-23-577ms   | [S0,MB7,B]  577-23-600ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-21ms      | [S1,MB1,F]  21-8-30ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  39-8-47ms      | [S1,MB4,F]  48-8-56ms      | [S6,MB0,F]  57-9-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-82ms      | [S6,MB0,BI] 90-9-100ms     | [S6,MB0,BW] 100-11-112ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-137ms    | [S6,MB1,BW] 137-11-148ms   | [S6,MB3,F]  148-6-155ms    | [S6,MB2,BI] 165-9-174ms    | [S6,MB2,BW] 174-11-185ms   | [S1,MB6,F]  186-8-194ms    | [S1,MB0,BI] 202-11-214ms   | [S1,MB0,BW] 214-14-228ms   | [S6,MB4,F]  228-6-235ms    | [S6,MB3,BI] 235-9-245ms    | [S6,MB3,BW] 245-11-256ms   | [S1,MB7,F]  256-8-265ms    | [S1,MB1,BI] 281-11-292ms   | [S1,MB1,BW] 293-14-307ms   | [S6,MB5,F]  307-6-314ms    | [S6,MB4,BI] 314-9-323ms    | [S6,MB4,BW] 323-11-335ms   | [S1,MB2,BI] 342-11-354ms   | [S1,MB2,BW] 354-14-368ms   | [S6,MB6,F]  368-6-375ms    | [S6,MB5,BI] 375-9-384ms    | [S6,MB5,BW] 385-11-396ms   | [S1,MB3,BI] 404-11-416ms   | [S1,MB3,BW] 416-14-430ms   | [S6,MB7,F]  430-6-437ms    | [S6,MB6,BI] 437-9-447ms    | [S6,MB6,BW] 447-11-458ms   | [S1,MB4,BI] 466-11-477ms   | [S6,MB7,BI] 477-9-487ms    | [S1,MB5,BI] 487-11-498ms   | [S1,MB4,BW] 499-14-513ms   | [S1,MB6,BI] 513-11-525ms   | [S1,MB5,BW] 525-14-539ms   | [S1,MB7,BI] 540-11-551ms   | [S1,MB6,BW] 551-14-565ms   | [S6,MB7,BW] 566-11-577ms   | [S1,MB7,BW] 579-14-593ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  21-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-56ms      | [S2,MB3,F]  57-6-64ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-6-82ms      | [S5,MB2,F]  82-6-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 109-11-121ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-146ms    | [S5,MB1,BW] 146-11-157ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 174-9-183ms    | [S2,MB0,BW] 183-11-195ms   | [S5,MB4,F]  195-6-202ms    | [S5,MB2,BI] 202-9-211ms    | [S5,MB2,BW] 211-11-223ms   | [S2,MB6,F]  223-7-230ms    | [S2,MB1,BI] 245-9-254ms    | [S2,MB1,BW] 254-11-265ms   | [S5,MB5,F]  266-6-273ms    | [S5,MB3,BI] 273-9-282ms    | [S5,MB3,BW] 282-11-293ms   | [S2,MB7,F]  294-7-301ms    | [S2,MB2,BI] 323-9-332ms    | [S2,MB2,BW] 332-11-344ms   | [S5,MB6,F]  344-6-351ms    | [S5,MB4,BI] 351-9-360ms    | [S5,MB4,BW] 360-11-372ms   | [S2,MB3,BI] 384-9-393ms    | [S2,MB3,BW] 394-11-405ms   | [S5,MB7,F]  405-6-412ms    | [S5,MB5,BI] 412-9-422ms    | [S5,MB5,BW] 422-11-433ms   | [S2,MB4,BI] 447-9-456ms    | [S5,MB6,BI] 456-9-465ms    | [S2,MB5,BI] 466-9-475ms    | [S5,MB7,BI] 487-9-496ms    | [S2,MB6,BI] 496-9-505ms    | [S2,MB4,BW] 506-11-517ms   | [S2,MB7,BI] 517-9-526ms    | [S2,MB5,BW] 526-11-538ms   | [S5,MB6,BW] 538-11-549ms   | [S5,MB7,BW] 549-11-560ms   | [S2,MB6,BW] 563-11-574ms   | [S2,MB7,BW] 574-11-585ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  82-6-89ms      | [S4,MB3,F]  89-6-96ms      | [S4,MB0,BI] 109-9-118ms    | [S4,MB0,BW] 118-11-130ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 146-9-155ms    | [S3,MB0,BW] 155-11-166ms   | [S4,MB4,F]  166-6-173ms    | [S4,MB1,BI] 173-9-183ms    | [S4,MB1,BW] 183-11-194ms   | [S3,MB5,F]  194-6-201ms    | [S3,MB1,BI] 211-9-220ms    | [S3,MB1,BW] 220-11-232ms   | [S4,MB5,F]  232-6-239ms    | [S4,MB2,BI] 239-9-248ms    | [S4,MB2,BW] 248-11-260ms   | [S3,MB6,F]  260-6-266ms    | [S3,MB2,BI] 282-9-291ms    | [S3,MB2,BW] 291-11-303ms   | [S4,MB6,F]  303-6-310ms    | [S4,MB3,BI] 310-9-319ms    | [S4,MB3,BW] 319-11-330ms   | [S3,MB7,F]  330-6-337ms    | [S3,MB3,BI] 360-9-369ms    | [S3,MB3,BW] 369-11-381ms   | [S4,MB7,F]  381-6-388ms    | [S4,MB4,BI] 388-9-397ms    | [S4,MB4,BW] 397-11-408ms   | [S3,MB4,BI] 421-9-431ms    | [S4,MB5,BI] 431-9-440ms    | [S3,MB5,BI] 440-9-449ms    | [S4,MB6,BI] 465-9-474ms    | [S3,MB6,BI] 475-9-484ms    | [S4,MB7,BI] 496-9-505ms    | [S3,MB7,BI] 505-9-514ms    | [S3,MB4,BW] 514-11-525ms   | [S4,MB5,BW] 526-11-537ms   | [S4,MB6,BW] 537-11-548ms   | [S4,MB7,BW] 548-11-560ms   | [S3,MB5,BW] 561-11-573ms   | [S3,MB6,BW] 572-11-584ms   | [S3,MB7,BW] 584-11-595ms  
[rank0]:2026-01-03 16:11:03,692 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 16:11:06,216 - Avg. fwd time: 7.0560 / Avg. bwd-weight time: 11.2394 / Avg. bwd-input time: 9.1637 / Avg. batch time: 561.0928 (ms) / GPU bubble ratio: 21.70%
[rank1]:2026-01-03 16:11:06,217 - Avg. fwd time: 8.0493 / Avg. bwd-weight time: 12.7718 / Avg. bwd-input time: 10.4374 / Avg. batch time: 579.7832 (ms) / GPU bubble ratio: 13.74%
[rank2]:2026-01-03 16:11:06,211 - Avg. fwd time: 7.0996 / Avg. bwd-weight time: 11.3261 / Avg. bwd-input time: 9.2250 / Avg. batch time: 560.5508 (ms) / GPU bubble ratio: 21.08%
[rank0]:2026-01-03 16:11:06,200 - Avg. fwd time: 7.9235 / Avg. full-bwd time: 23.2260 (Avg. bwd-weight time: 15.1894 / Avg. bwd-input time: 11.6495) / Avg. batch time: 586.2752 (ms) / GPU bubble ratio: 10.06%
[rank0]:2026-01-03 16:11:06,255 -  step: 1650  loss:  0.4330  grad_norm:  0.8537  memory: 63.64GiB(45.52%)  tps: 6,690  tflops: 312.02  mfu: 31.55%
[rank3]:2026-01-03 16:11:06,244 -  step: 1650  loss: -4.0000  grad_norm:  0.8537  memory: 49.97GiB(35.74%)  tps: 6,690  tflops: 312.01  mfu: 31.55%
[rank1]:2026-01-03 16:11:06,247 -  step: 1650  loss: -4.0000  grad_norm:  0.8537  memory: 52.63GiB(37.64%)  tps: 6,690  tflops: 312.01  mfu: 31.55%
[rank2]:2026-01-03 16:11:06,244 -  step: 1650  loss: -4.0000  grad_norm:  0.8537  memory: 46.44GiB(33.21%)  tps: 6,690  tflops: 312.01  mfu: 31.55%
[rank0]:2026-01-03 16:13:06,058 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:13:08,561 - Avg. fwd time: 7.9266 / Avg. full-bwd time: 23.2290 (Avg. bwd-weight time: 15.1918 / Avg. bwd-input time: 11.6525) / Avg. batch time: 586.4640 (ms) / GPU bubble ratio: 10.07%
[rank2]:2026-01-03 16:13:08,571 - Avg. fwd time: 7.1023 / Avg. bwd-weight time: 11.3268 / Avg. bwd-input time: 9.2265 / Avg. batch time: 560.6372 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:13:08,606 -  step: 1700  loss: -4.0000  grad_norm:  0.6612  memory: 46.44GiB(33.21%)  tps: 6,695  tflops: 312.25  mfu: 31.57%
[rank3]:2026-01-03 16:13:08,580 - Avg. fwd time: 7.0583 / Avg. bwd-weight time: 11.2399 / Avg. bwd-input time: 9.1650 / Avg. batch time: 561.1949 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:13:08,606 -  step: 1700  loss: -4.0000  grad_norm:  0.6612  memory: 49.97GiB(35.74%)  tps: 6,695  tflops: 312.25  mfu: 31.57%
[rank1]:2026-01-03 16:13:08,575 - Avg. fwd time: 8.0522 / Avg. bwd-weight time: 12.7725 / Avg. bwd-input time: 10.4391 / Avg. batch time: 579.8726 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 16:13:08,608 -  step: 1700  loss: -4.0000  grad_norm:  0.6612  memory: 52.63GiB(37.64%)  tps: 6,695  tflops: 312.25  mfu: 31.57%
[rank0]:2026-01-03 16:13:08,616 -  step: 1700  loss:  0.4006  grad_norm:  0.6612  memory: 63.64GiB(45.52%)  tps: 6,695  tflops: 312.25  mfu: 31.57%
[rank3]:2026-01-03 16:13:08,923 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1613_step1700_rank3.svg
[rank3]:			> Batch Time: 598.62 ms, GPU Bubble Ratio: 11.22%, 15.78%, 25.51%, 26.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  30-7-38ms      | [S0,MB3,F]  42-7-49ms      | [S0,MB4,F]  51-7-58ms      | [S0,MB5,F]  60-7-67ms      | [S0,MB6,F]  69-7-76ms      | [S7,MB0,F]  88-10-98ms     | [S7,MB0,BI] 100-11-111ms   | [S7,MB0,BW] 112-15-127ms   | [S7,MB1,F]  127-8-135ms    | [S7,MB1,BI] 137-11-148ms   | [S7,MB1,BW] 148-15-163ms   | [S7,MB2,F]  163-8-172ms    | [S7,MB2,BI] 174-11-185ms   | [S7,MB2,BW] 186-15-201ms   | [S7,MB3,F]  201-8-209ms    | [S7,MB3,BI] 211-11-223ms   | [S7,MB3,BW] 223-15-238ms   | [S0,MB7,F]  238-7-246ms    | [S0,MB0,B]  256-23-279ms   | [S7,MB4,F]  280-8-288ms    | [S7,MB4,BI] 290-11-301ms   | [S7,MB4,BW] 301-15-316ms   | [S0,MB1,B]  317-23-340ms   | [S7,MB5,F]  341-8-349ms    | [S7,MB5,BI] 351-11-363ms   | [S7,MB5,BW] 363-15-378ms   | [S0,MB2,B]  378-23-402ms   | [S7,MB6,F]  403-8-411ms    | [S7,MB6,BI] 413-11-425ms   | [S7,MB6,BW] 425-15-440ms   | [S0,MB3,B]  441-23-464ms   | [S7,MB7,F]  464-8-472ms    | [S7,MB7,BI] 475-11-486ms   | [S7,MB7,BW] 487-15-502ms   | [S0,MB4,B]  504-23-528ms   | [S0,MB5,B]  528-23-551ms   | [S0,MB6,B]  552-23-575ms   | [S0,MB7,B]  575-23-598ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  30-8-38ms      | [S1,MB3,F]  39-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  57-8-66ms      | [S1,MB5,F]  66-8-75ms      | [S6,MB1,F]  75-7-82ms      | [S6,MB0,BI] 90-9-100ms     | [S6,MB0,BW] 100-11-111ms   | [S6,MB2,F]  111-7-118ms    | [S6,MB1,BI] 127-9-136ms    | [S6,MB1,BW] 136-11-147ms   | [S6,MB3,F]  147-6-154ms    | [S6,MB2,BI] 164-9-173ms    | [S6,MB2,BW] 173-11-185ms   | [S1,MB6,F]  185-8-194ms    | [S1,MB0,BI] 201-11-213ms   | [S1,MB0,BW] 213-14-228ms   | [S6,MB4,F]  228-6-235ms    | [S6,MB3,BI] 235-9-244ms    | [S6,MB3,BW] 244-11-255ms   | [S1,MB7,F]  256-8-264ms    | [S1,MB1,BI] 280-11-291ms   | [S1,MB1,BW] 292-14-306ms   | [S6,MB5,F]  306-6-313ms    | [S6,MB4,BI] 313-9-322ms    | [S6,MB4,BW] 322-11-334ms   | [S1,MB2,BI] 341-11-353ms   | [S1,MB2,BW] 353-14-367ms   | [S6,MB6,F]  368-6-375ms    | [S6,MB5,BI] 375-9-384ms    | [S6,MB5,BW] 384-11-395ms   | [S1,MB3,BI] 403-11-415ms   | [S1,MB3,BW] 415-14-429ms   | [S6,MB7,F]  429-6-436ms    | [S6,MB6,BI] 437-9-446ms    | [S6,MB6,BW] 446-11-458ms   | [S1,MB4,BI] 464-11-476ms   | [S6,MB7,BI] 476-9-486ms    | [S1,MB5,BI] 486-11-497ms   | [S1,MB4,BW] 498-14-512ms   | [S1,MB6,BI] 512-11-524ms   | [S1,MB5,BW] 524-14-538ms   | [S1,MB7,BI] 538-11-550ms   | [S1,MB6,BW] 550-14-564ms   | [S6,MB7,BW] 565-11-576ms   | [S1,MB7,BW] 578-14-592ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  30-6-37ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  48-8-56ms      | [S2,MB3,F]  57-6-63ms      | [S5,MB1,F]  64-6-71ms      | [S2,MB4,F]  75-6-82ms      | [S5,MB2,F]  82-6-89ms      | [S5,MB0,BI] 100-9-109ms    | [S5,MB0,BW] 109-11-120ms   | [S5,MB3,F]  120-6-127ms    | [S5,MB1,BI] 136-9-145ms    | [S5,MB1,BW] 145-11-157ms   | [S2,MB5,F]  157-6-164ms    | [S2,MB0,BI] 173-9-182ms    | [S2,MB0,BW] 182-11-194ms   | [S5,MB4,F]  194-6-201ms    | [S5,MB2,BI] 201-9-210ms    | [S5,MB2,BW] 210-11-222ms   | [S2,MB6,F]  222-7-229ms    | [S2,MB1,BI] 244-9-253ms    | [S2,MB1,BW] 253-11-265ms   | [S5,MB5,F]  265-6-272ms    | [S5,MB3,BI] 272-9-281ms    | [S5,MB3,BW] 281-11-293ms   | [S2,MB7,F]  293-7-300ms    | [S2,MB2,BI] 322-9-331ms    | [S2,MB2,BW] 331-11-343ms   | [S5,MB6,F]  343-6-350ms    | [S5,MB4,BI] 350-9-359ms    | [S5,MB4,BW] 359-11-371ms   | [S2,MB3,BI] 384-9-393ms    | [S2,MB3,BW] 393-11-405ms   | [S5,MB7,F]  405-6-412ms    | [S5,MB5,BI] 412-9-421ms    | [S5,MB5,BW] 421-11-433ms   | [S2,MB4,BI] 446-9-455ms    | [S5,MB6,BI] 455-9-465ms    | [S2,MB5,BI] 465-9-474ms    | [S5,MB7,BI] 485-9-494ms    | [S2,MB6,BI] 495-9-504ms    | [S2,MB4,BW] 504-11-516ms   | [S2,MB7,BI] 516-9-525ms    | [S2,MB5,BW] 525-11-537ms   | [S5,MB6,BW] 536-11-548ms   | [S5,MB7,BW] 548-11-559ms   | [S2,MB6,BW] 561-11-573ms   | [S2,MB7,BW] 573-11-584ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-77ms      | [S3,MB3,F]  82-6-88ms      | [S4,MB3,F]  89-6-95ms      | [S4,MB0,BI] 109-9-118ms    | [S4,MB0,BW] 118-11-129ms   | [S3,MB4,F]  129-6-136ms    | [S3,MB0,BI] 145-9-154ms    | [S3,MB0,BW] 154-11-166ms   | [S4,MB4,F]  166-6-173ms    | [S4,MB1,BI] 173-9-182ms    | [S4,MB1,BW] 182-11-193ms   | [S3,MB5,F]  193-6-200ms    | [S3,MB1,BI] 210-9-219ms    | [S3,MB1,BW] 219-11-231ms   | [S4,MB5,F]  231-6-238ms    | [S4,MB2,BI] 238-9-247ms    | [S4,MB2,BW] 247-11-259ms   | [S3,MB6,F]  259-6-266ms    | [S3,MB2,BI] 281-9-290ms    | [S3,MB2,BW] 291-11-302ms   | [S4,MB6,F]  302-6-309ms    | [S4,MB3,BI] 309-9-318ms    | [S4,MB3,BW] 318-11-330ms   | [S3,MB7,F]  330-6-337ms    | [S3,MB3,BI] 359-9-368ms    | [S3,MB3,BW] 368-11-380ms   | [S4,MB7,F]  380-6-386ms    | [S4,MB4,BI] 387-9-396ms    | [S4,MB4,BW] 396-11-407ms   | [S3,MB4,BI] 421-9-430ms    | [S4,MB5,BI] 430-9-440ms    | [S3,MB5,BI] 440-9-449ms    | [S4,MB6,BI] 464-9-474ms    | [S3,MB6,BI] 474-9-483ms    | [S4,MB7,BI] 494-9-504ms    | [S3,MB7,BI] 504-9-513ms    | [S3,MB4,BW] 513-11-524ms   | [S4,MB5,BW] 524-11-536ms   | [S4,MB6,BW] 536-11-547ms   | [S4,MB7,BW] 547-11-558ms   | [S3,MB5,BW] 560-11-572ms   | [S3,MB6,BW] 571-11-583ms   | [S3,MB7,BW] 583-11-594ms  
[rank0]:2026-01-03 16:15:08,635 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:15:11,146 - Avg. fwd time: 7.9292 / Avg. full-bwd time: 23.2311 (Avg. bwd-weight time: 15.1936 / Avg. bwd-input time: 11.6550) / Avg. batch time: 586.6717 (ms) / GPU bubble ratio: 10.09%
[rank1]:2026-01-03 16:15:11,163 - Avg. fwd time: 8.0548 / Avg. bwd-weight time: 12.7732 / Avg. bwd-input time: 10.4404 / Avg. batch time: 579.9827 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 16:15:11,197 -  step: 1750  loss: -4.0000  grad_norm:  0.6319  memory: 52.63GiB(37.64%)  tps: 6,682  tflops: 311.67  mfu: 31.51%
[rank2]:2026-01-03 16:15:11,160 - Avg. fwd time: 7.1043 / Avg. bwd-weight time: 11.3272 / Avg. bwd-input time: 9.2277 / Avg. batch time: 560.7423 (ms) / GPU bubble ratio: 21.08%
[rank2]:2026-01-03 16:15:11,195 -  step: 1750  loss: -4.0000  grad_norm:  0.6319  memory: 46.44GiB(33.21%)  tps: 6,682  tflops: 311.67  mfu: 31.51%
[rank3]:2026-01-03 16:15:11,169 - Avg. fwd time: 7.0602 / Avg. bwd-weight time: 11.2403 / Avg. bwd-input time: 9.1661 / Avg. batch time: 561.2776 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:15:11,195 -  step: 1750  loss: -4.0000  grad_norm:  0.6319  memory: 49.97GiB(35.74%)  tps: 6,682  tflops: 311.67  mfu: 31.51%
[rank0]:2026-01-03 16:15:11,206 -  step: 1750  loss:  0.4086  grad_norm:  0.6319  memory: 63.64GiB(45.52%)  tps: 6,683  tflops: 311.67  mfu: 31.51%
[rank0]:2026-01-03 16:17:09,062 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:17:11,484 - Avg. fwd time: 7.9280 / Avg. full-bwd time: 23.2295 (Avg. bwd-weight time: 15.1923 / Avg. bwd-input time: 11.6533) / Avg. batch time: 586.5518 (ms) / GPU bubble ratio: 10.08%
[rank1]:2026-01-03 16:17:11,493 - Avg. fwd time: 8.0530 / Avg. bwd-weight time: 12.7727 / Avg. bwd-input time: 10.4395 / Avg. batch time: 579.8976 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 16:17:11,522 -  step: 1800  loss: -4.0000  grad_norm:  0.3102  memory: 52.63GiB(37.64%)  tps: 6,808  tflops: 317.54  mfu: 32.11%
[rank3]:2026-01-03 16:17:11,494 - Avg. fwd time: 7.0589 / Avg. bwd-weight time: 11.2400 / Avg. bwd-input time: 9.1655 / Avg. batch time: 561.2150 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:17:11,520 -  step: 1800  loss: -4.0000  grad_norm:  0.3102  memory: 49.97GiB(35.74%)  tps: 6,808  tflops: 317.54  mfu: 32.11%
[rank2]:2026-01-03 16:17:11,480 - Avg. fwd time: 7.1027 / Avg. bwd-weight time: 11.3268 / Avg. bwd-input time: 9.2270 / Avg. batch time: 560.6588 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:17:11,520 -  step: 1800  loss: -4.0000  grad_norm:  0.3102  memory: 46.44GiB(33.21%)  tps: 6,808  tflops: 317.54  mfu: 32.11%
[rank0]:2026-01-03 16:17:11,531 -  step: 1800  loss:  0.0770  grad_norm:  0.3102  memory: 63.64GiB(45.52%)  tps: 6,808  tflops: 317.54  mfu: 32.11%
[rank3]:2026-01-03 16:17:11,832 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1617_step1800_rank3.svg
[rank3]:			> Batch Time: 575.59 ms, GPU Bubble Ratio: 9.52%, 14.03%, 23.90%, 24.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-6-16ms       | [S0,MB2,F]  17-6-24ms      | [S0,MB3,F]  29-6-35ms      | [S0,MB4,F]  37-6-44ms      | [S0,MB5,F]  46-6-53ms      | [S0,MB6,F]  55-6-61ms      | [S7,MB0,F]  73-10-83ms     | [S7,MB0,BI] 85-11-96ms     | [S7,MB0,BW] 96-14-111ms    | [S7,MB1,F]  111-7-118ms    | [S7,MB1,BI] 120-11-132ms   | [S7,MB1,BW] 132-15-147ms   | [S7,MB2,F]  147-7-155ms    | [S7,MB2,BI] 157-11-168ms   | [S7,MB2,BW] 168-15-183ms   | [S7,MB3,F]  183-7-191ms    | [S7,MB3,BI] 193-11-204ms   | [S7,MB3,BW] 204-15-220ms   | [S0,MB7,F]  220-7-227ms    | [S0,MB0,B]  237-22-260ms   | [S7,MB4,F]  260-7-268ms    | [S7,MB4,BI] 270-11-281ms   | [S7,MB4,BW] 281-15-296ms   | [S0,MB1,B]  296-23-319ms   | [S7,MB5,F]  320-8-328ms    | [S7,MB5,BI] 330-11-342ms   | [S7,MB5,BW] 342-15-357ms   | [S0,MB2,B]  357-23-380ms   | [S7,MB6,F]  381-8-389ms    | [S7,MB6,BI] 391-11-403ms   | [S7,MB6,BW] 403-15-418ms   | [S0,MB3,B]  419-23-442ms   | [S7,MB7,F]  442-8-450ms    | [S7,MB7,BI] 453-11-464ms   | [S7,MB7,BW] 464-15-479ms   | [S0,MB4,B]  482-23-505ms   | [S0,MB5,B]  506-23-529ms   | [S0,MB6,B]  529-23-552ms   | [S0,MB7,B]  552-23-575ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  46-8-55ms      | [S6,MB0,F]  56-8-64ms      | [S1,MB5,F]  64-8-73ms      | [S6,MB1,F]  73-6-80ms      | [S6,MB0,BI] 88-9-97ms      | [S6,MB0,BW] 97-11-108ms    | [S6,MB2,F]  108-6-115ms    | [S6,MB1,BI] 123-9-133ms    | [S6,MB1,BW] 133-11-144ms   | [S6,MB3,F]  144-6-151ms    | [S6,MB2,BI] 160-9-169ms    | [S6,MB2,BW] 169-11-180ms   | [S1,MB6,F]  181-8-189ms    | [S1,MB0,BI] 196-11-208ms   | [S1,MB0,BW] 208-14-222ms   | [S6,MB4,F]  222-6-229ms    | [S6,MB3,BI] 229-9-238ms    | [S6,MB3,BW] 238-11-249ms   | [S1,MB7,F]  250-8-258ms    | [S1,MB1,BI] 273-11-284ms   | [S1,MB1,BW] 285-14-299ms   | [S6,MB5,F]  299-6-305ms    | [S6,MB4,BI] 306-9-315ms    | [S6,MB4,BW] 315-11-326ms   | [S1,MB2,BI] 333-11-345ms   | [S1,MB2,BW] 345-14-359ms   | [S6,MB6,F]  359-6-366ms    | [S6,MB5,BI] 366-9-375ms    | [S6,MB5,BW] 375-11-387ms   | [S1,MB3,BI] 395-11-407ms   | [S1,MB3,BW] 407-14-421ms   | [S6,MB7,F]  421-6-428ms    | [S6,MB6,BI] 428-9-437ms    | [S6,MB6,BW] 437-11-449ms   | [S1,MB4,BI] 457-11-468ms   | [S6,MB7,BI] 468-9-477ms    | [S1,MB5,BI] 478-11-489ms   | [S1,MB4,BW] 489-14-503ms   | [S1,MB6,BI] 504-11-515ms   | [S1,MB5,BW] 515-14-529ms   | [S1,MB7,BI] 530-11-541ms   | [S1,MB6,BW] 541-14-555ms   | [S6,MB7,BW] 556-11-567ms   | [S1,MB7,BW] 569-14-583ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  37-6-44ms      | [S5,MB0,F]  47-8-55ms      | [S2,MB3,F]  55-6-62ms      | [S5,MB1,F]  62-6-69ms      | [S2,MB4,F]  73-6-79ms      | [S5,MB2,F]  79-6-86ms      | [S5,MB0,BI] 97-9-106ms     | [S5,MB0,BW] 106-11-117ms   | [S5,MB3,F]  117-6-124ms    | [S5,MB1,BI] 132-9-142ms    | [S5,MB1,BW] 142-11-153ms   | [S2,MB5,F]  153-6-160ms    | [S2,MB0,BI] 169-9-178ms    | [S2,MB0,BW] 178-11-189ms   | [S5,MB4,F]  189-6-196ms    | [S5,MB2,BI] 196-9-205ms    | [S5,MB2,BW] 205-11-217ms   | [S2,MB6,F]  217-6-224ms    | [S2,MB1,BI] 238-9-247ms    | [S2,MB1,BW] 247-11-258ms   | [S5,MB5,F]  259-6-265ms    | [S5,MB3,BI] 265-9-275ms    | [S5,MB3,BW] 275-11-286ms   | [S2,MB7,F]  286-6-293ms    | [S2,MB2,BI] 315-9-324ms    | [S2,MB2,BW] 324-11-335ms   | [S5,MB6,F]  335-6-342ms    | [S5,MB4,BI] 342-9-351ms    | [S5,MB4,BW] 351-11-363ms   | [S2,MB3,BI] 375-9-384ms    | [S2,MB3,BW] 385-11-396ms   | [S5,MB7,F]  396-6-403ms    | [S5,MB5,BI] 403-9-412ms    | [S5,MB5,BW] 412-11-423ms   | [S2,MB4,BI] 437-9-446ms    | [S5,MB6,BI] 446-9-455ms    | [S2,MB5,BI] 456-9-465ms    | [S5,MB7,BI] 477-9-486ms    | [S2,MB6,BI] 486-9-495ms    | [S2,MB4,BW] 496-11-507ms   | [S2,MB7,BI] 507-9-516ms    | [S2,MB5,BW] 516-11-528ms   | [S5,MB6,BW] 528-11-539ms   | [S5,MB7,BW] 539-11-551ms   | [S2,MB6,BW] 552-11-564ms   | [S2,MB7,BW] 564-11-575ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  46-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-68ms      | [S4,MB2,F]  69-6-75ms      | [S3,MB3,F]  79-6-86ms      | [S4,MB3,F]  86-6-93ms      | [S4,MB0,BI] 106-9-115ms    | [S4,MB0,BW] 115-11-126ms   | [S3,MB4,F]  126-6-133ms    | [S3,MB0,BI] 141-9-150ms    | [S3,MB0,BW] 151-11-162ms   | [S4,MB4,F]  162-6-169ms    | [S4,MB1,BI] 169-9-178ms    | [S4,MB1,BW] 178-11-189ms   | [S3,MB5,F]  189-6-196ms    | [S3,MB1,BI] 205-9-214ms    | [S3,MB1,BW] 214-11-226ms   | [S4,MB5,F]  226-6-232ms    | [S4,MB2,BI] 233-9-242ms    | [S4,MB2,BW] 242-11-253ms   | [S3,MB6,F]  253-6-260ms    | [S3,MB2,BI] 274-9-284ms    | [S3,MB2,BW] 284-11-295ms   | [S4,MB6,F]  295-6-302ms    | [S4,MB3,BI] 302-9-311ms    | [S4,MB3,BW] 311-11-322ms   | [S3,MB7,F]  322-6-329ms    | [S3,MB3,BI] 351-9-360ms    | [S3,MB3,BW] 360-11-372ms   | [S4,MB7,F]  371-6-378ms    | [S4,MB4,BI] 378-9-387ms    | [S4,MB4,BW] 387-11-399ms   | [S3,MB4,BI] 412-9-421ms    | [S4,MB5,BI] 421-9-430ms    | [S3,MB5,BI] 430-9-439ms    | [S4,MB6,BI] 455-9-464ms    | [S3,MB6,BI] 464-9-474ms    | [S4,MB7,BI] 486-9-495ms    | [S3,MB7,BI] 495-9-504ms    | [S3,MB4,BW] 504-11-516ms   | [S4,MB5,BW] 516-11-527ms   | [S4,MB6,BW] 527-11-538ms   | [S4,MB7,BW] 538-11-550ms   | [S3,MB5,BW] 551-11-563ms   | [S3,MB6,BW] 562-11-574ms   | [S3,MB7,BW] 574-11-585ms  
[rank0]:2026-01-03 16:19:09,334 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:19:11,794 - Avg. fwd time: 7.9261 / Avg. full-bwd time: 23.2277 (Avg. bwd-weight time: 15.1910 / Avg. bwd-input time: 11.6515) / Avg. batch time: 586.4390 (ms) / GPU bubble ratio: 10.07%
[rank1]:2026-01-03 16:19:11,796 - Avg. fwd time: 8.0508 / Avg. bwd-weight time: 12.7720 / Avg. bwd-input time: 10.4383 / Avg. batch time: 579.8392 (ms) / GPU bubble ratio: 13.74%
[rank1]:2026-01-03 16:19:11,828 -  step: 1850  loss: -4.0000  grad_norm:  0.5589  memory: 52.63GiB(37.64%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank2]:2026-01-03 16:19:11,785 - Avg. fwd time: 7.1009 / Avg. bwd-weight time: 11.3263 / Avg. bwd-input time: 9.2259 / Avg. batch time: 560.6030 (ms) / GPU bubble ratio: 21.08%
[rank2]:2026-01-03 16:19:11,825 -  step: 1850  loss: -4.0000  grad_norm:  0.5589  memory: 46.44GiB(33.21%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank3]:2026-01-03 16:19:11,796 - Avg. fwd time: 7.0573 / Avg. bwd-weight time: 11.2396 / Avg. bwd-input time: 9.1646 / Avg. batch time: 561.1436 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:19:11,825 -  step: 1850  loss: -4.0000  grad_norm:  0.5589  memory: 49.97GiB(35.74%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank0]:2026-01-03 16:19:11,837 -  step: 1850  loss:  0.3554  grad_norm:  0.5589  memory: 63.64GiB(45.52%)  tps: 6,809  tflops: 317.59  mfu: 32.11%
[rank0]:2026-01-03 16:21:08,849 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:21:11,296 - Avg. fwd time: 7.9231 / Avg. full-bwd time: 23.2250 (Avg. bwd-weight time: 15.1889 / Avg. bwd-input time: 11.6486) / Avg. batch time: 586.2279 (ms) / GPU bubble ratio: 10.06%
[rank1]:2026-01-03 16:21:11,312 - Avg. fwd time: 8.0478 / Avg. bwd-weight time: 12.7711 / Avg. bwd-input time: 10.4366 / Avg. batch time: 579.7086 (ms) / GPU bubble ratio: 13.73%
[rank1]:2026-01-03 16:21:11,342 -  step: 1900  loss: -4.0000  grad_norm:  0.3101  memory: 52.65GiB(37.66%)  tps: 6,854  tflops: 319.69  mfu: 32.32%
[rank3]:2026-01-03 16:21:11,311 - Avg. fwd time: 7.0550 / Avg. bwd-weight time: 11.2390 / Avg. bwd-input time: 9.1633 / Avg. batch time: 561.0378 (ms) / GPU bubble ratio: 21.70%
[rank3]:2026-01-03 16:21:11,339 -  step: 1900  loss: -4.0000  grad_norm:  0.3101  memory: 49.97GiB(35.74%)  tps: 6,854  tflops: 319.69  mfu: 32.32%
[rank2]:2026-01-03 16:21:11,297 - Avg. fwd time: 7.0982 / Avg. bwd-weight time: 11.3255 / Avg. bwd-input time: 9.2244 / Avg. batch time: 560.4755 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:21:11,339 -  step: 1900  loss: -4.0000  grad_norm:  0.3101  memory: 46.44GiB(33.21%)  tps: 6,854  tflops: 319.69  mfu: 32.32%
[rank0]:2026-01-03 16:21:11,350 -  step: 1900  loss:  0.2037  grad_norm:  0.3101  memory: 63.64GiB(45.52%)  tps: 6,855  tflops: 319.70  mfu: 32.33%
[rank3]:2026-01-03 16:21:11,708 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1621_step1900_rank3.svg
[rank3]:			> Batch Time: 580.58 ms, GPU Bubble Ratio: 10.11%, 14.47%, 24.33%, 24.74%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-6-16ms       | [S0,MB2,F]  21-6-28ms      | [S0,MB3,F]  33-6-40ms      | [S0,MB4,F]  41-6-48ms      | [S0,MB5,F]  50-6-57ms      | [S0,MB6,F]  59-6-66ms      | [S7,MB0,F]  77-10-87ms     | [S7,MB0,BI] 89-11-100ms    | [S7,MB0,BW] 100-14-115ms   | [S7,MB1,F]  115-7-123ms    | [S7,MB1,BI] 125-11-136ms   | [S7,MB1,BW] 137-15-152ms   | [S7,MB2,F]  152-7-160ms    | [S7,MB2,BI] 162-11-173ms   | [S7,MB2,BW] 173-15-188ms   | [S7,MB3,F]  189-7-196ms    | [S7,MB3,BI] 198-11-210ms   | [S7,MB3,BW] 210-15-225ms   | [S0,MB7,F]  225-7-232ms    | [S0,MB0,B]  243-22-266ms   | [S7,MB4,F]  266-7-274ms    | [S7,MB4,BI] 276-11-287ms   | [S7,MB4,BW] 287-15-302ms   | [S0,MB1,B]  302-23-325ms   | [S7,MB5,F]  326-8-334ms    | [S7,MB5,BI] 336-11-347ms   | [S7,MB5,BW] 348-15-363ms   | [S0,MB2,B]  363-23-386ms   | [S7,MB6,F]  386-8-395ms    | [S7,MB6,BI] 397-11-409ms   | [S7,MB6,BW] 409-15-424ms   | [S0,MB3,B]  424-23-448ms   | [S7,MB7,F]  448-8-456ms    | [S7,MB7,BI] 458-11-469ms   | [S7,MB7,BW] 470-15-485ms   | [S0,MB4,B]  487-23-510ms   | [S0,MB5,B]  511-23-534ms   | [S0,MB6,B]  534-23-557ms   | [S0,MB7,B]  557-23-580ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-46ms      | [S1,MB4,F]  46-8-55ms      | [S6,MB0,F]  56-8-64ms      | [S1,MB5,F]  65-8-73ms      | [S6,MB1,F]  73-6-80ms      | [S6,MB0,BI] 88-9-97ms      | [S6,MB0,BW] 97-11-109ms    | [S6,MB2,F]  109-6-116ms    | [S6,MB1,BI] 124-9-133ms    | [S6,MB1,BW] 133-11-145ms   | [S6,MB3,F]  145-6-151ms    | [S6,MB2,BI] 161-9-170ms    | [S6,MB2,BW] 170-11-181ms   | [S1,MB6,F]  181-8-190ms    | [S1,MB0,BI] 198-11-209ms   | [S1,MB0,BW] 209-14-223ms   | [S6,MB4,F]  224-6-230ms    | [S6,MB3,BI] 230-9-240ms    | [S6,MB3,BW] 240-11-251ms   | [S1,MB7,F]  251-8-260ms    | [S1,MB1,BI] 275-11-286ms   | [S1,MB1,BW] 286-14-301ms   | [S6,MB5,F]  301-6-307ms    | [S6,MB4,BI] 307-9-317ms    | [S6,MB4,BW] 317-11-328ms   | [S1,MB2,BI] 335-11-346ms   | [S1,MB2,BW] 346-14-361ms   | [S6,MB6,F]  361-6-367ms    | [S6,MB5,BI] 368-9-377ms    | [S6,MB5,BW] 377-11-388ms   | [S1,MB3,BI] 396-11-408ms   | [S1,MB3,BW] 408-14-422ms   | [S6,MB7,F]  422-6-429ms    | [S6,MB6,BI] 429-9-438ms    | [S6,MB6,BW] 438-11-450ms   | [S1,MB4,BI] 457-11-469ms   | [S6,MB7,BI] 469-9-478ms    | [S1,MB5,BI] 478-11-490ms   | [S1,MB4,BW] 490-14-504ms   | [S1,MB6,BI] 504-11-516ms   | [S1,MB5,BW] 516-14-530ms   | [S1,MB7,BI] 530-11-542ms   | [S1,MB6,BW] 542-14-556ms   | [S6,MB7,BW] 556-11-568ms   | [S1,MB7,BW] 569-14-584ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-44ms      | [S5,MB0,F]  47-8-55ms      | [S2,MB3,F]  55-6-62ms      | [S5,MB1,F]  62-6-69ms      | [S2,MB4,F]  73-6-80ms      | [S5,MB2,F]  80-6-86ms      | [S5,MB0,BI] 97-9-106ms     | [S5,MB0,BW] 107-11-118ms   | [S5,MB3,F]  118-6-124ms    | [S5,MB1,BI] 133-9-142ms    | [S5,MB1,BW] 142-11-154ms   | [S2,MB5,F]  154-6-160ms    | [S2,MB0,BI] 170-9-179ms    | [S2,MB0,BW] 179-11-190ms   | [S5,MB4,F]  190-6-197ms    | [S5,MB2,BI] 197-9-206ms    | [S5,MB2,BW] 206-11-218ms   | [S2,MB6,F]  218-6-225ms    | [S2,MB1,BI] 239-9-248ms    | [S2,MB1,BW] 249-11-260ms   | [S5,MB5,F]  260-6-267ms    | [S5,MB3,BI] 267-9-276ms    | [S5,MB3,BW] 276-11-288ms   | [S2,MB7,F]  288-6-295ms    | [S2,MB2,BI] 316-9-325ms    | [S2,MB2,BW] 326-11-337ms   | [S5,MB6,F]  337-6-344ms    | [S5,MB4,BI] 344-9-353ms    | [S5,MB4,BW] 353-11-364ms   | [S2,MB3,BI] 376-9-386ms    | [S2,MB3,BW] 386-11-397ms   | [S5,MB7,F]  397-6-404ms    | [S5,MB5,BI] 404-9-413ms    | [S5,MB5,BW] 413-11-425ms   | [S2,MB4,BI] 437-9-447ms    | [S5,MB6,BI] 447-9-456ms    | [S2,MB5,BI] 456-9-465ms    | [S5,MB7,BI] 478-9-487ms    | [S2,MB6,BI] 487-9-496ms    | [S2,MB4,BW] 496-11-508ms   | [S2,MB7,BI] 508-9-517ms    | [S2,MB5,BW] 517-11-528ms   | [S5,MB6,BW] 528-11-540ms   | [S5,MB7,BW] 540-11-551ms   | [S2,MB6,BW] 553-11-564ms   | [S2,MB7,BW] 564-11-576ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-37ms      | [S4,MB0,F]  38-8-46ms      | [S3,MB1,F]  46-6-53ms      | [S4,MB1,F]  53-6-60ms      | [S3,MB2,F]  62-6-69ms      | [S4,MB2,F]  69-6-75ms      | [S3,MB3,F]  79-6-86ms      | [S4,MB3,F]  86-6-93ms      | [S4,MB0,BI] 106-9-115ms    | [S4,MB0,BW] 115-11-127ms   | [S3,MB4,F]  126-6-133ms    | [S3,MB0,BI] 142-9-151ms    | [S3,MB0,BW] 151-11-163ms   | [S4,MB4,F]  163-6-169ms    | [S4,MB1,BI] 169-9-178ms    | [S4,MB1,BW] 179-11-190ms   | [S3,MB5,F]  190-6-197ms    | [S3,MB1,BI] 206-9-215ms    | [S3,MB1,BW] 215-11-227ms   | [S4,MB5,F]  227-6-234ms    | [S4,MB2,BI] 234-9-243ms    | [S4,MB2,BW] 243-11-254ms   | [S3,MB6,F]  254-6-261ms    | [S3,MB2,BI] 276-9-285ms    | [S3,MB2,BW] 285-11-297ms   | [S4,MB6,F]  297-6-304ms    | [S4,MB3,BI] 304-9-313ms    | [S4,MB3,BW] 313-11-324ms   | [S3,MB7,F]  324-6-331ms    | [S3,MB3,BI] 353-9-362ms    | [S3,MB3,BW] 362-11-373ms   | [S4,MB7,F]  373-6-380ms    | [S4,MB4,BI] 380-9-389ms    | [S4,MB4,BW] 389-11-401ms   | [S3,MB4,BI] 413-9-422ms    | [S4,MB5,BI] 422-9-431ms    | [S3,MB5,BI] 431-9-440ms    | [S4,MB6,BI] 456-9-465ms    | [S3,MB6,BI] 465-9-474ms    | [S4,MB7,BI] 487-9-496ms    | [S3,MB7,BI] 496-9-505ms    | [S3,MB4,BW] 505-11-516ms   | [S4,MB5,BW] 517-11-528ms   | [S4,MB6,BW] 528-11-539ms   | [S4,MB7,BW] 539-11-550ms   | [S3,MB5,BW] 552-11-564ms   | [S3,MB6,BW] 563-11-575ms   | [S3,MB7,BW] 575-11-586ms  
[rank0]:2026-01-03 16:23:08,637 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 16:23:11,087 - Avg. fwd time: 7.9196 / Avg. full-bwd time: 23.2215 (Avg. bwd-weight time: 15.1866 / Avg. bwd-input time: 11.6453) / Avg. batch time: 586.0618 (ms) / GPU bubble ratio: 10.05%
[rank1]:2026-01-03 16:23:11,119 - Avg. fwd time: 8.0445 / Avg. bwd-weight time: 12.7702 / Avg. bwd-input time: 10.4347 / Avg. batch time: 579.6050 (ms) / GPU bubble ratio: 13.74%
[rank2]:2026-01-03 16:23:11,091 - Avg. fwd time: 7.0952 / Avg. bwd-weight time: 11.3247 / Avg. bwd-input time: 9.2227 / Avg. batch time: 560.3730 (ms) / GPU bubble ratio: 21.07%
[rank2]:2026-01-03 16:23:11,147 -  step: 1950  loss: -4.0000  grad_norm:  0.2721  memory: 46.44GiB(33.21%)  tps: 6,838  tflops: 318.91  mfu: 32.25%
[rank3]:2026-01-03 16:23:11,103 - Avg. fwd time: 7.0524 / Avg. bwd-weight time: 11.2383 / Avg. bwd-input time: 9.1619 / Avg. batch time: 560.9154 (ms) / GPU bubble ratio: 21.69%
[rank3]:2026-01-03 16:23:11,147 -  step: 1950  loss: -4.0000  grad_norm:  0.2721  memory: 49.97GiB(35.74%)  tps: 6,838  tflops: 318.91  mfu: 32.25%
[rank0]:2026-01-03 16:23:11,158 -  step: 1950  loss:  0.1740  grad_norm:  0.2721  memory: 63.64GiB(45.52%)  tps: 6,838  tflops: 318.91  mfu: 32.25%
[rank1]:2026-01-03 16:23:11,150 -  step: 1950  loss: -4.0000  grad_norm:  0.2721  memory: 52.65GiB(37.66%)  tps: 6,838  tflops: 318.91  mfu: 32.25%
[rank0]:2026-01-03 16:25:07,863 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-03 16:25:10,320 - Avg. fwd time: 7.0924 / Avg. bwd-weight time: 11.3239 / Avg. bwd-input time: 9.2210 / Avg. batch time: 560.2312 (ms) / GPU bubble ratio: 21.07%
[rank1]:2026-01-03 16:25:10,345 - Avg. fwd time: 8.0412 / Avg. bwd-weight time: 12.7691 / Avg. bwd-input time: 10.4327 / Avg. batch time: 579.4592 (ms) / GPU bubble ratio: 13.73%
[rank3]:2026-01-03 16:25:10,333 - Avg. fwd time: 7.0499 / Avg. bwd-weight time: 11.2377 / Avg. bwd-input time: 9.1605 / Avg. batch time: 560.7949 (ms) / GPU bubble ratio: 21.69%
[rank0]:2026-01-03 16:25:10,320 - Avg. fwd time: 7.9162 / Avg. full-bwd time: 23.2182 (Avg. bwd-weight time: 15.1842 / Avg. bwd-input time: 11.6420) / Avg. batch time: 585.8352 (ms) / GPU bubble ratio: 10.04%
[rank0]:2026-01-03 16:25:10,383 -  step: 2000  loss:  0.2086  grad_norm:  0.2596  memory: 63.64GiB(45.52%)  tps: 6,871  tflops: 320.47  mfu: 32.40%
[rank0]:2026-01-03 16:25:10,383 - â„¹ï¸ final step: 2000  loss:  0.2086  grad_norm:  0.2596  tps: 6,869  tflops: 320.37  mfu: 31.10%
[rank0]:2026-01-03 16:25:10,383 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 16:25:10,392 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2026-01-03 16:25:10,372 -  step: 2000  loss: -4.0000  grad_norm:  0.2596  memory: 46.44GiB(33.21%)  tps: 6,871  tflops: 320.47  mfu: 32.40%
[rank1]:2026-01-03 16:25:10,374 -  step: 2000  loss: -4.0000  grad_norm:  0.2596  memory: 52.65GiB(37.66%)  tps: 6,871  tflops: 320.47  mfu: 32.40%
[rank2]:2026-01-03 16:25:10,372 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2596  tps: 6,865  tflops: 320.21  mfu: 31.10%
[rank1]:2026-01-03 16:25:10,374 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2596  tps: 6,864  tflops: 320.16  mfu: 31.10%
[rank1]:2026-01-03 16:25:10,375 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 16:25:10,372 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 16:25:10,378 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2026-01-03 16:25:10,380 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-03 16:25:10,372 -  step: 2000  loss: -4.0000  grad_norm:  0.2596  memory: 49.97GiB(35.74%)  tps: 6,871  tflops: 320.47  mfu: 32.40%
[rank3]:2026-01-03 16:25:10,372 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2596  tps: 6,894  tflops: 321.52  mfu: 31.17%
[rank3]:2026-01-03 16:25:10,372 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-03 16:25:10,377 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-03 16:25:22,898 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-03 16:25:22,956 - Destroying the purge thread.
[rank1]:2026-01-03 16:25:22,956 - Destroying the purge thread.
[rank0]:2026-01-03 16:25:22,957 - Sleeping 2 seconds for other ranks to complete
[rank3]:2026-01-03 16:25:23,247 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1625_final2000_rank3.svg
[rank3]:			> Batch Time: 588.64 ms, GPU Bubble Ratio: 10.30%, 14.85%, 24.67%, 25.19%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-9-9ms        | [S0,MB1,F]  9-7-16ms       | [S0,MB2,F]  24-7-31ms      | [S0,MB3,F]  35-6-42ms      | [S0,MB4,F]  44-6-51ms      | [S0,MB5,F]  53-6-60ms      | [S0,MB6,F]  62-6-69ms      | [S7,MB0,F]  80-10-90ms     | [S7,MB0,BI] 92-11-104ms    | [S7,MB0,BW] 104-14-119ms   | [S7,MB1,F]  119-7-127ms    | [S7,MB1,BI] 129-11-140ms   | [S7,MB1,BW] 140-15-155ms   | [S7,MB2,F]  155-8-163ms    | [S7,MB2,BI] 165-11-177ms   | [S7,MB2,BW] 177-15-192ms   | [S7,MB3,F]  192-8-201ms    | [S7,MB3,BI] 203-11-214ms   | [S7,MB3,BW] 214-15-230ms   | [S0,MB7,F]  230-7-237ms    | [S0,MB0,B]  247-23-270ms   | [S7,MB4,F]  271-8-279ms    | [S7,MB4,BI] 281-11-292ms   | [S7,MB4,BW] 292-15-307ms   | [S0,MB1,B]  307-23-331ms   | [S7,MB5,F]  331-8-339ms    | [S7,MB5,BI] 341-11-353ms   | [S7,MB5,BW] 353-15-368ms   | [S0,MB2,B]  369-23-392ms   | [S7,MB6,F]  393-8-401ms    | [S7,MB6,BI] 403-11-415ms   | [S7,MB6,BW] 415-15-431ms   | [S0,MB3,B]  431-23-454ms   | [S7,MB7,F]  455-8-463ms    | [S7,MB7,BI] 465-11-476ms   | [S7,MB7,BW] 477-15-492ms   | [S0,MB4,B]  495-23-518ms   | [S0,MB5,B]  518-23-541ms   | [S0,MB6,B]  542-23-565ms   | [S0,MB7,B]  565-23-588ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  9-11-20ms      | [S1,MB1,F]  21-8-29ms      | [S1,MB2,F]  29-8-38ms      | [S1,MB3,F]  38-8-47ms      | [S1,MB4,F]  47-8-56ms      | [S6,MB0,F]  56-8-65ms      | [S1,MB5,F]  65-8-74ms      | [S6,MB1,F]  74-6-81ms      | [S6,MB0,BI] 89-9-99ms      | [S6,MB0,BW] 99-11-110ms    | [S6,MB2,F]  110-6-117ms    | [S6,MB1,BI] 125-9-135ms    | [S6,MB1,BW] 135-11-146ms   | [S6,MB3,F]  146-6-153ms    | [S6,MB2,BI] 162-9-172ms    | [S6,MB2,BW] 172-11-183ms   | [S1,MB6,F]  183-8-192ms    | [S1,MB0,BI] 200-11-211ms   | [S1,MB0,BW] 211-14-226ms   | [S6,MB4,F]  226-6-232ms    | [S6,MB3,BI] 232-9-242ms    | [S6,MB3,BW] 242-11-253ms   | [S1,MB7,F]  253-8-262ms    | [S1,MB1,BI] 277-11-289ms   | [S1,MB1,BW] 289-14-303ms   | [S6,MB5,F]  303-6-310ms    | [S6,MB4,BI] 310-9-319ms    | [S6,MB4,BW] 319-11-331ms   | [S1,MB2,BI] 338-11-350ms   | [S1,MB2,BW] 350-14-364ms   | [S6,MB6,F]  364-6-371ms    | [S6,MB5,BI] 371-9-380ms    | [S6,MB5,BW] 380-11-392ms   | [S1,MB3,BI] 400-11-412ms   | [S1,MB3,BW] 412-14-426ms   | [S6,MB7,F]  426-6-433ms    | [S6,MB6,BI] 433-9-442ms    | [S6,MB6,BW] 443-11-454ms   | [S1,MB4,BI] 462-11-473ms   | [S6,MB7,BI] 473-9-483ms    | [S1,MB5,BI] 483-11-495ms   | [S1,MB4,BW] 495-14-509ms   | [S1,MB6,BI] 509-11-521ms   | [S1,MB5,BW] 521-14-535ms   | [S1,MB7,BI] 535-11-547ms   | [S1,MB6,BW] 547-14-561ms   | [S6,MB7,BW] 561-11-573ms   | [S1,MB7,BW] 574-14-589ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  20-8-29ms      | [S2,MB1,F]  29-6-36ms      | [S2,MB2,F]  38-6-45ms      | [S5,MB0,F]  47-8-56ms      | [S2,MB3,F]  56-6-63ms      | [S5,MB1,F]  63-6-70ms      | [S2,MB4,F]  74-6-81ms      | [S5,MB2,F]  81-6-88ms      | [S5,MB0,BI] 99-9-108ms     | [S5,MB0,BW] 108-11-119ms   | [S5,MB3,F]  119-6-126ms    | [S5,MB1,BI] 135-9-144ms    | [S5,MB1,BW] 144-11-155ms   | [S2,MB5,F]  155-6-162ms    | [S2,MB0,BI] 171-9-181ms    | [S2,MB0,BW] 181-11-192ms   | [S5,MB4,F]  192-6-199ms    | [S5,MB2,BI] 199-9-208ms    | [S5,MB2,BW] 209-11-220ms   | [S2,MB6,F]  220-6-227ms    | [S2,MB1,BI] 242-9-251ms    | [S2,MB1,BW] 251-11-262ms   | [S5,MB5,F]  263-6-269ms    | [S5,MB3,BI] 269-9-279ms    | [S5,MB3,BW] 279-11-290ms   | [S2,MB7,F]  290-6-297ms    | [S2,MB2,BI] 319-9-328ms    | [S2,MB2,BW] 329-11-340ms   | [S5,MB6,F]  340-6-347ms    | [S5,MB4,BI] 347-9-356ms    | [S5,MB4,BW] 356-11-368ms   | [S2,MB3,BI] 380-9-389ms    | [S2,MB3,BW] 390-11-401ms   | [S5,MB7,F]  401-6-408ms    | [S5,MB5,BI] 408-9-417ms    | [S5,MB5,BW] 417-11-429ms   | [S2,MB4,BI] 442-9-452ms    | [S5,MB6,BI] 452-9-461ms    | [S2,MB5,BI] 461-9-470ms    | [S5,MB7,BI] 483-9-492ms    | [S2,MB6,BI] 492-9-501ms    | [S2,MB4,BW] 501-11-513ms   | [S2,MB7,BI] 513-9-522ms    | [S2,MB5,BW] 522-11-533ms   | [S5,MB6,BW] 533-11-545ms   | [S5,MB7,BW] 545-11-556ms   | [S2,MB6,BW] 558-11-569ms   | [S2,MB7,BW] 569-11-581ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  29-8-38ms      | [S4,MB0,F]  38-8-47ms      | [S3,MB1,F]  47-6-54ms      | [S4,MB1,F]  54-6-61ms      | [S3,MB2,F]  63-6-70ms      | [S4,MB2,F]  70-6-76ms      | [S3,MB3,F]  81-6-88ms      | [S4,MB3,F]  88-6-94ms      | [S4,MB0,BI] 108-9-117ms    | [S4,MB0,BW] 117-11-128ms   | [S3,MB4,F]  128-6-135ms    | [S3,MB0,BI] 144-9-153ms    | [S3,MB0,BW] 153-11-164ms   | [S4,MB4,F]  164-6-171ms    | [S4,MB1,BI] 171-9-180ms    | [S4,MB1,BW] 180-11-192ms   | [S3,MB5,F]  192-6-198ms    | [S3,MB1,BI] 208-9-217ms    | [S3,MB1,BW] 218-11-229ms   | [S4,MB5,F]  229-6-236ms    | [S4,MB2,BI] 236-9-245ms    | [S4,MB2,BW] 245-11-257ms   | [S3,MB6,F]  257-6-263ms    | [S3,MB2,BI] 278-9-288ms    | [S3,MB2,BW] 288-11-299ms   | [S4,MB6,F]  299-6-306ms    | [S4,MB3,BI] 306-9-315ms    | [S4,MB3,BW] 315-11-327ms   | [S3,MB7,F]  327-6-334ms    | [S3,MB3,BI] 356-9-365ms    | [S3,MB3,BW] 365-11-376ms   | [S4,MB7,F]  377-6-383ms    | [S4,MB4,BI] 383-9-393ms    | [S4,MB4,BW] 393-11-404ms   | [S3,MB4,BI] 417-9-426ms    | [S4,MB5,BI] 426-9-436ms    | [S3,MB5,BI] 436-9-445ms    | [S4,MB6,BI] 461-9-470ms    | [S3,MB6,BI] 470-9-479ms    | [S4,MB7,BI] 492-9-501ms    | [S3,MB7,BI] 501-9-510ms    | [S3,MB4,BW] 510-11-521ms   | [S4,MB5,BW] 521-11-533ms   | [S4,MB6,BW] 533-11-544ms   | [S4,MB7,BW] 544-11-555ms   | [S3,MB5,BW] 557-11-568ms   | [S3,MB6,BW] 569-11-580ms   | [S3,MB7,BW] 580-11-591ms  
[rank3]:2026-01-03 16:25:23,535 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200/pipeline_schedule/260103_1625_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 361.37 ms, GPU Bubble Ratio: 0.00%, 0.00%, 0.00%, 0.00%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-7-7ms        | [S0,MB1,F]  7-7-15ms       | [S0,MB2,F]  15-7-22ms      | [S0,MB3,F]  22-7-30ms      | [S0,MB4,F]  30-7-37ms      | [S0,MB5,F]  37-7-45ms      | [S0,MB6,F]  45-7-52ms      | [S7,MB0,F]  52-7-60ms      | [S7,MB0,BI] 60-7-67ms      | [S7,MB0,BW] 67-7-75ms      | [S7,MB1,F]  75-7-82ms      | [S7,MB1,BI] 82-7-90ms      | [S7,MB1,BW] 90-7-97ms      | [S7,MB2,F]  97-7-105ms     | [S7,MB2,BI] 105-7-112ms    | [S7,MB2,BW] 112-7-120ms    | [S7,MB3,F]  120-7-127ms    | [S7,MB3,BI] 127-7-135ms    | [S7,MB3,BW] 135-7-143ms    | [S0,MB7,F]  143-7-150ms    | [S0,MB0,B]  150-15-165ms   | [S7,MB4,F]  165-7-173ms    | [S7,MB4,BI] 173-7-180ms    | [S7,MB4,BW] 180-7-188ms    | [S0,MB1,B]  188-15-203ms   | [S7,MB5,F]  203-7-210ms    | [S7,MB5,BI] 210-7-218ms    | [S7,MB5,BW] 218-7-225ms    | [S0,MB2,B]  225-15-240ms   | [S7,MB6,F]  240-7-248ms    | [S7,MB6,BI] 248-7-255ms    | [S7,MB6,BW] 255-7-263ms    | [S0,MB3,B]  263-15-278ms   | [S7,MB7,F]  278-7-286ms    | [S7,MB7,BI] 286-7-293ms    | [S7,MB7,BW] 293-7-301ms    | [S0,MB4,B]  301-15-316ms   | [S0,MB5,B]  316-15-331ms   | [S0,MB6,B]  331-15-346ms   | [S0,MB7,B]  346-15-361ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  7-7-15ms       | [S1,MB1,F]  15-7-22ms      | [S1,MB2,F]  22-7-30ms      | [S1,MB3,F]  30-7-37ms      | [S1,MB4,F]  37-7-45ms      | [S6,MB0,F]  45-7-52ms      | [S1,MB5,F]  52-7-60ms      | [S6,MB1,F]  60-7-67ms      | [S6,MB0,BI] 67-7-75ms      | [S6,MB0,BW] 75-7-82ms      | [S6,MB2,F]  82-7-90ms      | [S6,MB1,BI] 90-7-97ms      | [S6,MB1,BW] 97-7-105ms     | [S6,MB3,F]  105-7-112ms    | [S6,MB2,BI] 112-7-120ms    | [S6,MB2,BW] 120-7-127ms    | [S1,MB6,F]  127-7-135ms    | [S1,MB0,BI] 135-7-143ms    | [S1,MB0,BW] 143-7-150ms    | [S6,MB4,F]  150-7-158ms    | [S6,MB3,BI] 158-7-165ms    | [S6,MB3,BW] 165-7-173ms    | [S1,MB7,F]  173-7-180ms    | [S1,MB1,BI] 180-7-188ms    | [S1,MB1,BW] 188-7-195ms    | [S6,MB5,F]  195-7-203ms    | [S6,MB4,BI] 203-7-210ms    | [S6,MB4,BW] 210-7-218ms    | [S1,MB2,BI] 218-7-225ms    | [S1,MB2,BW] 225-7-233ms    | [S6,MB6,F]  233-7-240ms    | [S6,MB5,BI] 240-7-248ms    | [S6,MB5,BW] 248-7-255ms    | [S1,MB3,BI] 255-7-263ms    | [S1,MB3,BW] 263-7-271ms    | [S6,MB7,F]  271-7-278ms    | [S6,MB6,BI] 278-7-286ms    | [S6,MB6,BW] 286-7-293ms    | [S1,MB4,BI] 293-7-301ms    | [S6,MB7,BI] 301-7-308ms    | [S1,MB5,BI] 308-7-316ms    | [S1,MB4,BW] 316-7-323ms    | [S1,MB6,BI] 323-7-331ms    | [S1,MB5,BW] 331-7-338ms    | [S1,MB7,BI] 338-7-346ms    | [S1,MB6,BW] 346-7-353ms    | [S6,MB7,BW] 353-7-361ms    | [S1,MB7,BW] 361-7-368ms   
[rank3]:			  [Rank 2]	[S2,MB0,F]  15-7-22ms      | [S2,MB1,F]  22-7-30ms      | [S2,MB2,F]  30-7-37ms      | [S5,MB0,F]  37-7-45ms      | [S2,MB3,F]  45-7-52ms      | [S5,MB1,F]  52-7-60ms      | [S2,MB4,F]  60-7-67ms      | [S5,MB2,F]  67-7-75ms      | [S5,MB0,BI] 75-7-82ms      | [S5,MB0,BW] 82-7-90ms      | [S5,MB3,F]  90-7-97ms      | [S5,MB1,BI] 97-7-105ms     | [S5,MB1,BW] 105-7-112ms    | [S2,MB5,F]  112-7-120ms    | [S2,MB0,BI] 120-7-127ms    | [S2,MB0,BW] 127-7-135ms    | [S5,MB4,F]  135-7-143ms    | [S5,MB2,BI] 143-7-150ms    | [S5,MB2,BW] 150-7-158ms    | [S2,MB6,F]  158-7-165ms    | [S2,MB1,BI] 165-7-173ms    | [S2,MB1,BW] 173-7-180ms    | [S5,MB5,F]  180-7-188ms    | [S5,MB3,BI] 188-7-195ms    | [S5,MB3,BW] 195-7-203ms    | [S2,MB7,F]  203-7-210ms    | [S2,MB2,BI] 210-7-218ms    | [S2,MB2,BW] 218-7-225ms    | [S5,MB6,F]  225-7-233ms    | [S5,MB4,BI] 233-7-240ms    | [S5,MB4,BW] 240-7-248ms    | [S2,MB3,BI] 248-7-255ms    | [S2,MB3,BW] 255-7-263ms    | [S5,MB7,F]  263-7-271ms    | [S5,MB5,BI] 271-7-278ms    | [S5,MB5,BW] 278-7-286ms    | [S2,MB4,BI] 286-7-293ms    | [S5,MB6,BI] 293-7-301ms    | [S2,MB5,BI] 301-7-308ms    | [S5,MB7,BI] 308-7-316ms    | [S2,MB6,BI] 316-7-323ms    | [S2,MB4,BW] 323-7-331ms    | [S2,MB7,BI] 331-7-338ms    | [S2,MB5,BW] 338-7-346ms    | [S5,MB6,BW] 346-7-353ms    | [S5,MB7,BW] 353-7-361ms    | [S2,MB6,BW] 361-7-368ms    | [S2,MB7,BW] 368-7-376ms   
[rank3]:			  [Rank 3]	[S3,MB0,F]  22-7-30ms      | [S4,MB0,F]  30-7-37ms      | [S3,MB1,F]  37-7-45ms      | [S4,MB1,F]  45-7-52ms      | [S3,MB2,F]  52-7-60ms      | [S4,MB2,F]  60-7-67ms      | [S3,MB3,F]  67-7-75ms      | [S4,MB3,F]  75-7-82ms      | [S4,MB0,BI] 82-7-90ms      | [S4,MB0,BW] 90-7-97ms      | [S3,MB4,F]  97-7-105ms     | [S3,MB0,BI] 105-7-112ms    | [S3,MB0,BW] 112-7-120ms    | [S4,MB4,F]  120-7-127ms    | [S4,MB1,BI] 127-7-135ms    | [S4,MB1,BW] 135-7-143ms    | [S3,MB5,F]  143-7-150ms    | [S3,MB1,BI] 150-7-158ms    | [S3,MB1,BW] 158-7-165ms    | [S4,MB5,F]  165-7-173ms    | [S4,MB2,BI] 173-7-180ms    | [S4,MB2,BW] 180-7-188ms    | [S3,MB6,F]  188-7-195ms    | [S3,MB2,BI] 195-7-203ms    | [S3,MB2,BW] 203-7-210ms    | [S4,MB6,F]  210-7-218ms    | [S4,MB3,BI] 218-7-225ms    | [S4,MB3,BW] 225-7-233ms    | [S3,MB7,F]  233-7-240ms    | [S3,MB3,BI] 240-7-248ms    | [S3,MB3,BW] 248-7-255ms    | [S4,MB7,F]  255-7-263ms    | [S4,MB4,BI] 263-7-271ms    | [S4,MB4,BW] 271-7-278ms    | [S3,MB4,BI] 278-7-286ms    | [S4,MB5,BI] 286-7-293ms    | [S3,MB5,BI] 293-7-301ms    | [S4,MB6,BI] 301-7-308ms    | [S3,MB6,BI] 308-7-316ms    | [S4,MB7,BI] 316-7-323ms    | [S3,MB7,BI] 323-7-331ms    | [S3,MB4,BW] 331-7-338ms    | [S4,MB5,BW] 338-7-346ms    | [S4,MB6,BW] 346-7-353ms    | [S4,MB7,BW] 353-7-361ms    | [S3,MB5,BW] 361-7-368ms    | [S3,MB6,BW] 368-7-376ms    | [S3,MB7,BW] 376-7-383ms   
[rank3]:2026-01-03 16:25:23,535 - Destroying the purge thread.
[rank0]:2026-01-03 16:25:24,958 - Training completed
[rank0]:2026-01-03 16:25:24,959 - Destroying the purge thread.
[rank0]:wandb: updating run metadata
[rank0]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank0]:wandb: uploading data
[rank0]:wandb: 
[rank0]:wandb: Run history:
[rank0]:wandb:      final/avg_end_to_end(s) â–
[rank0]:wandb:               final/avg_loss â–
[rank0]:wandb:             final/avg_mfu(%) â–
[rank0]:wandb:             final/avg_tflops â–
[rank0]:wandb:    final/avg_throughput(tps) â–
[rank0]:wandb:              final/grad_norm â–
[rank0]:wandb:               final/max_loss â–
[rank0]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: Run summary:
[rank0]:wandb:      final/avg_end_to_end(s) 2.38523
[rank0]:wandb:               final/avg_loss 0.20857
[rank0]:wandb:             final/avg_mfu(%) 31.10397
[rank0]:wandb:             final/avg_tflops 320.36853
[rank0]:wandb:    final/avg_throughput(tps) 6868.94147
[rank0]:wandb:              final/grad_norm 0.25958
[rank0]:wandb:               final/max_loss 0.20857
[rank0]:wandb:                    grad_norm 0.25958
[rank0]:wandb: loss_metrics/global_avg_loss 0.20857
[rank0]:wandb: loss_metrics/global_max_loss 0.20857
[rank0]:wandb:                          +14 ...
[rank0]:wandb: 
[rank0]:wandb: ðŸš€ View run 260102_ZBVZeroBubble_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/ev9k400q
[rank0]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank0]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank0]:wandb: Find logs at: ._data/tb/260102_ZBVZeroBubble_nofreeze_h200/20260103-1503/wandb/run-20260103_150339-ev9k400q/logs
[rank1]:2026-01-03 16:25:26,300 - Process group destroyed
[rank2]:2026-01-03 16:25:26,321 - Process group destroyed
[rank3]:2026-01-03 16:25:26,300 - Process group destroyed
[rank0]:2026-01-03 16:25:26,479 - Process group destroyed
[rank2]:[W103 16:25:27.079510188 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W103 16:25:27.085606654 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:[W103 16:25:27.095812768 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W103 16:25:28.024518998 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:Stage 1: Modules to keep: {'layers.6', 'layers.7', 'layers.8', 'layers.5', 'layers.4'}
[rank1]:Stage 6: Modules to keep: {'layers.26', 'layers.28', 'layers.27', 'layers.25'}
[rank2]:Stage 2: Modules to keep: {'layers.11', 'layers.10', 'layers.12', 'layers.9'}
[rank2]:Stage 5: Modules to keep: {'layers.22', 'layers.21', 'layers.24', 'layers.23'}
[rank0]:Stage 0: Modules to keep: {'layers.1', 'layers.3', 'layers.2', 'tok_embeddings', 'layers.0'}
[rank0]:Stage 7: Modules to keep: {'layers.29', 'output', 'layers.30', 'norm', 'layers.31'}
[rank3]:Stage 3: Modules to keep: {'layers.13', 'layers.15', 'layers.16', 'layers.14'}
[rank3]:Stage 4: Modules to keep: {'layers.19', 'layers.18', 'layers.20', 'layers.17'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_ZBVZeroBubble_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: ZBVZeroBubble
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 2
[rank3]:		- stages_list: [3, 4]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_ZBVZeroBubble_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W103 16:25:34.323999116 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
