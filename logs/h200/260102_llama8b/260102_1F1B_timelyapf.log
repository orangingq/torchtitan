
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Sat Jan  3 03:06:30 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_1F1B_timelyapf.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with timelyapf x 1F1B ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.0001 --freezing.max_freeze_ratio=0.8 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0103 03:06:31.502000 3127616 site-packages/torch/distributed/run.py:803] 
W0103 03:06:31.502000 3127616 site-packages/torch/distributed/run.py:803] *****************************************
W0103 03:06:31.502000 3127616 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0103 03:06:31.502000 3127616 site-packages/torch/distributed/run.py:803] *****************************************
[rank2]:2026-01-03 03:06:38,220 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank0]:2026-01-03 03:06:38,637 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank2]:2026-01-03 03:06:38,597 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-03 03:06:38,600 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-03 03:06:38,605 - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2026-01-03 03:06:38,649 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank3]:2026-01-03 03:06:38,776 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank1]:2026-01-03 03:06:39,396 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-03 03:06:39,398 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-03 03:06:39,403 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 03:06:39,395 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-03 03:06:39,396 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-03 03:06:39,401 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-03 03:06:39,401 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 03:06:39,402 - Loading tokenizer from tokenizer.json
[rank3]:2026-01-03 03:06:39,461 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-03 03:06:39,463 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-03 03:06:39,468 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-03 03:06:39,707 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2026-01-03 03:06:41,484 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2026-01-03 03:06:41,737 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-03 03:06:41,726 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2026-01-03 03:06:41,825 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-03 03:06:41,825 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank0]:2026-01-03 03:06:41,790 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-03 03:06:41,813 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-03 03:06:41,814 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-03 03:06:42,136 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-03 03:06:42,137 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2026-01-03 03:06:42,122 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-03 03:06:42,122 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2026-01-03 03:06:42,055 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2026-01-03 03:06:42,163 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-03 03:06:42,163 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank2]:2026-01-03 03:06:42,372 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-03 03:06:42,372 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: setting up run rlr7zidy
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_1F1B_timelyapf_h200/20260103-0306/wandb/run-20260103_030642-rlr7zidy
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_1F1B_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/rlr7zidy
[rank3]:2026-01-03 03:06:43,645 - WandB logging enabled
[rank3]:2026-01-03 03:06:43,646 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-03 03:06:43,723 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-03 03:06:43,723 - Using pipeline schedule 1F1B with 8 microbatches and 4 stages.
[rank1]:2026-01-03 03:06:43,985 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 03:06:43,984 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_1F1B_timelyapf_h200
[rank0]:2026-01-03 03:06:43,984 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 03:06:43,985 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-03 03:06:43,985 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank3]:2026-01-03 03:06:43,959 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-03 03:06:43,960 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2026-01-03 03:06:43,985 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-03 03:06:43,984 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-03 03:06:54,283 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-03 03:06:54,283 - Finished loading the checkpoint in 10.30 seconds.
[rank0]:2026-01-03 03:06:54,283 - Training starts at step 1
[rank1]:2026-01-03 03:06:58,428 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 36.44GiB(26.06%)  tps: 985  tflops: 45.96  mfu: 4.65%
[rank1]:2026-01-03 03:06:58,428 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-03 03:06:58,425 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 29.25GiB(20.92%)  tps: 1,006  tflops: 46.92  mfu: 4.74%
[rank2]:2026-01-03 03:06:58,426 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-03 03:06:58,444 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 35.49GiB(25.39%)  tps: 1,111  tflops: 51.82  mfu: 5.24%
[rank3]:2026-01-03 03:06:58,444 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 03:06:58,449 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 41.54GiB(29.71%)  tps: 983  tflops: 45.87  mfu: 4.64%
[rank0]:2026-01-03 03:06:58,449 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-03 03:09:16,295 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:09:19,031 - Avg. fwd time: 15.4697 / Avg. bwd time: 45.7720 / Avg. batch time: 508.7558 (ms) / GPU bubble ratio: 3.70%
[rank1]:2026-01-03 03:09:19,125 - Avg. fwd time: 16.1650 / Avg. bwd time: 45.3236 / Avg. batch time: 634.6596 (ms) / GPU bubble ratio: 22.49%
[rank2]:2026-01-03 03:09:19,076 - Avg. fwd time: 14.3627 / Avg. bwd time: 40.2285 / Avg. batch time: 568.2342 (ms) / GPU bubble ratio: 23.14%
[rank0]:2026-01-03 03:09:19,172 - Avg. fwd time: 14.5081 / Avg. bwd time: 42.7227 / Avg. batch time: 697.4502 (ms) / GPU bubble ratio: 34.35%
[rank1]:2026-01-03 03:09:19,204 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 51.01GiB(36.48%)  tps: 5,703  tflops: 265.98  mfu: 26.89%
[rank2]:2026-01-03 03:09:19,201 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 42.23GiB(30.21%)  tps: 5,703  tflops: 265.98  mfu: 26.89%
[rank0]:2026-01-03 03:09:19,208 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 58.66GiB(41.96%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank3]:2026-01-03 03:09:19,206 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 48.72GiB(34.84%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank0]:2026-01-03 03:11:39,963 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:11:42,691 - Avg. fwd time: 15.4808 / Avg. bwd time: 45.8345 / Avg. batch time: 508.6046 (ms) / GPU bubble ratio: 3.56%
[rank1]:2026-01-03 03:11:42,785 - Avg. fwd time: 16.1365 / Avg. bwd time: 45.3538 / Avg. batch time: 633.9218 (ms) / GPU bubble ratio: 22.40%
[rank2]:2026-01-03 03:11:42,736 - Avg. fwd time: 14.3569 / Avg. bwd time: 40.2805 / Avg. batch time: 567.8083 (ms) / GPU bubble ratio: 23.02%
[rank1]:2026-01-03 03:11:42,864 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 51.01GiB(36.48%)  tps: 5,702  tflops: 265.96  mfu: 26.89%
[rank1]:2026-01-03 03:11:42,864 - Nothing to draw before the end of warmup.
[rank2]:2026-01-03 03:11:42,861 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 42.23GiB(30.21%)  tps: 5,702  tflops: 265.96  mfu: 26.89%
[rank2]:2026-01-03 03:11:42,862 - Nothing to draw before the end of warmup.
[rank0]:2026-01-03 03:11:42,832 - Avg. fwd time: 14.4852 / Avg. bwd time: 42.8121 / Avg. batch time: 696.3782 (ms) / GPU bubble ratio: 34.18%
[rank0]:2026-01-03 03:11:42,868 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 58.66GiB(41.96%)  tps: 5,702  tflops: 265.96  mfu: 26.89%
[rank0]:2026-01-03 03:11:42,868 - Nothing to draw before the end of warmup.
[rank3]:2026-01-03 03:11:42,866 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 48.72GiB(34.84%)  tps: 5,702  tflops: 265.96  mfu: 26.89%
[rank3]:2026-01-03 03:11:42,866 - Nothing to draw before the end of warmup.
[rank0]:2026-01-03 03:14:03,590 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:14:06,324 - Avg. fwd time: 15.4757 / Avg. bwd time: 45.8606 / Avg. batch time: 508.5269 (ms) / GPU bubble ratio: 3.51%
[rank2]:2026-01-03 03:14:06,370 - Avg. fwd time: 14.3432 / Avg. bwd time: 40.3256 / Avg. batch time: 567.6467 (ms) / GPU bubble ratio: 22.95%
[rank1]:2026-01-03 03:14:06,420 - Avg. fwd time: 16.1184 / Avg. bwd time: 45.3774 / Avg. batch time: 633.6572 (ms) / GPU bubble ratio: 22.36%
[rank1]:2026-01-03 03:14:06,498 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 51.01GiB(36.48%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank0]:2026-01-03 03:14:06,467 - Avg. fwd time: 14.4795 / Avg. bwd time: 42.8613 / Avg. batch time: 696.0188 (ms) / GPU bubble ratio: 34.09%
[rank0]:2026-01-03 03:14:06,503 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 58.66GiB(41.96%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank3]:2026-01-03 03:14:06,501 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 48.72GiB(34.84%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank2]:2026-01-03 03:14:06,496 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 42.23GiB(30.21%)  tps: 5,703  tflops: 266.01  mfu: 26.90%
[rank3]:2026-01-03 03:14:32,133 - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-03 03:15:00,837 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank2]:2026-01-03 03:15:00,916 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank1]:2026-01-03 03:15:00,963 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank0]:2026-01-03 03:15:01,007 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank3]:2026-01-03 03:15:29,627 - [Step 180] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-03 03:15:29,839 - [Step 180] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-03 03:16:03,114 - [Step 200] âœ”ï¸  Setting Lowerbound
[rank0]:2026-01-03 03:16:03,194 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 03:16:03,220 - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.18/0.18, [MB2] 0.47/0.47, [MB3] 0.47/0.47, [MB4] 0.00/0.00, [MB5] 0.47/0.47, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank2]:2026-01-03 03:16:03,219 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 0.85/0.85, [MB3] 0.24/0.24, [MB4] 0.90/0.90, [MB5] 0.85/0.85, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank1]:2026-01-03 03:16:03,219 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-03 03:16:03,337 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0316_max_batch_time.svg
[rank3]:			> Batch Time: 674.78 ms, GPU Bubble Ratio: 31.75%, 26.95%, 34.97%, 27.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  204-42-247ms   | [S0,MB4,F]  247-13-260ms   | [S0,MB1,B]  265-43-308ms   | [S0,MB5,F]  308-13-322ms   | [S0,MB2,B]  326-43-370ms   | [S0,MB6,F]  370-13-384ms   | [S0,MB3,B]  388-43-431ms   | [S0,MB7,F]  431-14-445ms   | [S0,MB4,B]  450-43-493ms   | [S0,MB5,B]  511-43-554ms   | [S0,MB6,B]  571-43-614ms   | [S0,MB7,B]  631-43-674ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB0,B]  159-45-204ms   | [S1,MB3,F]  204-15-219ms   | [S1,MB1,B]  219-45-265ms   | [S1,MB4,F]  265-15-281ms   | [S1,MB2,B]  281-45-326ms   | [S1,MB5,F]  326-15-342ms   | [S1,MB3,B]  342-45-388ms   | [S1,MB6,F]  388-15-404ms   | [S1,MB4,B]  404-45-450ms   | [S1,MB7,F]  450-15-465ms   | [S1,MB5,B]  465-45-511ms   | [S1,MB6,B]  525-45-571ms   | [S1,MB7,B]  586-45-631ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB0,B]  118-40-159ms   | [S2,MB2,F]  159-13-172ms   | [S2,MB1,B]  179-40-219ms   | [S2,MB3,F]  219-13-233ms   | [S2,MB2,B]  240-40-281ms   | [S2,MB4,F]  281-13-295ms   | [S2,MB3,B]  301-40-342ms   | [S2,MB5,F]  342-13-356ms   | [S2,MB4,B]  362-40-403ms   | [S2,MB6,F]  404-13-418ms   | [S2,MB5,B]  423-40-464ms   | [S2,MB7,F]  465-13-479ms   | [S2,MB6,B]  484-40-525ms   | [S2,MB7,B]  545-40-586ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  73-45-118ms    AFR(10):0.9846 | [S3,MB1,F]  118-14-133ms   | [S3,MB1,B]  133-45-179ms   AFR(10):0.9846 | [S3,MB2,F]  179-14-194ms   | [S3,MB2,B]  194-46-240ms   AFR(10):0.9846 | [S3,MB3,F]  240-14-255ms   | [S3,MB3,B]  255-46-301ms   AFR(10):0.9846 | [S3,MB4,F]  301-14-316ms   | [S3,MB4,B]  316-46-362ms   AFR(10):0.9846 | [S3,MB5,F]  362-14-377ms   | [S3,MB5,B]  377-46-423ms   AFR(10):0.9846 | [S3,MB6,F]  423-14-438ms   | [S3,MB6,B]  438-46-484ms   AFR(10):0.9846 | [S3,MB7,F]  484-14-499ms   | [S3,MB7,B]  499-46-545ms   AFR(10):0.9846
[rank3]:2026-01-03 03:16:03,452 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0316_min_batch_time.svg
[rank3]:			> Batch Time: 384.50 ms, GPU Bubble Ratio: 69.98%, 23.19%, 31.54%, 24.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  133-0-133ms    | [S0,MB4,F]  133-13-146ms   | [S0,MB1,B]  169-0-169ms    | [S0,MB5,F]  169-13-183ms   | [S0,MB2,B]  205-0-205ms    | [S0,MB6,F]  205-13-219ms   | [S0,MB3,B]  242-0-242ms    | [S0,MB7,F]  242-14-256ms   | [S0,MB4,B]  279-0-279ms    | [S0,MB5,B]  316-0-316ms    | [S0,MB6,B]  348-0-348ms    | [S0,MB7,B]  384-0-384ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB0,B]  112-20-133ms   | [S1,MB3,F]  133-15-148ms   | [S1,MB1,B]  148-20-169ms   | [S1,MB4,F]  169-15-184ms   | [S1,MB2,B]  184-20-205ms   | [S1,MB5,F]  205-15-221ms   | [S1,MB3,B]  221-21-242ms   | [S1,MB6,F]  242-15-258ms   | [S1,MB4,B]  258-21-279ms   | [S1,MB7,F]  279-15-295ms   | [S1,MB5,B]  295-21-316ms   | [S1,MB6,B]  327-20-348ms   | [S1,MB7,B]  363-20-384ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB0,B]  94-18-112ms    | [S2,MB2,F]  112-13-126ms   | [S2,MB1,B]  129-18-147ms   | [S2,MB3,F]  148-13-162ms   | [S2,MB2,B]  165-18-183ms   | [S2,MB4,F]  184-13-198ms   | [S2,MB3,B]  201-18-219ms   | [S2,MB5,F]  221-13-235ms   | [S2,MB4,B]  237-18-256ms   | [S2,MB6,F]  258-13-272ms   | [S2,MB5,B]  273-18-291ms   | [S2,MB7,F]  295-13-309ms   | [S2,MB6,B]  309-18-327ms   | [S2,MB7,B]  345-18-363ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  73-20-94ms     AFR(10):0.9846 | [S3,MB1,F]  94-14-108ms    | [S3,MB1,B]  108-20-129ms   AFR(10):0.9846 | [S3,MB2,F]  129-14-144ms   | [S3,MB2,B]  144-20-165ms   AFR(10):0.9846 | [S3,MB3,F]  165-14-180ms   | [S3,MB3,B]  180-20-201ms   AFR(10):0.9846 | [S3,MB4,F]  201-14-216ms   | [S3,MB4,B]  216-21-237ms   AFR(10):0.9846 | [S3,MB5,F]  237-14-252ms   | [S3,MB5,B]  252-20-273ms   AFR(10):0.9846 | [S3,MB6,F]  273-14-288ms   | [S3,MB6,B]  288-20-309ms   AFR(10):0.9846 | [S3,MB7,F]  309-14-324ms   | [S3,MB7,B]  324-21-345ms   AFR(10):0.9846
[rank3]:2026-01-03 03:16:03,593 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0316_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 424.18 ms, GPU Bubble Ratio: 28.01%, 21.04%, 27.73%, 22.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-14-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  160-22-182ms   | [S0,MB4,F]  182-13-196ms   | [S0,MB1,B]  196-35-231ms   | [S0,MB5,F]  231-13-245ms   | [S0,MB2,B]  245-22-268ms   | [S0,MB6,F]  268-13-282ms   | [S0,MB3,B]  282-22-305ms   | [S0,MB7,F]  305-14-319ms   | [S0,MB4,B]  319-43-362ms   | [S0,MB5,B]  380-22-403ms   | [S0,MB6,B]  403-20-424ms   | [S0,MB7,B]  424-0-424ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-15-67ms     | [S1,MB0,B]  137-22-160ms   | [S1,MB3,F]  160-15-175ms   | [S1,MB1,B]  175-20-196ms   | [S1,MB4,F]  196-15-212ms   | [S1,MB2,B]  212-33-245ms   | [S1,MB5,F]  245-15-261ms   | [S1,MB3,B]  261-21-282ms   | [S1,MB6,F]  282-15-298ms   | [S1,MB4,B]  298-21-319ms   | [S1,MB7,F]  319-15-335ms   | [S1,MB5,B]  335-45-380ms   | [S1,MB6,B]  382-20-403ms   | [S1,MB7,B]  403-20-424ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB0,B]  118-18-137ms   | [S2,MB2,F]  137-13-151ms   | [S2,MB1,B]  154-21-175ms   | [S2,MB3,F]  175-13-189ms   | [S2,MB2,B]  190-21-212ms   | [S2,MB4,F]  212-13-225ms   | [S2,MB3,B]  225-35-261ms   | [S2,MB5,F]  261-13-275ms   | [S2,MB4,B]  277-20-298ms   | [S2,MB6,F]  298-13-312ms   | [S2,MB5,B]  313-21-335ms   | [S2,MB7,F]  335-13-348ms   | [S2,MB6,B]  348-33-382ms   | [S2,MB7,B]  384-18-403ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  73-45-118ms    AFR(10):0.9846 | [S3,MB1,F]  118-14-133ms   | [S3,MB1,B]  133-20-154ms   AFR(10):0.9846 | [S3,MB2,F]  154-14-169ms   | [S3,MB2,B]  169-20-190ms   AFR(10):0.9846 | [S3,MB3,F]  190-14-205ms   | [S3,MB3,B]  205-20-225ms   AFR(10):0.9846 | [S3,MB4,F]  225-14-240ms   | [S3,MB4,B]  240-36-277ms   AFR(10):0.9846 | [S3,MB5,F]  277-14-292ms   | [S3,MB5,B]  292-20-313ms   AFR(10):0.9846 | [S3,MB6,F]  313-14-328ms   | [S3,MB6,B]  328-20-348ms   AFR(10):0.9846 | [S3,MB7,F]  348-14-363ms   | [S3,MB7,B]  363-21-384ms   AFR(10):0.9846
[rank3]:2026-01-03 03:16:03,593 - 	> Batch Time: 424.18 ms (Average Freeze Ratio: 0.70, Time Reduction Rate: 0.37)
[rank3]:2026-01-03 03:16:03,599 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-03 03:16:05,512 - Avg. fwd time: 16.0933 / Avg. bwd time: 42.8391 / Avg. batch time: 608.0396 (ms) / GPU bubble ratio: 22.46%
[rank0]:2026-01-03 03:16:05,523 - Avg. fwd time: 14.4543 / Avg. bwd time: 38.5243 / Avg. batch time: 665.8276 (ms) / GPU bubble ratio: 36.35%
[rank3]:2026-01-03 03:16:05,464 - Avg. fwd time: 15.4496 / Avg. bwd time: 43.2661 / Avg. batch time: 487.5561 (ms) / GPU bubble ratio: 3.66%
[rank2]:2026-01-03 03:16:05,487 - Avg. fwd time: 14.3156 / Avg. bwd time: 38.0932 / Avg. batch time: 544.7071 (ms) / GPU bubble ratio: 23.03%
[rank1]:2026-01-03 03:16:05,554 -  step: 200  loss: -4.0000  grad_norm:  6.7871  memory: 58.51GiB(41.85%)  tps: 6,881  tflops: 320.92  mfu: 32.45%
[rank1]:2026-01-03 03:16:05,613 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0316_stage1_step200.svg
[rank0]:2026-01-03 03:16:05,558 -  step: 200  loss: -4.0000  grad_norm:  6.7871  memory: 67.16GiB(48.04%)  tps: 6,881  tflops: 320.92  mfu: 32.45%
[rank0]:2026-01-03 03:16:05,617 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0316_stage0_step200.svg
[rank3]:2026-01-03 03:16:05,556 -  step: 200  loss:  0.8740  grad_norm:  6.7871  memory: 57.39GiB(41.05%)  tps: 6,881  tflops: 320.93  mfu: 32.45%
[rank2]:2026-01-03 03:16:05,552 -  step: 200  loss: -4.0000  grad_norm:  6.7871  memory: 48.95GiB(35.01%)  tps: 6,881  tflops: 320.92  mfu: 32.45%
[rank2]:2026-01-03 03:16:05,616 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0316_stage2_step200.svg
[rank3]:2026-01-03 03:16:05,682 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0316_step200_rank3.svg
[rank3]:			> Batch Time: 403.25 ms, GPU Bubble Ratio: 71.61%, 26.77%, 34.82%, 28.02%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB0,B]  137-0-137ms    | [S0,MB4,F]  137-13-150ms   | [S0,MB1,B]  174-0-174ms    | [S0,MB5,F]  174-13-188ms   | [S0,MB2,B]  212-0-212ms    | [S0,MB6,F]  212-13-226ms   | [S0,MB3,B]  250-0-250ms    | [S0,MB7,F]  250-13-264ms   | [S0,MB4,B]  289-0-289ms    | [S0,MB5,B]  327-0-327ms    | [S0,MB6,B]  364-0-364ms    | [S0,MB7,B]  403-0-403ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  115-20-136ms   | [S1,MB3,F]  136-15-152ms   | [S1,MB1,B]  153-20-174ms   | [S1,MB4,F]  174-15-190ms   | [S1,MB2,B]  191-21-212ms   | [S1,MB5,F]  212-15-228ms   | [S1,MB3,B]  229-21-250ms   | [S1,MB6,F]  250-15-266ms   | [S1,MB4,B]  267-21-288ms   | [S1,MB7,F]  288-15-304ms   | [S1,MB5,B]  305-21-326ms   | [S1,MB6,B]  343-20-364ms   | [S1,MB7,B]  382-20-402ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  96-18-115ms    | [S2,MB2,F]  115-13-129ms   | [S2,MB1,B]  134-18-153ms   | [S2,MB3,F]  153-13-166ms   | [S2,MB2,B]  172-18-190ms   | [S2,MB4,F]  191-13-204ms   | [S2,MB3,B]  210-18-229ms   | [S2,MB5,F]  229-13-243ms   | [S2,MB4,B]  248-18-267ms   | [S2,MB6,F]  267-13-281ms   | [S2,MB5,B]  286-18-305ms   | [S2,MB7,F]  305-13-319ms   | [S2,MB6,B]  324-18-343ms   | [S2,MB7,B]  363-18-381ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB0,B]  75-20-96ms     | [S3,MB1,F]  96-14-111ms    | [S3,MB1,B]  113-21-134ms   | [S3,MB2,F]  134-14-149ms   | [S3,MB2,B]  151-20-171ms   | [S3,MB3,F]  172-14-186ms   | [S3,MB3,B]  188-20-209ms   | [S3,MB4,F]  210-14-225ms   | [S3,MB4,B]  227-20-248ms   | [S3,MB5,F]  248-14-263ms   | [S3,MB5,B]  265-20-286ms   | [S3,MB6,F]  286-14-301ms   | [S3,MB6,B]  303-20-324ms   | [S3,MB7,F]  324-14-339ms   | [S3,MB7,B]  341-21-362ms  
[rank1]:2026-01-03 03:16:05,794 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0316_rank1_stage1.svg
[rank1]:	> Counts Sum: 51840, Total Sum: 51840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-03 03:16:05,794 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0316_rank0_stage0.svg
[rank0]:	> Counts Sum: 46720, Total Sum: 46720 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank3]:2026-01-03 03:16:05,725 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0316_stage3_step200.svg
[rank2]:2026-01-03 03:16:05,787 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0316_rank2_stage2.svg
[rank2]:	> Counts Sum: 46080, Total Sum: 46080 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-03 03:16:05,822 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0316_stage2.svg
[rank1]:2026-01-03 03:16:05,829 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0316_stage1.svg
[rank0]:2026-01-03 03:16:05,830 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0316_stage0.svg
[rank3]:2026-01-03 03:16:05,889 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0316_rank3_stage3.svg
[rank3]:	> Counts Sum: 40960, Total Sum: 41600 (98.46%), Ratio(%) per element: [100.0, 100.0, 87.5, 93.75, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 87.5, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0]
[rank3]:2026-01-03 03:16:05,925 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0316_stage3.svg
[rank0]:2026-01-03 03:17:57,180 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2026-01-03 03:17:57,217 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.58/0.87, [MB2] 0.57/0.85, [MB3] 0.16/0.24, [MB4] 0.60/0.90, [MB5] 0.57/0.85, [MB6] 0.21/0.32, [MB7] 0.67/1.00
[rank1]:2026-01-03 03:17:57,226 - Current/Expected Freeze Ratio per Block: [MB0] 0.61/0.91, [MB1] 0.67/1.00, [MB2] 0.33/0.49, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.00/0.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-03 03:17:57,226 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.67/1.00, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.27/0.40, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank0]:2026-01-03 03:17:57,234 - Current/Expected Freeze Ratio per Block: [MB0] 0.32/0.48, [MB1] 0.12/0.18, [MB2] 0.32/0.47, [MB3] 0.32/0.47, [MB4] 0.00/0.00, [MB5] 0.32/0.47, [MB6] 0.35/0.52, [MB7] 0.67/1.00
[rank1]:2026-01-03 03:17:59,400 - Avg. fwd time: 16.0583 / Avg. bwd time: 40.3943 / Avg. batch time: 586.0142 (ms) / GPU bubble ratio: 22.93%
[rank3]:2026-01-03 03:17:59,341 - Avg. fwd time: 15.4319 / Avg. bwd time: 41.1687 / Avg. batch time: 471.3267 (ms) / GPU bubble ratio: 3.93%
[rank2]:2026-01-03 03:17:59,370 - Avg. fwd time: 14.2912 / Avg. bwd time: 36.1376 / Avg. batch time: 525.7724 (ms) / GPU bubble ratio: 23.27%
[rank1]:2026-01-03 03:17:59,459 -  step: 250  loss: -4.0000  grad_norm:  1.8626  memory: 58.51GiB(41.85%)  tps: 7,192  tflops: 335.44  mfu: 33.92%
[rank0]:2026-01-03 03:17:59,427 - Avg. fwd time: 14.4699 / Avg. bwd time: 37.6030 / Avg. batch time: 641.0888 (ms) / GPU bubble ratio: 35.02%
[rank0]:2026-01-03 03:17:59,463 -  step: 250  loss: -4.0000  grad_norm:  1.8626  memory: 67.49GiB(48.27%)  tps: 7,192  tflops: 335.44  mfu: 33.92%
[rank3]:2026-01-03 03:17:59,461 -  step: 250  loss:  0.2804  grad_norm:  1.8626  memory: 57.39GiB(41.05%)  tps: 7,192  tflops: 335.44  mfu: 33.92%
[rank2]:2026-01-03 03:17:59,453 -  step: 250  loss: -4.0000  grad_norm:  1.8626  memory: 48.95GiB(35.01%)  tps: 7,192  tflops: 335.45  mfu: 33.92%
[rank0]:2026-01-03 03:19:41,812 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 03:19:41,853 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 0.85/0.85, [MB3] 0.24/0.24, [MB4] 0.90/0.90, [MB5] 0.85/0.85, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank1]:2026-01-03 03:19:41,875 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-03 03:19:41,874 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-03 03:19:41,883 - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.18/0.18, [MB2] 0.47/0.47, [MB3] 0.47/0.47, [MB4] 0.00/0.00, [MB5] 0.47/0.47, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank3]:2026-01-03 03:19:43,697 - Avg. fwd time: 15.4118 / Avg. bwd time: 39.0601 / Avg. batch time: 454.3124 (ms) / GPU bubble ratio: 4.08%
[rank2]:2026-01-03 03:19:43,721 - Avg. fwd time: 14.2703 / Avg. bwd time: 34.1412 / Avg. batch time: 506.2454 (ms) / GPU bubble ratio: 23.50%
[rank2]:2026-01-03 03:19:43,775 -  step: 300  loss: -4.0000  grad_norm:  0.3252  memory: 48.95GiB(35.01%)  tps: 7,853  tflops: 366.25  mfu: 37.03%
[rank1]:2026-01-03 03:19:43,746 - Avg. fwd time: 16.0344 / Avg. bwd time: 38.1341 / Avg. batch time: 563.6904 (ms) / GPU bubble ratio: 23.12%
[rank1]:2026-01-03 03:19:43,782 -  step: 300  loss: -4.0000  grad_norm:  0.3252  memory: 58.51GiB(41.85%)  tps: 7,853  tflops: 366.24  mfu: 37.03%
[rank0]:2026-01-03 03:19:43,751 - Avg. fwd time: 14.4878 / Avg. bwd time: 36.5596 / Avg. batch time: 616.8693 (ms) / GPU bubble ratio: 33.80%
[rank0]:2026-01-03 03:19:43,786 -  step: 300  loss: -4.0000  grad_norm:  0.3252  memory: 67.49GiB(48.27%)  tps: 7,853  tflops: 366.24  mfu: 37.03%
[rank3]:2026-01-03 03:19:43,784 -  step: 300  loss:  0.2847  grad_norm:  0.3252  memory: 57.39GiB(41.05%)  tps: 7,853  tflops: 366.25  mfu: 37.03%
[rank2]:2026-01-03 03:19:43,831 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0319_stage2_step300.svg
[rank1]:2026-01-03 03:19:43,830 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0319_stage1_step300.svg
[rank0]:2026-01-03 03:19:43,833 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0319_stage0_step300.svg
[rank3]:2026-01-03 03:19:43,914 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0319_step300_rank3.svg
[rank3]:			> Batch Time: 476.52 ms, GPU Bubble Ratio: 25.47%, 30.36%, 37.65%, 30.98%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-26-188ms   | [S0,MB4,F]  189-13-202ms   | [S0,MB1,B]  203-37-240ms   | [S0,MB5,F]  241-14-255ms   | [S0,MB2,B]  255-28-283ms   | [S0,MB6,F]  283-14-297ms   | [S0,MB3,B]  298-28-326ms   | [S0,MB7,F]  326-14-340ms   | [S0,MB4,B]  340-43-384ms   | [S0,MB5,B]  402-27-429ms   | [S0,MB6,B]  429-27-456ms   | [S0,MB7,B]  457-19-476ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  140-21-162ms   | [S1,MB3,F]  162-15-177ms   | [S1,MB1,B]  180-21-201ms   | [S1,MB4,F]  202-15-218ms   | [S1,MB2,B]  219-28-247ms   | [S1,MB5,F]  254-15-270ms   | [S1,MB3,B]  270-21-291ms   | [S1,MB6,F]  297-15-313ms   | [S1,MB4,B]  313-22-335ms   | [S1,MB7,F]  340-15-355ms   | [S1,MB5,B]  356-45-401ms   | [S1,MB6,B]  402-21-423ms   | [S1,MB7,B]  428-22-450ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-20-179ms   | [S2,MB3,F]  180-13-193ms   | [S2,MB2,B]  196-21-218ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-32-266ms   | [S2,MB5,F]  270-13-284ms   | [S2,MB4,B]  286-21-307ms   | [S2,MB6,F]  313-13-326ms   | [S2,MB5,B]  326-20-347ms   | [S2,MB7,F]  356-13-369ms   | [S2,MB6,B]  370-29-399ms   | [S2,MB7,B]  407-19-427ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB0,B]  75-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-20-158ms   | [S3,MB2,F]  159-14-173ms   | [S3,MB2,B]  175-21-196ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  213-21-234ms   | [S3,MB4,F]  234-14-249ms   | [S3,MB4,B]  251-34-285ms   | [S3,MB5,F]  286-14-301ms   | [S3,MB5,B]  303-21-324ms   | [S3,MB6,F]  326-14-341ms   | [S3,MB6,B]  343-21-364ms   | [S3,MB7,F]  369-14-384ms   | [S3,MB7,B]  386-20-407ms  
[rank2]:2026-01-03 03:19:43,998 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0319_rank2_stage2.svg
[rank2]:	> Counts Sum: 167600, Total Sum: 276480 (60.62%), Ratio(%) per element: [66.66, 70.83, 40.62, 67.7, 50.0, 90.62, 58.33, 43.75, 45.83, 55.2, 46.87, 46.87, 48.95, 67.7, 67.7, 85.41, 40.62, 46.87, 71.87, 81.25, 47.91, 43.75, 86.45, 85.41, 73.95, 43.75, 39.58, 79.16, 51.04, 44.79, 67.7, 50.0, 91.66, 85.41, 46.87, 41.66, 86.45, 55.2, 54.16, 42.7, 79.16, 85.41, 84.37, 45.83, 45.83, 62.5, 53.12, 60.41, 54.16, 90.62, 61.45, 56.25, 44.79, 43.75, 55.2, 59.37, 53.12, 68.75, 83.33, 67.7, 47.91, 46.87, 41.66, 78.12, 71.87, 53.12, 46.87, 83.33, 63.54, 70.83, 44.79, 48.95]
[rank0]:2026-01-03 03:19:44,007 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0319_rank0_stage0.svg
[rank0]:	> Counts Sum: 120240, Total Sum: 280320 (42.89%), Ratio(%) per element: [23.95, 38.54, 32.29, 22.91, 47.91, 27.08, 40.62, 66.66, 22.91, 29.16, 52.08, 54.16, 26.04, 33.33, 56.25, 62.5, 40.62, 28.12, 23.95, 27.08, 45.83, 45.83, 26.04, 67.7, 51.04, 23.95, 22.91, 27.08, 46.87, 41.66, 44.79, 43.75, 58.33, 72.91, 50.0, 20.83, 27.08, 69.79, 47.91, 26.04, 30.2, 58.33, 72.91, 68.75, 23.95, 26.04, 39.58, 22.91, 59.37, 73.95, 44.79, 64.58, 67.7, 27.08, 26.04, 35.41, 41.66, 28.12, 47.91, 71.87, 64.58, 73.95, 27.08, 28.12, 66.66, 26.04, 25.0, 23.95, 64.58, 68.75, 61.45, 26.04, 27.08]
[rank3]:2026-01-03 03:19:43,954 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0319_stage3_step300.svg
[rank1]:2026-01-03 03:19:44,008 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0319_rank1_stage1.svg
[rank1]:	> Counts Sum: 197040, Total Sum: 311040 (63.35%), Ratio(%) per element: [87.5, 58.33, 46.87, 65.62, 45.83, 86.45, 79.16, 53.12, 47.91, 70.83, 51.04, 61.45, 73.95, 87.5, 87.5, 86.45, 44.79, 55.2, 78.12, 65.62, 42.7, 51.04, 88.54, 81.25, 82.29, 53.12, 43.75, 81.25, 56.25, 53.12, 68.75, 88.54, 81.25, 71.87, 42.7, 41.66, 76.04, 68.75, 45.83, 50.0, 48.95, 88.54, 69.79, 47.91, 53.12, 50.0, 66.66, 52.08, 51.04, 65.62, 70.83, 87.5, 57.29, 47.91, 75.0, 60.41, 46.87, 58.33, 87.5, 43.75, 57.29, 47.91, 55.2, 76.04, 52.08, 50.0, 64.58, 53.12, 59.37, 86.45, 48.95, 47.91, 65.62, 55.2, 63.54, 58.33, 84.37, 84.37, 82.29, 55.2, 52.08]
[rank3]:2026-01-03 03:19:44,114 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0319_rank3_stage3.svg
[rank3]:	> Counts Sum: 157440, Total Sum: 249600 (63.08%), Ratio(%) per element: [78.12, 59.37, 41.66, 57.29, 83.33, 79.16, 86.45, 46.87, 42.7, 79.16, 64.58, 45.83, 75.0, 84.37, 76.04, 79.16, 42.7, 38.54, 57.29, 51.04, 60.41, 52.08, 83.33, 63.54, 64.58, 48.95, 52.08, 85.41, 55.2, 51.04, 47.91, 63.54, 80.2, 87.5, 57.29, 50.0, 82.29, 71.87, 65.62, 61.45, 80.2, 52.08, 87.5, 46.87, 45.83, 46.87, 56.25, 60.41, 63.54, 50.0, 83.33, 76.04, 45.83, 51.04, 68.75, 77.08, 82.29, 56.25, 63.54, 84.37, 84.37, 47.91, 45.83, 44.79, 45.83]
[rank2]:2026-01-03 03:19:44,144 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0319_stage2.svg
[rank1]:2026-01-03 03:19:44,154 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0319_stage1.svg
[rank0]:2026-01-03 03:19:44,151 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0319_stage0.svg
[rank3]:2026-01-03 03:19:44,262 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0319_stage3.svg
[rank2]:2026-01-03 03:21:16,655 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 0.85/0.85, [MB3] 0.24/0.24, [MB4] 0.90/0.90, [MB5] 0.85/0.85, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank1]:2026-01-03 03:21:16,677 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-03 03:21:16,625 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-03 03:21:16,684 - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.18/0.18, [MB2] 0.47/0.47, [MB3] 0.47/0.47, [MB4] 0.00/0.00, [MB5] 0.47/0.47, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank3]:2026-01-03 03:21:16,678 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-03 03:21:18,540 - Avg. fwd time: 14.2604 / Avg. bwd time: 32.4274 / Avg. batch time: 488.5634 (ms) / GPU bubble ratio: 23.55%
[rank1]:2026-01-03 03:21:18,565 - Avg. fwd time: 16.0240 / Avg. bwd time: 36.2226 / Avg. batch time: 543.7048 (ms) / GPU bubble ratio: 23.13%
[rank3]:2026-01-03 03:21:18,516 - Avg. fwd time: 15.3985 / Avg. bwd time: 37.0896 / Avg. batch time: 438.7140 (ms) / GPU bubble ratio: 4.29%
[rank0]:2026-01-03 03:21:18,570 - Avg. fwd time: 14.5012 / Avg. bwd time: 35.0847 / Avg. batch time: 592.5705 (ms) / GPU bubble ratio: 33.06%
[rank2]:2026-01-03 03:21:18,593 -  step: 350  loss: -4.0000  grad_norm:  0.3383  memory: 48.95GiB(35.01%)  tps: 8,640  tflops: 402.96  mfu: 40.74%
[rank1]:2026-01-03 03:21:18,601 -  step: 350  loss: -4.0000  grad_norm:  0.3383  memory: 58.51GiB(41.85%)  tps: 8,640  tflops: 402.95  mfu: 40.74%
[rank3]:2026-01-03 03:21:18,604 -  step: 350  loss:  0.3373  grad_norm:  0.3383  memory: 57.39GiB(41.05%)  tps: 8,640  tflops: 402.96  mfu: 40.74%
[rank0]:2026-01-03 03:21:18,606 -  step: 350  loss: -4.0000  grad_norm:  0.3383  memory: 67.49GiB(48.27%)  tps: 8,640  tflops: 402.95  mfu: 40.74%
[rank1]:2026-01-03 03:22:51,643 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 0.00/0.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-03 03:22:51,618 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.87/0.87, [MB2] 0.85/0.85, [MB3] 0.24/0.24, [MB4] 0.90/0.90, [MB5] 0.85/0.85, [MB6] 0.32/0.32, [MB7] 1.00/1.00
[rank0]:2026-01-03 03:22:51,580 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 03:22:51,650 - Current/Expected Freeze Ratio per Block: [MB0] 0.48/0.48, [MB1] 0.18/0.18, [MB2] 0.47/0.47, [MB3] 0.47/0.47, [MB4] 0.00/0.00, [MB5] 0.47/0.47, [MB6] 0.52/0.52, [MB7] 1.00/1.00
[rank3]:2026-01-03 03:22:51,642 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 1.00/1.00, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 0.40/0.40, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-03 03:22:53,525 - Avg. fwd time: 14.2555 / Avg. bwd time: 31.1785 / Avg. batch time: 475.5289 (ms) / GPU bubble ratio: 23.56%
[rank1]:2026-01-03 03:22:53,550 - Avg. fwd time: 16.0142 / Avg. bwd time: 34.7802 / Avg. batch time: 528.9406 (ms) / GPU bubble ratio: 23.18%
[rank3]:2026-01-03 03:22:53,501 - Avg. fwd time: 15.3861 / Avg. bwd time: 35.6114 / Avg. batch time: 427.2723 (ms) / GPU bubble ratio: 4.52%
[rank0]:2026-01-03 03:22:53,555 - Avg. fwd time: 14.5119 / Avg. bwd time: 34.0433 / Avg. batch time: 574.7414 (ms) / GPU bubble ratio: 32.41%
[rank2]:2026-01-03 03:22:53,579 -  step: 400  loss: -4.0000  grad_norm:  0.2239  memory: 48.95GiB(35.01%)  tps: 8,624  tflops: 402.24  mfu: 40.67%
[rank1]:2026-01-03 03:22:53,586 -  step: 400  loss: -4.0000  grad_norm:  0.2239  memory: 58.51GiB(41.85%)  tps: 8,625  tflops: 402.25  mfu: 40.67%
[rank2]:2026-01-03 03:22:53,638 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0322_stage2_step400.svg
[rank1]:2026-01-03 03:22:53,639 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0322_stage1_step400.svg
[rank3]:2026-01-03 03:22:53,588 -  step: 400  loss:  0.2798  grad_norm:  0.2239  memory: 57.39GiB(41.05%)  tps: 8,625  tflops: 402.26  mfu: 40.67%
[rank0]:2026-01-03 03:22:53,590 -  step: 400  loss: -4.0000  grad_norm:  0.2239  memory: 67.51GiB(48.29%)  tps: 8,625  tflops: 402.25  mfu: 40.67%
[rank0]:2026-01-03 03:22:53,638 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0322_stage0_step400.svg
[rank3]:2026-01-03 03:22:53,717 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0322_step400_rank3.svg
[rank3]:			> Batch Time: 453.00 ms, GPU Bubble Ratio: 26.63%, 27.97%, 35.97%, 28.13%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB0,B]  162-27-189ms   | [S0,MB4,F]  189-13-202ms   | [S0,MB1,B]  203-36-239ms   | [S0,MB5,F]  240-14-254ms   | [S0,MB2,B]  254-27-282ms   | [S0,MB6,F]  282-14-296ms   | [S0,MB3,B]  296-27-323ms   | [S0,MB7,F]  323-14-337ms   | [S0,MB4,B]  338-43-381ms   | [S0,MB5,B]  399-27-426ms   | [S0,MB6,B]  426-26-452ms   | [S0,MB7,B]  453-0-453ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  140-21-161ms   | [S1,MB3,F]  162-15-177ms   | [S1,MB1,B]  178-20-199ms   | [S1,MB4,F]  202-15-218ms   | [S1,MB2,B]  218-27-246ms   | [S1,MB5,F]  254-15-269ms   | [S1,MB3,B]  269-20-290ms   | [S1,MB6,F]  296-15-311ms   | [S1,MB4,B]  311-20-332ms   | [S1,MB7,F]  337-15-353ms   | [S1,MB5,B]  353-45-399ms   | [S1,MB6,B]  399-21-420ms   | [S1,MB7,B]  423-20-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-19-178ms   | [S2,MB3,F]  178-13-192ms   | [S2,MB2,B]  196-19-216ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-31-265ms   | [S2,MB5,F]  269-13-283ms   | [S2,MB4,B]  285-19-304ms   | [S2,MB6,F]  311-13-325ms   | [S2,MB5,B]  325-20-345ms   | [S2,MB7,F]  353-13-367ms   | [S2,MB6,B]  367-28-396ms   | [S2,MB7,B]  404-18-423ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-20-158ms   | [S3,MB2,F]  158-14-173ms   | [S3,MB2,B]  175-20-196ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  213-20-233ms   | [S3,MB4,F]  233-14-248ms   | [S3,MB4,B]  250-34-285ms   | [S3,MB5,F]  285-14-300ms   | [S3,MB5,B]  302-20-322ms   | [S3,MB6,F]  325-14-339ms   | [S3,MB6,B]  341-20-362ms   | [S3,MB7,F]  367-14-381ms   | [S3,MB7,B]  383-20-404ms  
[rank3]:2026-01-03 03:22:53,761 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0322_stage3_step400.svg
[rank2]:2026-01-03 03:22:53,805 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0322_rank2_stage2.svg
[rank2]:	> Counts Sum: 341200, Total Sum: 506880 (67.31%), Ratio(%) per element: [71.02, 65.9, 50.56, 67.61, 56.81, 90.34, 73.29, 52.84, 53.97, 69.31, 53.97, 61.93, 62.5, 75.0, 76.7, 89.2, 53.4, 55.68, 80.11, 76.7, 53.4, 56.81, 81.25, 88.63, 81.81, 53.4, 51.7, 71.59, 57.38, 56.25, 76.13, 58.52, 88.06, 85.22, 55.11, 51.7, 87.5, 59.09, 59.09, 51.7, 84.09, 86.36, 77.84, 55.11, 52.27, 73.86, 59.09, 60.79, 58.52, 86.93, 74.43, 69.31, 52.84, 51.7, 71.02, 69.31, 68.18, 75.56, 86.93, 76.13, 65.9, 55.68, 55.68, 83.52, 76.13, 57.38, 53.4, 84.65, 76.7, 76.7, 53.97, 55.11]
[rank1]:2026-01-03 03:22:53,819 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0322_rank1_stage1.svg
[rank1]:	> Counts Sum: 404640, Total Sum: 570240 (70.96%), Ratio(%) per element: [85.79, 68.18, 59.09, 74.43, 59.09, 86.93, 82.38, 61.93, 58.52, 78.4, 61.36, 68.18, 80.11, 86.93, 86.36, 86.36, 57.95, 63.06, 81.25, 75.56, 56.81, 61.36, 87.5, 83.52, 84.09, 62.5, 57.38, 84.09, 64.77, 61.93, 71.02, 88.06, 84.09, 78.97, 57.38, 56.81, 80.68, 69.88, 64.2, 67.04, 59.65, 88.06, 77.27, 58.52, 61.93, 61.36, 71.59, 62.5, 61.93, 69.31, 78.4, 86.93, 65.9, 60.22, 78.4, 71.59, 60.79, 71.02, 87.5, 59.65, 69.88, 59.09, 63.06, 79.54, 61.36, 61.36, 74.43, 68.18, 72.15, 86.93, 60.22, 59.65, 75.56, 63.63, 73.29, 68.18, 85.79, 82.95, 80.68, 63.06, 61.93]
[rank0]:2026-01-03 03:22:53,809 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0322_rank0_stage0.svg
[rank0]:	> Counts Sum: 225840, Total Sum: 513920 (43.94%), Ratio(%) per element: [19.88, 53.4, 23.86, 25.56, 60.22, 20.45, 53.97, 68.18, 18.18, 21.59, 56.25, 37.5, 21.02, 50.0, 65.9, 67.04, 56.81, 21.59, 19.31, 20.45, 52.27, 48.29, 22.72, 69.88, 63.63, 19.88, 18.18, 21.59, 56.81, 42.61, 34.09, 57.38, 64.2, 73.86, 61.93, 17.61, 21.02, 73.29, 50.0, 20.45, 48.86, 64.2, 73.86, 71.02, 18.75, 20.45, 56.25, 19.31, 65.34, 61.36, 55.11, 67.04, 71.02, 22.72, 20.45, 40.34, 55.68, 37.5, 32.95, 71.59, 67.61, 73.29, 21.02, 21.02, 69.88, 21.59, 19.88, 18.75, 69.31, 72.72, 67.04, 19.88, 21.02]
[rank3]:2026-01-03 03:22:53,923 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0322_rank3_stage3.svg
[rank3]:	> Counts Sum: 323840, Total Sum: 457600 (70.77%), Ratio(%) per element: [81.25, 66.47, 56.81, 68.18, 82.95, 81.81, 84.65, 59.65, 57.38, 82.38, 72.72, 64.2, 77.84, 84.65, 80.11, 80.68, 57.38, 55.68, 65.34, 64.2, 69.31, 65.9, 84.65, 72.72, 72.72, 60.79, 62.5, 84.09, 65.9, 61.93, 62.5, 72.15, 82.38, 84.65, 65.34, 61.36, 83.52, 76.13, 69.88, 68.75, 82.95, 62.5, 86.93, 59.65, 59.09, 63.63, 66.47, 67.04, 71.02, 63.63, 82.95, 80.11, 59.09, 61.93, 75.0, 80.11, 78.97, 68.75, 72.15, 84.65, 84.65, 60.22, 59.09, 58.52, 59.09]
[rank2]:2026-01-03 03:22:54,064 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0322_stage2.svg
[rank0]:2026-01-03 03:22:54,064 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0322_stage0.svg
[rank1]:2026-01-03 03:22:54,096 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0322_stage1.svg
[rank3]:2026-01-03 03:22:54,182 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0322_stage3.svg
[rank0]:2026-01-03 03:24:26,573 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 03:24:28,456 - Avg. fwd time: 15.3753 / Avg. bwd time: 34.4571 / Avg. batch time: 418.1897 (ms) / GPU bubble ratio: 4.67%
[rank2]:2026-01-03 03:24:28,480 - Avg. fwd time: 14.2501 / Avg. bwd time: 30.1878 / Avg. batch time: 465.2303 (ms) / GPU bubble ratio: 23.59%
[rank2]:2026-01-03 03:24:28,536 -  step: 450  loss: -4.0000  grad_norm:  0.1896  memory: 48.95GiB(35.01%)  tps: 8,627  tflops: 402.37  mfu: 40.68%
[rank1]:2026-01-03 03:24:28,507 - Avg. fwd time: 16.0043 / Avg. bwd time: 33.6566 / Avg. batch time: 517.2942 (ms) / GPU bubble ratio: 23.20%
[rank1]:2026-01-03 03:24:28,543 -  step: 450  loss: -4.0000  grad_norm:  0.1896  memory: 58.51GiB(41.85%)  tps: 8,627  tflops: 402.37  mfu: 40.68%
[rank0]:2026-01-03 03:24:28,512 - Avg. fwd time: 14.5217 / Avg. bwd time: 33.1919 / Avg. batch time: 560.6125 (ms) / GPU bubble ratio: 31.91%
[rank0]:2026-01-03 03:24:28,548 -  step: 450  loss: -4.0000  grad_norm:  0.1896  memory: 67.51GiB(48.29%)  tps: 8,627  tflops: 402.37  mfu: 40.68%
[rank3]:2026-01-03 03:24:28,546 -  step: 450  loss:  0.2963  grad_norm:  0.1896  memory: 57.39GiB(41.05%)  tps: 8,627  tflops: 402.37  mfu: 40.68%
[rank0]:2026-01-03 03:26:01,119 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 03:26:03,022 - Avg. fwd time: 14.2450 / Avg. bwd time: 29.4050 / Avg. batch time: 457.0236 (ms) / GPU bubble ratio: 23.59%
[rank3]:2026-01-03 03:26:02,997 - Avg. fwd time: 15.3662 / Avg. bwd time: 33.5437 / Avg. batch time: 410.9809 (ms) / GPU bubble ratio: 4.79%
[rank2]:2026-01-03 03:26:03,079 -  step: 500  loss: -4.0000  grad_norm:  0.1997  memory: 48.95GiB(35.01%)  tps: 8,665  tflops: 404.13  mfu: 40.86%
[rank1]:2026-01-03 03:26:03,049 - Avg. fwd time: 15.9967 / Avg. bwd time: 32.7669 / Avg. batch time: 508.0097 (ms) / GPU bubble ratio: 23.21%
[rank1]:2026-01-03 03:26:03,085 -  step: 500  loss: -4.0000  grad_norm:  0.1997  memory: 58.51GiB(41.85%)  tps: 8,665  tflops: 404.13  mfu: 40.86%
[rank1]:2026-01-03 03:26:03,132 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0326_stage1_step500.svg
[rank0]:2026-01-03 03:26:03,054 - Avg. fwd time: 14.5298 / Avg. bwd time: 32.5031 / Avg. batch time: 549.2307 (ms) / GPU bubble ratio: 31.49%
[rank0]:2026-01-03 03:26:03,090 -  step: 500  loss: -4.0000  grad_norm:  0.1997  memory: 67.51GiB(48.29%)  tps: 8,665  tflops: 404.14  mfu: 40.86%
[rank0]:2026-01-03 03:26:03,142 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0326_stage0_step500.svg
[rank3]:2026-01-03 03:26:03,088 -  step: 500  loss:  0.2952  grad_norm:  0.1997  memory: 57.39GiB(41.05%)  tps: 8,665  tflops: 404.14  mfu: 40.86%
[rank2]:2026-01-03 03:26:03,135 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0326_stage2_step500.svg
[rank3]:2026-01-03 03:26:03,212 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0326_step500_rank3.svg
[rank3]:			> Batch Time: 453.00 ms, GPU Bubble Ratio: 26.71%, 27.37%, 35.76%, 27.83%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  163-25-189ms   | [S0,MB4,F]  189-13-203ms   | [S0,MB1,B]  203-38-241ms   | [S0,MB5,F]  241-14-255ms   | [S0,MB2,B]  255-25-281ms   | [S0,MB6,F]  281-14-295ms   | [S0,MB3,B]  295-28-323ms   | [S0,MB7,F]  323-14-338ms   | [S0,MB4,B]  338-43-382ms   | [S0,MB5,B]  399-26-426ms   | [S0,MB6,B]  426-26-452ms   | [S0,MB7,B]  453-0-453ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  140-22-162ms   | [S1,MB3,F]  163-15-178ms   | [S1,MB1,B]  178-20-199ms   | [S1,MB4,F]  203-15-218ms   | [S1,MB2,B]  218-28-247ms   | [S1,MB5,F]  255-15-271ms   | [S1,MB3,B]  271-20-292ms   | [S1,MB6,F]  295-15-310ms   | [S1,MB4,B]  310-20-331ms   | [S1,MB7,F]  338-15-353ms   | [S1,MB5,B]  353-45-399ms   | [S1,MB6,B]  400-21-421ms   | [S1,MB7,B]  424-20-445ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-19-178ms   | [S2,MB3,F]  178-13-192ms   | [S2,MB2,B]  196-19-216ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-32-266ms   | [S2,MB5,F]  271-13-285ms   | [S2,MB4,B]  286-19-305ms   | [S2,MB6,F]  310-13-324ms   | [S2,MB5,B]  324-20-345ms   | [S2,MB7,F]  353-13-367ms   | [S2,MB6,B]  367-29-397ms   | [S2,MB7,B]  405-18-424ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-20-158ms   | [S3,MB2,F]  158-14-173ms   | [S3,MB2,B]  175-20-196ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  213-20-234ms   | [S3,MB4,F]  234-14-249ms   | [S3,MB4,B]  251-35-286ms   | [S3,MB5,F]  286-15-301ms   | [S3,MB5,B]  303-20-324ms   | [S3,MB6,F]  324-14-339ms   | [S3,MB6,B]  341-20-362ms   | [S3,MB7,F]  367-14-382ms   | [S3,MB7,B]  384-20-404ms  
[rank2]:2026-01-03 03:26:03,304 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0326_rank2_stage2.svg
[rank2]:	> Counts Sum: 514800, Total Sum: 737280 (69.82%), Ratio(%) per element: [73.82, 67.18, 56.25, 64.84, 55.85, 89.06, 78.12, 57.42, 58.2, 75.78, 55.07, 70.31, 62.89, 79.29, 79.29, 89.45, 55.85, 57.42, 81.25, 73.04, 61.32, 66.01, 74.6, 89.06, 84.37, 55.07, 56.25, 70.31, 65.62, 57.81, 76.56, 60.93, 88.28, 86.71, 55.07, 53.12, 85.15, 60.15, 58.59, 55.46, 85.15, 87.5, 78.51, 58.59, 55.46, 78.9, 65.23, 61.32, 60.15, 87.1, 78.9, 75.78, 56.64, 56.64, 75.0, 75.39, 75.39, 80.07, 87.89, 80.07, 72.26, 55.85, 57.81, 85.15, 78.51, 58.59, 57.03, 85.93, 81.64, 80.85, 55.85, 57.03]
[rank1]:2026-01-03 03:26:03,306 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0326_rank1_stage1.svg
[rank1]:	> Counts Sum: 612240, Total Sum: 829440 (73.81%), Ratio(%) per element: [86.32, 74.21, 64.06, 77.73, 62.89, 86.71, 83.59, 65.23, 62.5, 80.85, 64.84, 68.75, 81.64, 86.71, 85.54, 86.71, 61.71, 66.01, 78.51, 78.9, 61.71, 65.23, 85.93, 83.98, 83.98, 66.01, 62.5, 84.37, 67.96, 64.45, 72.26, 87.1, 84.76, 80.85, 61.71, 61.32, 81.25, 71.87, 71.09, 71.87, 65.23, 87.5, 80.07, 62.1, 64.84, 68.75, 75.39, 69.14, 67.96, 72.26, 80.85, 87.1, 68.75, 64.45, 81.25, 71.48, 68.75, 75.39, 87.1, 67.96, 74.6, 63.28, 66.4, 81.64, 65.62, 67.57, 77.73, 74.21, 76.56, 85.93, 64.45, 63.67, 78.9, 66.79, 76.95, 72.26, 86.32, 82.42, 82.03, 66.01, 65.23]
[rank0]:2026-01-03 03:26:03,328 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0326_rank0_stage0.svg
[rank0]:	> Counts Sum: 331440, Total Sum: 747520 (44.34%), Ratio(%) per element: [33.2, 58.59, 21.09, 37.5, 63.67, 17.96, 57.42, 68.75, 16.4, 20.7, 61.32, 30.07, 18.75, 54.68, 62.89, 66.4, 60.93, 19.53, 17.57, 18.35, 58.2, 52.73, 37.1, 67.57, 64.06, 17.96, 17.18, 18.75, 61.32, 50.78, 27.73, 60.54, 64.84, 72.26, 64.45, 16.01, 18.75, 70.31, 38.28, 17.96, 46.87, 66.01, 71.48, 69.92, 16.79, 17.96, 62.1, 23.82, 66.79, 62.1, 58.2, 67.96, 67.96, 19.92, 18.35, 49.6, 57.81, 47.26, 26.95, 69.53, 66.79, 69.92, 18.35, 18.75, 68.35, 19.14, 26.95, 17.18, 66.01, 70.7, 67.96, 17.96, 18.35]
[rank3]:2026-01-03 03:26:03,251 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0326_stage3_step500.svg
[rank3]:2026-01-03 03:26:03,409 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0326_rank3_stage3.svg
[rank3]:	> Counts Sum: 490240, Total Sum: 665600 (73.65%), Ratio(%) per element: [79.29, 69.14, 62.5, 70.31, 82.81, 82.03, 84.76, 64.84, 62.89, 82.42, 75.0, 69.92, 78.9, 84.37, 81.25, 80.46, 62.89, 61.71, 68.75, 69.14, 73.82, 71.48, 84.76, 76.17, 76.56, 65.23, 66.4, 83.98, 68.75, 66.01, 67.57, 75.0, 82.81, 83.59, 68.35, 66.01, 83.59, 78.12, 71.48, 71.48, 83.2, 69.14, 85.15, 64.45, 64.06, 70.7, 72.26, 71.87, 73.43, 70.31, 83.2, 81.25, 64.06, 66.4, 77.73, 81.64, 78.12, 73.82, 75.78, 84.37, 84.76, 65.23, 64.06, 63.67, 64.06]
[rank2]:2026-01-03 03:26:03,672 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0326_stage2.svg
[rank1]:2026-01-03 03:26:03,681 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0326_stage1.svg
[rank0]:2026-01-03 03:26:03,738 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0326_stage0.svg
[rank3]:2026-01-03 03:26:03,784 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0326_stage3.svg
[rank0]:2026-01-03 03:27:35,684 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-03 03:27:37,594 - Avg. fwd time: 14.2400 / Avg. bwd time: 28.7639 / Avg. batch time: 450.1951 (ms) / GPU bubble ratio: 23.58%
[rank0]:2026-01-03 03:27:37,627 - Avg. fwd time: 14.5356 / Avg. bwd time: 31.9336 / Avg. batch time: 539.8375 (ms) / GPU bubble ratio: 31.14%
[rank3]:2026-01-03 03:27:37,569 - Avg. fwd time: 15.3563 / Avg. bwd time: 32.7881 / Avg. batch time: 404.9686 (ms) / GPU bubble ratio: 4.89%
[rank1]:2026-01-03 03:27:37,621 - Avg. fwd time: 15.9911 / Avg. bwd time: 32.0578 / Avg. batch time: 500.3022 (ms) / GPU bubble ratio: 23.17%
[rank1]:2026-01-03 03:27:37,658 -  step: 550  loss: -4.0000  grad_norm:  0.1909  memory: 58.51GiB(41.85%)  tps: 8,662  tflops: 404.00  mfu: 40.85%
[rank2]:2026-01-03 03:27:37,652 -  step: 550  loss: -4.0000  grad_norm:  0.1909  memory: 48.95GiB(35.01%)  tps: 8,662  tflops: 404.00  mfu: 40.85%
[rank0]:2026-01-03 03:27:37,662 -  step: 550  loss: -4.0000  grad_norm:  0.1909  memory: 67.51GiB(48.29%)  tps: 8,662  tflops: 404.00  mfu: 40.85%
[rank3]:2026-01-03 03:27:37,661 -  step: 550  loss:  0.1703  grad_norm:  0.1909  memory: 57.41GiB(41.06%)  tps: 8,662  tflops: 404.01  mfu: 40.85%
[rank0]:2026-01-03 03:29:11,412 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 03:29:13,369 - Avg. fwd time: 14.2455 / Avg. bwd time: 28.2262 / Avg. batch time: 444.8778 (ms) / GPU bubble ratio: 23.63%
[rank3]:2026-01-03 03:29:13,343 - Avg. fwd time: 15.3619 / Avg. bwd time: 32.1759 / Avg. batch time: 400.3136 (ms) / GPU bubble ratio: 5.00%
[rank0]:2026-01-03 03:29:13,401 - Avg. fwd time: 14.5499 / Avg. bwd time: 31.5185 / Avg. batch time: 532.5608 (ms) / GPU bubble ratio: 30.80%
[rank1]:2026-01-03 03:29:13,395 - Avg. fwd time: 15.9968 / Avg. bwd time: 31.4534 / Avg. batch time: 494.2653 (ms) / GPU bubble ratio: 23.20%
[rank1]:2026-01-03 03:29:13,433 -  step: 600  loss: -4.0000  grad_norm:  0.3075  memory: 58.51GiB(41.85%)  tps: 8,553  tflops: 398.93  mfu: 40.34%
[rank1]:2026-01-03 03:29:13,481 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0329_stage1_step600.svg
[rank2]:2026-01-03 03:29:13,427 -  step: 600  loss: -4.0000  grad_norm:  0.3075  memory: 48.95GiB(35.01%)  tps: 8,553  tflops: 398.93  mfu: 40.34%
[rank2]:2026-01-03 03:29:13,484 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0329_stage2_step600.svg
[rank3]:2026-01-03 03:29:13,435 -  step: 600  loss:  0.3979  grad_norm:  0.3075  memory: 57.49GiB(41.12%)  tps: 8,554  tflops: 398.94  mfu: 40.34%
[rank0]:2026-01-03 03:29:13,437 -  step: 600  loss: -4.0000  grad_norm:  0.3075  memory: 67.51GiB(48.29%)  tps: 8,553  tflops: 398.93  mfu: 40.34%
[rank0]:2026-01-03 03:29:13,482 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0329_stage0_step600.svg
[rank3]:2026-01-03 03:29:13,565 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0329_step600_rank3.svg
[rank3]:			> Batch Time: 457.75 ms, GPU Bubble Ratio: 26.35%, 27.96%, 34.80%, 27.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  163-26-189ms   | [S0,MB4,F]  190-13-203ms   | [S0,MB1,B]  204-38-242ms   | [S0,MB5,F]  242-14-256ms   | [S0,MB2,B]  256-29-286ms   | [S0,MB6,F]  285-14-300ms   | [S0,MB3,B]  300-26-327ms   | [S0,MB7,F]  326-14-341ms   | [S0,MB4,B]  341-44-386ms   | [S0,MB5,B]  403-28-432ms   | [S0,MB6,B]  431-25-457ms   | [S0,MB7,B]  457-0-457ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-178ms   | [S1,MB1,B]  181-20-201ms   | [S1,MB4,F]  203-15-219ms   | [S1,MB2,B]  219-28-247ms   | [S1,MB5,F]  256-15-272ms   | [S1,MB3,B]  272-20-293ms   | [S1,MB6,F]  300-15-315ms   | [S1,MB4,B]  315-20-336ms   | [S1,MB7,F]  341-15-357ms   | [S1,MB5,B]  357-45-403ms   | [S1,MB6,B]  403-21-424ms   | [S1,MB7,B]  429-21-450ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-141ms   | [S2,MB2,F]  141-13-155ms   | [S2,MB1,B]  160-20-181ms   | [S2,MB3,F]  180-13-194ms   | [S2,MB2,B]  198-20-218ms   | [S2,MB4,F]  219-14-233ms   | [S2,MB3,B]  236-33-269ms   | [S2,MB5,F]  272-14-286ms   | [S2,MB4,B]  289-19-308ms   | [S2,MB6,F]  315-13-329ms   | [S2,MB5,B]  330-20-350ms   | [S2,MB7,F]  357-14-371ms   | [S2,MB6,B]  371-31-402ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  122-14-137ms   | [S3,MB1,B]  139-20-160ms   | [S3,MB2,F]  160-14-175ms   | [S3,MB2,B]  177-20-198ms   | [S3,MB3,F]  198-15-213ms   | [S3,MB3,B]  215-21-236ms   | [S3,MB4,F]  236-15-251ms   | [S3,MB4,B]  253-35-288ms   | [S3,MB5,F]  288-15-304ms   | [S3,MB5,B]  306-20-326ms   | [S3,MB6,F]  329-15-344ms   | [S3,MB6,B]  346-20-367ms   | [S3,MB7,F]  371-15-386ms   | [S3,MB7,B]  388-20-408ms  
[rank3]:2026-01-03 03:29:13,607 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0329_stage3_step600.svg
[rank1]:2026-01-03 03:29:13,657 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0329_rank1_stage1.svg
[rank1]:	> Counts Sum: 819840, Total Sum: 1088640 (75.31%), Ratio(%) per element: [85.11, 77.08, 65.47, 78.57, 64.88, 86.3, 83.92, 66.96, 64.58, 81.84, 70.23, 69.64, 82.14, 86.01, 85.41, 86.9, 64.28, 67.85, 76.19, 79.76, 63.98, 67.26, 85.71, 83.33, 83.63, 67.26, 64.88, 84.82, 69.34, 66.66, 75.59, 86.6, 83.92, 82.14, 63.69, 63.98, 82.14, 74.7, 73.8, 73.8, 69.34, 86.3, 81.25, 64.88, 66.36, 72.32, 77.97, 72.32, 71.72, 74.7, 81.84, 86.3, 69.64, 66.66, 82.44, 74.7, 72.02, 77.97, 86.6, 71.72, 77.67, 65.47, 67.85, 82.73, 67.85, 71.72, 79.76, 76.78, 78.27, 85.11, 66.36, 66.07, 80.05, 67.55, 78.86, 74.7, 86.3, 83.03, 81.84, 67.26, 66.96]
[rank2]:2026-01-03 03:29:13,651 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0329_rank2_stage2.svg
[rank2]:	> Counts Sum: 688400, Total Sum: 967680 (71.14%), Ratio(%) per element: [76.78, 68.45, 60.41, 68.45, 58.63, 88.39, 80.65, 59.22, 60.11, 77.67, 60.71, 72.61, 61.9, 81.54, 81.54, 88.98, 57.73, 58.03, 83.33, 70.53, 61.9, 70.83, 72.32, 88.09, 85.71, 55.05, 56.54, 70.23, 70.23, 58.03, 78.86, 62.2, 86.6, 86.3, 55.65, 56.25, 86.6, 60.11, 59.52, 60.11, 85.71, 88.09, 80.65, 58.63, 56.54, 79.76, 66.96, 60.11, 59.52, 87.79, 80.05, 78.57, 59.22, 57.44, 77.67, 78.57, 79.16, 82.44, 87.79, 81.54, 76.19, 56.84, 58.63, 84.82, 79.16, 57.73, 57.44, 86.3, 83.03, 82.44, 56.54, 59.52]
[rank0]:2026-01-03 03:29:13,654 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0329_rank0_stage0.svg
[rank0]:	> Counts Sum: 437040, Total Sum: 981120 (44.55%), Ratio(%) per element: [39.88, 60.11, 25.59, 44.34, 51.48, 18.15, 59.22, 68.45, 15.77, 19.04, 61.9, 26.19, 21.72, 58.63, 63.09, 66.36, 61.9, 18.15, 16.36, 17.55, 60.11, 55.05, 42.85, 66.07, 65.47, 16.96, 16.07, 17.26, 63.69, 52.97, 24.4, 62.79, 64.28, 70.23, 63.98, 15.17, 17.26, 70.53, 35.11, 17.26, 50.0, 65.77, 69.64, 66.36, 16.07, 17.26, 63.09, 30.65, 65.77, 62.2, 60.11, 68.75, 67.26, 18.15, 17.26, 53.27, 56.54, 52.08, 23.51, 68.75, 67.55, 68.45, 16.96, 17.85, 66.96, 30.95, 26.48, 16.36, 65.77, 69.94, 66.66, 16.66, 16.96]
[rank3]:2026-01-03 03:29:13,772 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0329_rank3_stage3.svg
[rank3]:	> Counts Sum: 656640, Total Sum: 873600 (75.16%), Ratio(%) per element: [78.57, 71.13, 65.47, 72.02, 83.03, 83.03, 84.22, 67.26, 66.07, 83.03, 76.48, 73.21, 80.35, 84.22, 82.14, 81.25, 65.77, 65.17, 70.23, 72.61, 75.0, 73.8, 83.92, 77.97, 78.57, 67.55, 68.45, 84.22, 70.23, 68.15, 71.72, 77.38, 82.44, 83.03, 69.94, 68.15, 83.33, 79.16, 72.32, 72.32, 82.73, 72.91, 83.63, 66.96, 66.66, 74.1, 74.7, 74.4, 75.29, 73.21, 83.03, 81.54, 66.66, 68.45, 78.86, 80.35, 79.46, 74.4, 77.97, 83.92, 85.41, 67.55, 66.66, 66.96, 66.66]
[rank1]:2026-01-03 03:29:14,161 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0329_stage1.svg
[rank2]:2026-01-03 03:29:14,127 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0329_stage2.svg
[rank0]:2026-01-03 03:29:14,137 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0329_stage0.svg
[rank3]:2026-01-03 03:29:14,265 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0329_stage3.svg
[rank0]:2026-01-03 03:30:47,932 - [GC] Peforming periodical GC collection 0.02 seconds
[rank2]:2026-01-03 03:30:49,852 - Avg. fwd time: 14.2587 / Avg. bwd time: 27.7847 / Avg. batch time: 440.4014 (ms) / GPU bubble ratio: 23.63%
[rank3]:2026-01-03 03:30:49,826 - Avg. fwd time: 15.3786 / Avg. bwd time: 31.6697 / Avg. batch time: 396.3571 (ms) / GPU bubble ratio: 5.04%
[rank0]:2026-01-03 03:30:49,886 - Avg. fwd time: 14.5702 / Avg. bwd time: 31.1260 / Avg. batch time: 526.2435 (ms) / GPU bubble ratio: 30.53%
[rank1]:2026-01-03 03:30:49,879 - Avg. fwd time: 16.0102 / Avg. bwd time: 30.9446 / Avg. batch time: 489.1929 (ms) / GPU bubble ratio: 23.21%
[rank1]:2026-01-03 03:30:49,917 -  step: 650  loss: -4.0000  grad_norm: 379.9321  memory: 58.51GiB(41.85%)  tps: 8,490  tflops: 396.00  mfu: 40.04%
[rank2]:2026-01-03 03:30:49,911 -  step: 650  loss: -4.0000  grad_norm: 379.9321  memory: 48.95GiB(35.01%)  tps: 8,491  tflops: 396.00  mfu: 40.04%
[rank3]:2026-01-03 03:30:49,920 -  step: 650  loss:  0.3717  grad_norm: 379.9321  memory: 57.49GiB(41.12%)  tps: 8,491  tflops: 396.00  mfu: 40.04%
[rank0]:2026-01-03 03:30:49,922 -  step: 650  loss: -4.0000  grad_norm: 379.9321  memory: 67.51GiB(48.29%)  tps: 8,491  tflops: 396.00  mfu: 40.04%
[rank0]:2026-01-03 03:32:23,817 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 03:32:25,766 - Avg. fwd time: 14.2704 / Avg. bwd time: 27.4058 / Avg. batch time: 436.5528 (ms) / GPU bubble ratio: 23.63%
[rank3]:2026-01-03 03:32:25,740 - Avg. fwd time: 15.3940 / Avg. bwd time: 31.2491 / Avg. batch time: 392.9788 (ms) / GPU bubble ratio: 5.05%
[rank1]:2026-01-03 03:32:25,793 - Avg. fwd time: 16.0232 / Avg. bwd time: 30.5122 / Avg. batch time: 484.8343 (ms) / GPU bubble ratio: 23.21%
[rank1]:2026-01-03 03:32:25,832 -  step: 700  loss: -4.0000  grad_norm:  0.3413  memory: 58.51GiB(41.85%)  tps: 8,541  tflops: 398.35  mfu: 40.28%
[rank2]:2026-01-03 03:32:25,825 -  step: 700  loss: -4.0000  grad_norm:  0.3413  memory: 48.95GiB(35.01%)  tps: 8,541  tflops: 398.35  mfu: 40.28%
[rank0]:2026-01-03 03:32:25,800 - Avg. fwd time: 14.5877 / Avg. bwd time: 30.7894 / Avg. batch time: 520.8399 (ms) / GPU bubble ratio: 30.30%
[rank0]:2026-01-03 03:32:25,836 -  step: 700  loss: -4.0000  grad_norm:  0.3413  memory: 67.51GiB(48.29%)  tps: 8,541  tflops: 398.35  mfu: 40.28%
[rank3]:2026-01-03 03:32:25,834 -  step: 700  loss:  0.3521  grad_norm:  0.3413  memory: 57.49GiB(41.12%)  tps: 8,541  tflops: 398.36  mfu: 40.28%
[rank1]:2026-01-03 03:32:25,884 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0332_stage1_step700.svg
[rank2]:2026-01-03 03:32:25,883 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0332_stage2_step700.svg
[rank0]:2026-01-03 03:32:25,887 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0332_stage0_step700.svg
[rank3]:2026-01-03 03:32:25,959 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0332_step700_rank3.svg
[rank3]:			> Batch Time: 456.25 ms, GPU Bubble Ratio: 26.54%, 27.64%, 34.77%, 27.01%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  164-25-189ms   | [S0,MB4,F]  189-14-203ms   | [S0,MB1,B]  203-35-239ms   | [S0,MB5,F]  240-14-254ms   | [S0,MB2,B]  254-28-282ms   | [S0,MB6,F]  282-14-297ms   | [S0,MB3,B]  297-28-325ms   | [S0,MB7,F]  324-14-339ms   | [S0,MB4,B]  339-44-383ms   | [S0,MB5,B]  401-26-428ms   | [S0,MB6,B]  428-27-456ms   | [S0,MB7,B]  456-0-456ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  203-15-219ms   | [S1,MB2,B]  219-28-247ms   | [S1,MB5,F]  254-15-270ms   | [S1,MB3,B]  272-20-293ms   | [S1,MB6,F]  296-15-312ms   | [S1,MB4,B]  312-20-333ms   | [S1,MB7,F]  338-15-354ms   | [S1,MB5,B]  355-46-401ms   | [S1,MB6,B]  401-21-422ms   | [S1,MB7,B]  428-20-449ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-142ms   | [S2,MB2,F]  142-13-156ms   | [S2,MB1,B]  161-19-180ms   | [S2,MB3,F]  180-13-194ms   | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  219-14-233ms   | [S2,MB3,B]  237-34-272ms   | [S2,MB5,F]  272-14-286ms   | [S2,MB4,B]  291-19-311ms   | [S2,MB6,F]  312-14-326ms   | [S2,MB5,B]  330-20-351ms   | [S2,MB7,F]  355-14-369ms   | [S2,MB6,B]  369-30-399ms   | [S2,MB7,B]  408-18-427ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-20-160ms   | [S3,MB2,F]  160-15-175ms   | [S3,MB2,B]  177-20-198ms   | [S3,MB3,F]  198-15-214ms   | [S3,MB3,B]  216-21-237ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  254-36-291ms   | [S3,MB5,F]  291-15-306ms   | [S3,MB5,B]  308-20-329ms   | [S3,MB6,F]  330-15-345ms   | [S3,MB6,B]  347-21-368ms   | [S3,MB7,F]  369-15-384ms   | [S3,MB7,B]  386-20-407ms  
[rank2]:2026-01-03 03:32:26,052 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0332_rank2_stage2.svg
[rank2]:	> Counts Sum: 862000, Total Sum: 1198080 (71.95%), Ratio(%) per element: [78.6, 66.34, 65.38, 72.59, 58.41, 88.46, 81.0, 58.65, 59.85, 79.8, 62.74, 74.03, 63.94, 83.17, 81.73, 89.18, 58.65, 58.89, 83.41, 72.83, 64.18, 73.55, 69.23, 88.46, 85.33, 54.32, 56.49, 72.35, 74.03, 58.65, 80.52, 67.06, 86.29, 86.77, 57.93, 57.93, 86.77, 59.61, 60.33, 64.66, 86.05, 87.25, 81.73, 58.65, 56.25, 81.25, 65.62, 60.09, 59.61, 86.77, 81.49, 79.8, 59.13, 56.97, 79.08, 79.56, 76.44, 83.41, 87.74, 81.97, 77.88, 56.73, 59.13, 86.29, 80.52, 58.65, 59.37, 86.05, 83.17, 83.65, 57.21, 60.33]
[rank0]:2026-01-03 03:32:26,062 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0332_rank0_stage0.svg
[rank0]:	> Counts Sum: 542640, Total Sum: 1214720 (44.67%), Ratio(%) per element: [45.67, 59.13, 32.69, 48.31, 45.43, 26.92, 60.57, 67.3, 15.14, 17.78, 62.5, 23.79, 30.52, 59.13, 63.94, 66.1, 62.01, 17.3, 15.62, 17.3, 60.81, 55.76, 43.26, 65.14, 64.42, 21.63, 15.38, 16.34, 63.22, 54.32, 27.16, 63.46, 62.98, 68.99, 63.46, 14.66, 16.58, 69.23, 40.38, 16.34, 52.88, 65.38, 68.5, 65.38, 16.1, 16.58, 62.98, 36.77, 64.9, 52.88, 62.25, 69.71, 66.34, 17.3, 16.58, 53.84, 58.89, 51.44, 21.63, 67.06, 65.86, 66.58, 16.1, 16.82, 66.1, 29.08, 24.27, 16.1, 65.38, 68.5, 65.62, 15.86, 16.34]
[rank3]:2026-01-03 03:32:26,001 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0332_stage3_step700.svg
[rank1]:2026-01-03 03:32:26,062 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0332_rank1_stage1.svg
[rank1]:	> Counts Sum: 1027440, Total Sum: 1347840 (76.23%), Ratio(%) per element: [84.85, 77.16, 66.58, 79.56, 68.26, 86.29, 83.89, 68.75, 66.1, 82.21, 73.07, 70.67, 81.49, 85.57, 85.33, 86.05, 66.1, 68.5, 75.48, 80.76, 65.62, 67.78, 85.33, 83.41, 83.89, 68.26, 65.86, 85.09, 70.43, 68.99, 77.16, 86.05, 84.13, 82.45, 65.14, 65.86, 82.45, 76.44, 72.83, 75.48, 72.59, 85.81, 81.97, 65.86, 67.54, 74.27, 79.56, 72.59, 74.27, 76.44, 82.69, 86.05, 69.71, 67.3, 83.17, 77.16, 73.79, 78.12, 86.53, 74.03, 79.08, 66.82, 68.75, 83.17, 68.99, 74.51, 80.52, 78.6, 79.8, 84.61, 67.54, 68.02, 80.76, 68.75, 80.28, 76.44, 86.05, 83.89, 82.21, 68.5, 68.02]
[rank3]:2026-01-03 03:32:26,159 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0332_rank3_stage3.svg
[rank3]:	> Counts Sum: 823040, Total Sum: 1081600 (76.09%), Ratio(%) per element: [77.88, 73.55, 67.3, 74.03, 82.45, 83.17, 83.65, 68.75, 67.78, 81.49, 77.64, 74.75, 79.32, 83.65, 82.69, 81.49, 67.54, 67.06, 72.11, 75.0, 76.2, 74.75, 83.41, 79.08, 78.6, 68.99, 69.71, 84.61, 72.35, 69.47, 74.03, 78.6, 82.21, 82.93, 70.91, 69.47, 83.89, 80.28, 72.83, 72.83, 82.21, 74.51, 83.89, 68.5, 68.26, 76.44, 75.72, 76.44, 77.16, 75.24, 83.41, 80.76, 68.26, 69.71, 79.56, 80.76, 80.28, 75.72, 78.84, 84.13, 85.57, 68.99, 68.26, 68.5, 68.26]
[rank2]:2026-01-03 03:32:26,664 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0332_stage2.svg
[rank0]:2026-01-03 03:32:26,652 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0332_stage0.svg
[rank1]:2026-01-03 03:32:26,665 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0332_stage1.svg
[rank3]:2026-01-03 03:32:26,750 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0332_stage3.svg
[rank0]:2026-01-03 03:34:00,684 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 03:34:02,599 - Avg. fwd time: 15.4012 / Avg. bwd time: 30.8742 / Avg. batch time: 390.0327 (ms) / GPU bubble ratio: 5.08%
[rank2]:2026-01-03 03:34:02,624 - Avg. fwd time: 14.2760 / Avg. bwd time: 27.0611 / Avg. batch time: 433.2063 (ms) / GPU bubble ratio: 23.66%
[rank1]:2026-01-03 03:34:02,652 - Avg. fwd time: 16.0308 / Avg. bwd time: 30.1399 / Avg. batch time: 481.0411 (ms) / GPU bubble ratio: 23.22%
[rank1]:2026-01-03 03:34:02,690 -  step: 750  loss: -4.0000  grad_norm:  0.2481  memory: 58.51GiB(41.85%)  tps: 8,458  tflops: 394.47  mfu: 39.89%
[rank0]:2026-01-03 03:34:02,658 - Avg. fwd time: 14.6004 / Avg. bwd time: 30.5313 / Avg. batch time: 516.3336 (ms) / GPU bubble ratio: 30.07%
[rank0]:2026-01-03 03:34:02,694 -  step: 750  loss: -4.0000  grad_norm:  0.2481  memory: 67.51GiB(48.29%)  tps: 8,458  tflops: 394.47  mfu: 39.89%
[rank3]:2026-01-03 03:34:02,693 -  step: 750  loss:  0.1471  grad_norm:  0.2481  memory: 57.49GiB(41.12%)  tps: 8,458  tflops: 394.47  mfu: 39.89%
[rank2]:2026-01-03 03:34:02,684 -  step: 750  loss: -4.0000  grad_norm:  0.2481  memory: 48.95GiB(35.01%)  tps: 8,458  tflops: 394.47  mfu: 39.89%
[rank0]:2026-01-03 03:35:36,018 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-03 03:35:38,028 - Avg. fwd time: 14.6034 / Avg. bwd time: 30.3125 / Avg. batch time: 512.3322 (ms) / GPU bubble ratio: 29.86%
[rank3]:2026-01-03 03:35:37,967 - Avg. fwd time: 15.3988 / Avg. bwd time: 30.5397 / Avg. batch time: 387.4008 (ms) / GPU bubble ratio: 5.13%
[rank2]:2026-01-03 03:35:37,993 - Avg. fwd time: 14.2744 / Avg. bwd time: 26.7416 / Avg. batch time: 430.1987 (ms) / GPU bubble ratio: 23.73%
[rank1]:2026-01-03 03:35:38,021 - Avg. fwd time: 16.0293 / Avg. bwd time: 29.8086 / Avg. batch time: 477.6315 (ms) / GPU bubble ratio: 23.22%
[rank1]:2026-01-03 03:35:38,059 -  step: 800  loss: -4.0000  grad_norm:  0.2746  memory: 58.51GiB(41.85%)  tps: 8,590  tflops: 400.63  mfu: 40.51%
[rank0]:2026-01-03 03:35:38,063 -  step: 800  loss: -4.0000  grad_norm:  0.2746  memory: 67.51GiB(48.29%)  tps: 8,590  tflops: 400.63  mfu: 40.51%
[rank0]:2026-01-03 03:35:38,115 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0335_stage0_step800.svg
[rank3]:2026-01-03 03:35:38,061 -  step: 800  loss:  0.2658  grad_norm:  0.2746  memory: 57.49GiB(41.12%)  tps: 8,590  tflops: 400.64  mfu: 40.51%
[rank2]:2026-01-03 03:35:38,051 -  step: 800  loss: -4.0000  grad_norm:  0.2746  memory: 48.95GiB(35.01%)  tps: 8,590  tflops: 400.64  mfu: 40.51%
[rank2]:2026-01-03 03:35:38,112 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0335_stage2_step800.svg
[rank1]:2026-01-03 03:35:38,113 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0335_stage1_step800.svg
[rank3]:2026-01-03 03:35:38,187 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0335_step800_rank3.svg
[rank3]:			> Batch Time: 451.25 ms, GPU Bubble Ratio: 26.77%, 27.15%, 35.29%, 27.03%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-26-189ms   | [S0,MB4,F]  189-13-203ms   | [S0,MB1,B]  203-37-240ms   | [S0,MB5,F]  240-14-254ms   | [S0,MB2,B]  254-27-282ms   | [S0,MB6,F]  282-14-296ms   | [S0,MB3,B]  296-25-322ms   | [S0,MB7,F]  323-14-337ms   | [S0,MB4,B]  337-44-381ms   | [S0,MB5,B]  399-27-426ms   | [S0,MB6,B]  426-24-450ms   | [S0,MB7,B]  451-0-451ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  141-20-162ms   | [S1,MB3,F]  162-15-177ms   | [S1,MB1,B]  178-20-199ms   | [S1,MB4,F]  202-15-218ms   | [S1,MB2,B]  218-28-247ms   | [S1,MB5,F]  254-15-270ms   | [S1,MB3,B]  270-20-291ms   | [S1,MB6,F]  296-15-312ms   | [S1,MB4,B]  312-20-333ms   | [S1,MB7,F]  337-15-352ms   | [S1,MB5,B]  352-45-398ms   | [S1,MB6,B]  399-21-420ms   | [S1,MB7,B]  423-20-444ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-18-178ms   | [S2,MB3,F]  178-13-192ms   | [S2,MB2,B]  197-19-216ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-34-269ms   | [S2,MB5,F]  270-14-284ms   | [S2,MB4,B]  288-19-307ms   | [S2,MB6,F]  312-13-326ms   | [S2,MB5,B]  326-19-345ms   | [S2,MB7,F]  352-13-366ms   | [S2,MB6,B]  366-29-396ms   | [S2,MB7,B]  404-18-423ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  122-14-136ms   | [S3,MB1,B]  138-20-159ms   | [S3,MB2,F]  159-14-174ms   | [S3,MB2,B]  176-20-196ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  213-20-234ms   | [S3,MB4,F]  234-14-249ms   | [S3,MB4,B]  251-35-287ms   | [S3,MB5,F]  287-15-303ms   | [S3,MB5,B]  304-20-325ms   | [S3,MB6,F]  326-14-341ms   | [S3,MB6,B]  343-20-364ms   | [S3,MB7,F]  366-14-381ms   | [S3,MB7,B]  383-20-403ms  
[rank3]:2026-01-03 03:35:38,230 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0335_stage3_step800.svg
[rank1]:2026-01-03 03:35:38,294 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0335_rank1_stage1.svg
[rank1]:	> Counts Sum: 1235040, Total Sum: 1607040 (76.85%), Ratio(%) per element: [85.28, 77.41, 67.54, 80.44, 70.36, 85.68, 83.46, 69.15, 67.54, 82.66, 74.19, 70.36, 79.83, 85.48, 85.28, 86.29, 67.33, 69.15, 77.01, 81.25, 66.73, 68.75, 85.48, 83.66, 84.07, 68.75, 66.93, 85.08, 72.98, 71.16, 78.02, 85.68, 84.07, 82.45, 66.12, 66.93, 82.66, 77.41, 73.38, 76.81, 74.39, 85.68, 82.25, 66.73, 67.94, 76.0, 78.42, 72.58, 75.4, 78.02, 82.25, 85.88, 70.56, 67.74, 83.06, 78.62, 75.0, 79.03, 85.48, 75.8, 79.83, 68.14, 69.55, 83.66, 71.77, 75.6, 81.04, 79.23, 80.84, 84.67, 67.94, 68.75, 81.45, 70.76, 81.25, 77.62, 85.68, 83.87, 82.66, 68.34, 68.34]
[rank0]:2026-01-03 03:35:38,287 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0335_rank0_stage0.svg
[rank0]:	> Counts Sum: 648240, Total Sum: 1448320 (44.76%), Ratio(%) per element: [47.17, 59.67, 37.29, 50.0, 47.78, 32.66, 61.49, 65.92, 14.71, 17.33, 61.49, 21.97, 35.88, 59.47, 65.12, 64.71, 61.69, 16.73, 15.12, 23.58, 60.68, 56.65, 38.5, 64.51, 64.31, 28.42, 14.91, 16.12, 62.7, 55.44, 32.66, 62.9, 61.89, 66.93, 63.3, 14.31, 15.92, 68.14, 43.95, 15.72, 54.43, 64.11, 66.33, 64.91, 15.92, 16.12, 62.5, 40.52, 64.71, 52.41, 62.29, 68.75, 65.32, 16.53, 15.92, 54.83, 59.87, 50.6, 20.16, 63.91, 65.92, 64.71, 15.52, 16.33, 65.92, 26.41, 22.37, 15.72, 64.31, 65.72, 64.71, 15.32, 16.12]
[rank2]:2026-01-03 03:35:38,282 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0335_rank2_stage2.svg
[rank2]:	> Counts Sum: 1035600, Total Sum: 1428480 (72.50%), Ratio(%) per element: [79.63, 70.16, 67.94, 73.99, 62.29, 87.9, 81.85, 58.46, 58.46, 80.64, 65.92, 76.2, 66.73, 83.87, 81.85, 88.7, 58.26, 58.46, 83.87, 75.2, 66.93, 74.79, 69.75, 87.9, 85.48, 55.24, 57.45, 74.39, 75.6, 58.06, 81.45, 70.16, 86.08, 87.29, 57.66, 57.45, 86.08, 59.67, 60.48, 68.14, 85.68, 87.5, 82.45, 58.66, 56.45, 81.45, 64.71, 59.47, 59.47, 86.49, 81.65, 81.45, 58.87, 57.25, 80.84, 80.44, 72.78, 83.26, 87.29, 82.86, 79.43, 56.45, 58.66, 85.28, 79.63, 57.25, 63.3, 85.88, 83.66, 84.67, 56.65, 59.07]
[rank3]:2026-01-03 03:35:38,391 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0335_rank3_stage3.svg
[rank3]:	> Counts Sum: 989440, Total Sum: 1289600 (76.72%), Ratio(%) per element: [77.41, 75.2, 68.54, 76.0, 82.25, 83.06, 83.87, 69.75, 68.95, 81.04, 78.83, 75.8, 78.62, 83.46, 82.45, 82.05, 68.75, 68.34, 73.79, 76.2, 77.62, 74.79, 83.46, 79.43, 78.62, 70.36, 70.56, 84.47, 73.79, 70.96, 75.6, 78.62, 81.65, 82.45, 71.57, 70.36, 84.07, 81.04, 73.18, 73.18, 82.45, 75.8, 83.87, 69.55, 69.35, 77.41, 77.21, 77.21, 78.02, 76.2, 83.66, 81.25, 69.35, 70.56, 79.83, 80.64, 80.44, 77.01, 79.03, 84.47, 84.87, 69.95, 69.55, 69.55, 69.35]
[rank0]:2026-01-03 03:35:38,972 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0335_stage0.svg
[rank2]:2026-01-03 03:35:38,984 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0335_stage2.svg
[rank1]:2026-01-03 03:35:39,082 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0335_stage1.svg
[rank3]:2026-01-03 03:35:39,101 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0335_stage3.svg
[rank0]:2026-01-03 03:37:12,540 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 03:37:14,403 - Avg. fwd time: 15.3994 / Avg. bwd time: 30.2431 / Avg. batch time: 385.1158 (ms) / GPU bubble ratio: 5.19%
[rank1]:2026-01-03 03:37:14,459 - Avg. fwd time: 16.0317 / Avg. bwd time: 29.5172 / Avg. batch time: 474.6719 (ms) / GPU bubble ratio: 23.23%
[rank3]:2026-01-03 03:37:14,501 -  step: 850  loss:  0.1250  grad_norm:  0.1865  memory: 57.49GiB(41.12%)  tps: 8,495  tflops: 396.19  mfu: 40.06%
[rank0]:2026-01-03 03:37:14,466 - Avg. fwd time: 14.6093 / Avg. bwd time: 30.1146 / Avg. batch time: 508.8218 (ms) / GPU bubble ratio: 29.68%
[rank0]:2026-01-03 03:37:14,503 -  step: 850  loss: -4.0000  grad_norm:  0.1865  memory: 67.59GiB(48.34%)  tps: 8,494  tflops: 396.18  mfu: 40.06%
[rank2]:2026-01-03 03:37:14,430 - Avg. fwd time: 14.2759 / Avg. bwd time: 26.4710 / Avg. batch time: 427.5882 (ms) / GPU bubble ratio: 23.76%
[rank2]:2026-01-03 03:37:14,493 -  step: 850  loss: -4.0000  grad_norm:  0.1865  memory: 48.95GiB(35.01%)  tps: 8,494  tflops: 396.17  mfu: 40.06%
[rank1]:2026-01-03 03:37:14,498 -  step: 850  loss: -4.0000  grad_norm:  0.1865  memory: 58.51GiB(41.85%)  tps: 8,495  tflops: 396.18  mfu: 40.06%
[rank0]:2026-01-03 03:38:46,863 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:38:48,767 - Avg. fwd time: 15.3884 / Avg. bwd time: 29.9724 / Avg. batch time: 382.9933 (ms) / GPU bubble ratio: 5.25%
[rank2]:2026-01-03 03:38:48,794 - Avg. fwd time: 14.2695 / Avg. bwd time: 26.2335 / Avg. batch time: 425.1640 (ms) / GPU bubble ratio: 23.79%
[rank1]:2026-01-03 03:38:48,823 - Avg. fwd time: 16.0254 / Avg. bwd time: 29.2595 / Avg. batch time: 471.9245 (ms) / GPU bubble ratio: 23.23%
[rank1]:2026-01-03 03:38:48,862 -  step: 900  loss: -4.0000  grad_norm:  0.2497  memory: 58.51GiB(41.85%)  tps: 8,681  tflops: 404.90  mfu: 40.94%
[rank3]:2026-01-03 03:38:48,865 -  step: 900  loss:  0.1866  grad_norm:  0.2497  memory: 57.49GiB(41.12%)  tps: 8,681  tflops: 404.90  mfu: 40.94%
[rank0]:2026-01-03 03:38:48,831 - Avg. fwd time: 14.6066 / Avg. bwd time: 29.9324 / Avg. batch time: 505.5442 (ms) / GPU bubble ratio: 29.52%
[rank0]:2026-01-03 03:38:48,867 -  step: 900  loss: -4.0000  grad_norm:  0.2497  memory: 67.59GiB(48.34%)  tps: 8,681  tflops: 404.90  mfu: 40.94%
[rank2]:2026-01-03 03:38:48,859 -  step: 900  loss: -4.0000  grad_norm:  0.2497  memory: 48.95GiB(35.01%)  tps: 8,681  tflops: 404.89  mfu: 40.94%
[rank2]:2026-01-03 03:38:48,908 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0338_stage2_step900.svg
[rank1]:2026-01-03 03:38:48,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0338_stage1_step900.svg
[rank3]:2026-01-03 03:38:48,991 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0338_step900_rank3.svg
[rank3]:			> Batch Time: 454.25 ms, GPU Bubble Ratio: 26.48%, 27.89%, 35.53%, 27.60%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-27-189ms   | [S0,MB4,F]  189-13-203ms   | [S0,MB1,B]  203-37-241ms   | [S0,MB5,F]  241-14-255ms   | [S0,MB2,B]  256-27-283ms   | [S0,MB6,F]  283-14-297ms   | [S0,MB3,B]  297-28-326ms   | [S0,MB7,F]  326-14-340ms   | [S0,MB4,B]  340-43-384ms   | [S0,MB5,B]  402-25-427ms   | [S0,MB6,B]  428-26-454ms   | [S0,MB7,B]  454-0-454ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  140-20-161ms   | [S1,MB3,F]  161-15-177ms   | [S1,MB1,B]  178-20-199ms   | [S1,MB4,F]  203-15-219ms   | [S1,MB2,B]  219-28-247ms   | [S1,MB5,F]  255-15-271ms   | [S1,MB3,B]  271-20-292ms   | [S1,MB6,F]  297-15-313ms   | [S1,MB4,B]  313-20-333ms   | [S1,MB7,F]  340-15-356ms   | [S1,MB5,B]  355-45-401ms   | [S1,MB6,B]  401-21-423ms   | [S1,MB7,B]  426-20-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-18-178ms   | [S2,MB3,F]  178-13-192ms   | [S2,MB2,B]  196-18-215ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-34-268ms   | [S2,MB5,F]  271-13-285ms   | [S2,MB4,B]  287-19-306ms   | [S2,MB6,F]  312-13-326ms   | [S2,MB5,B]  326-19-345ms   | [S2,MB7,F]  355-13-369ms   | [S2,MB6,B]  369-30-400ms   | [S2,MB7,B]  407-18-426ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-20-158ms   | [S3,MB2,F]  159-14-173ms   | [S3,MB2,B]  175-20-196ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  213-20-233ms   | [S3,MB4,F]  234-14-248ms   | [S3,MB4,B]  250-36-287ms   | [S3,MB5,F]  287-15-302ms   | [S3,MB5,B]  304-20-325ms   | [S3,MB6,F]  326-14-341ms   | [S3,MB6,B]  343-20-364ms   | [S3,MB7,F]  369-14-384ms   | [S3,MB7,B]  386-20-406ms  
[rank0]:2026-01-03 03:38:48,913 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0338_stage0_step900.svg
[rank3]:2026-01-03 03:38:49,029 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0338_stage3_step900.svg
[rank0]:2026-01-03 03:38:49,089 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0338_rank0_stage0.svg
[rank0]:	> Counts Sum: 753840, Total Sum: 1681920 (44.82%), Ratio(%) per element: [48.26, 60.24, 40.1, 50.69, 49.13, 36.97, 60.24, 66.31, 14.75, 16.66, 61.97, 20.65, 39.06, 58.85, 63.71, 64.58, 61.63, 16.14, 14.75, 29.51, 60.59, 56.77, 34.89, 63.36, 63.71, 33.15, 15.1, 15.79, 62.5, 55.72, 37.32, 61.8, 62.67, 65.27, 61.63, 14.23, 15.45, 66.84, 46.35, 15.45, 55.38, 63.88, 65.62, 63.54, 15.45, 15.97, 61.63, 43.75, 63.71, 53.47, 61.97, 67.7, 63.88, 16.14, 15.45, 54.86, 57.98, 51.21, 19.09, 63.88, 65.79, 64.4, 15.27, 15.79, 64.93, 28.29, 21.0, 15.27, 63.02, 65.1, 64.4, 14.93, 15.97]
[rank2]:2026-01-03 03:38:49,075 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0338_rank2_stage2.svg
[rank2]:	> Counts Sum: 1209200, Total Sum: 1658880 (72.89%), Ratio(%) per element: [80.55, 71.7, 69.79, 76.04, 64.58, 87.84, 82.29, 58.33, 58.68, 81.59, 69.09, 77.6, 67.01, 83.85, 82.29, 88.36, 56.94, 57.63, 83.85, 77.08, 69.79, 76.56, 70.13, 87.32, 86.11, 55.38, 56.07, 75.86, 76.56, 56.59, 81.94, 72.39, 86.8, 86.97, 58.15, 57.29, 85.59, 62.15, 63.02, 70.48, 84.89, 87.5, 82.63, 57.29, 56.59, 82.29, 64.4, 58.85, 59.2, 86.28, 81.59, 82.11, 58.85, 56.94, 81.42, 81.25, 70.13, 83.5, 86.97, 83.5, 80.72, 55.9, 58.68, 84.89, 79.16, 56.94, 66.31, 84.89, 83.85, 84.89, 56.42, 58.85]
[rank1]:2026-01-03 03:38:49,087 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0338_rank1_stage1.svg
[rank1]:	> Counts Sum: 1442640, Total Sum: 1866240 (77.30%), Ratio(%) per element: [84.72, 78.29, 68.57, 80.38, 72.04, 85.59, 83.33, 69.44, 67.88, 82.46, 76.04, 70.31, 80.55, 85.41, 85.06, 85.59, 67.88, 69.44, 77.25, 81.25, 67.01, 70.83, 85.24, 83.85, 84.02, 69.09, 67.53, 84.72, 74.65, 72.74, 78.47, 85.59, 84.37, 82.29, 67.18, 67.7, 83.15, 78.12, 73.78, 78.29, 75.86, 85.59, 82.46, 67.7, 68.92, 77.43, 78.64, 72.91, 76.56, 78.99, 82.63, 85.41, 70.48, 68.22, 83.5, 79.34, 76.38, 79.86, 85.24, 77.08, 80.2, 68.4, 69.96, 83.85, 73.09, 75.52, 80.55, 80.2, 81.07, 84.54, 68.22, 69.27, 81.77, 72.74, 81.59, 78.64, 85.41, 82.81, 82.46, 68.57, 68.92]
[rank3]:2026-01-03 03:38:49,190 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0338_rank3_stage3.svg
[rank3]:	> Counts Sum: 1155840, Total Sum: 1497600 (77.18%), Ratio(%) per element: [77.08, 76.56, 69.44, 76.56, 82.11, 83.33, 83.5, 70.48, 69.79, 81.42, 79.86, 77.08, 78.12, 83.5, 82.46, 82.11, 69.61, 69.27, 74.65, 76.73, 78.29, 74.82, 83.15, 80.03, 79.34, 71.0, 71.35, 84.54, 75.17, 72.56, 76.56, 79.16, 81.25, 82.29, 72.22, 71.0, 83.33, 81.25, 73.43, 73.61, 82.98, 76.73, 83.33, 70.31, 70.13, 77.95, 77.25, 77.77, 78.99, 77.08, 83.33, 81.42, 70.13, 71.18, 80.72, 80.55, 81.07, 77.77, 79.51, 84.02, 84.72, 70.65, 70.31, 70.31, 70.13]
[rank0]:2026-01-03 03:38:49,883 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0338_stage0.svg
[rank2]:2026-01-03 03:38:49,883 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0338_stage2.svg
[rank1]:2026-01-03 03:38:49,925 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0338_stage1.svg
[rank3]:2026-01-03 03:38:50,010 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0338_stage3.svg
[rank0]:2026-01-03 03:40:23,507 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-03 03:40:25,456 - Avg. fwd time: 16.0256 / Avg. bwd time: 29.0305 / Avg. batch time: 469.6403 (ms) / GPU bubble ratio: 23.25%
[rank0]:2026-01-03 03:40:25,463 - Avg. fwd time: 14.6104 / Avg. bwd time: 29.7904 / Avg. batch time: 502.8453 (ms) / GPU bubble ratio: 29.36%
[rank3]:2026-01-03 03:40:25,401 - Avg. fwd time: 15.3863 / Avg. bwd time: 29.7274 / Avg. batch time: 381.2379 (ms) / GPU bubble ratio: 5.33%
[rank2]:2026-01-03 03:40:25,427 - Avg. fwd time: 14.2688 / Avg. bwd time: 26.0114 / Avg. batch time: 423.1599 (ms) / GPU bubble ratio: 23.85%
[rank2]:2026-01-03 03:40:25,490 -  step: 950  loss: -4.0000  grad_norm:  0.3858  memory: 48.95GiB(35.01%)  tps: 8,478  tflops: 395.40  mfu: 39.98%
[rank1]:2026-01-03 03:40:25,495 -  step: 950  loss: -4.0000  grad_norm:  0.3858  memory: 58.51GiB(41.85%)  tps: 8,478  tflops: 395.39  mfu: 39.98%
[rank0]:2026-01-03 03:40:25,499 -  step: 950  loss: -4.0000  grad_norm:  0.3858  memory: 67.59GiB(48.34%)  tps: 8,478  tflops: 395.39  mfu: 39.98%
[rank3]:2026-01-03 03:40:25,497 -  step: 950  loss:  0.2466  grad_norm:  0.3858  memory: 57.49GiB(41.12%)  tps: 8,478  tflops: 395.40  mfu: 39.98%
[rank0]:2026-01-03 03:41:58,548 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:42:00,443 - Avg. fwd time: 15.3887 / Avg. bwd time: 29.5191 / Avg. batch time: 379.5636 (ms) / GPU bubble ratio: 5.35%
[rank2]:2026-01-03 03:42:00,469 - Avg. fwd time: 14.2706 / Avg. bwd time: 25.8258 / Avg. batch time: 421.2535 (ms) / GPU bubble ratio: 23.85%
[rank1]:2026-01-03 03:42:00,498 - Avg. fwd time: 16.0271 / Avg. bwd time: 28.8239 / Avg. batch time: 467.4841 (ms) / GPU bubble ratio: 23.25%
[rank1]:2026-01-03 03:42:00,538 -  step: 1000  loss: -4.0000  grad_norm:  0.1964  memory: 58.51GiB(41.85%)  tps: 8,619  tflops: 402.00  mfu: 40.65%
[rank1]:2026-01-03 03:42:00,538 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 03:42:00,506 - Avg. fwd time: 14.6147 / Avg. bwd time: 29.6277 / Avg. batch time: 500.1788 (ms) / GPU bubble ratio: 29.24%
[rank0]:2026-01-03 03:42:00,542 -  step: 1000  loss: -4.0000  grad_norm:  0.1964  memory: 67.59GiB(48.34%)  tps: 8,619  tflops: 402.00  mfu: 40.65%
[rank0]:2026-01-03 03:42:00,542 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 03:42:00,543 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2026-01-03 03:42:00,540 -  step: 1000  loss:  0.1573  grad_norm:  0.1964  memory: 57.49GiB(41.12%)  tps: 8,619  tflops: 402.01  mfu: 40.65%
[rank3]:2026-01-03 03:42:00,541 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 03:42:00,532 -  step: 1000  loss: -4.0000  grad_norm:  0.1964  memory: 48.95GiB(35.01%)  tps: 8,619  tflops: 402.01  mfu: 40.65%
[rank2]:2026-01-03 03:42:00,532 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 03:42:12,658 - Finished saving the checkpoint (or staging if async is enabled)in 12.13 seconds.
[rank1]:2026-01-03 03:42:12,916 - Finished saving the checkpoint (or staging if async is enabled)in 12.38 seconds.
[rank3]:2026-01-03 03:42:13,689 - Finished saving the checkpoint (or staging if async is enabled)in 13.15 seconds.
[rank0]:2026-01-03 03:42:16,358 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-03 03:42:16,359 - Finished saving the checkpoint (or staging if async is enabled)in 15.82 seconds.
[rank1]:2026-01-03 03:42:16,415 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0342_stage1_step1000.svg
[rank0]:2026-01-03 03:42:16,454 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0342_stage0_step1000.svg
[rank3]:2026-01-03 03:42:16,494 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0342_step1000_rank3.svg
[rank3]:			> Batch Time: 455.00 ms, GPU Bubble Ratio: 26.46%, 27.67%, 35.41%, 27.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-26-188ms   | [S0,MB4,F]  188-13-202ms   | [S0,MB1,B]  202-38-241ms   | [S0,MB5,F]  241-14-256ms   | [S0,MB2,B]  256-26-282ms   | [S0,MB6,F]  282-14-296ms   | [S0,MB3,B]  297-26-323ms   | [S0,MB7,F]  323-14-337ms   | [S0,MB4,B]  338-44-382ms   | [S0,MB5,B]  399-29-429ms   | [S0,MB6,B]  429-25-454ms   | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB0,B]  141-20-162ms   | [S1,MB3,F]  162-15-177ms   | [S1,MB1,B]  179-20-200ms   | [S1,MB4,F]  202-15-218ms   | [S1,MB2,B]  218-29-247ms   | [S1,MB5,F]  255-15-271ms   | [S1,MB3,B]  271-20-292ms   | [S1,MB6,F]  296-15-312ms   | [S1,MB4,B]  312-20-333ms   | [S1,MB7,F]  337-15-353ms   | [S1,MB5,B]  353-45-399ms   | [S1,MB6,B]  400-21-421ms   | [S1,MB7,B]  425-20-445ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-18-140ms   | [S2,MB2,F]  141-13-154ms   | [S2,MB1,B]  159-18-178ms   | [S2,MB3,F]  179-13-192ms   | [S2,MB2,B]  197-19-216ms   | [S2,MB4,F]  218-13-231ms   | [S2,MB3,B]  235-33-268ms   | [S2,MB5,F]  271-13-285ms   | [S2,MB4,B]  289-19-309ms   | [S2,MB6,F]  312-13-326ms   | [S2,MB5,B]  327-19-346ms   | [S2,MB7,F]  353-13-367ms   | [S2,MB6,B]  367-32-399ms   | [S2,MB7,B]  405-18-424ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-122ms    | [S3,MB1,F]  122-14-137ms   | [S3,MB1,B]  138-20-159ms   | [S3,MB2,F]  159-14-174ms   | [S3,MB2,B]  176-20-197ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  214-20-235ms   | [S3,MB4,F]  235-15-250ms   | [S3,MB4,B]  252-37-289ms   | [S3,MB5,F]  289-15-304ms   | [S3,MB5,B]  306-20-327ms   | [S3,MB6,F]  327-14-342ms   | [S3,MB6,B]  344-20-364ms   | [S3,MB7,F]  367-14-382ms   | [S3,MB7,B]  384-20-404ms  
[rank2]:2026-01-03 03:42:16,411 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0342_stage2_step1000.svg
[rank3]:2026-01-03 03:42:16,534 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0342_stage3_step1000.svg
[rank2]:2026-01-03 03:42:16,661 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0342_rank2_stage2.svg
[rank2]:	> Counts Sum: 1382800, Total Sum: 1889280 (73.19%), Ratio(%) per element: [80.64, 71.64, 71.95, 77.43, 67.22, 87.65, 82.31, 58.23, 58.38, 81.7, 70.57, 78.81, 69.2, 84.45, 82.92, 88.26, 56.4, 57.46, 83.38, 77.74, 71.79, 77.43, 71.95, 87.19, 85.51, 55.64, 55.79, 76.98, 76.82, 56.7, 82.92, 73.78, 87.04, 86.12, 57.31, 56.7, 85.51, 65.7, 63.71, 72.25, 85.06, 87.19, 83.07, 56.7, 55.48, 82.62, 66.92, 57.77, 57.62, 85.97, 81.85, 82.46, 58.07, 56.25, 81.7, 82.01, 68.29, 83.53, 86.43, 83.38, 81.25, 56.09, 57.92, 85.06, 79.57, 56.7, 68.75, 85.06, 83.68, 84.9, 55.94, 58.99]
[rank1]:2026-01-03 03:42:16,696 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0342_rank1_stage1.svg
[rank1]:	> Counts Sum: 1650240, Total Sum: 2125440 (77.64%), Ratio(%) per element: [84.14, 78.81, 68.59, 80.03, 73.47, 85.21, 83.38, 69.51, 68.44, 82.62, 76.98, 70.27, 80.94, 85.36, 85.21, 85.51, 68.14, 69.35, 77.89, 81.7, 67.68, 72.4, 85.51, 83.99, 84.14, 69.51, 68.14, 84.45, 75.45, 74.23, 78.81, 85.06, 84.29, 82.31, 67.22, 68.29, 82.92, 78.81, 75.15, 79.26, 76.82, 84.9, 82.31, 68.59, 69.05, 78.5, 79.42, 72.86, 77.13, 79.57, 82.92, 85.36, 70.42, 68.75, 83.38, 79.72, 77.59, 80.33, 85.06, 77.74, 80.48, 68.9, 70.27, 83.53, 74.54, 76.21, 80.64, 80.64, 81.55, 84.6, 68.44, 69.66, 82.01, 74.08, 81.85, 78.96, 85.06, 82.62, 82.92, 68.9, 69.2]
[rank0]:2026-01-03 03:42:16,761 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0342_rank0_stage0.svg
[rank0]:	> Counts Sum: 859440, Total Sum: 1915520 (44.87%), Ratio(%) per element: [50.0, 60.67, 42.68, 51.98, 50.0, 39.63, 59.29, 66.15, 14.78, 16.15, 61.43, 19.81, 38.41, 59.14, 64.32, 63.56, 61.43, 15.85, 14.48, 33.84, 60.06, 56.25, 32.16, 62.34, 63.26, 36.12, 15.09, 15.7, 61.89, 55.79, 39.93, 61.12, 62.04, 64.93, 61.43, 14.32, 15.09, 64.93, 47.71, 15.09, 55.79, 63.41, 64.63, 63.71, 15.24, 15.54, 61.73, 44.96, 63.56, 54.72, 61.58, 66.15, 61.89, 15.7, 15.24, 55.33, 58.07, 53.04, 18.75, 63.56, 64.48, 64.63, 14.93, 15.54, 64.63, 32.46, 19.96, 15.09, 62.65, 64.48, 63.87, 14.78, 16.0]
[rank3]:2026-01-03 03:42:16,788 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0342_rank3_stage3.svg
[rank3]:	> Counts Sum: 1322240, Total Sum: 1705600 (77.52%), Ratio(%) per element: [76.98, 77.28, 70.27, 77.13, 81.85, 83.38, 83.38, 71.03, 70.42, 81.85, 80.18, 77.59, 77.74, 83.84, 82.46, 82.31, 70.27, 69.96, 75.6, 77.43, 78.65, 74.84, 83.23, 80.33, 80.18, 71.49, 71.95, 84.29, 75.76, 73.93, 76.67, 79.72, 81.25, 82.16, 72.56, 71.49, 83.23, 80.94, 73.62, 73.78, 82.92, 77.28, 83.07, 70.88, 70.73, 78.5, 77.74, 78.65, 79.57, 77.43, 83.53, 81.7, 70.73, 71.64, 81.25, 80.79, 81.25, 77.89, 80.03, 83.68, 84.75, 71.18, 70.88, 70.88, 70.73]
[rank2]:2026-01-03 03:42:17,632 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0342_stage2.svg
[rank1]:2026-01-03 03:42:17,753 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0342_stage1.svg
[rank0]:2026-01-03 03:42:17,715 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0342_stage0.svg
[rank3]:2026-01-03 03:42:17,773 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0342_stage3.svg
[rank0]:2026-01-03 03:43:52,431 - [GC] Peforming periodical GC collection 1.85 seconds
[rank3]:2026-01-03 03:43:54,339 - Avg. fwd time: 15.3855 / Avg. bwd time: 29.3234 / Avg. batch time: 378.0522 (ms) / GPU bubble ratio: 5.39%
[rank2]:2026-01-03 03:43:54,367 - Avg. fwd time: 14.2682 / Avg. bwd time: 25.6393 / Avg. batch time: 419.5249 (ms) / GPU bubble ratio: 23.90%
[rank1]:2026-01-03 03:43:54,397 - Avg. fwd time: 16.0250 / Avg. bwd time: 28.6339 / Avg. batch time: 465.5245 (ms) / GPU bubble ratio: 23.25%
[rank1]:2026-01-03 03:43:54,438 -  step: 1050  loss: -4.0000  grad_norm:  0.4931  memory: 58.51GiB(41.85%)  tps: 7,192  tflops: 335.45  mfu: 33.92%
[rank0]:2026-01-03 03:43:54,406 - Avg. fwd time: 14.6138 / Avg. bwd time: 29.4940 / Avg. batch time: 497.8094 (ms) / GPU bubble ratio: 29.12%
[rank0]:2026-01-03 03:43:54,442 -  step: 1050  loss: -4.0000  grad_norm:  0.4931  memory: 67.59GiB(48.34%)  tps: 7,192  tflops: 335.45  mfu: 33.92%
[rank3]:2026-01-03 03:43:54,440 -  step: 1050  loss:  0.2605  grad_norm:  0.4931  memory: 57.49GiB(41.12%)  tps: 7,192  tflops: 335.45  mfu: 33.92%
[rank2]:2026-01-03 03:43:54,429 -  step: 1050  loss: -4.0000  grad_norm:  0.4931  memory: 48.95GiB(35.01%)  tps: 7,193  tflops: 335.46  mfu: 33.92%
[rank0]:2026-01-03 03:45:29,192 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:45:31,130 - Avg. fwd time: 15.3996 / Avg. bwd time: 29.1681 / Avg. batch time: 376.8689 (ms) / GPU bubble ratio: 5.39%
[rank2]:2026-01-03 03:45:31,159 - Avg. fwd time: 14.2783 / Avg. bwd time: 25.4908 / Avg. batch time: 418.1646 (ms) / GPU bubble ratio: 23.92%
[rank1]:2026-01-03 03:45:31,189 - Avg. fwd time: 16.0363 / Avg. bwd time: 28.4755 / Avg. batch time: 463.9733 (ms) / GPU bubble ratio: 23.25%
[rank1]:2026-01-03 03:45:31,230 -  step: 1100  loss: -4.0000  grad_norm:  0.1621  memory: 58.51GiB(41.85%)  tps: 8,463  tflops: 394.74  mfu: 39.91%
[rank0]:2026-01-03 03:45:31,199 - Avg. fwd time: 14.6262 / Avg. bwd time: 29.3772 / Avg. batch time: 495.8521 (ms) / GPU bubble ratio: 29.01%
[rank0]:2026-01-03 03:45:31,235 -  step: 1100  loss: -4.0000  grad_norm:  0.1621  memory: 67.59GiB(48.34%)  tps: 8,463  tflops: 394.74  mfu: 39.91%
[rank3]:2026-01-03 03:45:31,233 -  step: 1100  loss:  0.2240  grad_norm:  0.1621  memory: 57.49GiB(41.12%)  tps: 8,464  tflops: 394.74  mfu: 39.91%
[rank2]:2026-01-03 03:45:31,226 -  step: 1100  loss: -4.0000  grad_norm:  0.1621  memory: 48.95GiB(35.01%)  tps: 8,463  tflops: 394.72  mfu: 39.91%
[rank2]:2026-01-03 03:45:31,283 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0345_stage2_step1100.svg
[rank1]:2026-01-03 03:45:31,281 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0345_stage1_step1100.svg
[rank0]:2026-01-03 03:45:31,285 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0345_stage0_step1100.svg
[rank3]:2026-01-03 03:45:31,361 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0345_step1100_rank3.svg
[rank3]:			> Batch Time: 459.75 ms, GPU Bubble Ratio: 26.27%, 27.57%, 35.47%, 27.07%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB0,B]  163-25-189ms   | [S0,MB4,F]  190-14-204ms   | [S0,MB1,B]  204-39-243ms   | [S0,MB5,F]  242-14-257ms   | [S0,MB2,B]  257-27-285ms   | [S0,MB6,F]  284-14-298ms   | [S0,MB3,B]  299-28-327ms   | [S0,MB7,F]  328-14-343ms   | [S0,MB4,B]  343-44-387ms   | [S0,MB5,B]  405-28-433ms   | [S0,MB6,B]  433-25-458ms   | [S0,MB7,B]  459-0-459ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  204-15-219ms   | [S1,MB2,B]  220-29-250ms   | [S1,MB5,F]  257-15-273ms   | [S1,MB3,B]  273-21-294ms   | [S1,MB6,F]  299-15-314ms   | [S1,MB4,B]  315-21-336ms   | [S1,MB7,F]  343-15-359ms   | [S1,MB5,B]  358-46-404ms   | [S1,MB6,B]  405-21-426ms   | [S1,MB7,B]  431-21-452ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-142ms   | [S2,MB2,F]  142-13-156ms   | [S2,MB1,B]  161-18-180ms   | [S2,MB3,F]  180-14-194ms   | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  220-14-234ms   | [S2,MB3,B]  237-34-272ms   | [S2,MB5,F]  273-14-287ms   | [S2,MB4,B]  292-19-311ms   | [S2,MB6,F]  315-14-329ms   | [S2,MB5,B]  331-19-350ms   | [S2,MB7,F]  359-14-373ms   | [S2,MB6,B]  373-31-404ms   | [S2,MB7,B]  411-18-430ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-123ms    | [S3,MB1,F]  123-15-138ms   | [S3,MB1,B]  140-20-161ms   | [S3,MB2,F]  161-15-176ms   | [S3,MB2,B]  178-21-199ms   | [S3,MB3,F]  199-15-214ms   | [S3,MB3,B]  216-21-237ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  254-37-292ms   | [S3,MB5,F]  292-15-307ms   | [S3,MB5,B]  309-20-330ms   | [S3,MB6,F]  330-15-346ms   | [S3,MB6,B]  348-21-369ms   | [S3,MB7,F]  373-15-388ms   | [S3,MB7,B]  390-20-411ms  
[rank3]:2026-01-03 03:45:31,401 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0345_stage3_step1100.svg
[rank2]:2026-01-03 03:45:31,459 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0345_rank2_stage2.svg
[rank2]:	> Counts Sum: 1556400, Total Sum: 2119680 (73.43%), Ratio(%) per element: [80.97, 73.36, 73.09, 77.85, 69.29, 87.9, 83.15, 58.01, 57.88, 81.92, 72.28, 79.21, 71.05, 84.37, 83.15, 87.77, 56.52, 57.2, 83.55, 76.08, 73.5, 78.12, 73.23, 86.54, 85.46, 55.57, 55.7, 77.44, 78.12, 58.01, 83.01, 75.4, 86.95, 85.73, 56.92, 56.38, 85.19, 67.52, 63.72, 73.77, 85.46, 86.82, 83.28, 57.06, 55.43, 82.2, 68.75, 58.69, 57.74, 86.0, 82.06, 83.15, 57.47, 55.97, 81.65, 82.33, 66.44, 80.84, 86.41, 83.28, 81.52, 55.57, 57.47, 84.78, 79.48, 56.11, 70.38, 85.46, 84.64, 84.64, 55.57, 58.83]
[rank1]:2026-01-03 03:45:31,458 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0345_rank1_stage1.svg
[rank1]:	> Counts Sum: 1857840, Total Sum: 2384640 (77.91%), Ratio(%) per element: [84.23, 79.61, 69.15, 80.57, 74.59, 84.91, 83.28, 69.7, 68.88, 82.88, 77.58, 70.24, 81.25, 85.19, 85.05, 85.59, 68.61, 69.56, 78.39, 80.7, 67.93, 73.64, 85.46, 83.96, 84.1, 69.97, 68.61, 84.37, 75.54, 75.67, 79.21, 85.32, 84.23, 81.92, 67.79, 68.47, 83.42, 78.8, 76.22, 79.75, 77.3, 84.78, 82.47, 68.75, 69.15, 79.21, 80.02, 72.96, 77.71, 80.02, 83.01, 85.32, 70.38, 68.88, 83.42, 80.29, 78.26, 79.75, 84.91, 78.12, 80.7, 69.02, 70.51, 83.83, 75.54, 77.17, 80.84, 81.11, 81.65, 84.37, 68.47, 69.83, 82.2, 74.86, 82.06, 79.61, 84.78, 82.47, 83.28, 69.29, 69.56]
[rank0]:2026-01-03 03:45:31,475 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0345_rank0_stage0.svg
[rank0]:	> Counts Sum: 965040, Total Sum: 2149120 (44.90%), Ratio(%) per element: [50.67, 60.73, 43.07, 52.85, 50.95, 42.66, 59.23, 65.48, 14.53, 15.76, 61.95, 19.15, 35.59, 59.37, 63.72, 63.17, 61.41, 15.76, 14.26, 36.95, 59.78, 56.38, 31.65, 61.82, 63.04, 39.13, 14.8, 15.48, 62.09, 56.25, 41.3, 60.59, 61.95, 64.4, 60.86, 14.13, 14.94, 64.4, 49.18, 14.8, 55.57, 62.63, 63.31, 63.85, 15.21, 15.35, 61.54, 45.51, 63.58, 55.7, 61.82, 66.03, 61.41, 15.48, 14.94, 55.84, 58.01, 54.21, 18.2, 63.85, 63.58, 63.72, 14.67, 15.48, 64.26, 35.32, 19.15, 14.94, 62.5, 63.31, 63.99, 14.53, 15.89]
[rank3]:2026-01-03 03:45:31,566 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0345_rank3_stage3.svg
[rank3]:	> Counts Sum: 1488640, Total Sum: 1913600 (77.79%), Ratio(%) per element: [76.76, 77.71, 71.73, 77.44, 82.2, 83.28, 83.15, 71.46, 70.92, 81.92, 79.61, 77.85, 77.44, 83.42, 82.47, 82.47, 70.78, 70.51, 76.35, 77.98, 79.21, 74.86, 83.28, 80.29, 80.29, 71.87, 72.28, 84.1, 76.35, 74.72, 77.44, 80.29, 80.84, 82.06, 72.82, 71.87, 83.15, 81.11, 73.77, 73.91, 82.74, 77.98, 82.88, 71.33, 71.19, 79.21, 78.8, 79.07, 79.89, 77.98, 83.69, 81.65, 71.33, 72.01, 81.38, 81.11, 81.92, 78.53, 80.16, 83.42, 84.51, 71.6, 71.33, 71.33, 71.19]
[rank1]:2026-01-03 03:45:32,505 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0345_stage1.svg
[rank2]:2026-01-03 03:45:32,506 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0345_stage2.svg
[rank0]:2026-01-03 03:45:32,642 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0345_stage0.svg
[rank3]:2026-01-03 03:45:32,619 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0345_stage3.svg
[rank0]:2026-01-03 03:47:06,656 - [GC] Peforming periodical GC collection 0.01 seconds
[rank1]:2026-01-03 03:47:08,626 - Avg. fwd time: 16.0375 / Avg. bwd time: 28.3190 / Avg. batch time: 462.4855 (ms) / GPU bubble ratio: 23.27%
[rank0]:2026-01-03 03:47:08,635 - Avg. fwd time: 14.6298 / Avg. bwd time: 29.2798 / Avg. batch time: 494.0294 (ms) / GPU bubble ratio: 28.90%
[rank3]:2026-01-03 03:47:08,566 - Avg. fwd time: 15.4008 / Avg. bwd time: 29.0105 / Avg. batch time: 375.7420 (ms) / GPU bubble ratio: 5.44%
[rank2]:2026-01-03 03:47:08,595 - Avg. fwd time: 14.2797 / Avg. bwd time: 25.3502 / Avg. batch time: 416.8650 (ms) / GPU bubble ratio: 23.95%
[rank2]:2026-01-03 03:47:08,662 -  step: 1150  loss: -4.0000  grad_norm:  0.2490  memory: 48.95GiB(35.01%)  tps: 8,408  tflops: 392.13  mfu: 39.65%
[rank1]:2026-01-03 03:47:08,667 -  step: 1150  loss: -4.0000  grad_norm:  0.2490  memory: 58.51GiB(41.85%)  tps: 8,408  tflops: 392.13  mfu: 39.65%
[rank0]:2026-01-03 03:47:08,671 -  step: 1150  loss: -4.0000  grad_norm:  0.2490  memory: 67.59GiB(48.34%)  tps: 8,408  tflops: 392.13  mfu: 39.65%
[rank3]:2026-01-03 03:47:08,669 -  step: 1150  loss:  0.2107  grad_norm:  0.2490  memory: 57.49GiB(41.12%)  tps: 8,408  tflops: 392.13  mfu: 39.65%
[rank0]:2026-01-03 03:48:42,343 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:48:44,268 - Avg. fwd time: 15.4015 / Avg. bwd time: 28.8639 / Avg. batch time: 374.6234 (ms) / GPU bubble ratio: 5.47%
[rank2]:2026-01-03 03:48:44,295 - Avg. fwd time: 14.2806 / Avg. bwd time: 25.2212 / Avg. batch time: 415.5890 (ms) / GPU bubble ratio: 23.96%
[rank1]:2026-01-03 03:48:44,324 - Avg. fwd time: 16.0389 / Avg. bwd time: 28.1831 / Avg. batch time: 461.0380 (ms) / GPU bubble ratio: 23.27%
[rank1]:2026-01-03 03:48:44,364 -  step: 1200  loss: -4.0000  grad_norm:  0.2516  memory: 58.51GiB(41.85%)  tps: 8,560  tflops: 399.26  mfu: 40.37%
[rank0]:2026-01-03 03:48:44,333 - Avg. fwd time: 14.6328 / Avg. bwd time: 29.1884 / Avg. batch time: 492.3335 (ms) / GPU bubble ratio: 28.79%
[rank0]:2026-01-03 03:48:44,369 -  step: 1200  loss: -4.0000  grad_norm:  0.2516  memory: 69.58GiB(49.77%)  tps: 8,560  tflops: 399.25  mfu: 40.37%
[rank0]:2026-01-03 03:48:44,415 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0348_stage0_step1200.svg
[rank3]:2026-01-03 03:48:44,366 -  step: 1200  loss:  0.2709  grad_norm:  0.2516  memory: 57.49GiB(41.12%)  tps: 8,560  tflops: 399.26  mfu: 40.37%
[rank2]:2026-01-03 03:48:44,360 -  step: 1200  loss: -4.0000  grad_norm:  0.2516  memory: 48.95GiB(35.01%)  tps: 8,560  tflops: 399.25  mfu: 40.37%
[rank2]:2026-01-03 03:48:44,414 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0348_stage2_step1200.svg
[rank1]:2026-01-03 03:48:44,417 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0348_stage1_step1200.svg
[rank3]:2026-01-03 03:48:44,493 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0348_step1200_rank3.svg
[rank3]:			> Batch Time: 457.00 ms, GPU Bubble Ratio: 26.38%, 27.44%, 35.81%, 27.89%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-25-187ms   | [S0,MB4,F]  188-13-201ms   | [S0,MB1,B]  201-37-238ms   | [S0,MB5,F]  239-14-253ms   | [S0,MB2,B]  253-27-281ms   | [S0,MB6,F]  281-14-295ms   | [S0,MB3,B]  296-28-324ms   | [S0,MB7,F]  324-14-338ms   | [S0,MB4,B]  338-44-382ms   | [S0,MB5,B]  400-28-429ms   | [S0,MB6,B]  429-27-456ms   | [S0,MB7,B]  457-0-457ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB0,B]  141-20-162ms   | [S1,MB3,F]  162-15-177ms   | [S1,MB1,B]  179-20-200ms   | [S1,MB4,F]  201-15-217ms   | [S1,MB2,B]  217-31-249ms   | [S1,MB5,F]  253-15-269ms   | [S1,MB3,B]  270-20-291ms   | [S1,MB6,F]  295-15-311ms   | [S1,MB4,B]  311-20-332ms   | [S1,MB7,F]  338-15-353ms   | [S1,MB5,B]  354-45-399ms   | [S1,MB6,B]  400-21-421ms   | [S1,MB7,B]  425-20-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB0,B]  122-18-141ms   | [S2,MB2,F]  141-13-154ms   | [S2,MB1,B]  160-19-179ms   | [S2,MB3,F]  179-13-192ms   | [S2,MB2,B]  197-19-216ms   | [S2,MB4,F]  217-13-231ms   | [S2,MB3,B]  235-34-270ms   | [S2,MB5,F]  270-14-284ms   | [S2,MB4,B]  288-19-307ms   | [S2,MB6,F]  311-13-325ms   | [S2,MB5,B]  326-19-345ms   | [S2,MB7,F]  354-13-368ms   | [S2,MB6,B]  368-30-398ms   | [S2,MB7,B]  406-18-425ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB0,B]  76-45-122ms    | [S3,MB1,F]  122-14-137ms   | [S3,MB1,B]  139-20-159ms   | [S3,MB2,F]  159-14-174ms   | [S3,MB2,B]  176-20-197ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  214-20-235ms   | [S3,MB4,F]  235-15-250ms   | [S3,MB4,B]  252-35-288ms   | [S3,MB5,F]  288-15-303ms   | [S3,MB5,B]  305-20-326ms   | [S3,MB6,F]  326-14-341ms   | [S3,MB6,B]  343-20-364ms   | [S3,MB7,F]  368-15-383ms   | [S3,MB7,B]  385-20-405ms  
[rank3]:2026-01-03 03:48:44,535 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0348_stage3_step1200.svg
[rank1]:2026-01-03 03:48:44,597 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0348_rank1_stage1.svg
[rank1]:	> Counts Sum: 2065440, Total Sum: 2643840 (78.12%), Ratio(%) per element: [84.06, 80.14, 69.48, 80.75, 75.73, 84.8, 83.08, 69.73, 68.5, 82.72, 78.18, 70.46, 81.49, 85.17, 84.92, 85.66, 68.99, 69.85, 79.04, 79.9, 69.11, 73.89, 85.41, 83.82, 84.06, 69.97, 68.99, 84.06, 76.59, 76.59, 79.65, 84.8, 84.19, 82.23, 68.13, 68.62, 83.45, 79.28, 75.85, 80.26, 77.69, 84.8, 82.35, 69.24, 69.36, 79.65, 80.51, 72.79, 78.3, 80.02, 82.96, 84.92, 71.07, 69.11, 83.45, 80.63, 78.67, 79.77, 85.04, 78.92, 81.0, 69.36, 70.71, 83.82, 76.34, 77.94, 81.25, 81.25, 81.86, 84.19, 68.75, 70.22, 82.35, 75.98, 82.35, 80.14, 84.92, 82.47, 82.96, 69.11, 69.73]
[rank0]:2026-01-03 03:48:44,589 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0348_rank0_stage0.svg
[rank0]:	> Counts Sum: 1070640, Total Sum: 2382720 (44.93%), Ratio(%) per element: [51.22, 60.53, 44.36, 53.3, 52.2, 44.36, 58.94, 64.46, 14.33, 15.44, 61.02, 18.5, 33.33, 59.19, 63.11, 63.84, 60.78, 15.44, 14.09, 38.72, 60.41, 56.74, 34.68, 61.88, 62.86, 42.03, 14.7, 15.31, 61.88, 56.25, 43.25, 59.43, 61.76, 62.25, 60.9, 14.09, 14.95, 63.23, 50.24, 19.24, 55.63, 62.13, 62.86, 64.09, 15.19, 15.19, 61.27, 46.93, 62.13, 55.63, 62.25, 64.95, 60.17, 15.19, 14.7, 56.25, 57.72, 54.41, 17.64, 63.23, 63.35, 63.72, 14.46, 15.19, 63.84, 37.86, 18.62, 14.82, 61.27, 62.62, 63.23, 14.33, 15.68]
[rank2]:2026-01-03 03:48:44,583 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0348_rank2_stage2.svg
[rank2]:	> Counts Sum: 1730000, Total Sum: 2350080 (73.61%), Ratio(%) per element: [81.74, 74.5, 74.01, 78.55, 71.07, 87.37, 83.33, 57.23, 56.49, 82.72, 73.52, 79.77, 72.42, 84.92, 83.21, 87.62, 55.88, 57.1, 83.08, 76.71, 74.63, 78.43, 74.38, 86.02, 85.41, 55.63, 55.88, 78.06, 78.3, 60.78, 82.72, 76.22, 86.02, 85.41, 56.74, 55.88, 84.92, 69.36, 62.86, 74.87, 85.53, 86.51, 83.57, 56.74, 54.9, 82.47, 70.09, 61.51, 60.9, 85.78, 82.47, 83.21, 57.72, 55.39, 82.23, 82.35, 65.44, 77.69, 86.02, 83.45, 81.61, 53.92, 56.61, 84.8, 80.26, 55.39, 71.44, 85.53, 84.43, 84.55, 55.02, 58.57]
[rank3]:2026-01-03 03:48:44,695 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0348_rank3_stage3.svg
[rank3]:	> Counts Sum: 1655040, Total Sum: 2121600 (78.01%), Ratio(%) per element: [76.71, 78.55, 72.42, 77.81, 82.23, 83.08, 82.84, 71.81, 71.44, 81.98, 79.16, 78.18, 77.2, 83.33, 82.59, 82.35, 71.2, 70.95, 76.83, 78.79, 79.28, 75.36, 83.21, 80.26, 80.51, 72.18, 72.54, 84.19, 76.83, 75.73, 77.81, 80.51, 81.0, 81.61, 73.03, 72.18, 82.96, 81.25, 73.89, 74.01, 83.08, 78.43, 82.84, 71.69, 71.56, 79.65, 79.53, 79.28, 80.14, 78.79, 83.57, 81.86, 71.69, 72.3, 81.37, 81.12, 81.86, 78.55, 80.51, 83.33, 84.43, 71.93, 71.69, 71.69, 71.56]
[rank0]:2026-01-03 03:48:45,705 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0348_stage0.svg
[rank2]:2026-01-03 03:48:45,706 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0348_stage2.svg
[rank1]:2026-01-03 03:48:45,873 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0348_stage1.svg
[rank3]:2026-01-03 03:48:45,856 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0348_stage3.svg
[rank0]:2026-01-03 03:50:18,985 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 03:50:20,876 - Avg. fwd time: 15.4000 / Avg. bwd time: 28.7275 / Avg. batch time: 373.5869 (ms) / GPU bubble ratio: 5.51%
[rank2]:2026-01-03 03:50:20,905 - Avg. fwd time: 14.2800 / Avg. bwd time: 25.0954 / Avg. batch time: 414.4028 (ms) / GPU bubble ratio: 23.99%
[rank1]:2026-01-03 03:50:20,936 - Avg. fwd time: 16.0385 / Avg. bwd time: 28.0568 / Avg. batch time: 459.6909 (ms) / GPU bubble ratio: 23.26%
[rank1]:2026-01-03 03:50:20,976 -  step: 1250  loss: -4.0000  grad_norm:  0.2779  memory: 58.51GiB(41.85%)  tps: 8,479  tflops: 395.48  mfu: 39.99%
[rank0]:2026-01-03 03:50:20,944 - Avg. fwd time: 14.6340 / Avg. bwd time: 29.0990 / Avg. batch time: 490.7361 (ms) / GPU bubble ratio: 28.71%
[rank0]:2026-01-03 03:50:20,980 -  step: 1250  loss: -4.0000  grad_norm:  0.2779  memory: 69.58GiB(49.77%)  tps: 8,479  tflops: 395.48  mfu: 39.99%
[rank3]:2026-01-03 03:50:20,978 -  step: 1250  loss:  0.2530  grad_norm:  0.2779  memory: 57.49GiB(41.12%)  tps: 8,479  tflops: 395.48  mfu: 39.99%
[rank2]:2026-01-03 03:50:20,971 -  step: 1250  loss: -4.0000  grad_norm:  0.2779  memory: 48.95GiB(35.01%)  tps: 8,479  tflops: 395.48  mfu: 39.99%
[rank0]:2026-01-03 03:51:54,554 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:51:56,449 - Avg. fwd time: 15.3997 / Avg. bwd time: 28.6039 / Avg. batch time: 372.6312 (ms) / GPU bubble ratio: 5.53%
[rank2]:2026-01-03 03:51:56,478 - Avg. fwd time: 14.2796 / Avg. bwd time: 24.9807 / Avg. batch time: 413.3092 (ms) / GPU bubble ratio: 24.01%
[rank1]:2026-01-03 03:51:56,508 - Avg. fwd time: 16.0384 / Avg. bwd time: 27.9356 / Avg. batch time: 458.4497 (ms) / GPU bubble ratio: 23.26%
[rank1]:2026-01-03 03:51:56,547 -  step: 1300  loss: -4.0000  grad_norm:  0.2293  memory: 58.51GiB(41.85%)  tps: 8,572  tflops: 399.78  mfu: 40.42%
[rank0]:2026-01-03 03:51:56,516 - Avg. fwd time: 14.6353 / Avg. bwd time: 29.0242 / Avg. batch time: 489.2988 (ms) / GPU bubble ratio: 28.62%
[rank0]:2026-01-03 03:51:56,552 -  step: 1300  loss: -4.0000  grad_norm:  0.2293  memory: 69.58GiB(49.77%)  tps: 8,572  tflops: 399.78  mfu: 40.42%
[rank3]:2026-01-03 03:51:56,550 -  step: 1300  loss:  0.1854  grad_norm:  0.2293  memory: 57.49GiB(41.12%)  tps: 8,572  tflops: 399.79  mfu: 40.42%
[rank2]:2026-01-03 03:51:56,541 -  step: 1300  loss: -4.0000  grad_norm:  0.2293  memory: 48.95GiB(35.01%)  tps: 8,572  tflops: 399.79  mfu: 40.42%
[rank2]:2026-01-03 03:51:56,596 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0351_stage2_step1300.svg
[rank1]:2026-01-03 03:51:56,599 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0351_stage1_step1300.svg
[rank0]:2026-01-03 03:51:56,599 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0351_stage0_step1300.svg
[rank3]:2026-01-03 03:51:56,677 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0351_step1300_rank3.svg
[rank3]:			> Batch Time: 455.75 ms, GPU Bubble Ratio: 26.26%, 27.76%, 36.42%, 28.36%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  162-27-189ms   | [S0,MB4,F]  189-13-203ms   | [S0,MB1,B]  203-36-240ms   | [S0,MB5,F]  240-14-254ms   | [S0,MB2,B]  254-27-281ms   | [S0,MB6,F]  281-14-295ms   | [S0,MB3,B]  296-29-325ms   | [S0,MB7,F]  325-14-339ms   | [S0,MB4,B]  340-43-383ms   | [S0,MB5,B]  401-26-427ms   | [S0,MB6,B]  428-27-455ms   | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  140-20-161ms   | [S1,MB3,F]  161-15-177ms   | [S1,MB1,B]  178-20-198ms   | [S1,MB4,F]  203-15-218ms   | [S1,MB2,B]  218-30-249ms   | [S1,MB5,F]  254-15-269ms   | [S1,MB3,B]  269-20-290ms   | [S1,MB6,F]  295-15-311ms   | [S1,MB4,B]  311-20-332ms   | [S1,MB7,F]  339-15-355ms   | [S1,MB5,B]  355-45-400ms   | [S1,MB6,B]  401-21-422ms   | [S1,MB7,B]  425-20-446ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  121-18-140ms   | [S2,MB2,F]  140-13-154ms   | [S2,MB1,B]  159-18-178ms   | [S2,MB3,F]  178-13-191ms   | [S2,MB2,B]  196-18-215ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  234-33-267ms   | [S2,MB5,F]  269-13-283ms   | [S2,MB4,B]  286-19-305ms   | [S2,MB6,F]  311-13-325ms   | [S2,MB5,B]  325-18-344ms   | [S2,MB7,F]  355-13-368ms   | [S2,MB6,B]  368-29-398ms   | [S2,MB7,B]  406-18-425ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  121-14-136ms   | [S3,MB1,B]  138-20-158ms   | [S3,MB2,F]  158-14-173ms   | [S3,MB2,B]  175-20-196ms   | [S3,MB3,F]  196-14-211ms   | [S3,MB3,B]  213-20-233ms   | [S3,MB4,F]  233-14-248ms   | [S3,MB4,B]  250-35-286ms   | [S3,MB5,F]  286-14-301ms   | [S3,MB5,B]  303-20-324ms   | [S3,MB6,F]  325-14-340ms   | [S3,MB6,B]  342-20-362ms   | [S3,MB7,F]  368-14-383ms   | [S3,MB7,B]  385-20-405ms  
[rank3]:2026-01-03 03:51:56,718 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0351_stage3_step1300.svg
[rank1]:2026-01-03 03:51:56,775 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0351_rank1_stage1.svg
[rank1]:	> Counts Sum: 2273040, Total Sum: 2903040 (78.30%), Ratio(%) per element: [84.26, 80.46, 69.86, 80.91, 76.33, 84.48, 83.03, 69.64, 68.52, 82.7, 78.34, 70.31, 81.69, 85.26, 84.82, 85.6, 69.19, 69.86, 79.35, 79.35, 70.42, 74.88, 85.15, 84.04, 83.81, 70.42, 69.3, 83.81, 77.34, 77.12, 80.02, 84.48, 84.15, 82.36, 68.08, 68.75, 83.25, 79.57, 75.22, 80.58, 78.34, 84.59, 82.03, 69.3, 69.75, 79.79, 80.69, 73.99, 78.9, 80.13, 83.03, 84.93, 71.2, 69.41, 83.59, 81.02, 79.24, 80.02, 84.7, 79.35, 81.36, 69.75, 70.87, 83.37, 77.0, 78.79, 81.8, 81.36, 82.03, 84.15, 68.97, 70.2, 82.47, 76.78, 82.47, 80.58, 84.93, 82.47, 82.81, 69.08, 69.86]
[rank0]:2026-01-03 03:51:56,768 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0351_rank0_stage0.svg
[rank0]:	> Counts Sum: 1176240, Total Sum: 2616320 (44.96%), Ratio(%) per element: [51.45, 60.26, 45.75, 53.68, 53.01, 45.64, 59.37, 64.28, 14.17, 15.17, 60.71, 18.19, 31.47, 58.92, 62.94, 63.61, 60.82, 15.29, 13.95, 39.62, 59.26, 56.91, 36.83, 61.94, 62.38, 42.96, 14.84, 15.06, 60.93, 56.36, 44.19, 59.59, 61.16, 61.83, 60.71, 14.06, 14.95, 63.16, 50.66, 23.1, 56.02, 61.94, 62.72, 63.83, 14.95, 14.95, 60.71, 48.21, 62.05, 55.69, 62.05, 64.17, 60.37, 14.95, 14.62, 55.8, 58.14, 53.9, 17.18, 62.5, 62.61, 63.83, 14.39, 14.95, 63.83, 39.62, 18.3, 14.73, 61.16, 61.71, 62.94, 14.17, 15.4]
[rank2]:2026-01-03 03:51:56,764 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0351_rank2_stage2.svg
[rank2]:	> Counts Sum: 1903600, Total Sum: 2580480 (73.77%), Ratio(%) per element: [81.69, 75.55, 74.77, 78.9, 72.2, 87.27, 83.7, 56.91, 56.13, 83.25, 74.1, 80.35, 73.32, 84.82, 83.59, 87.27, 55.58, 56.13, 83.25, 77.45, 75.44, 79.12, 75.22, 85.93, 85.49, 55.46, 55.8, 78.23, 75.78, 63.39, 83.14, 77.34, 85.49, 86.16, 56.02, 55.35, 84.7, 70.64, 62.27, 75.55, 85.49, 86.16, 84.04, 56.13, 54.91, 82.7, 71.42, 63.61, 63.05, 85.71, 82.92, 83.37, 57.47, 55.8, 82.92, 82.58, 64.5, 75.44, 85.6, 83.59, 81.47, 53.68, 55.69, 84.7, 80.46, 55.35, 72.43, 85.49, 84.59, 84.37, 55.13, 57.47]
[rank3]:2026-01-03 03:51:56,880 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0351_rank3_stage3.svg
[rank3]:	> Counts Sum: 1821440, Total Sum: 2329600 (78.19%), Ratio(%) per element: [76.89, 78.9, 72.99, 78.23, 82.14, 83.03, 82.81, 72.09, 71.76, 82.36, 78.79, 78.57, 77.0, 83.25, 82.25, 82.36, 71.54, 71.31, 77.45, 79.12, 79.24, 75.89, 83.14, 80.35, 80.58, 72.43, 72.76, 84.26, 77.34, 76.11, 78.57, 80.58, 81.25, 81.58, 73.21, 72.43, 82.81, 81.47, 73.99, 74.1, 82.92, 78.79, 82.81, 71.98, 71.87, 79.91, 79.46, 79.35, 80.46, 79.24, 83.59, 81.91, 71.98, 72.54, 81.47, 81.25, 81.91, 79.12, 80.8, 83.03, 84.48, 72.2, 71.98, 71.98, 71.87]
[rank2]:2026-01-03 03:51:57,993 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0351_stage2.svg
[rank1]:2026-01-03 03:51:58,062 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0351_stage1.svg
[rank0]:2026-01-03 03:51:57,997 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0351_stage0.svg
[rank3]:2026-01-03 03:51:58,197 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0351_stage3.svg
[rank0]:2026-01-03 03:53:32,907 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-03 03:53:34,845 - Avg. fwd time: 14.2838 / Avg. bwd time: 24.8766 / Avg. batch time: 412.5039 (ms) / GPU bubble ratio: 24.05%
[rank3]:2026-01-03 03:53:34,816 - Avg. fwd time: 15.4052 / Avg. bwd time: 28.4993 / Avg. batch time: 371.9274 (ms) / GPU bubble ratio: 5.56%
[rank1]:2026-01-03 03:53:34,875 - Avg. fwd time: 16.0429 / Avg. bwd time: 27.8259 / Avg. batch time: 457.5161 (ms) / GPU bubble ratio: 23.29%
[rank1]:2026-01-03 03:53:34,916 -  step: 1350  loss: -4.0000  grad_norm:  0.2011  memory: 58.51GiB(41.85%)  tps: 8,328  tflops: 388.41  mfu: 39.27%
[rank0]:2026-01-03 03:53:34,885 - Avg. fwd time: 14.6417 / Avg. bwd time: 28.9671 / Avg. batch time: 488.1468 (ms) / GPU bubble ratio: 28.53%
[rank0]:2026-01-03 03:53:34,921 -  step: 1350  loss: -4.0000  grad_norm:  0.2011  memory: 69.58GiB(49.77%)  tps: 8,328  tflops: 388.41  mfu: 39.27%
[rank2]:2026-01-03 03:53:34,912 -  step: 1350  loss: -4.0000  grad_norm:  0.2011  memory: 48.95GiB(35.01%)  tps: 8,328  tflops: 388.40  mfu: 39.27%
[rank3]:2026-01-03 03:53:34,918 -  step: 1350  loss:  0.1274  grad_norm:  0.2011  memory: 57.49GiB(41.12%)  tps: 8,328  tflops: 388.42  mfu: 39.27%
[rank0]:2026-01-03 03:55:08,708 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 03:55:10,655 - Avg. fwd time: 15.4038 / Avg. bwd time: 28.3906 / Avg. batch time: 371.1589 (ms) / GPU bubble ratio: 5.60%
[rank2]:2026-01-03 03:55:10,684 - Avg. fwd time: 14.2834 / Avg. bwd time: 24.7809 / Avg. batch time: 411.6169 (ms) / GPU bubble ratio: 24.08%
[rank1]:2026-01-03 03:55:10,714 - Avg. fwd time: 16.0423 / Avg. bwd time: 27.7237 / Avg. batch time: 456.5023 (ms) / GPU bubble ratio: 23.30%
[rank0]:2026-01-03 03:55:10,725 - Avg. fwd time: 14.6423 / Avg. bwd time: 28.9073 / Avg. batch time: 486.9453 (ms) / GPU bubble ratio: 28.45%
[rank3]:2026-01-03 03:55:10,759 -  step: 1400  loss:  0.3644  grad_norm:  0.3944  memory: 57.49GiB(41.12%)  tps: 8,548  tflops: 398.67  mfu: 40.31%
[rank2]:2026-01-03 03:55:10,751 -  step: 1400  loss: -4.0000  grad_norm:  0.3944  memory: 48.95GiB(35.01%)  tps: 8,548  tflops: 398.67  mfu: 40.31%
[rank1]:2026-01-03 03:55:10,756 -  step: 1400  loss: -4.0000  grad_norm:  0.3944  memory: 58.51GiB(41.85%)  tps: 8,548  tflops: 398.66  mfu: 40.31%
[rank1]:2026-01-03 03:55:10,807 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0355_stage1_step1400.svg
[rank0]:2026-01-03 03:55:10,760 -  step: 1400  loss: -4.0000  grad_norm:  0.3944  memory: 69.58GiB(49.77%)  tps: 8,548  tflops: 398.66  mfu: 40.31%
[rank0]:2026-01-03 03:55:10,809 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0355_stage0_step1400.svg
[rank3]:2026-01-03 03:55:10,887 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0355_step1400_rank3.svg
[rank3]:			> Batch Time: 457.00 ms, GPU Bubble Ratio: 26.64%, 27.51%, 35.11%, 27.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  163-28-192ms   | [S0,MB4,F]  192-14-206ms   | [S0,MB1,B]  206-37-244ms   | [S0,MB5,F]  244-14-259ms   | [S0,MB2,B]  259-25-284ms   | [S0,MB6,F]  285-14-299ms   | [S0,MB3,B]  300-26-326ms   | [S0,MB7,F]  327-14-341ms   | [S0,MB4,B]  341-44-385ms   | [S0,MB5,B]  403-27-430ms   | [S0,MB6,B]  431-25-456ms   | [S0,MB7,B]  457-0-457ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  206-15-222ms   | [S1,MB2,B]  222-29-251ms   | [S1,MB5,F]  259-15-275ms   | [S1,MB3,B]  275-21-296ms   | [S1,MB6,F]  299-15-315ms   | [S1,MB4,B]  315-20-336ms   | [S1,MB7,F]  341-15-357ms   | [S1,MB5,B]  357-45-403ms   | [S1,MB6,B]  403-21-425ms   | [S1,MB7,B]  429-20-450ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-141ms   | [S2,MB2,F]  142-13-155ms   | [S2,MB1,B]  161-18-180ms   | [S2,MB3,F]  180-13-194ms   | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-13-236ms   | [S2,MB3,B]  237-34-272ms   | [S2,MB5,F]  275-14-289ms   | [S2,MB4,B]  291-19-311ms   | [S2,MB6,F]  315-14-329ms   | [S2,MB5,B]  330-19-349ms   | [S2,MB7,F]  357-14-371ms   | [S2,MB6,B]  371-31-402ms   | [S2,MB7,B]  409-18-428ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-20-160ms   | [S3,MB2,F]  160-15-175ms   | [S3,MB2,B]  178-20-198ms   | [S3,MB3,F]  199-15-214ms   | [S3,MB3,B]  216-20-237ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  254-37-291ms   | [S3,MB5,F]  291-15-307ms   | [S3,MB5,B]  309-20-330ms   | [S3,MB6,F]  330-15-345ms   | [S3,MB6,B]  347-20-368ms   | [S3,MB7,F]  371-15-386ms   | [S3,MB7,B]  388-20-409ms  
[rank2]:2026-01-03 03:55:10,808 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0355_stage2_step1400.svg
[rank3]:2026-01-03 03:55:10,931 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0355_stage3_step1400.svg
[rank2]:2026-01-03 03:55:10,975 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0355_rank2_stage2.svg
[rank2]:	> Counts Sum: 2077200, Total Sum: 2810880 (73.90%), Ratio(%) per element: [82.17, 76.43, 75.4, 79.3, 73.05, 86.98, 83.5, 56.04, 55.63, 83.09, 74.89, 80.53, 74.48, 84.63, 83.81, 87.39, 55.94, 55.63, 83.19, 78.17, 76.12, 79.61, 76.12, 85.96, 85.75, 55.32, 55.73, 78.79, 74.18, 65.06, 83.19, 77.86, 85.55, 86.06, 55.73, 54.81, 84.32, 71.92, 61.68, 76.12, 85.75, 86.27, 83.81, 54.91, 54.91, 82.68, 72.33, 65.16, 64.65, 85.65, 83.19, 83.81, 56.76, 55.22, 82.88, 82.78, 66.59, 73.25, 85.14, 83.91, 81.86, 53.38, 55.63, 84.83, 80.63, 54.91, 73.25, 85.14, 84.52, 84.32, 55.32, 56.76]
[rank1]:2026-01-03 03:55:10,980 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0355_rank1_stage1.svg
[rank1]:	> Counts Sum: 2480640, Total Sum: 3162240 (78.45%), Ratio(%) per element: [84.32, 80.94, 69.87, 81.14, 76.84, 84.52, 83.19, 69.77, 68.64, 83.09, 78.58, 70.08, 81.76, 85.24, 84.63, 85.65, 69.36, 70.18, 79.4, 79.09, 71.31, 75.3, 84.93, 84.11, 83.7, 70.38, 69.36, 83.91, 77.66, 77.76, 80.12, 84.42, 84.11, 82.47, 68.34, 68.85, 83.4, 79.71, 75.2, 80.94, 78.89, 84.73, 82.06, 69.36, 69.77, 79.81, 80.84, 74.79, 79.4, 80.43, 82.99, 84.63, 71.31, 69.56, 83.5, 81.04, 79.5, 80.32, 84.63, 79.4, 81.25, 69.97, 71.0, 83.19, 77.56, 79.4, 81.86, 81.55, 82.17, 84.22, 69.26, 70.38, 82.68, 77.35, 82.27, 80.84, 84.73, 82.58, 82.78, 69.46, 69.97]
[rank0]:2026-01-03 03:55:10,984 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0355_rank0_stage0.svg
[rank0]:	> Counts Sum: 1281840, Total Sum: 2849920 (44.98%), Ratio(%) per element: [51.63, 59.83, 46.2, 53.89, 53.38, 46.82, 58.81, 64.03, 14.03, 15.06, 61.06, 17.72, 30.12, 58.91, 63.01, 63.52, 60.34, 15.26, 13.93, 40.67, 58.91, 57.27, 38.72, 61.37, 62.5, 44.05, 14.65, 14.85, 60.96, 56.55, 45.08, 59.32, 60.96, 60.86, 60.55, 13.93, 14.85, 62.8, 51.53, 26.02, 55.63, 60.75, 62.29, 64.44, 14.95, 14.85, 60.45, 49.07, 62.09, 55.53, 61.88, 63.11, 60.24, 14.85, 14.54, 55.94, 57.78, 53.79, 16.8, 61.47, 61.98, 63.52, 14.34, 14.75, 63.21, 41.29, 21.1, 14.54, 60.86, 61.47, 62.19, 14.24, 15.16]
[rank3]:2026-01-03 03:55:11,092 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0355_rank3_stage3.svg
[rank3]:	> Counts Sum: 1987840, Total Sum: 2537600 (78.34%), Ratio(%) per element: [77.35, 79.3, 73.87, 78.48, 82.17, 83.19, 82.78, 72.33, 72.02, 82.37, 78.48, 78.99, 76.84, 83.29, 82.27, 82.37, 71.82, 71.61, 77.86, 79.3, 79.09, 76.74, 83.19, 80.43, 80.84, 72.74, 72.95, 84.22, 77.76, 76.74, 78.68, 80.63, 81.45, 81.45, 73.36, 72.64, 82.88, 81.25, 74.07, 74.18, 82.88, 78.89, 82.58, 72.23, 72.13, 80.22, 79.81, 79.71, 80.73, 79.3, 83.4, 81.55, 72.23, 72.74, 81.65, 81.45, 81.65, 79.4, 80.94, 82.88, 84.11, 72.43, 72.23, 72.23, 72.13]
[rank1]:2026-01-03 03:55:12,340 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0355_stage1.svg
[rank0]:2026-01-03 03:55:12,324 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0355_stage0.svg
[rank2]:2026-01-03 03:55:12,317 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0355_stage2.svg
[rank3]:2026-01-03 03:55:12,527 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0355_stage3.svg
[rank0]:2026-01-03 03:56:47,102 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-03 03:56:49,027 - Avg. fwd time: 14.2895 / Avg. bwd time: 24.6959 / Avg. batch time: 410.8697 (ms) / GPU bubble ratio: 24.09%
[rank3]:2026-01-03 03:56:48,995 - Avg. fwd time: 15.4119 / Avg. bwd time: 28.2996 / Avg. batch time: 370.4861 (ms) / GPU bubble ratio: 5.61%
[rank1]:2026-01-03 03:56:49,058 - Avg. fwd time: 16.0493 / Avg. bwd time: 27.6333 / Avg. batch time: 455.6477 (ms) / GPU bubble ratio: 23.30%
[rank1]:2026-01-03 03:56:49,099 -  step: 1450  loss: -4.0000  grad_norm:  0.2338  memory: 58.51GiB(41.85%)  tps: 8,330  tflops: 388.52  mfu: 39.28%
[rank0]:2026-01-03 03:56:49,067 - Avg. fwd time: 14.6497 / Avg. bwd time: 28.8450 / Avg. batch time: 485.8791 (ms) / GPU bubble ratio: 28.39%
[rank0]:2026-01-03 03:56:49,103 -  step: 1450  loss: -4.0000  grad_norm:  0.2338  memory: 69.58GiB(49.77%)  tps: 8,330  tflops: 388.52  mfu: 39.28%
[rank2]:2026-01-03 03:56:49,095 -  step: 1450  loss: -4.0000  grad_norm:  0.2338  memory: 48.95GiB(35.01%)  tps: 8,330  tflops: 388.51  mfu: 39.28%
[rank3]:2026-01-03 03:56:49,101 -  step: 1450  loss:  0.1875  grad_norm:  0.2338  memory: 57.49GiB(41.12%)  tps: 8,330  tflops: 388.52  mfu: 39.28%
[rank0]:2026-01-03 03:58:23,951 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-03 03:58:25,955 - Avg. fwd time: 14.2974 / Avg. bwd time: 24.6261 / Avg. batch time: 410.1695 (ms) / GPU bubble ratio: 24.08%
[rank3]:2026-01-03 03:58:25,925 - Avg. fwd time: 15.4232 / Avg. bwd time: 28.2203 / Avg. batch time: 369.8749 (ms) / GPU bubble ratio: 5.60%
[rank1]:2026-01-03 03:58:25,986 - Avg. fwd time: 16.0580 / Avg. bwd time: 27.5537 / Avg. batch time: 454.8503 (ms) / GPU bubble ratio: 23.29%
[rank1]:2026-01-03 03:58:26,028 -  step: 1500  loss: -4.0000  grad_norm:  0.3499  memory: 58.51GiB(41.85%)  tps: 8,452  tflops: 394.18  mfu: 39.86%
[rank0]:2026-01-03 03:58:25,996 - Avg. fwd time: 14.6595 / Avg. bwd time: 28.7834 / Avg. batch time: 484.8738 (ms) / GPU bubble ratio: 28.32%
[rank2]:2026-01-03 03:58:26,023 -  step: 1500  loss: -4.0000  grad_norm:  0.3499  memory: 48.95GiB(35.01%)  tps: 8,452  tflops: 394.19  mfu: 39.86%
[rank3]:2026-01-03 03:58:26,030 -  step: 1500  loss:  0.2696  grad_norm:  0.3499  memory: 57.49GiB(41.12%)  tps: 8,452  tflops: 394.19  mfu: 39.86%
[rank1]:2026-01-03 03:58:26,080 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0358_stage1_step1500.svg
[rank0]:2026-01-03 03:58:26,032 -  step: 1500  loss: -4.0000  grad_norm:  0.3499  memory: 69.58GiB(49.77%)  tps: 8,452  tflops: 394.18  mfu: 39.86%
[rank0]:2026-01-03 03:58:26,079 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0358_stage0_step1500.svg
[rank2]:2026-01-03 03:58:26,080 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0358_stage2_step1500.svg
[rank3]:2026-01-03 03:58:26,156 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0358_step1500_rank3.svg
[rank3]:			> Batch Time: 459.25 ms, GPU Bubble Ratio: 26.22%, 27.09%, 35.43%, 26.95%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB0,B]  164-25-189ms   | [S0,MB4,F]  190-14-204ms   | [S0,MB1,B]  204-35-239ms   | [S0,MB5,F]  240-14-254ms   | [S0,MB2,B]  254-28-283ms   | [S0,MB6,F]  283-14-297ms   | [S0,MB3,B]  298-29-327ms   | [S0,MB7,F]  327-14-342ms   | [S0,MB4,B]  342-44-386ms   | [S0,MB5,B]  404-27-432ms   | [S0,MB6,B]  432-27-459ms   | [S0,MB7,B]  459-0-459ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  203-15-219ms   | [S1,MB2,B]  219-31-251ms   | [S1,MB5,F]  254-16-270ms   | [S1,MB3,B]  271-21-292ms   | [S1,MB6,F]  297-15-313ms   | [S1,MB4,B]  313-21-334ms   | [S1,MB7,F]  341-15-357ms   | [S1,MB5,B]  357-46-403ms   | [S1,MB6,B]  404-21-426ms   | [S1,MB7,B]  430-21-451ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-142ms   | [S2,MB2,F]  142-14-156ms   | [S2,MB1,B]  161-19-180ms   | [S2,MB3,F]  180-14-194ms   | [S2,MB2,B]  199-19-219ms   | [S2,MB4,F]  219-14-233ms   | [S2,MB3,B]  238-32-271ms   | [S2,MB5,F]  271-14-286ms   | [S2,MB4,B]  292-19-311ms   | [S2,MB6,F]  313-14-327ms   | [S2,MB5,B]  331-19-351ms   | [S2,MB7,F]  357-14-371ms   | [S2,MB6,B]  371-32-404ms   | [S2,MB7,B]  410-19-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-123ms    | [S3,MB1,F]  123-15-138ms   | [S3,MB1,B]  140-20-161ms   | [S3,MB2,F]  161-15-176ms   | [S3,MB2,B]  178-21-199ms   | [S3,MB3,F]  199-15-214ms   | [S3,MB3,B]  216-21-237ms   | [S3,MB4,F]  237-15-253ms   | [S3,MB4,B]  255-37-292ms   | [S3,MB5,F]  292-15-308ms   | [S3,MB5,B]  310-21-331ms   | [S3,MB6,F]  331-15-346ms   | [S3,MB6,B]  348-21-369ms   | [S3,MB7,F]  371-15-386ms   | [S3,MB7,B]  388-21-409ms  
[rank2]:2026-01-03 03:58:26,249 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0358_rank2_stage2.svg
[rank2]:	> Counts Sum: 2250800, Total Sum: 3041280 (74.01%), Ratio(%) per element: [81.91, 77.08, 76.23, 79.73, 74.05, 86.36, 83.61, 55.87, 55.77, 83.52, 75.37, 80.77, 75.47, 84.65, 83.8, 87.31, 55.58, 55.01, 83.33, 78.59, 76.7, 79.82, 76.6, 85.6, 85.41, 55.11, 55.39, 79.07, 72.25, 66.76, 83.04, 78.31, 85.03, 85.51, 55.58, 54.54, 84.94, 72.91, 62.4, 76.6, 85.7, 86.26, 83.99, 54.45, 54.54, 83.33, 73.2, 66.28, 66.38, 85.6, 83.14, 83.8, 55.96, 54.92, 82.95, 83.14, 67.89, 71.3, 84.75, 84.18, 81.81, 53.03, 55.39, 85.03, 80.77, 54.73, 74.33, 85.32, 84.65, 84.56, 54.92, 56.34]
[rank3]:2026-01-03 03:58:26,198 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0358_stage3_step1500.svg
[rank1]:2026-01-03 03:58:26,257 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0358_rank1_stage1.svg
[rank1]:	> Counts Sum: 2688240, Total Sum: 3421440 (78.57%), Ratio(%) per element: [84.28, 81.25, 69.79, 81.15, 77.27, 84.37, 83.23, 69.98, 68.93, 82.95, 78.97, 70.07, 82.1, 85.03, 84.28, 85.41, 69.22, 70.26, 79.54, 79.07, 72.53, 75.66, 84.75, 84.18, 83.61, 70.54, 69.5, 83.61, 78.4, 78.21, 80.68, 84.46, 83.9, 82.76, 68.56, 69.12, 83.42, 80.11, 75.66, 81.25, 79.26, 84.65, 82.0, 69.41, 69.88, 80.11, 80.96, 75.0, 79.73, 80.58, 83.14, 84.37, 70.92, 69.69, 83.71, 81.06, 79.73, 80.39, 84.46, 79.73, 81.43, 69.98, 71.11, 83.33, 77.93, 79.64, 82.1, 81.81, 82.1, 84.18, 69.31, 70.35, 82.67, 77.55, 82.48, 81.25, 84.56, 82.85, 82.48, 69.6, 70.26]
[rank0]:2026-01-03 03:58:26,249 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0358_rank0_stage0.svg
[rank0]:	> Counts Sum: 1387440, Total Sum: 3083520 (45.00%), Ratio(%) per element: [53.03, 58.9, 46.78, 54.26, 53.59, 47.53, 58.42, 64.01, 13.92, 14.86, 61.26, 17.42, 28.78, 58.61, 62.21, 63.16, 60.13, 15.05, 13.82, 41.95, 58.71, 56.72, 40.05, 61.36, 61.83, 44.88, 14.67, 14.67, 61.26, 56.72, 45.83, 59.18, 60.89, 60.51, 60.51, 13.82, 14.67, 62.5, 51.98, 28.4, 55.49, 60.03, 62.12, 64.01, 14.77, 14.77, 60.51, 49.14, 61.36, 55.77, 61.83, 62.5, 59.65, 14.67, 14.39, 55.58, 57.29, 53.97, 18.37, 61.83, 61.83, 63.06, 14.2, 14.58, 62.68, 42.8, 23.2, 14.58, 60.51, 61.07, 61.83, 14.1, 14.96]
[rank3]:2026-01-03 03:58:26,358 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0358_rank3_stage3.svg
[rank3]:	> Counts Sum: 2154240, Total Sum: 2745600 (78.46%), Ratio(%) per element: [77.74, 79.54, 74.62, 78.78, 82.1, 83.23, 82.57, 72.53, 72.25, 82.19, 78.21, 79.16, 76.7, 83.52, 82.0, 82.29, 72.06, 71.87, 78.4, 79.54, 79.35, 77.08, 83.14, 80.49, 81.06, 72.91, 73.1, 83.99, 78.5, 77.17, 78.78, 80.77, 81.53, 81.72, 73.48, 72.82, 82.67, 81.43, 74.52, 74.24, 82.85, 79.35, 82.67, 72.44, 72.34, 80.11, 80.11, 80.11, 80.87, 79.26, 83.23, 81.43, 72.44, 72.91, 81.34, 81.53, 81.62, 79.54, 80.77, 82.76, 84.09, 72.63, 72.44, 72.44, 72.34]
[rank1]:2026-01-03 03:58:27,727 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0358_stage1.svg
[rank0]:2026-01-03 03:58:27,683 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0358_stage0.svg
[rank2]:2026-01-03 03:58:27,719 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0358_stage2.svg
[rank3]:2026-01-03 03:58:27,857 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0358_stage3.svg
[rank0]:2026-01-03 04:00:03,682 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 04:00:05,626 - Avg. fwd time: 15.4320 / Avg. bwd time: 28.1371 / Avg. batch time: 369.3731 (ms) / GPU bubble ratio: 5.64%
[rank0]:2026-01-03 04:00:05,702 - Avg. fwd time: 14.6682 / Avg. bwd time: 28.7526 / Avg. batch time: 484.1355 (ms) / GPU bubble ratio: 28.25%
[rank1]:2026-01-03 04:00:05,689 - Avg. fwd time: 16.0655 / Avg. bwd time: 27.4753 / Avg. batch time: 454.1853 (ms) / GPU bubble ratio: 23.31%
[rank3]:2026-01-03 04:00:05,736 -  step: 1550  loss:  0.2709  grad_norm:  0.3010  memory: 57.49GiB(41.12%)  tps: 8,216  tflops: 383.21  mfu: 38.75%
[rank2]:2026-01-03 04:00:05,657 - Avg. fwd time: 14.3047 / Avg. bwd time: 24.5550 / Avg. batch time: 409.5966 (ms) / GPU bubble ratio: 24.10%
[rank2]:2026-01-03 04:00:05,729 -  step: 1550  loss: -4.0000  grad_norm:  0.3010  memory: 48.95GiB(35.01%)  tps: 8,216  tflops: 383.20  mfu: 38.75%
[rank0]:2026-01-03 04:00:05,737 -  step: 1550  loss: -4.0000  grad_norm:  0.3010  memory: 69.58GiB(49.77%)  tps: 8,216  tflops: 383.21  mfu: 38.75%
[rank1]:2026-01-03 04:00:05,733 -  step: 1550  loss: -4.0000  grad_norm:  0.3010  memory: 58.51GiB(41.85%)  tps: 8,216  tflops: 383.21  mfu: 38.75%
[rank0]:2026-01-03 04:01:40,783 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 04:01:42,750 - Avg. fwd time: 15.4365 / Avg. bwd time: 28.0624 / Avg. batch time: 368.8531 (ms) / GPU bubble ratio: 5.66%
[rank2]:2026-01-03 04:01:42,781 - Avg. fwd time: 14.3078 / Avg. bwd time: 24.4843 / Avg. batch time: 408.9913 (ms) / GPU bubble ratio: 24.12%
[rank1]:2026-01-03 04:01:42,813 - Avg. fwd time: 16.0689 / Avg. bwd time: 27.3971 / Avg. batch time: 453.4888 (ms) / GPU bubble ratio: 23.32%
[rank1]:2026-01-03 04:01:42,855 -  step: 1600  loss: -4.0000  grad_norm:  0.3392  memory: 58.51GiB(41.85%)  tps: 8,435  tflops: 393.40  mfu: 39.78%
[rank0]:2026-01-03 04:01:42,824 - Avg. fwd time: 14.6725 / Avg. bwd time: 28.7132 / Avg. batch time: 483.3040 (ms) / GPU bubble ratio: 28.18%
[rank0]:2026-01-03 04:01:42,859 -  step: 1600  loss: -4.0000  grad_norm:  0.3392  memory: 69.58GiB(49.77%)  tps: 8,435  tflops: 393.40  mfu: 39.78%
[rank3]:2026-01-03 04:01:42,858 -  step: 1600  loss:  0.4004  grad_norm:  0.3392  memory: 57.49GiB(41.12%)  tps: 8,435  tflops: 393.40  mfu: 39.78%
[rank2]:2026-01-03 04:01:42,851 -  step: 1600  loss: -4.0000  grad_norm:  0.3392  memory: 48.95GiB(35.01%)  tps: 8,435  tflops: 393.40  mfu: 39.78%
[rank2]:2026-01-03 04:01:42,912 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0401_stage2_step1600.svg
[rank1]:2026-01-03 04:01:42,909 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0401_stage1_step1600.svg
[rank0]:2026-01-03 04:01:42,911 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0401_stage0_step1600.svg
[rank3]:2026-01-03 04:01:42,987 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0401_step1600_rank3.svg
[rank3]:			> Batch Time: 463.50 ms, GPU Bubble Ratio: 26.14%, 28.49%, 36.20%, 27.81%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  164-28-192ms   | [S0,MB4,F]  192-14-206ms   | [S0,MB1,B]  206-38-245ms   | [S0,MB5,F]  245-14-259ms   | [S0,MB2,B]  259-28-288ms   | [S0,MB6,F]  287-14-302ms   | [S0,MB3,B]  302-30-332ms   | [S0,MB7,F]  332-14-346ms   | [S0,MB4,B]  347-44-391ms   | [S0,MB5,B]  409-26-436ms   | [S0,MB6,B]  436-26-463ms   | [S0,MB7,B]  463-0-463ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  206-15-221ms   | [S1,MB2,B]  222-28-250ms   | [S1,MB5,F]  259-15-275ms   | [S1,MB3,B]  275-21-296ms   | [S1,MB6,F]  302-15-317ms   | [S1,MB4,B]  318-21-339ms   | [S1,MB7,F]  346-15-362ms   | [S1,MB5,B]  362-46-408ms   | [S1,MB6,B]  409-21-430ms   | [S1,MB7,B]  434-21-455ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-142ms   | [S2,MB2,F]  142-13-156ms   | [S2,MB1,B]  161-19-180ms   | [S2,MB3,F]  180-13-194ms   | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  221-14-235ms   | [S2,MB3,B]  238-34-272ms   | [S2,MB5,F]  275-14-289ms   | [S2,MB4,B]  292-19-311ms   | [S2,MB6,F]  318-14-332ms   | [S2,MB5,B]  332-19-351ms   | [S2,MB7,F]  362-14-376ms   | [S2,MB6,B]  376-30-407ms   | [S2,MB7,B]  415-18-434ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-20-160ms   | [S3,MB2,F]  161-15-176ms   | [S3,MB2,B]  178-21-199ms   | [S3,MB3,F]  199-15-214ms   | [S3,MB3,B]  216-21-237ms   | [S3,MB4,F]  237-15-253ms   | [S3,MB4,B]  255-37-292ms   | [S3,MB5,F]  292-15-307ms   | [S3,MB5,B]  309-21-330ms   | [S3,MB6,F]  332-15-347ms   | [S3,MB6,B]  349-21-370ms   | [S3,MB7,F]  376-15-391ms   | [S3,MB7,B]  393-20-414ms  
[rank3]:2026-01-03 04:01:43,032 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0401_stage3_step1600.svg
[rank1]:2026-01-03 04:01:43,087 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0401_rank1_stage1.svg
[rank1]:	> Counts Sum: 2895840, Total Sum: 3680640 (78.68%), Ratio(%) per element: [84.24, 81.42, 70.07, 81.16, 77.64, 84.33, 83.18, 69.89, 68.92, 83.09, 79.13, 70.15, 82.04, 85.21, 84.06, 85.21, 69.27, 70.42, 79.75, 78.43, 73.15, 76.23, 84.59, 84.06, 83.71, 70.77, 69.54, 83.45, 78.43, 78.6, 80.63, 84.5, 83.62, 82.83, 68.92, 69.45, 83.45, 80.45, 76.32, 81.33, 79.57, 84.77, 82.13, 69.63, 69.8, 80.54, 81.07, 75.52, 80.19, 80.98, 82.92, 84.33, 71.03, 69.63, 83.45, 81.42, 80.19, 80.54, 84.59, 80.01, 81.6, 70.15, 70.77, 83.18, 78.52, 79.84, 81.95, 81.86, 82.21, 84.15, 69.54, 70.42, 82.74, 77.81, 82.65, 81.51, 84.5, 82.74, 82.65, 69.63, 70.15]
[rank0]:2026-01-03 04:01:43,085 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0401_rank0_stage0.svg
[rank0]:	> Counts Sum: 1493040, Total Sum: 3317120 (45.01%), Ratio(%) per element: [52.9, 58.97, 47.18, 54.66, 53.34, 48.06, 57.65, 63.82, 13.9, 14.78, 61.17, 17.07, 27.64, 58.45, 62.23, 62.23, 59.68, 14.96, 13.82, 42.34, 58.8, 56.69, 40.58, 61.26, 61.53, 45.51, 14.61, 14.52, 61.0, 56.95, 46.65, 58.71, 60.65, 60.12, 60.12, 13.73, 14.52, 62.32, 51.84, 30.72, 55.1, 59.85, 61.53, 63.55, 14.7, 14.87, 60.56, 49.82, 60.73, 55.28, 60.91, 61.97, 59.5, 14.52, 14.26, 56.25, 57.04, 54.31, 21.3, 61.79, 61.44, 62.67, 14.08, 14.43, 61.97, 44.45, 26.23, 14.43, 60.21, 61.35, 61.79, 13.99, 14.87]
[rank2]:2026-01-03 04:01:43,084 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0401_rank2_stage2.svg
[rank2]:	> Counts Sum: 2424400, Total Sum: 3271680 (74.10%), Ratio(%) per element: [82.21, 77.64, 76.67, 80.19, 74.91, 86.09, 83.45, 55.1, 55.72, 83.45, 76.05, 80.98, 76.23, 84.59, 84.06, 87.23, 55.28, 54.84, 82.92, 78.96, 77.37, 80.28, 77.11, 85.38, 85.29, 54.84, 55.1, 79.57, 70.68, 67.86, 82.92, 79.04, 84.85, 85.12, 54.84, 54.22, 85.12, 73.59, 63.99, 77.2, 85.56, 86.35, 84.24, 54.13, 54.66, 83.36, 74.03, 67.6, 67.6, 85.38, 83.18, 83.8, 55.89, 54.57, 83.18, 83.18, 68.83, 69.36, 84.94, 84.33, 81.86, 53.25, 54.66, 85.03, 81.16, 54.4, 75.44, 85.12, 84.15, 84.85, 54.31, 55.72]
[rank3]:2026-01-03 04:01:43,196 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0401_rank3_stage3.svg
[rank3]:	> Counts Sum: 2320640, Total Sum: 2953600 (78.57%), Ratio(%) per element: [78.25, 79.57, 75.08, 79.13, 82.13, 82.74, 82.92, 72.71, 72.44, 82.21, 77.99, 79.48, 76.67, 83.27, 82.04, 82.21, 72.27, 72.09, 78.78, 79.57, 79.4, 77.46, 82.83, 80.72, 80.98, 73.06, 73.23, 83.89, 78.69, 77.46, 79.13, 80.72, 81.51, 81.69, 73.59, 72.97, 82.65, 81.69, 74.91, 74.38, 82.74, 79.57, 82.74, 72.62, 72.53, 80.28, 80.63, 80.1, 80.89, 79.57, 83.27, 81.42, 72.62, 73.06, 81.33, 81.33, 81.51, 79.75, 81.07, 82.48, 84.06, 72.79, 72.62, 72.62, 72.62]
[rank0]:2026-01-03 04:01:44,649 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0401_stage0.svg
[rank1]:2026-01-03 04:01:44,776 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0401_stage1.svg
[rank2]:2026-01-03 04:01:44,795 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0401_stage2.svg
[rank3]:2026-01-03 04:01:44,912 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0401_stage3.svg
[rank0]:2026-01-03 04:03:20,151 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 04:03:22,097 - Avg. fwd time: 15.4421 / Avg. bwd time: 27.9893 / Avg. batch time: 368.3894 (ms) / GPU bubble ratio: 5.68%
[rank2]:2026-01-03 04:03:22,130 - Avg. fwd time: 14.3121 / Avg. bwd time: 24.4160 / Avg. batch time: 408.4643 (ms) / GPU bubble ratio: 24.15%
[rank1]:2026-01-03 04:03:22,162 - Avg. fwd time: 16.0738 / Avg. bwd time: 27.3255 / Avg. batch time: 452.8794 (ms) / GPU bubble ratio: 23.34%
[rank0]:2026-01-03 04:03:22,174 - Avg. fwd time: 14.6781 / Avg. bwd time: 28.6745 / Avg. batch time: 482.5587 (ms) / GPU bubble ratio: 28.13%
[rank3]:2026-01-03 04:03:22,208 -  step: 1650  loss:  0.4160  grad_norm:  0.5465  memory: 57.49GiB(41.12%)  tps: 8,246  tflops: 384.58  mfu: 38.89%
[rank2]:2026-01-03 04:03:22,201 -  step: 1650  loss: -4.0000  grad_norm:  0.5465  memory: 48.95GiB(35.01%)  tps: 8,246  tflops: 384.58  mfu: 38.89%
[rank1]:2026-01-03 04:03:22,206 -  step: 1650  loss: -4.0000  grad_norm:  0.5465  memory: 58.51GiB(41.85%)  tps: 8,246  tflops: 384.57  mfu: 38.89%
[rank0]:2026-01-03 04:03:22,210 -  step: 1650  loss: -4.0000  grad_norm:  0.5465  memory: 69.58GiB(49.77%)  tps: 8,246  tflops: 384.57  mfu: 38.89%
[rank0]:2026-01-03 04:04:58,052 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 04:05:00,002 - Avg. fwd time: 15.4482 / Avg. bwd time: 27.9229 / Avg. batch time: 367.9333 (ms) / GPU bubble ratio: 5.70%
[rank1]:2026-01-03 04:05:00,068 - Avg. fwd time: 16.0790 / Avg. bwd time: 27.2636 / Avg. batch time: 452.2726 (ms) / GPU bubble ratio: 23.33%
[rank0]:2026-01-03 04:05:00,078 - Avg. fwd time: 14.6839 / Avg. bwd time: 28.6449 / Avg. batch time: 481.8917 (ms) / GPU bubble ratio: 28.07%
[rank3]:2026-01-03 04:05:00,112 -  step: 1700  loss:  0.4024  grad_norm:  0.6977  memory: 57.49GiB(41.12%)  tps: 8,368  tflops: 390.26  mfu: 39.46%
[rank2]:2026-01-03 04:05:00,035 - Avg. fwd time: 14.3170 / Avg. bwd time: 24.3568 / Avg. batch time: 407.9346 (ms) / GPU bubble ratio: 24.16%
[rank2]:2026-01-03 04:05:00,104 -  step: 1700  loss: -4.0000  grad_norm:  0.6977  memory: 48.95GiB(35.01%)  tps: 8,367  tflops: 390.26  mfu: 39.46%
[rank1]:2026-01-03 04:05:00,110 -  step: 1700  loss: -4.0000  grad_norm:  0.6977  memory: 58.51GiB(41.85%)  tps: 8,367  tflops: 390.26  mfu: 39.46%
[rank1]:2026-01-03 04:05:00,164 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0405_stage1_step1700.svg
[rank0]:2026-01-03 04:05:00,114 -  step: 1700  loss: -4.0000  grad_norm:  0.6977  memory: 69.58GiB(49.77%)  tps: 8,367  tflops: 390.26  mfu: 39.46%
[rank0]:2026-01-03 04:05:00,162 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0405_stage0_step1700.svg
[rank2]:2026-01-03 04:05:00,163 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0405_stage2_step1700.svg
[rank3]:2026-01-03 04:05:00,238 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0405_step1700_rank3.svg
[rank3]:			> Batch Time: 464.75 ms, GPU Bubble Ratio: 25.91%, 28.38%, 36.06%, 28.58%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB0,B]  163-28-192ms   | [S0,MB4,F]  192-14-206ms   | [S0,MB1,B]  206-38-244ms   | [S0,MB5,F]  245-14-259ms   | [S0,MB2,B]  259-27-287ms   | [S0,MB6,F]  287-14-301ms   | [S0,MB3,B]  302-28-330ms   | [S0,MB7,F]  330-14-344ms   | [S0,MB4,B]  344-44-389ms   | [S0,MB5,B]  406-29-436ms   | [S0,MB6,B]  436-28-464ms   | [S0,MB7,B]  464-0-464ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB0,B]  142-21-163ms   | [S1,MB3,F]  163-15-179ms   | [S1,MB1,B]  180-20-201ms   | [S1,MB4,F]  206-15-222ms   | [S1,MB2,B]  222-30-252ms   | [S1,MB5,F]  259-15-274ms   | [S1,MB3,B]  275-21-296ms   | [S1,MB6,F]  301-15-317ms   | [S1,MB4,B]  317-21-338ms   | [S1,MB7,F]  344-15-360ms   | [S1,MB5,B]  360-45-406ms   | [S1,MB6,B]  406-21-428ms   | [S1,MB7,B]  432-21-453ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB0,B]  123-18-141ms   | [S2,MB2,F]  142-13-156ms   | [S2,MB1,B]  161-19-180ms   | [S2,MB3,F]  180-13-194ms   | [S2,MB2,B]  199-19-218ms   | [S2,MB4,F]  222-14-236ms   | [S2,MB3,B]  237-34-272ms   | [S2,MB5,F]  275-14-289ms   | [S2,MB4,B]  290-19-309ms   | [S2,MB6,F]  317-14-331ms   | [S2,MB5,B]  332-19-351ms   | [S2,MB7,F]  360-14-374ms   | [S2,MB6,B]  374-31-406ms   | [S2,MB7,B]  412-18-431ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB0,B]  77-45-122ms    | [S3,MB1,F]  123-14-138ms   | [S3,MB1,B]  140-20-160ms   | [S3,MB2,F]  160-15-175ms   | [S3,MB2,B]  177-20-198ms   | [S3,MB3,F]  198-15-214ms   | [S3,MB3,B]  215-20-236ms   | [S3,MB4,F]  237-15-252ms   | [S3,MB4,B]  254-35-290ms   | [S3,MB5,F]  290-15-305ms   | [S3,MB5,B]  307-20-328ms   | [S3,MB6,F]  331-15-346ms   | [S3,MB6,B]  348-20-369ms   | [S3,MB7,F]  374-15-389ms   | [S3,MB7,B]  391-20-412ms  
[rank3]:2026-01-03 04:05:00,281 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0405_stage3_step1700.svg
[rank1]:2026-01-03 04:05:00,347 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0405_rank1_stage1.svg
[rank1]:	> Counts Sum: 3103440, Total Sum: 3939840 (78.77%), Ratio(%) per element: [84.21, 81.49, 70.14, 81.0, 77.87, 84.45, 83.14, 69.98, 69.24, 83.14, 79.52, 70.14, 82.15, 85.27, 83.96, 85.11, 69.4, 70.47, 80.01, 77.96, 73.93, 76.8, 84.62, 83.96, 83.55, 70.8, 69.65, 83.22, 78.78, 79.02, 80.92, 84.45, 83.63, 82.81, 69.07, 69.4, 83.38, 80.59, 76.72, 81.66, 80.01, 84.7, 82.07, 69.73, 70.14, 80.59, 81.41, 76.15, 80.26, 81.25, 82.73, 84.21, 70.88, 69.9, 83.47, 81.66, 80.5, 80.59, 84.53, 80.26, 81.49, 69.98, 70.64, 83.38, 78.78, 80.26, 81.82, 81.82, 82.31, 84.04, 69.81, 70.47, 82.64, 78.04, 82.73, 81.57, 84.45, 82.81, 82.64, 69.57, 70.14]
[rank0]:2026-01-03 04:05:00,332 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0405_rank0_stage0.svg
[rank0]:	> Counts Sum: 1598640, Total Sum: 3550720 (45.02%), Ratio(%) per element: [53.12, 58.71, 47.86, 55.18, 54.35, 48.84, 57.48, 63.89, 13.81, 14.63, 61.18, 16.77, 26.72, 58.88, 61.84, 61.84, 59.62, 14.8, 13.73, 43.09, 58.79, 57.07, 42.1, 60.52, 61.59, 46.13, 14.47, 14.47, 60.11, 56.82, 47.12, 58.22, 60.52, 60.44, 59.7, 13.81, 14.47, 61.84, 52.38, 32.56, 54.93, 59.21, 60.93, 62.58, 14.63, 14.8, 59.95, 50.16, 60.11, 55.18, 60.19, 61.84, 59.62, 14.47, 14.14, 56.0, 56.9, 54.35, 23.27, 60.85, 61.75, 61.51, 14.06, 14.39, 61.92, 45.06, 28.37, 14.3, 59.7, 61.67, 61.26, 14.06, 14.72]
[rank2]:2026-01-03 04:05:00,335 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0405_rank2_stage2.svg
[rank2]:	> Counts Sum: 2598000, Total Sum: 3502080 (74.18%), Ratio(%) per element: [82.23, 78.04, 77.13, 80.34, 75.49, 85.93, 83.63, 54.44, 55.42, 83.88, 76.64, 81.0, 76.48, 84.7, 84.04, 87.17, 54.76, 54.52, 83.05, 79.27, 77.79, 80.34, 77.63, 84.86, 85.36, 54.68, 54.93, 80.09, 69.4, 69.07, 82.97, 79.52, 84.78, 85.03, 54.44, 54.02, 84.95, 74.42, 65.54, 78.04, 85.36, 86.01, 84.45, 54.02, 54.27, 83.63, 74.75, 68.5, 68.58, 85.44, 83.14, 84.04, 55.18, 54.19, 83.22, 83.3, 69.73, 68.25, 84.95, 84.7, 82.07, 53.2, 54.11, 84.95, 81.41, 53.78, 75.74, 85.27, 84.04, 84.53, 54.11, 56.0]
[rank3]:2026-01-03 04:05:00,442 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0405_rank3_stage3.svg
[rank3]:	> Counts Sum: 2487040, Total Sum: 3161600 (78.66%), Ratio(%) per element: [78.53, 79.6, 75.49, 79.27, 82.23, 82.56, 83.05, 72.86, 72.61, 82.07, 77.79, 79.6, 76.56, 83.05, 82.15, 81.99, 72.45, 72.28, 78.7, 79.76, 79.44, 77.79, 82.81, 80.92, 81.0, 73.19, 73.43, 83.71, 78.86, 77.87, 79.19, 80.92, 81.49, 81.82, 73.68, 73.1, 82.64, 81.82, 75.41, 74.42, 82.89, 79.76, 82.81, 72.77, 72.69, 80.26, 80.5, 80.26, 81.08, 79.93, 83.3, 81.41, 72.77, 73.19, 81.41, 81.41, 81.57, 79.76, 81.08, 82.56, 84.04, 72.94, 72.77, 72.77, 72.77]
[rank0]:2026-01-03 04:05:01,989 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0405_stage0.svg
[rank2]:2026-01-03 04:05:02,058 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0405_stage2.svg
[rank3]:2026-01-03 04:05:02,168 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0405_stage3.svg
[rank1]:2026-01-03 04:05:02,217 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0405_stage1.svg
[rank0]:2026-01-03 04:06:37,457 - [GC] Peforming periodical GC collection 0.02 seconds
[rank3]:2026-01-03 04:06:39,419 - Avg. fwd time: 15.4529 / Avg. bwd time: 27.8612 / Avg. batch time: 367.5321 (ms) / GPU bubble ratio: 5.72%
[rank2]:2026-01-03 04:06:39,453 - Avg. fwd time: 14.3209 / Avg. bwd time: 24.3035 / Avg. batch time: 407.4631 (ms) / GPU bubble ratio: 24.17%
[rank0]:2026-01-03 04:06:39,498 - Avg. fwd time: 14.6888 / Avg. bwd time: 28.6117 / Avg. batch time: 481.2416 (ms) / GPU bubble ratio: 28.02%
[rank0]:2026-01-03 04:06:39,533 -  step: 1750  loss: -4.0000  grad_norm:  0.6225  memory: 69.58GiB(49.77%)  tps: 8,240  tflops: 384.31  mfu: 38.86%
[rank1]:2026-01-03 04:06:39,486 - Avg. fwd time: 16.0832 / Avg. bwd time: 27.2002 / Avg. batch time: 451.7270 (ms) / GPU bubble ratio: 23.35%
[rank1]:2026-01-03 04:06:39,529 -  step: 1750  loss: -4.0000  grad_norm:  0.6225  memory: 58.51GiB(41.85%)  tps: 8,240  tflops: 384.31  mfu: 38.86%
[rank3]:2026-01-03 04:06:39,531 -  step: 1750  loss:  0.4140  grad_norm:  0.6225  memory: 57.49GiB(41.12%)  tps: 8,240  tflops: 384.31  mfu: 38.86%
[rank2]:2026-01-03 04:06:39,523 -  step: 1750  loss: -4.0000  grad_norm:  0.6225  memory: 48.95GiB(35.01%)  tps: 8,240  tflops: 384.31  mfu: 38.86%
[rank0]:2026-01-03 04:08:13,275 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 04:08:15,145 - Avg. fwd time: 15.4480 / Avg. bwd time: 27.7954 / Avg. batch time: 367.0028 (ms) / GPU bubble ratio: 5.74%
[rank2]:2026-01-03 04:08:15,177 - Avg. fwd time: 14.3174 / Avg. bwd time: 24.2446 / Avg. batch time: 406.8560 (ms) / GPU bubble ratio: 24.18%
[rank0]:2026-01-03 04:08:15,224 - Avg. fwd time: 14.6859 / Avg. bwd time: 28.5762 / Avg. batch time: 480.4856 (ms) / GPU bubble ratio: 27.97%
[rank1]:2026-01-03 04:08:15,210 - Avg. fwd time: 16.0793 / Avg. bwd time: 27.1354 / Avg. batch time: 451.0387 (ms) / GPU bubble ratio: 23.35%
[rank1]:2026-01-03 04:08:15,256 -  step: 1800  loss: -4.0000  grad_norm:  0.1603  memory: 58.51GiB(41.85%)  tps: 8,558  tflops: 399.13  mfu: 40.36%
[rank3]:2026-01-03 04:08:15,258 -  step: 1800  loss:  0.0776  grad_norm:  0.1603  memory: 57.49GiB(41.12%)  tps: 8,558  tflops: 399.14  mfu: 40.36%
[rank2]:2026-01-03 04:08:15,251 -  step: 1800  loss: -4.0000  grad_norm:  0.1603  memory: 48.95GiB(35.01%)  tps: 8,558  tflops: 399.13  mfu: 40.36%
[rank0]:2026-01-03 04:08:15,260 -  step: 1800  loss: -4.0000  grad_norm:  0.1603  memory: 69.58GiB(49.77%)  tps: 8,558  tflops: 399.13  mfu: 40.36%
[rank0]:2026-01-03 04:08:15,309 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0408_stage0_step1800.svg
[rank1]:2026-01-03 04:08:15,309 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0408_stage1_step1800.svg
[rank3]:2026-01-03 04:08:15,384 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0408_step1800_rank3.svg
[rank3]:			> Batch Time: 452.25 ms, GPU Bubble Ratio: 26.39%, 28.52%, 35.50%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-58ms     | [S0,MB0,B]  160-25-186ms   | [S0,MB4,F]  186-13-199ms   | [S0,MB1,B]  199-36-235ms   | [S0,MB5,F]  236-13-249ms   | [S0,MB2,B]  250-27-277ms   | [S0,MB6,F]  277-14-291ms   | [S0,MB3,B]  291-29-320ms   | [S0,MB7,F]  320-14-334ms   | [S0,MB4,B]  334-43-378ms   | [S0,MB5,B]  395-27-422ms   | [S0,MB6,B]  422-29-452ms   | [S0,MB7,B]  452-0-452ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-14-52ms     | [S1,MB2,F]  52-14-67ms     | [S1,MB0,B]  139-20-159ms   | [S1,MB3,F]  160-14-175ms   | [S1,MB1,B]  176-20-196ms   | [S1,MB4,F]  199-15-214ms   | [S1,MB2,B]  214-29-243ms   | [S1,MB5,F]  249-15-265ms   | [S1,MB3,B]  265-20-286ms   | [S1,MB6,F]  291-15-306ms   | [S1,MB4,B]  306-20-327ms   | [S1,MB7,F]  334-15-349ms   | [S1,MB5,B]  349-45-395ms   | [S1,MB6,B]  396-20-417ms   | [S1,MB7,B]  418-20-439ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB0,B]  120-18-138ms   | [S2,MB2,F]  139-13-152ms   | [S2,MB1,B]  157-18-176ms   | [S2,MB3,F]  176-13-189ms   | [S2,MB2,B]  193-18-212ms   | [S2,MB4,F]  214-13-227ms   | [S2,MB3,B]  230-34-265ms   | [S2,MB5,F]  265-13-279ms   | [S2,MB4,B]  280-18-299ms   | [S2,MB6,F]  306-13-319ms   | [S2,MB5,B]  319-19-339ms   | [S2,MB7,F]  349-13-362ms   | [S2,MB6,B]  362-32-395ms   | [S2,MB7,B]  399-18-418ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-72ms     | [S3,MB0,B]  74-45-120ms    | [S3,MB1,F]  120-14-134ms   | [S3,MB1,B]  136-20-156ms   | [S3,MB2,F]  156-14-171ms   | [S3,MB2,B]  172-20-193ms   | [S3,MB3,F]  193-14-207ms   | [S3,MB3,B]  209-20-229ms   | [S3,MB4,F]  230-14-244ms   | [S3,MB4,B]  246-34-280ms   | [S3,MB5,F]  280-14-294ms   | [S3,MB5,B]  296-20-317ms   | [S3,MB6,F]  319-14-333ms   | [S3,MB6,B]  335-20-356ms   | [S3,MB7,F]  362-14-377ms   | [S3,MB7,B]  378-20-399ms  
[rank2]:2026-01-03 04:08:15,309 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0408_stage2_step1800.svg
[rank3]:2026-01-03 04:08:15,427 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0408_stage3_step1800.svg
[rank2]:2026-01-03 04:08:15,477 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0408_rank2_stage2.svg
[rank2]:	> Counts Sum: 2771600, Total Sum: 3732480 (74.26%), Ratio(%) per element: [82.48, 78.39, 77.85, 80.7, 76.0, 85.49, 83.87, 54.16, 55.09, 83.71, 77.46, 81.09, 77.08, 84.33, 84.1, 86.65, 54.39, 54.24, 83.33, 79.55, 78.24, 80.7, 78.08, 84.79, 85.26, 54.39, 54.39, 80.09, 68.28, 69.83, 83.17, 79.86, 84.87, 85.18, 54.39, 53.93, 84.79, 75.15, 66.82, 78.47, 85.33, 85.64, 84.41, 54.01, 53.62, 83.79, 75.54, 69.29, 69.83, 85.41, 83.1, 83.87, 54.86, 53.78, 83.25, 83.41, 70.52, 67.36, 84.95, 84.64, 82.09, 52.62, 54.08, 85.18, 81.4, 53.47, 75.92, 85.1, 84.25, 84.56, 54.32, 55.86]
[rank0]:2026-01-03 04:08:15,484 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0408_rank0_stage0.svg
[rank0]:	> Counts Sum: 1704240, Total Sum: 3784320 (45.03%), Ratio(%) per element: [53.31, 58.56, 47.99, 55.55, 54.93, 49.3, 57.56, 63.81, 13.73, 14.5, 61.41, 16.58, 26.0, 58.56, 61.57, 60.87, 59.95, 14.89, 13.65, 43.51, 58.41, 56.94, 43.2, 60.33, 61.03, 47.29, 14.42, 14.42, 59.64, 57.09, 47.83, 58.17, 60.1, 60.26, 59.49, 13.81, 14.42, 61.65, 52.85, 33.87, 55.32, 59.33, 60.57, 62.34, 14.5, 14.66, 60.03, 50.54, 59.25, 54.93, 60.03, 61.57, 58.79, 14.35, 14.04, 55.94, 56.94, 54.32, 25.23, 60.64, 61.26, 60.64, 13.96, 14.35, 61.49, 45.91, 30.09, 14.19, 59.1, 61.41, 61.41, 13.96, 14.58]
[rank1]:2026-01-03 04:08:15,484 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0408_rank1_stage1.svg
[rank1]:	> Counts Sum: 3311040, Total Sum: 4199040 (78.85%), Ratio(%) per element: [83.95, 81.63, 70.29, 81.17, 78.08, 84.49, 83.1, 70.06, 69.52, 83.33, 79.93, 70.13, 82.17, 85.1, 83.95, 85.1, 69.44, 70.44, 80.32, 77.93, 74.61, 77.16, 84.72, 84.1, 83.56, 70.83, 69.9, 83.17, 79.01, 79.16, 80.94, 84.41, 83.64, 82.71, 69.05, 69.52, 83.41, 80.78, 77.08, 81.94, 80.24, 84.79, 82.17, 69.44, 70.29, 80.63, 81.48, 76.46, 80.4, 81.32, 82.79, 83.95, 70.83, 69.67, 83.56, 81.86, 80.47, 80.4, 84.41, 80.47, 81.63, 69.9, 70.67, 83.33, 79.16, 80.4, 81.94, 81.94, 82.33, 84.02, 70.06, 70.52, 82.94, 78.31, 82.48, 81.71, 84.33, 82.71, 82.71, 69.75, 70.37]
[rank3]:2026-01-03 04:08:15,587 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0408_rank3_stage3.svg
[rank3]:	> Counts Sum: 2653440, Total Sum: 3369600 (78.75%), Ratio(%) per element: [78.85, 79.78, 75.77, 79.16, 82.33, 82.56, 83.02, 72.99, 72.76, 82.09, 77.62, 79.7, 76.46, 82.94, 82.09, 81.94, 72.6, 72.45, 78.93, 80.01, 79.62, 78.08, 82.56, 81.17, 81.25, 73.3, 73.53, 83.79, 79.08, 78.16, 79.39, 81.01, 81.48, 81.71, 73.91, 73.22, 82.71, 81.94, 75.46, 74.45, 82.79, 79.86, 82.71, 72.91, 72.83, 80.55, 80.4, 80.4, 81.09, 79.86, 83.17, 81.4, 72.91, 73.37, 81.48, 81.63, 81.55, 79.86, 81.25, 82.56, 83.79, 73.14, 72.91, 72.99, 72.91]
[rank0]:2026-01-03 04:08:17,259 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0408_stage0.svg
[rank1]:2026-01-03 04:08:17,352 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0408_stage1.svg
[rank2]:2026-01-03 04:08:17,309 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0408_stage2.svg
[rank3]:2026-01-03 04:08:17,408 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0408_stage3.svg
[rank0]:2026-01-03 04:09:50,786 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 04:09:52,692 - Avg. fwd time: 15.4423 / Avg. bwd time: 27.7326 / Avg. batch time: 366.5127 (ms) / GPU bubble ratio: 5.76%
[rank2]:2026-01-03 04:09:52,724 - Avg. fwd time: 14.3129 / Avg. bwd time: 24.1833 / Avg. batch time: 406.2937 (ms) / GPU bubble ratio: 24.20%
[rank1]:2026-01-03 04:09:52,758 - Avg. fwd time: 16.0744 / Avg. bwd time: 27.0734 / Avg. batch time: 450.3979 (ms) / GPU bubble ratio: 23.36%
[rank1]:2026-01-03 04:09:52,803 -  step: 1850  loss: -4.0000  grad_norm:  0.2958  memory: 58.51GiB(41.85%)  tps: 8,398  tflops: 391.68  mfu: 39.60%
[rank0]:2026-01-03 04:09:52,771 - Avg. fwd time: 14.6827 / Avg. bwd time: 28.5430 / Avg. batch time: 479.7774 (ms) / GPU bubble ratio: 27.92%
[rank0]:2026-01-03 04:09:52,807 -  step: 1850  loss: -4.0000  grad_norm:  0.2958  memory: 69.58GiB(49.77%)  tps: 8,398  tflops: 391.69  mfu: 39.60%
[rank3]:2026-01-03 04:09:52,805 -  step: 1850  loss:  0.3557  grad_norm:  0.2958  memory: 57.49GiB(41.12%)  tps: 8,398  tflops: 391.69  mfu: 39.60%
[rank2]:2026-01-03 04:09:52,798 -  step: 1850  loss: -4.0000  grad_norm:  0.2958  memory: 48.95GiB(35.01%)  tps: 8,398  tflops: 391.68  mfu: 39.60%
[rank0]:2026-01-03 04:11:25,384 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 04:11:27,291 - Avg. fwd time: 15.4342 / Avg. bwd time: 27.6670 / Avg. batch time: 365.9877 (ms) / GPU bubble ratio: 5.79%
[rank2]:2026-01-03 04:11:27,324 - Avg. fwd time: 14.3069 / Avg. bwd time: 24.1261 / Avg. batch time: 405.6949 (ms) / GPU bubble ratio: 24.21%
[rank1]:2026-01-03 04:11:27,356 - Avg. fwd time: 16.0678 / Avg. bwd time: 27.0141 / Avg. batch time: 449.7217 (ms) / GPU bubble ratio: 23.36%
[rank1]:2026-01-03 04:11:27,401 -  step: 1900  loss: -4.0000  grad_norm:  0.1962  memory: 58.51GiB(41.85%)  tps: 8,660  tflops: 403.90  mfu: 40.84%
[rank0]:2026-01-03 04:11:27,369 - Avg. fwd time: 14.6771 / Avg. bwd time: 28.5059 / Avg. batch time: 479.0200 (ms) / GPU bubble ratio: 27.88%
[rank0]:2026-01-03 04:11:27,405 -  step: 1900  loss: -4.0000  grad_norm:  0.1962  memory: 69.58GiB(49.77%)  tps: 8,660  tflops: 403.90  mfu: 40.84%
[rank3]:2026-01-03 04:11:27,403 -  step: 1900  loss:  0.2041  grad_norm:  0.1962  memory: 57.49GiB(41.12%)  tps: 8,660  tflops: 403.90  mfu: 40.84%
[rank2]:2026-01-03 04:11:27,396 -  step: 1900  loss: -4.0000  grad_norm:  0.1962  memory: 48.95GiB(35.01%)  tps: 8,660  tflops: 403.90  mfu: 40.84%
[rank2]:2026-01-03 04:11:27,452 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0411_stage2_step1900.svg
[rank1]:2026-01-03 04:11:27,454 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0411_stage1_step1900.svg
[rank0]:2026-01-03 04:11:27,455 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0411_stage0_step1900.svg
[rank3]:2026-01-03 04:11:27,533 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0411_step1900_rank3.svg
[rank3]:			> Batch Time: 449.75 ms, GPU Bubble Ratio: 26.62%, 27.58%, 36.07%, 28.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB0,B]  161-26-187ms   | [S0,MB4,F]  186-13-200ms   | [S0,MB1,B]  200-37-237ms   | [S0,MB5,F]  238-14-252ms   | [S0,MB2,B]  252-29-281ms   | [S0,MB6,F]  281-14-295ms   | [S0,MB3,B]  295-27-323ms   | [S0,MB7,F]  323-14-337ms   | [S0,MB4,B]  337-43-381ms   | [S0,MB5,B]  398-24-423ms   | [S0,MB6,B]  423-26-449ms   | [S0,MB7,B]  449-0-449ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB0,B]  139-20-160ms   | [S1,MB3,F]  160-15-175ms   | [S1,MB1,B]  177-20-197ms   | [S1,MB4,F]  200-15-215ms   | [S1,MB2,B]  215-30-245ms   | [S1,MB5,F]  252-15-267ms   | [S1,MB3,B]  267-20-288ms   | [S1,MB6,F]  295-15-310ms   | [S1,MB4,B]  311-20-331ms   | [S1,MB7,F]  337-15-352ms   | [S1,MB5,B]  352-45-397ms   | [S1,MB6,B]  398-21-419ms   | [S1,MB7,B]  422-20-443ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB0,B]  121-18-139ms   | [S2,MB2,F]  139-13-153ms   | [S2,MB1,B]  157-18-176ms   | [S2,MB3,F]  176-13-190ms   | [S2,MB2,B]  194-18-213ms   | [S2,MB4,F]  215-13-229ms   | [S2,MB3,B]  231-34-265ms   | [S2,MB5,F]  267-13-280ms   | [S2,MB4,B]  282-18-301ms   | [S2,MB6,F]  310-13-324ms   | [S2,MB5,B]  324-18-343ms   | [S2,MB7,F]  352-13-365ms   | [S2,MB6,B]  365-28-394ms   | [S2,MB7,B]  402-18-421ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB0,B]  75-45-120ms    | [S3,MB1,F]  120-14-135ms   | [S3,MB1,B]  137-20-157ms   | [S3,MB2,F]  157-14-171ms   | [S3,MB2,B]  173-20-194ms   | [S3,MB3,F]  194-14-208ms   | [S3,MB3,B]  210-20-231ms   | [S3,MB4,F]  231-14-245ms   | [S3,MB4,B]  248-34-282ms   | [S3,MB5,F]  282-14-297ms   | [S3,MB5,B]  299-20-319ms   | [S3,MB6,F]  324-14-338ms   | [S3,MB6,B]  341-20-361ms   | [S3,MB7,F]  365-14-380ms   | [S3,MB7,B]  382-20-402ms  
[rank3]:2026-01-03 04:11:27,579 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0411_stage3_step1900.svg
[rank2]:2026-01-03 04:11:27,619 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0411_rank2_stage2.svg
[rank2]:	> Counts Sum: 2945200, Total Sum: 3962880 (74.32%), Ratio(%) per element: [82.48, 78.7, 78.27, 80.95, 76.45, 85.31, 84.08, 54.06, 54.72, 83.79, 78.12, 81.46, 77.39, 84.59, 83.86, 86.55, 53.92, 54.28, 83.35, 79.65, 78.27, 80.95, 78.41, 84.81, 85.31, 53.99, 54.06, 80.15, 67.0, 70.78, 83.13, 80.15, 84.88, 85.1, 54.28, 53.85, 84.66, 75.58, 67.8, 78.7, 85.46, 85.53, 84.44, 53.92, 53.85, 83.93, 76.09, 70.05, 70.71, 85.61, 83.28, 83.79, 54.28, 53.48, 83.21, 83.5, 71.07, 66.42, 85.17, 84.66, 82.04, 52.47, 53.77, 84.95, 81.39, 53.7, 76.45, 85.39, 84.3, 84.59, 54.06, 55.23]
[rank1]:2026-01-03 04:11:27,629 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0411_rank1_stage1.svg
[rank1]:	> Counts Sum: 3518640, Total Sum: 4458240 (78.92%), Ratio(%) per element: [83.79, 81.75, 70.27, 81.17, 78.34, 84.52, 83.21, 69.98, 69.69, 83.43, 80.01, 70.05, 82.19, 85.02, 83.93, 85.24, 69.54, 70.63, 80.74, 77.83, 75.07, 77.32, 84.59, 84.08, 83.43, 70.85, 69.91, 83.06, 79.36, 79.43, 81.03, 84.3, 83.64, 82.63, 69.4, 69.4, 83.35, 80.95, 77.18, 81.9, 80.37, 84.59, 82.12, 69.4, 70.42, 80.88, 81.54, 76.88, 80.59, 81.32, 82.84, 83.86, 70.78, 69.76, 83.64, 81.9, 80.59, 80.66, 84.37, 80.52, 81.68, 69.91, 70.63, 83.43, 79.36, 80.66, 81.97, 82.04, 82.48, 84.08, 70.27, 70.56, 83.13, 78.56, 82.63, 81.97, 84.37, 82.7, 82.7, 69.91, 70.2]
[rank0]:2026-01-03 04:11:27,631 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0411_rank0_stage0.svg
[rank0]:	> Counts Sum: 1809840, Total Sum: 4017920 (45.04%), Ratio(%) per element: [53.77, 59.01, 48.4, 55.23, 55.15, 50.0, 57.55, 63.29, 13.66, 14.46, 61.11, 16.35, 25.21, 58.64, 61.11, 60.82, 59.15, 14.89, 13.66, 44.04, 58.43, 56.32, 44.11, 60.31, 60.82, 47.81, 14.31, 14.38, 59.44, 57.12, 48.18, 58.13, 59.73, 60.31, 59.22, 13.8, 14.31, 61.04, 53.19, 35.31, 55.37, 58.79, 60.17, 61.48, 14.38, 14.68, 59.88, 50.5, 59.3, 55.3, 59.95, 61.55, 58.64, 14.24, 13.95, 55.88, 57.04, 54.79, 27.18, 59.81, 61.19, 60.24, 13.88, 14.31, 61.11, 46.43, 31.9, 14.17, 58.86, 61.26, 61.33, 14.02, 14.46]
[rank3]:2026-01-03 04:11:27,746 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0411_rank3_stage3.svg
[rank3]:	> Counts Sum: 2819840, Total Sum: 3577600 (78.82%), Ratio(%) per element: [78.99, 80.01, 76.09, 79.57, 82.34, 82.7, 82.92, 73.11, 72.89, 82.04, 77.47, 79.79, 76.38, 82.92, 82.12, 81.9, 72.74, 72.6, 79.14, 80.15, 79.57, 78.27, 82.41, 81.32, 81.25, 73.4, 73.61, 83.72, 79.14, 78.56, 79.5, 81.03, 81.54, 81.83, 73.98, 73.32, 82.55, 81.9, 75.72, 74.49, 82.77, 79.94, 82.55, 73.03, 72.96, 80.81, 80.66, 80.59, 80.95, 79.79, 82.99, 81.46, 73.03, 73.47, 81.39, 81.68, 81.68, 80.08, 81.32, 82.55, 83.79, 73.25, 73.11, 73.11, 73.03]
[rank2]:2026-01-03 04:11:29,508 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0411_stage2.svg
[rank0]:2026-01-03 04:11:29,581 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0411_stage0.svg
[rank1]:2026-01-03 04:11:29,630 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0411_stage1.svg
[rank3]:2026-01-03 04:11:29,763 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0411_stage3.svg
[rank0]:2026-01-03 04:13:02,473 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-03 04:13:04,355 - Avg. fwd time: 15.4253 / Avg. bwd time: 27.6094 / Avg. batch time: 365.5272 (ms) / GPU bubble ratio: 5.81%
[rank2]:2026-01-03 04:13:04,391 - Avg. fwd time: 14.3004 / Avg. bwd time: 24.0740 / Avg. batch time: 405.1747 (ms) / GPU bubble ratio: 24.23%
[rank0]:2026-01-03 04:13:04,439 - Avg. fwd time: 14.6712 / Avg. bwd time: 28.4777 / Avg. batch time: 478.3640 (ms) / GPU bubble ratio: 27.84%
[rank0]:2026-01-03 04:13:04,474 -  step: 1950  loss: -4.0000  grad_norm:  0.1410  memory: 69.58GiB(49.77%)  tps: 8,439  tflops: 393.61  mfu: 39.80%
[rank1]:2026-01-03 04:13:04,423 - Avg. fwd time: 16.0604 / Avg. bwd time: 26.9552 / Avg. batch time: 449.1271 (ms) / GPU bubble ratio: 23.38%
[rank1]:2026-01-03 04:13:04,470 -  step: 1950  loss: -4.0000  grad_norm:  0.1410  memory: 58.51GiB(41.85%)  tps: 8,439  tflops: 393.61  mfu: 39.80%
[rank3]:2026-01-03 04:13:04,472 -  step: 1950  loss:  0.1745  grad_norm:  0.1410  memory: 57.49GiB(41.12%)  tps: 8,439  tflops: 393.62  mfu: 39.80%
[rank2]:2026-01-03 04:13:04,465 -  step: 1950  loss: -4.0000  grad_norm:  0.1410  memory: 48.95GiB(35.01%)  tps: 8,439  tflops: 393.61  mfu: 39.80%
[rank0]:2026-01-03 04:14:36,718 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-03 04:14:38,604 - Avg. fwd time: 15.4169 / Avg. bwd time: 27.5516 / Avg. batch time: 365.0470 (ms) / GPU bubble ratio: 5.83%
[rank2]:2026-01-03 04:14:38,638 - Avg. fwd time: 14.2942 / Avg. bwd time: 24.0180 / Avg. batch time: 404.6251 (ms) / GPU bubble ratio: 24.25%
[rank0]:2026-01-03 04:14:38,686 - Avg. fwd time: 14.6657 / Avg. bwd time: 28.4426 / Avg. batch time: 477.6614 (ms) / GPU bubble ratio: 27.80%
[rank1]:2026-01-03 04:14:38,672 - Avg. fwd time: 16.0536 / Avg. bwd time: 26.9022 / Avg. batch time: 448.5063 (ms) / GPU bubble ratio: 23.38%
[rank3]:2026-01-03 04:14:38,720 -  step: 2000  loss:  0.2092  grad_norm:  0.1339  memory: 57.49GiB(41.12%)  tps: 8,692  tflops: 405.40  mfu: 40.99%
[rank3]:2026-01-03 04:14:38,721 - â„¹ï¸ final step: 2000  loss:  0.2092  grad_norm:  0.1339  tps: 8,242  tflops: 384.42  mfu: 37.71%
[rank3]:2026-01-03 04:14:38,721 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 04:14:38,713 -  step: 2000  loss: -4.0000  grad_norm:  0.1339  memory: 48.95GiB(35.01%)  tps: 8,692  tflops: 405.40  mfu: 40.99%
[rank2]:2026-01-03 04:14:38,713 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1339  tps: 8,239  tflops: 384.27  mfu: 37.70%
[rank2]:2026-01-03 04:14:38,713 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-03 04:14:38,718 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-03 04:14:38,722 -  step: 2000  loss: -4.0000  grad_norm:  0.1339  memory: 69.58GiB(49.77%)  tps: 8,692  tflops: 405.40  mfu: 40.99%
[rank0]:2026-01-03 04:14:38,722 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1339  tps: 8,238  tflops: 384.24  mfu: 37.70%
[rank0]:2026-01-03 04:14:38,722 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-03 04:14:38,727 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2026-01-03 04:14:38,718 -  step: 2000  loss: -4.0000  grad_norm:  0.1339  memory: 58.51GiB(41.85%)  tps: 8,692  tflops: 405.40  mfu: 40.99%
[rank1]:2026-01-03 04:14:38,718 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1339  tps: 8,238  tflops: 384.24  mfu: 37.70%
[rank1]:2026-01-03 04:14:38,718 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-03 04:14:38,721 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-03 04:14:38,725 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-03 04:14:49,479 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2026-01-03 04:14:49,555 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank1/260103_0414_stage1_final2000.svg
[rank0]:2026-01-03 04:14:49,559 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank0/260103_0414_stage0_final2000.svg
[rank2]:2026-01-03 04:14:49,566 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank2/260103_0414_stage2_final2000.svg
[rank3]:2026-01-03 04:14:49,641 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0414_final2000_rank3.svg
[rank3]:			> Batch Time: 455.50 ms, GPU Bubble Ratio: 26.49%, 27.76%, 35.73%, 27.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB0,B]  163-26-189ms   | [S0,MB4,F]  189-13-203ms   | [S0,MB1,B]  203-37-241ms   | [S0,MB5,F]  241-14-255ms   | [S0,MB2,B]  255-27-283ms   | [S0,MB6,F]  283-14-297ms   | [S0,MB3,B]  297-27-325ms   | [S0,MB7,F]  325-14-339ms   | [S0,MB4,B]  339-43-383ms   | [S0,MB5,B]  401-27-429ms   | [S0,MB6,B]  429-26-455ms   | [S0,MB7,B]  455-0-455ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB0,B]  141-21-162ms   | [S1,MB3,F]  162-15-178ms   | [S1,MB1,B]  179-20-200ms   | [S1,MB4,F]  203-15-218ms   | [S1,MB2,B]  219-28-248ms   | [S1,MB5,F]  255-15-271ms   | [S1,MB3,B]  271-20-292ms   | [S1,MB6,F]  297-15-313ms   | [S1,MB4,B]  313-20-334ms   | [S1,MB7,F]  339-15-355ms   | [S1,MB5,B]  355-45-400ms   | [S1,MB6,B]  401-21-422ms   | [S1,MB7,B]  426-20-447ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB0,B]  122-18-140ms   | [S2,MB2,F]  141-13-154ms   | [S2,MB1,B]  159-19-178ms   | [S2,MB3,F]  179-13-192ms   | [S2,MB2,B]  197-19-216ms   | [S2,MB4,F]  218-13-232ms   | [S2,MB3,B]  235-33-268ms   | [S2,MB5,F]  271-14-285ms   | [S2,MB4,B]  288-19-307ms   | [S2,MB6,F]  312-13-326ms   | [S2,MB5,B]  327-19-347ms   | [S2,MB7,F]  355-13-369ms   | [S2,MB6,B]  369-30-400ms   | [S2,MB7,B]  407-18-426ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB0,B]  76-45-121ms    | [S3,MB1,F]  122-14-136ms   | [S3,MB1,B]  138-20-159ms   | [S3,MB2,F]  159-14-174ms   | [S3,MB2,B]  176-20-197ms   | [S3,MB3,F]  197-14-212ms   | [S3,MB3,B]  214-20-235ms   | [S3,MB4,F]  235-14-250ms   | [S3,MB4,B]  252-35-288ms   | [S3,MB5,F]  287-15-303ms   | [S3,MB5,B]  305-20-325ms   | [S3,MB6,F]  327-14-342ms   | [S3,MB6,B]  344-20-365ms   | [S3,MB7,F]  369-14-383ms   | [S3,MB7,B]  385-20-406ms  
[rank2]:2026-01-03 04:14:49,752 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0414_rank2_stage2.svg
[rank2]:	> Counts Sum: 3118800, Total Sum: 4193280 (74.38%), Ratio(%) per element: [82.48, 78.98, 78.7, 80.83, 76.99, 85.37, 84.27, 53.64, 54.6, 83.72, 78.57, 81.66, 77.67, 84.61, 83.72, 86.6, 53.43, 54.05, 83.44, 79.73, 78.36, 81.18, 78.7, 84.68, 85.3, 54.12, 53.77, 80.49, 65.72, 71.15, 83.03, 80.56, 84.95, 85.09, 53.91, 53.84, 84.75, 76.16, 69.02, 78.91, 85.5, 85.5, 84.34, 53.7, 53.84, 83.79, 76.78, 71.22, 71.49, 85.57, 83.17, 83.92, 54.12, 53.02, 83.17, 83.37, 71.56, 65.72, 85.37, 85.02, 82.28, 52.6, 53.57, 85.3, 81.59, 53.64, 76.64, 85.09, 84.13, 84.47, 53.84, 54.67]
[rank1]:2026-01-03 04:14:49,731 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0414_rank1_stage1.svg
[rank1]:	> Counts Sum: 3726240, Total Sum: 4717440 (78.99%), Ratio(%) per element: [83.65, 81.79, 70.26, 81.31, 78.7, 84.47, 83.17, 70.12, 69.57, 83.58, 80.15, 70.26, 82.07, 84.95, 83.92, 85.3, 69.71, 70.81, 80.83, 78.15, 75.48, 77.47, 84.4, 83.92, 83.51, 70.81, 70.12, 83.17, 79.53, 79.67, 81.31, 84.27, 83.79, 82.62, 69.29, 69.57, 83.31, 80.97, 77.47, 81.93, 80.35, 84.47, 82.21, 69.57, 70.32, 80.83, 81.59, 77.19, 80.9, 81.52, 82.96, 83.79, 70.67, 69.78, 83.65, 82.07, 80.83, 80.9, 84.2, 80.63, 81.79, 69.84, 70.81, 83.37, 79.39, 80.9, 82.0, 82.21, 82.48, 84.13, 70.19, 70.53, 83.03, 78.77, 82.62, 82.14, 84.2, 82.48, 82.76, 69.98, 70.26]
[rank0]:2026-01-03 04:14:49,733 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0414_rank0_stage0.svg
[rank0]:	> Counts Sum: 1915440, Total Sum: 4251520 (45.05%), Ratio(%) per element: [53.98, 59.06, 48.96, 55.42, 55.01, 50.13, 57.41, 62.7, 13.73, 14.35, 60.64, 16.14, 24.51, 58.85, 60.85, 60.57, 58.58, 14.76, 13.59, 44.84, 58.37, 56.31, 44.84, 60.23, 60.16, 48.35, 14.21, 14.28, 59.4, 56.66, 48.55, 57.82, 59.82, 60.5, 58.99, 13.8, 14.21, 60.85, 53.84, 36.12, 55.63, 58.72, 59.75, 61.46, 14.42, 14.62, 59.68, 51.37, 58.65, 55.35, 59.82, 61.33, 58.31, 14.21, 13.87, 55.9, 56.52, 54.87, 28.91, 59.47, 60.85, 60.23, 13.8, 14.28, 60.92, 46.9, 32.48, 16.27, 58.58, 60.92, 60.71, 13.94, 14.35]
[rank3]:2026-01-03 04:14:49,776 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/pipeline_schedule/260103_0414_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 498.96 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB0,B]  151-30-181ms   | [S0,MB4,F]  181-15-196ms   | [S0,MB1,B]  196-30-226ms   | [S0,MB5,F]  226-15-241ms   | [S0,MB2,B]  241-30-272ms   | [S0,MB6,F]  272-15-287ms   | [S0,MB3,B]  287-30-317ms   | [S0,MB7,F]  317-15-332ms   | [S0,MB4,B]  332-30-362ms   | [S0,MB5,B]  377-30-408ms   | [S0,MB6,B]  423-30-453ms   | [S0,MB7,B]  468-30-498ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB0,B]  120-30-151ms   | [S1,MB3,F]  151-15-166ms   | [S1,MB1,B]  166-30-196ms   | [S1,MB4,F]  196-15-211ms   | [S1,MB2,B]  211-30-241ms   | [S1,MB5,F]  241-15-257ms   | [S1,MB3,B]  257-30-287ms   | [S1,MB6,F]  287-15-302ms   | [S1,MB4,B]  302-30-332ms   | [S1,MB7,F]  332-15-347ms   | [S1,MB5,B]  347-30-377ms   | [S1,MB6,B]  393-30-423ms   | [S1,MB7,B]  438-30-468ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB0,B]  90-30-120ms    | [S2,MB2,F]  120-15-136ms   | [S2,MB1,B]  136-30-166ms   | [S2,MB3,F]  166-15-181ms   | [S2,MB2,B]  181-30-211ms   | [S2,MB4,F]  211-15-226ms   | [S2,MB3,B]  226-30-257ms   | [S2,MB5,F]  257-15-272ms   | [S2,MB4,B]  272-30-302ms   | [S2,MB6,F]  302-15-317ms   | [S2,MB5,B]  317-30-347ms   | [S2,MB7,F]  347-15-362ms   | [S2,MB6,B]  362-30-393ms   | [S2,MB7,B]  408-30-438ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB0,B]  60-30-90ms     | [S3,MB1,F]  90-15-105ms    | [S3,MB1,B]  105-30-136ms   | [S3,MB2,F]  136-15-151ms   | [S3,MB2,B]  151-30-181ms   | [S3,MB3,F]  181-15-196ms   | [S3,MB3,B]  196-30-226ms   | [S3,MB4,F]  226-15-241ms   | [S3,MB4,B]  241-30-272ms   | [S3,MB5,F]  272-15-287ms   | [S3,MB5,B]  287-30-317ms   | [S3,MB6,F]  317-15-332ms   | [S3,MB6,B]  332-30-362ms   | [S3,MB7,F]  362-15-377ms   | [S3,MB7,B]  377-30-408ms  
[rank3]:2026-01-03 04:14:49,822 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_ratio_history/rank3/260103_0414_stage3_final2000.svg
[rank3]:2026-01-03 04:14:49,998 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/frozen_params_histogram/260103_0414_rank3_stage3.svg
[rank3]:	> Counts Sum: 2986240, Total Sum: 3785600 (78.88%), Ratio(%) per element: [79.32, 80.28, 76.51, 79.67, 82.34, 82.69, 83.17, 73.21, 73.0, 81.86, 77.4, 80.01, 76.3, 82.76, 82.07, 81.79, 72.87, 72.73, 79.25, 80.42, 79.73, 78.57, 82.28, 81.31, 81.25, 73.48, 73.76, 83.58, 79.25, 78.57, 79.8, 81.11, 81.59, 81.79, 74.03, 73.42, 82.55, 81.93, 76.09, 74.51, 82.48, 79.87, 82.34, 73.14, 73.07, 80.97, 80.83, 80.63, 81.25, 80.01, 82.89, 81.31, 73.14, 73.55, 81.38, 81.73, 81.66, 80.35, 81.18, 82.48, 83.72, 73.35, 73.21, 73.21, 73.14]
[rank1]:2026-01-03 04:14:51,817 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0414_stage1.svg
[rank1]:2026-01-03 04:14:51,825 - Destroying the purge thread.
[rank0]:2026-01-03 04:14:51,928 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0414_stage0.svg
[rank0]:2026-01-03 04:14:51,932 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-03 04:14:52,164 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0414_stage2.svg
[rank2]:2026-01-03 04:14:52,172 - Destroying the purge thread.
[rank3]:2026-01-03 04:14:52,280 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200/afr_time_plot/260103_0414_stage3.svg
[rank3]:2026-01-03 04:14:52,287 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 1.98779
[rank3]:wandb:               final/avg_loss 0.20916
[rank3]:wandb:             final/avg_mfu(%) 37.71052
[rank3]:wandb:             final/avg_tflops 384.42387
[rank3]:wandb:    final/avg_throughput(tps) 8242.3358
[rank3]:wandb:              final/grad_norm 0.13389
[rank3]:wandb:               final/max_loss 0.20916
[rank3]:wandb:                    grad_norm 0.13389
[rank3]:wandb: loss_metrics/global_avg_loss 0.20916
[rank3]:wandb: loss_metrics/global_max_loss 0.20916
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_1F1B_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/rlr7zidy
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_1F1B_timelyapf_h200/20260103-0306/wandb/run-20260103_030642-rlr7zidy/logs
[rank0]:2026-01-03 04:14:53,933 - Training completed
[rank0]:2026-01-03 04:14:53,933 - Destroying the purge thread.
[rank1]:2026-01-03 04:14:54,150 - Process group destroyed
[rank3]:2026-01-03 04:14:54,157 - Process group destroyed
[rank2]:2026-01-03 04:14:54,174 - Process group destroyed
[rank0]:2026-01-03 04:14:54,286 - Process group destroyed
[rank1]:[W103 04:14:55.961186874 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:[W103 04:14:55.024423098 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W103 04:14:55.159483527 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W103 04:14:55.255258906 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:Stage 1: Modules to keep: {'layers.9', 'layers.10', 'layers.8', 'layers.12', 'layers.14', 'layers.11', 'layers.15', 'layers.16', 'layers.13'}
[rank0]:Stage 0: Modules to keep: {'layers.5', 'layers.2', 'layers.3', 'layers.4', 'tok_embeddings', 'layers.7', 'layers.6', 'layers.1', 'layers.0'}
[rank2]:Stage 2: Modules to keep: {'layers.17', 'layers.23', 'layers.20', 'layers.22', 'layers.19', 'layers.24', 'layers.18', 'layers.21'}
[rank3]:Stage 3: Modules to keep: {'layers.27', 'layers.30', 'output', 'layers.31', 'layers.29', 'layers.28', 'layers.26', 'norm', 'layers.25'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_1F1B_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_1F1B_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_1F1B_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_1F1B_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_1F1B_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_1F1B_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: 1F1B
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_1F1B_timelyapf_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_1F1B_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.0001
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W103 04:15:01.356423677 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
