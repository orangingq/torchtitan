
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Jan  2 19:19:09 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_GPipe_timelyapf.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with timelyapf x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=timelyapf --freezing.threshold=0.0001 --freezing.max_freeze_ratio=0.8 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0102 19:19:11.145000 2888813 site-packages/torch/distributed/run.py:803] 
W0102 19:19:11.145000 2888813 site-packages/torch/distributed/run.py:803] *****************************************
W0102 19:19:11.145000 2888813 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0102 19:19:11.145000 2888813 site-packages/torch/distributed/run.py:803] *****************************************
[rank1]:2026-01-02 19:19:17,678 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank1]:2026-01-02 19:19:18,008 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-02 19:19:18,010 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-02 19:19:18,015 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 19:19:18,508 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank2]:2026-01-02 19:19:18,459 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank0]:2026-01-02 19:19:19,021 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-02 19:19:19,023 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-02 19:19:19,029 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-02 19:19:19,029 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 19:19:19,031 - Loading tokenizer from tokenizer.json
[rank3]:2026-01-02 19:19:18,994 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:2026-01-02 19:19:18,976 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-02 19:19:18,978 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-02 19:19:18,983 - Deterministic algorithm enabled (expect perf degradation).
[rank3]:"
[rank3]:2026-01-02 19:19:19,301 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-02 19:19:19,303 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-02 19:19:19,308 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 19:19:19,374 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank2]:2026-01-02 19:19:21,421 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 19:19:21,520 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank2]:2026-01-02 19:19:21,502 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-02 19:19:21,502 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2026-01-02 19:19:21,735 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-02 19:19:21,735 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank0]:2026-01-02 19:19:21,763 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 19:19:21,817 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-02 19:19:21,839 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-02 19:19:21,840 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2026-01-02 19:19:22,077 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-02 19:19:22,077 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run xxt1ek4d
[rank1]:2026-01-02 19:19:23,449 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_timelyapf_h200/20260102-1919/wandb/run-20260102_191922-xxt1ek4d
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_GPipe_timelyapf_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/xxt1ek4d
[rank1]:2026-01-02 19:19:23,522 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-02 19:19:23,523 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2026-01-02 19:19:23,515 - WandB logging enabled
[rank3]:2026-01-02 19:19:23,516 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-02 19:19:23,589 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-02 19:19:23,589 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-02 19:19:23,756 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-02 19:19:23,756 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2026-01-02 19:19:23,828 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_timelyapf_h200
[rank0]:2026-01-02 19:19:23,828 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 19:19:23,828 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-02 19:19:23,836 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank2]:2026-01-02 19:19:23,836 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-02 19:19:23,828 - Mixed precision training with TP or PP is handled by autocast
[rank3]:2026-01-02 19:19:23,817 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-02 19:19:23,817 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2026-01-02 19:19:23,828 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 19:19:35,701 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-02 19:19:35,702 - Finished loading the checkpoint in 11.87 seconds.
[rank0]:2026-01-02 19:19:35,702 - Training starts at step 1
[rank0]:2026-01-02 19:19:40,433 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.18GiB(39.46%)  tps: 880  tflops: 41.05  mfu: 4.15%
[rank0]:2026-01-02 19:19:40,433 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-02 19:19:40,407 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.30GiB(35.26%)  tps: 866  tflops: 40.37  mfu: 4.08%
[rank2]:2026-01-02 19:19:40,407 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-02 19:19:40,410 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.37GiB(39.61%)  tps: 969  tflops: 45.18  mfu: 4.57%
[rank1]:2026-01-02 19:19:40,411 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-02 19:19:40,415 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 61.09GiB(43.70%)  tps: 972  tflops: 45.36  mfu: 4.59%
[rank3]:2026-01-02 19:19:40,416 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 19:21:59,054 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:22:01,810 - Avg. fwd time: 15.3988 / Avg. bwd time: 46.0481 / Avg. batch time: 510.3173 (ms) / GPU bubble ratio: 3.67%
[rank1]:2026-01-02 19:22:01,905 - Avg. fwd time: 16.2361 / Avg. bwd time: 45.5200 / Avg. batch time: 638.2585 (ms) / GPU bubble ratio: 22.59%
[rank2]:2026-01-02 19:22:01,855 - Avg. fwd time: 14.2915 / Avg. bwd time: 40.2343 / Avg. batch time: 570.3134 (ms) / GPU bubble ratio: 23.51%
[rank1]:2026-01-02 19:22:01,985 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 70.00GiB(50.07%)  tps: 5,671  tflops: 264.48  mfu: 26.74%
[rank2]:2026-01-02 19:22:01,983 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 62.32GiB(44.58%)  tps: 5,671  tflops: 264.48  mfu: 26.74%
[rank3]:2026-01-02 19:22:01,988 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 76.42GiB(54.66%)  tps: 5,671  tflops: 264.49  mfu: 26.74%
[rank0]:2026-01-02 19:22:01,953 - Avg. fwd time: 14.9975 / Avg. bwd time: 42.8417 / Avg. batch time: 701.6906 (ms) / GPU bubble ratio: 34.06%
[rank0]:2026-01-02 19:22:01,989 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 72.15GiB(51.60%)  tps: 5,671  tflops: 264.51  mfu: 26.75%
[rank0]:2026-01-02 19:24:23,497 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:24:26,237 - Avg. fwd time: 15.3584 / Avg. bwd time: 46.1158 / Avg. batch time: 509.6734 (ms) / GPU bubble ratio: 3.51%
[rank2]:2026-01-02 19:24:26,283 - Avg. fwd time: 14.2884 / Avg. bwd time: 40.3326 / Avg. batch time: 569.2396 (ms) / GPU bubble ratio: 23.24%
[rank1]:2026-01-02 19:24:26,332 - Avg. fwd time: 16.2153 / Avg. bwd time: 45.5739 / Avg. batch time: 636.6190 (ms) / GPU bubble ratio: 22.35%
[rank2]:2026-01-02 19:24:26,409 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 62.32GiB(44.58%)  tps: 5,672  tflops: 264.55  mfu: 26.75%
[rank2]:2026-01-02 19:24:26,409 - Nothing to draw before the end of warmup.
[rank1]:2026-01-02 19:24:26,411 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 70.00GiB(50.07%)  tps: 5,672  tflops: 264.55  mfu: 26.75%
[rank1]:2026-01-02 19:24:26,411 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 19:24:26,380 - Avg. fwd time: 14.8782 / Avg. bwd time: 42.9618 / Avg. batch time: 699.6626 (ms) / GPU bubble ratio: 33.87%
[rank0]:2026-01-02 19:24:26,415 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 72.15GiB(51.60%)  tps: 5,672  tflops: 264.55  mfu: 26.75%
[rank0]:2026-01-02 19:24:26,415 - Nothing to draw before the end of warmup.
[rank3]:2026-01-02 19:24:26,413 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 76.42GiB(54.66%)  tps: 5,672  tflops: 264.55  mfu: 26.75%
[rank3]:2026-01-02 19:24:26,414 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 19:26:47,852 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:26:50,597 - Avg. fwd time: 15.3172 / Avg. bwd time: 46.1575 / Avg. batch time: 509.3838 (ms) / GPU bubble ratio: 3.45%
[rank2]:2026-01-02 19:26:50,644 - Avg. fwd time: 14.2665 / Avg. bwd time: 40.3995 / Avg. batch time: 568.8241 (ms) / GPU bubble ratio: 23.12%
[rank1]:2026-01-02 19:26:50,694 - Avg. fwd time: 16.1896 / Avg. bwd time: 45.6096 / Avg. batch time: 635.9856 (ms) / GPU bubble ratio: 22.26%
[rank1]:2026-01-02 19:26:50,774 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 70.00GiB(50.07%)  tps: 5,675  tflops: 264.66  mfu: 26.76%
[rank2]:2026-01-02 19:26:50,772 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 62.32GiB(44.58%)  tps: 5,675  tflops: 264.66  mfu: 26.76%
[rank0]:2026-01-02 19:26:50,742 - Avg. fwd time: 14.8345 / Avg. bwd time: 43.0205 / Avg. batch time: 698.9126 (ms) / GPU bubble ratio: 33.78%
[rank0]:2026-01-02 19:26:50,778 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 72.15GiB(51.60%)  tps: 5,675  tflops: 264.66  mfu: 26.76%
[rank3]:2026-01-02 19:26:50,777 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 76.42GiB(54.66%)  tps: 5,675  tflops: 264.67  mfu: 26.76%
[rank3]:2026-01-02 19:27:16,495 - [Step 160] ã€°ï¸ Monitoring Upperbound
[rank3]:2026-01-02 19:27:45,347 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank2]:2026-01-02 19:27:45,426 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank1]:2026-01-02 19:27:45,473 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank0]:2026-01-02 19:27:45,518 - [Step 170] â³ Monitoring Upperbound... (676/686)
[rank3]:2026-01-02 19:28:14,376 - [Step 180] âœ”ï¸  Setting Upperbound
[rank3]:2026-01-02 19:28:14,588 - [Step 180] ã€°ï¸ Monitoring Lowerbound
[rank3]:2026-01-02 19:28:48,380 - [Step 200] âœ”ï¸  Setting Lowerbound
[rank1]:2026-01-02 19:28:48,486 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 19:28:48,496 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.13/0.13, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 19:28:48,460 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:28:48,489 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.25/0.25, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 19:28:48,614 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1928_max_batch_time.svg
[rank3]:			> Batch Time: 677.89 ms, GPU Bubble Ratio: 31.52%, 26.91%, 35.33%, 27.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  308-42-351ms   | [S0,MB1,B]  355-43-398ms   | [S0,MB2,B]  402-43-445ms   | [S0,MB3,B]  448-43-491ms   | [S0,MB4,B]  495-43-538ms   | [S0,MB5,B]  541-43-585ms   | [S0,MB6,B]  588-43-631ms   | [S0,MB7,B]  634-43-677ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-84ms     | [S1,MB4,F]  84-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-131ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  262-45-308ms   | [S1,MB1,B]  309-45-355ms   | [S1,MB2,B]  356-45-402ms   | [S1,MB3,B]  402-45-448ms   | [S1,MB4,B]  449-46-495ms   | [S1,MB5,B]  495-46-541ms   | [S1,MB6,B]  542-46-588ms   | [S1,MB7,B]  588-46-634ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  68-13-82ms     | [S2,MB3,F]  84-13-97ms     | [S2,MB4,F]  99-13-113ms    | [S2,MB5,F]  115-13-129ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  222-40-262ms   | [S2,MB1,B]  269-40-309ms   | [S2,MB2,B]  315-40-356ms   | [S2,MB3,B]  361-40-402ms   | [S2,MB4,B]  408-40-449ms   | [S2,MB5,B]  454-40-495ms   | [S2,MB6,B]  501-40-542ms   | [S2,MB7,B]  547-40-588ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  74-14-88ms     | [S3,MB2,F]  88-14-102ms    | [S3,MB3,F]  102-14-117ms   | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-161ms   | [S3,MB7,F]  161-14-176ms   | [S3,MB0,B]  176-46-222ms   AFR(10):0.9846 | [S3,MB1,B]  222-46-269ms   AFR(10):0.9846 | [S3,MB2,B]  269-46-315ms   AFR(10):0.9846 | [S3,MB3,B]  315-46-361ms   AFR(10):0.9846 | [S3,MB4,B]  361-46-408ms   AFR(10):0.9846 | [S3,MB5,B]  408-46-454ms   AFR(10):0.9846 | [S3,MB6,B]  454-46-501ms   AFR(10):0.9846 | [S3,MB7,B]  501-46-547ms   AFR(10):0.9846
[rank3]:2026-01-02 19:28:48,735 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1928_min_batch_time.svg
[rank3]:			> Batch Time: 385.14 ms, GPU Bubble Ratio: 69.39%, 23.07%, 32.11%, 24.72%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  236-0-236ms    | [S0,MB1,B]  257-0-257ms    | [S0,MB2,B]  279-0-279ms    | [S0,MB3,B]  300-0-300ms    | [S0,MB4,B]  321-0-321ms    | [S0,MB5,B]  342-0-342ms    | [S0,MB6,B]  364-0-364ms    | [S0,MB7,B]  385-0-385ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-84ms     | [S1,MB4,F]  84-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-131ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  216-20-236ms   | [S1,MB1,B]  237-20-257ms   | [S1,MB2,B]  258-20-279ms   | [S1,MB3,B]  279-20-300ms   | [S1,MB4,B]  300-21-321ms   | [S1,MB5,B]  321-21-342ms   | [S1,MB6,B]  342-21-364ms   | [S1,MB7,B]  364-21-385ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  68-13-82ms     | [S2,MB3,F]  84-13-97ms     | [S2,MB4,F]  99-13-113ms    | [S2,MB5,F]  115-13-129ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  197-18-216ms   | [S2,MB1,B]  218-18-237ms   | [S2,MB2,B]  239-18-258ms   | [S2,MB3,B]  260-18-279ms   | [S2,MB4,B]  282-18-300ms   | [S2,MB5,B]  303-18-321ms   | [S2,MB6,B]  324-18-342ms   | [S2,MB7,B]  345-18-363ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  74-14-88ms     | [S3,MB2,F]  88-14-102ms    | [S3,MB3,F]  102-14-117ms   | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-161ms   | [S3,MB7,F]  161-14-176ms   | [S3,MB0,B]  176-21-197ms   AFR(10):0.9846 | [S3,MB1,B]  197-21-218ms   AFR(10):0.9846 | [S3,MB2,B]  218-21-239ms   AFR(10):0.9846 | [S3,MB3,B]  239-21-260ms   AFR(10):0.9846 | [S3,MB4,B]  260-21-282ms   AFR(10):0.9846 | [S3,MB5,B]  282-20-303ms   AFR(10):0.9846 | [S3,MB6,B]  303-21-324ms   AFR(10):0.9846 | [S3,MB7,B]  324-21-345ms   AFR(10):0.9846
[rank3]:2026-01-02 19:28:48,886 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1928_frozen_pipeline_schedule.svg
[rank3]:			> Batch Time: 425.21 ms, GPU Bubble Ratio: 34.24%, 21.06%, 28.25%, 22.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  263-42-306ms   | [S0,MB1,B]  306-43-349ms   | [S0,MB2,B]  349-43-392ms   | [S0,MB3,B]  392-32-425ms   | [S0,MB4,B]  425-0-425ms    | [S0,MB5,B]  425-0-425ms    | [S0,MB6,B]  425-0-425ms    | [S0,MB7,B]  425-0-425ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  37-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-84ms     | [S1,MB4,F]  84-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-131ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  218-45-263ms   | [S1,MB1,B]  263-35-299ms   | [S1,MB2,B]  299-20-319ms   | [S1,MB3,B]  319-20-340ms   | [S1,MB4,B]  340-21-361ms   | [S1,MB5,B]  361-21-382ms   | [S1,MB6,B]  382-21-404ms   | [S1,MB7,B]  404-21-425ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  68-13-82ms     | [S2,MB3,F]  84-13-97ms     | [S2,MB4,F]  99-13-113ms    | [S2,MB5,F]  115-13-129ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  199-18-218ms   | [S2,MB1,B]  220-40-261ms   | [S2,MB2,B]  261-37-299ms   | [S2,MB3,B]  299-20-319ms   | [S2,MB4,B]  322-18-340ms   | [S2,MB5,B]  343-18-361ms   | [S2,MB6,B]  364-18-382ms   | [S2,MB7,B]  385-18-404ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  74-14-88ms     | [S3,MB2,F]  88-14-102ms    | [S3,MB3,F]  102-14-117ms   | [S3,MB4,F]  117-14-131ms   | [S3,MB5,F]  131-14-146ms   | [S3,MB6,F]  146-14-161ms   | [S3,MB7,F]  161-14-176ms   | [S3,MB0,B]  176-23-199ms   AFR(10):0.9846 | [S3,MB1,B]  199-21-220ms   AFR(10):0.9846 | [S3,MB2,B]  220-34-254ms   AFR(10):0.9846 | [S3,MB3,B]  254-21-275ms   AFR(10):0.9846 | [S3,MB4,B]  275-46-322ms   AFR(10):0.9846 | [S3,MB5,B]  322-20-343ms   AFR(10):0.9846 | [S3,MB6,B]  343-21-364ms   AFR(10):0.9846 | [S3,MB7,B]  364-21-385ms   AFR(10):0.9846
[rank3]:2026-01-02 19:28:48,887 - 	> Batch Time: 425.21 ms (Average Freeze Ratio: 0.72, Time Reduction Rate: 0.37)
[rank3]:2026-01-02 19:28:48,893 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 19:28:50,797 - Avg. fwd time: 15.2821 / Avg. bwd time: 43.5672 / Avg. batch time: 488.2318 (ms) / GPU bubble ratio: 3.57%
[rank1]:2026-01-02 19:28:50,885 - Avg. fwd time: 16.1768 / Avg. bwd time: 43.0577 / Avg. batch time: 610.3913 (ms) / GPU bubble ratio: 22.37%
[rank2]:2026-01-02 19:28:50,823 - Avg. fwd time: 14.2459 / Avg. bwd time: 38.1572 / Avg. batch time: 545.7085 (ms) / GPU bubble ratio: 23.18%
[rank0]:2026-01-02 19:28:50,889 - Avg. fwd time: 14.7945 / Avg. bwd time: 38.6231 / Avg. batch time: 668.6495 (ms) / GPU bubble ratio: 36.09%
[rank0]:2026-01-02 19:28:50,924 -  step: 200  loss: -4.0000  grad_norm:  7.3976  memory: 80.61GiB(57.65%)  tps: 6,818  tflops: 318.01  mfu: 32.15%
[rank3]:2026-01-02 19:28:50,924 -  step: 200  loss:  0.8740  grad_norm:  7.3976  memory: 84.06GiB(60.12%)  tps: 6,818  tflops: 318.02  mfu: 32.16%
[rank1]:2026-01-02 19:28:50,920 -  step: 200  loss: -4.0000  grad_norm:  7.3976  memory: 77.31GiB(55.29%)  tps: 6,818  tflops: 318.01  mfu: 32.15%
[rank1]:2026-01-02 19:28:50,992 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1928_stage1_step200.svg
[rank2]:2026-01-02 19:28:50,918 -  step: 200  loss: -4.0000  grad_norm:  7.3976  memory: 68.83GiB(49.23%)  tps: 6,818  tflops: 318.01  mfu: 32.15%
[rank2]:2026-01-02 19:28:50,989 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1928_stage2_step200.svg
[rank0]:2026-01-02 19:28:50,983 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1928_stage0_step200.svg
[rank3]:2026-01-02 19:28:51,055 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1928_step200_rank3.svg
[rank3]:			> Batch Time: 405.75 ms, GPU Bubble Ratio: 71.26%, 26.61%, 35.31%, 28.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB4,F]  59-13-73ms     | [S0,MB5,F]  73-14-87ms     | [S0,MB6,F]  87-14-101ms    | [S0,MB7,F]  102-14-116ms   | [S0,MB0,B]  256-0-256ms    | [S0,MB1,B]  277-0-277ms    | [S0,MB2,B]  298-0-298ms    | [S0,MB3,B]  319-0-319ms    | [S0,MB4,B]  341-0-341ms    | [S0,MB5,B]  362-0-362ms    | [S0,MB6,B]  384-0-384ms    | [S0,MB7,B]  405-0-405ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  134-15-149ms   | [S1,MB0,B]  234-20-255ms   | [S1,MB1,B]  256-20-277ms   | [S1,MB2,B]  277-20-298ms   | [S1,MB3,B]  298-20-319ms   | [S1,MB4,B]  319-21-341ms   | [S1,MB5,B]  341-21-362ms   | [S1,MB6,B]  362-21-383ms   | [S1,MB7,B]  384-21-405ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  215-18-234ms   | [S2,MB1,B]  237-18-255ms   | [S2,MB2,B]  258-18-277ms   | [S2,MB3,B]  279-18-298ms   | [S2,MB4,B]  300-18-319ms   | [S2,MB5,B]  321-18-340ms   | [S2,MB6,B]  343-18-361ms   | [S2,MB7,B]  364-18-383ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  143-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-14-191ms   | [S3,MB0,B]  193-21-215ms   | [S3,MB1,B]  215-21-236ms   | [S3,MB2,B]  236-21-257ms   | [S3,MB3,B]  257-21-279ms   | [S3,MB4,B]  279-21-300ms   | [S3,MB5,B]  300-21-321ms   | [S3,MB6,B]  321-21-342ms   | [S3,MB7,B]  342-21-363ms  
[rank3]:2026-01-02 19:28:51,102 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1928_stage3_step200.svg
[rank1]:2026-01-02 19:28:51,181 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1928_rank1_stage1.svg
[rank1]:	> Counts Sum: 51840, Total Sum: 51840 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank2]:2026-01-02 19:28:51,171 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1928_rank2_stage2.svg
[rank2]:	> Counts Sum: 46080, Total Sum: 46080 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-02 19:28:51,165 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1928_rank0_stage0.svg
[rank0]:	> Counts Sum: 46720, Total Sum: 46720 (100.00%), Ratio(%) per element: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]
[rank0]:2026-01-02 19:28:51,202 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1928_stage0.svg
[rank3]:2026-01-02 19:28:51,276 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1928_rank3_stage3.svg
[rank3]:	> Counts Sum: 40960, Total Sum: 41600 (98.46%), Ratio(%) per element: [100.0, 100.0, 87.5, 93.75, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 93.75, 100.0, 100.0, 100.0, 93.75, 100.0, 100.0, 93.75, 93.75, 100.0, 100.0, 100.0, 87.5, 93.75, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 93.75, 100.0]
[rank1]:2026-01-02 19:28:51,220 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1928_stage1.svg
[rank2]:2026-01-02 19:28:51,209 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1928_stage2.svg
[rank3]:2026-01-02 19:28:51,316 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1928_stage3.svg
[rank0]:2026-01-02 19:30:46,111 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 19:30:46,168 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.17/0.25, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank1]:2026-01-02 19:30:46,164 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.27/0.40, [MB2] 0.67/1.00, [MB3] 0.67/1.00, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.67/1.00
[rank2]:2026-01-02 19:30:46,154 - Current/Expected Freeze Ratio per Block: [MB0] 0.67/1.00, [MB1] 0.00/0.00, [MB2] 0.09/0.13, [MB3] 0.60/0.90, [MB4] 0.67/1.00, [MB5] 0.67/1.00, [MB6] 0.66/1.00, [MB7] 0.67/1.00
[rank3]:2026-01-02 19:30:46,164 - Current/Expected Freeze Ratio per Block: [MB0] 0.61/0.91, [MB1] 0.67/1.00, [MB2] 0.33/0.49, [MB3] 0.67/1.00, [MB4] 0.00/0.00, [MB5] 0.67/1.00, [MB6] 0.67/1.00, [MB7] 0.66/1.00
[rank3]:2026-01-02 19:30:48,319 - Avg. fwd time: 15.2618 / Avg. bwd time: 41.5378 / Avg. batch time: 471.7462 (ms) / GPU bubble ratio: 3.68%
[rank2]:2026-01-02 19:30:48,345 - Avg. fwd time: 14.2346 / Avg. bwd time: 36.1690 / Avg. batch time: 526.4230 (ms) / GPU bubble ratio: 23.40%
[rank1]:2026-01-02 19:30:48,378 - Avg. fwd time: 16.1677 / Avg. bwd time: 40.5436 / Avg. batch time: 589.3631 (ms) / GPU bubble ratio: 23.02%
[rank0]:2026-01-02 19:30:48,417 - Avg. fwd time: 14.7849 / Avg. bwd time: 37.2810 / Avg. batch time: 647.0428 (ms) / GPU bubble ratio: 35.63%
[rank0]:2026-01-02 19:30:48,452 -  step: 250  loss: -4.0000  grad_norm:  1.4598  memory: 80.61GiB(57.65%)  tps: 6,970  tflops: 325.09  mfu: 32.87%
[rank2]:2026-01-02 19:30:48,446 -  step: 250  loss: -4.0000  grad_norm:  1.4598  memory: 68.83GiB(49.23%)  tps: 6,970  tflops: 325.10  mfu: 32.87%
[rank1]:2026-01-02 19:30:48,448 -  step: 250  loss: -4.0000  grad_norm:  1.4598  memory: 77.33GiB(55.31%)  tps: 6,970  tflops: 325.10  mfu: 32.87%
[rank3]:2026-01-02 19:30:48,452 -  step: 250  loss:  0.2745  grad_norm:  1.4598  memory: 84.06GiB(60.12%)  tps: 6,970  tflops: 325.10  mfu: 32.87%
[rank0]:2026-01-02 19:32:38,373 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:32:38,436 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 19:32:38,442 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.25/0.25, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 19:32:38,428 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.13/0.13, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-02 19:32:38,437 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 19:32:40,398 - Avg. fwd time: 15.2492 / Avg. bwd time: 39.3368 / Avg. batch time: 453.9784 (ms) / GPU bubble ratio: 3.81%
[rank0]:2026-01-02 19:32:40,494 - Avg. fwd time: 14.7860 / Avg. bwd time: 36.2258 / Avg. batch time: 628.0390 (ms) / GPU bubble ratio: 35.02%
[rank2]:2026-01-02 19:32:40,428 - Avg. fwd time: 14.2276 / Avg. bwd time: 34.3015 / Avg. batch time: 506.2862 (ms) / GPU bubble ratio: 23.32%
[rank1]:2026-01-02 19:32:40,487 - Avg. fwd time: 16.1623 / Avg. bwd time: 38.2583 / Avg. batch time: 570.6907 (ms) / GPU bubble ratio: 23.71%
[rank3]:2026-01-02 19:32:40,529 -  step: 300  loss:  0.2902  grad_norm:  0.6226  memory: 84.06GiB(60.12%)  tps: 7,309  tflops: 340.91  mfu: 34.47%
[rank0]:2026-01-02 19:32:40,530 -  step: 300  loss: -4.0000  grad_norm:  0.6226  memory: 80.61GiB(57.65%)  tps: 7,309  tflops: 340.90  mfu: 34.47%
[rank0]:2026-01-02 19:32:40,582 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1932_stage0_step300.svg
[rank2]:2026-01-02 19:32:40,524 -  step: 300  loss: -4.0000  grad_norm:  0.6226  memory: 68.83GiB(49.23%)  tps: 7,309  tflops: 340.90  mfu: 34.47%
[rank1]:2026-01-02 19:32:40,526 -  step: 300  loss: -4.0000  grad_norm:  0.6226  memory: 77.35GiB(55.32%)  tps: 7,309  tflops: 340.90  mfu: 34.47%
[rank2]:2026-01-02 19:32:40,577 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1932_stage2_step300.svg
[rank1]:2026-01-02 19:32:40,580 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1932_stage1_step300.svg
[rank3]:2026-01-02 19:32:40,660 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1932_step300_rank3.svg
[rank3]:			> Batch Time: 522.22 ms, GPU Bubble Ratio: 31.65%, 35.72%, 41.74%, 36.82%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  282-42-325ms   | [S0,MB1,B]  325-43-368ms   | [S0,MB2,B]  368-43-412ms   | [S0,MB3,B]  412-36-449ms   | [S0,MB4,B]  449-22-472ms   | [S0,MB5,B]  472-9-481ms    | [S0,MB6,B]  482-17-499ms   | [S0,MB7,B]  500-21-522ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  282-31-313ms   | [S1,MB2,B]  315-21-337ms   | [S1,MB3,B]  337-21-359ms   | [S1,MB4,B]  368-21-389ms   | [S1,MB5,B]  412-22-434ms   | [S1,MB6,B]  449-20-469ms   | [S1,MB7,B]  472-22-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  117-13-130ms   | [S2,MB6,F]  133-13-146ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  217-19-236ms   | [S2,MB1,B]  239-40-279ms   | [S2,MB2,B]  279-35-315ms   | [S2,MB3,B]  315-19-335ms   | [S2,MB4,B]  338-19-357ms   | [S2,MB5,B]  359-18-378ms   | [S2,MB6,B]  381-18-400ms   | [S2,MB7,B]  412-18-430ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-22-216ms   | [S3,MB1,B]  216-21-238ms   | [S3,MB2,B]  238-32-270ms   | [S3,MB3,B]  270-21-291ms   | [S3,MB4,B]  292-46-338ms   | [S3,MB5,B]  338-21-359ms   | [S3,MB6,B]  359-21-381ms   | [S3,MB7,B]  380-21-402ms  
[rank3]:2026-01-02 19:32:40,701 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1932_stage3_step300.svg
[rank0]:2026-01-02 19:32:40,764 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1932_rank0_stage0.svg
[rank0]:	> Counts Sum: 133600, Total Sum: 280320 (47.66%), Ratio(%) per element: [37.5, 48.95, 36.45, 36.45, 59.37, 60.41, 48.95, 56.25, 35.41, 38.54, 52.08, 56.25, 41.66, 43.75, 54.16, 35.41, 62.5, 37.5, 33.33, 48.95, 37.5, 41.66, 56.25, 52.08, 65.62, 33.33, 39.58, 38.54, 52.08, 57.29, 56.25, 45.83, 62.5, 63.54, 62.5, 35.41, 36.45, 60.41, 40.62, 35.41, 44.79, 59.37, 58.33, 60.41, 31.25, 40.62, 39.58, 43.75, 52.08, 59.37, 60.41, 46.87, 45.83, 36.45, 40.62, 43.75, 55.2, 33.33, 35.41, 61.45, 63.54, 63.54, 36.45, 41.66, 62.5, 36.45, 37.5, 36.45, 43.75, 66.66, 62.5, 38.54, 43.75]
[rank2]:2026-01-02 19:32:40,747 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1932_rank2_stage2.svg
[rank2]:	> Counts Sum: 167520, Total Sum: 276480 (60.59%), Ratio(%) per element: [72.91, 58.33, 42.7, 46.87, 50.0, 79.16, 79.16, 44.79, 45.83, 80.2, 68.75, 44.79, 48.95, 65.62, 72.91, 72.91, 44.79, 48.95, 83.33, 50.0, 48.95, 82.29, 68.75, 73.95, 50.0, 47.91, 43.75, 78.12, 59.37, 47.91, 46.87, 66.66, 81.25, 81.25, 47.91, 42.7, 79.16, 50.0, 57.29, 79.16, 80.2, 81.25, 76.04, 43.75, 46.87, 71.87, 46.87, 68.75, 47.91, 82.29, 61.45, 65.62, 47.91, 43.75, 76.04, 59.37, 53.12, 60.41, 77.08, 62.5, 69.79, 40.62, 44.79, 56.25, 40.62, 48.95, 69.79, 76.04, 66.66, 73.95, 43.75, 43.75]
[rank1]:2026-01-02 19:32:40,765 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1932_rank1_stage1.svg
[rank1]:	> Counts Sum: 196960, Total Sum: 311040 (63.32%), Ratio(%) per element: [73.95, 47.91, 51.04, 47.91, 44.79, 87.5, 71.87, 48.95, 48.95, 82.29, 53.12, 50.0, 69.79, 48.95, 78.12, 84.37, 40.62, 52.08, 81.25, 64.58, 43.75, 57.29, 81.25, 79.16, 87.5, 56.25, 44.79, 62.5, 52.08, 53.12, 67.7, 85.41, 75.0, 48.95, 47.91, 39.58, 63.54, 68.75, 52.08, 47.91, 53.12, 86.45, 79.16, 46.87, 53.12, 69.79, 59.37, 83.33, 78.12, 71.87, 83.33, 83.33, 52.08, 50.0, 81.25, 85.41, 50.0, 65.62, 86.45, 77.08, 87.5, 42.7, 53.12, 60.41, 59.37, 50.0, 44.79, 67.7, 67.7, 88.54, 44.79, 48.95, 59.37, 47.91, 60.41, 51.04, 84.37, 88.54, 80.2, 48.95, 54.16]
[rank2]:2026-01-02 19:32:40,895 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1932_stage2.svg
[rank3]:2026-01-02 19:32:40,862 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1932_rank3_stage3.svg
[rank3]:	> Counts Sum: 157520, Total Sum: 249600 (63.11%), Ratio(%) per element: [81.25, 56.25, 45.83, 61.45, 47.91, 60.41, 52.08, 46.87, 45.83, 87.5, 54.16, 43.75, 51.04, 88.54, 63.54, 87.5, 44.79, 42.7, 59.37, 51.04, 42.7, 69.79, 77.08, 86.45, 80.2, 53.12, 55.2, 83.33, 56.25, 54.16, 56.25, 85.41, 85.41, 82.29, 61.45, 53.12, 84.37, 73.95, 57.29, 71.87, 85.41, 88.54, 88.54, 50.0, 47.91, 54.16, 70.83, 50.0, 57.29, 50.0, 70.83, 60.41, 47.91, 45.83, 82.29, 48.95, 76.04, 54.16, 59.37, 88.54, 87.5, 51.04, 46.87, 50.0, 47.91]
[rank0]:2026-01-02 19:32:40,920 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1932_stage0.svg
[rank1]:2026-01-02 19:32:40,923 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1932_stage1.svg
[rank3]:2026-01-02 19:32:41,011 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1932_stage3.svg
[rank0]:2026-01-02 19:34:21,194 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 19:34:21,248 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank1]:2026-01-02 19:34:21,248 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 19:34:21,242 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.13/0.13, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 19:34:21,255 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.25/0.25, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 19:34:23,189 - Avg. fwd time: 15.2437 / Avg. bwd time: 37.3330 / Avg. batch time: 437.8622 (ms) / GPU bubble ratio: 3.94%
[rank1]:2026-01-02 19:34:23,273 - Avg. fwd time: 16.1689 / Avg. bwd time: 36.3519 / Avg. batch time: 555.8408 (ms) / GPU bubble ratio: 24.41%
[rank2]:2026-01-02 19:34:23,217 - Avg. fwd time: 14.2273 / Avg. bwd time: 32.7707 / Avg. batch time: 489.4933 (ms) / GPU bubble ratio: 23.19%
[rank0]:2026-01-02 19:34:23,279 - Avg. fwd time: 14.7732 / Avg. bwd time: 33.9618 / Avg. batch time: 607.7127 (ms) / GPU bubble ratio: 35.84%
[rank3]:2026-01-02 19:34:23,316 -  step: 350  loss:  0.3388  grad_norm:  0.3568  memory: 84.06GiB(60.12%)  tps: 7,970  tflops: 371.73  mfu: 37.59%
[rank2]:2026-01-02 19:34:23,309 -  step: 350  loss: -4.0000  grad_norm:  0.3568  memory: 68.83GiB(49.23%)  tps: 7,970  tflops: 371.73  mfu: 37.59%
[rank1]:2026-01-02 19:34:23,311 -  step: 350  loss: -4.0000  grad_norm:  0.3568  memory: 77.37GiB(55.34%)  tps: 7,970  tflops: 371.73  mfu: 37.59%
[rank0]:2026-01-02 19:34:23,315 -  step: 350  loss: -4.0000  grad_norm:  0.3568  memory: 80.61GiB(57.65%)  tps: 7,970  tflops: 371.73  mfu: 37.59%
[rank1]:2026-01-02 19:36:04,603 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.40/0.40, [MB2] 1.00/1.00, [MB3] 1.00/1.00, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 19:36:04,595 - Current/Expected Freeze Ratio per Block: [MB0] 1.00/1.00, [MB1] 0.00/0.00, [MB2] 0.13/0.13, [MB3] 0.90/0.90, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank0]:2026-01-02 19:36:04,539 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:36:04,608 - Current/Expected Freeze Ratio per Block: [MB0] 0.00/0.00, [MB1] 0.00/0.00, [MB2] 0.00/0.00, [MB3] 0.25/0.25, [MB4] 1.00/1.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank3]:2026-01-02 19:36:04,601 - Current/Expected Freeze Ratio per Block: [MB0] 0.91/0.91, [MB1] 1.00/1.00, [MB2] 0.49/0.49, [MB3] 1.00/1.00, [MB4] 0.00/0.00, [MB5] 1.00/1.00, [MB6] 1.00/1.00, [MB7] 1.00/1.00
[rank2]:2026-01-02 19:36:06,605 - Avg. fwd time: 14.2282 / Avg. bwd time: 31.6324 / Avg. batch time: 477.1369 (ms) / GPU bubble ratio: 23.11%
[rank3]:2026-01-02 19:36:06,572 - Avg. fwd time: 15.2361 / Avg. bwd time: 35.8757 / Avg. batch time: 426.1113 (ms) / GPU bubble ratio: 4.04%
[rank1]:2026-01-02 19:36:06,661 - Avg. fwd time: 16.1750 / Avg. bwd time: 34.9278 / Avg. batch time: 544.9652 (ms) / GPU bubble ratio: 24.98%
[rank1]:2026-01-02 19:36:06,701 -  step: 400  loss: -4.0000  grad_norm:  0.2327  memory: 77.37GiB(55.34%)  tps: 7,923  tflops: 369.55  mfu: 37.37%
[rank2]:2026-01-02 19:36:06,699 -  step: 400  loss: -4.0000  grad_norm:  0.2327  memory: 68.83GiB(49.23%)  tps: 7,923  tflops: 369.55  mfu: 37.37%
[rank0]:2026-01-02 19:36:06,669 - Avg. fwd time: 14.7687 / Avg. bwd time: 32.2667 / Avg. batch time: 592.7582 (ms) / GPU bubble ratio: 36.52%
[rank0]:2026-01-02 19:36:06,705 -  step: 400  loss: -4.0000  grad_norm:  0.2327  memory: 80.61GiB(57.65%)  tps: 7,923  tflops: 369.55  mfu: 37.37%
[rank3]:2026-01-02 19:36:06,704 -  step: 400  loss:  0.2770  grad_norm:  0.2327  memory: 84.06GiB(60.12%)  tps: 7,924  tflops: 369.57  mfu: 37.37%
[rank1]:2026-01-02 19:36:06,754 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1936_stage1_step400.svg
[rank2]:2026-01-02 19:36:06,759 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1936_stage2_step400.svg
[rank0]:2026-01-02 19:36:06,759 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1936_stage0_step400.svg
[rank3]:2026-01-02 19:36:06,832 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1936_step400_rank3.svg
[rank3]:			> Batch Time: 493.25 ms, GPU Bubble Ratio: 42.79%, 33.10%, 38.29%, 32.70%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  286-42-328ms   | [S0,MB1,B]  328-43-371ms   | [S0,MB2,B]  371-43-415ms   | [S0,MB3,B]  415-34-450ms   | [S0,MB4,B]  450-0-450ms    | [S0,MB5,B]  450-0-450ms    | [S0,MB6,B]  471-0-471ms    | [S0,MB7,B]  493-0-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  134-15-150ms   | [S1,MB0,B]  241-45-286ms   | [S1,MB1,B]  285-30-316ms   | [S1,MB2,B]  321-20-342ms   | [S1,MB3,B]  342-20-363ms   | [S1,MB4,B]  371-20-392ms   | [S1,MB5,B]  415-20-436ms   | [S1,MB6,B]  450-20-471ms   | [S1,MB7,B]  471-20-492ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  70-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  222-18-240ms   | [S2,MB1,B]  243-40-283ms   | [S2,MB2,B]  283-37-320ms   | [S2,MB3,B]  321-19-340ms   | [S2,MB4,B]  341-18-360ms   | [S2,MB5,B]  362-18-381ms   | [S2,MB6,B]  383-18-401ms   | [S2,MB7,B]  415-18-434ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-157ms   | [S3,MB6,F]  160-14-174ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-28-222ms   | [S3,MB1,B]  221-20-242ms   | [S3,MB2,B]  242-31-274ms   | [S3,MB3,B]  274-20-295ms   | [S3,MB4,B]  295-46-341ms   | [S3,MB5,B]  341-21-362ms   | [S3,MB6,B]  362-20-383ms   | [S3,MB7,B]  382-20-403ms  
[rank3]:2026-01-02 19:36:06,878 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1936_stage3_step400.svg
[rank1]:2026-01-02 19:36:06,937 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1936_rank1_stage1.svg
[rank1]:	> Counts Sum: 404160, Total Sum: 570240 (70.88%), Ratio(%) per element: [76.7, 60.22, 61.93, 60.22, 62.5, 86.36, 77.27, 60.79, 60.79, 82.95, 63.06, 61.36, 76.7, 64.77, 79.54, 84.65, 56.25, 62.5, 79.54, 75.0, 57.95, 69.31, 82.95, 77.84, 85.22, 64.77, 59.65, 69.88, 63.06, 63.06, 71.02, 84.65, 79.54, 65.34, 60.22, 55.68, 73.86, 72.15, 67.04, 64.77, 67.61, 83.52, 81.81, 59.65, 63.06, 76.7, 71.02, 84.09, 78.97, 78.97, 84.65, 79.54, 62.5, 61.36, 82.38, 83.52, 61.36, 71.59, 84.65, 78.4, 86.93, 57.95, 63.63, 71.59, 68.75, 61.36, 58.52, 75.56, 74.43, 85.22, 58.52, 61.36, 69.88, 60.22, 69.31, 63.63, 84.65, 86.36, 81.81, 60.79, 63.63]
[rank2]:2026-01-02 19:36:06,938 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1936_rank2_stage2.svg
[rank2]:	> Counts Sum: 341120, Total Sum: 506880 (67.30%), Ratio(%) per element: [73.29, 63.63, 55.11, 61.93, 61.93, 76.7, 76.13, 56.81, 58.52, 78.97, 73.86, 56.81, 62.5, 68.18, 74.43, 76.7, 56.81, 60.79, 80.68, 62.5, 59.65, 80.11, 73.29, 75.0, 61.93, 57.95, 56.81, 78.4, 65.34, 59.65, 59.09, 73.29, 79.54, 78.4, 59.65, 55.68, 76.13, 59.09, 65.9, 76.13, 80.11, 81.81, 76.7, 56.25, 58.52, 73.86, 59.65, 72.15, 60.79, 81.81, 69.88, 69.88, 59.65, 57.38, 76.13, 66.47, 64.2, 67.04, 77.27, 69.31, 73.86, 56.25, 58.52, 65.34, 55.11, 60.22, 71.59, 75.56, 72.15, 76.13, 57.95, 56.25]
[rank0]:2026-01-02 19:36:06,942 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1936_rank0_stage0.svg
[rank0]:	> Counts Sum: 257600, Total Sum: 513920 (50.12%), Ratio(%) per element: [43.75, 49.43, 42.61, 42.61, 56.25, 58.52, 51.7, 53.4, 42.04, 43.75, 52.27, 53.4, 45.45, 48.29, 54.54, 44.31, 59.65, 43.18, 40.9, 51.7, 45.45, 49.43, 55.68, 51.7, 60.79, 42.04, 44.31, 43.75, 55.68, 55.68, 55.11, 48.86, 57.95, 59.09, 58.52, 42.04, 42.61, 55.68, 46.02, 42.04, 48.29, 55.68, 57.95, 60.22, 39.77, 44.88, 44.31, 50.56, 53.97, 56.25, 56.81, 52.27, 51.13, 42.61, 44.88, 50.56, 52.84, 42.61, 43.75, 60.22, 59.09, 59.65, 42.61, 45.45, 58.52, 42.61, 43.18, 44.31, 48.86, 64.2, 60.22, 43.75, 46.59]
[rank3]:2026-01-02 19:36:07,044 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1936_rank3_stage3.svg
[rank3]:	> Counts Sum: 323920, Total Sum: 457600 (70.79%), Ratio(%) per element: [84.09, 70.45, 57.38, 72.15, 59.65, 71.59, 68.18, 57.95, 58.52, 86.93, 61.93, 60.79, 64.77, 88.06, 73.86, 86.36, 57.95, 56.81, 65.9, 61.36, 56.25, 74.43, 81.81, 86.93, 82.95, 61.93, 63.06, 80.11, 69.31, 69.31, 64.77, 85.22, 85.22, 81.81, 65.34, 61.93, 83.52, 78.4, 68.75, 78.97, 85.22, 86.93, 85.79, 61.36, 59.09, 65.9, 78.4, 59.65, 64.2, 65.9, 77.84, 71.59, 60.22, 56.81, 84.65, 59.65, 78.4, 66.47, 71.59, 88.06, 87.5, 61.93, 58.52, 61.36, 59.09]
[rank1]:2026-01-02 19:36:07,204 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1936_stage1.svg
[rank2]:2026-01-02 19:36:07,207 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1936_stage2.svg
[rank0]:2026-01-02 19:36:07,214 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1936_stage0.svg
[rank3]:2026-01-02 19:36:07,313 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1936_stage3.svg
[rank0]:2026-01-02 19:37:47,925 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 19:37:49,909 - Avg. fwd time: 15.2307 / Avg. bwd time: 34.6997 / Avg. batch time: 416.6348 (ms) / GPU bubble ratio: 4.13%
[rank0]:2026-01-02 19:37:50,003 - Avg. fwd time: 14.7619 / Avg. bwd time: 30.9473 / Avg. batch time: 580.9945 (ms) / GPU bubble ratio: 37.06%
[rank2]:2026-01-02 19:37:49,939 - Avg. fwd time: 14.2266 / Avg. bwd time: 30.7492 / Avg. batch time: 467.4122 (ms) / GPU bubble ratio: 23.02%
[rank1]:2026-01-02 19:37:49,998 - Avg. fwd time: 16.1779 / Avg. bwd time: 33.8215 / Avg. batch time: 536.3839 (ms) / GPU bubble ratio: 25.43%
[rank3]:2026-01-02 19:37:50,041 -  step: 450  loss:  0.2996  grad_norm:  0.1589  memory: 84.06GiB(60.12%)  tps: 7,928  tflops: 369.76  mfu: 37.39%
[rank0]:2026-01-02 19:37:50,039 -  step: 450  loss: -4.0000  grad_norm:  0.1589  memory: 80.61GiB(57.65%)  tps: 7,928  tflops: 369.75  mfu: 37.39%
[rank2]:2026-01-02 19:37:50,032 -  step: 450  loss: -4.0000  grad_norm:  0.1589  memory: 68.83GiB(49.23%)  tps: 7,928  tflops: 369.75  mfu: 37.39%
[rank1]:2026-01-02 19:37:50,035 -  step: 450  loss: -4.0000  grad_norm:  0.1589  memory: 77.37GiB(55.34%)  tps: 7,928  tflops: 369.75  mfu: 37.39%
[rank0]:2026-01-02 19:39:30,298 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:39:32,302 - Avg. fwd time: 15.2273 / Avg. bwd time: 33.7710 / Avg. batch time: 409.1582 (ms) / GPU bubble ratio: 4.20%
[rank0]:2026-01-02 19:39:32,394 - Avg. fwd time: 14.7542 / Avg. bwd time: 29.8841 / Avg. batch time: 571.4994 (ms) / GPU bubble ratio: 37.51%
[rank2]:2026-01-02 19:39:32,332 - Avg. fwd time: 14.2259 / Avg. bwd time: 30.0394 / Avg. batch time: 459.6260 (ms) / GPU bubble ratio: 22.95%
[rank1]:2026-01-02 19:39:32,389 - Avg. fwd time: 16.1788 / Avg. bwd time: 32.9276 / Avg. batch time: 529.4510 (ms) / GPU bubble ratio: 25.80%
[rank3]:2026-01-02 19:39:32,430 -  step: 500  loss:  0.3046  grad_norm:  0.1786  memory: 84.06GiB(60.12%)  tps: 8,001  tflops: 373.18  mfu: 37.73%
[rank0]:2026-01-02 19:39:32,430 -  step: 500  loss: -4.0000  grad_norm:  0.1786  memory: 80.61GiB(57.65%)  tps: 8,001  tflops: 373.16  mfu: 37.73%
[rank0]:2026-01-02 19:39:32,475 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1939_stage0_step500.svg
[rank2]:2026-01-02 19:39:32,423 -  step: 500  loss: -4.0000  grad_norm:  0.1786  memory: 68.83GiB(49.23%)  tps: 8,001  tflops: 373.16  mfu: 37.73%
[rank1]:2026-01-02 19:39:32,426 -  step: 500  loss: -4.0000  grad_norm:  0.1786  memory: 77.37GiB(55.34%)  tps: 8,001  tflops: 373.16  mfu: 37.73%
[rank2]:2026-01-02 19:39:32,478 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1939_stage2_step500.svg
[rank1]:2026-01-02 19:39:32,484 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1939_stage1_step500.svg
[rank3]:2026-01-02 19:39:32,558 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1939_step500_rank3.svg
[rank3]:			> Batch Time: 488.00 ms, GPU Bubble Ratio: 42.06%, 32.23%, 37.50%, 33.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  280-42-322ms   | [S0,MB1,B]  323-43-366ms   | [S0,MB2,B]  366-43-409ms   | [S0,MB3,B]  410-35-445ms   | [S0,MB4,B]  445-0-445ms    | [S0,MB5,B]  445-0-445ms    | [S0,MB6,B]  466-0-466ms    | [S0,MB7,B]  488-0-488ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  235-45-280ms   | [S1,MB1,B]  280-30-310ms   | [S1,MB2,B]  315-20-336ms   | [S1,MB3,B]  336-20-357ms   | [S1,MB4,B]  366-20-386ms   | [S1,MB5,B]  409-20-430ms   | [S1,MB6,B]  445-20-466ms   | [S1,MB7,B]  466-20-487ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-98ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  216-18-234ms   | [S2,MB1,B]  236-40-277ms   | [S2,MB2,B]  277-37-315ms   | [S2,MB3,B]  314-19-334ms   | [S2,MB4,B]  335-18-354ms   | [S2,MB5,B]  356-18-374ms   | [S2,MB6,B]  376-18-395ms   | [S2,MB7,B]  409-18-428ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  194-21-215ms   | [S3,MB1,B]  215-20-236ms   | [S3,MB2,B]  236-31-267ms   | [S3,MB3,B]  267-20-288ms   | [S3,MB4,B]  288-46-335ms   | [S3,MB5,B]  334-21-355ms   | [S3,MB6,B]  355-20-376ms   | [S3,MB7,B]  376-20-396ms  
[rank3]:2026-01-02 19:39:32,600 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1939_stage3_step500.svg
[rank0]:2026-01-02 19:39:32,646 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1939_rank0_stage0.svg
[rank0]:	> Counts Sum: 381600, Total Sum: 747520 (51.05%), Ratio(%) per element: [46.87, 49.6, 44.92, 44.92, 54.29, 56.25, 52.34, 52.73, 44.53, 45.7, 51.95, 52.34, 46.87, 50.39, 55.46, 47.26, 58.59, 45.7, 43.75, 52.34, 49.21, 50.0, 55.07, 51.95, 60.54, 45.31, 46.09, 45.7, 55.85, 53.9, 55.46, 51.56, 57.42, 58.2, 58.98, 44.53, 44.92, 53.9, 49.21, 44.53, 48.82, 53.9, 55.85, 58.98, 42.96, 46.48, 48.04, 51.95, 54.29, 54.29, 56.25, 52.73, 52.73, 45.31, 46.48, 51.56, 51.95, 46.09, 48.82, 58.59, 57.81, 58.59, 44.92, 46.87, 58.2, 44.92, 47.65, 46.48, 50.78, 61.71, 59.76, 45.7, 47.65]
[rank2]:2026-01-02 19:39:32,667 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1939_rank2_stage2.svg
[rank2]:	> Counts Sum: 514720, Total Sum: 737280 (69.81%), Ratio(%) per element: [75.0, 67.96, 61.32, 66.01, 66.79, 77.73, 76.95, 61.71, 62.5, 78.12, 75.0, 63.28, 66.79, 69.92, 74.6, 76.56, 60.93, 64.45, 79.29, 67.18, 63.28, 76.95, 75.0, 75.39, 66.79, 61.32, 61.32, 78.12, 68.35, 62.89, 62.5, 74.6, 78.51, 77.34, 62.5, 60.93, 75.39, 63.67, 69.53, 76.95, 79.29, 80.46, 76.95, 61.71, 62.5, 75.0, 64.84, 73.43, 65.62, 81.25, 72.26, 71.48, 63.67, 61.32, 77.73, 69.14, 68.35, 70.31, 77.73, 72.26, 75.0, 61.32, 63.67, 69.53, 62.1, 64.06, 71.48, 76.17, 73.43, 76.95, 62.89, 60.93]
[rank1]:2026-01-02 19:39:32,672 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1939_rank1_stage1.svg
[rank1]:	> Counts Sum: 611360, Total Sum: 829440 (73.71%), Ratio(%) per element: [79.29, 65.62, 66.01, 64.84, 69.14, 85.93, 78.12, 65.62, 65.23, 82.42, 66.79, 65.62, 78.51, 70.7, 80.07, 84.37, 62.1, 66.4, 78.12, 78.51, 63.28, 71.48, 82.42, 80.46, 83.98, 67.96, 64.45, 74.6, 66.79, 66.79, 72.26, 83.98, 80.85, 70.7, 64.84, 61.71, 76.95, 76.17, 71.87, 70.7, 71.87, 82.42, 82.81, 64.45, 67.18, 78.9, 74.21, 82.42, 77.73, 80.85, 85.15, 80.46, 66.4, 65.62, 82.81, 82.42, 65.62, 73.04, 84.76, 80.85, 85.54, 63.28, 67.18, 76.56, 74.21, 67.57, 63.67, 77.73, 77.34, 84.37, 63.67, 65.62, 73.82, 64.84, 73.82, 69.14, 84.76, 86.71, 82.03, 65.23, 67.18]
[rank3]:2026-01-02 19:39:32,766 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1939_rank3_stage3.svg
[rank3]:	> Counts Sum: 490320, Total Sum: 665600 (73.67%), Ratio(%) per element: [84.76, 75.78, 62.1, 76.17, 64.45, 75.78, 74.21, 62.5, 62.89, 85.54, 64.84, 64.45, 71.09, 87.5, 77.73, 86.71, 62.89, 62.5, 67.57, 65.23, 61.32, 78.51, 83.59, 86.32, 83.59, 65.23, 66.01, 82.42, 75.0, 71.48, 67.57, 85.54, 85.54, 82.81, 67.18, 65.62, 83.98, 80.07, 73.82, 81.25, 84.76, 86.71, 85.54, 65.62, 63.28, 68.35, 80.46, 64.06, 66.01, 72.26, 80.07, 76.56, 64.45, 62.1, 83.2, 62.89, 79.68, 72.65, 76.17, 87.89, 86.71, 64.84, 63.28, 65.23, 63.67]
[rank0]:2026-01-02 19:39:33,015 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1939_stage0.svg
[rank2]:2026-01-02 19:39:33,056 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1939_stage2.svg
[rank1]:2026-01-02 19:39:33,078 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1939_stage1.svg
[rank3]:2026-01-02 19:39:33,147 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1939_stage3.svg
[rank0]:2026-01-02 19:41:12,876 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 19:41:14,891 - Avg. fwd time: 14.2241 / Avg. bwd time: 29.4509 / Avg. batch time: 453.2253 (ms) / GPU bubble ratio: 22.91%
[rank3]:2026-01-02 19:41:14,862 - Avg. fwd time: 15.2218 / Avg. bwd time: 33.0100 / Avg. batch time: 403.0109 (ms) / GPU bubble ratio: 4.26%
[rank1]:2026-01-02 19:41:14,954 - Avg. fwd time: 16.1788 / Avg. bwd time: 32.1985 / Avg. batch time: 523.6777 (ms) / GPU bubble ratio: 26.10%
[rank1]:2026-01-02 19:41:14,993 -  step: 550  loss: -4.0000  grad_norm:  0.2305  memory: 77.37GiB(55.34%)  tps: 7,987  tflops: 372.51  mfu: 37.67%
[rank2]:2026-01-02 19:41:14,991 -  step: 550  loss: -4.0000  grad_norm:  0.2305  memory: 68.83GiB(49.23%)  tps: 7,987  tflops: 372.51  mfu: 37.67%
[rank0]:2026-01-02 19:41:14,961 - Avg. fwd time: 14.7477 / Avg. bwd time: 29.0044 / Avg. batch time: 563.6601 (ms) / GPU bubble ratio: 37.90%
[rank0]:2026-01-02 19:41:14,997 -  step: 550  loss: -4.0000  grad_norm:  0.2305  memory: 80.61GiB(57.65%)  tps: 7,987  tflops: 372.51  mfu: 37.67%
[rank3]:2026-01-02 19:41:14,999 -  step: 550  loss:  0.1732  grad_norm:  0.2305  memory: 84.06GiB(60.12%)  tps: 7,987  tflops: 372.52  mfu: 37.67%
[rank0]:2026-01-02 19:42:55,675 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:42:57,730 - Avg. fwd time: 15.2323 / Avg. bwd time: 32.3971 / Avg. batch time: 398.1811 (ms) / GPU bubble ratio: 4.31%
[rank2]:2026-01-02 19:42:57,758 - Avg. fwd time: 14.2351 / Avg. bwd time: 28.9607 / Avg. batch time: 448.0537 (ms) / GPU bubble ratio: 22.87%
[rank1]:2026-01-02 19:42:57,815 - Avg. fwd time: 16.1929 / Avg. bwd time: 31.6084 / Avg. batch time: 519.1946 (ms) / GPU bubble ratio: 26.35%
[rank1]:2026-01-02 19:42:57,852 -  step: 600  loss: -4.0000  grad_norm:  0.4641  memory: 77.37GiB(55.34%)  tps: 7,964  tflops: 371.46  mfu: 37.56%
[rank2]:2026-01-02 19:42:57,850 -  step: 600  loss: -4.0000  grad_norm:  0.4641  memory: 68.83GiB(49.23%)  tps: 7,964  tflops: 371.46  mfu: 37.56%
[rank0]:2026-01-02 19:42:57,821 - Avg. fwd time: 14.7525 / Avg. bwd time: 28.2923 / Avg. batch time: 557.4235 (ms) / GPU bubble ratio: 38.22%
[rank0]:2026-01-02 19:42:57,856 -  step: 600  loss: -4.0000  grad_norm:  0.4641  memory: 80.61GiB(57.65%)  tps: 7,964  tflops: 371.46  mfu: 37.56%
[rank0]:2026-01-02 19:42:57,900 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1942_stage0_step600.svg
[rank3]:2026-01-02 19:42:57,854 -  step: 600  loss:  0.4067  grad_norm:  0.4641  memory: 84.06GiB(60.12%)  tps: 7,965  tflops: 371.48  mfu: 37.56%
[rank1]:2026-01-02 19:42:57,902 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1942_stage1_step600.svg
[rank2]:2026-01-02 19:42:57,901 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1942_stage2_step600.svg
[rank3]:2026-01-02 19:42:57,981 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1942_step600_rank3.svg
[rank3]:			> Batch Time: 497.50 ms, GPU Bubble Ratio: 42.59%, 32.69%, 38.60%, 32.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  289-42-332ms   | [S0,MB1,B]  332-43-375ms   | [S0,MB2,B]  375-43-418ms   | [S0,MB3,B]  418-36-454ms   | [S0,MB4,B]  455-0-455ms    | [S0,MB5,B]  455-0-455ms    | [S0,MB6,B]  476-0-476ms    | [S0,MB7,B]  497-0-497ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  243-45-289ms   | [S1,MB1,B]  288-31-320ms   | [S1,MB2,B]  321-21-343ms   | [S1,MB3,B]  343-21-364ms   | [S1,MB4,B]  375-21-396ms   | [S1,MB5,B]  418-20-439ms   | [S1,MB6,B]  454-20-475ms   | [S1,MB7,B]  475-20-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  224-18-243ms   | [S2,MB1,B]  245-40-286ms   | [S2,MB2,B]  285-35-321ms   | [S2,MB3,B]  321-19-341ms   | [S2,MB4,B]  346-18-365ms   | [S2,MB5,B]  367-18-386ms   | [S2,MB6,B]  388-18-407ms   | [S2,MB7,B]  418-18-437ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  93-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  127-15-142ms   | [S3,MB5,F]  144-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  179-15-194ms   | [S3,MB0,B]  196-27-224ms   | [S3,MB1,B]  224-21-245ms   | [S3,MB2,B]  245-33-279ms   | [S3,MB3,B]  279-21-300ms   | [S3,MB4,B]  300-46-346ms   | [S3,MB5,B]  346-21-367ms   | [S3,MB6,B]  367-20-388ms   | [S3,MB7,B]  388-20-409ms  
[rank3]:2026-01-02 19:42:58,023 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1942_stage3_step600.svg
[rank1]:2026-01-02 19:42:58,081 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1942_rank1_stage1.svg
[rank1]:	> Counts Sum: 818560, Total Sum: 1088640 (75.19%), Ratio(%) per element: [80.65, 70.53, 69.04, 69.34, 72.32, 85.11, 79.76, 67.85, 67.55, 82.14, 68.75, 67.85, 79.16, 74.7, 78.86, 84.52, 65.17, 68.45, 77.38, 79.16, 67.55, 72.32, 82.73, 80.35, 83.33, 69.64, 67.26, 76.78, 68.75, 69.04, 73.21, 83.92, 81.25, 73.51, 67.55, 64.88, 78.86, 77.97, 74.4, 73.8, 73.21, 82.73, 83.63, 66.96, 69.04, 79.76, 75.59, 81.25, 77.08, 82.14, 85.11, 81.25, 68.45, 67.85, 82.14, 83.03, 67.85, 73.51, 83.92, 81.25, 85.11, 66.07, 69.04, 78.57, 75.0, 70.83, 66.36, 78.86, 78.57, 83.92, 66.36, 67.85, 75.89, 67.26, 75.89, 72.91, 84.52, 86.3, 83.03, 67.55, 69.04]
[rank2]:2026-01-02 19:42:58,073 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1942_rank2_stage2.svg
[rank2]:	> Counts Sum: 688320, Total Sum: 967680 (71.13%), Ratio(%) per element: [75.0, 69.94, 63.98, 68.45, 69.64, 77.38, 77.67, 63.98, 64.28, 77.97, 75.29, 66.96, 69.34, 72.32, 75.0, 77.08, 63.69, 66.36, 79.16, 69.04, 66.07, 75.89, 75.0, 75.29, 69.94, 63.69, 64.28, 78.86, 70.23, 64.88, 64.28, 75.59, 78.57, 78.57, 64.28, 63.98, 75.29, 65.47, 70.83, 76.48, 78.27, 80.05, 77.08, 63.69, 63.98, 75.59, 67.26, 74.1, 67.55, 79.76, 73.21, 72.91, 65.47, 63.69, 77.67, 69.64, 70.53, 71.72, 77.67, 73.21, 76.78, 63.09, 65.47, 71.72, 65.77, 65.77, 71.72, 76.78, 74.4, 77.38, 65.47, 63.69]
[rank0]:2026-01-02 19:42:58,070 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1942_rank0_stage0.svg
[rank0]:	> Counts Sum: 505600, Total Sum: 981120 (51.53%), Ratio(%) per element: [49.1, 49.7, 47.02, 46.13, 53.27, 54.76, 53.27, 53.27, 45.83, 46.72, 51.48, 51.78, 47.61, 52.38, 55.65, 49.1, 58.33, 46.72, 45.23, 52.08, 50.89, 50.29, 55.65, 52.38, 59.22, 47.32, 47.02, 46.72, 55.35, 52.97, 56.54, 52.08, 57.14, 57.44, 58.63, 45.83, 46.42, 52.97, 51.19, 45.83, 49.1, 52.97, 54.46, 58.03, 44.64, 47.32, 50.0, 52.38, 53.86, 53.27, 55.95, 53.57, 53.57, 46.42, 47.32, 52.08, 51.48, 48.21, 50.59, 58.03, 56.25, 58.03, 46.13, 48.21, 57.14, 46.13, 50.0, 48.8, 52.08, 60.41, 58.92, 46.72, 48.21]
[rank3]:2026-01-02 19:42:58,185 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1942_rank3_stage3.svg
[rank3]:	> Counts Sum: 656720, Total Sum: 873600 (75.17%), Ratio(%) per element: [84.82, 77.97, 64.88, 78.27, 69.34, 77.97, 76.78, 64.58, 65.47, 86.01, 69.94, 69.64, 74.4, 86.9, 79.76, 86.01, 65.77, 65.17, 68.45, 67.85, 64.28, 80.35, 83.92, 86.3, 83.63, 66.36, 67.26, 83.33, 77.67, 72.32, 70.23, 84.82, 85.41, 82.73, 68.45, 66.96, 84.52, 79.46, 72.61, 82.44, 84.82, 86.01, 85.71, 66.66, 65.77, 69.34, 81.25, 65.77, 67.55, 75.89, 81.25, 78.86, 66.36, 64.88, 83.92, 64.88, 80.95, 76.19, 78.27, 87.5, 86.3, 66.96, 65.17, 66.96, 65.77]
[rank1]:2026-01-02 19:42:58,574 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1942_stage1.svg
[rank2]:2026-01-02 19:42:58,553 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1942_stage2.svg
[rank0]:2026-01-02 19:42:58,557 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1942_stage0.svg
[rank3]:2026-01-02 19:42:58,678 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1942_stage3.svg
[rank0]:2026-01-02 19:44:40,235 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 19:44:42,263 - Avg. fwd time: 14.2544 / Avg. bwd time: 28.5603 / Avg. batch time: 443.9156 (ms) / GPU bubble ratio: 22.84%
[rank3]:2026-01-02 19:44:42,237 - Avg. fwd time: 15.2532 / Avg. bwd time: 31.9021 / Avg. batch time: 394.3809 (ms) / GPU bubble ratio: 4.35%
[rank1]:2026-01-02 19:44:42,320 - Avg. fwd time: 16.2142 / Avg. bwd time: 31.1166 / Avg. batch time: 515.6071 (ms) / GPU bubble ratio: 26.56%
[rank1]:2026-01-02 19:44:42,357 -  step: 650  loss: -4.0000  grad_norm:  0.2846  memory: 77.37GiB(55.34%)  tps: 7,839  tflops: 365.61  mfu: 36.97%
[rank2]:2026-01-02 19:44:42,354 -  step: 650  loss: -4.0000  grad_norm:  0.2846  memory: 68.83GiB(49.23%)  tps: 7,839  tflops: 365.61  mfu: 36.97%
[rank0]:2026-01-02 19:44:42,325 - Avg. fwd time: 14.7667 / Avg. bwd time: 27.6855 / Avg. batch time: 552.3574 (ms) / GPU bubble ratio: 38.51%
[rank0]:2026-01-02 19:44:42,361 -  step: 650  loss: -4.0000  grad_norm:  0.2846  memory: 80.61GiB(57.65%)  tps: 7,839  tflops: 365.61  mfu: 36.97%
[rank3]:2026-01-02 19:44:42,359 -  step: 650  loss:  0.2741  grad_norm:  0.2846  memory: 84.06GiB(60.12%)  tps: 7,839  tflops: 365.61  mfu: 36.97%
[rank0]:2026-01-02 19:46:24,098 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 19:46:26,162 - Avg. fwd time: 14.2712 / Avg. bwd time: 28.2203 / Avg. batch time: 440.4439 (ms) / GPU bubble ratio: 22.82%
[rank3]:2026-01-02 19:46:26,133 - Avg. fwd time: 15.2720 / Avg. bwd time: 31.4918 / Avg. batch time: 391.2435 (ms) / GPU bubble ratio: 4.38%
[rank1]:2026-01-02 19:46:26,219 - Avg. fwd time: 16.2331 / Avg. bwd time: 30.7018 / Avg. batch time: 512.5533 (ms) / GPU bubble ratio: 26.74%
[rank1]:2026-01-02 19:46:26,256 -  step: 700  loss: -4.0000  grad_norm:  0.3555  memory: 77.37GiB(55.34%)  tps: 7,885  tflops: 367.74  mfu: 37.18%
[rank2]:2026-01-02 19:46:26,253 -  step: 700  loss: -4.0000  grad_norm:  0.3555  memory: 68.83GiB(49.23%)  tps: 7,885  tflops: 367.74  mfu: 37.18%
[rank0]:2026-01-02 19:46:26,224 - Avg. fwd time: 14.7784 / Avg. bwd time: 27.1590 / Avg. batch time: 548.0374 (ms) / GPU bubble ratio: 38.78%
[rank0]:2026-01-02 19:46:26,260 -  step: 700  loss: -4.0000  grad_norm:  0.3555  memory: 80.61GiB(57.65%)  tps: 7,885  tflops: 367.74  mfu: 37.18%
[rank3]:2026-01-02 19:46:26,258 -  step: 700  loss:  0.3598  grad_norm:  0.3555  memory: 84.06GiB(60.12%)  tps: 7,885  tflops: 367.74  mfu: 37.18%
[rank1]:2026-01-02 19:46:26,308 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1946_stage1_step700.svg
[rank2]:2026-01-02 19:46:26,308 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1946_stage2_step700.svg
[rank0]:2026-01-02 19:46:26,305 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1946_stage0_step700.svg
[rank3]:2026-01-02 19:46:26,386 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1946_step700_rank3.svg
[rank3]:			> Batch Time: 491.00 ms, GPU Bubble Ratio: 42.25%, 31.60%, 37.10%, 32.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-119ms   | [S0,MB0,B]  284-42-326ms   | [S0,MB1,B]  327-43-370ms   | [S0,MB2,B]  370-43-414ms   | [S0,MB3,B]  414-33-448ms   | [S0,MB4,B]  448-0-448ms    | [S0,MB5,B]  448-0-448ms    | [S0,MB6,B]  469-0-469ms    | [S0,MB7,B]  491-0-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-136ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  238-45-284ms   | [S1,MB1,B]  283-32-316ms   | [S1,MB2,B]  319-21-340ms   | [S1,MB3,B]  340-21-361ms   | [S1,MB4,B]  370-21-391ms   | [S1,MB5,B]  414-20-435ms   | [S1,MB6,B]  448-20-469ms   | [S1,MB7,B]  469-20-490ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  219-18-238ms   | [S2,MB1,B]  240-40-281ms   | [S2,MB2,B]  281-37-318ms   | [S2,MB3,B]  319-20-339ms   | [S2,MB4,B]  342-18-360ms   | [S2,MB5,B]  363-18-382ms   | [S2,MB6,B]  384-18-403ms   | [S2,MB7,B]  414-18-433ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-21-218ms   | [S3,MB1,B]  219-21-240ms   | [S3,MB2,B]  240-33-273ms   | [S3,MB3,B]  273-21-294ms   | [S3,MB4,B]  294-46-341ms   | [S3,MB5,B]  341-21-362ms   | [S3,MB6,B]  362-21-383ms   | [S3,MB7,B]  383-20-404ms  
[rank0]:2026-01-02 19:46:26,474 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1946_rank0_stage0.svg
[rank0]:	> Counts Sum: 629600, Total Sum: 1214720 (51.83%), Ratio(%) per element: [50.72, 50.72, 48.55, 46.87, 52.64, 53.84, 53.36, 53.36, 46.63, 47.35, 51.92, 51.68, 48.07, 52.88, 55.04, 50.72, 57.69, 47.35, 46.15, 52.88, 50.72, 51.2, 55.76, 52.88, 58.17, 48.55, 47.59, 47.35, 55.52, 52.4, 56.73, 52.4, 56.73, 56.25, 57.69, 46.63, 47.11, 52.4, 51.68, 46.63, 49.27, 52.4, 54.8, 57.93, 45.67, 47.83, 50.96, 53.36, 54.08, 52.64, 55.76, 54.08, 53.84, 47.11, 47.83, 53.12, 51.2, 49.27, 50.48, 58.41, 56.73, 56.97, 46.87, 48.55, 56.49, 47.11, 51.44, 50.48, 52.88, 59.37, 57.69, 47.35, 48.55]
[rank3]:2026-01-02 19:46:26,430 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1946_stage3_step700.svg
[rank1]:2026-01-02 19:46:26,488 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1946_rank1_stage1.svg
[rank1]:	> Counts Sum: 1025760, Total Sum: 1347840 (76.10%), Ratio(%) per element: [81.49, 72.83, 71.39, 72.35, 74.27, 85.09, 81.0, 69.23, 68.99, 82.21, 71.39, 69.23, 79.56, 75.96, 78.12, 84.61, 67.06, 69.71, 76.92, 79.8, 70.91, 72.83, 82.45, 81.0, 83.65, 70.91, 68.75, 77.64, 70.43, 70.19, 73.55, 83.89, 81.73, 75.24, 68.99, 66.82, 79.8, 78.36, 75.48, 74.75, 74.51, 82.45, 83.41, 68.5, 70.19, 80.04, 77.16, 81.97, 76.68, 82.93, 84.13, 81.0, 69.71, 69.23, 82.21, 83.17, 69.95, 74.03, 83.89, 81.25, 83.41, 68.02, 70.19, 80.04, 75.24, 73.31, 68.02, 79.32, 79.08, 83.89, 68.02, 69.23, 77.64, 70.91, 76.44, 74.51, 84.37, 85.33, 82.69, 68.99, 70.43]
[rank2]:2026-01-02 19:46:26,483 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1946_rank2_stage2.svg
[rank2]:	> Counts Sum: 861920, Total Sum: 1198080 (71.94%), Ratio(%) per element: [75.24, 71.15, 67.06, 69.95, 71.87, 77.16, 77.64, 65.86, 65.62, 78.12, 75.48, 68.99, 70.91, 72.83, 75.0, 77.4, 65.38, 67.54, 78.36, 70.43, 66.58, 75.24, 75.0, 76.2, 71.15, 65.14, 66.1, 78.36, 70.67, 67.06, 66.1, 75.48, 78.12, 78.12, 66.1, 64.9, 75.96, 66.82, 71.87, 76.2, 78.36, 79.56, 76.68, 64.9, 65.62, 75.96, 69.23, 75.0, 69.23, 79.32, 74.03, 73.55, 67.06, 65.38, 77.64, 69.71, 72.59, 73.07, 77.88, 73.79, 77.16, 64.66, 66.34, 73.31, 66.34, 66.82, 72.11, 76.92, 74.51, 77.4, 66.58, 65.62]
[rank3]:2026-01-02 19:46:26,591 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1946_rank3_stage3.svg
[rank3]:	> Counts Sum: 823120, Total Sum: 1081600 (76.10%), Ratio(%) per element: [84.37, 79.56, 67.06, 79.32, 72.59, 79.32, 77.88, 66.34, 67.06, 85.33, 72.83, 72.83, 76.68, 85.81, 80.76, 85.09, 67.3, 65.86, 70.67, 71.15, 66.58, 81.0, 83.65, 85.81, 83.89, 67.78, 67.78, 83.65, 79.08, 74.51, 73.31, 85.09, 85.09, 82.93, 69.23, 68.02, 85.09, 78.6, 72.59, 83.17, 84.61, 85.09, 84.85, 67.06, 66.58, 69.95, 81.49, 66.82, 70.91, 77.4, 81.73, 80.52, 66.82, 65.86, 84.13, 66.82, 81.73, 77.88, 79.56, 87.5, 85.33, 68.02, 66.82, 67.78, 66.34]
[rank2]:2026-01-02 19:46:27,073 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1946_stage2.svg
[rank0]:2026-01-02 19:46:27,070 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1946_stage0.svg
[rank1]:2026-01-02 19:46:27,108 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1946_stage1.svg
[rank3]:2026-01-02 19:46:27,187 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1946_stage3.svg
[rank0]:2026-01-02 19:48:08,259 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 19:48:10,274 - Avg. fwd time: 15.2815 / Avg. bwd time: 31.1282 / Avg. batch time: 388.4056 (ms) / GPU bubble ratio: 4.41%
[rank2]:2026-01-02 19:48:10,303 - Avg. fwd time: 14.2796 / Avg. bwd time: 27.9203 / Avg. batch time: 437.3732 (ms) / GPU bubble ratio: 22.81%
[rank1]:2026-01-02 19:48:10,361 - Avg. fwd time: 16.2449 / Avg. bwd time: 30.3377 / Avg. batch time: 509.8106 (ms) / GPU bubble ratio: 26.90%
[rank1]:2026-01-02 19:48:10,399 -  step: 750  loss: -4.0000  grad_norm:  0.2437  memory: 77.37GiB(55.34%)  tps: 7,866  tflops: 366.88  mfu: 37.10%
[rank2]:2026-01-02 19:48:10,396 -  step: 750  loss: -4.0000  grad_norm:  0.2437  memory: 68.83GiB(49.23%)  tps: 7,866  tflops: 366.88  mfu: 37.10%
[rank0]:2026-01-02 19:48:10,367 - Avg. fwd time: 14.7840 / Avg. bwd time: 26.6976 / Avg. batch time: 544.1988 (ms) / GPU bubble ratio: 39.02%
[rank0]:2026-01-02 19:48:10,403 -  step: 750  loss: -4.0000  grad_norm:  0.2437  memory: 80.61GiB(57.65%)  tps: 7,866  tflops: 366.88  mfu: 37.10%
[rank3]:2026-01-02 19:48:10,401 -  step: 750  loss:  0.1497  grad_norm:  0.2437  memory: 84.06GiB(60.12%)  tps: 7,866  tflops: 366.88  mfu: 37.10%
[rank0]:2026-01-02 19:49:50,341 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 19:49:52,371 - Avg. fwd time: 15.2795 / Avg. bwd time: 30.7786 / Avg. batch time: 385.5851 (ms) / GPU bubble ratio: 4.44%
[rank2]:2026-01-02 19:49:52,400 - Avg. fwd time: 14.2794 / Avg. bwd time: 27.6555 / Avg. batch time: 434.3914 (ms) / GPU bubble ratio: 22.77%
[rank2]:2026-01-02 19:49:52,493 -  step: 800  loss: -4.0000  grad_norm:  0.2740  memory: 68.83GiB(49.23%)  tps: 8,024  tflops: 374.23  mfu: 37.84%
[rank1]:2026-01-02 19:49:52,457 - Avg. fwd time: 16.2460 / Avg. bwd time: 30.0122 / Avg. batch time: 507.1836 (ms) / GPU bubble ratio: 27.04%
[rank1]:2026-01-02 19:49:52,495 -  step: 800  loss: -4.0000  grad_norm:  0.2740  memory: 77.37GiB(55.34%)  tps: 8,024  tflops: 374.23  mfu: 37.84%
[rank0]:2026-01-02 19:49:52,464 - Avg. fwd time: 14.7794 / Avg. bwd time: 26.3023 / Avg. batch time: 540.6006 (ms) / GPU bubble ratio: 39.21%
[rank0]:2026-01-02 19:49:52,499 -  step: 800  loss: -4.0000  grad_norm:  0.2740  memory: 80.61GiB(57.65%)  tps: 8,024  tflops: 374.23  mfu: 37.84%
[rank0]:2026-01-02 19:49:52,546 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1949_stage0_step800.svg
[rank3]:2026-01-02 19:49:52,497 -  step: 800  loss:  0.2717  grad_norm:  0.2740  memory: 84.06GiB(60.12%)  tps: 8,024  tflops: 374.24  mfu: 37.84%
[rank2]:2026-01-02 19:49:52,548 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1949_stage2_step800.svg
[rank1]:2026-01-02 19:49:52,548 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1949_stage1_step800.svg
[rank3]:2026-01-02 19:49:52,623 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1949_step800_rank3.svg
[rank3]:			> Batch Time: 488.75 ms, GPU Bubble Ratio: 41.99%, 32.01%, 37.45%, 33.12%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  280-42-323ms   | [S0,MB1,B]  323-43-366ms   | [S0,MB2,B]  366-43-410ms   | [S0,MB3,B]  410-35-446ms   | [S0,MB4,B]  446-0-446ms    | [S0,MB5,B]  446-0-446ms    | [S0,MB6,B]  467-0-467ms    | [S0,MB7,B]  488-0-488ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  235-45-280ms   | [S1,MB1,B]  280-31-311ms   | [S1,MB2,B]  315-20-336ms   | [S1,MB3,B]  336-20-357ms   | [S1,MB4,B]  366-20-387ms   | [S1,MB5,B]  410-20-431ms   | [S1,MB6,B]  446-20-466ms   | [S1,MB7,B]  467-20-487ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  216-18-235ms   | [S2,MB1,B]  237-40-277ms   | [S2,MB2,B]  277-37-315ms   | [S2,MB3,B]  315-19-334ms   | [S2,MB4,B]  336-18-355ms   | [S2,MB5,B]  357-18-376ms   | [S2,MB6,B]  378-18-397ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-21-215ms   | [S3,MB1,B]  215-20-236ms   | [S3,MB2,B]  236-31-268ms   | [S3,MB3,B]  268-21-289ms   | [S3,MB4,B]  289-46-336ms   | [S3,MB5,B]  336-21-357ms   | [S3,MB6,B]  357-20-377ms   | [S3,MB7,B]  377-20-398ms  
[rank3]:2026-01-02 19:49:52,668 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1949_stage3_step800.svg
[rank2]:2026-01-02 19:49:52,720 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1949_rank2_stage2.svg
[rank2]:	> Counts Sum: 1035520, Total Sum: 1428480 (72.49%), Ratio(%) per element: [75.4, 71.77, 68.95, 71.16, 72.78, 77.21, 77.62, 66.73, 66.53, 78.22, 75.8, 69.95, 71.57, 73.38, 75.4, 77.21, 66.53, 68.34, 78.62, 71.77, 68.14, 75.8, 75.4, 76.61, 71.97, 65.92, 66.73, 78.42, 70.76, 68.75, 68.14, 75.4, 78.22, 78.02, 66.93, 66.33, 76.2, 67.94, 72.98, 76.41, 78.42, 79.03, 76.41, 65.72, 66.33, 76.2, 70.56, 74.19, 70.16, 79.03, 74.59, 73.79, 67.33, 66.33, 77.62, 70.16, 73.38, 73.79, 77.62, 74.19, 77.21, 65.92, 66.73, 74.19, 66.73, 67.94, 71.97, 76.61, 75.0, 77.82, 67.13, 66.93]
[rank1]:2026-01-02 19:49:52,726 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1949_rank1_stage1.svg
[rank1]:	> Counts Sum: 1232960, Total Sum: 1607040 (76.72%), Ratio(%) per element: [81.45, 74.39, 73.18, 73.38, 75.4, 84.87, 81.25, 70.16, 70.16, 82.25, 73.18, 70.96, 80.24, 77.41, 78.62, 84.27, 68.34, 70.56, 76.61, 80.64, 72.78, 73.18, 82.66, 81.65, 82.86, 71.77, 69.95, 78.22, 71.97, 72.58, 73.79, 84.07, 82.05, 76.2, 69.95, 68.14, 79.83, 79.03, 75.6, 75.8, 76.2, 82.05, 83.26, 69.55, 70.96, 80.24, 78.42, 81.45, 76.41, 82.66, 83.87, 81.45, 70.56, 70.16, 81.85, 82.86, 72.37, 74.19, 83.26, 81.04, 83.46, 69.15, 70.96, 80.44, 75.6, 73.79, 69.15, 79.63, 79.63, 83.66, 69.15, 70.16, 78.62, 72.58, 77.62, 75.8, 84.27, 84.47, 82.66, 69.95, 71.16]
[rank0]:2026-01-02 19:49:52,717 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1949_rank0_stage0.svg
[rank0]:	> Counts Sum: 753600, Total Sum: 1448320 (52.03%), Ratio(%) per element: [51.61, 50.8, 50.0, 47.37, 52.21, 53.42, 53.42, 53.83, 47.17, 47.78, 52.01, 51.41, 48.58, 53.22, 55.24, 51.0, 56.85, 47.78, 46.77, 52.62, 51.0, 51.81, 55.44, 53.22, 57.66, 49.39, 47.98, 47.78, 55.44, 52.01, 56.85, 53.02, 57.05, 56.25, 57.66, 47.17, 47.58, 52.21, 52.01, 47.37, 49.39, 52.41, 54.83, 57.45, 46.37, 48.18, 51.61, 52.82, 54.43, 52.21, 55.84, 54.03, 54.03, 47.58, 48.18, 53.22, 51.2, 50.2, 50.4, 58.06, 56.04, 57.05, 47.37, 48.79, 56.45, 47.98, 52.41, 51.41, 53.22, 58.87, 57.45, 47.78, 48.79]
[rank3]:2026-01-02 19:49:52,829 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1949_rank3_stage3.svg
[rank3]:	> Counts Sum: 989520, Total Sum: 1289600 (76.73%), Ratio(%) per element: [84.27, 80.04, 67.94, 79.03, 74.59, 80.64, 79.03, 67.13, 68.14, 85.08, 72.78, 73.58, 78.22, 85.28, 81.25, 85.08, 68.34, 66.73, 72.78, 73.38, 69.75, 81.25, 83.66, 85.48, 84.27, 68.34, 68.34, 84.07, 80.04, 76.2, 75.0, 85.08, 84.47, 83.06, 69.55, 68.95, 85.28, 79.63, 72.58, 83.46, 84.87, 84.67, 85.08, 67.54, 67.74, 70.16, 81.04, 67.74, 73.58, 78.62, 82.05, 81.04, 67.54, 67.13, 84.27, 67.54, 81.65, 79.43, 80.44, 86.49, 85.48, 68.75, 67.33, 68.34, 66.93]
[rank2]:2026-01-02 19:49:53,431 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1949_stage2.svg
[rank1]:2026-01-02 19:49:53,442 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1949_stage1.svg
[rank0]:2026-01-02 19:49:53,442 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1949_stage0.svg
[rank3]:2026-01-02 19:49:53,536 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1949_stage3.svg
[rank0]:2026-01-02 19:51:33,724 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 19:51:35,723 - Avg. fwd time: 14.2832 / Avg. bwd time: 27.4176 / Avg. batch time: 431.8275 (ms) / GPU bubble ratio: 22.75%
[rank3]:2026-01-02 19:51:35,695 - Avg. fwd time: 15.2819 / Avg. bwd time: 30.4775 / Avg. batch time: 383.1896 (ms) / GPU bubble ratio: 4.47%
[rank1]:2026-01-02 19:51:35,779 - Avg. fwd time: 16.2510 / Avg. bwd time: 29.7297 / Avg. batch time: 504.9127 (ms) / GPU bubble ratio: 27.15%
[rank1]:2026-01-02 19:51:35,816 -  step: 850  loss: -4.0000  grad_norm:  0.1875  memory: 77.37GiB(55.34%)  tps: 7,929  tflops: 369.80  mfu: 37.39%
[rank2]:2026-01-02 19:51:35,814 -  step: 850  loss: -4.0000  grad_norm:  0.1875  memory: 68.83GiB(49.23%)  tps: 7,929  tflops: 369.80  mfu: 37.39%
[rank0]:2026-01-02 19:51:35,785 - Avg. fwd time: 14.7794 / Avg. bwd time: 25.9512 / Avg. batch time: 537.4762 (ms) / GPU bubble ratio: 39.38%
[rank0]:2026-01-02 19:51:35,820 -  step: 850  loss: -4.0000  grad_norm:  0.1875  memory: 80.62GiB(57.67%)  tps: 7,929  tflops: 369.79  mfu: 37.39%
[rank3]:2026-01-02 19:51:35,818 -  step: 850  loss:  0.1242  grad_norm:  0.1875  memory: 84.06GiB(60.12%)  tps: 7,929  tflops: 369.80  mfu: 37.39%
[rank0]:2026-01-02 19:53:14,788 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 19:53:16,801 - Avg. fwd time: 14.2778 / Avg. bwd time: 27.2014 / Avg. batch time: 429.4094 (ms) / GPU bubble ratio: 22.72%
[rank3]:2026-01-02 19:53:16,774 - Avg. fwd time: 15.2730 / Avg. bwd time: 30.1955 / Avg. batch time: 380.8558 (ms) / GPU bubble ratio: 4.49%
[rank1]:2026-01-02 19:53:16,856 - Avg. fwd time: 16.2456 / Avg. bwd time: 29.4729 / Avg. batch time: 502.7094 (ms) / GPU bubble ratio: 27.24%
[rank1]:2026-01-02 19:53:16,893 -  step: 900  loss: -4.0000  grad_norm:  0.2166  memory: 77.37GiB(55.34%)  tps: 8,105  tflops: 378.00  mfu: 38.22%
[rank2]:2026-01-02 19:53:16,891 -  step: 900  loss: -4.0000  grad_norm:  0.2166  memory: 68.83GiB(49.23%)  tps: 8,105  tflops: 378.01  mfu: 38.22%
[rank0]:2026-01-02 19:53:16,862 - Avg. fwd time: 14.7694 / Avg. bwd time: 25.6333 / Avg. batch time: 534.5079 (ms) / GPU bubble ratio: 39.53%
[rank0]:2026-01-02 19:53:16,897 -  step: 900  loss: -4.0000  grad_norm:  0.2166  memory: 80.62GiB(57.67%)  tps: 8,105  tflops: 378.01  mfu: 38.22%
[rank3]:2026-01-02 19:53:16,896 -  step: 900  loss:  0.1884  grad_norm:  0.2166  memory: 84.06GiB(60.12%)  tps: 8,105  tflops: 378.01  mfu: 38.22%
[rank1]:2026-01-02 19:53:16,940 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1953_stage1_step900.svg
[rank2]:2026-01-02 19:53:16,941 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1953_stage2_step900.svg
[rank0]:2026-01-02 19:53:16,939 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1953_stage0_step900.svg
[rank3]:2026-01-02 19:53:17,024 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1953_step900_rank3.svg
[rank3]:			> Batch Time: 487.50 ms, GPU Bubble Ratio: 42.26%, 31.94%, 37.90%, 33.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-103ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  281-42-323ms   | [S0,MB1,B]  324-43-367ms   | [S0,MB2,B]  367-43-410ms   | [S0,MB3,B]  410-34-445ms   | [S0,MB4,B]  445-0-445ms    | [S0,MB5,B]  445-0-445ms    | [S0,MB6,B]  466-0-466ms    | [S0,MB7,B]  487-0-487ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-16-133ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  235-45-281ms   | [S1,MB1,B]  281-31-312ms   | [S1,MB2,B]  314-20-335ms   | [S1,MB3,B]  335-20-356ms   | [S1,MB4,B]  367-20-387ms   | [S1,MB5,B]  410-20-431ms   | [S1,MB6,B]  445-20-465ms   | [S1,MB7,B]  465-20-486ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  216-18-235ms   | [S2,MB1,B]  237-40-277ms   | [S2,MB2,B]  277-35-313ms   | [S2,MB3,B]  314-19-333ms   | [S2,MB4,B]  336-18-355ms   | [S2,MB5,B]  357-18-375ms   | [S2,MB6,B]  378-18-396ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-21-215ms   | [S3,MB1,B]  215-20-236ms   | [S3,MB2,B]  236-31-268ms   | [S3,MB3,B]  268-20-289ms   | [S3,MB4,B]  289-46-335ms   | [S3,MB5,B]  335-21-356ms   | [S3,MB6,B]  356-20-377ms   | [S3,MB7,B]  377-20-398ms  
[rank0]:2026-01-02 19:53:17,113 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1953_rank0_stage0.svg
[rank0]:	> Counts Sum: 877600, Total Sum: 1681920 (52.18%), Ratio(%) per element: [52.6, 51.21, 51.04, 47.74, 51.9, 53.12, 54.16, 53.81, 47.56, 48.09, 52.95, 51.21, 48.78, 53.64, 55.03, 51.21, 56.42, 48.09, 47.22, 52.95, 51.38, 51.9, 54.68, 53.29, 57.11, 50.0, 48.26, 48.09, 55.2, 52.77, 56.59, 53.29, 56.59, 55.9, 57.63, 47.56, 47.91, 51.9, 52.6, 47.74, 49.47, 52.25, 55.03, 56.94, 46.87, 48.43, 51.9, 52.43, 54.16, 51.9, 55.55, 54.51, 54.51, 47.91, 48.61, 53.64, 51.04, 50.86, 50.52, 57.29, 56.07, 56.59, 47.74, 48.95, 56.42, 49.13, 52.95, 51.38, 53.29, 58.68, 57.46, 48.09, 48.95]
[rank3]:2026-01-02 19:53:17,063 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1953_stage3_step900.svg
[rank1]:2026-01-02 19:53:17,121 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1953_rank1_stage1.svg
[rank1]:	> Counts Sum: 1440160, Total Sum: 1866240 (77.17%), Ratio(%) per element: [81.77, 75.69, 74.13, 74.82, 76.9, 84.54, 81.25, 70.83, 70.83, 82.46, 74.65, 72.39, 80.2, 77.95, 79.34, 84.2, 69.27, 71.18, 76.38, 80.72, 73.61, 73.61, 82.29, 81.42, 82.11, 72.22, 70.83, 78.64, 73.43, 73.61, 73.95, 83.5, 82.11, 77.08, 70.65, 69.09, 80.03, 79.16, 76.73, 76.38, 76.56, 82.63, 83.15, 70.31, 71.7, 80.9, 79.34, 81.07, 76.38, 82.63, 83.85, 81.25, 71.18, 70.83, 81.42, 82.63, 73.43, 74.3, 83.15, 81.07, 83.33, 69.96, 71.52, 81.07, 75.52, 74.65, 70.48, 80.03, 80.03, 84.02, 69.96, 70.83, 79.16, 74.13, 78.12, 76.56, 83.85, 84.02, 82.98, 70.65, 71.7]
[rank2]:2026-01-02 19:53:17,114 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1953_rank2_stage2.svg
[rank2]:	> Counts Sum: 1209120, Total Sum: 1658880 (72.89%), Ratio(%) per element: [75.69, 72.91, 69.79, 71.87, 73.26, 77.08, 77.6, 67.53, 67.36, 77.95, 75.86, 70.83, 72.39, 73.95, 76.04, 77.25, 67.36, 68.05, 78.12, 72.56, 69.44, 76.04, 76.04, 76.38, 72.56, 66.84, 67.18, 78.12, 70.13, 69.96, 69.27, 75.86, 77.95, 78.47, 67.7, 67.36, 76.04, 69.09, 73.78, 76.73, 78.12, 78.99, 76.56, 66.66, 66.49, 76.38, 71.18, 73.78, 71.0, 78.99, 74.82, 74.47, 68.05, 66.84, 77.6, 70.13, 73.95, 73.95, 77.25, 74.82, 77.25, 66.66, 68.05, 74.82, 67.53, 68.22, 71.87, 76.73, 75.17, 77.77, 67.7, 67.36]
[rank3]:2026-01-02 19:53:17,225 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1953_rank3_stage3.svg
[rank3]:	> Counts Sum: 1155920, Total Sum: 1497600 (77.18%), Ratio(%) per element: [84.37, 80.38, 68.75, 78.12, 76.04, 80.9, 80.2, 67.7, 68.75, 85.06, 72.74, 74.82, 78.64, 85.41, 81.77, 84.89, 68.92, 67.53, 74.47, 74.65, 71.52, 81.59, 83.68, 84.89, 84.37, 68.75, 68.92, 84.2, 80.9, 77.6, 76.56, 85.06, 84.72, 83.33, 70.13, 69.96, 85.24, 80.03, 72.56, 83.5, 84.54, 84.54, 84.89, 67.88, 68.05, 70.65, 81.94, 68.05, 75.0, 79.68, 82.29, 81.59, 68.05, 67.88, 83.85, 67.7, 82.11, 80.38, 80.72, 86.45, 85.24, 69.27, 67.88, 68.75, 67.7]
[rank2]:2026-01-02 19:53:17,934 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1953_stage2.svg
[rank1]:2026-01-02 19:53:17,957 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1953_stage1.svg
[rank0]:2026-01-02 19:53:17,944 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1953_stage0.svg
[rank3]:2026-01-02 19:53:18,048 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1953_stage3.svg
[rank0]:2026-01-02 19:54:57,924 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 19:54:59,924 - Avg. fwd time: 15.2732 / Avg. bwd time: 29.9498 / Avg. batch time: 378.8864 (ms) / GPU bubble ratio: 4.51%
[rank2]:2026-01-02 19:54:59,954 - Avg. fwd time: 14.2794 / Avg. bwd time: 27.0087 / Avg. batch time: 427.3550 (ms) / GPU bubble ratio: 22.71%
[rank1]:2026-01-02 19:55:00,010 - Avg. fwd time: 16.2480 / Avg. bwd time: 29.2480 / Avg. batch time: 500.9046 (ms) / GPU bubble ratio: 27.34%
[rank1]:2026-01-02 19:55:00,048 -  step: 950  loss: -4.0000  grad_norm:  0.3509  memory: 77.37GiB(55.34%)  tps: 7,941  tflops: 370.39  mfu: 37.45%
[rank2]:2026-01-02 19:55:00,046 -  step: 950  loss: -4.0000  grad_norm:  0.3509  memory: 68.83GiB(49.23%)  tps: 7,941  tflops: 370.39  mfu: 37.45%
[rank0]:2026-01-02 19:55:00,017 - Avg. fwd time: 14.7681 / Avg. bwd time: 25.3559 / Avg. batch time: 532.0228 (ms) / GPU bubble ratio: 39.67%
[rank0]:2026-01-02 19:55:00,052 -  step: 950  loss: -4.0000  grad_norm:  0.3509  memory: 80.62GiB(57.67%)  tps: 7,941  tflops: 370.39  mfu: 37.45%
[rank3]:2026-01-02 19:55:00,050 -  step: 950  loss:  0.2438  grad_norm:  0.3509  memory: 84.06GiB(60.12%)  tps: 7,942  tflops: 370.40  mfu: 37.45%
[rank0]:2026-01-02 19:56:40,511 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 19:56:42,568 - Avg. fwd time: 14.2832 / Avg. bwd time: 26.8404 / Avg. batch time: 425.5420 (ms) / GPU bubble ratio: 22.69%
[rank3]:2026-01-02 19:56:42,535 - Avg. fwd time: 15.2772 / Avg. bwd time: 29.7355 / Avg. batch time: 377.2009 (ms) / GPU bubble ratio: 4.53%
[rank1]:2026-01-02 19:56:42,626 - Avg. fwd time: 16.2523 / Avg. bwd time: 29.0540 / Avg. batch time: 499.3428 (ms) / GPU bubble ratio: 27.41%
[rank1]:2026-01-02 19:56:42,664 -  step: 1000  loss: -4.0000  grad_norm:  0.1566  memory: 77.37GiB(55.34%)  tps: 7,983  tflops: 372.34  mfu: 37.65%
[rank1]:2026-01-02 19:56:42,665 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 19:56:42,662 -  step: 1000  loss: -4.0000  grad_norm:  0.1566  memory: 68.83GiB(49.23%)  tps: 7,983  tflops: 372.34  mfu: 37.65%
[rank2]:2026-01-02 19:56:42,662 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 19:56:42,633 - Avg. fwd time: 14.7685 / Avg. bwd time: 25.1099 / Avg. batch time: 529.8511 (ms) / GPU bubble ratio: 39.79%
[rank0]:2026-01-02 19:56:42,668 -  step: 1000  loss: -4.0000  grad_norm:  0.1566  memory: 80.62GiB(57.67%)  tps: 7,983  tflops: 372.34  mfu: 37.65%
[rank0]:2026-01-02 19:56:42,669 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 19:56:42,669 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank3]:2026-01-02 19:56:42,667 -  step: 1000  loss:  0.1589  grad_norm:  0.1566  memory: 84.06GiB(60.12%)  tps: 7,983  tflops: 372.34  mfu: 37.65%
[rank3]:2026-01-02 19:56:42,667 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 19:56:54,596 - Finished saving the checkpoint (or staging if async is enabled)in 11.93 seconds.
[rank1]:2026-01-02 19:56:55,318 - Finished saving the checkpoint (or staging if async is enabled)in 12.65 seconds.
[rank3]:2026-01-02 19:56:55,843 - Finished saving the checkpoint (or staging if async is enabled)in 13.18 seconds.
[rank1]:2026-01-02 19:56:58,663 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_1956_stage1_step1000.svg
[rank2]:2026-01-02 19:56:58,664 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_1956_stage2_step1000.svg
[rank0]:2026-01-02 19:56:58,608 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 19:56:58,609 - Finished saving the checkpoint (or staging if async is enabled)in 15.94 seconds.
[rank0]:2026-01-02 19:56:58,661 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_1956_stage0_step1000.svg
[rank3]:2026-01-02 19:56:58,746 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_1956_step1000_rank3.svg
[rank3]:			> Batch Time: 495.75 ms, GPU Bubble Ratio: 42.67%, 32.31%, 38.53%, 32.65%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-118ms   | [S0,MB0,B]  287-42-330ms   | [S0,MB1,B]  330-43-373ms   | [S0,MB2,B]  373-43-417ms   | [S0,MB3,B]  417-35-453ms   | [S0,MB4,B]  453-0-453ms    | [S0,MB5,B]  453-0-453ms    | [S0,MB6,B]  474-0-474ms    | [S0,MB7,B]  495-0-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  86-15-102ms    | [S1,MB5,F]  102-16-118ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-151ms   | [S1,MB0,B]  242-45-287ms   | [S1,MB1,B]  287-33-321ms   | [S1,MB2,B]  321-20-342ms   | [S1,MB3,B]  342-21-363ms   | [S1,MB4,B]  373-21-394ms   | [S1,MB5,B]  417-20-438ms   | [S1,MB6,B]  453-20-474ms   | [S1,MB7,B]  474-20-495ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  118-13-132ms   | [S2,MB6,F]  134-13-148ms   | [S2,MB7,F]  151-13-165ms   | [S2,MB0,B]  223-18-241ms   | [S2,MB1,B]  244-40-284ms   | [S2,MB2,B]  284-36-321ms   | [S2,MB3,B]  321-19-340ms   | [S2,MB4,B]  343-18-362ms   | [S2,MB5,B]  364-18-383ms   | [S2,MB6,B]  385-18-404ms   | [S2,MB7,B]  417-18-435ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  110-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-15-158ms   | [S3,MB6,F]  161-15-176ms   | [S3,MB7,F]  178-15-193ms   | [S3,MB0,B]  195-27-222ms   | [S3,MB1,B]  222-21-243ms   | [S3,MB2,B]  243-32-276ms   | [S3,MB3,B]  276-20-297ms   | [S3,MB4,B]  297-46-343ms   | [S3,MB5,B]  343-21-364ms   | [S3,MB6,B]  364-20-385ms   | [S3,MB7,B]  384-20-405ms  
[rank3]:2026-01-02 19:56:58,787 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_1956_stage3_step1000.svg
[rank1]:2026-01-02 19:56:58,843 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1956_rank1_stage1.svg
[rank1]:	> Counts Sum: 1647360, Total Sum: 2125440 (77.51%), Ratio(%) per element: [81.4, 76.37, 74.69, 75.76, 77.28, 84.14, 81.55, 71.34, 71.34, 82.31, 75.3, 73.47, 80.18, 78.35, 79.57, 83.68, 69.96, 71.79, 77.59, 81.09, 74.69, 74.69, 82.16, 82.01, 81.7, 72.56, 71.34, 79.11, 74.08, 74.23, 74.08, 83.68, 82.16, 77.59, 71.18, 69.81, 80.33, 79.57, 76.82, 77.13, 77.28, 82.31, 83.07, 70.88, 72.1, 80.94, 79.57, 81.09, 76.21, 82.31, 83.68, 80.79, 71.64, 71.34, 80.94, 82.46, 74.39, 75.3, 83.07, 81.09, 83.07, 70.57, 71.95, 81.4, 76.06, 75.15, 72.1, 80.48, 80.33, 83.53, 70.57, 71.34, 79.72, 75.3, 79.11, 76.98, 83.68, 83.68, 82.77, 71.18, 72.1]
[rank2]:2026-01-02 19:56:58,838 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1956_rank2_stage2.svg
[rank2]:	> Counts Sum: 1382720, Total Sum: 1889280 (73.19%), Ratio(%) per element: [75.6, 73.78, 70.42, 72.25, 74.08, 77.28, 77.28, 67.98, 68.14, 77.74, 76.06, 71.64, 72.86, 74.39, 76.37, 77.13, 67.22, 68.75, 77.74, 73.01, 70.42, 76.06, 76.06, 76.52, 73.01, 67.83, 67.37, 78.04, 69.96, 70.57, 69.96, 75.91, 78.04, 78.35, 67.53, 67.98, 76.21, 70.12, 74.39, 76.82, 78.2, 78.5, 76.98, 66.92, 66.92, 76.52, 71.79, 73.32, 71.79, 78.81, 75.0, 75.0, 68.29, 67.37, 77.59, 70.27, 74.23, 74.08, 77.28, 75.3, 77.59, 67.22, 68.59, 75.15, 69.05, 68.44, 72.1, 77.13, 75.3, 77.59, 67.98, 67.98]
[rank0]:2026-01-02 19:56:58,871 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1956_rank0_stage0.svg
[rank0]:	> Counts Sum: 1001600, Total Sum: 1915520 (52.29%), Ratio(%) per element: [52.43, 51.98, 51.37, 48.01, 51.67, 53.35, 54.11, 53.81, 47.86, 48.32, 53.04, 51.06, 48.93, 53.65, 55.33, 51.52, 56.4, 48.32, 47.56, 52.89, 51.82, 51.98, 54.11, 53.81, 56.7, 50.91, 48.47, 48.47, 55.33, 52.89, 56.4, 53.04, 56.25, 56.25, 57.16, 47.86, 48.17, 51.82, 52.74, 48.01, 50.0, 51.98, 55.03, 56.55, 47.25, 48.62, 52.74, 52.28, 54.26, 51.67, 55.79, 54.26, 55.03, 48.17, 48.78, 53.5, 50.91, 50.76, 50.76, 57.16, 56.25, 56.25, 48.01, 49.08, 56.4, 49.69, 53.5, 51.98, 53.65, 58.23, 57.01, 48.32, 49.08]
[rank3]:2026-01-02 19:56:59,054 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_1956_rank3_stage3.svg
[rank3]:	> Counts Sum: 1322320, Total Sum: 1705600 (77.53%), Ratio(%) per element: [84.6, 80.33, 68.9, 77.59, 76.82, 81.55, 80.64, 68.14, 69.35, 85.06, 72.71, 75.91, 79.42, 85.51, 82.01, 84.9, 69.05, 68.44, 75.91, 75.15, 73.32, 81.7, 83.53, 85.06, 84.6, 68.9, 68.9, 83.99, 81.25, 78.35, 77.43, 84.9, 84.9, 83.53, 70.57, 70.27, 85.06, 80.48, 72.71, 83.84, 84.45, 84.45, 84.75, 68.14, 68.44, 71.95, 82.16, 68.44, 76.37, 80.18, 82.31, 82.16, 68.29, 68.29, 83.99, 68.29, 82.46, 80.64, 81.09, 86.12, 85.06, 69.51, 68.59, 69.35, 68.29]
[rank1]:2026-01-02 19:56:59,906 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1956_stage1.svg
[rank2]:2026-01-02 19:56:59,888 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1956_stage2.svg
[rank0]:2026-01-02 19:56:59,935 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1956_stage0.svg
[rank3]:2026-01-02 19:57:00,039 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_1956_stage3.svg
[rank0]:2026-01-02 19:58:42,519 - [GC] Peforming periodical GC collection 1.88 seconds
[rank2]:2026-01-02 19:58:44,650 - Avg. fwd time: 14.2818 / Avg. bwd time: 26.6822 / Avg. batch time: 423.9972 (ms) / GPU bubble ratio: 22.71%
[rank3]:2026-01-02 19:58:44,622 - Avg. fwd time: 15.2765 / Avg. bwd time: 29.5404 / Avg. batch time: 375.7355 (ms) / GPU bubble ratio: 4.58%
[rank1]:2026-01-02 19:58:44,711 - Avg. fwd time: 16.2513 / Avg. bwd time: 28.8749 / Avg. batch time: 498.0377 (ms) / GPU bubble ratio: 27.51%
[rank1]:2026-01-02 19:58:44,751 -  step: 1050  loss: -4.0000  grad_norm:  0.4933  memory: 77.37GiB(55.34%)  tps: 6,710  tflops: 312.96  mfu: 31.64%
[rank2]:2026-01-02 19:58:44,748 -  step: 1050  loss: -4.0000  grad_norm:  0.4933  memory: 68.83GiB(49.23%)  tps: 6,710  tflops: 312.96  mfu: 31.64%
[rank0]:2026-01-02 19:58:44,719 - Avg. fwd time: 14.7636 / Avg. bwd time: 24.8869 / Avg. batch time: 527.9997 (ms) / GPU bubble ratio: 39.92%
[rank0]:2026-01-02 19:58:44,755 -  step: 1050  loss: -4.0000  grad_norm:  0.4933  memory: 80.62GiB(57.67%)  tps: 6,710  tflops: 312.96  mfu: 31.64%
[rank3]:2026-01-02 19:58:44,753 -  step: 1050  loss:  0.2738  grad_norm:  0.4933  memory: 84.06GiB(60.12%)  tps: 6,710  tflops: 312.96  mfu: 31.64%
[rank0]:2026-01-02 20:00:27,355 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:00:29,420 - Avg. fwd time: 14.2951 / Avg. bwd time: 26.5495 / Avg. batch time: 422.8023 (ms) / GPU bubble ratio: 22.72%
[rank3]:2026-01-02 20:00:29,389 - Avg. fwd time: 15.2925 / Avg. bwd time: 29.3944 / Avg. batch time: 374.6901 (ms) / GPU bubble ratio: 4.59%
[rank1]:2026-01-02 20:00:29,480 - Avg. fwd time: 16.2658 / Avg. bwd time: 28.7156 / Avg. batch time: 497.0767 (ms) / GPU bubble ratio: 27.61%
[rank1]:2026-01-02 20:00:29,519 -  step: 1100  loss: -4.0000  grad_norm:  0.1993  memory: 77.37GiB(55.34%)  tps: 7,819  tflops: 364.69  mfu: 36.87%
[rank2]:2026-01-02 20:00:29,517 -  step: 1100  loss: -4.0000  grad_norm:  0.1993  memory: 68.83GiB(49.23%)  tps: 7,819  tflops: 364.69  mfu: 36.87%
[rank0]:2026-01-02 20:00:29,488 - Avg. fwd time: 14.7740 / Avg. bwd time: 24.6873 / Avg. batch time: 526.5445 (ms) / GPU bubble ratio: 40.04%
[rank0]:2026-01-02 20:00:29,523 -  step: 1100  loss: -4.0000  grad_norm:  0.1993  memory: 80.62GiB(57.67%)  tps: 7,819  tflops: 364.69  mfu: 36.87%
[rank0]:2026-01-02 20:00:29,569 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2000_stage0_step1100.svg
[rank3]:2026-01-02 20:00:29,521 -  step: 1100  loss:  0.2252  grad_norm:  0.1993  memory: 84.06GiB(60.12%)  tps: 7,819  tflops: 364.69  mfu: 36.87%
[rank1]:2026-01-02 20:00:29,571 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2000_stage1_step1100.svg
[rank2]:2026-01-02 20:00:29,570 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2000_stage2_step1100.svg
[rank3]:2026-01-02 20:00:29,649 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2000_step1100_rank3.svg
[rank3]:			> Batch Time: 499.25 ms, GPU Bubble Ratio: 42.72%, 32.49%, 38.22%, 32.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-15-120ms   | [S0,MB0,B]  291-42-334ms   | [S0,MB1,B]  334-43-377ms   | [S0,MB2,B]  377-43-421ms   | [S0,MB3,B]  421-35-456ms   | [S0,MB4,B]  456-0-456ms    | [S0,MB5,B]  456-0-456ms    | [S0,MB6,B]  477-0-477ms    | [S0,MB7,B]  499-0-499ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-87ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-120ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  137-16-153ms   | [S1,MB0,B]  245-45-291ms   | [S1,MB1,B]  291-32-323ms   | [S1,MB2,B]  326-21-347ms   | [S1,MB3,B]  347-21-368ms   | [S1,MB4,B]  377-21-398ms   | [S1,MB5,B]  421-20-441ms   | [S1,MB6,B]  456-20-477ms   | [S1,MB7,B]  477-20-498ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  87-14-101ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  120-14-134ms   | [S2,MB6,F]  136-14-151ms   | [S2,MB7,F]  153-14-167ms   | [S2,MB0,B]  227-18-245ms   | [S2,MB1,B]  248-40-288ms   | [S2,MB2,B]  288-37-325ms   | [S2,MB3,B]  326-19-345ms   | [S2,MB4,B]  348-18-367ms   | [S2,MB5,B]  369-18-388ms   | [S2,MB6,B]  390-18-409ms   | [S2,MB7,B]  421-18-439ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  146-15-161ms   | [S3,MB6,F]  163-15-178ms   | [S3,MB7,F]  181-15-196ms   | [S3,MB0,B]  198-27-226ms   | [S3,MB1,B]  226-21-247ms   | [S3,MB2,B]  247-32-280ms   | [S3,MB3,B]  280-21-301ms   | [S3,MB4,B]  301-46-348ms   | [S3,MB5,B]  347-21-368ms   | [S3,MB6,B]  369-21-390ms   | [S3,MB7,B]  390-21-411ms  
[rank2]:2026-01-02 20:00:29,744 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2000_rank2_stage2.svg
[rank2]:	> Counts Sum: 1556320, Total Sum: 2119680 (73.42%), Ratio(%) per element: [75.81, 73.91, 71.19, 72.69, 74.45, 77.58, 77.03, 68.61, 68.2, 77.85, 75.95, 72.28, 73.5, 74.86, 76.49, 77.17, 67.25, 69.29, 77.85, 73.64, 70.92, 76.08, 76.35, 76.76, 73.23, 67.93, 67.79, 78.12, 70.65, 71.05, 70.65, 76.08, 78.39, 78.12, 67.93, 68.07, 76.22, 71.05, 74.72, 77.03, 78.26, 78.39, 77.03, 67.39, 67.52, 76.76, 72.14, 72.55, 72.41, 78.53, 75.27, 75.13, 68.2, 67.39, 77.3, 70.78, 74.59, 74.32, 77.03, 75.54, 77.3, 67.25, 69.02, 75.54, 69.83, 69.02, 72.41, 77.17, 75.4, 77.3, 68.34, 68.2]
[rank0]:2026-01-02 20:00:29,741 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2000_rank0_stage0.svg
[rank0]:	> Counts Sum: 1125600, Total Sum: 2149120 (52.37%), Ratio(%) per element: [52.3, 52.3, 51.49, 48.23, 52.03, 53.39, 54.34, 54.21, 48.09, 48.5, 53.12, 50.95, 49.04, 53.8, 55.02, 51.76, 56.65, 48.5, 47.82, 53.26, 52.17, 52.44, 53.66, 53.53, 56.38, 51.22, 48.64, 48.64, 55.02, 52.98, 56.38, 52.71, 56.11, 55.97, 56.92, 48.09, 48.36, 52.3, 53.26, 48.23, 50.54, 51.76, 55.16, 56.25, 47.55, 48.77, 53.12, 52.44, 54.48, 51.63, 56.38, 54.48, 54.89, 48.36, 48.91, 53.66, 50.81, 51.08, 50.67, 56.92, 56.11, 55.97, 48.23, 49.18, 56.11, 50.13, 53.66, 52.03, 54.07, 57.47, 56.52, 48.5, 49.32]
[rank3]:2026-01-02 20:00:29,690 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2000_stage3_step1100.svg
[rank1]:2026-01-02 20:00:29,751 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2000_rank1_stage1.svg
[rank1]:	> Counts Sum: 1854560, Total Sum: 2384640 (77.77%), Ratio(%) per element: [81.38, 77.17, 75.54, 76.22, 78.12, 83.96, 81.92, 71.73, 71.73, 81.92, 76.22, 74.32, 80.57, 78.66, 79.89, 83.55, 70.51, 72.28, 77.85, 81.52, 75.67, 75.27, 82.2, 82.33, 81.65, 72.82, 71.73, 79.61, 74.72, 74.59, 74.45, 83.15, 81.92, 77.85, 71.6, 70.38, 80.57, 79.34, 77.3, 77.85, 77.3, 82.33, 83.01, 71.33, 72.41, 81.25, 79.34, 80.43, 76.08, 82.2, 83.42, 81.25, 72.01, 71.73, 80.7, 82.47, 75.4, 76.35, 83.42, 80.84, 82.88, 71.05, 72.28, 81.11, 75.95, 75.95, 73.5, 80.29, 80.57, 83.15, 71.05, 71.73, 80.02, 75.95, 79.48, 77.85, 82.74, 83.42, 82.74, 71.6, 72.41]
[rank3]:2026-01-02 20:00:29,851 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2000_rank3_stage3.svg
[rank3]:	> Counts Sum: 1488720, Total Sum: 1913600 (77.80%), Ratio(%) per element: [84.51, 80.97, 70.24, 76.76, 77.85, 81.79, 81.25, 68.61, 69.83, 85.32, 72.28, 76.63, 79.75, 85.59, 82.33, 84.78, 69.56, 68.88, 77.03, 75.81, 74.45, 81.52, 83.69, 84.91, 84.64, 69.29, 69.42, 83.83, 81.65, 78.94, 78.26, 85.19, 85.19, 83.55, 70.65, 70.38, 84.78, 80.84, 72.82, 83.83, 84.23, 84.37, 84.64, 68.47, 68.88, 73.5, 82.2, 68.75, 76.76, 80.7, 82.2, 82.47, 68.47, 68.61, 83.96, 68.47, 82.33, 81.11, 81.79, 85.73, 84.37, 69.97, 69.02, 69.7, 68.2]
[rank1]:2026-01-02 20:00:30,786 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2000_stage1.svg
[rank2]:2026-01-02 20:00:30,787 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2000_stage2.svg
[rank0]:2026-01-02 20:00:30,780 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2000_stage0.svg
[rank3]:2026-01-02 20:00:30,903 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2000_stage3.svg
[rank0]:2026-01-02 20:02:12,057 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:02:14,105 - Avg. fwd time: 14.2976 / Avg. bwd time: 26.4228 / Avg. batch time: 421.5768 (ms) / GPU bubble ratio: 22.73%
[rank3]:2026-01-02 20:02:14,074 - Avg. fwd time: 15.2955 / Avg. bwd time: 29.2546 / Avg. batch time: 373.5883 (ms) / GPU bubble ratio: 4.60%
[rank1]:2026-01-02 20:02:14,162 - Avg. fwd time: 16.2690 / Avg. bwd time: 28.5662 / Avg. batch time: 496.0600 (ms) / GPU bubble ratio: 27.69%
[rank1]:2026-01-02 20:02:14,202 -  step: 1150  loss: -4.0000  grad_norm:  0.2572  memory: 77.37GiB(55.34%)  tps: 7,826  tflops: 364.99  mfu: 36.90%
[rank2]:2026-01-02 20:02:14,200 -  step: 1150  loss: -4.0000  grad_norm:  0.2572  memory: 68.83GiB(49.23%)  tps: 7,826  tflops: 364.99  mfu: 36.90%
[rank0]:2026-01-02 20:02:14,171 - Avg. fwd time: 14.7744 / Avg. bwd time: 24.5043 / Avg. batch time: 525.0681 (ms) / GPU bubble ratio: 40.15%
[rank0]:2026-01-02 20:02:14,206 -  step: 1150  loss: -4.0000  grad_norm:  0.2572  memory: 80.62GiB(57.67%)  tps: 7,826  tflops: 364.99  mfu: 36.90%
[rank3]:2026-01-02 20:02:14,204 -  step: 1150  loss:  0.2125  grad_norm:  0.2572  memory: 84.06GiB(60.12%)  tps: 7,826  tflops: 364.99  mfu: 36.90%
[rank0]:2026-01-02 20:03:54,545 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:03:56,597 - Avg. fwd time: 14.2999 / Avg. bwd time: 26.3065 / Avg. batch time: 420.2861 (ms) / GPU bubble ratio: 22.71%
[rank3]:2026-01-02 20:03:56,568 - Avg. fwd time: 15.2972 / Avg. bwd time: 29.1087 / Avg. batch time: 372.4284 (ms) / GPU bubble ratio: 4.61%
[rank1]:2026-01-02 20:03:56,655 - Avg. fwd time: 16.2722 / Avg. bwd time: 28.4291 / Avg. batch time: 494.9391 (ms) / GPU bubble ratio: 27.75%
[rank1]:2026-01-02 20:03:56,695 -  step: 1200  loss: -4.0000  grad_norm:  0.2620  memory: 77.37GiB(55.34%)  tps: 7,993  tflops: 372.78  mfu: 37.69%
[rank2]:2026-01-02 20:03:56,692 -  step: 1200  loss: -4.0000  grad_norm:  0.2620  memory: 68.83GiB(49.23%)  tps: 7,993  tflops: 372.78  mfu: 37.69%
[rank0]:2026-01-02 20:03:56,663 - Avg. fwd time: 14.7743 / Avg. bwd time: 24.3341 / Avg. batch time: 523.5274 (ms) / GPU bubble ratio: 40.24%
[rank0]:2026-01-02 20:03:56,699 -  step: 1200  loss: -4.0000  grad_norm:  0.2620  memory: 80.62GiB(57.67%)  tps: 7,993  tflops: 372.78  mfu: 37.69%
[rank3]:2026-01-02 20:03:56,697 -  step: 1200  loss:  0.2711  grad_norm:  0.2620  memory: 84.06GiB(60.12%)  tps: 7,993  tflops: 372.79  mfu: 37.69%
[rank1]:2026-01-02 20:03:56,748 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2003_stage1_step1200.svg
[rank2]:2026-01-02 20:03:56,747 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2003_stage2_step1200.svg
[rank0]:2026-01-02 20:03:56,744 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2003_stage0_step1200.svg
[rank3]:2026-01-02 20:03:56,826 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2003_step1200_rank3.svg
[rank3]:			> Batch Time: 490.50 ms, GPU Bubble Ratio: 41.99%, 31.86%, 37.83%, 32.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  281-42-324ms   | [S0,MB1,B]  324-43-367ms   | [S0,MB2,B]  368-43-411ms   | [S0,MB3,B]  411-36-448ms   | [S0,MB4,B]  448-0-448ms    | [S0,MB5,B]  448-0-448ms    | [S0,MB6,B]  469-0-469ms    | [S0,MB7,B]  490-0-490ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-16-101ms    | [S1,MB5,F]  102-16-118ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  135-16-151ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  281-32-313ms   | [S1,MB2,B]  315-21-336ms   | [S1,MB3,B]  337-20-358ms   | [S1,MB4,B]  368-20-389ms   | [S1,MB5,B]  411-20-432ms   | [S1,MB6,B]  448-20-468ms   | [S1,MB7,B]  469-20-489ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  70-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  118-13-132ms   | [S2,MB6,F]  134-14-148ms   | [S2,MB7,F]  151-13-165ms   | [S2,MB0,B]  217-18-236ms   | [S2,MB1,B]  238-40-278ms   | [S2,MB2,B]  278-36-315ms   | [S2,MB3,B]  315-19-335ms   | [S2,MB4,B]  340-18-359ms   | [S2,MB5,B]  361-18-380ms   | [S2,MB6,B]  382-18-401ms   | [S2,MB7,B]  411-18-430ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-108ms    | [S3,MB3,F]  110-14-124ms   | [S3,MB4,F]  127-14-142ms   | [S3,MB5,F]  144-14-159ms   | [S3,MB6,F]  161-15-176ms   | [S3,MB7,F]  178-15-193ms   | [S3,MB0,B]  195-21-217ms   | [S3,MB1,B]  217-21-238ms   | [S3,MB2,B]  238-34-272ms   | [S3,MB3,B]  272-21-293ms   | [S3,MB4,B]  293-46-339ms   | [S3,MB5,B]  339-21-360ms   | [S3,MB6,B]  360-20-381ms   | [S3,MB7,B]  381-20-402ms  
[rank0]:2026-01-02 20:03:56,918 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2003_rank0_stage0.svg
[rank0]:	> Counts Sum: 1249600, Total Sum: 2382720 (52.44%), Ratio(%) per element: [52.08, 52.69, 51.34, 48.4, 52.08, 53.55, 54.16, 54.28, 48.28, 48.65, 52.94, 50.85, 49.14, 53.79, 54.9, 51.83, 56.86, 48.65, 48.03, 53.3, 52.69, 52.69, 53.3, 53.55, 56.37, 51.71, 48.77, 48.77, 55.26, 52.81, 56.25, 52.45, 56.12, 55.88, 56.61, 48.28, 48.52, 52.57, 53.43, 48.77, 50.98, 52.45, 55.26, 55.63, 47.79, 48.89, 53.06, 53.06, 54.65, 51.59, 56.49, 54.9, 54.9, 48.52, 49.01, 53.67, 51.34, 51.34, 50.61, 56.98, 56.12, 55.63, 48.4, 49.26, 55.88, 50.24, 53.55, 52.08, 53.92, 56.86, 56.37, 48.65, 49.38]
[rank3]:2026-01-02 20:03:56,869 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2003_stage3_step1200.svg
[rank1]:2026-01-02 20:03:56,928 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2003_rank1_stage1.svg
[rank1]:	> Counts Sum: 2061760, Total Sum: 2643840 (77.98%), Ratio(%) per element: [81.49, 77.69, 76.34, 76.71, 78.3, 83.7, 81.49, 72.05, 72.05, 81.98, 76.59, 75.24, 81.0, 78.92, 80.39, 83.21, 70.95, 72.54, 77.94, 81.61, 76.22, 75.49, 82.1, 82.47, 81.49, 73.03, 72.05, 79.65, 75.61, 75.36, 75.24, 82.96, 81.74, 77.94, 71.93, 70.83, 80.51, 79.41, 77.69, 77.94, 77.81, 82.1, 82.96, 71.69, 72.67, 81.0, 79.65, 79.9, 75.98, 82.1, 83.33, 81.37, 72.3, 72.05, 81.0, 82.59, 75.61, 77.2, 83.45, 81.0, 82.96, 71.44, 72.54, 81.25, 76.22, 76.34, 74.26, 80.39, 80.88, 82.96, 71.44, 72.05, 80.14, 76.47, 79.65, 78.3, 82.72, 83.33, 82.59, 72.05, 72.67]
[rank2]:2026-01-02 20:03:56,917 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2003_rank2_stage2.svg
[rank2]:	> Counts Sum: 1729920, Total Sum: 2350080 (73.61%), Ratio(%) per element: [75.98, 74.38, 71.81, 73.16, 74.63, 77.94, 77.45, 68.75, 68.25, 77.57, 76.22, 72.67, 73.65, 74.87, 76.71, 77.08, 67.76, 69.85, 77.57, 74.01, 71.44, 76.22, 76.71, 76.59, 73.52, 68.25, 68.01, 77.81, 71.07, 71.69, 71.07, 76.22, 78.18, 78.18, 68.01, 68.25, 76.47, 71.56, 75.12, 77.2, 78.3, 78.3, 76.96, 67.76, 67.64, 76.96, 72.67, 72.18, 72.67, 78.3, 75.61, 75.36, 68.5, 67.64, 77.2, 70.71, 74.87, 74.63, 76.96, 75.49, 77.08, 67.4, 69.24, 75.61, 70.83, 69.48, 72.67, 77.32, 75.61, 77.08, 68.25, 68.5]
[rank3]:2026-01-02 20:03:57,030 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2003_rank3_stage3.svg
[rank3]:	> Counts Sum: 1655120, Total Sum: 2121600 (78.01%), Ratio(%) per element: [84.31, 81.37, 71.32, 77.2, 78.06, 81.86, 81.61, 68.87, 69.97, 85.29, 72.91, 77.57, 80.14, 85.53, 82.23, 84.68, 69.6, 69.48, 78.06, 76.83, 75.24, 81.86, 83.82, 84.68, 84.55, 69.48, 69.73, 83.7, 81.98, 79.41, 78.55, 85.04, 85.04, 83.33, 70.71, 70.46, 84.68, 80.88, 73.16, 83.82, 84.43, 84.19, 84.55, 68.5, 68.99, 74.75, 81.74, 68.99, 77.57, 81.0, 81.98, 82.84, 68.75, 69.11, 84.06, 68.75, 82.23, 81.37, 81.98, 85.78, 84.06, 70.22, 69.36, 70.09, 68.25]
[rank0]:2026-01-02 20:03:58,038 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2003_stage0.svg
[rank1]:2026-01-02 20:03:58,088 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2003_stage1.svg
[rank2]:2026-01-02 20:03:58,048 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2003_stage2.svg
[rank3]:2026-01-02 20:03:58,220 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2003_stage3.svg
[rank0]:2026-01-02 20:05:38,325 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:05:40,350 - Avg. fwd time: 14.3002 / Avg. bwd time: 26.1978 / Avg. batch time: 419.0973 (ms) / GPU bubble ratio: 22.69%
[rank3]:2026-01-02 20:05:40,319 - Avg. fwd time: 15.2970 / Avg. bwd time: 28.9693 / Avg. batch time: 371.3052 (ms) / GPU bubble ratio: 4.63%
[rank0]:2026-01-02 20:05:40,414 - Avg. fwd time: 14.7737 / Avg. bwd time: 24.1793 / Avg. batch time: 522.1273 (ms) / GPU bubble ratio: 40.32%
[rank1]:2026-01-02 20:05:40,405 - Avg. fwd time: 16.2731 / Avg. bwd time: 28.3012 / Avg. batch time: 493.9207 (ms) / GPU bubble ratio: 27.80%
[rank1]:2026-01-02 20:05:40,445 -  step: 1250  loss: -4.0000  grad_norm:  0.2486  memory: 77.37GiB(55.34%)  tps: 7,896  tflops: 368.27  mfu: 37.24%
[rank2]:2026-01-02 20:05:40,443 -  step: 1250  loss: -4.0000  grad_norm:  0.2486  memory: 68.83GiB(49.23%)  tps: 7,896  tflops: 368.27  mfu: 37.24%
[rank3]:2026-01-02 20:05:40,447 -  step: 1250  loss:  0.2532  grad_norm:  0.2486  memory: 84.06GiB(60.12%)  tps: 7,896  tflops: 368.27  mfu: 37.24%
[rank0]:2026-01-02 20:05:40,449 -  step: 1250  loss: -4.0000  grad_norm:  0.2486  memory: 80.62GiB(57.67%)  tps: 7,896  tflops: 368.27  mfu: 37.24%
[rank0]:2026-01-02 20:07:20,785 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:07:22,775 - Avg. fwd time: 15.2981 / Avg. bwd time: 28.8393 / Avg. batch time: 370.2687 (ms) / GPU bubble ratio: 4.64%
[rank2]:2026-01-02 20:07:22,805 - Avg. fwd time: 14.3017 / Avg. bwd time: 26.0983 / Avg. batch time: 417.9984 (ms) / GPU bubble ratio: 22.68%
[rank0]:2026-01-02 20:07:22,870 - Avg. fwd time: 14.7731 / Avg. bwd time: 24.0374 / Avg. batch time: 520.8331 (ms) / GPU bubble ratio: 40.39%
[rank1]:2026-01-02 20:07:22,861 - Avg. fwd time: 16.2751 / Avg. bwd time: 28.1896 / Avg. batch time: 492.9845 (ms) / GPU bubble ratio: 27.84%
[rank1]:2026-01-02 20:07:22,901 -  step: 1300  loss: -4.0000  grad_norm:  0.1980  memory: 77.37GiB(55.34%)  tps: 7,996  tflops: 372.92  mfu: 37.71%
[rank1]:2026-01-02 20:07:22,952 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2007_stage1_step1300.svg
[rank2]:2026-01-02 20:07:22,899 -  step: 1300  loss: -4.0000  grad_norm:  0.1980  memory: 68.83GiB(49.23%)  tps: 7,996  tflops: 372.92  mfu: 37.71%
[rank2]:2026-01-02 20:07:22,954 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2007_stage2_step1300.svg
[rank3]:2026-01-02 20:07:22,904 -  step: 1300  loss:  0.1854  grad_norm:  0.1980  memory: 84.06GiB(60.12%)  tps: 7,996  tflops: 372.92  mfu: 37.71%
[rank0]:2026-01-02 20:07:22,905 -  step: 1300  loss: -4.0000  grad_norm:  0.1980  memory: 80.62GiB(57.67%)  tps: 7,996  tflops: 372.92  mfu: 37.71%
[rank0]:2026-01-02 20:07:22,949 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2007_stage0_step1300.svg
[rank3]:2026-01-02 20:07:23,029 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2007_step1300_rank3.svg
[rank3]:			> Batch Time: 488.00 ms, GPU Bubble Ratio: 42.10%, 31.58%, 37.69%, 33.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-14-59ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  103-14-117ms   | [S0,MB0,B]  280-42-323ms   | [S0,MB1,B]  323-43-366ms   | [S0,MB2,B]  366-43-409ms   | [S0,MB3,B]  409-35-445ms   | [S0,MB4,B]  445-0-445ms    | [S0,MB5,B]  445-0-445ms    | [S0,MB6,B]  466-0-466ms    | [S0,MB7,B]  488-0-488ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-16-117ms   | [S1,MB6,F]  118-15-134ms   | [S1,MB7,F]  134-15-150ms   | [S1,MB0,B]  234-45-280ms   | [S1,MB1,B]  280-33-313ms   | [S1,MB2,B]  314-21-335ms   | [S1,MB3,B]  335-20-356ms   | [S1,MB4,B]  366-20-387ms   | [S1,MB5,B]  409-20-430ms   | [S1,MB6,B]  445-20-466ms   | [S1,MB7,B]  466-20-487ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-98ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  216-18-234ms   | [S2,MB1,B]  236-40-277ms   | [S2,MB2,B]  277-37-314ms   | [S2,MB3,B]  314-19-333ms   | [S2,MB4,B]  335-18-354ms   | [S2,MB5,B]  356-18-374ms   | [S2,MB6,B]  376-18-395ms   | [S2,MB7,B]  409-18-428ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  143-14-157ms   | [S3,MB6,F]  160-14-174ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-21-215ms   | [S3,MB1,B]  215-20-236ms   | [S3,MB2,B]  236-31-267ms   | [S3,MB3,B]  267-20-288ms   | [S3,MB4,B]  288-46-334ms   | [S3,MB5,B]  334-20-355ms   | [S3,MB6,B]  355-20-376ms   | [S3,MB7,B]  376-20-396ms  
[rank3]:2026-01-02 20:07:23,071 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2007_stage3_step1300.svg
[rank1]:2026-01-02 20:07:23,131 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2007_rank1_stage1.svg
[rank1]:	> Counts Sum: 2268960, Total Sum: 2903040 (78.16%), Ratio(%) per element: [81.69, 77.9, 77.12, 77.23, 78.79, 83.59, 81.47, 72.32, 72.32, 81.8, 77.12, 75.66, 80.91, 79.24, 80.13, 82.7, 71.31, 72.76, 78.12, 81.58, 76.78, 76.11, 82.03, 82.47, 81.58, 73.21, 72.32, 80.02, 76.33, 75.89, 76.0, 82.7, 81.58, 78.01, 72.2, 71.2, 80.58, 79.57, 77.79, 78.23, 78.23, 82.03, 82.92, 71.98, 72.87, 81.13, 79.91, 79.46, 75.89, 82.25, 83.25, 81.36, 72.54, 72.32, 80.91, 82.47, 76.33, 77.45, 83.37, 80.8, 82.81, 71.76, 72.76, 81.47, 76.56, 76.67, 74.77, 80.46, 80.91, 82.81, 71.76, 72.32, 80.46, 77.0, 79.79, 78.68, 82.47, 83.48, 82.47, 72.32, 72.87]
[rank2]:2026-01-02 20:07:23,124 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2007_rank2_stage2.svg
[rank2]:	> Counts Sum: 1903520, Total Sum: 2580480 (73.77%), Ratio(%) per element: [76.11, 74.66, 72.32, 73.43, 75.0, 78.01, 77.34, 68.86, 68.3, 77.45, 76.33, 72.99, 73.88, 75.11, 76.67, 77.12, 68.19, 69.86, 77.45, 74.33, 71.76, 76.22, 76.78, 76.78, 73.66, 68.3, 68.3, 77.9, 71.76, 72.09, 71.65, 76.33, 78.23, 78.23, 68.3, 68.52, 76.33, 72.2, 75.33, 77.0, 78.34, 78.12, 76.89, 67.85, 67.96, 76.89, 72.54, 71.98, 73.1, 78.57, 75.66, 75.44, 68.52, 67.96, 76.89, 70.98, 75.22, 74.66, 77.12, 75.66, 77.0, 67.74, 69.41, 75.66, 71.42, 69.53, 72.99, 77.34, 75.66, 77.23, 68.52, 68.86]
[rank0]:2026-01-02 20:07:23,121 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2007_rank0_stage0.svg
[rank0]:	> Counts Sum: 1373600, Total Sum: 2616320 (52.50%), Ratio(%) per element: [51.89, 53.01, 51.22, 48.66, 52.12, 54.01, 54.01, 54.46, 48.43, 48.77, 53.23, 50.78, 49.21, 53.79, 54.68, 52.12, 56.58, 48.77, 48.21, 53.57, 52.56, 52.67, 53.01, 53.57, 56.25, 52.0, 48.88, 48.88, 55.24, 52.9, 56.02, 52.34, 55.58, 55.8, 56.13, 48.43, 48.66, 52.67, 53.45, 49.1, 51.22, 52.45, 55.24, 56.02, 47.99, 48.99, 53.45, 53.12, 55.02, 51.78, 56.13, 55.13, 54.79, 48.66, 49.1, 53.79, 51.22, 51.89, 50.55, 57.03, 56.02, 55.69, 48.54, 49.33, 55.8, 50.78, 53.57, 52.23, 54.35, 56.47, 56.02, 48.77, 49.44]
[rank3]:2026-01-02 20:07:23,230 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2007_rank3_stage3.svg
[rank3]:	> Counts Sum: 1821520, Total Sum: 2329600 (78.19%), Ratio(%) per element: [84.26, 81.25, 72.54, 77.56, 78.68, 82.25, 82.03, 69.08, 70.08, 85.04, 73.54, 78.23, 80.58, 85.37, 82.7, 84.59, 69.86, 69.64, 78.68, 77.67, 76.22, 81.8, 83.81, 84.82, 84.37, 70.08, 69.97, 83.7, 82.14, 79.68, 78.79, 85.04, 84.82, 83.59, 70.64, 70.64, 84.37, 81.02, 73.21, 83.7, 84.26, 84.15, 84.48, 68.63, 69.19, 75.33, 81.25, 69.3, 78.34, 81.25, 82.25, 83.03, 68.63, 69.41, 84.04, 68.52, 82.36, 81.58, 81.8, 85.71, 83.92, 70.2, 69.41, 70.31, 68.63]
[rank0]:2026-01-02 20:07:24,372 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2007_stage0.svg
[rank1]:2026-01-02 20:07:24,388 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2007_stage1.svg
[rank2]:2026-01-02 20:07:24,364 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2007_stage2.svg
[rank3]:2026-01-02 20:07:24,506 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2007_stage3.svg
[rank0]:2026-01-02 20:09:05,666 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:09:07,718 - Avg. fwd time: 14.3081 / Avg. bwd time: 26.0114 / Avg. batch time: 417.0735 (ms) / GPU bubble ratio: 22.66%
[rank3]:2026-01-02 20:09:07,687 - Avg. fwd time: 15.3051 / Avg. bwd time: 28.7276 / Avg. batch time: 369.4260 (ms) / GPU bubble ratio: 4.65%
[rank0]:2026-01-02 20:09:07,786 - Avg. fwd time: 14.7778 / Avg. bwd time: 23.9071 / Avg. batch time: 519.7409 (ms) / GPU bubble ratio: 40.46%
[rank1]:2026-01-02 20:09:07,777 - Avg. fwd time: 16.2812 / Avg. bwd time: 28.0863 / Avg. batch time: 492.2194 (ms) / GPU bubble ratio: 27.89%
[rank1]:2026-01-02 20:09:07,817 -  step: 1350  loss: -4.0000  grad_norm:  0.1992  memory: 77.37GiB(55.34%)  tps: 7,808  tflops: 364.17  mfu: 36.82%
[rank2]:2026-01-02 20:09:07,815 -  step: 1350  loss: -4.0000  grad_norm:  0.1992  memory: 68.83GiB(49.23%)  tps: 7,808  tflops: 364.17  mfu: 36.82%
[rank3]:2026-01-02 20:09:07,819 -  step: 1350  loss:  0.1269  grad_norm:  0.1992  memory: 84.06GiB(60.12%)  tps: 7,808  tflops: 364.18  mfu: 36.82%
[rank0]:2026-01-02 20:09:07,821 -  step: 1350  loss: -4.0000  grad_norm:  0.1992  memory: 80.62GiB(57.67%)  tps: 7,808  tflops: 364.17  mfu: 36.82%
[rank0]:2026-01-02 20:10:48,167 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:10:50,235 - Avg. fwd time: 15.3056 / Avg. bwd time: 28.6172 / Avg. batch time: 368.5423 (ms) / GPU bubble ratio: 4.66%
[rank2]:2026-01-02 20:10:50,265 - Avg. fwd time: 14.3089 / Avg. bwd time: 25.9262 / Avg. batch time: 416.1230 (ms) / GPU bubble ratio: 22.65%
[rank0]:2026-01-02 20:10:50,330 - Avg. fwd time: 14.7769 / Avg. bwd time: 23.7868 / Avg. batch time: 518.6367 (ms) / GPU bubble ratio: 40.52%
[rank0]:2026-01-02 20:10:50,365 -  step: 1400  loss: -4.0000  grad_norm:  0.2359  memory: 80.62GiB(57.67%)  tps: 7,989  tflops: 372.60  mfu: 37.67%
[rank1]:2026-01-02 20:10:50,321 - Avg. fwd time: 16.2815 / Avg. bwd time: 27.9888 / Avg. batch time: 491.4232 (ms) / GPU bubble ratio: 27.93%
[rank1]:2026-01-02 20:10:50,361 -  step: 1400  loss: -4.0000  grad_norm:  0.2359  memory: 77.37GiB(55.34%)  tps: 7,989  tflops: 372.60  mfu: 37.67%
[rank1]:2026-01-02 20:10:50,415 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2010_stage1_step1400.svg
[rank2]:2026-01-02 20:10:50,359 -  step: 1400  loss: -4.0000  grad_norm:  0.2359  memory: 68.83GiB(49.23%)  tps: 7,989  tflops: 372.60  mfu: 37.67%
[rank2]:2026-01-02 20:10:50,415 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2010_stage2_step1400.svg
[rank3]:2026-01-02 20:10:50,363 -  step: 1400  loss:  0.3679  grad_norm:  0.2359  memory: 84.06GiB(60.12%)  tps: 7,989  tflops: 372.60  mfu: 37.67%
[rank0]:2026-01-02 20:10:50,411 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2010_stage0_step1400.svg
[rank3]:2026-01-02 20:10:50,491 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2010_step1400_rank3.svg
[rank3]:			> Batch Time: 493.50 ms, GPU Bubble Ratio: 42.08%, 31.61%, 37.53%, 32.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  284-42-327ms   | [S0,MB1,B]  327-43-371ms   | [S0,MB2,B]  371-43-414ms   | [S0,MB3,B]  415-35-450ms   | [S0,MB4,B]  450-0-450ms    | [S0,MB5,B]  451-0-451ms    | [S0,MB6,B]  472-0-472ms    | [S0,MB7,B]  493-0-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  239-45-284ms   | [S1,MB1,B]  284-33-318ms   | [S1,MB2,B]  320-21-341ms   | [S1,MB3,B]  341-21-362ms   | [S1,MB4,B]  371-21-392ms   | [S1,MB5,B]  415-20-435ms   | [S1,MB6,B]  450-20-471ms   | [S1,MB7,B]  472-20-492ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  220-18-238ms   | [S2,MB1,B]  241-40-281ms   | [S2,MB2,B]  281-37-319ms   | [S2,MB3,B]  320-19-339ms   | [S2,MB4,B]  342-18-361ms   | [S2,MB5,B]  363-18-382ms   | [S2,MB6,B]  384-18-403ms   | [S2,MB7,B]  414-18-433ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-21-219ms   | [S3,MB1,B]  219-21-240ms   | [S3,MB2,B]  240-33-274ms   | [S3,MB3,B]  273-21-295ms   | [S3,MB4,B]  294-46-341ms   | [S3,MB5,B]  341-21-362ms   | [S3,MB6,B]  362-20-383ms   | [S3,MB7,B]  383-20-404ms  
[rank3]:2026-01-02 20:10:50,535 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2010_stage3_step1400.svg
[rank1]:2026-01-02 20:10:50,594 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2010_rank1_stage1.svg
[rank1]:	> Counts Sum: 2476160, Total Sum: 3162240 (78.30%), Ratio(%) per element: [81.65, 78.38, 77.35, 77.35, 78.58, 83.7, 81.35, 72.54, 72.54, 81.96, 77.56, 75.81, 80.94, 79.5, 80.32, 82.58, 71.61, 72.95, 78.48, 81.65, 77.15, 76.53, 81.86, 82.58, 81.25, 73.36, 72.54, 80.02, 76.74, 76.33, 76.33, 82.37, 81.76, 78.17, 72.54, 71.51, 80.53, 79.61, 78.27, 78.58, 78.48, 81.96, 82.88, 72.23, 73.05, 81.04, 80.43, 79.09, 75.81, 82.47, 83.29, 81.25, 72.74, 72.54, 81.14, 82.47, 76.94, 77.76, 83.29, 80.94, 82.58, 72.02, 73.05, 81.45, 76.94, 77.15, 75.2, 80.32, 80.73, 82.78, 72.02, 72.54, 80.43, 77.45, 80.22, 78.89, 82.37, 83.4, 82.47, 72.54, 73.05]
[rank2]:2026-01-02 20:10:50,586 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2010_rank2_stage2.svg
[rank2]:	> Counts Sum: 2077120, Total Sum: 2810880 (73.90%), Ratio(%) per element: [76.33, 75.0, 72.54, 73.66, 75.3, 78.07, 77.15, 69.05, 68.64, 77.25, 76.33, 73.15, 74.28, 75.3, 76.74, 76.94, 68.64, 69.67, 77.25, 74.59, 72.43, 76.33, 77.04, 76.84, 74.07, 68.54, 68.54, 77.86, 72.43, 72.54, 72.02, 76.33, 78.07, 78.07, 68.54, 68.64, 76.33, 72.43, 75.51, 76.94, 78.07, 78.07, 77.25, 68.03, 68.23, 77.15, 72.23, 71.92, 73.25, 78.48, 76.22, 75.51, 68.95, 67.93, 76.63, 70.79, 75.4, 75.1, 77.04, 75.71, 76.94, 68.03, 69.56, 75.71, 71.92, 69.56, 73.25, 77.25, 75.61, 77.15, 68.95, 68.85]
[rank0]:2026-01-02 20:10:50,579 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2010_rank0_stage0.svg
[rank0]:	> Counts Sum: 1497600, Total Sum: 2849920 (52.55%), Ratio(%) per element: [51.74, 53.27, 51.12, 48.77, 52.04, 54.2, 53.89, 54.61, 48.66, 48.87, 53.48, 50.71, 49.28, 53.68, 54.61, 52.45, 56.45, 48.87, 48.36, 53.38, 52.76, 53.17, 52.76, 53.79, 55.84, 52.35, 48.97, 48.97, 55.12, 52.86, 55.84, 52.25, 55.63, 55.73, 55.84, 48.56, 48.77, 52.76, 53.48, 49.28, 51.43, 52.66, 55.02, 55.84, 48.15, 49.07, 53.58, 53.48, 55.22, 51.74, 55.94, 55.02, 54.71, 48.77, 49.18, 54.09, 51.22, 52.25, 50.81, 56.96, 55.73, 55.63, 48.66, 49.48, 55.73, 50.92, 53.68, 52.56, 54.4, 56.35, 55.94, 48.87, 49.48]
[rank3]:2026-01-02 20:10:50,695 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2010_rank3_stage3.svg
[rank3]:	> Counts Sum: 1987920, Total Sum: 2537600 (78.34%), Ratio(%) per element: [84.11, 81.25, 73.15, 77.97, 78.99, 82.68, 82.37, 69.26, 70.18, 85.04, 74.48, 78.58, 80.84, 85.04, 82.88, 84.42, 69.77, 69.56, 79.09, 78.07, 76.84, 81.96, 84.11, 84.63, 84.32, 70.49, 70.28, 83.6, 82.27, 80.12, 78.99, 85.14, 84.83, 83.5, 70.38, 70.79, 84.01, 81.35, 73.25, 83.6, 84.11, 84.11, 84.52, 68.75, 69.56, 76.12, 81.14, 70.18, 78.68, 81.25, 82.06, 83.19, 69.05, 69.46, 84.11, 68.44, 82.27, 81.96, 81.86, 85.65, 84.11, 70.28, 69.26, 70.38, 68.95]
[rank0]:2026-01-02 20:10:51,941 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2010_stage0.svg
[rank1]:2026-01-02 20:10:51,987 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2010_stage1.svg
[rank2]:2026-01-02 20:10:51,943 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2010_stage2.svg
[rank3]:2026-01-02 20:10:52,039 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2010_stage3.svg
[rank0]:2026-01-02 20:12:34,231 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:12:36,282 - Avg. fwd time: 14.3170 / Avg. bwd time: 25.8523 / Avg. batch time: 415.4311 (ms) / GPU bubble ratio: 22.65%
[rank3]:2026-01-02 20:12:36,251 - Avg. fwd time: 15.3149 / Avg. bwd time: 28.5367 / Avg. batch time: 367.9700 (ms) / GPU bubble ratio: 4.66%
[rank0]:2026-01-02 20:12:36,348 - Avg. fwd time: 14.7844 / Avg. bwd time: 23.6754 / Avg. batch time: 517.8143 (ms) / GPU bubble ratio: 40.58%
[rank1]:2026-01-02 20:12:36,339 - Avg. fwd time: 16.2907 / Avg. bwd time: 27.9003 / Avg. batch time: 490.8773 (ms) / GPU bubble ratio: 27.98%
[rank1]:2026-01-02 20:12:36,379 -  step: 1450  loss: -4.0000  grad_norm:  0.2049  memory: 77.37GiB(55.34%)  tps: 7,727  tflops: 360.39  mfu: 36.44%
[rank2]:2026-01-02 20:12:36,377 -  step: 1450  loss: -4.0000  grad_norm:  0.2049  memory: 68.83GiB(49.23%)  tps: 7,727  tflops: 360.39  mfu: 36.44%
[rank3]:2026-01-02 20:12:36,382 -  step: 1450  loss:  0.1885  grad_norm:  0.2049  memory: 84.06GiB(60.12%)  tps: 7,727  tflops: 360.39  mfu: 36.44%
[rank0]:2026-01-02 20:12:36,383 -  step: 1450  loss: -4.0000  grad_norm:  0.2049  memory: 80.62GiB(57.67%)  tps: 7,727  tflops: 360.39  mfu: 36.44%
[rank0]:2026-01-02 20:14:18,562 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:14:20,654 - Avg. fwd time: 14.3273 / Avg. bwd time: 25.7846 / Avg. batch time: 414.7491 (ms) / GPU bubble ratio: 22.63%
[rank3]:2026-01-02 20:14:20,625 - Avg. fwd time: 15.3274 / Avg. bwd time: 28.4548 / Avg. batch time: 367.4121 (ms) / GPU bubble ratio: 4.67%
[rank0]:2026-01-02 20:14:20,719 - Avg. fwd time: 14.7937 / Avg. bwd time: 23.5725 / Avg. batch time: 517.0142 (ms) / GPU bubble ratio: 40.63%
[rank1]:2026-01-02 20:14:20,710 - Avg. fwd time: 16.3018 / Avg. bwd time: 27.8183 / Avg. batch time: 490.3368 (ms) / GPU bubble ratio: 28.02%
[rank1]:2026-01-02 20:14:20,751 -  step: 1500  loss: -4.0000  grad_norm:  0.2889  memory: 77.38GiB(55.35%)  tps: 7,849  tflops: 366.07  mfu: 37.01%
[rank2]:2026-01-02 20:14:20,748 -  step: 1500  loss: -4.0000  grad_norm:  0.2889  memory: 68.83GiB(49.23%)  tps: 7,849  tflops: 366.08  mfu: 37.01%
[rank3]:2026-01-02 20:14:20,753 -  step: 1500  loss:  0.2711  grad_norm:  0.2889  memory: 84.06GiB(60.12%)  tps: 7,849  tflops: 366.08  mfu: 37.02%
[rank0]:2026-01-02 20:14:20,755 -  step: 1500  loss: -4.0000  grad_norm:  0.2889  memory: 80.62GiB(57.67%)  tps: 7,849  tflops: 366.07  mfu: 37.01%
[rank0]:2026-01-02 20:14:20,802 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2014_stage0_step1500.svg
[rank1]:2026-01-02 20:14:20,803 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2014_stage1_step1500.svg
[rank2]:2026-01-02 20:14:20,803 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2014_stage2_step1500.svg
[rank3]:2026-01-02 20:14:20,881 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2014_step1500_rank3.svg
[rank3]:			> Batch Time: 494.50 ms, GPU Bubble Ratio: 41.88%, 31.38%, 37.45%, 32.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-90ms     | [S0,MB6,F]  91-14-105ms    | [S0,MB7,F]  105-15-120ms   | [S0,MB0,B]  285-43-328ms   | [S0,MB1,B]  328-43-371ms   | [S0,MB2,B]  371-43-415ms   | [S0,MB3,B]  415-36-451ms   | [S0,MB4,B]  452-0-452ms    | [S0,MB5,B]  452-0-452ms    | [S0,MB6,B]  473-0-473ms    | [S0,MB7,B]  494-0-494ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-87ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-120ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  137-16-153ms   | [S1,MB0,B]  240-45-286ms   | [S1,MB1,B]  285-34-319ms   | [S1,MB2,B]  320-21-342ms   | [S1,MB3,B]  342-21-363ms   | [S1,MB4,B]  371-21-392ms   | [S1,MB5,B]  415-20-436ms   | [S1,MB6,B]  452-20-472ms   | [S1,MB7,B]  473-20-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-14-84ms     | [S2,MB3,F]  87-14-101ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  120-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  153-14-167ms   | [S2,MB0,B]  221-18-240ms   | [S2,MB1,B]  242-40-283ms   | [S2,MB2,B]  282-38-320ms   | [S2,MB3,B]  320-19-340ms   | [S2,MB4,B]  345-18-364ms   | [S2,MB5,B]  366-18-385ms   | [S2,MB6,B]  387-18-406ms   | [S2,MB7,B]  415-18-434ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-144ms   | [S3,MB5,F]  146-15-161ms   | [S3,MB6,F]  163-15-179ms   | [S3,MB7,F]  181-15-197ms   | [S3,MB0,B]  199-21-220ms   | [S3,MB1,B]  220-21-242ms   | [S3,MB2,B]  242-35-277ms   | [S3,MB3,B]  276-21-298ms   | [S3,MB4,B]  298-46-345ms   | [S3,MB5,B]  344-21-366ms   | [S3,MB6,B]  365-21-386ms   | [S3,MB7,B]  386-21-407ms  
[rank2]:2026-01-02 20:14:20,972 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2014_rank2_stage2.svg
[rank2]:	> Counts Sum: 2250720, Total Sum: 3041280 (74.01%), Ratio(%) per element: [76.23, 75.09, 73.01, 74.05, 75.37, 77.84, 77.08, 69.12, 68.93, 77.27, 76.51, 73.57, 74.43, 75.56, 76.7, 76.89, 68.75, 69.6, 77.46, 74.71, 72.72, 76.23, 76.98, 77.08, 74.33, 68.75, 68.56, 77.84, 72.82, 72.82, 72.53, 76.32, 77.84, 77.93, 68.37, 68.56, 76.51, 72.72, 75.66, 76.79, 78.03, 78.03, 77.27, 68.27, 68.56, 77.08, 72.15, 71.87, 73.57, 78.21, 76.42, 75.56, 69.03, 68.37, 76.6, 70.73, 75.56, 75.47, 77.17, 75.66, 77.08, 68.27, 69.69, 75.75, 72.44, 69.88, 73.57, 77.17, 75.94, 77.08, 69.31, 68.75]
[rank3]:2026-01-02 20:14:20,926 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2014_stage3_step1500.svg
[rank0]:2026-01-02 20:14:20,973 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2014_rank0_stage0.svg
[rank0]:	> Counts Sum: 1621600, Total Sum: 3083520 (52.59%), Ratio(%) per element: [51.6, 53.12, 51.04, 48.86, 52.36, 54.45, 53.78, 54.73, 48.76, 48.95, 53.69, 50.66, 49.33, 53.78, 54.64, 52.65, 56.34, 48.95, 48.48, 53.5, 52.74, 53.12, 52.55, 53.97, 55.96, 52.74, 49.05, 49.05, 54.92, 53.31, 55.68, 52.08, 55.39, 55.39, 55.68, 48.67, 48.86, 52.84, 53.78, 49.33, 51.42, 52.74, 55.01, 55.68, 48.39, 49.14, 53.69, 53.59, 55.3, 52.17, 55.87, 55.11, 54.45, 48.86, 49.24, 54.16, 51.13, 52.55, 51.04, 56.72, 55.49, 55.49, 48.76, 49.52, 55.58, 51.23, 53.97, 52.65, 54.64, 56.15, 55.68, 48.95, 49.52]
[rank1]:2026-01-02 20:14:20,982 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2014_rank1_stage1.svg
[rank1]:	> Counts Sum: 2683360, Total Sum: 3421440 (78.43%), Ratio(%) per element: [81.81, 78.69, 77.46, 77.65, 78.97, 83.61, 81.34, 72.82, 72.72, 81.62, 77.93, 76.04, 80.96, 80.01, 80.49, 82.38, 71.87, 73.1, 78.59, 82.0, 77.55, 76.89, 81.81, 82.76, 81.53, 73.48, 72.72, 80.39, 77.17, 76.7, 76.7, 82.1, 81.72, 78.4, 72.72, 71.78, 80.77, 79.82, 78.59, 78.78, 78.69, 81.81, 82.76, 72.44, 73.2, 80.77, 80.68, 78.78, 75.75, 82.57, 82.95, 81.34, 72.91, 72.72, 80.96, 82.19, 77.08, 78.21, 83.04, 80.68, 82.57, 72.25, 73.2, 81.43, 77.55, 77.55, 75.18, 80.39, 80.58, 82.85, 72.44, 72.72, 80.39, 77.93, 80.39, 78.97, 82.29, 83.33, 82.19, 72.82, 73.2]
[rank3]:2026-01-02 20:14:21,087 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2014_rank3_stage3.svg
[rank3]:	> Counts Sum: 2154320, Total Sum: 2745600 (78.46%), Ratio(%) per element: [83.9, 81.53, 73.86, 78.4, 79.26, 82.67, 82.38, 69.31, 70.35, 84.37, 75.09, 78.88, 80.87, 85.22, 82.95, 84.46, 69.79, 69.6, 79.64, 78.59, 77.46, 82.1, 83.8, 84.37, 84.37, 70.54, 70.35, 83.71, 82.48, 80.3, 79.26, 85.03, 84.84, 83.61, 70.45, 70.83, 83.71, 81.43, 74.33, 83.42, 83.99, 83.99, 84.28, 68.93, 69.69, 76.7, 81.25, 71.11, 78.97, 81.53, 82.19, 83.23, 69.03, 69.69, 83.9, 69.12, 82.29, 82.19, 82.0, 85.51, 83.8, 70.17, 69.31, 70.45, 69.03]
[rank0]:2026-01-02 20:14:22,450 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2014_stage0.svg
[rank2]:2026-01-02 20:14:22,426 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2014_stage2.svg
[rank1]:2026-01-02 20:14:22,453 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2014_stage1.svg
[rank3]:2026-01-02 20:14:22,636 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2014_stage3.svg
[rank0]:2026-01-02 20:16:04,613 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 20:16:06,665 - Avg. fwd time: 15.3384 / Avg. bwd time: 28.3784 / Avg. batch time: 366.8870 (ms) / GPU bubble ratio: 4.68%
[rank2]:2026-01-02 20:16:06,696 - Avg. fwd time: 14.3361 / Avg. bwd time: 25.7211 / Avg. batch time: 414.1268 (ms) / GPU bubble ratio: 22.62%
[rank1]:2026-01-02 20:16:06,750 - Avg. fwd time: 16.3119 / Avg. bwd time: 27.7400 / Avg. batch time: 489.8411 (ms) / GPU bubble ratio: 28.06%
[rank0]:2026-01-02 20:16:06,760 - Avg. fwd time: 14.8021 / Avg. bwd time: 23.4753 / Avg. batch time: 516.2742 (ms) / GPU bubble ratio: 40.69%
[rank0]:2026-01-02 20:16:06,795 -  step: 1550  loss: -4.0000  grad_norm:  0.2656  memory: 80.62GiB(57.67%)  tps: 7,725  tflops: 360.31  mfu: 36.43%
[rank2]:2026-01-02 20:16:06,789 -  step: 1550  loss: -4.0000  grad_norm:  0.2656  memory: 68.83GiB(49.23%)  tps: 7,725  tflops: 360.31  mfu: 36.43%
[rank1]:2026-01-02 20:16:06,791 -  step: 1550  loss: -4.0000  grad_norm:  0.2656  memory: 77.38GiB(55.35%)  tps: 7,725  tflops: 360.31  mfu: 36.43%
[rank3]:2026-01-02 20:16:06,793 -  step: 1550  loss:  0.2693  grad_norm:  0.2656  memory: 84.06GiB(60.12%)  tps: 7,725  tflops: 360.32  mfu: 36.43%
[rank0]:2026-01-02 20:17:48,873 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:17:50,935 - Avg. fwd time: 15.3437 / Avg. bwd time: 28.3151 / Avg. batch time: 366.4209 (ms) / GPU bubble ratio: 4.68%
[rank2]:2026-01-02 20:17:50,967 - Avg. fwd time: 14.3408 / Avg. bwd time: 25.6604 / Avg. batch time: 413.5676 (ms) / GPU bubble ratio: 22.62%
[rank1]:2026-01-02 20:17:51,020 - Avg. fwd time: 16.3170 / Avg. bwd time: 27.6648 / Avg. batch time: 489.3862 (ms) / GPU bubble ratio: 28.10%
[rank0]:2026-01-02 20:17:51,030 - Avg. fwd time: 14.8058 / Avg. bwd time: 23.3824 / Avg. batch time: 515.5878 (ms) / GPU bubble ratio: 40.75%
[rank0]:2026-01-02 20:17:51,065 -  step: 1600  loss: -4.0000  grad_norm:  0.3481  memory: 80.62GiB(57.67%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank0]:2026-01-02 20:17:51,112 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2017_stage0_step1600.svg
[rank2]:2026-01-02 20:17:51,059 -  step: 1600  loss: -4.0000  grad_norm:  0.3481  memory: 68.83GiB(49.23%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank2]:2026-01-02 20:17:51,115 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2017_stage2_step1600.svg
[rank1]:2026-01-02 20:17:51,061 -  step: 1600  loss: -4.0000  grad_norm:  0.3481  memory: 77.38GiB(55.35%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank1]:2026-01-02 20:17:51,113 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2017_stage1_step1600.svg
[rank3]:2026-01-02 20:17:51,063 -  step: 1600  loss:  0.4016  grad_norm:  0.3481  memory: 84.06GiB(60.12%)  tps: 7,857  tflops: 366.43  mfu: 37.05%
[rank3]:2026-01-02 20:17:51,195 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2017_step1600_rank3.svg
[rank3]:			> Batch Time: 495.00 ms, GPU Bubble Ratio: 41.96%, 32.29%, 37.60%, 32.92%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  285-42-327ms   | [S0,MB1,B]  328-43-371ms   | [S0,MB2,B]  371-43-414ms   | [S0,MB3,B]  415-36-452ms   | [S0,MB4,B]  452-0-452ms    | [S0,MB5,B]  452-0-452ms    | [S0,MB6,B]  473-0-473ms    | [S0,MB7,B]  495-0-495ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  136-16-153ms   | [S1,MB0,B]  239-45-285ms   | [S1,MB1,B]  285-31-316ms   | [S1,MB2,B]  320-21-341ms   | [S1,MB3,B]  341-21-362ms   | [S1,MB4,B]  371-21-392ms   | [S1,MB5,B]  415-20-436ms   | [S1,MB6,B]  452-20-473ms   | [S1,MB7,B]  473-20-494ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  152-14-167ms   | [S2,MB0,B]  220-18-239ms   | [S2,MB1,B]  241-40-282ms   | [S2,MB2,B]  282-38-320ms   | [S2,MB3,B]  320-19-339ms   | [S2,MB4,B]  342-18-361ms   | [S2,MB5,B]  363-18-382ms   | [S2,MB6,B]  384-18-403ms   | [S2,MB7,B]  415-18-433ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-161ms   | [S3,MB6,F]  163-15-178ms   | [S3,MB7,F]  180-15-196ms   | [S3,MB0,B]  198-21-219ms   | [S3,MB1,B]  219-21-241ms   | [S3,MB2,B]  241-33-274ms   | [S3,MB3,B]  273-21-295ms   | [S3,MB4,B]  295-46-341ms   | [S3,MB5,B]  341-21-363ms   | [S3,MB6,B]  362-21-383ms   | [S3,MB7,B]  383-21-404ms  
[rank3]:2026-01-02 20:17:51,241 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2017_stage3_step1600.svg
[rank0]:2026-01-02 20:17:51,284 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2017_rank0_stage0.svg
[rank0]:	> Counts Sum: 1745600, Total Sum: 3317120 (52.62%), Ratio(%) per element: [51.49, 53.16, 51.05, 48.94, 52.81, 54.75, 53.87, 54.48, 48.85, 49.03, 53.78, 50.61, 49.38, 54.04, 54.66, 53.16, 56.16, 49.03, 48.59, 53.52, 52.9, 52.9, 52.37, 54.04, 55.8, 52.99, 49.11, 49.11, 55.19, 53.25, 55.54, 52.02, 55.28, 55.19, 55.45, 48.76, 49.03, 52.9, 53.69, 49.38, 51.58, 52.9, 54.92, 55.63, 48.5, 49.2, 53.87, 53.52, 55.36, 52.46, 55.72, 54.92, 54.48, 48.94, 49.29, 54.22, 51.05, 52.72, 51.4, 56.6, 55.45, 55.36, 48.85, 49.55, 55.45, 51.4, 53.78, 52.99, 54.66, 56.07, 55.45, 49.03, 49.55]
[rank2]:2026-01-02 20:17:51,286 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2017_rank2_stage2.svg
[rank2]:	> Counts Sum: 2424320, Total Sum: 3271680 (74.10%), Ratio(%) per element: [76.4, 75.17, 73.23, 74.38, 75.44, 77.81, 77.02, 69.45, 68.92, 77.2, 76.58, 73.85, 74.55, 75.61, 76.67, 76.93, 68.92, 69.71, 77.46, 75.0, 73.15, 76.4, 77.11, 77.02, 74.64, 69.01, 68.57, 77.81, 73.15, 73.15, 72.88, 76.4, 77.72, 77.99, 68.66, 68.57, 76.49, 72.97, 75.88, 77.02, 77.81, 77.81, 77.37, 68.39, 68.66, 77.11, 72.0, 71.83, 73.76, 78.08, 76.32, 75.79, 69.27, 68.57, 76.67, 70.77, 75.79, 75.44, 77.11, 75.7, 77.2, 68.3, 69.63, 75.79, 72.71, 69.98, 73.85, 77.02, 75.96, 77.02, 69.36, 68.92]
[rank1]:2026-01-02 20:17:51,293 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2017_rank1_stage1.svg
[rank1]:	> Counts Sum: 2890560, Total Sum: 3680640 (78.53%), Ratio(%) per element: [81.6, 79.04, 78.08, 77.9, 79.22, 83.45, 81.33, 72.97, 72.88, 81.51, 78.16, 76.4, 80.98, 80.19, 80.63, 82.21, 72.09, 73.23, 78.69, 82.04, 77.72, 77.2, 81.6, 82.74, 81.6, 73.67, 72.88, 80.63, 77.55, 76.93, 77.28, 82.3, 81.77, 78.52, 72.88, 72.0, 80.89, 79.75, 78.6, 78.96, 78.69, 81.69, 82.74, 72.62, 73.32, 80.89, 80.8, 78.52, 75.79, 82.39, 82.74, 81.51, 73.06, 72.88, 80.72, 82.3, 77.46, 78.25, 82.92, 80.72, 82.65, 72.44, 73.32, 81.51, 77.72, 77.9, 75.17, 80.72, 80.63, 82.74, 72.62, 72.88, 80.19, 78.25, 80.54, 79.4, 82.21, 83.36, 82.21, 72.97, 73.32]
[rank3]:2026-01-02 20:17:51,404 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2017_rank3_stage3.svg
[rank3]:	> Counts Sum: 2320720, Total Sum: 2953600 (78.57%), Ratio(%) per element: [83.97, 81.6, 74.47, 78.78, 79.22, 82.65, 82.39, 69.19, 70.42, 84.33, 75.79, 79.22, 80.89, 85.21, 83.01, 84.5, 69.8, 69.54, 79.84, 79.04, 77.9, 82.3, 83.62, 84.24, 84.33, 70.77, 70.15, 83.62, 82.57, 80.45, 79.57, 84.77, 84.94, 83.53, 70.68, 70.68, 83.53, 81.33, 74.91, 83.36, 84.06, 84.15, 84.15, 68.92, 69.98, 76.93, 81.33, 71.91, 79.22, 81.51, 82.21, 83.36, 69.01, 69.63, 83.89, 70.15, 82.48, 82.3, 81.95, 85.47, 83.8, 70.51, 69.36, 70.51, 69.01]
[rank0]:2026-01-02 20:17:52,853 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2017_stage0.svg
[rank2]:2026-01-02 20:17:52,869 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2017_stage2.svg
[rank1]:2026-01-02 20:17:52,910 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2017_stage1.svg
[rank3]:2026-01-02 20:17:53,059 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2017_stage3.svg
[rank0]:2026-01-02 20:19:35,012 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:19:37,090 - Avg. fwd time: 14.3470 / Avg. bwd time: 25.6025 / Avg. batch time: 413.0126 (ms) / GPU bubble ratio: 22.62%
[rank3]:2026-01-02 20:19:37,058 - Avg. fwd time: 15.3504 / Avg. bwd time: 28.2483 / Avg. batch time: 365.9375 (ms) / GPU bubble ratio: 4.69%
[rank0]:2026-01-02 20:19:37,154 - Avg. fwd time: 14.8119 / Avg. bwd time: 23.2953 / Avg. batch time: 514.9229 (ms) / GPU bubble ratio: 40.80%
[rank0]:2026-01-02 20:19:37,189 -  step: 1650  loss: -4.0000  grad_norm:  0.4726  memory: 80.62GiB(57.67%)  tps: 7,719  tflops: 360.03  mfu: 36.40%
[rank1]:2026-01-02 20:19:37,144 - Avg. fwd time: 16.3239 / Avg. bwd time: 27.5953 / Avg. batch time: 488.9311 (ms) / GPU bubble ratio: 28.14%
[rank2]:2026-01-02 20:19:37,182 -  step: 1650  loss: -4.0000  grad_norm:  0.4726  memory: 68.83GiB(49.23%)  tps: 7,719  tflops: 360.03  mfu: 36.40%
[rank1]:2026-01-02 20:19:37,185 -  step: 1650  loss: -4.0000  grad_norm:  0.4726  memory: 77.38GiB(55.35%)  tps: 7,719  tflops: 360.03  mfu: 36.40%
[rank3]:2026-01-02 20:19:37,187 -  step: 1650  loss:  0.4292  grad_norm:  0.4726  memory: 84.06GiB(60.12%)  tps: 7,719  tflops: 360.03  mfu: 36.40%
[rank0]:2026-01-02 20:21:19,424 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:21:21,506 - Avg. fwd time: 14.3533 / Avg. bwd time: 25.5469 / Avg. batch time: 412.4844 (ms) / GPU bubble ratio: 22.61%
[rank3]:2026-01-02 20:21:21,474 - Avg. fwd time: 15.3577 / Avg. bwd time: 28.1851 / Avg. batch time: 365.4888 (ms) / GPU bubble ratio: 4.69%
[rank0]:2026-01-02 20:21:21,571 - Avg. fwd time: 14.8176 / Avg. bwd time: 23.2138 / Avg. batch time: 514.2899 (ms) / GPU bubble ratio: 40.84%
[rank1]:2026-01-02 20:21:21,560 - Avg. fwd time: 16.3309 / Avg. bwd time: 27.5262 / Avg. batch time: 488.5012 (ms) / GPU bubble ratio: 28.18%
[rank1]:2026-01-02 20:21:21,602 -  step: 1700  loss: -4.0000  grad_norm:  0.3146  memory: 77.38GiB(55.35%)  tps: 7,845  tflops: 365.91  mfu: 37.00%
[rank2]:2026-01-02 20:21:21,599 -  step: 1700  loss: -4.0000  grad_norm:  0.3146  memory: 68.83GiB(49.23%)  tps: 7,845  tflops: 365.91  mfu: 37.00%
[rank3]:2026-01-02 20:21:21,604 -  step: 1700  loss:  0.4114  grad_norm:  0.3146  memory: 84.06GiB(60.12%)  tps: 7,846  tflops: 365.92  mfu: 37.00%
[rank0]:2026-01-02 20:21:21,606 -  step: 1700  loss: -4.0000  grad_norm:  0.3146  memory: 80.62GiB(57.67%)  tps: 7,845  tflops: 365.91  mfu: 37.00%
[rank0]:2026-01-02 20:21:21,653 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2021_stage0_step1700.svg
[rank1]:2026-01-02 20:21:21,654 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2021_stage1_step1700.svg
[rank2]:2026-01-02 20:21:21,655 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2021_stage2_step1700.svg
[rank3]:2026-01-02 20:21:21,732 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2021_step1700_rank3.svg
[rank3]:			> Batch Time: 493.50 ms, GPU Bubble Ratio: 42.00%, 31.82%, 37.94%, 32.87%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  283-42-326ms   | [S0,MB1,B]  326-43-369ms   | [S0,MB2,B]  370-43-413ms   | [S0,MB3,B]  413-36-450ms   | [S0,MB4,B]  450-0-450ms    | [S0,MB5,B]  450-0-450ms    | [S0,MB6,B]  471-0-471ms    | [S0,MB7,B]  493-0-493ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-136ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  238-45-284ms   | [S1,MB1,B]  283-32-316ms   | [S1,MB2,B]  317-21-338ms   | [S1,MB3,B]  338-21-359ms   | [S1,MB4,B]  369-21-391ms   | [S1,MB5,B]  413-20-434ms   | [S1,MB6,B]  450-20-471ms   | [S1,MB7,B]  471-20-492ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  219-18-238ms   | [S2,MB1,B]  240-40-281ms   | [S2,MB2,B]  280-36-317ms   | [S2,MB3,B]  317-19-336ms   | [S2,MB4,B]  341-18-360ms   | [S2,MB5,B]  362-18-381ms   | [S2,MB6,B]  383-18-402ms   | [S2,MB7,B]  413-18-432ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  197-21-218ms   | [S3,MB1,B]  218-21-240ms   | [S3,MB2,B]  240-33-273ms   | [S3,MB3,B]  272-21-294ms   | [S3,MB4,B]  294-46-340ms   | [S3,MB5,B]  340-21-361ms   | [S3,MB6,B]  361-20-382ms   | [S3,MB7,B]  382-20-403ms  
[rank3]:2026-01-02 20:21:21,776 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2021_stage3_step1700.svg
[rank0]:2026-01-02 20:21:21,824 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2021_rank0_stage0.svg
[rank0]:	> Counts Sum: 1869600, Total Sum: 3550720 (52.65%), Ratio(%) per element: [51.39, 53.2, 51.23, 49.01, 52.96, 54.85, 53.94, 54.52, 48.93, 49.09, 53.61, 50.57, 49.42, 54.02, 54.85, 53.12, 55.92, 49.09, 48.68, 53.53, 52.87, 52.71, 52.22, 54.11, 55.83, 53.37, 49.17, 49.17, 55.09, 53.28, 55.42, 52.3, 55.34, 55.5, 55.34, 48.93, 49.09, 53.12, 53.78, 49.42, 52.05, 52.96, 54.85, 55.75, 48.6, 49.25, 53.78, 53.53, 55.26, 52.54, 55.5, 54.76, 54.44, 49.01, 49.34, 54.27, 50.98, 52.79, 51.64, 56.33, 55.5, 55.01, 48.93, 49.58, 55.42, 51.64, 53.86, 53.2, 54.68, 55.83, 55.42, 49.09, 49.58]
[rank1]:2026-01-02 20:21:21,835 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2021_rank1_stage1.svg
[rank1]:	> Counts Sum: 3097760, Total Sum: 3939840 (78.63%), Ratio(%) per element: [81.74, 79.27, 78.12, 78.28, 79.35, 83.55, 81.33, 73.1, 73.02, 81.33, 78.37, 76.8, 81.0, 80.18, 80.5, 82.23, 72.28, 73.35, 78.86, 81.9, 77.96, 77.54, 81.57, 82.89, 81.74, 73.76, 73.1, 80.67, 77.87, 77.13, 77.46, 82.23, 81.9, 78.61, 73.02, 72.2, 81.08, 79.76, 78.78, 79.11, 78.94, 81.74, 82.64, 72.77, 73.43, 81.0, 80.67, 78.28, 75.74, 82.23, 82.64, 81.57, 73.19, 73.02, 80.92, 82.23, 77.87, 78.28, 83.05, 80.83, 82.73, 72.61, 73.43, 81.57, 77.87, 78.28, 75.16, 80.83, 80.59, 82.73, 72.77, 73.02, 80.18, 78.37, 80.59, 79.44, 81.99, 83.38, 82.23, 73.1, 73.43]
[rank2]:2026-01-02 20:21:21,827 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2021_rank2_stage2.svg
[rank2]:	> Counts Sum: 2597920, Total Sum: 3502080 (74.18%), Ratio(%) per element: [76.39, 75.24, 73.6, 74.58, 75.57, 77.79, 76.97, 69.57, 68.99, 77.13, 76.72, 74.17, 74.67, 75.82, 76.72, 77.05, 69.07, 69.73, 77.46, 75.0, 73.43, 76.39, 76.97, 77.05, 74.83, 69.16, 68.42, 77.71, 73.51, 73.35, 73.1, 76.48, 77.71, 77.79, 68.83, 68.91, 76.8, 73.27, 75.9, 77.05, 77.71, 77.96, 77.38, 68.58, 68.91, 77.05, 71.87, 71.54, 74.09, 78.04, 76.48, 75.82, 69.49, 68.58, 76.56, 70.88, 75.74, 75.41, 76.97, 75.65, 77.05, 68.17, 69.81, 75.82, 73.02, 70.14, 74.09, 77.22, 76.23, 77.05, 69.24, 69.32]
[rank3]:2026-01-02 20:21:21,936 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2021_rank3_stage3.svg
[rank3]:	> Counts Sum: 2487120, Total Sum: 3161600 (78.67%), Ratio(%) per element: [84.04, 81.41, 74.91, 79.11, 79.27, 82.64, 82.64, 69.16, 70.55, 84.21, 76.23, 79.52, 81.0, 85.11, 83.05, 84.37, 69.9, 69.65, 79.85, 79.35, 78.12, 82.4, 83.63, 84.29, 84.12, 70.97, 70.39, 83.55, 82.73, 80.5, 79.76, 84.78, 84.95, 83.71, 70.64, 70.47, 83.47, 81.66, 75.24, 83.3, 84.12, 84.29, 83.96, 68.99, 70.06, 77.3, 81.41, 72.77, 79.6, 81.66, 82.31, 83.14, 69.16, 69.57, 83.96, 71.13, 82.56, 82.4, 81.9, 85.36, 83.63, 70.64, 69.07, 70.31, 69.07]
[rank2]:2026-01-02 20:21:23,503 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2021_stage2.svg
[rank0]:2026-01-02 20:21:23,502 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2021_stage0.svg
[rank1]:2026-01-02 20:21:23,552 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2021_stage1.svg
[rank3]:2026-01-02 20:21:23,680 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2021_stage3.svg
[rank0]:2026-01-02 20:23:05,916 - [GC] Peforming periodical GC collection 0.01 seconds
[rank3]:2026-01-02 20:23:07,967 - Avg. fwd time: 15.3633 / Avg. bwd time: 28.1303 / Avg. batch time: 365.0924 (ms) / GPU bubble ratio: 4.70%
[rank0]:2026-01-02 20:23:08,064 - Avg. fwd time: 14.8225 / Avg. bwd time: 23.1384 / Avg. batch time: 513.7385 (ms) / GPU bubble ratio: 40.89%
[rank1]:2026-01-02 20:23:08,053 - Avg. fwd time: 16.3363 / Avg. bwd time: 27.4641 / Avg. batch time: 488.1372 (ms) / GPU bubble ratio: 28.22%
[rank2]:2026-01-02 20:23:07,998 - Avg. fwd time: 14.3582 / Avg. bwd time: 25.4955 / Avg. batch time: 412.0133 (ms) / GPU bubble ratio: 22.62%
[rank3]:2026-01-02 20:23:08,097 -  step: 1750  loss:  0.4165  grad_norm:  0.3192  memory: 84.06GiB(60.12%)  tps: 7,693  tflops: 358.78  mfu: 36.28%
[rank0]:2026-01-02 20:23:08,099 -  step: 1750  loss: -4.0000  grad_norm:  0.3192  memory: 80.62GiB(57.67%)  tps: 7,693  tflops: 358.78  mfu: 36.28%
[rank1]:2026-01-02 20:23:08,095 -  step: 1750  loss: -4.0000  grad_norm:  0.3192  memory: 77.38GiB(55.35%)  tps: 7,693  tflops: 358.78  mfu: 36.28%
[rank2]:2026-01-02 20:23:08,093 -  step: 1750  loss: -4.0000  grad_norm:  0.3192  memory: 68.83GiB(49.23%)  tps: 7,693  tflops: 358.78  mfu: 36.28%
[rank0]:2026-01-02 20:24:48,557 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:24:50,556 - Avg. fwd time: 14.3546 / Avg. bwd time: 25.4434 / Avg. batch time: 411.4033 (ms) / GPU bubble ratio: 22.61%
[rank3]:2026-01-02 20:24:50,524 - Avg. fwd time: 15.3585 / Avg. bwd time: 28.0653 / Avg. batch time: 364.5300 (ms) / GPU bubble ratio: 4.70%
[rank1]:2026-01-02 20:24:50,615 - Avg. fwd time: 16.3312 / Avg. bwd time: 27.4029 / Avg. batch time: 487.6446 (ms) / GPU bubble ratio: 28.25%
[rank1]:2026-01-02 20:24:50,658 -  step: 1800  loss: -4.0000  grad_norm:  0.1716  memory: 77.38GiB(55.35%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank2]:2026-01-02 20:24:50,655 -  step: 1800  loss: -4.0000  grad_norm:  0.1716  memory: 68.83GiB(49.23%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank0]:2026-01-02 20:24:50,626 - Avg. fwd time: 14.8172 / Avg. bwd time: 23.0689 / Avg. batch time: 513.0584 (ms) / GPU bubble ratio: 40.92%
[rank0]:2026-01-02 20:24:50,662 -  step: 1800  loss: -4.0000  grad_norm:  0.1716  memory: 80.62GiB(57.67%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank3]:2026-01-02 20:24:50,660 -  step: 1800  loss:  0.0795  grad_norm:  0.1716  memory: 84.06GiB(60.12%)  tps: 7,987  tflops: 372.53  mfu: 37.67%
[rank1]:2026-01-02 20:24:50,711 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2024_stage1_step1800.svg
[rank2]:2026-01-02 20:24:50,711 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2024_stage2_step1800.svg
[rank0]:2026-01-02 20:24:50,709 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2024_stage0_step1800.svg
[rank3]:2026-01-02 20:24:50,787 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2024_step1800_rank3.svg
[rank3]:			> Batch Time: 489.50 ms, GPU Bubble Ratio: 42.54%, 32.96%, 38.91%, 33.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-44ms     | [S0,MB3,F]  44-13-58ms     | [S0,MB4,F]  58-13-72ms     | [S0,MB5,F]  71-13-85ms     | [S0,MB6,F]  86-14-100ms    | [S0,MB7,F]  99-14-113ms    | [S0,MB0,B]  279-42-322ms   | [S0,MB1,B]  322-42-365ms   | [S0,MB2,B]  365-43-408ms   | [S0,MB3,B]  409-38-447ms   | [S0,MB4,B]  447-0-447ms    | [S0,MB5,B]  447-0-447ms    | [S0,MB6,B]  468-0-468ms    | [S0,MB7,B]  489-0-489ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  52-14-67ms     | [S1,MB3,F]  67-15-82ms     | [S1,MB4,F]  83-15-98ms     | [S1,MB5,F]  98-15-113ms    | [S1,MB6,F]  113-15-129ms   | [S1,MB7,F]  129-15-144ms   | [S1,MB0,B]  234-45-279ms   | [S1,MB1,B]  279-33-313ms   | [S1,MB2,B]  313-20-334ms   | [S1,MB3,B]  334-20-355ms   | [S1,MB4,B]  365-20-386ms   | [S1,MB5,B]  408-20-429ms   | [S1,MB6,B]  447-20-467ms   | [S1,MB7,B]  467-20-488ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-81ms     | [S2,MB3,F]  82-13-96ms     | [S2,MB4,F]  98-13-111ms    | [S2,MB5,F]  113-13-127ms   | [S2,MB6,F]  129-13-142ms   | [S2,MB7,F]  144-13-158ms   | [S2,MB0,B]  215-18-234ms   | [S2,MB1,B]  236-40-276ms   | [S2,MB2,B]  276-36-312ms   | [S2,MB3,B]  313-18-332ms   | [S2,MB4,B]  336-18-354ms   | [S2,MB5,B]  357-18-375ms   | [S2,MB6,B]  377-18-396ms   | [S2,MB7,B]  408-18-427ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-72ms     | [S3,MB1,F]  74-14-88ms     | [S3,MB2,F]  91-14-105ms    | [S3,MB3,F]  107-14-121ms   | [S3,MB4,F]  123-14-137ms   | [S3,MB5,F]  139-14-154ms   | [S3,MB6,F]  156-14-170ms   | [S3,MB7,F]  172-14-186ms   | [S3,MB0,B]  188-26-215ms   | [S3,MB1,B]  215-20-235ms   | [S3,MB2,B]  235-33-269ms   | [S3,MB3,B]  269-20-290ms   | [S3,MB4,B]  290-45-335ms   | [S3,MB5,B]  335-20-356ms   | [S3,MB6,B]  356-20-376ms   | [S3,MB7,B]  376-20-397ms  
[rank3]:2026-01-02 20:24:50,831 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2024_stage3_step1800.svg
[rank1]:2026-01-02 20:24:50,893 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2024_rank1_stage1.svg
[rank1]:	> Counts Sum: 3304960, Total Sum: 4199040 (78.71%), Ratio(%) per element: [81.63, 79.47, 78.39, 78.47, 79.78, 83.64, 81.32, 73.22, 73.14, 81.25, 78.39, 77.0, 81.01, 80.32, 80.55, 82.02, 72.45, 73.45, 79.01, 81.86, 78.08, 77.77, 81.4, 82.79, 81.79, 73.84, 73.22, 80.78, 78.0, 77.54, 77.7, 82.25, 81.71, 78.93, 73.14, 72.45, 81.17, 79.93, 79.16, 79.47, 79.08, 81.63, 82.48, 72.91, 73.53, 81.01, 80.7, 78.08, 75.69, 82.25, 82.63, 81.4, 73.3, 73.14, 81.09, 82.25, 78.0, 78.47, 82.79, 81.01, 82.71, 72.76, 73.53, 81.4, 77.93, 78.39, 75.15, 80.7, 80.78, 82.71, 72.91, 73.14, 80.24, 78.78, 80.86, 79.7, 81.94, 83.17, 82.4, 73.22, 73.53]
[rank2]:2026-01-02 20:24:50,880 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2024_rank2_stage2.svg
[rank2]:	> Counts Sum: 2771520, Total Sum: 3732480 (74.25%), Ratio(%) per element: [76.54, 75.3, 73.76, 74.76, 75.84, 77.77, 76.92, 69.75, 69.13, 77.08, 76.77, 74.22, 74.92, 75.77, 76.85, 77.0, 69.13, 69.67, 77.39, 75.15, 73.68, 76.46, 76.92, 76.92, 74.92, 69.13, 68.67, 77.77, 73.68, 73.84, 73.3, 76.62, 77.54, 77.7, 69.13, 68.98, 76.77, 73.53, 75.92, 77.08, 77.62, 77.77, 77.39, 68.59, 68.98, 77.08, 71.83, 71.45, 74.38, 77.93, 76.54, 75.84, 69.59, 68.82, 76.54, 70.91, 75.69, 75.61, 77.0, 75.77, 77.16, 68.36, 69.83, 76.15, 73.22, 70.13, 74.22, 77.16, 76.23, 77.23, 69.29, 69.36]
[rank0]:2026-01-02 20:24:50,881 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2024_rank0_stage0.svg
[rank0]:	> Counts Sum: 1993600, Total Sum: 3784320 (52.68%), Ratio(%) per element: [51.31, 53.24, 51.38, 49.07, 53.24, 54.78, 53.85, 54.39, 48.99, 49.15, 53.85, 50.61, 49.45, 54.32, 54.86, 53.16, 55.7, 49.22, 48.76, 53.47, 53.0, 52.54, 52.08, 54.16, 55.7, 53.31, 49.22, 49.22, 55.09, 53.39, 55.55, 52.54, 55.16, 55.24, 55.47, 48.99, 49.15, 53.16, 53.85, 49.45, 52.16, 53.08, 54.86, 55.63, 48.68, 49.3, 53.78, 53.7, 55.32, 53.0, 55.47, 54.47, 54.32, 49.07, 49.38, 54.16, 50.92, 53.0, 51.92, 56.25, 55.47, 55.16, 48.99, 49.61, 55.4, 51.62, 53.93, 53.39, 54.62, 55.55, 55.24, 49.15, 49.61]
[rank3]:2026-01-02 20:24:50,991 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2024_rank3_stage3.svg
[rank3]:	> Counts Sum: 2653520, Total Sum: 3369600 (78.75%), Ratio(%) per element: [83.95, 81.48, 75.23, 79.39, 79.55, 82.56, 82.63, 69.29, 70.52, 84.25, 76.77, 79.7, 81.09, 84.95, 83.1, 84.25, 69.9, 69.83, 80.09, 79.62, 78.16, 82.56, 83.56, 84.25, 83.87, 70.91, 70.37, 83.48, 82.79, 80.4, 79.93, 84.64, 85.03, 83.87, 70.44, 70.21, 83.48, 81.71, 75.77, 83.48, 84.1, 84.41, 83.95, 69.21, 70.21, 77.62, 81.79, 73.53, 79.7, 81.63, 82.33, 83.17, 69.44, 69.59, 83.71, 71.91, 82.63, 82.48, 82.17, 84.95, 83.64, 70.83, 69.05, 70.21, 69.05]
[rank2]:2026-01-02 20:24:52,690 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2024_stage2.svg
[rank1]:2026-01-02 20:24:52,741 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2024_stage1.svg
[rank0]:2026-01-02 20:24:52,685 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2024_stage0.svg
[rank3]:2026-01-02 20:24:52,853 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2024_stage3.svg
[rank0]:2026-01-02 20:26:32,529 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:26:34,538 - Avg. fwd time: 14.3501 / Avg. bwd time: 25.3928 / Avg. batch time: 410.8167 (ms) / GPU bubble ratio: 22.61%
[rank3]:2026-01-02 20:26:34,507 - Avg. fwd time: 15.3530 / Avg. bwd time: 28.0045 / Avg. batch time: 363.9958 (ms) / GPU bubble ratio: 4.71%
[rank1]:2026-01-02 20:26:34,593 - Avg. fwd time: 16.3259 / Avg. bwd time: 27.3436 / Avg. batch time: 487.1175 (ms) / GPU bubble ratio: 28.28%
[rank1]:2026-01-02 20:26:34,636 -  step: 1850  loss: -4.0000  grad_norm:  0.3223  memory: 77.38GiB(55.35%)  tps: 7,879  tflops: 367.46  mfu: 37.15%
[rank2]:2026-01-02 20:26:34,634 -  step: 1850  loss: -4.0000  grad_norm:  0.3223  memory: 68.83GiB(49.23%)  tps: 7,879  tflops: 367.46  mfu: 37.15%
[rank0]:2026-01-02 20:26:34,605 - Avg. fwd time: 14.8117 / Avg. bwd time: 22.9968 / Avg. batch time: 512.3582 (ms) / GPU bubble ratio: 40.97%
[rank0]:2026-01-02 20:26:34,640 -  step: 1850  loss: -4.0000  grad_norm:  0.3223  memory: 80.62GiB(57.67%)  tps: 7,879  tflops: 367.46  mfu: 37.15%
[rank3]:2026-01-02 20:26:34,638 -  step: 1850  loss:  0.3581  grad_norm:  0.3223  memory: 84.06GiB(60.12%)  tps: 7,879  tflops: 367.46  mfu: 37.15%
[rank0]:2026-01-02 20:28:13,765 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 20:28:15,793 - Avg. fwd time: 14.3439 / Avg. bwd time: 25.3463 / Avg. batch time: 410.2243 (ms) / GPU bubble ratio: 22.60%
[rank3]:2026-01-02 20:28:15,762 - Avg. fwd time: 15.3450 / Avg. bwd time: 27.9433 / Avg. batch time: 363.4387 (ms) / GPU bubble ratio: 4.71%
[rank1]:2026-01-02 20:28:15,850 - Avg. fwd time: 16.3185 / Avg. bwd time: 27.2847 / Avg. batch time: 486.5698 (ms) / GPU bubble ratio: 28.31%
[rank1]:2026-01-02 20:28:15,892 -  step: 1900  loss: -4.0000  grad_norm:  0.1913  memory: 77.38GiB(55.35%)  tps: 8,090  tflops: 377.34  mfu: 38.15%
[rank2]:2026-01-02 20:28:15,890 -  step: 1900  loss: -4.0000  grad_norm:  0.1913  memory: 68.83GiB(49.23%)  tps: 8,090  tflops: 377.34  mfu: 38.15%
[rank3]:2026-01-02 20:28:15,894 -  step: 1900  loss:  0.2042  grad_norm:  0.1913  memory: 84.06GiB(60.12%)  tps: 8,090  tflops: 377.34  mfu: 38.15%
[rank0]:2026-01-02 20:28:15,861 - Avg. fwd time: 14.8040 / Avg. bwd time: 22.9270 / Avg. batch time: 511.6396 (ms) / GPU bubble ratio: 41.00%
[rank0]:2026-01-02 20:28:15,896 -  step: 1900  loss: -4.0000  grad_norm:  0.1913  memory: 80.62GiB(57.67%)  tps: 8,090  tflops: 377.34  mfu: 38.15%
[rank1]:2026-01-02 20:28:15,945 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2028_stage1_step1900.svg
[rank2]:2026-01-02 20:28:15,945 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2028_stage2_step1900.svg
[rank3]:2026-01-02 20:28:16,021 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2028_step1900_rank3.svg
[rank3]:			> Batch Time: 488.75 ms, GPU Bubble Ratio: 42.80%, 32.85%, 38.72%, 32.78%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-13-31ms     | [S0,MB2,F]  31-13-45ms     | [S0,MB3,F]  45-13-58ms     | [S0,MB4,F]  59-13-72ms     | [S0,MB5,F]  72-14-87ms     | [S0,MB6,F]  86-14-101ms    | [S0,MB7,F]  101-14-115ms   | [S0,MB0,B]  282-42-324ms   | [S0,MB1,B]  325-43-368ms   | [S0,MB2,B]  368-43-411ms   | [S0,MB3,B]  411-35-446ms   | [S0,MB4,B]  446-0-446ms    | [S0,MB5,B]  446-0-446ms    | [S0,MB6,B]  467-0-467ms    | [S0,MB7,B]  488-0-488ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-15-52ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-83ms     | [S1,MB4,F]  84-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-131ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  236-45-281ms   | [S1,MB1,B]  281-31-313ms   | [S1,MB2,B]  314-20-335ms   | [S1,MB3,B]  335-20-356ms   | [S1,MB4,B]  367-20-388ms   | [S1,MB5,B]  411-20-431ms   | [S1,MB6,B]  446-20-466ms   | [S1,MB7,B]  467-20-487ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  54-13-68ms     | [S2,MB2,F]  68-13-82ms     | [S2,MB3,F]  83-13-97ms     | [S2,MB4,F]  99-13-113ms    | [S2,MB5,F]  115-13-128ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  217-18-236ms   | [S2,MB1,B]  238-40-278ms   | [S2,MB2,B]  278-35-314ms   | [S2,MB3,B]  314-19-333ms   | [S2,MB4,B]  338-18-356ms   | [S2,MB5,B]  359-18-377ms   | [S2,MB6,B]  379-18-398ms   | [S2,MB7,B]  410-18-429ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  75-14-89ms     | [S3,MB2,F]  91-14-105ms    | [S3,MB3,F]  107-14-122ms   | [S3,MB4,F]  124-14-138ms   | [S3,MB5,F]  141-14-155ms   | [S3,MB6,F]  157-14-172ms   | [S3,MB7,F]  174-14-189ms   | [S3,MB0,B]  191-26-217ms   | [S3,MB1,B]  217-20-237ms   | [S3,MB2,B]  237-33-270ms   | [S3,MB3,B]  270-20-291ms   | [S3,MB4,B]  291-45-337ms   | [S3,MB5,B]  337-20-358ms   | [S3,MB6,B]  358-20-378ms   | [S3,MB7,B]  379-20-399ms  
[rank0]:2026-01-02 20:28:15,942 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2028_stage0_step1900.svg
[rank1]:2026-01-02 20:28:16,124 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2028_rank1_stage1.svg
[rank1]:	> Counts Sum: 3512160, Total Sum: 4458240 (78.78%), Ratio(%) per element: [81.68, 79.43, 78.41, 78.48, 79.94, 83.43, 81.54, 73.4, 73.25, 81.17, 78.77, 77.18, 81.03, 80.3, 80.66, 82.04, 72.6, 73.54, 79.14, 81.83, 78.27, 78.05, 81.32, 82.92, 81.68, 73.9, 73.32, 80.59, 78.12, 77.76, 77.9, 82.26, 81.54, 79.21, 73.25, 72.6, 81.17, 79.94, 79.28, 79.57, 79.21, 81.46, 82.41, 73.03, 73.61, 81.1, 81.03, 77.9, 75.65, 82.41, 82.55, 81.39, 73.4, 73.25, 81.17, 82.04, 78.27, 78.7, 82.7, 81.03, 82.41, 72.89, 73.61, 81.54, 78.19, 78.7, 75.14, 80.88, 80.95, 82.77, 73.03, 73.25, 80.3, 78.99, 80.95, 80.01, 82.19, 83.06, 82.12, 73.32, 73.61]
[rank2]:2026-01-02 20:28:16,114 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2028_rank2_stage2.svg
[rank2]:	> Counts Sum: 2945120, Total Sum: 3962880 (74.32%), Ratio(%) per element: [76.67, 75.43, 73.98, 75.0, 75.94, 77.76, 76.81, 69.91, 69.25, 77.1, 76.88, 74.41, 75.07, 75.72, 76.81, 76.88, 69.18, 69.76, 77.39, 75.29, 73.76, 76.52, 76.88, 76.81, 75.14, 69.04, 68.75, 77.76, 73.9, 74.05, 73.4, 76.52, 77.68, 77.76, 69.11, 69.04, 76.67, 73.76, 76.09, 77.25, 77.54, 77.68, 77.32, 68.6, 69.11, 77.1, 71.72, 71.51, 74.63, 77.83, 76.59, 75.94, 69.54, 69.11, 76.52, 70.93, 75.87, 75.79, 77.03, 75.87, 77.03, 68.53, 69.91, 76.16, 73.54, 70.2, 74.34, 77.18, 76.3, 77.18, 69.33, 69.47]
[rank3]:2026-01-02 20:28:16,065 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2028_stage3_step1900.svg
[rank0]:2026-01-02 20:28:16,112 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2028_rank0_stage0.svg
[rank0]:	> Counts Sum: 2117600, Total Sum: 4017920 (52.70%), Ratio(%) per element: [51.23, 53.41, 51.45, 49.12, 53.19, 55.01, 53.7, 54.57, 49.05, 49.2, 53.99, 50.58, 49.49, 54.21, 54.65, 53.48, 55.66, 49.27, 48.83, 53.63, 53.12, 52.39, 52.03, 54.14, 55.66, 53.41, 49.27, 49.27, 55.01, 53.34, 55.37, 52.76, 55.01, 55.3, 55.52, 49.05, 49.2, 53.27, 53.92, 49.49, 52.39, 53.05, 54.86, 55.66, 48.76, 49.34, 53.92, 53.77, 55.37, 52.83, 55.59, 54.5, 54.28, 49.12, 49.41, 54.14, 50.87, 53.12, 52.03, 56.17, 55.3, 55.15, 49.05, 49.63, 55.15, 51.67, 53.99, 53.27, 54.72, 55.59, 55.23, 49.2, 49.63]
[rank3]:2026-01-02 20:28:16,224 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2028_rank3_stage3.svg
[rank3]:	> Counts Sum: 2819920, Total Sum: 3577600 (78.82%), Ratio(%) per element: [84.01, 81.68, 75.65, 79.5, 79.65, 82.7, 82.7, 69.33, 70.71, 84.08, 77.25, 79.94, 81.17, 85.1, 83.21, 84.15, 69.98, 69.91, 80.3, 79.86, 78.48, 82.63, 83.57, 84.01, 83.93, 70.78, 70.42, 83.35, 82.84, 80.74, 80.15, 84.44, 85.02, 83.64, 70.42, 70.05, 83.13, 81.83, 76.3, 83.28, 83.93, 84.3, 83.93, 69.18, 70.2, 77.97, 82.04, 74.05, 79.65, 81.68, 82.41, 83.28, 69.54, 69.69, 83.72, 72.6, 82.63, 82.63, 82.26, 84.73, 83.57, 70.63, 69.25, 70.2, 69.11]
[rank2]:2026-01-02 20:28:18,014 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2028_stage2.svg
[rank1]:2026-01-02 20:28:18,056 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2028_stage1.svg
[rank0]:2026-01-02 20:28:18,054 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2028_stage0.svg
[rank3]:2026-01-02 20:28:18,234 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2028_stage3.svg
[rank0]:2026-01-02 20:29:56,881 - [GC] Peforming periodical GC collection 0.01 seconds
[rank2]:2026-01-02 20:29:58,883 - Avg. fwd time: 14.3368 / Avg. bwd time: 25.2997 / Avg. batch time: 409.6512 (ms) / GPU bubble ratio: 22.59%
[rank3]:2026-01-02 20:29:58,850 - Avg. fwd time: 15.3360 / Avg. bwd time: 27.8857 / Avg. batch time: 362.9006 (ms) / GPU bubble ratio: 4.72%
[rank1]:2026-01-02 20:29:58,939 - Avg. fwd time: 16.3101 / Avg. bwd time: 27.2280 / Avg. batch time: 486.0337 (ms) / GPU bubble ratio: 28.34%
[rank1]:2026-01-02 20:29:58,982 -  step: 1950  loss: -4.0000  grad_norm:  0.1197  memory: 77.38GiB(55.35%)  tps: 7,947  tflops: 370.63  mfu: 37.47%
[rank2]:2026-01-02 20:29:58,979 -  step: 1950  loss: -4.0000  grad_norm:  0.1197  memory: 68.83GiB(49.23%)  tps: 7,947  tflops: 370.63  mfu: 37.47%
[rank3]:2026-01-02 20:29:58,984 -  step: 1950  loss:  0.1745  grad_norm:  0.1197  memory: 84.06GiB(60.12%)  tps: 7,947  tflops: 370.63  mfu: 37.48%
[rank0]:2026-01-02 20:29:58,950 - Avg. fwd time: 14.7952 / Avg. bwd time: 22.8597 / Avg. batch time: 510.9401 (ms) / GPU bubble ratio: 41.04%
[rank0]:2026-01-02 20:29:58,985 -  step: 1950  loss: -4.0000  grad_norm:  0.1197  memory: 80.62GiB(57.67%)  tps: 7,947  tflops: 370.63  mfu: 37.48%
[rank0]:2026-01-02 20:31:37,273 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 20:31:39,277 - Avg. fwd time: 15.3274 / Avg. bwd time: 27.8200 / Avg. batch time: 362.3019 (ms) / GPU bubble ratio: 4.73%
[rank1]:2026-01-02 20:31:39,363 - Avg. fwd time: 16.3025 / Avg. bwd time: 27.1747 / Avg. batch time: 485.4594 (ms) / GPU bubble ratio: 28.35%
[rank2]:2026-01-02 20:31:39,307 - Avg. fwd time: 14.3301 / Avg. bwd time: 25.2543 / Avg. batch time: 409.0405 (ms) / GPU bubble ratio: 22.58%
[rank0]:2026-01-02 20:31:39,375 - Avg. fwd time: 14.7871 / Avg. bwd time: 22.7960 / Avg. batch time: 510.2106 (ms) / GPU bubble ratio: 41.07%
[rank2]:2026-01-02 20:31:39,404 -  step: 2000  loss: -4.0000  grad_norm:  0.1610  memory: 68.83GiB(49.23%)  tps: 8,157  tflops: 380.46  mfu: 38.47%
[rank1]:2026-01-02 20:31:39,407 -  step: 2000  loss: -4.0000  grad_norm:  0.1610  memory: 77.38GiB(55.35%)  tps: 8,157  tflops: 380.46  mfu: 38.47%
[rank1]:2026-01-02 20:31:39,407 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1610  tps: 7,746  tflops: 361.29  mfu: 35.30%
[rank1]:2026-01-02 20:31:39,407 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 20:31:39,411 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2026-01-02 20:31:39,404 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1610  tps: 7,743  tflops: 361.12  mfu: 35.29%
[rank2]:2026-01-02 20:31:39,405 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 20:31:39,409 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-02 20:31:39,409 -  step: 2000  loss:  0.2093  grad_norm:  0.1610  memory: 84.06GiB(60.12%)  tps: 8,157  tflops: 380.46  mfu: 38.47%
[rank3]:2026-01-02 20:31:39,409 - â„¹ï¸ final step: 2000  loss:  0.2093  grad_norm:  0.1610  tps: 7,747  tflops: 361.30  mfu: 35.31%
[rank3]:2026-01-02 20:31:39,410 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-02 20:31:39,414 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 20:31:39,411 -  step: 2000  loss: -4.0000  grad_norm:  0.1610  memory: 80.62GiB(57.67%)  tps: 8,157  tflops: 380.46  mfu: 38.47%
[rank0]:2026-01-02 20:31:39,411 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.1610  tps: 7,743  tflops: 361.15  mfu: 35.29%
[rank0]:2026-01-02 20:31:39,411 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 20:31:39,415 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 20:31:49,478 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank1]:2026-01-02 20:31:49,549 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank1/260102_2031_stage1_final2000.svg
[rank2]:2026-01-02 20:31:49,548 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank2/260102_2031_stage2_final2000.svg
[rank0]:2026-01-02 20:31:49,548 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank0/260102_2031_stage0_final2000.svg
[rank3]:2026-01-02 20:31:49,620 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2031_final2000_rank3.svg
[rank3]:			> Batch Time: 491.25 ms, GPU Bubble Ratio: 42.31%, 31.99%, 37.82%, 33.09%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  283-42-326ms   | [S0,MB1,B]  326-43-369ms   | [S0,MB2,B]  369-43-412ms   | [S0,MB3,B]  413-35-448ms   | [S0,MB4,B]  448-0-448ms    | [S0,MB5,B]  448-0-448ms    | [S0,MB6,B]  469-0-469ms    | [S0,MB7,B]  491-0-491ms   
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  102-16-118ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  238-45-284ms   | [S1,MB1,B]  283-32-315ms   | [S1,MB2,B]  318-21-339ms   | [S1,MB3,B]  339-21-360ms   | [S1,MB4,B]  369-21-390ms   | [S1,MB5,B]  412-20-433ms   | [S1,MB6,B]  448-20-469ms   | [S1,MB7,B]  469-20-490ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  134-13-148ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  219-18-237ms   | [S2,MB1,B]  240-40-281ms   | [S2,MB2,B]  280-37-317ms   | [S2,MB3,B]  317-19-337ms   | [S2,MB4,B]  340-18-359ms   | [S2,MB5,B]  361-18-380ms   | [S2,MB6,B]  382-18-401ms   | [S2,MB7,B]  412-18-431ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-15-175ms   | [S3,MB7,F]  177-15-193ms   | [S3,MB0,B]  195-21-216ms   | [S3,MB1,B]  218-21-239ms   | [S3,MB2,B]  239-33-272ms   | [S3,MB3,B]  272-21-293ms   | [S3,MB4,B]  293-46-340ms   | [S3,MB5,B]  340-21-361ms   | [S3,MB6,B]  361-20-381ms   | [S3,MB7,B]  382-20-402ms  
[rank1]:2026-01-02 20:31:49,727 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2031_rank1_stage1.svg
[rank1]:	> Counts Sum: 3719360, Total Sum: 4717440 (78.84%), Ratio(%) per element: [81.73, 79.67, 78.64, 78.84, 80.21, 83.51, 81.45, 73.48, 73.35, 81.18, 78.91, 77.6, 81.18, 80.49, 80.83, 82.21, 72.73, 73.62, 79.18, 81.93, 78.57, 78.29, 81.25, 82.89, 81.59, 74.03, 73.42, 80.56, 78.09, 78.09, 78.02, 82.21, 81.59, 79.39, 73.35, 72.73, 81.04, 80.01, 79.39, 79.53, 79.53, 81.38, 82.28, 73.14, 73.69, 81.11, 81.25, 77.74, 75.61, 82.34, 82.55, 81.31, 73.48, 73.35, 81.25, 81.79, 78.43, 78.77, 82.55, 81.04, 82.41, 73.0, 73.69, 81.38, 78.29, 78.77, 75.13, 80.97, 81.11, 82.69, 73.14, 73.35, 80.15, 79.12, 80.97, 80.08, 82.28, 82.82, 82.07, 73.42, 73.69]
[rank2]:2026-01-02 20:31:49,718 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2031_rank2_stage2.svg
[rank2]:	> Counts Sum: 3118720, Total Sum: 4193280 (74.37%), Ratio(%) per element: [76.57, 75.41, 74.17, 75.27, 75.89, 77.81, 76.78, 70.12, 69.43, 77.12, 76.92, 74.72, 75.2, 75.75, 76.92, 76.85, 69.16, 69.78, 77.4, 75.41, 74.03, 76.57, 76.99, 76.71, 75.34, 69.02, 68.68, 77.67, 74.1, 74.17, 73.55, 76.71, 77.67, 77.74, 69.36, 69.29, 76.71, 74.1, 76.09, 77.12, 77.54, 77.6, 77.19, 68.75, 69.09, 76.99, 71.84, 71.35, 74.86, 77.81, 76.57, 75.96, 69.57, 69.16, 76.71, 70.94, 75.82, 75.82, 76.99, 75.82, 77.06, 68.4, 69.98, 76.16, 73.76, 70.12, 74.58, 77.12, 76.37, 77.26, 69.5, 69.57]
[rank3]:2026-01-02 20:31:49,742 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/pipeline_schedule/260102_2031_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 501.56 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB4,F]  60-15-75ms     | [S0,MB5,F]  75-15-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-121ms   | [S0,MB0,B]  258-30-288ms   | [S0,MB1,B]  288-30-319ms   | [S0,MB2,B]  319-30-349ms   | [S0,MB3,B]  349-30-379ms   | [S0,MB4,B]  379-30-410ms   | [S0,MB5,B]  410-30-440ms   | [S0,MB6,B]  440-30-471ms   | [S0,MB7,B]  471-30-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-75ms     | [S1,MB4,F]  75-15-91ms     | [S1,MB5,F]  91-15-106ms    | [S1,MB6,F]  106-15-121ms   | [S1,MB7,F]  121-15-136ms   | [S1,MB0,B]  227-30-258ms   | [S1,MB1,B]  258-30-288ms   | [S1,MB2,B]  288-30-319ms   | [S1,MB3,B]  319-30-349ms   | [S1,MB4,B]  349-30-379ms   | [S1,MB5,B]  379-30-410ms   | [S1,MB6,B]  410-30-440ms   | [S1,MB7,B]  440-30-471ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB2,F]  60-15-75ms     | [S2,MB3,F]  75-15-91ms     | [S2,MB4,F]  91-15-106ms    | [S2,MB5,F]  106-15-121ms   | [S2,MB6,F]  121-15-136ms   | [S2,MB7,F]  136-15-151ms   | [S2,MB0,B]  197-30-227ms   | [S2,MB1,B]  227-30-258ms   | [S2,MB2,B]  258-30-288ms   | [S2,MB3,B]  288-30-319ms   | [S2,MB4,B]  319-30-349ms   | [S2,MB5,B]  349-30-379ms   | [S2,MB6,B]  379-30-410ms   | [S2,MB7,B]  410-30-440ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB1,F]  60-15-75ms     | [S3,MB2,F]  75-15-91ms     | [S3,MB3,F]  91-15-106ms    | [S3,MB4,F]  106-15-121ms   | [S3,MB5,F]  121-15-136ms   | [S3,MB6,F]  136-15-151ms   | [S3,MB7,F]  151-15-167ms   | [S3,MB0,B]  167-30-197ms   | [S3,MB1,B]  197-30-227ms   | [S3,MB2,B]  227-30-258ms   | [S3,MB3,B]  258-30-288ms   | [S3,MB4,B]  288-30-319ms   | [S3,MB5,B]  319-30-349ms   | [S3,MB6,B]  349-30-379ms   | [S3,MB7,B]  379-30-410ms  
[rank3]:2026-01-02 20:31:49,786 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_ratio_history/rank3/260102_2031_stage3_final2000.svg
[rank0]:2026-01-02 20:31:49,720 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2031_rank0_stage0.svg
[rank0]:	> Counts Sum: 2241600, Total Sum: 4251520 (52.72%), Ratio(%) per element: [51.16, 53.43, 51.51, 49.17, 53.22, 54.94, 53.91, 54.67, 49.1, 49.24, 54.05, 50.54, 49.51, 54.12, 54.67, 53.57, 55.76, 49.31, 48.9, 53.7, 53.02, 52.26, 51.92, 54.32, 55.7, 53.5, 49.31, 49.31, 55.08, 53.36, 55.21, 52.74, 55.08, 55.28, 55.35, 49.1, 49.24, 53.29, 53.84, 49.51, 52.74, 52.95, 55.01, 55.56, 48.83, 49.38, 53.84, 53.7, 55.15, 52.81, 55.63, 54.6, 54.32, 49.17, 49.45, 54.25, 50.82, 53.15, 52.12, 56.18, 55.28, 55.08, 49.17, 49.65, 55.21, 51.92, 53.98, 53.43, 54.67, 55.42, 55.28, 49.24, 49.65]
[rank3]:2026-01-02 20:31:49,945 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/frozen_params_histogram/260102_2031_rank3_stage3.svg
[rank3]:	> Counts Sum: 2986320, Total Sum: 3785600 (78.89%), Ratio(%) per element: [83.85, 81.79, 76.09, 79.67, 79.94, 82.62, 82.76, 69.36, 70.87, 84.13, 77.6, 80.21, 81.25, 84.95, 83.24, 84.06, 70.05, 69.78, 80.42, 80.08, 78.7, 82.76, 83.51, 83.72, 83.85, 70.74, 70.32, 83.44, 82.76, 81.04, 80.15, 84.47, 84.95, 83.58, 70.46, 70.19, 83.17, 81.86, 76.85, 83.24, 83.51, 84.2, 83.79, 69.09, 70.12, 78.36, 82.07, 74.51, 79.8, 81.79, 82.41, 83.24, 69.71, 69.57, 83.72, 73.35, 82.69, 82.82, 82.34, 84.68, 83.51, 70.67, 69.23, 70.26, 69.36]
[rank1]:2026-01-02 20:31:51,750 - âœ… Scatter Plot of Stage 1 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2031_stage1.svg
[rank1]:2026-01-02 20:31:51,753 - Destroying the purge thread.
[rank2]:2026-01-02 20:31:51,724 - âœ… Scatter Plot of Stage 2 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2031_stage2.svg
[rank2]:2026-01-02 20:31:51,728 - Destroying the purge thread.
[rank0]:2026-01-02 20:31:51,764 - âœ… Scatter Plot of Stage 0 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2031_stage0.svg
[rank0]:2026-01-02 20:31:51,768 - Sleeping 2 seconds for other ranks to complete
[rank3]:2026-01-02 20:31:51,986 - âœ… Scatter Plot of Stage 3 is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200/afr_time_plot/260102_2031_stage3.svg
[rank3]:2026-01-02 20:31:51,990 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading wandb-summary.json; uploading output.log; uploading config.yaml
[rank3]:wandb: uploading history steps 39-40, summary, console lines 474-495
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.11501
[rank3]:wandb:               final/avg_loss 0.20931
[rank3]:wandb:             final/avg_mfu(%) 35.30578
[rank3]:wandb:             final/avg_tflops 361.30027
[rank3]:wandb:    final/avg_throughput(tps) 7746.54858
[rank3]:wandb:              final/grad_norm 0.16096
[rank3]:wandb:               final/max_loss 0.20931
[rank3]:wandb:                    grad_norm 0.16096
[rank3]:wandb: loss_metrics/global_avg_loss 0.20931
[rank3]:wandb: loss_metrics/global_max_loss 0.20931
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_GPipe_timelyapf_h200 at: https://wandb.ai/orangingq/torchtitan/runs/xxt1ek4d
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_GPipe_timelyapf_h200/20260102-1919/wandb/run-20260102_191922-xxt1ek4d/logs
[rank0]:2026-01-02 20:31:53,768 - Training completed
[rank0]:2026-01-02 20:31:53,768 - Destroying the purge thread.
[rank1]:2026-01-02 20:31:53,989 - Process group destroyed
[rank3]:2026-01-02 20:31:53,990 - Process group destroyed
[rank2]:2026-01-02 20:31:54,006 - Process group destroyed
[rank0]:2026-01-02 20:31:54,280 - Process group destroyed
[rank2]:[W102 20:31:54.744066590 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:[W102 20:31:54.732706752 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W102 20:31:54.817330983 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W102 20:31:55.999481944 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:Stage 2: Modules to keep: {'layers.17', 'layers.19', 'layers.20', 'layers.21', 'layers.18', 'layers.24', 'layers.23', 'layers.22'}
[rank0]:Stage 0: Modules to keep: {'tok_embeddings', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.1', 'layers.0', 'layers.7', 'layers.2'}
[rank1]:Stage 1: Modules to keep: {'layers.15', 'layers.16', 'layers.11', 'layers.13', 'layers.10', 'layers.12', 'layers.8', 'layers.9', 'layers.14'}
[rank3]:Stage 3: Modules to keep: {'norm', 'output', 'layers.26', 'layers.25', 'layers.30', 'layers.31', 'layers.29', 'layers.28', 'layers.27'}
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_GPipe_timelyapf_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_GPipe_timelyapf_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_GPipe_timelyapf_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_timelyapf_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_timelyapf_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_GPipe_timelyapf_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_timelyapf_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_GPipe_timelyapf_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: timelyapf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.0001
[rank3]:		- percentile: 80
[rank3]:
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W102 20:32:01.671605851 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
