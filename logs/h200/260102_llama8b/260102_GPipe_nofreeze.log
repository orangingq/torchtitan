
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Jan  2 16:24:25 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_GPipe_nofreeze.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with nofreeze x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.no-freeze
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0102 16:24:27.252000 2824073 site-packages/torch/distributed/run.py:803] 
W0102 16:24:27.252000 2824073 site-packages/torch/distributed/run.py:803] *****************************************
W0102 16:24:27.252000 2824073 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0102 16:24:27.252000 2824073 site-packages/torch/distributed/run.py:803] *****************************************
[rank1]:2026-01-02 16:24:34,230 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank1]:2026-01-02 16:24:34,587 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-02 16:24:34,589 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-02 16:24:34,594 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 16:24:34,846 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank2]:2026-01-02 16:24:35,088 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank0]:2026-01-02 16:24:35,232 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-02 16:24:35,234 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-02 16:24:35,239 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-02 16:24:35,239 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 16:24:35,240 - Loading tokenizer from tokenizer.json
[rank3]:2026-01-02 16:24:35,307 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank0]:2026-01-02 16:24:35,538 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank2]:2026-01-02 16:24:35,601 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-02 16:24:35,603 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-02 16:24:35,608 - Deterministic algorithm enabled (expect perf degradation).
[rank3]:2026-01-02 16:24:35,708 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-02 16:24:35,711 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-02 16:24:35,716 - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2026-01-02 16:24:37,006 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank1]:2026-01-02 16:24:37,078 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-02 16:24:37,078 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2026-01-02 16:24:37,149 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank1]:2026-01-02 16:24:37,304 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-02 16:24:37,304 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank0]:2026-01-02 16:24:37,406 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 16:24:37,462 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-02 16:24:37,486 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-02 16:24:37,487 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank0]:2026-01-02 16:24:37,733 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-02 16:24:37,734 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank2]:2026-01-02 16:24:37,975 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2026-01-02 16:24:38,055 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-02 16:24:38,056 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank2]:2026-01-02 16:24:38,299 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-02 16:24:38,299 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run yertr3ob
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_nofreeze_h200/20260102-1624/wandb/run-20260102_162438-yertr3ob
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_GPipe_nofreeze_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/yertr3ob
[rank3]:2026-01-02 16:24:39,753 - WandB logging enabled
[rank3]:2026-01-02 16:24:39,754 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-02 16:24:39,832 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-02 16:24:39,832 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2026-01-02 16:24:40,080 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-02 16:24:40,081 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank3]:2026-01-02 16:24:40,094 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-02 16:24:40,105 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-02 16:24:40,102 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 16:24:40,094 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_nofreeze_h200
[rank0]:2026-01-02 16:24:40,095 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 16:24:40,095 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-02 16:24:40,095 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank0]:2026-01-02 16:24:51,332 - [GC] GC collection for checkpoint loading. 0.00 seconds
[rank0]:2026-01-02 16:24:51,332 - Finished loading the checkpoint in 11.24 seconds.
[rank0]:2026-01-02 16:24:51,332 - Training starts at step 1
[rank3]:2026-01-02 16:24:56,071 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 61.09GiB(43.70%)  tps: 1,007  tflops: 46.99  mfu: 4.75%
[rank3]:2026-01-02 16:24:56,071 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank1]:2026-01-02 16:24:56,069 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.37GiB(39.61%)  tps: 862  tflops: 40.19  mfu: 4.06%
[rank1]:2026-01-02 16:24:56,069 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 16:24:56,090 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.18GiB(39.46%)  tps: 880  tflops: 41.02  mfu: 4.15%
[rank0]:2026-01-02 16:24:56,090 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-02 16:24:56,064 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.30GiB(35.26%)  tps: 909  tflops: 42.37  mfu: 4.28%
[rank2]:2026-01-02 16:24:56,065 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 16:27:14,422 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:27:17,174 - Avg. fwd time: 15.3303 / Avg. bwd time: 45.9282 / Avg. batch time: 508.8844 (ms) / GPU bubble ratio: 3.70%
[rank2]:2026-01-02 16:27:17,219 - Avg. fwd time: 14.2935 / Avg. bwd time: 40.2347 / Avg. batch time: 569.0231 (ms) / GPU bubble ratio: 23.34%
[rank0]:2026-01-02 16:27:17,318 - Avg. fwd time: 14.9955 / Avg. bwd time: 42.8522 / Avg. batch time: 700.1849 (ms) / GPU bubble ratio: 33.91%
[rank1]:2026-01-02 16:27:17,269 - Avg. fwd time: 16.1688 / Avg. bwd time: 45.4071 / Avg. batch time: 636.6274 (ms) / GPU bubble ratio: 22.62%
[rank0]:2026-01-02 16:27:17,354 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 72.15GiB(51.60%)  tps: 5,683  tflops: 265.06  mfu: 26.80%
[rank3]:2026-01-02 16:27:17,355 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 76.42GiB(54.66%)  tps: 5,682  tflops: 265.03  mfu: 26.80%
[rank1]:2026-01-02 16:27:17,350 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 70.00GiB(50.07%)  tps: 5,682  tflops: 265.03  mfu: 26.80%
[rank2]:2026-01-02 16:27:17,347 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 62.32GiB(44.58%)  tps: 5,682  tflops: 265.03  mfu: 26.80%
[rank0]:2026-01-02 16:29:38,546 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:29:41,286 - Avg. fwd time: 15.2961 / Avg. bwd time: 45.9906 / Avg. batch time: 508.2089 (ms) / GPU bubble ratio: 3.53%
[rank2]:2026-01-02 16:29:41,332 - Avg. fwd time: 14.2921 / Avg. bwd time: 40.3255 / Avg. batch time: 567.8461 (ms) / GPU bubble ratio: 23.05%
[rank1]:2026-01-02 16:29:41,382 - Avg. fwd time: 16.1456 / Avg. bwd time: 45.4617 / Avg. batch time: 634.9149 (ms) / GPU bubble ratio: 22.37%
[rank0]:2026-01-02 16:29:41,430 - Avg. fwd time: 14.8719 / Avg. bwd time: 42.9624 / Avg. batch time: 698.0601 (ms) / GPU bubble ratio: 33.72%
[rank2]:2026-01-02 16:29:41,459 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 62.32GiB(44.58%)  tps: 5,684  tflops: 265.13  mfu: 26.81%
[rank1]:2026-01-02 16:29:41,461 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 70.00GiB(50.07%)  tps: 5,685  tflops: 265.13  mfu: 26.81%
[rank3]:2026-01-02 16:29:41,465 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 76.42GiB(54.66%)  tps: 5,685  tflops: 265.13  mfu: 26.81%
[rank0]:2026-01-02 16:29:41,466 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 72.15GiB(51.60%)  tps: 5,684  tflops: 265.13  mfu: 26.81%
[rank3]:2026-01-02 16:29:41,622 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1629_step100_rank3.svg
[rank3]:			> Batch Time: 697.00 ms, GPU Bubble Ratio: 33.31%, 28.93%, 36.92%, 29.31%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  328-42-371ms   | [S0,MB1,B]  374-43-417ms   | [S0,MB2,B]  421-43-464ms   | [S0,MB3,B]  467-43-511ms   | [S0,MB4,B]  514-43-557ms   | [S0,MB5,B]  560-43-603ms   | [S0,MB6,B]  606-43-650ms   | [S0,MB7,B]  653-43-697ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  282-45-327ms   | [S1,MB1,B]  328-45-373ms   | [S1,MB2,B]  374-45-420ms   | [S1,MB3,B]  421-45-466ms   | [S1,MB4,B]  467-45-513ms   | [S1,MB5,B]  513-45-559ms   | [S1,MB6,B]  560-46-606ms   | [S1,MB7,B]  606-45-652ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-98ms     | [S2,MB4,F]  101-13-114ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  241-40-281ms   | [S2,MB1,B]  287-40-327ms   | [S2,MB2,B]  333-40-374ms   | [S2,MB3,B]  379-40-420ms   | [S2,MB4,B]  426-40-466ms   | [S2,MB5,B]  472-40-513ms   | [S2,MB6,B]  518-40-559ms   | [S2,MB7,B]  565-40-605ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-15-175ms   | [S3,MB7,F]  177-15-193ms   | [S3,MB0,B]  195-46-241ms   | [S3,MB1,B]  240-46-286ms   | [S3,MB2,B]  286-46-333ms   | [S3,MB3,B]  333-46-379ms   | [S3,MB4,B]  379-46-425ms   | [S3,MB5,B]  425-46-471ms   | [S3,MB6,B]  472-46-518ms   | [S3,MB7,B]  518-46-564ms  
[rank0]:2026-01-02 16:32:02,852 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 16:32:05,635 - Avg. fwd time: 14.2653 / Avg. bwd time: 40.3851 / Avg. batch time: 567.5463 (ms) / GPU bubble ratio: 22.97%
[rank3]:2026-01-02 16:32:05,590 - Avg. fwd time: 15.2570 / Avg. bwd time: 46.0321 / Avg. batch time: 507.9210 (ms) / GPU bubble ratio: 3.47%
[rank3]:2026-01-02 16:32:05,766 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 76.42GiB(54.66%)  tps: 5,677  tflops: 264.78  mfu: 26.77%
[rank1]:2026-01-02 16:32:05,685 - Avg. fwd time: 16.1227 / Avg. bwd time: 45.4971 / Avg. batch time: 634.4294 (ms) / GPU bubble ratio: 22.30%
[rank1]:2026-01-02 16:32:05,764 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 70.00GiB(50.07%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank0]:2026-01-02 16:32:05,733 - Avg. fwd time: 14.8351 / Avg. bwd time: 43.0226 / Avg. batch time: 697.4594 (ms) / GPU bubble ratio: 33.64%
[rank0]:2026-01-02 16:32:05,768 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 72.15GiB(51.60%)  tps: 5,677  tflops: 264.77  mfu: 26.77%
[rank2]:2026-01-02 16:32:05,762 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 62.32GiB(44.58%)  tps: 5,677  tflops: 264.78  mfu: 26.77%
[rank0]:2026-01-02 16:34:26,665 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:34:29,391 - Avg. fwd time: 15.2201 / Avg. bwd time: 46.0525 / Avg. batch time: 507.6331 (ms) / GPU bubble ratio: 3.44%
[rank2]:2026-01-02 16:34:29,437 - Avg. fwd time: 14.2406 / Avg. bwd time: 40.4237 / Avg. batch time: 567.1359 (ms) / GPU bubble ratio: 22.89%
[rank1]:2026-01-02 16:34:29,488 - Avg. fwd time: 16.1051 / Avg. bwd time: 45.5162 / Avg. batch time: 633.9159 (ms) / GPU bubble ratio: 22.23%
[rank2]:2026-01-02 16:34:29,565 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 62.32GiB(44.58%)  tps: 5,697  tflops: 265.69  mfu: 26.86%
[rank3]:2026-01-02 16:34:29,571 -  step: 200  loss:  0.4945  grad_norm: 19.6900  memory: 76.42GiB(54.66%)  tps: 5,697  tflops: 265.70  mfu: 26.87%
[rank1]:2026-01-02 16:34:29,568 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 70.00GiB(50.07%)  tps: 5,697  tflops: 265.69  mfu: 26.86%
[rank0]:2026-01-02 16:34:29,536 - Avg. fwd time: 14.8108 / Avg. bwd time: 43.0494 / Avg. batch time: 696.8585 (ms) / GPU bubble ratio: 33.58%
[rank0]:2026-01-02 16:34:29,572 -  step: 200  loss: -4.0000  grad_norm: 19.6900  memory: 72.15GiB(51.60%)  tps: 5,697  tflops: 265.69  mfu: 26.86%
[rank3]:2026-01-02 16:34:29,707 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1634_step200_rank3.svg
[rank3]:			> Batch Time: 695.47 ms, GPU Bubble Ratio: 33.18%, 28.88%, 36.88%, 29.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  326-42-368ms   | [S0,MB1,B]  372-43-415ms   | [S0,MB2,B]  419-43-462ms   | [S0,MB3,B]  465-43-509ms   | [S0,MB4,B]  512-43-555ms   | [S0,MB5,B]  559-43-602ms   | [S0,MB6,B]  605-43-648ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  100-15-116ms   | [S1,MB6,F]  116-15-132ms   | [S1,MB7,F]  132-15-148ms   | [S1,MB0,B]  279-45-325ms   | [S1,MB1,B]  326-45-372ms   | [S1,MB2,B]  372-45-418ms   | [S1,MB3,B]  419-45-465ms   | [S1,MB4,B]  465-45-511ms   | [S1,MB5,B]  512-45-558ms   | [S1,MB6,B]  558-45-604ms   | [S1,MB7,B]  605-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  148-13-162ms   | [S2,MB0,B]  239-40-279ms   | [S2,MB1,B]  285-40-326ms   | [S2,MB2,B]  332-40-372ms   | [S2,MB3,B]  378-40-418ms   | [S2,MB4,B]  424-40-465ms   | [S2,MB5,B]  471-40-511ms   | [S2,MB6,B]  517-40-558ms   | [S2,MB7,B]  563-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  108-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-173ms   | [S3,MB7,F]  176-14-190ms   | [S3,MB0,B]  193-46-239ms   | [S3,MB1,B]  238-46-285ms   | [S3,MB2,B]  285-46-331ms   | [S3,MB3,B]  331-46-377ms   | [S3,MB4,B]  377-46-423ms   | [S3,MB5,B]  424-46-470ms   | [S3,MB6,B]  470-46-516ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-02 16:36:51,106 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:36:53,837 - Avg. fwd time: 15.2011 / Avg. bwd time: 46.0656 / Avg. batch time: 507.4920 (ms) / GPU bubble ratio: 3.42%
[rank1]:2026-01-02 16:36:53,935 - Avg. fwd time: 16.1002 / Avg. bwd time: 45.5262 / Avg. batch time: 633.7262 (ms) / GPU bubble ratio: 22.20%
[rank2]:2026-01-02 16:36:53,884 - Avg. fwd time: 14.2311 / Avg. bwd time: 40.4448 / Avg. batch time: 567.0083 (ms) / GPU bubble ratio: 22.86%
[rank1]:2026-01-02 16:36:54,017 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 70.00GiB(50.07%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank3]:2026-01-02 16:36:54,023 -  step: 250  loss:  0.2557  grad_norm:  1.7990  memory: 76.42GiB(54.66%)  tps: 5,671  tflops: 264.51  mfu: 26.75%
[rank0]:2026-01-02 16:36:53,985 - Avg. fwd time: 14.8056 / Avg. bwd time: 43.0679 / Avg. batch time: 696.6518 (ms) / GPU bubble ratio: 33.54%
[rank0]:2026-01-02 16:36:54,021 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 72.15GiB(51.60%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank2]:2026-01-02 16:36:54,015 -  step: 250  loss: -4.0000  grad_norm:  1.7990  memory: 62.32GiB(44.58%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank0]:2026-01-02 16:39:15,146 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 16:39:17,928 - Avg. fwd time: 14.2264 / Avg. bwd time: 40.4502 / Avg. batch time: 566.7857 (ms) / GPU bubble ratio: 22.83%
[rank3]:2026-01-02 16:39:17,882 - Avg. fwd time: 15.1895 / Avg. bwd time: 46.0653 / Avg. batch time: 507.3340 (ms) / GPU bubble ratio: 3.41%
[rank1]:2026-01-02 16:39:17,980 - Avg. fwd time: 16.1009 / Avg. bwd time: 45.5296 / Avg. batch time: 633.4725 (ms) / GPU bubble ratio: 22.17%
[rank1]:2026-01-02 16:39:18,060 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 70.00GiB(50.07%)  tps: 5,687  tflops: 265.25  mfu: 26.82%
[rank3]:2026-01-02 16:39:18,063 -  step: 300  loss:  0.2809  grad_norm:  0.4396  memory: 76.42GiB(54.66%)  tps: 5,687  tflops: 265.26  mfu: 26.82%
[rank0]:2026-01-02 16:39:18,028 - Avg. fwd time: 14.8009 / Avg. bwd time: 43.0846 / Avg. batch time: 696.3813 (ms) / GPU bubble ratio: 33.50%
[rank0]:2026-01-02 16:39:18,064 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 72.15GiB(51.60%)  tps: 5,687  tflops: 265.25  mfu: 26.82%
[rank2]:2026-01-02 16:39:18,057 -  step: 300  loss: -4.0000  grad_norm:  0.4396  memory: 62.32GiB(44.58%)  tps: 5,687  tflops: 265.25  mfu: 26.82%
[rank3]:2026-01-02 16:39:18,198 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1639_step300_rank3.svg
[rank3]:			> Batch Time: 694.62 ms, GPU Bubble Ratio: 33.01%, 28.81%, 36.86%, 29.35%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-103ms    | [S0,MB7,F]  103-14-118ms   | [S0,MB0,B]  326-42-369ms   | [S0,MB1,B]  372-43-415ms   | [S0,MB2,B]  418-43-462ms   | [S0,MB3,B]  465-43-508ms   | [S0,MB4,B]  511-43-555ms   | [S0,MB5,B]  558-43-601ms   | [S0,MB6,B]  604-43-648ms   | [S0,MB7,B]  651-43-694ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  101-15-116ms   | [S1,MB6,F]  117-15-132ms   | [S1,MB7,F]  133-15-148ms   | [S1,MB0,B]  280-45-325ms   | [S1,MB1,B]  326-45-371ms   | [S1,MB2,B]  372-45-417ms   | [S1,MB3,B]  418-45-464ms   | [S1,MB4,B]  465-45-511ms   | [S1,MB5,B]  511-45-557ms   | [S1,MB6,B]  557-45-603ms   | [S1,MB7,B]  604-45-650ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  84-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  148-13-162ms   | [S2,MB0,B]  239-40-279ms   | [S2,MB1,B]  285-40-325ms   | [S2,MB2,B]  331-40-371ms   | [S2,MB3,B]  377-40-418ms   | [S2,MB4,B]  423-40-464ms   | [S2,MB5,B]  470-40-511ms   | [S2,MB6,B]  516-40-557ms   | [S2,MB7,B]  562-40-603ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-14-191ms   | [S3,MB0,B]  193-46-239ms   | [S3,MB1,B]  238-46-285ms   | [S3,MB2,B]  284-46-331ms   | [S3,MB3,B]  330-46-377ms   | [S3,MB4,B]  377-46-423ms   | [S3,MB5,B]  423-46-469ms   | [S3,MB6,B]  469-46-516ms   | [S3,MB7,B]  515-46-562ms  
[rank0]:2026-01-02 16:41:39,606 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:41:42,350 - Avg. fwd time: 15.1861 / Avg. bwd time: 46.0711 / Avg. batch time: 507.3107 (ms) / GPU bubble ratio: 3.40%
[rank2]:2026-01-02 16:41:42,396 - Avg. fwd time: 14.2261 / Avg. bwd time: 40.4570 / Avg. batch time: 566.7692 (ms) / GPU bubble ratio: 22.81%
[rank1]:2026-01-02 16:41:42,447 - Avg. fwd time: 16.1051 / Avg. bwd time: 45.5333 / Avg. batch time: 633.4325 (ms) / GPU bubble ratio: 22.15%
[rank0]:2026-01-02 16:41:42,497 - Avg. fwd time: 14.8029 / Avg. bwd time: 43.0942 / Avg. batch time: 696.3277 (ms) / GPU bubble ratio: 33.48%
[rank3]:2026-01-02 16:41:42,533 -  step: 350  loss:  0.3283  grad_norm:  0.5292  memory: 76.42GiB(54.66%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank0]:2026-01-02 16:41:42,534 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 72.15GiB(51.60%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank1]:2026-01-02 16:41:42,530 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 70.00GiB(50.07%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank2]:2026-01-02 16:41:42,527 -  step: 350  loss: -4.0000  grad_norm:  0.5292  memory: 62.32GiB(44.58%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank0]:2026-01-02 16:44:04,073 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:44:06,822 - Avg. fwd time: 15.1815 / Avg. bwd time: 46.0729 / Avg. batch time: 507.2558 (ms) / GPU bubble ratio: 3.39%
[rank2]:2026-01-02 16:44:06,870 - Avg. fwd time: 14.2264 / Avg. bwd time: 40.4627 / Avg. batch time: 566.6807 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 16:44:06,923 - Avg. fwd time: 16.1062 / Avg. bwd time: 45.5378 / Avg. batch time: 633.3267 (ms) / GPU bubble ratio: 22.13%
[rank0]:2026-01-02 16:44:06,972 - Avg. fwd time: 14.8041 / Avg. bwd time: 43.1038 / Avg. batch time: 696.2346 (ms) / GPU bubble ratio: 33.46%
[rank0]:2026-01-02 16:44:07,007 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 72.15GiB(51.60%)  tps: 5,670  tflops: 264.46  mfu: 26.74%
[rank1]:2026-01-02 16:44:07,003 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 70.00GiB(50.07%)  tps: 5,670  tflops: 264.46  mfu: 26.74%
[rank3]:2026-01-02 16:44:07,009 -  step: 400  loss:  0.2626  grad_norm:  0.3711  memory: 76.42GiB(54.66%)  tps: 5,670  tflops: 264.47  mfu: 26.74%
[rank2]:2026-01-02 16:44:07,001 -  step: 400  loss: -4.0000  grad_norm:  0.3711  memory: 62.32GiB(44.58%)  tps: 5,670  tflops: 264.46  mfu: 26.74%
[rank3]:2026-01-02 16:44:07,152 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1644_step400_rank3.svg
[rank3]:			> Batch Time: 696.50 ms, GPU Bubble Ratio: 33.18%, 29.00%, 37.00%, 29.51%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-13-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-118ms   | [S0,MB0,B]  326-42-369ms   | [S0,MB1,B]  373-43-416ms   | [S0,MB2,B]  420-43-463ms   | [S0,MB3,B]  466-43-509ms   | [S0,MB4,B]  513-43-556ms   | [S0,MB5,B]  559-43-603ms   | [S0,MB6,B]  605-43-649ms   | [S0,MB7,B]  653-43-696ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  280-45-326ms   | [S1,MB1,B]  327-45-372ms   | [S1,MB2,B]  373-45-419ms   | [S1,MB3,B]  420-45-466ms   | [S1,MB4,B]  466-45-512ms   | [S1,MB5,B]  512-45-558ms   | [S1,MB6,B]  558-45-604ms   | [S1,MB7,B]  605-45-651ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  132-13-146ms   | [S2,MB7,F]  148-13-162ms   | [S2,MB0,B]  240-40-280ms   | [S2,MB1,B]  286-40-326ms   | [S2,MB2,B]  332-40-373ms   | [S2,MB3,B]  378-40-419ms   | [S2,MB4,B]  425-40-465ms   | [S2,MB5,B]  471-40-512ms   | [S2,MB6,B]  517-40-558ms   | [S2,MB7,B]  564-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  125-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-14-191ms   | [S3,MB0,B]  193-46-239ms   | [S3,MB1,B]  239-46-285ms   | [S3,MB2,B]  285-46-332ms   | [S3,MB3,B]  332-46-378ms   | [S3,MB4,B]  378-46-424ms   | [S3,MB5,B]  424-46-470ms   | [S3,MB6,B]  470-46-517ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-02 16:46:28,316 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 16:46:31,111 - Avg. fwd time: 14.2246 / Avg. bwd time: 40.4671 / Avg. batch time: 566.6408 (ms) / GPU bubble ratio: 22.78%
[rank3]:2026-01-02 16:46:31,063 - Avg. fwd time: 15.1773 / Avg. bwd time: 46.0729 / Avg. batch time: 507.1962 (ms) / GPU bubble ratio: 3.39%
[rank0]:2026-01-02 16:46:31,224 - Avg. fwd time: 14.8044 / Avg. bwd time: 43.1120 / Avg. batch time: 696.1915 (ms) / GPU bubble ratio: 33.45%
[rank1]:2026-01-02 16:46:31,170 - Avg. fwd time: 16.1074 / Avg. bwd time: 45.5421 / Avg. batch time: 633.2857 (ms) / GPU bubble ratio: 22.12%
[rank1]:2026-01-02 16:46:31,257 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 70.00GiB(50.07%)  tps: 5,679  tflops: 264.86  mfu: 26.78%
[rank2]:2026-01-02 16:46:31,255 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 62.32GiB(44.58%)  tps: 5,679  tflops: 264.87  mfu: 26.78%
[rank3]:2026-01-02 16:46:31,261 -  step: 450  loss:  0.2786  grad_norm:  0.3552  memory: 76.42GiB(54.66%)  tps: 5,679  tflops: 264.87  mfu: 26.78%
[rank0]:2026-01-02 16:46:31,261 -  step: 450  loss: -4.0000  grad_norm:  0.3552  memory: 72.15GiB(51.60%)  tps: 5,679  tflops: 264.86  mfu: 26.78%
[rank0]:2026-01-02 16:48:52,373 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:48:55,107 - Avg. fwd time: 15.1734 / Avg. bwd time: 46.0740 / Avg. batch time: 507.1539 (ms) / GPU bubble ratio: 3.39%
[rank2]:2026-01-02 16:48:55,155 - Avg. fwd time: 14.2254 / Avg. bwd time: 40.4704 / Avg. batch time: 566.5643 (ms) / GPU bubble ratio: 22.77%
[rank0]:2026-01-02 16:48:55,256 - Avg. fwd time: 14.8030 / Avg. bwd time: 43.1193 / Avg. batch time: 696.0985 (ms) / GPU bubble ratio: 33.43%
[rank2]:2026-01-02 16:48:55,285 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 62.32GiB(44.58%)  tps: 5,688  tflops: 265.28  mfu: 26.82%
[rank1]:2026-01-02 16:48:55,206 - Avg. fwd time: 16.1078 / Avg. bwd time: 45.5441 / Avg. batch time: 633.2037 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 16:48:55,287 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 70.00GiB(50.07%)  tps: 5,688  tflops: 265.28  mfu: 26.82%
[rank0]:2026-01-02 16:48:55,291 -  step: 500  loss: -4.0000  grad_norm:  0.3576  memory: 72.15GiB(51.60%)  tps: 5,688  tflops: 265.28  mfu: 26.82%
[rank3]:2026-01-02 16:48:55,294 -  step: 500  loss:  0.2718  grad_norm:  0.3576  memory: 76.42GiB(54.66%)  tps: 5,688  tflops: 265.28  mfu: 26.82%
[rank3]:2026-01-02 16:48:55,443 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1648_step500_rank3.svg
[rank3]:			> Batch Time: 696.47 ms, GPU Bubble Ratio: 33.16%, 28.96%, 36.94%, 29.41%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-74ms     | [S0,MB5,F]  74-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-118ms   | [S0,MB0,B]  327-42-369ms   | [S0,MB1,B]  373-43-416ms   | [S0,MB2,B]  420-43-463ms   | [S0,MB3,B]  466-43-510ms   | [S0,MB4,B]  513-43-556ms   | [S0,MB5,B]  559-43-603ms   | [S0,MB6,B]  606-43-649ms   | [S0,MB7,B]  653-43-696ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-100ms    | [S1,MB5,F]  101-15-116ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  281-45-326ms   | [S1,MB1,B]  327-45-372ms   | [S1,MB2,B]  373-45-419ms   | [S1,MB3,B]  420-45-466ms   | [S1,MB4,B]  466-45-512ms   | [S1,MB5,B]  513-45-558ms   | [S1,MB6,B]  559-45-605ms   | [S1,MB7,B]  606-45-652ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-98ms     | [S2,MB4,F]  100-13-114ms   | [S2,MB5,F]  116-13-130ms   | [S2,MB6,F]  133-13-146ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  240-40-280ms   | [S2,MB1,B]  286-40-327ms   | [S2,MB2,B]  333-40-373ms   | [S2,MB3,B]  379-40-420ms   | [S2,MB4,B]  425-40-466ms   | [S2,MB5,B]  471-40-512ms   | [S2,MB6,B]  518-40-559ms   | [S2,MB7,B]  564-40-605ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  92-14-107ms    | [S3,MB3,F]  109-14-123ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  142-14-157ms   | [S3,MB6,F]  159-14-174ms   | [S3,MB7,F]  176-15-191ms   | [S3,MB0,B]  193-46-239ms   | [S3,MB1,B]  239-46-285ms   | [S3,MB2,B]  286-46-332ms   | [S3,MB3,B]  332-46-378ms   | [S3,MB4,B]  378-46-425ms   | [S3,MB5,B]  425-46-471ms   | [S3,MB6,B]  471-46-517ms   | [S3,MB7,B]  517-46-564ms  
[rank0]:2026-01-02 16:51:16,193 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:51:18,930 - Avg. fwd time: 15.1680 / Avg. bwd time: 46.0731 / Avg. batch time: 507.0856 (ms) / GPU bubble ratio: 3.38%
[rank1]:2026-01-02 16:51:19,034 - Avg. fwd time: 16.1086 / Avg. bwd time: 45.5452 / Avg. batch time: 633.1469 (ms) / GPU bubble ratio: 22.10%
[rank2]:2026-01-02 16:51:18,978 - Avg. fwd time: 14.2244 / Avg. bwd time: 40.4728 / Avg. batch time: 566.5131 (ms) / GPU bubble ratio: 22.76%
[rank3]:2026-01-02 16:51:19,118 -  step: 550  loss:  0.1622  grad_norm:  0.2790  memory: 76.42GiB(54.66%)  tps: 5,696  tflops: 265.66  mfu: 26.86%
[rank0]:2026-01-02 16:51:19,083 - Avg. fwd time: 14.8018 / Avg. bwd time: 43.1268 / Avg. batch time: 696.0383 (ms) / GPU bubble ratio: 33.42%
[rank0]:2026-01-02 16:51:19,119 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 72.15GiB(51.60%)  tps: 5,696  tflops: 265.65  mfu: 26.86%
[rank1]:2026-01-02 16:51:19,115 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 70.00GiB(50.07%)  tps: 5,696  tflops: 265.65  mfu: 26.86%
[rank2]:2026-01-02 16:51:19,112 -  step: 550  loss: -4.0000  grad_norm:  0.2790  memory: 62.32GiB(44.58%)  tps: 5,696  tflops: 265.65  mfu: 26.86%
[rank0]:2026-01-02 16:53:41,219 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:53:44,009 - Avg. fwd time: 15.1807 / Avg. bwd time: 46.0920 / Avg. batch time: 507.3278 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 16:53:44,060 - Avg. fwd time: 14.2375 / Avg. bwd time: 40.4843 / Avg. batch time: 566.7507 (ms) / GPU bubble ratio: 22.76%
[rank1]:2026-01-02 16:53:44,114 - Avg. fwd time: 16.1254 / Avg. bwd time: 45.5582 / Avg. batch time: 633.3989 (ms) / GPU bubble ratio: 22.09%
[rank2]:2026-01-02 16:53:44,198 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 62.32GiB(44.58%)  tps: 5,646  tflops: 263.35  mfu: 26.63%
[rank3]:2026-01-02 16:53:44,206 -  step: 600  loss:  0.4080  grad_norm:  0.7070  memory: 76.42GiB(54.66%)  tps: 5,646  tflops: 263.35  mfu: 26.63%
[rank0]:2026-01-02 16:53:44,168 - Avg. fwd time: 14.8156 / Avg. bwd time: 43.1433 / Avg. batch time: 696.3090 (ms) / GPU bubble ratio: 33.41%
[rank0]:2026-01-02 16:53:44,205 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 72.15GiB(51.60%)  tps: 5,646  tflops: 263.35  mfu: 26.63%
[rank1]:2026-01-02 16:53:44,201 -  step: 600  loss: -4.0000  grad_norm:  0.7070  memory: 70.00GiB(50.07%)  tps: 5,646  tflops: 263.35  mfu: 26.63%
[rank3]:2026-01-02 16:53:44,345 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1653_step600_rank3.svg
[rank3]:			> Batch Time: 702.25 ms, GPU Bubble Ratio: 33.12%, 28.87%, 36.95%, 29.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-14-106ms    | [S0,MB7,F]  106-14-121ms   | [S0,MB0,B]  331-43-374ms   | [S0,MB1,B]  377-43-420ms   | [S0,MB2,B]  424-43-467ms   | [S0,MB3,B]  471-43-514ms   | [S0,MB4,B]  518-43-561ms   | [S0,MB5,B]  564-43-608ms   | [S0,MB6,B]  611-43-655ms   | [S0,MB7,B]  658-43-702ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  285-45-330ms   | [S1,MB1,B]  331-45-377ms   | [S1,MB2,B]  377-45-423ms   | [S1,MB3,B]  424-46-470ms   | [S1,MB4,B]  471-46-517ms   | [S1,MB5,B]  517-46-564ms   | [S1,MB6,B]  564-46-610ms   | [S1,MB7,B]  611-46-657ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  244-40-284ms   | [S2,MB1,B]  290-40-331ms   | [S2,MB2,B]  336-40-377ms   | [S2,MB3,B]  383-40-424ms   | [S2,MB4,B]  430-40-470ms   | [S2,MB5,B]  476-40-517ms   | [S2,MB6,B]  523-40-564ms   | [S2,MB7,B]  570-40-610ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-18-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  127-15-142ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  179-15-195ms   | [S3,MB0,B]  197-46-243ms   | [S3,MB1,B]  243-46-290ms   | [S3,MB2,B]  289-46-336ms   | [S3,MB3,B]  336-46-382ms   | [S3,MB4,B]  382-46-429ms   | [S3,MB5,B]  429-46-475ms   | [S3,MB6,B]  476-46-522ms   | [S3,MB7,B]  522-46-569ms  
[rank0]:2026-01-02 16:56:08,012 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:56:10,773 - Avg. fwd time: 15.2032 / Avg. bwd time: 46.1206 / Avg. batch time: 507.7294 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 16:56:10,821 - Avg. fwd time: 14.2587 / Avg. bwd time: 40.4999 / Avg. batch time: 567.1941 (ms) / GPU bubble ratio: 22.77%
[rank1]:2026-01-02 16:56:10,880 - Avg. fwd time: 16.1493 / Avg. bwd time: 45.5750 / Avg. batch time: 633.8674 (ms) / GPU bubble ratio: 22.10%
[rank2]:2026-01-02 16:56:10,958 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 62.32GiB(44.58%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank0]:2026-01-02 16:56:10,929 - Avg. fwd time: 14.8390 / Avg. bwd time: 43.1609 / Avg. batch time: 696.8125 (ms) / GPU bubble ratio: 33.41%
[rank0]:2026-01-02 16:56:10,965 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 72.15GiB(51.60%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank3]:2026-01-02 16:56:10,965 -  step: 650  loss:  0.2718  grad_norm:  0.5331  memory: 76.42GiB(54.66%)  tps: 5,582  tflops: 260.35  mfu: 26.32%
[rank1]:2026-01-02 16:56:10,961 -  step: 650  loss: -4.0000  grad_norm:  0.5331  memory: 70.00GiB(50.07%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank0]:2026-01-02 16:58:34,227 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 16:58:37,026 - Avg. fwd time: 15.2237 / Avg. bwd time: 46.1462 / Avg. batch time: 508.0933 (ms) / GPU bubble ratio: 3.37%
[rank1]:2026-01-02 16:58:37,132 - Avg. fwd time: 16.1714 / Avg. bwd time: 45.5899 / Avg. batch time: 634.2630 (ms) / GPU bubble ratio: 22.10%
[rank2]:2026-01-02 16:58:37,076 - Avg. fwd time: 14.2769 / Avg. bwd time: 40.5137 / Avg. batch time: 567.5689 (ms) / GPU bubble ratio: 22.77%
[rank0]:2026-01-02 16:58:37,182 - Avg. fwd time: 14.8581 / Avg. bwd time: 43.1750 / Avg. batch time: 697.2273 (ms) / GPU bubble ratio: 33.41%
[rank0]:2026-01-02 16:58:37,218 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 72.15GiB(51.60%)  tps: 5,601  tflops: 261.24  mfu: 26.41%
[rank3]:2026-01-02 16:58:37,220 -  step: 700  loss:  0.3478  grad_norm:  0.5993  memory: 76.42GiB(54.66%)  tps: 5,601  tflops: 261.25  mfu: 26.42%
[rank1]:2026-01-02 16:58:37,214 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 70.00GiB(50.07%)  tps: 5,601  tflops: 261.24  mfu: 26.41%
[rank2]:2026-01-02 16:58:37,212 -  step: 700  loss: -4.0000  grad_norm:  0.5993  memory: 62.32GiB(44.58%)  tps: 5,601  tflops: 261.24  mfu: 26.41%
[rank3]:2026-01-02 16:58:37,359 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1658_step700_rank3.svg
[rank3]:			> Batch Time: 703.75 ms, GPU Bubble Ratio: 33.23%, 28.94%, 37.00%, 29.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-14-106ms    | [S0,MB7,F]  106-14-121ms   | [S0,MB0,B]  332-43-375ms   | [S0,MB1,B]  378-43-421ms   | [S0,MB2,B]  426-43-469ms   | [S0,MB3,B]  473-43-516ms   | [S0,MB4,B]  519-43-563ms   | [S0,MB5,B]  566-43-610ms   | [S0,MB6,B]  613-43-656ms   | [S0,MB7,B]  660-43-703ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  285-45-331ms   | [S1,MB1,B]  332-45-377ms   | [S1,MB2,B]  379-45-425ms   | [S1,MB3,B]  426-46-472ms   | [S1,MB4,B]  472-46-519ms   | [S1,MB5,B]  519-46-565ms   | [S1,MB6,B]  566-46-612ms   | [S1,MB7,B]  613-46-659ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  244-40-285ms   | [S2,MB1,B]  291-40-331ms   | [S2,MB2,B]  338-40-379ms   | [S2,MB3,B]  384-40-425ms   | [S2,MB4,B]  431-40-472ms   | [S2,MB5,B]  477-41-519ms   | [S2,MB6,B]  524-40-565ms   | [S2,MB7,B]  571-40-612ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  179-15-195ms   | [S3,MB0,B]  197-46-244ms   | [S3,MB1,B]  244-46-290ms   | [S3,MB2,B]  290-46-337ms   | [S3,MB3,B]  337-46-384ms   | [S3,MB4,B]  384-46-430ms   | [S3,MB5,B]  430-46-477ms   | [S3,MB6,B]  477-46-523ms   | [S3,MB7,B]  523-46-570ms  
[rank0]:2026-01-02 17:01:00,179 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:01:02,943 - Avg. fwd time: 15.2354 / Avg. bwd time: 46.1625 / Avg. batch time: 508.3122 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:01:02,994 - Avg. fwd time: 14.2876 / Avg. bwd time: 40.5231 / Avg. batch time: 567.8220 (ms) / GPU bubble ratio: 22.78%
[rank1]:2026-01-02 17:01:03,053 - Avg. fwd time: 16.1852 / Avg. bwd time: 45.5988 / Avg. batch time: 634.5293 (ms) / GPU bubble ratio: 22.10%
[rank0]:2026-01-02 17:01:03,105 - Avg. fwd time: 14.8706 / Avg. bwd time: 43.1842 / Avg. batch time: 697.5120 (ms) / GPU bubble ratio: 33.41%
[rank0]:2026-01-02 17:01:03,141 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 72.15GiB(51.60%)  tps: 5,614  tflops: 261.83  mfu: 26.47%
[rank1]:2026-01-02 17:01:03,137 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 70.00GiB(50.07%)  tps: 5,614  tflops: 261.84  mfu: 26.47%
[rank3]:2026-01-02 17:01:03,141 -  step: 750  loss:  0.1444  grad_norm:  0.4049  memory: 76.42GiB(54.66%)  tps: 5,614  tflops: 261.84  mfu: 26.48%
[rank2]:2026-01-02 17:01:03,135 -  step: 750  loss: -4.0000  grad_norm:  0.4049  memory: 62.32GiB(44.58%)  tps: 5,614  tflops: 261.84  mfu: 26.47%
[rank0]:2026-01-02 17:03:24,607 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:03:27,404 - Avg. fwd time: 15.2352 / Avg. bwd time: 46.1661 / Avg. batch time: 508.3313 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:03:27,452 - Avg. fwd time: 14.2895 / Avg. bwd time: 40.5267 / Avg. batch time: 567.8301 (ms) / GPU bubble ratio: 22.77%
[rank1]:2026-01-02 17:03:27,505 - Avg. fwd time: 16.1867 / Avg. bwd time: 45.6014 / Avg. batch time: 634.5383 (ms) / GPU bubble ratio: 22.10%
[rank0]:2026-01-02 17:03:27,554 - Avg. fwd time: 14.8711 / Avg. bwd time: 43.1877 / Avg. batch time: 697.5216 (ms) / GPU bubble ratio: 33.41%
[rank0]:2026-01-02 17:03:27,590 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 72.15GiB(51.60%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank2]:2026-01-02 17:03:27,584 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 62.32GiB(44.58%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank1]:2026-01-02 17:03:27,586 -  step: 800  loss: -4.0000  grad_norm:  0.5742  memory: 70.00GiB(50.07%)  tps: 5,671  tflops: 264.51  mfu: 26.74%
[rank3]:2026-01-02 17:03:27,589 -  step: 800  loss:  0.2657  grad_norm:  0.5742  memory: 76.42GiB(54.66%)  tps: 5,671  tflops: 264.51  mfu: 26.75%
[rank3]:2026-01-02 17:03:27,721 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1703_step800_rank3.svg
[rank3]:			> Batch Time: 698.09 ms, GPU Bubble Ratio: 33.20%, 28.89%, 36.92%, 29.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-118ms   | [S0,MB0,B]  327-42-370ms   | [S0,MB1,B]  374-43-417ms   | [S0,MB2,B]  420-43-464ms   | [S0,MB3,B]  467-43-510ms   | [S0,MB4,B]  514-43-557ms   | [S0,MB5,B]  560-43-604ms   | [S0,MB6,B]  607-43-650ms   | [S0,MB7,B]  654-43-698ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  281-45-326ms   | [S1,MB1,B]  328-45-373ms   | [S1,MB2,B]  374-45-420ms   | [S1,MB3,B]  420-45-466ms   | [S1,MB4,B]  467-45-513ms   | [S1,MB5,B]  514-46-560ms   | [S1,MB6,B]  560-46-606ms   | [S1,MB7,B]  607-46-653ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  240-40-281ms   | [S2,MB1,B]  286-40-327ms   | [S2,MB2,B]  333-40-374ms   | [S2,MB3,B]  379-40-420ms   | [S2,MB4,B]  426-40-467ms   | [S2,MB5,B]  472-40-513ms   | [S2,MB6,B]  519-40-559ms   | [S2,MB7,B]  565-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-46-240ms   | [S3,MB1,B]  240-46-286ms   | [S3,MB2,B]  286-46-332ms   | [S3,MB3,B]  332-46-379ms   | [S3,MB4,B]  379-46-425ms   | [S3,MB5,B]  425-46-472ms   | [S3,MB6,B]  472-46-518ms   | [S3,MB7,B]  518-46-564ms  
[rank0]:2026-01-02 17:05:49,797 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:05:52,551 - Avg. fwd time: 15.2390 / Avg. bwd time: 46.1731 / Avg. batch time: 508.4121 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:05:52,605 - Avg. fwd time: 14.2953 / Avg. bwd time: 40.5301 / Avg. batch time: 567.9255 (ms) / GPU bubble ratio: 22.77%
[rank0]:2026-01-02 17:05:52,715 - Avg. fwd time: 14.8765 / Avg. bwd time: 43.1924 / Avg. batch time: 697.6305 (ms) / GPU bubble ratio: 33.41%
[rank1]:2026-01-02 17:05:52,659 - Avg. fwd time: 16.1924 / Avg. bwd time: 45.6050 / Avg. batch time: 634.6391 (ms) / GPU bubble ratio: 22.10%
[rank3]:2026-01-02 17:05:52,753 -  step: 850  loss:  0.1216  grad_norm:  0.3777  memory: 76.42GiB(54.66%)  tps: 5,643  tflops: 263.21  mfu: 26.61%
[rank2]:2026-01-02 17:05:52,745 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 62.32GiB(44.58%)  tps: 5,643  tflops: 263.21  mfu: 26.61%
[rank0]:2026-01-02 17:05:52,751 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 72.15GiB(51.60%)  tps: 5,643  tflops: 263.21  mfu: 26.61%
[rank1]:2026-01-02 17:05:52,747 -  step: 850  loss: -4.0000  grad_norm:  0.3777  memory: 70.00GiB(50.07%)  tps: 5,643  tflops: 263.21  mfu: 26.61%
[rank0]:2026-01-02 17:08:13,106 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:08:15,868 - Avg. fwd time: 15.2296 / Avg. bwd time: 46.1645 / Avg. batch time: 508.2608 (ms) / GPU bubble ratio: 3.37%
[rank1]:2026-01-02 17:08:15,978 - Avg. fwd time: 16.1866 / Avg. bwd time: 45.6016 / Avg. batch time: 634.4579 (ms) / GPU bubble ratio: 22.09%
[rank2]:2026-01-02 17:08:15,918 - Avg. fwd time: 14.2897 / Avg. bwd time: 40.5275 / Avg. batch time: 567.7532 (ms) / GPU bubble ratio: 22.76%
[rank0]:2026-01-02 17:08:16,034 - Avg. fwd time: 14.8705 / Avg. bwd time: 43.1913 / Avg. batch time: 697.4456 (ms) / GPU bubble ratio: 33.40%
[rank3]:2026-01-02 17:08:16,070 -  step: 900  loss:  0.1849  grad_norm:  0.4090  memory: 76.42GiB(54.66%)  tps: 5,716  tflops: 266.60  mfu: 26.96%
[rank1]:2026-01-02 17:08:16,066 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 70.00GiB(50.07%)  tps: 5,716  tflops: 266.59  mfu: 26.96%
[rank2]:2026-01-02 17:08:16,064 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 62.32GiB(44.58%)  tps: 5,716  tflops: 266.59  mfu: 26.96%
[rank0]:2026-01-02 17:08:16,070 -  step: 900  loss: -4.0000  grad_norm:  0.4090  memory: 72.15GiB(51.60%)  tps: 5,716  tflops: 266.59  mfu: 26.96%
[rank3]:2026-01-02 17:08:16,207 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1708_step900_rank3.svg
[rank3]:			> Batch Time: 695.53 ms, GPU Bubble Ratio: 32.96%, 28.71%, 36.73%, 29.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  326-42-369ms   | [S0,MB1,B]  372-43-415ms   | [S0,MB2,B]  419-43-462ms   | [S0,MB3,B]  466-43-509ms   | [S0,MB4,B]  512-43-556ms   | [S0,MB5,B]  559-43-602ms   | [S0,MB6,B]  605-43-648ms   | [S0,MB7,B]  652-43-695ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  134-15-150ms   | [S1,MB0,B]  280-45-325ms   | [S1,MB1,B]  326-45-372ms   | [S1,MB2,B]  373-45-418ms   | [S1,MB3,B]  419-45-465ms   | [S1,MB4,B]  466-45-512ms   | [S1,MB5,B]  512-45-558ms   | [S1,MB6,B]  558-46-604ms   | [S1,MB7,B]  604-46-650ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  150-13-163ms   | [S2,MB0,B]  239-40-279ms   | [S2,MB1,B]  285-40-326ms   | [S2,MB2,B]  332-40-372ms   | [S2,MB3,B]  378-40-419ms   | [S2,MB4,B]  424-40-465ms   | [S2,MB5,B]  471-40-512ms   | [S2,MB6,B]  517-40-558ms   | [S2,MB7,B]  563-40-604ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-192ms   | [S3,MB0,B]  194-46-240ms   | [S3,MB1,B]  239-46-285ms   | [S3,MB2,B]  285-46-331ms   | [S3,MB3,B]  331-46-377ms   | [S3,MB4,B]  377-46-424ms   | [S3,MB5,B]  424-46-470ms   | [S3,MB6,B]  470-46-516ms   | [S3,MB7,B]  516-46-562ms  
[rank0]:2026-01-02 17:10:37,290 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:10:40,063 - Avg. fwd time: 15.2303 / Avg. bwd time: 46.1666 / Avg. batch time: 508.2780 (ms) / GPU bubble ratio: 3.36%
[rank2]:2026-01-02 17:10:40,113 - Avg. fwd time: 14.2918 / Avg. bwd time: 40.5303 / Avg. batch time: 567.7839 (ms) / GPU bubble ratio: 22.76%
[rank1]:2026-01-02 17:10:40,171 - Avg. fwd time: 16.1897 / Avg. bwd time: 45.6039 / Avg. batch time: 634.4882 (ms) / GPU bubble ratio: 22.09%
[rank0]:2026-01-02 17:10:40,226 - Avg. fwd time: 14.8722 / Avg. bwd time: 43.1948 / Avg. batch time: 697.4730 (ms) / GPU bubble ratio: 33.40%
[rank0]:2026-01-02 17:10:40,262 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 72.15GiB(51.60%)  tps: 5,681  tflops: 264.98  mfu: 26.79%
[rank2]:2026-01-02 17:10:40,255 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 62.32GiB(44.58%)  tps: 5,681  tflops: 264.98  mfu: 26.79%
[rank3]:2026-01-02 17:10:40,263 -  step: 950  loss:  0.2463  grad_norm:  0.7322  memory: 76.42GiB(54.66%)  tps: 5,681  tflops: 264.98  mfu: 26.79%
[rank1]:2026-01-02 17:10:40,258 -  step: 950  loss: -4.0000  grad_norm:  0.7322  memory: 70.00GiB(50.07%)  tps: 5,681  tflops: 264.98  mfu: 26.79%
[rank0]:2026-01-02 17:13:02,083 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:13:04,817 - Avg. fwd time: 15.2342 / Avg. bwd time: 46.1720 / Avg. batch time: 508.3483 (ms) / GPU bubble ratio: 3.36%
[rank2]:2026-01-02 17:13:04,867 - Avg. fwd time: 14.2955 / Avg. bwd time: 40.5344 / Avg. batch time: 567.8525 (ms) / GPU bubble ratio: 22.75%
[rank1]:2026-01-02 17:13:04,924 - Avg. fwd time: 16.1943 / Avg. bwd time: 45.6081 / Avg. batch time: 634.5615 (ms) / GPU bubble ratio: 22.08%
[rank0]:2026-01-02 17:13:04,975 - Avg. fwd time: 14.8748 / Avg. bwd time: 43.1987 / Avg. batch time: 697.5478 (ms) / GPU bubble ratio: 33.40%
[rank3]:2026-01-02 17:13:05,012 -  step: 1000  loss:  0.1516  grad_norm:  0.2949  memory: 76.42GiB(54.66%)  tps: 5,660  tflops: 263.97  mfu: 26.69%
[rank3]:2026-01-02 17:13:05,012 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 17:13:05,004 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 62.32GiB(44.58%)  tps: 5,659  tflops: 263.96  mfu: 26.69%
[rank2]:2026-01-02 17:13:05,004 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 17:13:05,007 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 70.00GiB(50.07%)  tps: 5,659  tflops: 263.96  mfu: 26.69%
[rank1]:2026-01-02 17:13:05,007 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 17:13:05,010 -  step: 1000  loss: -4.0000  grad_norm:  0.2949  memory: 72.15GiB(51.60%)  tps: 5,659  tflops: 263.96  mfu: 26.69%
[rank0]:2026-01-02 17:13:05,010 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 17:13:05,011 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-02 17:13:20,549 - Finished saving the checkpoint (or staging if async is enabled)in 15.54 seconds.
[rank3]:2026-01-02 17:13:21,975 - Finished saving the checkpoint (or staging if async is enabled)in 16.96 seconds.
[rank1]:2026-01-02 17:13:22,869 - Finished saving the checkpoint (or staging if async is enabled)in 17.86 seconds.
[rank0]:2026-01-02 17:13:25,905 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 17:13:25,906 - Finished saving the checkpoint (or staging if async is enabled)in 20.90 seconds.
[rank3]:2026-01-02 17:13:26,098 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1713_step1000_rank3.svg
[rank3]:			> Batch Time: 699.06 ms, GPU Bubble Ratio: 33.23%, 28.94%, 36.93%, 29.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  328-43-371ms   | [S0,MB1,B]  375-43-418ms   | [S0,MB2,B]  421-43-464ms   | [S0,MB3,B]  468-43-511ms   | [S0,MB4,B]  515-43-559ms   | [S0,MB5,B]  562-43-605ms   | [S0,MB6,B]  608-43-652ms   | [S0,MB7,B]  655-43-699ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  102-15-118ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  282-45-327ms   | [S1,MB1,B]  328-45-374ms   | [S1,MB2,B]  375-45-421ms   | [S1,MB3,B]  421-45-467ms   | [S1,MB4,B]  468-46-514ms   | [S1,MB5,B]  515-46-561ms   | [S1,MB6,B]  561-46-607ms   | [S1,MB7,B]  608-46-654ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  70-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  134-14-148ms   | [S2,MB7,F]  150-14-164ms   | [S2,MB0,B]  242-40-282ms   | [S2,MB1,B]  288-40-328ms   | [S2,MB2,B]  334-40-375ms   | [S2,MB3,B]  381-40-421ms   | [S2,MB4,B]  427-40-468ms   | [S2,MB5,B]  474-40-514ms   | [S2,MB6,B]  520-40-561ms   | [S2,MB7,B]  567-40-607ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-15-193ms   | [S3,MB0,B]  195-46-241ms   | [S3,MB1,B]  241-46-287ms   | [S3,MB2,B]  287-46-334ms   | [S3,MB3,B]  333-46-380ms   | [S3,MB4,B]  380-46-426ms   | [S3,MB5,B]  426-46-473ms   | [S3,MB6,B]  473-46-519ms   | [S3,MB7,B]  519-46-566ms  
[rank0]:2026-01-02 17:15:50,137 - [GC] Peforming periodical GC collection 1.83 seconds
[rank3]:2026-01-02 17:15:52,931 - Avg. fwd time: 15.2356 / Avg. bwd time: 46.1716 / Avg. batch time: 508.5643 (ms) / GPU bubble ratio: 3.40%
[rank2]:2026-01-02 17:15:52,980 - Avg. fwd time: 14.2966 / Avg. bwd time: 40.5358 / Avg. batch time: 568.0915 (ms) / GPU bubble ratio: 22.78%
[rank1]:2026-01-02 17:15:53,036 - Avg. fwd time: 16.1951 / Avg. bwd time: 45.6111 / Avg. batch time: 634.8062 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 17:15:53,120 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 70.00GiB(50.07%)  tps: 4,873  tflops: 227.27  mfu: 22.98%
[rank2]:2026-01-02 17:15:53,118 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 62.32GiB(44.58%)  tps: 4,873  tflops: 227.27  mfu: 22.98%
[rank0]:2026-01-02 17:15:53,089 - Avg. fwd time: 14.8766 / Avg. bwd time: 43.1983 / Avg. batch time: 697.7908 (ms) / GPU bubble ratio: 33.42%
[rank0]:2026-01-02 17:15:53,125 -  step: 1050  loss: -4.0000  grad_norm:  0.8512  memory: 72.15GiB(51.60%)  tps: 4,873  tflops: 227.27  mfu: 22.98%
[rank3]:2026-01-02 17:15:53,124 -  step: 1050  loss:  0.2494  grad_norm:  0.8512  memory: 76.42GiB(54.66%)  tps: 4,873  tflops: 227.28  mfu: 22.98%
[rank0]:2026-01-02 17:18:16,900 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:18:19,664 - Avg. fwd time: 15.2524 / Avg. bwd time: 46.1896 / Avg. batch time: 508.8333 (ms) / GPU bubble ratio: 3.40%
[rank2]:2026-01-02 17:18:19,717 - Avg. fwd time: 14.3107 / Avg. bwd time: 40.5462 / Avg. batch time: 568.3729 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 17:18:19,781 - Avg. fwd time: 16.2101 / Avg. bwd time: 45.6219 / Avg. batch time: 635.1077 (ms) / GPU bubble ratio: 22.11%
[rank0]:2026-01-02 17:18:19,834 - Avg. fwd time: 14.8901 / Avg. bwd time: 43.2045 / Avg. batch time: 698.1071 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:18:19,869 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 72.15GiB(51.60%)  tps: 5,582  tflops: 260.37  mfu: 26.33%
[rank3]:2026-01-02 17:18:19,873 -  step: 1100  loss:  0.2216  grad_norm:  0.3646  memory: 76.42GiB(54.66%)  tps: 5,583  tflops: 260.37  mfu: 26.33%
[rank2]:2026-01-02 17:18:19,863 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 62.32GiB(44.58%)  tps: 5,582  tflops: 260.37  mfu: 26.33%
[rank1]:2026-01-02 17:18:19,866 -  step: 1100  loss: -4.0000  grad_norm:  0.3646  memory: 70.00GiB(50.07%)  tps: 5,582  tflops: 260.37  mfu: 26.33%
[rank3]:2026-01-02 17:18:20,020 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1718_step1100_rank3.svg
[rank3]:			> Batch Time: 705.78 ms, GPU Bubble Ratio: 33.32%, 29.02%, 36.95%, 29.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  33-14-47ms     | [S0,MB3,F]  47-14-62ms     | [S0,MB4,F]  62-14-76ms     | [S0,MB5,F]  77-14-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-122ms   | [S0,MB0,B]  332-43-375ms   | [S0,MB1,B]  379-43-423ms   | [S0,MB2,B]  426-43-470ms   | [S0,MB3,B]  473-43-517ms   | [S0,MB4,B]  520-43-564ms   | [S0,MB5,B]  567-43-611ms   | [S0,MB6,B]  614-43-657ms   | [S0,MB7,B]  662-43-705ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-16-87ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-120ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  136-16-153ms   | [S1,MB0,B]  286-45-331ms   | [S1,MB1,B]  333-45-379ms   | [S1,MB2,B]  380-46-426ms   | [S1,MB3,B]  427-46-473ms   | [S1,MB4,B]  473-46-520ms   | [S1,MB5,B]  520-46-567ms   | [S1,MB6,B]  567-46-613ms   | [S1,MB7,B]  615-46-661ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-14-70ms     | [S2,MB2,F]  71-14-85ms     | [S2,MB3,F]  86-14-101ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  153-14-167ms   | [S2,MB0,B]  245-40-286ms   | [S2,MB1,B]  292-40-333ms   | [S2,MB2,B]  339-40-380ms   | [S2,MB3,B]  385-41-426ms   | [S2,MB4,B]  432-41-473ms   | [S2,MB5,B]  479-41-520ms   | [S2,MB6,B]  526-41-567ms   | [S2,MB7,B]  573-41-614ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-144ms   | [S3,MB5,F]  146-15-161ms   | [S3,MB6,F]  163-15-179ms   | [S3,MB7,F]  181-15-196ms   | [S3,MB0,B]  198-46-245ms   | [S3,MB1,B]  244-46-291ms   | [S3,MB2,B]  291-46-338ms   | [S3,MB3,B]  338-46-385ms   | [S3,MB4,B]  385-46-432ms   | [S3,MB5,B]  431-46-478ms   | [S3,MB6,B]  478-46-525ms   | [S3,MB7,B]  525-46-572ms  
[rank0]:2026-01-02 17:20:41,831 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:20:44,586 - Avg. fwd time: 15.2563 / Avg. bwd time: 46.1949 / Avg. batch time: 508.8947 (ms) / GPU bubble ratio: 3.40%
[rank2]:2026-01-02 17:20:44,649 - Avg. fwd time: 14.3142 / Avg. bwd time: 40.5499 / Avg. batch time: 568.4527 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 17:20:44,709 - Avg. fwd time: 16.2142 / Avg. bwd time: 45.6252 / Avg. batch time: 635.1937 (ms) / GPU bubble ratio: 22.12%
[rank0]:2026-01-02 17:20:44,761 - Avg. fwd time: 14.8927 / Avg. bwd time: 43.2057 / Avg. batch time: 698.1909 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:20:44,797 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 72.15GiB(51.60%)  tps: 5,652  tflops: 263.63  mfu: 26.66%
[rank3]:2026-01-02 17:20:44,801 -  step: 1150  loss:  0.2111  grad_norm:  0.5336  memory: 76.42GiB(54.66%)  tps: 5,653  tflops: 263.64  mfu: 26.66%
[rank2]:2026-01-02 17:20:44,791 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 62.32GiB(44.58%)  tps: 5,652  tflops: 263.63  mfu: 26.66%
[rank1]:2026-01-02 17:20:44,793 -  step: 1150  loss: -4.0000  grad_norm:  0.5336  memory: 70.00GiB(50.07%)  tps: 5,653  tflops: 263.63  mfu: 26.66%
[rank0]:2026-01-02 17:23:06,663 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:23:09,434 - Avg. fwd time: 15.2589 / Avg. bwd time: 46.1981 / Avg. batch time: 508.9307 (ms) / GPU bubble ratio: 3.39%
[rank2]:2026-01-02 17:23:09,486 - Avg. fwd time: 14.3171 / Avg. bwd time: 40.5530 / Avg. batch time: 568.4861 (ms) / GPU bubble ratio: 22.78%
[rank1]:2026-01-02 17:23:09,541 - Avg. fwd time: 16.2180 / Avg. bwd time: 45.6278 / Avg. batch time: 635.2311 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 17:23:09,623 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 62.32GiB(44.58%)  tps: 5,656  tflops: 263.81  mfu: 26.67%
[rank1]:2026-01-02 17:23:09,625 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 70.00GiB(50.07%)  tps: 5,656  tflops: 263.81  mfu: 26.67%
[rank0]:2026-01-02 17:23:09,594 - Avg. fwd time: 14.8950 / Avg. bwd time: 43.2077 / Avg. batch time: 698.2294 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:23:09,629 -  step: 1200  loss: -4.0000  grad_norm:  0.4373  memory: 72.15GiB(51.60%)  tps: 5,656  tflops: 263.81  mfu: 26.67%
[rank3]:2026-01-02 17:23:09,629 -  step: 1200  loss:  0.2638  grad_norm:  0.4373  memory: 76.42GiB(54.66%)  tps: 5,656  tflops: 263.82  mfu: 26.68%
[rank3]:2026-01-02 17:23:09,764 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1723_step1200_rank3.svg
[rank3]:			> Batch Time: 700.62 ms, GPU Bubble Ratio: 33.30%, 29.00%, 36.94%, 29.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-75ms     | [S0,MB5,F]  75-14-90ms     | [S0,MB6,F]  90-14-105ms    | [S0,MB7,F]  105-14-120ms   | [S0,MB0,B]  329-43-372ms   | [S0,MB1,B]  375-43-418ms   | [S0,MB2,B]  423-43-466ms   | [S0,MB3,B]  469-43-513ms   | [S0,MB4,B]  516-43-559ms   | [S0,MB5,B]  562-43-606ms   | [S0,MB6,B]  609-43-652ms   | [S0,MB7,B]  657-43-700ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  70-15-85ms     | [S1,MB4,F]  86-15-101ms    | [S1,MB5,F]  102-16-118ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  283-45-328ms   | [S1,MB1,B]  329-45-375ms   | [S1,MB2,B]  376-45-422ms   | [S1,MB3,B]  422-46-468ms   | [S1,MB4,B]  469-46-515ms   | [S1,MB5,B]  515-46-561ms   | [S1,MB6,B]  562-46-608ms   | [S1,MB7,B]  609-46-655ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-14-115ms   | [S2,MB5,F]  118-14-132ms   | [S2,MB6,F]  134-14-148ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  242-40-282ms   | [S2,MB1,B]  288-40-329ms   | [S2,MB2,B]  335-40-376ms   | [S2,MB3,B]  381-40-422ms   | [S2,MB4,B]  428-40-469ms   | [S2,MB5,B]  474-40-515ms   | [S2,MB6,B]  521-40-562ms   | [S2,MB7,B]  567-40-608ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-18-74ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  93-14-108ms    | [S3,MB3,F]  110-14-125ms   | [S3,MB4,F]  127-14-142ms   | [S3,MB5,F]  144-15-159ms   | [S3,MB6,F]  161-15-176ms   | [S3,MB7,F]  178-15-193ms   | [S3,MB0,B]  195-46-242ms   | [S3,MB1,B]  242-46-288ms   | [S3,MB2,B]  288-46-334ms   | [S3,MB3,B]  335-46-381ms   | [S3,MB4,B]  381-46-427ms   | [S3,MB5,B]  427-46-474ms   | [S3,MB6,B]  474-46-520ms   | [S3,MB7,B]  520-46-567ms  
[rank0]:2026-01-02 17:25:31,477 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 17:25:34,306 - Avg. fwd time: 14.3183 / Avg. bwd time: 40.5547 / Avg. batch time: 568.4957 (ms) / GPU bubble ratio: 22.78%
[rank3]:2026-01-02 17:25:34,250 - Avg. fwd time: 15.2591 / Avg. bwd time: 46.1993 / Avg. batch time: 508.9321 (ms) / GPU bubble ratio: 3.39%
[rank1]:2026-01-02 17:25:34,371 - Avg. fwd time: 16.2190 / Avg. bwd time: 45.6289 / Avg. batch time: 635.2413 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 17:25:34,461 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 70.00GiB(50.07%)  tps: 5,656  tflops: 263.80  mfu: 26.67%
[rank0]:2026-01-02 17:25:34,428 - Avg. fwd time: 14.8961 / Avg. bwd time: 43.2082 / Avg. batch time: 698.2445 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:25:34,465 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 72.15GiB(51.60%)  tps: 5,656  tflops: 263.80  mfu: 26.67%
[rank2]:2026-01-02 17:25:34,459 -  step: 1250  loss: -4.0000  grad_norm:  0.5137  memory: 62.32GiB(44.58%)  tps: 5,656  tflops: 263.80  mfu: 26.67%
[rank3]:2026-01-02 17:25:34,465 -  step: 1250  loss:  0.2512  grad_norm:  0.5137  memory: 76.42GiB(54.66%)  tps: 5,656  tflops: 263.81  mfu: 26.67%
[rank0]:2026-01-02 17:27:56,163 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:27:58,920 - Avg. fwd time: 15.2607 / Avg. bwd time: 46.2016 / Avg. batch time: 508.9536 (ms) / GPU bubble ratio: 3.39%
[rank2]:2026-01-02 17:27:58,971 - Avg. fwd time: 14.3203 / Avg. bwd time: 40.5567 / Avg. batch time: 568.5123 (ms) / GPU bubble ratio: 22.78%
[rank0]:2026-01-02 17:27:59,083 - Avg. fwd time: 14.8971 / Avg. bwd time: 43.2090 / Avg. batch time: 698.2607 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:27:59,119 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 72.15GiB(51.60%)  tps: 5,663  tflops: 264.13  mfu: 26.71%
[rank1]:2026-01-02 17:27:59,027 - Avg. fwd time: 16.2211 / Avg. bwd time: 45.6307 / Avg. batch time: 635.2596 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 17:27:59,115 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 70.00GiB(50.07%)  tps: 5,663  tflops: 264.13  mfu: 26.71%
[rank3]:2026-01-02 17:27:59,121 -  step: 1300  loss:  0.1790  grad_norm:  0.3540  memory: 76.42GiB(54.66%)  tps: 5,663  tflops: 264.14  mfu: 26.71%
[rank2]:2026-01-02 17:27:59,113 -  step: 1300  loss: -4.0000  grad_norm:  0.3540  memory: 62.32GiB(44.58%)  tps: 5,663  tflops: 264.13  mfu: 26.71%
[rank3]:2026-01-02 17:27:59,269 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1727_step1300_rank3.svg
[rank3]:			> Batch Time: 696.47 ms, GPU Bubble Ratio: 33.18%, 28.81%, 36.83%, 29.38%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-118ms   | [S0,MB0,B]  326-42-369ms   | [S0,MB1,B]  373-43-416ms   | [S0,MB2,B]  419-43-463ms   | [S0,MB3,B]  466-43-509ms   | [S0,MB4,B]  513-43-556ms   | [S0,MB5,B]  559-43-602ms   | [S0,MB6,B]  605-43-649ms   | [S0,MB7,B]  653-43-696ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  117-15-133ms   | [S1,MB7,F]  133-15-149ms   | [S1,MB0,B]  280-45-326ms   | [S1,MB1,B]  327-45-372ms   | [S1,MB2,B]  373-45-419ms   | [S1,MB3,B]  420-45-466ms   | [S1,MB4,B]  466-45-512ms   | [S1,MB5,B]  512-45-558ms   | [S1,MB6,B]  559-45-605ms   | [S1,MB7,B]  606-45-652ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  133-13-147ms   | [S2,MB7,F]  149-13-163ms   | [S2,MB0,B]  240-40-280ms   | [S2,MB1,B]  286-40-327ms   | [S2,MB2,B]  332-40-373ms   | [S2,MB3,B]  379-40-419ms   | [S2,MB4,B]  425-40-466ms   | [S2,MB5,B]  471-40-512ms   | [S2,MB6,B]  517-40-558ms   | [S2,MB7,B]  565-40-605ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-90ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-140ms   | [S3,MB5,F]  143-14-157ms   | [S3,MB6,F]  160-14-175ms   | [S3,MB7,F]  177-14-192ms   | [S3,MB0,B]  194-46-240ms   | [S3,MB1,B]  239-46-285ms   | [S3,MB2,B]  285-46-332ms   | [S3,MB3,B]  332-46-378ms   | [S3,MB4,B]  378-46-424ms   | [S3,MB5,B]  424-46-471ms   | [S3,MB6,B]  471-46-517ms   | [S3,MB7,B]  517-46-563ms  
[rank0]:2026-01-02 17:30:22,189 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:30:24,938 - Avg. fwd time: 15.2681 / Avg. bwd time: 46.2106 / Avg. batch time: 509.0776 (ms) / GPU bubble ratio: 3.39%
[rank1]:2026-01-02 17:30:25,046 - Avg. fwd time: 16.2275 / Avg. bwd time: 45.6364 / Avg. batch time: 635.4147 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 17:30:24,991 - Avg. fwd time: 14.3267 / Avg. bwd time: 40.5621 / Avg. batch time: 568.6565 (ms) / GPU bubble ratio: 22.78%
[rank0]:2026-01-02 17:30:25,100 - Avg. fwd time: 14.9033 / Avg. bwd time: 43.2122 / Avg. batch time: 698.4218 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:30:25,136 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 72.15GiB(51.60%)  tps: 5,610  tflops: 261.67  mfu: 26.46%
[rank1]:2026-01-02 17:30:25,132 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 70.00GiB(50.07%)  tps: 5,610  tflops: 261.67  mfu: 26.46%
[rank3]:2026-01-02 17:30:25,135 -  step: 1350  loss:  0.1236  grad_norm:  0.4636  memory: 76.42GiB(54.66%)  tps: 5,611  tflops: 261.68  mfu: 26.46%
[rank2]:2026-01-02 17:30:25,129 -  step: 1350  loss: -4.0000  grad_norm:  0.4636  memory: 62.32GiB(44.58%)  tps: 5,610  tflops: 261.67  mfu: 26.46%
[rank0]:2026-01-02 17:32:47,009 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:32:49,813 - Avg. fwd time: 15.2687 / Avg. bwd time: 46.2123 / Avg. batch time: 509.0881 (ms) / GPU bubble ratio: 3.39%
[rank2]:2026-01-02 17:32:49,866 - Avg. fwd time: 14.3279 / Avg. bwd time: 40.5647 / Avg. batch time: 568.6619 (ms) / GPU bubble ratio: 22.78%
[rank1]:2026-01-02 17:32:49,924 - Avg. fwd time: 16.2284 / Avg. bwd time: 45.6382 / Avg. batch time: 635.4232 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 17:32:50,019 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 62.32GiB(44.58%)  tps: 5,654  tflops: 263.70  mfu: 26.66%
[rank3]:2026-01-02 17:32:50,027 -  step: 1400  loss:  0.3597  grad_norm:  0.5406  memory: 76.42GiB(54.66%)  tps: 5,654  tflops: 263.71  mfu: 26.66%
[rank0]:2026-01-02 17:32:49,989 - Avg. fwd time: 14.9039 / Avg. bwd time: 43.2129 / Avg. batch time: 698.4330 (ms) / GPU bubble ratio: 33.43%
[rank0]:2026-01-02 17:32:50,025 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 72.15GiB(51.60%)  tps: 5,654  tflops: 263.70  mfu: 26.66%
[rank1]:2026-01-02 17:32:50,021 -  step: 1400  loss: -4.0000  grad_norm:  0.5406  memory: 70.00GiB(50.07%)  tps: 5,654  tflops: 263.70  mfu: 26.66%
[rank3]:2026-01-02 17:32:50,170 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1732_step1400_rank3.svg
[rank3]:			> Batch Time: 704.69 ms, GPU Bubble Ratio: 33.37%, 29.09%, 37.02%, 29.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-33ms     | [S0,MB2,F]  33-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-14-121ms   | [S0,MB0,B]  332-43-375ms   | [S0,MB1,B]  379-43-422ms   | [S0,MB2,B]  426-43-469ms   | [S0,MB3,B]  473-43-516ms   | [S0,MB4,B]  520-43-563ms   | [S0,MB5,B]  566-43-610ms   | [S0,MB6,B]  613-43-656ms   | [S0,MB7,B]  661-43-704ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  39-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-136ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  286-45-331ms   | [S1,MB1,B]  332-45-378ms   | [S1,MB2,B]  379-45-425ms   | [S1,MB3,B]  426-46-472ms   | [S1,MB4,B]  472-46-519ms   | [S1,MB5,B]  519-46-565ms   | [S1,MB6,B]  566-46-612ms   | [S1,MB7,B]  613-46-659ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  71-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  245-40-285ms   | [S2,MB1,B]  291-40-332ms   | [S2,MB2,B]  338-40-379ms   | [S2,MB3,B]  384-40-425ms   | [S2,MB4,B]  431-41-472ms   | [S2,MB5,B]  478-41-519ms   | [S2,MB6,B]  524-41-565ms   | [S2,MB7,B]  572-41-613ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-161ms   | [S3,MB6,F]  163-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  198-46-244ms   | [S3,MB1,B]  244-46-291ms   | [S3,MB2,B]  291-46-337ms   | [S3,MB3,B]  337-46-384ms   | [S3,MB4,B]  384-46-430ms   | [S3,MB5,B]  431-46-477ms   | [S3,MB6,B]  477-46-524ms   | [S3,MB7,B]  524-46-570ms  
[rank0]:2026-01-02 17:35:13,587 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:35:16,336 - Avg. fwd time: 15.2780 / Avg. bwd time: 46.2206 / Avg. batch time: 509.2233 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 17:35:16,387 - Avg. fwd time: 14.3345 / Avg. bwd time: 40.5674 / Avg. batch time: 568.8140 (ms) / GPU bubble ratio: 22.78%
[rank0]:2026-01-02 17:35:16,500 - Avg. fwd time: 14.9104 / Avg. bwd time: 43.2134 / Avg. batch time: 698.5976 (ms) / GPU bubble ratio: 33.44%
[rank1]:2026-01-02 17:35:16,445 - Avg. fwd time: 16.2364 / Avg. bwd time: 45.6433 / Avg. batch time: 635.5828 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 17:35:16,532 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 70.00GiB(50.07%)  tps: 5,591  tflops: 260.79  mfu: 26.37%
[rank3]:2026-01-02 17:35:16,536 -  step: 1450  loss:  0.1860  grad_norm:  0.3945  memory: 76.42GiB(54.66%)  tps: 5,592  tflops: 260.79  mfu: 26.37%
[rank2]:2026-01-02 17:35:16,530 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 62.32GiB(44.58%)  tps: 5,591  tflops: 260.78  mfu: 26.37%
[rank0]:2026-01-02 17:35:16,537 -  step: 1450  loss: -4.0000  grad_norm:  0.3945  memory: 72.15GiB(51.60%)  tps: 5,591  tflops: 260.78  mfu: 26.37%
[rank0]:2026-01-02 17:37:40,522 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:37:43,329 - Avg. fwd time: 15.2899 / Avg. bwd time: 46.2300 / Avg. batch time: 509.3881 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 17:37:43,381 - Avg. fwd time: 14.3425 / Avg. bwd time: 40.5700 / Avg. batch time: 568.9809 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 17:37:43,438 - Avg. fwd time: 16.2465 / Avg. bwd time: 45.6491 / Avg. batch time: 635.7606 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 17:37:43,522 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 62.32GiB(44.58%)  tps: 5,573  tflops: 259.93  mfu: 26.28%
[rank1]:2026-01-02 17:37:43,525 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 70.00GiB(50.07%)  tps: 5,573  tflops: 259.93  mfu: 26.28%
[rank0]:2026-01-02 17:37:43,493 - Avg. fwd time: 14.9181 / Avg. bwd time: 43.2139 / Avg. batch time: 698.7834 (ms) / GPU bubble ratio: 33.45%
[rank0]:2026-01-02 17:37:43,529 -  step: 1500  loss: -4.0000  grad_norm:  0.5251  memory: 72.15GiB(51.60%)  tps: 5,573  tflops: 259.93  mfu: 26.28%
[rank3]:2026-01-02 17:37:43,528 -  step: 1500  loss:  0.2561  grad_norm:  0.5251  memory: 76.42GiB(54.66%)  tps: 5,573  tflops: 259.93  mfu: 26.28%
[rank3]:2026-01-02 17:37:43,661 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1737_step1500_rank3.svg
[rank3]:			> Batch Time: 703.53 ms, GPU Bubble Ratio: 33.35%, 28.83%, 37.01%, 29.11%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-33ms     | [S0,MB2,F]  33-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB4,F]  62-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-121ms   | [S0,MB0,B]  333-43-376ms   | [S0,MB1,B]  379-43-422ms   | [S0,MB2,B]  426-43-470ms   | [S0,MB3,B]  473-43-517ms   | [S0,MB4,B]  520-43-564ms   | [S0,MB5,B]  566-43-610ms   | [S0,MB6,B]  613-43-656ms   | [S0,MB7,B]  660-43-703ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  39-15-54ms     | [S1,MB2,F]  55-15-70ms     | [S1,MB3,F]  71-15-87ms     | [S1,MB4,F]  87-16-103ms    | [S1,MB5,F]  103-16-120ms   | [S1,MB6,F]  120-16-136ms   | [S1,MB7,F]  137-16-153ms   | [S1,MB0,B]  286-45-332ms   | [S1,MB1,B]  333-45-379ms   | [S1,MB2,B]  379-45-425ms   | [S1,MB3,B]  426-46-473ms   | [S1,MB4,B]  473-46-519ms   | [S1,MB5,B]  519-46-566ms   | [S1,MB6,B]  566-46-612ms   | [S1,MB7,B]  613-46-659ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  71-14-85ms     | [S2,MB3,F]  86-14-101ms    | [S2,MB4,F]  103-14-117ms   | [S2,MB5,F]  120-14-134ms   | [S2,MB6,F]  136-14-150ms   | [S2,MB7,F]  153-14-167ms   | [S2,MB0,B]  245-40-286ms   | [S2,MB1,B]  292-40-332ms   | [S2,MB2,B]  338-40-379ms   | [S2,MB3,B]  385-40-426ms   | [S2,MB4,B]  432-40-473ms   | [S2,MB5,B]  478-40-519ms   | [S2,MB6,B]  525-40-566ms   | [S2,MB7,B]  571-40-612ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  129-15-144ms   | [S3,MB5,F]  146-15-161ms   | [S3,MB6,F]  164-15-179ms   | [S3,MB7,F]  181-15-196ms   | [S3,MB0,B]  198-46-245ms   | [S3,MB1,B]  245-46-291ms   | [S3,MB2,B]  291-46-338ms   | [S3,MB3,B]  338-46-385ms   | [S3,MB4,B]  385-46-431ms   | [S3,MB5,B]  431-46-478ms   | [S3,MB6,B]  477-46-524ms   | [S3,MB7,B]  524-46-571ms  
[rank0]:2026-01-02 17:40:07,282 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:40:10,083 - Avg. fwd time: 15.3004 / Avg. bwd time: 46.2373 / Avg. batch time: 509.5253 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 17:40:10,136 - Avg. fwd time: 14.3493 / Avg. bwd time: 40.5711 / Avg. batch time: 569.1305 (ms) / GPU bubble ratio: 22.80%
[rank1]:2026-01-02 17:40:10,194 - Avg. fwd time: 16.2553 / Avg. bwd time: 45.6541 / Avg. batch time: 635.9186 (ms) / GPU bubble ratio: 22.12%
[rank1]:2026-01-02 17:40:10,285 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 70.00GiB(50.07%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank3]:2026-01-02 17:40:10,289 -  step: 1550  loss:  0.2671  grad_norm:  0.5066  memory: 76.42GiB(54.66%)  tps: 5,582  tflops: 260.35  mfu: 26.32%
[rank0]:2026-01-02 17:40:10,253 - Avg. fwd time: 14.9246 / Avg. bwd time: 43.2129 / Avg. batch time: 698.9448 (ms) / GPU bubble ratio: 33.46%
[rank0]:2026-01-02 17:40:10,289 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 72.15GiB(51.60%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank2]:2026-01-02 17:40:10,282 -  step: 1550  loss: -4.0000  grad_norm:  0.5066  memory: 62.32GiB(44.58%)  tps: 5,582  tflops: 260.34  mfu: 26.32%
[rank0]:2026-01-02 17:42:32,988 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:42:35,789 - Avg. fwd time: 15.3054 / Avg. bwd time: 46.2419 / Avg. batch time: 509.5973 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 17:42:35,857 - Avg. fwd time: 14.3527 / Avg. bwd time: 40.5721 / Avg. batch time: 569.1987 (ms) / GPU bubble ratio: 22.80%
[rank1]:2026-01-02 17:42:35,920 - Avg. fwd time: 16.2599 / Avg. bwd time: 45.6571 / Avg. batch time: 635.9956 (ms) / GPU bubble ratio: 22.12%
[rank2]:2026-01-02 17:42:36,006 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 62.32GiB(44.58%)  tps: 5,622  tflops: 262.20  mfu: 26.51%
[rank3]:2026-01-02 17:42:36,010 -  step: 1600  loss:  0.4009  grad_norm:  0.7882  memory: 76.42GiB(54.66%)  tps: 5,622  tflops: 262.20  mfu: 26.51%
[rank1]:2026-01-02 17:42:36,007 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 70.00GiB(50.07%)  tps: 5,622  tflops: 262.20  mfu: 26.51%
[rank0]:2026-01-02 17:42:35,975 - Avg. fwd time: 14.9268 / Avg. bwd time: 43.2127 / Avg. batch time: 699.0191 (ms) / GPU bubble ratio: 33.46%
[rank0]:2026-01-02 17:42:36,011 -  step: 1600  loss: -4.0000  grad_norm:  0.7882  memory: 72.15GiB(51.60%)  tps: 5,622  tflops: 262.20  mfu: 26.51%
[rank3]:2026-01-02 17:42:36,145 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1742_step1600_rank3.svg
[rank3]:			> Batch Time: 704.69 ms, GPU Bubble Ratio: 33.38%, 29.05%, 37.07%, 29.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-47ms     | [S0,MB3,F]  47-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-14-106ms    | [S0,MB7,F]  106-14-121ms   | [S0,MB0,B]  332-43-375ms   | [S0,MB1,B]  378-43-422ms   | [S0,MB2,B]  426-43-469ms   | [S0,MB3,B]  472-43-516ms   | [S0,MB4,B]  520-43-563ms   | [S0,MB5,B]  567-43-610ms   | [S0,MB6,B]  613-43-657ms   | [S0,MB7,B]  661-43-704ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-103ms    | [S1,MB5,F]  103-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  136-16-152ms   | [S1,MB0,B]  286-45-331ms   | [S1,MB1,B]  332-45-378ms   | [S1,MB2,B]  379-45-425ms   | [S1,MB3,B]  426-46-472ms   | [S1,MB4,B]  472-46-519ms   | [S1,MB5,B]  520-46-566ms   | [S1,MB6,B]  566-46-613ms   | [S1,MB7,B]  613-46-660ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-13-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-117ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-150ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  245-40-285ms   | [S2,MB1,B]  291-40-332ms   | [S2,MB2,B]  338-40-379ms   | [S2,MB3,B]  385-40-426ms   | [S2,MB4,B]  431-40-472ms   | [S2,MB5,B]  478-41-519ms   | [S2,MB6,B]  525-41-566ms   | [S2,MB7,B]  572-40-613ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-92ms     | [S3,MB2,F]  94-14-109ms    | [S3,MB3,F]  111-14-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  163-15-178ms   | [S3,MB7,F]  180-15-195ms   | [S3,MB0,B]  198-46-245ms   | [S3,MB1,B]  244-46-291ms   | [S3,MB2,B]  290-46-337ms   | [S3,MB3,B]  337-46-384ms   | [S3,MB4,B]  384-46-431ms   | [S3,MB5,B]  430-46-477ms   | [S3,MB6,B]  477-46-524ms   | [S3,MB7,B]  524-46-571ms  
[rank0]:2026-01-02 17:44:59,771 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 17:45:02,655 - Avg. fwd time: 14.3588 / Avg. bwd time: 40.5765 / Avg. batch time: 569.3374 (ms) / GPU bubble ratio: 22.81%
[rank3]:2026-01-02 17:45:02,600 - Avg. fwd time: 15.3126 / Avg. bwd time: 46.2508 / Avg. batch time: 509.7214 (ms) / GPU bubble ratio: 3.38%
[rank1]:2026-01-02 17:45:02,722 - Avg. fwd time: 16.2665 / Avg. bwd time: 45.6616 / Avg. batch time: 636.1431 (ms) / GPU bubble ratio: 22.12%
[rank0]:2026-01-02 17:45:02,779 - Avg. fwd time: 14.9332 / Avg. bwd time: 43.2163 / Avg. batch time: 699.1748 (ms) / GPU bubble ratio: 33.47%
[rank2]:2026-01-02 17:45:02,809 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 62.32GiB(44.58%)  tps: 5,580  tflops: 260.26  mfu: 26.32%
[rank3]:2026-01-02 17:45:02,818 -  step: 1650  loss:  0.4374  grad_norm:  0.9184  memory: 76.42GiB(54.66%)  tps: 5,580  tflops: 260.27  mfu: 26.32%
[rank1]:2026-01-02 17:45:02,812 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 70.00GiB(50.07%)  tps: 5,580  tflops: 260.26  mfu: 26.32%
[rank0]:2026-01-02 17:45:02,815 -  step: 1650  loss: -4.0000  grad_norm:  0.9184  memory: 72.15GiB(51.60%)  tps: 5,580  tflops: 260.26  mfu: 26.32%
[rank0]:2026-01-02 17:47:26,652 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:47:29,471 - Avg. fwd time: 15.3198 / Avg. bwd time: 46.2596 / Avg. batch time: 509.8459 (ms) / GPU bubble ratio: 3.38%
[rank2]:2026-01-02 17:47:29,523 - Avg. fwd time: 14.3653 / Avg. bwd time: 40.5810 / Avg. batch time: 569.4642 (ms) / GPU bubble ratio: 22.81%
[rank1]:2026-01-02 17:47:29,580 - Avg. fwd time: 16.2730 / Avg. bwd time: 45.6659 / Avg. batch time: 636.2770 (ms) / GPU bubble ratio: 22.12%
[rank3]:2026-01-02 17:47:29,676 -  step: 1700  loss:  0.4016  grad_norm:  0.6211  memory: 76.42GiB(54.66%)  tps: 5,578  tflops: 260.17  mfu: 26.31%
[rank1]:2026-01-02 17:47:29,673 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 70.00GiB(50.07%)  tps: 5,578  tflops: 260.16  mfu: 26.31%
[rank0]:2026-01-02 17:47:29,641 - Avg. fwd time: 14.9393 / Avg. bwd time: 43.2194 / Avg. batch time: 699.3140 (ms) / GPU bubble ratio: 33.47%
[rank0]:2026-01-02 17:47:29,677 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 72.15GiB(51.60%)  tps: 5,578  tflops: 260.16  mfu: 26.31%
[rank2]:2026-01-02 17:47:29,670 -  step: 1700  loss: -4.0000  grad_norm:  0.6211  memory: 62.32GiB(44.58%)  tps: 5,578  tflops: 260.16  mfu: 26.31%
[rank3]:2026-01-02 17:47:29,811 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1747_step1700_rank3.svg
[rank3]:			> Batch Time: 703.62 ms, GPU Bubble Ratio: 33.41%, 29.01%, 36.93%, 29.23%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-61ms     | [S0,MB4,F]  61-14-76ms     | [S0,MB5,F]  76-14-91ms     | [S0,MB6,F]  91-14-106ms    | [S0,MB7,F]  106-14-121ms   | [S0,MB0,B]  331-43-374ms   | [S0,MB1,B]  378-43-421ms   | [S0,MB2,B]  425-43-468ms   | [S0,MB3,B]  471-43-515ms   | [S0,MB4,B]  519-43-562ms   | [S0,MB5,B]  565-43-609ms   | [S0,MB6,B]  612-43-656ms   | [S0,MB7,B]  660-43-703ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-54ms     | [S1,MB2,F]  54-15-70ms     | [S1,MB3,F]  70-15-86ms     | [S1,MB4,F]  86-16-102ms    | [S1,MB5,F]  102-16-119ms   | [S1,MB6,F]  119-16-135ms   | [S1,MB7,F]  135-16-152ms   | [S1,MB0,B]  285-45-330ms   | [S1,MB1,B]  331-45-377ms   | [S1,MB2,B]  378-45-424ms   | [S1,MB3,B]  425-46-471ms   | [S1,MB4,B]  472-46-518ms   | [S1,MB5,B]  518-46-565ms   | [S1,MB6,B]  565-46-611ms   | [S1,MB7,B]  612-46-659ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  56-13-70ms     | [S2,MB2,F]  70-14-84ms     | [S2,MB3,F]  86-14-100ms    | [S2,MB4,F]  102-14-116ms   | [S2,MB5,F]  119-14-133ms   | [S2,MB6,F]  135-14-149ms   | [S2,MB7,F]  152-14-166ms   | [S2,MB0,B]  244-40-284ms   | [S2,MB1,B]  290-40-331ms   | [S2,MB2,B]  337-40-378ms   | [S2,MB3,B]  384-40-425ms   | [S2,MB4,B]  430-41-471ms   | [S2,MB5,B]  477-41-518ms   | [S2,MB6,B]  524-41-565ms   | [S2,MB7,B]  570-41-611ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-14-91ms     | [S3,MB2,F]  94-14-108ms    | [S3,MB3,F]  111-15-126ms   | [S3,MB4,F]  128-15-143ms   | [S3,MB5,F]  145-15-160ms   | [S3,MB6,F]  162-15-177ms   | [S3,MB7,F]  179-15-195ms   | [S3,MB0,B]  197-46-244ms   | [S3,MB1,B]  243-46-290ms   | [S3,MB2,B]  290-46-337ms   | [S3,MB3,B]  337-46-383ms   | [S3,MB4,B]  383-46-430ms   | [S3,MB5,B]  430-46-477ms   | [S3,MB6,B]  477-46-523ms   | [S3,MB7,B]  523-46-570ms  
[rank0]:2026-01-02 17:49:53,830 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 17:49:56,699 - Avg. fwd time: 14.3708 / Avg. bwd time: 40.5847 / Avg. batch time: 569.5738 (ms) / GPU bubble ratio: 22.81%
[rank3]:2026-01-02 17:49:56,647 - Avg. fwd time: 15.3255 / Avg. bwd time: 46.2667 / Avg. batch time: 509.9438 (ms) / GPU bubble ratio: 3.37%
[rank1]:2026-01-02 17:49:56,756 - Avg. fwd time: 16.2785 / Avg. bwd time: 45.6693 / Avg. batch time: 636.3925 (ms) / GPU bubble ratio: 22.13%
[rank0]:2026-01-02 17:49:56,818 - Avg. fwd time: 14.9448 / Avg. bwd time: 43.2226 / Avg. batch time: 699.4394 (ms) / GPU bubble ratio: 33.47%
[rank0]:2026-01-02 17:49:56,854 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 72.15GiB(51.60%)  tps: 5,566  tflops: 259.60  mfu: 26.25%
[rank2]:2026-01-02 17:49:56,847 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 62.32GiB(44.58%)  tps: 5,566  tflops: 259.60  mfu: 26.25%
[rank3]:2026-01-02 17:49:56,852 -  step: 1750  loss:  0.4086  grad_norm:  0.6343  memory: 76.42GiB(54.66%)  tps: 5,566  tflops: 259.61  mfu: 26.25%
[rank1]:2026-01-02 17:49:56,850 -  step: 1750  loss: -4.0000  grad_norm:  0.6343  memory: 70.00GiB(50.07%)  tps: 5,566  tflops: 259.60  mfu: 26.25%
[rank0]:2026-01-02 17:52:18,450 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:52:21,162 - Avg. fwd time: 15.3212 / Avg. bwd time: 46.2621 / Avg. batch time: 509.8671 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:52:21,214 - Avg. fwd time: 14.3678 / Avg. bwd time: 40.5831 / Avg. batch time: 569.4876 (ms) / GPU bubble ratio: 22.81%
[rank1]:2026-01-02 17:52:21,271 - Avg. fwd time: 16.2737 / Avg. bwd time: 45.6670 / Avg. batch time: 636.3041 (ms) / GPU bubble ratio: 22.12%
[rank2]:2026-01-02 17:52:21,356 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 62.32GiB(44.58%)  tps: 5,669  tflops: 264.40  mfu: 26.73%
[rank3]:2026-01-02 17:52:21,361 -  step: 1800  loss:  0.0769  grad_norm:  0.3149  memory: 76.42GiB(54.66%)  tps: 5,669  tflops: 264.40  mfu: 26.73%
[rank1]:2026-01-02 17:52:21,358 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 70.00GiB(50.07%)  tps: 5,669  tflops: 264.40  mfu: 26.73%
[rank0]:2026-01-02 17:52:21,327 - Avg. fwd time: 14.9407 / Avg. bwd time: 43.2208 / Avg. batch time: 699.3517 (ms) / GPU bubble ratio: 33.47%
[rank0]:2026-01-02 17:52:21,362 -  step: 1800  loss: -4.0000  grad_norm:  0.3149  memory: 72.15GiB(51.60%)  tps: 5,669  tflops: 264.40  mfu: 26.73%
[rank3]:2026-01-02 17:52:21,495 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1752_step1800_rank3.svg
[rank3]:			> Batch Time: 687.84 ms, GPU Bubble Ratio: 33.07%, 28.68%, 36.64%, 29.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB4,F]  59-13-73ms     | [S0,MB5,F]  73-13-87ms     | [S0,MB6,F]  87-13-101ms    | [S0,MB7,F]  101-13-114ms   | [S0,MB0,B]  320-42-363ms   | [S0,MB1,B]  366-42-409ms   | [S0,MB2,B]  413-43-456ms   | [S0,MB3,B]  459-43-502ms   | [S0,MB4,B]  505-43-549ms   | [S0,MB5,B]  552-43-595ms   | [S0,MB6,B]  598-43-641ms   | [S0,MB7,B]  644-43-687ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  69-15-84ms     | [S1,MB4,F]  84-15-100ms    | [S1,MB5,F]  100-15-115ms   | [S1,MB6,F]  116-15-131ms   | [S1,MB7,F]  131-15-147ms   | [S1,MB0,B]  275-45-320ms   | [S1,MB1,B]  321-45-366ms   | [S1,MB2,B]  367-45-412ms   | [S1,MB3,B]  413-45-458ms   | [S1,MB4,B]  459-45-505ms   | [S1,MB5,B]  505-45-551ms   | [S1,MB6,B]  551-45-597ms   | [S1,MB7,B]  597-45-643ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-69ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-97ms     | [S2,MB4,F]  100-13-113ms   | [S2,MB5,F]  115-13-129ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  146-13-160ms   | [S2,MB0,B]  234-40-274ms   | [S2,MB1,B]  280-40-320ms   | [S2,MB2,B]  326-40-366ms   | [S2,MB3,B]  372-40-412ms   | [S2,MB4,B]  418-40-458ms   | [S2,MB5,B]  464-40-504ms   | [S2,MB6,B]  509-40-550ms   | [S2,MB7,B]  555-40-596ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-14-90ms     | [S3,MB2,F]  92-14-106ms    | [S3,MB3,F]  108-14-122ms   | [S3,MB4,F]  124-14-139ms   | [S3,MB5,F]  141-14-155ms   | [S3,MB6,F]  157-14-171ms   | [S3,MB7,F]  174-14-188ms   | [S3,MB0,B]  190-45-236ms   | [S3,MB1,B]  234-45-280ms   | [S3,MB2,B]  280-45-325ms   | [S3,MB3,B]  326-45-371ms   | [S3,MB4,B]  372-45-417ms   | [S3,MB5,B]  417-45-463ms   | [S3,MB6,B]  463-45-509ms   | [S3,MB7,B]  509-45-555ms  
[rank0]:2026-01-02 17:54:42,272 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:54:45,013 - Avg. fwd time: 15.3164 / Avg. bwd time: 46.2573 / Avg. batch time: 509.7846 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:54:45,071 - Avg. fwd time: 14.3643 / Avg. bwd time: 40.5808 / Avg. batch time: 569.4048 (ms) / GPU bubble ratio: 22.80%
[rank1]:2026-01-02 17:54:45,141 - Avg. fwd time: 16.2693 / Avg. bwd time: 45.6638 / Avg. batch time: 636.2165 (ms) / GPU bubble ratio: 22.12%
[rank0]:2026-01-02 17:54:45,198 - Avg. fwd time: 14.9355 / Avg. bwd time: 43.2182 / Avg. batch time: 699.2577 (ms) / GPU bubble ratio: 33.47%
[rank2]:2026-01-02 17:54:45,227 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 62.32GiB(44.58%)  tps: 5,694  tflops: 265.57  mfu: 26.85%
[rank1]:2026-01-02 17:54:45,230 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 70.00GiB(50.07%)  tps: 5,694  tflops: 265.57  mfu: 26.85%
[rank3]:2026-01-02 17:54:45,236 -  step: 1850  loss:  0.3556  grad_norm:  0.5551  memory: 76.42GiB(54.66%)  tps: 5,694  tflops: 265.57  mfu: 26.85%
[rank0]:2026-01-02 17:54:45,233 -  step: 1850  loss: -4.0000  grad_norm:  0.5551  memory: 72.15GiB(51.60%)  tps: 5,694  tflops: 265.57  mfu: 26.85%
[rank0]:2026-01-02 17:57:05,534 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:57:08,264 - Avg. fwd time: 15.3087 / Avg. bwd time: 46.2503 / Avg. batch time: 509.6609 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:57:08,320 - Avg. fwd time: 14.3584 / Avg. bwd time: 40.5771 / Avg. batch time: 569.2667 (ms) / GPU bubble ratio: 22.80%
[rank1]:2026-01-02 17:57:08,393 - Avg. fwd time: 16.2626 / Avg. bwd time: 45.6596 / Avg. batch time: 636.0692 (ms) / GPU bubble ratio: 22.12%
[rank2]:2026-01-02 17:57:08,485 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 62.32GiB(44.58%)  tps: 5,718  tflops: 266.71  mfu: 26.97%
[rank0]:2026-01-02 17:57:08,456 - Avg. fwd time: 14.9286 / Avg. bwd time: 43.2144 / Avg. batch time: 699.1057 (ms) / GPU bubble ratio: 33.47%
[rank0]:2026-01-02 17:57:08,492 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 72.15GiB(51.60%)  tps: 5,718  tflops: 266.70  mfu: 26.97%
[rank3]:2026-01-02 17:57:08,491 -  step: 1900  loss:  0.2039  grad_norm:  0.3106  memory: 76.42GiB(54.66%)  tps: 5,719  tflops: 266.72  mfu: 26.97%
[rank1]:2026-01-02 17:57:08,488 -  step: 1900  loss: -4.0000  grad_norm:  0.3106  memory: 70.00GiB(50.07%)  tps: 5,718  tflops: 266.71  mfu: 26.97%
[rank3]:2026-01-02 17:57:08,629 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1757_step1900_rank3.svg
[rank3]:			> Batch Time: 691.41 ms, GPU Bubble Ratio: 33.14%, 28.86%, 36.85%, 29.48%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-13-32ms     | [S0,MB2,F]  32-13-45ms     | [S0,MB3,F]  45-13-59ms     | [S0,MB4,F]  59-14-74ms     | [S0,MB5,F]  74-14-88ms     | [S0,MB6,F]  88-14-102ms    | [S0,MB7,F]  102-14-116ms   | [S0,MB0,B]  323-42-366ms   | [S0,MB1,B]  369-42-411ms   | [S0,MB2,B]  416-43-459ms   | [S0,MB3,B]  462-43-505ms   | [S0,MB4,B]  508-43-552ms   | [S0,MB5,B]  555-43-598ms   | [S0,MB6,B]  601-43-644ms   | [S0,MB7,B]  648-43-691ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  53-15-68ms     | [S1,MB3,F]  68-15-84ms     | [S1,MB4,F]  84-15-99ms     | [S1,MB5,F]  99-15-115ms    | [S1,MB6,F]  115-15-131ms   | [S1,MB7,F]  131-15-146ms   | [S1,MB0,B]  277-45-322ms   | [S1,MB1,B]  323-45-368ms   | [S1,MB2,B]  369-45-415ms   | [S1,MB3,B]  416-45-461ms   | [S1,MB4,B]  462-45-508ms   | [S1,MB5,B]  508-45-554ms   | [S1,MB6,B]  554-45-600ms   | [S1,MB7,B]  601-45-647ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-13-68ms     | [S2,MB2,F]  69-13-82ms     | [S2,MB3,F]  84-13-97ms     | [S2,MB4,F]  99-13-113ms    | [S2,MB5,F]  115-13-128ms   | [S2,MB6,F]  131-13-144ms   | [S2,MB7,F]  147-13-160ms   | [S2,MB0,B]  236-40-276ms   | [S2,MB1,B]  282-40-322ms   | [S2,MB2,B]  328-40-369ms   | [S2,MB3,B]  374-40-415ms   | [S2,MB4,B]  421-40-461ms   | [S2,MB5,B]  467-40-507ms   | [S2,MB6,B]  513-40-553ms   | [S2,MB7,B]  559-40-600ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-14-89ms     | [S3,MB2,F]  91-14-106ms    | [S3,MB3,F]  108-14-122ms   | [S3,MB4,F]  124-14-139ms   | [S3,MB5,F]  141-14-155ms   | [S3,MB6,F]  157-14-172ms   | [S3,MB7,F]  174-14-189ms   | [S3,MB0,B]  191-45-236ms   | [S3,MB1,B]  236-46-282ms   | [S3,MB2,B]  281-46-327ms   | [S3,MB3,B]  327-46-373ms   | [S3,MB4,B]  374-46-420ms   | [S3,MB5,B]  420-46-466ms   | [S3,MB6,B]  466-46-512ms   | [S3,MB7,B]  512-46-558ms  
[rank0]:2026-01-02 17:59:28,322 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 17:59:31,038 - Avg. fwd time: 15.2998 / Avg. bwd time: 46.2413 / Avg. batch time: 509.5127 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 17:59:31,093 - Avg. fwd time: 14.3514 / Avg. bwd time: 40.5725 / Avg. batch time: 569.1130 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 17:59:31,150 - Avg. fwd time: 16.2549 / Avg. bwd time: 45.6545 / Avg. batch time: 635.9053 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 17:59:31,237 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 62.32GiB(44.58%)  tps: 5,739  tflops: 267.65  mfu: 27.06%
[rank0]:2026-01-02 17:59:31,207 - Avg. fwd time: 14.9207 / Avg. bwd time: 43.2106 / Avg. batch time: 698.9331 (ms) / GPU bubble ratio: 33.46%
[rank0]:2026-01-02 17:59:31,243 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 72.15GiB(51.60%)  tps: 5,739  tflops: 267.65  mfu: 27.06%
[rank3]:2026-01-02 17:59:31,242 -  step: 1950  loss:  0.1735  grad_norm:  0.2811  memory: 76.42GiB(54.66%)  tps: 5,739  tflops: 267.66  mfu: 27.06%
[rank1]:2026-01-02 17:59:31,239 -  step: 1950  loss: -4.0000  grad_norm:  0.2811  memory: 70.00GiB(50.07%)  tps: 5,739  tflops: 267.65  mfu: 27.06%
[rank0]:2026-01-02 18:01:50,889 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 18:01:53,632 - Avg. fwd time: 15.2917 / Avg. bwd time: 46.2329 / Avg. batch time: 509.3747 (ms) / GPU bubble ratio: 3.37%
[rank2]:2026-01-02 18:01:53,690 - Avg. fwd time: 14.3453 / Avg. bwd time: 40.5685 / Avg. batch time: 568.9610 (ms) / GPU bubble ratio: 22.79%
[rank0]:2026-01-02 18:01:53,807 - Avg. fwd time: 14.9134 / Avg. bwd time: 43.2071 / Avg. batch time: 698.7638 (ms) / GPU bubble ratio: 33.46%
[rank1]:2026-01-02 18:01:53,751 - Avg. fwd time: 16.2477 / Avg. bwd time: 45.6498 / Avg. batch time: 635.7447 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 18:01:53,839 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 70.00GiB(50.07%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank1]:2026-01-02 18:01:53,839 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,754  tflops: 268.39  mfu: 26.02%
[rank1]:2026-01-02 18:01:53,839 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-02 18:01:53,844 -  step: 2000  loss:  0.2094  grad_norm:  0.2648  memory: 76.42GiB(54.66%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank3]:2026-01-02 18:01:53,844 - â„¹ï¸ final step: 2000  loss:  0.2094  grad_norm:  0.2648  tps: 5,757  tflops: 268.52  mfu: 26.03%
[rank3]:2026-01-02 18:01:53,845 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-02 18:01:53,849 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 18:01:53,843 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 72.15GiB(51.60%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank0]:2026-01-02 18:01:53,843 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,755  tflops: 268.41  mfu: 26.02%
[rank0]:2026-01-02 18:01:53,843 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 18:01:53,851 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2026-01-02 18:01:53,837 -  step: 2000  loss: -4.0000  grad_norm:  0.2648  memory: 62.32GiB(44.58%)  tps: 5,745  tflops: 267.94  mfu: 27.09%
[rank2]:2026-01-02 18:01:53,837 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.2648  tps: 5,755  tflops: 268.43  mfu: 26.02%
[rank2]:2026-01-02 18:01:53,837 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 18:01:53,843 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank1]:2026-01-02 18:01:53,844 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 18:02:06,642 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 18:02:06,677 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-02 18:02:06,677 - Destroying the purge thread.
[rank1]:2026-01-02 18:02:06,677 - Destroying the purge thread.
[rank3]:2026-01-02 18:02:06,842 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1802_final2000_rank3.svg
[rank3]:			> Batch Time: 698.06 ms, GPU Bubble Ratio: 33.19%, 28.84%, 36.89%, 29.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-14-32ms     | [S0,MB2,F]  32-14-46ms     | [S0,MB3,F]  46-14-60ms     | [S0,MB4,F]  60-14-75ms     | [S0,MB5,F]  75-14-89ms     | [S0,MB6,F]  89-14-104ms    | [S0,MB7,F]  104-14-119ms   | [S0,MB0,B]  327-42-370ms   | [S0,MB1,B]  374-43-417ms   | [S0,MB2,B]  421-43-464ms   | [S0,MB3,B]  467-43-511ms   | [S0,MB4,B]  514-43-558ms   | [S0,MB5,B]  561-43-604ms   | [S0,MB6,B]  607-43-650ms   | [S0,MB7,B]  654-43-698ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-15-53ms     | [S1,MB2,F]  54-15-69ms     | [S1,MB3,F]  69-15-85ms     | [S1,MB4,F]  85-15-101ms    | [S1,MB5,F]  101-15-117ms   | [S1,MB6,F]  118-16-134ms   | [S1,MB7,F]  134-16-150ms   | [S1,MB0,B]  281-45-326ms   | [S1,MB1,B]  328-45-373ms   | [S1,MB2,B]  374-45-420ms   | [S1,MB3,B]  421-45-467ms   | [S1,MB4,B]  467-46-513ms   | [S1,MB5,B]  514-46-560ms   | [S1,MB6,B]  560-46-606ms   | [S1,MB7,B]  607-46-653ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  56-13-69ms     | [S2,MB2,F]  70-13-83ms     | [S2,MB3,F]  85-13-99ms     | [S2,MB4,F]  101-13-115ms   | [S2,MB5,F]  117-13-131ms   | [S2,MB6,F]  134-13-147ms   | [S2,MB7,F]  150-13-164ms   | [S2,MB0,B]  241-40-281ms   | [S2,MB1,B]  287-40-327ms   | [S2,MB2,B]  333-40-374ms   | [S2,MB3,B]  379-40-420ms   | [S2,MB4,B]  426-40-467ms   | [S2,MB5,B]  472-40-513ms   | [S2,MB6,B]  519-40-559ms   | [S2,MB7,B]  565-40-606ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-14-91ms     | [S3,MB2,F]  93-14-107ms    | [S3,MB3,F]  109-14-124ms   | [S3,MB4,F]  126-14-141ms   | [S3,MB5,F]  143-14-158ms   | [S3,MB6,F]  160-15-175ms   | [S3,MB7,F]  177-15-193ms   | [S3,MB0,B]  195-46-241ms   | [S3,MB1,B]  240-46-286ms   | [S3,MB2,B]  286-46-333ms   | [S3,MB3,B]  333-46-379ms   | [S3,MB4,B]  379-46-425ms   | [S3,MB5,B]  425-46-472ms   | [S3,MB6,B]  472-46-518ms   | [S3,MB7,B]  518-46-565ms  
[rank3]:2026-01-02 18:02:06,998 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200/pipeline_schedule/260102_1802_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 501.94 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-15-15ms      | [S0,MB1,F]  15-15-30ms     | [S0,MB2,F]  30-15-45ms     | [S0,MB3,F]  45-15-60ms     | [S0,MB4,F]  60-15-76ms     | [S0,MB5,F]  76-15-91ms     | [S0,MB6,F]  91-15-106ms    | [S0,MB7,F]  106-15-121ms   | [S0,MB0,B]  258-30-288ms   | [S0,MB1,B]  288-30-319ms   | [S0,MB2,B]  319-30-349ms   | [S0,MB3,B]  349-30-380ms   | [S0,MB4,B]  380-30-410ms   | [S0,MB5,B]  410-30-441ms   | [S0,MB6,B]  441-30-471ms   | [S0,MB7,B]  471-30-501ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  15-15-30ms     | [S1,MB1,F]  30-15-45ms     | [S1,MB2,F]  45-15-60ms     | [S1,MB3,F]  60-15-76ms     | [S1,MB4,F]  76-15-91ms     | [S1,MB5,F]  91-15-106ms    | [S1,MB6,F]  106-15-121ms   | [S1,MB7,F]  121-15-136ms   | [S1,MB0,B]  228-30-258ms   | [S1,MB1,B]  258-30-288ms   | [S1,MB2,B]  288-30-319ms   | [S1,MB3,B]  319-30-349ms   | [S1,MB4,B]  349-30-380ms   | [S1,MB5,B]  380-30-410ms   | [S1,MB6,B]  410-30-441ms   | [S1,MB7,B]  441-30-471ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  30-15-45ms     | [S2,MB1,F]  45-15-60ms     | [S2,MB2,F]  60-15-76ms     | [S2,MB3,F]  76-15-91ms     | [S2,MB4,F]  91-15-106ms    | [S2,MB5,F]  106-15-121ms   | [S2,MB6,F]  121-15-136ms   | [S2,MB7,F]  136-15-152ms   | [S2,MB0,B]  197-30-228ms   | [S2,MB1,B]  228-30-258ms   | [S2,MB2,B]  258-30-288ms   | [S2,MB3,B]  288-30-319ms   | [S2,MB4,B]  319-30-349ms   | [S2,MB5,B]  349-30-380ms   | [S2,MB6,B]  380-30-410ms   | [S2,MB7,B]  410-30-441ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  45-15-60ms     | [S3,MB1,F]  60-15-76ms     | [S3,MB2,F]  76-15-91ms     | [S3,MB3,F]  91-15-106ms    | [S3,MB4,F]  106-15-121ms   | [S3,MB5,F]  121-15-136ms   | [S3,MB6,F]  136-15-152ms   | [S3,MB7,F]  152-15-167ms   | [S3,MB0,B]  167-30-197ms   | [S3,MB1,B]  197-30-228ms   | [S3,MB2,B]  228-30-258ms   | [S3,MB3,B]  258-30-288ms   | [S3,MB4,B]  288-30-319ms   | [S3,MB5,B]  319-30-349ms   | [S3,MB6,B]  349-30-380ms   | [S3,MB7,B]  380-30-410ms  
[rank3]:2026-01-02 18:02:06,999 - Destroying the purge thread.
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: uploading output.log; uploading config.yaml
[rank3]:wandb: uploading history steps 40-40, summary, console lines 383-395
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.8458
[rank3]:wandb:               final/avg_loss 0.20941
[rank3]:wandb:             final/avg_mfu(%) 26.03333
[rank3]:wandb:             final/avg_tflops 268.51945
[rank3]:wandb:    final/avg_throughput(tps) 5757.2583
[rank3]:wandb:              final/grad_norm 0.26478
[rank3]:wandb:               final/max_loss 0.20941
[rank3]:wandb:                    grad_norm 0.26478
[rank3]:wandb: loss_metrics/global_avg_loss 0.20941
[rank3]:wandb: loss_metrics/global_max_loss 0.20941
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_GPipe_nofreeze_h200 at: https://wandb.ai/orangingq/torchtitan/runs/yertr3ob
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_GPipe_nofreeze_h200/20260102-1624/wandb/run-20260102_162438-yertr3ob/logs
[rank0]:2026-01-02 18:02:08,677 - Training completed
[rank0]:2026-01-02 18:02:08,678 - Destroying the purge thread.
[rank3]:2026-01-02 18:02:08,982 - Process group destroyed
[rank2]:2026-01-02 18:02:08,995 - Process group destroyed
[rank1]:2026-01-02 18:02:08,981 - Process group destroyed
[rank0]:2026-01-02 18:02:09,238 - Process group destroyed
[rank2]:[W102 18:02:10.897822466 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W102 18:02:10.608112305 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:[W102 18:02:12.262697400 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W102 18:02:12.681606739 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.14', 'layers.11', 'layers.8', 'layers.15', 'layers.9', 'layers.12', 'layers.16', 'layers.10'}
[rank0]:Stage 0: Modules to keep: {'layers.7', 'layers.6', 'tok_embeddings', 'layers.4', 'layers.3', 'layers.0', 'layers.5', 'layers.2', 'layers.1'}
[rank2]:Stage 2: Modules to keep: {'layers.20', 'layers.17', 'layers.23', 'layers.22', 'layers.19', 'layers.24', 'layers.18', 'layers.21'}
[rank3]:Stage 3: Modules to keep: {'layers.25', 'output', 'layers.31', 'layers.26', 'layers.30', 'norm', 'layers.29', 'layers.28', 'layers.27'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_GPipe_nofreeze_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_GPipe_nofreeze_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_GPipe_nofreeze_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_nofreeze_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_nofreeze_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_GPipe_nofreeze_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_nofreeze_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_GPipe_nofreeze_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: False
[rank3]:		- metric_type: apf
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.7
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.05
[rank3]:		- percentile: 70
[rank3]:
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W102 18:02:18.460391286 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
