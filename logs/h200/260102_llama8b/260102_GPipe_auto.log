
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
âœ”ï¸Current Timestamp: Fri Jan  2 18:02:19 UTC 2026
âœ”ï¸SERVER: wbl-kaist-gpu-2 (172.16.143.166),  GPUs: 4,5,6,7
âœ”ï¸SCRIPT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/run.sh
âœ”ï¸OUTPUT: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/260102_GPipe_auto.log
âœ”ï¸Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42

âœ”ï¸Running with auto x GPipe ... 
â˜‘ï¸> torchrun --standalone --nnodes=1 --nproc_per_node=4 --local_addr=127.0.0.1 --local-ranks-filter=0,1,2,3 --role=rank --tee=3 -m timelyfreeze.train --job.config_file=/opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml --job.description="Llama 3.1 8B Experiment
260102: everything same with 1104_llama8b/1128, but with seed=42
" --parallelism.pipeline_parallel_degree=4  --freezing.freeze --freezing.metric_type=auto --freezing.threshold=0.0001 --freezing.max_freeze_ratio=0.8 --freezing.percentile=80
ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
W0102 18:02:21.132000 2860230 site-packages/torch/distributed/run.py:803] 
W0102 18:02:21.132000 2860230 site-packages/torch/distributed/run.py:803] *****************************************
W0102 18:02:21.132000 2860230 site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0102 18:02:21.132000 2860230 site-packages/torch/distributed/run.py:803] *****************************************
[rank3]:2026-01-02 18:02:27,924 - Starting job: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank2]:2026-01-02 18:02:27,859 - Starting job: "Llama 3.1 8B Experiment
[rank2]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank2]:"
[rank0]:2026-01-02 18:02:28,338 - Starting job: "Llama 3.1 8B Experiment
[rank0]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank0]:"
[rank2]:2026-01-02 18:02:28,367 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank2]:2026-01-02 18:02:28,369 - Building 1-D device mesh with ['pp'], [4]
[rank2]:2026-01-02 18:02:28,373 - Deterministic algorithm enabled (expect perf degradation).
[rank1]:2026-01-02 18:02:28,535 - Starting job: "Llama 3.1 8B Experiment
[rank1]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank1]:"
[rank3]:2026-01-02 18:02:28,463 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank3]:2026-01-02 18:02:28,465 - Building 1-D device mesh with ['pp'], [4]
[rank3]:2026-01-02 18:02:28,469 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 18:02:28,728 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank0]:2026-01-02 18:02:28,730 - Building 1-D device mesh with ['pp'], [4]
[rank0]:2026-01-02 18:02:28,734 - [GC] Initial GC collection 0.00 seconds
[rank0]:2026-01-02 18:02:28,734 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 18:02:28,736 - Loading tokenizer from tokenizer.json
[rank1]:2026-01-02 18:02:28,929 - ENV[TORCH_NCCL_ASYNC_ERROR_HANDLING] = 1 will be overridden to 3 based on job config
[rank1]:2026-01-02 18:02:28,932 - Building 1-D device mesh with ['pp'], [4]
[rank1]:2026-01-02 18:02:28,937 - Deterministic algorithm enabled (expect perf degradation).
[rank0]:2026-01-02 18:02:29,021 - Preparing openhermes dataset from teknium/OpenHermes-2.5
[rank0]:2026-01-02 18:02:30,597 - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=1024, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[rank0]:2026-01-02 18:02:30,842 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 18:02:30,892 - Model llama3 8B size: 8,030,261,248 total parameters
[rank0]:2026-01-02 18:02:30,915 - PP rank 0 is building stage_idx 0 with modules ['tok_embeddings', 'layers.0', 'layers.1', 'layers.2', 'layers.3', 'layers.4', 'layers.5', 'layers.6', 'layers.7']
[rank0]:2026-01-02 18:02:30,915 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-02 18:02:31,123 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank0]:2026-01-02 18:02:31,151 - Peak FLOPS used for computing MFU: 9.890e+14
[rank0]:2026-01-02 18:02:31,152 - CUDA memory usage for model: 8.46GiB(6.05%)
[rank1]:2026-01-02 18:02:31,200 - PP rank 1 is building stage_idx 1 with modules ['layers.8', 'layers.9', 'layers.10', 'layers.11', 'layers.12', 'layers.13', 'layers.14', 'layers.15', 'layers.16']
[rank1]:2026-01-02 18:02:31,200 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank1]:2026-01-02 18:02:31,430 - Peak FLOPS used for computing MFU: 9.890e+14
[rank1]:2026-01-02 18:02:31,430 - CUDA memory usage for model: 7.33GiB(5.24%)
[rank3]:wandb: Currently logged in as: orangingq to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank3]:wandb: setting up run wlgql67l
[rank3]:wandb: Tracking run with wandb version 0.23.1
[rank3]:wandb: Run data is saved locally in /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_auto_h200/20260102-1802/wandb/run-20260102_180237-wlgql67l
[rank3]:wandb: Run `wandb offline` to turn off syncing.
[rank3]:wandb: Syncing run 260102_GPipe_auto_h200
[rank3]:wandb: â­ï¸ View project at https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: ðŸš€ View run at https://wandb.ai/orangingq/torchtitan/runs/wlgql67l
[rank3]:2026-01-02 18:02:39,239 - WandB logging enabled
[rank3]:2026-01-02 18:02:39,241 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank3]:2026-01-02 18:02:39,323 - PP rank 3 is building stage_idx 3 with modules ['layers.25', 'layers.26', 'layers.27', 'layers.28', 'layers.29', 'layers.30', 'layers.31', 'norm', 'output']
[rank3]:2026-01-02 18:02:39,323 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2026-01-02 18:02:39,596 - Peak FLOPS used for computing MFU: 9.890e+14
[rank3]:2026-01-02 18:02:39,597 - CUDA memory usage for model: 7.66GiB(5.48%)
[rank2]:2026-01-02 18:02:43,173 - CUDA capacity: NVIDIA H200 with 139.81GiB memory
[rank2]:2026-01-02 18:02:43,249 - PP rank 2 is building stage_idx 2 with modules ['layers.17', 'layers.18', 'layers.19', 'layers.20', 'layers.21', 'layers.22', 'layers.23', 'layers.24']
[rank2]:2026-01-02 18:02:43,249 - Using pipeline schedule GPipe with 8 microbatches and 4 stages.
[rank3]:2026-01-02 18:02:43,542 - Mixed precision training with TP or PP is handled by autocast
[rank1]:2026-01-02 18:02:43,542 - Mixed precision training with TP or PP is handled by autocast
[rank2]:2026-01-02 18:02:43,511 - Peak FLOPS used for computing MFU: 9.890e+14
[rank2]:2026-01-02 18:02:43,512 - CUDA memory usage for model: 6.51GiB(4.65%)
[rank2]:2026-01-02 18:02:43,541 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 18:02:43,528 - Checkpointing active. Checkpoints will be loaded from and saved to /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_auto_h200
[rank0]:2026-01-02 18:02:43,528 - Mixed precision training with TP or PP is handled by autocast
[rank0]:2026-01-02 18:02:43,528 - Trainer is initialized with local batch size 16, global batch size 64, gradient accumulation steps 4, sequence length 1024, total steps 2000 (warmup 200)
[rank0]:2026-01-02 18:02:43,528 - Loading the checkpoint from /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp.
[rank0]:2026-01-02 18:02:55,568 - [GC] GC collection for checkpoint loading. 0.01 seconds
[rank0]:2026-01-02 18:02:55,568 - Finished loading the checkpoint in 12.04 seconds.
[rank0]:2026-01-02 18:02:55,569 - Training starts at step 1
[rank1]:2026-01-02 18:03:00,619 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.37GiB(39.61%)  tps: 557  tflops: 25.96  mfu: 2.62%
[rank1]:2026-01-02 18:03:00,619 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank3]:2026-01-02 18:03:00,629 -  step:  1  loss:  8.2933  grad_norm:     inf  memory: 61.09GiB(43.70%)  tps: 768  tflops: 35.83  mfu: 3.62%
[rank3]:2026-01-02 18:03:00,630 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 18:03:00,644 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 55.18GiB(39.46%)  tps: 551  tflops: 25.68  mfu: 2.60%
[rank0]:2026-01-02 18:03:00,644 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank2]:2026-01-02 18:03:00,617 -  step:  1  loss: -4.0000  grad_norm:     inf  memory: 49.30GiB(35.26%)  tps: 942  tflops: 43.93  mfu: 4.44%
[rank2]:2026-01-02 18:03:00,617 - Synchronizing and adjusting timeout for all ProcessGroups to 0:05:00
[rank0]:2026-01-02 18:05:18,939 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 18:05:21,696 - Avg. fwd time: 15.3609 / Avg. bwd time: 45.9762 / Avg. batch time: 510.1880 (ms) / GPU bubble ratio: 3.82%
[rank2]:2026-01-02 18:05:21,742 - Avg. fwd time: 14.2181 / Avg. bwd time: 40.0988 / Avg. batch time: 570.1652 (ms) / GPU bubble ratio: 23.79%
[rank1]:2026-01-02 18:05:21,793 - Avg. fwd time: 16.2538 / Avg. bwd time: 45.5855 / Avg. batch time: 638.5970 (ms) / GPU bubble ratio: 22.53%
[rank3]:2026-01-02 18:05:21,880 -  step: 50  loss:  9.4337  grad_norm: 5745.0024  memory: 76.42GiB(54.66%)  tps: 5,684  tflops: 265.09  mfu: 26.80%
[rank1]:2026-01-02 18:05:21,876 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 70.00GiB(50.07%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank0]:2026-01-02 18:05:21,843 - Avg. fwd time: 14.9920 / Avg. bwd time: 42.6924 / Avg. batch time: 702.1410 (ms) / GPU bubble ratio: 34.28%
[rank0]:2026-01-02 18:05:21,880 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 72.15GiB(51.60%)  tps: 5,684  tflops: 265.11  mfu: 26.81%
[rank2]:2026-01-02 18:05:21,874 -  step: 50  loss: -4.0000  grad_norm: 5745.0024  memory: 62.32GiB(44.58%)  tps: 5,683  tflops: 265.07  mfu: 26.80%
[rank0]:2026-01-02 18:07:43,344 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 18:07:46,093 - Avg. fwd time: 15.3138 / Avg. bwd time: 46.0302 / Avg. batch time: 509.0048 (ms) / GPU bubble ratio: 3.59%
[rank2]:2026-01-02 18:07:46,142 - Avg. fwd time: 14.2133 / Avg. bwd time: 40.1928 / Avg. batch time: 568.4635 (ms) / GPU bubble ratio: 23.43%
[rank1]:2026-01-02 18:07:46,195 - Avg. fwd time: 16.2284 / Avg. bwd time: 45.6280 / Avg. batch time: 636.2241 (ms) / GPU bubble ratio: 22.22%
[rank0]:2026-01-02 18:07:46,243 - Avg. fwd time: 14.8530 / Avg. bwd time: 42.8118 / Avg. batch time: 699.3186 (ms) / GPU bubble ratio: 34.03%
[rank2]:2026-01-02 18:07:46,272 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 62.32GiB(44.58%)  tps: 5,673  tflops: 264.60  mfu: 26.75%
[rank2]:2026-01-02 18:07:46,273 - Nothing to draw before the end of warmup.
[rank1]:2026-01-02 18:07:46,275 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 70.00GiB(50.07%)  tps: 5,673  tflops: 264.60  mfu: 26.75%
[rank1]:2026-01-02 18:07:46,275 - Nothing to draw before the end of warmup.
[rank3]:2026-01-02 18:07:46,287 -  step: 100  loss:  4.3426  grad_norm: 109.5687  memory: 76.42GiB(54.66%)  tps: 5,673  tflops: 264.60  mfu: 26.75%
[rank3]:2026-01-02 18:07:46,288 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 18:07:46,279 -  step: 100  loss: -4.0000  grad_norm: 109.5687  memory: 72.15GiB(51.60%)  tps: 5,673  tflops: 264.60  mfu: 26.75%
[rank0]:2026-01-02 18:07:46,279 - Nothing to draw before the end of warmup.
[rank0]:2026-01-02 18:10:08,069 - [GC] Peforming periodical GC collection 0.00 seconds
[rank2]:2026-01-02 18:10:10,873 - Avg. fwd time: 14.1909 / Avg. bwd time: 40.2560 / Avg. batch time: 567.8539 (ms) / GPU bubble ratio: 23.29%
[rank3]:2026-01-02 18:10:10,827 - Avg. fwd time: 15.2733 / Avg. bwd time: 46.0675 / Avg. batch time: 508.5620 (ms) / GPU bubble ratio: 3.51%
[rank1]:2026-01-02 18:10:10,923 - Avg. fwd time: 16.1991 / Avg. bwd time: 45.6589 / Avg. batch time: 635.3446 (ms) / GPU bubble ratio: 22.11%
[rank1]:2026-01-02 18:10:11,006 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 70.00GiB(50.07%)  tps: 5,660  tflops: 263.99  mfu: 26.69%
[rank2]:2026-01-02 18:10:11,003 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 62.32GiB(44.58%)  tps: 5,660  tflops: 263.99  mfu: 26.69%
[rank3]:2026-01-02 18:10:11,008 -  step: 150  loss:  1.9824  grad_norm: 22.4032  memory: 76.42GiB(54.66%)  tps: 5,661  tflops: 264.01  mfu: 26.69%
[rank0]:2026-01-02 18:10:10,973 - Avg. fwd time: 14.8080 / Avg. bwd time: 42.8709 / Avg. batch time: 698.3377 (ms) / GPU bubble ratio: 33.92%
[rank0]:2026-01-02 18:10:11,010 -  step: 150  loss: -4.0000  grad_norm: 22.4032  memory: 72.15GiB(51.60%)  tps: 5,660  tflops: 263.99  mfu: 26.69%
[rank0]:2026-01-02 18:10:36,982 - Freezing Ratio: [Stage0] 0.00, Threshold: 0.0000e+00
[rank1]:2026-01-02 18:10:36,979 - Freezing Ratio: [Stage1] 0.00, Threshold: 0.0000e+00
[rank2]:2026-01-02 18:10:36,975 - Freezing Ratio: [Stage2] 0.00, Threshold: 0.0000e+00
[rank3]:2026-01-02 18:10:36,979 - Freezing Ratio: [Stage3] 0.00, Threshold: 0.0000e+00
[rank0]:2026-01-02 18:11:05,900 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.9856e+00
[rank1]:2026-01-02 18:11:05,895 - Freezing Ratio: [Stage1] 0.44, Threshold: 6.4146e-01
[rank2]:2026-01-02 18:11:05,892 - Freezing Ratio: [Stage2] 0.75, Threshold: 7.2266e-01
[rank3]:2026-01-02 18:11:05,898 - Freezing Ratio: [Stage3] 0.55, Threshold: 1.3296e+00
[rank0]:2026-01-02 18:11:32,841 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.4663e+00
[rank1]:2026-01-02 18:11:32,824 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.0139e+00
[rank2]:2026-01-02 18:11:32,815 - Freezing Ratio: [Stage2] 0.00, Threshold: 1.3316e+00
[rank3]:2026-01-02 18:11:32,826 - Freezing Ratio: [Stage3] 0.00, Threshold: 1.4253e+00
[rank0]:2026-01-02 18:12:01,557 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.0576e+00
[rank1]:2026-01-02 18:12:01,553 - Freezing Ratio: [Stage1] 0.56, Threshold: 5.7606e+00
[rank2]:2026-01-02 18:12:01,550 - Freezing Ratio: [Stage2] 0.75, Threshold: 3.3651e+00
[rank3]:2026-01-02 18:12:01,555 - Freezing Ratio: [Stage3] 0.55, Threshold: 7.1110e+00
[rank0]:2026-01-02 18:12:25,175 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:12:25,188 - Freezing Ratio: [Stage0] 0.00, Threshold: 3.2044e+00
[rank1]:2026-01-02 18:12:25,188 - Freezing Ratio: [Stage1] 0.00, Threshold: 1.8642e+00
[rank2]:2026-01-02 18:12:25,181 - Freezing Ratio: [Stage2] 0.00, Threshold: 3.2690e+00
[rank3]:2026-01-02 18:12:25,194 - Freezing Ratio: [Stage3] 0.00, Threshold: 2.3592e+00
[rank3]:2026-01-02 18:12:27,917 - Avg. fwd time: 15.3956 / Avg. bwd time: 44.9809 / Avg. batch time: 500.6323 (ms) / GPU bubble ratio: 3.52%
[rank1]:2026-01-02 18:12:28,021 - Avg. fwd time: 16.3641 / Avg. bwd time: 44.4261 / Avg. batch time: 624.3744 (ms) / GPU bubble ratio: 22.11%
[rank2]:2026-01-02 18:12:27,964 - Avg. fwd time: 14.4112 / Avg. bwd time: 38.6292 / Avg. batch time: 558.1436 (ms) / GPU bubble ratio: 23.98%
[rank0]:2026-01-02 18:12:28,070 - Avg. fwd time: 14.9117 / Avg. bwd time: 42.0746 / Avg. batch time: 688.9921 (ms) / GPU bubble ratio: 33.83%
[rank0]:2026-01-02 18:12:28,105 -  step: 200  loss: -4.0000  grad_norm: 23.8856  memory: 73.98GiB(52.92%)  tps: 5,975  tflops: 278.69  mfu: 28.18%
[rank1]:2026-01-02 18:12:28,102 -  step: 200  loss: -4.0000  grad_norm: 23.8856  memory: 71.56GiB(51.19%)  tps: 5,975  tflops: 278.69  mfu: 28.18%
[rank2]:2026-01-02 18:12:28,099 -  step: 200  loss: -4.0000  grad_norm: 23.8856  memory: 64.18GiB(45.90%)  tps: 5,975  tflops: 278.69  mfu: 28.18%
[rank3]:2026-01-02 18:12:28,107 -  step: 200  loss:  0.4943  grad_norm: 23.8856  memory: 77.56GiB(55.47%)  tps: 5,975  tflops: 278.70  mfu: 28.18%
[rank0]:2026-01-02 18:12:28,189 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1812_stage0_step200.svg
[rank1]:2026-01-02 18:12:28,190 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1812_stage1_step200.svg
[rank2]:2026-01-02 18:12:28,187 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1812_stage2_step200.svg
[rank3]:2026-01-02 18:12:28,273 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1812_step200_rank3.svg
[rank3]:			> Batch Time: 573.38 ms, GPU Bubble Ratio: 39.41%, 30.18%, 43.66%, 27.39%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-16-34ms     | [S0,MB2,F]  34-16-51ms     | [S0,MB3,F]  51-16-68ms     | [S0,MB4,F]  68-16-85ms     | [S0,MB5,F]  85-17-102ms    | [S0,MB6,F]  102-17-119ms   | [S0,MB7,F]  119-16-136ms   | [S0,MB0,B]  298-26-324ms   | [S0,MB1,B]  333-26-359ms   | [S0,MB2,B]  369-26-395ms   | [S0,MB3,B]  404-26-430ms   | [S0,MB4,B]  439-26-465ms   | [S0,MB5,B]  475-26-501ms   | [S0,MB6,B]  510-26-536ms   | [S0,MB7,B]  547-26-573ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-17-55ms     | [S1,MB2,F]  56-17-73ms     | [S1,MB3,F]  74-17-91ms     | [S1,MB4,F]  92-17-110ms    | [S1,MB5,F]  110-18-128ms   | [S1,MB6,F]  128-18-146ms   | [S1,MB7,F]  147-18-165ms   | [S1,MB0,B]  266-31-297ms   | [S1,MB1,B]  301-31-332ms   | [S1,MB2,B]  336-31-368ms   | [S1,MB3,B]  371-31-403ms   | [S1,MB4,B]  406-31-438ms   | [S1,MB5,B]  442-32-474ms   | [S1,MB6,B]  477-32-509ms   | [S1,MB7,B]  514-31-546ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  55-16-72ms     | [S2,MB2,F]  73-16-90ms     | [S2,MB3,F]  91-16-108ms    | [S2,MB4,F]  110-16-126ms   | [S2,MB5,F]  128-16-144ms   | [S2,MB6,F]  146-16-163ms   | [S2,MB7,F]  165-16-181ms   | [S2,MB0,B]  240-23-264ms   | [S2,MB1,B]  276-23-300ms   | [S2,MB2,B]  312-23-336ms   | [S2,MB3,B]  347-23-371ms   | [S2,MB4,B]  382-23-406ms   | [S2,MB5,B]  418-23-441ms   | [S2,MB6,B]  453-23-477ms   | [S2,MB7,B]  489-23-513ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-16-92ms     | [S3,MB2,F]  94-16-110ms    | [S3,MB3,F]  112-16-128ms   | [S3,MB4,F]  131-16-147ms   | [S3,MB5,F]  149-16-166ms   | [S3,MB6,F]  168-16-184ms   | [S3,MB7,F]  187-16-203ms   | [S3,MB0,B]  205-35-240ms   | [S3,MB1,B]  240-35-275ms   | [S3,MB2,B]  276-35-311ms   | [S3,MB3,B]  311-35-347ms   | [S3,MB4,B]  346-35-382ms   | [S3,MB5,B]  382-35-417ms   | [S3,MB6,B]  417-35-452ms   | [S3,MB7,B]  452-35-488ms  
[rank3]:2026-01-02 18:12:28,320 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1812_stage3_step200.svg
[rank0]:2026-01-02 18:12:28,369 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1812_rank0_stage0.svg
[rank0]:	> Counts Sum: 54, Total Sum: 365 (14.79%), Ratio(%) per element: [0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:12:28,384 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1812_rank1_stage1.svg
[rank1]:	> Counts Sum: 81, Total Sum: 405 (20.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:12:28,360 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1812_rank2_stage2.svg
[rank2]:	> Counts Sum: 108, Total Sum: 360 (30.00%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:12:28,492 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1812_rank3_stage3.svg
[rank3]:	> Counts Sum: 72, Total Sum: 325 (22.15%), Ratio(%) per element: [40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:12:54,454 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.1299e+00
[rank1]:2026-01-02 18:12:54,458 - Freezing Ratio: [Stage1] 0.67, Threshold: 9.5409e+00
[rank3]:2026-01-02 18:12:54,460 - Freezing Ratio: [Stage3] 0.55, Threshold: 1.0586e+01
[rank0]:2026-01-02 18:12:54,461 - Freezing Ratio: [Stage0] 0.74, Threshold: 4.9486e+00
[rank2]:2026-01-02 18:13:18,076 - Freezing Ratio: [Stage2] 0.00, Threshold: 5.3053e+00
[rank3]:2026-01-02 18:13:18,088 - Freezing Ratio: [Stage3] 0.00, Threshold: 4.0363e+00
[rank1]:2026-01-02 18:13:18,079 - Freezing Ratio: [Stage1] 0.00, Threshold: 4.6020e+00
[rank0]:2026-01-02 18:13:18,083 - Freezing Ratio: [Stage0] 0.00, Threshold: 4.6594e+00
[rank0]:2026-01-02 18:13:46,985 - Freezing Ratio: [Stage0] 0.74, Threshold: 2.1240e+00
[rank2]:2026-01-02 18:13:46,978 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.5132e+00
[rank3]:2026-01-02 18:13:46,982 - Freezing Ratio: [Stage3] 0.69, Threshold: 3.4379e+00
[rank1]:2026-01-02 18:13:46,982 - Freezing Ratio: [Stage1] 0.78, Threshold: 3.4407e+00
[rank0]:2026-01-02 18:14:09,784 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.5052e+01
[rank2]:2026-01-02 18:14:09,777 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4922e+01
[rank3]:2026-01-02 18:14:09,784 - Freezing Ratio: [Stage3] 0.69, Threshold: 3.1125e+01
[rank1]:2026-01-02 18:14:09,777 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3331e+01
[rank0]:2026-01-02 18:14:32,499 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-02 18:14:32,503 - Freezing Ratio: [Stage0] 0.74, Threshold: 6.4926e-01
[rank2]:2026-01-02 18:14:32,487 - Freezing Ratio: [Stage2] 0.75, Threshold: 2.0544e+00
[rank3]:2026-01-02 18:14:32,499 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6726e+00
[rank1]:2026-01-02 18:14:32,488 - Freezing Ratio: [Stage1] 0.78, Threshold: 1.9165e+00
[rank3]:2026-01-02 18:14:34,645 - Avg. fwd time: 15.5790 / Avg. bwd time: 43.6165 / Avg. batch time: 491.1268 (ms) / GPU bubble ratio: 3.58%
[rank0]:2026-01-02 18:14:34,744 - Avg. fwd time: 15.1675 / Avg. bwd time: 40.1893 / Avg. batch time: 672.7988 (ms) / GPU bubble ratio: 34.18%
[rank2]:2026-01-02 18:14:34,677 - Avg. fwd time: 14.6705 / Avg. bwd time: 36.8181 / Avg. batch time: 546.8008 (ms) / GPU bubble ratio: 24.67%
[rank2]:2026-01-02 18:14:34,754 -  step: 250  loss: -4.0000  grad_norm:  0.6007  memory: 64.49GiB(46.13%)  tps: 6,468  tflops: 301.67  mfu: 30.50%
[rank3]:2026-01-02 18:14:34,764 -  step: 250  loss:  0.2453  grad_norm:  0.6007  memory: 79.24GiB(56.67%)  tps: 6,468  tflops: 301.68  mfu: 30.50%
[rank1]:2026-01-02 18:14:34,709 - Avg. fwd time: 16.6730 / Avg. bwd time: 42.2684 / Avg. batch time: 610.6769 (ms) / GPU bubble ratio: 22.79%
[rank1]:2026-01-02 18:14:34,754 -  step: 250  loss: -4.0000  grad_norm:  0.6007  memory: 72.50GiB(51.86%)  tps: 6,468  tflops: 301.68  mfu: 30.50%
[rank0]:2026-01-02 18:14:34,760 -  step: 250  loss: -4.0000  grad_norm:  0.6007  memory: 73.98GiB(52.92%)  tps: 6,468  tflops: 301.67  mfu: 30.50%
[rank2]:2026-01-02 18:14:54,572 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1284e+01
[rank3]:2026-01-02 18:14:54,576 - Freezing Ratio: [Stage3] 0.69, Threshold: 4.1312e+00
[rank1]:2026-01-02 18:14:54,572 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0875e+01
[rank0]:2026-01-02 18:14:54,579 - Freezing Ratio: [Stage0] 0.74, Threshold: 1.3588e+01
[rank0]:2026-01-02 18:15:17,145 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2549e+00
[rank2]:2026-01-02 18:15:17,134 - Freezing Ratio: [Stage2] 0.75, Threshold: 5.5114e+00
[rank3]:2026-01-02 18:15:17,145 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3025e+00
[rank1]:2026-01-02 18:15:17,134 - Freezing Ratio: [Stage1] 0.78, Threshold: 5.4738e+00
[rank2]:2026-01-02 18:15:39,225 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.7490e-01
[rank3]:2026-01-02 18:15:39,231 - Freezing Ratio: [Stage3] 0.69, Threshold: 2.2315e+00
[rank1]:2026-01-02 18:15:39,224 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5000e+00
[rank0]:2026-01-02 18:15:39,229 - Freezing Ratio: [Stage0] 0.74, Threshold: 1.8872e+00
[rank1]:2026-01-02 18:16:01,754 - Freezing Ratio: [Stage1] 0.78, Threshold: 2.2362e+00
[rank0]:2026-01-02 18:16:01,765 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.1757e+00
[rank2]:2026-01-02 18:16:01,754 - Freezing Ratio: [Stage2] 0.75, Threshold: 6.0954e-01
[rank3]:2026-01-02 18:16:01,766 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.8680e+00
[rank1]:2026-01-02 18:16:23,781 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.5327e+00
[rank3]:2026-01-02 18:16:23,785 - Freezing Ratio: [Stage3] 0.69, Threshold: 8.2799e+00
[rank0]:2026-01-02 18:16:23,776 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:16:23,785 - Freezing Ratio: [Stage0] 0.74, Threshold: 8.2471e+00
[rank2]:2026-01-02 18:16:23,781 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.5374e+00
[rank3]:2026-01-02 18:16:25,961 - Avg. fwd time: 15.8808 / Avg. bwd time: 41.4806 / Avg. batch time: 476.4730 (ms) / GPU bubble ratio: 3.69%
[rank0]:2026-01-02 18:16:26,048 - Avg. fwd time: 15.5145 / Avg. bwd time: 37.6989 / Avg. batch time: 649.7496 (ms) / GPU bubble ratio: 34.48%
[rank2]:2026-01-02 18:16:25,988 - Avg. fwd time: 15.0144 / Avg. bwd time: 34.4607 / Avg. batch time: 529.7005 (ms) / GPU bubble ratio: 25.28%
[rank2]:2026-01-02 18:16:26,055 -  step: 300  loss: -4.0000  grad_norm:  0.8738  memory: 64.49GiB(46.13%)  tps: 7,360  tflops: 343.28  mfu: 34.71%
[rank1]:2026-01-02 18:16:26,016 - Avg. fwd time: 17.0879 / Avg. bwd time: 39.4033 / Avg. batch time: 590.5506 (ms) / GPU bubble ratio: 23.47%
[rank1]:2026-01-02 18:16:26,055 -  step: 300  loss: -4.0000  grad_norm:  0.8738  memory: 72.50GiB(51.86%)  tps: 7,360  tflops: 343.28  mfu: 34.71%
[rank3]:2026-01-02 18:16:26,066 -  step: 300  loss:  0.2732  grad_norm:  0.8738  memory: 79.24GiB(56.67%)  tps: 7,360  tflops: 343.29  mfu: 34.71%
[rank0]:2026-01-02 18:16:26,064 -  step: 300  loss: -4.0000  grad_norm:  0.8738  memory: 74.28GiB(53.13%)  tps: 7,360  tflops: 343.28  mfu: 34.71%
[rank0]:2026-01-02 18:16:26,112 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1816_stage0_step300.svg
[rank2]:2026-01-02 18:16:26,111 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1816_stage2_step300.svg
[rank1]:2026-01-02 18:16:26,112 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1816_stage1_step300.svg
[rank3]:2026-01-02 18:16:26,206 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1816_step300_rank3.svg
[rank3]:			> Batch Time: 526.95 ms, GPU Bubble Ratio: 37.60%, 31.26%, 38.61%, 28.29%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB4,F]  69-17-87ms     | [S0,MB5,F]  87-17-104ms    | [S0,MB6,F]  104-17-122ms   | [S0,MB7,F]  122-17-139ms   | [S0,MB0,B]  292-23-316ms   | [S0,MB1,B]  322-23-346ms   | [S0,MB2,B]  353-23-376ms   | [S0,MB3,B]  383-23-406ms   | [S0,MB4,B]  413-23-436ms   | [S0,MB5,B]  443-23-466ms   | [S0,MB6,B]  472-23-496ms   | [S0,MB7,B]  503-23-526ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-18-57ms     | [S1,MB2,F]  57-18-76ms     | [S1,MB3,F]  76-18-95ms     | [S1,MB4,F]  95-18-114ms    | [S1,MB5,F]  114-18-133ms   | [S1,MB6,F]  133-18-152ms   | [S1,MB7,F]  153-18-172ms   | [S1,MB0,B]  266-26-292ms   | [S1,MB1,B]  296-26-322ms   | [S1,MB2,B]  326-26-352ms   | [S1,MB3,B]  356-26-382ms   | [S1,MB4,B]  386-26-412ms   | [S1,MB5,B]  416-26-442ms   | [S1,MB6,B]  445-26-471ms   | [S1,MB7,B]  475-26-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  57-16-73ms     | [S2,MB2,F]  76-16-92ms     | [S2,MB3,F]  95-16-111ms    | [S2,MB4,F]  114-16-130ms   | [S2,MB5,F]  133-16-150ms   | [S2,MB6,F]  152-16-169ms   | [S2,MB7,F]  172-16-188ms   | [S2,MB0,B]  242-23-266ms   | [S2,MB1,B]  272-23-296ms   | [S2,MB2,B]  302-23-325ms   | [S2,MB3,B]  332-23-355ms   | [S2,MB4,B]  361-23-385ms   | [S2,MB5,B]  391-23-415ms   | [S2,MB6,B]  421-23-445ms   | [S2,MB7,B]  451-23-475ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-112ms    | [S3,MB3,F]  114-17-131ms   | [S3,MB4,F]  134-17-151ms   | [S3,MB5,F]  153-17-171ms   | [S3,MB6,F]  173-17-190ms   | [S3,MB7,F]  193-17-210ms   | [S3,MB0,B]  212-29-242ms   | [S3,MB1,B]  241-29-271ms   | [S3,MB2,B]  271-29-301ms   | [S3,MB3,B]  301-29-331ms   | [S3,MB4,B]  331-29-361ms   | [S3,MB5,B]  361-29-390ms   | [S3,MB6,B]  391-29-420ms   | [S3,MB7,B]  420-29-450ms  
[rank3]:2026-01-02 18:16:26,248 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1816_stage3_step300.svg
[rank0]:2026-01-02 18:16:26,289 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1816_rank0_stage0.svg
[rank0]:	> Counts Sum: 558, Total Sum: 1095 (50.96%), Ratio(%) per element: [0.0, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 13.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:16:26,283 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1816_rank2_stage2.svg
[rank2]:	> Counts Sum: 630, Total Sum: 1080 (58.33%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:16:26,293 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1816_rank1_stage1.svg
[rank1]:	> Counts Sum: 675, Total Sum: 1215 (55.56%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 60.0, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 26.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:16:26,413 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1816_rank3_stage3.svg
[rank3]:	> Counts Sum: 495, Total Sum: 975 (50.77%), Ratio(%) per element: [73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 73.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 53.33, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:16:46,674 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0916e+02
[rank1]:2026-01-02 18:16:46,673 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0307e+02
[rank3]:2026-01-02 18:16:46,684 - Freezing Ratio: [Stage3] 0.83, Threshold: 8.6874e+01
[rank0]:2026-01-02 18:16:46,683 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8610e+01
[rank2]:2026-01-02 18:17:08,112 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.1761e-01
[rank3]:2026-01-02 18:17:08,119 - Freezing Ratio: [Stage3] 0.69, Threshold: 9.1420e-01
[rank1]:2026-01-02 18:17:08,112 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0547e-01
[rank0]:2026-01-02 18:17:08,119 - Freezing Ratio: [Stage0] 0.74, Threshold: 1.7499e-01
[rank0]:2026-01-02 18:17:30,875 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1009e+00
[rank2]:2026-01-02 18:17:30,865 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3760e+00
[rank1]:2026-01-02 18:17:30,864 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5421e+00
[rank3]:2026-01-02 18:17:30,876 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6078e+00
[rank2]:2026-01-02 18:17:52,649 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.7324e+00
[rank3]:2026-01-02 18:17:52,658 - Freezing Ratio: [Stage3] 0.69, Threshold: 6.7755e+00
[rank1]:2026-01-02 18:17:52,649 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.0978e+00
[rank0]:2026-01-02 18:17:52,657 - Freezing Ratio: [Stage0] 0.74, Threshold: 6.9691e+00
[rank1]:2026-01-02 18:18:15,303 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3086e+01
[rank0]:2026-01-02 18:18:15,309 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:18:15,313 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3031e+01
[rank2]:2026-01-02 18:18:15,303 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3091e+01
[rank3]:2026-01-02 18:18:15,315 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1643e+01
[rank3]:2026-01-02 18:18:17,405 - Avg. fwd time: 16.0899 / Avg. bwd time: 40.0220 / Avg. batch time: 466.5320 (ms) / GPU bubble ratio: 3.78%
[rank2]:2026-01-02 18:18:17,432 - Avg. fwd time: 15.2963 / Avg. bwd time: 32.5468 / Avg. batch time: 517.8257 (ms) / GPU bubble ratio: 26.09%
[rank3]:2026-01-02 18:18:17,506 -  step: 350  loss:  0.3246  grad_norm:  0.5392  memory: 79.24GiB(56.67%)  tps: 7,351  tflops: 342.86  mfu: 34.67%
[rank1]:2026-01-02 18:18:17,462 - Avg. fwd time: 17.4191 / Avg. bwd time: 37.1253 / Avg. batch time: 576.2734 (ms) / GPU bubble ratio: 24.28%
[rank1]:2026-01-02 18:18:17,498 -  step: 350  loss: -4.0000  grad_norm:  0.5392  memory: 72.50GiB(51.86%)  tps: 7,351  tflops: 342.85  mfu: 34.67%
[rank0]:2026-01-02 18:18:17,492 - Avg. fwd time: 15.7653 / Avg. bwd time: 35.9130 / Avg. batch time: 633.3676 (ms) / GPU bubble ratio: 34.73%
[rank0]:2026-01-02 18:18:17,504 -  step: 350  loss: -4.0000  grad_norm:  0.5392  memory: 74.28GiB(53.13%)  tps: 7,351  tflops: 342.85  mfu: 34.67%
[rank2]:2026-01-02 18:18:17,498 -  step: 350  loss: -4.0000  grad_norm:  0.5392  memory: 64.49GiB(46.13%)  tps: 7,351  tflops: 342.85  mfu: 34.67%
[rank0]:2026-01-02 18:18:37,085 - Freezing Ratio: [Stage0] 0.74, Threshold: 2.6816e-01
[rank2]:2026-01-02 18:18:37,078 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2980e+00
[rank3]:2026-01-02 18:18:37,087 - Freezing Ratio: [Stage3] 0.69, Threshold: 2.2725e+00
[rank1]:2026-01-02 18:18:37,078 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1046e+00
[rank0]:2026-01-02 18:18:59,775 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.3460e-01
[rank2]:2026-01-02 18:18:59,765 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2878e+00
[rank3]:2026-01-02 18:18:59,776 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3341e+00
[rank1]:2026-01-02 18:18:59,765 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.0554e-01
[rank2]:2026-01-02 18:19:21,439 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6446e+00
[rank3]:2026-01-02 18:19:21,448 - Freezing Ratio: [Stage3] 0.69, Threshold: 1.2142e+00
[rank1]:2026-01-02 18:19:21,439 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.9472e-01
[rank0]:2026-01-02 18:19:21,446 - Freezing Ratio: [Stage0] 0.74, Threshold: 9.3537e-01
[rank0]:2026-01-02 18:19:44,049 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2420e-01
[rank2]:2026-01-02 18:19:44,038 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.3955e-01
[rank3]:2026-01-02 18:19:44,049 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1369e-01
[rank1]:2026-01-02 18:19:44,038 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1256e-01
[rank0]:2026-01-02 18:20:05,645 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:20:05,655 - Freezing Ratio: [Stage0] 0.74, Threshold: 8.1414e-01
[rank2]:2026-01-02 18:20:05,648 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4281e-01
[rank1]:2026-01-02 18:20:05,647 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.2791e-01
[rank3]:2026-01-02 18:20:05,654 - Freezing Ratio: [Stage3] 0.69, Threshold: 8.4548e-01
[rank2]:2026-01-02 18:20:07,855 - Avg. fwd time: 15.5071 / Avg. bwd time: 31.1115 / Avg. batch time: 508.4382 (ms) / GPU bubble ratio: 26.65%
[rank3]:2026-01-02 18:20:07,829 - Avg. fwd time: 16.2530 / Avg. bwd time: 38.8706 / Avg. batch time: 458.6402 (ms) / GPU bubble ratio: 3.85%
[rank1]:2026-01-02 18:20:07,883 - Avg. fwd time: 17.6669 / Avg. bwd time: 35.4162 / Avg. batch time: 565.0812 (ms) / GPU bubble ratio: 24.85%
[rank0]:2026-01-02 18:20:07,914 - Avg. fwd time: 15.9601 / Avg. bwd time: 34.5176 / Avg. batch time: 620.5410 (ms) / GPU bubble ratio: 34.92%
[rank0]:2026-01-02 18:20:07,929 -  step: 400  loss: -4.0000  grad_norm:  0.2869  memory: 74.28GiB(53.13%)  tps: 7,419  tflops: 346.00  mfu: 34.99%
[rank0]:2026-01-02 18:20:07,977 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1820_stage0_step400.svg
[rank2]:2026-01-02 18:20:07,920 -  step: 400  loss: -4.0000  grad_norm:  0.2869  memory: 64.49GiB(46.13%)  tps: 7,419  tflops: 346.01  mfu: 34.99%
[rank2]:2026-01-02 18:20:07,976 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1820_stage2_step400.svg
[rank3]:2026-01-02 18:20:07,930 -  step: 400  loss:  0.2646  grad_norm:  0.2869  memory: 79.24GiB(56.67%)  tps: 7,419  tflops: 346.01  mfu: 34.99%
[rank1]:2026-01-02 18:20:07,920 -  step: 400  loss: -4.0000  grad_norm:  0.2869  memory: 72.50GiB(51.86%)  tps: 7,419  tflops: 346.01  mfu: 34.99%
[rank1]:2026-01-02 18:20:07,978 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1820_stage1_step400.svg
[rank3]:2026-01-02 18:20:08,057 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1820_step400_rank3.svg
[rank3]:			> Batch Time: 521.67 ms, GPU Bubble Ratio: 37.02%, 34.24%, 41.68%, 27.47%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB4,F]  69-17-86ms     | [S0,MB5,F]  86-17-104ms    | [S0,MB6,F]  104-17-121ms   | [S0,MB7,F]  121-17-139ms   | [S0,MB0,B]  288-23-311ms   | [S0,MB1,B]  318-23-341ms   | [S0,MB2,B]  348-23-371ms   | [S0,MB3,B]  378-23-401ms   | [S0,MB4,B]  407-23-431ms   | [S0,MB5,B]  437-23-461ms   | [S0,MB6,B]  467-23-490ms   | [S0,MB7,B]  498-23-521ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-76ms     | [S1,MB3,F]  76-19-96ms     | [S1,MB4,F]  96-19-116ms    | [S1,MB5,F]  116-19-135ms   | [S1,MB6,F]  136-19-155ms   | [S1,MB7,F]  155-19-175ms   | [S1,MB0,B]  263-23-287ms   | [S1,MB1,B]  294-23-317ms   | [S1,MB2,B]  324-23-347ms   | [S1,MB3,B]  354-23-377ms   | [S1,MB4,B]  383-23-407ms   | [S1,MB5,B]  413-23-436ms   | [S1,MB6,B]  442-23-466ms   | [S1,MB7,B]  473-23-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  57-16-74ms     | [S2,MB2,F]  76-16-93ms     | [S2,MB3,F]  96-16-113ms    | [S2,MB4,F]  116-16-132ms   | [S2,MB5,F]  135-16-152ms   | [S2,MB6,F]  155-16-172ms   | [S2,MB7,F]  175-16-192ms   | [S2,MB0,B]  242-20-263ms   | [S2,MB1,B]  272-21-293ms   | [S2,MB2,B]  302-21-323ms   | [S2,MB3,B]  332-21-353ms   | [S2,MB4,B]  362-21-383ms   | [S2,MB5,B]  391-21-412ms   | [S2,MB6,B]  421-21-442ms   | [S2,MB7,B]  451-21-472ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  75-17-93ms     | [S3,MB2,F]  95-17-112ms    | [S3,MB3,F]  114-17-131ms   | [S3,MB4,F]  134-17-151ms   | [S3,MB5,F]  153-17-171ms   | [S3,MB6,F]  173-17-190ms   | [S3,MB7,F]  192-17-210ms   | [S3,MB0,B]  212-29-242ms   | [S3,MB1,B]  242-29-271ms   | [S3,MB2,B]  272-29-302ms   | [S3,MB3,B]  302-29-331ms   | [S3,MB4,B]  331-29-361ms   | [S3,MB5,B]  361-29-391ms   | [S3,MB6,B]  391-29-420ms   | [S3,MB7,B]  420-29-450ms  
[rank3]:2026-01-02 18:20:08,100 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1820_stage3_step400.svg
[rank0]:2026-01-02 18:20:08,149 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1820_rank0_stage0.svg
[rank0]:	> Counts Sum: 1143, Total Sum: 1825 (62.63%), Ratio(%) per element: [0.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:20:08,143 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1820_rank2_stage2.svg
[rank2]:	> Counts Sum: 1260, Total Sum: 1800 (70.00%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:20:08,157 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1820_rank1_stage1.svg
[rank1]:	> Counts Sum: 1395, Total Sum: 2025 (68.89%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 76.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 56.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:20:08,260 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1820_rank3_stage3.svg
[rank3]:	> Counts Sum: 990, Total Sum: 1625 (60.92%), Ratio(%) per element: [84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 84.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 72.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:20:28,514 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.1946e-01
[rank1]:2026-01-02 18:20:28,513 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1192e-01
[rank3]:2026-01-02 18:20:28,524 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4708e-01
[rank0]:2026-01-02 18:20:28,524 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1893e-01
[rank1]:2026-01-02 18:20:50,157 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.6137e-01
[rank0]:2026-01-02 18:20:50,165 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.0548e-01
[rank2]:2026-01-02 18:20:50,158 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.0483e-01
[rank3]:2026-01-02 18:20:50,165 - Freezing Ratio: [Stage3] 0.69, Threshold: 6.0127e-01
[rank0]:2026-01-02 18:21:12,658 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4234e-01
[rank2]:2026-01-02 18:21:12,647 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2330e-01
[rank1]:2026-01-02 18:21:12,647 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.5528e-01
[rank3]:2026-01-02 18:21:12,658 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.4462e-01
[rank0]:2026-01-02 18:21:34,248 - Freezing Ratio: [Stage0] 0.74, Threshold: 2.0081e+00
[rank2]:2026-01-02 18:21:34,240 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5159e+00
[rank3]:2026-01-02 18:21:34,247 - Freezing Ratio: [Stage3] 0.69, Threshold: 2.7208e+00
[rank1]:2026-01-02 18:21:34,240 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5498e+00
[rank2]:2026-01-02 18:21:56,907 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.7407e-01
[rank3]:2026-01-02 18:21:56,918 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0926e+00
[rank1]:2026-01-02 18:21:56,907 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2061e-01
[rank0]:2026-01-02 18:21:56,924 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-02 18:21:56,928 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8095e-01
[rank3]:2026-01-02 18:21:59,023 - Avg. fwd time: 16.3726 / Avg. bwd time: 38.0226 / Avg. batch time: 452.8388 (ms) / GPU bubble ratio: 3.90%
[rank0]:2026-01-02 18:21:59,113 - Avg. fwd time: 16.1033 / Avg. bwd time: 33.4811 / Avg. batch time: 610.9868 (ms) / GPU bubble ratio: 35.08%
[rank2]:2026-01-02 18:21:59,053 - Avg. fwd time: 15.6701 / Avg. bwd time: 29.9943 / Avg. batch time: 501.5062 (ms) / GPU bubble ratio: 27.16%
[rank2]:2026-01-02 18:21:59,120 -  step: 450  loss: -4.0000  grad_norm:  0.3746  memory: 64.49GiB(46.13%)  tps: 7,367  tflops: 343.60  mfu: 34.74%
[rank1]:2026-01-02 18:21:59,084 - Avg. fwd time: 17.8586 / Avg. bwd time: 34.0877 / Avg. batch time: 556.7487 (ms) / GPU bubble ratio: 25.36%
[rank1]:2026-01-02 18:21:59,119 -  step: 450  loss: -4.0000  grad_norm:  0.3746  memory: 72.50GiB(51.86%)  tps: 7,367  tflops: 343.60  mfu: 34.74%
[rank3]:2026-01-02 18:21:59,130 -  step: 450  loss:  0.2847  grad_norm:  0.3746  memory: 79.24GiB(56.67%)  tps: 7,367  tflops: 343.61  mfu: 34.74%
[rank0]:2026-01-02 18:21:59,126 -  step: 450  loss: -4.0000  grad_norm:  0.3746  memory: 74.28GiB(53.13%)  tps: 7,367  tflops: 343.61  mfu: 34.74%
[rank0]:2026-01-02 18:22:18,489 - Freezing Ratio: [Stage0] 0.74, Threshold: 5.6941e-01
[rank2]:2026-01-02 18:22:18,481 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7513e-01
[rank1]:2026-01-02 18:22:18,481 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5709e-01
[rank3]:2026-01-02 18:22:18,490 - Freezing Ratio: [Stage3] 0.69, Threshold: 4.8568e-01
[rank1]:2026-01-02 18:22:41,271 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0560e-01
[rank0]:2026-01-02 18:22:41,282 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5303e-01
[rank2]:2026-01-02 18:22:41,271 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.3773e-01
[rank3]:2026-01-02 18:22:41,283 - Freezing Ratio: [Stage3] 0.83, Threshold: 6.1897e-01
[rank0]:2026-01-02 18:23:03,053 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.3883e-01
[rank2]:2026-01-02 18:23:03,046 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4677e+00
[rank3]:2026-01-02 18:23:03,054 - Freezing Ratio: [Stage3] 0.69, Threshold: 9.6286e-01
[rank1]:2026-01-02 18:23:03,046 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.6590e-01
[rank0]:2026-01-02 18:23:25,669 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.1754e-01
[rank2]:2026-01-02 18:23:25,659 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.6645e-01
[rank3]:2026-01-02 18:23:25,670 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8027e-01
[rank1]:2026-01-02 18:23:25,658 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5779e-01
[rank0]:2026-01-02 18:23:47,323 - [GC] Peforming periodical GC collection 0.00 seconds
[rank3]:2026-01-02 18:23:47,333 - Freezing Ratio: [Stage3] 0.69, Threshold: 7.2360e-01
[rank1]:2026-01-02 18:23:47,326 - Freezing Ratio: [Stage1] 0.89, Threshold: 9.8920e-01
[rank2]:2026-01-02 18:23:47,326 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0806e-01
[rank0]:2026-01-02 18:23:47,334 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.1792e-01
[rank2]:2026-01-02 18:23:49,519 - Avg. fwd time: 15.7996 / Avg. bwd time: 29.1004 / Avg. batch time: 495.6074 (ms) / GPU bubble ratio: 27.52%
[rank3]:2026-01-02 18:23:49,492 - Avg. fwd time: 16.4740 / Avg. bwd time: 37.3006 / Avg. batch time: 447.8757 (ms) / GPU bubble ratio: 3.95%
[rank2]:2026-01-02 18:23:49,585 -  step: 500  loss: -4.0000  grad_norm:  0.4749  memory: 64.49GiB(46.13%)  tps: 7,416  tflops: 345.88  mfu: 34.97%
[rank0]:2026-01-02 18:23:49,579 - Avg. fwd time: 16.2230 / Avg. bwd time: 32.6069 / Avg. batch time: 602.9424 (ms) / GPU bubble ratio: 35.21%
[rank0]:2026-01-02 18:23:49,594 -  step: 500  loss: -4.0000  grad_norm:  0.4749  memory: 74.28GiB(53.13%)  tps: 7,416  tflops: 345.87  mfu: 34.97%
[rank3]:2026-01-02 18:23:49,595 -  step: 500  loss:  0.2942  grad_norm:  0.4749  memory: 79.24GiB(56.67%)  tps: 7,416  tflops: 345.88  mfu: 34.97%
[rank1]:2026-01-02 18:23:49,547 - Avg. fwd time: 18.0114 / Avg. bwd time: 33.0252 / Avg. batch time: 549.7276 (ms) / GPU bubble ratio: 25.73%
[rank1]:2026-01-02 18:23:49,585 -  step: 500  loss: -4.0000  grad_norm:  0.4749  memory: 72.50GiB(51.86%)  tps: 7,416  tflops: 345.88  mfu: 34.97%
[rank1]:2026-01-02 18:23:49,637 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1823_stage1_step500.svg
[rank2]:2026-01-02 18:23:49,638 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1823_stage2_step500.svg
[rank0]:2026-01-02 18:23:49,637 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1823_stage0_step500.svg
[rank3]:2026-01-02 18:23:49,722 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1823_step500_rank3.svg
[rank3]:			> Batch Time: 521.92 ms, GPU Bubble Ratio: 36.97%, 34.27%, 41.69%, 27.54%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-69ms     | [S0,MB4,F]  69-17-87ms     | [S0,MB5,F]  87-17-104ms    | [S0,MB6,F]  104-17-122ms   | [S0,MB7,F]  122-17-139ms   | [S0,MB0,B]  288-23-311ms   | [S0,MB1,B]  318-23-342ms   | [S0,MB2,B]  348-23-372ms   | [S0,MB3,B]  378-23-401ms   | [S0,MB4,B]  408-23-431ms   | [S0,MB5,B]  438-23-461ms   | [S0,MB6,B]  467-23-491ms   | [S0,MB7,B]  498-23-521ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-76ms     | [S1,MB3,F]  77-19-96ms     | [S1,MB4,F]  96-19-116ms    | [S1,MB5,F]  116-19-136ms   | [S1,MB6,F]  136-19-155ms   | [S1,MB7,F]  155-19-175ms   | [S1,MB0,B]  263-23-287ms   | [S1,MB1,B]  294-23-317ms   | [S1,MB2,B]  324-23-347ms   | [S1,MB3,B]  354-23-377ms   | [S1,MB4,B]  383-23-407ms   | [S1,MB5,B]  413-23-437ms   | [S1,MB6,B]  443-23-466ms   | [S1,MB7,B]  473-23-497ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  57-16-74ms     | [S2,MB2,F]  76-16-93ms     | [S2,MB3,F]  96-16-113ms    | [S2,MB4,F]  116-16-133ms   | [S2,MB5,F]  135-16-152ms   | [S2,MB6,F]  155-16-172ms   | [S2,MB7,F]  175-16-192ms   | [S2,MB0,B]  242-21-263ms   | [S2,MB1,B]  272-21-293ms   | [S2,MB2,B]  302-21-323ms   | [S2,MB3,B]  332-21-353ms   | [S2,MB4,B]  362-21-383ms   | [S2,MB5,B]  392-21-413ms   | [S2,MB6,B]  422-21-443ms   | [S2,MB7,B]  451-21-472ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-73ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-112ms    | [S3,MB3,F]  114-17-132ms   | [S3,MB4,F]  134-17-151ms   | [S3,MB5,F]  153-17-171ms   | [S3,MB6,F]  173-17-190ms   | [S3,MB7,F]  193-17-210ms   | [S3,MB0,B]  212-29-242ms   | [S3,MB1,B]  242-29-271ms   | [S3,MB2,B]  272-29-302ms   | [S3,MB3,B]  302-29-332ms   | [S3,MB4,B]  331-29-361ms   | [S3,MB5,B]  361-29-391ms   | [S3,MB6,B]  391-29-421ms   | [S3,MB7,B]  421-29-450ms  
[rank2]:2026-01-02 18:23:49,805 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1823_rank2_stage2.svg
[rank2]:	> Counts Sum: 1890, Total Sum: 2520 (75.00%), Ratio(%) per element: [88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:23:49,811 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1823_rank0_stage0.svg
[rank0]:	> Counts Sum: 1728, Total Sum: 2555 (67.63%), Ratio(%) per element: [0.0, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 34.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:23:49,760 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1823_stage3_step500.svg
[rank1]:2026-01-02 18:23:49,817 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1823_rank1_stage1.svg
[rank1]:	> Counts Sum: 2115, Total Sum: 2835 (74.60%), Ratio(%) per element: [88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 82.85, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 68.57, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:23:49,921 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1823_rank3_stage3.svg
[rank3]:	> Counts Sum: 1485, Total Sum: 2275 (65.27%), Ratio(%) per element: [88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 88.57, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 37.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:24:10,272 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0919e+00
[rank2]:2026-01-02 18:24:10,261 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.6478e-01
[rank3]:2026-01-02 18:24:10,271 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.2953e-01
[rank1]:2026-01-02 18:24:10,261 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2814e-01
[rank2]:2026-01-02 18:24:32,015 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.6716e+00
[rank0]:2026-01-02 18:24:32,023 - Freezing Ratio: [Stage0] 0.74, Threshold: 3.6446e+00
[rank1]:2026-01-02 18:24:32,015 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4491e+00
[rank3]:2026-01-02 18:24:32,022 - Freezing Ratio: [Stage3] 0.69, Threshold: 7.3833e-01
[rank2]:2026-01-02 18:24:54,523 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2137e+00
[rank0]:2026-01-02 18:24:54,534 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4285e+00
[rank1]:2026-01-02 18:24:54,523 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0793e+00
[rank3]:2026-01-02 18:24:54,533 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6837e+00
[rank1]:2026-01-02 18:25:15,926 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4843e+00
[rank2]:2026-01-02 18:25:15,925 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1178e+00
[rank0]:2026-01-02 18:25:15,933 - Freezing Ratio: [Stage0] 0.74, Threshold: 1.9440e+00
[rank3]:2026-01-02 18:25:15,934 - Freezing Ratio: [Stage3] 0.69, Threshold: 1.5630e+00
[rank2]:2026-01-02 18:25:38,421 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.4680e+00
[rank0]:2026-01-02 18:25:38,426 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:25:38,431 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1712e-01
[rank3]:2026-01-02 18:25:38,432 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7686e+00
[rank1]:2026-01-02 18:25:38,421 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2110e-01
[rank2]:2026-01-02 18:25:40,526 - Avg. fwd time: 15.9048 / Avg. bwd time: 28.3680 / Avg. batch time: 491.0519 (ms) / GPU bubble ratio: 27.87%
[rank3]:2026-01-02 18:25:40,498 - Avg. fwd time: 16.5486 / Avg. bwd time: 36.7462 / Avg. batch time: 444.0599 (ms) / GPU bubble ratio: 3.99%
[rank2]:2026-01-02 18:25:40,594 -  step: 550  loss: -4.0000  grad_norm:  0.3726  memory: 64.49GiB(46.13%)  tps: 7,380  tflops: 344.19  mfu: 34.80%
[rank0]:2026-01-02 18:25:40,588 - Avg. fwd time: 16.3149 / Avg. bwd time: 31.9320 / Avg. batch time: 596.6810 (ms) / GPU bubble ratio: 35.31%
[rank0]:2026-01-02 18:25:40,600 -  step: 550  loss: -4.0000  grad_norm:  0.3726  memory: 74.28GiB(53.13%)  tps: 7,380  tflops: 344.19  mfu: 34.80%
[rank3]:2026-01-02 18:25:40,605 -  step: 550  loss:  0.1645  grad_norm:  0.3726  memory: 79.24GiB(56.67%)  tps: 7,380  tflops: 344.20  mfu: 34.80%
[rank1]:2026-01-02 18:25:40,557 - Avg. fwd time: 18.1351 / Avg. bwd time: 32.1546 / Avg. batch time: 544.2533 (ms) / GPU bubble ratio: 26.08%
[rank1]:2026-01-02 18:25:40,594 -  step: 550  loss: -4.0000  grad_norm:  0.3726  memory: 72.50GiB(51.86%)  tps: 7,380  tflops: 344.19  mfu: 34.80%
[rank0]:2026-01-02 18:26:00,106 - Freezing Ratio: [Stage0] 0.86, Threshold: 9.4433e+00
[rank2]:2026-01-02 18:26:00,099 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.9653e+00
[rank3]:2026-01-02 18:26:00,106 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2223e+00
[rank1]:2026-01-02 18:26:00,100 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.5744e+00
[rank0]:2026-01-02 18:26:21,829 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8895e+00
[rank2]:2026-01-02 18:26:21,822 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5556e+00
[rank3]:2026-01-02 18:26:21,830 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9722e+00
[rank1]:2026-01-02 18:26:21,822 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4134e+00
[rank0]:2026-01-02 18:26:43,567 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.1357e+00
[rank2]:2026-01-02 18:26:43,560 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7517e+00
[rank1]:2026-01-02 18:26:43,560 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6989e+00
[rank3]:2026-01-02 18:26:43,567 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3259e+00
[rank0]:2026-01-02 18:27:05,468 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5399e+00
[rank1]:2026-01-02 18:27:05,460 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8489e+00
[rank3]:2026-01-02 18:27:05,468 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0768e+00
[rank2]:2026-01-02 18:27:05,460 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3834e+00
[rank0]:2026-01-02 18:27:27,679 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:27:27,689 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.9907e+00
[rank3]:2026-01-02 18:27:27,690 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4482e+00
[rank1]:2026-01-02 18:27:27,682 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7244e+00
[rank2]:2026-01-02 18:27:27,682 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.5269e+00
[rank3]:2026-01-02 18:27:29,821 - Avg. fwd time: 16.6465 / Avg. bwd time: 36.1677 / Avg. batch time: 440.1594 (ms) / GPU bubble ratio: 4.01%
[rank2]:2026-01-02 18:27:29,848 - Avg. fwd time: 16.0041 / Avg. bwd time: 27.7653 / Avg. batch time: 486.5292 (ms) / GPU bubble ratio: 28.03%
[rank0]:2026-01-02 18:27:29,908 - Avg. fwd time: 16.4236 / Avg. bwd time: 31.2404 / Avg. batch time: 590.6291 (ms) / GPU bubble ratio: 35.44%
[rank0]:2026-01-02 18:27:29,920 -  step: 600  loss: -4.0000  grad_norm:  0.7502  memory: 74.28GiB(53.13%)  tps: 7,494  tflops: 349.50  mfu: 35.34%
[rank3]:2026-01-02 18:27:29,924 -  step: 600  loss:  0.3882  grad_norm:  0.7502  memory: 79.24GiB(56.67%)  tps: 7,494  tflops: 349.52  mfu: 35.34%
[rank1]:2026-01-02 18:27:29,878 - Avg. fwd time: 18.2531 / Avg. bwd time: 31.4362 / Avg. batch time: 538.9832 (ms) / GPU bubble ratio: 26.25%
[rank1]:2026-01-02 18:27:29,914 -  step: 600  loss: -4.0000  grad_norm:  0.7502  memory: 72.50GiB(51.86%)  tps: 7,494  tflops: 349.50  mfu: 35.34%
[rank2]:2026-01-02 18:27:29,914 -  step: 600  loss: -4.0000  grad_norm:  0.7502  memory: 64.49GiB(46.13%)  tps: 7,494  tflops: 349.50  mfu: 35.34%
[rank0]:2026-01-02 18:27:29,972 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1827_stage0_step600.svg
[rank3]:2026-01-02 18:27:30,051 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1827_step600_rank3.svg
[rank3]:			> Batch Time: 527.00 ms, GPU Bubble Ratio: 36.93%, 34.22%, 41.62%, 27.33%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-36ms     | [S0,MB2,F]  36-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-89ms     | [S0,MB5,F]  89-17-106ms    | [S0,MB6,F]  106-17-124ms   | [S0,MB7,F]  124-17-142ms   | [S0,MB0,B]  292-23-315ms   | [S0,MB1,B]  322-23-345ms   | [S0,MB2,B]  352-23-375ms   | [S0,MB3,B]  382-23-405ms   | [S0,MB4,B]  412-23-435ms   | [S0,MB5,B]  442-23-465ms   | [S0,MB6,B]  472-23-496ms   | [S0,MB7,B]  503-23-527ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  138-19-158ms   | [S1,MB7,F]  158-19-178ms   | [S1,MB0,B]  267-23-291ms   | [S1,MB1,B]  298-23-321ms   | [S1,MB2,B]  328-23-351ms   | [S1,MB3,B]  358-23-381ms   | [S1,MB4,B]  388-23-411ms   | [S1,MB5,B]  417-23-441ms   | [S1,MB6,B]  447-23-471ms   | [S1,MB7,B]  478-23-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  78-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-155ms   | [S2,MB6,F]  158-17-175ms   | [S2,MB7,F]  178-17-195ms   | [S2,MB0,B]  246-21-267ms   | [S2,MB1,B]  276-21-297ms   | [S2,MB2,B]  306-21-327ms   | [S2,MB3,B]  336-21-357ms   | [S2,MB4,B]  366-21-387ms   | [S2,MB5,B]  396-21-417ms   | [S2,MB6,B]  426-21-447ms   | [S2,MB7,B]  456-21-477ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-18-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  96-17-114ms    | [S3,MB3,F]  116-17-134ms   | [S3,MB4,F]  136-17-154ms   | [S3,MB5,F]  156-17-174ms   | [S3,MB6,F]  176-17-194ms   | [S3,MB7,F]  196-17-214ms   | [S3,MB0,B]  216-29-246ms   | [S3,MB1,B]  245-30-275ms   | [S3,MB2,B]  275-30-305ms   | [S3,MB3,B]  305-30-335ms   | [S3,MB4,B]  335-30-365ms   | [S3,MB5,B]  365-29-395ms   | [S3,MB6,B]  395-30-425ms   | [S3,MB7,B]  425-29-455ms  
[rank1]:2026-01-02 18:27:29,969 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1827_stage1_step600.svg
[rank2]:2026-01-02 18:27:29,970 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1827_stage2_step600.svg
[rank0]:2026-01-02 18:27:30,150 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1827_rank0_stage0.svg
[rank0]:	> Counts Sum: 2340, Total Sum: 3285 (71.23%), Ratio(%) per element: [0.0, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 44.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:27:30,093 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1827_stage3_step600.svg
[rank1]:2026-01-02 18:27:30,147 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1827_rank1_stage1.svg
[rank1]:	> Counts Sum: 2835, Total Sum: 3645 (77.78%), Ratio(%) per element: [91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 88.88, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 86.66, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:27:30,137 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1827_rank2_stage2.svg
[rank2]:	> Counts Sum: 2520, Total Sum: 3240 (77.78%), Ratio(%) per element: [91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 75.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:27:30,256 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1827_rank3_stage3.svg
[rank3]:	> Counts Sum: 2007, Total Sum: 2925 (68.62%), Ratio(%) per element: [91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 91.11, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 84.44, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 46.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:27:50,073 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8072e+00
[rank3]:2026-01-02 18:27:50,081 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8506e+00
[rank2]:2026-01-02 18:27:50,073 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8407e+00
[rank0]:2026-01-02 18:27:50,080 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0627e+00
[rank0]:2026-01-02 18:28:12,257 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9101e+00
[rank3]:2026-01-02 18:28:12,257 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2998e+00
[rank1]:2026-01-02 18:28:12,250 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.2764e+00
[rank2]:2026-01-02 18:28:12,250 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1575e+00
[rank0]:2026-01-02 18:28:34,262 - Freezing Ratio: [Stage0] 0.86, Threshold: 9.1586e+00
[rank3]:2026-01-02 18:28:34,260 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0353e+01
[rank1]:2026-01-02 18:28:34,254 - Freezing Ratio: [Stage1] 0.89, Threshold: 9.2382e+00
[rank2]:2026-01-02 18:28:34,253 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.6632e+00
[rank0]:2026-01-02 18:28:56,268 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1804e+00
[rank1]:2026-01-02 18:28:56,260 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5034e+00
[rank3]:2026-01-02 18:28:56,267 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0717e+00
[rank2]:2026-01-02 18:28:56,260 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1168e+00
[rank0]:2026-01-02 18:29:18,241 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2026-01-02 18:29:18,245 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.2598e-01
[rank1]:2026-01-02 18:29:18,218 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7279e-01
[rank3]:2026-01-02 18:29:18,228 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7990e+00
[rank2]:2026-01-02 18:29:18,219 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6774e-01
[rank1]:2026-01-02 18:29:20,445 - Avg. fwd time: 18.3628 / Avg. bwd time: 30.8312 / Avg. batch time: 534.7278 (ms) / GPU bubble ratio: 26.40%
[rank3]:2026-01-02 18:29:20,386 - Avg. fwd time: 16.7406 / Avg. bwd time: 35.6865 / Avg. batch time: 437.0159 (ms) / GPU bubble ratio: 4.03%
[rank2]:2026-01-02 18:29:20,415 - Avg. fwd time: 16.0965 / Avg. bwd time: 27.2591 / Avg. batch time: 482.8944 (ms) / GPU bubble ratio: 28.17%
[rank0]:2026-01-02 18:29:20,481 - Avg. fwd time: 16.5246 / Avg. bwd time: 30.6580 / Avg. batch time: 585.7186 (ms) / GPU bubble ratio: 35.56%
[rank0]:2026-01-02 18:29:20,495 -  step: 650  loss: -4.0000  grad_norm:  1.1355  memory: 74.28GiB(53.13%)  tps: 7,409  tflops: 345.54  mfu: 34.94%
[rank1]:2026-01-02 18:29:20,488 -  step: 650  loss: -4.0000  grad_norm:  1.1355  memory: 72.50GiB(51.86%)  tps: 7,409  tflops: 345.54  mfu: 34.94%
[rank3]:2026-01-02 18:29:20,498 -  step: 650  loss:  0.2657  grad_norm:  1.1355  memory: 79.24GiB(56.67%)  tps: 7,409  tflops: 345.55  mfu: 34.94%
[rank2]:2026-01-02 18:29:20,488 -  step: 650  loss: -4.0000  grad_norm:  1.1355  memory: 64.49GiB(46.13%)  tps: 7,409  tflops: 345.54  mfu: 34.94%
[rank0]:2026-01-02 18:29:40,256 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2652e-01
[rank1]:2026-01-02 18:29:40,248 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1127e-01
[rank3]:2026-01-02 18:29:40,255 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9261e+00
[rank2]:2026-01-02 18:29:40,248 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1717e+00
[rank0]:2026-01-02 18:30:02,389 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4335e+00
[rank1]:2026-01-02 18:30:02,382 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8610e+00
[rank3]:2026-01-02 18:30:02,391 - Freezing Ratio: [Stage3] 0.83, Threshold: 8.6081e-01
[rank2]:2026-01-02 18:30:02,382 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3207e+00
[rank0]:2026-01-02 18:30:24,763 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5170e-01
[rank1]:2026-01-02 18:30:24,756 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.0622e-01
[rank3]:2026-01-02 18:30:24,765 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0779e+00
[rank2]:2026-01-02 18:30:24,756 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0779e-01
[rank0]:2026-01-02 18:30:46,821 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1853e-01
[rank3]:2026-01-02 18:30:46,821 - Freezing Ratio: [Stage3] 0.83, Threshold: 8.9931e-01
[rank1]:2026-01-02 18:30:46,814 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9788e-01
[rank2]:2026-01-02 18:30:46,814 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.6200e-01
[rank2]:2026-01-02 18:31:09,083 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9463e+00
[rank0]:2026-01-02 18:31:09,083 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:31:09,091 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1720e+00
[rank3]:2026-01-02 18:31:09,092 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6452e+00
[rank1]:2026-01-02 18:31:09,083 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9536e+00
[rank3]:2026-01-02 18:31:11,280 - Avg. fwd time: 16.8221 / Avg. bwd time: 35.2749 / Avg. batch time: 434.3348 (ms) / GPU bubble ratio: 4.04%
[rank1]:2026-01-02 18:31:11,340 - Avg. fwd time: 18.4575 / Avg. bwd time: 30.3122 / Avg. batch time: 531.0731 (ms) / GPU bubble ratio: 26.53%
[rank2]:2026-01-02 18:31:11,310 - Avg. fwd time: 16.1761 / Avg. bwd time: 26.8253 / Avg. batch time: 479.7715 (ms) / GPU bubble ratio: 28.30%
[rank2]:2026-01-02 18:31:11,382 -  step: 700  loss: -4.0000  grad_norm:  1.2027  memory: 64.49GiB(46.13%)  tps: 7,387  tflops: 344.54  mfu: 34.84%
[rank0]:2026-01-02 18:31:11,375 - Avg. fwd time: 16.6122 / Avg. bwd time: 30.1584 / Avg. batch time: 581.5104 (ms) / GPU bubble ratio: 35.66%
[rank0]:2026-01-02 18:31:11,389 -  step: 700  loss: -4.0000  grad_norm:  1.2027  memory: 74.28GiB(53.13%)  tps: 7,387  tflops: 344.54  mfu: 34.84%
[rank0]:2026-01-02 18:31:11,447 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1831_stage0_step700.svg
[rank3]:2026-01-02 18:31:11,391 -  step: 700  loss:  0.3471  grad_norm:  1.2027  memory: 79.24GiB(56.67%)  tps: 7,388  tflops: 344.56  mfu: 34.84%
[rank1]:2026-01-02 18:31:11,382 -  step: 700  loss: -4.0000  grad_norm:  1.2027  memory: 72.50GiB(51.86%)  tps: 7,387  tflops: 344.54  mfu: 34.84%
[rank1]:2026-01-02 18:31:11,439 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1831_stage1_step700.svg
[rank2]:2026-01-02 18:31:11,439 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1831_stage2_step700.svg
[rank3]:2026-01-02 18:31:11,524 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1831_step700_rank3.svg
[rank3]:			> Batch Time: 527.98 ms, GPU Bubble Ratio: 37.07%, 34.31%, 41.66%, 27.26%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-36ms     | [S0,MB2,F]  36-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-88ms     | [S0,MB5,F]  88-17-106ms    | [S0,MB6,F]  106-17-124ms   | [S0,MB7,F]  124-17-142ms   | [S0,MB0,B]  293-23-316ms   | [S0,MB1,B]  323-23-346ms   | [S0,MB2,B]  353-23-376ms   | [S0,MB3,B]  383-23-406ms   | [S0,MB4,B]  413-23-437ms   | [S0,MB5,B]  443-23-467ms   | [S0,MB6,B]  473-23-497ms   | [S0,MB7,B]  504-23-527ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  138-19-158ms   | [S1,MB7,F]  158-19-178ms   | [S1,MB0,B]  268-23-292ms   | [S1,MB1,B]  298-23-322ms   | [S1,MB2,B]  328-23-352ms   | [S1,MB3,B]  359-23-382ms   | [S1,MB4,B]  389-23-412ms   | [S1,MB5,B]  419-23-442ms   | [S1,MB6,B]  449-23-472ms   | [S1,MB7,B]  479-23-503ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  78-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-155ms   | [S2,MB6,F]  158-17-175ms   | [S2,MB7,F]  178-17-195ms   | [S2,MB0,B]  247-21-268ms   | [S2,MB1,B]  277-21-298ms   | [S2,MB2,B]  307-21-328ms   | [S2,MB3,B]  337-21-358ms   | [S2,MB4,B]  367-21-388ms   | [S2,MB5,B]  397-21-418ms   | [S2,MB6,B]  427-21-448ms   | [S2,MB7,B]  457-21-479ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  97-17-114ms    | [S3,MB3,F]  116-17-134ms   | [S3,MB4,F]  136-17-154ms   | [S3,MB5,F]  156-17-174ms   | [S3,MB6,F]  176-17-194ms   | [S3,MB7,F]  196-18-214ms   | [S3,MB0,B]  216-29-246ms   | [S3,MB1,B]  246-30-276ms   | [S3,MB2,B]  276-30-306ms   | [S3,MB3,B]  306-30-336ms   | [S3,MB4,B]  336-30-367ms   | [S3,MB5,B]  366-30-397ms   | [S3,MB6,B]  396-30-427ms   | [S3,MB7,B]  426-30-456ms  
[rank3]:2026-01-02 18:31:11,567 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1831_stage3_step700.svg
[rank0]:2026-01-02 18:31:11,643 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1831_rank0_stage0.svg
[rank0]:	> Counts Sum: 2970, Total Sum: 4015 (73.97%), Ratio(%) per element: [0.0, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 54.54, 54.54, 54.54, 54.54, 54.54, 54.54, 54.54, 54.54, 54.54, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:31:11,616 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1831_rank1_stage1.svg
[rank1]:	> Counts Sum: 3555, Total Sum: 4455 (79.80%), Ratio(%) per element: [92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 89.09, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:31:11,613 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1831_rank2_stage2.svg
[rank2]:	> Counts Sum: 3150, Total Sum: 3960 (79.55%), Ratio(%) per element: [92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:31:11,734 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1831_rank3_stage3.svg
[rank3]:	> Counts Sum: 2547, Total Sum: 3575 (71.24%), Ratio(%) per element: [92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 92.72, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 87.27, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 56.36, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:31:31,661 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1803e+00
[rank1]:2026-01-02 18:31:31,654 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6519e+00
[rank3]:2026-01-02 18:31:31,660 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3018e+00
[rank2]:2026-01-02 18:31:31,654 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9512e+00
[rank0]:2026-01-02 18:31:53,682 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5714e+00
[rank3]:2026-01-02 18:31:53,682 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.2276e+00
[rank1]:2026-01-02 18:31:53,674 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6391e+00
[rank2]:2026-01-02 18:31:53,675 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6666e+00
[rank1]:2026-01-02 18:32:15,526 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.0105e+00
[rank3]:2026-01-02 18:32:15,534 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.4853e+00
[rank2]:2026-01-02 18:32:15,526 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3723e+00
[rank0]:2026-01-02 18:32:15,534 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4682e+00
[rank0]:2026-01-02 18:32:37,697 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.9339e-01
[rank3]:2026-01-02 18:32:37,697 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7095e+00
[rank1]:2026-01-02 18:32:37,690 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6723e-01
[rank2]:2026-01-02 18:32:37,690 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1571e-01
[rank0]:2026-01-02 18:32:59,520 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:32:59,523 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4786e+00
[rank1]:2026-01-02 18:32:59,513 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2257e+00
[rank3]:2026-01-02 18:32:59,520 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.2181e-01
[rank2]:2026-01-02 18:32:59,513 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7469e+00
[rank1]:2026-01-02 18:33:01,668 - Avg. fwd time: 18.5351 / Avg. bwd time: 29.8607 / Avg. batch time: 527.8258 (ms) / GPU bubble ratio: 26.65%
[rank3]:2026-01-02 18:33:01,610 - Avg. fwd time: 16.8878 / Avg. bwd time: 34.9133 / Avg. batch time: 431.9329 (ms) / GPU bubble ratio: 4.06%
[rank2]:2026-01-02 18:33:01,638 - Avg. fwd time: 16.2417 / Avg. bwd time: 26.4470 / Avg. batch time: 476.9899 (ms) / GPU bubble ratio: 28.40%
[rank2]:2026-01-02 18:33:01,704 -  step: 750  loss: -4.0000  grad_norm:  0.4366  memory: 64.49GiB(46.13%)  tps: 7,426  tflops: 346.33  mfu: 35.02%
[rank0]:2026-01-02 18:33:01,698 - Avg. fwd time: 16.6840 / Avg. bwd time: 29.7244 / Avg. batch time: 577.7783 (ms) / GPU bubble ratio: 35.74%
[rank0]:2026-01-02 18:33:01,710 -  step: 750  loss: -4.0000  grad_norm:  0.4366  memory: 74.28GiB(53.13%)  tps: 7,426  tflops: 346.33  mfu: 35.02%
[rank1]:2026-01-02 18:33:01,704 -  step: 750  loss: -4.0000  grad_norm:  0.4366  memory: 72.50GiB(51.86%)  tps: 7,426  tflops: 346.33  mfu: 35.02%
[rank3]:2026-01-02 18:33:01,711 -  step: 750  loss:  0.1293  grad_norm:  0.4366  memory: 79.24GiB(56.67%)  tps: 7,426  tflops: 346.34  mfu: 35.02%
[rank1]:2026-01-02 18:33:21,202 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.2211e-01
[rank3]:2026-01-02 18:33:21,211 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9751e+00
[rank2]:2026-01-02 18:33:21,203 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0580e+00
[rank0]:2026-01-02 18:33:21,210 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.6377e+00
[rank0]:2026-01-02 18:33:43,214 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1491e+00
[rank1]:2026-01-02 18:33:43,205 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8786e+00
[rank3]:2026-01-02 18:33:43,212 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.1631e-01
[rank2]:2026-01-02 18:33:43,205 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.8336e-01
[rank0]:2026-01-02 18:34:04,736 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.2638e+00
[rank1]:2026-01-02 18:34:04,729 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3354e+00
[rank3]:2026-01-02 18:34:04,736 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4371e+00
[rank2]:2026-01-02 18:34:04,729 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7449e+00
[rank0]:2026-01-02 18:34:26,166 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5241e+00
[rank1]:2026-01-02 18:34:26,160 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.3752e-01
[rank3]:2026-01-02 18:34:26,167 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2761e+00
[rank2]:2026-01-02 18:34:26,159 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4916e+00
[rank0]:2026-01-02 18:34:47,784 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-02 18:34:47,787 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.4953e+00
[rank3]:2026-01-02 18:34:47,794 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0089e+01
[rank2]:2026-01-02 18:34:47,787 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0105e+01
[rank0]:2026-01-02 18:34:47,793 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.0149e+00
[rank3]:2026-01-02 18:34:49,923 - Avg. fwd time: 16.9345 / Avg. bwd time: 34.5886 / Avg. batch time: 429.6767 (ms) / GPU bubble ratio: 4.07%
[rank1]:2026-01-02 18:34:49,994 - Avg. fwd time: 18.5936 / Avg. bwd time: 29.4623 / Avg. batch time: 524.8011 (ms) / GPU bubble ratio: 26.74%
[rank2]:2026-01-02 18:34:49,956 - Avg. fwd time: 16.2915 / Avg. bwd time: 26.1129 / Avg. batch time: 474.3825 (ms) / GPU bubble ratio: 28.49%
[rank0]:2026-01-02 18:34:50,026 - Avg. fwd time: 16.7367 / Avg. bwd time: 29.3423 / Avg. batch time: 574.3140 (ms) / GPU bubble ratio: 35.81%
[rank0]:2026-01-02 18:34:50,038 -  step: 800  loss: -4.0000  grad_norm:  0.6100  memory: 74.28GiB(53.13%)  tps: 7,562  tflops: 352.70  mfu: 35.66%
[rank3]:2026-01-02 18:34:50,040 -  step: 800  loss:  0.2562  grad_norm:  0.6100  memory: 79.24GiB(56.67%)  tps: 7,562  tflops: 352.71  mfu: 35.66%
[rank1]:2026-01-02 18:34:50,032 -  step: 800  loss: -4.0000  grad_norm:  0.6100  memory: 72.50GiB(51.86%)  tps: 7,562  tflops: 352.70  mfu: 35.66%
[rank1]:2026-01-02 18:34:50,098 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1834_stage1_step800.svg
[rank2]:2026-01-02 18:34:50,032 -  step: 800  loss: -4.0000  grad_norm:  0.6100  memory: 64.49GiB(46.13%)  tps: 7,562  tflops: 352.70  mfu: 35.66%
[rank2]:2026-01-02 18:34:50,091 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1834_stage2_step800.svg
[rank0]:2026-01-02 18:34:50,090 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1834_stage0_step800.svg
[rank3]:2026-01-02 18:34:50,172 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1834_step800_rank3.svg
[rank3]:			> Batch Time: 522.72 ms, GPU Bubble Ratio: 36.86%, 34.12%, 41.52%, 27.28%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB4,F]  70-17-87ms     | [S0,MB5,F]  87-17-105ms    | [S0,MB6,F]  105-17-122ms   | [S0,MB7,F]  122-17-140ms   | [S0,MB0,B]  289-23-312ms   | [S0,MB1,B]  318-23-342ms   | [S0,MB2,B]  348-23-372ms   | [S0,MB3,B]  378-23-402ms   | [S0,MB4,B]  408-23-432ms   | [S0,MB5,B]  438-23-461ms   | [S0,MB6,B]  468-23-491ms   | [S0,MB7,B]  499-23-522ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB3,F]  77-19-96ms     | [S1,MB4,F]  97-19-116ms    | [S1,MB5,F]  116-19-136ms   | [S1,MB6,F]  136-19-156ms   | [S1,MB7,F]  156-19-176ms   | [S1,MB0,B]  265-23-288ms   | [S1,MB1,B]  294-23-318ms   | [S1,MB2,B]  324-23-348ms   | [S1,MB3,B]  354-23-378ms   | [S1,MB4,B]  384-23-407ms   | [S1,MB5,B]  414-23-437ms   | [S1,MB6,B]  444-23-467ms   | [S1,MB7,B]  474-23-498ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  57-17-74ms     | [S2,MB2,F]  77-17-94ms     | [S2,MB3,F]  96-17-113ms    | [S2,MB4,F]  116-17-133ms   | [S2,MB5,F]  136-16-153ms   | [S2,MB6,F]  156-17-173ms   | [S2,MB7,F]  176-17-193ms   | [S2,MB0,B]  243-21-264ms   | [S2,MB1,B]  273-21-294ms   | [S2,MB2,B]  303-21-324ms   | [S2,MB3,B]  332-21-354ms   | [S2,MB4,B]  362-21-384ms   | [S2,MB5,B]  392-21-413ms   | [S2,MB6,B]  422-21-443ms   | [S2,MB7,B]  452-21-474ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-113ms    | [S3,MB3,F]  115-17-132ms   | [S3,MB4,F]  134-17-152ms   | [S3,MB5,F]  154-17-171ms   | [S3,MB6,F]  174-17-191ms   | [S3,MB7,F]  193-17-211ms   | [S3,MB0,B]  213-29-243ms   | [S3,MB1,B]  242-29-272ms   | [S3,MB2,B]  272-30-302ms   | [S3,MB3,B]  302-29-332ms   | [S3,MB4,B]  332-29-362ms   | [S3,MB5,B]  362-29-392ms   | [S3,MB6,B]  391-29-421ms   | [S3,MB7,B]  421-29-451ms  
[rank0]:2026-01-02 18:34:50,269 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1834_rank0_stage0.svg
[rank0]:	> Counts Sum: 3600, Total Sum: 4745 (75.87%), Ratio(%) per element: [0.0, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 61.53, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:34:50,286 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1834_rank1_stage1.svg
[rank1]:	> Counts Sum: 4275, Total Sum: 5265 (81.20%), Ratio(%) per element: [93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 92.3, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 90.76, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:34:50,216 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1834_stage3_step800.svg
[rank2]:2026-01-02 18:34:50,273 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1834_rank2_stage2.svg
[rank2]:	> Counts Sum: 3780, Total Sum: 4680 (80.77%), Ratio(%) per element: [93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 83.07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:34:50,381 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1834_rank3_stage3.svg
[rank3]:	> Counts Sum: 3087, Total Sum: 4225 (73.07%), Ratio(%) per element: [93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 93.84, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 89.23, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 63.07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:35:10,150 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2490e+00
[rank0]:2026-01-02 18:35:10,157 - Freezing Ratio: [Stage0] 0.86, Threshold: 9.7673e-01
[rank3]:2026-01-02 18:35:10,156 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.5802e-01
[rank1]:2026-01-02 18:35:10,150 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6478e+00
[rank0]:2026-01-02 18:35:32,215 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0415e+00
[rank3]:2026-01-02 18:35:32,214 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9043e+00
[rank1]:2026-01-02 18:35:32,207 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6231e+00
[rank2]:2026-01-02 18:35:32,207 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6906e+00
[rank2]:2026-01-02 18:35:54,268 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7011e+00
[rank0]:2026-01-02 18:35:54,276 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5071e+00
[rank3]:2026-01-02 18:35:54,276 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1436e+00
[rank1]:2026-01-02 18:35:54,269 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6510e+00
[rank2]:2026-01-02 18:36:15,509 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6934e+00
[rank0]:2026-01-02 18:36:15,516 - Freezing Ratio: [Stage0] 0.86, Threshold: 9.3359e-01
[rank3]:2026-01-02 18:36:15,516 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8722e+00
[rank1]:2026-01-02 18:36:15,509 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5687e+00
[rank2]:2026-01-02 18:36:36,936 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4598e+00
[rank0]:2026-01-02 18:36:36,959 - [GC] Peforming periodical GC collection 0.03 seconds
[rank0]:2026-01-02 18:36:36,962 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.0771e-01
[rank3]:2026-01-02 18:36:36,945 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1770e-01
[rank1]:2026-01-02 18:36:36,935 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7063e+00
[rank3]:2026-01-02 18:36:39,034 - Avg. fwd time: 16.9791 / Avg. bwd time: 34.3036 / Avg. batch time: 427.7251 (ms) / GPU bubble ratio: 4.08%
[rank1]:2026-01-02 18:36:39,098 - Avg. fwd time: 18.6488 / Avg. bwd time: 29.1114 / Avg. batch time: 522.1920 (ms) / GPU bubble ratio: 26.83%
[rank2]:2026-01-02 18:36:39,066 - Avg. fwd time: 16.3380 / Avg. bwd time: 25.8182 / Avg. batch time: 472.1378 (ms) / GPU bubble ratio: 28.57%
[rank2]:2026-01-02 18:36:39,136 -  step: 850  loss: -4.0000  grad_norm:  0.3476  memory: 64.49GiB(46.13%)  tps: 7,508  tflops: 350.20  mfu: 35.41%
[rank0]:2026-01-02 18:36:39,130 - Avg. fwd time: 16.7874 / Avg. bwd time: 29.0054 / Avg. batch time: 571.3249 (ms) / GPU bubble ratio: 35.88%
[rank0]:2026-01-02 18:36:39,142 -  step: 850  loss: -4.0000  grad_norm:  0.3476  memory: 74.28GiB(53.13%)  tps: 7,508  tflops: 350.20  mfu: 35.41%
[rank3]:2026-01-02 18:36:39,144 -  step: 850  loss:  0.1233  grad_norm:  0.3476  memory: 79.24GiB(56.67%)  tps: 7,509  tflops: 350.20  mfu: 35.41%
[rank1]:2026-01-02 18:36:39,136 -  step: 850  loss: -4.0000  grad_norm:  0.3476  memory: 72.50GiB(51.86%)  tps: 7,508  tflops: 350.20  mfu: 35.41%
[rank2]:2026-01-02 18:36:58,430 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.5454e+00
[rank0]:2026-01-02 18:36:58,437 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5405e-01
[rank3]:2026-01-02 18:36:58,438 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5747e+00
[rank1]:2026-01-02 18:36:58,431 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0028e+00
[rank2]:2026-01-02 18:37:19,659 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.0906e+00
[rank0]:2026-01-02 18:37:19,666 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4782e+00
[rank3]:2026-01-02 18:37:19,666 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5649e+00
[rank1]:2026-01-02 18:37:19,659 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.3880e+00
[rank0]:2026-01-02 18:37:40,842 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7384e+00
[rank3]:2026-01-02 18:37:40,843 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6319e+00
[rank1]:2026-01-02 18:37:40,835 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8105e+00
[rank2]:2026-01-02 18:37:40,835 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.7876e+00
[rank0]:2026-01-02 18:38:02,180 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3724e+00
[rank3]:2026-01-02 18:38:02,181 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2078e+00
[rank1]:2026-01-02 18:38:02,173 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.8759e-01
[rank2]:2026-01-02 18:38:02,173 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8614e+00
[rank2]:2026-01-02 18:38:23,645 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8506e+00
[rank0]:2026-01-02 18:38:23,642 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:38:23,652 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.0493e-01
[rank1]:2026-01-02 18:38:23,644 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7685e+00
[rank3]:2026-01-02 18:38:23,653 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7661e+00
[rank3]:2026-01-02 18:38:25,737 - Avg. fwd time: 17.0072 / Avg. bwd time: 34.0399 / Avg. batch time: 425.8145 (ms) / GPU bubble ratio: 4.10%
[rank1]:2026-01-02 18:38:25,807 - Avg. fwd time: 18.6878 / Avg. bwd time: 28.7958 / Avg. batch time: 519.6601 (ms) / GPU bubble ratio: 26.90%
[rank2]:2026-01-02 18:38:25,771 - Avg. fwd time: 16.3708 / Avg. bwd time: 25.5516 / Avg. batch time: 469.9410 (ms) / GPU bubble ratio: 28.63%
[rank2]:2026-01-02 18:38:25,850 -  step: 900  loss: -4.0000  grad_norm:  0.4829  memory: 64.49GiB(46.13%)  tps: 7,677  tflops: 358.04  mfu: 36.20%
[rank0]:2026-01-02 18:38:25,843 - Avg. fwd time: 16.8218 / Avg. bwd time: 28.7037 / Avg. batch time: 568.4363 (ms) / GPU bubble ratio: 35.93%
[rank0]:2026-01-02 18:38:25,856 -  step: 900  loss: -4.0000  grad_norm:  0.4829  memory: 74.28GiB(53.13%)  tps: 7,677  tflops: 358.04  mfu: 36.20%
[rank3]:2026-01-02 18:38:25,857 -  step: 900  loss:  0.1866  grad_norm:  0.4829  memory: 79.24GiB(56.67%)  tps: 7,677  tflops: 358.05  mfu: 36.20%
[rank1]:2026-01-02 18:38:25,850 -  step: 900  loss: -4.0000  grad_norm:  0.4829  memory: 72.50GiB(51.86%)  tps: 7,677  tflops: 358.04  mfu: 36.20%
[rank1]:2026-01-02 18:38:25,906 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1838_stage1_step900.svg
[rank2]:2026-01-02 18:38:25,905 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1838_stage2_step900.svg
[rank0]:2026-01-02 18:38:25,907 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1838_stage0_step900.svg
[rank3]:2026-01-02 18:38:25,985 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1838_step900_rank3.svg
[rank3]:			> Batch Time: 521.39 ms, GPU Bubble Ratio: 36.85%, 34.03%, 41.54%, 27.37%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB4,F]  70-17-87ms     | [S0,MB5,F]  87-17-105ms    | [S0,MB6,F]  105-17-122ms   | [S0,MB7,F]  122-17-140ms   | [S0,MB0,B]  287-23-311ms   | [S0,MB1,B]  318-23-341ms   | [S0,MB2,B]  348-23-371ms   | [S0,MB3,B]  377-23-401ms   | [S0,MB4,B]  407-23-431ms   | [S0,MB5,B]  437-23-460ms   | [S0,MB6,B]  467-23-490ms   | [S0,MB7,B]  497-23-521ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB3,F]  77-19-96ms     | [S1,MB4,F]  97-19-116ms    | [S1,MB5,F]  116-19-136ms   | [S1,MB6,F]  136-19-156ms   | [S1,MB7,F]  156-19-176ms   | [S1,MB0,B]  263-23-287ms   | [S1,MB1,B]  294-23-317ms   | [S1,MB2,B]  323-23-347ms   | [S1,MB3,B]  353-23-377ms   | [S1,MB4,B]  383-23-406ms   | [S1,MB5,B]  413-23-436ms   | [S1,MB6,B]  442-23-466ms   | [S1,MB7,B]  473-23-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-55ms     | [S2,MB1,F]  57-16-74ms     | [S2,MB2,F]  77-16-94ms     | [S2,MB3,F]  96-16-113ms    | [S2,MB4,F]  116-16-133ms   | [S2,MB5,F]  136-16-153ms   | [S2,MB6,F]  156-16-173ms   | [S2,MB7,F]  176-17-193ms   | [S2,MB0,B]  242-21-263ms   | [S2,MB1,B]  272-21-293ms   | [S2,MB2,B]  302-21-323ms   | [S2,MB3,B]  332-21-353ms   | [S2,MB4,B]  361-21-382ms   | [S2,MB5,B]  391-21-412ms   | [S2,MB6,B]  421-21-442ms   | [S2,MB7,B]  451-21-472ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-112ms    | [S3,MB3,F]  115-17-132ms   | [S3,MB4,F]  134-17-151ms   | [S3,MB5,F]  154-17-171ms   | [S3,MB6,F]  174-17-191ms   | [S3,MB7,F]  193-17-211ms   | [S3,MB0,B]  213-29-243ms   | [S3,MB1,B]  241-29-271ms   | [S3,MB2,B]  271-29-301ms   | [S3,MB3,B]  301-29-331ms   | [S3,MB4,B]  331-29-361ms   | [S3,MB5,B]  361-29-391ms   | [S3,MB6,B]  391-29-420ms   | [S3,MB7,B]  420-29-450ms  
[rank0]:2026-01-02 18:38:26,089 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1838_rank0_stage0.svg
[rank0]:	> Counts Sum: 4230, Total Sum: 5475 (77.26%), Ratio(%) per element: [0.0, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 66.66, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:38:26,023 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1838_stage3_step900.svg
[rank1]:2026-01-02 18:38:26,089 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1838_rank1_stage1.svg
[rank1]:	> Counts Sum: 4995, Total Sum: 6075 (82.22%), Ratio(%) per element: [94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 92.0, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:38:26,081 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1838_rank2_stage2.svg
[rank2]:	> Counts Sum: 4410, Total Sum: 5400 (81.67%), Ratio(%) per element: [94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 85.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:38:26,183 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1838_rank3_stage3.svg
[rank3]:	> Counts Sum: 3627, Total Sum: 4875 (74.40%), Ratio(%) per element: [94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 94.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 90.66, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:38:45,507 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5968e+00
[rank3]:2026-01-02 18:38:45,506 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1773e+00
[rank1]:2026-01-02 18:38:45,499 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.9170e+00
[rank2]:2026-01-02 18:38:45,499 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.1328e+00
[rank0]:2026-01-02 18:39:07,123 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5757e+00
[rank3]:2026-01-02 18:39:07,123 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6479e-01
[rank1]:2026-01-02 18:39:07,116 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.2365e-01
[rank2]:2026-01-02 18:39:07,116 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.6175e-01
[rank2]:2026-01-02 18:39:28,622 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1663e+00
[rank0]:2026-01-02 18:39:28,631 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.8798e+00
[rank3]:2026-01-02 18:39:28,630 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2400e+00
[rank1]:2026-01-02 18:39:28,623 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0705e+00
[rank2]:2026-01-02 18:39:50,330 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5841e+00
[rank0]:2026-01-02 18:39:50,338 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3045e+00
[rank3]:2026-01-02 18:39:50,339 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7428e+00
[rank1]:2026-01-02 18:39:50,330 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8750e+00
[rank2]:2026-01-02 18:40:12,221 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2361e+00
[rank0]:2026-01-02 18:40:12,232 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:40:12,235 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5348e+00
[rank1]:2026-01-02 18:40:12,221 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.1140e+00
[rank3]:2026-01-02 18:40:12,228 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3196e+00
[rank2]:2026-01-02 18:40:14,367 - Avg. fwd time: 16.4066 / Avg. bwd time: 25.3167 / Avg. batch time: 468.1211 (ms) / GPU bubble ratio: 28.70%
[rank1]:2026-01-02 18:40:14,398 - Avg. fwd time: 18.7303 / Avg. bwd time: 28.5164 / Avg. batch time: 517.5464 (ms) / GPU bubble ratio: 26.97%
[rank3]:2026-01-02 18:40:14,339 - Avg. fwd time: 17.0409 / Avg. bwd time: 33.8113 / Avg. batch time: 424.2332 (ms) / GPU bubble ratio: 4.11%
[rank2]:2026-01-02 18:40:14,440 -  step: 950  loss: -4.0000  grad_norm:  3.0870  memory: 64.49GiB(46.13%)  tps: 7,544  tflops: 351.85  mfu: 35.58%
[rank0]:2026-01-02 18:40:14,433 - Avg. fwd time: 16.8609 / Avg. bwd time: 28.4351 / Avg. batch time: 566.0188 (ms) / GPU bubble ratio: 35.98%
[rank0]:2026-01-02 18:40:14,446 -  step: 950  loss: -4.0000  grad_norm:  3.0870  memory: 74.28GiB(53.13%)  tps: 7,544  tflops: 351.85  mfu: 35.58%
[rank1]:2026-01-02 18:40:14,439 -  step: 950  loss: -4.0000  grad_norm:  3.0870  memory: 72.50GiB(51.86%)  tps: 7,544  tflops: 351.85  mfu: 35.58%
[rank3]:2026-01-02 18:40:14,447 -  step: 950  loss:  0.2382  grad_norm:  3.0870  memory: 79.24GiB(56.67%)  tps: 7,544  tflops: 351.86  mfu: 35.58%
[rank0]:2026-01-02 18:40:34,115 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.5565e-01
[rank3]:2026-01-02 18:40:34,116 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.3089e-01
[rank1]:2026-01-02 18:40:34,108 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.4069e-01
[rank2]:2026-01-02 18:40:34,108 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2439e+00
[rank2]:2026-01-02 18:40:56,008 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.6185e-01
[rank0]:2026-01-02 18:40:56,015 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6294e-01
[rank3]:2026-01-02 18:40:56,016 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0374e+00
[rank1]:2026-01-02 18:40:56,008 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1463e+00
[rank2]:2026-01-02 18:41:17,700 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.4204e+00
[rank0]:2026-01-02 18:41:17,707 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.1489e+00
[rank1]:2026-01-02 18:41:17,700 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.1554e+00
[rank3]:2026-01-02 18:41:17,707 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4060e+00
[rank3]:2026-01-02 18:41:39,000 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1987e+00
[rank1]:2026-01-02 18:41:38,991 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7398e+00
[rank2]:2026-01-02 18:41:38,992 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2946e+00
[rank0]:2026-01-02 18:41:38,998 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5692e+00
[rank2]:2026-01-02 18:42:00,738 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9376e+00
[rank0]:2026-01-02 18:42:00,735 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:42:00,745 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3840e+00
[rank1]:2026-01-02 18:42:00,738 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5434e+00
[rank3]:2026-01-02 18:42:00,745 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2558e+00
[rank3]:2026-01-02 18:42:02,823 - Avg. fwd time: 17.0741 / Avg. bwd time: 33.6084 / Avg. batch time: 422.8558 (ms) / GPU bubble ratio: 4.11%
[rank2]:2026-01-02 18:42:02,854 - Avg. fwd time: 16.4404 / Avg. bwd time: 25.1063 / Avg. batch time: 466.5246 (ms) / GPU bubble ratio: 28.76%
[rank1]:2026-01-02 18:42:02,885 - Avg. fwd time: 18.7704 / Avg. bwd time: 28.2663 / Avg. batch time: 515.6898 (ms) / GPU bubble ratio: 27.03%
[rank1]:2026-01-02 18:42:02,924 -  step: 1000  loss: -4.0000  grad_norm:  0.5175  memory: 72.50GiB(51.86%)  tps: 7,551  tflops: 352.20  mfu: 35.61%
[rank1]:2026-01-02 18:42:02,924 - Saving the checkpoint (or staging if async is enabled).
[rank3]:2026-01-02 18:42:02,932 -  step: 1000  loss:  0.1648  grad_norm:  0.5175  memory: 79.24GiB(56.67%)  tps: 7,551  tflops: 352.20  mfu: 35.61%
[rank3]:2026-01-02 18:42:02,932 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 18:42:02,924 -  step: 1000  loss: -4.0000  grad_norm:  0.5175  memory: 64.49GiB(46.13%)  tps: 7,551  tflops: 352.20  mfu: 35.61%
[rank2]:2026-01-02 18:42:02,924 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 18:42:02,918 - Avg. fwd time: 16.8964 / Avg. bwd time: 28.1947 / Avg. batch time: 563.8819 (ms) / GPU bubble ratio: 36.03%
[rank0]:2026-01-02 18:42:02,930 -  step: 1000  loss: -4.0000  grad_norm:  0.5175  memory: 74.28GiB(53.13%)  tps: 7,551  tflops: 352.20  mfu: 35.61%
[rank0]:2026-01-02 18:42:02,930 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 18:42:02,930 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-02 18:42:15,021 - Finished saving the checkpoint (or staging if async is enabled)in 12.10 seconds.
[rank1]:2026-01-02 18:42:16,441 - Finished saving the checkpoint (or staging if async is enabled)in 13.52 seconds.
[rank3]:2026-01-02 18:42:16,974 - Finished saving the checkpoint (or staging if async is enabled)in 14.04 seconds.
[rank0]:2026-01-02 18:42:18,509 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank0]:2026-01-02 18:42:18,512 - Finished saving the checkpoint (or staging if async is enabled)in 15.58 seconds.
[rank2]:2026-01-02 18:42:18,567 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1842_stage2_step1000.svg
[rank0]:2026-01-02 18:42:18,606 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1842_stage0_step1000.svg
[rank1]:2026-01-02 18:42:18,563 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1842_stage1_step1000.svg
[rank3]:2026-01-02 18:42:18,648 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1842_step1000_rank3.svg
[rank3]:			> Batch Time: 523.17 ms, GPU Bubble Ratio: 36.88%, 34.10%, 41.57%, 27.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB4,F]  70-17-88ms     | [S0,MB5,F]  88-17-105ms    | [S0,MB6,F]  105-17-123ms   | [S0,MB7,F]  123-17-141ms   | [S0,MB0,B]  289-23-313ms   | [S0,MB1,B]  319-23-343ms   | [S0,MB2,B]  349-23-373ms   | [S0,MB3,B]  379-23-402ms   | [S0,MB4,B]  409-23-432ms   | [S0,MB5,B]  439-23-462ms   | [S0,MB6,B]  468-23-492ms   | [S0,MB7,B]  499-23-523ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB3,F]  77-19-97ms     | [S1,MB4,F]  97-19-117ms    | [S1,MB5,F]  117-19-137ms   | [S1,MB6,F]  137-19-157ms   | [S1,MB7,F]  157-19-176ms   | [S1,MB0,B]  265-23-288ms   | [S1,MB1,B]  295-23-319ms   | [S1,MB2,B]  325-23-348ms   | [S1,MB3,B]  355-23-378ms   | [S1,MB4,B]  384-23-408ms   | [S1,MB5,B]  414-23-438ms   | [S1,MB6,B]  444-23-467ms   | [S1,MB7,B]  474-23-498ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  57-17-74ms     | [S2,MB2,F]  77-17-94ms     | [S2,MB3,F]  97-17-114ms    | [S2,MB4,F]  117-17-134ms   | [S2,MB5,F]  137-17-154ms   | [S2,MB6,F]  156-17-173ms   | [S2,MB7,F]  176-17-193ms   | [S2,MB0,B]  244-21-265ms   | [S2,MB1,B]  274-21-295ms   | [S2,MB2,B]  303-21-325ms   | [S2,MB3,B]  333-21-354ms   | [S2,MB4,B]  363-21-384ms   | [S2,MB5,B]  392-21-414ms   | [S2,MB6,B]  422-21-443ms   | [S2,MB7,B]  452-21-473ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  96-17-113ms    | [S3,MB3,F]  115-17-133ms   | [S3,MB4,F]  135-17-152ms   | [S3,MB5,F]  154-17-172ms   | [S3,MB6,F]  174-17-192ms   | [S3,MB7,F]  194-17-212ms   | [S3,MB0,B]  214-29-243ms   | [S3,MB1,B]  243-29-273ms   | [S3,MB2,B]  273-29-303ms   | [S3,MB3,B]  303-29-332ms   | [S3,MB4,B]  332-29-362ms   | [S3,MB5,B]  362-29-392ms   | [S3,MB6,B]  392-29-422ms   | [S3,MB7,B]  422-29-451ms  
[rank3]:2026-01-02 18:42:18,687 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1842_stage3_step1000.svg
[rank2]:2026-01-02 18:42:18,792 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1842_rank2_stage2.svg
[rank2]:	> Counts Sum: 5040, Total Sum: 6120 (82.35%), Ratio(%) per element: [95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:42:18,797 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1842_rank1_stage1.svg
[rank1]:	> Counts Sum: 5715, Total Sum: 6885 (83.01%), Ratio(%) per element: [95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 92.94, 92.94, 92.94, 92.94, 92.94, 92.94, 92.94, 92.94, 92.94, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 87.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:42:18,891 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1842_rank0_stage0.svg
[rank0]:	> Counts Sum: 4860, Total Sum: 6205 (78.32%), Ratio(%) per element: [0.0, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 94.11, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 70.58, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:42:18,939 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1842_rank3_stage3.svg
[rank3]:	> Counts Sum: 4167, Total Sum: 5525 (75.42%), Ratio(%) per element: [95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 95.29, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 91.76, 71.76, 71.76, 71.76, 71.76, 71.76, 71.76, 71.76, 71.76, 71.76, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:42:39,001 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5707e+00
[rank0]:2026-01-02 18:42:39,009 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5432e+00
[rank1]:2026-01-02 18:42:39,002 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0059e+00
[rank3]:2026-01-02 18:42:39,008 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.6100e+00
[rank2]:2026-01-02 18:43:00,339 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7896e+01
[rank0]:2026-01-02 18:43:00,347 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7575e+01
[rank1]:2026-01-02 18:43:00,339 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5908e+01
[rank3]:2026-01-02 18:43:00,347 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5601e+01
[rank2]:2026-01-02 18:43:21,610 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.4443e+00
[rank0]:2026-01-02 18:43:21,618 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.8871e+00
[rank1]:2026-01-02 18:43:21,611 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.9713e+00
[rank3]:2026-01-02 18:43:21,617 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.9399e+00
[rank2]:2026-01-02 18:43:43,448 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.6621e+00
[rank0]:2026-01-02 18:43:43,455 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.2593e+00
[rank1]:2026-01-02 18:43:43,448 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.7795e+00
[rank3]:2026-01-02 18:43:43,456 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.2732e+00
[rank2]:2026-01-02 18:44:07,195 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3287e+00
[rank1]:2026-01-02 18:44:07,192 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.2891e+00
[rank3]:2026-01-02 18:44:07,406 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3083e+00
[rank0]:2026-01-02 18:44:07,582 - [GC] Peforming periodical GC collection 2.17 seconds
[rank0]:2026-01-02 18:44:07,586 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2328e+00
[rank2]:2026-01-02 18:44:09,812 - Avg. fwd time: 16.4674 / Avg. bwd time: 24.9135 / Avg. batch time: 465.1451 (ms) / GPU bubble ratio: 28.83%
[rank1]:2026-01-02 18:44:09,850 - Avg. fwd time: 18.8018 / Avg. bwd time: 28.0378 / Avg. batch time: 514.0695 (ms) / GPU bubble ratio: 27.11%
[rank3]:2026-01-02 18:44:09,777 - Avg. fwd time: 17.0997 / Avg. bwd time: 33.4180 / Avg. batch time: 421.6804 (ms) / GPU bubble ratio: 4.16%
[rank2]:2026-01-02 18:44:09,890 -  step: 1050  loss: -4.0000  grad_norm:  0.7853  memory: 64.49GiB(46.13%)  tps: 6,452  tflops: 300.93  mfu: 30.43%
[rank0]:2026-01-02 18:44:09,884 - Avg. fwd time: 16.9246 / Avg. bwd time: 27.9740 / Avg. batch time: 562.0161 (ms) / GPU bubble ratio: 36.09%
[rank0]:2026-01-02 18:44:09,897 -  step: 1050  loss: -4.0000  grad_norm:  0.7853  memory: 74.28GiB(53.13%)  tps: 6,452  tflops: 300.93  mfu: 30.43%
[rank1]:2026-01-02 18:44:09,890 -  step: 1050  loss: -4.0000  grad_norm:  0.7853  memory: 72.50GiB(51.86%)  tps: 6,452  tflops: 300.93  mfu: 30.43%
[rank3]:2026-01-02 18:44:09,901 -  step: 1050  loss:  0.2689  grad_norm:  0.7853  memory: 79.24GiB(56.67%)  tps: 6,452  tflops: 300.93  mfu: 30.43%
[rank0]:2026-01-02 18:44:29,846 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4530e+00
[rank1]:2026-01-02 18:44:29,839 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.4226e-01
[rank3]:2026-01-02 18:44:29,845 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6433e+00
[rank2]:2026-01-02 18:44:29,838 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1239e+00
[rank0]:2026-01-02 18:44:51,972 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4145e+00
[rank3]:2026-01-02 18:44:51,973 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4923e-01
[rank1]:2026-01-02 18:44:51,964 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4671e+00
[rank2]:2026-01-02 18:44:51,964 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2175e+00
[rank2]:2026-01-02 18:45:14,294 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2074e+00
[rank3]:2026-01-02 18:45:14,303 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4751e+00
[rank1]:2026-01-02 18:45:14,294 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.1701e+00
[rank0]:2026-01-02 18:45:14,302 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6829e+00
[rank0]:2026-01-02 18:45:36,368 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1561e+00
[rank2]:2026-01-02 18:45:36,361 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.8258e+00
[rank1]:2026-01-02 18:45:36,360 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3354e+00
[rank3]:2026-01-02 18:45:36,368 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3362e+00
[rank0]:2026-01-02 18:45:58,503 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:45:58,512 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.0400e+00
[rank2]:2026-01-02 18:45:58,505 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4242e+00
[rank1]:2026-01-02 18:45:58,504 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6328e+00
[rank3]:2026-01-02 18:45:58,513 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.1906e+00
[rank3]:2026-01-02 18:46:00,645 - Avg. fwd time: 17.1399 / Avg. bwd time: 33.2616 / Avg. batch time: 420.7294 (ms) / GPU bubble ratio: 4.16%
[rank2]:2026-01-02 18:46:00,683 - Avg. fwd time: 16.5049 / Avg. bwd time: 24.7449 / Avg. batch time: 464.0280 (ms) / GPU bubble ratio: 28.88%
[rank3]:2026-01-02 18:46:00,767 -  step: 1100  loss:  0.2243  grad_norm:  0.5354  memory: 79.24GiB(56.67%)  tps: 7,389  tflops: 344.64  mfu: 34.85%
[rank1]:2026-01-02 18:46:00,715 - Avg. fwd time: 18.8462 / Avg. bwd time: 27.8361 / Avg. batch time: 512.7537 (ms) / GPU bubble ratio: 27.17%
[rank1]:2026-01-02 18:46:00,759 -  step: 1100  loss: -4.0000  grad_norm:  0.5354  memory: 72.50GiB(51.86%)  tps: 7,389  tflops: 344.62  mfu: 34.85%
[rank0]:2026-01-02 18:46:00,752 - Avg. fwd time: 16.9646 / Avg. bwd time: 27.7783 / Avg. batch time: 560.4846 (ms) / GPU bubble ratio: 36.14%
[rank0]:2026-01-02 18:46:00,765 -  step: 1100  loss: -4.0000  grad_norm:  0.5354  memory: 74.28GiB(53.13%)  tps: 7,389  tflops: 344.62  mfu: 34.85%
[rank0]:2026-01-02 18:46:00,818 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1846_stage0_step1100.svg
[rank2]:2026-01-02 18:46:00,759 -  step: 1100  loss: -4.0000  grad_norm:  0.5354  memory: 64.49GiB(46.13%)  tps: 7,389  tflops: 344.62  mfu: 34.85%
[rank2]:2026-01-02 18:46:00,819 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1846_stage2_step1100.svg
[rank1]:2026-01-02 18:46:00,814 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1846_stage1_step1100.svg
[rank3]:2026-01-02 18:46:00,900 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1846_step1100_rank3.svg
[rank3]:			> Batch Time: 529.53 ms, GPU Bubble Ratio: 37.12%, 34.26%, 41.66%, 27.24%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-36ms     | [S0,MB2,F]  36-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-89ms     | [S0,MB5,F]  89-17-107ms    | [S0,MB6,F]  107-17-124ms   | [S0,MB7,F]  125-17-143ms   | [S0,MB0,B]  293-23-317ms   | [S0,MB1,B]  324-23-347ms   | [S0,MB2,B]  354-23-377ms   | [S0,MB3,B]  384-23-408ms   | [S0,MB4,B]  414-23-438ms   | [S0,MB5,B]  444-23-468ms   | [S0,MB6,B]  474-23-498ms   | [S0,MB7,B]  505-23-529ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  139-20-159ms   | [S1,MB7,F]  159-20-179ms   | [S1,MB0,B]  269-23-293ms   | [S1,MB1,B]  299-23-323ms   | [S1,MB2,B]  329-23-353ms   | [S1,MB3,B]  360-23-384ms   | [S1,MB4,B]  390-23-414ms   | [S1,MB5,B]  420-23-444ms   | [S1,MB6,B]  450-23-474ms   | [S1,MB7,B]  481-23-504ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  78-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-156ms   | [S2,MB6,F]  159-17-176ms   | [S2,MB7,F]  179-17-196ms   | [S2,MB0,B]  248-21-269ms   | [S2,MB1,B]  278-21-299ms   | [S2,MB2,B]  308-21-329ms   | [S2,MB3,B]  338-21-359ms   | [S2,MB4,B]  368-21-390ms   | [S2,MB5,B]  398-21-420ms   | [S2,MB6,B]  428-21-450ms   | [S2,MB7,B]  459-21-480ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-17-95ms     | [S3,MB2,F]  97-17-115ms    | [S3,MB3,F]  117-17-135ms   | [S3,MB4,F]  137-17-155ms   | [S3,MB5,F]  157-18-175ms   | [S3,MB6,F]  177-17-195ms   | [S3,MB7,F]  197-18-216ms   | [S3,MB0,B]  218-30-248ms   | [S3,MB1,B]  247-30-277ms   | [S3,MB2,B]  277-30-308ms   | [S3,MB3,B]  307-30-337ms   | [S3,MB4,B]  338-30-368ms   | [S3,MB5,B]  368-30-398ms   | [S3,MB6,B]  398-30-428ms   | [S3,MB7,B]  428-30-458ms  
[rank3]:2026-01-02 18:46:00,940 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1846_stage3_step1100.svg
[rank0]:2026-01-02 18:46:01,003 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1846_rank0_stage0.svg
[rank0]:	> Counts Sum: 5490, Total Sum: 6935 (79.16%), Ratio(%) per element: [0.0, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 73.68, 73.68, 73.68, 73.68, 73.68, 73.68, 73.68, 73.68, 73.68, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:46:00,999 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1846_rank2_stage2.svg
[rank2]:	> Counts Sum: 5670, Total Sum: 6840 (82.89%), Ratio(%) per element: [95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:46:00,996 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1846_rank1_stage1.svg
[rank1]:	> Counts Sum: 6435, Total Sum: 7695 (83.63%), Ratio(%) per element: [95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 94.73, 93.68, 93.68, 93.68, 93.68, 93.68, 93.68, 93.68, 93.68, 93.68, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 88.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:46:01,103 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1846_rank3_stage3.svg
[rank3]:	> Counts Sum: 4707, Total Sum: 6175 (76.23%), Ratio(%) per element: [95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 95.78, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 92.63, 74.73, 74.73, 74.73, 74.73, 74.73, 74.73, 74.73, 74.73, 74.73, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:46:20,724 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.0661e+00
[rank2]:2026-01-02 18:46:20,717 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.3311e+00
[rank3]:2026-01-02 18:46:20,724 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.1009e+00
[rank1]:2026-01-02 18:46:20,717 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.7911e+00
[rank0]:2026-01-02 18:46:42,728 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7974e-01
[rank2]:2026-01-02 18:46:42,721 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0923e+00
[rank1]:2026-01-02 18:46:42,721 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1898e+00
[rank3]:2026-01-02 18:46:42,728 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2179e+00
[rank1]:2026-01-02 18:47:04,424 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8733e+00
[rank0]:2026-01-02 18:47:04,431 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.7406e+00
[rank2]:2026-01-02 18:47:04,424 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7647e+00
[rank3]:2026-01-02 18:47:04,431 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.2690e+00
[rank0]:2026-01-02 18:47:25,973 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5122e+00
[rank2]:2026-01-02 18:47:25,965 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.5668e+00
[rank1]:2026-01-02 18:47:25,965 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.7863e+00
[rank3]:2026-01-02 18:47:25,974 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.4346e+00
[rank2]:2026-01-02 18:47:47,642 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.5978e+00
[rank3]:2026-01-02 18:47:47,648 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6809e+00
[rank1]:2026-01-02 18:47:47,641 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2864e+00
[rank0]:2026-01-02 18:47:47,649 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:47:47,652 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0772e+00
[rank3]:2026-01-02 18:47:49,743 - Avg. fwd time: 17.1655 / Avg. bwd time: 33.1096 / Avg. batch time: 419.6982 (ms) / GPU bubble ratio: 4.17%
[rank0]:2026-01-02 18:47:49,845 - Avg. fwd time: 16.9921 / Avg. bwd time: 27.5976 / Avg. batch time: 558.8969 (ms) / GPU bubble ratio: 36.17%
[rank2]:2026-01-02 18:47:49,780 - Avg. fwd time: 16.5311 / Avg. bwd time: 24.5875 / Avg. batch time: 462.8423 (ms) / GPU bubble ratio: 28.93%
[rank2]:2026-01-02 18:47:49,851 -  step: 1150  loss: -4.0000  grad_norm:  0.5161  memory: 64.49GiB(46.13%)  tps: 7,509  tflops: 350.23  mfu: 35.41%
[rank3]:2026-01-02 18:47:49,860 -  step: 1150  loss:  0.2075  grad_norm:  0.5161  memory: 79.24GiB(56.67%)  tps: 7,509  tflops: 350.24  mfu: 35.41%
[rank1]:2026-01-02 18:47:49,811 - Avg. fwd time: 18.8769 / Avg. bwd time: 27.6483 / Avg. batch time: 511.3736 (ms) / GPU bubble ratio: 27.22%
[rank1]:2026-01-02 18:47:49,851 -  step: 1150  loss: -4.0000  grad_norm:  0.5161  memory: 72.50GiB(51.86%)  tps: 7,509  tflops: 350.23  mfu: 35.41%
[rank0]:2026-01-02 18:47:49,857 -  step: 1150  loss: -4.0000  grad_norm:  0.5161  memory: 74.28GiB(53.13%)  tps: 7,509  tflops: 350.23  mfu: 35.41%
[rank1]:2026-01-02 18:48:09,585 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3045e+00
[rank0]:2026-01-02 18:48:09,593 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.1742e+00
[rank2]:2026-01-02 18:48:09,586 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.5912e+00
[rank3]:2026-01-02 18:48:09,594 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7064e+00
[rank2]:2026-01-02 18:48:31,295 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6644e+00
[rank3]:2026-01-02 18:48:31,305 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4059e+00
[rank1]:2026-01-02 18:48:31,295 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8962e+00
[rank0]:2026-01-02 18:48:31,303 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9360e+00
[rank0]:2026-01-02 18:48:53,041 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4138e+00
[rank2]:2026-01-02 18:48:53,034 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4163e+00
[rank3]:2026-01-02 18:48:53,042 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1628e+00
[rank1]:2026-01-02 18:48:53,034 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3854e+00
[rank0]:2026-01-02 18:49:14,572 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2883e-01
[rank2]:2026-01-02 18:49:14,565 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7683e+00
[rank3]:2026-01-02 18:49:14,574 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.9071e+00
[rank1]:2026-01-02 18:49:14,565 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6472e+00
[rank2]:2026-01-02 18:49:36,457 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2816e+00
[rank3]:2026-01-02 18:49:36,465 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8748e+00
[rank1]:2026-01-02 18:49:36,457 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0318e+00
[rank0]:2026-01-02 18:49:36,456 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:49:36,464 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.2112e+00
[rank2]:2026-01-02 18:49:38,657 - Avg. fwd time: 16.5549 / Avg. bwd time: 24.4426 / Avg. batch time: 461.7363 (ms) / GPU bubble ratio: 28.97%
[rank3]:2026-01-02 18:49:38,618 - Avg. fwd time: 17.1882 / Avg. bwd time: 32.9696 / Avg. batch time: 418.7415 (ms) / GPU bubble ratio: 4.17%
[rank0]:2026-01-02 18:49:38,731 - Avg. fwd time: 17.0174 / Avg. bwd time: 27.4320 / Avg. batch time: 557.4277 (ms) / GPU bubble ratio: 36.21%
[rank0]:2026-01-02 18:49:38,745 -  step: 1200  loss: -4.0000  grad_norm:  0.4501  memory: 74.28GiB(53.13%)  tps: 7,523  tflops: 350.89  mfu: 35.48%
[rank2]:2026-01-02 18:49:38,738 -  step: 1200  loss: -4.0000  grad_norm:  0.4501  memory: 64.49GiB(46.13%)  tps: 7,523  tflops: 350.89  mfu: 35.48%
[rank3]:2026-01-02 18:49:38,746 -  step: 1200  loss:  0.2726  grad_norm:  0.4501  memory: 79.24GiB(56.67%)  tps: 7,524  tflops: 350.90  mfu: 35.48%
[rank1]:2026-01-02 18:49:38,692 - Avg. fwd time: 18.9051 / Avg. bwd time: 27.4758 / Avg. batch time: 510.0915 (ms) / GPU bubble ratio: 27.26%
[rank1]:2026-01-02 18:49:38,738 -  step: 1200  loss: -4.0000  grad_norm:  0.4501  memory: 72.50GiB(51.86%)  tps: 7,523  tflops: 350.89  mfu: 35.48%
[rank0]:2026-01-02 18:49:38,799 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1849_stage0_step1200.svg
[rank2]:2026-01-02 18:49:38,799 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1849_stage2_step1200.svg
[rank1]:2026-01-02 18:49:38,796 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1849_stage1_step1200.svg
[rank3]:2026-01-02 18:49:38,879 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1849_step1200_rank3.svg
[rank3]:			> Batch Time: 524.69 ms, GPU Bubble Ratio: 37.00%, 34.26%, 41.65%, 27.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-53ms     | [S0,MB3,F]  53-17-70ms     | [S0,MB4,F]  70-17-88ms     | [S0,MB5,F]  88-17-105ms    | [S0,MB6,F]  105-17-123ms   | [S0,MB7,F]  123-17-141ms   | [S0,MB0,B]  290-23-314ms   | [S0,MB1,B]  320-23-344ms   | [S0,MB2,B]  350-23-374ms   | [S0,MB3,B]  380-23-404ms   | [S0,MB4,B]  410-23-434ms   | [S0,MB5,B]  440-23-463ms   | [S0,MB6,B]  470-23-493ms   | [S0,MB7,B]  501-23-524ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-77ms     | [S1,MB3,F]  77-19-97ms     | [S1,MB4,F]  97-19-117ms    | [S1,MB5,F]  117-19-137ms   | [S1,MB6,F]  137-19-157ms   | [S1,MB7,F]  157-19-177ms   | [S1,MB0,B]  266-23-289ms   | [S1,MB1,B]  296-23-320ms   | [S1,MB2,B]  326-23-349ms   | [S1,MB3,B]  356-23-379ms   | [S1,MB4,B]  386-23-409ms   | [S1,MB5,B]  416-23-439ms   | [S1,MB6,B]  445-23-469ms   | [S1,MB7,B]  476-23-499ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  77-17-94ms     | [S2,MB3,F]  97-17-114ms    | [S2,MB4,F]  117-17-134ms   | [S2,MB5,F]  137-17-154ms   | [S2,MB6,F]  156-17-174ms   | [S2,MB7,F]  176-17-193ms   | [S2,MB0,B]  244-21-266ms   | [S2,MB1,B]  274-21-296ms   | [S2,MB2,B]  304-21-326ms   | [S2,MB3,B]  334-21-355ms   | [S2,MB4,B]  364-21-385ms   | [S2,MB5,B]  394-21-415ms   | [S2,MB6,B]  424-21-445ms   | [S2,MB7,B]  454-21-475ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-18-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  96-17-113ms    | [S3,MB3,F]  116-17-133ms   | [S3,MB4,F]  135-17-153ms   | [S3,MB5,F]  155-17-173ms   | [S3,MB6,F]  175-17-192ms   | [S3,MB7,F]  195-17-213ms   | [S3,MB0,B]  215-29-244ms   | [S3,MB1,B]  244-29-274ms   | [S3,MB2,B]  274-29-304ms   | [S3,MB3,B]  304-29-334ms   | [S3,MB4,B]  334-29-364ms   | [S3,MB5,B]  364-29-394ms   | [S3,MB6,B]  394-29-423ms   | [S3,MB7,B]  424-29-453ms  
[rank3]:2026-01-02 18:49:38,921 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1849_stage3_step1200.svg
[rank0]:2026-01-02 18:49:38,986 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1849_rank0_stage0.svg
[rank0]:	> Counts Sum: 6120, Total Sum: 7665 (79.84%), Ratio(%) per element: [0.0, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 76.19, 76.19, 76.19, 76.19, 76.19, 76.19, 76.19, 76.19, 76.19, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:49:38,981 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1849_rank2_stage2.svg
[rank2]:	> Counts Sum: 6300, Total Sum: 7560 (83.33%), Ratio(%) per element: [96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:49:38,987 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1849_rank1_stage1.svg
[rank1]:	> Counts Sum: 7155, Total Sum: 8505 (84.13%), Ratio(%) per element: [96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 95.23, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 94.28, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 89.52, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:49:39,084 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1849_rank3_stage3.svg
[rank3]:	> Counts Sum: 5247, Total Sum: 6825 (76.88%), Ratio(%) per element: [96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 96.19, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 77.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:49:58,840 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.3874e+00
[rank3]:2026-01-02 18:49:58,839 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.5018e+00
[rank2]:2026-01-02 18:49:58,832 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.9755e+00
[rank1]:2026-01-02 18:49:58,832 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.6048e+00
[rank0]:2026-01-02 18:50:20,565 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4524e+00
[rank1]:2026-01-02 18:50:20,557 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2181e+00
[rank3]:2026-01-02 18:50:20,564 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.6339e-01
[rank2]:2026-01-02 18:50:20,558 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.1357e+00
[rank0]:2026-01-02 18:50:42,111 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.7612e+00
[rank3]:2026-01-02 18:50:42,112 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3869e+00
[rank1]:2026-01-02 18:50:42,104 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8073e+00
[rank2]:2026-01-02 18:50:42,104 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.4356e+00
[rank3]:2026-01-02 18:51:03,449 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0193e+00
[rank1]:2026-01-02 18:51:03,441 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9046e-01
[rank2]:2026-01-02 18:51:03,441 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0871e+00
[rank0]:2026-01-02 18:51:03,448 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7786e+00
[rank1]:2026-01-02 18:51:24,970 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3352e+00
[rank3]:2026-01-02 18:51:24,979 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1221e+00
[rank2]:2026-01-02 18:51:24,971 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6710e+00
[rank0]:2026-01-02 18:51:24,976 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:51:24,979 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.4863e-01
[rank3]:2026-01-02 18:51:27,078 - Avg. fwd time: 17.2071 / Avg. bwd time: 32.8389 / Avg. batch time: 417.8279 (ms) / GPU bubble ratio: 4.18%
[rank1]:2026-01-02 18:51:27,148 - Avg. fwd time: 18.9288 / Avg. bwd time: 27.3163 / Avg. batch time: 508.8785 (ms) / GPU bubble ratio: 27.30%
[rank2]:2026-01-02 18:51:27,116 - Avg. fwd time: 16.5752 / Avg. bwd time: 24.3085 / Avg. batch time: 460.6895 (ms) / GPU bubble ratio: 29.00%
[rank2]:2026-01-02 18:51:27,188 -  step: 1250  loss: -4.0000  grad_norm:  0.3036  memory: 64.49GiB(46.13%)  tps: 7,554  tflops: 352.31  mfu: 35.62%
[rank0]:2026-01-02 18:51:27,182 - Avg. fwd time: 17.0380 / Avg. bwd time: 27.2787 / Avg. batch time: 556.0355 (ms) / GPU bubble ratio: 36.24%
[rank0]:2026-01-02 18:51:27,194 -  step: 1250  loss: -4.0000  grad_norm:  0.3036  memory: 74.28GiB(53.13%)  tps: 7,554  tflops: 352.31  mfu: 35.62%
[rank1]:2026-01-02 18:51:27,188 -  step: 1250  loss: -4.0000  grad_norm:  0.3036  memory: 72.50GiB(51.86%)  tps: 7,554  tflops: 352.31  mfu: 35.62%
[rank3]:2026-01-02 18:51:27,196 -  step: 1250  loss:  0.2506  grad_norm:  0.3036  memory: 79.24GiB(56.67%)  tps: 7,554  tflops: 352.32  mfu: 35.62%
[rank3]:2026-01-02 18:51:46,942 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3859e+00
[rank1]:2026-01-02 18:51:46,933 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6265e+00
[rank0]:2026-01-02 18:51:46,940 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3466e+00
[rank2]:2026-01-02 18:51:46,933 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1999e+00
[rank1]:2026-01-02 18:52:08,906 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7761e+00
[rank3]:2026-01-02 18:52:08,914 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.9620e+00
[rank0]:2026-01-02 18:52:08,914 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0060e+00
[rank2]:2026-01-02 18:52:08,906 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6837e+00
[rank1]:2026-01-02 18:52:30,394 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5581e+00
[rank0]:2026-01-02 18:52:30,401 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.1452e+00
[rank3]:2026-01-02 18:52:30,403 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7662e+00
[rank2]:2026-01-02 18:52:30,394 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0583e+00
[rank1]:2026-01-02 18:52:51,938 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.3169e+00
[rank0]:2026-01-02 18:52:51,946 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.7056e+00
[rank3]:2026-01-02 18:52:51,947 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.8116e+00
[rank2]:2026-01-02 18:52:51,939 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.2857e+00
[rank1]:2026-01-02 18:53:13,435 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.8600e+00
[rank0]:2026-01-02 18:53:13,434 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:53:13,442 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8697e+00
[rank3]:2026-01-02 18:53:13,444 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7919e+00
[rank2]:2026-01-02 18:53:13,435 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.8245e+00
[rank3]:2026-01-02 18:53:15,560 - Avg. fwd time: 17.2253 / Avg. bwd time: 32.7192 / Avg. batch time: 416.9992 (ms) / GPU bubble ratio: 4.18%
[rank2]:2026-01-02 18:53:15,596 - Avg. fwd time: 16.5943 / Avg. bwd time: 24.1851 / Avg. batch time: 459.7306 (ms) / GPU bubble ratio: 29.04%
[rank1]:2026-01-02 18:53:15,631 - Avg. fwd time: 18.9516 / Avg. bwd time: 27.1696 / Avg. batch time: 507.7661 (ms) / GPU bubble ratio: 27.33%
[rank1]:2026-01-02 18:53:15,679 -  step: 1300  loss: -4.0000  grad_norm:  0.3806  memory: 72.50GiB(51.86%)  tps: 7,551  tflops: 352.17  mfu: 35.61%
[rank0]:2026-01-02 18:53:15,672 - Avg. fwd time: 17.0581 / Avg. bwd time: 27.1375 / Avg. batch time: 554.7614 (ms) / GPU bubble ratio: 36.27%
[rank0]:2026-01-02 18:53:15,685 -  step: 1300  loss: -4.0000  grad_norm:  0.3806  memory: 74.28GiB(53.13%)  tps: 7,551  tflops: 352.17  mfu: 35.61%
[rank3]:2026-01-02 18:53:15,688 -  step: 1300  loss:  0.1935  grad_norm:  0.3806  memory: 79.24GiB(56.67%)  tps: 7,551  tflops: 352.18  mfu: 35.61%
[rank2]:2026-01-02 18:53:15,679 -  step: 1300  loss: -4.0000  grad_norm:  0.3806  memory: 64.49GiB(46.13%)  tps: 7,551  tflops: 352.17  mfu: 35.61%
[rank1]:2026-01-02 18:53:15,738 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1853_stage1_step1300.svg
[rank0]:2026-01-02 18:53:15,739 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1853_stage0_step1300.svg
[rank2]:2026-01-02 18:53:15,737 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1853_stage2_step1300.svg
[rank3]:2026-01-02 18:53:15,821 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1853_step1300_rank3.svg
[rank3]:			> Batch Time: 520.38 ms, GPU Bubble Ratio: 36.76%, 34.06%, 41.53%, 27.40%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB4,F]  70-17-87ms     | [S0,MB5,F]  87-17-104ms    | [S0,MB6,F]  105-17-122ms   | [S0,MB7,F]  122-17-140ms   | [S0,MB0,B]  287-23-311ms   | [S0,MB1,B]  318-23-341ms   | [S0,MB2,B]  347-23-371ms   | [S0,MB3,B]  377-23-401ms   | [S0,MB4,B]  407-23-430ms   | [S0,MB5,B]  437-23-460ms   | [S0,MB6,B]  466-23-490ms   | [S0,MB7,B]  496-23-520ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB3,F]  77-19-96ms     | [S1,MB4,F]  97-19-116ms    | [S1,MB5,F]  117-19-136ms   | [S1,MB6,F]  136-19-156ms   | [S1,MB7,F]  156-19-176ms   | [S1,MB0,B]  263-23-287ms   | [S1,MB1,B]  293-23-317ms   | [S1,MB2,B]  323-23-347ms   | [S1,MB3,B]  353-23-376ms   | [S1,MB4,B]  383-23-406ms   | [S1,MB5,B]  413-23-436ms   | [S1,MB6,B]  442-23-466ms   | [S1,MB7,B]  472-23-496ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  57-16-74ms     | [S2,MB2,F]  77-16-94ms     | [S2,MB3,F]  96-16-113ms    | [S2,MB4,F]  116-16-133ms   | [S2,MB5,F]  136-16-153ms   | [S2,MB6,F]  156-16-173ms   | [S2,MB7,F]  175-16-192ms   | [S2,MB0,B]  242-21-263ms   | [S2,MB1,B]  272-21-293ms   | [S2,MB2,B]  302-21-323ms   | [S2,MB3,B]  331-21-352ms   | [S2,MB4,B]  361-21-382ms   | [S2,MB5,B]  391-21-412ms   | [S2,MB6,B]  421-21-442ms   | [S2,MB7,B]  450-21-471ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-113ms    | [S3,MB3,F]  115-17-132ms   | [S3,MB4,F]  134-17-152ms   | [S3,MB5,F]  154-17-171ms   | [S3,MB6,F]  174-17-191ms   | [S3,MB7,F]  193-17-211ms   | [S3,MB0,B]  213-29-242ms   | [S3,MB1,B]  241-29-271ms   | [S3,MB2,B]  271-29-301ms   | [S3,MB3,B]  301-29-331ms   | [S3,MB4,B]  330-29-360ms   | [S3,MB5,B]  360-29-390ms   | [S3,MB6,B]  390-29-420ms   | [S3,MB7,B]  420-29-450ms  
[rank3]:2026-01-02 18:53:15,863 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1853_stage3_step1300.svg
[rank2]:2026-01-02 18:53:15,915 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1853_rank2_stage2.svg
[rank2]:	> Counts Sum: 6930, Total Sum: 8280 (83.70%), Ratio(%) per element: [96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:53:15,926 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1853_rank1_stage1.svg
[rank1]:	> Counts Sum: 7875, Total Sum: 9315 (84.54%), Ratio(%) per element: [96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 94.78, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 90.43, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 18:53:15,929 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1853_rank0_stage0.svg
[rank0]:	> Counts Sum: 6750, Total Sum: 8395 (80.41%), Ratio(%) per element: [0.0, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 95.65, 78.26, 78.26, 78.26, 78.26, 78.26, 78.26, 78.26, 78.26, 78.26, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:53:16,029 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1853_rank3_stage3.svg
[rank3]:	> Counts Sum: 5787, Total Sum: 7475 (77.42%), Ratio(%) per element: [96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 96.52, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 93.91, 79.13, 79.13, 79.13, 79.13, 79.13, 79.13, 79.13, 79.13, 79.13, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:53:35,691 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.5864e+01
[rank0]:2026-01-02 18:53:35,699 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0418e+02
[rank3]:2026-01-02 18:53:35,698 - Freezing Ratio: [Stage3] 0.83, Threshold: 6.3676e+01
[rank2]:2026-01-02 18:53:35,691 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.3305e+01
[rank1]:2026-01-02 18:53:57,799 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8604e-01
[rank3]:2026-01-02 18:53:57,807 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3130e+00
[rank0]:2026-01-02 18:53:57,806 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.0446e+00
[rank2]:2026-01-02 18:53:57,799 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.0759e-01
[rank1]:2026-01-02 18:54:19,921 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6752e-01
[rank3]:2026-01-02 18:54:19,929 - Freezing Ratio: [Stage3] 0.83, Threshold: 6.9089e-01
[rank0]:2026-01-02 18:54:19,929 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.6913e-01
[rank2]:2026-01-02 18:54:19,922 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9912e+00
[rank1]:2026-01-02 18:54:41,536 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0582e-01
[rank3]:2026-01-02 18:54:41,543 - Freezing Ratio: [Stage3] 0.83, Threshold: 8.5161e-01
[rank0]:2026-01-02 18:54:41,543 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9327e+00
[rank2]:2026-01-02 18:54:41,536 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6967e+00
[rank2]:2026-01-02 18:55:03,306 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8098e+00
[rank1]:2026-01-02 18:55:03,306 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.5970e+00
[rank3]:2026-01-02 18:55:03,313 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.4694e+00
[rank0]:2026-01-02 18:55:03,311 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:55:03,314 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9428e+00
[rank2]:2026-01-02 18:55:05,431 - Avg. fwd time: 16.6165 / Avg. bwd time: 24.0732 / Avg. batch time: 458.9484 (ms) / GPU bubble ratio: 29.07%
[rank1]:2026-01-02 18:55:05,463 - Avg. fwd time: 18.9774 / Avg. bwd time: 27.0357 / Avg. batch time: 506.8486 (ms) / GPU bubble ratio: 27.37%
[rank3]:2026-01-02 18:55:05,401 - Avg. fwd time: 17.2483 / Avg. bwd time: 32.6135 / Avg. batch time: 416.3225 (ms) / GPU bubble ratio: 4.19%
[rank0]:2026-01-02 18:55:05,495 - Avg. fwd time: 17.0817 / Avg. bwd time: 27.0082 / Avg. batch time: 553.6981 (ms) / GPU bubble ratio: 36.30%
[rank2]:2026-01-02 18:55:05,501 -  step: 1350  loss: -4.0000  grad_norm:  0.3775  memory: 64.49GiB(46.13%)  tps: 7,459  tflops: 347.91  mfu: 35.18%
[rank1]:2026-01-02 18:55:05,501 -  step: 1350  loss: -4.0000  grad_norm:  0.3775  memory: 72.50GiB(51.86%)  tps: 7,459  tflops: 347.91  mfu: 35.18%
[rank3]:2026-01-02 18:55:05,508 -  step: 1350  loss:  0.1359  grad_norm:  0.3775  memory: 79.24GiB(56.67%)  tps: 7,460  tflops: 347.91  mfu: 35.18%
[rank0]:2026-01-02 18:55:05,507 -  step: 1350  loss: -4.0000  grad_norm:  0.3775  memory: 74.28GiB(53.13%)  tps: 7,459  tflops: 347.91  mfu: 35.18%
[rank1]:2026-01-02 18:55:25,274 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7249e+00
[rank3]:2026-01-02 18:55:25,282 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1779e+00
[rank0]:2026-01-02 18:55:25,281 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6275e+00
[rank2]:2026-01-02 18:55:25,274 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7783e+00
[rank1]:2026-01-02 18:55:46,888 - Freezing Ratio: [Stage1] 0.89, Threshold: 7.7677e-01
[rank3]:2026-01-02 18:55:46,895 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.3107e-01
[rank0]:2026-01-02 18:55:46,895 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5782e+00
[rank2]:2026-01-02 18:55:46,888 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.4375e+00
[rank2]:2026-01-02 18:56:08,491 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6928e+00
[rank3]:2026-01-02 18:56:08,499 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.0565e-01
[rank1]:2026-01-02 18:56:08,490 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9794e-01
[rank0]:2026-01-02 18:56:08,497 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3282e+00
[rank1]:2026-01-02 18:56:30,037 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3100e+00
[rank3]:2026-01-02 18:56:30,046 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7691e+00
[rank0]:2026-01-02 18:56:30,044 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.7653e+00
[rank2]:2026-01-02 18:56:30,037 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.4862e+00
[rank2]:2026-01-02 18:56:52,112 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.1223e+00
[rank1]:2026-01-02 18:56:52,111 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.4690e+00
[rank3]:2026-01-02 18:56:52,120 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.7654e+00
[rank0]:2026-01-02 18:56:52,109 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 18:56:52,119 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.0100e+00
[rank3]:2026-01-02 18:56:54,258 - Avg. fwd time: 17.2635 / Avg. bwd time: 32.5104 / Avg. batch time: 415.6051 (ms) / GPU bubble ratio: 4.19%
[rank2]:2026-01-02 18:56:54,291 - Avg. fwd time: 16.6327 / Avg. bwd time: 23.9674 / Avg. batch time: 458.1209 (ms) / GPU bubble ratio: 29.10%
[rank1]:2026-01-02 18:56:54,323 - Avg. fwd time: 18.9961 / Avg. bwd time: 26.9095 / Avg. batch time: 505.8894 (ms) / GPU bubble ratio: 27.41%
[rank1]:2026-01-02 18:56:54,363 -  step: 1400  loss: -4.0000  grad_norm:  0.3499  memory: 72.50GiB(51.86%)  tps: 7,525  tflops: 350.97  mfu: 35.49%
[rank3]:2026-01-02 18:56:54,373 -  step: 1400  loss:  0.3656  grad_norm:  0.3499  memory: 79.24GiB(56.67%)  tps: 7,525  tflops: 350.98  mfu: 35.49%
[rank0]:2026-01-02 18:56:54,357 - Avg. fwd time: 17.0991 / Avg. bwd time: 26.8867 / Avg. batch time: 552.6038 (ms) / GPU bubble ratio: 36.32%
[rank0]:2026-01-02 18:56:54,369 -  step: 1400  loss: -4.0000  grad_norm:  0.3499  memory: 74.28GiB(53.13%)  tps: 7,525  tflops: 350.97  mfu: 35.49%
[rank2]:2026-01-02 18:56:54,363 -  step: 1400  loss: -4.0000  grad_norm:  0.3499  memory: 64.49GiB(46.13%)  tps: 7,525  tflops: 350.97  mfu: 35.49%
[rank2]:2026-01-02 18:56:54,423 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1856_stage2_step1400.svg
[rank1]:2026-01-02 18:56:54,418 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1856_stage1_step1400.svg
[rank0]:2026-01-02 18:56:54,423 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1856_stage0_step1400.svg
[rank3]:2026-01-02 18:56:54,508 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1856_step1400_rank3.svg
[rank3]:			> Batch Time: 527.73 ms, GPU Bubble Ratio: 37.07%, 34.24%, 41.66%, 27.30%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-88ms     | [S0,MB5,F]  88-17-106ms    | [S0,MB6,F]  106-17-124ms   | [S0,MB7,F]  124-17-142ms   | [S0,MB0,B]  293-23-316ms   | [S0,MB1,B]  322-23-346ms   | [S0,MB2,B]  352-23-376ms   | [S0,MB3,B]  382-23-406ms   | [S0,MB4,B]  412-23-436ms   | [S0,MB5,B]  443-23-466ms   | [S0,MB6,B]  473-23-496ms   | [S0,MB7,B]  504-23-527ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  138-19-158ms   | [S1,MB7,F]  158-19-178ms   | [S1,MB0,B]  268-23-292ms   | [S1,MB1,B]  298-23-322ms   | [S1,MB2,B]  328-23-352ms   | [S1,MB3,B]  358-23-382ms   | [S1,MB4,B]  388-23-412ms   | [S1,MB5,B]  418-23-442ms   | [S1,MB6,B]  448-23-472ms   | [S1,MB7,B]  479-23-503ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  78-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-155ms   | [S2,MB6,F]  158-17-175ms   | [S2,MB7,F]  178-17-195ms   | [S2,MB0,B]  247-21-268ms   | [S2,MB1,B]  277-21-298ms   | [S2,MB2,B]  307-21-328ms   | [S2,MB3,B]  337-21-358ms   | [S2,MB4,B]  367-21-388ms   | [S2,MB5,B]  397-21-418ms   | [S2,MB6,B]  427-21-448ms   | [S2,MB7,B]  457-21-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  97-17-114ms    | [S3,MB3,F]  116-17-134ms   | [S3,MB4,F]  136-17-154ms   | [S3,MB5,F]  156-17-174ms   | [S3,MB6,F]  176-17-194ms   | [S3,MB7,F]  196-18-214ms   | [S3,MB0,B]  217-29-246ms   | [S3,MB1,B]  246-30-276ms   | [S3,MB2,B]  276-30-306ms   | [S3,MB3,B]  306-30-336ms   | [S3,MB4,B]  336-30-366ms   | [S3,MB5,B]  366-30-396ms   | [S3,MB6,B]  396-29-426ms   | [S3,MB7,B]  426-29-456ms  
[rank3]:2026-01-02 18:56:54,555 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1856_stage3_step1400.svg
[rank0]:2026-01-02 18:56:54,602 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1856_rank0_stage0.svg
[rank0]:	> Counts Sum: 7380, Total Sum: 9125 (80.88%), Ratio(%) per element: [0.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 18:56:54,593 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1856_rank2_stage2.svg
[rank2]:	> Counts Sum: 7560, Total Sum: 9000 (84.00%), Ratio(%) per element: [96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 18:56:54,592 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1856_rank1_stage1.svg
[rank1]:	> Counts Sum: 8595, Total Sum: 10125 (84.89%), Ratio(%) per element: [96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:56:54,721 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1856_rank3_stage3.svg
[rank3]:	> Counts Sum: 6327, Total Sum: 8125 (77.87%), Ratio(%) per element: [96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 94.4, 80.8, 80.8, 80.8, 80.8, 80.8, 80.8, 80.8, 80.8, 80.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 18:57:14,392 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5014e+00
[rank1]:2026-01-02 18:57:14,385 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3960e+00
[rank0]:2026-01-02 18:57:14,393 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2772e+00
[rank2]:2026-01-02 18:57:14,385 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0678e+00
[rank1]:2026-01-02 18:57:36,425 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5071e+00
[rank0]:2026-01-02 18:57:36,432 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.0802e+00
[rank2]:2026-01-02 18:57:36,425 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0232e+00
[rank3]:2026-01-02 18:57:36,432 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.4664e+00
[rank2]:2026-01-02 18:57:58,787 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.4021e-01
[rank1]:2026-01-02 18:57:58,787 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.5580e+00
[rank3]:2026-01-02 18:57:58,795 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.4279e-01
[rank0]:2026-01-02 18:57:58,795 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2636e-01
[rank2]:2026-01-02 18:58:20,842 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.2971e+00
[rank1]:2026-01-02 18:58:20,841 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.2921e-01
[rank3]:2026-01-02 18:58:20,850 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1922e+00
[rank0]:2026-01-02 18:58:20,849 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8633e-01
[rank2]:2026-01-02 18:58:42,916 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3114e+00
[rank1]:2026-01-02 18:58:42,916 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1549e+00
[rank3]:2026-01-02 18:58:42,923 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.3192e+00
[rank0]:2026-01-02 18:58:42,922 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 18:58:42,924 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3398e+00
[rank2]:2026-01-02 18:58:45,047 - Avg. fwd time: 16.6545 / Avg. bwd time: 23.8716 / Avg. batch time: 457.5030 (ms) / GPU bubble ratio: 29.14%
[rank1]:2026-01-02 18:58:45,079 - Avg. fwd time: 19.0220 / Avg. bwd time: 26.7951 / Avg. batch time: 505.1584 (ms) / GPU bubble ratio: 27.44%
[rank3]:2026-01-02 18:58:45,014 - Avg. fwd time: 17.2868 / Avg. bwd time: 32.4217 / Avg. batch time: 415.0697 (ms) / GPU bubble ratio: 4.19%
[rank2]:2026-01-02 18:58:45,127 -  step: 1450  loss: -4.0000  grad_norm:  0.4555  memory: 64.49GiB(46.13%)  tps: 7,396  tflops: 344.95  mfu: 34.88%
[rank1]:2026-01-02 18:58:45,127 -  step: 1450  loss: -4.0000  grad_norm:  0.4555  memory: 72.50GiB(51.86%)  tps: 7,396  tflops: 344.95  mfu: 34.88%
[rank3]:2026-01-02 18:58:45,135 -  step: 1450  loss:  0.1811  grad_norm:  0.4555  memory: 79.24GiB(56.67%)  tps: 7,396  tflops: 344.96  mfu: 34.88%
[rank0]:2026-01-02 18:58:45,120 - Avg. fwd time: 17.1231 / Avg. bwd time: 26.7761 / Avg. batch time: 551.7515 (ms) / GPU bubble ratio: 36.35%
[rank0]:2026-01-02 18:58:45,134 -  step: 1450  loss: -4.0000  grad_norm:  0.4555  memory: 74.28GiB(53.13%)  tps: 7,396  tflops: 344.95  mfu: 34.88%
[rank2]:2026-01-02 18:59:05,055 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3862e+00
[rank1]:2026-01-02 18:59:05,055 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0002e+00
[rank3]:2026-01-02 18:59:05,064 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0835e+00
[rank0]:2026-01-02 18:59:05,063 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.8980e-01
[rank2]:2026-01-02 18:59:26,994 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0907e+00
[rank3]:2026-01-02 18:59:27,001 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.7608e-01
[rank1]:2026-01-02 18:59:26,994 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3260e+00
[rank0]:2026-01-02 18:59:27,001 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.3954e+00
[rank2]:2026-01-02 18:59:49,286 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2407e+00
[rank3]:2026-01-02 18:59:49,295 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0796e+00
[rank1]:2026-01-02 18:59:49,286 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.3551e-01
[rank0]:2026-01-02 18:59:49,293 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.3305e-01
[rank2]:2026-01-02 19:00:11,629 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1431e+00
[rank3]:2026-01-02 19:00:11,638 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2722e+00
[rank1]:2026-01-02 19:00:11,629 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.4139e+00
[rank0]:2026-01-02 19:00:11,636 - Freezing Ratio: [Stage0] 0.86, Threshold: 9.1393e-01
[rank2]:2026-01-02 19:00:34,014 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2900e-01
[rank3]:2026-01-02 19:00:34,021 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.9245e-01
[rank1]:2026-01-02 19:00:34,014 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.8196e-01
[rank0]:2026-01-02 19:00:34,012 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:00:34,022 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.1092e-01
[rank3]:2026-01-02 19:00:36,173 - Avg. fwd time: 17.3119 / Avg. bwd time: 32.3421 / Avg. batch time: 414.6225 (ms) / GPU bubble ratio: 4.19%
[rank2]:2026-01-02 19:00:36,204 - Avg. fwd time: 16.6770 / Avg. bwd time: 23.7833 / Avg. batch time: 456.9692 (ms) / GPU bubble ratio: 29.17%
[rank2]:2026-01-02 19:00:36,277 -  step: 1500  loss: -4.0000  grad_norm:  0.4471  memory: 64.49GiB(46.13%)  tps: 7,370  tflops: 343.75  mfu: 34.76%
[rank3]:2026-01-02 19:00:36,284 -  step: 1500  loss:  0.2816  grad_norm:  0.4471  memory: 79.24GiB(56.67%)  tps: 7,370  tflops: 343.75  mfu: 34.76%
[rank1]:2026-01-02 19:00:36,236 - Avg. fwd time: 19.0485 / Avg. bwd time: 26.6892 / Avg. batch time: 504.5215 (ms) / GPU bubble ratio: 27.48%
[rank1]:2026-01-02 19:00:36,277 -  step: 1500  loss: -4.0000  grad_norm:  0.4471  memory: 72.50GiB(51.86%)  tps: 7,370  tflops: 343.75  mfu: 34.76%
[rank0]:2026-01-02 19:00:36,271 - Avg. fwd time: 17.1475 / Avg. bwd time: 26.6730 / Avg. batch time: 551.0038 (ms) / GPU bubble ratio: 36.38%
[rank0]:2026-01-02 19:00:36,283 -  step: 1500  loss: -4.0000  grad_norm:  0.4471  memory: 74.28GiB(53.13%)  tps: 7,370  tflops: 343.75  mfu: 34.76%
[rank2]:2026-01-02 19:00:36,332 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1900_stage2_step1500.svg
[rank1]:2026-01-02 19:00:36,329 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1900_stage1_step1500.svg
[rank0]:2026-01-02 19:00:36,334 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1900_stage0_step1500.svg
[rank3]:2026-01-02 19:00:36,412 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1900_step1500_rank3.svg
[rank3]:			> Batch Time: 529.78 ms, GPU Bubble Ratio: 37.08%, 34.32%, 41.69%, 27.21%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-36ms     | [S0,MB2,F]  36-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-89ms     | [S0,MB5,F]  89-17-107ms    | [S0,MB6,F]  107-17-125ms   | [S0,MB7,F]  125-18-143ms   | [S0,MB0,B]  294-23-317ms   | [S0,MB1,B]  324-23-347ms   | [S0,MB2,B]  354-23-378ms   | [S0,MB3,B]  385-23-408ms   | [S0,MB4,B]  415-23-438ms   | [S0,MB5,B]  445-23-468ms   | [S0,MB6,B]  475-23-499ms   | [S0,MB7,B]  506-23-529ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  139-19-159ms   | [S1,MB7,F]  159-19-179ms   | [S1,MB0,B]  269-23-293ms   | [S1,MB1,B]  300-23-323ms   | [S1,MB2,B]  330-23-353ms   | [S1,MB3,B]  360-23-384ms   | [S1,MB4,B]  390-23-414ms   | [S1,MB5,B]  421-23-444ms   | [S1,MB6,B]  451-23-474ms   | [S1,MB7,B]  481-23-505ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  78-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-156ms   | [S2,MB6,F]  159-17-176ms   | [S2,MB7,F]  179-17-196ms   | [S2,MB0,B]  248-21-269ms   | [S2,MB1,B]  278-21-299ms   | [S2,MB2,B]  308-21-330ms   | [S2,MB3,B]  339-21-360ms   | [S2,MB4,B]  369-21-390ms   | [S2,MB5,B]  399-21-420ms   | [S2,MB6,B]  429-21-450ms   | [S2,MB7,B]  459-21-480ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-17-95ms     | [S3,MB2,F]  97-17-115ms    | [S3,MB3,F]  117-17-135ms   | [S3,MB4,F]  137-17-155ms   | [S3,MB5,F]  157-18-175ms   | [S3,MB6,F]  177-18-195ms   | [S3,MB7,F]  197-18-216ms   | [S3,MB0,B]  218-30-248ms   | [S3,MB1,B]  247-30-278ms   | [S3,MB2,B]  278-30-308ms   | [S3,MB3,B]  308-30-338ms   | [S3,MB4,B]  338-30-368ms   | [S3,MB5,B]  368-30-398ms   | [S3,MB6,B]  398-30-428ms   | [S3,MB7,B]  428-30-458ms  
[rank3]:2026-01-02 19:00:36,455 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1900_stage3_step1500.svg
[rank2]:2026-01-02 19:00:36,499 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1900_rank2_stage2.svg
[rank2]:	> Counts Sum: 8190, Total Sum: 9720 (84.26%), Ratio(%) per element: [97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:00:36,506 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1900_rank1_stage1.svg
[rank1]:	> Counts Sum: 9315, Total Sum: 10935 (85.19%), Ratio(%) per element: [97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 95.55, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 91.85, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 19:00:36,511 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1900_rank0_stage0.svg
[rank0]:	> Counts Sum: 8010, Total Sum: 9855 (81.28%), Ratio(%) per element: [0.0, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 96.29, 81.48, 81.48, 81.48, 81.48, 81.48, 81.48, 81.48, 81.48, 81.48, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:00:36,614 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1900_rank3_stage3.svg
[rank3]:	> Counts Sum: 6867, Total Sum: 8775 (78.26%), Ratio(%) per element: [97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 97.03, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 94.81, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 82.22, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:00:56,551 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0113e+00
[rank2]:2026-01-02 19:00:56,544 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2348e+00
[rank1]:2026-01-02 19:00:56,544 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9667e+00
[rank0]:2026-01-02 19:00:56,551 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5134e+00
[rank3]:2026-01-02 19:01:18,830 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2988e+00
[rank2]:2026-01-02 19:01:18,821 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.2521e+00
[rank1]:2026-01-02 19:01:18,821 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.4108e+00
[rank0]:2026-01-02 19:01:18,828 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.2069e+00
[rank1]:2026-01-02 19:01:41,058 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8911e+00
[rank0]:2026-01-02 19:01:41,066 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.8305e-01
[rank3]:2026-01-02 19:01:41,065 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.7098e+00
[rank2]:2026-01-02 19:01:41,058 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6373e+00
[rank3]:2026-01-02 19:02:03,310 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.8434e-01
[rank2]:2026-01-02 19:02:03,302 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1798e+00
[rank1]:2026-01-02 19:02:03,302 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.7645e-01
[rank0]:2026-01-02 19:02:03,309 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.6180e-01
[rank2]:2026-01-02 19:02:25,407 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0589e+00
[rank1]:2026-01-02 19:02:25,407 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.9723e-01
[rank0]:2026-01-02 19:02:25,414 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 19:02:25,417 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.2898e-01
[rank3]:2026-01-02 19:02:25,416 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.6157e-01
[rank3]:2026-01-02 19:02:27,578 - Avg. fwd time: 17.3351 / Avg. bwd time: 32.2668 / Avg. batch time: 414.1951 (ms) / GPU bubble ratio: 4.20%
[rank2]:2026-01-02 19:02:27,609 - Avg. fwd time: 16.6976 / Avg. bwd time: 23.7003 / Avg. batch time: 456.4676 (ms) / GPU bubble ratio: 29.20%
[rank3]:2026-01-02 19:02:27,705 -  step: 1550  loss:  0.2691  grad_norm:  0.5158  memory: 79.24GiB(56.67%)  tps: 7,352  tflops: 342.92  mfu: 34.67%
[rank2]:2026-01-02 19:02:27,698 -  step: 1550  loss: -4.0000  grad_norm:  0.5158  memory: 64.49GiB(46.13%)  tps: 7,352  tflops: 342.91  mfu: 34.67%
[rank1]:2026-01-02 19:02:27,651 - Avg. fwd time: 19.0729 / Avg. bwd time: 26.5900 / Avg. batch time: 503.9223 (ms) / GPU bubble ratio: 27.51%
[rank1]:2026-01-02 19:02:27,698 -  step: 1550  loss: -4.0000  grad_norm:  0.5158  memory: 72.50GiB(51.86%)  tps: 7,352  tflops: 342.91  mfu: 34.67%
[rank0]:2026-01-02 19:02:27,692 - Avg. fwd time: 17.1706 / Avg. bwd time: 26.5767 / Avg. batch time: 550.3054 (ms) / GPU bubble ratio: 36.40%
[rank0]:2026-01-02 19:02:27,704 -  step: 1550  loss: -4.0000  grad_norm:  0.5158  memory: 74.28GiB(53.13%)  tps: 7,352  tflops: 342.91  mfu: 34.67%
[rank1]:2026-01-02 19:02:47,614 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0759e-01
[rank2]:2026-01-02 19:02:47,614 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7431e-01
[rank3]:2026-01-02 19:02:47,621 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1337e+00
[rank0]:2026-01-02 19:02:47,621 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.2244e-01
[rank1]:2026-01-02 19:03:09,597 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.6469e+00
[rank3]:2026-01-02 19:03:09,606 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8246e+00
[rank2]:2026-01-02 19:03:09,598 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.2512e+00
[rank0]:2026-01-02 19:03:09,605 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.2089e+00
[rank1]:2026-01-02 19:03:31,322 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8142e+01
[rank3]:2026-01-02 19:03:31,330 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5938e+01
[rank2]:2026-01-02 19:03:31,322 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6535e+01
[rank0]:2026-01-02 19:03:31,329 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5302e+01
[rank1]:2026-01-02 19:03:53,528 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.3011e-01
[rank3]:2026-01-02 19:03:53,534 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0269e+00
[rank2]:2026-01-02 19:03:53,528 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.9524e-01
[rank0]:2026-01-02 19:03:53,535 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.7270e-01
[rank0]:2026-01-02 19:04:15,825 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:04:15,835 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8012e-01
[rank1]:2026-01-02 19:04:15,828 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.2168e-01
[rank3]:2026-01-02 19:04:15,837 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.6066e-01
[rank2]:2026-01-02 19:04:15,828 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3168e+00
[rank3]:2026-01-02 19:04:17,985 - Avg. fwd time: 17.3515 / Avg. bwd time: 32.1922 / Avg. batch time: 413.7196 (ms) / GPU bubble ratio: 4.20%
[rank2]:2026-01-02 19:04:18,024 - Avg. fwd time: 16.7133 / Avg. bwd time: 23.6211 / Avg. batch time: 455.9107 (ms) / GPU bubble ratio: 29.22%
[rank1]:2026-01-02 19:04:18,057 - Avg. fwd time: 19.0918 / Avg. bwd time: 26.4952 / Avg. batch time: 503.2708 (ms) / GPU bubble ratio: 27.53%
[rank1]:2026-01-02 19:04:18,098 -  step: 1600  loss: -4.0000  grad_norm:  0.5352  memory: 72.50GiB(51.86%)  tps: 7,420  tflops: 346.08  mfu: 34.99%
[rank3]:2026-01-02 19:04:18,107 -  step: 1600  loss:  0.3742  grad_norm:  0.5352  memory: 79.24GiB(56.67%)  tps: 7,420  tflops: 346.09  mfu: 34.99%
[rank2]:2026-01-02 19:04:18,099 -  step: 1600  loss: -4.0000  grad_norm:  0.5352  memory: 64.49GiB(46.13%)  tps: 7,420  tflops: 346.08  mfu: 34.99%
[rank0]:2026-01-02 19:04:18,092 - Avg. fwd time: 17.1877 / Avg. bwd time: 26.4857 / Avg. batch time: 549.5537 (ms) / GPU bubble ratio: 36.42%
[rank0]:2026-01-02 19:04:18,105 -  step: 1600  loss: -4.0000  grad_norm:  0.5352  memory: 74.28GiB(53.13%)  tps: 7,420  tflops: 346.08  mfu: 34.99%
[rank1]:2026-01-02 19:04:18,155 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1904_stage1_step1600.svg
[rank2]:2026-01-02 19:04:18,163 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1904_stage2_step1600.svg
[rank0]:2026-01-02 19:04:18,159 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1904_stage0_step1600.svg
[rank3]:2026-01-02 19:04:18,240 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1904_step1600_rank3.svg
[rank3]:			> Batch Time: 527.52 ms, GPU Bubble Ratio: 37.00%, 34.19%, 41.59%, 27.18%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-88ms     | [S0,MB5,F]  88-17-106ms    | [S0,MB6,F]  106-17-124ms   | [S0,MB7,F]  124-17-142ms   | [S0,MB0,B]  292-23-316ms   | [S0,MB1,B]  322-23-346ms   | [S0,MB2,B]  352-23-376ms   | [S0,MB3,B]  382-23-406ms   | [S0,MB4,B]  412-23-436ms   | [S0,MB5,B]  442-23-466ms   | [S0,MB6,B]  472-23-496ms   | [S0,MB7,B]  503-23-527ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-20-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-98ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  138-19-158ms   | [S1,MB7,F]  158-19-178ms   | [S1,MB0,B]  268-23-292ms   | [S1,MB1,B]  298-23-322ms   | [S1,MB2,B]  328-23-352ms   | [S1,MB3,B]  358-23-382ms   | [S1,MB4,B]  388-23-412ms   | [S1,MB5,B]  418-23-442ms   | [S1,MB6,B]  448-23-472ms   | [S1,MB7,B]  479-23-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  77-17-95ms     | [S2,MB3,F]  98-17-115ms    | [S2,MB4,F]  118-17-135ms   | [S2,MB5,F]  138-17-155ms   | [S2,MB6,F]  158-17-175ms   | [S2,MB7,F]  178-17-195ms   | [S2,MB0,B]  246-21-268ms   | [S2,MB1,B]  276-21-298ms   | [S2,MB2,B]  307-21-328ms   | [S2,MB3,B]  337-21-358ms   | [S2,MB4,B]  367-21-388ms   | [S2,MB5,B]  397-21-418ms   | [S2,MB6,B]  427-21-448ms   | [S2,MB7,B]  457-21-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-19-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  96-17-114ms    | [S3,MB3,F]  116-17-134ms   | [S3,MB4,F]  136-17-154ms   | [S3,MB5,F]  156-17-174ms   | [S3,MB6,F]  176-17-194ms   | [S3,MB7,F]  196-18-214ms   | [S3,MB0,B]  216-29-246ms   | [S3,MB1,B]  246-30-276ms   | [S3,MB2,B]  276-30-306ms   | [S3,MB3,B]  306-30-336ms   | [S3,MB4,B]  336-30-366ms   | [S3,MB5,B]  366-30-396ms   | [S3,MB6,B]  396-30-426ms   | [S3,MB7,B]  426-30-456ms  
[rank3]:2026-01-02 19:04:18,286 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1904_stage3_step1600.svg
[rank0]:2026-01-02 19:04:18,340 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1904_rank0_stage0.svg
[rank0]:	> Counts Sum: 8640, Total Sum: 10585 (81.62%), Ratio(%) per element: [0.0, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 82.75, 82.75, 82.75, 82.75, 82.75, 82.75, 82.75, 82.75, 82.75, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:04:18,331 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1904_rank1_stage1.svg
[rank1]:	> Counts Sum: 10035, Total Sum: 11745 (85.44%), Ratio(%) per element: [97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 96.55, 95.86, 95.86, 95.86, 95.86, 95.86, 95.86, 95.86, 95.86, 95.86, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 19:04:18,346 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1904_rank2_stage2.svg
[rank2]:	> Counts Sum: 8820, Total Sum: 10440 (84.48%), Ratio(%) per element: [97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 92.41, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:04:18,452 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1904_rank3_stage3.svg
[rank3]:	> Counts Sum: 7407, Total Sum: 9425 (78.59%), Ratio(%) per element: [97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 97.24, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 95.17, 83.44, 83.44, 83.44, 83.44, 83.44, 83.44, 83.44, 83.44, 83.44, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:04:38,384 - Freezing Ratio: [Stage1] 0.89, Threshold: 9.3153e-01
[rank3]:2026-01-02 19:04:38,392 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0174e+00
[rank2]:2026-01-02 19:04:38,385 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1355e+00
[rank0]:2026-01-02 19:04:38,392 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.6847e-01
[rank3]:2026-01-02 19:05:00,451 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2667e+00
[rank2]:2026-01-02 19:05:00,444 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7695e+00
[rank0]:2026-01-02 19:05:00,451 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5695e+00
[rank1]:2026-01-02 19:05:00,444 - Freezing Ratio: [Stage1] 0.89, Threshold: 9.9718e-01
[rank2]:2026-01-02 19:05:22,577 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7566e+00
[rank0]:2026-01-02 19:05:22,584 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4692e+00
[rank1]:2026-01-02 19:05:22,577 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.7945e-01
[rank3]:2026-01-02 19:05:22,583 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3592e-01
[rank1]:2026-01-02 19:05:44,875 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.6740e+00
[rank3]:2026-01-02 19:05:44,882 - Freezing Ratio: [Stage3] 0.83, Threshold: 8.7391e-01
[rank2]:2026-01-02 19:05:44,875 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5144e+00
[rank0]:2026-01-02 19:05:44,883 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.2803e+00
[rank1]:2026-01-02 19:06:07,087 - Freezing Ratio: [Stage1] 0.89, Threshold: 8.5486e-01
[rank3]:2026-01-02 19:06:07,095 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.3386e-01
[rank2]:2026-01-02 19:06:07,088 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.0245e+00
[rank0]:2026-01-02 19:06:07,109 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-02 19:06:07,112 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.3363e+00
[rank3]:2026-01-02 19:06:09,304 - Avg. fwd time: 17.3689 / Avg. bwd time: 32.1238 / Avg. batch time: 413.3017 (ms) / GPU bubble ratio: 4.20%
[rank1]:2026-01-02 19:06:09,382 - Avg. fwd time: 19.1115 / Avg. bwd time: 26.4068 / Avg. batch time: 502.7015 (ms) / GPU bubble ratio: 27.56%
[rank2]:2026-01-02 19:06:09,348 - Avg. fwd time: 16.7297 / Avg. bwd time: 23.5471 / Avg. batch time: 455.4273 (ms) / GPU bubble ratio: 29.25%
[rank2]:2026-01-02 19:06:09,435 -  step: 1650  loss: -4.0000  grad_norm:  0.3141  memory: 64.49GiB(46.13%)  tps: 7,358  tflops: 343.18  mfu: 34.70%
[rank0]:2026-01-02 19:06:09,428 - Avg. fwd time: 17.2059 / Avg. bwd time: 26.4006 / Avg. batch time: 548.8933 (ms) / GPU bubble ratio: 36.44%
[rank0]:2026-01-02 19:06:09,441 -  step: 1650  loss: -4.0000  grad_norm:  0.3141  memory: 74.28GiB(53.13%)  tps: 7,358  tflops: 343.17  mfu: 34.70%
[rank1]:2026-01-02 19:06:09,434 -  step: 1650  loss: -4.0000  grad_norm:  0.3141  memory: 72.50GiB(51.86%)  tps: 7,358  tflops: 343.17  mfu: 34.70%
[rank3]:2026-01-02 19:06:09,444 -  step: 1650  loss:  0.3889  grad_norm:  0.3141  memory: 79.24GiB(56.67%)  tps: 7,358  tflops: 343.18  mfu: 34.70%
[rank2]:2026-01-02 19:06:29,656 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.5009e+00
[rank0]:2026-01-02 19:06:29,663 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1955e+00
[rank1]:2026-01-02 19:06:29,656 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0027e+00
[rank3]:2026-01-02 19:06:29,663 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.0776e+00
[rank1]:2026-01-02 19:06:51,738 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.1484e-01
[rank3]:2026-01-02 19:06:51,744 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.7013e-01
[rank2]:2026-01-02 19:06:51,738 - Freezing Ratio: [Stage2] 0.88, Threshold: 7.7267e-01
[rank0]:2026-01-02 19:06:51,745 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.1243e-01
[rank0]:2026-01-02 19:07:14,032 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1155e+00
[rank1]:2026-01-02 19:07:14,025 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0468e+00
[rank3]:2026-01-02 19:07:14,033 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1591e+00
[rank2]:2026-01-02 19:07:14,025 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9555e+00
[rank2]:2026-01-02 19:07:36,231 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.3333e-01
[rank0]:2026-01-02 19:07:36,238 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.5208e-01
[rank1]:2026-01-02 19:07:36,230 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.0064e-01
[rank3]:2026-01-02 19:07:36,239 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.8253e+00
[rank0]:2026-01-02 19:07:58,375 - [GC] Peforming periodical GC collection 0.00 seconds
[rank1]:2026-01-02 19:07:58,377 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.0612e+00
[rank3]:2026-01-02 19:07:58,386 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.3577e+00
[rank2]:2026-01-02 19:07:58,378 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.6804e+00
[rank0]:2026-01-02 19:07:58,384 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5213e+00
[rank3]:2026-01-02 19:08:00,532 - Avg. fwd time: 17.3855 / Avg. bwd time: 32.0598 / Avg. batch time: 412.9131 (ms) / GPU bubble ratio: 4.20%
[rank2]:2026-01-02 19:08:00,572 - Avg. fwd time: 16.7453 / Avg. bwd time: 23.4777 / Avg. batch time: 454.9695 (ms) / GPU bubble ratio: 29.27%
[rank2]:2026-01-02 19:08:00,654 -  step: 1700  loss: -4.0000  grad_norm:  0.5491  memory: 64.49GiB(46.13%)  tps: 7,366  tflops: 343.54  mfu: 34.74%
[rank0]:2026-01-02 19:08:00,648 - Avg. fwd time: 17.2231 / Avg. bwd time: 26.3202 / Avg. batch time: 548.2681 (ms) / GPU bubble ratio: 36.46%
[rank0]:2026-01-02 19:08:00,660 -  step: 1700  loss: -4.0000  grad_norm:  0.5491  memory: 74.28GiB(53.13%)  tps: 7,366  tflops: 343.53  mfu: 34.74%
[rank1]:2026-01-02 19:08:00,611 - Avg. fwd time: 19.1303 / Avg. bwd time: 26.3236 / Avg. batch time: 502.1625 (ms) / GPU bubble ratio: 27.59%
[rank1]:2026-01-02 19:08:00,654 -  step: 1700  loss: -4.0000  grad_norm:  0.5491  memory: 72.50GiB(51.86%)  tps: 7,366  tflops: 343.53  mfu: 34.74%
[rank3]:2026-01-02 19:08:00,665 -  step: 1700  loss:  0.3948  grad_norm:  0.5491  memory: 79.24GiB(56.67%)  tps: 7,366  tflops: 343.54  mfu: 34.74%
[rank2]:2026-01-02 19:08:00,719 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1908_stage2_step1700.svg
[rank0]:2026-01-02 19:08:00,714 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1908_stage0_step1700.svg
[rank1]:2026-01-02 19:08:00,719 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1908_stage1_step1700.svg
[rank3]:2026-01-02 19:08:00,803 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1908_step1700_rank3.svg
[rank3]:			> Batch Time: 526.98 ms, GPU Bubble Ratio: 37.02%, 34.23%, 41.65%, 27.25%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-88ms     | [S0,MB5,F]  88-17-106ms    | [S0,MB6,F]  106-17-124ms   | [S0,MB7,F]  124-17-142ms   | [S0,MB0,B]  292-23-315ms   | [S0,MB1,B]  322-23-346ms   | [S0,MB2,B]  352-23-376ms   | [S0,MB3,B]  382-23-406ms   | [S0,MB4,B]  412-23-436ms   | [S0,MB5,B]  442-23-466ms   | [S0,MB6,B]  472-23-496ms   | [S0,MB7,B]  503-23-526ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-58ms     | [S1,MB2,F]  58-19-78ms     | [S1,MB3,F]  78-19-97ms     | [S1,MB4,F]  98-19-118ms    | [S1,MB5,F]  118-19-138ms   | [S1,MB6,F]  138-19-158ms   | [S1,MB7,F]  158-19-178ms   | [S1,MB0,B]  268-23-291ms   | [S1,MB1,B]  298-23-321ms   | [S1,MB2,B]  328-23-351ms   | [S1,MB3,B]  358-23-381ms   | [S1,MB4,B]  388-23-411ms   | [S1,MB5,B]  418-23-441ms   | [S1,MB6,B]  448-23-471ms   | [S1,MB7,B]  478-23-502ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-56ms     | [S2,MB1,F]  58-17-75ms     | [S2,MB2,F]  77-17-95ms     | [S2,MB3,F]  97-17-115ms    | [S2,MB4,F]  117-17-135ms   | [S2,MB5,F]  137-17-155ms   | [S2,MB6,F]  158-17-175ms   | [S2,MB7,F]  178-17-195ms   | [S2,MB0,B]  246-21-267ms   | [S2,MB1,B]  276-21-297ms   | [S2,MB2,B]  306-21-328ms   | [S2,MB3,B]  336-21-358ms   | [S2,MB4,B]  366-21-388ms   | [S2,MB5,B]  396-21-418ms   | [S2,MB6,B]  426-21-448ms   | [S2,MB7,B]  456-21-478ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  56-19-75ms     | [S3,MB1,F]  77-17-94ms     | [S3,MB2,F]  96-17-114ms    | [S3,MB3,F]  116-17-134ms   | [S3,MB4,F]  136-17-154ms   | [S3,MB5,F]  156-17-174ms   | [S3,MB6,F]  176-17-194ms   | [S3,MB7,F]  196-17-214ms   | [S3,MB0,B]  216-29-246ms   | [S3,MB1,B]  246-30-276ms   | [S3,MB2,B]  276-30-306ms   | [S3,MB3,B]  306-29-336ms   | [S3,MB4,B]  336-29-366ms   | [S3,MB5,B]  366-29-396ms   | [S3,MB6,B]  396-30-426ms   | [S3,MB7,B]  426-29-456ms  
[rank3]:2026-01-02 19:08:00,850 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1908_stage3_step1700.svg
[rank2]:2026-01-02 19:08:00,900 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1908_rank2_stage2.svg
[rank2]:	> Counts Sum: 9450, Total Sum: 11160 (84.68%), Ratio(%) per element: [97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 19:08:00,896 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1908_rank0_stage0.svg
[rank0]:	> Counts Sum: 9270, Total Sum: 11315 (81.93%), Ratio(%) per element: [0.0, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 83.87, 83.87, 83.87, 83.87, 83.87, 83.87, 83.87, 83.87, 83.87, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:08:00,907 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1908_rank1_stage1.svg
[rank1]:	> Counts Sum: 10755, Total Sum: 12555 (85.66%), Ratio(%) per element: [97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.77, 96.12, 96.12, 96.12, 96.12, 96.12, 96.12, 96.12, 96.12, 96.12, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 92.9, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:08:01,021 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1908_rank3_stage3.svg
[rank3]:	> Counts Sum: 7947, Total Sum: 10075 (78.88%), Ratio(%) per element: [97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 97.41, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 95.48, 84.51, 84.51, 84.51, 84.51, 84.51, 84.51, 84.51, 84.51, 84.51, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:08:20,919 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7739e+00
[rank3]:2026-01-02 19:08:20,926 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6459e+00
[rank2]:2026-01-02 19:08:20,919 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1121e+00
[rank0]:2026-01-02 19:08:20,926 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.9714e+00
[rank2]:2026-01-02 19:08:42,904 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.3323e+00
[rank0]:2026-01-02 19:08:42,912 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7096e-01
[rank1]:2026-01-02 19:08:42,905 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.3746e-01
[rank3]:2026-01-02 19:08:42,911 - Freezing Ratio: [Stage3] 0.83, Threshold: 3.8587e+00
[rank2]:2026-01-02 19:09:05,015 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2814e-01
[rank0]:2026-01-02 19:09:05,022 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.1903e-01
[rank1]:2026-01-02 19:09:05,015 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.4965e-01
[rank3]:2026-01-02 19:09:05,022 - Freezing Ratio: [Stage3] 0.83, Threshold: 6.5890e-01
[rank2]:2026-01-02 19:09:27,432 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.7175e+00
[rank0]:2026-01-02 19:09:27,439 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9681e+00
[rank1]:2026-01-02 19:09:27,432 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7408e+00
[rank3]:2026-01-02 19:09:27,438 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.5397e+00
[rank2]:2026-01-02 19:09:49,669 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6499e+00
[rank0]:2026-01-02 19:09:49,677 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 19:09:49,680 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2206e-01
[rank1]:2026-01-02 19:09:49,669 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1070e+00
[rank3]:2026-01-02 19:09:49,678 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.7798e-01
[rank2]:2026-01-02 19:09:51,870 - Avg. fwd time: 16.7593 / Avg. bwd time: 23.4120 / Avg. batch time: 454.5349 (ms) / GPU bubble ratio: 29.30%
[rank1]:2026-01-02 19:09:51,905 - Avg. fwd time: 19.1471 / Avg. bwd time: 26.2448 / Avg. batch time: 501.6502 (ms) / GPU bubble ratio: 27.61%
[rank3]:2026-01-02 19:09:51,829 - Avg. fwd time: 17.4004 / Avg. bwd time: 31.9984 / Avg. batch time: 412.5327 (ms) / GPU bubble ratio: 4.20%
[rank2]:2026-01-02 19:09:51,948 -  step: 1750  loss: -4.0000  grad_norm:  0.9394  memory: 64.49GiB(46.13%)  tps: 7,361  tflops: 343.31  mfu: 34.71%
[rank0]:2026-01-02 19:09:51,942 - Avg. fwd time: 17.2389 / Avg. bwd time: 26.2445 / Avg. batch time: 547.6753 (ms) / GPU bubble ratio: 36.48%
[rank0]:2026-01-02 19:09:51,954 -  step: 1750  loss: -4.0000  grad_norm:  0.9394  memory: 74.28GiB(53.13%)  tps: 7,361  tflops: 343.30  mfu: 34.71%
[rank1]:2026-01-02 19:09:51,948 -  step: 1750  loss: -4.0000  grad_norm:  0.9394  memory: 72.50GiB(51.86%)  tps: 7,361  tflops: 343.31  mfu: 34.71%
[rank3]:2026-01-02 19:09:51,959 -  step: 1750  loss:  0.4158  grad_norm:  0.9394  memory: 79.24GiB(56.67%)  tps: 7,361  tflops: 343.32  mfu: 34.71%
[rank2]:2026-01-02 19:10:12,055 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.7491e+00
[rank0]:2026-01-02 19:10:12,062 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.4625e+00
[rank1]:2026-01-02 19:10:12,055 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2225e-01
[rank3]:2026-01-02 19:10:12,063 - Freezing Ratio: [Stage3] 0.83, Threshold: 7.1579e-01
[rank2]:2026-01-02 19:10:34,419 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.8913e+00
[rank0]:2026-01-02 19:10:34,427 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1606e+00
[rank1]:2026-01-02 19:10:34,419 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1587e+00
[rank3]:2026-01-02 19:10:34,428 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0923e+00
[rank2]:2026-01-02 19:10:56,241 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.3116e+00
[rank0]:2026-01-02 19:10:56,248 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2239e+00
[rank1]:2026-01-02 19:10:56,240 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.7601e+00
[rank3]:2026-01-02 19:10:56,247 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7941e+00
[rank1]:2026-01-02 19:11:17,185 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6461e+00
[rank3]:2026-01-02 19:11:17,192 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.7748e+00
[rank2]:2026-01-02 19:11:17,185 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0256e+00
[rank0]:2026-01-02 19:11:17,193 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.5206e+00
[rank2]:2026-01-02 19:11:38,142 - Freezing Ratio: [Stage2] 0.88, Threshold: 6.2881e-01
[rank0]:2026-01-02 19:11:38,141 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:11:38,150 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.0986e-01
[rank1]:2026-01-02 19:11:38,143 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9424e-01
[rank3]:2026-01-02 19:11:38,150 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0298e+00
[rank3]:2026-01-02 19:11:40,192 - Avg. fwd time: 17.4046 / Avg. bwd time: 31.9311 / Avg. batch time: 412.0181 (ms) / GPU bubble ratio: 4.21%
[rank2]:2026-01-02 19:11:40,236 - Avg. fwd time: 16.7655 / Avg. bwd time: 23.3462 / Avg. batch time: 453.9464 (ms) / GPU bubble ratio: 29.31%
[rank1]:2026-01-02 19:11:40,274 - Avg. fwd time: 19.1537 / Avg. bwd time: 26.1674 / Avg. batch time: 500.9787 (ms) / GPU bubble ratio: 27.63%
[rank2]:2026-01-02 19:11:40,329 -  step: 1800  loss: -4.0000  grad_norm:  0.7687  memory: 64.49GiB(46.13%)  tps: 7,559  tflops: 352.53  mfu: 35.65%
[rank2]:2026-01-02 19:11:40,393 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1911_stage2_step1800.svg
[rank0]:2026-01-02 19:11:40,322 - Avg. fwd time: 17.2443 / Avg. bwd time: 26.1702 / Avg. batch time: 546.9188 (ms) / GPU bubble ratio: 36.50%
[rank0]:2026-01-02 19:11:40,336 -  step: 1800  loss: -4.0000  grad_norm:  0.7687  memory: 74.28GiB(53.13%)  tps: 7,559  tflops: 352.53  mfu: 35.65%
[rank0]:2026-01-02 19:11:40,394 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1911_stage0_step1800.svg
[rank1]:2026-01-02 19:11:40,329 -  step: 1800  loss: -4.0000  grad_norm:  0.7687  memory: 72.50GiB(51.86%)  tps: 7,559  tflops: 352.53  mfu: 35.65%
[rank1]:2026-01-02 19:11:40,391 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1911_stage1_step1800.svg
[rank3]:2026-01-02 19:11:40,338 -  step: 1800  loss:  0.0773  grad_norm:  0.7687  memory: 79.24GiB(56.67%)  tps: 7,559  tflops: 352.55  mfu: 35.65%
[rank3]:2026-01-02 19:11:40,470 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1911_step1800_rank3.svg
[rank3]:			> Batch Time: 512.28 ms, GPU Bubble Ratio: 36.65%, 34.01%, 41.34%, 27.66%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-16-35ms     | [S0,MB2,F]  35-16-51ms     | [S0,MB3,F]  51-16-68ms     | [S0,MB4,F]  68-16-85ms     | [S0,MB5,F]  85-16-102ms    | [S0,MB6,F]  102-16-119ms   | [S0,MB7,F]  119-16-136ms   | [S0,MB0,B]  282-23-306ms   | [S0,MB1,B]  312-23-335ms   | [S0,MB2,B]  341-23-364ms   | [S0,MB3,B]  370-23-394ms   | [S0,MB4,B]  400-23-423ms   | [S0,MB5,B]  429-23-452ms   | [S0,MB6,B]  458-23-482ms   | [S0,MB7,B]  488-23-512ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-37ms     | [S1,MB1,F]  37-18-56ms     | [S1,MB2,F]  56-18-75ms     | [S1,MB3,F]  76-18-94ms     | [S1,MB4,F]  95-18-114ms    | [S1,MB5,F]  114-18-133ms   | [S1,MB6,F]  133-18-152ms   | [S1,MB7,F]  152-18-171ms   | [S1,MB0,B]  258-23-282ms   | [S1,MB1,B]  288-23-311ms   | [S1,MB2,B]  317-23-340ms   | [S1,MB3,B]  346-23-370ms   | [S1,MB4,B]  376-23-399ms   | [S1,MB5,B]  405-23-428ms   | [S1,MB6,B]  434-23-457ms   | [S1,MB7,B]  464-23-487ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  56-16-73ms     | [S2,MB2,F]  75-16-92ms     | [S2,MB3,F]  94-16-111ms    | [S2,MB4,F]  113-16-130ms   | [S2,MB5,F]  133-16-149ms   | [S2,MB6,F]  152-16-168ms   | [S2,MB7,F]  171-16-187ms   | [S2,MB0,B]  237-20-258ms   | [S2,MB1,B]  266-20-287ms   | [S2,MB2,B]  296-20-317ms   | [S2,MB3,B]  325-20-346ms   | [S2,MB4,B]  354-20-375ms   | [S2,MB5,B]  383-20-404ms   | [S2,MB6,B]  413-20-434ms   | [S2,MB7,B]  442-20-463ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-72ms     | [S3,MB1,F]  75-16-91ms     | [S3,MB2,F]  94-16-110ms    | [S3,MB3,F]  113-16-129ms   | [S3,MB4,F]  132-16-148ms   | [S3,MB5,F]  151-16-167ms   | [S3,MB6,F]  170-16-187ms   | [S3,MB7,F]  189-17-206ms   | [S3,MB0,B]  208-28-237ms   | [S3,MB1,B]  236-29-266ms   | [S3,MB2,B]  266-29-295ms   | [S3,MB3,B]  295-29-324ms   | [S3,MB4,B]  325-29-354ms   | [S3,MB5,B]  354-29-383ms   | [S3,MB6,B]  383-29-412ms   | [S3,MB7,B]  412-29-442ms  
[rank3]:2026-01-02 19:11:40,515 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1911_stage3_step1800.svg
[rank2]:2026-01-02 19:11:40,579 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1911_rank2_stage2.svg
[rank2]:	> Counts Sum: 10080, Total Sum: 11880 (84.85%), Ratio(%) per element: [97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 19:11:40,588 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1911_rank0_stage0.svg
[rank0]:	> Counts Sum: 9900, Total Sum: 12045 (82.19%), Ratio(%) per element: [0.0, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 84.84, 84.84, 84.84, 84.84, 84.84, 84.84, 84.84, 84.84, 84.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:11:40,574 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1911_rank1_stage1.svg
[rank1]:	> Counts Sum: 11475, Total Sum: 13365 (85.86%), Ratio(%) per element: [97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 96.36, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 93.33, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:11:40,682 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1911_rank3_stage3.svg
[rank3]:	> Counts Sum: 8487, Total Sum: 10725 (79.13%), Ratio(%) per element: [97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 97.57, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 95.75, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 85.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 19:11:59,590 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.9362e+00
[rank1]:2026-01-02 19:11:59,590 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.8673e+00
[rank0]:2026-01-02 19:11:59,597 - Freezing Ratio: [Stage0] 0.86, Threshold: 7.8735e-01
[rank3]:2026-01-02 19:11:59,597 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6374e+00
[rank2]:2026-01-02 19:12:21,365 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.8863e+00
[rank1]:2026-01-02 19:12:21,366 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.4479e+00
[rank0]:2026-01-02 19:12:21,372 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.8828e+00
[rank3]:2026-01-02 19:12:21,372 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.5392e+00
[rank2]:2026-01-02 19:12:42,953 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.2794e+00
[rank1]:2026-01-02 19:12:42,953 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.1174e+00
[rank0]:2026-01-02 19:12:42,960 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.5239e-01
[rank3]:2026-01-02 19:12:42,961 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.2902e+00
[rank2]:2026-01-02 19:13:04,407 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.6819e-01
[rank1]:2026-01-02 19:13:04,407 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.8986e-01
[rank0]:2026-01-02 19:13:04,414 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2635e+00
[rank3]:2026-01-02 19:13:04,416 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.0284e+00
[rank2]:2026-01-02 19:13:25,835 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.3072e+00
[rank1]:2026-01-02 19:13:25,834 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.3177e+00
[rank0]:2026-01-02 19:13:25,847 - [GC] Peforming periodical GC collection 0.02 seconds
[rank0]:2026-01-02 19:13:25,850 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.8277e+00
[rank3]:2026-01-02 19:13:25,842 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.8477e-01
[rank2]:2026-01-02 19:13:27,968 - Avg. fwd time: 16.7703 / Avg. bwd time: 23.2836 / Avg. batch time: 453.3818 (ms) / GPU bubble ratio: 29.32%
[rank3]:2026-01-02 19:13:27,928 - Avg. fwd time: 17.4072 / Avg. bwd time: 31.8672 / Avg. batch time: 411.5191 (ms) / GPU bubble ratio: 4.21%
[rank2]:2026-01-02 19:13:28,048 -  step: 1850  loss: -4.0000  grad_norm:  1.1569  memory: 64.49GiB(46.13%)  tps: 7,605  tflops: 354.70  mfu: 35.86%
[rank1]:2026-01-02 19:13:28,005 - Avg. fwd time: 19.1589 / Avg. bwd time: 26.0934 / Avg. batch time: 500.3329 (ms) / GPU bubble ratio: 27.64%
[rank1]:2026-01-02 19:13:28,048 -  step: 1850  loss: -4.0000  grad_norm:  1.1569  memory: 72.50GiB(51.86%)  tps: 7,605  tflops: 354.70  mfu: 35.86%
[rank0]:2026-01-02 19:13:28,042 - Avg. fwd time: 17.2485 / Avg. bwd time: 26.0996 / Avg. batch time: 546.1877 (ms) / GPU bubble ratio: 36.51%
[rank0]:2026-01-02 19:13:28,054 -  step: 1850  loss: -4.0000  grad_norm:  1.1569  memory: 74.28GiB(53.13%)  tps: 7,605  tflops: 354.70  mfu: 35.86%
[rank3]:2026-01-02 19:13:28,056 -  step: 1850  loss:  0.3529  grad_norm:  1.1569  memory: 79.24GiB(56.67%)  tps: 7,605  tflops: 354.71  mfu: 35.87%
[rank2]:2026-01-02 19:13:47,681 - Freezing Ratio: [Stage2] 0.88, Threshold: 8.3815e-01
[rank1]:2026-01-02 19:13:47,681 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.8745e-01
[rank0]:2026-01-02 19:13:47,688 - Freezing Ratio: [Stage0] 0.86, Threshold: 5.5286e-01
[rank3]:2026-01-02 19:13:47,688 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.1962e+00
[rank0]:2026-01-02 19:14:09,162 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.8871e+00
[rank3]:2026-01-02 19:14:09,164 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8161e+00
[rank2]:2026-01-02 19:14:09,154 - Freezing Ratio: [Stage2] 0.88, Threshold: 3.0148e+00
[rank1]:2026-01-02 19:14:09,154 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.3122e+00
[rank2]:2026-01-02 19:14:30,399 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.1668e+00
[rank1]:2026-01-02 19:14:30,398 - Freezing Ratio: [Stage1] 0.89, Threshold: 6.9580e-01
[rank3]:2026-01-02 19:14:30,408 - Freezing Ratio: [Stage3] 0.83, Threshold: 6.3632e-01
[rank0]:2026-01-02 19:14:30,406 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6658e-01
[rank2]:2026-01-02 19:14:51,646 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.3283e+00
[rank1]:2026-01-02 19:14:51,646 - Freezing Ratio: [Stage1] 0.89, Threshold: 9.6924e-01
[rank3]:2026-01-02 19:14:51,653 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.1534e+00
[rank0]:2026-01-02 19:14:51,653 - Freezing Ratio: [Stage0] 0.86, Threshold: 6.8151e-01
[rank2]:2026-01-02 19:15:12,771 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.5524e+00
[rank1]:2026-01-02 19:15:12,771 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.2505e+00
[rank3]:2026-01-02 19:15:12,780 - Freezing Ratio: [Stage3] 0.83, Threshold: 1.6643e+00
[rank0]:2026-01-02 19:15:12,770 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:15:12,778 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.2067e+00
[rank2]:2026-01-02 19:15:14,897 - Avg. fwd time: 16.7731 / Avg. bwd time: 23.2235 / Avg. batch time: 452.8017 (ms) / GPU bubble ratio: 29.33%
[rank3]:2026-01-02 19:15:14,857 - Avg. fwd time: 17.4071 / Avg. bwd time: 31.8046 / Avg. batch time: 411.0085 (ms) / GPU bubble ratio: 4.21%
[rank2]:2026-01-02 19:15:14,995 -  step: 1900  loss: -4.0000  grad_norm:  0.6551  memory: 64.49GiB(46.13%)  tps: 7,660  tflops: 357.26  mfu: 36.12%
[rank3]:2026-01-02 19:15:15,003 -  step: 1900  loss:  0.2047  grad_norm:  0.6551  memory: 79.24GiB(56.67%)  tps: 7,660  tflops: 357.27  mfu: 36.12%
[rank1]:2026-01-02 19:15:14,942 - Avg. fwd time: 19.1617 / Avg. bwd time: 26.0229 / Avg. batch time: 499.6738 (ms) / GPU bubble ratio: 27.66%
[rank1]:2026-01-02 19:15:14,995 -  step: 1900  loss: -4.0000  grad_norm:  0.6551  memory: 72.50GiB(51.86%)  tps: 7,660  tflops: 357.26  mfu: 36.12%
[rank0]:2026-01-02 19:15:14,988 - Avg. fwd time: 17.2505 / Avg. bwd time: 26.0322 / Avg. batch time: 545.4480 (ms) / GPU bubble ratio: 36.52%
[rank0]:2026-01-02 19:15:15,001 -  step: 1900  loss: -4.0000  grad_norm:  0.6551  memory: 74.28GiB(53.13%)  tps: 7,660  tflops: 357.26  mfu: 36.12%
[rank2]:2026-01-02 19:15:15,056 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1915_stage2_step1900.svg
[rank0]:2026-01-02 19:15:15,057 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1915_stage0_step1900.svg
[rank1]:2026-01-02 19:15:15,053 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1915_stage1_step1900.svg
[rank3]:2026-01-02 19:15:15,134 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1915_step1900_rank3.svg
[rank3]:			> Batch Time: 515.58 ms, GPU Bubble Ratio: 36.77%, 34.00%, 41.36%, 27.46%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-17-34ms     | [S0,MB2,F]  34-16-51ms     | [S0,MB3,F]  51-17-68ms     | [S0,MB4,F]  68-17-85ms     | [S0,MB5,F]  85-17-103ms    | [S0,MB6,F]  103-17-120ms   | [S0,MB7,F]  120-17-137ms   | [S0,MB0,B]  284-23-308ms   | [S0,MB1,B]  314-23-337ms   | [S0,MB2,B]  343-23-367ms   | [S0,MB3,B]  373-23-396ms   | [S0,MB4,B]  402-23-426ms   | [S0,MB5,B]  432-23-455ms   | [S0,MB6,B]  461-23-485ms   | [S0,MB7,B]  492-23-515ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-19-37ms     | [S1,MB1,F]  37-19-56ms     | [S1,MB2,F]  57-19-76ms     | [S1,MB3,F]  76-19-95ms     | [S1,MB4,F]  95-19-114ms    | [S1,MB5,F]  114-19-134ms   | [S1,MB6,F]  134-19-153ms   | [S1,MB7,F]  153-19-172ms   | [S1,MB0,B]  260-23-284ms   | [S1,MB1,B]  290-23-313ms   | [S1,MB2,B]  319-23-343ms   | [S1,MB3,B]  349-23-372ms   | [S1,MB4,B]  378-23-402ms   | [S1,MB5,B]  408-23-431ms   | [S1,MB6,B]  437-23-461ms   | [S1,MB7,B]  467-23-491ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  37-17-54ms     | [S2,MB1,F]  56-16-73ms     | [S2,MB2,F]  75-16-92ms     | [S2,MB3,F]  95-16-112ms    | [S2,MB4,F]  114-16-131ms   | [S2,MB5,F]  133-16-150ms   | [S2,MB6,F]  153-16-170ms   | [S2,MB7,F]  172-16-189ms   | [S2,MB0,B]  239-20-260ms   | [S2,MB1,B]  268-20-289ms   | [S2,MB2,B]  298-21-319ms   | [S2,MB3,B]  327-21-348ms   | [S2,MB4,B]  357-21-378ms   | [S2,MB5,B]  386-21-407ms   | [S2,MB6,B]  416-21-437ms   | [S2,MB7,B]  445-21-466ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  54-18-73ms     | [S3,MB1,F]  75-16-92ms     | [S3,MB2,F]  94-17-111ms    | [S3,MB3,F]  113-17-130ms   | [S3,MB4,F]  132-17-149ms   | [S3,MB5,F]  152-17-169ms   | [S3,MB6,F]  171-17-188ms   | [S3,MB7,F]  190-17-207ms   | [S3,MB0,B]  209-29-238ms   | [S3,MB1,B]  238-29-267ms   | [S3,MB2,B]  268-29-297ms   | [S3,MB3,B]  297-29-327ms   | [S3,MB4,B]  327-29-356ms   | [S3,MB5,B]  356-29-386ms   | [S3,MB6,B]  386-29-415ms   | [S3,MB7,B]  415-29-445ms  
[rank3]:2026-01-02 19:15:15,177 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1915_stage3_step1900.svg
[rank2]:2026-01-02 19:15:15,233 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1915_rank2_stage2.svg
[rank2]:	> Counts Sum: 10710, Total Sum: 12600 (85.00%), Ratio(%) per element: [97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 19:15:15,240 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1915_rank0_stage0.svg
[rank0]:	> Counts Sum: 10530, Total Sum: 12775 (82.43%), Ratio(%) per element: [0.0, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 85.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:15:15,230 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1915_rank1_stage1.svg
[rank1]:	> Counts Sum: 12195, Total Sum: 14175 (86.03%), Ratio(%) per element: [97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 96.57, 96.57, 96.57, 96.57, 96.57, 96.57, 96.57, 96.57, 96.57, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 93.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:15:15,341 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1915_rank3_stage3.svg
[rank3]:	> Counts Sum: 9027, Total Sum: 11375 (79.36%), Ratio(%) per element: [97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 97.71, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 86.28, 86.28, 86.28, 86.28, 86.28, 86.28, 86.28, 86.28, 86.28, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 19:15:34,482 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.6393e+00
[rank3]:2026-01-02 19:15:34,491 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.6970e+00
[rank0]:2026-01-02 19:15:34,489 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.6993e+00
[rank1]:2026-01-02 19:15:34,482 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.6795e+00
[rank2]:2026-01-02 19:15:55,611 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.4118e+00
[rank3]:2026-01-02 19:15:55,618 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.6714e+00
[rank0]:2026-01-02 19:15:55,618 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.6844e+00
[rank1]:2026-01-02 19:15:55,612 - Freezing Ratio: [Stage1] 0.89, Threshold: 4.4237e+00
[rank2]:2026-01-02 19:16:16,775 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.0455e+00
[rank0]:2026-01-02 19:16:16,782 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.9751e+00
[rank1]:2026-01-02 19:16:16,776 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.9295e+00
[rank3]:2026-01-02 19:16:16,782 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.0025e+00
[rank3]:2026-01-02 19:16:38,086 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.3368e+00
[rank0]:2026-01-02 19:16:38,086 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.5708e-01
[rank2]:2026-01-02 19:16:38,079 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.6552e+00
[rank1]:2026-01-02 19:16:38,078 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.7208e+00
[rank3]:2026-01-02 19:16:59,215 - Freezing Ratio: [Stage3] 0.83, Threshold: 4.9744e-01
[rank0]:2026-01-02 19:16:59,213 - [GC] Peforming periodical GC collection 0.01 seconds
[rank0]:2026-01-02 19:16:59,216 - Freezing Ratio: [Stage0] 0.86, Threshold: 8.7252e-01
[rank1]:2026-01-02 19:16:59,209 - Freezing Ratio: [Stage1] 0.89, Threshold: 3.2768e-01
[rank2]:2026-01-02 19:16:59,208 - Freezing Ratio: [Stage2] 0.88, Threshold: 5.1776e-01
[rank3]:2026-01-02 19:17:01,264 - Avg. fwd time: 17.4055 / Avg. bwd time: 31.7435 / Avg. batch time: 410.4978 (ms) / GPU bubble ratio: 4.22%
[rank2]:2026-01-02 19:17:01,297 - Avg. fwd time: 16.7748 / Avg. bwd time: 23.1657 / Avg. batch time: 452.2290 (ms) / GPU bubble ratio: 29.34%
[rank3]:2026-01-02 19:17:01,383 -  step: 1950  loss:  0.1744  grad_norm:  0.8552  memory: 79.24GiB(56.67%)  tps: 7,701  tflops: 359.17  mfu: 36.32%
[rank0]:2026-01-02 19:17:01,368 - Avg. fwd time: 17.2509 / Avg. bwd time: 25.9680 / Avg. batch time: 544.7176 (ms) / GPU bubble ratio: 36.53%
[rank0]:2026-01-02 19:17:01,380 -  step: 1950  loss: -4.0000  grad_norm:  0.8552  memory: 74.28GiB(53.13%)  tps: 7,701  tflops: 359.17  mfu: 36.32%
[rank1]:2026-01-02 19:17:01,333 - Avg. fwd time: 19.1630 / Avg. bwd time: 25.9554 / Avg. batch time: 499.0240 (ms) / GPU bubble ratio: 27.67%
[rank1]:2026-01-02 19:17:01,374 -  step: 1950  loss: -4.0000  grad_norm:  0.8552  memory: 72.50GiB(51.86%)  tps: 7,701  tflops: 359.17  mfu: 36.32%
[rank2]:2026-01-02 19:17:01,374 -  step: 1950  loss: -4.0000  grad_norm:  0.8552  memory: 64.49GiB(46.13%)  tps: 7,701  tflops: 359.17  mfu: 36.32%
[rank3]:2026-01-02 19:17:20,515 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.8934e+00
[rank1]:2026-01-02 19:17:20,506 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.9115e+00
[rank0]:2026-01-02 19:17:20,513 - Freezing Ratio: [Stage0] 0.86, Threshold: 2.4236e+00
[rank2]:2026-01-02 19:17:20,506 - Freezing Ratio: [Stage2] 0.88, Threshold: 2.7084e+00
[rank3]:2026-01-02 19:17:41,703 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.0276e+00
[rank1]:2026-01-02 19:17:41,695 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.7881e+00
[rank0]:2026-01-02 19:17:41,702 - Freezing Ratio: [Stage0] 0.86, Threshold: 4.3919e+00
[rank2]:2026-01-02 19:17:41,696 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.9674e+00
[rank3]:2026-01-02 19:18:02,821 - Freezing Ratio: [Stage3] 0.83, Threshold: 9.0294e-01
[rank0]:2026-01-02 19:18:02,820 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.1346e+00
[rank1]:2026-01-02 19:18:02,814 - Freezing Ratio: [Stage1] 0.89, Threshold: 1.0596e+00
[rank2]:2026-01-02 19:18:02,813 - Freezing Ratio: [Stage2] 0.88, Threshold: 9.9993e-01
[rank3]:2026-01-02 19:18:24,163 - Freezing Ratio: [Stage3] 0.83, Threshold: 2.2013e+00
[rank1]:2026-01-02 19:18:24,155 - Freezing Ratio: [Stage1] 0.89, Threshold: 2.1534e+00
[rank0]:2026-01-02 19:18:24,162 - Freezing Ratio: [Stage0] 0.86, Threshold: 1.5087e+00
[rank2]:2026-01-02 19:18:24,156 - Freezing Ratio: [Stage2] 0.88, Threshold: 1.9176e+00
[rank3]:2026-01-02 19:18:45,398 - Freezing Ratio: [Stage3] 0.83, Threshold: 5.1047e+00
[rank1]:2026-01-02 19:18:45,390 - Freezing Ratio: [Stage1] 0.89, Threshold: 5.0316e+00
[rank0]:2026-01-02 19:18:45,389 - [GC] Peforming periodical GC collection 0.00 seconds
[rank0]:2026-01-02 19:18:45,397 - Freezing Ratio: [Stage0] 0.86, Threshold: 3.0019e+00
[rank2]:2026-01-02 19:18:45,390 - Freezing Ratio: [Stage2] 0.88, Threshold: 4.5777e+00
[rank3]:2026-01-02 19:18:47,492 - Avg. fwd time: 17.4044 / Avg. bwd time: 31.6857 / Avg. batch time: 410.0181 (ms) / GPU bubble ratio: 4.22%
[rank2]:2026-01-02 19:18:47,527 - Avg. fwd time: 16.7765 / Avg. bwd time: 23.1108 / Avg. batch time: 451.6863 (ms) / GPU bubble ratio: 29.35%
[rank3]:2026-01-02 19:18:47,624 -  step: 2000  loss:  0.2092  grad_norm:  0.5478  memory: 79.24GiB(56.67%)  tps: 7,711  tflops: 359.65  mfu: 36.36%
[rank3]:2026-01-02 19:18:47,625 - â„¹ï¸ final step: 2000  loss:  0.2092  grad_norm:  0.5478  tps: 7,352  tflops: 342.92  mfu: 33.46%
[rank3]:2026-01-02 19:18:47,625 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 19:18:47,562 - Avg. fwd time: 19.1647 / Avg. bwd time: 25.8913 / Avg. batch time: 498.4081 (ms) / GPU bubble ratio: 27.68%
[rank1]:2026-01-02 19:18:47,613 -  step: 2000  loss: -4.0000  grad_norm:  0.5478  memory: 72.50GiB(51.86%)  tps: 7,711  tflops: 359.64  mfu: 36.36%
[rank1]:2026-01-02 19:18:47,613 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.5478  tps: 7,339  tflops: 342.30  mfu: 33.44%
[rank1]:2026-01-02 19:18:47,614 - Saving the checkpoint (or staging if async is enabled).
[rank1]:2026-01-02 19:18:47,617 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 19:18:47,607 - Avg. fwd time: 17.2516 / Avg. bwd time: 25.9069 / Avg. batch time: 544.0256 (ms) / GPU bubble ratio: 36.53%
[rank0]:2026-01-02 19:18:47,620 -  step: 2000  loss: -4.0000  grad_norm:  0.5478  memory: 74.28GiB(53.13%)  tps: 7,711  tflops: 359.64  mfu: 36.36%
[rank0]:2026-01-02 19:18:47,620 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.5478  tps: 7,339  tflops: 342.28  mfu: 33.43%
[rank0]:2026-01-02 19:18:47,620 - Saving the checkpoint (or staging if async is enabled).
[rank0]:2026-01-02 19:18:47,628 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank2]:2026-01-02 19:18:47,613 -  step: 2000  loss: -4.0000  grad_norm:  0.5478  memory: 64.49GiB(46.13%)  tps: 7,711  tflops: 359.64  mfu: 36.36%
[rank2]:2026-01-02 19:18:47,613 - â„¹ï¸ final step: 2000  loss: -4.0000  grad_norm:  0.5478  tps: 7,359  tflops: 343.20  mfu: 33.48%
[rank2]:2026-01-02 19:18:47,614 - Saving the checkpoint (or staging if async is enabled).
[rank2]:2026-01-02 19:18:47,619 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank3]:2026-01-02 19:18:47,632 - Saving a model only checkpoint in torch.float16 at last step, step 2000.
[rank0]:2026-01-02 19:18:57,576 - [GC] GC collection invoked by checkpointer. 0.00 seconds
[rank2]:2026-01-02 19:18:57,650 - âœ… Frozen Ratio History of Rank 2 (Stage 2) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank2/260102_1918_stage2_final2000.svg
[rank3]:2026-01-02 19:18:57,731 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1918_final2000_rank3.svg
[rank3]:			> Batch Time: 525.97 ms, GPU Bubble Ratio: 37.28%, 34.54%, 41.90%, 27.68%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-18-18ms      | [S0,MB1,F]  18-17-35ms     | [S0,MB2,F]  35-17-52ms     | [S0,MB3,F]  52-17-70ms     | [S0,MB4,F]  70-17-87ms     | [S0,MB5,F]  87-17-105ms    | [S0,MB6,F]  105-17-122ms   | [S0,MB7,F]  122-17-140ms   | [S0,MB0,B]  290-23-314ms   | [S0,MB1,B]  321-23-344ms   | [S0,MB2,B]  351-23-374ms   | [S0,MB3,B]  381-23-404ms   | [S0,MB4,B]  411-23-434ms   | [S0,MB5,B]  441-23-464ms   | [S0,MB6,B]  471-23-494ms   | [S0,MB7,B]  502-23-525ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  18-19-38ms     | [S1,MB1,F]  38-19-57ms     | [S1,MB2,F]  57-19-77ms     | [S1,MB3,F]  77-19-96ms     | [S1,MB4,F]  97-19-116ms    | [S1,MB5,F]  116-19-136ms   | [S1,MB6,F]  136-19-156ms   | [S1,MB7,F]  156-19-176ms   | [S1,MB0,B]  266-23-289ms   | [S1,MB1,B]  296-23-320ms   | [S1,MB2,B]  327-23-350ms   | [S1,MB3,B]  357-23-380ms   | [S1,MB4,B]  387-23-410ms   | [S1,MB5,B]  417-23-440ms   | [S1,MB6,B]  446-23-470ms   | [S1,MB7,B]  477-23-500ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  38-17-55ms     | [S2,MB1,F]  57-16-74ms     | [S2,MB2,F]  77-16-94ms     | [S2,MB3,F]  96-16-113ms    | [S2,MB4,F]  116-16-133ms   | [S2,MB5,F]  136-16-153ms   | [S2,MB6,F]  156-17-173ms   | [S2,MB7,F]  176-17-193ms   | [S2,MB0,B]  243-21-264ms   | [S2,MB1,B]  274-21-296ms   | [S2,MB2,B]  305-21-326ms   | [S2,MB3,B]  335-21-356ms   | [S2,MB4,B]  365-21-386ms   | [S2,MB5,B]  395-21-416ms   | [S2,MB6,B]  425-21-446ms   | [S2,MB7,B]  455-21-476ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  55-18-74ms     | [S3,MB1,F]  76-17-93ms     | [S3,MB2,F]  95-17-113ms    | [S3,MB3,F]  115-17-132ms   | [S3,MB4,F]  134-17-152ms   | [S3,MB5,F]  154-17-172ms   | [S3,MB6,F]  174-17-191ms   | [S3,MB7,F]  193-17-211ms   | [S3,MB0,B]  213-29-243ms   | [S3,MB1,B]  243-29-273ms   | [S3,MB2,B]  274-30-304ms   | [S3,MB3,B]  304-29-334ms   | [S3,MB4,B]  334-29-364ms   | [S3,MB5,B]  364-29-394ms   | [S3,MB6,B]  394-29-424ms   | [S3,MB7,B]  424-29-454ms  
[rank1]:2026-01-02 19:18:57,651 - âœ… Frozen Ratio History of Rank 1 (Stage 1) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank1/260102_1918_stage1_final2000.svg
[rank0]:2026-01-02 19:18:57,650 - âœ… Frozen Ratio History of Rank 0 (Stage 0) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank0/260102_1918_stage0_final2000.svg
[rank1]:2026-01-02 19:18:57,834 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1918_rank1_stage1.svg
[rank1]:	> Counts Sum: 12915, Total Sum: 14985 (86.19%), Ratio(%) per element: [97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 96.75, 96.75, 96.75, 96.75, 96.75, 96.75, 96.75, 96.75, 96.75, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank1]:2026-01-02 19:18:57,834 - Destroying the purge thread.
[rank0]:2026-01-02 19:18:57,828 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1918_rank0_stage0.svg
[rank0]:	> Counts Sum: 11160, Total Sum: 13505 (82.64%), Ratio(%) per element: [0.0, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 97.29, 86.48, 86.48, 86.48, 86.48, 86.48, 86.48, 86.48, 86.48, 86.48, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank0]:2026-01-02 19:18:57,828 - Sleeping 2 seconds for other ranks to complete
[rank2]:2026-01-02 19:18:57,821 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1918_rank2_stage2.svg
[rank2]:	> Counts Sum: 11340, Total Sum: 13320 (85.14%), Ratio(%) per element: [97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 94.05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank2]:2026-01-02 19:18:57,822 - Destroying the purge thread.
[rank3]:2026-01-02 19:18:57,859 - âœ… Pipeline schedule is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/pipeline_schedule/260102_1918_thry_final2000_rank3.svg
[rank3]:			> Batch Time: 591.49 ms, GPU Bubble Ratio: 27.27%, 27.27%, 27.27%, 27.27%
[rank3]:			  [Rank 0]	[S0,MB0,F]  0-17-17ms      | [S0,MB1,F]  17-17-35ms     | [S0,MB2,F]  35-17-53ms     | [S0,MB3,F]  53-17-71ms     | [S0,MB4,F]  71-17-89ms     | [S0,MB5,F]  89-17-107ms    | [S0,MB6,F]  107-17-125ms   | [S0,MB7,F]  125-17-143ms   | [S0,MB0,B]  304-35-340ms   | [S0,MB1,B]  340-35-376ms   | [S0,MB2,B]  376-35-412ms   | [S0,MB3,B]  412-35-448ms   | [S0,MB4,B]  448-35-483ms   | [S0,MB5,B]  483-35-519ms   | [S0,MB6,B]  519-35-555ms   | [S0,MB7,B]  555-35-591ms  
[rank3]:			  [Rank 1]	[S1,MB0,F]  17-17-35ms     | [S1,MB1,F]  35-17-53ms     | [S1,MB2,F]  53-17-71ms     | [S1,MB3,F]  71-17-89ms     | [S1,MB4,F]  89-17-107ms    | [S1,MB5,F]  107-17-125ms   | [S1,MB6,F]  125-17-143ms   | [S1,MB7,F]  143-17-161ms   | [S1,MB0,B]  268-35-304ms   | [S1,MB1,B]  304-35-340ms   | [S1,MB2,B]  340-35-376ms   | [S1,MB3,B]  376-35-412ms   | [S1,MB4,B]  412-35-448ms   | [S1,MB5,B]  448-35-483ms   | [S1,MB6,B]  483-35-519ms   | [S1,MB7,B]  519-35-555ms  
[rank3]:			  [Rank 2]	[S2,MB0,F]  35-17-53ms     | [S2,MB1,F]  53-17-71ms     | [S2,MB2,F]  71-17-89ms     | [S2,MB3,F]  89-17-107ms    | [S2,MB4,F]  107-17-125ms   | [S2,MB5,F]  125-17-143ms   | [S2,MB6,F]  143-17-161ms   | [S2,MB7,F]  161-17-179ms   | [S2,MB0,B]  233-35-268ms   | [S2,MB1,B]  268-35-304ms   | [S2,MB2,B]  304-35-340ms   | [S2,MB3,B]  340-35-376ms   | [S2,MB4,B]  376-35-412ms   | [S2,MB5,B]  412-35-448ms   | [S2,MB6,B]  448-35-483ms   | [S2,MB7,B]  483-35-519ms  
[rank3]:			  [Rank 3]	[S3,MB0,F]  53-17-71ms     | [S3,MB1,F]  71-17-89ms     | [S3,MB2,F]  89-17-107ms    | [S3,MB3,F]  107-17-125ms   | [S3,MB4,F]  125-17-143ms   | [S3,MB5,F]  143-17-161ms   | [S3,MB6,F]  161-17-179ms   | [S3,MB7,F]  179-17-197ms   | [S3,MB0,B]  197-35-233ms   | [S3,MB1,B]  233-35-268ms   | [S3,MB2,B]  268-35-304ms   | [S3,MB3,B]  304-35-340ms   | [S3,MB4,B]  340-35-376ms   | [S3,MB5,B]  376-35-412ms   | [S3,MB6,B]  412-35-448ms   | [S3,MB7,B]  448-35-483ms  
[rank3]:2026-01-02 19:18:57,905 - âœ… Frozen Ratio History of Rank 3 (Stage 3) is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_ratio_history/rank3/260102_1918_stage3_final2000.svg
[rank3]:2026-01-02 19:18:58,067 - âœ… Elementwise Histogram is saved as: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200/frozen_params_histogram/260102_1918_rank3_stage3.svg
[rank3]:	> Counts Sum: 9567, Total Sum: 12025 (79.56%), Ratio(%) per element: [97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 97.83, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 96.21, 87.02, 87.02, 87.02, 87.02, 87.02, 87.02, 87.02, 87.02, 87.02, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[rank3]:2026-01-02 19:18:58,068 - Destroying the purge thread.
[rank3]:wandb: updating run metadata
[rank3]:wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[rank3]:wandb: uploading history steps 40-40, summary, console lines 617-632
[rank3]:wandb: 
[rank3]:wandb: Run history:
[rank3]:wandb:      final/avg_end_to_end(s) â–
[rank3]:wandb:               final/avg_loss â–
[rank3]:wandb:             final/avg_mfu(%) â–
[rank3]:wandb:             final/avg_tflops â–
[rank3]:wandb:    final/avg_throughput(tps) â–
[rank3]:wandb:              final/grad_norm â–
[rank3]:wandb:               final/max_loss â–
[rank3]:wandb:                    grad_norm  â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_avg_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb: loss_metrics/global_max_loss â–‡â–ˆâ–„â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: Run summary:
[rank3]:wandb:      final/avg_end_to_end(s) 2.22838
[rank3]:wandb:               final/avg_loss 0.20918
[rank3]:wandb:             final/avg_mfu(%) 33.46065
[rank3]:wandb:             final/avg_tflops 342.91769
[rank3]:wandb:    final/avg_throughput(tps) 7352.41229
[rank3]:wandb:              final/grad_norm 0.54776
[rank3]:wandb:               final/max_loss 0.20918
[rank3]:wandb:                    grad_norm 0.54776
[rank3]:wandb: loss_metrics/global_avg_loss 0.20918
[rank3]:wandb: loss_metrics/global_max_loss 0.20918
[rank3]:wandb:                          +14 ...
[rank3]:wandb: 
[rank3]:wandb: ðŸš€ View run 260102_GPipe_auto_h200 at: https://wandb.ai/orangingq/torchtitan/runs/wlgql67l
[rank3]:wandb: â­ï¸ View project at: https://wandb.ai/orangingq/torchtitan
[rank3]:wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[rank3]:wandb: Find logs at: ._data/tb/260102_GPipe_auto_h200/20260102-1802/wandb/run-20260102_180237-wlgql67l/logs
[rank0]:2026-01-02 19:18:59,828 - Training completed
[rank0]:2026-01-02 19:18:59,828 - Destroying the purge thread.
[rank3]:2026-01-02 19:19:00,131 - Process group destroyed
[rank1]:2026-01-02 19:19:00,129 - Process group destroyed
[rank0]:2026-01-02 19:19:00,168 - Process group destroyed
[rank2]:2026-01-02 19:19:00,173 - Process group destroyed
[rank1]:[W102 19:19:01.018929129 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank2]:[W102 19:19:01.173747900 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:[W102 19:19:01.233980593 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank3]:[W102 19:19:01.504754123 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
[rank0]:Stage 0: Modules to keep: {'layers.2', 'tok_embeddings', 'layers.3', 'layers.7', 'layers.5', 'layers.6', 'layers.0', 'layers.4', 'layers.1'}
[rank1]:Stage 1: Modules to keep: {'layers.13', 'layers.12', 'layers.14', 'layers.10', 'layers.9', 'layers.8', 'layers.11', 'layers.15', 'layers.16'}
[rank3]:Stage 3: Modules to keep: {'layers.31', 'layers.25', 'layers.26', 'layers.29', 'norm', 'layers.27', 'output', 'layers.30', 'layers.28'}
[rank3]:----- TimelyFreezeâ° Configuration:
[rank3]:	- job:
[rank3]:		- config_file: /opt/dlami/nvme/DMLAB/shcho/torchtitan/logs/h200/260102_llama8b/config_260102.toml
[rank3]:		- dump_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data
[rank3]:		- description: "Llama 3.1 8B Experiment
[rank3]:260102: everything same with 1104_llama8b/1128, but with seed=42
[rank3]:"
[rank3]:		- use_for_integration_test: False
[rank3]:		- print_args: False
[rank3]:		- basename: 260102_GPipe_auto_h200
[rank3]:	- profiling:
[rank3]:		- enable_profiling: False
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/profile_trace/260102_GPipe_auto_h200
[rank3]:		- profile_freq: 100
[rank3]:		- enable_memory_snapshot: False
[rank3]:		- save_memory_snapshot_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/memory_snapshot/260102_GPipe_auto_h200
[rank3]:	- metrics:
[rank3]:		- log_freq: 50
[rank3]:		- enable_tensorboard: False
[rank3]:		- disable_color_printing: True
[rank3]:		- save_tb_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/tb/260102_GPipe_auto_h200
[rank3]:		- save_for_all_ranks: False
[rank3]:		- enable_wandb: True
[rank3]:		- image_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/images/260102_GPipe_auto_h200
[rank3]:		- pplog_freq: 200
[rank3]:		- draw_freq: 100
[rank3]:		- wandb_name: 260102_GPipe_auto_h200
[rank3]:		- draw_graph: True
[rank3]:	- model:
[rank3]:		- name: llama3
[rank3]:		- flavor: 8B
[rank3]:		- tokenizer_path: ./assets/tokenizer/Llama-3.1-8B
[rank3]:		- converters: []
[rank3]:		- print_after_conversion: False
[rank3]:	- optimizer:
[rank3]:		- name: AdamW
[rank3]:		- lr: 3e-06
[rank3]:		- beta1: 0.9
[rank3]:		- beta2: 0.999
[rank3]:		- eps: 1e-08
[rank3]:		- weight_decay: 0.1
[rank3]:		- implementation: fused
[rank3]:		- early_step_in_backward: False
[rank3]:	- lr_scheduler:
[rank3]:		- warmup_steps: 200
[rank3]:		- decay_ratio: 0.8
[rank3]:		- decay_type: cosine
[rank3]:		- min_lr_factor: 0.0
[rank3]:	- training:
[rank3]:		- dataset: openhermes
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 16
[rank3]:		- global_batch_size: 64
[rank3]:		- seq_len: 1024
[rank3]:		- max_norm: 1.0
[rank3]:		- steps: 2000
[rank3]:		- enable_cpu_offload: False
[rank3]:		- mixed_precision_param: bfloat16
[rank3]:		- mixed_precision_reduce: float32
[rank3]:		- compile: False
[rank3]:		- gc_freq: 50
[rank3]:		- gc_debug: False
[rank3]:		- seed: 42
[rank3]:		- deterministic: True
[rank3]:	- parallelism:
[rank3]:		- data_parallel_replicate_degree: 1
[rank3]:		- enable_compiled_autograd: False
[rank3]:		- data_parallel_shard_degree: -1
[rank3]:		- fsdp_reshard_after_forward: default
[rank3]:		- tensor_parallel_degree: 1
[rank3]:		- disable_loss_parallel: False
[rank3]:		- enable_async_tensor_parallel: False
[rank3]:		- pipeline_parallel_degree: 4
[rank3]:		- pipeline_parallel_split_points: []
[rank3]:		- module_fqns_per_model_part: None
[rank3]:		- pipeline_parallel_first_stage_less_layers: 1
[rank3]:		- pipeline_parallel_last_stage_less_layers: 1
[rank3]:		- pipeline_parallel_layers_per_stage: None
[rank3]:		- pipeline_parallel_schedule: GPipe
[rank3]:		- pipeline_parallel_schedule_csv: 
[rank3]:		- pipeline_parallel_microbatch_size: 2
[rank3]:		- context_parallel_degree: 1
[rank3]:		- context_parallel_rotate_method: allgather
[rank3]:		- expert_parallel_degree: 1
[rank3]:		- pp: 4
[rank3]:		- stages_per_rank: 1
[rank3]:		- stages_list: [3]
[rank3]:		- microbatches: 8
[rank3]:	- checkpoint:
[rank3]:		- enable_checkpoint: True
[rank3]:		- checkpoint_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/checkpoint/260102_GPipe_auto_h200
[rank3]:		- interval: 1000
[rank3]:		- initial_load_path: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/base_model/Llama-3.1-8B/original_dcp
[rank3]:		- initial_load_model_only: True
[rank3]:		- initial_load_in_hf: False
[rank3]:		- last_save_model_only: True
[rank3]:		- last_save_in_hf: False
[rank3]:		- export_dtype: float16
[rank3]:		- async_mode: async
[rank3]:		- keep_latest_k: 2
[rank3]:		- load_step: -1
[rank3]:		- exclude_from_loading: ['dataloader', 'lr_scheduler', 'optimizer', 'train_state']
[rank3]:		- enable_first_step_checkpoint: False
[rank3]:		- create_seed_checkpoint: False
[rank3]:	- activation_checkpoint:
[rank3]:		- mode: none
[rank3]:		- selective_ac_option: op
[rank3]:		- per_op_sac_force_recompute_mm_shapes_by_fqns: ['moe.router.gate']
[rank3]:	- float8:
[rank3]:		- enable_fsdp_float8_all_gather: False
[rank3]:		- precompute_float8_dynamic_scale_for_fsdp: False
[rank3]:		- recipe_name: None
[rank3]:		- filter_fqns: ['output']
[rank3]:		- emulate: False
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- mx:
[rank3]:		- mxfp8_dim1_cast_kernel_choice: triton
[rank3]:		- recipe_name: mxfp8
[rank3]:		- filter_fqns: ['output']
[rank3]:		- moe_fqns_prototype: []
[rank3]:	- comm:
[rank3]:		- init_timeout_seconds: 300
[rank3]:		- train_timeout_seconds: 300
[rank3]:		- trace_buf_size: 20000
[rank3]:		- save_traces_folder: /opt/dlami/nvme/DMLAB/shcho/torchtitan_data/comm_traces/260102_GPipe_auto_h200
[rank3]:		- world_size: 4
[rank3]:		- global_rank: 3
[rank3]:		- local_rank: 3
[rank3]:		- dp: 1
[rank3]:		- pp: 4
[rank3]:		- pp_rank: 3
[rank3]:		- dp_rank: 0
[rank3]:		- master_dp_rank: 0
[rank3]:	- memory_estimation:
[rank3]:		- enabled: False
[rank3]:		- disable_fake_mode: False
[rank3]:	- fault_tolerance:
[rank3]:		- enable: False
[rank3]:		- process_group: gloo
[rank3]:		- process_group_timeout_ms: 10000
[rank3]:		- replica_id: 0
[rank3]:		- group_size: 0
[rank3]:		- min_replica_size: 1
[rank3]:		- semi_sync_method: None
[rank3]:		- sync_steps: 5
[rank3]:		- should_quantize: False
[rank3]:		- fragment_sync_delay: 0
[rank3]:		- fragment_update_alpha: 0.0
[rank3]:	- experimental:
[rank3]:		- custom_import: 
[rank3]:		- custom_args_module: 
[rank3]:	- validation:
[rank3]:		- enabled: False
[rank3]:		- dataset: c4_validation
[rank3]:		- dataset_path: None
[rank3]:		- local_batch_size: 8
[rank3]:		- seq_len: 2048
[rank3]:		- freq: 10
[rank3]:		- steps: -1
[rank3]:	- lora:
[rank3]:		- enable_lora: False
[rank3]:		- lora_r: 16
[rank3]:		- lora_alpha: 32
[rank3]:		- lora_dropout: 0.05
[rank3]:		- lora_target_modules: ['wq', 'wk', 'wv', 'wo', 'w1', 'w2', 'w3']
[rank3]:	- freezing:
[rank3]:		- freeze: True
[rank3]:		- metric_type: auto
[rank3]:		- phase_unit: 50
[rank3]:		- stability_check_freq: 10
[rank3]:		- max_freeze_ratio: 0.8
[rank3]:		- adjustment: False
[rank3]:		- threshold: 0.0001
[rank3]:		- percentile: 80
[rank3]:
[rank2]:Stage 2: Modules to keep: {'layers.22', 'layers.17', 'layers.19', 'layers.24', 'layers.20', 'layers.18', 'layers.21', 'layers.23'}
[rank0]:[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank1]:[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank3]:[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[rank2]:[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[W102 19:19:08.471634219 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
